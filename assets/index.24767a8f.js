function Tk(e,o){for(var a=0;a<o.length;a++){const c=o[a];if(typeof c!="string"&&!Array.isArray(c)){for(const d in c)if(d!=="default"&&!(d in e)){const m=Object.getOwnPropertyDescriptor(c,d);m&&Object.defineProperty(e,d,m.get?m:{enumerable:!0,get:()=>c[d]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const m of d)if(m.type==="childList")for(const _ of m.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&c(_)}).observe(document,{childList:!0,subtree:!0});function a(d){const m={};return d.integrity&&(m.integrity=d.integrity),d.referrerpolicy&&(m.referrerPolicy=d.referrerpolicy),d.crossorigin==="use-credentials"?m.credentials="include":d.crossorigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function c(d){if(d.ep)return;d.ep=!0;const m=a(d);fetch(d.href,m)}})();function Uy(e,o){const a=Object.create(null),c=e.split(",");for(let d=0;d<c.length;d++)a[c[d]]=!0;return o?d=>!!a[d.toLowerCase()]:d=>!!a[d]}const Ck="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Ik=Uy(Ck);function qS(e){return!!e||e===""}function jy(e){if(xn(e)){const o={};for(let a=0;a<e.length;a++){const c=e[a],d=rr(c)?Mk(c):jy(c);if(d)for(const m in d)o[m]=d[m]}return o}else{if(rr(e))return e;if(Ri(e))return e}}const Ak=/;(?![^(]*\))/g,kk=/:(.+)/;function Mk(e){const o={};return e.split(Ak).forEach(a=>{if(a){const c=a.split(kk);c.length>1&&(o[c[0].trim()]=c[1].trim())}}),o}function Gy(e){let o="";if(rr(e))o=e;else if(xn(e))for(let a=0;a<e.length;a++){const c=Gy(e[a]);c&&(o+=c+" ")}else if(Ri(e))for(const a in e)e[a]&&(o+=a+" ");return o.trim()}const Pk=e=>rr(e)?e:e==null?"":xn(e)||Ri(e)&&(e.toString===XS||!On(e.toString))?JSON.stringify(e,ZS,2):String(e),ZS=(e,o)=>o&&o.__v_isRef?ZS(e,o.value):oh(o)?{[`Map(${o.size})`]:[...o.entries()].reduce((a,[c,d])=>(a[`${c} =>`]=d,a),{})}:WS(o)?{[`Set(${o.size})`]:[...o.values()]}:Ri(o)&&!xn(o)&&!YS(o)?String(o):o,Ti={},rh=[],ss=()=>{},zk=()=>!1,Lk=/^on[^a-z]/,Cg=e=>Lk.test(e),qy=e=>e.startsWith("onUpdate:"),Cr=Object.assign,Zy=(e,o)=>{const a=e.indexOf(o);a>-1&&e.splice(a,1)},Rk=Object.prototype.hasOwnProperty,Xn=(e,o)=>Rk.call(e,o),xn=Array.isArray,oh=e=>Ig(e)==="[object Map]",WS=e=>Ig(e)==="[object Set]",On=e=>typeof e=="function",rr=e=>typeof e=="string",Wy=e=>typeof e=="symbol",Ri=e=>e!==null&&typeof e=="object",HS=e=>Ri(e)&&On(e.then)&&On(e.catch),XS=Object.prototype.toString,Ig=e=>XS.call(e),Dk=e=>Ig(e).slice(8,-1),YS=e=>Ig(e)==="[object Object]",Hy=e=>rr(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Ym=Uy(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ag=e=>{const o=Object.create(null);return a=>o[a]||(o[a]=e(a))},Bk=/-(\w)/g,Bo=Ag(e=>e.replace(Bk,(o,a)=>a?a.toUpperCase():"")),Ok=/\B([A-Z])/g,ph=Ag(e=>e.replace(Ok,"-$1").toLowerCase()),bl=Ag(e=>e.charAt(0).toUpperCase()+e.slice(1)),Km=Ag(e=>e?`on${bl(e)}`:""),wf=(e,o)=>!Object.is(e,o),Jm=(e,o)=>{for(let a=0;a<e.length;a++)e[a](o)},rg=(e,o,a)=>{Object.defineProperty(e,o,{configurable:!0,enumerable:!1,value:a})},og=e=>{const o=parseFloat(e);return isNaN(o)?e:o};let Pb;const Fk=()=>Pb||(Pb=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let ko;class KS{constructor(o=!1){this.detached=o,this.active=!0,this.effects=[],this.cleanups=[],this.parent=ko,!o&&ko&&(this.index=(ko.scopes||(ko.scopes=[])).push(this)-1)}run(o){if(this.active){const a=ko;try{return ko=this,o()}finally{ko=a}}}on(){ko=this}off(){ko=this.parent}stop(o){if(this.active){let a,c;for(a=0,c=this.effects.length;a<c;a++)this.effects[a].stop();for(a=0,c=this.cleanups.length;a<c;a++)this.cleanups[a]();if(this.scopes)for(a=0,c=this.scopes.length;a<c;a++)this.scopes[a].stop(!0);if(!this.detached&&this.parent&&!o){const d=this.parent.scopes.pop();d&&d!==this&&(this.parent.scopes[this.index]=d,d.index=this.index)}this.parent=void 0,this.active=!1}}}function Uf(e){return new KS(e)}function Vk(e,o=ko){o&&o.active&&o.effects.push(e)}function Dc(e){ko&&ko.cleanups.push(e)}const Xy=e=>{const o=new Set(e);return o.w=0,o.n=0,o},JS=e=>(e.w&vl)>0,QS=e=>(e.n&vl)>0,$k=({deps:e})=>{if(e.length)for(let o=0;o<e.length;o++)e[o].w|=vl},Nk=e=>{const{deps:o}=e;if(o.length){let a=0;for(let c=0;c<o.length;c++){const d=o[c];JS(d)&&!QS(d)?d.delete(e):o[a++]=d,d.w&=~vl,d.n&=~vl}o.length=a}},H_=new WeakMap;let cf=0,vl=1;const X_=30;let is;const kc=Symbol(""),Y_=Symbol("");class Yy{constructor(o,a=null,c){this.fn=o,this.scheduler=a,this.active=!0,this.deps=[],this.parent=void 0,Vk(this,c)}run(){if(!this.active)return this.fn();let o=is,a=ml;for(;o;){if(o===this)return;o=o.parent}try{return this.parent=is,is=this,ml=!0,vl=1<<++cf,cf<=X_?$k(this):zb(this),this.fn()}finally{cf<=X_&&Nk(this),vl=1<<--cf,is=this.parent,ml=a,this.parent=void 0,this.deferStop&&this.stop()}}stop(){is===this?this.deferStop=!0:this.active&&(zb(this),this.onStop&&this.onStop(),this.active=!1)}}function zb(e){const{deps:o}=e;if(o.length){for(let a=0;a<o.length;a++)o[a].delete(e);o.length=0}}let ml=!0;const eE=[];function Bc(){eE.push(ml),ml=!1}function Oc(){const e=eE.pop();ml=e===void 0?!0:e}function mo(e,o,a){if(ml&&is){let c=H_.get(e);c||H_.set(e,c=new Map);let d=c.get(a);d||c.set(a,d=Xy()),tE(d)}}function tE(e,o){let a=!1;cf<=X_?QS(e)||(e.n|=vl,a=!JS(e)):a=!e.has(is),a&&(e.add(is),is.deps.push(e))}function ga(e,o,a,c,d,m){const _=H_.get(e);if(!_)return;let s=[];if(o==="clear")s=[..._.values()];else if(a==="length"&&xn(e))_.forEach((w,E)=>{(E==="length"||E>=c)&&s.push(w)});else switch(a!==void 0&&s.push(_.get(a)),o){case"add":xn(e)?Hy(a)&&s.push(_.get("length")):(s.push(_.get(kc)),oh(e)&&s.push(_.get(Y_)));break;case"delete":xn(e)||(s.push(_.get(kc)),oh(e)&&s.push(_.get(Y_)));break;case"set":oh(e)&&s.push(_.get(kc));break}if(s.length===1)s[0]&&K_(s[0]);else{const w=[];for(const E of s)E&&w.push(...E);K_(Xy(w))}}function K_(e,o){const a=xn(e)?e:[...e];for(const c of a)c.computed&&Lb(c);for(const c of a)c.computed||Lb(c)}function Lb(e,o){(e!==is||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const Uk=Uy("__proto__,__v_isRef,__isVue"),nE=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Wy)),jk=Ky(),Gk=Ky(!1,!0),qk=Ky(!0),Rb=Zk();function Zk(){const e={};return["includes","indexOf","lastIndexOf"].forEach(o=>{e[o]=function(...a){const c=Yn(this);for(let m=0,_=this.length;m<_;m++)mo(c,"get",m+"");const d=c[o](...a);return d===-1||d===!1?c[o](...a.map(Yn)):d}}),["push","pop","shift","unshift","splice"].forEach(o=>{e[o]=function(...a){Bc();const c=Yn(this)[o].apply(this,a);return Oc(),c}}),e}function Ky(e=!1,o=!1){return function(c,d,m){if(d==="__v_isReactive")return!e;if(d==="__v_isReadonly")return e;if(d==="__v_isShallow")return o;if(d==="__v_raw"&&m===(e?o?lM:aE:o?sE:oE).get(c))return c;const _=xn(c);if(!e&&_&&Xn(Rb,d))return Reflect.get(Rb,d,m);const s=Reflect.get(c,d,m);return(Wy(d)?nE.has(d):Uk(d))||(e||mo(c,"get",d),o)?s:zi(s)?_&&Hy(d)?s:s.value:Ri(s)?e?jf(s):$i(s):s}}const Wk=iE(),Hk=iE(!0);function iE(e=!1){return function(a,c,d,m){let _=a[c];if(ch(_)&&zi(_)&&!zi(d))return!1;if(!e&&(!sg(d)&&!ch(d)&&(_=Yn(_),d=Yn(d)),!xn(a)&&zi(_)&&!zi(d)))return _.value=d,!0;const s=xn(a)&&Hy(c)?Number(c)<a.length:Xn(a,c),w=Reflect.set(a,c,d,m);return a===Yn(m)&&(s?wf(d,_)&&ga(a,"set",c,d):ga(a,"add",c,d)),w}}function Xk(e,o){const a=Xn(e,o);e[o];const c=Reflect.deleteProperty(e,o);return c&&a&&ga(e,"delete",o,void 0),c}function Yk(e,o){const a=Reflect.has(e,o);return(!Wy(o)||!nE.has(o))&&mo(e,"has",o),a}function Kk(e){return mo(e,"iterate",xn(e)?"length":kc),Reflect.ownKeys(e)}const rE={get:jk,set:Wk,deleteProperty:Xk,has:Yk,ownKeys:Kk},Jk={get:qk,set(e,o){return!0},deleteProperty(e,o){return!0}},Qk=Cr({},rE,{get:Gk,set:Hk}),Jy=e=>e,kg=e=>Reflect.getPrototypeOf(e);function Fm(e,o,a=!1,c=!1){e=e.__v_raw;const d=Yn(e),m=Yn(o);a||(o!==m&&mo(d,"get",o),mo(d,"get",m));const{has:_}=kg(d),s=c?Jy:a?t0:Sf;if(_.call(d,o))return s(e.get(o));if(_.call(d,m))return s(e.get(m));e!==d&&e.get(o)}function Vm(e,o=!1){const a=this.__v_raw,c=Yn(a),d=Yn(e);return o||(e!==d&&mo(c,"has",e),mo(c,"has",d)),e===d?a.has(e):a.has(e)||a.has(d)}function $m(e,o=!1){return e=e.__v_raw,!o&&mo(Yn(e),"iterate",kc),Reflect.get(e,"size",e)}function Db(e){e=Yn(e);const o=Yn(this);return kg(o).has.call(o,e)||(o.add(e),ga(o,"add",e,e)),this}function Bb(e,o){o=Yn(o);const a=Yn(this),{has:c,get:d}=kg(a);let m=c.call(a,e);m||(e=Yn(e),m=c.call(a,e));const _=d.call(a,e);return a.set(e,o),m?wf(o,_)&&ga(a,"set",e,o):ga(a,"add",e,o),this}function Ob(e){const o=Yn(this),{has:a,get:c}=kg(o);let d=a.call(o,e);d||(e=Yn(e),d=a.call(o,e)),c&&c.call(o,e);const m=o.delete(e);return d&&ga(o,"delete",e,void 0),m}function Fb(){const e=Yn(this),o=e.size!==0,a=e.clear();return o&&ga(e,"clear",void 0,void 0),a}function Nm(e,o){return function(c,d){const m=this,_=m.__v_raw,s=Yn(_),w=o?Jy:e?t0:Sf;return!e&&mo(s,"iterate",kc),_.forEach((E,A)=>c.call(d,w(E),w(A),m))}}function Um(e,o,a){return function(...c){const d=this.__v_raw,m=Yn(d),_=oh(m),s=e==="entries"||e===Symbol.iterator&&_,w=e==="keys"&&_,E=d[e](...c),A=a?Jy:o?t0:Sf;return!o&&mo(m,"iterate",w?Y_:kc),{next(){const{value:P,done:L}=E.next();return L?{value:P,done:L}:{value:s?[A(P[0]),A(P[1])]:A(P),done:L}},[Symbol.iterator](){return this}}}}function sl(e){return function(...o){return e==="delete"?!1:this}}function eM(){const e={get(m){return Fm(this,m)},get size(){return $m(this)},has:Vm,add:Db,set:Bb,delete:Ob,clear:Fb,forEach:Nm(!1,!1)},o={get(m){return Fm(this,m,!1,!0)},get size(){return $m(this)},has:Vm,add:Db,set:Bb,delete:Ob,clear:Fb,forEach:Nm(!1,!0)},a={get(m){return Fm(this,m,!0)},get size(){return $m(this,!0)},has(m){return Vm.call(this,m,!0)},add:sl("add"),set:sl("set"),delete:sl("delete"),clear:sl("clear"),forEach:Nm(!0,!1)},c={get(m){return Fm(this,m,!0,!0)},get size(){return $m(this,!0)},has(m){return Vm.call(this,m,!0)},add:sl("add"),set:sl("set"),delete:sl("delete"),clear:sl("clear"),forEach:Nm(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(m=>{e[m]=Um(m,!1,!1),a[m]=Um(m,!0,!1),o[m]=Um(m,!1,!0),c[m]=Um(m,!0,!0)}),[e,a,o,c]}const[tM,nM,iM,rM]=eM();function Qy(e,o){const a=o?e?rM:iM:e?nM:tM;return(c,d,m)=>d==="__v_isReactive"?!e:d==="__v_isReadonly"?e:d==="__v_raw"?c:Reflect.get(Xn(a,d)&&d in c?a:c,d,m)}const oM={get:Qy(!1,!1)},sM={get:Qy(!1,!0)},aM={get:Qy(!0,!1)},oE=new WeakMap,sE=new WeakMap,aE=new WeakMap,lM=new WeakMap;function cM(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function uM(e){return e.__v_skip||!Object.isExtensible(e)?0:cM(Dk(e))}function $i(e){return ch(e)?e:e0(e,!1,rE,oM,oE)}function lE(e){return e0(e,!1,Qk,sM,sE)}function jf(e){return e0(e,!0,Jk,aM,aE)}function e0(e,o,a,c,d){if(!Ri(e)||e.__v_raw&&!(o&&e.__v_isReactive))return e;const m=d.get(e);if(m)return m;const _=uM(e);if(_===0)return e;const s=new Proxy(e,_===2?c:a);return d.set(e,s),s}function sh(e){return ch(e)?sh(e.__v_raw):!!(e&&e.__v_isReactive)}function ch(e){return!!(e&&e.__v_isReadonly)}function sg(e){return!!(e&&e.__v_isShallow)}function cE(e){return sh(e)||ch(e)}function Yn(e){const o=e&&e.__v_raw;return o?Yn(o):e}function uE(e){return rg(e,"__v_skip",!0),e}const Sf=e=>Ri(e)?$i(e):e,t0=e=>Ri(e)?jf(e):e;function hE(e){ml&&is&&(e=Yn(e),tE(e.dep||(e.dep=Xy())))}function dE(e,o){e=Yn(e),e.dep&&K_(e.dep)}function zi(e){return!!(e&&e.__v_isRef===!0)}function He(e){return fE(e,!1)}function Ii(e){return fE(e,!0)}function fE(e,o){return zi(e)?e:new hM(e,o)}class hM{constructor(o,a){this.__v_isShallow=a,this.dep=void 0,this.__v_isRef=!0,this._rawValue=a?o:Yn(o),this._value=a?o:Sf(o)}get value(){return hE(this),this._value}set value(o){const a=this.__v_isShallow||sg(o)||ch(o);o=a?o:Yn(o),wf(o,this._rawValue)&&(this._rawValue=o,this._value=a?o:Sf(o),dE(this))}}function pi(e){return zi(e)?e.value:e}const dM={get:(e,o,a)=>pi(Reflect.get(e,o,a)),set:(e,o,a,c)=>{const d=e[o];return zi(d)&&!zi(a)?(d.value=a,!0):Reflect.set(e,o,a,c)}};function pE(e){return sh(e)?e:new Proxy(e,dM)}function n0(e){const o=xn(e)?new Array(e.length):{};for(const a in e)o[a]=Et(e,a);return o}class fM{constructor(o,a,c){this._object=o,this._key=a,this._defaultValue=c,this.__v_isRef=!0}get value(){const o=this._object[this._key];return o===void 0?this._defaultValue:o}set value(o){this._object[this._key]=o}}function Et(e,o,a){const c=e[o];return zi(c)?c:new fM(e,o,a)}var mE;class pM{constructor(o,a,c,d){this._setter=a,this.dep=void 0,this.__v_isRef=!0,this[mE]=!1,this._dirty=!0,this.effect=new Yy(o,()=>{this._dirty||(this._dirty=!0,dE(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!d,this.__v_isReadonly=c}get value(){const o=Yn(this);return hE(o),(o._dirty||!o._cacheable)&&(o._dirty=!1,o._value=o.effect.run()),o._value}set value(o){this._setter(o)}}mE="__v_isReadonly";function mM(e,o,a=!1){let c,d;const m=On(e);return m?(c=e,d=ss):(c=e.get,d=e.set),new pM(c,d,m||!d,a)}const df=[];function gM(e,...o){Bc();const a=df.length?df[df.length-1].component:null,c=a&&a.appContext.config.warnHandler,d=vM();if(c)pa(c,a,11,[e+o.join(""),a&&a.proxy,d.map(({vnode:m})=>`at <${WE(a,m.type)}>`).join(`
`),d]);else{const m=[`[Vue warn]: ${e}`,...o];d.length&&m.push(`
`,..._M(d)),console.warn(...m)}Oc()}function vM(){let e=df[df.length-1];if(!e)return[];const o=[];for(;e;){const a=o[0];a&&a.vnode===e?a.recurseCount++:o.push({vnode:e,recurseCount:0});const c=e.component&&e.component.parent;e=c&&c.vnode}return o}function _M(e){const o=[];return e.forEach((a,c)=>{o.push(...c===0?[]:[`
`],...yM(a))}),o}function yM({vnode:e,recurseCount:o}){const a=o>0?`... (${o} recursive calls)`:"",c=e.component?e.component.parent==null:!1,d=` at <${WE(e.component,e.type,c)}`,m=">"+a;return e.props?[d,...xM(e.props),m]:[d+m]}function xM(e){const o=[],a=Object.keys(e);return a.slice(0,3).forEach(c=>{o.push(...gE(c,e[c]))}),a.length>3&&o.push(" ..."),o}function gE(e,o,a){return rr(o)?(o=JSON.stringify(o),a?o:[`${e}=${o}`]):typeof o=="number"||typeof o=="boolean"||o==null?a?o:[`${e}=${o}`]:zi(o)?(o=gE(e,Yn(o.value),!0),a?o:[`${e}=Ref<`,o,">"]):On(o)?[`${e}=fn${o.name?`<${o.name}>`:""}`]:(o=Yn(o),a?o:[`${e}=`,o])}function pa(e,o,a,c){let d;try{d=c?e(...c):e()}catch(m){Mg(m,o,a)}return d}function Po(e,o,a,c){if(On(e)){const m=pa(e,o,a,c);return m&&HS(m)&&m.catch(_=>{Mg(_,o,a)}),m}const d=[];for(let m=0;m<e.length;m++)d.push(Po(e[m],o,a,c));return d}function Mg(e,o,a,c=!0){const d=o?o.vnode:null;if(o){let m=o.parent;const _=o.proxy,s=a;for(;m;){const E=m.ec;if(E){for(let A=0;A<E.length;A++)if(E[A](e,_,s)===!1)return}m=m.parent}const w=o.appContext.config.errorHandler;if(w){pa(w,null,10,[e,_,s]);return}}bM(e,a,d,c)}function bM(e,o,a,c=!0){console.error(e)}let Ef=!1,J_=!1;const Ur=[];let Ds=0;const ah=[];let fa=null,bc=0;const vE=Promise.resolve();let i0=null;function Xi(e){const o=i0||vE;return e?o.then(this?e.bind(this):e):o}function wM(e){let o=Ds+1,a=Ur.length;for(;o<a;){const c=o+a>>>1;Tf(Ur[c])<e?o=c+1:a=c}return o}function r0(e){(!Ur.length||!Ur.includes(e,Ef&&e.allowRecurse?Ds+1:Ds))&&(e.id==null?Ur.push(e):Ur.splice(wM(e.id),0,e),_E())}function _E(){!Ef&&!J_&&(J_=!0,i0=vE.then(xE))}function SM(e){const o=Ur.indexOf(e);o>Ds&&Ur.splice(o,1)}function EM(e){xn(e)?ah.push(...e):(!fa||!fa.includes(e,e.allowRecurse?bc+1:bc))&&ah.push(e),_E()}function Vb(e,o=Ef?Ds+1:0){for(;o<Ur.length;o++){const a=Ur[o];a&&a.pre&&(Ur.splice(o,1),o--,a())}}function yE(e){if(ah.length){const o=[...new Set(ah)];if(ah.length=0,fa){fa.push(...o);return}for(fa=o,fa.sort((a,c)=>Tf(a)-Tf(c)),bc=0;bc<fa.length;bc++)fa[bc]();fa=null,bc=0}}const Tf=e=>e.id==null?1/0:e.id,TM=(e,o)=>{const a=Tf(e)-Tf(o);if(a===0){if(e.pre&&!o.pre)return-1;if(o.pre&&!e.pre)return 1}return a};function xE(e){J_=!1,Ef=!0,Ur.sort(TM);const o=ss;try{for(Ds=0;Ds<Ur.length;Ds++){const a=Ur[Ds];a&&a.active!==!1&&pa(a,null,14)}}finally{Ds=0,Ur.length=0,yE(),Ef=!1,i0=null,(Ur.length||ah.length)&&xE()}}function CM(e,o,...a){if(e.isUnmounted)return;const c=e.vnode.props||Ti;let d=a;const m=o.startsWith("update:"),_=m&&o.slice(7);if(_&&_ in c){const A=`${_==="modelValue"?"model":_}Modifiers`,{number:P,trim:L}=c[A]||Ti;L&&(d=a.map(D=>D.trim())),P&&(d=a.map(og))}let s,w=c[s=Km(o)]||c[s=Km(Bo(o))];!w&&m&&(w=c[s=Km(ph(o))]),w&&Po(w,e,6,d);const E=c[s+"Once"];if(E){if(!e.emitted)e.emitted={};else if(e.emitted[s])return;e.emitted[s]=!0,Po(E,e,6,d)}}function bE(e,o,a=!1){const c=o.emitsCache,d=c.get(e);if(d!==void 0)return d;const m=e.emits;let _={},s=!1;if(!On(e)){const w=E=>{const A=bE(E,o,!0);A&&(s=!0,Cr(_,A))};!a&&o.mixins.length&&o.mixins.forEach(w),e.extends&&w(e.extends),e.mixins&&e.mixins.forEach(w)}return!m&&!s?(Ri(e)&&c.set(e,null),null):(xn(m)?m.forEach(w=>_[w]=null):Cr(_,m),Ri(e)&&c.set(e,_),_)}function Pg(e,o){return!e||!Cg(o)?!1:(o=o.slice(2).replace(/Once$/,""),Xn(e,o[0].toLowerCase()+o.slice(1))||Xn(e,ph(o))||Xn(e,o))}let jr=null,wE=null;function ag(e){const o=jr;return jr=e,wE=e&&e.type.__scopeId||null,o}function wn(e,o=jr,a){if(!o||e._n)return e;const c=(...d)=>{c._d&&Kb(-1);const m=ag(o);let _;try{_=e(...d)}finally{ag(m),c._d&&Kb(1)}return _};return c._n=!0,c._c=!0,c._d=!0,c}function b_(e){const{type:o,vnode:a,proxy:c,withProxy:d,props:m,propsOptions:[_],slots:s,attrs:w,emit:E,render:A,renderCache:P,data:L,setupState:D,ctx:N,inheritAttrs:Z}=e;let de,ne;const ce=ag(e);try{if(a.shapeFlag&4){const Se=d||c;de=Rs(A.call(Se,Se,P,m,D,L,N)),ne=w}else{const Se=o;de=Rs(Se.length>1?Se(m,{attrs:w,slots:s,emit:E}):Se(m,null)),ne=o.props?w:IM(w)}}catch(Se){mf.length=0,Mg(Se,e,1),de=F(Lo)}let K=de;if(ne&&Z!==!1){const Se=Object.keys(ne),{shapeFlag:Y}=K;Se.length&&Y&7&&(_&&Se.some(qy)&&(ne=AM(ne,_)),K=_a(K,ne))}return a.dirs&&(K=_a(K),K.dirs=K.dirs?K.dirs.concat(a.dirs):a.dirs),a.transition&&(K.transition=a.transition),de=K,ag(ce),de}const IM=e=>{let o;for(const a in e)(a==="class"||a==="style"||Cg(a))&&((o||(o={}))[a]=e[a]);return o},AM=(e,o)=>{const a={};for(const c in e)(!qy(c)||!(c.slice(9)in o))&&(a[c]=e[c]);return a};function kM(e,o,a){const{props:c,children:d,component:m}=e,{props:_,children:s,patchFlag:w}=o,E=m.emitsOptions;if(o.dirs||o.transition)return!0;if(a&&w>=0){if(w&1024)return!0;if(w&16)return c?$b(c,_,E):!!_;if(w&8){const A=o.dynamicProps;for(let P=0;P<A.length;P++){const L=A[P];if(_[L]!==c[L]&&!Pg(E,L))return!0}}}else return(d||s)&&(!s||!s.$stable)?!0:c===_?!1:c?_?$b(c,_,E):!0:!!_;return!1}function $b(e,o,a){const c=Object.keys(o);if(c.length!==Object.keys(e).length)return!0;for(let d=0;d<c.length;d++){const m=c[d];if(o[m]!==e[m]&&!Pg(a,m))return!0}return!1}function MM({vnode:e,parent:o},a){for(;o&&o.subTree===e;)(e=o.vnode).el=a,o=o.parent}const PM=e=>e.__isSuspense;function zM(e,o){o&&o.pendingBranch?xn(e)?o.effects.push(...e):o.effects.push(e):EM(e)}function Wi(e,o){if(Tr){let a=Tr.provides;const c=Tr.parent&&Tr.parent.provides;c===a&&(a=Tr.provides=Object.create(c)),a[e]=o}}function cn(e,o,a=!1){const c=Tr||jr;if(c){const d=c.parent==null?c.vnode.appContext&&c.vnode.appContext.provides:c.parent.provides;if(d&&e in d)return d[e];if(arguments.length>1)return a&&On(o)?o.call(c.proxy):o}}function Vs(e,o){return o0(e,null,o)}const Nb={};function Ke(e,o,a){return o0(e,o,a)}function o0(e,o,{immediate:a,deep:c,flush:d,onTrack:m,onTrigger:_}=Ti){const s=Tr;let w,E=!1,A=!1;if(zi(e)?(w=()=>e.value,E=sg(e)):sh(e)?(w=()=>e,c=!0):xn(e)?(A=!0,E=e.some(ne=>sh(ne)||sg(ne)),w=()=>e.map(ne=>{if(zi(ne))return ne.value;if(sh(ne))return Ec(ne);if(On(ne))return pa(ne,s,2)})):On(e)?o?w=()=>pa(e,s,2):w=()=>{if(!(s&&s.isUnmounted))return P&&P(),Po(e,s,3,[L])}:w=ss,o&&c){const ne=w;w=()=>Ec(ne())}let P,L=ne=>{P=de.onStop=()=>{pa(ne,s,4)}};if(kf)return L=ss,o?a&&Po(o,s,3,[w(),A?[]:void 0,L]):w(),ss;let D=A?[]:Nb;const N=()=>{if(!!de.active)if(o){const ne=de.run();(c||E||(A?ne.some((ce,K)=>wf(ce,D[K])):wf(ne,D)))&&(P&&P(),Po(o,s,3,[ne,D===Nb?void 0:D,L]),D=ne)}else de.run()};N.allowRecurse=!!o;let Z;d==="sync"?Z=N:d==="post"?Z=()=>ro(N,s&&s.suspense):(N.pre=!0,s&&(N.id=s.uid),Z=()=>r0(N));const de=new Yy(w,Z);return o?a?N():D=de.run():d==="post"?ro(de.run.bind(de),s&&s.suspense):de.run(),()=>{de.stop(),s&&s.scope&&Zy(s.scope.effects,de)}}function LM(e,o,a){const c=this.proxy,d=rr(e)?e.includes(".")?SE(c,e):()=>c[e]:e.bind(c,c);let m;On(o)?m=o:(m=o.handler,a=o);const _=Tr;uh(this);const s=o0(d,m.bind(c),a);return _?uh(_):Mc(),s}function SE(e,o){const a=o.split(".");return()=>{let c=e;for(let d=0;d<a.length&&c;d++)c=c[a[d]];return c}}function Ec(e,o){if(!Ri(e)||e.__v_skip||(o=o||new Set,o.has(e)))return e;if(o.add(e),zi(e))Ec(e.value,o);else if(xn(e))for(let a=0;a<e.length;a++)Ec(e[a],o);else if(WS(e)||oh(e))e.forEach(a=>{Ec(a,o)});else if(YS(e))for(const a in e)Ec(e[a],o);return e}function EE(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return zn(()=>{e.isMounted=!0}),Ai(()=>{e.isUnmounting=!0}),e}const Ao=[Function,Array],RM={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ao,onEnter:Ao,onAfterEnter:Ao,onEnterCancelled:Ao,onBeforeLeave:Ao,onLeave:Ao,onAfterLeave:Ao,onLeaveCancelled:Ao,onBeforeAppear:Ao,onAppear:Ao,onAfterAppear:Ao,onAppearCancelled:Ao},setup(e,{slots:o}){const a=Bg(),c=EE();let d;return()=>{const m=o.default&&s0(o.default(),!0);if(!m||!m.length)return;let _=m[0];if(m.length>1){for(const Z of m)if(Z.type!==Lo){_=Z;break}}const s=Yn(e),{mode:w}=s;if(c.isLeaving)return w_(_);const E=Ub(_);if(!E)return w_(_);const A=Cf(E,s,c,a);If(E,A);const P=a.subTree,L=P&&Ub(P);let D=!1;const{getTransitionKey:N}=E.type;if(N){const Z=N();d===void 0?d=Z:Z!==d&&(d=Z,D=!0)}if(L&&L.type!==Lo&&(!wc(E,L)||D)){const Z=Cf(L,s,c,a);if(If(L,Z),w==="out-in")return c.isLeaving=!0,Z.afterLeave=()=>{c.isLeaving=!1,a.update()},w_(_);w==="in-out"&&E.type!==Lo&&(Z.delayLeave=(de,ne,ce)=>{const K=CE(c,L);K[String(L.key)]=L,de._leaveCb=()=>{ne(),de._leaveCb=void 0,delete A.delayedLeave},A.delayedLeave=ce})}return _}}},TE=RM;function CE(e,o){const{leavingVNodes:a}=e;let c=a.get(o.type);return c||(c=Object.create(null),a.set(o.type,c)),c}function Cf(e,o,a,c){const{appear:d,mode:m,persisted:_=!1,onBeforeEnter:s,onEnter:w,onAfterEnter:E,onEnterCancelled:A,onBeforeLeave:P,onLeave:L,onAfterLeave:D,onLeaveCancelled:N,onBeforeAppear:Z,onAppear:de,onAfterAppear:ne,onAppearCancelled:ce}=o,K=String(e.key),Se=CE(a,e),Y=(ve,Ee)=>{ve&&Po(ve,c,9,Ee)},_e=(ve,Ee)=>{const be=Ee[1];Y(ve,Ee),xn(ve)?ve.every(Re=>Re.length<=1)&&be():ve.length<=1&&be()},fe={mode:m,persisted:_,beforeEnter(ve){let Ee=s;if(!a.isMounted)if(d)Ee=Z||s;else return;ve._leaveCb&&ve._leaveCb(!0);const be=Se[K];be&&wc(e,be)&&be.el._leaveCb&&be.el._leaveCb(),Y(Ee,[ve])},enter(ve){let Ee=w,be=E,Re=A;if(!a.isMounted)if(d)Ee=de||w,be=ne||E,Re=ce||A;else return;let ze=!1;const Je=ve._enterCb=ct=>{ze||(ze=!0,ct?Y(Re,[ve]):Y(be,[ve]),fe.delayedLeave&&fe.delayedLeave(),ve._enterCb=void 0)};Ee?_e(Ee,[ve,Je]):Je()},leave(ve,Ee){const be=String(e.key);if(ve._enterCb&&ve._enterCb(!0),a.isUnmounting)return Ee();Y(P,[ve]);let Re=!1;const ze=ve._leaveCb=Je=>{Re||(Re=!0,Ee(),Je?Y(N,[ve]):Y(D,[ve]),ve._leaveCb=void 0,Se[be]===e&&delete Se[be])};Se[be]=e,L?_e(L,[ve,ze]):ze()},clone(ve){return Cf(ve,o,a,c)}};return fe}function w_(e){if(zg(e))return e=_a(e),e.children=null,e}function Ub(e){return zg(e)?e.children?e.children[0]:void 0:e}function If(e,o){e.shapeFlag&6&&e.component?If(e.component.subTree,o):e.shapeFlag&128?(e.ssContent.transition=o.clone(e.ssContent),e.ssFallback.transition=o.clone(e.ssFallback)):e.transition=o}function s0(e,o=!1,a){let c=[],d=0;for(let m=0;m<e.length;m++){let _=e[m];const s=a==null?_.key:String(a)+String(_.key!=null?_.key:m);_.type===Dn?(_.patchFlag&128&&d++,c=c.concat(s0(_.children,o,s))):(o||_.type!==Lo)&&c.push(s!=null?_a(_,{key:s}):_)}if(d>1)for(let m=0;m<c.length;m++)c[m].patchFlag=-2;return c}function vn(e){return On(e)?{setup:e,name:e.name}:e}const ff=e=>!!e.type.__asyncLoader,zg=e=>e.type.__isKeepAlive;function IE(e,o){kE(e,"a",o)}function AE(e,o){kE(e,"da",o)}function kE(e,o,a=Tr){const c=e.__wdc||(e.__wdc=()=>{let d=a;for(;d;){if(d.isDeactivated)return;d=d.parent}return e()});if(Lg(o,c,a),a){let d=a.parent;for(;d&&d.parent;)zg(d.parent.vnode)&&DM(c,o,a,d),d=d.parent}}function DM(e,o,a,c){const d=Lg(o,e,c,!0);gr(()=>{Zy(c[o],d)},a)}function Lg(e,o,a=Tr,c=!1){if(a){const d=a[e]||(a[e]=[]),m=o.__weh||(o.__weh=(..._)=>{if(a.isUnmounted)return;Bc(),uh(a);const s=Po(o,a,e,_);return Mc(),Oc(),s});return c?d.unshift(m):d.push(m),m}}const xa=e=>(o,a=Tr)=>(!kf||e==="sp")&&Lg(e,(...c)=>o(...c),a),Rg=xa("bm"),zn=xa("m"),ME=xa("bu"),PE=xa("u"),Ai=xa("bum"),gr=xa("um"),BM=xa("sp"),OM=xa("rtg"),FM=xa("rtc");function VM(e,o=Tr){Lg("ec",e,o)}function Yi(e,o){const a=jr;if(a===null)return e;const c=Og(a)||a.proxy,d=e.dirs||(e.dirs=[]);for(let m=0;m<o.length;m++){let[_,s,w,E=Ti]=o[m];On(_)&&(_={mounted:_,updated:_}),_.deep&&Ec(s),d.push({dir:_,instance:c,value:s,oldValue:void 0,arg:w,modifiers:E})}return e}function mc(e,o,a,c){const d=e.dirs,m=o&&o.dirs;for(let _=0;_<d.length;_++){const s=d[_];m&&(s.oldValue=m[_].value);let w=s.dir[c];w&&(Bc(),Po(w,a,8,[e.el,s,e,o]),Oc())}}const a0="components",$M="directives";function zo(e,o){return l0(a0,e,!0,o)||e}const zE=Symbol();function NM(e){return rr(e)?l0(a0,e,!1)||e:e||zE}function go(e){return l0($M,e)}function l0(e,o,a=!0,c=!1){const d=jr||Tr;if(d){const m=d.type;if(e===a0){const s=ZE(m,!1);if(s&&(s===o||s===Bo(o)||s===bl(Bo(o))))return m}const _=jb(d[e]||m[e],o)||jb(d.appContext[e],o);return!_&&c?m:_}}function jb(e,o){return e&&(e[o]||e[Bo(o)]||e[bl(Bo(o))])}function UM(e,o,a,c){let d;const m=a&&a[c];if(xn(e)||rr(e)){d=new Array(e.length);for(let _=0,s=e.length;_<s;_++)d[_]=o(e[_],_,void 0,m&&m[_])}else if(typeof e=="number"){d=new Array(e);for(let _=0;_<e;_++)d[_]=o(_+1,_,void 0,m&&m[_])}else if(Ri(e))if(e[Symbol.iterator])d=Array.from(e,(_,s)=>o(_,s,void 0,m&&m[s]));else{const _=Object.keys(e);d=new Array(_.length);for(let s=0,w=_.length;s<w;s++){const E=_[s];d[s]=o(e[E],E,s,m&&m[s])}}else d=[];return a&&(a[c]=d),d}function mh(e,o,a={},c,d){if(jr.isCE||jr.parent&&ff(jr.parent)&&jr.parent.isCE)return F("slot",o==="default"?null:{name:o},c&&c());let m=e[o];m&&m._c&&(m._d=!1),fi();const _=m&&LE(m(a)),s=Mr(Dn,{key:a.key||_&&_.key||`_${o}`},_||(c?c():[]),_&&e._===1?64:-2);return!d&&s.scopeId&&(s.slotScopeIds=[s.scopeId+"-s"]),m&&m._c&&(m._d=!0),s}function LE(e){return e.some(o=>ug(o)?!(o.type===Lo||o.type===Dn&&!LE(o.children)):!0)?e:null}function S_(e,o){const a={};for(const c in e)a[o&&/[A-Z]/.test(c)?`on:${c}`:Km(c)]=e[c];return a}const Q_=e=>e?GE(e)?Og(e)||e.proxy:Q_(e.parent):null,lg=Cr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Q_(e.parent),$root:e=>Q_(e.root),$emit:e=>e.emit,$options:e=>c0(e),$forceUpdate:e=>e.f||(e.f=()=>r0(e.update)),$nextTick:e=>e.n||(e.n=Xi.bind(e.proxy)),$watch:e=>LM.bind(e)}),jM={get({_:e},o){const{ctx:a,setupState:c,data:d,props:m,accessCache:_,type:s,appContext:w}=e;let E;if(o[0]!=="$"){const D=_[o];if(D!==void 0)switch(D){case 1:return c[o];case 2:return d[o];case 4:return a[o];case 3:return m[o]}else{if(c!==Ti&&Xn(c,o))return _[o]=1,c[o];if(d!==Ti&&Xn(d,o))return _[o]=2,d[o];if((E=e.propsOptions[0])&&Xn(E,o))return _[o]=3,m[o];if(a!==Ti&&Xn(a,o))return _[o]=4,a[o];ey&&(_[o]=0)}}const A=lg[o];let P,L;if(A)return o==="$attrs"&&mo(e,"get",o),A(e);if((P=s.__cssModules)&&(P=P[o]))return P;if(a!==Ti&&Xn(a,o))return _[o]=4,a[o];if(L=w.config.globalProperties,Xn(L,o))return L[o]},set({_:e},o,a){const{data:c,setupState:d,ctx:m}=e;return d!==Ti&&Xn(d,o)?(d[o]=a,!0):c!==Ti&&Xn(c,o)?(c[o]=a,!0):Xn(e.props,o)||o[0]==="$"&&o.slice(1)in e?!1:(m[o]=a,!0)},has({_:{data:e,setupState:o,accessCache:a,ctx:c,appContext:d,propsOptions:m}},_){let s;return!!a[_]||e!==Ti&&Xn(e,_)||o!==Ti&&Xn(o,_)||(s=m[0])&&Xn(s,_)||Xn(c,_)||Xn(lg,_)||Xn(d.config.globalProperties,_)},defineProperty(e,o,a){return a.get!=null?e._.accessCache[o]=0:Xn(a,"value")&&this.set(e,o,a.value,null),Reflect.defineProperty(e,o,a)}};let ey=!0;function GM(e){const o=c0(e),a=e.proxy,c=e.ctx;ey=!1,o.beforeCreate&&Gb(o.beforeCreate,e,"bc");const{data:d,computed:m,methods:_,watch:s,provide:w,inject:E,created:A,beforeMount:P,mounted:L,beforeUpdate:D,updated:N,activated:Z,deactivated:de,beforeDestroy:ne,beforeUnmount:ce,destroyed:K,unmounted:Se,render:Y,renderTracked:_e,renderTriggered:fe,errorCaptured:ve,serverPrefetch:Ee,expose:be,inheritAttrs:Re,components:ze,directives:Je,filters:ct}=o;if(E&&qM(E,c,null,e.appContext.config.unwrapInjectedRef),_)for(const Pe in _){const at=_[Pe];On(at)&&(c[Pe]=at.bind(a))}if(d){const Pe=d.call(a,a);Ri(Pe)&&(e.data=$i(Pe))}if(ey=!0,m)for(const Pe in m){const at=m[Pe],Gt=On(at)?at.bind(a,a):On(at.get)?at.get.bind(a,a):ss,pt=!On(at)&&On(at.set)?at.set.bind(a):ss,Lt=ie({get:Gt,set:pt});Object.defineProperty(c,Pe,{enumerable:!0,configurable:!0,get:()=>Lt.value,set:qt=>Lt.value=qt})}if(s)for(const Pe in s)RE(s[Pe],c,a,Pe);if(w){const Pe=On(w)?w.call(a):w;Reflect.ownKeys(Pe).forEach(at=>{Wi(at,Pe[at])})}A&&Gb(A,e,"c");function ft(Pe,at){xn(at)?at.forEach(Gt=>Pe(Gt.bind(a))):at&&Pe(at.bind(a))}if(ft(Rg,P),ft(zn,L),ft(ME,D),ft(PE,N),ft(IE,Z),ft(AE,de),ft(VM,ve),ft(FM,_e),ft(OM,fe),ft(Ai,ce),ft(gr,Se),ft(BM,Ee),xn(be))if(be.length){const Pe=e.exposed||(e.exposed={});be.forEach(at=>{Object.defineProperty(Pe,at,{get:()=>a[at],set:Gt=>a[at]=Gt})})}else e.exposed||(e.exposed={});Y&&e.render===ss&&(e.render=Y),Re!=null&&(e.inheritAttrs=Re),ze&&(e.components=ze),Je&&(e.directives=Je)}function qM(e,o,a=ss,c=!1){xn(e)&&(e=ty(e));for(const d in e){const m=e[d];let _;Ri(m)?"default"in m?_=cn(m.from||d,m.default,!0):_=cn(m.from||d):_=cn(m),zi(_)&&c?Object.defineProperty(o,d,{enumerable:!0,configurable:!0,get:()=>_.value,set:s=>_.value=s}):o[d]=_}}function Gb(e,o,a){Po(xn(e)?e.map(c=>c.bind(o.proxy)):e.bind(o.proxy),o,a)}function RE(e,o,a,c){const d=c.includes(".")?SE(a,c):()=>a[c];if(rr(e)){const m=o[e];On(m)&&Ke(d,m)}else if(On(e))Ke(d,e.bind(a));else if(Ri(e))if(xn(e))e.forEach(m=>RE(m,o,a,c));else{const m=On(e.handler)?e.handler.bind(a):o[e.handler];On(m)&&Ke(d,m,e)}}function c0(e){const o=e.type,{mixins:a,extends:c}=o,{mixins:d,optionsCache:m,config:{optionMergeStrategies:_}}=e.appContext,s=m.get(o);let w;return s?w=s:!d.length&&!a&&!c?w=o:(w={},d.length&&d.forEach(E=>cg(w,E,_,!0)),cg(w,o,_)),Ri(o)&&m.set(o,w),w}function cg(e,o,a,c=!1){const{mixins:d,extends:m}=o;m&&cg(e,m,a,!0),d&&d.forEach(_=>cg(e,_,a,!0));for(const _ in o)if(!(c&&_==="expose")){const s=ZM[_]||a&&a[_];e[_]=s?s(e[_],o[_]):o[_]}return e}const ZM={data:qb,props:xc,emits:xc,methods:xc,computed:xc,beforeCreate:Hr,created:Hr,beforeMount:Hr,mounted:Hr,beforeUpdate:Hr,updated:Hr,beforeDestroy:Hr,beforeUnmount:Hr,destroyed:Hr,unmounted:Hr,activated:Hr,deactivated:Hr,errorCaptured:Hr,serverPrefetch:Hr,components:xc,directives:xc,watch:HM,provide:qb,inject:WM};function qb(e,o){return o?e?function(){return Cr(On(e)?e.call(this,this):e,On(o)?o.call(this,this):o)}:o:e}function WM(e,o){return xc(ty(e),ty(o))}function ty(e){if(xn(e)){const o={};for(let a=0;a<e.length;a++)o[e[a]]=e[a];return o}return e}function Hr(e,o){return e?[...new Set([].concat(e,o))]:o}function xc(e,o){return e?Cr(Cr(Object.create(null),e),o):o}function HM(e,o){if(!e)return o;if(!o)return e;const a=Cr(Object.create(null),e);for(const c in o)a[c]=Hr(e[c],o[c]);return a}function XM(e,o,a,c=!1){const d={},m={};rg(m,Dg,1),e.propsDefaults=Object.create(null),DE(e,o,d,m);for(const _ in e.propsOptions[0])_ in d||(d[_]=void 0);a?e.props=c?d:lE(d):e.type.props?e.props=d:e.props=m,e.attrs=m}function YM(e,o,a,c){const{props:d,attrs:m,vnode:{patchFlag:_}}=e,s=Yn(d),[w]=e.propsOptions;let E=!1;if((c||_>0)&&!(_&16)){if(_&8){const A=e.vnode.dynamicProps;for(let P=0;P<A.length;P++){let L=A[P];if(Pg(e.emitsOptions,L))continue;const D=o[L];if(w)if(Xn(m,L))D!==m[L]&&(m[L]=D,E=!0);else{const N=Bo(L);d[N]=ny(w,s,N,D,e,!1)}else D!==m[L]&&(m[L]=D,E=!0)}}}else{DE(e,o,d,m)&&(E=!0);let A;for(const P in s)(!o||!Xn(o,P)&&((A=ph(P))===P||!Xn(o,A)))&&(w?a&&(a[P]!==void 0||a[A]!==void 0)&&(d[P]=ny(w,s,P,void 0,e,!0)):delete d[P]);if(m!==s)for(const P in m)(!o||!Xn(o,P)&&!0)&&(delete m[P],E=!0)}E&&ga(e,"set","$attrs")}function DE(e,o,a,c){const[d,m]=e.propsOptions;let _=!1,s;if(o)for(let w in o){if(Ym(w))continue;const E=o[w];let A;d&&Xn(d,A=Bo(w))?!m||!m.includes(A)?a[A]=E:(s||(s={}))[A]=E:Pg(e.emitsOptions,w)||(!(w in c)||E!==c[w])&&(c[w]=E,_=!0)}if(m){const w=Yn(a),E=s||Ti;for(let A=0;A<m.length;A++){const P=m[A];a[P]=ny(d,w,P,E[P],e,!Xn(E,P))}}return _}function ny(e,o,a,c,d,m){const _=e[a];if(_!=null){const s=Xn(_,"default");if(s&&c===void 0){const w=_.default;if(_.type!==Function&&On(w)){const{propsDefaults:E}=d;a in E?c=E[a]:(uh(d),c=E[a]=w.call(null,o),Mc())}else c=w}_[0]&&(m&&!s?c=!1:_[1]&&(c===""||c===ph(a))&&(c=!0))}return c}function BE(e,o,a=!1){const c=o.propsCache,d=c.get(e);if(d)return d;const m=e.props,_={},s=[];let w=!1;if(!On(e)){const A=P=>{w=!0;const[L,D]=BE(P,o,!0);Cr(_,L),D&&s.push(...D)};!a&&o.mixins.length&&o.mixins.forEach(A),e.extends&&A(e.extends),e.mixins&&e.mixins.forEach(A)}if(!m&&!w)return Ri(e)&&c.set(e,rh),rh;if(xn(m))for(let A=0;A<m.length;A++){const P=Bo(m[A]);Zb(P)&&(_[P]=Ti)}else if(m)for(const A in m){const P=Bo(A);if(Zb(P)){const L=m[A],D=_[P]=xn(L)||On(L)?{type:L}:L;if(D){const N=Xb(Boolean,D.type),Z=Xb(String,D.type);D[0]=N>-1,D[1]=Z<0||N<Z,(N>-1||Xn(D,"default"))&&s.push(P)}}}const E=[_,s];return Ri(e)&&c.set(e,E),E}function Zb(e){return e[0]!=="$"}function Wb(e){const o=e&&e.toString().match(/^\s*function (\w+)/);return o?o[1]:e===null?"null":""}function Hb(e,o){return Wb(e)===Wb(o)}function Xb(e,o){return xn(o)?o.findIndex(a=>Hb(a,e)):On(o)&&Hb(o,e)?0:-1}const OE=e=>e[0]==="_"||e==="$stable",u0=e=>xn(e)?e.map(Rs):[Rs(e)],KM=(e,o,a)=>{if(o._n)return o;const c=wn((...d)=>u0(o(...d)),a);return c._c=!1,c},FE=(e,o,a)=>{const c=e._ctx;for(const d in e){if(OE(d))continue;const m=e[d];if(On(m))o[d]=KM(d,m,c);else if(m!=null){const _=u0(m);o[d]=()=>_}}},VE=(e,o)=>{const a=u0(o);e.slots.default=()=>a},JM=(e,o)=>{if(e.vnode.shapeFlag&32){const a=o._;a?(e.slots=Yn(o),rg(o,"_",a)):FE(o,e.slots={})}else e.slots={},o&&VE(e,o);rg(e.slots,Dg,1)},QM=(e,o,a)=>{const{vnode:c,slots:d}=e;let m=!0,_=Ti;if(c.shapeFlag&32){const s=o._;s?a&&s===1?m=!1:(Cr(d,o),!a&&s===1&&delete d._):(m=!o.$stable,FE(o,d)),_=o}else o&&(VE(e,o),_={default:1});if(m)for(const s in d)!OE(s)&&!(s in _)&&delete d[s]};function $E(){return{app:null,config:{isNativeTag:zk,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let eP=0;function tP(e,o){return function(c,d=null){On(c)||(c=Object.assign({},c)),d!=null&&!Ri(d)&&(d=null);const m=$E(),_=new Set;let s=!1;const w=m.app={_uid:eP++,_component:c,_props:d,_container:null,_context:m,_instance:null,version:wP,get config(){return m.config},set config(E){},use(E,...A){return _.has(E)||(E&&On(E.install)?(_.add(E),E.install(w,...A)):On(E)&&(_.add(E),E(w,...A))),w},mixin(E){return m.mixins.includes(E)||m.mixins.push(E),w},component(E,A){return A?(m.components[E]=A,w):m.components[E]},directive(E,A){return A?(m.directives[E]=A,w):m.directives[E]},mount(E,A,P){if(!s){const L=F(c,d);return L.appContext=m,A&&o?o(L,E):e(L,E,P),s=!0,w._container=E,E.__vue_app__=w,Og(L.component)||L.component.proxy}},unmount(){s&&(e(null,w._container),delete w._container.__vue_app__)},provide(E,A){return m.provides[E]=A,w}};return w}}function iy(e,o,a,c,d=!1){if(xn(e)){e.forEach((L,D)=>iy(L,o&&(xn(o)?o[D]:o),a,c,d));return}if(ff(c)&&!d)return;const m=c.shapeFlag&4?Og(c.component)||c.component.proxy:c.el,_=d?null:m,{i:s,r:w}=e,E=o&&o.r,A=s.refs===Ti?s.refs={}:s.refs,P=s.setupState;if(E!=null&&E!==w&&(rr(E)?(A[E]=null,Xn(P,E)&&(P[E]=null)):zi(E)&&(E.value=null)),On(w))pa(w,s,12,[_,A]);else{const L=rr(w),D=zi(w);if(L||D){const N=()=>{if(e.f){const Z=L?Xn(P,w)?P[w]:A[w]:w.value;d?xn(Z)&&Zy(Z,m):xn(Z)?Z.includes(m)||Z.push(m):L?(A[w]=[m],Xn(P,w)&&(P[w]=A[w])):(w.value=[m],e.k&&(A[e.k]=w.value))}else L?(A[w]=_,Xn(P,w)&&(P[w]=_)):D&&(w.value=_,e.k&&(A[e.k]=_))};_?(N.id=-1,ro(N,a)):N()}}}const ro=zM;function nP(e){return iP(e)}function iP(e,o){const a=Fk();a.__VUE__=!0;const{insert:c,remove:d,patchProp:m,createElement:_,createText:s,createComment:w,setText:E,setElementText:A,parentNode:P,nextSibling:L,setScopeId:D=ss,insertStaticContent:N}=e,Z=(he,Me,qe,st=null,yt=null,Rt=null,$t=!1,Pt=null,Ft=!!Me.dynamicChildren)=>{if(he===Me)return;he&&!wc(he,Me)&&(st=Tt(he),qt(he,yt,Rt,!0),he=null),Me.patchFlag===-2&&(Ft=!1,Me.dynamicChildren=null);const{type:St,ref:Jt,shapeFlag:Wt}=Me;switch(St){case d0:de(he,Me,qe,st);break;case Lo:ne(he,Me,qe,st);break;case E_:he==null&&ce(Me,qe,st,$t);break;case Dn:ze(he,Me,qe,st,yt,Rt,$t,Pt,Ft);break;default:Wt&1?Y(he,Me,qe,st,yt,Rt,$t,Pt,Ft):Wt&6?Je(he,Me,qe,st,yt,Rt,$t,Pt,Ft):(Wt&64||Wt&128)&&St.process(he,Me,qe,st,yt,Rt,$t,Pt,Ft,pn)}Jt!=null&&yt&&iy(Jt,he&&he.ref,Rt,Me||he,!Me)},de=(he,Me,qe,st)=>{if(he==null)c(Me.el=s(Me.children),qe,st);else{const yt=Me.el=he.el;Me.children!==he.children&&E(yt,Me.children)}},ne=(he,Me,qe,st)=>{he==null?c(Me.el=w(Me.children||""),qe,st):Me.el=he.el},ce=(he,Me,qe,st)=>{[he.el,he.anchor]=N(he.children,Me,qe,st,he.el,he.anchor)},K=({el:he,anchor:Me},qe,st)=>{let yt;for(;he&&he!==Me;)yt=L(he),c(he,qe,st),he=yt;c(Me,qe,st)},Se=({el:he,anchor:Me})=>{let qe;for(;he&&he!==Me;)qe=L(he),d(he),he=qe;d(Me)},Y=(he,Me,qe,st,yt,Rt,$t,Pt,Ft)=>{$t=$t||Me.type==="svg",he==null?_e(Me,qe,st,yt,Rt,$t,Pt,Ft):Ee(he,Me,yt,Rt,$t,Pt,Ft)},_e=(he,Me,qe,st,yt,Rt,$t,Pt)=>{let Ft,St;const{type:Jt,props:Wt,shapeFlag:on,transition:fn,dirs:In}=he;if(Ft=he.el=_(he.type,Rt,Wt&&Wt.is,Wt),on&8?A(Ft,he.children):on&16&&ve(he.children,Ft,null,st,yt,Rt&&Jt!=="foreignObject",$t,Pt),In&&mc(he,null,st,"created"),Wt){for(const qn in Wt)qn!=="value"&&!Ym(qn)&&m(Ft,qn,null,Wt[qn],Rt,he.children,st,yt,bt);"value"in Wt&&m(Ft,"value",null,Wt.value),(St=Wt.onVnodeBeforeMount)&&zs(St,st,he)}fe(Ft,he,he.scopeId,$t,st),In&&mc(he,null,st,"beforeMount");const Gn=(!yt||yt&&!yt.pendingBranch)&&fn&&!fn.persisted;Gn&&fn.beforeEnter(Ft),c(Ft,Me,qe),((St=Wt&&Wt.onVnodeMounted)||Gn||In)&&ro(()=>{St&&zs(St,st,he),Gn&&fn.enter(Ft),In&&mc(he,null,st,"mounted")},yt)},fe=(he,Me,qe,st,yt)=>{if(qe&&D(he,qe),st)for(let Rt=0;Rt<st.length;Rt++)D(he,st[Rt]);if(yt){let Rt=yt.subTree;if(Me===Rt){const $t=yt.vnode;fe(he,$t,$t.scopeId,$t.slotScopeIds,yt.parent)}}},ve=(he,Me,qe,st,yt,Rt,$t,Pt,Ft=0)=>{for(let St=Ft;St<he.length;St++){const Jt=he[St]=Pt?hl(he[St]):Rs(he[St]);Z(null,Jt,Me,qe,st,yt,Rt,$t,Pt)}},Ee=(he,Me,qe,st,yt,Rt,$t)=>{const Pt=Me.el=he.el;let{patchFlag:Ft,dynamicChildren:St,dirs:Jt}=Me;Ft|=he.patchFlag&16;const Wt=he.props||Ti,on=Me.props||Ti;let fn;qe&&gc(qe,!1),(fn=on.onVnodeBeforeUpdate)&&zs(fn,qe,Me,he),Jt&&mc(Me,he,qe,"beforeUpdate"),qe&&gc(qe,!0);const In=yt&&Me.type!=="foreignObject";if(St?be(he.dynamicChildren,St,Pt,qe,st,In,Rt):$t||at(he,Me,Pt,null,qe,st,In,Rt,!1),Ft>0){if(Ft&16)Re(Pt,Me,Wt,on,qe,st,yt);else if(Ft&2&&Wt.class!==on.class&&m(Pt,"class",null,on.class,yt),Ft&4&&m(Pt,"style",Wt.style,on.style,yt),Ft&8){const Gn=Me.dynamicProps;for(let qn=0;qn<Gn.length;qn++){const _i=Gn[qn],or=Wt[_i],Ki=on[_i];(Ki!==or||_i==="value")&&m(Pt,_i,or,Ki,yt,he.children,qe,st,bt)}}Ft&1&&he.children!==Me.children&&A(Pt,Me.children)}else!$t&&St==null&&Re(Pt,Me,Wt,on,qe,st,yt);((fn=on.onVnodeUpdated)||Jt)&&ro(()=>{fn&&zs(fn,qe,Me,he),Jt&&mc(Me,he,qe,"updated")},st)},be=(he,Me,qe,st,yt,Rt,$t)=>{for(let Pt=0;Pt<Me.length;Pt++){const Ft=he[Pt],St=Me[Pt],Jt=Ft.el&&(Ft.type===Dn||!wc(Ft,St)||Ft.shapeFlag&70)?P(Ft.el):qe;Z(Ft,St,Jt,null,st,yt,Rt,$t,!0)}},Re=(he,Me,qe,st,yt,Rt,$t)=>{if(qe!==st){if(qe!==Ti)for(const Pt in qe)!Ym(Pt)&&!(Pt in st)&&m(he,Pt,qe[Pt],null,$t,Me.children,yt,Rt,bt);for(const Pt in st){if(Ym(Pt))continue;const Ft=st[Pt],St=qe[Pt];Ft!==St&&Pt!=="value"&&m(he,Pt,St,Ft,$t,Me.children,yt,Rt,bt)}"value"in st&&m(he,"value",qe.value,st.value)}},ze=(he,Me,qe,st,yt,Rt,$t,Pt,Ft)=>{const St=Me.el=he?he.el:s(""),Jt=Me.anchor=he?he.anchor:s("");let{patchFlag:Wt,dynamicChildren:on,slotScopeIds:fn}=Me;fn&&(Pt=Pt?Pt.concat(fn):fn),he==null?(c(St,qe,st),c(Jt,qe,st),ve(Me.children,qe,Jt,yt,Rt,$t,Pt,Ft)):Wt>0&&Wt&64&&on&&he.dynamicChildren?(be(he.dynamicChildren,on,qe,yt,Rt,$t,Pt),(Me.key!=null||yt&&Me===yt.subTree)&&h0(he,Me,!0)):at(he,Me,qe,Jt,yt,Rt,$t,Pt,Ft)},Je=(he,Me,qe,st,yt,Rt,$t,Pt,Ft)=>{Me.slotScopeIds=Pt,he==null?Me.shapeFlag&512?yt.ctx.activate(Me,qe,st,$t,Ft):ct(Me,qe,st,yt,Rt,$t,Ft):nt(he,Me,Ft)},ct=(he,Me,qe,st,yt,Rt,$t)=>{const Pt=he.component=pP(he,st,yt);if(zg(he)&&(Pt.ctx.renderer=pn),mP(Pt),Pt.asyncDep){if(yt&&yt.registerDep(Pt,ft),!he.el){const Ft=Pt.subTree=F(Lo);ne(null,Ft,Me,qe)}return}ft(Pt,he,Me,qe,yt,Rt,$t)},nt=(he,Me,qe)=>{const st=Me.component=he.component;if(kM(he,Me,qe))if(st.asyncDep&&!st.asyncResolved){Pe(st,Me,qe);return}else st.next=Me,SM(st.update),st.update();else Me.el=he.el,st.vnode=Me},ft=(he,Me,qe,st,yt,Rt,$t)=>{const Pt=()=>{if(he.isMounted){let{next:Jt,bu:Wt,u:on,parent:fn,vnode:In}=he,Gn=Jt,qn;gc(he,!1),Jt?(Jt.el=In.el,Pe(he,Jt,$t)):Jt=In,Wt&&Jm(Wt),(qn=Jt.props&&Jt.props.onVnodeBeforeUpdate)&&zs(qn,fn,Jt,In),gc(he,!0);const _i=b_(he),or=he.subTree;he.subTree=_i,Z(or,_i,P(or.el),Tt(or),he,yt,Rt),Jt.el=_i.el,Gn===null&&MM(he,_i.el),on&&ro(on,yt),(qn=Jt.props&&Jt.props.onVnodeUpdated)&&ro(()=>zs(qn,fn,Jt,In),yt)}else{let Jt;const{el:Wt,props:on}=Me,{bm:fn,m:In,parent:Gn}=he,qn=ff(Me);if(gc(he,!1),fn&&Jm(fn),!qn&&(Jt=on&&on.onVnodeBeforeMount)&&zs(Jt,Gn,Me),gc(he,!0),Wt&&_n){const _i=()=>{he.subTree=b_(he),_n(Wt,he.subTree,he,yt,null)};qn?Me.type.__asyncLoader().then(()=>!he.isUnmounted&&_i()):_i()}else{const _i=he.subTree=b_(he);Z(null,_i,qe,st,he,yt,Rt),Me.el=_i.el}if(In&&ro(In,yt),!qn&&(Jt=on&&on.onVnodeMounted)){const _i=Me;ro(()=>zs(Jt,Gn,_i),yt)}(Me.shapeFlag&256||Gn&&ff(Gn.vnode)&&Gn.vnode.shapeFlag&256)&&he.a&&ro(he.a,yt),he.isMounted=!0,Me=qe=st=null}},Ft=he.effect=new Yy(Pt,()=>r0(St),he.scope),St=he.update=()=>Ft.run();St.id=he.uid,gc(he,!0),St()},Pe=(he,Me,qe)=>{Me.component=he;const st=he.vnode.props;he.vnode=Me,he.next=null,YM(he,Me.props,st,qe),QM(he,Me.children,qe),Bc(),Vb(),Oc()},at=(he,Me,qe,st,yt,Rt,$t,Pt,Ft=!1)=>{const St=he&&he.children,Jt=he?he.shapeFlag:0,Wt=Me.children,{patchFlag:on,shapeFlag:fn}=Me;if(on>0){if(on&128){pt(St,Wt,qe,st,yt,Rt,$t,Pt,Ft);return}else if(on&256){Gt(St,Wt,qe,st,yt,Rt,$t,Pt,Ft);return}}fn&8?(Jt&16&&bt(St,yt,Rt),Wt!==St&&A(qe,Wt)):Jt&16?fn&16?pt(St,Wt,qe,st,yt,Rt,$t,Pt,Ft):bt(St,yt,Rt,!0):(Jt&8&&A(qe,""),fn&16&&ve(Wt,qe,st,yt,Rt,$t,Pt,Ft))},Gt=(he,Me,qe,st,yt,Rt,$t,Pt,Ft)=>{he=he||rh,Me=Me||rh;const St=he.length,Jt=Me.length,Wt=Math.min(St,Jt);let on;for(on=0;on<Wt;on++){const fn=Me[on]=Ft?hl(Me[on]):Rs(Me[on]);Z(he[on],fn,qe,null,yt,Rt,$t,Pt,Ft)}St>Jt?bt(he,yt,Rt,!0,!1,Wt):ve(Me,qe,st,yt,Rt,$t,Pt,Ft,Wt)},pt=(he,Me,qe,st,yt,Rt,$t,Pt,Ft)=>{let St=0;const Jt=Me.length;let Wt=he.length-1,on=Jt-1;for(;St<=Wt&&St<=on;){const fn=he[St],In=Me[St]=Ft?hl(Me[St]):Rs(Me[St]);if(wc(fn,In))Z(fn,In,qe,null,yt,Rt,$t,Pt,Ft);else break;St++}for(;St<=Wt&&St<=on;){const fn=he[Wt],In=Me[on]=Ft?hl(Me[on]):Rs(Me[on]);if(wc(fn,In))Z(fn,In,qe,null,yt,Rt,$t,Pt,Ft);else break;Wt--,on--}if(St>Wt){if(St<=on){const fn=on+1,In=fn<Jt?Me[fn].el:st;for(;St<=on;)Z(null,Me[St]=Ft?hl(Me[St]):Rs(Me[St]),qe,In,yt,Rt,$t,Pt,Ft),St++}}else if(St>on)for(;St<=Wt;)qt(he[St],yt,Rt,!0),St++;else{const fn=St,In=St,Gn=new Map;for(St=In;St<=on;St++){const nr=Me[St]=Ft?hl(Me[St]):Rs(Me[St]);nr.key!=null&&Gn.set(nr.key,St)}let qn,_i=0;const or=on-In+1;let Ki=!1,ds=0;const Lr=new Array(or);for(St=0;St<or;St++)Lr[St]=0;for(St=fn;St<=Wt;St++){const nr=he[St];if(_i>=or){qt(nr,yt,Rt,!0);continue}let ur;if(nr.key!=null)ur=Gn.get(nr.key);else for(qn=In;qn<=on;qn++)if(Lr[qn-In]===0&&wc(nr,Me[qn])){ur=qn;break}ur===void 0?qt(nr,yt,Rt,!0):(Lr[ur-In]=St+1,ur>=ds?ds=ur:Ki=!0,Z(nr,Me[ur],qe,null,yt,Rt,$t,Pt,Ft),_i++)}const yo=Ki?rP(Lr):rh;for(qn=yo.length-1,St=or-1;St>=0;St--){const nr=In+St,ur=Me[nr],jo=nr+1<Jt?Me[nr+1].el:st;Lr[St]===0?Z(null,ur,qe,jo,yt,Rt,$t,Pt,Ft):Ki&&(qn<0||St!==yo[qn]?Lt(ur,qe,jo,2):qn--)}}},Lt=(he,Me,qe,st,yt=null)=>{const{el:Rt,type:$t,transition:Pt,children:Ft,shapeFlag:St}=he;if(St&6){Lt(he.component.subTree,Me,qe,st);return}if(St&128){he.suspense.move(Me,qe,st);return}if(St&64){$t.move(he,Me,qe,pn);return}if($t===Dn){c(Rt,Me,qe);for(let Wt=0;Wt<Ft.length;Wt++)Lt(Ft[Wt],Me,qe,st);c(he.anchor,Me,qe);return}if($t===E_){K(he,Me,qe);return}if(st!==2&&St&1&&Pt)if(st===0)Pt.beforeEnter(Rt),c(Rt,Me,qe),ro(()=>Pt.enter(Rt),yt);else{const{leave:Wt,delayLeave:on,afterLeave:fn}=Pt,In=()=>c(Rt,Me,qe),Gn=()=>{Wt(Rt,()=>{In(),fn&&fn()})};on?on(Rt,In,Gn):Gn()}else c(Rt,Me,qe)},qt=(he,Me,qe,st=!1,yt=!1)=>{const{type:Rt,props:$t,ref:Pt,children:Ft,dynamicChildren:St,shapeFlag:Jt,patchFlag:Wt,dirs:on}=he;if(Pt!=null&&iy(Pt,null,qe,he,!0),Jt&256){Me.ctx.deactivate(he);return}const fn=Jt&1&&on,In=!ff(he);let Gn;if(In&&(Gn=$t&&$t.onVnodeBeforeUnmount)&&zs(Gn,Me,he),Jt&6)Qe(he.component,qe,st);else{if(Jt&128){he.suspense.unmount(qe,st);return}fn&&mc(he,null,Me,"beforeUnmount"),Jt&64?he.type.remove(he,Me,qe,yt,pn,st):St&&(Rt!==Dn||Wt>0&&Wt&64)?bt(St,Me,qe,!1,!0):(Rt===Dn&&Wt&384||!yt&&Jt&16)&&bt(Ft,Me,qe),st&&Bn(he)}(In&&(Gn=$t&&$t.onVnodeUnmounted)||fn)&&ro(()=>{Gn&&zs(Gn,Me,he),fn&&mc(he,null,Me,"unmounted")},qe)},Bn=he=>{const{type:Me,el:qe,anchor:st,transition:yt}=he;if(Me===Dn){kt(qe,st);return}if(Me===E_){Se(he);return}const Rt=()=>{d(qe),yt&&!yt.persisted&&yt.afterLeave&&yt.afterLeave()};if(he.shapeFlag&1&&yt&&!yt.persisted){const{leave:$t,delayLeave:Pt}=yt,Ft=()=>$t(qe,Rt);Pt?Pt(he.el,Rt,Ft):Ft()}else Rt()},kt=(he,Me)=>{let qe;for(;he!==Me;)qe=L(he),d(he),he=qe;d(Me)},Qe=(he,Me,qe)=>{const{bum:st,scope:yt,update:Rt,subTree:$t,um:Pt}=he;st&&Jm(st),yt.stop(),Rt&&(Rt.active=!1,qt($t,he,Me,qe)),Pt&&ro(Pt,Me),ro(()=>{he.isUnmounted=!0},Me),Me&&Me.pendingBranch&&!Me.isUnmounted&&he.asyncDep&&!he.asyncResolved&&he.suspenseId===Me.pendingId&&(Me.deps--,Me.deps===0&&Me.resolve())},bt=(he,Me,qe,st=!1,yt=!1,Rt=0)=>{for(let $t=Rt;$t<he.length;$t++)qt(he[$t],Me,qe,st,yt)},Tt=he=>he.shapeFlag&6?Tt(he.component.subTree):he.shapeFlag&128?he.suspense.next():L(he.anchor||he.el),Ut=(he,Me,qe)=>{he==null?Me._vnode&&qt(Me._vnode,null,null,!0):Z(Me._vnode||null,he,Me,null,null,null,qe),Vb(),yE(),Me._vnode=he},pn={p:Z,um:qt,m:Lt,r:Bn,mt:ct,mc:ve,pc:at,pbc:be,n:Tt,o:e};let Fn,_n;return o&&([Fn,_n]=o(pn)),{render:Ut,hydrate:Fn,createApp:tP(Ut,Fn)}}function gc({effect:e,update:o},a){e.allowRecurse=o.allowRecurse=a}function h0(e,o,a=!1){const c=e.children,d=o.children;if(xn(c)&&xn(d))for(let m=0;m<c.length;m++){const _=c[m];let s=d[m];s.shapeFlag&1&&!s.dynamicChildren&&((s.patchFlag<=0||s.patchFlag===32)&&(s=d[m]=hl(d[m]),s.el=_.el),a||h0(_,s))}}function rP(e){const o=e.slice(),a=[0];let c,d,m,_,s;const w=e.length;for(c=0;c<w;c++){const E=e[c];if(E!==0){if(d=a[a.length-1],e[d]<E){o[c]=d,a.push(c);continue}for(m=0,_=a.length-1;m<_;)s=m+_>>1,e[a[s]]<E?m=s+1:_=s;E<e[a[m]]&&(m>0&&(o[c]=a[m-1]),a[m]=c)}}for(m=a.length,_=a[m-1];m-- >0;)a[m]=_,_=o[_];return a}const oP=e=>e.__isTeleport,pf=e=>e&&(e.disabled||e.disabled===""),Yb=e=>typeof SVGElement<"u"&&e instanceof SVGElement,ry=(e,o)=>{const a=e&&e.to;return rr(a)?o?o(a):null:a},sP={__isTeleport:!0,process(e,o,a,c,d,m,_,s,w,E){const{mc:A,pc:P,pbc:L,o:{insert:D,querySelector:N,createText:Z,createComment:de}}=E,ne=pf(o.props);let{shapeFlag:ce,children:K,dynamicChildren:Se}=o;if(e==null){const Y=o.el=Z(""),_e=o.anchor=Z("");D(Y,a,c),D(_e,a,c);const fe=o.target=ry(o.props,N),ve=o.targetAnchor=Z("");fe&&(D(ve,fe),_=_||Yb(fe));const Ee=(be,Re)=>{ce&16&&A(K,be,Re,d,m,_,s,w)};ne?Ee(a,_e):fe&&Ee(fe,ve)}else{o.el=e.el;const Y=o.anchor=e.anchor,_e=o.target=e.target,fe=o.targetAnchor=e.targetAnchor,ve=pf(e.props),Ee=ve?a:_e,be=ve?Y:fe;if(_=_||Yb(_e),Se?(L(e.dynamicChildren,Se,Ee,d,m,_,s),h0(e,o,!0)):w||P(e,o,Ee,be,d,m,_,s,!1),ne)ve||jm(o,a,Y,E,1);else if((o.props&&o.props.to)!==(e.props&&e.props.to)){const Re=o.target=ry(o.props,N);Re&&jm(o,Re,null,E,0)}else ve&&jm(o,_e,fe,E,1)}},remove(e,o,a,c,{um:d,o:{remove:m}},_){const{shapeFlag:s,children:w,anchor:E,targetAnchor:A,target:P,props:L}=e;if(P&&m(A),(_||!pf(L))&&(m(E),s&16))for(let D=0;D<w.length;D++){const N=w[D];d(N,o,a,!0,!!N.dynamicChildren)}},move:jm,hydrate:aP};function jm(e,o,a,{o:{insert:c},m:d},m=2){m===0&&c(e.targetAnchor,o,a);const{el:_,anchor:s,shapeFlag:w,children:E,props:A}=e,P=m===2;if(P&&c(_,o,a),(!P||pf(A))&&w&16)for(let L=0;L<E.length;L++)d(E[L],o,a,2);P&&c(s,o,a)}function aP(e,o,a,c,d,m,{o:{nextSibling:_,parentNode:s,querySelector:w}},E){const A=o.target=ry(o.props,w);if(A){const P=A._lpa||A.firstChild;if(o.shapeFlag&16)if(pf(o.props))o.anchor=E(_(e),o,s(e),a,c,d,m),o.targetAnchor=P;else{o.anchor=_(e);let L=P;for(;L;)if(L=_(L),L&&L.nodeType===8&&L.data==="teleport anchor"){o.targetAnchor=L,A._lpa=o.targetAnchor&&_(o.targetAnchor);break}E(P,o,A,a,c,d,m)}}return o.anchor&&_(o.anchor)}const lP=sP,Dn=Symbol(void 0),d0=Symbol(void 0),Lo=Symbol(void 0),E_=Symbol(void 0),mf=[];let rs=null;function fi(e=!1){mf.push(rs=e?null:[])}function cP(){mf.pop(),rs=mf[mf.length-1]||null}let Af=1;function Kb(e){Af+=e}function NE(e){return e.dynamicChildren=Af>0?rs||rh:null,cP(),Af>0&&rs&&rs.push(e),e}function oo(e,o,a,c,d,m){return NE(va(e,o,a,c,d,m,!0))}function Mr(e,o,a,c,d){return NE(F(e,o,a,c,d,!0))}function ug(e){return e?e.__v_isVNode===!0:!1}function wc(e,o){return e.type===o.type&&e.key===o.key}const Dg="__vInternal",UE=({key:e})=>e!=null?e:null,Qm=({ref:e,ref_key:o,ref_for:a})=>e!=null?rr(e)||zi(e)||On(e)?{i:jr,r:e,k:o,f:!!a}:e:null;function va(e,o=null,a=null,c=0,d=null,m=e===Dn?0:1,_=!1,s=!1){const w={__v_isVNode:!0,__v_skip:!0,type:e,props:o,key:o&&UE(o),ref:o&&Qm(o),scopeId:wE,slotScopeIds:null,children:a,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:m,patchFlag:c,dynamicProps:d,dynamicChildren:null,appContext:null};return s?(f0(w,a),m&128&&e.normalize(w)):a&&(w.shapeFlag|=rr(a)?8:16),Af>0&&!_&&rs&&(w.patchFlag>0||m&6)&&w.patchFlag!==32&&rs.push(w),w}const F=uP;function uP(e,o=null,a=null,c=0,d=null,m=!1){if((!e||e===zE)&&(e=Lo),ug(e)){const s=_a(e,o,!0);return a&&f0(s,a),Af>0&&!m&&rs&&(s.shapeFlag&6?rs[rs.indexOf(e)]=s:rs.push(s)),s.patchFlag|=-2,s}if(bP(e)&&(e=e.__vccOpts),o){o=hP(o);let{class:s,style:w}=o;s&&!rr(s)&&(o.class=Gy(s)),Ri(w)&&(cE(w)&&!xn(w)&&(w=Cr({},w)),o.style=jy(w))}const _=rr(e)?1:PM(e)?128:oP(e)?64:Ri(e)?4:On(e)?2:0;return va(e,o,a,c,d,_,m,!0)}function hP(e){return e?cE(e)||Dg in e?Cr({},e):e:null}function _a(e,o,a=!1){const{props:c,ref:d,patchFlag:m,children:_}=e,s=o?tn(c||{},o):c;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:s,key:s&&UE(s),ref:o&&o.ref?a&&d?xn(d)?d.concat(Qm(o)):[d,Qm(o)]:Qm(o):d,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:_,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:o&&e.type!==Dn?m===-1?16:m|16:m,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&_a(e.ssContent),ssFallback:e.ssFallback&&_a(e.ssFallback),el:e.el,anchor:e.anchor}}function gl(e=" ",o=0){return F(d0,null,e,o)}function jE(e="",o=!1){return o?(fi(),Mr(Lo,null,e)):F(Lo,null,e)}function Rs(e){return e==null||typeof e=="boolean"?F(Lo):xn(e)?F(Dn,null,e.slice()):typeof e=="object"?hl(e):F(d0,null,String(e))}function hl(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:_a(e)}function f0(e,o){let a=0;const{shapeFlag:c}=e;if(o==null)o=null;else if(xn(o))a=16;else if(typeof o=="object")if(c&65){const d=o.default;d&&(d._c&&(d._d=!1),f0(e,d()),d._c&&(d._d=!0));return}else{a=32;const d=o._;!d&&!(Dg in o)?o._ctx=jr:d===3&&jr&&(jr.slots._===1?o._=1:(o._=2,e.patchFlag|=1024))}else On(o)?(o={default:o,_ctx:jr},a=32):(o=String(o),c&64?(a=16,o=[gl(o)]):a=8);e.children=o,e.shapeFlag|=a}function tn(...e){const o={};for(let a=0;a<e.length;a++){const c=e[a];for(const d in c)if(d==="class")o.class!==c.class&&(o.class=Gy([o.class,c.class]));else if(d==="style")o.style=jy([o.style,c.style]);else if(Cg(d)){const m=o[d],_=c[d];_&&m!==_&&!(xn(m)&&m.includes(_))&&(o[d]=m?[].concat(m,_):_)}else d!==""&&(o[d]=c[d])}return o}function zs(e,o,a,c=null){Po(e,o,7,[a,c])}const dP=$E();let fP=0;function pP(e,o,a){const c=e.type,d=(o?o.appContext:e.appContext)||dP,m={uid:fP++,vnode:e,type:c,parent:o,appContext:d,root:null,next:null,subTree:null,effect:null,update:null,scope:new KS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:o?o.provides:Object.create(d.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:BE(c,d),emitsOptions:bE(c,d),emit:null,emitted:null,propsDefaults:Ti,inheritAttrs:c.inheritAttrs,ctx:Ti,data:Ti,props:Ti,attrs:Ti,slots:Ti,refs:Ti,setupState:Ti,setupContext:null,suspense:a,suspenseId:a?a.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return m.ctx={_:m},m.root=o?o.root:m,m.emit=CM.bind(null,m),e.ce&&e.ce(m),m}let Tr=null;const Bg=()=>Tr||jr,uh=e=>{Tr=e,e.scope.on()},Mc=()=>{Tr&&Tr.scope.off(),Tr=null};function GE(e){return e.vnode.shapeFlag&4}let kf=!1;function mP(e,o=!1){kf=o;const{props:a,children:c}=e.vnode,d=GE(e);XM(e,a,d,o),JM(e,c);const m=d?gP(e,o):void 0;return kf=!1,m}function gP(e,o){const a=e.type;e.accessCache=Object.create(null),e.proxy=uE(new Proxy(e.ctx,jM));const{setup:c}=a;if(c){const d=e.setupContext=c.length>1?_P(e):null;uh(e),Bc();const m=pa(c,e,0,[e.props,d]);if(Oc(),Mc(),HS(m)){if(m.then(Mc,Mc),o)return m.then(_=>{Jb(e,_,o)}).catch(_=>{Mg(_,e,0)});e.asyncDep=m}else Jb(e,m,o)}else qE(e,o)}function Jb(e,o,a){On(o)?e.type.__ssrInlineRender?e.ssrRender=o:e.render=o:Ri(o)&&(e.setupState=pE(o)),qE(e,a)}let Qb;function qE(e,o,a){const c=e.type;if(!e.render){if(!o&&Qb&&!c.render){const d=c.template||c0(e).template;if(d){const{isCustomElement:m,compilerOptions:_}=e.appContext.config,{delimiters:s,compilerOptions:w}=c,E=Cr(Cr({isCustomElement:m,delimiters:s},_),w);c.render=Qb(d,E)}}e.render=c.render||ss}uh(e),Bc(),GM(e),Oc(),Mc()}function vP(e){return new Proxy(e.attrs,{get(o,a){return mo(e,"get","$attrs"),o[a]}})}function _P(e){const o=c=>{e.exposed=c||{}};let a;return{get attrs(){return a||(a=vP(e))},slots:e.slots,emit:e.emit,expose:o}}function Og(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(pE(uE(e.exposed)),{get(o,a){if(a in o)return o[a];if(a in lg)return lg[a](e)}}))}const yP=/(?:^|[-_])(\w)/g,xP=e=>e.replace(yP,o=>o.toUpperCase()).replace(/[-_]/g,"");function ZE(e,o=!0){return On(e)?e.displayName||e.name:e.name||o&&e.__name}function WE(e,o,a=!1){let c=ZE(o);if(!c&&o.__file){const d=o.__file.match(/([^/\\]+)\.\w+$/);d&&(c=d[1])}if(!c&&e&&e.parent){const d=m=>{for(const _ in m)if(m[_]===o)return _};c=d(e.components||e.parent.type.components)||d(e.appContext.components)}return c?xP(c):a?"App":"Anonymous"}function bP(e){return On(e)&&"__vccOpts"in e}const ie=(e,o)=>mM(e,o,kf);function $s(e,o,a){const c=arguments.length;return c===2?Ri(o)&&!xn(o)?ug(o)?F(e,null,[o]):F(e,o):F(e,null,o):(c>3?a=Array.prototype.slice.call(arguments,2):c===3&&ug(a)&&(a=[a]),F(e,o,a))}const wP="3.2.41",SP="http://www.w3.org/2000/svg",Sc=typeof document<"u"?document:null,ew=Sc&&Sc.createElement("template"),EP={insert:(e,o,a)=>{o.insertBefore(e,a||null)},remove:e=>{const o=e.parentNode;o&&o.removeChild(e)},createElement:(e,o,a,c)=>{const d=o?Sc.createElementNS(SP,e):Sc.createElement(e,a?{is:a}:void 0);return e==="select"&&c&&c.multiple!=null&&d.setAttribute("multiple",c.multiple),d},createText:e=>Sc.createTextNode(e),createComment:e=>Sc.createComment(e),setText:(e,o)=>{e.nodeValue=o},setElementText:(e,o)=>{e.textContent=o},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Sc.querySelector(e),setScopeId(e,o){e.setAttribute(o,"")},insertStaticContent(e,o,a,c,d,m){const _=a?a.previousSibling:o.lastChild;if(d&&(d===m||d.nextSibling))for(;o.insertBefore(d.cloneNode(!0),a),!(d===m||!(d=d.nextSibling)););else{ew.innerHTML=c?`<svg>${e}</svg>`:e;const s=ew.content;if(c){const w=s.firstChild;for(;w.firstChild;)s.appendChild(w.firstChild);s.removeChild(w)}o.insertBefore(s,a)}return[_?_.nextSibling:o.firstChild,a?a.previousSibling:o.lastChild]}};function TP(e,o,a){const c=e._vtc;c&&(o=(o?[o,...c]:[...c]).join(" ")),o==null?e.removeAttribute("class"):a?e.setAttribute("class",o):e.className=o}function CP(e,o,a){const c=e.style,d=rr(a);if(a&&!d){for(const m in a)oy(c,m,a[m]);if(o&&!rr(o))for(const m in o)a[m]==null&&oy(c,m,"")}else{const m=c.display;d?o!==a&&(c.cssText=a):o&&e.removeAttribute("style"),"_vod"in e&&(c.display=m)}}const tw=/\s*!important$/;function oy(e,o,a){if(xn(a))a.forEach(c=>oy(e,o,c));else if(a==null&&(a=""),o.startsWith("--"))e.setProperty(o,a);else{const c=IP(e,o);tw.test(a)?e.setProperty(ph(c),a.replace(tw,""),"important"):e[c]=a}}const nw=["Webkit","Moz","ms"],T_={};function IP(e,o){const a=T_[o];if(a)return a;let c=Bo(o);if(c!=="filter"&&c in e)return T_[o]=c;c=bl(c);for(let d=0;d<nw.length;d++){const m=nw[d]+c;if(m in e)return T_[o]=m}return o}const iw="http://www.w3.org/1999/xlink";function AP(e,o,a,c,d){if(c&&o.startsWith("xlink:"))a==null?e.removeAttributeNS(iw,o.slice(6,o.length)):e.setAttributeNS(iw,o,a);else{const m=Ik(o);a==null||m&&!qS(a)?e.removeAttribute(o):e.setAttribute(o,m?"":a)}}function kP(e,o,a,c,d,m,_){if(o==="innerHTML"||o==="textContent"){c&&_(c,d,m),e[o]=a==null?"":a;return}if(o==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=a;const w=a==null?"":a;(e.value!==w||e.tagName==="OPTION")&&(e.value=w),a==null&&e.removeAttribute(o);return}let s=!1;if(a===""||a==null){const w=typeof e[o];w==="boolean"?a=qS(a):a==null&&w==="string"?(a="",s=!0):w==="number"&&(a=0,s=!0)}try{e[o]=a}catch{}s&&e.removeAttribute(o)}function th(e,o,a,c){e.addEventListener(o,a,c)}function MP(e,o,a,c){e.removeEventListener(o,a,c)}function PP(e,o,a,c,d=null){const m=e._vei||(e._vei={}),_=m[o];if(c&&_)_.value=c;else{const[s,w]=zP(o);if(c){const E=m[o]=DP(c,d);th(e,s,E,w)}else _&&(MP(e,s,_,w),m[o]=void 0)}}const rw=/(?:Once|Passive|Capture)$/;function zP(e){let o;if(rw.test(e)){o={};let c;for(;c=e.match(rw);)e=e.slice(0,e.length-c[0].length),o[c[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):ph(e.slice(2)),o]}let C_=0;const LP=Promise.resolve(),RP=()=>C_||(LP.then(()=>C_=0),C_=Date.now());function DP(e,o){const a=c=>{if(!c._vts)c._vts=Date.now();else if(c._vts<=a.attached)return;Po(BP(c,a.value),o,5,[c])};return a.value=e,a.attached=RP(),a}function BP(e,o){if(xn(o)){const a=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{a.call(e),e._stopped=!0},o.map(c=>d=>!d._stopped&&c&&c(d))}else return o}const ow=/^on[a-z]/,OP=(e,o,a,c,d=!1,m,_,s,w)=>{o==="class"?TP(e,c,d):o==="style"?CP(e,a,c):Cg(o)?qy(o)||PP(e,o,a,c,_):(o[0]==="."?(o=o.slice(1),!0):o[0]==="^"?(o=o.slice(1),!1):FP(e,o,c,d))?kP(e,o,c,m,_,s,w):(o==="true-value"?e._trueValue=c:o==="false-value"&&(e._falseValue=c),AP(e,o,c,d))};function FP(e,o,a,c){return c?!!(o==="innerHTML"||o==="textContent"||o in e&&ow.test(o)&&On(a)):o==="spellcheck"||o==="draggable"||o==="translate"||o==="form"||o==="list"&&e.tagName==="INPUT"||o==="type"&&e.tagName==="TEXTAREA"||ow.test(o)&&rr(a)?!1:o in e}const al="transition",Qd="animation",Fs=(e,{slots:o})=>$s(TE,XE(e),o);Fs.displayName="Transition";const HE={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},VP=Fs.props=Cr({},TE.props,HE),vc=(e,o=[])=>{xn(e)?e.forEach(a=>a(...o)):e&&e(...o)},sw=e=>e?xn(e)?e.some(o=>o.length>1):e.length>1:!1;function XE(e){const o={};for(const ze in e)ze in HE||(o[ze]=e[ze]);if(e.css===!1)return o;const{name:a="v",type:c,duration:d,enterFromClass:m=`${a}-enter-from`,enterActiveClass:_=`${a}-enter-active`,enterToClass:s=`${a}-enter-to`,appearFromClass:w=m,appearActiveClass:E=_,appearToClass:A=s,leaveFromClass:P=`${a}-leave-from`,leaveActiveClass:L=`${a}-leave-active`,leaveToClass:D=`${a}-leave-to`}=e,N=$P(d),Z=N&&N[0],de=N&&N[1],{onBeforeEnter:ne,onEnter:ce,onEnterCancelled:K,onLeave:Se,onLeaveCancelled:Y,onBeforeAppear:_e=ne,onAppear:fe=ce,onAppearCancelled:ve=K}=o,Ee=(ze,Je,ct)=>{ul(ze,Je?A:s),ul(ze,Je?E:_),ct&&ct()},be=(ze,Je)=>{ze._isLeaving=!1,ul(ze,P),ul(ze,D),ul(ze,L),Je&&Je()},Re=ze=>(Je,ct)=>{const nt=ze?fe:ce,ft=()=>Ee(Je,ze,ct);vc(nt,[Je,ft]),aw(()=>{ul(Je,ze?w:m),da(Je,ze?A:s),sw(nt)||lw(Je,c,Z,ft)})};return Cr(o,{onBeforeEnter(ze){vc(ne,[ze]),da(ze,m),da(ze,_)},onBeforeAppear(ze){vc(_e,[ze]),da(ze,w),da(ze,E)},onEnter:Re(!1),onAppear:Re(!0),onLeave(ze,Je){ze._isLeaving=!0;const ct=()=>be(ze,Je);da(ze,P),KE(),da(ze,L),aw(()=>{!ze._isLeaving||(ul(ze,P),da(ze,D),sw(Se)||lw(ze,c,de,ct))}),vc(Se,[ze,ct])},onEnterCancelled(ze){Ee(ze,!1),vc(K,[ze])},onAppearCancelled(ze){Ee(ze,!0),vc(ve,[ze])},onLeaveCancelled(ze){be(ze),vc(Y,[ze])}})}function $P(e){if(e==null)return null;if(Ri(e))return[I_(e.enter),I_(e.leave)];{const o=I_(e);return[o,o]}}function I_(e){return og(e)}function da(e,o){o.split(/\s+/).forEach(a=>a&&e.classList.add(a)),(e._vtc||(e._vtc=new Set)).add(o)}function ul(e,o){o.split(/\s+/).forEach(c=>c&&e.classList.remove(c));const{_vtc:a}=e;a&&(a.delete(o),a.size||(e._vtc=void 0))}function aw(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let NP=0;function lw(e,o,a,c){const d=e._endId=++NP,m=()=>{d===e._endId&&c()};if(a)return setTimeout(m,a);const{type:_,timeout:s,propCount:w}=YE(e,o);if(!_)return c();const E=_+"end";let A=0;const P=()=>{e.removeEventListener(E,L),m()},L=D=>{D.target===e&&++A>=w&&P()};setTimeout(()=>{A<w&&P()},s+1),e.addEventListener(E,L)}function YE(e,o){const a=window.getComputedStyle(e),c=N=>(a[N]||"").split(", "),d=c(al+"Delay"),m=c(al+"Duration"),_=cw(d,m),s=c(Qd+"Delay"),w=c(Qd+"Duration"),E=cw(s,w);let A=null,P=0,L=0;o===al?_>0&&(A=al,P=_,L=m.length):o===Qd?E>0&&(A=Qd,P=E,L=w.length):(P=Math.max(_,E),A=P>0?_>E?al:Qd:null,L=A?A===al?m.length:w.length:0);const D=A===al&&/\b(transform|all)(,|$)/.test(a[al+"Property"]);return{type:A,timeout:P,propCount:L,hasTransform:D}}function cw(e,o){for(;e.length<o.length;)e=e.concat(e);return Math.max(...o.map((a,c)=>uw(a)+uw(e[c])))}function uw(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function KE(){return document.body.offsetHeight}const JE=new WeakMap,QE=new WeakMap,UP={name:"TransitionGroup",props:Cr({},VP,{tag:String,moveClass:String}),setup(e,{slots:o}){const a=Bg(),c=EE();let d,m;return PE(()=>{if(!d.length)return;const _=e.moveClass||`${e.name||"v"}-move`;if(!WP(d[0].el,a.vnode.el,_))return;d.forEach(GP),d.forEach(qP);const s=d.filter(ZP);KE(),s.forEach(w=>{const E=w.el,A=E.style;da(E,_),A.transform=A.webkitTransform=A.transitionDuration="";const P=E._moveCb=L=>{L&&L.target!==E||(!L||/transform$/.test(L.propertyName))&&(E.removeEventListener("transitionend",P),E._moveCb=null,ul(E,_))};E.addEventListener("transitionend",P)})}),()=>{const _=Yn(e),s=XE(_);let w=_.tag||Dn;d=m,m=o.default?s0(o.default()):[];for(let E=0;E<m.length;E++){const A=m[E];A.key!=null&&If(A,Cf(A,s,c,a))}if(d)for(let E=0;E<d.length;E++){const A=d[E];If(A,Cf(A,s,c,a)),JE.set(A,A.el.getBoundingClientRect())}return F(w,null,m)}}},jP=UP;function GP(e){const o=e.el;o._moveCb&&o._moveCb(),o._enterCb&&o._enterCb()}function qP(e){QE.set(e,e.el.getBoundingClientRect())}function ZP(e){const o=JE.get(e),a=QE.get(e),c=o.left-a.left,d=o.top-a.top;if(c||d){const m=e.el.style;return m.transform=m.webkitTransform=`translate(${c}px,${d}px)`,m.transitionDuration="0s",e}}function WP(e,o,a){const c=e.cloneNode();e._vtc&&e._vtc.forEach(_=>{_.split(/\s+/).forEach(s=>s&&c.classList.remove(s))}),a.split(/\s+/).forEach(_=>_&&c.classList.add(_)),c.style.display="none";const d=o.nodeType===1?o:o.parentNode;d.appendChild(c);const{hasTransform:m}=YE(c);return d.removeChild(c),m}const hw=e=>{const o=e.props["onUpdate:modelValue"]||!1;return xn(o)?a=>Jm(o,a):o};function HP(e){e.target.composing=!0}function dw(e){const o=e.target;o.composing&&(o.composing=!1,o.dispatchEvent(new Event("input")))}const XP={created(e,{modifiers:{lazy:o,trim:a,number:c}},d){e._assign=hw(d);const m=c||d.props&&d.props.type==="number";th(e,o?"change":"input",_=>{if(_.target.composing)return;let s=e.value;a&&(s=s.trim()),m&&(s=og(s)),e._assign(s)}),a&&th(e,"change",()=>{e.value=e.value.trim()}),o||(th(e,"compositionstart",HP),th(e,"compositionend",dw),th(e,"change",dw))},mounted(e,{value:o}){e.value=o==null?"":o},beforeUpdate(e,{value:o,modifiers:{lazy:a,trim:c,number:d}},m){if(e._assign=hw(m),e.composing||document.activeElement===e&&e.type!=="range"&&(a||c&&e.value.trim()===o||(d||e.type==="number")&&og(e.value)===o))return;const _=o==null?"":o;e.value!==_&&(e.value=_)}},Ns={beforeMount(e,{value:o},{transition:a}){e._vod=e.style.display==="none"?"":e.style.display,a&&o?a.beforeEnter(e):ef(e,o)},mounted(e,{value:o},{transition:a}){a&&o&&a.enter(e)},updated(e,{value:o,oldValue:a},{transition:c}){!o!=!a&&(c?o?(c.beforeEnter(e),ef(e,!0),c.enter(e)):c.leave(e,()=>{ef(e,!1)}):ef(e,o))},beforeUnmount(e,{value:o}){ef(e,o)}};function ef(e,o){e.style.display=o?e._vod:"none"}const YP=Cr({patchProp:OP},EP);let fw;function KP(){return fw||(fw=nP(YP))}const JP=(...e)=>{const o=KP().createApp(...e),{mount:a}=o;return o.mount=c=>{const d=QP(c);if(!d)return;const m=o._component;!On(m)&&!m.render&&!m.template&&(m.template=d.innerHTML),d.innerHTML="";const _=a(d,!1,d instanceof SVGElement);return d instanceof Element&&(d.removeAttribute("v-cloak"),d.setAttribute("data-v-app","")),_},o};function QP(e){return rr(e)?document.querySelector(e):e}const Oo=(e,o)=>{const a=e.__vccOpts||e;for(const[c,d]of o)a[c]=d;return a};function pw(e,o,a){ez(e,o),o.set(e,a)}function ez(e,o){if(o.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tz(e,o,a){var c=eT(e,o,"set");return nz(e,c,a),a}function nz(e,o,a){if(o.set)o.set.call(e,a);else{if(!o.writable)throw new TypeError("attempted to set read only private field");o.value=a}}function _c(e,o){var a=eT(e,o,"get");return iz(e,a)}function eT(e,o,a){if(!o.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return o.get(e)}function iz(e,o){return o.get?o.get.call(e):o.value}function tT(e,o,a){const c=o.length-1;if(c<0)return e===void 0?a:e;for(let d=0;d<c;d++){if(e==null)return a;e=e[o[d]]}return e==null||e[o[c]]===void 0?a:e[o[c]]}function Gf(e,o){if(e===o)return!0;if(e instanceof Date&&o instanceof Date&&e.getTime()!==o.getTime()||e!==Object(e)||o!==Object(o))return!1;const a=Object.keys(e);return a.length!==Object.keys(o).length?!1:a.every(c=>Gf(e[c],o[c]))}function sy(e,o,a){return e==null||!o||typeof o!="string"?a:e[o]!==void 0?e[o]:(o=o.replace(/\[(\w+)\]/g,".$1"),o=o.replace(/^\./,""),tT(e,o.split("."),a))}function Bs(e,o,a){if(o==null)return e===void 0?a:e;if(e!==Object(e))return a;if(typeof o=="string")return sy(e,o,a);if(Array.isArray(o))return tT(e,o,a);if(typeof o!="function")return a;const c=o(e,a);return typeof c>"u"?a:c}function Tc(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:e},(a,c)=>o+c)}function Yt(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(!(e==null||e===""))return isNaN(+e)?String(e):isFinite(+e)?`${Number(e)}${o}`:void 0}function ay(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function rz(e){return e==null?void 0:e.$el}const mw=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16}),ly=Object.freeze({enter:"Enter",tab:"Tab",delete:"Delete",esc:"Escape",space:"Space",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",end:"End",home:"Home",del:"Delete",backspace:"Backspace",insert:"Insert",pageup:"PageUp",pagedown:"PageDown",shift:"Shift"});function nT(e){return Object.keys(e)}function Fo(e,o){const a=Object.create(null),c=Object.create(null);for(const d in e)o.some(m=>m instanceof RegExp?m.test(d):m===d)?a[d]=e[d]:c[d]=e[d];return[a,c]}function Fg(e,o){const a={...e};return o.forEach(c=>delete a[c]),a}function Fc(e){return Fo(e,["class","style","id",/^data-/])}function Ro(e){return e==null?[]:Array.isArray(e)?e:[e]}function Mo(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(o,Math.min(a,e))}function A_(e,o){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return e+a.repeat(Math.max(0,o-e.length))}function oz(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const a=[];let c=0;for(;c<e.length;)a.push(e.substr(c,o)),c+=o;return a}function gw(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;if(e<o)return`${e} B`;const a=o===1024?["Ki","Mi","Gi"]:["k","M","G"];let c=-1;for(;Math.abs(e)>=o&&c<a.length-1;)e/=o,++c;return`${e.toFixed(1)} ${a[c]}B`}function ya(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;const c={};for(const d in e)c[d]=e[d];for(const d in o){const m=e[d],_=o[d];if(ay(m)&&ay(_)){c[d]=ya(m,_,a);continue}if(Array.isArray(m)&&Array.isArray(_)&&a){c[d]=a(m,_);continue}c[d]=_}return c}function iT(e){return e.map(o=>o.type===Dn?iT(o.children):o).flat()}function p0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"").replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase()}function gf(e,o){if(!o||typeof o!="object")return[];if(Array.isArray(o))return o.map(a=>gf(e,a)).flat(1);if(Array.isArray(o.children))return o.children.map(a=>gf(e,a)).flat(1);if(o.component){if(Object.getOwnPropertySymbols(o.component.provides).includes(e))return[o.component];if(o.component.subTree)return gf(e,o.component.subTree).flat(1)}return[]}var Gm=new WeakMap,Yu=new WeakMap;class sz{constructor(o){pw(this,Gm,{writable:!0,value:[]}),pw(this,Yu,{writable:!0,value:0}),this.size=o}push(o){_c(this,Gm)[_c(this,Yu)]=o,tz(this,Yu,(_c(this,Yu)+1)%this.size)}values(){return _c(this,Gm).slice(_c(this,Yu)).concat(_c(this,Gm).slice(0,_c(this,Yu)))}}function az(e){return"touches"in e?{clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}:{clientX:e.clientX,clientY:e.clientY}}function m0(e){const o=$i({}),a=ie(e);return Vs(()=>{for(const c in a.value)o[c]=a.value[c]},{flush:"sync"}),n0(o)}function hg(e,o){return e.includes(o)}const lz=/^on[^a-z]/,rT=e=>lz.test(e),vf=[Function,Array];function dg(e){for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];if(Array.isArray(e))for(const d of e)d(...a);else typeof e=="function"&&e(...a)}const oT=["top","bottom"],cz=["start","end","left","right"];function cy(e,o){let[a,c]=e.split(" ");return c||(c=hg(oT,a)?"start":hg(cz,a)?"top":"center"),{side:uy(a,o),align:uy(c,o)}}function uy(e,o){return e==="start"?o?"right":"left":e==="end"?o?"left":"right":e}function k_(e){return{side:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.side],align:e.align}}function M_(e){return{side:e.side,align:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.align]}}function vw(e){return{side:e.align,align:e.side}}function _w(e){return hg(oT,e.side)?"y":"x"}class lh{constructor(o){let{x:a,y:c,width:d,height:m}=o;this.x=a,this.y=c,this.width=d,this.height=m}get top(){return this.y}get bottom(){return this.y+this.height}get left(){return this.x}get right(){return this.x+this.width}}function yw(e,o){return{x:{before:Math.max(0,o.left-e.left),after:Math.max(0,e.right-o.right)},y:{before:Math.max(0,o.top-e.top),after:Math.max(0,e.bottom-o.bottom)}}}function g0(e){const o=e.getBoundingClientRect(),a=getComputedStyle(e),c=a.transform;if(c){let d,m,_,s,w;if(c.startsWith("matrix3d("))d=c.slice(9,-1).split(/, /),m=+d[0],_=+d[5],s=+d[12],w=+d[13];else if(c.startsWith("matrix("))d=c.slice(7,-1).split(/, /),m=+d[0],_=+d[3],s=+d[4],w=+d[5];else return new lh(o);const E=a.transformOrigin,A=o.x-s-(1-m)*parseFloat(E),P=o.y-w-(1-_)*parseFloat(E.slice(E.indexOf(" ")+1)),L=m?o.width/m:e.offsetWidth+1,D=_?o.height/_:e.offsetHeight+1;return new lh({x:A,y:P,width:L,height:D})}else return new lh(o)}function Cc(e,o,a){if(typeof e.animate>"u")return{finished:Promise.resolve()};const c=e.animate(o,a);return typeof c.finished>"u"&&(c.finished=new Promise(d=>{c.onfinish=()=>{d(c)}})),c}function sT(e,o,a){if(a&&(o={_isVue:!0,$parent:a,$options:o}),o){if(o.$_alreadyWarned=o.$_alreadyWarned||[],o.$_alreadyWarned.includes(e))return;o.$_alreadyWarned.push(e)}return`[Vuetify] ${e}`+(o?dz(o):"")}function Pc(e,o,a){const c=sT(e,o,a);c!=null&&console.warn(c)}function hy(e,o,a){const c=sT(e,o,a);c!=null&&console.error(c)}const uz=/(?:^|[-_])(\w)/g,hz=e=>e.replace(uz,o=>o.toUpperCase()).replace(/[-_]/g,"");function P_(e,o){if(e.$root===e)return"<Root>";const a=typeof e=="function"&&e.cid!=null?e.options:e._isVue?e.$options||e.constructor.options:e||{};let c=a.name||a._componentTag;const d=a.__file;if(!c&&d){const m=d.match(/([^/\\]+)\.vue$/);c=m==null?void 0:m[1]}return(c?`<${hz(c)}>`:"<Anonymous>")+(d&&o!==!1?` at ${d}`:"")}function dz(e){if(e._isVue&&e.$parent){const o=[];let a=0;for(;e;){if(o.length>0){const c=o[o.length-1];if(c.constructor===e.constructor){a++,e=e.$parent;continue}else a>0&&(o[o.length-1]=[c,a],a=0)}o.push(e),e=e.$parent}return`

found in

`+o.map((c,d)=>`${d===0?"---> ":" ".repeat(5+d*2)}${Array.isArray(c)?`${P_(c[0])}... (${c[1]} recursive calls)`:P_(c)}`).join(`
`)}else return`

(found in ${P_(e)})`}const fz=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],pz=e=>e<=.0031308?e*12.92:1.055*e**(1/2.4)-.055,mz=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],gz=e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4;function aT(e){const o=Array(3),a=pz,c=fz;for(let d=0;d<3;++d)o[d]=Math.round(Mo(a(c[d][0]*e[0]+c[d][1]*e[1]+c[d][2]*e[2]))*255);return(o[0]<<16)+(o[1]<<8)+(o[2]<<0)}function v0(e){const o=[0,0,0],a=gz,c=mz,d=a((e>>16&255)/255),m=a((e>>8&255)/255),_=a((e>>0&255)/255);for(let s=0;s<3;++s)o[s]=c[s][0]*d+c[s][1]*m+c[s][2]*_;return o}const fg=.20689655172413793,vz=e=>e>fg**3?Math.cbrt(e):e/(3*fg**2)+4/29,_z=e=>e>fg?e**3:3*fg**2*(e-4/29);function lT(e){const o=vz,a=o(e[1]);return[116*a-16,500*(o(e[0]/.95047)-a),200*(a-o(e[2]/1.08883))]}function cT(e){const o=_z,a=(e[0]+16)/116;return[o(a+e[1]/500)*.95047,o(a),o(a-e[2]/200)*1.08883]}function xw(e){return!!e&&/^(#|var\(--|(rgb|hsl)a?\()/.test(e)}function pg(e){let o;if(typeof e=="number")o=e;else if(typeof e=="string"){let a=e.startsWith("#")?e.substring(1):e;a.length===3&&(a=a.split("").map(c=>c+c).join("")),a.length!==6&&a.length!==8&&Pc(`'${e}' is not a valid rgb color`),o=parseInt(a,16)}else throw new TypeError(`Colors can only be numbers or strings, recieved ${e==null?e:e.constructor.name} instead`);return o<0?(Pc(`Colors cannot be negative: '${e}'`),o=0):(o>4294967295||isNaN(o))&&(Pc(`'${e}' is not a valid rgb color`),o=16777215),o}function yz(e){let o=e.toString(16);return o.length<6&&(o="0".repeat(6-o.length)+o),"#"+o}function Vg(e){const{h:o,s:a,v:c,a:d}=e,m=s=>{const w=(s+o/60)%6;return c-c*a*Math.max(Math.min(w,4-w,1),0)},_=[m(5),m(3),m(1)].map(s=>Math.round(s*255));return{r:_[0],g:_[1],b:_[2],a:d}}function _0(e){if(!e)return{h:0,s:1,v:1,a:1};const o=e.r/255,a=e.g/255,c=e.b/255,d=Math.max(o,a,c),m=Math.min(o,a,c);let _=0;d!==m&&(d===o?_=60*(0+(a-c)/(d-m)):d===a?_=60*(2+(c-o)/(d-m)):d===c&&(_=60*(4+(o-a)/(d-m)))),_<0&&(_=_+360);const s=d===0?0:(d-m)/d,w=[_,s,d];return{h:w[0],s:w[1],v:w[2],a:e.a}}function uT(e){const{h:o,s:a,v:c,a:d}=e,m=c-c*a/2,_=m===1||m===0?0:(c-m)/Math.min(m,1-m);return{h:o,s:_,l:m,a:d}}function hT(e){const{h:o,s:a,l:c,a:d}=e,m=c+a*Math.min(c,1-c),_=m===0?0:2-2*c/m;return{h:o,s:_,v:m,a:d}}function xz(e){return`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`}function dT(e){return xz(Vg(e))}function bz(e){const o=a=>{const c=Math.round(a).toString(16);return("00".substr(0,2-c.length)+c).toUpperCase()};return`#${[o(e.r),o(e.g),o(e.b),o(Math.round(e.a*255))].join("")}`}function wz(e){const o=oz(e.slice(1),2).map(a=>parseInt(a,16));return{r:o[0],g:o[1],b:o[2],a:Math.round(o[3]/255*100)/100}}function fT(e){const o=wz(e);return _0(o)}function pT(e){return bz(Vg(e))}function Sz(e){return e.startsWith("#")&&(e=e.slice(1)),e=e.replace(/([^0-9a-f])/gi,"F"),(e.length===3||e.length===4)&&(e=e.split("").map(o=>o+o).join("")),e.length===6?e=A_(e,8,"F"):e=A_(A_(e,6),8,"F"),`#${e}`.toUpperCase().substr(0,9)}function mT(e){const o=pg(e);return{r:(o&16711680)>>16,g:(o&65280)>>8,b:o&255}}function Ez(e,o){const a=lT(v0(e));return a[0]=a[0]+o*10,aT(cT(a))}function Tz(e,o){const a=lT(v0(e));return a[0]=a[0]-o*10,aT(cT(a))}function dy(e){const o=pg(e);return v0(o)[1]}function Cz(e,o){const a=dy(e),c=dy(o),d=Math.max(a,c),m=Math.min(a,c);return(d+.05)/(m+.05)}function Pr(e,o){const a=Bg();if(!a)throw new Error(`[Vuetify] ${e} ${o||"must be called from inside a setup function"}`);return a}function ba(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const o=Pr(e).type;return p0((o==null?void 0:o.aliasName)||(o==null?void 0:o.name))}let gT=0,eg=new WeakMap;function Gr(){const e=Pr("getUid");if(eg.has(e))return eg.get(e);{const o=gT++;return eg.set(e,o),o}}Gr.reset=()=>{gT=0,eg=new WeakMap};function Iz(e){const{provides:o}=Pr("injectSelf");if(o&&e in o)return o[e]}function Ln(e,o){return a=>Object.keys(e).reduce((c,d)=>{const _=typeof e[d]=="object"&&e[d]!=null&&!Array.isArray(e[d])?e[d]:{type:e[d]};return a&&d in a?c[d]={..._,default:a[d]}:c[d]=_,o&&!c[d].source&&(c[d].source=o),c},{})}function Az(e,o){var a,c;return((a=e.props)==null?void 0:a.hasOwnProperty(o))||((c=e.props)==null?void 0:c.hasOwnProperty(p0(o)))}const zt=function(o){var a,c;return o._setup=(a=o._setup)!=null?a:o.setup,o.name?(o._setup&&(o.props=(c=o.props)!=null?c:{},o.props=Ln(o.props,o.name)(),o.props._as=String,o.setup=function(m,_){const s=Bg(),w=yT(),E=Ii(),A=lE({...Yn(m)});Vs(()=>{var Z,de,ne;const D=w.value.global,N=w.value[(Z=m._as)!=null?Z:o.name];if(N){const ce=Object.entries(N).filter(K=>{let[Se]=K;return Se.startsWith("V")});ce.length&&(E.value=Object.fromEntries(ce))}for(const ce of Object.keys(m)){let K=m[ce];Az(s.vnode,ce)||(K=(ne=(de=N==null?void 0:N[ce])!=null?de:D==null?void 0:D[ce])!=null?ne:m[ce]),A[ce]!==K&&(A[ce]=K)}});const P=o._setup(A,_);let L;return Ke(E,(D,N)=>{!D&&L?L.stop():D&&!N&&(L=Uf(),L.run(()=>{var de;var Z;ar(ya((de=(Z=Iz(Pf))==null?void 0:Z.value)!=null?de:{},D))}))},{immediate:!0}),P}),o):(Pc("The component is missing an explicit name, unable to generate default prop value"),o)};function Di(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return o=>(e?zt:vn)(o)}function Vo(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",a=arguments.length>2?arguments[2]:void 0;return zt({name:a!=null?a:bl(Bo(e.replace(/__/g,"-"))),props:{tag:{type:String,default:o}},setup(c,d){let{slots:m}=d;return()=>{var _;return $s(c.tag,{class:e},(_=m.default)==null?void 0:_.call(m))}}})}function vT(e){if(typeof e.getRootNode!="function"){for(;e.parentNode;)e=e.parentNode;return e!==document?null:document}const o=e.getRootNode();return o!==document&&o.getRootNode({composed:!0})!==document?null:o}const Mf="cubic-bezier(0.4, 0, 0.2, 1)",kz="cubic-bezier(0.0, 0, 0.2, 1)",Mz="cubic-bezier(0.4, 0, 1, 1)";function _T(e){for(;e;){if(y0(e))return e;e=e.parentElement}return document.scrollingElement}function mg(e,o){const a=[];if(o&&e&&!o.contains(e))return a;for(;e&&(y0(e)&&a.push(e),e!==o);)e=e.parentElement;return a}function y0(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const o=window.getComputedStyle(e);return o.overflowY==="scroll"||o.overflowY==="auto"&&e.scrollHeight>e.clientHeight}const Li=typeof window<"u",x0=Li&&"IntersectionObserver"in window,Pz=Li&&("ontouchstart"in window||window.navigator.maxTouchPoints>0),fy=Li&&typeof CSS<"u"&&CSS.supports("selector(:focus-visible)");function zz(e){for(;e;){if(window.getComputedStyle(e).position==="fixed")return!0;e=e.offsetParent}return!1}function Mt(e){const o=Pr("useRender");o.render=e}const Pf=Symbol.for("vuetify:defaults");function Lz(e){return He(e!=null?e:{})}function yT(){const e=cn(Pf);if(!e)throw new Error("[Vuetify] Could not find defaults instance");return e}function ar(e,o){const a=yT(),c=He(e),d=ie(()=>{const m=pi(o==null?void 0:o.scoped),_=pi(o==null?void 0:o.reset),s=pi(o==null?void 0:o.root);let w=ya(c.value,{prev:a.value});if(m)return w;if(_||s){const E=Number(_||1/0);for(let A=0;A<=E&&w.prev;A++)w=w.prev;return w}return ya(w.prev,w)});return Wi(Pf,d),d}const Ci=vn({name:"VDefaultsProvider",props:{defaults:Object,reset:[Number,String],root:Boolean,scoped:Boolean},setup(e,o){let{slots:a}=o;const{defaults:c,reset:d,root:m,scoped:_}=n0(e);return ar(c,{reset:d,root:m,scoped:_}),()=>{var s;return(s=a.default)==null?void 0:s.call(a)}}});function vo(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top center 0",a=arguments.length>2?arguments[2]:void 0;return zt({name:e,props:{group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:{type:String,default:a},origin:{type:String,default:o}},setup(c,d){let{slots:m}=d;return()=>{const _=c.group?jP:Fs;return $s(_,{name:e,mode:c.mode,onBeforeEnter(s){s.style.transformOrigin=c.origin},onLeave(s){if(c.leaveAbsolute){const{offsetTop:w,offsetLeft:E,offsetWidth:A,offsetHeight:P}=s;s._transitionInitialStyles={position:s.style.position,top:s.style.top,left:s.style.left,width:s.style.width,height:s.style.height},s.style.position="absolute",s.style.top=`${w}px`,s.style.left=`${E}px`,s.style.width=`${A}px`,s.style.height=`${P}px`}c.hideOnLeave&&s.style.setProperty("display","none","important")},onAfterLeave(s){if(c.leaveAbsolute&&s!=null&&s._transitionInitialStyles){const{position:w,top:E,left:A,width:P,height:L}=s._transitionInitialStyles;delete s._transitionInitialStyles,s.style.position=w||"",s.style.top=E||"",s.style.left=A||"",s.style.width=P||"",s.style.height=L||""}}},m.default)}}})}function xT(e,o){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"in-out";return zt({name:e,props:{mode:{type:String,default:a}},setup(c,d){let{slots:m}=d;return()=>$s(Fs,{name:e,...o},m.default)}})}function bT(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const a=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?"width":"height",c=Bo(`offset-${a}`);return{onBeforeEnter(_){_._parent=_.parentNode,_._initialStyle={transition:_.style.transition,overflow:_.style.overflow,[a]:_.style[a]}},onEnter(_){const s=_._initialStyle;_.style.setProperty("transition","none","important"),_.style.overflow="hidden";const w=`${_[c]}px`;_.style[a]="0",_.offsetHeight,_.style.transition=s.transition,e&&_._parent&&_._parent.classList.add(e),requestAnimationFrame(()=>{_.style[a]=w})},onAfterEnter:m,onEnterCancelled:m,onLeave(_){_._initialStyle={transition:"",overflow:_.style.overflow,[a]:_.style[a]},_.style.overflow="hidden",_.style[a]=`${_[c]}px`,_.offsetHeight,requestAnimationFrame(()=>_.style[a]="0")},onAfterLeave:d,onLeaveCancelled:d};function d(_){e&&_._parent&&_._parent.classList.remove(e),m(_)}function m(_){const s=_._initialStyle[a];_.style.overflow=_._initialStyle.overflow,s!=null&&(_.style[a]=s),delete _._initialStyle}}const $g=zt({name:"VDialogTransition",props:{target:Object},setup(e,o){let{slots:a}=o;const c={onBeforeEnter(d){d.style.pointerEvents="none",d.style.visibility="hidden"},async onEnter(d,m){var _;await new Promise(D=>requestAnimationFrame(D)),await new Promise(D=>requestAnimationFrame(D)),d.style.visibility="";const{x:s,y:w,sx:E,sy:A,speed:P}=ww(e.target,d),L=Cc(d,[{transform:`translate(${s}px, ${w}px) scale(${E}, ${A})`,opacity:0},{transform:""}],{duration:225*P,easing:kz});(_=bw(d))==null||_.forEach(D=>{Cc(D,[{opacity:0},{opacity:0,offset:.33},{opacity:1}],{duration:225*2*P,easing:Mf})}),L.finished.then(()=>m())},onAfterEnter(d){d.style.removeProperty("pointer-events")},onBeforeLeave(d){d.style.pointerEvents="none"},async onLeave(d,m){var _;await new Promise(D=>requestAnimationFrame(D));const{x:s,y:w,sx:E,sy:A,speed:P}=ww(e.target,d);Cc(d,[{transform:""},{transform:`translate(${s}px, ${w}px) scale(${E}, ${A})`,opacity:0}],{duration:125*P,easing:Mz}).finished.then(()=>m()),(_=bw(d))==null||_.forEach(D=>{Cc(D,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*P,easing:Mf})})},onAfterLeave(d){d.style.removeProperty("pointer-events")}};return()=>e.target?F(Fs,tn({name:"dialog-transition"},c,{css:!1}),a):F(Fs,{name:"dialog-transition"},a)}});function bw(e){var o;const a=(o=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:o.children;return a&&[...a]}function ww(e,o){const a=e.getBoundingClientRect(),c=g0(o),[d,m]=getComputedStyle(o).transformOrigin.split(" ").map(ne=>parseFloat(ne)),[_,s]=getComputedStyle(o).getPropertyValue("--v-overlay-anchor-origin").split(" ");let w=a.left+a.width/2;_==="left"||s==="left"?w-=a.width/2:(_==="right"||s==="right")&&(w+=a.width/2);let E=a.top+a.height/2;_==="top"||s==="top"?E-=a.height/2:(_==="bottom"||s==="bottom")&&(E+=a.height/2);const A=a.width/c.width,P=a.height/c.height,L=Math.max(1,A,P),D=A/L,N=P/L,Z=c.width*c.height/(window.innerWidth*window.innerHeight),de=Z>.12?Math.min(1.5,(Z-.12)*10+1):1;return{x:w-(d+c.left),y:E-(m+c.top),sx:D,sy:N,speed:de}}const Rz=vo("fab-transition","center center","out-in"),Dz=vo("dialog-bottom-transition"),Bz=vo("dialog-top-transition"),py=vo("fade-transition"),wT=vo("scale-transition"),Oz=vo("scroll-x-transition"),Fz=vo("scroll-x-reverse-transition"),Vz=vo("scroll-y-transition"),$z=vo("scroll-y-reverse-transition"),Nz=vo("slide-x-transition"),Uz=vo("slide-x-reverse-transition"),b0=vo("slide-y-transition"),jz=vo("slide-y-reverse-transition"),Ng=xT("expand-transition",bT()),w0=xT("expand-x-transition",bT("",!0));const ls=Ln({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function cs(e){return{dimensionStyles:ie(()=>({height:Yt(e.height),maxHeight:Yt(e.maxHeight),maxWidth:Yt(e.maxWidth),minHeight:Yt(e.minHeight),minWidth:Yt(e.minWidth),width:Yt(e.width)}))}}function Gz(e){return{aspectStyles:ie(()=>{const o=Number(e.aspectRatio);return o?{paddingBottom:String(1/o*100)+"%"}:void 0})}}const ST=zt({name:"VResponsive",props:{aspectRatio:[String,Number],contentClass:String,...ls()},setup(e,o){let{slots:a}=o;const{aspectStyles:c}=Gz(e),{dimensionStyles:d}=cs(e);return Mt(()=>{var m;return F("div",{class:"v-responsive",style:d.value},[F("div",{class:"v-responsive__sizer",style:c.value},null),(m=a.additional)==null?void 0:m.call(a),a.default&&F("div",{class:["v-responsive__content",e.contentClass]},[a.default()])])}),{}}});function qz(e,o){if(!x0)return;const a=o.modifiers||{},c=o.value,{handler:d,options:m}=typeof c=="object"?c:{handler:c,options:{}},_=new IntersectionObserver(function(){var s;let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],E=arguments.length>1?arguments[1]:void 0;const A=(s=e._observe)==null?void 0:s[o.instance.$.uid];if(!A)return;const P=w.some(L=>L.isIntersecting);d&&(!a.quiet||A.init)&&(!a.once||P||A.init)&&d(P,w,E),P&&a.once?ET(e,o):A.init=!0},m);e._observe=Object(e._observe),e._observe[o.instance.$.uid]={init:!1,observer:_},_.observe(e)}function ET(e,o){var a;const c=(a=e._observe)==null?void 0:a[o.instance.$.uid];!c||(c.observer.unobserve(e),delete e._observe[o.instance.$.uid])}const TT={mounted:qz,unmounted:ET},Ug=TT,wa=Ln({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:e=>e!==!0}},"transition"),Os=(e,o)=>{let{slots:a}=o;const{transition:c,...d}=e,{component:m=Fs,..._}=typeof c=="object"?c:{};return $s(m,tn(typeof c=="string"?{name:c}:_,d),a)},gh=zt({name:"VImg",directives:{intersect:Ug},props:{aspectRatio:[String,Number],alt:String,cover:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},srcset:String,width:[String,Number],...wa()},emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,o){let{emit:a,slots:c}=o;const d=He(""),m=He(),_=He(e.eager?"loading":"idle"),s=He(),w=He(),E=ie(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),A=ie(()=>E.value.aspect||s.value/w.value||0);Ke(()=>e.src,()=>{P(_.value!=="idle")}),Rg(()=>P());function P(fe){if(!(e.eager&&fe)&&!(x0&&!fe&&!e.eager)){if(_.value="loading",E.value.lazySrc){const ve=new Image;ve.src=E.value.lazySrc,Z(ve,null)}!E.value.src||Xi(()=>{var ve,Ee;if(a("loadstart",((ve=m.value)==null?void 0:ve.currentSrc)||E.value.src),(Ee=m.value)!=null&&Ee.complete){if(m.value.naturalWidth||D(),_.value==="error")return;A.value||Z(m.value,null),L()}else A.value||Z(m.value),N()})}}function L(){var fe;N(),_.value="loaded",a("load",((fe=m.value)==null?void 0:fe.currentSrc)||E.value.src)}function D(){var fe;_.value="error",a("error",((fe=m.value)==null?void 0:fe.currentSrc)||E.value.src)}function N(){const fe=m.value;fe&&(d.value=fe.currentSrc||fe.src)}function Z(fe){let ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const Ee=()=>{const{naturalHeight:be,naturalWidth:Re}=fe;be||Re?(s.value=Re,w.value=be):!fe.complete&&_.value==="loading"&&ve!=null?setTimeout(Ee,ve):(fe.currentSrc.endsWith(".svg")||fe.currentSrc.startsWith("data:image/svg+xml"))&&(s.value=1,w.value=1)};Ee()}const de=ie(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),ne=()=>{var fe;if(!E.value.src||_.value==="idle")return null;const ve=F("img",{class:["v-img__img",de.value],src:E.value.src,srcset:E.value.srcset,alt:"",sizes:e.sizes,ref:m,onLoad:L,onError:D},null),Ee=(fe=c.sources)==null?void 0:fe.call(c);return F(Os,{transition:e.transition,appear:!0},{default:()=>[Yi(Ee?F("picture",{class:"v-img__picture"},[Ee,ve]):ve,[[Ns,_.value==="loaded"]])]})},ce=()=>F(Os,{transition:e.transition},{default:()=>[E.value.lazySrc&&_.value!=="loaded"&&F("img",{class:["v-img__img","v-img__img--preload",de.value],src:E.value.lazySrc,alt:""},null)]}),K=()=>c.placeholder?F(Os,{transition:e.transition,appear:!0},{default:()=>[(_.value==="loading"||_.value==="error"&&!c.error)&&F("div",{class:"v-img__placeholder"},[c.placeholder()])]}):null,Se=()=>c.error?F(Os,{transition:e.transition,appear:!0},{default:()=>[_.value==="error"&&F("div",{class:"v-img__error"},[c.error()])]}):null,Y=()=>e.gradient?F("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,_e=He(!1);{const fe=Ke(A,ve=>{ve&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{_e.value=!0})}),fe())})}return Mt(()=>Yi(F(ST,{class:["v-img",{"v-img--booting":!_e.value}],style:{width:Yt(e.width==="auto"?s.value:e.width)},aspectRatio:A.value,"aria-label":e.alt,role:e.alt?"img":void 0},{additional:()=>F(Dn,null,[F(ne,null,null),F(ce,null,null),F(Y,null,null),F(K,null,null),F(Se,null,null)]),default:c.default}),[[go("intersect"),{handler:P,options:e.options},null,{once:!0}]])),{currentSrc:d,image:m,state:_,naturalWidth:s,naturalHeight:w}}}),Cn=Ln({tag:{type:String,default:"div"}},"tag"),gg=Di()({name:"VToolbarTitle",props:{text:String,...Cn()},setup(e,o){let{slots:a}=o;return Mt(()=>{var c;const d=!!(a.default||a.text||e.text);return F(e.tag,{class:"v-toolbar-title"},{default:()=>[d&&F("div",{class:"v-toolbar-title__placeholder"},[a.text?a.text():e.text,(c=a.default)==null?void 0:c.call(a)])]})}),{}}}),_o=Ln({border:[Boolean,Number,String]},"border");function $o(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ba();return{borderClasses:ie(()=>{const c=zi(e)?e.value:e.border,d=[];if(c===!0||c==="")d.push(`${o}--border`);else if(typeof c=="string"||c===0)for(const m of String(c).split(" "))d.push(`border-${m}`);return d})}}const cr=Ln({elevation:{type:[Number,String],validator(e){const o=parseInt(e);return!isNaN(o)&&o>=0&&o<=24}}},"elevation");function zr(e){return{elevationClasses:ie(()=>{const a=zi(e)?e.value:e.elevation,c=[];return a==null||c.push(`elevation-${a}`),c})}}const Bi=Ln({rounded:{type:[Boolean,Number,String],default:void 0}},"rounded");function tr(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ba();return{roundedClasses:ie(()=>{const c=zi(e)?e.value:e.rounded,d=[];if(c===!0||c==="")d.push(`${o}--rounded`);else if(typeof c=="string"||c===0)for(const m of String(c).split(" "))d.push(`rounded-${m}`);return d})}}const Ku=2.4,Sw=.2126729,Ew=.7151522,Tw=.072175,Zz=.55,Wz=.58,Hz=.57,Xz=.62,qm=.03,Cw=1.45,Yz=5e-4,Kz=1.25,Jz=1.25,Iw=.078,Aw=12.82051282051282,Zm=.06,kw=.001;function Mw(e,o){const a=((e>>16&255)/255)**Ku,c=((e>>8&255)/255)**Ku,d=((e>>0&255)/255)**Ku,m=((o>>16&255)/255)**Ku,_=((o>>8&255)/255)**Ku,s=((o>>0&255)/255)**Ku;let w=a*Sw+c*Ew+d*Tw,E=m*Sw+_*Ew+s*Tw;if(w<=qm&&(w+=(qm-w)**Cw),E<=qm&&(E+=(qm-E)**Cw),Math.abs(E-w)<Yz)return 0;let A;if(E>w){const P=(E**Zz-w**Wz)*Kz;A=P<kw?0:P<Iw?P-P*Aw*Zm:P-Zm}else{const P=(E**Xz-w**Hz)*Jz;A=P>-kw?0:P>-Iw?P-P*Aw*Zm:P+Zm}return A*100}const zf=Symbol.for("vuetify:theme"),Kn=Ln({theme:String},"theme"),tf={defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#6200EE","primary-darken-1":"#3700B3",secondary:"#03DAC6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-variant":"#BDBDBD","on-surface-variant":"#424242",primary:"#BB86FC","primary-darken-1":"#3700B3",secondary:"#03DAC5","secondary-darken-1":"#03DAC5",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}};function Qz(){var d;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:tf;if(!e)return{...tf,isDisabled:!0};const o={};for(const[m,_]of Object.entries((d=e.themes)!=null?d:{})){var a,c;const s=_.dark||m==="dark"?(a=tf.themes)==null?void 0:a.dark:(c=tf.themes)==null?void 0:c.light;o[m]=ya(s,_)}return ya(tf,{...e,themes:o})}function eL(e){const o=$i(Qz(e)),a=He(o.defaultTheme),c=He(o.themes),d=ie(()=>{const E={};for(const[A,P]of Object.entries(c.value)){const L=E[A]={...P,colors:{...P.colors}};if(o.variations)for(const D of o.variations.colors){const N=L.colors[D];if(!!N)for(const Z of["lighten","darken"]){const de=Z==="lighten"?Ez:Tz;for(const ne of Tc(o.variations[Z],1))L.colors[`${D}-${Z}-${ne}`]=yz(de(pg(N),ne))}}for(const D of Object.keys(L.colors)){if(/^on-[a-z]/.test(D)||L.colors[`on-${D}`])continue;const N=`on-${D}`,Z=pg(L.colors[D]),de=Math.abs(Mw(0,Z)),ne=Math.abs(Mw(16777215,Z));L.colors[N]=ne>Math.min(de,50)?"#fff":"#000"}}return E}),m=ie(()=>d.value[a.value]),_=ie(()=>{const E=[];m.value.dark&&Ju(E,":root",["color-scheme: dark"]);for(const[D,N]of Object.entries(d.value)){const{variables:Z,dark:de}=N;Ju(E,`.v-theme--${D}`,[`color-scheme: ${de?"dark":"normal"}`,...tL(N),...Object.keys(Z).map(ne=>{const ce=Z[ne],K=typeof ce=="string"&&ce.startsWith("#")?mT(ce):void 0,Se=K?`${K.r}, ${K.g}, ${K.b}`:void 0;return`--v-${ne}: ${Se!=null?Se:ce}`})])}const A=[],P=[],L=new Set(Object.values(d.value).flatMap(D=>Object.keys(D.colors)));for(const D of L)/^on-[a-z]/.test(D)?Ju(P,`.${D}`,[`color: rgb(var(--v-theme-${D})) !important`]):(Ju(A,`.bg-${D}`,[`--v-theme-overlay-multiplier: var(--v-theme-${D}-overlay-multiplier)`,`background: rgb(var(--v-theme-${D})) !important`,`color: rgb(var(--v-theme-on-${D})) !important`]),Ju(P,`.text-${D}`,[`color: rgb(var(--v-theme-${D})) !important`]),Ju(P,`.border-${D}`,[`--v-border-color: var(--v-theme-${D})`]));return E.push(...A,...P),E.map((D,N)=>N===0?D:`    ${D}`).join("")});function s(E){const A=E._context.provides.usehead;if(A)A.addHeadObjs(ie(()=>{const P={children:_.value,type:"text/css",id:"vuetify-theme-stylesheet"};return o.cspNonce&&(P.nonce=o.cspNonce),{style:[P]}})),Li&&Vs(()=>A.updateDOM());else{let L=function(){if(!o.isDisabled){if(typeof document<"u"&&!P){const D=document.createElement("style");D.type="text/css",D.id="vuetify-theme-stylesheet",o.cspNonce&&D.setAttribute("nonce",o.cspNonce),P=D,document.head.appendChild(P)}P&&(P.innerHTML=_.value)}},P=Li?document.getElementById("vuetify-theme-stylesheet"):null;Ke(_,L,{immediate:!0})}}const w=ie(()=>o.isDisabled?void 0:`v-theme--${a.value}`);return{install:s,isDisabled:o.isDisabled,name:a,themes:c,current:m,computedThemes:d,themeClasses:w,styles:_,global:{name:a,current:m}}}function Si(e){Pr("provideTheme");const o=cn(zf,null);if(!o)throw new Error("Could not find Vuetify theme injection");const a=ie(()=>{var m;return(m=e.theme)!=null?m:o==null?void 0:o.name.value}),c=ie(()=>o.isDisabled?void 0:`v-theme--${a.value}`),d={...o,name:a,themeClasses:c};return Wi(zf,d),d}function CT(){Pr("useTheme");const e=cn(zf,null);if(!e)throw new Error("Could not find Vuetify theme injection");return e}function Ju(e,o,a){e.push(`${o} {
`,...a.map(c=>`  ${c};
`),`}
`)}function tL(e){const o=e.dark?2:1,a=e.dark?1:2,c=[];for(const[d,m]of Object.entries(e.colors)){const _=mT(m);c.push(`--v-theme-${d}: ${_.r},${_.g},${_.b}`),d.startsWith("on-")||c.push(`--v-theme-${d}-overlay-multiplier: ${dy(m)>.18?o:a}`)}return c}function S0(e){return m0(()=>{const o=[],a={};return e.value.background&&(xw(e.value.background)?a.backgroundColor=e.value.background:o.push(`bg-${e.value.background}`)),e.value.text&&(xw(e.value.text)?(a.color=e.value.text,a.caretColor=e.value.text):o.push(`text-${e.value.text}`)),{colorClasses:o,colorStyles:a}})}function so(e,o){const a=ie(()=>({text:zi(e)?e.value:o?e[o]:null})),{colorClasses:c,colorStyles:d}=S0(a);return{textColorClasses:c,textColorStyles:d}}function er(e,o){const a=ie(()=>({background:zi(e)?e.value:o?e[o]:null})),{colorClasses:c,colorStyles:d}=S0(a);return{backgroundColorClasses:c,backgroundColorStyles:d}}const nL=[null,"prominent","default","comfortable","compact"],IT=Ln({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:e=>nL.includes(e)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,..._o(),...cr(),...Bi(),...Cn({tag:"header"}),...Kn()},"v-toolbar"),vg=Di()({name:"VToolbar",props:IT(),setup(e,o){var a;let{slots:c}=o;const{backgroundColorClasses:d,backgroundColorStyles:m}=er(Et(e,"color")),{borderClasses:_}=$o(e),{elevationClasses:s}=zr(e),{roundedClasses:w}=tr(e),{themeClasses:E}=Si(e),A=He(!!(e.extended||(a=c.extension)!=null&&a.call(c))),P=ie(()=>parseInt(Number(e.height)+(e.density==="prominent"?Number(e.height):0)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0),10)),L=ie(()=>A.value?parseInt(Number(e.extensionHeight)+(e.density==="prominent"?Number(e.extensionHeight):0)-(e.density==="comfortable"?4:0)-(e.density==="compact"?8:0),10):0);return ar({VBtn:{variant:"text"}}),Mt(()=>{var D,N,Z,de,ne;const ce=!!(e.title||c.title),K=!!(c.image||e.image),Se=(D=c.extension)==null?void 0:D.call(c);return A.value=!!(e.extended||Se),F(e.tag,{class:["v-toolbar",{"v-toolbar--absolute":e.absolute,"v-toolbar--collapse":e.collapse,"v-toolbar--flat":e.flat,"v-toolbar--floating":e.floating,[`v-toolbar--density-${e.density}`]:!0},d.value,_.value,s.value,w.value,E.value],style:[m.value]},{default:()=>[K&&F("div",{key:"image",class:"v-toolbar__image"},[F(Ci,{defaults:{VImg:{cover:!0,src:e.image}}},{default:()=>[c.image?(N=c.image)==null?void 0:N.call(c):F(gh,null,null)]})]),F("div",{class:"v-toolbar__content",style:{height:Yt(P.value)}},[c.prepend&&F("div",{class:"v-toolbar__prepend"},[(Z=c.prepend)==null?void 0:Z.call(c)]),ce&&F(gg,{key:"title",text:e.title},{text:c.title}),(de=c.default)==null?void 0:de.call(c),c.append&&F("div",{class:"v-toolbar__append"},[(ne=c.append)==null?void 0:ne.call(c)])]),F(Ng,null,{default:()=>[A.value&&F("div",{class:"v-toolbar__extension",style:{height:Yt(L.value)}},[Se])]})]})}),{contentHeight:P,extensionHeight:L}}});function iL(e){var o;return Fo(e,Object.keys((o=vg==null?void 0:vg.props)!=null?o:{}))}function Rc(e){const o=He(),a=He();if(Li){const c=new ResizeObserver(d=>{e==null||e(d,c),d.length&&(a.value=d[0].contentRect)});Ai(()=>{c.disconnect()}),Ke(o,(d,m)=>{m&&(c.unobserve(m),a.value=void 0),d&&c.observe(d)},{flush:"post"})}return{resizeRef:o,contentRect:jf(a)}}const _g=Symbol.for("vuetify:layout"),AT=Symbol.for("vuetify:layout-item"),Pw=1e3,kT=Ln({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),vh=Ln({name:{type:String},order:{type:[Number,String],default:0},absolute:Boolean},"layout-item");function rL(){const e=cn(_g);if(!e)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:e.getLayoutItem,mainRect:e.mainRect,mainStyles:e.mainStyles}}function _h(e){var s;const o=cn(_g);if(!o)throw new Error("[Vuetify] Could not find injected layout");const a=(s=e.id)!=null?s:`layout-item-${Gr()}`,c=Pr("useLayoutItem");Wi(AT,{id:a});const d=He(!1);AE(()=>d.value=!0),IE(()=>d.value=!1);const{layoutItemStyles:m,layoutItemScrimStyles:_}=o.register(c,{...e,active:ie(()=>d.value?!1:e.active.value),id:a});return Ai(()=>o.unregister(a)),{layoutItemStyles:m,layoutRect:o.layoutRect,layoutItemScrimStyles:_}}const oL=(e,o,a,c)=>{let d={top:0,left:0,right:0,bottom:0};const m=[{id:"",layer:{...d}}];for(const _ of e){const s=o.get(_),w=a.get(_),E=c.get(_);if(!s||!w||!E)continue;const A={...d,[s.value]:parseInt(d[s.value],10)+(E.value?parseInt(w.value,10):0)};m.push({id:_,layer:A}),d=A}return m};function MT(e){const o=cn(_g,null),a=ie(()=>o?o.rootZIndex.value-100:Pw),c=He([]),d=$i(new Map),m=$i(new Map),_=$i(new Map),s=$i(new Map),w=$i(new Map),{resizeRef:E,contentRect:A}=Rc(),P=ie(()=>{var ve;const _e=new Map,fe=(ve=e.overlaps)!=null?ve:[];for(const Ee of fe.filter(be=>be.includes(":"))){const[be,Re]=Ee.split(":");if(!c.value.includes(be)||!c.value.includes(Re))continue;const ze=d.get(be),Je=d.get(Re),ct=m.get(be),nt=m.get(Re);!ze||!Je||!ct||!nt||(_e.set(Re,{position:ze.value,amount:parseInt(ct.value,10)}),_e.set(be,{position:Je.value,amount:-parseInt(nt.value,10)}))}return _e}),L=ie(()=>{const _e=[...new Set([..._.values()].map(ve=>ve.value))].sort((ve,Ee)=>ve-Ee),fe=[];for(const ve of _e){const Ee=c.value.filter(be=>{var Re;return((Re=_.get(be))==null?void 0:Re.value)===ve});fe.push(...Ee)}return oL(fe,d,m,s)}),D=ie(()=>!Array.from(w.values()).some(_e=>_e.value)),N=ie(()=>L.value[L.value.length-1].layer),Z=ie(()=>({"--v-layout-left":Yt(N.value.left),"--v-layout-right":Yt(N.value.right),"--v-layout-top":Yt(N.value.top),"--v-layout-bottom":Yt(N.value.bottom),...D.value?void 0:{transition:"none"}})),de=ie(()=>L.value.slice(1).map((_e,fe)=>{let{id:ve}=_e;const{layer:Ee}=L.value[fe],be=m.get(ve),Re=d.get(ve);return{id:ve,...Ee,size:Number(be.value),position:Re.value}})),ne=_e=>de.value.find(fe=>fe.id===_e),ce=Pr("createLayout"),K=He(!1);zn(()=>{K.value=!0}),Wi(_g,{register:(_e,fe)=>{let{id:ve,order:Ee,position:be,layoutSize:Re,elementSize:ze,active:Je,disableTransitions:ct,absolute:nt}=fe;_.set(ve,Ee),d.set(ve,be),m.set(ve,Re),s.set(ve,Je),ct&&w.set(ve,ct);const Pe=gf(AT,ce==null?void 0:ce.vnode).indexOf(_e);Pe>-1?c.value.splice(Pe,0,ve):c.value.push(ve);const at=ie(()=>de.value.findIndex(qt=>qt.id===ve)),Gt=ie(()=>a.value+L.value.length*2-at.value*2),pt=ie(()=>{const qt=be.value==="left"||be.value==="right",Bn=be.value==="right",kt=be.value==="bottom",Qe={[be.value]:0,zIndex:Gt.value,transform:`translate${qt?"X":"Y"}(${(Je.value?0:-110)*(Bn||kt?-1:1)}%)`,position:nt.value||a.value!==Pw?"absolute":"fixed",...D.value?void 0:{transition:"none"}};if(!K.value)return Qe;const bt=de.value[at.value];if(!bt)throw new Error(`[Vuetify] Could not find layout item "${ve}"`);const Tt=P.value.get(ve);return Tt&&(bt[Tt.position]+=Tt.amount),{...Qe,height:qt?`calc(100% - ${bt.top}px - ${bt.bottom}px)`:ze.value?`${ze.value}px`:void 0,left:Bn?void 0:`${bt.left}px`,right:Bn?`${bt.right}px`:void 0,top:be.value!=="bottom"?`${bt.top}px`:void 0,bottom:be.value!=="top"?`${bt.bottom}px`:void 0,width:qt?ze.value?`${ze.value}px`:void 0:`calc(100% - ${bt.left}px - ${bt.right}px)`}}),Lt=ie(()=>({zIndex:Gt.value-1}));return{layoutItemStyles:pt,layoutItemScrimStyles:Lt,zIndex:Gt}},unregister:_e=>{_.delete(_e),d.delete(_e),m.delete(_e),s.delete(_e),w.delete(_e),c.value=c.value.filter(fe=>fe!==_e)},mainRect:N,mainStyles:Z,getLayoutItem:ne,items:de,layoutRect:A,rootZIndex:a});const Se=ie(()=>["v-layout",{"v-layout--full-height":e.fullHeight}]),Y=ie(()=>({zIndex:a.value,position:o?"relative":void 0,overflow:o?"hidden":void 0}));return{layoutClasses:Se,layoutStyles:Y,getLayoutItem:ne,items:de,layoutRect:A,layoutRef:E}}function Lf(e,o){let a;Ke(e,c=>{if(c&&!a)a=Uf(),a.run(o);else{var d;(d=a)==null||d.stop(),a=void 0}},{immediate:!0})}function Tn(e,o,a){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:P=>P,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:P=>P;const m=Pr("useProxiedModel"),_=He(e[o]!==void 0?e[o]:a),s=p0(o),E=ie(s!==o?()=>{var P,L,D,N;return e[o],!!(((P=m.vnode.props)!=null&&P.hasOwnProperty(o)||(L=m.vnode.props)!=null&&L.hasOwnProperty(s))&&((D=m.vnode.props)!=null&&D.hasOwnProperty(`onUpdate:${o}`)||(N=m.vnode.props)!=null&&N.hasOwnProperty(`onUpdate:${s}`)))}:()=>{var P,L;return e[o],!!((P=m.vnode.props)!=null&&P.hasOwnProperty(o)&&(L=m.vnode.props)!=null&&L.hasOwnProperty(`onUpdate:${o}`))});Lf(()=>!E.value,()=>{Ke(()=>e[o],P=>{_.value=P})});const A=ie({get(){return c(E.value?e[o]:_.value)},set(P){const L=d(P);(E.value?e[o]:_.value)===L||c(E.value?e[o]:_.value)===P||(_.value=L,m==null||m.emit(`update:${o}`,L))}});return Object.defineProperty(A,"externalValue",{get:()=>E.value?e[o]:_.value}),A}const PT=zt({name:"VAppBar",props:{modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...IT(),...vh(),height:{type:[Number,String],default:64}},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=He(),d=Tn(e,"modelValue"),m=ie(()=>{var P,L;var s,w;const E=(P=(s=c.value)==null?void 0:s.contentHeight)!=null?P:0,A=(L=(w=c.value)==null?void 0:w.extensionHeight)!=null?L:0;return E+A}),{layoutItemStyles:_}=_h({id:e.name,order:ie(()=>parseInt(e.order,10)),position:Et(e,"location"),layoutSize:m,elementSize:m,active:d,absolute:Et(e,"absolute")});return Mt(()=>{const[s]=iL(e);return F(vg,tn({ref:c,class:["v-app-bar",{"v-app-bar--bottom":e.location==="bottom"}],style:{..._.value,height:void 0}},s),a)}),{}}});const sL=[null,"default","comfortable","compact"],vr=Ln({density:{type:String,default:"default",validator:e=>sL.includes(e)}},"density");function qr(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ba();return{densityClasses:ie(()=>`${o}--density-${e.density}`)}}const aL=["elevated","flat","tonal","outlined","text","plain"];function Vc(e,o){return F(Dn,null,[e&&F("span",{key:"overlay",class:`${o}__overlay`},null),F("span",{key:"underlay",class:`${o}__underlay`},null)])}const No=Ln({color:String,variant:{type:String,default:"elevated",validator:e=>aL.includes(e)}},"variant");function $c(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ba();const a=ie(()=>{const{variant:m}=pi(e);return`${o}--variant-${m}`}),{colorClasses:c,colorStyles:d}=S0(ie(()=>{const{variant:m,color:_}=pi(e);return{[["elevated","flat"].includes(m)?"background":"text"]:_}}));return{colorClasses:c,colorStyles:d,variantClasses:a}}const zT=zt({name:"VBtnGroup",props:{divided:Boolean,..._o(),...vr(),...cr(),...Bi(),...Cn(),...Kn(),...No()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=Si(e),{densityClasses:d}=qr(e),{borderClasses:m}=$o(e),{elevationClasses:_}=zr(e),{roundedClasses:s}=tr(e);ar({VBtn:{height:"auto",color:Et(e,"color"),density:Et(e,"density"),flat:!0,variant:Et(e,"variant")}}),Mt(()=>F(e.tag,{class:["v-btn-group",{"v-btn-group--divided":e.divided},c.value,m.value,d.value,_.value,s.value]},a))}}),yh=Ln({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),Nc=Ln({value:null,disabled:Boolean,selectedClass:String},"group-item");function xh(e,o){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const c=Pr("useGroupItem");if(!c)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const d=Gr();Wi(Symbol.for(`${o.description}:id`),d);const m=cn(o,null);if(!m){if(!a)return m;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${o.description}`)}const _=Et(e,"value"),s=ie(()=>m.disabled.value||e.disabled);m.register({id:d,value:_,disabled:s},c),Ai(()=>{m.unregister(d)});const w=ie(()=>m.isSelected(d)),E=ie(()=>w.value&&[m.selectedClass.value,e.selectedClass]);return Ke(w,A=>{c.emit("group:selected",{value:A})}),{id:d,isSelected:w,toggle:()=>m.select(d,!w.value),select:A=>m.select(d,A),selectedClass:E,value:_,disabled:s,group:m}}function Uc(e,o){let a=!1;const c=$i([]),d=Tn(e,"modelValue",[],L=>L==null?[]:LT(c,Ro(L)),L=>{const D=cL(c,L);return e.multiple?D:D[0]}),m=Pr("useGroup");function _(L,D){const N=L,Z=Symbol.for(`${o.description}:id`),ne=gf(Z,m==null?void 0:m.vnode).indexOf(D);ne>-1?c.splice(ne,0,N):c.push(N)}function s(L){if(a)return;w();const D=c.findIndex(N=>N.id===L);c.splice(D,1)}function w(){const L=c.find(D=>!D.disabled);L&&e.mandatory==="force"&&!d.value.length&&(d.value=[L.id])}zn(()=>{w()}),Ai(()=>{a=!0});function E(L,D){const N=c.find(Z=>Z.id===L);if(!(D&&N!=null&&N.disabled))if(e.multiple){const Z=d.value.slice(),de=Z.findIndex(ce=>ce===L),ne=~de;if(D=D!=null?D:!ne,ne&&e.mandatory&&Z.length<=1||!ne&&e.max!=null&&Z.length+1>e.max)return;de<0&&D?Z.push(L):de>=0&&!D&&Z.splice(de,1),d.value=Z}else{const Z=d.value.includes(L);if(e.mandatory&&Z)return;d.value=(D!=null?D:!Z)?[L]:[]}}function A(L){if(e.multiple&&Pc('This method is not supported when using "multiple" prop'),d.value.length){const D=d.value[0],N=c.findIndex(ne=>ne.id===D);let Z=(N+L)%c.length,de=c[Z];for(;de.disabled&&Z!==N;)Z=(Z+L)%c.length,de=c[Z];if(de.disabled)return;d.value=[c[Z].id]}else{const D=c.find(N=>!N.disabled);D&&(d.value=[D.id])}}const P={register:_,unregister:s,selected:d,select:E,disabled:Et(e,"disabled"),prev:()=>A(c.length-1),next:()=>A(1),isSelected:L=>d.value.includes(L),selectedClass:ie(()=>e.selectedClass),items:ie(()=>c),getItemIndex:L=>lL(c,L)};return Wi(o,P),P}function lL(e,o){const a=LT(e,[o]);return a.length?e.findIndex(c=>c.id===a[0]):-1}function LT(e,o){const a=[];for(let c=0;c<e.length;c++){const d=e[c];d.value!=null?o.find(m=>Gf(m,d.value))!=null&&a.push(d.id):o.includes(c)&&a.push(d.id)}return a}function cL(e,o){const a=[];for(let c=0;c<e.length;c++){const d=e[c];o.includes(d.id)&&a.push(d.value!=null?d.value:c)}return a}const E0=Symbol.for("vuetify:v-btn-toggle"),uL=Di()({name:"VBtnToggle",props:yh(),emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{isSelected:c,next:d,prev:m,select:_,selected:s}=Uc(e,E0);return Mt(()=>{var w;return F(zT,{class:"v-btn-toggle"},{default:()=>[(w=a.default)==null?void 0:w.call(a,{isSelected:c,next:d,prev:m,select:_,selected:s})]})}),{next:d,prev:m,select:_}}});const hL={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sort:"mdi-arrow-up",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus"},dL={component:e=>$s(T0,{...e,class:"mdi"})},mn=[String,Function,Object],my=Symbol.for("vuetify:icons"),jg=Ln({icon:{type:mn,required:!0},tag:{type:String,required:!0}},"icon"),RT=zt({name:"VComponentIcon",props:jg(),setup(e){return()=>F(e.tag,null,{default:()=>[F(e.icon,null,null)]})}}),DT=zt({name:"VSvgIcon",inheritAttrs:!1,props:jg(),setup(e,o){let{attrs:a}=o;return()=>F(e.tag,tn(a,{style:null}),{default:()=>[F("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[F("path",{d:e.icon},null)])]})}}),fL=zt({name:"VLigatureIcon",props:jg(),setup(e){return()=>F(e.tag,null,{default:()=>[e.icon]})}}),T0=zt({name:"VClassIcon",props:jg(),setup(e){return()=>F(e.tag,{class:e.icon},null)}}),pL={svg:{component:DT},class:{component:T0}};function mL(e){return ya({defaultSet:"mdi",sets:{...pL,mdi:dL},aliases:hL},e)}const gL=e=>{const o=cn(my);if(!o)throw new Error("Missing Vuetify Icons provide!");return{iconData:ie(()=>{const c=zi(e)?e.value:e.icon;if(!c)throw new Error("Icon value is undefined or null");let d=c;if(typeof c=="string"&&c.includes("$")){var m;d=(m=o.aliases)==null?void 0:m[c.slice(c.indexOf("$")+1)]}if(!d)throw new Error(`Could not find aliased icon "${c}"`);if(typeof d!="string")return{component:RT,icon:d};const _=Object.keys(o.sets).find(E=>typeof d=="string"&&d.startsWith(`${E}:`)),s=_?d.slice(_.length+1):d;return{component:o.sets[_!=null?_:o.defaultSet].component,icon:s}})}},vL=["x-small","small","default","large","x-large"],Sa=Ln({size:{type:[String,Number],default:"default"}},"size");function bh(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ba();return m0(()=>{let a,c;return hg(vL,e.size)?a=`${o}--size-${e.size}`:e.size&&(c={width:Yt(e.size),height:Yt(e.size)}),{sizeClasses:a,sizeStyles:c}})}const _L=Ln({color:String,start:Boolean,end:Boolean,icon:mn,...Sa(),...Cn({tag:"i"}),...Kn()},"v-icon"),Ni=zt({name:"VIcon",props:_L(),setup(e,o){let{attrs:a,slots:c}=o,d;c.default&&(d=ie(()=>{var A,P;const L=(A=c.default)==null?void 0:A.call(c);if(!!L)return(P=iT(L).filter(D=>D.children&&typeof D.children=="string")[0])==null?void 0:P.children}));const{themeClasses:m}=Si(e),{iconData:_}=gL(d||e),{sizeClasses:s}=bh(e),{textColorClasses:w,textColorStyles:E}=so(Et(e,"color"));return Mt(()=>F(_.value.component,{tag:e.tag,icon:_.value.icon,class:["v-icon","notranslate",m.value,s.value,w.value,{"v-icon--clickable":!!a.onClick,"v-icon--start":e.start,"v-icon--end":e.end}],style:[s.value?void 0:{fontSize:Yt(e.size),height:Yt(e.size),width:Yt(e.size)},E.value],role:a.onClick?"button":void 0,"aria-hidden":!a.onClick},null)),{}}});function C0(e){const o=He(),a=He(!1);if(x0){const c=new IntersectionObserver(d=>{e==null||e(d,c),a.value=!!d.find(m=>m.isIntersecting)});Ai(()=>{c.disconnect()}),Ke(o,(d,m)=>{m&&(c.unobserve(m),a.value=!1),d&&c.observe(d)},{flush:"post"})}return{intersectionRef:o,isIntersecting:a}}const I0=zt({name:"VProgressCircular",props:{bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...Sa(),...Cn({tag:"div"}),...Kn()},setup(e,o){let{slots:a}=o;const c=20,d=2*Math.PI*c,m=He(),{themeClasses:_}=Si(e),{sizeClasses:s,sizeStyles:w}=bh(e),{textColorClasses:E,textColorStyles:A}=so(Et(e,"color")),{textColorClasses:P,textColorStyles:L}=so(Et(e,"bgColor")),{intersectionRef:D,isIntersecting:N}=C0(),{resizeRef:Z,contentRect:de}=Rc(),ne=ie(()=>Math.max(0,Math.min(100,parseFloat(e.modelValue)))),ce=ie(()=>Number(e.width)),K=ie(()=>w.value?Number(e.size):de.value?de.value.width:Math.max(ce.value,32)),Se=ie(()=>c/(1-ce.value/K.value)*2),Y=ie(()=>ce.value/K.value*Se.value),_e=ie(()=>Yt((100-ne.value)/100*d));return Vs(()=>{D.value=m.value,Z.value=m.value}),Mt(()=>F(e.tag,{ref:m,class:["v-progress-circular",{"v-progress-circular--indeterminate":!!e.indeterminate,"v-progress-circular--visible":N.value,"v-progress-circular--disable-shrink":e.indeterminate==="disable-shrink"},_.value,s.value,E.value],style:[w.value,A.value],role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.indeterminate?void 0:ne.value},{default:()=>[F("svg",{style:{transform:`rotate(calc(-90deg + ${Number(e.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${Se.value} ${Se.value}`},[F("circle",{class:["v-progress-circular__underlay",P.value],style:L.value,fill:"transparent",cx:"50%",cy:"50%",r:c,"stroke-width":Y.value,"stroke-dasharray":d,"stroke-dashoffset":0},null),F("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:c,"stroke-width":Y.value,"stroke-dasharray":d,"stroke-dashoffset":_e.value},null)]),a.default&&F("div",{class:"v-progress-circular__content"},[a.default({value:ne.value})])]})),{}}});const gy=Symbol("rippleStop"),yL=80;function zw(e,o){e.style.transform=o,e.style.webkitTransform=o}function z_(e,o){e.style.opacity=`calc(${o} * var(--v-theme-overlay-multiplier))`}function vy(e){return e.constructor.name==="TouchEvent"}function BT(e){return e.constructor.name==="KeyboardEvent"}const xL=function(e,o){var a;let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d=0,m=0;if(!BT(e)){const L=o.getBoundingClientRect(),D=vy(e)?e.touches[e.touches.length-1]:e;d=D.clientX-L.left,m=D.clientY-L.top}let _=0,s=.3;(a=o._ripple)!=null&&a.circle?(s=.15,_=o.clientWidth/2,_=c.center?_:_+Math.sqrt((d-_)**2+(m-_)**2)/4):_=Math.sqrt(o.clientWidth**2+o.clientHeight**2)/2;const w=`${(o.clientWidth-_*2)/2}px`,E=`${(o.clientHeight-_*2)/2}px`,A=c.center?w:`${d-_}px`,P=c.center?E:`${m-_}px`;return{radius:_,scale:s,x:A,y:P,centerX:w,centerY:E}},yg={show(e,o){var a;let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(o!=null&&(a=o._ripple)!=null&&a.enabled))return;const d=document.createElement("span"),m=document.createElement("span");d.appendChild(m),d.className="v-ripple__container",c.class&&(d.className+=` ${c.class}`);const{radius:_,scale:s,x:w,y:E,centerX:A,centerY:P}=xL(e,o,c),L=`${_*2}px`;m.className="v-ripple__animation",m.style.width=L,m.style.height=L,o.appendChild(d);const D=window.getComputedStyle(o);D&&D.position==="static"&&(o.style.position="relative",o.dataset.previousPosition="static"),m.classList.add("v-ripple__animation--enter"),m.classList.add("v-ripple__animation--visible"),zw(m,`translate(${w}, ${E}) scale3d(${s},${s},${s})`),z_(m,0),m.dataset.activated=String(performance.now()),setTimeout(()=>{m.classList.remove("v-ripple__animation--enter"),m.classList.add("v-ripple__animation--in"),zw(m,`translate(${A}, ${P}) scale3d(1,1,1)`),z_(m,.08)},0)},hide(e){var o;if(!(e!=null&&(o=e._ripple)!=null&&o.enabled))return;const a=e.getElementsByClassName("v-ripple__animation");if(a.length===0)return;const c=a[a.length-1];if(c.dataset.isHiding)return;c.dataset.isHiding="true";const d=performance.now()-Number(c.dataset.activated),m=Math.max(250-d,0);setTimeout(()=>{c.classList.remove("v-ripple__animation--in"),c.classList.add("v-ripple__animation--out"),z_(c,0),setTimeout(()=>{e.getElementsByClassName("v-ripple__animation").length===1&&e.dataset.previousPosition&&(e.style.position=e.dataset.previousPosition,delete e.dataset.previousPosition),c.parentNode&&e.removeChild(c.parentNode)},300)},m)}};function OT(e){return typeof e>"u"||!!e}function Rf(e){const o={},a=e.currentTarget;if(!(!(a!=null&&a._ripple)||a._ripple.touched||e[gy])){if(e[gy]=!0,vy(e))a._ripple.touched=!0,a._ripple.isTouch=!0;else if(a._ripple.isTouch)return;if(o.center=a._ripple.centered||BT(e),a._ripple.class&&(o.class=a._ripple.class),vy(e)){if(a._ripple.showTimerCommit)return;a._ripple.showTimerCommit=()=>{yg.show(e,a,o)},a._ripple.showTimer=window.setTimeout(()=>{var c;a!=null&&(c=a._ripple)!=null&&c.showTimerCommit&&(a._ripple.showTimerCommit(),a._ripple.showTimerCommit=null)},yL)}else yg.show(e,a,o)}}function Lw(e){e[gy]=!0}function po(e){const o=e.currentTarget;if(!(!o||!o._ripple)){if(window.clearTimeout(o._ripple.showTimer),e.type==="touchend"&&o._ripple.showTimerCommit){o._ripple.showTimerCommit(),o._ripple.showTimerCommit=null,o._ripple.showTimer=window.setTimeout(()=>{po(e)});return}window.setTimeout(()=>{o._ripple&&(o._ripple.touched=!1)}),yg.hide(o)}}function FT(e){const o=e.currentTarget;!o||!o._ripple||(o._ripple.showTimerCommit&&(o._ripple.showTimerCommit=null),window.clearTimeout(o._ripple.showTimer))}let Df=!1;function VT(e){!Df&&(e.keyCode===mw.enter||e.keyCode===mw.space)&&(Df=!0,Rf(e))}function $T(e){Df=!1,po(e)}function NT(e){Df&&(Df=!1,po(e))}function UT(e,o,a){var _;const{value:c,modifiers:d}=o,m=OT(c);if(m||yg.hide(e),e._ripple=(_=e._ripple)!=null?_:{},e._ripple.enabled=m,e._ripple.centered=d.center,e._ripple.circle=d.circle,ay(c)&&c.class&&(e._ripple.class=c.class),m&&!a){if(d.stop){e.addEventListener("touchstart",Lw,{passive:!0}),e.addEventListener("mousedown",Lw);return}e.addEventListener("touchstart",Rf,{passive:!0}),e.addEventListener("touchend",po,{passive:!0}),e.addEventListener("touchmove",FT,{passive:!0}),e.addEventListener("touchcancel",po),e.addEventListener("mousedown",Rf),e.addEventListener("mouseup",po),e.addEventListener("mouseleave",po),e.addEventListener("keydown",VT),e.addEventListener("keyup",$T),e.addEventListener("blur",NT),e.addEventListener("dragstart",po,{passive:!0})}else!m&&a&&jT(e)}function jT(e){e.removeEventListener("mousedown",Rf),e.removeEventListener("touchstart",Rf),e.removeEventListener("touchend",po),e.removeEventListener("touchmove",FT),e.removeEventListener("touchcancel",po),e.removeEventListener("mouseup",po),e.removeEventListener("mouseleave",po),e.removeEventListener("keydown",VT),e.removeEventListener("keyup",$T),e.removeEventListener("dragstart",po),e.removeEventListener("blur",NT)}function bL(e,o){UT(e,o,!1)}function wL(e){delete e._ripple,jT(e)}function SL(e,o){if(o.value===o.oldValue)return;const a=OT(o.oldValue);UT(e,o,a)}const wl={mounted:bL,unmounted:wL,updated:SL};const EL={badge:"Badge",close:"Close",dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},datePicker:{itemsSelected:"{0} selected",nextMonthAriaLabel:"Next month",nextYearAriaLabel:"Next year",prevMonthAriaLabel:"Previous month",prevYearAriaLabel:"Previous year"},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Goto Page {0}",currentPage:"Page {0}, Current Page",first:"First page",last:"Last page"}},rating:{ariaLabel:{item:"Rating {0} of {1}"}}},Rw="$vuetify.",Dw=(e,o)=>e.replace(/\{(\d+)\}/g,(a,c)=>String(o[+c])),GT=(e,o,a)=>function(c){for(var d=arguments.length,m=new Array(d>1?d-1:0),_=1;_<d;_++)m[_-1]=arguments[_];if(!c.startsWith(Rw))return Dw(c,m);const s=c.replace(Rw,""),w=e.value&&a.value[e.value],E=o.value&&a.value[o.value];let A=sy(w,s,null);return A||(Pc(`Translation key "${c}" not found in "${e.value}", trying fallback locale`),A=sy(E,s,null)),A||(hy(`Translation key "${c}" not found in fallback`),A=c),typeof A!="string"&&(hy(`Translation key "${c}" has a non-string value`),A=c),Dw(A,m)};function qT(e,o){return(a,c)=>new Intl.NumberFormat([e.value,o.value],c).format(a)}function L_(e,o,a){var d,m;const c=Tn(e,o,(d=e[o])!=null?d:a.value);return c.value=(m=e[o])!=null?m:a.value,Ke(a,_=>{e[o]==null&&(c.value=a.value)}),c}function ZT(e){return o=>{const a=L_(o,"locale",e.current),c=L_(o,"fallback",e.fallback),d=L_(o,"messages",e.messages);return{name:"vuetify",current:a,fallback:c,messages:d,t:GT(a,c,d),n:qT(a,c),provide:ZT({current:a,fallback:c,messages:d})}}}function TL(e){var d,m;const o=He((d=e==null?void 0:e.locale)!=null?d:"en"),a=He((m=e==null?void 0:e.fallback)!=null?m:"en"),c=He({en:EL,...e==null?void 0:e.messages});return{name:"vuetify",current:o,fallback:a,messages:c,t:GT(o,a,c),n:qT(o,a),provide:ZT({current:o,fallback:a,messages:c})}}const CL={af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!1,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1},hh=Symbol.for("vuetify:locale");function IL(e){return e.name!=null}function AL(e){const o=e!=null&&e.adapter&&IL(e==null?void 0:e.adapter)?e==null?void 0:e.adapter:TL(e),a=ML(o,e);return{...o,...a}}function us(){const e=cn(hh);if(!e)throw new Error("[Vuetify] Could not find injected locale instance");return e}function kL(e){const o=cn(hh);if(!o)throw new Error("[Vuetify] Could not find injected locale instance");const a=o.provide(e),c=PL(a,o.rtl,e),d={...a,...c};return Wi(hh,d),d}function ML(e,o){var d;const a=He((d=o==null?void 0:o.rtl)!=null?d:CL),c=ie(()=>{var m;return(m=a.value[e.current.value])!=null?m:!1});return{isRtl:c,rtl:a,rtlClasses:ie(()=>`v-locale--is-${c.value?"rtl":"ltr"}`)}}function PL(e,o,a){const c=ie(()=>{var d,m;return(m=(d=a.rtl)!=null?d:o.value[e.current.value])!=null?m:!1});return{isRtl:c,rtl:o,rtlClasses:ie(()=>`v-locale--is-${c.value?"rtl":"ltr"}`)}}function Ea(){const e=cn(hh);if(!e)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:e.isRtl,rtlClasses:e.rtlClasses}}const A0=zt({name:"VProgressLinear",props:{active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,...Bi(),...Cn(),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=Tn(e,"modelValue"),{isRtl:d}=Ea(),{themeClasses:m}=Si(e),{textColorClasses:_,textColorStyles:s}=so(e,"color"),{backgroundColorClasses:w,backgroundColorStyles:E}=er(ie(()=>e.bgColor||e.color)),{backgroundColorClasses:A,backgroundColorStyles:P}=er(e,"color"),{roundedClasses:L}=tr(e),{intersectionRef:D,isIntersecting:N}=C0(),Z=ie(()=>parseInt(e.max,10)),de=ie(()=>parseInt(e.height,10)),ne=ie(()=>parseFloat(e.bufferValue)/Z.value*100),ce=ie(()=>parseFloat(c.value)/Z.value*100),K=ie(()=>d.value!==e.reverse),Se=ie(()=>e.indeterminate?"fade-transition":"slide-x-transition"),Y=ie(()=>e.bgOpacity==null?e.bgOpacity:parseFloat(e.bgOpacity));function _e(fe){if(!D.value)return;const{left:ve,right:Ee,width:be}=D.value.getBoundingClientRect(),Re=K.value?be-fe.clientX+(Ee-be):fe.clientX-ve;c.value=Math.round(Re/be*Z.value)}return Mt(()=>F(e.tag,{ref:D,class:["v-progress-linear",{"v-progress-linear--active":e.active&&N.value,"v-progress-linear--reverse":K.value,"v-progress-linear--rounded":e.rounded,"v-progress-linear--rounded-bar":e.roundedBar,"v-progress-linear--striped":e.striped},L.value,m.value],style:{height:e.active?Yt(de.value):0,"--v-progress-linear-height":Yt(de.value)},role:"progressbar","aria-valuemin":"0","aria-valuemax":e.max,"aria-valuenow":e.indeterminate?void 0:ce.value,onClick:e.clickable&&_e},{default:()=>[e.stream&&F("div",{key:"stream",class:["v-progress-linear__stream",_.value],style:{...s.value,[K.value?"left":"right"]:Yt(-de.value),borderTop:`${Yt(de.value/2)} dotted`,opacity:Y.value,top:`calc(50% - ${Yt(de.value/4)})`,width:Yt(100-ne.value,"%"),"--v-progress-linear-stream-to":Yt(de.value*(K.value?1:-1))}},null),F("div",{class:["v-progress-linear__background",w.value],style:[E.value,{opacity:Y.value,width:Yt(e.stream?ne.value:100,"%")}]},null),F(Fs,{name:Se.value},{default:()=>[e.indeterminate?F("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(fe=>F("div",{key:fe,class:["v-progress-linear__indeterminate",fe,A.value],style:P.value},null))]):F("div",{class:["v-progress-linear__determinate",A.value],style:[P.value,{width:Yt(ce.value,"%")}]},null)]}),a.default&&F("div",{class:"v-progress-linear__content"},[a.default({value:ce.value,buffer:ne.value})])]})),{}}}),k0=Ln({loading:Boolean},"loader");function Gg(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ba();return{loaderClasses:ie(()=>({[`${o}--loading`]:e.loading}))}}function M0(e,o){var a;let{slots:c}=o;return F("div",{class:`${e.name}__loader`},[((a=c.default)==null?void 0:a.call(c,{color:e.color,isActive:e.active}))||F(A0,{active:e.active,color:e.color,height:"2",indeterminate:!0},null)])}const Bw={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},jc=Ln({location:String},"location");function Gc(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=arguments.length>2?arguments[2]:void 0;const{isRtl:c}=Ea();return{locationStyles:ie(()=>{if(!e.location)return{};const{side:m,align:_}=cy(e.location.split(" ").length>1?e.location:`${e.location} center`,c.value);function s(E){return a?a(E):0}const w={};return m!=="center"&&(o?w[Bw[m]]=`calc(100% - ${s(m)}px)`:w[m]=0),_!=="center"?o?w[Bw[_]]=`calc(100% - ${s(_)}px)`:w[_]=0:(m==="center"?w.top=w.left="50%":w[{top:"left",bottom:"left",left:"top",right:"top"}[m]]="50%",w.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[m]),w})}}const zL=["static","relative","fixed","absolute","sticky"],wh=Ln({position:{type:String,validator:e=>zL.includes(e)}},"position");function Sh(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ba();return{positionClasses:ie(()=>e.position?`${o}--${e.position}`:void 0)}}function WT(){var e,o;return(e=Pr("useRouter"))==null||(o=e.proxy)==null?void 0:o.$router}function qf(e,o){const a=NM("RouterLink"),c=ie(()=>!!(e.href||e.to)),d=ie(()=>(c==null?void 0:c.value)||!!(o.onClick||o.onClickOnce));if(typeof a=="string")return{isLink:c,isClickable:d,href:Et(e,"href")};const m=e.to?a.useLink(e):void 0;return{isLink:c,isClickable:d,route:m==null?void 0:m.route,navigate:m==null?void 0:m.navigate,isActive:m&&ie(()=>{var _,s;return e.exact?(_=m.isExactActive)==null?void 0:_.value:(s=m.isActive)==null?void 0:s.value}),href:ie(()=>e.to?m==null?void 0:m.route.value.href:e.href)}}const Eh=Ln({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let R_=!1;function LL(e,o){let a=!1,c,d;Li&&(Xi(()=>{window.addEventListener("popstate",m),c=e==null?void 0:e.beforeEach((_,s,w)=>{R_?a?o(w):w():setTimeout(()=>a?o(w):w()),R_=!0}),d=e==null?void 0:e.afterEach(()=>{R_=!1})}),Dc(()=>{var _,s;window.removeEventListener("popstate",m),(_=c)==null||_(),(s=d)==null||s()}));function m(_){var s;(s=_.state)!=null&&s.replaced||(a=!0,setTimeout(()=>a=!1))}}function RL(e,o){Ke(()=>{var a;return(a=e.isActive)==null?void 0:a.value},a=>{e.isLink.value&&a&&o&&Xi(()=>{o(!0)})},{immediate:!0})}const wi=zt({name:"VBtn",directives:{Ripple:wl},props:{active:{type:Boolean,default:void 0},symbol:{type:null,default:E0},flat:Boolean,icon:[Boolean,String,Function,Object],prependIcon:mn,appendIcon:mn,block:Boolean,stacked:Boolean,ripple:{type:Boolean,default:!0},..._o(),...Bi(),...vr(),...ls(),...cr(),...Nc(),...k0(),...jc(),...wh(),...Eh(),...Sa(),...Cn({tag:"button"}),...Kn(),...No({variant:"elevated"})},emits:{"group:selected":e=>!0},setup(e,o){let{attrs:a,slots:c}=o;const{themeClasses:d}=Si(e),{borderClasses:m}=$o(e),{colorClasses:_,colorStyles:s,variantClasses:w}=$c(e),{densityClasses:E}=qr(e),{dimensionStyles:A}=cs(e),{elevationClasses:P}=zr(e),{loaderClasses:L}=Gg(e),{locationStyles:D}=Gc(e),{positionClasses:N}=Sh(e),{roundedClasses:Z}=tr(e),{sizeClasses:de,sizeStyles:ne}=bh(e),ce=xh(e,e.symbol,!1),K=qf(e,a),Se=ie(()=>{var fe;return e.active!==!1&&(e.active||((fe=K.isActive)==null?void 0:fe.value)||(ce==null?void 0:ce.isSelected.value))}),Y=ie(()=>(ce==null?void 0:ce.disabled.value)||e.disabled),_e=ie(()=>e.variant==="elevated"&&!(e.disabled||e.flat||e.border));return RL(K,ce==null?void 0:ce.select),Mt(()=>{var fe,ve,Ee,be;const Re=K.isLink.value?"a":e.tag,ze=!ce||ce.isSelected.value,Je=!!(e.prependIcon||c.prepend),ct=!!(e.appendIcon||c.append),nt=!!(e.icon&&e.icon!==!0);return Yi(F(Re,{type:Re==="a"?void 0:"button",class:["v-btn",ce==null?void 0:ce.selectedClass.value,{"v-btn--active":Se.value,"v-btn--block":e.block,"v-btn--disabled":Y.value,"v-btn--elevated":_e.value,"v-btn--flat":e.flat,"v-btn--icon":!!e.icon,"v-btn--loading":e.loading,"v-btn--stacked":e.stacked},d.value,m.value,ze?_.value:void 0,E.value,P.value,L.value,N.value,Z.value,de.value,w.value],style:[ze?s.value:void 0,A.value,D.value,ne.value],disabled:Y.value||void 0,href:K.href.value,onClick:ft=>{var Pe;Y.value||((Pe=K.navigate)==null||Pe.call(K,ft),ce==null||ce.toggle())}},{default:()=>{var ft;return[Vc(!0,"v-btn"),!e.icon&&Je&&F(Ci,{key:"prepend",defaults:{VIcon:{icon:e.prependIcon}}},{default:()=>{var Pe;return[F("span",{class:"v-btn__prepend"},[(Pe=(fe=c.prepend)==null?void 0:fe.call(c))!=null?Pe:F(Ni,null,null)])]}}),F("span",{class:"v-btn__content","data-no-activator":""},[F(Ci,{key:"content",defaults:{VIcon:{icon:nt?e.icon:void 0}}},{default:()=>{var Pe;return[(Pe=(ve=c.default)==null?void 0:ve.call(c))!=null?Pe:nt&&F(Ni,{key:"icon"},null)]}})]),!e.icon&&ct&&F(Ci,{key:"append",defaults:{VIcon:{icon:e.appendIcon}}},{default:()=>{var Pe;return[F("span",{class:"v-btn__append"},[(Pe=(Ee=c.append)==null?void 0:Ee.call(c))!=null?Pe:F(Ni,null,null)])]}}),!!e.loading&&F("span",{key:"loader",class:"v-btn__loader"},[(ft=(be=c.loader)==null?void 0:be.call(c))!=null?ft:F(I0,{color:typeof e.loading=="boolean"?void 0:e.loading,indeterminate:!0,size:"23",width:"2"},null)])]}}),[[go("ripple"),!Y.value&&e.ripple,null]])}),{}}}),HT=zt({name:"VAppBarNavIcon",props:{icon:{type:mn,default:"$menu"}},setup(e,o){let{slots:a}=o;return Mt(()=>F(wi,{class:"v-app-bar-nav-icon",icon:e.icon},a)),{}}}),DL=zt({name:"VToolbarItems",props:No({variant:"text"}),setup(e,o){let{slots:a}=o;return ar({VBtn:{color:Et(e,"color"),height:"inherit",variant:Et(e,"variant")}}),Mt(()=>{var c;return F("div",{class:"v-toolbar-items"},[(c=a.default)==null?void 0:c.call(a)])}),{}}}),BL=zt({name:"VAppBarTitle",props:{...gg.props},setup(e,o){let{slots:a}=o;return Mt(()=>F(gg,{class:"v-app-bar-title"},a)),{}}}),OL={};function FL(e,o){return fi(),Mr(PT,{color:"#303F9F",elevation:"1",height:"50"},{prepend:wn(()=>[F(HT,{class:"text-white"})]),_:1})}const VL=Oo(OL,[["render",FL]]);const XT=zt({name:"VLayout",props:kT(),setup(e,o){let{slots:a}=o;const{layoutClasses:c,layoutStyles:d,getLayoutItem:m,items:_,layoutRef:s}=MT(e);return Mt(()=>{var w;return F("div",{ref:s,class:c.value,style:d.value},[(w=a.default)==null?void 0:w.call(a)])}),{getLayoutItem:m,items:_}}});const $L=zt({name:"VLayoutItem",props:{position:{type:String,required:!0},size:{type:[Number,String],default:300},modelValue:Boolean,...vh()},setup(e,o){let{slots:a}=o;const{layoutItemStyles:c}=_h({id:e.name,order:ie(()=>parseInt(e.order,10)),position:Et(e,"position"),elementSize:Et(e,"size"),layoutSize:Et(e,"size"),active:Et(e,"modelValue"),absolute:Et(e,"absolute")});return()=>{var d;return F("div",{class:["v-layout-item"],style:c.value},[(d=a.default)==null?void 0:d.call(a)])}}});function P0(){const e=He(!1);return zn(()=>{window.requestAnimationFrame(()=>{e.value=!0})}),{ssrBootStyles:ie(()=>e.value?void 0:{transition:"none !important"}),isBooted:jf(e)}}const YT=zt({name:"VMain",props:{scrollable:Boolean,...Cn({tag:"main"})},setup(e,o){let{slots:a}=o;const{mainStyles:c}=rL(),{ssrBootStyles:d}=P0();return Mt(()=>{var m,_;return F(e.tag,{class:["v-main",{"v-main--scrollable":e.scrollable}],style:[c.value,d.value]},{default:()=>[e.scrollable?F("div",{class:"v-main__scroller"},[(m=a.default)==null?void 0:m.call(a)]):(_=a.default)==null?void 0:_.call(a)]})}),{}}}),NL=vn({__name:"MainLayout",setup(e){const o=He();return zn(()=>{const a=o.value.$el.clientHeight;document.documentElement.style.setProperty("--tab-height",`${a}px`),document.documentElement.style.setProperty("--draw-width","50px")}),(a,c)=>{const d=zo("router-view");return fi(),Mr(XT,null,{default:wn(()=>[F(YT,{class:"custom-background"},{default:wn(()=>[F(VL,{ref_key:"tab",ref:o},null,512),F(d,{class:"map",name:"main_view"})]),_:1}),F(d,{class:"draw",name:"left_draw"})]),_:1})}}});const UL=Oo(NL,[["__scopeId","data-v-97032754"]]),jL={components:{MainLayout:UL}};function GL(e,o,a,c,d,m){const _=zo("MainLayout");return fi(),Mr(_)}const qL=Oo(jL,[["render",GL],["__scopeId","data-v-2cc332ae"]]);var ZL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},z0={exports:{}};(function(e,o){(function(a,c){e.exports=c()})(ZL,function(){var a,c,d;function m(s,w){if(!a)a=w;else if(!c)c=w;else{var E="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+c+")(sharedChunk); self.onerror = null;",A={};a(A),d=w(A),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([E],{type:"text/javascript"})))}}m(["exports"],function(s){var w=typeof self<"u"?self:{},E="2.13.0";let A;const P={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(A==null){const n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{A={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):n}catch{A=n}}return A},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},L={supported:!1,testSupport:function(n){!Z&&N&&(de?ne(n):D=n)}};let D,N,Z=!1,de=!1;function ne(n){const t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,N),n.isContextLost())return;L.supported=!0}catch{}n.deleteTexture(t),Z=!0}w.document&&(N=w.document.createElement("img"),N.onload=function(){D&&ne(D),D=null,de=!0},N.onerror=function(){Z=!0,D=null},N.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ce="01";var K=Se;function Se(n,t,i,l){this.cx=3*n,this.bx=3*(i-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=t,this.p2x=i,this.p2y=l}Se.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,t){if(t===void 0&&(t=1e-6),n<0)return 0;if(n>1)return 1;for(var i=n,l=0;l<8;l++){var h=this.sampleCurveX(i)-n;if(Math.abs(h)<t)return i;var p=this.sampleCurveDerivativeX(i);if(Math.abs(p)<1e-6)break;i-=h/p}var v=0,x=1;for(i=n,l=0;l<20&&(h=this.sampleCurveX(i),!(Math.abs(h-n)<t));l++)n>h?v=i:x=i,i=.5*(x-v)+v;return i},solve:function(n,t){return this.sampleCurveY(this.solveCurveX(n,t))}};var Y=_e;function _e(n,t){this.x=n,this.y=t}_e.prototype={clone:function(){return new _e(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,t){return this.clone()._rotateAround(n,t)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var t=n.x-this.x,i=n.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,t){return Math.atan2(this.x*t-this.y*n,this.x*n+this.y*t)},_matMult:function(n){var t=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=t,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var t=Math.cos(n),i=Math.sin(n),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(n,t){var i=Math.cos(n),l=Math.sin(n),h=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},_e.convert=function(n){return n instanceof _e?n:Array.isArray(n)?new _e(n[0],n[1]):n};const fe=Math.PI/180,ve=180/Math.PI;function Ee(n){return n*fe}function be(n){return n*ve}const Re=[[0,0],[1,0],[1,1],[0,1]];function ze(n){if(n<=0)return 0;if(n>=1)return 1;const t=n*n,i=t*n;return 4*(n<.5?i:3*(n-t)+i-.75)}function Je(n,t,i,l){const h=new K(n,t,i,l);return function(p){return h.solve(p)}}const ct=Je(.25,.1,.25,1);function nt(n,t,i){return Math.min(i,Math.max(t,n))}function ft(n,t,i){return(i=nt((i-n)/(t-n),0,1))*i*(3-2*i)}function Pe(n,t,i){const l=i-t,h=((n-t)%l+l)%l+t;return h===t?i:h}function at(n,t,i){if(!n.length)return i(null,[]);let l=n.length;const h=new Array(n.length);let p=null;n.forEach((v,x)=>{t(v,(S,T)=>{S&&(p=S),h[x]=T,--l==0&&i(p,h)})})}function Gt(n){const t=[];for(const i in n)t.push(n[i]);return t}function pt(n,...t){for(const i of t)for(const l in i)n[l]=i[l];return n}let Lt=1;function qt(){return Lt++}function Bn(){return function n(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,n)}()}function kt(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Qe(n){return!!n&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)}function bt(n,t){n.forEach(i=>{t[i]&&(t[i]=t[i].bind(t))})}function Tt(n,t){return n.indexOf(t,n.length-t.length)!==-1}function Ut(n,t,i){const l={};for(const h in n)l[h]=t.call(i||this,n[h],h,n);return l}function pn(n,t,i){const l={};for(const h in n)t.call(i||this,n[h],h,n)&&(l[h]=n[h]);return l}function Fn(n){return Array.isArray(n)?n.map(Fn):typeof n=="object"&&n?Ut(n,Fn):n}const _n={};function he(n){_n[n]||(typeof console<"u"&&console.warn(n),_n[n]=!0)}function Me(n,t,i){return(i.y-n.y)*(t.x-n.x)>(t.y-n.y)*(i.x-n.x)}function qe(n){let t=0;for(let i,l,h=0,p=n.length,v=p-1;h<p;v=h++)i=n[h],l=n[v],t+=(l.x-i.x)*(i.y+l.y);return t}function st(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function yt(n){const t={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,l,h,p)=>{const v=h||p;return t[l]=!v||v.toLowerCase(),""}),t["max-age"]){const i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}let Rt=null;function $t(n){if(Rt==null){const t=n.navigator?n.navigator.userAgent:null;Rt=!!n.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Rt}function Pt(n){try{const t=w[n];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ft(n,t){return[n[4*t],n[4*t+1],n[4*t+2],n[4*t+3]]}const St="mapbox-tiles";let Jt,Wt,on=500,fn=50;function In(){try{return w.caches}catch{}}function Gn(){In()&&!Jt&&(Jt=w.caches.open(St))}function qn(n){const t=n.indexOf("?");if(t<0)return n;const i=function(h){const p=h.indexOf("?");return p>0?h.slice(p+1).split("&"):[]}(n),l=i.filter(h=>{const p=h.split("=");return p[0]==="language"||p[0]==="worldview"});return l.length?`${n.slice(0,t)}?${l.join("&")}`:n.slice(0,t)}let _i=1/0;const or={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(or);class Ki extends Error{constructor(t,i,l){i===401&&Zs(l)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=i,this.url=l}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ds=st()?()=>self.worker&&self.worker.referrer:()=>(w.location.protocol==="blob:"?w.parent:w).location.href,Lr=function(n,t){if(!(/^file:/.test(i=n.url)||/^file:/.test(ds())&&!/^\w+:/.test(i))){if(w.fetch&&w.Request&&w.AbortController&&w.Request.prototype.hasOwnProperty("signal"))return function(l,h){const p=new w.AbortController,v=new w.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:ds(),signal:p.signal});let x=!1,S=!1;const T=(k=v.url).indexOf("sku=")>0&&Zs(k);var k;l.type==="json"&&v.headers.set("Accept","application/json");const z=(V,$,G)=>{if(S)return;if(V&&V.message!=="SecurityError"&&he(V),$&&G)return R($);const X=Date.now();w.fetch(v).then(le=>{if(le.ok){const ye=T?le.clone():null;return R(le,ye,X)}return h(new Ki(le.statusText,le.status,l.url))}).catch(le=>{le.name!=="AbortError"&&h(new Error(`${le.message} ${l.url}`))})},R=(V,$,G)=>{(l.type==="arrayBuffer"?V.arrayBuffer():l.type==="json"?V.json():V.text()).then(X=>{S||($&&G&&function(le,ye,re){if(Gn(),!Jt)return;const ge={status:ye.status,statusText:ye.statusText,headers:new w.Headers};ye.headers.forEach((je,$e)=>ge.headers.set($e,je));const Te=yt(ye.headers.get("Cache-Control")||"");if(Te["no-store"])return;Te["max-age"]&&ge.headers.set("Expires",new Date(re+1e3*Te["max-age"]).toUTCString());const xe=ge.headers.get("Expires");xe&&(new Date(xe).getTime()-re<42e4||function(je,$e){if(Wt===void 0)try{new Response(new ReadableStream),Wt=!0}catch{Wt=!1}Wt?$e(je.body):je.blob().then($e)}(ye,je=>{const $e=new w.Response(je,ge);Gn(),Jt&&Jt.then(tt=>tt.put(qn(le.url),$e)).catch(tt=>he(tt.message))}))}(v,$,G),x=!0,h(null,X,V.headers.get("Cache-Control"),V.headers.get("Expires")))}).catch(X=>{S||h(new Error(X.message))})};return T?function(V,$){if(Gn(),!Jt)return $(null);const G=qn(V.url);Jt.then(X=>{X.match(G).then(le=>{const ye=function(re){if(!re)return!1;const ge=new Date(re.headers.get("Expires")||0),Te=yt(re.headers.get("Cache-Control")||"");return ge>Date.now()&&!Te["no-cache"]}(le);X.delete(G),ye&&X.put(G,le.clone()),$(null,le,ye)}).catch($)}).catch($)}(v,z):z(null,null),{cancel:()=>{S=!0,x||p.abort()}}}(n,t);if(st()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,t,void 0,!0)}var i;return function(l,h){const p=new w.XMLHttpRequest;p.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(p.responseType="arraybuffer");for(const v in l.headers)p.setRequestHeader(v,l.headers[v]);return l.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=l.credentials==="include",p.onerror=()=>{h(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){let v=p.response;if(l.type==="json")try{v=JSON.parse(p.response)}catch(x){return h(x)}h(null,v,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else h(new Ki(p.statusText,p.status,l.url))},p.send(l.body),{cancel:()=>p.abort()}}(n,t)},yo=function(n,t){return Lr(pt(n,{type:"arrayBuffer"}),t)};function nr(n){const t=w.document.createElement("a");return t.href=n,t.protocol===w.document.location.protocol&&t.host===w.document.location.host}const ur="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let jo,Gs;jo=[],Gs=0;const El=function(n,t){if(L.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),Gs>=P.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:n,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return jo.push(p),p}Gs++;let i=!1;const l=()=>{if(!i)for(i=!0,Gs--;jo.length&&Gs<P.MAX_PARALLEL_IMAGE_REQUESTS;){const p=jo.shift(),{requestParameters:v,callback:x,cancelled:S}=p;S||(p.cancel=El(v,x).cancel)}},h=yo(n,(p,v,x,S)=>{l(),p?t(p):v&&(w.createImageBitmap?function(T,k){const z=new w.Blob([new Uint8Array(T)],{type:"image/png"});w.createImageBitmap(z).then(R=>{k(null,R)}).catch(R=>{k(new Error(`Could not load image because of ${R.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(T,k)=>t(T,k,x,S)):function(T,k){const z=new w.Image,R=w.URL;z.onload=()=>{k(null,z),R.revokeObjectURL(z.src),z.onload=null,w.requestAnimationFrame(()=>{z.src=ur})},z.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const V=new w.Blob([new Uint8Array(T)],{type:"image/png"});z.src=T.byteLength?R.createObjectURL(V):ur}(v,(T,k)=>t(T,k,x,S)))});return{cancel:()=>{h.cancel(),l()}}},qs="NO_ACCESS_TOKEN";function lo(n){return n.indexOf("mapbox:")===0}function Zs(n){return P.API_URL_REGEX.test(n)}function Zc(n){return P.API_CDN_URL_REGEX.test(n)}function Wc(n){return P.API_STYLE_REGEX.test(n)&&!Ia(n)}function Ia(n){return P.API_SPRITE_REGEX.test(n)}const Ws=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Zr(n){const t=n.match(Ws);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function fs(n){const t=n.params.length?`?${n.params.join("&")}`:"";return`${n.protocol}://${n.authority}${n.path}${t}`}function Hc(n){if(!n)return null;const t=n.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(w.atob(t[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Hs{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const i=Hc(P.ACCESS_TOKEN);let l="";return l=i&&i.u?w.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(h,p)=>String.fromCharCode(Number("0x"+p)))):P.ACCESS_TOKEN||"",t?`mapbox.eventData.${t}:${l}`:`mapbox.eventData:${l}`}fetchEventData(){const t=Pt("localStorage"),i=this.getStorageKey(),l=this.getStorageKey("uuid");if(t)try{const h=w.localStorage.getItem(i);h&&(this.eventData=JSON.parse(h));const p=w.localStorage.getItem(l);p&&(this.anonId=p)}catch{he("Unable to read from LocalStorage")}}saveEventData(){const t=Pt("localStorage"),i=this.getStorageKey(),l=this.getStorageKey("uuid");if(t)try{w.localStorage.setItem(l,this.anonId),Object.keys(this.eventData).length>=1&&w.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{he("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,i,l,h){if(!P.EVENTS_URL)return;const p=Zr(P.EVENTS_URL);p.params.push(`access_token=${h||P.ACCESS_TOKEN||""}`);const v={event:this.type,created:new Date(t).toISOString()},x=i?pt(v,i):v,S={url:fs(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([x])};this.pendingRequest=function(T,k){return Lr(pt(T,{method:"POST"}),k)}(S,T=>{this.pendingRequest=null,l(T),this.saveEventData(),this.processRequests(h)})}queueRequest(t,i){this.queue.push(t),this.processRequests(i)}}const se=new class extends Hs{constructor(n){super("appUserTurnstile"),this._customAccessToken=n}postTurnstileEvent(n,t){P.EVENTS_URL&&P.ACCESS_TOKEN&&Array.isArray(n)&&n.some(i=>lo(i)||Zs(i))&&this.queueRequest(Date.now(),t)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Hc(P.ACCESS_TOKEN),i=t?t.u:P.ACCESS_TOKEN;let l=i!==this.eventData.tokenU;Qe(this.anonId)||(this.anonId=Bn(),l=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),v=new Date(h),x=(h-this.eventData.lastSuccess)/864e5;l=l||x>=1||x<-1||p.getDate()!==v.getDate()}else l=!0;l?this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:E,skuId:ce,"enabled.telemetry":!1,userId:this.anonId},p=>{p||(this.eventData.lastSuccess=h,this.eventData.tokenU=i)},n):this.processRequests()}},U=se.postTurnstileEvent.bind(se),q=new class extends Hs{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(n,t,i,l){this.skuToken=t,this.errorCb=l,P.EVENTS_URL&&(i||P.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(qs)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),Qe(this.anonId)||(this.anonId=Bn()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:E,skuId:ce,skuToken:this.skuToken,userId:this.anonId},l=>{l?this.errorCb(l):t&&(this.success[t]=!0)},n))}},oe=q.postMapLoadEvent.bind(q),me=new class extends Hs{constructor(){super("gljs.performance")}postPerformanceEvent(n,t){P.EVENTS_URL&&(n||P.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},n)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:i}=this.queue.shift(),l=function(h){const p=w.performance.getEntriesByType("resource"),v=w.performance.getEntriesByType("mark"),x=function(R){const V={};if(R){for(const $ in R)if($!=="other")for(const G of R[$]){const X=`${$}ResolveRangeMin`,le=`${$}ResolveRangeMax`,ye=`${$}RequestCount`,re=`${$}RequestCachedCount`;V[X]=Math.min(V[X]||1/0,G.startTime),V[le]=Math.max(V[le]||-1/0,G.responseEnd);const ge=Te=>{V[Te]===void 0&&(V[Te]=0),++V[Te]};G.transferSize!==void 0&&G.transferSize===0&&ge(re),ge(ye)}}return V}(function(R,V){const $={};if(R)for(const G of R){const X=V(G);$[X]===void 0&&($[X]=[]),$[X].push(G)}return $}(p,Bt)),S=w.devicePixelRatio,T=w.navigator.connection||w.navigator.mozConnection||w.navigator.webkitConnection,k={counters:[],metadata:[],attributes:[]},z=(R,V,$)=>{$!=null&&R.push({name:V,value:$.toString()})};for(const R in x)z(k.counters,R,x[R]);if(h.interactionRange[0]!==1/0&&h.interactionRange[1]!==-1/0&&(z(k.counters,"interactionRangeMin",h.interactionRange[0]),z(k.counters,"interactionRangeMax",h.interactionRange[1])),v)for(const R of Object.keys(Ve)){const V=Ve[R],$=v.find(G=>G.name===V);$&&z(k.counters,V,$.startTime)}return z(k.counters,"visibilityHidden",h.visibilityHidden),z(k.attributes,"style",function(R){if(R)for(const V of R){const $=V.name.split("?")[0];if(Wc($)){const G=$.split("/").slice(-2);if(G.length===2)return`mapbox://styles/${G[0]}/${G[1]}`}}}(p)),z(k.attributes,"terrainEnabled",h.terrainEnabled?"true":"false"),z(k.attributes,"fogEnabled",h.fogEnabled?"true":"false"),z(k.attributes,"projection",h.projection),z(k.attributes,"zoom",h.zoom),z(k.metadata,"devicePixelRatio",S),z(k.metadata,"connectionEffectiveType",T?T.effectiveType:void 0),z(k.metadata,"navigatorUserAgent",w.navigator.userAgent),z(k.metadata,"screenWidth",w.screen.width),z(k.metadata,"screenHeight",w.screen.height),z(k.metadata,"windowWidth",w.innerWidth),z(k.metadata,"windowHeight",w.innerHeight),z(k.metadata,"mapWidth",h.width/S),z(k.metadata,"mapHeight",h.height/S),z(k.metadata,"webglRenderer",h.renderer),z(k.metadata,"webglVendor",h.vendor),z(k.metadata,"sdkVersion",E),z(k.metadata,"sdkIdentifier","mapbox-gl-js"),k}(i);for(const h of l.metadata);for(const h of l.counters);for(const h of l.attributes);this.postEvent(t,l,()=>{},n)}},Ie=me.postPerformanceEvent.bind(me),Oe=new class extends Hs{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(n,t,i,l){if(!P.API_URL||!P.SESSION_PATH)return;const h=Zr(P.API_URL+P.SESSION_PATH);h.params.push(`sku=${t||""}`),h.params.push(`access_token=${l||P.ACCESS_TOKEN||""}`);const p={url:fs(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(v,x){return Lr(pt(v,{method:"GET"}),x)}(p,v=>{this.pendingRequest=null,i(v),this.saveEventData(),this.processRequests(l)})}getSessionAPI(n,t,i,l){this.skuToken=t,this.errorCb=l,P.SESSION_PATH&&P.API_URL&&(i||P.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(qs)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||this.getSession(i,this.skuToken,l=>{l?this.errorCb(l):t&&(this.success[t]=!0)},n)}},De=Oe.getSessionAPI.bind(Oe),ke=new Set,Ve={create:"create",load:"load",fullLoad:"fullLoad"},ut={mark(n){w.performance.mark(n)},measure(n,t,i){w.performance.measure(n,t,i)}};function Bt(n){const t=n.name.split("?")[0];return Zc(t)&&t.includes("mapbox-gl.js")?"javascript":Zc(t)&&t.includes("mapbox-gl.css")?"css":function(i){return P.API_FONTS_REGEX.test(i)}(t)?"fontRange":Ia(t)?"sprite":Wc(t)?"style":function(i){return P.API_TILEJSON_REGEX.test(i)}(t)?"tilejson":"other"}const gt=w.performance;function nn(n){const t=n?n.url.toString():void 0;return gt.getEntriesByName(t)}let Qt,Kt,un,yn;const Zn={now:()=>un!==void 0?un:w.performance.now(),setNow(n){un=n},restoreNow(){un=void 0},frame(n){const t=w.requestAnimationFrame(n);return{cancel:()=>w.cancelAnimationFrame(t)}},getImageData(n,t=0){const{width:i,height:l}=n;yn||(yn=w.document.createElement("canvas"));const h=yn.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return(i>yn.width||l>yn.height)&&(yn.width=i,yn.height=l),h.clearRect(-t,-t,i+2*t,l+2*t),h.drawImage(n,0,0,i,l),h.getImageData(-t,-t,i+2*t,l+2*t)},resolveURL:n=>(Qt||(Qt=w.document.createElement("a")),Qt.href=n,Qt.href),get devicePixelRatio(){return w.devicePixelRatio},get prefersReducedMotion(){return!!w.matchMedia&&(Kt==null&&(Kt=w.matchMedia("(prefers-reduced-motion: reduce)")),Kt.matches)}};function sn(n,t,i){i[n]&&i[n].indexOf(t)!==-1||(i[n]=i[n]||[],i[n].push(t))}function ei(n,t,i){if(i&&i[n]){const l=i[n].indexOf(t);l!==-1&&i[n].splice(l,1)}}class ti{constructor(t,i={}){pt(this,i),this.type=t}}class ps extends ti{constructor(t,i={}){super("error",pt({error:t},i))}}class Go{on(t,i){return this._listeners=this._listeners||{},sn(t,i,this._listeners),this}off(t,i){return ei(t,i,this._listeners),ei(t,i,this._oneTimeListeners),this}once(t,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},sn(t,i,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,i){typeof t=="string"&&(t=new ti(t,i||{}));const l=t.type;if(this.listens(l)){t.target=this;const h=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const x of h)x.call(this,t);const p=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const x of p)ei(l,x,this._oneTimeListeners),x.call(this,t);const v=this._eventedParent;v&&(pt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(t))}else t instanceof ps&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,i){return this._eventedParent=t,this._eventedParentData=i,this}}var et=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function qo(n,...t){for(const i of t)for(const l in i)n[l]=i[l];return n}function Ui(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function ms(n){if(Array.isArray(n))return n.map(ms);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const t={};for(const i in n)t[i]=ms(n[i]);return t}return Ui(n)}class np extends Error{constructor(t,i){super(i),this.message=i,this.key=t}}var xo=np;class Aa{constructor(t,i=[]){this.parent=t,this.bindings={};for(const[l,h]of i)this.bindings[l]=h}concat(t){return new Aa(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var ip=Aa;const ka={kind:"null"},Ct={kind:"number"},Rn={kind:"string"},An={kind:"boolean"},bo={kind:"color"},Xs={kind:"object"},Sn={kind:"value"},Tl={kind:"collator"},Ma={kind:"formatted"},Pa={kind:"resolvedImage"};function Ir(n,t){return{kind:"array",itemType:n,N:t}}function ci(n){if(n.kind==="array"){const t=ci(n.itemType);return typeof n.N=="number"?`array<${t}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${t}>`}return n.kind}const rp=[ka,Ct,Rn,An,bo,Ma,Xs,Ir(Sn),Pa];function Rr(n,t){if(t.kind==="error")return null;if(n.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Rr(n.itemType,t.itemType))&&(typeof n.N!="number"||n.N===t.N))return null}else{if(n.kind===t.kind)return null;if(n.kind==="value"){for(const i of rp)if(!Rr(i,t))return null}}return`Expected ${ci(n)} but found ${ci(t)} instead.`}function zh(n,t){return t.some(i=>i.kind===n.kind)}function Ys(n,t){return t.some(i=>i==="null"?n===null:i==="array"?Array.isArray(n):i==="object"?n&&!Array.isArray(n)&&typeof n=="object":i===typeof n)}var Lh,Xc={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Cl(n){return(n=Math.round(n))<0?0:n>255?255:n}function Ks(n){return Cl(n[n.length-1]==="%"?parseFloat(n)/100*255:parseInt(n))}function za(n){return(t=n[n.length-1]==="%"?parseFloat(n)/100:parseFloat(n))<0?0:t>1?1:t;var t}function Rh(n,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?n+(t-n)*i*6:2*i<1?t:3*i<2?n+(t-n)*(2/3-i)*6:n}try{Lh={}.parseCSSColor=function(n){var t,i=n.replace(/ /g,"").toLowerCase();if(i in Xc)return Xc[i].slice();if(i[0]==="#")return i.length===4?(t=parseInt(i.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:i.length===7&&(t=parseInt(i.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var l=i.indexOf("("),h=i.indexOf(")");if(l!==-1&&h+1===i.length){var p=i.substr(0,l),v=i.substr(l+1,h-(l+1)).split(","),x=1;switch(p){case"rgba":if(v.length!==4)return null;x=za(v.pop());case"rgb":return v.length!==3?null:[Ks(v[0]),Ks(v[1]),Ks(v[2]),x];case"hsla":if(v.length!==4)return null;x=za(v.pop());case"hsl":if(v.length!==3)return null;var S=(parseFloat(v[0])%360+360)%360/360,T=za(v[1]),k=za(v[2]),z=k<=.5?k*(T+1):k+T-k*T,R=2*k-z;return[Cl(255*Rh(R,z,S+1/3)),Cl(255*Rh(R,z,S)),Cl(255*Rh(R,z,S-1/3)),x];default:return null}}return null}}catch{}class Dr{constructor(t,i,l,h=1){this.r=t,this.g=i,this.b=l,this.a=h}static parse(t){if(!t)return;if(t instanceof Dr)return t;if(typeof t!="string")return;const i=Lh(t);return i?new Dr(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[t,i,l,h]=this.toArray();return`rgba(${Math.round(t)},${Math.round(i)},${Math.round(l)},${h})`}toArray(){const{r:t,g:i,b:l,a:h}=this;return h===0?[0,0,0,0]:[255*t/h,255*i/h,255*l/h,h]}toArray01(){const{r:t,g:i,b:l,a:h}=this;return h===0?[0,0,0,0]:[t/h,i/h,l/h,h]}toArray01PremultipliedAlpha(){const{r:t,g:i,b:l,a:h}=this;return[t,i,l,h]}}Dr.black=new Dr(0,0,0,1),Dr.white=new Dr(1,1,1,1),Dr.transparent=new Dr(0,0,0,0),Dr.red=new Dr(1,0,0,1),Dr.blue=new Dr(0,0,1,1);var Oi=Dr;class Yc{constructor(t,i,l){this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,i){return this.collator.compare(t,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Il{constructor(t,i,l,h,p){this.text=t.normalize?t.normalize():t,this.image=i,this.scale=l,this.fontStack=h,this.textColor=p}}class Br{constructor(t){this.sections=t}static fromString(t){return new Br([new Il(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Br?t:Br.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const i of this.sections){if(i.image){t.push(["image",i.image.name]);continue}t.push(i.text);const l={};i.fontStack&&(l["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(l["font-scale"]=i.scale),i.textColor&&(l["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(l)}return t}}class Ar{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Ar({name:t,available:!1}):null}serialize(){return["image",this.name]}}function op(n,t,i,l){return typeof n=="number"&&n>=0&&n<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[n,t,i,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[n,t,i,l]:[n,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Kc(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Oi||n instanceof Yc||n instanceof Br||n instanceof Ar)return!0;if(Array.isArray(n)){for(const t of n)if(!Kc(t))return!1;return!0}if(typeof n=="object"){for(const t in n)if(!Kc(n[t]))return!1;return!0}return!1}function Ji(n){if(n===null)return ka;if(typeof n=="string")return Rn;if(typeof n=="boolean")return An;if(typeof n=="number")return Ct;if(n instanceof Oi)return bo;if(n instanceof Yc)return Tl;if(n instanceof Br)return Ma;if(n instanceof Ar)return Pa;if(Array.isArray(n)){const t=n.length;let i;for(const l of n){const h=Ji(l);if(i){if(i===h)continue;i=Sn;break}i=h}return Ir(i||Sn,t)}return Xs}function Al(n){const t=typeof n;return n===null?"":t==="string"||t==="number"||t==="boolean"?String(n):n instanceof Oi||n instanceof Br||n instanceof Ar?n.toString():JSON.stringify(n)}class Dh{constructor(t,i){this.type=t,this.value=i}static parse(t,i){if(t.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Kc(t[1]))return i.error("invalid value");const l=t[1];let h=Ji(l);const p=i.expectedType;return h.kind!=="array"||h.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(h=p),new Dh(h,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Oi?["rgba"].concat(this.value.toArray()):this.value instanceof Br?this.value.serialize():this.value}}var kl=Dh,hr=class{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}};const Jc={string:Rn,number:Ct,boolean:An,object:Xs};class La{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let l,h=1;const p=t[0];if(p==="array"){let x,S;if(t.length>2){const T=t[1];if(typeof T!="string"||!(T in Jc)||T==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);x=Jc[T],h++}else x=Sn;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);S=t[2],h++}l=Ir(x,S)}else l=Jc[p];const v=[];for(;h<t.length;h++){const x=i.parse(t[h],h,Sn);if(!x)return null;v.push(x)}return new La(l,v)}evaluate(t){for(let i=0;i<this.args.length;i++){const l=this.args[i].evaluate(t);if(!Rr(this.type,Ji(l)))return l;if(i===this.args.length-1)throw new hr(`Expected value to be of type ${ci(this.type)}, but found ${ci(Ji(l))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,i=[t.kind];if(t.kind==="array"){const l=t.itemType;if(l.kind==="string"||l.kind==="number"||l.kind==="boolean"){i.push(l.kind);const h=t.N;(typeof h=="number"||this.args.length>1)&&i.push(h)}}return i.concat(this.args.map(l=>l.serialize()))}}var Zo=La;class Ml{constructor(t){this.type=Ma,this.sections=t}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return i.error("First argument must be an image or text section.");const h=[];let p=!1;for(let v=1;v<=t.length-1;++v){const x=t[v];if(p&&typeof x=="object"&&!Array.isArray(x)){p=!1;let S=null;if(x["font-scale"]&&(S=i.parse(x["font-scale"],1,Ct),!S))return null;let T=null;if(x["text-font"]&&(T=i.parse(x["text-font"],1,Ir(Rn)),!T))return null;let k=null;if(x["text-color"]&&(k=i.parse(x["text-color"],1,bo),!k))return null;const z=h[h.length-1];z.scale=S,z.font=T,z.textColor=k}else{const S=i.parse(t[v],1,Sn);if(!S)return null;const T=S.type.kind;if(T!=="string"&&T!=="value"&&T!=="null"&&T!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,h.push({content:S,scale:null,font:null,textColor:null})}}return new Ml(h)}evaluate(t){return new Br(this.sections.map(i=>{const l=i.content.evaluate(t);return Ji(l)===Pa?new Il("",l,null,null,null):new Il(Al(l),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null)}))}eachChild(t){for(const i of this.sections)t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const i of this.sections){t.push(i.content.serialize());const l={};i.scale&&(l["font-scale"]=i.scale.serialize()),i.font&&(l["text-font"]=i.font.serialize()),i.textColor&&(l["text-color"]=i.textColor.serialize()),t.push(l)}return t}}class Qc{constructor(t){this.type=Pa,this.input=t}static parse(t,i){if(t.length!==2)return i.error("Expected two arguments.");const l=i.parse(t[1],1,Rn);return l?new Qc(l):i.error("No image name provided.")}evaluate(t){const i=this.input.evaluate(t),l=Ar.fromString(i);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(i)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const rv={"to-boolean":An,"to-color":bo,"to-number":Ct,"to-string":Rn};class Bh{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const l=t[0];if((l==="to-boolean"||l==="to-string")&&t.length!==2)return i.error("Expected one argument.");const h=rv[l],p=[];for(let v=1;v<t.length;v++){const x=i.parse(t[v],v,Sn);if(!x)return null;p.push(x)}return new Bh(h,p)}evaluate(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){let i,l;for(const h of this.args){if(i=h.evaluate(t),l=null,i instanceof Oi)return i;if(typeof i=="string"){const p=t.parseColor(i);if(p)return p}else if(Array.isArray(i)&&(l=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:op(i[0],i[1],i[2],i[3]),!l))return new Oi(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new hr(l||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const l of this.args){if(i=l.evaluate(t),i===null)return 0;const h=Number(i);if(!isNaN(h))return h}throw new hr(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?Br.fromString(Al(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Ar.fromString(Al(this.args[0].evaluate(t))):Al(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Ml([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Qc(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(i=>{t.push(i.serialize())}),t}}var Ra=Bh;const sp=["Unknown","Point","LineString","Polygon"];var Pl=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?sp[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:i,y:l}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*t-n[0])+this.featureDistanceData.bearing[1]*(l*t-n[1])}return 0}parseColor(n){let t=this._parseColorCache[n];return t||(t=this._parseColorCache[n]=Oi.parse(n)),t}};class Da{constructor(t,i,l,h){this.name=t,this.type=i,this._evaluate=l,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,i){const l=t[0],h=Da.definitions[l];if(!h)return i.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(h)?h[0]:h.type,v=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,x=v.filter(([T])=>!Array.isArray(T)||T.length===t.length-1);let S=null;for(const[T,k]of x){S=new Uh(i.registry,i.path,null,i.scope);const z=[];let R=!1;for(let V=1;V<t.length;V++){const $=t[V],G=Array.isArray(T)?T[V-1]:T.type,X=S.parse($,1+z.length,G);if(!X){R=!0;break}z.push(X)}if(!R)if(Array.isArray(T)&&T.length!==z.length)S.error(`Expected ${T.length} arguments, but found ${z.length} instead.`);else{for(let V=0;V<z.length;V++){const $=Array.isArray(T)?T[V]:T.type,G=z[V];S.concat(V+1).checkSubtype($,G.type)}if(S.errors.length===0)return new Da(l,p,k,z)}}if(x.length===1)i.errors.push(...S.errors);else{const T=(x.length?x:v).map(([z])=>{return R=z,Array.isArray(R)?`(${R.map(ci).join(", ")})`:`(${ci(R.type)}...)`;var R}).join(" | "),k=[];for(let z=1;z<t.length;z++){const R=i.parse(t[z],1+k.length);if(!R)return null;k.push(ci(R.type))}i.error(`Expected arguments of type ${T}, but found (${k.join(", ")}) instead.`)}return null}static register(t,i){Da.definitions=i;for(const l in i)t[l]=Da}}var gs=Da;class eu{constructor(t,i,l){this.type=Tl,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=i}static parse(t,i){if(t.length!==2)return i.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return i.error("Collator options argument must be an object.");const h=i.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,An);if(!h)return null;const p=i.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,An);if(!p)return null;let v=null;return l.locale&&(v=i.parse(l.locale,1,Rn),!v)?null:new eu(h,p,v)}evaluate(t){return new Yc(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const vs=8192;function Yr(n,t){n[0]=Math.min(n[0],t[0]),n[1]=Math.min(n[1],t[1]),n[2]=Math.max(n[2],t[0]),n[3]=Math.max(n[3],t[1])}function zl(n,t){return!(n[0]<=t[0]||n[2]>=t[2]||n[1]<=t[1]||n[3]>=t[3])}function ap(n,t){const i=(180+n[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(i*h*vs),Math.round(l*h*vs)]}function lp(n,t,i){const l=n[0]-t[0],h=n[1]-t[1],p=n[0]-i[0],v=n[1]-i[1];return l*v-p*h==0&&l*p<=0&&h*v<=0}function tu(n,t){let i=!1;for(let v=0,x=t.length;v<x;v++){const S=t[v];for(let T=0,k=S.length;T<k-1;T++){if(lp(n,S[T],S[T+1]))return!1;(h=S[T])[1]>(l=n)[1]!=(p=S[T+1])[1]>l[1]&&l[0]<(p[0]-h[0])*(l[1]-h[1])/(p[1]-h[1])+h[0]&&(i=!i)}}var l,h,p;return i}function cp(n,t){for(let i=0;i<t.length;i++)if(tu(n,t[i]))return!0;return!1}function Oh(n,t,i,l){const h=l[0]-i[0],p=l[1]-i[1],v=(n[0]-i[0])*p-h*(n[1]-i[1]),x=(t[0]-i[0])*p-h*(t[1]-i[1]);return v>0&&x<0||v<0&&x>0}function Fh(n,t,i){for(const T of i)for(let k=0;k<T.length-1;++k)if((x=[(v=T[k+1])[0]-(p=T[k])[0],v[1]-p[1]])[0]*(S=[(h=t)[0]-(l=n)[0],h[1]-l[1]])[1]-x[1]*S[0]!=0&&Oh(l,h,p,v)&&Oh(p,v,l,h))return!0;var l,h,p,v,x,S;return!1}function Ba(n,t){for(let i=0;i<n.length;++i)if(!tu(n[i],t))return!1;for(let i=0;i<n.length-1;++i)if(Fh(n[i],n[i+1],t))return!1;return!0}function up(n,t){for(let i=0;i<t.length;i++)if(Ba(n,t[i]))return!0;return!1}function nu(n,t,i){const l=[];for(let h=0;h<n.length;h++){const p=[];for(let v=0;v<n[h].length;v++){const x=ap(n[h][v],i);Yr(t,x),p.push(x)}l.push(p)}return l}function iu(n,t,i){const l=[];for(let h=0;h<n.length;h++){const p=nu(n[h],t,i);l.push(p)}return l}function Vh(n,t,i,l){if(n[0]<i[0]||n[0]>i[2]){const h=.5*l;let p=n[0]-i[0]>h?-l:i[0]-n[0]>h?l:0;p===0&&(p=n[0]-i[2]>h?-l:i[2]-n[0]>h?l:0),n[0]+=p}Yr(t,n)}function Js(n,t,i,l){const h=Math.pow(2,l.z)*vs,p=[l.x*vs,l.y*vs],v=[];if(!n)return v;for(const x of n)for(const S of x){const T=[S.x+p[0],S.y+p[1]];Vh(T,t,i,h),v.push(T)}return v}function Wn(n,t,i,l){const h=Math.pow(2,l.z)*vs,p=[l.x*vs,l.y*vs],v=[];if(!n)return v;for(const S of n){const T=[];for(const k of S){const z=[k.x+p[0],k.y+p[1]];Yr(t,z),T.push(z)}v.push(T)}if(t[2]-t[0]<=h/2){(x=t)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const S of v)for(const T of S)Vh(T,t,i,h)}var x;return v}class Ll{constructor(t,i){this.type=An,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Kc(t[1])){const l=t[1];if(l.type==="FeatureCollection")for(let h=0;h<l.features.length;++h){const p=l.features[h].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Ll(l,l.features[h].geometry)}else if(l.type==="Feature"){const h=l.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Ll(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Ll(l,l)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,l){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],v=i.canonicalID();if(!v)return!1;if(l.type==="Polygon"){const x=nu(l.coordinates,p,v),S=Js(i.geometry(),h,p,v);if(!zl(h,p))return!1;for(const T of S)if(!tu(T,x))return!1}if(l.type==="MultiPolygon"){const x=iu(l.coordinates,p,v),S=Js(i.geometry(),h,p,v);if(!zl(h,p))return!1;for(const T of S)if(!cp(T,x))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,l){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],v=i.canonicalID();if(!v)return!1;if(l.type==="Polygon"){const x=nu(l.coordinates,p,v),S=Wn(i.geometry(),h,p,v);if(!zl(h,p))return!1;for(const T of S)if(!Ba(T,x))return!1}if(l.type==="MultiPolygon"){const x=iu(l.coordinates,p,v),S=Wn(i.geometry(),h,p,v);if(!zl(h,p))return!1;for(const T of S)if(!up(T,x))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var $h=Ll;function Rl(n){if(n instanceof gs&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof $h)return!1;let t=!0;return n.eachChild(i=>{t&&!Rl(i)&&(t=!1)}),t}function Dl(n){if(n instanceof gs&&n.name==="feature-state")return!1;let t=!0;return n.eachChild(i=>{t&&!Dl(i)&&(t=!1)}),t}function ru(n,t){if(n instanceof gs&&t.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild(l=>{i&&!ru(l,t)&&(i=!1)}),i}class ou{constructor(t,i){this.type=i.type,this.name=t,this.boundExpression=i}static parse(t,i){if(t.length!==2||typeof t[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const l=t[1];return i.scope.has(l)?new ou(l,i.scope.get(l)):i.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Nh=ou;class su{constructor(t,i=[],l,h=new ip,p=[]){this.registry=t,this.path=i,this.key=i.map(v=>`[${v}]`).join(""),this.scope=h,this.errors=p,this.expectedType=l}parse(t,i,l,h,p={}){return i?this.concat(i,l,h)._parse(t,p):this._parse(t,p)}_parse(t,i){function l(h,p,v){return v==="assert"?new Zo(p,[h]):v==="coerce"?new Ra(p,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[h];if(p){let v=p.parse(t,this);if(!v)return null;if(this.expectedType){const x=this.expectedType,S=v.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||S.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string"){if(this.checkSubtype(x,S))return null}else v=l(v,x,i.typeAnnotation||"coerce");else v=l(v,x,i.typeAnnotation||"assert")}if(!(v instanceof kl)&&v.type.kind!=="resolvedImage"&&_s(v)){const x=new Pl;try{v=new kl(v.type,v.evaluate(x))}catch(S){return this.error(S.message),null}}return v}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,i,l){const h=typeof t=="number"?this.path.concat(t):this.path,p=l?this.scope.concat(l):this.scope;return new su(this.registry,h,i||null,p,this.errors)}error(t,...i){const l=`${this.key}${i.map(h=>`[${h}]`).join("")}`;this.errors.push(new xo(l,t))}checkSubtype(t,i){const l=Rr(t,i);return l&&this.error(l),l}}var Uh=su;function _s(n){if(n instanceof Nh)return _s(n.boundExpression);if(n instanceof gs&&n.name==="error"||n instanceof eu||n instanceof $h)return!1;const t=n instanceof Ra||n instanceof Zo;let i=!0;return n.eachChild(l=>{i=t?i&&_s(l):i&&l instanceof kl}),!!i&&Rl(n)&&ru(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Qs(n,t){const i=n.length-1;let l,h,p=0,v=i,x=0;for(;p<=v;)if(x=Math.floor((p+v)/2),l=n[x],h=n[x+1],l<=t){if(x===i||t<h)return x;p=x+1}else{if(!(l>t))throw new hr("Input is not a number.");v=x-1}return 0}class au{constructor(t,i,l){this.type=t,this.input=i,this.labels=[],this.outputs=[];for(const[h,p]of l)this.labels.push(h),this.outputs.push(p)}static parse(t,i){if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");const l=i.parse(t[1],1,Ct);if(!l)return null;const h=[];let p=null;i.expectedType&&i.expectedType.kind!=="value"&&(p=i.expectedType);for(let v=1;v<t.length;v+=2){const x=v===1?-1/0:t[v],S=t[v+1],T=v,k=v+1;if(typeof x!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(h.length&&h[h.length-1][0]>=x)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const z=i.parse(S,k,p);if(!z)return null;p=p||z.type,h.push([x,z])}return new au(p,l,h)}evaluate(t){const i=this.labels,l=this.outputs;if(i.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=i[0])return l[0].evaluate(t);const p=i.length;return h>=i[p-1]?l[p-1].evaluate(t):l[Qs(i,h)].evaluate(t)}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&t.push(this.labels[i]),t.push(this.outputs[i].serialize());return t}}var jh=au;function $n(n,t,i){return n*(1-i)+t*i}var Bl=Object.freeze({__proto__:null,number:$n,color:function(n,t,i){return new Oi($n(n.r,t.r,i),$n(n.g,t.g,i),$n(n.b,t.b,i),$n(n.a,t.a,i))},array:function(n,t,i){return n.map((l,h)=>$n(l,t[h],i))}});const hp=.95047,dp=1.08883,Gh=4/29,qh=6/29,Zh=3*qh*qh,fp=Math.PI/180,ov=180/Math.PI;function lu(n){return n>.008856451679035631?Math.pow(n,1/3):n/Zh+Gh}function Wh(n){return n>qh?n*n*n:Zh*(n-Gh)}function cu(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function uu(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function pp(n){const t=uu(n.r),i=uu(n.g),l=uu(n.b),h=lu((.4124564*t+.3575761*i+.1804375*l)/hp),p=lu((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*p-16,a:500*(h-p),b:200*(p-lu((.0193339*t+.119192*i+.9503041*l)/dp)),alpha:n.a}}function mp(n){let t=(n.l+16)/116,i=isNaN(n.a)?t:t+n.a/500,l=isNaN(n.b)?t:t-n.b/200;return t=1*Wh(t),i=hp*Wh(i),l=dp*Wh(l),new Oi(cu(3.2404542*i-1.5371385*t-.4985314*l),cu(-.969266*i+1.8760108*t+.041556*l),cu(.0556434*i-.2040259*t+1.0572252*l),n.alpha)}function sv(n,t,i){const l=t-n;return n+i*(l>180||l<-180?l-360*Math.round(l/360):l)}const Ol={forward:pp,reverse:mp,interpolate:function(n,t,i){return{l:$n(n.l,t.l,i),a:$n(n.a,t.a,i),b:$n(n.b,t.b,i),alpha:$n(n.alpha,t.alpha,i)}}},Fl={forward:function(n){const{l:t,a:i,b:l}=pp(n),h=Math.atan2(l,i)*ov;return{h:h<0?h+360:h,c:Math.sqrt(i*i+l*l),l:t,alpha:n.a}},reverse:function(n){const t=n.h*fp,i=n.c;return mp({l:n.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:n.alpha})},interpolate:function(n,t,i){return{h:sv(n.h,t.h,i),c:$n(n.c,t.c,i),l:$n(n.l,t.l,i),alpha:$n(n.alpha,t.alpha,i)}}};var gp=Object.freeze({__proto__:null,lab:Ol,hcl:Fl});class Vl{constructor(t,i,l,h,p){this.type=t,this.operator=i,this.interpolation=l,this.input=h,this.labels=[],this.outputs=[];for(const[v,x]of p)this.labels.push(v),this.outputs.push(x)}static interpolationFactor(t,i,l,h){let p=0;if(t.name==="exponential")p=Hh(i,t.base,l,h);else if(t.name==="linear")p=Hh(i,1,l,h);else if(t.name==="cubic-bezier"){const v=t.controlPoints;p=new K(v[0],v[1],v[2],v[3]).solve(Hh(i,1,l,h))}return p}static parse(t,i){let[l,h,p,...v]=t;if(!Array.isArray(h)||h.length===0)return i.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const T=h[1];if(typeof T!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:T}}else{if(h[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const T=h.slice(1);if(T.length!==4||T.some(k=>typeof k!="number"||k<0||k>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:T}}}if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(p=i.parse(p,2,Ct),!p)return null;const x=[];let S=null;l==="interpolate-hcl"||l==="interpolate-lab"?S=bo:i.expectedType&&i.expectedType.kind!=="value"&&(S=i.expectedType);for(let T=0;T<v.length;T+=2){const k=v[T],z=v[T+1],R=T+3,V=T+4;if(typeof k!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(x.length&&x[x.length-1][0]>=k)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);const $=i.parse(z,V,S);if(!$)return null;S=S||$.type,x.push([k,$])}return S.kind==="number"||S.kind==="color"||S.kind==="array"&&S.itemType.kind==="number"&&typeof S.N=="number"?new Vl(S,l,h,p,x):i.error(`Type ${ci(S)} is not interpolatable.`)}evaluate(t){const i=this.labels,l=this.outputs;if(i.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=i[0])return l[0].evaluate(t);const p=i.length;if(h>=i[p-1])return l[p-1].evaluate(t);const v=Qs(i,h),x=Vl.interpolationFactor(this.interpolation,h,i[v],i[v+1]),S=l[v].evaluate(t),T=l[v+1].evaluate(t);return this.operator==="interpolate"?Bl[this.type.kind.toLowerCase()](S,T,x):this.operator==="interpolate-hcl"?Fl.reverse(Fl.interpolate(Fl.forward(S),Fl.forward(T),x)):Ol.reverse(Ol.interpolate(Ol.forward(S),Ol.forward(T),x))}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,t,this.input.serialize()];for(let l=0;l<this.labels.length;l++)i.push(this.labels[l],this.outputs[l].serialize());return i}}function Hh(n,t,i,l){const h=l-i,p=n-i;return h===0?0:t===1?p/h:(Math.pow(t,p)-1)/(Math.pow(t,h)-1)}var wo=Vl;class Xh{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expectected at least one argument.");let l=null;const h=i.expectedType;h&&h.kind!=="value"&&(l=h);const p=[];for(const x of t.slice(1)){const S=i.parse(x,1+p.length,l,void 0,{typeAnnotation:"omit"});if(!S)return null;l=l||S.type,p.push(S)}const v=h&&p.some(x=>Rr(h,x.type));return new Xh(v?Sn:l,p)}evaluate(t){let i,l=null,h=0;for(const p of this.args){if(h++,l=p.evaluate(t),l&&l instanceof Ar&&!l.available&&(i||(i=l),l=null,h===this.args.length))return i;if(l!==null)break}return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var vp=Xh;class hu{constructor(t,i){this.type=i.type,this.bindings=[].concat(t),this.result=i}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const i of this.bindings)t(i[1]);t(this.result)}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let p=1;p<t.length-1;p+=2){const v=t[p];if(typeof v!="string")return i.error(`Expected string, but found ${typeof v} instead.`,p);if(/[^a-zA-Z0-9_]/.test(v))return i.error("Variable names must contain only alphanumeric characters or '_'.",p);const x=i.parse(t[p+1],p+1);if(!x)return null;l.push([v,x])}const h=i.parse(t[t.length-1],t.length-1,i.expectedType,l);return h?new hu(l,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[i,l]of this.bindings)t.push(i,l.serialize());return t.push(this.result.serialize()),t}}var Yh=hu;class du{constructor(t,i,l){this.type=t,this.index=i,this.input=l}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=i.parse(t[1],1,Ct),h=i.parse(t[2],2,Ir(i.expectedType||Sn));return l&&h?new du(h.type.itemType,l,h):null}evaluate(t){const i=this.index.evaluate(t),l=this.input.evaluate(t);if(i<0)throw new hr(`Array index out of bounds: ${i} < 0.`);if(i>=l.length)throw new hr(`Array index out of bounds: ${i} > ${l.length-1}.`);if(i!==Math.floor(i))throw new hr(`Array index must be an integer, but found ${i} instead.`);return l[i]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var av=du;class Kh{constructor(t,i){this.type=An,this.needle=t,this.haystack=i}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=i.parse(t[1],1,Sn),h=i.parse(t[2],2,Sn);return l&&h?zh(l.type,[An,Rn,Ct,ka,Sn])?new Kh(l,h):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ci(l.type)} instead`):null}evaluate(t){const i=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(l==null)return!1;if(!Ys(i,["boolean","string","number","null"]))throw new hr(`Expected first argument to be of type boolean, string, number or null, but found ${ci(Ji(i))} instead.`);if(!Ys(l,["string","array"]))throw new hr(`Expected second argument to be of type array or string, but found ${ci(Ji(l))} instead.`);return l.indexOf(i)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var _p=Kh;class $l{constructor(t,i,l){this.type=Ct,this.needle=t,this.haystack=i,this.fromIndex=l}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=i.parse(t[1],1,Sn),h=i.parse(t[2],2,Sn);if(!l||!h)return null;if(!zh(l.type,[An,Rn,Ct,ka,Sn]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ci(l.type)} instead`);if(t.length===4){const p=i.parse(t[3],3,Ct);return p?new $l(l,h,p):null}return new $l(l,h)}evaluate(t){const i=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!Ys(i,["boolean","string","number","null"]))throw new hr(`Expected first argument to be of type boolean, string, number or null, but found ${ci(Ji(i))} instead.`);if(!Ys(l,["string","array"]))throw new hr(`Expected second argument to be of type array or string, but found ${ci(Ji(l))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(t);return l.indexOf(i,h)}return l.indexOf(i)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var yp=$l;class Jh{constructor(t,i,l,h,p,v){this.inputType=t,this.type=i,this.input=l,this.cases=h,this.outputs=p,this.otherwise=v}static parse(t,i){if(t.length<5)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return i.error("Expected an even number of arguments.");let l,h;i.expectedType&&i.expectedType.kind!=="value"&&(h=i.expectedType);const p={},v=[];for(let T=2;T<t.length-1;T+=2){let k=t[T];const z=t[T+1];Array.isArray(k)||(k=[k]);const R=i.concat(T);if(k.length===0)return R.error("Expected at least one branch label.");for(const $ of k){if(typeof $!="number"&&typeof $!="string")return R.error("Branch labels must be numbers or strings.");if(typeof $=="number"&&Math.abs($)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $=="number"&&Math.floor($)!==$)return R.error("Numeric branch labels must be integer values.");if(l){if(R.checkSubtype(l,Ji($)))return null}else l=Ji($);if(p[String($)]!==void 0)return R.error("Branch labels must be unique.");p[String($)]=v.length}const V=i.parse(z,T,h);if(!V)return null;h=h||V.type,v.push(V)}const x=i.parse(t[1],1,Sn);if(!x)return null;const S=i.parse(t[t.length-1],t.length-1,h);return S?x.type.kind!=="value"&&i.concat(1).checkSubtype(l,x.type)?null:new Jh(l,h,x,p,v,S):null}evaluate(t){const i=this.input.evaluate(t);return(Ji(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),l=[],h={};for(const v of i){const x=h[this.cases[v]];x===void 0?(h[this.cases[v]]=l.length,l.push([this.cases[v],[v]])):l[x][1].push(v)}const p=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,x]of l)t.push(x.length===1?p(x[0]):x.map(p)),t.push(this.outputs[v].serialize());return t.push(this.otherwise.serialize()),t}}var lv=Jh;class Qh{constructor(t,i,l){this.type=t,this.branches=i,this.otherwise=l}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return i.error("Expected an odd number of arguments.");let l;i.expectedType&&i.expectedType.kind!=="value"&&(l=i.expectedType);const h=[];for(let v=1;v<t.length-1;v+=2){const x=i.parse(t[v],v,An);if(!x)return null;const S=i.parse(t[v+1],v+1,l);if(!S)return null;h.push([x,S]),l=l||S.type}const p=i.parse(t[t.length-1],t.length-1,l);return p?new Qh(l,h,p):null}evaluate(t){for(const[i,l]of this.branches)if(i.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[i,l]of this.branches)t(i),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var cv=Qh;class ea{constructor(t,i,l,h){this.type=t,this.input=i,this.beginIndex=l,this.endIndex=h}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=i.parse(t[1],1,Sn),h=i.parse(t[2],2,Ct);if(!l||!h)return null;if(!zh(l.type,[Ir(Sn),Rn,Sn]))return i.error(`Expected first argument to be of type array or string, but found ${ci(l.type)} instead`);if(t.length===4){const p=i.parse(t[3],3,Ct);return p?new ea(l.type,l,h,p):null}return new ea(l.type,l,h)}evaluate(t){const i=this.input.evaluate(t),l=this.beginIndex.evaluate(t);if(!Ys(i,["string","array"]))throw new hr(`Expected first argument to be of type array or string, but found ${ci(Ji(i))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(t);return i.slice(l,h)}return i.slice(l)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var xp=ea;function ed(n,t){return n==="=="||n==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function bp(n,t,i,l){return l.compare(t,i)===0}function Oa(n,t,i){const l=n!=="=="&&n!=="!=";return class KT{constructor(p,v,x){this.type=An,this.lhs=p,this.rhs=v,this.collator=x,this.hasUntypedArgument=p.type.kind==="value"||v.type.kind==="value"}static parse(p,v){if(p.length!==3&&p.length!==4)return v.error("Expected two or three arguments.");const x=p[0];let S=v.parse(p[1],1,Sn);if(!S)return null;if(!ed(x,S.type))return v.concat(1).error(`"${x}" comparisons are not supported for type '${ci(S.type)}'.`);let T=v.parse(p[2],2,Sn);if(!T)return null;if(!ed(x,T.type))return v.concat(2).error(`"${x}" comparisons are not supported for type '${ci(T.type)}'.`);if(S.type.kind!==T.type.kind&&S.type.kind!=="value"&&T.type.kind!=="value")return v.error(`Cannot compare types '${ci(S.type)}' and '${ci(T.type)}'.`);l&&(S.type.kind==="value"&&T.type.kind!=="value"?S=new Zo(T.type,[S]):S.type.kind!=="value"&&T.type.kind==="value"&&(T=new Zo(S.type,[T])));let k=null;if(p.length===4){if(S.type.kind!=="string"&&T.type.kind!=="string"&&S.type.kind!=="value"&&T.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(k=v.parse(p[3],3,Tl),!k)return null}return new KT(S,T,k)}evaluate(p){const v=this.lhs.evaluate(p),x=this.rhs.evaluate(p);if(l&&this.hasUntypedArgument){const S=Ji(v),T=Ji(x);if(S.kind!==T.kind||S.kind!=="string"&&S.kind!=="number")throw new hr(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${S.kind}, ${T.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const S=Ji(v),T=Ji(x);if(S.kind!=="string"||T.kind!=="string")return t(p,v,x)}return this.collator?i(p,v,x,this.collator.evaluate(p)):t(p,v,x)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[n];return this.eachChild(v=>{p.push(v.serialize())}),p}}}const uv=Oa("==",function(n,t,i){return t===i},bp),wp=Oa("!=",function(n,t,i){return t!==i},function(n,t,i,l){return!bp(0,t,i,l)}),Sp=Oa("<",function(n,t,i){return t<i},function(n,t,i,l){return l.compare(t,i)<0}),Ep=Oa(">",function(n,t,i){return t>i},function(n,t,i,l){return l.compare(t,i)>0}),td=Oa("<=",function(n,t,i){return t<=i},function(n,t,i,l){return l.compare(t,i)<=0}),hv=Oa(">=",function(n,t,i){return t>=i},function(n,t,i,l){return l.compare(t,i)>=0});class nd{constructor(t,i,l,h,p,v){this.type=Rn,this.number=t,this.locale=i,this.currency=l,this.unit=h,this.minFractionDigits=p,this.maxFractionDigits=v}static parse(t,i){if(t.length!==3)return i.error("Expected two arguments.");const l=i.parse(t[1],1,Ct);if(!l)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return i.error("NumberFormat options argument must be an object.");let p=null;if(h.locale&&(p=i.parse(h.locale,1,Rn),!p))return null;let v=null;if(h.currency&&(v=i.parse(h.currency,1,Rn),!v))return null;let x=null;if(h.unit&&(x=i.parse(h.unit,1,Rn),!x))return null;let S=null;if(h["min-fraction-digits"]&&(S=i.parse(h["min-fraction-digits"],1,Ct),!S))return null;let T=null;return h["max-fraction-digits"]&&(T=i.parse(h["max-fraction-digits"],1,Ct),!T)?null:new nd(l,p,v,x,S,T)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class id{constructor(t){this.type=Ct,this.input=t}static parse(t,i){if(t.length!==2)return i.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=i.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${ci(l.type)} instead.`):new id(l):null}evaluate(t){const i=this.input.evaluate(t);if(typeof i=="string"||Array.isArray(i))return i.length;throw new hr(`Expected value to be of type string or array, but found ${ci(Ji(i))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(i=>{t.push(i.serialize())}),t}}const Tp={"==":uv,"!=":wp,">":Ep,"<":Sp,">=":hv,"<=":td,array:Zo,at:av,boolean:Zo,case:cv,coalesce:vp,collator:eu,format:Ml,image:Qc,in:_p,"index-of":yp,interpolate:wo,"interpolate-hcl":wo,"interpolate-lab":wo,length:id,let:Yh,literal:kl,match:lv,number:Zo,"number-format":nd,object:Zo,slice:xp,step:jh,string:Zo,"to-boolean":Ra,"to-color":Ra,"to-number":Ra,"to-string":Ra,var:Nh,within:$h};function Cp(n,[t,i,l,h]){t=t.evaluate(n),i=i.evaluate(n),l=l.evaluate(n);const p=h?h.evaluate(n):1,v=op(t,i,l,p);if(v)throw new hr(v);return new Oi(t/255*p,i/255*p,l/255*p,p)}function Ip(n,t){return n in t}function rd(n,t){const i=t[n];return i===void 0?null:i}function ys(n){return{type:n}}gs.register(Tp,{error:[{kind:"error"},[Rn],(n,[t])=>{throw new hr(t.evaluate(n))}],typeof:[Rn,[Sn],(n,[t])=>ci(Ji(t.evaluate(n)))],"to-rgba":[Ir(Ct,4),[bo],(n,[t])=>t.evaluate(n).toArray()],rgb:[bo,[Ct,Ct,Ct],Cp],rgba:[bo,[Ct,Ct,Ct,Ct],Cp],has:{type:An,overloads:[[[Rn],(n,[t])=>Ip(t.evaluate(n),n.properties())],[[Rn,Xs],(n,[t,i])=>Ip(t.evaluate(n),i.evaluate(n))]]},get:{type:Sn,overloads:[[[Rn],(n,[t])=>rd(t.evaluate(n),n.properties())],[[Rn,Xs],(n,[t,i])=>rd(t.evaluate(n),i.evaluate(n))]]},"feature-state":[Sn,[Rn],(n,[t])=>rd(t.evaluate(n),n.featureState||{})],properties:[Xs,[],n=>n.properties()],"geometry-type":[Rn,[],n=>n.geometryType()],id:[Sn,[],n=>n.id()],zoom:[Ct,[],n=>n.globals.zoom],pitch:[Ct,[],n=>n.globals.pitch||0],"distance-from-center":[Ct,[],n=>n.distanceFromCenter()],"heatmap-density":[Ct,[],n=>n.globals.heatmapDensity||0],"line-progress":[Ct,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[Ct,[],n=>n.globals.skyRadialProgress||0],accumulated:[Sn,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[Ct,ys(Ct),(n,t)=>{let i=0;for(const l of t)i+=l.evaluate(n);return i}],"*":[Ct,ys(Ct),(n,t)=>{let i=1;for(const l of t)i*=l.evaluate(n);return i}],"-":{type:Ct,overloads:[[[Ct,Ct],(n,[t,i])=>t.evaluate(n)-i.evaluate(n)],[[Ct],(n,[t])=>-t.evaluate(n)]]},"/":[Ct,[Ct,Ct],(n,[t,i])=>t.evaluate(n)/i.evaluate(n)],"%":[Ct,[Ct,Ct],(n,[t,i])=>t.evaluate(n)%i.evaluate(n)],ln2:[Ct,[],()=>Math.LN2],pi:[Ct,[],()=>Math.PI],e:[Ct,[],()=>Math.E],"^":[Ct,[Ct,Ct],(n,[t,i])=>Math.pow(t.evaluate(n),i.evaluate(n))],sqrt:[Ct,[Ct],(n,[t])=>Math.sqrt(t.evaluate(n))],log10:[Ct,[Ct],(n,[t])=>Math.log(t.evaluate(n))/Math.LN10],ln:[Ct,[Ct],(n,[t])=>Math.log(t.evaluate(n))],log2:[Ct,[Ct],(n,[t])=>Math.log(t.evaluate(n))/Math.LN2],sin:[Ct,[Ct],(n,[t])=>Math.sin(t.evaluate(n))],cos:[Ct,[Ct],(n,[t])=>Math.cos(t.evaluate(n))],tan:[Ct,[Ct],(n,[t])=>Math.tan(t.evaluate(n))],asin:[Ct,[Ct],(n,[t])=>Math.asin(t.evaluate(n))],acos:[Ct,[Ct],(n,[t])=>Math.acos(t.evaluate(n))],atan:[Ct,[Ct],(n,[t])=>Math.atan(t.evaluate(n))],min:[Ct,ys(Ct),(n,t)=>Math.min(...t.map(i=>i.evaluate(n)))],max:[Ct,ys(Ct),(n,t)=>Math.max(...t.map(i=>i.evaluate(n)))],abs:[Ct,[Ct],(n,[t])=>Math.abs(t.evaluate(n))],round:[Ct,[Ct],(n,[t])=>{const i=t.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[Ct,[Ct],(n,[t])=>Math.floor(t.evaluate(n))],ceil:[Ct,[Ct],(n,[t])=>Math.ceil(t.evaluate(n))],"filter-==":[An,[Rn,Sn],(n,[t,i])=>n.properties()[t.value]===i.value],"filter-id-==":[An,[Sn],(n,[t])=>n.id()===t.value],"filter-type-==":[An,[Rn],(n,[t])=>n.geometryType()===t.value],"filter-<":[An,[Rn,Sn],(n,[t,i])=>{const l=n.properties()[t.value],h=i.value;return typeof l==typeof h&&l<h}],"filter-id-<":[An,[Sn],(n,[t])=>{const i=n.id(),l=t.value;return typeof i==typeof l&&i<l}],"filter->":[An,[Rn,Sn],(n,[t,i])=>{const l=n.properties()[t.value],h=i.value;return typeof l==typeof h&&l>h}],"filter-id->":[An,[Sn],(n,[t])=>{const i=n.id(),l=t.value;return typeof i==typeof l&&i>l}],"filter-<=":[An,[Rn,Sn],(n,[t,i])=>{const l=n.properties()[t.value],h=i.value;return typeof l==typeof h&&l<=h}],"filter-id-<=":[An,[Sn],(n,[t])=>{const i=n.id(),l=t.value;return typeof i==typeof l&&i<=l}],"filter->=":[An,[Rn,Sn],(n,[t,i])=>{const l=n.properties()[t.value],h=i.value;return typeof l==typeof h&&l>=h}],"filter-id->=":[An,[Sn],(n,[t])=>{const i=n.id(),l=t.value;return typeof i==typeof l&&i>=l}],"filter-has":[An,[Sn],(n,[t])=>t.value in n.properties()],"filter-has-id":[An,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[An,[Ir(Rn)],(n,[t])=>t.value.indexOf(n.geometryType())>=0],"filter-id-in":[An,[Ir(Sn)],(n,[t])=>t.value.indexOf(n.id())>=0],"filter-in-small":[An,[Rn,Ir(Sn)],(n,[t,i])=>i.value.indexOf(n.properties()[t.value])>=0],"filter-in-large":[An,[Rn,Ir(Sn)],(n,[t,i])=>function(l,h,p,v){for(;p<=v;){const x=p+v>>1;if(h[x]===l)return!0;h[x]>l?v=x-1:p=x+1}return!1}(n.properties()[t.value],i.value,0,i.value.length-1)],all:{type:An,overloads:[[[An,An],(n,[t,i])=>t.evaluate(n)&&i.evaluate(n)],[ys(An),(n,t)=>{for(const i of t)if(!i.evaluate(n))return!1;return!0}]]},any:{type:An,overloads:[[[An,An],(n,[t,i])=>t.evaluate(n)||i.evaluate(n)],[ys(An),(n,t)=>{for(const i of t)if(i.evaluate(n))return!0;return!1}]]},"!":[An,[An],(n,[t])=>!t.evaluate(n)],"is-supported-script":[An,[Rn],(n,[t])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(t.evaluate(n))}],upcase:[Rn,[Rn],(n,[t])=>t.evaluate(n).toUpperCase()],downcase:[Rn,[Rn],(n,[t])=>t.evaluate(n).toLowerCase()],concat:[Rn,ys(Sn),(n,t)=>t.map(i=>Al(i.evaluate(n))).join("")],"resolved-locale":[Rn,[Tl],(n,[t])=>t.evaluate(n).resolvedLocale()]});var Fa=Tp;function Nl(n){return{result:"success",value:n}}function Va(n){return{result:"error",value:n}}function $a(n){return n["property-type"]==="data-driven"}function Wo(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function fu(n){return!!n.expression&&n.expression.interpolated}function Vn(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function pu(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function dv(n){return n}function od(n,t){const i=t.type==="color",l=n.stops&&typeof n.stops[0][0]=="object",h=l||!(l||n.property!==void 0),p=n.type||(fu(t)?"exponential":"interval");if(i&&((n=qo({},n)).stops&&(n.stops=n.stops.map(T=>[T[0],Oi.parse(T[1])])),n.default=Oi.parse(n.default?n.default:t.default)),n.colorSpace&&n.colorSpace!=="rgb"&&!gp[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let v,x,S;if(p==="exponential")v=mu;else if(p==="interval")v=Ap;else if(p==="categorical"){v=sd,x=Object.create(null);for(const T of n.stops)x[T[0]]=T[1];S=typeof n.stops[0][0]}else{if(p!=="identity")throw new Error(`Unknown function type "${p}"`);v=kp}if(l){const T={},k=[];for(let V=0;V<n.stops.length;V++){const $=n.stops[V],G=$[0].zoom;T[G]===void 0&&(T[G]={zoom:G,type:n.type,property:n.property,default:n.default,stops:[]},k.push(G)),T[G].stops.push([$[0].value,$[1]])}const z=[];for(const V of k)z.push([T[V].zoom,od(T[V],t)]);const R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:wo.interpolationFactor.bind(void 0,R),zoomStops:z.map(V=>V[0]),evaluate:({zoom:V},$)=>mu({stops:z,base:n.base},t,V).evaluate(V,$)}}if(h){const T=p==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:wo.interpolationFactor.bind(void 0,T),zoomStops:n.stops.map(k=>k[0]),evaluate:({zoom:k})=>v(n,t,k,x,S)}}return{kind:"source",evaluate(T,k){const z=k&&k.properties?k.properties[n.property]:void 0;return z===void 0?Ul(n.default,t.default):v(n,t,z,x,S)}}}function Ul(n,t,i){return n!==void 0?n:t!==void 0?t:i!==void 0?i:void 0}function sd(n,t,i,l,h){return Ul(typeof i===h?l[i]:void 0,n.default,t.default)}function Ap(n,t,i){if(Vn(i)!=="number")return Ul(n.default,t.default);const l=n.stops.length;if(l===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[l-1][0])return n.stops[l-1][1];const h=Qs(n.stops.map(p=>p[0]),i);return n.stops[h][1]}function mu(n,t,i){const l=n.base!==void 0?n.base:1;if(Vn(i)!=="number")return Ul(n.default,t.default);const h=n.stops.length;if(h===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[h-1][0])return n.stops[h-1][1];const p=Qs(n.stops.map(k=>k[0]),i),v=function(k,z,R,V){const $=V-R,G=k-R;return $===0?0:z===1?G/$:(Math.pow(z,G)-1)/(Math.pow(z,$)-1)}(i,l,n.stops[p][0],n.stops[p+1][0]),x=n.stops[p][1],S=n.stops[p+1][1];let T=Bl[t.type]||dv;if(n.colorSpace&&n.colorSpace!=="rgb"){const k=gp[n.colorSpace];T=(z,R)=>k.reverse(k.interpolate(k.forward(z),k.forward(R),v))}return typeof x.evaluate=="function"?{evaluate(...k){const z=x.evaluate.apply(void 0,k),R=S.evaluate.apply(void 0,k);if(z!==void 0&&R!==void 0)return T(z,R,v)}}:T(x,S,v)}function kp(n,t,i){return t.type==="color"?i=Oi.parse(i):t.type==="formatted"?i=Br.fromString(i.toString()):t.type==="resolvedImage"?i=Ar.fromString(i.toString()):Vn(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),Ul(i,n.default,t.default)}class gu{constructor(t,i){this.expression=t,this._warningHistory={},this._evaluator=new Pl,this._defaultValue=i?function(l){return l.type==="color"&&(pu(l.default)||Array.isArray(l.default))?new Oi(0,0,0,0):l.type==="color"?Oi.parse(l.default)||null:l.default===void 0?null:l.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(t,i,l,h,p,v,x,S){return this._evaluator.globals=t,this._evaluator.feature=i,this._evaluator.featureState=l,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=S||null,this.expression.evaluate(this._evaluator)}evaluate(t,i,l,h,p,v,x,S){this._evaluator.globals=t,this._evaluator.feature=i||null,this._evaluator.featureState=l||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=S||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new hr(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function Na(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in Fa}function Ua(n,t){const i=new Uh(Fa,[],t?function(h){const p={color:bo,string:Rn,number:Ct,enum:Rn,boolean:An,formatted:Ma,resolvedImage:Pa};return h.type==="array"?Ir(p[h.value]||Sn,h.length):p[h.type]}(t):void 0),l=i.parse(n,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Nl(new gu(l,t)):Va(i.errors)}class vu{constructor(t,i){this.kind=t,this._styleExpression=i,this.isStateDependent=t!=="constant"&&!Dl(i.expression)}evaluateWithoutErrorHandling(t,i,l,h,p,v){return this._styleExpression.evaluateWithoutErrorHandling(t,i,l,h,p,v)}evaluate(t,i,l,h,p,v){return this._styleExpression.evaluate(t,i,l,h,p,v)}}class ta{constructor(t,i,l,h){this.kind=t,this.zoomStops=l,this._styleExpression=i,this.isStateDependent=t!=="camera"&&!Dl(i.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,i,l,h,p,v){return this._styleExpression.evaluateWithoutErrorHandling(t,i,l,h,p,v)}evaluate(t,i,l,h,p,v){return this._styleExpression.evaluate(t,i,l,h,p,v)}interpolationFactor(t,i,l){return this.interpolationType?wo.interpolationFactor(this.interpolationType,t,i,l):0}}function na(n,t){if((n=Ua(n,t)).result==="error")return n;const i=n.value.expression,l=Rl(i);if(!l&&!$a(t))return Va([new xo("","data expressions not supported")]);const h=ru(i,["zoom","pitch","distance-from-center"]);if(!h&&!Wo(t))return Va([new xo("","zoom expressions not supported")]);const p=Gl(i);return p||h?p instanceof xo?Va([p]):p instanceof wo&&!fu(t)?Va([new xo("",'"interpolate" expressions cannot be used with this property')]):Nl(p?new ta(l?"camera":"composite",n.value,p.labels,p instanceof wo?p.interpolation:void 0):new vu(l?"constant":"source",n.value)):Va([new xo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class jl{constructor(t,i){this._parameters=t,this._specification=i,qo(this,od(this._parameters,this._specification))}static deserialize(t){return new jl(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Gl(n){let t=null;if(n instanceof Yh)t=Gl(n.result);else if(n instanceof vp){for(const i of n.args)if(t=Gl(i),t)break}else(n instanceof jh||n instanceof wo)&&n.input instanceof gs&&n.input.name==="zoom"&&(t=n);return t instanceof xo||n.eachChild(i=>{const l=Gl(i);l instanceof xo?t=l:!t&&l?t=new xo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new xo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}class Ot{constructor(t,i,l,h){this.message=(t?`${t}: `:"")+l,h&&(this.identifier=h),i!=null&&i.__line__&&(this.line=i.__line__)}}function Kr(n){const t=n.key,i=n.value,l=n.valueSpec||{},h=n.objectElementValidators||{},p=n.style,v=n.styleSpec;let x=[];const S=Vn(i);if(S!=="object")return[new Ot(t,i,`object expected, ${S} found`)];for(const T in i){const k=T.split(".")[0],z=l[k]||l["*"];let R;h[k]?R=h[k]:l[k]?R=_r:h["*"]?R=h["*"]:l["*"]&&(R=_r),R?x=x.concat(R({key:(t&&`${t}.`)+T,value:i[T],valueSpec:z,style:p,styleSpec:v,object:i,objectKey:T},i)):x.push(new Ot(t,i[T],`unknown property "${T}"`))}for(const T in l)h[T]||l[T].required&&l[T].default===void 0&&i[T]===void 0&&x.push(new Ot(t,i,`missing required property "${T}"`));return x}function Mp(n){const t=n.value,i=n.valueSpec,l=n.style,h=n.styleSpec,p=n.key,v=n.arrayElementValidator||_r;if(Vn(t)!=="array")return[new Ot(p,t,`array expected, ${Vn(t)} found`)];if(i.length&&t.length!==i.length)return[new Ot(p,t,`array length ${i.length} expected, length ${t.length} found`)];if(i["min-length"]&&t.length<i["min-length"])return[new Ot(p,t,`array length at least ${i["min-length"]} expected, length ${t.length} found`)];let x={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};h.$version<7&&(x.function=i.function),Vn(i.value)==="object"&&(x=i.value);let S=[];for(let T=0;T<t.length;T++)S=S.concat(v({array:t,arrayIndex:T,value:t[T],valueSpec:x,style:l,styleSpec:h,key:`${p}[${T}]`}));return S}function ad(n){const t=n.key,i=n.value,l=n.valueSpec;let h=Vn(i);if(h==="number"&&i!=i&&(h="NaN"),h!=="number")return[new Ot(t,i,`number expected, ${h} found`)];if("minimum"in l){let p=l.minimum;if(Vn(l.minimum)==="array"&&(p=l.minimum[n.arrayIndex]),i<p)return[new Ot(t,i,`${i} is less than the minimum value ${p}`)]}if("maximum"in l){let p=l.maximum;if(Vn(l.maximum)==="array"&&(p=l.maximum[n.arrayIndex]),i>p)return[new Ot(t,i,`${i} is greater than the maximum value ${p}`)]}return[]}function ql(n){const t=n.valueSpec,i=Ui(n.value.type);let l,h,p,v={};const x=i!=="categorical"&&n.value.property===void 0,S=!x,T=Vn(n.value.stops)==="array"&&Vn(n.value.stops[0])==="array"&&Vn(n.value.stops[0][0])==="object",k=Kr({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(V){if(i==="identity")return[new Ot(V.key,V.value,'identity function may not have a "stops" property')];let $=[];const G=V.value;return $=$.concat(Mp({key:V.key,value:G,valueSpec:V.valueSpec,style:V.style,styleSpec:V.styleSpec,arrayElementValidator:z})),Vn(G)==="array"&&G.length===0&&$.push(new Ot(V.key,G,"array must have at least one stop")),$},default:function(V){return _r({key:V.key,value:V.value,valueSpec:t,style:V.style,styleSpec:V.styleSpec})}}});return i==="identity"&&x&&k.push(new Ot(n.key,n.value,'missing required property "property"')),i==="identity"||n.value.stops||k.push(new Ot(n.key,n.value,'missing required property "stops"')),i==="exponential"&&n.valueSpec.expression&&!fu(n.valueSpec)&&k.push(new Ot(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(S&&!$a(n.valueSpec)?k.push(new Ot(n.key,n.value,"property functions not supported")):x&&!Wo(n.valueSpec)&&k.push(new Ot(n.key,n.value,"zoom functions not supported"))),i!=="categorical"&&!T||n.value.property!==void 0||k.push(new Ot(n.key,n.value,'"property" property is required')),k;function z(V){let $=[];const G=V.value,X=V.key;if(Vn(G)!=="array")return[new Ot(X,G,`array expected, ${Vn(G)} found`)];if(G.length!==2)return[new Ot(X,G,`array length 2 expected, length ${G.length} found`)];if(T){if(Vn(G[0])!=="object")return[new Ot(X,G,`object expected, ${Vn(G[0])} found`)];if(G[0].zoom===void 0)return[new Ot(X,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new Ot(X,G,"object stop key must have value")];const le=Ui(G[0].zoom);if(typeof le!="number")return[new Ot(X,G[0].zoom,"stop zoom values must be numbers")];if(p&&p>le)return[new Ot(X,G[0].zoom,"stop zoom values must appear in ascending order")];le!==p&&(p=le,h=void 0,v={}),$=$.concat(Kr({key:`${X}[0]`,value:G[0],valueSpec:{zoom:{}},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{zoom:ad,value:R}}))}else $=$.concat(R({key:`${X}[0]`,value:G[0],valueSpec:{},style:V.style,styleSpec:V.styleSpec},G));return Na(ms(G[1]))?$.concat([new Ot(`${X}[1]`,G[1],"expressions are not allowed in function stops.")]):$.concat(_r({key:`${X}[1]`,value:G[1],valueSpec:t,style:V.style,styleSpec:V.styleSpec}))}function R(V,$){const G=Vn(V.value),X=Ui(V.value),le=V.value!==null?V.value:$;if(l){if(G!==l)return[new Ot(V.key,le,`${G} stop domain type must match previous stop domain type ${l}`)]}else l=G;if(G!=="number"&&G!=="string"&&G!=="boolean"&&typeof X!="number"&&typeof X!="string"&&typeof X!="boolean")return[new Ot(V.key,le,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&i!=="categorical"){let ye=`number expected, ${G} found`;return $a(t)&&i===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ot(V.key,le,ye)]}return i!=="categorical"||G!=="number"||typeof X=="number"&&isFinite(X)&&Math.floor(X)===X?i!=="categorical"&&G==="number"&&typeof X=="number"&&typeof h=="number"&&h!==void 0&&X<h?[new Ot(V.key,le,"stop domain values must appear in ascending order")]:(h=X,i==="categorical"&&X in v?[new Ot(V.key,le,"stop domain values must be unique")]:(v[X]=!0,[])):[new Ot(V.key,le,`integer expected, found ${String(X)}`)]}}function ja(n){const t=(n.expressionContext==="property"?na:Ua)(ms(n.value),n.valueSpec);if(t.result==="error")return t.value.map(l=>new Ot(`${n.key}${l.key}`,n.value,l.message));const i=t.value.expression||t.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!i.outputDefined())return[new Ot(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!Dl(i))return[new Ot(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter")return Pp(i,n);if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!ru(i,["zoom","feature-state"]))return[new Ot(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!Rl(i))return[new Ot(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Pp(n,t){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const h of t.valueSpec.expression.parameters)i.delete(h);if(i.size===0)return[];const l=[];return n instanceof gs&&i.has(n.name)?[new Ot(t.key,t.value,`["${n.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(n.eachChild(h=>{l.push(...Pp(h,t))}),l)}function _u(n){const t=n.key,i=n.value,l=n.valueSpec,h=[];return Array.isArray(l.values)?l.values.indexOf(Ui(i))===-1&&h.push(new Ot(t,i,`expected one of [${l.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(l.values).indexOf(Ui(i))===-1&&h.push(new Ot(t,i,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(i)} found`)),h}function ld(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const t of n.slice(1))if(!ld(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function yu(n,t="fill"){if(n==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};ld(n)||(n=bu(n));const i=n;let l=!0;try{l=function(T){if(!sr(T))return T;let k=ms(T);return Wl(k),k=Zl(k),k}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const h=et[`filter_${t}`],p=Ua(l,h);let v=null;if(p.result==="error")throw new Error(p.value.map(T=>`${T.key}: ${T.message}`).join(", "));v=(T,k,z)=>p.value.evaluate(T,k,{},z);let x=null,S=null;if(l!==i){const T=Ua(i,h);if(T.result==="error")throw new Error(T.value.map(k=>`${k.key}: ${k.message}`).join(", "));x=(k,z,R,V,$)=>T.value.evaluate(k,z,{},R,void 0,void 0,V,$),S=!Rl(T.value.expression)}return{filter:v,dynamicFilter:x||void 0,needGeometry:zp(l),needFeature:!!S}}function Zl(n){if(!Array.isArray(n))return n;const t=function(i){if(xu.has(i[0])){for(let l=1;l<i.length;l++)if(sr(i[l]))return!0}return i}(n);return t===!0?t:t.map(i=>Zl(i))}function Wl(n){let t=!1;const i=[];if(n[0]==="case"){for(let l=1;l<n.length-1;l+=2)t=t||sr(n[l]),i.push(n[l+1]);i.push(n[n.length-1])}else if(n[0]==="match"){t=t||sr(n[1]);for(let l=2;l<n.length-1;l+=2)i.push(n[l+1]);i.push(n[n.length-1])}else if(n[0]==="step"){t=t||sr(n[1]);for(let l=1;l<n.length-1;l+=2)i.push(n[l+1])}t&&(n.length=0,n.push("any",...i));for(let l=1;l<n.length;l++)Wl(n[l])}function sr(n){if(!Array.isArray(n))return!1;if((t=n[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let i=1;i<n.length;i++)if(sr(n[i]))return!0;return!1}const xu=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function fv(n,t){return n<t?-1:n>t?1:0}function zp(n){if(!Array.isArray(n))return!1;if(n[0]==="within")return!0;for(let t=1;t<n.length;t++)if(zp(n[t]))return!0;return!1}function bu(n){if(!n)return!0;const t=n[0];return n.length<=1?t!=="any":t==="=="?cd(n[1],n[2],"=="):t==="!="?Ga(cd(n[1],n[2],"==")):t==="<"||t===">"||t==="<="||t===">="?cd(n[1],n[2],t):t==="any"?(i=n.slice(1),["any"].concat(i.map(bu))):t==="all"?["all"].concat(n.slice(1).map(bu)):t==="none"?["all"].concat(n.slice(1).map(bu).map(Ga)):t==="in"?wu(n[1],n.slice(2)):t==="!in"?Ga(wu(n[1],n.slice(2))):t==="has"?Lp(n[1]):t==="!has"?Ga(Lp(n[1])):t!=="within"||n;var i}function cd(n,t,i){switch(n){case"$type":return[`filter-type-${i}`,t];case"$id":return[`filter-id-${i}`,t];default:return[`filter-${i}`,n,t]}}function wu(n,t){if(t.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(i=>typeof i!=typeof t[0])?["filter-in-large",n,["literal",t.sort(fv)]]:["filter-in-small",n,["literal",t]]}}function Lp(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Ga(n){return["!",n]}function ud(n){return ld(ms(n.value))?ja(qo({},n,{expressionContext:"filter",valueSpec:n.styleSpec[`filter_${n.layerType||"fill"}`]})):Rp(n)}function Rp(n){const t=n.value,i=n.key;if(Vn(t)!=="array")return[new Ot(i,t,`array expected, ${Vn(t)} found`)];const l=n.styleSpec;let h,p=[];if(t.length<1)return[new Ot(i,t,"filter array must have at least 1 element")];switch(p=p.concat(_u({key:`${i}[0]`,value:t[0],valueSpec:l.filter_operator,style:n.style,styleSpec:n.styleSpec})),Ui(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Ui(t[1])==="$type"&&p.push(new Ot(i,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&p.push(new Ot(i,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=Vn(t[1]),h!=="string"&&p.push(new Ot(`${i}[1]`,t[1],`string expected, ${h} found`)));for(let v=2;v<t.length;v++)h=Vn(t[v]),Ui(t[1])==="$type"?p=p.concat(_u({key:`${i}[${v}]`,value:t[v],valueSpec:l.geometry_type,style:n.style,styleSpec:n.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&p.push(new Ot(`${i}[${v}]`,t[v],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let v=1;v<t.length;v++)p=p.concat(Rp({key:`${i}[${v}]`,value:t[v],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":h=Vn(t[1]),t.length!==2?p.push(new Ot(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&p.push(new Ot(`${i}[1]`,t[1],`string expected, ${h} found`));break;case"within":h=Vn(t[1]),t.length!==2?p.push(new Ot(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="object"&&p.push(new Ot(`${i}[1]`,t[1],`object expected, ${h} found`))}return p}function Su(n,t){const i=n.key,l=n.style,h=n.styleSpec,p=n.value,v=n.objectKey,x=h[`${t}_${n.layerType}`];if(!x)return[];const S=v.match(/^(.*)-transition$/);if(t==="paint"&&S&&x[S[1]]&&x[S[1]].transition)return _r({key:i,value:p,valueSpec:h.transition,style:l,styleSpec:h});const T=n.valueSpec||x[v];if(!T)return[new Ot(i,p,`unknown property "${v}"`)];let k;if(Vn(p)==="string"&&$a(T)&&!T.tokens&&(k=/^{([^}]+)}$/.exec(p)))return[new Ot(i,p,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(k[1])} }\`.`)];const z=[];return n.layerType==="symbol"&&(v==="text-field"&&l&&!l.glyphs&&z.push(new Ot(i,p,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&pu(ms(p))&&Ui(p.type)==="identity"&&z.push(new Ot(i,p,'"text-font" does not support identity functions'))),z.concat(_r({key:n.key,value:p,valueSpec:T,style:l,styleSpec:h,expressionContext:"property",propertyType:t,propertyKey:v}))}function Dp(n){return Su(n,"paint")}function hd(n){return Su(n,"layout")}function dd(n){let t=[];const i=n.value,l=n.key,h=n.style,p=n.styleSpec;i.type||i.ref||t.push(new Ot(l,i,'either "type" or "ref" is required'));let v=Ui(i.type);const x=Ui(i.ref);if(i.id){const S=Ui(i.id);for(let T=0;T<n.arrayIndex;T++){const k=h.layers[T];Ui(k.id)===S&&t.push(new Ot(l,i.id,`duplicate layer id "${i.id}", previously used at line ${k.id.__line__}`))}}if("ref"in i){let S;["type","source","source-layer","filter","layout"].forEach(T=>{T in i&&t.push(new Ot(l,i[T],`"${T}" is prohibited for ref layers`))}),h.layers.forEach(T=>{Ui(T.id)===x&&(S=T)}),S?S.ref?t.push(new Ot(l,i.ref,"ref cannot reference another ref layer")):v=Ui(S.type):typeof x=="string"&&t.push(new Ot(l,i.ref,`ref layer "${x}" not found`))}else if(v!=="background"&&v!=="sky")if(i.source){const S=h.sources&&h.sources[i.source],T=S&&Ui(S.type);S?T==="vector"&&v==="raster"?t.push(new Ot(l,i.source,`layer "${i.id}" requires a raster source`)):T==="raster"&&v!=="raster"?t.push(new Ot(l,i.source,`layer "${i.id}" requires a vector source`)):T!=="vector"||i["source-layer"]?T==="raster-dem"&&v!=="hillshade"?t.push(new Ot(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||T==="geojson"&&S.lineMetrics||t.push(new Ot(l,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Ot(l,i,`layer "${i.id}" must specify a "source-layer"`)):t.push(new Ot(l,i.source,`source "${i.source}" not found`))}else t.push(new Ot(l,i,'missing required property "source"'));return t=t.concat(Kr({key:l,value:i,valueSpec:p.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>_r({key:`${l}.type`,value:i.type,valueSpec:p.layer.type,style:n.style,styleSpec:n.styleSpec,object:i,objectKey:"type"}),filter:S=>ud(qo({layerType:v},S)),layout:S=>Kr({layer:i,key:S.key,value:S.value,valueSpec:{},style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":T=>hd(qo({layerType:v},T))}}),paint:S=>Kr({layer:i,key:S.key,value:S.value,valueSpec:{},style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":T=>Dp(qo({layerType:v},T))}})}})),t}function qa(n){const t=n.value,i=n.key,l=Vn(t);return l!=="string"?[new Ot(i,t,`string expected, ${l} found`)]:[]}const Eu={promoteId:function({key:n,value:t}){if(Vn(t)==="string")return qa({key:n,value:t});{const i=[];for(const l in t)i.push(...qa({key:`${n}.${l}`,value:t[l]}));return i}}};function Hl(n){const t=n.value,i=n.key,l=n.styleSpec,h=n.style;if(!t.type)return[new Ot(i,t,'"type" is required')];const p=Ui(t.type);let v;switch(p){case"vector":case"raster":case"raster-dem":return v=Kr({key:i,value:t,valueSpec:l[`source_${p.replace("-","_")}`],style:n.style,styleSpec:l,objectElementValidators:Eu}),v;case"geojson":if(v=Kr({key:i,value:t,valueSpec:l.source_geojson,style:h,styleSpec:l,objectElementValidators:Eu}),t.cluster)for(const x in t.clusterProperties){const[S,T]=t.clusterProperties[x],k=typeof S=="string"?[S,["accumulated"],["get",x]]:S;v.push(...ja({key:`${i}.${x}.map`,value:T,expressionContext:"cluster-map"})),v.push(...ja({key:`${i}.${x}.reduce`,value:k,expressionContext:"cluster-reduce"}))}return v;case"video":return Kr({key:i,value:t,valueSpec:l.source_video,style:h,styleSpec:l});case"image":return Kr({key:i,value:t,valueSpec:l.source_image,style:h,styleSpec:l});case"canvas":return[new Ot(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _u({key:`${i}.type`,value:t.type,valueSpec:{values:Bp(l)},style:h,styleSpec:l})}}function Bp(n){return n.source.reduce((t,i)=>{const l=n[i];return l.type.type==="enum"&&(t=t.concat(Object.keys(l.type.values))),t},[])}function Op(n){const t=n.value,i=n.styleSpec,l=i.light,h=n.style;let p=[];const v=Vn(t);if(t===void 0)return p;if(v!=="object")return p=p.concat([new Ot("light",t,`object expected, ${v} found`)]),p;for(const x in t){const S=x.match(/^(.*)-transition$/);p=p.concat(S&&l[S[1]]&&l[S[1]].transition?_r({key:x,value:t[x],valueSpec:i.transition,style:h,styleSpec:i}):l[x]?_r({key:x,value:t[x],valueSpec:l[x],style:h,styleSpec:i}):[new Ot(x,t[x],`unknown property "${x}"`)])}return p}function fd(n){const t=n.value,i=n.key,l=n.style,h=n.styleSpec,p=h.terrain;let v=[];const x=Vn(t);if(t===void 0)return v;if(x!=="object")return v=v.concat([new Ot("terrain",t,`object expected, ${x} found`)]),v;for(const S in t){const T=S.match(/^(.*)-transition$/);v=v.concat(T&&p[T[1]]&&p[T[1]].transition?_r({key:S,value:t[S],valueSpec:h.transition,style:l,styleSpec:h}):p[S]?_r({key:S,value:t[S],valueSpec:p[S],style:l,styleSpec:h}):[new Ot(S,t[S],`unknown property "${S}"`)])}if(t.source){const S=l.sources&&l.sources[t.source],T=S&&Ui(S.type);S?T!=="raster-dem"&&v.push(new Ot(i,t.source,`terrain cannot be used with a source of type ${String(T)}, it only be used with a "raster-dem" source type`)):v.push(new Ot(i,t.source,`source "${t.source}" not found`))}else v.push(new Ot(i,t,'terrain is missing required property "source"'));return v}function Fp(n){const t=n.value,i=n.style,l=n.styleSpec,h=l.fog;let p=[];const v=Vn(t);if(t===void 0)return p;if(v!=="object")return p=p.concat([new Ot("fog",t,`object expected, ${v} found`)]),p;for(const x in t){const S=x.match(/^(.*)-transition$/);p=p.concat(S&&h[S[1]]&&h[S[1]].transition?_r({key:x,value:t[x],valueSpec:l.transition,style:i,styleSpec:l}):h[x]?_r({key:x,value:t[x],valueSpec:h[x],style:i,styleSpec:l}):[new Ot(x,t[x],`unknown property "${x}"`)])}return p}const Tu={"*":()=>[],array:Mp,boolean:function(n){const t=n.value,i=n.key,l=Vn(t);return l!=="boolean"?[new Ot(i,t,`boolean expected, ${l} found`)]:[]},number:ad,color:function(n){const t=n.key,i=n.value,l=Vn(i);return l!=="string"?[new Ot(t,i,`color expected, ${l} found`)]:Lh(i)===null?[new Ot(t,i,`color expected, "${i}" found`)]:[]},enum:_u,filter:ud,function:ql,layer:dd,object:Kr,source:Hl,light:Op,terrain:fd,fog:Fp,string:qa,formatted:function(n){return qa(n).length===0?[]:ja(n)},resolvedImage:function(n){return qa(n).length===0?[]:ja(n)},projection:function(n){const t=n.value,i=n.styleSpec,l=i.projection,h=n.style;let p=[];const v=Vn(t);if(v==="object")for(const x in t)p=p.concat(_r({key:x,value:t[x],valueSpec:l[x],style:h,styleSpec:i}));else v!=="string"&&(p=p.concat([new Ot("projection",t,`object or string expected, ${v} found`)]));return p}};function _r(n){const t=n.value,i=n.valueSpec,l=n.styleSpec;return i.expression&&pu(Ui(t))?ql(n):i.expression&&Na(ms(t))?ja(n):i.type&&Tu[i.type]?Tu[i.type](n):Kr(qo({},n,{valueSpec:i.type?l[i.type]:i}))}function pv(n){const t=n.value,i=n.key,l=qa(n);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new Ot(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new Ot(i,t,'"glyphs" url must include a "{range}" token'))),l}function Vp(n,t=et){return Ho(_r({key:"",value:n,valueSpec:t.$root,styleSpec:t,style:n,objectElementValidators:{glyphs:pv,"*":()=>[]}}))}const mv=n=>Ho(Dp(n)),$p=n=>Ho(hd(n));function Ho(n){return n.slice().sort((t,i)=>t.line&&i.line?t.line-i.line:0)}function Np(n,t){let i=!1;if(t&&t.length)for(const l of t)n.fire(new ps(new Error(l.message))),i=!0;return i}var Za=So;function So(n,t,i){var l=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var h=new Int32Array(this.arrayBuffer);n=h[0],this.d=(t=h[1])+2*(i=h[2]);for(var p=0;p<this.d*this.d;p++){var v=h[3+p],x=h[3+p+1];l.push(v===x?null:h.subarray(v,x))}var S=h[3+l.length+1];this.keys=h.subarray(h[3+l.length],S),this.bboxes=h.subarray(S),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var T=0;T<this.d*this.d;T++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=n,this.padding=i,this.scale=t/n,this.uid=0;var k=i/t*n;this.min=-k,this.max=n+k}So.prototype.insert=function(n,t,i,l,h){this._forEachCell(t,i,l,h,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(h)},So.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},So.prototype._insertCell=function(n,t,i,l,h,p){this.cells[h].push(p)},So.prototype.query=function(n,t,i,l,h){var p=this.min,v=this.max;if(n<=p&&t<=p&&v<=i&&v<=l&&!h)return Array.prototype.slice.call(this.keys);var x=[];return this._forEachCell(n,t,i,l,this._queryCell,x,{},h),x},So.prototype._queryCell=function(n,t,i,l,h,p,v,x){var S=this.cells[h];if(S!==null)for(var T=this.keys,k=this.bboxes,z=0;z<S.length;z++){var R=S[z];if(v[R]===void 0){var V=4*R;(x?x(k[V+0],k[V+1],k[V+2],k[V+3]):n<=k[V+2]&&t<=k[V+3]&&i>=k[V+0]&&l>=k[V+1])?(v[R]=!0,p.push(T[R])):v[R]=!1}}},So.prototype._forEachCell=function(n,t,i,l,h,p,v,x){for(var S=this._convertToCellCoord(n),T=this._convertToCellCoord(t),k=this._convertToCellCoord(i),z=this._convertToCellCoord(l),R=S;R<=k;R++)for(var V=T;V<=z;V++){var $=this.d*V+R;if((!x||x(this._convertFromCellCoord(R),this._convertFromCellCoord(V),this._convertFromCellCoord(R+1),this._convertFromCellCoord(V+1)))&&h.call(this,n,t,i,l,$,p,v,x))return}},So.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},So.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},So.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var h=new Int32Array(t+i+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var p=t,v=0;v<n.length;v++){var x=n[v];h[3+v]=p,h.set(x,p),p+=x.length}return h[3+n.length]=p,h.set(this.keys,p),h[3+n.length+1]=p+=this.keys.length,h.set(this.bboxes,p),p+=this.bboxes.length,h.buffer};const Cu={};function Nt(n,t,i={}){Object.defineProperty(n,"_classRegistryKey",{value:t,writeable:!1}),Cu[t]={klass:n,omit:i.omit||[]}}Nt(Object,"Object"),Za.serialize=function(n,t){const i=n.toArrayBuffer();return t&&t.push(i),{buffer:i}},Za.deserialize=function(n){return new Za(n.buffer)},Object.defineProperty(Za,"name",{value:"Grid"}),Nt(Za,"Grid"),Nt(Oi,"Color"),Nt(Error,"Error"),Nt(Ki,"AJAXError"),Nt(Ar,"ResolvedImage"),Nt(jl,"StylePropertyFunction"),Nt(gu,"StyleExpression",{omit:["_evaluator"]}),Nt(ta,"ZoomDependentExpression"),Nt(vu,"ZoomConstantExpression"),Nt(gs,"CompoundExpression",{omit:["_evaluate"]});for(const n in Fa)Cu[Fa[n]._classRegistryKey]||Nt(Fa[n],`Expression${n}`);function Up(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function Xl(n){return w.ImageBitmap&&n instanceof w.ImageBitmap}function Yl(n,t){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp)return n;if(Up(n)||Xl(n))return t&&t.push(n),n;if(ArrayBuffer.isView(n)){const i=n;return t&&t.push(i.buffer),i}if(n instanceof w.ImageData)return t&&t.push(n.data.buffer),n;if(Array.isArray(n)){const i=[];for(const l of n)i.push(Yl(l,t));return i}if(typeof n=="object"){const i=n.constructor,l=i._classRegistryKey;if(!l)throw new Error(`can't serialize object of unregistered class ${l}`);const h=i.serialize?i.serialize(n,t):{};if(!i.serialize){for(const p in n)n.hasOwnProperty(p)&&(Cu[l].omit.indexOf(p)>=0||(h[p]=Yl(n[p],t)));n instanceof Error&&(h.message=n.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(h.$name=l),h}throw new Error("can't serialize object of type "+typeof n)}function Kl(n){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||Up(n)||Xl(n)||ArrayBuffer.isView(n)||n instanceof w.ImageData)return n;if(Array.isArray(n))return n.map(Kl);if(typeof n=="object"){const t=n.$name||"Object",{klass:i}=Cu[t];if(!i)throw new Error(`can't deserialize unregistered class ${t}`);if(i.deserialize)return i.deserialize(n);const l=Object.create(i.prototype);for(const h of Object.keys(n))h!=="$name"&&(l[h]=Kl(n[h]));return l}throw new Error("can't deserialize object of type "+typeof n)}const Jl=n=>n>=1536&&n<=1791,jp=n=>n>=1872&&n<=1919,pd=n=>n>=2208&&n<=2303,Gp=n=>n>=11904&&n<=12031,md=n=>n>=12032&&n<=12255,gd=n=>n>=12272&&n<=12287,Ql=n=>n>=12288&&n<=12351,Iu=n=>n>=12352&&n<=12447,Wa=n=>n>=12448&&n<=12543,Au=n=>n>=12544&&n<=12591,qp=n=>n>=12704&&n<=12735,Zp=n=>n>=12736&&n<=12783,vd=n=>n>=12784&&n<=12799,Wp=n=>n>=12800&&n<=13055,Hp=n=>n>=13056&&n<=13311,Xp=n=>n>=13312&&n<=19903,_d=n=>n>=19968&&n<=40959,Yp=n=>n>=40960&&n<=42127,Kp=n=>n>=42128&&n<=42191,Jp=n=>n>=44032&&n<=55215,Qp=n=>n>=63744&&n<=64255,ku=n=>n>=64336&&n<=65023,ec=n=>n>=65040&&n<=65055,f=n=>n>=65072&&n<=65103,r=n=>n>=65104&&n<=65135,u=n=>n>=65136&&n<=65279,g=n=>n>=65280&&n<=65519;function y(n){for(const t of n)if(I(t.charCodeAt(0)))return!0;return!1}function b(n){for(const t of n)if(!C(t.charCodeAt(0)))return!1;return!0}function C(n){return!(Jl(n)||jp(n)||pd(n)||ku(n)||u(n))}function I(n){return!(n!==746&&n!==747&&(n<4352||!(qp(n)||Au(n)||f(n)&&!(n>=65097&&n<=65103)||Qp(n)||Hp(n)||Gp(n)||Zp(n)||!(!Ql(n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||Xp(n)||_d(n)||Wp(n)||(t=>t>=12592&&t<=12687)(n)||(t=>t>=43360&&t<=43391)(n)||(t=>t>=55216&&t<=55295)(n)||(t=>t>=4352&&t<=4607)(n)||Jp(n)||Iu(n)||gd(n)||(t=>t>=12688&&t<=12703)(n)||md(n)||vd(n)||Wa(n)&&n!==12540||!(!g(n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!r(n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||(t=>t>=5120&&t<=5759)(n)||(t=>t>=6320&&t<=6399)(n)||ec(n)||(t=>t>=19904&&t<=19967)(n)||Yp(n)||Kp(n))))}function M(n){return!(I(n)||function(t){return!!((i=>i>=128&&i<=255)(t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||(i=>i>=8192&&i<=8303)(t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||(i=>i>=8448&&i<=8527)(t)||(i=>i>=8528&&i<=8591)(t)||(i=>i>=8960&&i<=9215)(t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||(i=>i>=9216&&i<=9279)(t)&&t!==9251||(i=>i>=9280&&i<=9311)(t)||(i=>i>=9312&&i<=9471)(t)||(i=>i>=9632&&i<=9727)(t)||(i=>i>=9728&&i<=9983)(t)&&!(t>=9754&&t<=9759)||(i=>i>=11008&&i<=11263)(t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Ql(t)||Wa(t)||(i=>i>=57344&&i<=63743)(t)||f(t)||r(t)||g(t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(n))}function B(n){return n>=1424&&n<=2303||ku(n)||u(n)}function O(n,t){return!(!t&&B(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||(i=>i>=6016&&i<=6143)(n))}function j(n){for(const t of n)if(B(t.charCodeAt(0)))return!0;return!1}const H="deferred",Q="loading",J="loaded";let ee=null,te="unavailable",W=null;const ue=function(n){n&&typeof n=="string"&&n.indexOf("NetworkError")>-1&&(te="error"),ee&&ee(n)};function ae(){pe.fire(new ti("pluginStateChange",{pluginStatus:te,pluginURL:W}))}const pe=new Go,Ce=function(){return te},we=function(){if(te!==H||!W)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");te=Q,ae(),W&&yo({url:W},n=>{n?ue(n):(te=J,ae())})},Ae={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>te===J||Ae.applyArabicShaping!=null,isLoading:()=>te===Q,setState(n){te=n.pluginStatus,W=n.pluginURL},isParsed:()=>Ae.applyArabicShaping!=null&&Ae.processBidirectionalText!=null&&Ae.processStyledBidirectionalText!=null,getPluginURL:()=>W};class Be{constructor(t,i){this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(t){return function(i,l){for(const h of i)if(!O(h.charCodeAt(0),l))return!1;return!0}(t,Ae.isLoaded())}}class Ne{constructor(t,i){this.property=t,this.value=i,this.expression=function(l,h){if(pu(l))return new jl(l,h);if(Na(l)){const p=na(l,h);if(p.result==="error")throw new Error(p.value.map(v=>`${v.key}: ${v.message}`).join(", "));return p.value}{let p=l;return typeof l=="string"&&h.type==="color"&&(p=Oi.parse(l)),{kind:"constant",evaluate:()=>p}}}(i===void 0?t.specification.default:i,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,i,l){return this.property.possiblyEvaluate(this,t,i,l)}}class Ge{constructor(t){this.property=t,this.value=new Ne(t,void 0)}transitioned(t,i){return new Fe(this.property,this.value,i,pt({},t.transition,this.transition),t.now)}untransitioned(){return new Fe(this.property,this.value,null,{},0)}}class wt{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Fn(this._values[t].value.value)}setValue(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new Ge(this._values[t].property)),this._values[t].value=new Ne(this._values[t].property,i===null?void 0:Fn(i))}getTransition(t){return Fn(this._values[t].transition)}setTransition(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new Ge(this._values[t].property)),this._values[t].transition=Fn(i)||void 0}serialize(){const t={};for(const i of Object.keys(this._values)){const l=this.getValue(i);l!==void 0&&(t[i]=l);const h=this.getTransition(i);h!==void 0&&(t[`${i}-transition`]=h)}return t}transitioned(t,i){const l=new rt(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].transitioned(t,i._values[h]);return l}untransitioned(){const t=new rt(this._properties);for(const i of Object.keys(this._values))t._values[i]=this._values[i].untransitioned();return t}}class Fe{constructor(t,i,l,h,p){const v=h.delay||0,x=h.duration||0;p=p||0,this.property=t,this.value=i,this.begin=p+v,this.end=this.begin+x,t.specification.transition&&(h.delay||h.duration)&&(this.prior=l)}possiblyEvaluate(t,i,l){const h=t.now||0,p=this.value.possiblyEvaluate(t,i,l),v=this.prior;if(v){if(h>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(h<this.begin)return v.possiblyEvaluate(t,i,l);{const x=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(t,i,l),p,ze(x))}}return p}}class rt{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,i,l){const h=new Ue(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(t,i,l);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Xe{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return Fn(this._values[t].value)}setValue(t,i){this._values[t]=new Ne(this._values[t].property,i===null?void 0:Fn(i))}serialize(){const t={};for(const i of Object.keys(this._values)){const l=this.getValue(i);l!==void 0&&(t[i]=l)}return t}possiblyEvaluate(t,i,l){const h=new Ue(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(t,i,l);return h}}class ht{constructor(t,i,l){this.property=t,this.value=i,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,i,l,h){return this.property.evaluate(this.value,this.parameters,t,i,l,h)}}class Ue{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Le{constructor(t){this.specification=t}possiblyEvaluate(t,i){return t.expression.evaluate(i)}interpolate(t,i,l){const h=Bl[this.specification.type];return h?h(t,i,l):t}}class Ze{constructor(t,i){this.specification=t,this.overrides=i}possiblyEvaluate(t,i,l,h){return new ht(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(i,null,{},l,h)}:t.expression,i)}interpolate(t,i,l){if(t.value.kind!=="constant"||i.value.kind!=="constant")return t;if(t.value.value===void 0||i.value.value===void 0)return new ht(this,{kind:"constant",value:void 0},t.parameters);const h=Bl[this.specification.type];return h?new ht(this,{kind:"constant",value:h(t.value.value,i.value.value,l)},t.parameters):t}evaluate(t,i,l,h,p,v){return t.kind==="constant"?t.value:t.evaluate(i,l,h,p,v)}}class lt{constructor(t){this.specification=t}possiblyEvaluate(t,i,l,h){return!!t.expression.evaluate(i,null,{},l,h)}interpolate(){return!1}}class mt{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new Be(0,{});for(const l in t){const h=t[l];h.specification.overridable&&this.overridableProperties.push(l);const p=this.defaultPropertyValues[l]=new Ne(h,void 0),v=this.defaultTransitionablePropertyValues[l]=new Ge(h);this.defaultTransitioningPropertyValues[l]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=p.possiblyEvaluate(i)}}}function Ht(n,t){return 256*(n=nt(Math.floor(n),0,255))+nt(Math.floor(t),0,255)}Nt(Ze,"DataDrivenProperty"),Nt(Le,"DataConstantProperty"),Nt(lt,"ColorRampProperty");const gn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class jt{constructor(t,i){this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Vt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,i){return t._trim(),i&&(t.isTransferred=!0,i.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const i=Object.create(this.prototype);return i.arrayBuffer=t.arrayBuffer,i.length=t.length,i.capacity=t.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Xt(n,t=1){let i=0,l=0;return{members:n.map(h=>{const p=gn[h.type].BYTES_PER_ELEMENT,v=i=kn(i,Math.max(t,p)),x=h.components||1;return l=Math.max(l,p),i+=p*x,{name:h.name,type:h.type,components:x,offset:v}}),size:kn(i,Math.max(l,t)),alignment:t}}function kn(n,t){return Math.ceil(n/t)*t}class en extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i){const l=this.length;return this.resize(l+1),this.emplace(l,t,i)}emplace(t,i,l){const h=2*t;return this.int16[h+0]=i,this.int16[h+1]=l,t}}en.prototype.bytesPerElement=4,Nt(en,"StructArrayLayout2i4");class Hn extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,l)}emplace(t,i,l,h){const p=3*t;return this.int16[p+0]=i,this.int16[p+1]=l,this.int16[p+2]=h,t}}Hn.prototype.bytesPerElement=6,Nt(Hn,"StructArrayLayout3i6");class ni extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=4*t;return this.int16[v+0]=i,this.int16[v+1]=l,this.int16[v+2]=h,this.int16[v+3]=p,t}}ni.prototype.bytesPerElement=8,Nt(ni,"StructArrayLayout4i8");class ui extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,t,i,l,h,p,v,x)}emplace(t,i,l,h,p,v,x,S){const T=6*t,k=12*t,z=3*t;return this.int16[T+0]=i,this.int16[T+1]=l,this.uint8[k+4]=h,this.uint8[k+5]=p,this.uint8[k+6]=v,this.uint8[k+7]=x,this.float32[z+2]=S,t}}ui.prototype.bytesPerElement=12,Nt(ui,"StructArrayLayout2i4ub1f12");class oi extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=4*t;return this.float32[v+0]=i,this.float32[v+1]=l,this.float32[v+2]=h,this.float32[v+3]=p,t}}oi.prototype.bytesPerElement=16,Nt(oi,"StructArrayLayout4f16");class ji extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,l,h,p)}emplace(t,i,l,h,p,v){const x=6*t,S=3*t;return this.uint16[x+0]=i,this.uint16[x+1]=l,this.uint16[x+2]=h,this.uint16[x+3]=p,this.float32[S+2]=v,t}}ji.prototype.bytesPerElement=12,Nt(ji,"StructArrayLayout4ui1f12");class Or extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=4*t;return this.uint16[v+0]=i,this.uint16[v+1]=l,this.uint16[v+2]=h,this.uint16[v+3]=p,t}}Or.prototype.bytesPerElement=8,Nt(Or,"StructArrayLayout4ui8");class co extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,i,l,h,p,v)}emplace(t,i,l,h,p,v,x){const S=6*t;return this.int16[S+0]=i,this.int16[S+1]=l,this.int16[S+2]=h,this.int16[S+3]=p,this.int16[S+4]=v,this.int16[S+5]=x,t}}co.prototype.bytesPerElement=12,Nt(co,"StructArrayLayout6i12");class Xo extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,x,S,T,k,z,R){const V=this.length;return this.resize(V+1),this.emplace(V,t,i,l,h,p,v,x,S,T,k,z,R)}emplace(t,i,l,h,p,v,x,S,T,k,z,R,V){const $=12*t;return this.int16[$+0]=i,this.int16[$+1]=l,this.int16[$+2]=h,this.int16[$+3]=p,this.uint16[$+4]=v,this.uint16[$+5]=x,this.uint16[$+6]=S,this.uint16[$+7]=T,this.int16[$+8]=k,this.int16[$+9]=z,this.int16[$+10]=R,this.int16[$+11]=V,t}}Xo.prototype.bytesPerElement=24,Nt(Xo,"StructArrayLayout4i4ui4i24");class yi extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,i,l,h,p,v)}emplace(t,i,l,h,p,v,x){const S=10*t,T=5*t;return this.int16[S+0]=i,this.int16[S+1]=l,this.int16[S+2]=h,this.float32[T+2]=p,this.float32[T+3]=v,this.float32[T+4]=x,t}}yi.prototype.bytesPerElement=20,Nt(yi,"StructArrayLayout3i3f20");class si extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint32[1*t+0]=i,t}}si.prototype.bytesPerElement=4,Nt(si,"StructArrayLayout1ul4");class Un extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,x,S,T,k,z,R,V){const $=this.length;return this.resize($+1),this.emplace($,t,i,l,h,p,v,x,S,T,k,z,R,V)}emplace(t,i,l,h,p,v,x,S,T,k,z,R,V,$){const G=20*t,X=10*t;return this.int16[G+0]=i,this.int16[G+1]=l,this.int16[G+2]=h,this.int16[G+3]=p,this.int16[G+4]=v,this.float32[X+3]=x,this.float32[X+4]=S,this.float32[X+5]=T,this.float32[X+6]=k,this.int16[G+14]=z,this.uint32[X+8]=R,this.uint16[G+18]=V,this.uint16[G+19]=$,t}}Un.prototype.bytesPerElement=40,Nt(Un,"StructArrayLayout5i4f1i1ul2ui40");class Mi extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,t,i,l,h,p,v,x)}emplace(t,i,l,h,p,v,x,S){const T=8*t;return this.int16[T+0]=i,this.int16[T+1]=l,this.int16[T+2]=h,this.int16[T+4]=p,this.int16[T+5]=v,this.int16[T+6]=x,this.int16[T+7]=S,t}}Mi.prototype.bytesPerElement=16,Nt(Mi,"StructArrayLayout3i2i2i16");class yr extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,l,h,p)}emplace(t,i,l,h,p,v){const x=4*t,S=8*t;return this.float32[x+0]=i,this.float32[x+1]=l,this.float32[x+2]=h,this.int16[S+6]=p,this.int16[S+7]=v,t}}yr.prototype.bytesPerElement=16,Nt(yr,"StructArrayLayout2f1f2i16");class mi extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=12*t,x=3*t;return this.uint8[v+0]=i,this.uint8[v+1]=l,this.float32[x+1]=h,this.float32[x+2]=p,t}}mi.prototype.bytesPerElement=12,Nt(mi,"StructArrayLayout2ub2f12");class xr extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,l)}emplace(t,i,l,h){const p=3*t;return this.float32[p+0]=i,this.float32[p+1]=l,this.float32[p+2]=h,t}}xr.prototype.bytesPerElement=12,Nt(xr,"StructArrayLayout3f12");class br extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,l)}emplace(t,i,l,h){const p=3*t;return this.uint16[p+0]=i,this.uint16[p+1]=l,this.uint16[p+2]=h,t}}br.prototype.bytesPerElement=6,Nt(br,"StructArrayLayout3ui6");class xs extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,x,S,T,k,z,R,V,$,G,X,le,ye,re,ge,Te){const xe=this.length;return this.resize(xe+1),this.emplace(xe,t,i,l,h,p,v,x,S,T,k,z,R,V,$,G,X,le,ye,re,ge,Te)}emplace(t,i,l,h,p,v,x,S,T,k,z,R,V,$,G,X,le,ye,re,ge,Te,xe){const je=30*t,$e=15*t,tt=60*t;return this.int16[je+0]=i,this.int16[je+1]=l,this.int16[je+2]=h,this.float32[$e+2]=p,this.float32[$e+3]=v,this.uint16[je+8]=x,this.uint16[je+9]=S,this.uint32[$e+5]=T,this.uint32[$e+6]=k,this.uint32[$e+7]=z,this.uint16[je+16]=R,this.uint16[je+17]=V,this.uint16[je+18]=$,this.float32[$e+10]=G,this.float32[$e+11]=X,this.uint8[tt+48]=le,this.uint8[tt+49]=ye,this.uint8[tt+50]=re,this.uint32[$e+13]=ge,this.int16[je+28]=Te,this.uint8[tt+58]=xe,t}}xs.prototype.bytesPerElement=60,Nt(xs,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Ha extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,x,S,T,k,z,R,V,$,G,X,le,ye,re,ge,Te,xe,je,$e,tt,vt,We,it,ot,dt){const _t=this.length;return this.resize(_t+1),this.emplace(_t,t,i,l,h,p,v,x,S,T,k,z,R,V,$,G,X,le,ye,re,ge,Te,xe,je,$e,tt,vt,We,it,ot,dt)}emplace(t,i,l,h,p,v,x,S,T,k,z,R,V,$,G,X,le,ye,re,ge,Te,xe,je,$e,tt,vt,We,it,ot,dt,_t){const Ye=38*t,It=19*t;return this.int16[Ye+0]=i,this.int16[Ye+1]=l,this.int16[Ye+2]=h,this.float32[It+2]=p,this.float32[It+3]=v,this.int16[Ye+8]=x,this.int16[Ye+9]=S,this.int16[Ye+10]=T,this.int16[Ye+11]=k,this.int16[Ye+12]=z,this.int16[Ye+13]=R,this.uint16[Ye+14]=V,this.uint16[Ye+15]=$,this.uint16[Ye+16]=G,this.uint16[Ye+17]=X,this.uint16[Ye+18]=le,this.uint16[Ye+19]=ye,this.uint16[Ye+20]=re,this.uint16[Ye+21]=ge,this.uint16[Ye+22]=Te,this.uint16[Ye+23]=xe,this.uint16[Ye+24]=je,this.uint16[Ye+25]=$e,this.uint16[Ye+26]=tt,this.uint16[Ye+27]=vt,this.uint16[Ye+28]=We,this.uint32[It+15]=it,this.float32[It+16]=ot,this.float32[It+17]=dt,this.float32[It+18]=_t,t}}Ha.prototype.bytesPerElement=76,Nt(Ha,"StructArrayLayout3i2f6i15ui1ul3f76");class Wr extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.float32[1*t+0]=i,t}}Wr.prototype.bytesPerElement=4,Nt(Wr,"StructArrayLayout1f4");class Jr extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,l,h,p)}emplace(t,i,l,h,p,v){const x=5*t;return this.float32[x+0]=i,this.float32[x+1]=l,this.float32[x+2]=h,this.float32[x+3]=p,this.float32[x+4]=v,t}}Jr.prototype.bytesPerElement=20,Nt(Jr,"StructArrayLayout5f20");class Yo extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=6*t;return this.uint32[3*t+0]=i,this.uint16[v+2]=l,this.uint16[v+3]=h,this.uint16[v+4]=p,t}}Yo.prototype.bytesPerElement=12,Nt(Yo,"StructArrayLayout1ul3ui12");class bs extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i){const l=this.length;return this.resize(l+1),this.emplace(l,t,i)}emplace(t,i,l){const h=2*t;return this.uint16[h+0]=i,this.uint16[h+1]=l,t}}bs.prototype.bytesPerElement=4,Nt(bs,"StructArrayLayout2ui4");class ws extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint16[1*t+0]=i,t}}ws.prototype.bytesPerElement=2,Nt(ws,"StructArrayLayout1ui2");class Xa extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i){const l=this.length;return this.resize(l+1),this.emplace(l,t,i)}emplace(t,i,l){const h=2*t;return this.float32[h+0]=i,this.float32[h+1]=l,t}}Xa.prototype.bytesPerElement=8,Nt(Xa,"StructArrayLayout2f8");class nx extends jt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}nx.prototype.size=40;class gv extends Un{get(t){return new nx(this,t)}}Nt(gv,"CollisionBoxArray");class ix extends jt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}ix.prototype.size=60;class rx extends xs{get(t){return new ix(this,t)}}Nt(rx,"PlacedSymbolArray");class ox extends jt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(t){this._structArray.uint32[this._pos4+15]=t}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}ox.prototype.size=76;class sx extends Ha{get(t){return new ox(this,t)}}Nt(sx,"SymbolInstanceArray");class ax extends Wr{getoffsetX(t){return this.float32[1*t+0]}}Nt(ax,"GlyphOffsetArray");class lx extends en{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}Nt(lx,"SymbolLineVertexArray");class cx extends jt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}cx.prototype.size=12;class ux extends Yo{get(t){return new cx(this,t)}}Nt(ux,"FeatureIndexArray");class hx extends bs{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}Nt(hx,"FillExtrusionCentroidArray");const KC=Xt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),JC=Xt([{name:"a_dash",components:4,type:"Uint16"}]);var tc={},QC={get exports(){return tc},set exports(n){tc=n}},vv={};({get exports(){return vv},set exports(n){vv=n}}).exports=function(n,t){var i,l,h,p,v,x,S,T;for(l=n.length-(i=3&n.length),h=t,v=3432918353,x=461845907,T=0;T<l;)S=255&n.charCodeAt(T)|(255&n.charCodeAt(++T))<<8|(255&n.charCodeAt(++T))<<16|(255&n.charCodeAt(++T))<<24,++T,h=27492+(65535&(p=5*(65535&(h=(h^=S=(65535&(S=(S=(65535&S)*v+(((S>>>16)*v&65535)<<16)&4294967295)<<15|S>>>17))*x+(((S>>>16)*x&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(p>>>16)&65535)<<16);switch(S=0,i){case 3:S^=(255&n.charCodeAt(T+2))<<16;case 2:S^=(255&n.charCodeAt(T+1))<<8;case 1:h^=S=(65535&(S=(S=(65535&(S^=255&n.charCodeAt(T)))*v+(((S>>>16)*v&65535)<<16)&4294967295)<<15|S>>>17))*x+(((S>>>16)*x&65535)<<16)&4294967295}return h^=n.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var _v={};({get exports(){return _v},set exports(n){_v=n}}).exports=function(n,t){for(var i,l=n.length,h=t^l,p=0;l>=4;)i=1540483477*(65535&(i=255&n.charCodeAt(p)|(255&n.charCodeAt(++p))<<8|(255&n.charCodeAt(++p))<<16|(255&n.charCodeAt(++p))<<24))+((1540483477*(i>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),l-=4,++p;switch(l){case 3:h^=(255&n.charCodeAt(p+2))<<16;case 2:h^=(255&n.charCodeAt(p+1))<<8;case 1:h=1540483477*(65535&(h^=255&n.charCodeAt(p)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var dx=vv,eI=_v;QC.exports=dx,tc.murmur3=dx,tc.murmur2=eI;class em{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,i,l,h){this.ids.push(fx(t)),this.positions.push(i,l,h)}getPositions(t){const i=fx(t);let l=0,h=this.ids.length-1;for(;l<h;){const v=l+h>>1;this.ids[v]>=i?h=v:l=v+1}const p=[];for(;this.ids[l]===i;)p.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return p}static serialize(t,i){const l=new Float64Array(t.ids),h=new Uint32Array(t.positions);return yv(l,h,0,l.length-1),i&&i.push(l.buffer,h.buffer),{ids:l,positions:h}}static deserialize(t){const i=new em;return i.ids=t.ids,i.positions=t.positions,i.indexed=!0,i}}function fx(n){const t=+n;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:tc(String(n))}function yv(n,t,i,l){for(;i<l;){const h=n[i+l>>1];let p=i-1,v=l+1;for(;;){do p++;while(n[p]<h);do v--;while(n[v]>h);if(p>=v)break;tm(n,p,v),tm(t,3*p,3*v),tm(t,3*p+1,3*v+1),tm(t,3*p+2,3*v+2)}v-i<l-v?(yv(n,t,i,v),i=v+1):(yv(n,t,v+1,l),l=v)}}function tm(n,t,i){const l=n[t];n[t]=n[i],n[i]=l}Nt(em,"FeaturePositionMap");class ia{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,i),this.initialized=!0),!!this.location}}class nm extends ia{constructor(t){super(t),this.current=0}set(t,i,l){this.fetchUniformLocation(t,i)&&this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class px extends ia{constructor(t){super(t),this.current=[0,0,0,0]}set(t,i,l){this.fetchUniformLocation(t,i)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3])))}}class mx extends ia{constructor(t){super(t),this.current=Oi.transparent}set(t,i,l){this.fetchUniformLocation(t,i)&&(l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a)))}}const tI=new Float32Array(16),nI=new Float32Array(9),iI=new Float32Array(4);function xv(n){return[Ht(255*n.r,255*n.g),Ht(255*n.b,255*n.a)]}class yd{constructor(t,i,l){this.value=t,this.uniformNames=i.map(h=>`u_${h}`),this.type=l}setUniform(t,i,l,h,p){i.set(t,p,h.constantOr(this.value))}getBinding(t,i){return this.type==="color"?new mx(t):new nm(t)}}class Mu{constructor(t,i){this.uniformNames=i.map(l=>`u_${l}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,i,l,h,p){const v=p==="u_pattern"||p==="u_dash"?this.pattern:p==="u_pixel_ratio"?this.pixelRatio:null;v&&i.set(t,p,v)}getBinding(t,i){return i==="u_pattern"||i==="u_dash"?new px(t):new nm(t)}}class ra{constructor(t,i,l,h){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=i.map(p=>({name:`a_${p}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,i,l,h,p,v){const x=this.paintVertexArray.length,S=this.expression.evaluate(new Be(0),i,{},p,h,v);this.paintVertexArray.resize(t),this._setPaintValue(x,t,S)}updatePaintArray(t,i,l,h,p){const v=this.expression.evaluate({zoom:0},l,h,void 0,p);this._setPaintValue(t,i,v)}_setPaintValue(t,i,l){if(this.type==="color"){const h=xv(l);for(let p=t;p<i;p++)this.paintVertexArray.emplace(p,h[0],h[1])}else{for(let h=t;h<i;h++)this.paintVertexArray.emplace(h,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ko{constructor(t,i,l,h,p,v){this.expression=t,this.uniformNames=i.map(x=>`u_${x}_t`),this.type=l,this.useIntegerZoom=h,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=i.map(x=>({name:`a_${x}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(t,i,l,h,p,v){const x=this.expression.evaluate(new Be(this.zoom),i,{},p,h,v),S=this.expression.evaluate(new Be(this.zoom+1),i,{},p,h,v),T=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(T,t,x,S)}updatePaintArray(t,i,l,h,p){const v=this.expression.evaluate({zoom:this.zoom},l,h,void 0,p),x=this.expression.evaluate({zoom:this.zoom+1},l,h,void 0,p);this._setPaintValue(t,i,v,x)}_setPaintValue(t,i,l,h){if(this.type==="color"){const p=xv(l),v=xv(h);for(let x=t;x<i;x++)this.paintVertexArray.emplace(x,p[0],p[1],v[0],v[1])}else{for(let p=t;p<i;p++)this.paintVertexArray.emplace(p,l,h);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,i,l,h,p){const v=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,x=nt(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);i.set(t,p,x)}getBinding(t,i){return new nm(t)}}class Ya{constructor(t,i,l,h,p){this.expression=t,this.layerId=p,this.paintVertexAttributes=(l==="array"?JC:KC).members;for(let v=0;v<i.length;++v);this.paintVertexArray=new h}populatePaintArray(t,i,l){const h=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(h,t,i.patterns&&i.patterns[this.layerId],l)}updatePaintArray(t,i,l,h,p,v){this._setPaintValues(t,i,l.patterns&&l.patterns[this.layerId],v)}_setPaintValues(t,i,l,h){if(!h||!l)return;const p=h[l];if(!p)return;const{tl:v,br:x,pixelRatio:S}=p;for(let T=t;T<i;T++)this.paintVertexArray.emplace(T,v[0],v[1],x[0],x[1],S)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ka{constructor(t,i,l=()=>!0){this.binders={},this._buffers=[];const h=[];for(const p in t.paint._values){if(!l(p))continue;const v=t.paint.get(p);if(!(v instanceof ht&&$a(v.property.specification)))continue;const x=oI(p,t.type),S=v.value,T=v.property.specification.type,k=v.property.useIntegerZoom,z=p==="line-dasharray"||p.endsWith("pattern"),R=p==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(S.kind!=="constant"||R)if(S.kind==="source"||R||z){const V=gx(p,T,"source");this.binders[p]=z?new Ya(S,x,T,V,t.id):new ra(S,x,T,V),h.push(`/a_${p}`)}else{const V=gx(p,T,"composite");this.binders[p]=new Ko(S,x,T,k,i,V),h.push(`/z_${p}`)}else this.binders[p]=z?new Mu(S.value,x):new yd(S.value,x,T),h.push(`/u_${p}`)}this.cacheKey=h.sort().join("")}getMaxValue(t){const i=this.binders[t];return i instanceof ra||i instanceof Ko?i.maxValue:0}populatePaintArrays(t,i,l,h,p,v){for(const x in this.binders){const S=this.binders[x];(S instanceof ra||S instanceof Ko||S instanceof Ya)&&S.populatePaintArray(t,i,l,h,p,v)}}setConstantPatternPositions(t){for(const i in this.binders){const l=this.binders[i];l instanceof Mu&&l.setConstantPatternPositions(t)}}updatePaintArrays(t,i,l,h,p,v){let x=!1;for(const S in t){const T=i.getPositions(S);for(const k of T){const z=l.feature(k.index);for(const R in this.binders){const V=this.binders[R];if((V instanceof ra||V instanceof Ko||V instanceof Ya)&&V.expression.isStateDependent===!0){const $=h.paint.get(R);V.expression=$.value,V.updatePaintArray(k.start,k.end,z,t[S],p,v),x=!0}}}}return x}defines(){const t=[];for(const i in this.binders){const l=this.binders[i];(l instanceof yd||l instanceof Mu)&&t.push(...l.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const i in this.binders){const l=this.binders[i];if(l instanceof ra||l instanceof Ko||l instanceof Ya)for(let h=0;h<l.paintVertexAttributes.length;h++)t.push(l.paintVertexAttributes[h].name)}return t}getBinderUniforms(){const t=[];for(const i in this.binders){const l=this.binders[i];if(l instanceof yd||l instanceof Mu||l instanceof Ko)for(const h of l.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const i=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof yd||h instanceof Mu||h instanceof Ko)for(const p of h.uniformNames)i.push({name:p,property:l,binding:h.getBinding(t,p)})}return i}setUniforms(t,i,l,h,p){for(const{name:v,property:x,binding:S}of l)this.binders[x].setUniform(t,S,p,h.get(x),v)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const i=this.binders[t];(i instanceof ra||i instanceof Ko||i instanceof Ya)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(t){for(const i in this.binders){const l=this.binders[i];(l instanceof ra||l instanceof Ko||l instanceof Ya)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const i=this.binders[t];(i instanceof ra||i instanceof Ko||i instanceof Ya)&&i.destroy()}}}class nc{constructor(t,i,l=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new Ka(h,i,l);this.needsUpload=!1,this._featureMap=new em,this._bufferOffset=0}populatePaintArrays(t,i,l,h,p,v,x){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(t,i,h,p,v,x);i.id!==void 0&&this._featureMap.add(i.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,i,l,h,p){for(const v of l)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(t,this._featureMap,i,v,h,p)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const rI={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function oI(n,t){return rI[n]||[n.replace(`${t}-`,"").replace(/-/g,"_")]}const sI={"line-pattern":{source:ji,composite:ji},"fill-pattern":{source:ji,composite:ji},"fill-extrusion-pattern":{source:ji,composite:ji},"line-dasharray":{source:Or,composite:Or}},aI={color:{source:Xa,composite:oi},number:{source:Wr,composite:Xa}};function gx(n,t,i){const l=sI[n];return l&&l[i]||aI[t][i]}Nt(yd,"ConstantBinder"),Nt(Mu,"PatternConstantBinder"),Nt(ra,"SourceExpressionBinder"),Nt(Ya,"PatternCompositeBinder"),Nt(Ko,"CompositeExpressionBinder"),Nt(Ka,"ProgramConfiguration",{omit:["_buffers"]}),Nt(nc,"ProgramConfigurationSet");const im="-transition";class Jo extends Go{constructor(t,i){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),i.layout&&(this._unevaluatedLayout=new Xe(i.layout)),i.paint)){this._transitionablePaint=new wt(i.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ue(i.paint)}}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,i,l={}){i!=null&&this._validate($p,`layers.${this.id}.layout.${t}`,t,i,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,i):this.visibility=i)}getPaintProperty(t){return Tt(t,im)?this._transitionablePaint.getTransition(t.slice(0,-im.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,i,l={}){if(i!=null&&this._validate(mv,`layers.${this.id}.paint.${t}`,t,i,l))return!1;if(Tt(t,im))return this._transitionablePaint.setTransition(t.slice(0,-im.length),i||void 0),!1;{const h=this._transitionablePaint._values[t],p=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(t,i),this._handleSpecialPaintPropertyUpdate(t);const x=this._transitionablePaint._values[t].value,S=x.isDataDriven(),T=Tt(t,"pattern")||t==="line-dasharray";return S||p||T||this._handleOverridablePaintPropertyUpdate(t,v,x)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,i,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,i)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),pn(t,(i,l)=>!(i===void 0||l==="layout"&&!Object.keys(i).length||l==="paint"&&!Object.keys(i).length))}_validate(t,i,l,h,p={}){return(!p||p.validate!==!1)&&Np(this,t.call(Vp,{key:i,layerType:this.type,objectKey:l,value:h,styleSpec:et,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const i=this.paint.get(t);if(i instanceof ht&&$a(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=yu(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const lI=Xt([{name:"a_pos",components:2,type:"Int16"}],4),cI=Xt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Gi{constructor(t=[]){this.segments=t}prepareSegment(t,i,l,h){let p=this.segments[this.segments.length-1];return t>Gi.MAX_VERTEX_ARRAY_LENGTH&&he(`Max vertices per segment is ${Gi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!p||p.vertexLength+t>Gi.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==h)&&(p={vertexOffset:i.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},h!==void 0&&(p.sortKey=h),this.segments.push(p)),p}get(){return this.segments}destroy(){for(const t of this.segments)for(const i in t.vaos)t.vaos[i].destroy()}static simpleSegment(t,i,l,h){return new Gi([{vertexOffset:t,primitiveOffset:i,vertexLength:l,primitiveLength:h,vaos:{},sortKey:0}])}}Gi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Nt(Gi,"SegmentVector");var hn=8192;class Ja{constructor(t,i){t&&(i?this.setSouthWest(t).setNorthEast(i):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Nn?new Nn(t.lng,t.lat):Nn.convert(t),this}setSouthWest(t){return this._sw=t instanceof Nn?new Nn(t.lng,t.lat):Nn.convert(t),this}extend(t){const i=this._sw,l=this._ne;let h,p;if(t instanceof Nn)h=t,p=t;else{if(!(t instanceof Ja))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Ja.convert(t)):this.extend(Nn.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&t.hasOwnProperty("lon")?this.extend(Nn.convert(t)):this;if(h=t._sw,p=t._ne,!h||!p)return this}return i||l?(i.lng=Math.min(h.lng,i.lng),i.lat=Math.min(h.lat,i.lat),l.lng=Math.max(p.lng,l.lng),l.lat=Math.max(p.lat,l.lat)):(this._sw=new Nn(h.lng,h.lat),this._ne=new Nn(p.lng,p.lat)),this}getCenter(){return new Nn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Nn(this.getWest(),this.getNorth())}getSouthEast(){return new Nn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:i,lat:l}=Nn.convert(t);let h=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&h}static convert(t){return!t||t instanceof Ja?t:new Ja(t)}}var rm=1e-6,Qr=typeof Float32Array<"u"?Float32Array:Array;function vx(){var n=new Qr(9);return Qr!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function _x(n,t,i){var l=t[0],h=t[1],p=t[2],v=t[3],x=t[4],S=t[5],T=t[6],k=t[7],z=t[8],R=i[0],V=i[1],$=i[2],G=i[3],X=i[4],le=i[5],ye=i[6],re=i[7],ge=i[8];return n[0]=R*l+V*v+$*T,n[1]=R*h+V*x+$*k,n[2]=R*p+V*S+$*z,n[3]=G*l+X*v+le*T,n[4]=G*h+X*x+le*k,n[5]=G*p+X*S+le*z,n[6]=ye*l+re*v+ge*T,n[7]=ye*h+re*x+ge*k,n[8]=ye*p+re*S+ge*z,n}function Qo(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function bv(n,t){var i=t[0],l=t[1],h=t[2],p=t[3],v=t[4],x=t[5],S=t[6],T=t[7],k=t[8],z=t[9],R=t[10],V=t[11],$=t[12],G=t[13],X=t[14],le=t[15],ye=i*x-l*v,re=i*S-h*v,ge=i*T-p*v,Te=l*S-h*x,xe=l*T-p*x,je=h*T-p*S,$e=k*G-z*$,tt=k*X-R*$,vt=k*le-V*$,We=z*X-R*G,it=z*le-V*G,ot=R*le-V*X,dt=ye*ot-re*it+ge*We+Te*vt-xe*tt+je*$e;return dt?(n[0]=(x*ot-S*it+T*We)*(dt=1/dt),n[1]=(h*it-l*ot-p*We)*dt,n[2]=(G*je-X*xe+le*Te)*dt,n[3]=(R*xe-z*je-V*Te)*dt,n[4]=(S*vt-v*ot-T*tt)*dt,n[5]=(i*ot-h*vt+p*tt)*dt,n[6]=(X*ge-$*je-le*re)*dt,n[7]=(k*je-R*ge+V*re)*dt,n[8]=(v*it-x*vt+T*$e)*dt,n[9]=(l*vt-i*it-p*$e)*dt,n[10]=($*xe-G*ge+le*ye)*dt,n[11]=(z*ge-k*xe-V*ye)*dt,n[12]=(x*tt-v*We-S*$e)*dt,n[13]=(i*We-l*tt+h*$e)*dt,n[14]=(G*re-$*Te-X*ye)*dt,n[15]=(k*Te-z*re+R*ye)*dt,n):null}function ic(n,t,i){var l=t[0],h=t[1],p=t[2],v=t[3],x=t[4],S=t[5],T=t[6],k=t[7],z=t[8],R=t[9],V=t[10],$=t[11],G=t[12],X=t[13],le=t[14],ye=t[15],re=i[0],ge=i[1],Te=i[2],xe=i[3];return n[0]=re*l+ge*x+Te*z+xe*G,n[1]=re*h+ge*S+Te*R+xe*X,n[2]=re*p+ge*T+Te*V+xe*le,n[3]=re*v+ge*k+Te*$+xe*ye,n[4]=(re=i[4])*l+(ge=i[5])*x+(Te=i[6])*z+(xe=i[7])*G,n[5]=re*h+ge*S+Te*R+xe*X,n[6]=re*p+ge*T+Te*V+xe*le,n[7]=re*v+ge*k+Te*$+xe*ye,n[8]=(re=i[8])*l+(ge=i[9])*x+(Te=i[10])*z+(xe=i[11])*G,n[9]=re*h+ge*S+Te*R+xe*X,n[10]=re*p+ge*T+Te*V+xe*le,n[11]=re*v+ge*k+Te*$+xe*ye,n[12]=(re=i[12])*l+(ge=i[13])*x+(Te=i[14])*z+(xe=i[15])*G,n[13]=re*h+ge*S+Te*R+xe*X,n[14]=re*p+ge*T+Te*V+xe*le,n[15]=re*v+ge*k+Te*$+xe*ye,n}function xd(n,t,i){var l,h,p,v,x,S,T,k,z,R,V,$,G=i[0],X=i[1],le=i[2];return t===n?(n[12]=t[0]*G+t[4]*X+t[8]*le+t[12],n[13]=t[1]*G+t[5]*X+t[9]*le+t[13],n[14]=t[2]*G+t[6]*X+t[10]*le+t[14],n[15]=t[3]*G+t[7]*X+t[11]*le+t[15]):(h=t[1],p=t[2],v=t[3],x=t[4],S=t[5],T=t[6],k=t[7],z=t[8],R=t[9],V=t[10],$=t[11],n[0]=l=t[0],n[1]=h,n[2]=p,n[3]=v,n[4]=x,n[5]=S,n[6]=T,n[7]=k,n[8]=z,n[9]=R,n[10]=V,n[11]=$,n[12]=l*G+x*X+z*le+t[12],n[13]=h*G+S*X+R*le+t[13],n[14]=p*G+T*X+V*le+t[14],n[15]=v*G+k*X+$*le+t[15]),n}function rc(n,t,i){var l=i[0],h=i[1],p=i[2];return n[0]=t[0]*l,n[1]=t[1]*l,n[2]=t[2]*l,n[3]=t[3]*l,n[4]=t[4]*h,n[5]=t[5]*h,n[6]=t[6]*h,n[7]=t[7]*h,n[8]=t[8]*p,n[9]=t[9]*p,n[10]=t[10]*p,n[11]=t[11]*p,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function wv(n,t,i){var l=Math.sin(i),h=Math.cos(i),p=t[4],v=t[5],x=t[6],S=t[7],T=t[8],k=t[9],z=t[10],R=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=p*h+T*l,n[5]=v*h+k*l,n[6]=x*h+z*l,n[7]=S*h+R*l,n[8]=T*h-p*l,n[9]=k*h-v*l,n[10]=z*h-x*l,n[11]=R*h-S*l,n}function om(n,t,i){var l=Math.sin(i),h=Math.cos(i),p=t[0],v=t[1],x=t[2],S=t[3],T=t[8],k=t[9],z=t[10],R=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=p*h-T*l,n[1]=v*h-k*l,n[2]=x*h-z*l,n[3]=S*h-R*l,n[8]=p*l+T*h,n[9]=v*l+k*h,n[10]=x*l+z*h,n[11]=S*l+R*h,n}function yx(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=t[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function xx(n,t,i){var l,h,p,v=i[0],x=i[1],S=i[2],T=Math.hypot(v,x,S);return T<rm?null:(v*=T=1/T,x*=T,S*=T,l=Math.sin(t),h=Math.cos(t),n[0]=v*v*(p=1-h)+h,n[1]=x*v*p+S*l,n[2]=S*v*p-x*l,n[3]=0,n[4]=v*x*p-S*l,n[5]=x*x*p+h,n[6]=S*x*p+v*l,n[7]=0,n[8]=v*S*p+x*l,n[9]=x*S*p-v*l,n[10]=S*S*p+h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});var uI=ic;function Sv(){var n=new Qr(3);return Qr!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function bx(n){var t=new Qr(3);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function bd(n){return Math.hypot(n[0],n[1],n[2])}function Pu(n,t,i){var l=new Qr(3);return l[0]=n,l[1]=t,l[2]=i,l}function oa(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n}function Ev(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n}function wx(n,t,i){return n[0]=t[0]*i[0],n[1]=t[1]*i[1],n[2]=t[2]*i[2],n}function wd(n,t,i){return n[0]=Math.min(t[0],i[0]),n[1]=Math.min(t[1],i[1]),n[2]=Math.min(t[2],i[2]),n}function Sd(n,t,i){return n[0]=Math.max(t[0],i[0]),n[1]=Math.max(t[1],i[1]),n[2]=Math.max(t[2],i[2]),n}function uo(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n}function Ed(n,t,i,l){return n[0]=t[0]+i[0]*l,n[1]=t[1]+i[1]*l,n[2]=t[2]+i[2]*l,n}function Fr(n,t){var i=t[0],l=t[1],h=t[2],p=i*i+l*l+h*h;return p>0&&(p=1/Math.sqrt(p)),n[0]=t[0]*p,n[1]=t[1]*p,n[2]=t[2]*p,n}function Eo(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function Tv(n,t,i){var l=t[0],h=t[1],p=t[2],v=i[0],x=i[1],S=i[2];return n[0]=h*S-p*x,n[1]=p*v-l*S,n[2]=l*x-h*v,n}function Fi(n,t,i){var l=t[0],h=t[1],p=t[2],v=i[3]*l+i[7]*h+i[11]*p+i[15];return n[0]=(i[0]*l+i[4]*h+i[8]*p+i[12])/(v=v||1),n[1]=(i[1]*l+i[5]*h+i[9]*p+i[13])/v,n[2]=(i[2]*l+i[6]*h+i[10]*p+i[14])/v,n}function Sx(n,t,i){var l=i[0],h=i[1],p=i[2],v=t[0],x=t[1],S=t[2],T=h*S-p*x,k=p*v-l*S,z=l*x-h*v,R=h*z-p*k,V=p*T-l*z,$=l*k-h*T,G=2*i[3];return k*=G,z*=G,V*=2,$*=2,n[0]=v+(T*=G)+(R*=2),n[1]=x+k+V,n[2]=S+z+$,n}var Td,es=Ev,hI=wx,dI=bd;function Ex(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n}function Tx(n,t){var i=t[0],l=t[1],h=t[2],p=t[3],v=i*i+l*l+h*h+p*p;return v>0&&(v=1/Math.sqrt(v)),n[0]=i*v,n[1]=l*v,n[2]=h*v,n[3]=p*v,n}function oc(n,t,i){var l=t[0],h=t[1],p=t[2],v=t[3];return n[0]=i[0]*l+i[4]*h+i[8]*p+i[12]*v,n[1]=i[1]*l+i[5]*h+i[9]*p+i[13]*v,n[2]=i[2]*l+i[6]*h+i[10]*p+i[14]*v,n[3]=i[3]*l+i[7]*h+i[11]*p+i[15]*v,n}function Cx(){var n=new Qr(4);return Qr!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function Ix(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function Ax(n,t,i){i*=.5;var l=t[0],h=t[1],p=t[2],v=t[3],x=Math.sin(i),S=Math.cos(i);return n[0]=l*S+v*x,n[1]=h*S+p*x,n[2]=p*S-h*x,n[3]=v*S-l*x,n}function kx(n,t,i){i*=.5;var l=t[0],h=t[1],p=t[2],v=t[3],x=Math.sin(i),S=Math.cos(i);return n[0]=l*S-p*x,n[1]=h*S+v*x,n[2]=p*S+l*x,n[3]=v*S-h*x,n}Sv(),Td=new Qr(4),Qr!=Float32Array&&(Td[0]=0,Td[1]=0,Td[2]=0,Td[3]=0);var fI=Tx;Sv(),Pu(1,0,0),Pu(0,1,0),Cx(),Cx(),vx();const pI=Xt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Mx}=pI,Px=Xt([{name:"a_pos_3",components:3,type:"Int16"}]);var Cd=Xt([{name:"a_pos",type:"Int16",components:2}]);class Cv{constructor(t,i){this.pos=t,this.dir=i}intersectsPlane(t,i,l){const h=Eo(i,this.dir);if(Math.abs(h)<1e-6)return!1;const p=((t[0]-this.pos[0])*i[0]+(t[1]-this.pos[1])*i[1]+(t[2]-this.pos[2])*i[2])/h;return l[0]=this.pos[0]+this.dir[0]*p,l[1]=this.pos[1]+this.dir[1]*p,l[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(t,i,l){if(function(V,$){var G=V[0],X=V[1],le=V[2],ye=$[0],re=$[1],ge=$[2];return Math.abs(G-ye)<=rm*Math.max(1,Math.abs(G),Math.abs(ye))&&Math.abs(X-re)<=rm*Math.max(1,Math.abs(X),Math.abs(re))&&Math.abs(le-ge)<=rm*Math.max(1,Math.abs(le),Math.abs(ge))}(this.pos,t)||i===0)return l[0]=l[1]=l[2]=0,!1;const[h,p,v]=this.dir,x=this.pos[0]-t[0],S=this.pos[1]-t[1],T=this.pos[2]-t[2],k=h*h+p*p+v*v,z=2*(x*h+S*p+T*v),R=z*z-4*k*(x*x+S*S+T*T-i*i);if(R<0){const V=Math.max(-z/2,0),$=x+h*V,G=S+p*V,X=T+v*V,le=Math.hypot($,G,X);return l[0]=$*i/le,l[1]=G*i/le,l[2]=X*i/le,!1}{const V=(-z-Math.sqrt(R))/(2*k);if(V<0){const $=Math.hypot(x,S,T);return l[0]=x*i/$,l[1]=S*i/$,l[2]=T*i/$,!1}return l[0]=x+h*V,l[1]=S+p*V,l[2]=T+v*V,!0}}}class Iv{constructor(t,i,l,h,p){this.TL=t,this.TR=i,this.BR=l,this.BL=h,this.horizon=p}static fromInvProjectionMatrix(t,i,l){const h=[-1,1,1],p=[1,1,1],v=[1,-1,1],x=[-1,-1,1],S=Fi(h,h,t),T=Fi(p,p,t),k=Fi(v,v,t),z=Fi(x,x,t);return new Iv(S,T,k,z,i/l)}}class Av{constructor(t,i){this.points=t,this.planes=i}static fromInvProjectionMatrix(t,i,l,h){const p=Math.pow(2,l),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const T=oc([],S,t),k=1/T[3]/i*p;return function(z,R,V){return z[0]=R[0]*V[0],z[1]=R[1]*V[1],z[2]=R[2]*V[2],z[3]=R[3]*V[3],z}(T,T,[k,k,h?1/T[3]:k,k])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const T=Fr([],Tv([],es([],v[S[0]],v[S[1]]),es([],v[S[2]],v[S[1]]))),k=-Eo(T,v[S[1]]);return T.concat(k)});return new Av(v,x)}}class Vr{static fromPoints(t){const i=[1/0,1/0,1/0],l=[-1/0,-1/0,-1/0];for(const h of t)wd(i,i,h),Sd(l,l,h);return new Vr(i,l)}static applyTransform(t,i){const l=t.getCorners();for(let h=0;h<l.length;++h)Fi(l[h],l[h],i);return Vr.fromPoints(l)}constructor(t,i){this.min=t,this.max=i,this.center=uo([],oa([],this.min,this.max),.5)}quadrant(t){const i=[t%2==0,t<2],l=bx(this.min),h=bx(this.max);for(let p=0;p<i.length;p++)l[p]=i[p]?this.min[p]:this.center[p],h[p]=i[p]?this.center[p]:this.max[p];return h[2]=this.max[2],new Vr(l,h)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,i=this.max;return[[t[0],t[1],t[2]],[i[0],t[1],t[2]],[i[0],i[1],t[2]],[t[0],i[1],t[2]],[t[0],t[1],i[2]],[i[0],t[1],i[2]],[i[0],i[1],i[2]],[t[0],i[1],i[2]]]}intersects(t){const i=this.getCorners();let l=!0;for(let h=0;h<t.planes.length;h++){const p=t.planes[h];let v=0;for(let x=0;x<i.length;x++)v+=Eo(p,i[x])+p[3]>=0;if(v===0)return 0;v!==i.length&&(l=!1)}if(l)return 2;for(let h=0;h<3;h++){let p=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let x=0;x<t.points.length;x++){const S=t.points[x][h]-this.min[h];p=Math.min(p,S),v=Math.max(v,S)}if(v<0||p>this.max[h]-this.min[h])return 0}return 1}}const Ss=hn/Math.PI/2,sc=64,Id=[sc,32,16],To=-Ss,Co=Ss,mI=[new Vr([To,To,To],[Co,Co,Co]),new Vr([To,To,To],[0,0,Co]),new Vr([0,To,To],[Co,0,Co]),new Vr([To,0,To],[0,Co,Co]),new Vr([0,0,To],[Co,Co,Co])];function sm(n){return n*Ss/Md}function zx(n,t,i,l=!0){const h=uo([],n._camera.position,n.worldSize),p=[t,i,1,1];oc(p,p,n.pixelMatrixInverse),Ex(p,p,1/p[3]);const v=Fr([],es([],p,h)),x=n.globeMatrix,S=[x[12],x[13],x[14]],T=es([],S,h),k=bd(T),z=Fr([],T),R=n.worldSize/(2*Math.PI),V=Eo(z,v),$=Math.asin(R/k);if($<Math.acos(V)){if(!l)return null;const vt=[],We=[];uo(vt,v,k/V),Fr(We,es(We,vt,T)),Fr(v,oa(v,T,uo(v,We,Math.tan($)*k)))}const G=[];new Cv(h,v).closestPointOnSphere(S,R,G);const X=Fr([],Ft(x,0)),le=Fr([],Ft(x,1)),ye=Fr([],Ft(x,2)),re=Eo(X,G),ge=Eo(le,G),Te=Eo(ye,G),xe=be(Math.asin(-ge/R));let je=be(Math.atan2(re,Te));je=n.center.lng+function(vt,We){const it=(We-vt+180)%360-180;return it<-180?it+360:it}(n.center.lng,je);const $e=Ts(je),tt=nt(Cs(xe),0,1);return new Du($e,tt)}class gI{constructor(t,i,l){this.a=es([],t,l),this.b=es([],i,l),this.center=l;const h=Fr([],this.a),p=Fr([],this.b);this.angle=Math.acos(Eo(h,p))}}function kv(n,t){if(n.angle===0)return null;let i;return i=n.a[t]===0?1/n.angle*.5*Math.PI:1/n.angle*Math.atan(n.b[t]/n.a[t]/Math.sin(n.angle)-1/Math.tan(n.angle)),i<0||i>1?null:function(l,h,p,v){const x=Math.sin(p);return l*(Math.sin((1-v)*p)/x)+h*(Math.sin(v*p)/x)}(n.a[t],n.b[t],n.angle,nt(i,0,1))+n.center[t]}function Es(n){if(n.z<=1)return mI[n.z+2*n.y+n.x];const t=Mv(am(n));return Vr.fromPoints(t)}function ac(n,t,i){return uo(n,n,1-i),Ed(n,n,t,i)}function Lx(n,t){const i=Ru(t.zoom);if(i===0)return Es(n);const l=am(n),h=Mv(l),p=Ts(l.getWest())*t.worldSize,v=Ts(l.getEast())*t.worldSize,x=Cs(l.getNorth())*t.worldSize,S=Cs(l.getSouth())*t.worldSize,T=[p,x,0],k=[v,x,0],z=[p,S,0],R=[v,S,0],V=bv([],t.globeMatrix);return Fi(T,T,V),Fi(k,k,V),Fi(z,z,V),Fi(R,R,V),h[0]=ac(h[0],z,i),h[1]=ac(h[1],R,i),h[2]=ac(h[2],k,i),h[3]=ac(h[3],T,i),Vr.fromPoints(h)}function Rx(n,t,i){for(const l of n)Fi(l,l,t),uo(l,l,i)}function vI(n,t,i){const l=t/n.worldSize,h=n.globeMatrix;if(i.z<=1){const $e=Es(i).getCorners();return Rx($e,h,l),Vr.fromPoints($e)}const p=am(i),v=Mv(p);Rx(v,h,l);const x=Number.MAX_VALUE,S=[-x,-x,-x],T=[x,x,x];if(p.contains(n.center)){for(const vt of v)wd(T,T,vt),Sd(S,S,vt);S[2]=0;const $e=n.point,tt=[$e.x*l,$e.y*l,0];return wd(T,T,tt),Sd(S,S,tt),new Vr(T,S)}const k=[h[12]*l,h[13]*l,h[14]*l],z=p.getCenter(),R=nt(n.center.lat,-Sr,Sr),V=nt(z.lat,-Sr,Sr),$=Ts(n.center.lng),G=Cs(R);let X=$-Ts(z.lng);const le=G-Cs(V);X>.5?X-=1:X<-.5&&(X+=1);let ye=0;Math.abs(X)>Math.abs(le)?ye=X>=0?1:3:(ye=le>=0?0:2,Ed(k,k,[h[4]*l,h[5]*l,h[6]*l],-Math.sin(Ee(le>=0?p.getSouth():p.getNorth()))*Ss));const re=v[ye],ge=v[(ye+1)%4],Te=new gI(re,ge,k),xe=[kv(Te,0)||re[0],kv(Te,1)||re[1],kv(Te,2)||re[2]],je=Ru(n.zoom);if(je>0){const $e=function({x:vt,y:We,z:it},ot,dt,_t,Ye){const It=1/(1<<it);let rn=vt*It,Dt=rn+It,Zt=We*It,At=Zt+It,an=0;const Mn=(rn+Dt)/2-_t;return Mn>.5?an=-1:Mn<-.5&&(an=1),rn=((rn+an)*ot-(_t*=ot))*dt+_t,Dt=((Dt+an)*ot-_t)*dt+_t,Zt=(Zt*ot-(Ye*=ot))*dt+Ye,At=(At*ot-Ye)*dt+Ye,[[rn,At,0],[Dt,At,0],[Dt,Zt,0],[rn,Zt,0]]}(i,t,n._pixelsPerMercatorPixel,$,G);for(let vt=0;vt<v.length;vt++)ac(v[vt],$e[vt],je);const tt=oa([],$e[ye],$e[(ye+1)%4]);uo(tt,tt,.5),ac(xe,tt,je)}for(const $e of v)wd(T,T,$e),Sd(S,S,$e);return T[2]=Math.min(re[2],ge[2]),wd(T,T,xe),Sd(S,S,xe),new Vr(T,S)}function am({x:n,y:t,z:i}){const l=1/(1<<i),h=new Nn(ho(n*l),wr((t+1)*l)),p=new Nn(ho((n+1)*l),wr(t*l));return new Ja(h,p)}function Mv(n){const t=Ee(n.getNorth()),i=Ee(n.getSouth()),l=Math.cos(t),h=Math.cos(i),p=Math.sin(t),v=Math.sin(i),x=n.getWest(),S=n.getEast();return[zu(h,v,x),zu(h,v,S),zu(l,p,S),zu(l,p,x)]}function zu(n,t,i,l=Ss){return i=Ee(i),[n*Math.sin(i)*l,-t*l,n*Math.cos(i)*l]}function Lu(n,t,i){return zu(Math.cos(Ee(n)),Math.sin(Ee(n)),t,i)}function Ad(n,t,i,l){const h=1<<i.z,p=(n/hn+i.x)/h;return Lu(wr((t/hn+i.y)/h),ho(p),l)}function lm({min:n,max:t}){return 16383/Math.max(t[0]-n[0],t[1]-n[1],t[2]-n[2])}const Dx=new Float64Array(16);function kd(n){const t=lm(n),i=yx(Dx,[t,t,t]);return xd(i,i,((l=[])[0]=-(h=n.min)[0],l[1]=-h[1],l[2]=-h[2],l));var l,h}function Pv(n){const t=(l=n.min,(i=Dx)[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=l[0],i[13]=l[1],i[14]=l[2],i[15]=1,i);var i,l;const h=1/lm(n);return rc(t,t,[h,h,h])}function Bx(n,t,i,l,h){const p=function(S){const T=hn/(2*Math.PI);return S/(2*Math.PI)/T}(i),v=[n,t,-i/(2*Math.PI)],x=Qo(new Float64Array(16));return xd(x,x,v),rc(x,x,[p,p,p]),wv(x,x,Ee(-h)),om(x,x,Ee(-l)),x}function Ru(n){return ft(5,6,n)}function Ox(n,t){const i=Lu(t.lat,t.lng),l=function($){const G=Lu($._center.lat,$._center.lng);let X=Tv([],Pu(0,1,0),G);const le=xx([],-$.angle,G);X=Fi(X,X,le),xx(le,-$._pitch,X);const ye=Fr([],G);return uo(ye,ye,sm($.cameraToCenterDistance/$.pixelsPerMeter)),Fi(ye,ye,le),oa([],G,ye)}(n);return v=(h=Ev([],l,i))[0],x=h[1],S=h[2],T=(p=i)[0],k=p[1],z=p[2],V=(R=Math.sqrt(v*v+x*x+S*S)*Math.sqrt(T*T+k*k+z*z))&&Eo(h,p)/R,Math.acos(Math.min(Math.max(V,-1),1));var h,p,v,x,S,T,k,z,R,V}function zv(n,t){return Ox(n,t)>Math.PI/2*1.01}const Fx=Ee(85),_I=Math.cos(Fx),yI=Math.sin(Fx),Md=63710088e-1,Vx=2*Math.PI*Md;class Nn{constructor(t,i){if(isNaN(t)||isNaN(i))throw new Error(`Invalid LngLat object: (${t}, ${i})`);if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Nn(Pe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const i=Math.PI/180,l=this.lat*i,h=t.lat*i,p=Math.sin(l)*Math.sin(h)+Math.cos(l)*Math.cos(h)*Math.cos((t.lng-this.lng)*i);return Md*Math.acos(Math.min(p,1))}toBounds(t=0){const i=360*t/40075017,l=i/Math.cos(Math.PI/180*this.lat);return new Ja(new Nn(this.lng-l,this.lat-i),new Nn(this.lng+l,this.lat+i))}toEcef(t){const i=sm(t);return Lu(this.lat,this.lng,Ss+i)}static convert(t){if(t instanceof Nn)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Nn(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Nn(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function Lv(n){return Vx*Math.cos(n*Math.PI/180)}function Ts(n){return(180+n)/360}function Cs(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function ts(n,t){return n/Lv(t)}function ho(n){return 360*n-180}function wr(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function $x(n,t){return n*Lv(wr(t))}const Sr=85.051129;function Nx(n){return 1/Math.cos(n*Math.PI/180)}class Du{constructor(t,i,l=0){this.x=+t,this.y=+i,this.z=+l}static fromLngLat(t,i=0){const l=Nn.convert(t);return new Du(Ts(l.lng),Cs(l.lat),ts(i,l.lat))}toLngLat(){return new Nn(ho(this.x),wr(this.y))}toAltitude(){return $x(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Vx*Nx(wr(this.y))}}function Rv(n,t,i,l,h,p,v,x,S){const T=(t+l)/2,k=(i+h)/2,z=new Y(T,k);x(z),function(R,V,$,G,X,le){const ye=$-X,re=G-le;return Math.abs((G-V)*ye-($-R)*re)/Math.hypot(ye,re)}(z.x,z.y,p.x,p.y,v.x,v.y)>=S?(Rv(n,t,i,T,k,p,z,x,S),Rv(n,T,k,l,h,z,v,x,S)):n.push(v)}function Ux(n,t,i){let l=n[0],h=l.x,p=l.y;t(l);const v=[l];for(let x=1;x<n.length;x++){const S=n[x],{x:T,y:k}=S;t(S),Rv(v,h,p,T,k,l,S,t,i),h=T,p=k,l=S}return v}function Dv(n,t,i,l){if(l(t,i)){const h=t.add(i)._mult(.5);Dv(n,t,h,l),Dv(n,h,i,l)}else n.push(i)}function xI(n,t){let i=n[0];const l=[i];for(let h=1;h<n.length;h++){const p=n[h];Dv(l,i,p,t),i=p}return l}const Bv=Math.pow(2,14)-1,jx=-Bv-1;function bI(n,t){const i=Math.round(n.x*t),l=Math.round(n.y*t);return n.x=nt(i,jx,Bv),n.y=nt(l,jx,Bv),(i<n.x||i>n.x+1||l<n.y||l>n.y+1)&&he("Geometry exceeds allowed extent, reduce your vector tile buffer size"),n}function sa(n,t,i){const l=n.loadGeometry(),h=n.extent,p=hn/h;if(t&&i&&i.projection.isReprojectedInTileSpace){const v=1<<t.z,{scale:x,x:S,y:T,projection:k}=i,z=R=>{const V=ho((t.x+R.x/h)/v),$=wr((t.y+R.y/h)/v),G=k.project(V,$);R.x=(G.x*x-S)*h,R.y=(G.y*x-T)*h};for(let R=0;R<l.length;R++)if(n.type!==1)l[R]=Ux(l[R],z,1);else{const V=[];for(const $ of l[R])$.x<0||$.x>=h||$.y<0||$.y>=h||(z($),V.push($));l[R]=V}}for(const v of l)for(const x of v)bI(x,p);return l}function lc(n,t){return{type:n.type,id:n.id,properties:n.properties,geometry:t?sa(n):[]}}function cm(n,t,i,l,h){n.emplaceBack(2*t+(l+1)/2,2*i+(h+1)/2)}function um(n,t,i){n.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class Ov{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new en,this.indexArray=new br,this.segments=new Gi,this.programConfigurations=new nc(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,l,h){const p=this.layers[0],v=[];let x=null;p.type==="circle"&&(x=p.layout.get("circle-sort-key"));for(const{feature:T,id:k,index:z,sourceLayerIndex:R}of t){const V=this.layers[0]._featureFilter.needGeometry,$=lc(T,V);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),$,l))continue;const G=x?x.evaluate($,{},l):void 0,X={id:k,properties:T.properties,type:T.type,sourceLayerIndex:R,index:z,geometry:V?$.geometry:sa(T,l,h),patterns:{},sortKey:G};v.push(X)}x&&v.sort((T,k)=>T.sortKey-k.sortKey);let S=null;h.projection.name==="globe"&&(this.globeExtVertexArray=new co,S=h.projection);for(const T of v){const{geometry:k,index:z,sourceLayerIndex:R}=T,V=t[z].feature;this.addFeature(T,k,z,i.availableImages,l,S),i.featureIndex.insert(V,k,z,R,this.index)}}update(t,i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,lI.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,cI.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,i,l,h,p,v){for(const x of i)for(const S of x){const T=S.x,k=S.y;if(T<0||T>=hn||k<0||k>=hn)continue;if(v){const V=v.projectTilePoint(T,k,p),$=v.upVector(p,T,k),G=this.globeExtVertexArray;um(G,V,$),um(G,V,$),um(G,V,$),um(G,V,$)}const z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),R=z.vertexLength;cm(this.layoutVertexArray,T,k,-1,-1),cm(this.layoutVertexArray,T,k,1,-1),cm(this.layoutVertexArray,T,k,1,1),cm(this.layoutVertexArray,T,k,-1,1),this.indexArray.emplaceBack(R,R+1,R+2),this.indexArray.emplaceBack(R,R+2,R+3),z.vertexLength+=4,z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},h,p)}}function Gx(n,t){for(let i=0;i<n.length;i++)if(cc(t,n[i]))return!0;for(let i=0;i<t.length;i++)if(cc(n,t[i]))return!0;return!!Fv(n,t)}function wI(n,t,i){return!!cc(n,t)||!!Vv(t,n,i)}function qx(n,t){if(n.length===1)return Wx(t,n[0]);for(let i=0;i<t.length;i++){const l=t[i];for(let h=0;h<l.length;h++)if(cc(n,l[h]))return!0}for(let i=0;i<n.length;i++)if(Wx(t,n[i]))return!0;for(let i=0;i<t.length;i++)if(Fv(n,t[i]))return!0;return!1}function SI(n,t,i){if(n.length>1){if(Fv(n,t))return!0;for(let l=0;l<t.length;l++)if(Vv(t[l],n,i))return!0}for(let l=0;l<n.length;l++)if(Vv(n[l],t,i))return!0;return!1}function Fv(n,t){if(n.length===0||t.length===0)return!1;for(let i=0;i<n.length-1;i++){const l=n[i],h=n[i+1];for(let p=0;p<t.length-1;p++)if(EI(l,h,t[p],t[p+1]))return!0}return!1}function EI(n,t,i,l){return Me(n,i,l)!==Me(t,i,l)&&Me(n,t,i)!==Me(n,t,l)}function Vv(n,t,i){const l=i*i;if(t.length===1)return n.distSqr(t[0])<l;for(let h=1;h<t.length;h++)if(Zx(n,t[h-1],t[h])<l)return!0;return!1}function Zx(n,t,i){const l=t.distSqr(i);if(l===0)return n.distSqr(t);const h=((n.x-t.x)*(i.x-t.x)+(n.y-t.y)*(i.y-t.y))/l;return n.distSqr(h<0?t:h>1?i:i.sub(t)._mult(h)._add(t))}function Wx(n,t){let i,l,h,p=!1;for(let v=0;v<n.length;v++){i=n[v];for(let x=0,S=i.length-1;x<i.length;S=x++)l=i[x],h=i[S],l.y>t.y!=h.y>t.y&&t.x<(h.x-l.x)*(t.y-l.y)/(h.y-l.y)+l.x&&(p=!p)}return p}function cc(n,t){let i=!1;for(let l=0,h=n.length-1;l<n.length;h=l++){const p=n[l],v=n[h];p.y>t.y!=v.y>t.y&&t.x<(v.x-p.x)*(t.y-p.y)/(v.y-p.y)+p.x&&(i=!i)}return i}function Hx(n,t,i,l,h){for(const v of n)if(t<=v.x&&i<=v.y&&l>=v.x&&h>=v.y)return!0;const p=[new Y(t,i),new Y(t,h),new Y(l,h),new Y(l,i)];if(n.length>2){for(const v of p)if(cc(n,v))return!0}for(let v=0;v<n.length-1;v++)if(TI(n[v],n[v+1],p))return!0;return!1}function TI(n,t,i){const l=i[0],h=i[2];if(n.x<l.x&&t.x<l.x||n.x>h.x&&t.x>h.x||n.y<l.y&&t.y<l.y||n.y>h.y&&t.y>h.y)return!1;const p=Me(n,t,i[0]);return p!==Me(n,t,i[1])||p!==Me(n,t,i[2])||p!==Me(n,t,i[3])}function Bu(n,t,i){const l=t.paint.get(n).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(n)}function hm(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Xx(n,t,i,l,h){if(!t[0]&&!t[1])return n;const p=Y.convert(t)._mult(h);i==="viewport"&&p._rotate(-l);const v=[];for(let x=0;x<n.length;x++)v.push(n[x].sub(p));return v}function Yx(n,t,i,l){const h=Y.convert(n)._mult(l);return t==="viewport"&&h._rotate(-i),h}Nt(Ov,"CircleBucket",{omit:["layers"]});const CI=new mt({"circle-sort-key":new Ze(et.layout_circle["circle-sort-key"])});var II={paint:new mt({"circle-radius":new Ze(et.paint_circle["circle-radius"]),"circle-color":new Ze(et.paint_circle["circle-color"]),"circle-blur":new Ze(et.paint_circle["circle-blur"]),"circle-opacity":new Ze(et.paint_circle["circle-opacity"]),"circle-translate":new Le(et.paint_circle["circle-translate"]),"circle-translate-anchor":new Le(et.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Le(et.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Le(et.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ze(et.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ze(et.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ze(et.paint_circle["circle-stroke-opacity"])}),layout:CI};function Kx(n,t,i,l,h,p,v,x,S){if(p&&n.queryGeometry.isAboveHorizon)return!1;p&&(S*=n.pixelToTileUnitsFactor);const T=n.tileID.canonical,k=i.projection.upVectorScale(T,i.center.lat,i.worldSize).metersToTile;for(const z of t)for(const R of z){const V=R.add(x),$=h&&i.elevation?i.elevation.exaggeration()*h.getElevationAt(V.x,V.y,!0):0,G=i.projection.projectTilePoint(V.x,V.y,T);if($>0){const re=i.projection.upVector(T,V.x,V.y);G.x+=re[0]*k*$,G.y+=re[1]*k*$,G.z+=re[2]*k*$}const X=p?V:AI(G.x,G.y,G.z,l),le=p?n.tilespaceRays.map(re=>MI(re,$)):n.queryGeometry.screenGeometry,ye=oc([],[G.x,G.y,G.z,1],l);if(!v&&p?S*=ye[3]/i.cameraToCenterDistance:v&&!p&&(S*=i.cameraToCenterDistance/ye[3]),p){const re=wr((R.y/hn+T.y)/(1<<T.z));S/=i.projection.pixelsPerMeter(re,1)/ts(1,re)}if(wI(le,X,S))return!0}return!1}function AI(n,t,i,l){const h=oc([],[n,t,i,1],l);return new Y(h[0]/h[3],h[1]/h[3])}const Jx=Pu(0,0,0),kI=Pu(0,0,1);function MI(n,t){const i=Sv();return Jx[2]=t,n.intersectsPlane(Jx,kI,i),new Y(i[0],i[1])}class Qx extends Ov{}function e1(n,{width:t,height:i},l,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*i*l)throw new RangeError("mismatched image size")}else h=new Uint8Array(t*i*l);return n.width=t,n.height=i,n.data=h,n}function t1(n,t,i){const{width:l,height:h}=t;l===n.width&&h===n.height||($v(n,t,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,l),height:Math.min(n.height,h)},i),n.width=l,n.height=h,n.data=t.data)}function $v(n,t,i,l,h,p){if(h.width===0||h.height===0)return t;if(h.width>n.width||h.height>n.height||i.x>n.width-h.width||i.y>n.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||l.x>t.width-h.width||l.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const v=n.data,x=t.data;for(let S=0;S<h.height;S++){const T=((i.y+S)*n.width+i.x)*p,k=((l.y+S)*t.width+l.x)*p;for(let z=0;z<h.width*p;z++)x[k+z]=v[T+z]}return t}Nt(Qx,"HeatmapBucket",{omit:["layers"]});class aa{constructor(t,i){e1(this,t,1,i)}resize(t){t1(this,new aa(t),1)}clone(){return new aa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,l,h,p){$v(t,i,l,h,p,1)}}class eo{constructor(t,i){e1(this,t,4,i)}resize(t){t1(this,new eo(t),4)}replace(t,i){i?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new eo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,l,h,p){$v(t,i,l,h,p,4)}}Nt(aa,"AlphaImage"),Nt(eo,"RGBAImage");var PI={paint:new mt({"heatmap-radius":new Ze(et.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ze(et.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Le(et.paint_heatmap["heatmap-intensity"]),"heatmap-color":new lt(et.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Le(et.paint_heatmap["heatmap-opacity"])})};function Nv(n){const t={},i=n.resolution||256,l=n.clips?n.clips.length:1,h=n.image||new eo({width:i,height:l}),p=(v,x,S)=>{t[n.evaluationKey]=S;const T=n.expression.evaluate(t);h.data[v+x+0]=Math.floor(255*T.r/T.a),h.data[v+x+1]=Math.floor(255*T.g/T.a),h.data[v+x+2]=Math.floor(255*T.b/T.a),h.data[v+x+3]=Math.floor(255*T.a)};if(n.clips)for(let v=0,x=0;v<l;++v,x+=4*i)for(let S=0,T=0;S<i;S++,T+=4){const k=S/(i-1),{start:z,end:R}=n.clips[v];p(x,T,z*(1-k)+R*k)}else for(let v=0,x=0;v<i;v++,x+=4)p(0,x,v/(i-1));return h}var zI={paint:new mt({"hillshade-illumination-direction":new Le(et.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Le(et.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Le(et.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Le(et.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Le(et.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Le(et.paint_hillshade["hillshade-accent-color"])})};const LI=Xt([{name:"a_pos",components:2,type:"Int16"}],4),{members:RI}=LI;var Ou={};function dm(n,t,i){i=i||2;var l,h,p,v,x,S,T,k=t&&t.length,z=k?t[0]*i:n.length,R=n1(n,0,z,i,!0),V=[];if(!R||R.next===R.prev)return V;if(k&&(R=function(G,X,le,ye){var re,ge,Te,xe=[];for(re=0,ge=X.length;re<ge;re++)(Te=n1(G,X[re]*ye,re<ge-1?X[re+1]*ye:G.length,ye,!1))===Te.next&&(Te.steiner=!0),xe.push(UI(Te));for(xe.sort(VI),re=0;re<xe.length;re++)le=$I(xe[re],le);return le}(n,t,R,i)),n.length>80*i){l=p=n[0],h=v=n[1];for(var $=i;$<z;$+=i)(x=n[$])<l&&(l=x),(S=n[$+1])<h&&(h=S),x>p&&(p=x),S>v&&(v=S);T=(T=Math.max(p-l,v-h))!==0?32767/T:0}return Pd(R,V,i,l,h,T,0),V}function n1(n,t,i,l,h){var p,v;if(h===Gv(n,t,i,l)>0)for(p=t;p<i;p+=l)v=o1(p,n[p],n[p+1],v);else for(p=i-l;p>=t;p-=l)v=o1(p,n[p],n[p+1],v);return v&&fm(v,v.next)&&(Ld(v),v=v.next),v}function uc(n,t){if(!n)return n;t||(t=n);var i,l=n;do if(i=!1,l.steiner||!fm(l,l.next)&&qi(l.prev,l,l.next)!==0)l=l.next;else{if(Ld(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function Pd(n,t,i,l,h,p,v){if(n){!v&&p&&function(k,z,R,V){var $=k;do $.z===0&&($.z=Uv($.x,$.y,z,R,V)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==k);$.prevZ.nextZ=null,$.prevZ=null,function(G){var X,le,ye,re,ge,Te,xe,je,$e=1;do{for(le=G,G=null,ge=null,Te=0;le;){for(Te++,ye=le,xe=0,X=0;X<$e&&(xe++,ye=ye.nextZ);X++);for(je=$e;xe>0||je>0&&ye;)xe!==0&&(je===0||!ye||le.z<=ye.z)?(re=le,le=le.nextZ,xe--):(re=ye,ye=ye.nextZ,je--),ge?ge.nextZ=re:G=re,re.prevZ=ge,ge=re;le=ye}ge.nextZ=null,$e*=2}while(Te>1)}($)}(n,l,h,p);for(var x,S,T=n;n.prev!==n.next;)if(x=n.prev,S=n.next,p?BI(n,l,h,p):DI(n))t.push(x.i/i|0),t.push(n.i/i|0),t.push(S.i/i|0),Ld(n),n=S.next,T=S.next;else if((n=S)===T){v?v===1?Pd(n=OI(uc(n),t,i),t,i,l,h,p,2):v===2&&FI(n,t,i,l,h,p):Pd(uc(n),t,i,l,h,p,1);break}}}function DI(n){var t=n.prev,i=n,l=n.next;if(qi(t,i,l)>=0)return!1;for(var h=t.x,p=i.x,v=l.x,x=t.y,S=i.y,T=l.y,k=h<p?h<v?h:v:p<v?p:v,z=x<S?x<T?x:T:S<T?S:T,R=h>p?h>v?h:v:p>v?p:v,V=x>S?x>T?x:T:S>T?S:T,$=l.next;$!==t;){if($.x>=k&&$.x<=R&&$.y>=z&&$.y<=V&&Fu(h,x,p,S,v,T,$.x,$.y)&&qi($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function BI(n,t,i,l){var h=n.prev,p=n,v=n.next;if(qi(h,p,v)>=0)return!1;for(var x=h.x,S=p.x,T=v.x,k=h.y,z=p.y,R=v.y,V=x<S?x<T?x:T:S<T?S:T,$=k<z?k<R?k:R:z<R?z:R,G=x>S?x>T?x:T:S>T?S:T,X=k>z?k>R?k:R:z>R?z:R,le=Uv(V,$,t,i,l),ye=Uv(G,X,t,i,l),re=n.prevZ,ge=n.nextZ;re&&re.z>=le&&ge&&ge.z<=ye;){if(re.x>=V&&re.x<=G&&re.y>=$&&re.y<=X&&re!==h&&re!==v&&Fu(x,k,S,z,T,R,re.x,re.y)&&qi(re.prev,re,re.next)>=0||(re=re.prevZ,ge.x>=V&&ge.x<=G&&ge.y>=$&&ge.y<=X&&ge!==h&&ge!==v&&Fu(x,k,S,z,T,R,ge.x,ge.y)&&qi(ge.prev,ge,ge.next)>=0))return!1;ge=ge.nextZ}for(;re&&re.z>=le;){if(re.x>=V&&re.x<=G&&re.y>=$&&re.y<=X&&re!==h&&re!==v&&Fu(x,k,S,z,T,R,re.x,re.y)&&qi(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;ge&&ge.z<=ye;){if(ge.x>=V&&ge.x<=G&&ge.y>=$&&ge.y<=X&&ge!==h&&ge!==v&&Fu(x,k,S,z,T,R,ge.x,ge.y)&&qi(ge.prev,ge,ge.next)>=0)return!1;ge=ge.nextZ}return!0}function OI(n,t,i){var l=n;do{var h=l.prev,p=l.next.next;!fm(h,p)&&i1(h,l,l.next,p)&&zd(h,p)&&zd(p,h)&&(t.push(h.i/i|0),t.push(l.i/i|0),t.push(p.i/i|0),Ld(l),Ld(l.next),l=n=p),l=l.next}while(l!==n);return uc(l)}function FI(n,t,i,l,h,p){var v=n;do{for(var x=v.next.next;x!==v.prev;){if(v.i!==x.i&&jI(v,x)){var S=r1(v,x);return v=uc(v,v.next),S=uc(S,S.next),Pd(v,t,i,l,h,p,0),void Pd(S,t,i,l,h,p,0)}x=x.next}v=v.next}while(v!==n)}function VI(n,t){return n.x-t.x}function $I(n,t){var i=function(h,p){var v,x=p,S=h.x,T=h.y,k=-1/0;do{if(T<=x.y&&T>=x.next.y&&x.next.y!==x.y){var z=x.x+(T-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(z<=S&&z>k&&(k=z,v=x.x<x.next.x?x:x.next,z===S))return v}x=x.next}while(x!==p);if(!v)return null;var R,V=v,$=v.x,G=v.y,X=1/0;x=v;do S>=x.x&&x.x>=$&&S!==x.x&&Fu(T<G?S:k,T,$,G,T<G?k:S,T,x.x,x.y)&&(R=Math.abs(T-x.y)/(S-x.x),zd(x,h)&&(R<X||R===X&&(x.x>v.x||x.x===v.x&&NI(v,x)))&&(v=x,X=R)),x=x.next;while(x!==V);return v}(n,t);if(!i)return t;var l=r1(i,n);return uc(l,l.next),uc(i,i.next)}function NI(n,t){return qi(n.prev,n,t.prev)<0&&qi(t.next,n,n.next)<0}function Uv(n,t,i,l,h){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*h|0)|n<<8))|n<<4))|n<<2))|n<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function UI(n){var t=n,i=n;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==n);return i}function Fu(n,t,i,l,h,p,v,x){return(h-v)*(t-x)>=(n-v)*(p-x)&&(n-v)*(l-x)>=(i-v)*(t-x)&&(i-v)*(p-x)>=(h-v)*(l-x)}function jI(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!function(i,l){var h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==l.i&&h.next.i!==l.i&&i1(h,h.next,i,l))return!0;h=h.next}while(h!==i);return!1}(n,t)&&(zd(n,t)&&zd(t,n)&&function(i,l){var h=i,p=!1,v=(i.x+l.x)/2,x=(i.y+l.y)/2;do h.y>x!=h.next.y>x&&h.next.y!==h.y&&v<(h.next.x-h.x)*(x-h.y)/(h.next.y-h.y)+h.x&&(p=!p),h=h.next;while(h!==i);return p}(n,t)&&(qi(n.prev,n,t.prev)||qi(n,t.prev,t))||fm(n,t)&&qi(n.prev,n,n.next)>0&&qi(t.prev,t,t.next)>0)}function qi(n,t,i){return(t.y-n.y)*(i.x-t.x)-(t.x-n.x)*(i.y-t.y)}function fm(n,t){return n.x===t.x&&n.y===t.y}function i1(n,t,i,l){var h=mm(qi(n,t,i)),p=mm(qi(n,t,l)),v=mm(qi(i,l,n)),x=mm(qi(i,l,t));return h!==p&&v!==x||!(h!==0||!pm(n,i,t))||!(p!==0||!pm(n,l,t))||!(v!==0||!pm(i,n,l))||!(x!==0||!pm(i,t,l))}function pm(n,t,i){return t.x<=Math.max(n.x,i.x)&&t.x>=Math.min(n.x,i.x)&&t.y<=Math.max(n.y,i.y)&&t.y>=Math.min(n.y,i.y)}function mm(n){return n>0?1:n<0?-1:0}function zd(n,t){return qi(n.prev,n,n.next)<0?qi(n,t,n.next)>=0&&qi(n,n.prev,t)>=0:qi(n,t,n.prev)<0||qi(n,n.next,t)<0}function r1(n,t){var i=new jv(n.i,n.x,n.y),l=new jv(t.i,t.x,t.y),h=n.next,p=t.prev;return n.next=t,t.prev=n,i.next=h,h.prev=i,l.next=i,i.prev=l,p.next=l,l.prev=p,l}function o1(n,t,i,l){var h=new jv(n,t,i);return l?(h.next=l.next,h.prev=l,l.next.prev=h,l.next=h):(h.prev=h,h.next=h),h}function Ld(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function jv(n,t,i){this.i=n,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Gv(n,t,i,l){for(var h=0,p=t,v=i-l;p<i;p+=l)h+=(n[v]-n[p])*(n[p+1]+n[v+1]),v=p;return h}function GI(n,t,i,l,h){s1(n,t,i||0,l||n.length-1,h||qI)}function s1(n,t,i,l,h){for(;l>i;){if(l-i>600){var p=l-i+1,v=t-i+1,x=Math.log(p),S=.5*Math.exp(2*x/3),T=.5*Math.sqrt(x*S*(p-S)/p)*(v-p/2<0?-1:1);s1(n,t,Math.max(i,Math.floor(t-v*S/p+T)),Math.min(l,Math.floor(t+(p-v)*S/p+T)),h)}var k=n[t],z=i,R=l;for(Rd(n,i,t),h(n[l],k)>0&&Rd(n,i,l);z<R;){for(Rd(n,z,R),z++,R--;h(n[z],k)<0;)z++;for(;h(n[R],k)>0;)R--}h(n[i],k)===0?Rd(n,i,R):Rd(n,++R,l),R<=t&&(i=R+1),t<=R&&(l=R-1)}}function Rd(n,t,i){var l=n[t];n[t]=n[i],n[i]=l}function qI(n,t){return n<t?-1:n>t?1:0}function qv(n,t){const i=n.length;if(i<=1)return[n];const l=[];let h,p;for(let v=0;v<i;v++){const x=qe(n[v]);x!==0&&(n[v].area=Math.abs(x),p===void 0&&(p=x<0),p===x<0?(h&&l.push(h),h=[n[v]]):h.push(n[v]))}if(h&&l.push(h),t>1)for(let v=0;v<l.length;v++)l[v].length<=t||(GI(l[v],t,1,l[v].length-1,ZI),l[v]=l[v].slice(0,t));return l}function ZI(n,t){return t.area-n.area}function Zv(n,t,i){const l=i.patternDependencies;let h=!1;for(const p of t){const v=p.paint.get(`${n}-pattern`);v.isConstant()||(h=!0);const x=v.constantOr(null);x&&(h=!0,l[x]=!0)}return h}function Wv(n,t,i,l,h){const p=h.patternDependencies;for(const v of t){const x=v.paint.get(`${n}-pattern`).value;if(x.kind!=="constant"){let S=x.evaluate({zoom:l},i,{},h.availableImages);S=S&&S.name?S.name:S,p[S]=!0,i.patterns[v.id]=S}}return i}({get exports(){return Ou},set exports(n){Ou=n}}).exports=dm,Ou.default=dm,dm.deviation=function(n,t,i,l){var h=t&&t.length,p=Math.abs(Gv(n,0,h?t[0]*i:n.length,i));if(h)for(var v=0,x=t.length;v<x;v++)p-=Math.abs(Gv(n,t[v]*i,v<x-1?t[v+1]*i:n.length,i));var S=0;for(v=0;v<l.length;v+=3){var T=l[v]*i,k=l[v+1]*i,z=l[v+2]*i;S+=Math.abs((n[T]-n[z])*(n[k+1]-n[T+1])-(n[T]-n[k])*(n[z+1]-n[T+1]))}return p===0&&S===0?0:Math.abs((S-p)/p)},dm.flatten=function(n){for(var t=n[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,h=0;h<n.length;h++){for(var p=0;p<n[h].length;p++)for(var v=0;v<t;v++)i.vertices.push(n[h][p][v]);h>0&&i.holes.push(l+=n[h-1].length)}return i};class gm{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new en,this.indexArray=new br,this.indexArray2=new bs,this.programConfigurations=new nc(t.layers,t.zoom),this.segments=new Gi,this.segments2=new Gi,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=t.projection}populate(t,i,l,h){this.hasPattern=Zv("fill",this.layers,i);const p=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:x,id:S,index:T,sourceLayerIndex:k}of t){const z=this.layers[0]._featureFilter.needGeometry,R=lc(x,z);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),R,l))continue;const V=p?p.evaluate(R,{},l,i.availableImages):void 0,$={id:S,properties:x.properties,type:x.type,sourceLayerIndex:k,index:T,geometry:z?R.geometry:sa(x,l,h),patterns:{},sortKey:V};v.push($)}p&&v.sort((x,S)=>x.sortKey-S.sortKey);for(const x of v){const{geometry:S,index:T,sourceLayerIndex:k}=x;if(this.hasPattern){const z=Wv("fill",this.layers,x,this.zoom,i);this.patternFeatures.push(z)}else this.addFeature(x,S,T,l,{},i.availableImages);i.featureIndex.insert(t[T].feature,S,T,k,this.index)}}update(t,i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,l,h)}addFeatures(t,i,l,h,p){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,i,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,RI),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,i,l,h,p,v=[]){for(const x of qv(i,500)){let S=0;for(const $ of x)S+=$.length;const T=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),k=T.vertexLength,z=[],R=[];for(const $ of x){if($.length===0)continue;$!==x[0]&&R.push(z.length/2);const G=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),X=G.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(X+$.length-1,X),z.push($[0].x),z.push($[0].y);for(let le=1;le<$.length;le++)this.layoutVertexArray.emplaceBack($[le].x,$[le].y),this.indexArray2.emplaceBack(X+le-1,X+le),z.push($[le].x),z.push($[le].y);G.vertexLength+=$.length,G.primitiveLength+=$.length}const V=Ou(z,R);for(let $=0;$<V.length;$+=3)this.indexArray.emplaceBack(k+V[$],k+V[$+1],k+V[$+2]);T.vertexLength+=S,T.primitiveLength+=V.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,p,v,h)}}Nt(gm,"FillBucket",{omit:["layers","patternFeatures"]});const WI=new mt({"fill-sort-key":new Ze(et.layout_fill["fill-sort-key"])});var HI={paint:new mt({"fill-antialias":new Le(et.paint_fill["fill-antialias"]),"fill-opacity":new Ze(et.paint_fill["fill-opacity"]),"fill-color":new Ze(et.paint_fill["fill-color"]),"fill-outline-color":new Ze(et.paint_fill["fill-outline-color"]),"fill-translate":new Le(et.paint_fill["fill-translate"]),"fill-translate-anchor":new Le(et.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ze(et.paint_fill["fill-pattern"])}),layout:WI};const XI=Xt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),YI=Xt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),KI=Xt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:JI}=XI;var vm={},QI=Y,a1=Vu;function Vu(n,t,i,l,h){this.properties={},this.extent=i,this.type=0,this._pbf=n,this._geometry=-1,this._keys=l,this._values=h,n.readFields(eA,this,t)}function eA(n,t,i){n==1?t.id=i.readVarint():n==2?function(l,h){for(var p=l.readVarint()+l.pos;l.pos<p;){var v=h._keys[l.readVarint()],x=h._values[l.readVarint()];h.properties[v]=x}}(i,t):n==3?t.type=i.readVarint():n==4&&(t._geometry=i.pos)}function tA(n){for(var t,i,l=0,h=0,p=n.length,v=p-1;h<p;v=h++)l+=((i=n[v]).x-(t=n[h]).x)*(t.y+i.y);return l}Vu.types=["Unknown","Point","LineString","Polygon"],Vu.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var t,i=n.readVarint()+n.pos,l=1,h=0,p=0,v=0,x=[];n.pos<i;){if(h<=0){var S=n.readVarint();l=7&S,h=S>>3}if(h--,l===1||l===2)p+=n.readSVarint(),v+=n.readSVarint(),l===1&&(t&&x.push(t),t=[]),t.push(new QI(p,v));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&x.push(t),x},Vu.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var t=n.readVarint()+n.pos,i=1,l=0,h=0,p=0,v=1/0,x=-1/0,S=1/0,T=-1/0;n.pos<t;){if(l<=0){var k=n.readVarint();i=7&k,l=k>>3}if(l--,i===1||i===2)(h+=n.readSVarint())<v&&(v=h),h>x&&(x=h),(p+=n.readSVarint())<S&&(S=p),p>T&&(T=p);else if(i!==7)throw new Error("unknown command "+i)}return[v,S,x,T]},Vu.prototype.toGeoJSON=function(n,t,i){var l,h,p=this.extent*Math.pow(2,i),v=this.extent*n,x=this.extent*t,S=this.loadGeometry(),T=Vu.types[this.type];function k(V){for(var $=0;$<V.length;$++){var G=V[$];V[$]=[360*(G.x+v)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+x)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(l=0;l<S.length;l++)z[l]=S[l][0];k(S=z);break;case 2:for(l=0;l<S.length;l++)k(S[l]);break;case 3:for(S=function(V){var $=V.length;if($<=1)return[V];for(var G,X,le=[],ye=0;ye<$;ye++){var re=tA(V[ye]);re!==0&&(X===void 0&&(X=re<0),X===re<0?(G&&le.push(G),G=[V[ye]]):G.push(V[ye]))}return G&&le.push(G),le}(S),l=0;l<S.length;l++)for(h=0;h<S[l].length;h++)k(S[l][h])}S.length===1?S=S[0]:T="Multi"+T;var R={type:"Feature",geometry:{type:T,coordinates:S},properties:this.properties};return"id"in this&&(R.id=this.id),R};var nA=a1,l1=c1;function c1(n,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(iA,this,t),this.length=this._features.length}function iA(n,t,i){n===15?t.version=i.readVarint():n===1?t.name=i.readString():n===5?t.extent=i.readVarint():n===2?t._features.push(i.pos):n===3?t._keys.push(i.readString()):n===4&&t._values.push(function(l){for(var h=null,p=l.readVarint()+l.pos;l.pos<p;){var v=l.readVarint()>>3;h=v===1?l.readString():v===2?l.readFloat():v===3?l.readDouble():v===4?l.readVarint64():v===5?l.readVarint():v===6?l.readSVarint():v===7?l.readBoolean():null}return h}(i))}c1.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var t=this._pbf.readVarint()+this._pbf.pos;return new nA(this._pbf,t,this.extent,this._keys,this._values)};var rA=l1;function oA(n,t,i){if(n===3){var l=new rA(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}var Hv=vm.VectorTile=function(n,t){this.layers=n.readFields(oA,{},t)},_m=vm.VectorTileFeature=a1;function ym(n,t,i,l){const h=[],p=l===0?(v,x,S,T,k,z)=>{v.push(new Y(z,S+(z-x)/(T-x)*(k-S)))}:(v,x,S,T,k,z)=>{v.push(new Y(x+(z-S)/(k-S)*(T-x),z))};for(const v of n){const x=[];for(const S of v){if(S.length<=2)continue;const T=[];for(let R=0;R<S.length-1;R++){const V=S[R].x,$=S[R].y,G=S[R+1].x,X=S[R+1].y,le=l===0?V:$,ye=l===0?G:X;le<t?ye>t&&p(T,V,$,G,X,t):le>i?ye<i&&p(T,V,$,G,X,i):T.push(S[R]),ye<t&&le>=t&&p(T,V,$,G,X,t),ye>i&&le<=i&&p(T,V,$,G,X,i)}let k=S[S.length-1];const z=l===0?k.x:k.y;z>=t&&z<=i&&T.push(k),T.length&&(k=T[T.length-1],T[0].x===k.x&&T[0].y===k.y||T.push(T[0]),x.push(T))}x.length&&h.push(x)}return h}vm.VectorTileLayer=l1;const sA=_m.types,aA=Math.pow(2,13);function Dd(n,t,i,l,h,p,v,x){n.emplaceBack((t<<1)+v,(i<<1)+p,(Math.floor(l*aA)<<1)+h,Math.round(x))}function Bd(n,t,i){n.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class u1{constructor(){this.acc=new Y(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Y(t.x,t.y),this.max=new Y(t.x,t.y))}append(t,i){this.currentPolyCount.edges++,this.acc._add(t);const l=this.min,h=this.max;t.x<l.x?l.x=t.x:t.x>h.x&&(h.x=t.x),t.y<l.y?l.y=t.y:t.y>h.y&&(h.y=t.y),((t.x===0||t.x===hn)&&t.x===i.x)!=((t.y===0||t.y===hn)&&t.y===i.y)&&this.processBorderOverlap(t,i),i.x<0!=t.x<0&&this.addBorderIntersection(0,$n(i.y,t.y,(0-i.x)/(t.x-i.x))),i.x>hn!=t.x>hn&&this.addBorderIntersection(1,$n(i.y,t.y,(hn-i.x)/(t.x-i.x))),i.y<0!=t.y<0&&this.addBorderIntersection(2,$n(i.x,t.x,(0-i.y)/(t.y-i.y))),i.y>hn!=t.y>hn&&this.addBorderIntersection(3,$n(i.x,t.x,(hn-i.y)/(t.y-i.y)))}addBorderIntersection(t,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const l=this.borders[t];i<l[0]&&(l[0]=i),i>l[1]&&(l[1]=i)}processBorderOverlap(t,i){if(t.x===i.x){if(t.y===i.y)return;const l=t.x===0?0:1;this.addBorderIntersection(l,i.y),this.addBorderIntersection(l,t.y)}else{const l=t.y===0?2:3;this.addBorderIntersection(l,i.x),this.addBorderIntersection(l,t.x)}}centroid(){const t=this.polyCount.reduce((i,l)=>i+l.edges,0);return t!==0?this.acc.div(t)._round():new Y(0,0)}span(){return new Y(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((t,i)=>t+ +(i[0]!==Number.MAX_VALUE),0)}}class Od{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.layoutVertexArray=new ni,this.centroidVertexArray=new hx,this.indexArray=new br,this.programConfigurations=new nc(t.layers,t.zoom),this.segments=new Gi,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=t.enableTerrain}populate(t,i,l,h){this.features=[],this.hasPattern=Zv("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(p){const v=Math.exp(Math.PI*(1-p.y/(1<<p.z)*2));return 80150034*v/(v*v+1)/hn/(1<<p.z)}(l),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:p,id:v,index:x,sourceLayerIndex:S}of t){const T=this.layers[0]._featureFilter.needGeometry,k=lc(p,T);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),k,l))continue;const z={id:v,sourceLayerIndex:S,index:x,geometry:T?k.geometry:sa(p,l,h),properties:p.properties,type:p.type,patterns:{}},R=this.layoutVertexArray.length;this.hasPattern?this.features.push(Wv("fill-extrusion",this.layers,z,this.zoom,i)):this.addFeature(z,z.geometry,x,l,{},i.availableImages,h),i.featureIndex.insert(p,z.geometry,x,S,this.index,R)}this.sortBorders()}addFeatures(t,i,l,h,p){for(const v of this.features){const{geometry:x}=v;this.addFeature(v,x,v.index,i,l,h,p)}this.sortBorders()}update(t,i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,JI),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,KI.members,!0))),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,YI.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,i,l,h,p,v,x){const S=[new Y(0,0),new Y(hn,hn)],T=x.projection,k=T.name==="globe",z=this.enableTerrain&&!k?new u1:null,R=sA[t.type]==="Polygon";k&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new co);const V=qv(i,500);for(let le=V.length-1;le>=0;le--){const ye=V[le];(ye.length===0||($=ye[0]).every(re=>re.x<=0)||$.every(re=>re.x>=hn)||$.every(re=>re.y<=0)||$.every(re=>re.y>=hn))&&V.splice(le,1)}var $;let G;if(k)G=v1(V,S,h);else{G=[];for(const le of V)G.push({polygon:le,bounds:S})}const X=R?this.edgeRadius:0;for(const{polygon:le,bounds:ye}of G){let re=0,ge=0;for(const xe of le)R&&!xe[0].equals(xe[xe.length-1])&&xe.push(xe[0]),ge+=R?xe.length-1:xe.length;const Te=this.segments.prepareSegment((R?5:4)*ge,this.layoutVertexArray,this.indexArray);if(R){const xe=[],je=[];re=Te.vertexLength;for(const tt of le){let vt,We;tt.length&&tt!==le[0]&&je.push(xe.length/2),vt=tt[1].sub(tt[0])._perp()._unit();for(let it=1;it<tt.length;it++){const ot=tt[it],dt=tt[it===tt.length-1?1:it+1];let{x:_t,y:Ye}=ot;if(X){We=dt.sub(ot)._perp()._unit();const It=vt.add(We)._unit(),rn=X*Math.min(4,1/(vt.x*It.x+vt.y*It.y));_t+=rn*It.x,Ye+=rn*It.y,vt=We}Dd(this.layoutVertexArray,_t,Ye,0,0,1,1,0),Te.vertexLength++,xe.push(ot.x,ot.y),k&&Bd(this.layoutVertexExtArray,T.projectTilePoint(_t,Ye,h),T.upVector(h,_t,Ye))}}const $e=Ou(xe,je);for(let tt=0;tt<$e.length;tt+=3)this.indexArray.emplaceBack(re+$e[tt],re+$e[tt+2],re+$e[tt+1]),Te.primitiveLength++}for(const xe of le){z&&xe.length&&z.startRing(xe[0]);let je,$e,tt,vt=xe.length>4&&p1(xe[xe.length-2],xe[0],xe[1]),We=X?lA(xe[xe.length-2],xe[0],xe[1],X):0;$e=xe[1].sub(xe[0])._perp()._unit();let it=!0;for(let ot=1,dt=0;ot<xe.length;ot++){let _t=xe[ot-1],Ye=xe[ot];const It=xe[ot===xe.length-1?1:ot+1];if(z&&R&&z.currentPolyCount.top++,f1(Ye,_t,ye)){X&&($e=It.sub(Ye)._perp()._unit(),it=!it);continue}z&&z.append(Ye,_t);const rn=Ye.sub(_t)._perp(),Dt=rn.x/(Math.abs(rn.x)+Math.abs(rn.y)),Zt=rn.y>0?1:0,At=_t.dist(Ye);if(dt+At>32768&&(dt=0),X){tt=It.sub(Ye)._perp()._unit();let bn=d1(_t,Ye,It,h1($e,tt),X);isNaN(bn)&&(bn=0);const ln=Ye.sub(_t)._unit();_t=_t.add(ln.mult(We))._round(),Ye=Ye.add(ln.mult(-bn))._round(),We=bn,$e=tt}const an=Te.vertexLength,Mn=xe.length>4&&p1(_t,Ye,It);let En=m1(dt,vt,it);if(Dd(this.layoutVertexArray,_t.x,_t.y,Dt,Zt,0,0,En),Dd(this.layoutVertexArray,_t.x,_t.y,Dt,Zt,0,1,En),dt+=At,En=m1(dt,Mn,!it),vt=Mn,Dd(this.layoutVertexArray,Ye.x,Ye.y,Dt,Zt,0,0,En),Dd(this.layoutVertexArray,Ye.x,Ye.y,Dt,Zt,0,1,En),Te.vertexLength+=4,this.indexArray.emplaceBack(an+0,an+1,an+2),this.indexArray.emplaceBack(an+1,an+3,an+2),Te.primitiveLength+=2,X){const bn=re+(ot===1?xe.length-2:ot-2),ln=ot===1?re:bn+1;if(this.indexArray.emplaceBack(an+1,bn,an+3),this.indexArray.emplaceBack(bn,ln,an+3),Te.primitiveLength+=2,je===void 0&&(je=an),!f1(It,xe[ot],ye)){const Jn=ot===xe.length-1?je:Te.vertexLength;this.indexArray.emplaceBack(an+2,an+3,Jn),this.indexArray.emplaceBack(an+3,Jn+1,Jn),this.indexArray.emplaceBack(an+3,ln,Jn+1),Te.primitiveLength+=3}it=!it}if(k){const bn=this.layoutVertexExtArray,ln=T.projectTilePoint(_t.x,_t.y,h),Jn=T.projectTilePoint(Ye.x,Ye.y,h),dn=T.upVector(h,_t.x,_t.y),Pn=T.upVector(h,Ye.x,Ye.y);Bd(bn,ln,dn),Bd(bn,ln,dn),Bd(bn,Jn,Pn),Bd(bn,Jn,Pn)}}R&&(re+=xe.length-1)}}if(z&&z.polyCount.length>0){if(z.borders){z.vertexArrayOffset=this.centroidVertexArray.length;const le=z.borders,ye=this.featuresOnBorder.push(z)-1;for(let re=0;re<4;re++)le[re][0]!==Number.MAX_VALUE&&this.borders[re].push(ye)}this.encodeCentroid(z.borders?void 0:z.centroid(),z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,p,v,h)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort((i,l)=>this.featuresOnBorder[i].borders[t][0]-this.featuresOnBorder[l].borders[t][0])}encodeCentroid(t,i,l=!0){let h,p;if(t)if(t.y!==0){const x=i.span()._mult(this.tileToMeter);h=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(x.x/10)),p=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(x.y/10))}else h=Math.ceil(7*(t.x+450)),p=0;else h=0,p=+l;let v=l?this.centroidVertexArray.length:i.vertexArrayOffset;for(const x of i.polyCount){l&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*x.edges+x.top);for(let S=0;S<x.top;S++)this.centroidVertexArray.emplace(v++,h,p);for(let S=0;S<2*x.edges;S++)this.centroidVertexArray.emplace(v++,0,p),this.centroidVertexArray.emplace(v++,h,p)}}}function h1(n,t){const i=n.add(t)._unit();return n.x*i.x+n.y*i.y}function lA(n,t,i,l){const h=t.sub(n)._perp()._unit(),p=i.sub(t)._perp()._unit();return d1(n,t,i,h1(h,p),l)}function d1(n,t,i,l,h){const p=Math.sqrt(1-l*l);return Math.min(n.dist(t)/3,t.dist(i)/3,h*p/l)}function f1(n,t,i){return n.x<i[0].x&&t.x<i[0].x||n.x>i[1].x&&t.x>i[1].x||n.y<i[0].y&&t.y<i[0].y||n.y>i[1].y&&t.y>i[1].y}function p1(n,t,i){if(n.x<0||n.x>=hn||t.x<0||t.x>=hn||i.x<0||i.x>=hn)return!1;const l=i.sub(t),h=l.perp(),p=n.sub(t);return(l.x*p.x+l.y*p.y)/Math.sqrt((l.x*l.x+l.y*l.y)*(p.x*p.x+p.y*p.y))>-.866&&h.x*p.x+h.y*p.y<0}function m1(n,t,i){const l=t?2|n:-3&n;return i?1|l:-2&l}function g1(){const n=Math.PI/32,t=Math.tan(n),i=Md;return i*Math.sqrt(1+2*t*t)-i}function v1(n,t,i){const l=1<<i.z,h=ho(i.x/l),p=ho((i.x+1)/l),v=wr(i.y/l),x=wr((i.y+1)/l);return function(S,T,k,z,R=0,V){const $=[];if(!S.length||!k||!z)return $;const G=(xe,je)=>{for(const $e of xe)$.push({polygon:$e,bounds:je})},X=Math.ceil(Math.log2(k)),le=Math.ceil(Math.log2(z)),ye=X-le,re=[];for(let xe=0;xe<Math.abs(ye);xe++)re.push(ye>0?0:1);for(let xe=0;xe<Math.min(X,le);xe++)re.push(0),re.push(1);let ge=S;if(ge=ym(ge,T[0].y-R,T[1].y+R,1),ge=ym(ge,T[0].x-R,T[1].x+R,0),!ge.length)return $;const Te=[];for(re.length?Te.push({polygons:ge,bounds:T,depth:0}):G(ge,T);Te.length;){const xe=Te.pop(),je=xe.depth,$e=re[je],tt=xe.bounds[0],vt=xe.bounds[1],We=$e===0?tt.x:tt.y,it=$e===0?vt.x:vt.y,ot=V?V($e,We,it):.5*(We+it),dt=ym(xe.polygons,We-R,ot+R,$e),_t=ym(xe.polygons,ot-R,it+R,$e);if(dt.length){const Ye=[tt,new Y($e===0?ot:vt.x,$e===1?ot:vt.y)];re.length>je+1?Te.push({polygons:dt,bounds:Ye,depth:je+1}):G(dt,Ye)}if(_t.length){const Ye=[new Y($e===0?ot:tt.x,$e===1?ot:tt.y),vt];re.length>je+1?Te.push({polygons:_t,bounds:Ye,depth:je+1}):G(_t,Ye)}}return $}(n,t,Math.ceil((p-h)/11.25),Math.ceil((v-x)/11.25),1,(S,T,k)=>{if(S===0)return .5*(T+k);{const z=wr((i.y+T/hn)/l);return(Cs(.5*(wr((i.y+k/hn)/l)+z))*l-i.y)*hn}})}Nt(Od,"FillExtrusionBucket",{omit:["layers","features"]}),Nt(u1,"PartMetadata");const cA=new mt({"fill-extrusion-edge-radius":new Le(et["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var uA={paint:new mt({"fill-extrusion-opacity":new Le(et["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ze(et["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Le(et["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Le(et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ze(et["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ze(et["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ze(et["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Le(et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Le(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Le(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:cA};function _1(n,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[n*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class xm{constructor(t,i,l){this.z=t,this.x=i,this.y=l,this.key=Fd(0,t,t,i,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,i){const l=function(p,v,x){var S=_1(256*p,256*(v=Math.pow(2,x)-v-1),x),T=_1(256*(p+1),256*(v+1),x);return S[0]+","+S[1]+","+T[0]+","+T[1]}(this.x,this.y,this.z),h=function(p,v,x){let S,T="";for(let k=p;k>0;k--)S=1<<k-1,T+=(v&S?1:0)+(x&S?2:0);return T}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",l)}toString(){return`${this.z}/${this.x}/${this.y}`}}class y1{constructor(t,i){this.wrap=t,this.canonical=i,this.key=Fd(t,i.z,i.z,i.x,i.y)}}class $r{constructor(t,i,l,h,p){this.overscaledZ=t,this.wrap=i,this.canonical=new xm(l,+h,+p),this.key=i===0&&t===l?this.canonical.key:Fd(i,t,l,h,p)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const i=this.canonical.z-t;return t>this.canonical.z?new $r(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $r(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(t,i=!0){if(this.overscaledZ===t&&i)return this.key;if(t>this.canonical.z)return Fd(this.wrap*+i,t,this.canonical.z,this.canonical.x,this.canonical.y);{const l=this.canonical.z-t;return Fd(this.wrap*+i,t,t,this.canonical.x>>l,this.canonical.y>>l)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const i=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>i&&t.canonical.y===this.canonical.y>>i}children(t){if(this.overscaledZ>=t)return[new $r(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,l=2*this.canonical.x,h=2*this.canonical.y;return[new $r(i,this.wrap,i,l,h),new $r(i,this.wrap,i,l+1,h),new $r(i,this.wrap,i,l,h+1),new $r(i,this.wrap,i,l+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new $r(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new $r(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new y1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Fd(n,t,i,l,h){const p=1<<Math.min(i,22);let v=p*(h%p)+l%p;return n&&i<22&&(v+=p*p*((n<0?-2*n-1:2*n)%(1<<2*(22-i)))),16*(32*v+i)+(t-i)}Nt(xm,"CanonicalTileID"),Nt($r,"OverscaledTileID",{omit:["projMatrix"]});class $u extends Y{constructor(t,i,l){super(t,i),this.z=l}}function Vd(n,t){return n.x*t.x+n.y*t.y}function x1(n,t){if(n.length===1){let i=0;const l=t[i++];let h;for(;!h||l.equals(h);)if(h=t[i++],!h)return 1/0;for(;i<t.length;i++){const p=t[i],v=n[0],x=h.sub(l),S=p.sub(l),T=v.sub(l),k=Vd(x,x),z=Vd(x,S),R=Vd(S,S),V=Vd(T,x),$=Vd(T,S),G=k*R-z*z,X=(R*V-z*$)/G,le=(k*$-z*V)/G,ye=l.z*(1-X-le)+h.z*X+p.z*le;if(isFinite(ye))return ye}return 1/0}{let i=1/0;for(const l of t)i=Math.min(i,l.z);return i}}function b1(n,t,i,l,h,p,v,x){const S=v*h.getElevationAt(n,t,!0,!0),T=p[0]!==0,k=T?p[1]===0?v*(p[0]/7-450):v*function(z,R,V){const $=Math.floor(R[0]/8),G=Math.floor(R[1]/8),X=10*(R[0]-8*$),le=10*(R[1]-8*G),ye=z.getElevationAt($,G,!0,!0),re=z.getMeterToDEM(V),ge=Math.floor(.5*(X*re-1)),Te=Math.floor(.5*(le*re-1)),xe=z.tileCoordToPixel($,G),je=2*ge+1,$e=2*Te+1,tt=function(_t,Ye,It,rn,Dt){return[_t.getElevationAtPixel(Ye,It,!0),_t.getElevationAtPixel(Ye+Dt,It,!0),_t.getElevationAtPixel(Ye,It+Dt,!0),_t.getElevationAtPixel(Ye+rn,It+Dt,!0)]}(z,xe.x-ge,xe.y-Te,je,$e),vt=Math.abs(tt[0]-tt[1]),We=Math.abs(tt[2]-tt[3]),it=Math.abs(tt[0]-tt[2])+Math.abs(tt[1]-tt[3]),ot=Math.min(.25,.5*re*(vt+We)/je),dt=Math.min(.25,.5*re*it/$e);return ye+Math.max(ot*X,dt*le)}(h,p,x):S;return{base:S+(i===0)?-1:i,top:T?Math.max(k+l,S+i+2):S+l}}const hA=Xt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:dA}=hA,fA=Xt([{name:"a_packed",components:4,type:"Float32"}]),{members:pA}=fA,mA=_m.types,gA=Math.cos(Math.PI/180*37.5);class bm{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new ui,this.layoutVertexArray2=new oi,this.indexArray=new br,this.programConfigurations=new nc(t.layers,t.zoom),this.segments=new Gi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,l,h){this.hasPattern=Zv("line",this.layers,i);const p=this.layers[0].layout.get("line-sort-key"),v=[];for(const{feature:k,id:z,index:R,sourceLayerIndex:V}of t){const $=this.layers[0]._featureFilter.needGeometry,G=lc(k,$);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),G,l))continue;const X=p?p.evaluate(G,{},l):void 0,le={id:z,properties:k.properties,type:k.type,sourceLayerIndex:V,index:R,geometry:$?G.geometry:sa(k,l,h),patterns:{},sortKey:X};v.push(le)}p&&v.sort((k,z)=>k.sortKey-z.sortKey);const{lineAtlas:x,featureIndex:S}=i,T=this.addConstantDashes(x);for(const k of v){const{geometry:z,index:R,sourceLayerIndex:V}=k;if(T&&this.addFeatureDashes(k,x),this.hasPattern){const $=Wv("line",this.layers,k,this.zoom,i);this.patternFeatures.push($)}else this.addFeature(k,z,R,l,x.positions,i.availableImages);S.insert(t[R].feature,z,R,V,this.index)}}addConstantDashes(t){let i=!1;for(const l of this.layers){const h=l.paint.get("line-dasharray").value,p=l.layout.get("line-cap").value;if(h.kind!=="constant"||p.kind!=="constant")i=!0;else{const v=p.value,x=h.value;if(!x)continue;t.addDash(x,v)}}return i}addFeatureDashes(t,i){const l=this.zoom;for(const h of this.layers){const p=h.paint.get("line-dasharray").value,v=h.layout.get("line-cap").value;if(p.kind==="constant"&&v.kind==="constant")continue;let x,S;if(p.kind==="constant"){if(x=p.value,!x)continue}else x=p.evaluate({zoom:l},t);S=v.kind==="constant"?v.value:v.evaluate({zoom:l},t),i.addDash(x,S),t.patterns[h.id]=i.getKey(x,S)}}update(t,i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,l,h)}addFeatures(t,i,l,h,p){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,i,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,pA)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,dA),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,i,l,h,p,v){const x=this.layers[0].layout,S=x.get("line-join").evaluate(t,{}),T=x.get("line-cap").evaluate(t,{}),k=x.get("line-miter-limit"),z=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const R of i)this.addLine(R,t,S,T,k,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,p,v,h)}addLine(t,i,l,h,p,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let le=0;le<t.length-1;le++)this.totalDistance+=t[le].dist(t[le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x=mA[i.type]==="Polygon";let S=t.length;for(;S>=2&&t[S-1].equals(t[S-2]);)S--;let T=0;for(;T<S-1&&t[T].equals(t[T+1]);)T++;if(S<(x?3:2))return;l==="bevel"&&(p=1.05);const k=this.overscaling<=16?122880/(512*this.overscaling):0,z=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let R,V,$,G,X;this.e1=this.e2=-1,x&&(R=t[S-2],X=t[T].sub(R)._unit()._perp());for(let le=T;le<S;le++){if($=le===S-1?x?t[T+1]:void 0:t[le+1],$&&t[le].equals($))continue;X&&(G=X),R&&(V=R),R=t[le],X=$?$.sub(R)._unit()._perp():G,G=G||X;let ye=G.add(X);ye.x===0&&ye.y===0||ye._unit();const re=G.x*X.x+G.y*X.y,ge=ye.x*X.x+ye.y*X.y,Te=ge!==0?1/ge:1/0,xe=2*Math.sqrt(2-2*ge),je=ge<gA&&V&&$,$e=G.x*X.y-G.y*X.x>0;if(je&&le>T){const We=R.dist(V);if(We>2*k){const it=R.sub(R.sub(V)._mult(k/We)._round());this.updateDistance(V,it),this.addCurrentVertex(it,G,0,0,z),V=it}}const tt=V&&$;let vt=tt?l:x?"butt":h;if(tt&&vt==="round"&&(Te<v?vt="miter":Te<=2&&(vt="fakeround")),vt==="miter"&&Te>p&&(vt="bevel"),vt==="bevel"&&(Te>2&&(vt="flipbevel"),Te<p&&(vt="miter")),V&&this.updateDistance(V,R),vt==="miter")ye._mult(Te),this.addCurrentVertex(R,ye,0,0,z);else if(vt==="flipbevel"){if(Te>100)ye=X.mult(-1);else{const We=Te*G.add(X).mag()/G.sub(X).mag();ye._perp()._mult(We*($e?-1:1))}this.addCurrentVertex(R,ye,0,0,z),this.addCurrentVertex(R,ye.mult(-1),0,0,z)}else if(vt==="bevel"||vt==="fakeround"){const We=-Math.sqrt(Te*Te-1),it=$e?We:0,ot=$e?0:We;if(V&&this.addCurrentVertex(R,G,it,ot,z),vt==="fakeround"){const dt=Math.round(180*xe/Math.PI/20);for(let _t=1;_t<dt;_t++){let Ye=_t/dt;if(Ye!==.5){const rn=Ye-.5;Ye+=Ye*rn*(Ye-1)*((1.0904+re*(re*(3.55645-1.43519*re)-3.2452))*rn*rn+(.848013+re*(.215638*re-1.06021)))}const It=X.sub(G)._mult(Ye)._add(G)._unit()._mult($e?-1:1);this.addHalfVertex(R,It.x,It.y,!1,$e,0,z)}}$&&this.addCurrentVertex(R,X,-it,-ot,z)}else if(vt==="butt")this.addCurrentVertex(R,ye,0,0,z);else if(vt==="square"){const We=V?1:-1;V||this.addCurrentVertex(R,ye,We,We,z),this.addCurrentVertex(R,ye,0,0,z),V&&this.addCurrentVertex(R,ye,We,We,z)}else vt==="round"&&(V&&(this.addCurrentVertex(R,G,0,0,z),this.addCurrentVertex(R,G,1,1,z,!0)),$&&(this.addCurrentVertex(R,X,-1,-1,z,!0),this.addCurrentVertex(R,X,0,0,z)));if(je&&le<S-1){const We=R.dist($);if(We>2*k){const it=R.add($.sub(R)._mult(k/We)._round());this.updateDistance(R,it),this.addCurrentVertex(it,X,0,0,z),R=it}}}}addCurrentVertex(t,i,l,h,p,v=!1){const x=i.y*h-i.x,S=-i.y-i.x*h;this.addHalfVertex(t,i.x+i.y*l,i.y-i.x*l,v,!1,l,p),this.addHalfVertex(t,x,S,v,!0,-h,p)}addHalfVertex({x:t,y:i},l,h,p,v,x,S){this.layoutVertexArray.emplaceBack((t<<1)+(p?1:0),(i<<1)+(v?1:0),Math.round(63*l)+128,Math.round(63*h)+128,1+(x===0?0:x<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const T=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),S.primitiveLength++),v?this.e2=T:this.e1=T}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,i){this.distance+=t.dist(i),this.updateScaledDistance()}}Nt(bm,"LineBucket",{omit:["layers","patternFeatures"]});const vA=new mt({"line-cap":new Ze(et.layout_line["line-cap"]),"line-join":new Ze(et.layout_line["line-join"]),"line-miter-limit":new Le(et.layout_line["line-miter-limit"]),"line-round-limit":new Le(et.layout_line["line-round-limit"]),"line-sort-key":new Ze(et.layout_line["line-sort-key"])});var w1={paint:new mt({"line-opacity":new Ze(et.paint_line["line-opacity"]),"line-color":new Ze(et.paint_line["line-color"]),"line-translate":new Le(et.paint_line["line-translate"]),"line-translate-anchor":new Le(et.paint_line["line-translate-anchor"]),"line-width":new Ze(et.paint_line["line-width"]),"line-gap-width":new Ze(et.paint_line["line-gap-width"]),"line-offset":new Ze(et.paint_line["line-offset"]),"line-blur":new Ze(et.paint_line["line-blur"]),"line-dasharray":new Ze(et.paint_line["line-dasharray"]),"line-pattern":new Ze(et.paint_line["line-pattern"]),"line-gradient":new lt(et.paint_line["line-gradient"]),"line-trim-offset":new Le(et.paint_line["line-trim-offset"])}),layout:vA};const S1=new class extends Ze{possiblyEvaluate(n,t){return t=new Be(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(n,t)}evaluate(n,t,i,l){return t=pt({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(n,t,i,l)}}(w1.paint.properties["line-width"].specification);function E1(n,t){return t>0?t+2*n:n}S1.useIntegerZoom=!0;const _A=Xt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),yA=Xt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),xA=Xt([{name:"a_projected_pos",components:4,type:"Float32"}],4);Xt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const bA=Xt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),wA=Xt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Xt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const T1=Xt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),SA=Xt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Xt([{name:"triangle",components:3,type:"Uint16"}]),Xt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Xt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Xt([{type:"Float32",name:"offsetX"}]),Xt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Er=24;const Is=128;function Xv(n,t){const{expression:i}=t;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new Be(n+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:h}=i;let p=0;for(;p<l.length&&l[p]<=n;)p++;p=Math.max(0,p-1);let v=p;for(;v<l.length&&l[v]<n+1;)v++;v=Math.min(l.length-1,v);const x=l[p],S=l[v];return i.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:S,interpolationType:h}:{kind:"camera",minZoom:x,maxZoom:S,minSize:i.evaluate(new Be(x)),maxSize:i.evaluate(new Be(S)),interpolationType:h}}}function wm(n,{uSize:t,uSizeT:i},{lowerSize:l,upperSize:h}){return n.kind==="source"?l/Is:n.kind==="composite"?$n(l/Is,h/Is,i):t}function Nu(n,t){let i=0,l=0;if(n.kind==="constant")l=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:h,minZoom:p,maxZoom:v}=n,x=h?nt(wo.interpolationFactor(h,t,p,v),0,1):0;n.kind==="camera"?l=$n(n.minSize,n.maxSize,x):i=x}return{uSizeT:i,uSize:l}}var EA=Object.freeze({__proto__:null,getSizeData:Xv,evaluateSizeForFeature:wm,evaluateSizeForZoom:Nu,SIZE_PACK_FACTOR:Is});function TA(n,t,i){return n.sections.forEach(l=>{l.text=function(h,p,v){const x=p.layout.get("text-transform").evaluate(v,{});return x==="uppercase"?h=h.toLocaleUpperCase():x==="lowercase"&&(h=h.toLocaleLowerCase()),Ae.applyArabicShaping&&(h=Ae.applyArabicShaping(h)),h}(l.text,t,i)}),n}const $d={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function CA(n){return n==="\uFE36"||n==="\uFE48"||n==="\uFE38"||n==="\uFE44"||n==="\uFE42"||n==="\uFE3E"||n==="\uFE3C"||n==="\uFE3A"||n==="\uFE18"||n==="\uFE40"||n==="\uFE10"||n==="\uFE13"||n==="\uFE14"||n==="\uFF40"||n==="\uFFE3"||n==="\uFE11"||n==="\uFE12"}function IA(n){return n==="\uFE35"||n==="\uFE47"||n==="\uFE37"||n==="\uFE43"||n==="\uFE41"||n==="\uFE3D"||n==="\uFE3B"||n==="\uFE39"||n==="\uFE17"||n==="\uFE3F"}var Nd=hi,C1=function(n,t,i,l,h){var p,v,x=8*h-l-1,S=(1<<x)-1,T=S>>1,k=-7,z=i?h-1:0,R=i?-1:1,V=n[t+z];for(z+=R,p=V&(1<<-k)-1,V>>=-k,k+=x;k>0;p=256*p+n[t+z],z+=R,k-=8);for(v=p&(1<<-k)-1,p>>=-k,k+=l;k>0;v=256*v+n[t+z],z+=R,k-=8);if(p===0)p=1-T;else{if(p===S)return v?NaN:1/0*(V?-1:1);v+=Math.pow(2,l),p-=T}return(V?-1:1)*v*Math.pow(2,p-l)},I1=function(n,t,i,l,h,p){var v,x,S,T=8*p-h-1,k=(1<<T)-1,z=k>>1,R=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,V=l?0:p-1,$=l?1:-1,G=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(x=isNaN(t)?1:0,v=k):(v=Math.floor(Math.log(t)/Math.LN2),t*(S=Math.pow(2,-v))<1&&(v--,S*=2),(t+=v+z>=1?R/S:R*Math.pow(2,1-z))*S>=2&&(v++,S/=2),v+z>=k?(x=0,v=k):v+z>=1?(x=(t*S-1)*Math.pow(2,h),v+=z):(x=t*Math.pow(2,z-1)*Math.pow(2,h),v=0));h>=8;n[i+V]=255&x,V+=$,x/=256,h-=8);for(v=v<<h|x,T+=h;T>0;n[i+V]=255&v,V+=$,v/=256,T-=8);n[i+V-$]|=128*G};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function hi(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}hi.Varint=0,hi.Fixed64=1,hi.Bytes=2,hi.Fixed32=5;var Yv=4294967296,A1=1/Yv,k1=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function la(n){return n.type===hi.Bytes?n.readVarint()+n.pos:n.pos+1}function Uu(n,t,i){return i?4294967296*t+(n>>>0):4294967296*(t>>>0)+(n>>>0)}function M1(n,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var h=i.pos-1;h>=n;h--)i.buf[h+l]=i.buf[h]}function AA(n,t){for(var i=0;i<n.length;i++)t.writeVarint(n[i])}function kA(n,t){for(var i=0;i<n.length;i++)t.writeSVarint(n[i])}function MA(n,t){for(var i=0;i<n.length;i++)t.writeFloat(n[i])}function PA(n,t){for(var i=0;i<n.length;i++)t.writeDouble(n[i])}function zA(n,t){for(var i=0;i<n.length;i++)t.writeBoolean(n[i])}function LA(n,t){for(var i=0;i<n.length;i++)t.writeFixed32(n[i])}function RA(n,t){for(var i=0;i<n.length;i++)t.writeSFixed32(n[i])}function DA(n,t){for(var i=0;i<n.length;i++)t.writeFixed64(n[i])}function BA(n,t){for(var i=0;i<n.length;i++)t.writeSFixed64(n[i])}function Sm(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16)+16777216*n[t+3]}function ju(n,t,i){n[i]=t,n[i+1]=t>>>8,n[i+2]=t>>>16,n[i+3]=t>>>24}function P1(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16)+(n[t+3]<<24)}function OA(n,t,i){t.glyphs=[],n===1&&i.readMessage(FA,t)}function FA(n,t,i){if(n===3){const{id:l,bitmap:h,width:p,height:v,left:x,top:S,advance:T}=i.readMessage(VA,{});t.glyphs.push({id:l,bitmap:new aa({width:p+6,height:v+6},h),metrics:{width:p,height:v,left:x,top:S,advance:T}})}else n===4?t.ascender=i.readSVarint():n===5&&(t.descender=i.readSVarint())}function VA(n,t,i){n===1?t.id=i.readVarint():n===2?t.bitmap=i.readBytes():n===3?t.width=i.readVarint():n===4?t.height=i.readVarint():n===5?t.left=i.readSVarint():n===6?t.top=i.readSVarint():n===7&&(t.advance=i.readVarint())}function Kv(n){let t=0,i=0;for(const v of n)t+=v.w*v.h,i=Math.max(i,v.w);n.sort((v,x)=>x.h-v.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let h=0,p=0;for(const v of n)for(let x=l.length-1;x>=0;x--){const S=l[x];if(!(v.w>S.w||v.h>S.h)){if(v.x=S.x,v.y=S.y,p=Math.max(p,v.y+v.h),h=Math.max(h,v.x+v.w),v.w===S.w&&v.h===S.h){const T=l.pop();x<l.length&&(l[x]=T)}else v.h===S.h?(S.x+=v.w,S.w-=v.w):v.w===S.w?(S.y+=v.h,S.h-=v.h):(l.push({x:S.x+v.w,y:S.y,w:S.w-v.w,h:v.h}),S.y+=v.h,S.h-=v.h);break}}return{w:h,h:p,fill:t/(h*p)||0}}hi.prototype={destroy:function(){this.buf=null},readFields:function(n,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),h=l>>3,p=this.pos;this.type=7&l,n(h,t,this),this.pos===p&&this.skip(l)}return t},readMessage:function(n,t){return this.readFields(n,t,this.readVarint()+this.pos)},readFixed32:function(){var n=Sm(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=P1(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=Sm(this.buf,this.pos)+Sm(this.buf,this.pos+4)*Yv;return this.pos+=8,n},readSFixed64:function(){var n=Sm(this.buf,this.pos)+P1(this.buf,this.pos+4)*Yv;return this.pos+=8,n},readFloat:function(){var n=C1(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=C1(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(h,p,v){var x,S,T=v.buf;if(x=(112&(S=T[v.pos++]))>>4,S<128||(x|=(127&(S=T[v.pos++]))<<3,S<128)||(x|=(127&(S=T[v.pos++]))<<10,S<128)||(x|=(127&(S=T[v.pos++]))<<17,S<128)||(x|=(127&(S=T[v.pos++]))<<24,S<128)||(x|=(1&(S=T[v.pos++]))<<31,S<128))return Uu(h,x,p);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var n=this.readVarint()+this.pos,t=this.pos;return this.pos=n,n-t>=12&&k1?function(i,l,h){return k1.decode(i.subarray(l,h))}(this.buf,t,n):function(i,l,h){for(var p="",v=l;v<h;){var x,S,T,k=i[v],z=null,R=k>239?4:k>223?3:k>191?2:1;if(v+R>h)break;R===1?k<128&&(z=k):R===2?(192&(x=i[v+1]))==128&&(z=(31&k)<<6|63&x)<=127&&(z=null):R===3?(S=i[v+2],(192&(x=i[v+1]))==128&&(192&S)==128&&((z=(15&k)<<12|(63&x)<<6|63&S)<=2047||z>=55296&&z<=57343)&&(z=null)):R===4&&(S=i[v+2],T=i[v+3],(192&(x=i[v+1]))==128&&(192&S)==128&&(192&T)==128&&((z=(15&k)<<18|(63&x)<<12|(63&S)<<6|63&T)<=65535||z>=1114112)&&(z=null)),z===null?(z=65533,R=1):z>65535&&(z-=65536,p+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),p+=String.fromCharCode(z),v+=R}return p}(this.buf,t,n)},readBytes:function(){var n=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,n);return this.pos=n,t},readPackedVarint:function(n,t){if(this.type!==hi.Bytes)return n.push(this.readVarint(t));var i=la(this);for(n=n||[];this.pos<i;)n.push(this.readVarint(t));return n},readPackedSVarint:function(n){if(this.type!==hi.Bytes)return n.push(this.readSVarint());var t=la(this);for(n=n||[];this.pos<t;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==hi.Bytes)return n.push(this.readBoolean());var t=la(this);for(n=n||[];this.pos<t;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==hi.Bytes)return n.push(this.readFloat());var t=la(this);for(n=n||[];this.pos<t;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==hi.Bytes)return n.push(this.readDouble());var t=la(this);for(n=n||[];this.pos<t;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==hi.Bytes)return n.push(this.readFixed32());var t=la(this);for(n=n||[];this.pos<t;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==hi.Bytes)return n.push(this.readSFixed32());var t=la(this);for(n=n||[];this.pos<t;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==hi.Bytes)return n.push(this.readFixed64());var t=la(this);for(n=n||[];this.pos<t;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==hi.Bytes)return n.push(this.readSFixed64());var t=la(this);for(n=n||[];this.pos<t;)n.push(this.readSFixed64());return n},skip:function(n){var t=7&n;if(t===hi.Varint)for(;this.buf[this.pos++]>127;);else if(t===hi.Bytes)this.pos=this.readVarint()+this.pos;else if(t===hi.Fixed32)this.pos+=4;else{if(t!==hi.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(n,t){this.writeVarint(n<<3|t)},realloc:function(n){for(var t=this.length||16;t<this.pos+n;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),ju(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),ju(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),ju(this.buf,-1&n,this.pos),ju(this.buf,Math.floor(n*A1),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),ju(this.buf,-1&n,this.pos),ju(this.buf,Math.floor(n*A1),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(t,i){var l,h;if(t>=0?(l=t%4294967296|0,h=t/4294967296|0):(h=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,h=h+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(p,v,x){x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,x.buf[x.pos]=127&(p>>>=7)}(l,0,i),function(p,v){var x=(7&p)<<4;v.buf[v.pos++]|=x|((p>>>=3)?128:0),p&&(v.buf[v.pos++]=127&p|((p>>>=7)?128:0),p&&(v.buf[v.pos++]=127&p|((p>>>=7)?128:0),p&&(v.buf[v.pos++]=127&p|((p>>>=7)?128:0),p&&(v.buf[v.pos++]=127&p|((p>>>=7)?128:0),p&&(v.buf[v.pos++]=127&p)))))}(h,i)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(Boolean(n))},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var t=this.pos;this.pos=function(l,h,p){for(var v,x,S=0;S<h.length;S++){if((v=h.charCodeAt(S))>55295&&v<57344){if(!x){v>56319||S+1===h.length?(l[p++]=239,l[p++]=191,l[p++]=189):x=v;continue}if(v<56320){l[p++]=239,l[p++]=191,l[p++]=189,x=v;continue}v=x-55296<<10|v-56320|65536,x=null}else x&&(l[p++]=239,l[p++]=191,l[p++]=189,x=null);v<128?l[p++]=v:(v<2048?l[p++]=v>>6|192:(v<65536?l[p++]=v>>12|224:(l[p++]=v>>18|240,l[p++]=v>>12&63|128),l[p++]=v>>6&63|128),l[p++]=63&v|128)}return p}(this.buf,n,this.pos);var i=this.pos-t;i>=128&&M1(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(n){this.realloc(4),I1(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),I1(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var t=n.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=n[i]},writeRawMessage:function(n,t){this.pos++;var i=this.pos;n(t,this);var l=this.pos-i;l>=128&&M1(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(n,t,i){this.writeTag(n,hi.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(n,t){t.length&&this.writeMessage(n,AA,t)},writePackedSVarint:function(n,t){t.length&&this.writeMessage(n,kA,t)},writePackedBoolean:function(n,t){t.length&&this.writeMessage(n,zA,t)},writePackedFloat:function(n,t){t.length&&this.writeMessage(n,MA,t)},writePackedDouble:function(n,t){t.length&&this.writeMessage(n,PA,t)},writePackedFixed32:function(n,t){t.length&&this.writeMessage(n,LA,t)},writePackedSFixed32:function(n,t){t.length&&this.writeMessage(n,RA,t)},writePackedFixed64:function(n,t){t.length&&this.writeMessage(n,DA,t)},writePackedSFixed64:function(n,t){t.length&&this.writeMessage(n,BA,t)},writeBytesField:function(n,t){this.writeTag(n,hi.Bytes),this.writeBytes(t)},writeFixed32Field:function(n,t){this.writeTag(n,hi.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(n,t){this.writeTag(n,hi.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(n,t){this.writeTag(n,hi.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(n,t){this.writeTag(n,hi.Fixed64),this.writeSFixed64(t)},writeVarintField:function(n,t){this.writeTag(n,hi.Varint),this.writeVarint(t)},writeSVarintField:function(n,t){this.writeTag(n,hi.Varint),this.writeSVarint(t)},writeStringField:function(n,t){this.writeTag(n,hi.Bytes),this.writeString(t)},writeFloatField:function(n,t){this.writeTag(n,hi.Fixed32),this.writeFloat(t)},writeDoubleField:function(n,t){this.writeTag(n,hi.Fixed64),this.writeDouble(t)},writeBooleanField:function(n,t){this.writeVarintField(n,Boolean(t))}};class Jv{constructor(t,{pixelRatio:i,version:l,stretchX:h,stretchY:p,content:v}){this.paddedRect=t,this.pixelRatio=i,this.stretchX=h,this.stretchY=p,this.content=v,this.version=l}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class z1{constructor(t,i){const l={},h={};this.haveRenderCallbacks=[];const p=[];this.addImages(t,l,p),this.addImages(i,h,p);const{w:v,h:x}=Kv(p),S=new eo({width:v||1,height:x||1});for(const T in t){const k=t[T],z=l[T].paddedRect;eo.copy(k.data,S,{x:0,y:0},{x:z.x+1,y:z.y+1},k.data)}for(const T in i){const k=i[T],z=h[T].paddedRect,R=z.x+1,V=z.y+1,$=k.data.width,G=k.data.height;eo.copy(k.data,S,{x:0,y:0},{x:R,y:V},k.data),eo.copy(k.data,S,{x:0,y:G-1},{x:R,y:V-1},{width:$,height:1}),eo.copy(k.data,S,{x:0,y:0},{x:R,y:V+G},{width:$,height:1}),eo.copy(k.data,S,{x:$-1,y:0},{x:R-1,y:V},{width:1,height:G}),eo.copy(k.data,S,{x:0,y:0},{x:R+$,y:V},{width:1,height:G})}this.image=S,this.iconPositions=l,this.patternPositions=h}addImages(t,i,l){for(const h in t){const p=t[h],v={x:0,y:0,w:p.data.width+2,h:p.data.height+2};l.push(v),i[h]=new Jv(v,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(l=>t.hasImage(l)),t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),i),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),i)}patchUpdatedImage(t,i,l){if(!t||!i||t.version===i.version)return;t.version=i.version;const[h,p]=t.tl;l.update(i.data,void 0,{x:h,y:p})}}Nt(Jv,"ImagePosition"),Nt(z1,"ImageAtlas");const fo={horizontal:1,vertical:2,horizontalOnly:3};class Ud{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,i){const l=new Ud;return l.scale=t||1,l.fontStack=i,l}static forImage(t){const i=new Ud;return i.imageName=t,i}}class Gu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,i){const l=new Gu;for(let h=0;h<t.sections.length;h++){const p=t.sections[h];p.image?l.addImageSection(p):l.addTextSection(p,i)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(t){this.text=function(i,l){let h="";for(let p=0;p<i.length;p++){const v=i.charCodeAt(p+1)||null,x=i.charCodeAt(p-1)||null;h+=!l&&(v&&M(v)&&!$d[i[p+1]]||x&&M(x)&&!$d[i[p-1]])||!$d[i[p]]?i[p]:$d[i[p]]}return h}(this.text,t)}trim(){let t=0;for(let l=0;l<this.text.length&&Em[this.text.charCodeAt(l)];l++)t++;let i=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&Em[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)}substring(t,i){const l=new Gu;return l.text=this.text.substring(t,i),l.sectionIndex=this.sectionIndex.slice(t,i),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,i)=>Math.max(t,this.sections[i].scale),0)}addTextSection(t,i){this.text+=t.text,this.sections.push(Ud.forText(t.scale,t.fontStack||i));const l=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(l)}addImageSection(t){const i=t.image?t.image.name:"";if(i.length===0)return void he("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Ud.forImage(i)),this.sectionIndex.push(this.sections.length-1)):he("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Qv(n,t,i,l,h,p,v,x,S,T,k,z,R,V,$){const G=Gu.fromFeature(n,h);z===fo.vertical&&G.verticalizePunctuation(R);let X=[];const le=function(xe,je,$e,tt,vt,We){if(!xe)return[];const it=[],ot=function(It,rn,Dt,Zt,At,an){let Mn=0;for(let En=0;En<It.length();En++){const bn=It.getSection(En);Mn+=L1(It.getCharCode(En),bn,Zt,At,rn,an)}return Mn/Math.max(1,Math.ceil(Mn/Dt))}(xe,je,$e,tt,vt,We),dt=xe.text.indexOf("\u200B")>=0;let _t=0;for(let It=0;It<xe.length();It++){const rn=xe.getSection(It),Dt=xe.getCharCode(It);if(Em[Dt]||(_t+=L1(Dt,rn,tt,vt,je,We)),It<xe.length()-1){const Zt=!((Ye=Dt)<11904||!(qp(Ye)||Au(Ye)||f(Ye)||Qp(Ye)||Hp(Ye)||Gp(Ye)||Zp(Ye)||Ql(Ye)||Xp(Ye)||_d(Ye)||Wp(Ye)||g(Ye)||Iu(Ye)||gd(Ye)||md(Ye)||vd(Ye)||Wa(Ye)||ec(Ye)||Kp(Ye)||Yp(Ye)));($A[Dt]||Zt||rn.imageName)&&it.push(D1(It+1,_t,ot,it,NA(Dt,xe.getCharCode(It+1),Zt&&dt),!1))}}var Ye;return B1(D1(xe.length(),_t,ot,it,0,!0))}(G,T,p,t,l,V),{processBidirectionalText:ye,processStyledBidirectionalText:re}=Ae;if(ye&&G.sections.length===1){const xe=ye(G.toString(),le);for(const je of xe){const $e=new Gu;$e.text=je,$e.sections=G.sections;for(let tt=0;tt<je.length;tt++)$e.sectionIndex.push(0);X.push($e)}}else if(re){const xe=re(G.text,G.sectionIndex,le);for(const je of xe){const $e=new Gu;$e.text=je[0],$e.sectionIndex=je[1],$e.sections=G.sections,X.push($e)}}else X=function(xe,je){const $e=[],tt=xe.text;let vt=0;for(const We of je)$e.push(xe.substring(vt,We)),vt=We;return vt<tt.length&&$e.push(xe.substring(vt,tt.length)),$e}(G,le);const ge=[],Te={positionedLines:ge,text:G.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(xe,je,$e,tt,vt,We,it,ot,dt,_t,Ye,It){let rn=0,Dt=0,Zt=0;const At=ot==="right"?1:ot==="left"?0:.5;let an=!1;for(const dn of vt){const Pn=dn.getSections();for(const ii of Pn){if(ii.imageName)continue;const gi=je[ii.fontStack];if(gi&&(an=gi.ascender!==void 0&&gi.descender!==void 0,!an))break}if(!an)break}let Mn=0;for(const dn of vt){dn.trim();const Pn=dn.getMaxScale(),ii=(Pn-1)*Er,gi={positionedGlyphs:[],lineOffset:0};xe.positionedLines[Mn]=gi;const di=gi.positionedGlyphs;let vi=0;if(!dn.length()){Dt+=We,++Mn;continue}let xi=0,Pi=0;for(let Qn=0;Qn<dn.length();Qn++){const Qi=dn.getSection(Qn),Zi=dn.getSectionIndex(Qn),jn=dn.getCharCode(Qn);let Ei=Qi.scale,ir=null,ri=null,Vi=null,kr=Er,fr=0;const pr=!(dt===fo.horizontal||!Ye&&!I(jn)||Ye&&(Em[jn]||(En=jn,Jl(En)||jp(En)||pd(En)||ku(En)||u(En))));if(Qi.imageName){const Nr=tt[Qi.imageName];if(!Nr)continue;Vi=Qi.imageName,xe.iconsInText=xe.iconsInText||!0,ri=Nr.paddedRect;const mr=Nr.displaySize;Ei=Ei*Er/It,ir={width:mr[0],height:mr[1],left:1,top:-3,advance:pr?mr[1]:mr[0],localGlyph:!1},fr=an?-ir.height*Ei:Pn*Er-17-mr[1]*Ei,kr=ir.advance;const ua=(pr?mr[0]:mr[1])*Ei-Er*Pn;ua>0&&ua>vi&&(vi=ua)}else{const Nr=$e[Qi.fontStack];if(!Nr)continue;Nr[jn]&&(ri=Nr[jn]);const mr=je[Qi.fontStack];if(!mr)continue;const ua=mr.glyphs[jn];if(!ua)continue;if(ir=ua.metrics,kr=jn!==8203?Er:0,an){const Xu=mr.ascender!==void 0?Math.abs(mr.ascender):0,Yd=mr.descender!==void 0?Math.abs(mr.descender):0,Kd=(Xu+Yd)*Ei;xi<Kd&&(xi=Kd,Pi=(Xu-Yd)/2*Ei),fr=-Xu*Ei}else fr=(Pn-Ei)*Er-17}pr?(xe.verticalizable=!0,di.push({glyph:jn,imageName:Vi,x:rn,y:Dt+fr,vertical:pr,scale:Ei,localGlyph:ir.localGlyph,fontStack:Qi.fontStack,sectionIndex:Zi,metrics:ir,rect:ri}),rn+=kr*Ei+_t):(di.push({glyph:jn,imageName:Vi,x:rn,y:Dt+fr,vertical:pr,scale:Ei,localGlyph:ir.localGlyph,fontStack:Qi.fontStack,sectionIndex:Zi,metrics:ir,rect:ri}),rn+=ir.advance*Ei+_t)}di.length!==0&&(Zt=Math.max(rn-_t,Zt),an?O1(di,At,vi,Pi,We*Pn/2):O1(di,At,vi,0,We/2)),rn=0;const dr=We*Pn+vi;gi.lineOffset=Math.max(vi,ii),Dt+=dr,++Mn}var En;const bn=Dt,{horizontalAlign:ln,verticalAlign:Jn}=e_(it);(function(dn,Pn,ii,gi,di,vi){const xi=(Pn-ii)*di,Pi=-vi*gi;for(const dr of dn)for(const Qn of dr.positionedGlyphs)Qn.x+=xi,Qn.y+=Pi})(xe.positionedLines,At,ln,Jn,Zt,bn),xe.top+=-Jn*bn,xe.bottom=xe.top+bn,xe.left+=-ln*Zt,xe.right=xe.left+Zt,xe.hasBaseline=an}(Te,t,i,l,X,v,x,S,z,T,R,$),!function(xe){for(const je of xe)if(je.positionedGlyphs.length!==0)return!1;return!0}(ge)&&Te}const Em={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},$A={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function L1(n,t,i,l,h,p){if(t.imageName){const v=l[t.imageName];return v?v.displaySize[0]*t.scale*Er/p+h:0}{const v=i[t.fontStack],x=v&&v.glyphs[n];return x?x.metrics.advance*t.scale+h:0}}function R1(n,t,i,l){const h=Math.pow(n-t,2);return l?n<t?h/2:2*h:h+Math.abs(i)*i}function NA(n,t,i){let l=0;return n===10&&(l-=1e4),i&&(l+=150),n!==40&&n!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function D1(n,t,i,l,h,p){let v=null,x=R1(t,i,h,p);for(const S of l){const T=R1(t-S.x,i,h,p)+S.badness;T<=x&&(v=S,x=T)}return{index:n,x:t,priorBreak:v,badness:x}}function B1(n){return n?B1(n.priorBreak).concat(n.index):[]}function e_(n){let t=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function O1(n,t,i,l,h){if(!(t||i||l||h))return;const p=n.length-1,v=n[p],x=(v.x+v.metrics.advance*v.scale)*t;for(let S=0;S<=p;S++)n[S].x-=x,n[S].y+=i+l+h}function UA(n,t,i){const{horizontalAlign:l,verticalAlign:h}=e_(i),p=t[0]-n.displaySize[0]*l,v=t[1]-n.displaySize[1]*h;return{image:n,top:v,bottom:v+n.displaySize[1],left:p,right:p+n.displaySize[0]}}function F1(n,t,i,l,h,p){const v=n.image;let x;if(v.content){const X=v.content,le=v.pixelRatio||1;x=[X[0]/le,X[1]/le,v.displaySize[0]-X[2]/le,v.displaySize[1]-X[3]/le]}const S=t.left*p,T=t.right*p;let k,z,R,V;i==="width"||i==="both"?(V=h[0]+S-l[3],z=h[0]+T+l[1]):(V=h[0]+(S+T-v.displaySize[0])/2,z=V+v.displaySize[0]);const $=t.top*p,G=t.bottom*p;return i==="height"||i==="both"?(k=h[1]+$-l[0],R=h[1]+G+l[2]):(k=h[1]+($+G-v.displaySize[1])/2,R=k+v.displaySize[1]),{image:v,top:k,right:z,bottom:R,left:V,collisionPadding:x}}class ca extends Y{constructor(t,i,l,h,p){super(t,i),this.angle=h,this.z=l,p!==void 0&&(this.segment=p)}clone(){return new ca(this.x,this.y,this.z,this.angle,this.segment)}}function V1(n,t,i,l,h){if(t.segment===void 0)return!0;let p=t,v=t.segment+1,x=0;for(;x>-i/2;){if(v--,v<0)return!1;x-=n[v].dist(p),p=n[v]}x+=n[v].dist(n[v+1]),v++;const S=[];let T=0;for(;x<i/2;){const k=n[v],z=n[v+1];if(!z)return!1;let R=n[v-1].angleTo(k)-k.angleTo(z);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:x,angleDelta:R}),T+=R;x-S[0].distance>l;)T-=S.shift().angleDelta;if(T>h)return!1;v++,x+=k.dist(z)}return!0}function $1(n){let t=0;for(let i=0;i<n.length-1;i++)t+=n[i].dist(n[i+1]);return t}function N1(n,t,i){return n?.6*t*i:0}function U1(n,t){return Math.max(n?n.right-n.left:0,t?t.right-t.left:0)}function jA(n,t,i,l,h,p){const v=N1(i,h,p),x=U1(i,l)*p;let S=0;const T=$1(n)/2;for(let k=0;k<n.length-1;k++){const z=n[k],R=n[k+1],V=z.dist(R);if(S+V>T){const $=(T-S)/V,G=$n(z.x,R.x,$),X=$n(z.y,R.y,$),le=new ca(G,X,0,R.angleTo(z),k);return!v||V1(n,le,x,v,t)?le:void 0}S+=V}}function GA(n,t,i,l,h,p,v,x,S){const T=N1(l,p,v),k=U1(l,h),z=k*v,R=n[0].x===0||n[0].x===S||n[0].y===0||n[0].y===S;return t-z<t/4&&(t=z+t/4),j1(n,R?t/2*x%t:(k/2+2*p)*v*x%t,t,T,i,z,R,!1,S)}function j1(n,t,i,l,h,p,v,x,S){const T=p/2,k=$1(n);let z=0,R=t-i,V=[];for(let $=0;$<n.length-1;$++){const G=n[$],X=n[$+1],le=G.dist(X),ye=X.angleTo(G);for(;R+i<z+le;){R+=i;const re=(R-z)/le,ge=$n(G.x,X.x,re),Te=$n(G.y,X.y,re);if(ge>=0&&ge<S&&Te>=0&&Te<S&&R-T>=0&&R+T<=k){const xe=new ca(ge,Te,0,ye,$);xe._round(),l&&!V1(n,xe,p,l,h)||V.push(xe)}}z+=le}return x||V.length||v||(V=j1(n,z/2,i,l,h,p,v,!0,S)),V}function G1(n,t,i,l,h){const p=[];for(let v=0;v<n.length;v++){const x=n[v];let S;for(let T=0;T<x.length-1;T++){let k=x[T],z=x[T+1];k.x<t&&z.x<t||(k.x<t?k=new Y(t,k.y+(t-k.x)/(z.x-k.x)*(z.y-k.y))._round():z.x<t&&(z=new Y(t,k.y+(t-k.x)/(z.x-k.x)*(z.y-k.y))._round()),k.y<i&&z.y<i||(k.y<i?k=new Y(k.x+(i-k.y)/(z.y-k.y)*(z.x-k.x),i)._round():z.y<i&&(z=new Y(k.x+(i-k.y)/(z.y-k.y)*(z.x-k.x),i)._round()),k.x>=l&&z.x>=l||(k.x>=l?k=new Y(l,k.y+(l-k.x)/(z.x-k.x)*(z.y-k.y))._round():z.x>=l&&(z=new Y(l,k.y+(l-k.x)/(z.x-k.x)*(z.y-k.y))._round()),k.y>=h&&z.y>=h||(k.y>=h?k=new Y(k.x+(h-k.y)/(z.y-k.y)*(z.x-k.x),h)._round():z.y>=h&&(z=new Y(k.x+(h-k.y)/(z.y-k.y)*(z.x-k.x),h)._round()),S&&k.equals(S[S.length-1])||(S=[k],p.push(S)),S.push(z)))))}}return p}Nt(ca,"Anchor");const jd=1e20;function q1(n,t,i,l,h,p,v,x,S){for(let T=t;T<t+l;T++)Z1(n,i*p+T,p,h,v,x,S);for(let T=i;T<i+h;T++)Z1(n,T*p+t,1,l,v,x,S)}function Z1(n,t,i,l,h,p,v){p[0]=0,v[0]=-jd,v[1]=jd,h[0]=n[t];for(let x=1,S=0,T=0;x<l;x++){h[x]=n[t+x*i];const k=x*x;do{const z=p[S];T=(h[x]-h[z]+k-z*z)/(x-z)/2}while(T<=v[S]&&--S>-1);S++,p[S]=x,v[S]=T,v[S+1]=jd}for(let x=0,S=0;x<l;x++){for(;v[S+1]<x;)S++;const T=p[S],k=x-T;n[t+x*i]=h[T]+k*k}}const t_={none:0,ideographs:1,all:2};class qu{constructor(t,i,l){this.requestManager=t,this.localGlyphMode=i,this.localFontFamily=l,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,i){const l=[];for(const h in t)for(const p of t[h])l.push({stack:h,id:p});at(l,({stack:h,id:p},v)=>{let x=this.entries[h];x||(x=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let S=x.glyphs[p];if(S!==void 0)return void v(null,{stack:h,id:p,glyph:S});if(S=this._tinySDF(x,h,p),S)return x.glyphs[p]=S,void v(null,{stack:h,id:p,glyph:S});const T=Math.floor(p/256);if(256*T>65535)return void v(new Error("glyphs > 65535 not supported"));if(x.ranges[T])return void v(null,{stack:h,id:p,glyph:S});let k=x.requests[T];k||(k=x.requests[T]=[],qu.loadGlyphRange(h,T,this.url,this.requestManager,(z,R)=>{if(R){x.ascender=R.ascender,x.descender=R.descender;for(const V in R.glyphs)this._doesCharSupportLocalGlyph(+V)||(x.glyphs[+V]=R.glyphs[+V]);x.ranges[T]=!0}for(const V of k)V(z,R);delete x.requests[T]})),k.push((z,R)=>{z?v(z):R&&v(null,{stack:h,id:p,glyph:R.glyphs[p]||null})})},(h,p)=>{if(h)i(h);else if(p){const v={};for(const{stack:x,id:S,glyph:T}of p)v[x]===void 0&&(v[x]={}),v[x].glyphs===void 0&&(v[x].glyphs={}),v[x].glyphs[S]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics},v[x].ascender=this.entries[x].ascender,v[x].descender=this.entries[x].descender;i(null,v)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==t_.none&&(this.localGlyphMode===t_.all?!!this.localFontFamily:!!this.localFontFamily&&(_d(t)||Jp(t)||Iu(t)||Wa(t)||Ql(t)))}_tinySDF(t,i,l){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(l))return;let p=t.tinySDF;if(!p){let G="400";/bold/i.test(i)?G="900":/medium/i.test(i)?G="500":/light/i.test(i)&&(G="200"),p=t.tinySDF=new qu.TinySDF({fontFamily:h,fontWeight:G,fontSize:48,buffer:6,radius:16}),p.fontWeight=G}if(this.localGlyphs[p.fontWeight][l])return this.localGlyphs[p.fontWeight][l];const v=String.fromCharCode(l),{data:x,width:S,height:T,glyphWidth:k,glyphHeight:z,glyphLeft:R,glyphTop:V,glyphAdvance:$}=p.draw(v);return this.localGlyphs[p.fontWeight][l]={id:l,bitmap:new aa({width:S,height:T},x),metrics:{width:k/2,height:z/2,left:R/2,top:V/2-27,advance:$/2,localGlyph:!0}}}}function W1(n,t,i,l){const h=[],p=n.image,v=p.pixelRatio,x=p.paddedRect.w-2,S=p.paddedRect.h-2,T=n.right-n.left,k=n.bottom-n.top,z=p.stretchX||[[0,x]],R=p.stretchY||[[0,S]],V=(We,it)=>We+it[1]-it[0],$=z.reduce(V,0),G=R.reduce(V,0),X=x-$,le=S-G;let ye=0,re=$,ge=0,Te=G,xe=0,je=X,$e=0,tt=le;if(p.content&&l){const We=p.content;ye=Tm(z,0,We[0]),ge=Tm(R,0,We[1]),re=Tm(z,We[0],We[2]),Te=Tm(R,We[1],We[3]),xe=We[0]-ye,$e=We[1]-ge,je=We[2]-We[0]-re,tt=We[3]-We[1]-Te}const vt=(We,it,ot,dt)=>{const _t=Cm(We.stretch-ye,re,T,n.left),Ye=Im(We.fixed-xe,je,We.stretch,$),It=Cm(it.stretch-ge,Te,k,n.top),rn=Im(it.fixed-$e,tt,it.stretch,G),Dt=Cm(ot.stretch-ye,re,T,n.left),Zt=Im(ot.fixed-xe,je,ot.stretch,$),At=Cm(dt.stretch-ge,Te,k,n.top),an=Im(dt.fixed-$e,tt,dt.stretch,G),Mn=new Y(_t,It),En=new Y(Dt,It),bn=new Y(Dt,At),ln=new Y(_t,At),Jn=new Y(Ye/v,rn/v),dn=new Y(Zt/v,an/v),Pn=t*Math.PI/180;if(Pn){const di=Math.sin(Pn),vi=Math.cos(Pn),xi=[vi,-di,di,vi];Mn._matMult(xi),En._matMult(xi),ln._matMult(xi),bn._matMult(xi)}const ii=We.stretch+We.fixed,gi=it.stretch+it.fixed;return{tl:Mn,tr:En,bl:ln,br:bn,tex:{x:p.paddedRect.x+1+ii,y:p.paddedRect.y+1+gi,w:ot.stretch+ot.fixed-ii,h:dt.stretch+dt.fixed-gi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Jn,pixelOffsetBR:dn,minFontScaleX:je/v/T,minFontScaleY:tt/v/k,isSDF:i}};if(l&&(p.stretchX||p.stretchY)){const We=H1(z,X,$),it=H1(R,le,G);for(let ot=0;ot<We.length-1;ot++){const dt=We[ot],_t=We[ot+1];for(let Ye=0;Ye<it.length-1;Ye++)h.push(vt(dt,it[Ye],_t,it[Ye+1]))}}else h.push(vt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:S+1}));return h}function Tm(n,t,i){let l=0;for(const h of n)l+=Math.max(t,Math.min(i,h[1]))-Math.max(t,Math.min(i,h[0]));return l}function H1(n,t,i){const l=[{fixed:-1,stretch:0}];for(const[h,p]of n){const v=l[l.length-1];l.push({fixed:h-v.stretch,stretch:v.stretch}),l.push({fixed:h-v.stretch,stretch:v.stretch+(p-h)})}return l.push({fixed:t+1,stretch:i}),l}function Cm(n,t,i,l){return n/t*i+l}function Im(n,t,i,l){return n-t*i/l}function qA(n,t,i,l){const h=t+n.positionedLines[l].lineOffset;return l===0?i+h/2:i+(h+(t+n.positionedLines[l-1].lineOffset))/2}qu.loadGlyphRange=function(n,t,i,l,h){const p=256*t,v=p+255,x=l.transformRequest(l.normalizeGlyphsURL(i).replace("{fontstack}",n).replace("{range}",`${p}-${v}`),or.Glyphs);yo(x,(S,T)=>{if(S)h(S);else if(T){const k={},z=function(R){return new Nd(R).readFields(OA,{})}(T);for(const R of z.glyphs)k[R.id]=R;h(null,{glyphs:k,ascender:z.ascender,descender:z.descender})}})},qu.TinySDF=class{constructor({fontSize:n=24,buffer:t=3,radius:i=8,cutoff:l=.25,fontFamily:h="sans-serif",fontWeight:p="normal",fontStyle:v="normal"}={}){this.buffer=t,this.cutoff=l,this.radius=i;const x=this.size=n+4*t,S=this._createCanvas(x),T=this.ctx=S.getContext("2d",{willReadFrequently:!0});T.font=`${v} ${p} ${n}px ${h}`,T.textBaseline="alphabetic",T.textAlign="left",T.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(n){const t=document.createElement("canvas");return t.width=t.height=n,t}draw(n){const{width:t,actualBoundingBoxAscent:i,actualBoundingBoxDescent:l,actualBoundingBoxLeft:h,actualBoundingBoxRight:p}=this.ctx.measureText(n),v=Math.ceil(i),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-h))),S=Math.min(this.size-this.buffer,v+Math.ceil(l)),T=x+2*this.buffer,k=S+2*this.buffer,z=Math.max(T*k,0),R=new Uint8ClampedArray(z),V={data:R,width:T,height:k,glyphWidth:x,glyphHeight:S,glyphTop:v,glyphLeft:0,glyphAdvance:t};if(x===0||S===0)return V;const{ctx:$,buffer:G,gridInner:X,gridOuter:le}=this;$.clearRect(G,G,x,S),$.fillText(n,G,G+v);const ye=$.getImageData(G,G,x,S);le.fill(jd,0,z),X.fill(0,0,z);for(let re=0;re<S;re++)for(let ge=0;ge<x;ge++){const Te=ye.data[4*(re*x+ge)+3]/255;if(Te===0)continue;const xe=(re+G)*T+ge+G;if(Te===1)le[xe]=0,X[xe]=jd;else{const je=.5-Te;le[xe]=je>0?je*je:0,X[xe]=je<0?je*je:0}}q1(le,0,0,T,k,T,this.f,this.v,this.z),q1(X,G,G,x,S,T,this.f,this.v,this.z);for(let re=0;re<z;re++){const ge=Math.sqrt(le[re])-Math.sqrt(X[re]);R[re]=Math.round(255-255*(ge/this.radius+this.cutoff))}return V}};class ZA{constructor(t=[],i=WA){if(this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:i,compare:l}=this,h=i[t];for(;t>0;){const p=t-1>>1,v=i[p];if(l(h,v)>=0)break;i[t]=v,t=p}i[t]=h}_down(t){const{data:i,compare:l}=this,h=this.length>>1,p=i[t];for(;t<h;){let v=1+(t<<1),x=i[v];const S=v+1;if(S<this.length&&l(i[S],x)<0&&(v=S,x=i[S]),l(x,p)>=0)break;i[t]=x,t=v}i[t]=p}}function WA(n,t){return n<t?-1:n>t?1:0}function HA(n,t=1,i=!1){let l=1/0,h=1/0,p=-1/0,v=-1/0;const x=n[0];for(let V=0;V<x.length;V++){const $=x[V];(!V||$.x<l)&&(l=$.x),(!V||$.y<h)&&(h=$.y),(!V||$.x>p)&&(p=$.x),(!V||$.y>v)&&(v=$.y)}const S=Math.min(p-l,v-h);let T=S/2;const k=new ZA([],XA);if(S===0)return new Y(l,h);for(let V=l;V<p;V+=S)for(let $=h;$<v;$+=S)k.push(new Zu(V+T,$+T,T,n));let z=function(V){let $=0,G=0,X=0;const le=V[0];for(let ye=0,re=le.length,ge=re-1;ye<re;ge=ye++){const Te=le[ye],xe=le[ge],je=Te.x*xe.y-xe.x*Te.y;G+=(Te.x+xe.x)*je,X+=(Te.y+xe.y)*je,$+=3*je}return new Zu(G/$,X/$,0,V)}(n),R=k.length;for(;k.length;){const V=k.pop();(V.d>z.d||!z.d)&&(z=V,i&&console.log("found best %d after %d probes",Math.round(1e4*V.d)/1e4,R)),V.max-z.d<=t||(T=V.h/2,k.push(new Zu(V.p.x-T,V.p.y-T,T,n)),k.push(new Zu(V.p.x+T,V.p.y-T,T,n)),k.push(new Zu(V.p.x-T,V.p.y+T,T,n)),k.push(new Zu(V.p.x+T,V.p.y+T,T,n)),R+=4)}return i&&(console.log(`num probes: ${R}`),console.log(`best distance: ${z.d}`)),z.p}function XA(n,t){return t.max-n.max}function Zu(n,t,i,l){this.p=new Y(n,t),this.h=i,this.d=function(h,p){let v=!1,x=1/0;for(let S=0;S<p.length;S++){const T=p[S];for(let k=0,z=T.length,R=z-1;k<z;R=k++){const V=T[k],$=T[R];V.y>h.y!=$.y>h.y&&h.x<($.x-V.x)*(h.y-V.y)/($.y-V.y)+V.x&&(v=!v),x=Math.min(x,Zx(h,V,$))}}return(v?1:-1)*Math.sqrt(x)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}const n_=Number.POSITIVE_INFINITY,YA=Math.sqrt(2);function X1(n,[t,i]){let l=0,h=0;if(i===n_){t<0&&(t=0);const p=t/YA;switch(n){case"top-right":case"top-left":h=p-7;break;case"bottom-right":case"bottom-left":h=7-p;break;case"bottom":h=7-t;break;case"top":h=t-7}switch(n){case"top-right":case"bottom-right":l=-p;break;case"top-left":case"bottom-left":l=p;break;case"left":l=t;break;case"right":l=-t}}else{switch(t=Math.abs(t),i=Math.abs(i),n){case"top-right":case"top-left":case"top":h=i-7;break;case"bottom-right":case"bottom-left":case"bottom":h=7-i}switch(n){case"top-right":case"bottom-right":case"right":l=-t;break;case"top-left":case"bottom-left":case"left":l=t}}return[l,h]}function KA(n,t,i,l,h,p,v,x,S,T){n.createArrays(),n.tilePixelRatio=hn/(512*n.overscaling),n.compareText={},n.iconsNeedLinear=!1;const k=n.layers[0].layout,z=n.layers[0]._unevaluatedLayout._values,R={};if(n.textSizeData.kind==="composite"){const{minZoom:G,maxZoom:X}=n.textSizeData;R.compositeTextSizes=[z["text-size"].possiblyEvaluate(new Be(G),x),z["text-size"].possiblyEvaluate(new Be(X),x)]}if(n.iconSizeData.kind==="composite"){const{minZoom:G,maxZoom:X}=n.iconSizeData;R.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new Be(G),x),z["icon-size"].possiblyEvaluate(new Be(X),x)]}R.layoutTextSize=z["text-size"].possiblyEvaluate(new Be(S+1),x),R.layoutIconSize=z["icon-size"].possiblyEvaluate(new Be(S+1),x),R.textMaxSize=z["text-size"].possiblyEvaluate(new Be(18),x);const V=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",$=k.get("text-size");for(const G of n.features){const X=k.get("text-font").evaluate(G,{},x).join(","),le=$.evaluate(G,{},x),ye=R.layoutTextSize.evaluate(G,{},x),re=(R.layoutIconSize.evaluate(G,{},x),{horizontal:{},vertical:void 0}),ge=G.text;let Te,xe=[0,0];if(ge){const tt=ge.toString(),vt=k.get("text-letter-spacing").evaluate(G,{},x)*Er,We=k.get("text-line-height").evaluate(G,{},x)*Er,it=b(tt)?vt:0,ot=k.get("text-anchor").evaluate(G,{},x),dt=k.get("text-variable-anchor");if(!dt){const Dt=k.get("text-radial-offset").evaluate(G,{},x);xe=Dt?X1(ot,[Dt*Er,n_]):k.get("text-offset").evaluate(G,{},x).map(Zt=>Zt*Er)}let _t=V?"center":k.get("text-justify").evaluate(G,{},x);const Ye=k.get("symbol-placement")==="point",It=Ye?k.get("text-max-width").evaluate(G,{},x)*Er:1/0,rn=Dt=>{n.allowVerticalPlacement&&y(tt)&&(re.vertical=Qv(ge,t,i,h,X,It,We,ot,Dt,it,xe,fo.vertical,!0,ye,le))};if(!V&&dt){const Dt=_t==="auto"?dt.map(At=>i_(At)):[_t];let Zt=!1;for(let At=0;At<Dt.length;At++){const an=Dt[At];if(!re.horizontal[an])if(Zt)re.horizontal[an]=re.horizontal[0];else{const Mn=Qv(ge,t,i,h,X,It,We,"center",an,it,xe,fo.horizontal,!1,ye,le);Mn&&(re.horizontal[an]=Mn,Zt=Mn.positionedLines.length===1)}}rn("left")}else{if(_t==="auto"&&(_t=i_(ot)),Ye||k.get("text-writing-mode").indexOf("horizontal")>=0||!y(tt)){const Dt=Qv(ge,t,i,h,X,It,We,ot,_t,it,xe,fo.horizontal,!1,ye,le);Dt&&(re.horizontal[_t]=Dt)}rn(Ye?"left":_t)}}let je=!1;if(G.icon&&G.icon.name){const tt=l[G.icon.name];tt&&(Te=UA(h[G.icon.name],k.get("icon-offset").evaluate(G,{},x),k.get("icon-anchor").evaluate(G,{},x)),je=tt.sdf,n.sdfIcons===void 0?n.sdfIcons=tt.sdf:n.sdfIcons!==tt.sdf&&he("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(tt.pixelRatio!==n.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(n.iconsNeedLinear=!0))}const $e=K1(re.horizontal)||re.vertical;n.iconsInText||(n.iconsInText=!!$e&&$e.iconsInText),($e||Te)&&JA(n,G,re,Te,l,R,ye,0,xe,je,v,x,T)}p&&n.generateCollisionDebugBuffers(S,n.collisionBoxArray)}function i_(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function JA(n,t,i,l,h,p,v,x,S,T,k,z,R){let V=p.textMaxSize.evaluate(t,{},z);V===void 0&&(V=v);const $=n.layers[0].layout,G=$.get("icon-offset").evaluate(t,{},z),X=K1(i.horizontal)||i.vertical,le=R.name==="globe",ye=v/24,re=n.tilePixelRatio*V/24,ge=(it=n.overscaling,n.zoom>18&&it>2&&(it>>=1),Math.max(hn/(512*it),1)*$.get("symbol-spacing")),Te=$.get("text-padding")*n.tilePixelRatio,xe=$.get("icon-padding")*n.tilePixelRatio,je=Ee($.get("text-max-angle")),$e=$.get("text-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",tt=$.get("icon-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",vt=$.get("symbol-placement"),We=ge/2;var it;const ot=$.get("icon-text-fit");let dt;l&&ot!=="none"&&(n.allowVerticalPlacement&&i.vertical&&(dt=F1(l,i.vertical,ot,$.get("icon-text-fit-padding"),G,ye)),X&&(l=F1(l,X,ot,$.get("icon-text-fit-padding"),G,ye)));const _t=(Ye,It,rn)=>{if(It.x<0||It.x>=hn||It.y<0||It.y>=hn)return;let Dt=null;if(le){const{x:Zt,y:At,z:an}=R.projectTilePoint(It.x,It.y,rn);Dt={anchor:new ca(Zt,At,an,0,void 0),up:R.upVector(rn,It.x,It.y)}}(function(Zt,At,an,Mn,En,bn,ln,Jn,dn,Pn,ii,gi,di,vi,xi,Pi,dr,Qn,Qi,Zi,jn,Ei,ir,ri,Vi){const kr=Zt.addToLineVertexArray(At,Mn);let fr,pr,Nr,mr,ua,Xu,Yd,Kd=0,Cb=0,Ib=0,Ab=0,m_=-1,g_=-1;const Ps={};let kb=tc("");const fc=an?an.anchor:At;let v_=0,__=0;if(dn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[v_,__]=dn.layout.get("text-offset").evaluate(jn,{},Vi).map(to=>to*Er):(v_=dn.layout.get("text-radial-offset").evaluate(jn,{},Vi)*Er,__=n_),Zt.allowVerticalPlacement&&En.vertical){const to=En.vertical;if(xi)Xu=r_(to),Jn&&(Yd=r_(Jn));else{const no=dn.layout.get("text-rotate").evaluate(jn,{},Vi)+90;Nr=Am(Pn,fc,At,ii,gi,di,to,vi,no,Pi),Jn&&(mr=Am(Pn,fc,At,ii,gi,di,Jn,Qn,no))}}if(bn){const to=dn.layout.get("icon-rotate").evaluate(jn,{},Vi),no=dn.layout.get("icon-text-fit")!=="none",Jd=W1(bn,to,ir,no),x_=Jn?W1(Jn,to,ir,no):void 0;pr=Am(Pn,fc,At,ii,gi,di,bn,Qn,to),Kd=4*Jd.length;const Mb=Zt.iconSizeData;let pc=null;Mb.kind==="source"?(pc=[Is*dn.layout.get("icon-size").evaluate(jn,{},Vi)],pc[0]>Qa&&he(`${Zt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Mb.kind==="composite"&&(pc=[Is*Ei.compositeIconSizes[0].evaluate(jn,{},Vi),Is*Ei.compositeIconSizes[1].evaluate(jn,{},Vi)],(pc[0]>Qa||pc[1]>Qa)&&he(`${Zt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Zt.addSymbols(Zt.icon,Jd,pc,Zi,Qi,jn,!1,an,At,kr.lineStartIndex,kr.lineLength,-1,ri,Vi),m_=Zt.icon.placedSymbolArray.length-1,x_&&(Cb=4*x_.length,Zt.addSymbols(Zt.icon,x_,pc,Zi,Qi,jn,fo.vertical,an,At,kr.lineStartIndex,kr.lineLength,-1,ri,Vi),g_=Zt.icon.placedSymbolArray.length-1)}for(const to in En.horizontal){const no=En.horizontal[to];fr||(kb=tc(no.text),xi?ua=r_(no):fr=Am(Pn,fc,At,ii,gi,di,no,vi,dn.layout.get("text-rotate").evaluate(jn,{},Vi),Pi));const Jd=no.positionedLines.length===1;if(Ib+=Y1(Zt,an,At,no,ln,dn,xi,jn,Pi,kr,En.vertical?fo.horizontal:fo.horizontalOnly,Jd?Object.keys(En.horizontal):[to],Ps,m_,Ei,ri,Vi),Jd)break}En.vertical&&(Ab+=Y1(Zt,an,At,En.vertical,ln,dn,xi,jn,Pi,kr,fo.vertical,["vertical"],Ps,g_,Ei,ri,Vi));let ol=-1;const y_=(to,no)=>to?Math.max(to,no):no;ol=y_(ua,ol),ol=y_(Xu,ol),ol=y_(Yd,ol);const Ek=ol>-1?1:0;Zt.glyphOffsetArray.length>=tl.MAX_GLYPHS&&he("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),jn.sortKey!==void 0&&Zt.addToSortKeyRanges(Zt.symbolInstances.length,jn.sortKey),Zt.symbolInstances.emplaceBack(fc.x,fc.y,fc.z,At.x,At.y,Ps.right>=0?Ps.right:-1,Ps.center>=0?Ps.center:-1,Ps.left>=0?Ps.left:-1,Ps.vertical>=0?Ps.vertical:-1,m_,g_,kb,fr!==void 0?fr:Zt.collisionBoxArray.length,fr!==void 0?fr+1:Zt.collisionBoxArray.length,Nr!==void 0?Nr:Zt.collisionBoxArray.length,Nr!==void 0?Nr+1:Zt.collisionBoxArray.length,pr!==void 0?pr:Zt.collisionBoxArray.length,pr!==void 0?pr+1:Zt.collisionBoxArray.length,mr||Zt.collisionBoxArray.length,mr?mr+1:Zt.collisionBoxArray.length,ii,Ib,Ab,Kd,Cb,Ek,0,v_,__,ol)})(n,It,Dt,Ye,i,l,h,dt,n.layers[0],n.collisionBoxArray,t.index,t.sourceLayerIndex,n.index,Te,$e,S,0,xe,tt,G,t,p,T,k,z)};if(vt==="line")for(const Ye of G1(t.geometry,0,0,hn,hn)){const It=GA(Ye,ge,je,i.vertical||X,l,24,re,n.overscaling,hn);for(const rn of It){const Dt=X;Dt&&QA(n,Dt.text,We,rn)||_t(Ye,rn,z)}}else if(vt==="line-center"){for(const Ye of t.geometry)if(Ye.length>1){const It=jA(Ye,je,i.vertical||X,l,24,re);It&&_t(Ye,It,z)}}else if(t.type==="Polygon")for(const Ye of qv(t.geometry,0)){const It=HA(Ye,16);_t(Ye[0],new ca(It.x,It.y,0,0,void 0),z)}else if(t.type==="LineString")for(const Ye of t.geometry)_t(Ye,new ca(Ye[0].x,Ye[0].y,0,0,void 0),z);else if(t.type==="Point")for(const Ye of t.geometry)for(const It of Ye)_t([It],new ca(It.x,It.y,0,0,void 0),z)}const Qa=32640;function Y1(n,t,i,l,h,p,v,x,S,T,k,z,R,V,$,G,X){const le=function(ge,Te,xe,je,$e,tt,vt,We){const it=[];if(Te.positionedLines.length===0)return it;const ot=je.layout.get("text-rotate").evaluate(tt,{})*Math.PI/180,dt=function(Dt){const Zt=Dt[0],At=Dt[1],an=Zt*At;return an>0?[Zt,-At]:an<0?[-Zt,At]:Zt===0?[At,Zt]:[At,-Zt]}(xe);let _t=Math.abs(Te.top-Te.bottom);for(const Dt of Te.positionedLines)_t-=Dt.lineOffset;const Ye=Te.positionedLines.length,It=_t/Ye;let rn=Te.top-xe[1];for(let Dt=0;Dt<Ye;++Dt){const Zt=Te.positionedLines[Dt];rn=qA(Te,It,rn,Dt);for(const At of Zt.positionedGlyphs){if(!At.rect)continue;const an=At.rect||{};let Mn=4,En=!0,bn=1,ln=0;if(At.imageName){const ri=vt[At.imageName];if(!ri)continue;if(ri.sdf){he("SDF images are not supported in formatted text and will be ignored.");continue}En=!1,bn=ri.pixelRatio,Mn=1/bn}const Jn=($e||We)&&At.vertical,dn=At.metrics.advance*At.scale/2,Pn=At.metrics,ii=At.rect;if(ii===null)continue;We&&Te.verticalizable&&(ln=At.imageName?dn-At.metrics.width*At.scale/2:0);const gi=$e?[At.x+dn,At.y]:[0,0];let di=[0,0],vi=[0,0],xi=!1;$e||(Jn?(vi=[At.x+dn+dt[0],At.y+dt[1]-ln],xi=!0):di=[At.x+dn+xe[0],At.y+xe[1]-ln]);const Pi=ii.w*At.scale/(bn*(At.localGlyph?2:1)),dr=ii.h*At.scale/(bn*(At.localGlyph?2:1));let Qn,Qi,Zi,jn;if(Jn){const ri=At.y-rn,Vi=new Y(-dn,dn-ri),kr=-Math.PI/2,fr=new Y(...vi);Qn=new Y(-dn+di[0],di[1]),Qn._rotateAround(kr,Vi)._add(fr),Qn.x+=-ri+dn,Qn.y-=(Pn.left-Mn)*At.scale;const pr=At.imageName?Pn.advance*At.scale:Er*At.scale,Nr=String.fromCharCode(At.glyph);CA(Nr)?Qn.x+=(1-Mn)*At.scale:IA(Nr)?Qn.x+=pr-Pn.height*At.scale+(-Mn-1)*At.scale:Qn.x+=At.imageName||Pn.width+2*Mn===ii.w&&Pn.height+2*Mn===ii.h?(pr-dr)/2:(pr-(Pn.height+2*Mn)*At.scale)/2,Qi=new Y(Qn.x,Qn.y-Pi),Zi=new Y(Qn.x+dr,Qn.y),jn=new Y(Qn.x+dr,Qn.y-Pi)}else{const ri=(Pn.left-Mn)*At.scale-dn+di[0],Vi=(-Pn.top-Mn)*At.scale+di[1],kr=ri+Pi,fr=Vi+dr;Qn=new Y(ri,Vi),Qi=new Y(kr,Vi),Zi=new Y(ri,fr),jn=new Y(kr,fr)}if(ot){let ri;ri=$e?new Y(0,0):xi?new Y(dt[0],dt[1]):new Y(xe[0],xe[1]),Qn._rotateAround(ot,ri),Qi._rotateAround(ot,ri),Zi._rotateAround(ot,ri),jn._rotateAround(ot,ri)}const Ei=new Y(0,0),ir=new Y(0,0);it.push({tl:Qn,tr:Qi,bl:Zi,br:jn,tex:an,writingMode:Te.writingMode,glyphOffset:gi,sectionIndex:At.sectionIndex,isSDF:En,pixelOffsetTL:Ei,pixelOffsetBR:ir,minFontScaleX:0,minFontScaleY:0})}}return it}(0,l,S,p,v,x,h,n.allowVerticalPlacement),ye=n.textSizeData;let re=null;ye.kind==="source"?(re=[Is*p.layout.get("text-size").evaluate(x,{},X)],re[0]>Qa&&he(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ye.kind==="composite"&&(re=[Is*$.compositeTextSizes[0].evaluate(x,{},X),Is*$.compositeTextSizes[1].evaluate(x,{},X)],(re[0]>Qa||re[1]>Qa)&&he(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,le,re,S,v,x,k,t,i,T.lineStartIndex,T.lineLength,V,G,X);for(const ge of z)R[ge]=n.text.placedSymbolArray.length-1;return 4*le.length}function K1(n){for(const t in n)return n[t];return null}function Am(n,t,i,l,h,p,v,x,S,T){let k=v.top,z=v.bottom,R=v.left,V=v.right;const $=v.collisionPadding;if($&&(R-=$[0],k-=$[1],V+=$[2],z+=$[3]),S){const G=new Y(R,k),X=new Y(V,k),le=new Y(R,z),ye=new Y(V,z),re=Ee(S);let ge=new Y(0,0);T&&(ge=new Y(T[0],T[1])),G._rotateAround(re,ge),X._rotateAround(re,ge),le._rotateAround(re,ge),ye._rotateAround(re,ge),R=Math.min(G.x,X.x,le.x,ye.x),V=Math.max(G.x,X.x,le.x,ye.x),k=Math.min(G.y,X.y,le.y,ye.y),z=Math.max(G.y,X.y,le.y,ye.y)}return n.emplaceBack(t.x,t.y,t.z,i.x,i.y,R,k,V,z,x,l,h,p),n.length-1}function r_(n){n.collisionPadding&&(n.top-=n.collisionPadding[1],n.bottom+=n.collisionPadding[3]);const t=n.bottom-n.top;return t>0?Math.max(10,t):null}function QA(n,t,i,l){const h=n.compareText;if(t in h){const p=h[t];for(let v=p.length-1;v>=0;v--)if(l.dist(p[v])<i)return!0}else h[t]=[];return h[t].push(l),!1}function J1(n,t){const i=n.fovAboveCenter,l=n.elevation?n.elevation.getMinElevationBelowMSL()*t:0,h=(n._camera.position[2]*n.worldSize-l)/Math.cos(n._pitch),p=Math.sin(i)*h/Math.sin(Math.max(Math.PI/2-n._pitch-i,.01)),v=Math.sin(n._pitch)*p+h;return Math.min(1.01*v,h*(1/n._horizonShift))}function hc(n,t){if(!t.isReprojectedInTileSpace)return{scale:1<<n.z,x:n.x,y:n.y,x2:n.x+1,y2:n.y+1,projection:t};const i=Math.pow(2,-n.z),l=n.x*i,h=(n.x+1)*i,p=n.y*i,v=(n.y+1)*i,x=ho(l),S=ho(h),T=wr(p),k=wr(v),z=t.project(x,T),R=t.project(S,T),V=t.project(S,k),$=t.project(x,k);let G=Math.min(z.x,R.x,V.x,$.x),X=Math.min(z.y,R.y,V.y,$.y),le=Math.max(z.x,R.x,V.x,$.x),ye=Math.max(z.y,R.y,V.y,$.y);const re=i/16;function ge(xe,je,$e,tt,vt,We){const it=($e+vt)/2,ot=(tt+We)/2,dt=t.project(ho(it),wr(ot)),_t=Math.max(0,G-dt.x,X-dt.y,dt.x-le,dt.y-ye);G=Math.min(G,dt.x),le=Math.max(le,dt.x),X=Math.min(X,dt.y),ye=Math.max(ye,dt.y),_t>re&&(ge(xe,dt,$e,tt,it,ot),ge(dt,je,it,ot,vt,We))}ge(z,R,l,p,h,p),ge(R,V,h,p,h,v),ge(V,$,h,v,l,v),ge($,z,l,v,l,p),G-=re,X-=re,le+=re,ye+=re;const Te=1/Math.max(le-G,ye-X);return{scale:Te,x:G*Te,y:X*Te,x2:le*Te,y2:ye*Te,projection:t}}const ek=Qo(new Float32Array(16));class el{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,i){return{x:0,y:0,z:0}}unproject(t,i){return new Nn(0,0)}projectTilePoint(t,i,l){return{x:t,y:i,z:0}}locationPoint(t,i,l=!0){return t._coordinatePoint(t.locationCoordinate(i),l)}pixelsPerMeter(t,i){return ts(1,t)*i}pixelSpaceConversion(t,i,l){return 1}farthestPixelDistance(t){return J1(t,t.pixelsPerMeter)}pointCoordinate(t,i,l,h){const p=t.horizonLineFromTop(!1),v=new Y(i,Math.max(p,l));return t.rayIntersectionCoordinate(t.pointRayIntersection(v,h))}pointCoordinate3D(t,i,l){const h=new Y(i,l);if(t.elevation)return t.elevation.pointCoordinate(h);{const p=this.pointCoordinate(t,h.x,h.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(t,i){if(t.elevation)return!this.pointCoordinate3D(t,i.x,i.y);const l=t.horizonLineFromTop();return i.y<l}createInversionMatrix(t,i){return ek}createTileMatrix(t,i,l){let h,p,v;const x=l.canonical,S=Qo(new Float64Array(16));if(this.isReprojectedInTileSpace){const T=hc(x,this);h=1,p=T.x+l.wrap*T.scale,v=T.y,rc(S,S,[h/T.scale,h/T.scale,t.pixelsPerMeter/i])}else h=i/t.zoomScale(x.z),p=(x.x+Math.pow(2,x.z)*l.wrap)*h,v=x.y*h;return xd(S,S,[p,v,0]),rc(S,S,[h/hn,h/hn,1]),S}upVector(t,i,l){return[0,0,1]}upVectorScale(t,i,l){return{metersToTile:1}}}class tk extends el{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[i,l]=this.parallels=t.parallels||[29.5,45.5],h=Math.sin(Ee(i));this.n=(h+Math.sin(Ee(l)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(t,i){const{n:l,c:h,r0:p}=this,v=Ee(t-this.center[0]),x=Ee(i),S=Math.sqrt(h-2*l*Math.sin(x))/l;return{x:S*Math.sin(v*l),y:S*Math.cos(v*l)-p,z:0}}unproject(t,i){const{n:l,c:h,r0:p}=this,v=p+i;let x=Math.atan2(t,Math.abs(v))*Math.sign(v);v*l<0&&(x-=Math.PI*Math.sign(t)*Math.sign(v));const S=Ee(this.center[0])*l;x=Pe(x,-Math.PI-S,Math.PI-S);const T=nt(be(x/l)+this.center[0],-180,180),k=Math.asin(nt((h-(t*t+v*v)*l*l)/(2*l),-1,1)),z=nt(be(k),-Sr,Sr);return new Nn(T,z)}}const Gd=1.340264,qd=-.081106,Zd=893e-6,Wd=.003796,km=Math.sqrt(3)/2;class nk extends el{project(t,i){i=i/180*Math.PI,t=t/180*Math.PI;const l=Math.asin(km*Math.sin(i)),h=l*l,p=h*h*h;return{x:.5*(t*Math.cos(l)/(km*(Gd+3*qd*h+p*(7*Zd+9*Wd*h)))/Math.PI+.5),y:1-.5*(l*(Gd+qd*h+p*(Zd+Wd*h))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let l=i=(2*(1-i)-1)*Math.PI,h=l*l,p=h*h*h;for(let k,z,R,V=0;V<12&&(z=l*(Gd+qd*h+p*(Zd+Wd*h))-i,R=Gd+3*qd*h+p*(7*Zd+9*Wd*h),k=z/R,l=nt(l-k,-Math.PI/3,Math.PI/3),h=l*l,p=h*h*h,!(Math.abs(k)<1e-12));++V);const v=km*t*(Gd+3*qd*h+p*(7*Zd+9*Wd*h))/Math.cos(l),x=Math.asin(Math.sin(l)/km),S=nt(180*v/Math.PI,-180,180),T=nt(180*x/Math.PI,-Sr,Sr);return new Nn(S,T)}}class ik extends el{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){return{x:.5+t/360,y:.5-i/360,z:0}}unproject(t,i){const l=360*(t-.5),h=nt(360*(.5-i),-Sr,Sr);return new Nn(l,h)}}const Wu=Math.PI/2;function Mm(n){return Math.tan((Wu+n)/2)}class rk extends el{constructor(t){super(t),this.center=t.center||[0,30];const[i,l]=this.parallels=t.parallels||[30,30];let h=Ee(i),p=Ee(l);this.southernCenter=h+p<0,this.southernCenter&&(h=-h,p=-p);const v=Math.cos(h),x=Mm(h);this.n=h===p?Math.sin(h):Math.log(v/Math.cos(p))/Math.log(Mm(p)/x),this.f=v*Math.pow(Mm(h),this.n)/this.n}project(t,i){i=Ee(i),this.southernCenter&&(i=-i),t=Ee(t-this.center[0]);const l=1e-6,{n:h,f:p}=this;p>0?i<-Wu+l&&(i=-Wu+l):i>Wu-l&&(i=Wu-l);const v=p/Math.pow(Mm(i),h);let x=v*Math.sin(h*t),S=p-v*Math.cos(h*t);return x=.5*(x/Math.PI+.5),S=.5*(S/Math.PI+.5),{x,y:this.southernCenter?S:1-S,z:0}}unproject(t,i){t=(2*t-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:l,f:h}=this,p=h-i,v=Math.sign(p),x=Math.sign(l)*Math.sqrt(t*t+p*p);let S=Math.atan2(t,Math.abs(p))*v;p*l<0&&(S-=Math.PI*Math.sign(t)*v);const T=nt(be(S/l)+this.center[0],-180,180),k=nt(be(2*Math.atan(Math.pow(h/x,1/l))-Wu),-Sr,Sr);return new Nn(T,this.southernCenter?-k:k)}}class Q1 extends el{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,i){return{x:Ts(t),y:Cs(i),z:0}}unproject(t,i){const l=ho(t),h=wr(i);return new Nn(l,h)}}const eb=Ee(Sr);class ok extends el{project(t,i){const l=(i=Ee(i))*i,h=l*l;return{x:.5*((t=Ee(t))*(.8707-.131979*l+h*(h*(.003971*l-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+l*(.015085+h*(.028874*l-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let l=i=(2*(1-i)-1)*Math.PI,h=25,p=0,v=l*l;do{v=l*l;const T=v*v;p=(l*(1.007226+v*(.015085+T*(.028874*v-.044475-.005916*T)))-i)/(1.007226+v*(.045255+T*(.259866*v-.311325-.005916*11*T))),l=nt(l-p,-eb,eb)}while(Math.abs(p)>1e-6&&--h>0);v=l*l;const x=nt(be(t/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),S=be(l);return new Nn(x,S)}}const tb=Ee(Sr);class sk extends el{project(t,i){i=Ee(i),t=Ee(t);const l=Math.cos(i),h=2/Math.PI,p=Math.acos(l*Math.cos(t/2)),v=Math.sin(p)/p,x=.5*(t*h+2*l*Math.sin(t/2)/v)||0,S=.5*(i+Math.sin(i)/v)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(S/Math.PI+1),z:0}}unproject(t,i){let l=t=(2*t-.5)*Math.PI,h=i=(2*(1-i)-1)*Math.PI,p=25;const v=1e-6;let x=0,S=0;do{const T=Math.cos(h),k=Math.sin(h),z=2*k*T,R=k*k,V=T*T,$=Math.cos(l/2),G=Math.sin(l/2),X=2*$*G,le=G*G,ye=1-V*$*$,re=ye?1/ye:0,ge=ye?Math.acos(T*$)*Math.sqrt(1/ye):0,Te=.5*(2*ge*T*G+2*l/Math.PI)-t,xe=.5*(ge*k+h)-i,je=.5*re*(V*le+ge*T*$*R)+1/Math.PI,$e=re*(X*z/4-ge*k*G),tt=.125*re*(z*G-ge*k*V*X),vt=.5*re*(R*$+ge*le*T)+.5,We=$e*tt-vt*je;x=(xe*$e-Te*vt)/We,S=(Te*tt-xe*je)/We,l=nt(l-x,-Math.PI,Math.PI),h=nt(h-S,-tb,tb)}while((Math.abs(x)>v||Math.abs(S)>v)&&--p>0);return new Nn(be(l),be(h))}}class nb extends el{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ee(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){const{scale:l,cosPhi:h}=this;return{x:Ee(t)*h*l+.5,y:-Math.sin(Ee(i))/h*l+.5,z:0}}unproject(t,i){const{scale:l,cosPhi:h}=this,p=-(i-.5)/l,v=nt(be((t-.5)/l)/h,-180,180),x=Math.asin(nt(p*h,-1,1)),S=nt(be(x),-Sr,Sr);return new Nn(v,S)}}class ak extends Q1{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,i,l){const h=Ad(t,i,l);return Fi(h,h,kd(Es(l))),{x:h[0],y:h[1],z:h[2]}}locationPoint(t,i){const l=Lu(i.lat,i.lng),h=Fr([],l),p=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(i),t._centerAltitude):t._centerAltitude;Ed(l,l,h,ts(1,0)*hn*p);const v=Qo(new Float64Array(16));return ic(v,t.pixelMatrix,t.globeMatrix),Fi(l,l,v),new Y(l[0],l[1])}pixelsPerMeter(t,i){return ts(1,0)*i}pixelSpaceConversion(t,i,l){const h=ts(1,t)*i,p=$n(ts(1,45)*i,h,l);return this.pixelsPerMeter(t,i)/p}createTileMatrix(t,i,l){const h=Pv(Es(l.canonical));return ic(new Float64Array(16),t.globeMatrix,h)}createInversionMatrix(t,i){const{center:l}=t,h=kd(Es(i));return om(h,h,Ee(l.lng)),wv(h,h,Ee(l.lat)),rc(h,h,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(t,i,l,h){return zx(t,i,l,!0)||new Du(0,0)}pointCoordinate3D(t,i,l){const h=this.pointCoordinate(t,i,l,0);return[h.x,h.y,h.z]}isPointAboveHorizon(t,i){return!zx(t,i.x,i.y,!1)}farthestPixelDistance(t){const i=function(h,p){const v=h.cameraToCenterDistance,x=h._centerAltitude*p,S=h._camera,T=h._camera.forward(),k=oa([],uo([],T,-v),[0,0,x]),z=h.worldSize/(2*Math.PI),R=[0,0,-z],V=h.width/h.height,$=Math.tan(h.fovAboveCenter),G=uo([],S.up(),$),X=uo([],S.right(),$*V),le=Fr([],oa([],oa([],T,G),X)),ye=[];let re;if(new Cv(k,le).closestPointOnSphere(R,z,ye)){const ge=oa([],ye,R),Te=es([],ge,k);re=Math.cos(h.fovAboveCenter)*bd(Te)}else{const ge=es([],k,R),Te=es([],R,k);Fr(Te,Te);const xe=bd(ge)-z;re=Math.sqrt(xe*(xe+2*z));const je=Math.acos(re/(z+xe))-Math.acos(Eo(T,Te));re*=Math.cos(je)}return 1.01*re}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),l=Ru(t.zoom);if(l>0){const h=J1(t,ts(1,t.center.lat)*t.worldSize),p=t.worldSize/(2*Math.PI),v=Math.max(t.width,t.height)/t.worldSize*Math.PI;return $n(i,h+p*(1-Math.cos(v)),Math.pow(l,10))}return i}upVector(t,i,l){return Ad(i,l,t,1)}upVectorScale(t){return{metersToTile:sm(lm(Es(t)))}}}function ib(n){const t=n.parallels,i=!!t&&Math.abs(t[0]+t[1])<.01;switch(n.name){case"mercator":return new Q1(n);case"equirectangular":return new ik(n);case"naturalEarth":return new ok(n);case"equalEarth":return new nk(n);case"winkelTripel":return new sk(n);case"albers":return i?new nb(n):new tk(n);case"lambertConformalConic":return i?new nb(n):new rk(n);case"globe":return new ak(n)}throw new Error(`Invalid projection name: ${n.name}`)}const lk=_m.types,ck=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Pm(n,t,i,l,h,p,v,x,S,T,k,z,R){const V=x?Math.min(Qa,Math.round(x[0])):0,$=x?Math.min(Qa,Math.round(x[1])):0;n.emplaceBack(t,i,Math.round(32*l),Math.round(32*h),p,v,(V<<1)+(S?1:0),$,16*T,16*k,256*z,256*R)}function zm(n,t,i,l,h,p,v){n.emplaceBack(t,i,l,h,p,v)}function Lm(n,t,i,l,h){n.emplaceBack(t,i,l,h),n.emplaceBack(t,i,l,h),n.emplaceBack(t,i,l,h),n.emplaceBack(t,i,l,h)}function uk(n){for(const t of n.sections)if(j(t.text))return!0;return!1}class o_{constructor(t){this.layoutVertexArray=new Xo,this.indexArray=new br,this.programConfigurations=t,this.segments=new Gi,this.dynamicLayoutVertexArray=new oi,this.opacityVertexArray=new si,this.placedSymbolArray=new rx,this.globeExtVertexArray=new yi}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,i,l,h){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,_A.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,xA.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,ck,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,yA.members,!0)),this.opacityVertexBuffer.itemSize=1),(l||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Nt(o_,"SymbolBuffers");class s_{constructor(t,i,l){this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new l,this.segments=new Gi,this.collisionVertexArray=new mi,this.collisionVertexArrayExt=new xr}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,bA.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,wA.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Nt(s_,"CollisionBuffers");class tl{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(v=>v.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Qo([]),this.placementViewportMatrix=Qo([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Xv(this.zoom,i["text-size"]),this.iconSizeData=Xv(this.zoom,i["icon-size"]);const l=this.layers[0].layout,h=l.get("symbol-sort-key"),p=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=l.get("text-writing-mode").map(v=>fo[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=t.sourceID,this.projection=t.projection}createArrays(){this.text=new o_(new nc(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new o_(new nc(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ax,this.lineVertexArray=new lx,this.symbolInstances=new sx}calculateGlyphDependencies(t,i,l,h,p){for(let v=0;v<t.length;v++)if(i[t.charCodeAt(v)]=!0,h&&p){const x=$d[t.charAt(v)];x&&(i[x.charCodeAt(0)]=!0)}}populate(t,i,l,h){const p=this.layers[0],v=p.layout,x=this.projection.name==="globe",S=v.get("text-font"),T=v.get("text-field"),k=v.get("icon-image"),z=(T.value.kind!=="constant"||T.value.value instanceof Br&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),R=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,V=v.get("symbol-sort-key");if(this.features=[],!z&&!R)return;const $=i.iconDependencies,G=i.glyphDependencies,X=i.availableImages,le=new Be(this.zoom);for(const{feature:ye,id:re,index:ge,sourceLayerIndex:Te}of t){const xe=p._featureFilter.needGeometry,je=lc(ye,xe);if(!p._featureFilter.filter(le,je,l))continue;if(xe||(je.geometry=sa(ye,l,h)),x&&ye.type!==1&&l.z<=5){const We=je.geometry,it=.98078528056,ot=(dt,_t)=>Eo(Ad(dt.x,dt.y,l,1),Ad(_t.x,_t.y,l,1))<it;for(let dt=0;dt<We.length;dt++)We[dt]=xI(We[dt],ot)}let $e,tt;if(z){const We=p.getValueAndResolveTokens("text-field",je,l,X),it=Br.factory(We);uk(it)&&(this.hasRTLText=!0),(!this.hasRTLText||Ce()==="unavailable"||this.hasRTLText&&Ae.isParsed())&&($e=TA(it,p,je))}if(R){const We=p.getValueAndResolveTokens("icon-image",je,l,X);tt=We instanceof Ar?We:Ar.fromString(We)}if(!$e&&!tt)continue;const vt=this.sortFeaturesByKey?V.evaluate(je,{},l):void 0;if(this.features.push({id:re,text:$e,icon:tt,index:ge,sourceLayerIndex:Te,geometry:je.geometry,properties:ye.properties,type:lk[ye.type],sortKey:vt}),tt&&($[tt.name]=!0),$e){const We=S.evaluate(je,{},l).join(","),it=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(fo.vertical)>=0;for(const ot of $e.sections)if(ot.image)$[ot.image.name]=!0;else{const dt=y($e.toString()),_t=ot.fontStack||We,Ye=G[_t]=G[_t]||{};this.calculateGlyphDependencies(ot.text,Ye,it,this.allowVerticalPlacement,dt)}}}v.get("symbol-placement")==="line"&&(this.features=function(ye){const re={},ge={},Te=[];let xe=0;function je(We){Te.push(ye[We]),xe++}function $e(We,it,ot){const dt=ge[We];return delete ge[We],ge[it]=dt,Te[dt].geometry[0].pop(),Te[dt].geometry[0]=Te[dt].geometry[0].concat(ot[0]),dt}function tt(We,it,ot){const dt=re[it];return delete re[it],re[We]=dt,Te[dt].geometry[0].shift(),Te[dt].geometry[0]=ot[0].concat(Te[dt].geometry[0]),dt}function vt(We,it,ot){const dt=ot?it[0][it[0].length-1]:it[0][0];return`${We}:${dt.x}:${dt.y}`}for(let We=0;We<ye.length;We++){const it=ye[We],ot=it.geometry,dt=it.text?it.text.toString():null;if(!dt){je(We);continue}const _t=vt(dt,ot),Ye=vt(dt,ot,!0);if(_t in ge&&Ye in re&&ge[_t]!==re[Ye]){const It=tt(_t,Ye,ot),rn=$e(_t,Ye,Te[It].geometry);delete re[_t],delete ge[Ye],ge[vt(dt,Te[rn].geometry,!0)]=rn,Te[It].geometry=null}else _t in ge?$e(_t,Ye,ot):Ye in re?tt(_t,Ye,ot):(je(We),re[_t]=xe-1,ge[Ye]=xe-1)}return Te.filter(We=>We.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ye,re)=>ye.sortKey-re.sortKey)}update(t,i,l,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,i,this.layers,l,h),this.icon.programConfigurations.updatePaintArrays(t,i,this.layers,l,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=ib(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,i){const l=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:h,y:p}of i)this.lineVertexArray.emplaceBack(h,p);return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,i,l,h,p,v,x,S,T,k,z,R,V,$){const G=t.indexArray,X=t.layoutVertexArray,le=t.globeExtVertexArray,ye=t.segments.prepareSegment(4*i.length,X,G,this.canOverlap?v.sortKey:void 0),re=this.glyphOffsetArray.length,ge=ye.vertexLength,Te=this.allowVerticalPlacement&&x===fo.vertical?Math.PI/2:0,xe=v.text&&v.text.sections;for(let $e=0;$e<i.length;$e++){const{tl:tt,tr:vt,bl:We,br:it,tex:ot,pixelOffsetTL:dt,pixelOffsetBR:_t,minFontScaleX:Ye,minFontScaleY:It,glyphOffset:rn,isSDF:Dt,sectionIndex:Zt}=i[$e],At=ye.vertexLength,an=rn[1];if(Pm(X,T.x,T.y,tt.x,an+tt.y,ot.x,ot.y,l,Dt,dt.x,dt.y,Ye,It),Pm(X,T.x,T.y,vt.x,an+vt.y,ot.x+ot.w,ot.y,l,Dt,_t.x,dt.y,Ye,It),Pm(X,T.x,T.y,We.x,an+We.y,ot.x,ot.y+ot.h,l,Dt,dt.x,_t.y,Ye,It),Pm(X,T.x,T.y,it.x,an+it.y,ot.x+ot.w,ot.y+ot.h,l,Dt,_t.x,_t.y,Ye,It),S){const{x:Mn,y:En,z:bn}=S.anchor,[ln,Jn,dn]=S.up;zm(le,Mn,En,bn,ln,Jn,dn),zm(le,Mn,En,bn,ln,Jn,dn),zm(le,Mn,En,bn,ln,Jn,dn),zm(le,Mn,En,bn,ln,Jn,dn),Lm(t.dynamicLayoutVertexArray,Mn,En,bn,Te)}else Lm(t.dynamicLayoutVertexArray,T.x,T.y,T.z,Te);G.emplaceBack(At,At+1,At+2),G.emplaceBack(At+1,At+2,At+3),ye.vertexLength+=4,ye.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(rn[0]),$e!==i.length-1&&Zt===i[$e+1].sectionIndex||t.programConfigurations.populatePaintArrays(X.length,v,v.index,{},V,$,xe&&xe[Zt])}const je=S?S.anchor:T;t.placedSymbolArray.emplaceBack(je.x,je.y,je.z,T.x,T.y,re,this.glyphOffsetArray.length-re,ge,k,z,T.segment,l?l[0]:0,l?l[1]:0,h[0],h[1],x,0,!1,0,R,0)}_commitLayoutVertex(t,i,l,h,p,v,x){t.emplaceBack(i,l,h,p,v,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(t,i,l,h,p,v,x){const S=l.segments.prepareSegment(4,l.layoutVertexArray,l.indexArray),T=S.vertexLength,k=x.tileAnchorX,z=x.tileAnchorY;for(let V=0;V<4;V++)l.collisionVertexArray.emplaceBack(0,0,0,0);l.collisionVertexArrayExt.emplaceBack(i,-t.padding,-t.padding),l.collisionVertexArrayExt.emplaceBack(i,t.padding,-t.padding),l.collisionVertexArrayExt.emplaceBack(i,t.padding,t.padding),l.collisionVertexArrayExt.emplaceBack(i,-t.padding,t.padding),this._commitLayoutVertex(l.layoutVertexArray,h,p,v,k,z,new Y(t.x1,t.y1)),this._commitLayoutVertex(l.layoutVertexArray,h,p,v,k,z,new Y(t.x2,t.y1)),this._commitLayoutVertex(l.layoutVertexArray,h,p,v,k,z,new Y(t.x2,t.y2)),this._commitLayoutVertex(l.layoutVertexArray,h,p,v,k,z,new Y(t.x1,t.y2)),S.vertexLength+=4;const R=l.indexArray;R.emplaceBack(T,T+1),R.emplaceBack(T+1,T+2),R.emplaceBack(T+2,T+3),R.emplaceBack(T+3,T),S.primitiveLength+=4}_addTextDebugCollisionBoxes(t,i,l,h,p,v){for(let x=h;x<p;x++){const S=l.get(x),T=this.getSymbolInstanceTextSize(t,v,i,x);this._addCollisionDebugVertices(S,T,this.textCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(t,i,l,h,p,v){for(let x=h;x<p;x++){const S=l.get(x),T=this.getSymbolInstanceIconSize(t,i,v.placedIconSymbolIndex);this._addCollisionDebugVertices(S,T,this.iconCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,v)}}generateCollisionDebugBuffers(t,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new s_(Mi,T1.members,bs),this.iconCollisionBox=new s_(Mi,T1.members,bs);const l=Nu(this.iconSizeData,t),h=Nu(this.textSizeData,t);for(let p=0;p<this.symbolInstances.length;p++){const v=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(h,t,i,v.textBoxStartIndex,v.textBoxEndIndex,v),this._addTextDebugCollisionBoxes(h,t,i,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._addIconDebugCollisionBoxes(l,t,i,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._addIconDebugCollisionBoxes(l,t,i,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}}getSymbolInstanceTextSize(t,i,l,h){const p=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:h),v=wm(this.textSizeData,t,p)/Er;return this.tilePixelRatio*v}getSymbolInstanceIconSize(t,i,l){const h=this.icon.placedSymbolArray.get(l),p=wm(this.iconSizeData,t,h);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(t,i,l){t.emplaceBack(i,-l,-l),t.emplaceBack(i,l,-l),t.emplaceBack(i,l,l),t.emplaceBack(i,-l,l)}_updateTextDebugCollisionBoxes(t,i,l,h,p,v){for(let x=h;x<p;x++){const S=l.get(x),T=this.getSymbolInstanceTextSize(t,v,i,x);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,T,S.padding)}}_updateIconDebugCollisionBoxes(t,i,l,h,p,v){for(let x=h;x<p;x++){const S=l.get(x),T=this.getSymbolInstanceIconSize(t,i,v);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,T,S.padding)}}updateCollisionDebugBuffers(t,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const l=Nu(this.iconSizeData,t),h=Nu(this.textSizeData,t);for(let p=0;p<this.symbolInstances.length;p++){const v=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(h,t,i,v.textBoxStartIndex,v.textBoxEndIndex,v),this._updateTextDebugCollisionBoxes(h,t,i,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._updateIconDebugCollisionBoxes(l,t,i,v.iconBoxStartIndex,v.iconBoxEndIndex,v.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(l,t,i,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,i,l,h,p,v,x,S,T){const k={};if(i<l){const{x1:z,y1:R,x2:V,y2:$,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge,featureIndex:Te}=t.get(i);k.textBox={x1:z,y1:R,x2:V,y2:$,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge},k.textFeatureIndex=Te}if(h<p){const{x1:z,y1:R,x2:V,y2:$,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge,featureIndex:Te}=t.get(h);k.verticalTextBox={x1:z,y1:R,x2:V,y2:$,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge},k.verticalTextFeatureIndex=Te}if(v<x){const{x1:z,y1:R,x2:V,y2:$,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge,featureIndex:Te}=t.get(v);k.iconBox={x1:z,y1:R,x2:V,y2:$,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge},k.iconFeatureIndex=Te}if(S<T){const{x1:z,y1:R,x2:V,y2:$,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge,featureIndex:Te}=t.get(S);k.verticalIconBox={x1:z,y1:R,x2:V,y2:$,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge},k.verticalIconFeatureIndex=Te}return k}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const l=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,i){const l=t.placedSymbolArray.get(i),h=l.vertexStartIndex+4*l.numGlyphs;for(let p=l.vertexStartIndex;p<h;p+=4)t.indexArray.emplaceBack(p,p+1,p+2),t.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(t),l=Math.cos(t),h=[],p=[],v=[];for(let x=0;x<this.symbolInstances.length;++x){v.push(x);const S=this.symbolInstances.get(x);h.push(0|Math.round(i*S.tileAnchorX+l*S.tileAnchorY)),p.push(S.featureIndex)}return v.sort((x,S)=>h[x]-h[S]||p[S]-p[x]),v}addToSortKeyRanges(t,i){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===i?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const l=this.symbolInstances.get(i);this.featureSortOrder.push(l.featureIndex);const{rightJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:p,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:S,verticalPlacedIconSymbolIndex:T}=l;h>=0&&this.addIndicesForPlacedSymbol(this.text,h),p>=0&&p!==h&&this.addIndicesForPlacedSymbol(this.text,p),v>=0&&v!==p&&v!==h&&this.addIndicesForPlacedSymbol(this.text,v),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),S>=0&&this.addIndicesForPlacedSymbol(this.icon,S),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Nt(tl,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),tl.MAX_GLYPHS=65535,tl.addDynamicAttributes=Lm;const hk=new mt({"symbol-placement":new Le(et.layout_symbol["symbol-placement"]),"symbol-spacing":new Le(et.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Le(et.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ze(et.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Le(et.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Le(et.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Le(et.layout_symbol["icon-ignore-placement"]),"icon-optional":new Le(et.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Le(et.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ze(et.layout_symbol["icon-size"]),"icon-text-fit":new Le(et.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Le(et.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ze(et.layout_symbol["icon-image"]),"icon-rotate":new Ze(et.layout_symbol["icon-rotate"]),"icon-padding":new Le(et.layout_symbol["icon-padding"]),"icon-keep-upright":new Le(et.layout_symbol["icon-keep-upright"]),"icon-offset":new Ze(et.layout_symbol["icon-offset"]),"icon-anchor":new Ze(et.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Le(et.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Le(et.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Le(et.layout_symbol["text-rotation-alignment"]),"text-field":new Ze(et.layout_symbol["text-field"]),"text-font":new Ze(et.layout_symbol["text-font"]),"text-size":new Ze(et.layout_symbol["text-size"]),"text-max-width":new Ze(et.layout_symbol["text-max-width"]),"text-line-height":new Ze(et.layout_symbol["text-line-height"]),"text-letter-spacing":new Ze(et.layout_symbol["text-letter-spacing"]),"text-justify":new Ze(et.layout_symbol["text-justify"]),"text-radial-offset":new Ze(et.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Le(et.layout_symbol["text-variable-anchor"]),"text-anchor":new Ze(et.layout_symbol["text-anchor"]),"text-max-angle":new Le(et.layout_symbol["text-max-angle"]),"text-writing-mode":new Le(et.layout_symbol["text-writing-mode"]),"text-rotate":new Ze(et.layout_symbol["text-rotate"]),"text-padding":new Le(et.layout_symbol["text-padding"]),"text-keep-upright":new Le(et.layout_symbol["text-keep-upright"]),"text-transform":new Ze(et.layout_symbol["text-transform"]),"text-offset":new Ze(et.layout_symbol["text-offset"]),"text-allow-overlap":new Le(et.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Le(et.layout_symbol["text-ignore-placement"]),"text-optional":new Le(et.layout_symbol["text-optional"])});var a_={paint:new mt({"icon-opacity":new Ze(et.paint_symbol["icon-opacity"]),"icon-color":new Ze(et.paint_symbol["icon-color"]),"icon-halo-color":new Ze(et.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ze(et.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ze(et.paint_symbol["icon-halo-blur"]),"icon-translate":new Le(et.paint_symbol["icon-translate"]),"icon-translate-anchor":new Le(et.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ze(et.paint_symbol["text-opacity"]),"text-color":new Ze(et.paint_symbol["text-color"],{runtimeType:bo,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new Ze(et.paint_symbol["text-halo-color"]),"text-halo-width":new Ze(et.paint_symbol["text-halo-width"]),"text-halo-blur":new Ze(et.paint_symbol["text-halo-blur"]),"text-translate":new Le(et.paint_symbol["text-translate"]),"text-translate-anchor":new Le(et.paint_symbol["text-translate-anchor"])}),layout:hk};class rb{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:ka,this.defaultValue=t}evaluate(t){if(t.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(t.formattedSection))return i.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Nt(rb,"FormatSectionOverride",{omit:["defaultValue"]});class Rm extends Jo{constructor(t){super(t,a_)}recalculate(t,i){super.recalculate(t,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const l=this.layout.get("text-writing-mode");if(l){const h=[];for(const p of l)h.indexOf(p)<0&&h.push(p);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,i,l,h){const p=this.layout.get(t).evaluate(i,{},l,h),v=this._unevaluatedLayout._values[t];return v.isDataDriven()||Na(v.value)||!p?p:function(x,S){return S.replace(/{([^{}]+)}/g,(T,k)=>k in x?String(x[k]):"")}(i.properties,p)}createBucket(t){return new tl(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of a_.paint.overridableProperties){if(!Rm.hasPaintOverride(this.layout,t))continue;const i=this.paint.get(t),l=new rb(i),h=new gu(l,i.property.specification);let p=null;p=i.value.kind==="constant"||i.value.kind==="source"?new vu("source",h):new ta("composite",h,i.value.zoomStops,i.value._interpolationType),this.paint._values[t]=new ht(i.property,p,i.parameters)}}_handleOverridablePaintPropertyUpdate(t,i,l){return!(!this.layout||i.isDataDriven()||l.isDataDriven())&&Rm.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,i){const l=t.get("text-field"),h=a_.paint.properties[i];let p=!1;const v=x=>{for(const S of x)if(h.overrides&&h.overrides.hasOverride(S))return void(p=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Br)v(l.value.value.sections);else if(l.value.kind==="source"){const x=T=>{p||(T instanceof kl&&Ji(T.value)===Ma?v(T.value.sections):T instanceof Ml?v(T.sections):T.eachChild(x))},S=l.value;S._styleExpression&&x(S._styleExpression.expression)}return p}getProgramConfiguration(t){return new Ka(this,t)}}var dk={paint:new mt({"background-color":new Le(et.paint_background["background-color"]),"background-pattern":new Le(et.paint_background["background-pattern"]),"background-opacity":new Le(et.paint_background["background-opacity"])})},fk={paint:new mt({"raster-opacity":new Le(et.paint_raster["raster-opacity"]),"raster-hue-rotate":new Le(et.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Le(et.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Le(et.paint_raster["raster-brightness-max"]),"raster-saturation":new Le(et.paint_raster["raster-saturation"]),"raster-contrast":new Le(et.paint_raster["raster-contrast"]),"raster-resampling":new Le(et.paint_raster["raster-resampling"]),"raster-fade-duration":new Le(et.paint_raster["raster-fade-duration"])})};class pk extends Jo{constructor(t){super(t,{}),this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var mk={paint:new mt({"sky-type":new Le(et.paint_sky["sky-type"]),"sky-atmosphere-sun":new Le(et.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Le(et.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Le(et.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Le(et.paint_sky["sky-gradient-radius"]),"sky-gradient":new lt(et.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Le(et.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Le(et.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Le(et.paint_sky["sky-opacity"])})};function l_(n,t,i){const l=[0,0,1],h=Ix([]);return kx(h,h,i?-Ee(n)+Math.PI:Ee(n)),Ax(h,h,-Ee(t)),Sx(l,l,h),Fr(l,l)}const gk={circle:class extends Jo{constructor(n){super(n,II)}createBucket(n){return new Ov(n)}queryRadius(n){const t=n;return Bu("circle-radius",this,t)+Bu("circle-stroke-width",this,t)+hm(this.paint.get("circle-translate"))}queryIntersectsFeature(n,t,i,l,h,p,v,x){const S=Yx(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,n.pixelToTileUnitsFactor),T=this.paint.get("circle-radius").evaluate(t,i)+this.paint.get("circle-stroke-width").evaluate(t,i);return Kx(n,l,p,v,x,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",S,T)}getProgramIds(){return["circle"]}getProgramConfiguration(n){return new Ka(this,n)}},heatmap:class extends Jo{createBucket(n){return new Qx(n)}constructor(n){super(n,PI),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Nv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(n){return Bu("heatmap-radius",this,n)}queryIntersectsFeature(n,t,i,l,h,p,v,x){const S=this.paint.get("heatmap-radius").evaluate(t,i);return Kx(n,l,p,v,x,!0,!0,new Y(0,0),S)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(n){return new Ka(this,n)}},hillshade:class extends Jo{constructor(n){super(n,zI)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Jo{constructor(n){super(n,HI)}getProgramIds(){const n=this.paint.get("fill-pattern"),t=n&&n.constantOr(1),i=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(n){return new Ka(this,n)}recalculate(n,t){super.recalculate(n,t);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new gm(n)}queryRadius(){return hm(this.paint.get("fill-translate"))}queryIntersectsFeature(n,t,i,l,h,p){return!n.queryGeometry.isAboveHorizon&&qx(Xx(n.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,n.pixelToTileUnitsFactor),l)}isTileClipped(){return!0}},"fill-extrusion":class extends Jo{constructor(n){super(n,uA)}createBucket(n){return new Od(n)}queryRadius(){return hm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(n){return new Ka(this,n)}queryIntersectsFeature(n,t,i,l,h,p,v,x,S){const T=Yx(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,n.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(t,i),z=this.paint.get("fill-extrusion-base").evaluate(t,i),R=[0,0],V=x&&p.elevation,$=p.elevation?p.elevation.exaggeration():1,G=n.tile.getBucket(this);if(V&&G instanceof Od){const ge=G.centroidVertexArray,Te=S+1;Te<ge.length&&(R[0]=ge.geta_centroid_pos0(Te),R[1]=ge.geta_centroid_pos1(Te))}if(R[0]===0&&R[1]===1)return!1;p.projection.name==="globe"&&(l=v1([l],[new Y(0,0),new Y(hn,hn)],n.tileID.canonical).map(ge=>ge.polygon).flat());const X=V?x:null,[le,ye]=function(ge,Te,xe,je,$e,tt,vt,We,it,ot,dt){return ge.projection.name==="globe"?function(_t,Ye,It,rn,Dt,Zt,At,an,Mn,En,bn){const ln=[],Jn=[],dn=_t.projection.upVectorScale(bn,_t.center.lat,_t.worldSize).metersToTile,Pn=[0,0,0,1],ii=[0,0,0,1],gi=(vi,xi,Pi,dr)=>{vi[0]=xi,vi[1]=Pi,vi[2]=dr,vi[3]=1},di=g1();It>0&&(It+=di),rn+=di;for(const vi of Ye){const xi=[],Pi=[];for(const dr of vi){const Qn=dr.x+Dt.x,Qi=dr.y+Dt.y,Zi=_t.projection.projectTilePoint(Qn,Qi,bn),jn=_t.projection.upVector(bn,dr.x,dr.y);let Ei=It,ir=rn;if(At){const ri=b1(Qn,Qi,It,rn,At,an,Mn,En);Ei+=ri.base,ir+=ri.top}It!==0?gi(Pn,Zi.x+jn[0]*dn*Ei,Zi.y+jn[1]*dn*Ei,Zi.z+jn[2]*dn*Ei):gi(Pn,Zi.x,Zi.y,Zi.z),gi(ii,Zi.x+jn[0]*dn*ir,Zi.y+jn[1]*dn*ir,Zi.z+jn[2]*dn*ir),Fi(Pn,Pn,Zt),Fi(ii,ii,Zt),xi.push(new $u(Pn[0],Pn[1],Pn[2])),Pi.push(new $u(ii[0],ii[1],ii[2]))}ln.push(xi),Jn.push(Pi)}return[ln,Jn]}(ge,Te,xe,je,$e,tt,vt,We,it,ot,dt):vt?function(_t,Ye,It,rn,Dt,Zt,At,an,Mn){const En=[],bn=[],ln=[0,0,0,1];for(const Jn of _t){const dn=[],Pn=[];for(const ii of Jn){const gi=ii.x+rn.x,di=ii.y+rn.y,vi=b1(gi,di,Ye,It,Zt,At,an,Mn);ln[0]=gi,ln[1]=di,ln[2]=vi.base,ln[3]=1,oc(ln,ln,Dt),ln[3]=Math.max(ln[3],1e-5);const xi=new $u(ln[0]/ln[3],ln[1]/ln[3],ln[2]/ln[3]);ln[0]=gi,ln[1]=di,ln[2]=vi.top,ln[3]=1,oc(ln,ln,Dt),ln[3]=Math.max(ln[3],1e-5);const Pi=new $u(ln[0]/ln[3],ln[1]/ln[3],ln[2]/ln[3]);dn.push(xi),Pn.push(Pi)}En.push(dn),bn.push(Pn)}return[En,bn]}(Te,xe,je,$e,tt,vt,We,it,ot):function(_t,Ye,It,rn,Dt){const Zt=[],At=[],an=Dt[8]*Ye,Mn=Dt[9]*Ye,En=Dt[10]*Ye,bn=Dt[11]*Ye,ln=Dt[8]*It,Jn=Dt[9]*It,dn=Dt[10]*It,Pn=Dt[11]*It;for(const ii of _t){const gi=[],di=[];for(const vi of ii){const xi=vi.x+rn.x,Pi=vi.y+rn.y,dr=Dt[0]*xi+Dt[4]*Pi+Dt[12],Qn=Dt[1]*xi+Dt[5]*Pi+Dt[13],Qi=Dt[2]*xi+Dt[6]*Pi+Dt[14],Zi=Dt[3]*xi+Dt[7]*Pi+Dt[15],jn=dr+an,Ei=Qn+Mn,ir=Qi+En,ri=Math.max(Zi+bn,1e-5),Vi=dr+ln,kr=Qn+Jn,fr=Qi+dn,pr=Math.max(Zi+Pn,1e-5);gi.push(new $u(jn/ri,Ei/ri,ir/ri)),di.push(new $u(Vi/pr,kr/pr,fr/pr))}Zt.push(gi),At.push(di)}return[Zt,At]}(Te,xe,je,$e,tt)}(p,l,z,k,T,v,X,R,$,p.center.lat,n.tileID.canonical),re=n.queryGeometry;return function(ge,Te,xe){let je=1/0;qx(xe,Te)&&(je=x1(xe,Te[0]));for(let $e=0;$e<Te.length;$e++){const tt=Te[$e],vt=ge[$e];for(let We=0;We<tt.length-1;We++){const it=tt[We],ot=[it,tt[We+1],vt[We+1],vt[We],it];Gx(xe,ot)&&(je=Math.min(je,x1(xe,ot)))}}return je!==1/0&&je}(le,ye,re.isPointQuery()?re.screenBounds:re.screenGeometry)}},line:class extends Jo{constructor(n){super(n,w1),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof jh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(n,t){super.recalculate(n,t),this.paint._values["line-floorwidth"]=S1.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new bm(n)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(n){return new Ka(this,n)}queryRadius(n){const t=n,i=E1(Bu("line-width",this,t),Bu("line-gap-width",this,t)),l=Bu("line-offset",this,t);return i/2+Math.abs(l)+hm(this.paint.get("line-translate"))}queryIntersectsFeature(n,t,i,l,h,p){if(n.queryGeometry.isAboveHorizon)return!1;const v=Xx(n.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,n.pixelToTileUnitsFactor),x=n.pixelToTileUnitsFactor/2*E1(this.paint.get("line-width").evaluate(t,i),this.paint.get("line-gap-width").evaluate(t,i)),S=this.paint.get("line-offset").evaluate(t,i);return S&&(l=function(T,k){const z=[],R=new Y(0,0);for(let V=0;V<T.length;V++){const $=T[V],G=[];for(let X=0;X<$.length;X++){const le=$[X-1],ye=$[X],re=$[X+1],ge=X===0?R:ye.sub(le)._unit()._perp(),Te=X===$.length-1?R:re.sub(ye)._unit()._perp(),xe=ge._add(Te)._unit();xe._mult(1/(xe.x*Te.x+xe.y*Te.y)),G.push(xe._mult(k)._add(ye))}z.push(G)}return z}(l,S*n.pixelToTileUnitsFactor)),function(T,k,z){for(let R=0;R<k.length;R++){const V=k[R];if(T.length>=3){for(let $=0;$<V.length;$++)if(cc(T,V[$]))return!0}if(SI(T,V,z))return!0}return!1}(v,l,x)}isTileClipped(){return!0}},symbol:Rm,background:class extends Jo{constructor(n){super(n,dk)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Jo{constructor(n){super(n,fk)}getProgramIds(){return["raster"]}},sky:class extends Jo{constructor(n){super(n,mk),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="sky-gradient"?this._updateColorRamp():n!=="sky-atmosphere-sun"&&n!=="sky-atmosphere-halo-color"&&n!=="sky-atmosphere-color"&&n!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Nv({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(n){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=n.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(n,t){if(this.paint.get("sky-type")==="atmosphere"){const l=this.paint.get("sky-atmosphere-sun"),h=!l,p=n.style.light,v=p.properties.get("position");return h&&p.properties.get("anchor")==="viewport"&&he("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?l_(v.azimuthal,90-v.polar,t):l_(l[0],90-l[1],t)}const i=this.paint.get("sky-gradient-center");return l_(i[0],90-i[1],t)}is3D(){return!1}isSky(){return!0}markSkyboxValid(n){this._skyboxInvalidated=!1,this._lightPosition=n.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const n=this.paint.get("sky-type");return n==="atmosphere"?["skyboxCapture","skybox"]:n==="gradient"?["skyboxGradient"]:null}}};class Hd{constructor(t,i,l,h){this.context=t,this.format=l,this.texture=t.gl.createTexture(),this.update(i,h)}update(t,i,l){const{width:h,height:p}=t,{context:v}=this,{gl:x}=v,{HTMLImageElement:S,HTMLCanvasElement:T,HTMLVideoElement:k,ImageData:z,ImageBitmap:R}=w;if(x.bindTexture(x.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA&&(!i||i.premultiply!==!1)),l||this.size&&this.size[0]===h&&this.size[1]===p){const{x:V,y:$}=l||{x:0,y:0};t instanceof S||t instanceof T||t instanceof k||t instanceof z||R&&t instanceof R?x.texSubImage2D(x.TEXTURE_2D,0,V,$,x.RGBA,x.UNSIGNED_BYTE,t):x.texSubImage2D(x.TEXTURE_2D,0,V,$,h,p,x.RGBA,x.UNSIGNED_BYTE,t.data)}else this.size=[h,p],t instanceof S||t instanceof T||t instanceof k||t instanceof z||R&&t instanceof R?x.texImage2D(x.TEXTURE_2D,0,this.format,this.format,x.UNSIGNED_BYTE,t):x.texImage2D(x.TEXTURE_2D,0,this.format,h,p,0,this.format,x.UNSIGNED_BYTE,t.data);this.useMipmap=Boolean(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(t,i){const{context:l}=this,{gl:h}=l;h.bindTexture(h.TEXTURE_2D,this.texture),t!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,t),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?t===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:t),this.filter=t),i!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,i),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class vk{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class _k{constructor(){this.tasks={},this.taskQueue=[],bt(["process"],this),this.invoker=new vk(this.process),this.nextId=0}add(t,i){const l=this.nextId++,h=function({type:p,isSymbolTile:v,zoom:x}){return x=x||0,p==="message"?0:p!=="maybePrepare"||v?p!=="parseTile"||v?p==="parseTile"&&v?300-x:p==="maybePrepare"&&v?400-x:500:200-x:100-x}(i);if(h===0){st();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[l]={fn:t,metadata:i,priority:h,id:l},this.taskQueue.push(l),this.invoker.trigger(),{cancel:()=>{delete this.tasks[l]}}}process(){st();try{if(this.taskQueue=this.taskQueue.filter(l=>!!this.tasks[l]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const i=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let t=null,i=1/0;for(let h=0;h<this.taskQueue.length;h++){const p=this.tasks[this.taskQueue[h]];p.priority<i&&(i=p.priority,t=h)}if(t===null)return null;const l=this.taskQueue[t];return this.taskQueue.splice(t,1),l}remove(){this.invoker.remove()}}class ob{constructor(t){this._stringToNumber={},this._numberToString=[];for(let i=0;i<t.length;i++){const l=t[i];this._stringToNumber[l]=i,this._numberToString[i]=l}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const yk=["tile","layer","source","sourceLayer","state"];class sb{constructor(t,i,l,h,p){this.type="Feature",this._vectorTileFeature=t,this._z=i,this._x=l,this._y=h,this.properties=t.properties,this.id=p}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const i of yk)this[i]!==void 0&&(t[i]=this[i]);return t}}const Io=32,As=33,nl=new Uint16Array(8184);for(let n=0;n<2046;n++){let t=n+2,i=0,l=0,h=0,p=0,v=0,x=0;for(1&t?h=p=v=Io:i=l=x=Io;(t>>=1)>1;){const T=i+h>>1,k=l+p>>1;1&t?(h=i,p=l,i=v,l=x):(i=h,l=p,h=v,p=x),v=T,x=k}const S=4*n;nl[S+0]=i,nl[S+1]=l,nl[S+2]=h,nl[S+3]=p}const ks=new Uint16Array(2178),il=new Uint8Array(1089),Dm=new Uint16Array(1089);function ab(n){return n===0?-.03125:n===32?.03125:0}var lb=Xt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const cb={type:2,extent:hn,loadGeometry:()=>[[new Y(0,0),new Y(8193,0),new Y(8193,8193),new Y(0,8193),new Y(0,0)]]};class c_{constructor(t,i,l,h,p){this.tileID=t,this.uid=qt(),this.uses=0,this.tileSize=i,this.tileZoom=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=p,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(t){const i=t+this.timeAdded;i<Zn.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=hc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,i,l){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(h,p){const v={};if(!p)return v;for(const x of h){const S=x.layerIds.map(T=>p.getLayer(T)).filter(Boolean);if(S.length!==0){x.layers=S,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(T=>S.filter(k=>k.id===T)[0]));for(const T of S)v[T.id]=x}}return v}(t.buckets,i.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const p=this.buckets[h];if(p instanceof tl){if(this.hasSymbolBuckets=!0,!l)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const p=this.buckets[h];if(p instanceof tl&&p.hasRTLText){this.hasRTLText=!0,Ae.isLoading()||Ae.isLoaded()||Ce()!=="deferred"||we();break}}this.queryPadding=0;for(const h in this.buckets){const p=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(h).queryRadius(p))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas)}else this.collisionBoxArray=new gv}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.id]}upload(t){for(const l in this.buckets){const h=this.buckets[l];h.uploadPending()&&h.upload(t)}const i=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Hd(t,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Hd(t,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Hd(t,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,i,l,h,p,v,x,S){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:x,transform:v,params:p,tileTransform:this.tileTransform},t,i,l):{}}querySourceFeatures(t,i){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const h=l.loadVTLayers(),p=i?i.sourceLayer:"",v=h._geojsonTileLayer||h[p];if(!v)return;const x=yu(i&&i.filter),{z:S,x:T,y:k}=this.tileID.canonical,z={z:S,x:T,y:k};for(let R=0;R<v.length;R++){const V=v.feature(R);if(x.needGeometry){const X=lc(V,!0);if(!x.filter(new Be(this.tileID.overscaledZ),X,this.tileID.canonical))continue}else if(!x.filter(new Be(this.tileID.overscaledZ),V))continue;const $=l.getId(V,p),G=new sb(V,S,T,k,$);G.tile=z,t.push(G)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const i=this.expirationTime;if(t.cacheControl){const l=yt(t.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const l=Date.now();let h=!1;if(this.expirationTime>l)h=!1;else if(i)if(this.expirationTime<i)h=!0;else{const p=this.expirationTime-i;p?this.expirationTime=l+Math.max(p,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0||!i)return;const l=this.latestFeatureIndex.loadVTLayers(),h=i.style.listImages();for(const p in this.buckets){if(!i.style.hasLayer(p))continue;const v=this.buckets[p],x=v.layers[0].sourceLayer||"_geojsonTileLayer",S=l[x],T=t[x];if(!S||!T||Object.keys(T).length===0)continue;if(v.update(T,S,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),v instanceof bm||v instanceof gm){const z=i.style._getSourceCache(v.layers[0].source);i._terrain&&i._terrain.enabled&&z&&v.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(z.id,this.tileID)}const k=i&&i.style&&i.style.getLayer(p);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Zn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Zn.now()+t}setTexture(t,i){const l=i.context,h=l.gl;this.texture=this.texture||i.getTileTexture(t.width),this.texture?this.texture.update(t,{useMipmap:!0}):(this.texture=new Hd(l,t,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),l.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax))}setDependencies(t,i){const l={};for(const h of i)l[h]=!0;this.dependencies[t]=l}hasDependency(t,i){for(const l of t){const h=this.dependencies[l];if(h){for(const p of i)if(h[p])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,i){if(!i||i.name==="mercator"||this._tileDebugBuffer)return;const l=sa(cb,this.tileID.canonical,this.tileTransform)[0],h=new en,p=new ws;for(let v=0;v<l.length;v++){const{x,y:S}=l[v];h.emplaceBack(x,S),p.emplaceBack(v)}p.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(p),this._tileDebugBuffer=t.createVertexBuffer(h,Cd.members),this._tileDebugSegments=Gi.simpleSegment(0,0,h.length,p.length)}_makeTileBoundsBuffers(t,i){if(this._tileBoundsBuffer||!i||i.name==="mercator")return;const l=sa(cb,this.tileID.canonical,this.tileTransform)[0];let h,p;if(this.isRaster){const v=function(x,S){const T=hc(x,S),k=Math.pow(2,x.z);for(let X=0;X<As;X++)for(let le=0;le<As;le++){const ye=ho((x.x+(le+ab(le))/Io)/k),re=wr((x.y+(X+ab(X))/Io)/k),ge=S.project(ye,re),Te=X*As+le;ks[2*Te+0]=Math.round((ge.x*T.scale-T.x)*hn),ks[2*Te+1]=Math.round((ge.y*T.scale-T.y)*hn)}il.fill(0),Dm.fill(0);for(let X=2045;X>=0;X--){const le=4*X,ye=nl[le+0],re=nl[le+1],ge=nl[le+2],Te=nl[le+3],xe=ye+ge>>1,je=re+Te>>1,$e=xe+je-re,tt=je+ye-xe,vt=re*As+ye,We=Te*As+ge,it=je*As+xe,ot=Math.hypot((ks[2*vt+0]+ks[2*We+0])/2-ks[2*it+0],(ks[2*vt+1]+ks[2*We+1])/2-ks[2*it+1])>=16;if(il[it]=il[it]||(ot?1:0),X<1022){const dt=(re+tt>>1)*As+(ye+$e>>1),_t=(Te+tt>>1)*As+(ge+$e>>1);il[it]=il[it]||il[dt]||il[_t]}}const z=new ni,R=new br;let V=0;function $(X,le){const ye=le*As+X;return Dm[ye]===0&&(z.emplaceBack(ks[2*ye+0],ks[2*ye+1],X*hn/Io,le*hn/Io),Dm[ye]=++V),Dm[ye]-1}function G(X,le,ye,re,ge,Te){const xe=X+ye>>1,je=le+re>>1;if(Math.abs(X-ge)+Math.abs(le-Te)>1&&il[je*As+xe])G(ge,Te,X,le,xe,je),G(ye,re,ge,Te,xe,je);else{const $e=$(X,le),tt=$(ye,re),vt=$(ge,Te);R.emplaceBack($e,tt,vt)}}return G(0,0,Io,Io,Io,0),G(Io,Io,0,0,0,Io),{vertices:z,indices:R}}(this.tileID.canonical,i);h=v.vertices,p=v.indices}else{h=new ni,p=new br;for(const{x,y:S}of l)h.emplaceBack(x,S,0,0);const v=Ou(h.int16,void 0,4);for(let x=0;x<v.length;x+=3)p.emplaceBack(v[x],v[x+1],v[x+2])}this._tileBoundsBuffer=t.createVertexBuffer(h,lb.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(p),this._tileBoundsSegments=Gi.simpleSegment(0,0,h.length,p.length)}_makeGlobeTileDebugBuffers(t,i){const l=i.projection;if(!l||l.name!=="globe"||i.freezeTileCoverage)return;const h=this.tileID.canonical,p=kd(Lx(h,i)),v=Ru(i.zoom);let x;v>0&&(x=bv(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,h,i,p,x,v),this._makeGlobeTileDebugTextBuffer(t,h,i,p,x,v)}_globePoint(t,i,l,h,p,v,x){let S=Ad(t,i,l);if(v){const T=1<<l.z,k=Ts(h.center.lng),z=Cs(h.center.lat),R=(l.x+.5)/T-k;let V=0;R>.5?V=-1:R<-.5&&(V=1);let $=(t/hn+l.x)/T+V,G=(i/hn+l.y)/T;$=($-k)*h._pixelsPerMercatorPixel+k,G=(G-z)*h._pixelsPerMercatorPixel+z;const X=[$*h.worldSize,G*h.worldSize,0];Fi(X,X,v),S=ac(S,X,x)}return Fi(S,S,p)}_makeGlobeTileDebugBorderBuffer(t,i,l,h,p,v){const x=new en,S=new ws,T=new Hn,k=(R,V,$,G,X)=>{const le=($-R)/(X-1),ye=(G-V)/(X-1),re=x.length;for(let ge=0;ge<X;ge++){const Te=R+ge*le,xe=V+ge*ye;x.emplaceBack(Te,xe);const je=this._globePoint(Te,xe,i,l,h,p,v);T.emplaceBack(je[0],je[1],je[2]),S.emplaceBack(re+ge)}},z=hn;k(0,0,z,0,16),k(z,0,z,z,16),k(z,z,0,z,16),k(0,z,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(S),this._tileDebugBuffer=t.createVertexBuffer(x,Cd.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(T,Px.members),this._tileDebugSegments=Gi.simpleSegment(0,0,x.length,S.length)}_makeGlobeTileDebugTextBuffer(t,i,l,h,p,v){const x=new en,S=new br,T=new Hn,k=25;S.reserve(32),x.reserve(k),T.reserve(k);const z=(R,V)=>k*R+V;for(let R=0;R<k;R++){const V=2048*R;for(let $=0;$<k;$++){const G=2048*$;x.emplaceBack(G,V);const X=this._globePoint(G,V,i,l,h,p,v);T.emplaceBack(X[0],X[1],X[2])}}for(let R=0;R<4;R++)for(let V=0;V<4;V++){const $=z(R,V),G=z(R,V+1),X=z(R+1,V),le=z(R+1,V+1);S.emplaceBack($,G,X),S.emplaceBack(X,G,le)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(S),this._tileDebugTextBuffer=t.createVertexBuffer(x,Cd.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(T,Px.members),this._tileDebugTextSegments=Gi.simpleSegment(0,0,k,32)}}class xk{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,i,l){const h=String(i);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][h]=this.stateChanges[t][h]||{},pt(this.stateChanges[t][h],l),this.deletedStates[t]===null){this.deletedStates[t]={};for(const p in this.state[t])p!==h&&(this.deletedStates[t][p]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][h]===null){this.deletedStates[t][h]={};for(const p in this.state[t][h])l[p]||(this.deletedStates[t][h][p]=null)}else for(const p in l)this.deletedStates[t]&&this.deletedStates[t][h]&&this.deletedStates[t][h][p]===null&&delete this.deletedStates[t][h][p]}removeFeatureState(t,i,l){if(this.deletedStates[t]===null)return;const h=String(i);if(this.deletedStates[t]=this.deletedStates[t]||{},l&&i!==void 0)this.deletedStates[t][h]!==null&&(this.deletedStates[t][h]=this.deletedStates[t][h]||{},this.deletedStates[t][h][l]=null);else if(i!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][h])for(l in this.deletedStates[t][h]={},this.stateChanges[t][h])this.deletedStates[t][h][l]=null;else this.deletedStates[t][h]=null;else this.deletedStates[t]=null}getState(t,i){const l=String(i),h=pt({},(this.state[t]||{})[l],(this.stateChanges[t]||{})[l]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const p=this.deletedStates[t][i];if(p===null)return{};for(const v in p)delete h[v]}return h}initializeTileState(t,i){t.setFeatureState(this.state,i)}coalesceChanges(t,i){const l={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const p={};for(const v in this.stateChanges[h])this.state[h][v]||(this.state[h][v]={}),pt(this.state[h][v],this.stateChanges[h][v]),p[v]=this.state[h][v];l[h]=p}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const p={};if(this.deletedStates[h]===null)for(const v in this.state[h])p[v]={},this.state[h][v]={};else for(const v in this.deletedStates[h]){if(this.deletedStates[h][v]===null)this.state[h][v]={};else if(this.state[h][v])for(const x of Object.keys(this.deletedStates[h][v]))delete this.state[h][v][x];p[v]=this.state[h][v]}l[h]=l[h]||{},pt(l[h],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const h in t)t[h].setFeatureState(l,i)}}class ub{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,i){const l=this.toIdx(t,i);return{min:this.minimums[l],max:this.maximums[l]}}isLeaf(t,i){return this.leaves[this.toIdx(t,i)]}toIdx(t,i){return i*this.size+t}}function hb(n,t,i,l){let h=0,p=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(l[v])<1e-15){if(i[v]<n[v]||i[v]>t[v])return null}else{const x=1/l[v];let S=(n[v]-i[v])*x,T=(t[v]-i[v])*x;if(S>T){const k=S;S=T,T=k}if(S>h&&(h=S),T<p&&(p=T),h>p)return null}return h}function db(n,t,i,l,h,p,v,x,S,T,k){const z=l-n,R=h-t,V=p-i,$=v-n,G=x-t,X=S-i,le=k[1]*X-k[2]*G,ye=k[2]*$-k[0]*X,re=k[0]*G-k[1]*$,ge=z*le+R*ye+V*re;if(Math.abs(ge)<1e-15)return null;const Te=1/ge,xe=T[0]-n,je=T[1]-t,$e=T[2]-i,tt=(xe*le+je*ye+$e*re)*Te;if(tt<0||tt>1)return null;const vt=je*V-$e*R,We=$e*z-xe*V,it=xe*R-je*z,ot=(k[0]*vt+k[1]*We+k[2]*it)*Te;return ot<0||tt+ot>1?null:($*vt+G*We+X*it)*Te}function fb(n,t,i){return(n-t)/(i-t)}function pb(n,t,i,l,h,p,v,x,S){const T=1<<i,k=p-l,z=v-h,R=(n+1)/T*k+l,V=(t+0)/T*z+h,$=(t+1)/T*z+h;x[0]=(n+0)/T*k+l,x[1]=V,S[0]=R,S[1]=$}class mb{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(p){const v=Math.ceil(Math.log2(p.dim/8)),x=[];let S=Math.ceil(Math.pow(2,v));const T=1/S,k=(V,$,G,X,le)=>{const ye=X?1:0,re=(V+1)*G-ye,ge=$*G,Te=($+1)*G-ye;le[0]=V*G,le[1]=ge,le[2]=re,le[3]=Te};let z=new ub(S);const R=[];for(let V=0;V<S*S;V++){k(V%S,Math.floor(V/S),T,!1,R);const $=rl(R[0],R[1],p),G=rl(R[2],R[1],p),X=rl(R[2],R[3],p),le=rl(R[0],R[3],p);z.minimums.push(Math.min($,G,X,le)),z.maximums.push(Math.max($,G,X,le)),z.leaves.push(1)}for(x.push(z),S/=2;S>=1;S/=2){const V=x[x.length-1];z=new ub(S);for(let $=0;$<S*S;$++){k($%S,Math.floor($/S),2,!0,R);const G=V.getElevation(R[0],R[1]),X=V.getElevation(R[2],R[1]),le=V.getElevation(R[2],R[3]),ye=V.getElevation(R[0],R[3]),re=V.isLeaf(R[0],R[1]),ge=V.isLeaf(R[2],R[1]),Te=V.isLeaf(R[2],R[3]),xe=V.isLeaf(R[0],R[3]),je=Math.min(G.min,X.min,le.min,ye.min),$e=Math.max(G.max,X.max,le.max,ye.max),tt=re&&ge&&Te&&xe;z.maximums.push($e),z.minimums.push(je),z.leaves.push($e-je<=5&&tt?1:0)}x.push(z)}return x}(this.dem),l=i.length-1,h=i[l];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(i,0,0,l,0)}raycastRoot(t,i,l,h,p,v,x=1){return hb([t,i,-100],[l,h,this.maximums[0]*x],p,v)}raycast(t,i,l,h,p,v,x=1){if(!this.nodeCount)return null;const S=this.raycastRoot(t,i,l,h,p,v,x);if(S==null)return null;const T=[],k=[],z=[],R=[],V=[{idx:0,t:S,nodex:0,nodey:0,depth:0}];for(;V.length>0;){const{idx:$,t:G,nodex:X,nodey:le,depth:ye}=V.pop();if(this.leaves[$]){pb(X,le,ye,t,i,l,h,z,R);const ge=1<<ye,Te=(X+0)/ge,xe=(X+1)/ge,je=(le+0)/ge,$e=(le+1)/ge,tt=rl(Te,je,this.dem)*x,vt=rl(xe,je,this.dem)*x,We=rl(xe,$e,this.dem)*x,it=rl(Te,$e,this.dem)*x,ot=db(z[0],z[1],tt,R[0],z[1],vt,R[0],R[1],We,p,v),dt=db(R[0],R[1],We,z[0],R[1],it,z[0],z[1],tt,p,v),_t=Math.min(ot!==null?ot:Number.MAX_VALUE,dt!==null?dt:Number.MAX_VALUE);if(_t!==Number.MAX_VALUE)return _t;{const Ye=Ed([],p,v,G);if(gb(tt,vt,it,We,fb(Ye[0],z[0],R[0]),fb(Ye[1],z[1],R[1]))>=Ye[2])return G}continue}let re=0;for(let ge=0;ge<this._siblingOffset.length;ge++){pb((X<<1)+this._siblingOffset[ge][0],(le<<1)+this._siblingOffset[ge][1],ye+1,t,i,l,h,z,R),z[2]=-100,R[2]=this.maximums[this.childOffsets[$]+ge]*x;const Te=hb(z,R,p,v);if(Te!=null){const xe=Te;T[ge]=xe;let je=!1;for(let $e=0;$e<re&&!je;$e++)xe>=T[k[$e]]&&(k.splice($e,0,ge),je=!0);je||(k[re]=ge),re++}}for(let ge=0;ge<re;ge++){const Te=k[ge];V.push({idx:this.childOffsets[$]+Te,t:T[Te],nodex:(X<<1)+this._siblingOffset[Te][0],nodey:(le<<1)+this._siblingOffset[Te][1],depth:ye+1})}}return null}_addNode(t,i,l){return this.minimums.push(t),this.maximums.push(i),this.leaves.push(l),this.childOffsets.push(0),this.nodeCount++}_construct(t,i,l,h,p){if(t[h].isLeaf(i,l)===1)return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const v=h-1,x=t[v];let S=0,T=0;for(let k=0;k<this._siblingOffset.length;k++){const z=2*i+this._siblingOffset[k][0],R=2*l+this._siblingOffset[k][1],V=x.getElevation(z,R),$=x.isLeaf(z,R),G=this._addNode(V.min,V.max,$);$&&(S|=1<<k),T||(T=G)}for(let k=0;k<this._siblingOffset.length;k++)S&1<<k||this._construct(t,2*i+this._siblingOffset[k][0],2*l+this._siblingOffset[k][1],v,T+k)}}function gb(n,t,i,l,h,p){return $n($n(n,i,p),$n(t,l,p),h)}function rl(n,t,i){const l=i.dim,h=nt(n*l-.5,0,l-1),p=nt(t*l-.5,0,l-1),v=Math.floor(h),x=Math.floor(p),S=Math.min(v+1,l-1),T=Math.min(x+1,l-1);return gb(i.get(v,x),i.get(S,x),i.get(v,T),i.get(S,T),h-v,p-x)}const vb={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Bm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,i,l,h=!1,p=!1){if(this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return he(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const v=this.dim=i.height-2,x=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=l||"mapbox",this.borderReady=h,!h){for(let S=0;S<v;S++)x[this._idx(-1,S)]=x[this._idx(0,S)],x[this._idx(v,S)]=x[this._idx(v-1,S)],x[this._idx(S,-1)]=x[this._idx(S,0)],x[this._idx(S,v)]=x[this._idx(S,v-1)];x[this._idx(-1,-1)]=x[this._idx(0,0)],x[this._idx(v,-1)]=x[this._idx(v-1,0)],x[this._idx(-1,v)]=x[this._idx(0,v-1)],x[this._idx(v,v)]=x[this._idx(v-1,v-1)],p&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new mb(this)}get(t,i,l=!1){l&&(t=nt(t,-1,this.dim),i=nt(i,-1,this.dim));const h=4*this._idx(t,i);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}static getUnpackVector(t){return vb[t]}get unpackVector(){return vb[this.encoding]}_idx(t,i){if(t<-1||t>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(t+1)}_unpackMapbox(t,i,l){return(256*t*256+256*i+l)/10-1e4}_unpackTerrarium(t,i,l){return 256*t+i+l/256-32768}static pack(t,i){const l=[0,0,0,0],h=Bm.getUnpackVector(i);let p=Math.floor((t+h[3])/h[2]);return l[2]=p%256,p=Math.floor(p/256),l[1]=p%256,p=Math.floor(p/256),l[0]=p,l}getPixels(){return new eo({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,i,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=i*this.dim,p=i*this.dim+this.dim,v=l*this.dim,x=l*this.dim+this.dim;switch(i){case-1:h=p-1;break;case 1:p=h+1}switch(l){case-1:v=x-1;break;case 1:x=v+1}const S=-i*this.dim,T=-l*this.dim;for(let k=v;k<x;k++)for(let z=h;z<p;z++){const R=4*this._idx(z,k),V=4*this._idx(z+S,k+T);this.pixels[R+0]=t.pixels[V+0],this.pixels[R+1]=t.pixels[V+1],this.pixels[R+2]=t.pixels[V+2],this.pixels[R+3]=t.pixels[V+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Nt(Bm,"DEMData"),Nt(mb,"DemMinMaxQuadTree",{omit:["dem"]});class bk{constructor(t,i){this.max=t,this.onRemove=i,this.reset()}reset(){for(const t in this.data)for(const i of this.data[t])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(t,i,l){const h=t.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const p={value:i,timeout:void 0};if(l!==void 0&&(p.timeout=setTimeout(()=>{this.remove(t,p)},l)),this.data[h].push(p),this.order.push(h),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const i=this.data[t].shift();return i.timeout&&clearTimeout(i.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),i.value}getByKey(t){const i=this.data[t];return i?i[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,i){if(!this.has(t))return this;const l=t.wrapped().key,h=i===void 0?0:this.data[l].indexOf(i),p=this.data[l][h];return this.data[l].splice(h,1),p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(p.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(t){const i=[];for(const l in this.data)for(const h of this.data[l])t(h.value)||i.push(h);for(const l of i)this.remove(l.value.tileID,l)}}class Hu{constructor(t,i,l){this.func=t,this.mask=i,this.range=l}}Hu.ReadOnly=!1,Hu.ReadWrite=!0,Hu.disabled=new Hu(519,Hu.ReadOnly,[0,1]);const u_=7680;class h_{constructor(t,i,l,h,p,v){this.test=t,this.ref=i,this.mask=l,this.fail=h,this.depthFail=p,this.pass=v}}h_.disabled=new h_({func:519,mask:0},0,0,u_,u_,u_);class Ms{constructor(t,i,l){this.blendFunction=t,this.blendColor=i,this.mask=l}}Ms.Replace=[1,0],Ms.disabled=new Ms(Ms.Replace,Oi.transparent,[!1,!1,!1,!1]),Ms.unblended=new Ms(Ms.Replace,Oi.transparent,[!0,!0,!0,!0]),Ms.alphaBlended=new Ms([1,771],Oi.transparent,[!0,!0,!0,!0]);const d_=1029,f_=2305;class ns{constructor(t,i,l){this.enable=t,this.mode=i,this.frontFace=l}}ns.disabled=new ns(!1,d_,f_),ns.backCCW=new ns(!0,d_,f_),ns.backCW=new ns(!0,d_,2304),ns.frontCW=new ns(!0,1028,2304),ns.frontCCW=new ns(!0,1028,f_);class dc extends Go{constructor(t,i,l){super(),this.id=t,this._onlySymbols=l,i.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new bk(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new xk,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const i=this._tiles[t];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,i){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,i)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const l=this._tiles[i];l.upload(t),l.prepare(this.map.style.imageManager)}}getIds(){return Gt(this._tiles).map(t=>t.tileID).sort(_b).map(t=>t.key)}getRenderableIds(t){const i=[];for(const l in this._tiles)this._isIdRenderable(+l,t)&&i.push(this._tiles[l]);return t?i.sort((l,h)=>{const p=l.tileID,v=h.tileID,x=new Y(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),S=new Y(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-v.overscaledZ||S.y-x.y||S.x-x.x}).map(l=>l.tileID.key):i.map(l=>l.tileID).sort(_b).map(l=>l.key)}hasRenderableParent(t){const i=this.findLoadedParent(t,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(t,i){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(i||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,i){const l=this._tiles[t];l&&(l.state!=="loading"&&(l.state=i),this._loadTile(l,this._tileLoaded.bind(this,l,t,i)))}_tileLoaded(t,i,l,h){if(h)if(t.state="errored",h.status!==404)this._source.fire(new ps(h,{tile:t}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const p=this.map.painter.terrain;this.update(this.transform,p.getScaledDemTileSize(),!0),p.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=Zn.now(),l==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(i,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new ti("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const i=this.getRenderableIds();for(let h=0;h<i.length;h++){const p=i[h];if(t.neighboringTiles&&t.neighboringTiles[p]){const v=this.getTileByID(p);l(t,v),l(v,t)}}function l(h,p){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let v=p.tileID.canonical.x-h.tileID.canonical.x;const x=p.tileID.canonical.y-h.tileID.canonical.y,S=Math.pow(2,h.tileID.canonical.z),T=p.tileID.key;v===0&&x===0||Math.abs(x)>1||(Math.abs(v)>1&&(Math.abs(v+S)===1?v+=S:Math.abs(v-S)===1&&(v-=S)),p.dem&&h.dem&&(h.dem.backfillBorder(p.dem,v,x),h.neighboringTiles&&h.neighboringTiles[T]&&(h.neighboringTiles[T].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,i,l,h){for(const p in this._tiles){let v=this._tiles[p];if(h[p]||!v.hasData()||v.tileID.overscaledZ<=i||v.tileID.overscaledZ>l)continue;let x=v.tileID;for(;v&&v.tileID.overscaledZ>i+1;){const T=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[T.key],v&&v.hasData()&&(x=T)}let S=x;for(;S.overscaledZ>i;)if(S=S.scaledTo(S.overscaledZ-1),t[S.key]){h[x.key]=x;break}}}findLoadedParent(t,i){if(t.key in this._loadedParentTiles){const l=this._loadedParentTiles[t.key];return l&&l.tileID.overscaledZ>=i?l:null}for(let l=t.overscaledZ-1;l>=i;l--){const h=t.scaledTo(l),p=this._getLoadedTile(h);if(p)return p}}_getLoadedTile(t){const i=this._tiles[t.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,i){i=i||this._source.tileSize;const l=Math.ceil(t.width/i)+1,h=Math.ceil(t.height/i)+1,p=Math.floor(l*h*5),v=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,p):p,x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(x)}handleWrapJump(t){const i=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,i){const l={};for(const h in this._tiles){const p=this._tiles[h];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+i),l[p.tileID.key]=p}this._tiles=l;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(t,i,l){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!l)return;let h;this.updateCacheSize(t,i),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(x=>new $r(x.canonical.z,x.wrap,x.canonical.z,x.canonical.x,x.canonical.y)):(h=t.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!l,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(x=>this._source.hasTile(x)))):h=[];const p=this._updateRetainedTiles(h);if(yb(this._source.type)&&h.length!==0){const x={},S={},T=Object.keys(p);for(const z of T){const R=p[z],V=this._tiles[z];if(!V||V.fadeEndTime&&V.fadeEndTime<=Zn.now())continue;const $=this.findLoadedParent(R,Math.max(R.overscaledZ-dc.maxOverzooming,this._source.minzoom));$&&(this._addTile($.tileID),x[$.tileID.key]=$.tileID),S[z]=R}const k=h[h.length-1].overscaledZ;for(const z in this._tiles){const R=this._tiles[z];if(p[z]||!R.hasData())continue;let V=R.tileID;for(;V.overscaledZ>k;){V=V.scaledTo(V.overscaledZ-1);const $=this._tiles[V.key];if($&&$.hasData()&&S[V.key]){p[z]=R.tileID;break}}}for(const z in x)p[z]||(this._coveredTiles[z]=!0,p[z]=x[z])}for(const x in p)this._tiles[x].clearFadeHold();const v=function(x,S){const T=[];for(const k in x)k in S||T.push(k);return T}(this._tiles,p);for(const x of v){const S=this._tiles[x];S.hasSymbolBuckets&&!S.holdingForFade()?S.setHoldDuration(this.map._fadeDuration):S.hasSymbolBuckets&&!S.symbolFadeFinished()||this._removeTile(+x)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const i={};if(t.length===0)return i;const l={},h=t.reduce((T,k)=>Math.min(T,k.overscaledZ),1/0),p=t[0].overscaledZ,v=Math.max(p-dc.maxOverzooming,this._source.minzoom),x=Math.max(p+dc.maxUnderzooming,this._source.minzoom),S={};for(const T of t){const k=this._addTile(T);i[T.key]=T,k.hasData()||h<this._source.maxzoom&&(S[T.key]=T)}this._retainLoadedChildren(S,h,x,i);for(const T of t){let k=this._tiles[T.key];if(k.hasData())continue;if(T.canonical.z>=this._source.maxzoom){const R=T.children(this._source.maxzoom)[0],V=this.getTile(R);if(V&&V.hasData()){i[R.key]=R;continue}}else{const R=T.children(this._source.maxzoom);if(i[R[0].key]&&i[R[1].key]&&i[R[2].key]&&i[R[3].key])continue}let z=k.wasRequested();for(let R=T.overscaledZ-1;R>=v;--R){const V=T.scaledTo(R);if(l[V.key]||(l[V.key]=!0,k=this.getTile(V),!k&&z&&(k=this._addTile(V)),k&&(i[V.key]=V,z=k.wasRequested(),k.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const i=[];let l,h=this._tiles[t].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){l=this._loadedParentTiles[h.key];break}i.push(h.key);const p=h.scaledTo(h.overscaledZ-1);if(l=this._getLoadedTile(p),l)break;h=p}for(const p of i)this._loadedParentTiles[p]=l}}_addTile(t){let i=this._tiles[t.key];if(i)return i;i=this._cache.getAndRemove(t),i&&(this._setTileReloadTimer(t.key,i),i.tileID=t,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,i)));const l=Boolean(i);if(!l){const h=this.map?this.map.painter:null;i=new c_(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,h,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,t.key,i.state))}return i?(i.uses++,this._tiles[t.key]=i,l||this._source.fire(new ti("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(t,i){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const l=i.getExpiryTimeout();l&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},l))}_removeTile(t){const i=this._tiles[t];i&&(i.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,i,l){const h=[],p=this.transform;if(!p)return h;const v=p.projection.name==="globe",x=Ts(p.center.lng);for(const S in this._tiles){const T=this._tiles[S];if(l&&T.clearQueryDebugViz(),T.holdingForFade())continue;let k;if(v){const z=T.tileID.canonical;if(z.z===0){const R=[Math.abs(nt(x,...Xd(z,-1))-x),Math.abs(nt(x,...Xd(z,1))-x)];k=[0,2*R.indexOf(Math.min(...R))-1]}else{const R=[Math.abs(nt(x,...Xd(z,-1))-x),Math.abs(nt(x,...Xd(z,0))-x),Math.abs(nt(x,...Xd(z,1))-x)];k=[R.indexOf(Math.min(...R))-1]}}else k=[0];for(const z of k){const R=t.containsTile(T,p,i,z);R&&h.push(R)}}return h}getVisibleCoordinates(t){const i=this.getRenderableIds(t).map(l=>this._tiles[l].tileID);for(const l of i)l.projMatrix=this.transform.calculateProjMatrix(l.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(yb(this._source.type))for(const t in this._tiles){const i=this._tiles[t];if(i.fadeEndTime!==void 0&&i.fadeEndTime>=Zn.now())return!0}return!1}setFeatureState(t,i,l){this._state.updateState(t=t||"_geojsonTileLayer",i,l)}removeFeatureState(t,i,l){this._state.removeFeatureState(t=t||"_geojsonTileLayer",i,l)}getFeatureState(t,i){return this._state.getState(t=t||"_geojsonTileLayer",i)}setDependencies(t,i,l){const h=this._tiles[t];h&&h.setDependencies(i,l)}reloadTilesForDependencies(t,i){for(const l in this._tiles)this._tiles[l].hasDependency(t,i)&&this._reloadTile(+l,"reloading");this._cache.filter(l=>!l.hasDependency(t,i))}_preloadTiles(t,i){const l=new Map,h=Array.isArray(t)?t:[t],p=this.map.painter.terrain,v=this.usedForTerrain&&p?p.getScaledDemTileSize():this._source.tileSize;for(const x of h){const S=x.coveringTiles({tileSize:v,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const T of S)l.set(T.key,T);this.usedForTerrain&&x.updateElevation(!1)}at(Array.from(l.values()),(x,S)=>{const T=new c_(x,this._source.tileSize*x.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(T,k=>{this._source.type==="raster-dem"&&T.dem&&this._backfillDEM(T),S(k,T)})},i)}}function _b(n,t){const i=Math.abs(2*n.wrap)-+(n.wrap<0),l=Math.abs(2*t.wrap)-+(t.wrap<0);return n.overscaledZ-t.overscaledZ||l-i||t.canonical.y-n.canonical.y||t.canonical.x-n.canonical.x}function yb(n){return n==="raster"||n==="image"||n==="video"||n==="custom"}function Xd(n,t){const i=1<<n.z;return[n.x/i+t,(n.x+1)/i+t]}dc.maxOverzooming=10,dc.maxUnderzooming=3;class Om{constructor(t,i,l){this._demTile=t,this._dem=this._demTile.dem,this._scale=i,this._offset=l}static create(t,i,l){const h=l||t.findDEMTileFor(i);if(!h||!h.dem)return;const p=h.dem,v=h.tileID,x=1<<i.canonical.z-v.canonical.z;return new Om(h,h.tileSize/hn/x,[(i.canonical.x/x-v.canonical.x)*p.dim,(i.canonical.y/x-v.canonical.y)*p.dim])}tileCoordToPixel(t,i){const l=i*this._scale+this._offset[1],h=Math.floor(t*this._scale+this._offset[0]),p=Math.floor(l);return new Y(h,p)}getElevationAt(t,i,l,h){const p=t*this._scale+this._offset[0],v=i*this._scale+this._offset[1],x=Math.floor(p),S=Math.floor(v),T=this._dem;return h=!!h,l?$n($n(T.get(x,S,h),T.get(x,S+1,h),v-S),$n(T.get(x+1,S,h),T.get(x+1,S+1,h),v-S),p-x):T.get(x,S,h)}getElevationAtPixel(t,i,l){return this._dem.get(t,i,!!l)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*ts(1,t)*this._dem.stride}}class xb{constructor(t,i){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Za(hn,16,0),this.featureIndexArray=new ux,this.promoteId=i}insert(t,i,l,h,p,v=0){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,h,p,v);const S=this.grid;for(let T=0;T<i.length;T++){const k=i[T],z=[1/0,1/0,-1/0,-1/0];for(let R=0;R<k.length;R++){const V=k[R];z[0]=Math.min(z[0],V.x),z[1]=Math.min(z[1],V.y),z[2]=Math.max(z[2],V.x),z[3]=Math.max(z[3],V.y)}z[0]<hn&&z[1]<hn&&z[2]>=0&&z[3]>=0&&S.insert(x,z[0],z[1],z[2],z[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Hv(new Nd(this.rawTileData)).layers,this.sourceLayerCoder=new ob(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,i,l,h){this.loadVTLayers();const p=t.params||{},v=yu(p.filter),x=t.tileResult,S=t.transform,T=x.bufferedTilespaceBounds,k=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,($,G,X,le)=>Hx(x.bufferedTilespaceGeometry,$,G,X,le));k.sort(wk);let z=null;S.elevation&&k.length>0&&(z=Om.create(S.elevation,this.tileID));const R={};let V;for(let $=0;$<k.length;$++){const G=k[$];if(G===V)continue;V=G;const X=this.featureIndexArray.get(G);let le=null;this.loadMatchingFeature(R,X,v,p.layers,p.availableImages,i,l,h,(ye,re,ge,Te=0)=>(le||(le=sa(ye,this.tileID.canonical,t.tileTransform)),re.queryIntersectsFeature(x,ye,ge,le,this.z,t.transform,t.pixelPosMatrix,z,Te)))}return R}loadMatchingFeature(t,i,l,h,p,v,x,S,T){const{featureIndex:k,bucketIndex:z,sourceLayerIndex:R,layoutVertexArrayOffset:V}=i,$=this.bucketLayerIDs[z];if(h&&!function(ye,re){for(let ge=0;ge<ye.length;ge++)if(re.indexOf(ye[ge])>=0)return!0;return!1}(h,$))return;const G=this.sourceLayerCoder.decode(R),X=this.vtLayers[G].feature(k);if(l.needGeometry){const ye=lc(X,!0);if(!l.filter(new Be(this.tileID.overscaledZ),ye,this.tileID.canonical))return}else if(!l.filter(new Be(this.tileID.overscaledZ),X))return;const le=this.getId(X,G);for(let ye=0;ye<$.length;ye++){const re=$[ye];if(h&&h.indexOf(re)<0)continue;const ge=v[re];if(!ge)continue;let Te={};le!==void 0&&S&&(Te=S.getState(ge.sourceLayer||"_geojsonTileLayer",le));const xe=pt({},x[re]);xe.paint=bb(xe.paint,ge.paint,X,Te,p),xe.layout=bb(xe.layout,ge.layout,X,Te,p);const je=!T||T(X,ge,Te,V);if(!je)continue;const $e=new sb(X,this.z,this.x,this.y,le);$e.layer=xe;let tt=t[re];tt===void 0&&(tt=t[re]=[]),tt.push({featureIndex:k,feature:$e,intersectionZ:je})}}lookupSymbolFeatures(t,i,l,h,p,v,x,S){const T={};this.loadVTLayers();const k=yu(p);for(const z of t)this.loadMatchingFeature(T,{bucketIndex:l,sourceLayerIndex:h,featureIndex:z,layoutVertexArrayOffset:0},k,v,x,S,i);return T}loadFeature(t){const{featureIndex:i,sourceLayerIndex:l}=t;this.loadVTLayers();const h=this.sourceLayerCoder.decode(l),p=this.vtFeatures[h];if(p[i])return p[i];const v=this.vtLayers[h].feature(i);return p[i]=v,v}hasLayer(t){for(const i of this.bucketLayerIDs)for(const l of i)if(t===l)return!0;return!1}getId(t,i){let l=t.id;if(this.promoteId){const h=typeof this.promoteId=="string"?this.promoteId:this.promoteId[i];h!=null&&(l=t.properties[h]),typeof l=="boolean"&&(l=Number(l))}return l}}function bb(n,t,i,l,h){return Ut(n,(p,v)=>{const x=t instanceof Ue?t.get(v):null;return x&&x.evaluate?x.evaluate(i,l,h):x})}function wk(n,t){return t-n}Nt(xb,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class wb{constructor(t,i){this.width=t,this.height=i,this.nextRow=0,this.image=new aa({width:t,height:i}),this.positions={},this.uploaded=!1}getDash(t,i){const l=this.getKey(t,i);return this.positions[l]}trim(){const t=this.width,i=this.height=kt(this.nextRow);this.image.resize({width:t,height:i})}getKey(t,i){return t.join(",")+i}getDashRanges(t,i,l){const h=[];let p=t.length%2==1?-t[t.length-1]*l:0,v=t[0]*l,x=!0;h.push({left:p,right:v,isDash:x,zeroLength:t[0]===0});let S=t[0];for(let T=1;T<t.length;T++){x=!x;const k=t[T];p=S*l,S+=k,v=S*l,h.push({left:p,right:v,isDash:x,zeroLength:k===0})}return h}addRoundDash(t,i,l){const h=i/2;for(let p=-l;p<=l;p++){const v=this.width*(this.nextRow+l+p);let x=0,S=t[x];for(let T=0;T<this.width;T++){T/S.right>1&&(S=t[++x]);const k=Math.abs(T-S.left),z=Math.abs(T-S.right),R=Math.min(k,z);let V;const $=p/l*(h+1);if(S.isDash){const G=h-Math.abs($);V=Math.sqrt(R*R+G*G)}else V=h-Math.sqrt(R*R+$*$);this.image.data[v+T]=Math.max(0,Math.min(255,V+128))}}}addRegularDash(t,i){for(let S=t.length-1;S>=0;--S){const T=t[S],k=t[S+1];T.zeroLength?t.splice(S,1):k&&k.isDash===T.isDash&&(k.left=T.left,t.splice(S,1))}const l=t[0],h=t[t.length-1];l.isDash===h.isDash&&(l.left=h.left-this.width,h.right=l.right+this.width);const p=this.width*this.nextRow;let v=0,x=t[v];for(let S=0;S<this.width;S++){S/x.right>1&&(x=t[++v]);const T=Math.abs(S-x.left),k=Math.abs(S-x.right),z=Math.min(T,k);this.image.data[p+S]=Math.max(0,Math.min(255,(x.isDash?z:-z)+i+128))}}addDash(t,i){const l=this.getKey(t,i);if(this.positions[l])return this.positions[l];const h=i==="round",p=h?7:0,v=2*p+1;if(this.nextRow+v>this.height)return he("LineAtlas out of space"),null;t.length===0&&t.push(1);let x=0;for(let k=0;k<t.length;k++)t[k]<0&&(he("Negative value is found in line dasharray, replacing values with 0"),t[k]=0),x+=t[k];if(x!==0){const k=this.width/x,z=this.getDashRanges(t,this.width,k);h?this.addRoundDash(z,k,p):this.addRegularDash(z,i==="square"?.5*k:0)}const S=this.nextRow+p;this.nextRow+=v;const T={tl:[S,p],br:[x,0]};return this.positions[l]=T,T}}Nt(wb,"LineAtlas");class Sb{constructor(t){const i={},l=[];for(const x in t){const S=t[x],T=i[x]={};for(const k in S.glyphs){const z=S.glyphs[+k];if(!z||z.bitmap.width===0||z.bitmap.height===0)continue;const R=z.metrics.localGlyph?2:1,V={x:0,y:0,w:z.bitmap.width+2*R,h:z.bitmap.height+2*R};l.push(V),T[k]=V}}const{w:h,h:p}=Kv(l),v=new aa({width:h||1,height:p||1});for(const x in t){const S=t[x];for(const T in S.glyphs){const k=S.glyphs[+T];if(!k||k.bitmap.width===0||k.bitmap.height===0)continue;const z=i[x][T],R=k.metrics.localGlyph?2:1;aa.copy(k.bitmap,v,{x:0,y:0},{x:z.x+R,y:z.y+R},k.bitmap)}}this.image=v,this.positions=i}}Nt(Sb,"GlyphAtlas");class Sk{constructor(t){this.tileID=new $r(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile,this.tileTransform=hc(t.tileID.canonical,t.projection),this.projection=t.projection}parse(t,i,l,h,p){this.status="parsing",this.data=t,this.collisionBoxArray=new gv;const v=new ob(Object.keys(t.layers).sort()),x=new xb(this.tileID,this.promoteId);x.bucketLayerIDs=[];const S={},T=new wb(256,256),k={featureIndex:x,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:T,availableImages:l},z=i.familiesBySource[this.source];for(const Te in z){const xe=t.layers[Te];if(!xe)continue;let je=!1,$e=!1;for(const We of z[Te])We[0].type==="symbol"?je=!0:$e=!0;if(this.isSymbolTile===!0&&!je||this.isSymbolTile===!1&&!$e)continue;xe.version===1&&he(`Vector tile source "${this.source}" layer "${Te}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const tt=v.encode(Te),vt=[];for(let We=0;We<xe.length;We++){const it=xe.feature(We),ot=x.getId(it,Te);vt.push({feature:it,id:ot,index:We,sourceLayerIndex:tt})}for(const We of z[Te]){const it=We[0];this.isSymbolTile!==void 0&&it.type==="symbol"!==this.isSymbolTile||it.minzoom&&this.zoom<Math.floor(it.minzoom)||it.maxzoom&&this.zoom>=it.maxzoom||it.visibility!=="none"&&(p_(We,this.zoom,l),(S[it.id]=it.createBucket({index:x.bucketLayerIDs.length,layers:We,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:tt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:l})).populate(vt,k,this.tileID.canonical,this.tileTransform),x.bucketLayerIDs.push(We.map(ot=>ot.id)))}}let R,V,$,G;T.trim();const X={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},le=Ut(k.glyphDependencies,Te=>Object.keys(Te).map(Number));Object.keys(le).length?h.send("getGlyphs",{uid:this.uid,stacks:le},(Te,xe)=>{R||(R=Te,V=xe,ge.call(this))},void 0,!1,X):V={};const ye=Object.keys(k.iconDependencies);ye.length?h.send("getImages",{icons:ye,source:this.source,tileID:this.tileID,type:"icons"},(Te,xe)=>{R||(R=Te,$=xe,ge.call(this))},void 0,!1,X):$={};const re=Object.keys(k.patternDependencies);function ge(){if(R)return p(R);if(V&&$&&G){const Te=new Sb(V),xe=new z1($,G);for(const je in S){const $e=S[je];$e instanceof tl?(p_($e.layers,this.zoom,l),KA($e,V,Te.positions,$,xe.iconPositions,this.showCollisionBoxes,l,this.tileID.canonical,this.tileZoom,this.projection)):$e.hasPattern&&($e instanceof bm||$e instanceof gm||$e instanceof Od)&&(p_($e.layers,this.zoom,l),$e.addFeatures(k,this.tileID.canonical,xe.patternPositions,l,this.tileTransform))}this.status="done",p(null,{buckets:Gt(S).filter(je=>!je.isEmpty()),featureIndex:x,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Te.image,lineAtlas:T,imageAtlas:xe,glyphMap:this.returnDependencies?V:null,iconMap:this.returnDependencies?$:null,glyphPositions:this.returnDependencies?Te.positions:null})}}re.length?h.send("getImages",{icons:re,source:this.source,tileID:this.tileID,type:"patterns"},(Te,xe)=>{R||(R=Te,G=xe,ge.call(this))},void 0,!1,X):G={},ge.call(this)}}function p_(n,t,i){const l=new Be(t);for(const h of n)h.recalculate(l,i)}class Eb{constructor(t){this.entries={},this.scheduler=t}request(t,i,l,h){const p=this.entries[t]=this.entries[t]||{callbacks:[]};if(p.result){const[v,x]=p.result;return this.scheduler?this.scheduler.add(()=>{h(v,x)},i):h(v,x),()=>{}}return p.callbacks.push(h),p.cancel||(p.cancel=l((v,x)=>{p.result=[v,x];for(const S of p.callbacks)this.scheduler?this.scheduler.add(()=>{S(v,x)},i):S(v,x);setTimeout(()=>delete this.entries[t],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(v=>v!==h),p.callbacks.length||(p.cancel(),delete this.entries[t]))}}}function Tb(n,t,i){const l=JSON.stringify(n.request);return n.data&&(this.deduped.entries[l]={result:[null,n.data]}),this.deduped.request(l,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom},h=>{const p=yo(n.request,(v,x,S,T)=>{v?h(v):x&&h(null,{vectorTile:i?void 0:new Hv(new Nd(x)),rawData:x,cacheControl:S,expires:T})});return()=>{p.cancel(),h()}},t)}s.ARRAY_TYPE=Qr,s.AUTH_ERR_MSG=qs,s.Aabb=Vr,s.Actor=class{constructor(n,t,i){this.target=n,this.parent=t,this.mapId=i,this.callbacks={},this.cancelCallbacks={},bt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=st()?n:w,this.scheduler=new _k}send(n,t,i,l,h=!1,p){const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=p,this.callbacks[v]=i);const x=$t(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:n,hasCallback:!!i,targetMapId:l,mustQueue:h,sourceMapId:this.mapId,data:Yl(t,x)},x),{cancel:()=>{i&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}receive(n){const t=n.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){const l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l.cancel()}else if(t.mustQueue||st()){const l=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,t),l&&l.metadata||{type:"message"})}else this.processTask(i,t)}processTask(n,t){if(t.type==="<response>"){const i=this.callbacks[n];delete this.callbacks[n],i&&(t.error?i(Kl(t.error)):i(null,Kl(t.data)))}else{const i=$t(this.globalScope)?void 0:[],l=t.hasCallback?(p,v)=>{delete this.cancelCallbacks[n],this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:p?Yl(p):null,data:Yl(v,i)},i)}:p=>{},h=Kl(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,h,l);else if(this.parent.getWorkerSource){const p=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,p[0],h.source)[p[1]](h,l)}else l(new Error(`Could not find function ${t.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=xm,s.Color=Oi,s.ColorMode=Ms,s.CullFaceMode=ns,s.DEMData=Bm,s.DataConstantProperty=Le,s.DedupedRequest=Eb,s.DepthMode=Hu,s.EXTENT=hn,s.Elevation=class{isDataAvailableAtPoint(n){const t=this._source();if(this.isUsingMockSource()||!t||n.y<0||n.y>1)return!1;const i=t.getSource().maxzoom,l=1<<i,h=Math.floor(n.x),p=Math.floor((n.x-h)*l),v=Math.floor(n.y*l),x=this.findDEMTileFor(new $r(i,h,i,p,v));return!(!x||!x.dem)}getAtPointOrZero(n,t=0){return this.getAtPoint(n,t)||0}getAtPoint(n,t,i=!0){if(this.isUsingMockSource())return null;t==null&&(t=null);const l=this._source();if(!l||n.y<0||n.y>1)return t;const h=l.getSource().maxzoom,p=1<<h,v=Math.floor(n.x),x=n.x-v,S=new $r(h,v,h,Math.floor(x*p),Math.floor(n.y*p)),T=this.findDEMTileFor(S);if(!T||!T.dem)return t;const k=T.dem,z=1<<T.tileID.canonical.z,R=(x*z-T.tileID.canonical.x)*k.dim,V=(n.y*z-T.tileID.canonical.y)*k.dim,$=Math.floor(R),G=Math.floor(V);return(i?this.exaggeration():1)*$n($n(k.get($,G),k.get($,G+1),V-G),$n(k.get($+1,G),k.get($+1,G+1),V-G),R-$)}getAtTileOffset(n,t,i){const l=1<<n.canonical.z;return this.getAtPointOrZero(new Du(n.wrap+(n.canonical.x+t/hn)/l,(n.canonical.y+i/hn)/l))}getAtTileOffsetFunc(n,t,i,l){return h=>{const p=this.getAtTileOffset(n,h.x,h.y),v=l.upVector(n.canonical,h.x,h.y);return uo(v,v,p*l.upVectorScale(n.canonical,t,i).metersToTile),v}}getForTilePoints(n,t,i,l){if(this.isUsingMockSource())return!1;const h=Om.create(this,n,l);return!!h&&(t.forEach(p=>{p[2]=this.exaggeration()*h.getElevationAt(p[0],p[1],i)}),!0)}getMinMaxForTile(n){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(n);if(!t||!t.dem)return null;const i=t.dem.tree,l=t.tileID,h=1<<n.canonical.z-l.canonical.z;let p=n.canonical.x/h-l.canonical.x,v=n.canonical.y/h-l.canonical.y,x=0;for(let S=0;S<n.canonical.z-l.canonical.z&&!i.leaves[x];S++){p*=2,v*=2;const T=2*Math.floor(v)+Math.floor(p);x=i.childOffsets[x]+T,p%=1,v%=1}return{min:this.exaggeration()*i.minimums[x],max:this.exaggeration()*i.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(n,t,i){throw new Error("Pure virtual method called.")}pointCoordinate(n){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(n){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=ps,s.EvaluationParameters=Be,s.Event=ti,s.Evented=Go,s.FillExtrusionBucket=Od,s.Frustum=Av,s.FrustumCorners=Iv,s.GLOBE_RADIUS=Ss,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=6,s.GLOBE_ZOOM_THRESHOLD_MIN=5,s.GlobeSharedBuffers=class{constructor(n){this._createGrid(n),this._createPoles(n)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const n of this._poleSegments)n.destroy();for(const n of this._gridSegments)n.withSkirts.destroy(),n.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const n of this._wireframeSegments)n.destroy()}}_fillGridMeshWithLods(n,t){const i=new en,l=new br,h=[],p=n+1+2,v=t[0]+1,x=t[0]+1+(1+t.length),S=(T,k,z)=>{let R=T===p-1?T-2:T===0?T:T-1;return R+=z?24575:0,[R,k]};for(let T=0;T<p;++T)i.emplaceBack(...S(T,0,!0));for(let T=0;T<v;++T)for(let k=0;k<p;++k)i.emplaceBack(...S(k,T,(k===0||k===p-1)&&!0));for(let T=0;T<t.length;++T){const k=t[T];for(let z=0;z<p;++z)i.emplaceBack(...S(z,k,!0))}for(let T=0;T<t.length;++T){const k=l.length,z=t[T]+1+2,R=new br;for(let G=0;G<z-1;G++){const X=G===z-2,le=X?p*(x-t.length+T-G):p;for(let ye=0;ye<p-1;ye++){const re=G*p+ye;G===0||X||ye===0||ye===p-2?(R.emplaceBack(re+1,re,re+le),R.emplaceBack(re+le,re+le+1,re+1)):(l.emplaceBack(re+1,re,re+le),l.emplaceBack(re+le,re+le+1,re+1))}}const V=Gi.simpleSegment(0,k,i.length,l.length-k);for(let G=0;G<R.uint16.length;G+=3)l.emplaceBack(R.uint16[G],R.uint16[G+1],R.uint16[G+2]);const $=Gi.simpleSegment(0,k,i.length,l.length-k);h.push({withoutSkirts:V,withSkirts:$})}return{vertices:i,indices:l,segments:h}}_createGrid(n){const t=this._fillGridMeshWithLods(sc,Id);this._gridSegments=t.segments,this._gridBuffer=n.createVertexBuffer(t.vertices,Cd.members),this._gridIndexBuffer=n.createIndexBuffer(t.indices,!0)}_createPoles(n){const t=new br;for(let h=0;h<=sc;h++)t.emplaceBack(0,h+1,h+2);this._poleIndexBuffer=n.createIndexBuffer(t,!0);const i=new Jr,l=new Jr;this._poleSegments=[];for(let h=0,p=0;h<5;h++){const v=360/(1<<h);i.emplaceBack(0,-Ss,0,.5,0),l.emplaceBack(0,-Ss,0,.5,1);for(let x=0;x<=sc;x++){const S=x/sc,T=$n(0,v,S),[k,z,R]=zu(_I,yI,T,Ss);i.emplaceBack(k,z,R,S,0),l.emplaceBack(k,z,R,S,1)}this._poleSegments.push(Gi.simpleSegment(p,0,66,64)),p+=66}this._poleNorthVertexBuffer=n.createVertexBuffer(i,Mx,!1),this._poleSouthVertexBuffer=n.createVertexBuffer(l,Mx,!1)}getGridBuffers(n,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[n].withSkirts:this._gridSegments[n].withoutSkirts]}getPoleBuffers(n){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[n]]}getWirefameBuffers(n,t){if(!this._wireframeSegments){const i=new bs,l=sc,h=l+1+2,p=1;this._wireframeSegments=[];for(let v=0,x=0;v<Id.length;v++){const S=Id[v];for(let k=p;k<S+p;k++)for(let z=p;z<l+p;z++){const R=k*h+z;i.emplaceBack(R,R+1),i.emplaceBack(R,R+h),i.emplaceBack(R,R+h+1)}const T=S*l*3;this._wireframeSegments.push(Gi.simpleSegment(0,x,(S+1)*h,T)),x+=T}this._wireframeIndexBuffer=n.createIndexBuffer(i)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[t]]}},s.GlyphManager=qu,s.ImagePosition=Jv,s.LivePerformanceUtils=ut,s.LngLat=Nn,s.LngLatBounds=Ja,s.LocalGlyphMode=t_,s.MAX_MERCATOR_LATITUDE=Sr,s.MercatorCoordinate=Du,s.ONE_EM=Er,s.OverscaledTileID=$r,s.PerformanceMarkers=Ve,s.Properties=mt,s.RGBAImage=eo,s.Ray=Cv,s.RequestManager=class{constructor(n,t,i){this._transformRequestFn=n,this._customAccessToken=t,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const n=function(){let t="";for(let i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ce,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,t){return this._transformRequestFn&&this._transformRequestFn(n,t)||{url:n}}normalizeStyleURL(n,t){if(!lo(n))return n;const i=Zr(n);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeGlyphsURL(n,t){if(!lo(n))return n;const i=Zr(n);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeSourceURL(n,t,i,l){if(!lo(n))return n;const h=Zr(n);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),i&&h.params.push(`language=${i}`),l&&h.params.push(`worldview=${l}`),this._makeAPIURL(h,this._customAccessToken||t)}normalizeSpriteURL(n,t,i,l){const h=Zr(n);return lo(n)?(h.path=`/styles/v1${h.path}/sprite${t}${i}`,this._makeAPIURL(h,this._customAccessToken||l)):(h.path+=`${t}${i}`,fs(h))}normalizeTileURL(n,t,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!lo(n))return n;const l=Zr(n);l.path=l.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${t||i&&l.authority!=="raster"&&i===512?"@2x":""}${L.supported?".webp":"$1"}`),l.authority==="raster"?l.path=`/${P.RASTER_URL_PREFIX}${l.path}`:(l.path=l.path.replace(/^.+\/v4\//,"/"),l.path=`/${P.TILE_URL_VERSION}${l.path}`);const h=this._customAccessToken||function(p){for(const v of p){const x=v.match(/^access_token=(.*)$/);if(x)return x[1]}return null}(l.params)||P.ACCESS_TOKEN;return P.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&l.params.push(`sku=${this._skuToken}`),this._makeAPIURL(l,h)}canonicalizeTileURL(n,t){const i=Zr(n);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return n;let l="mapbox://";i.path.match(/^\/raster\/v1\//)?l+=`raster/${i.path.replace(`/${P.RASTER_URL_PREFIX}/`,"")}`:l+=`tiles/${i.path.replace(`/${P.TILE_URL_VERSION}/`,"")}`;let h=i.params;return t&&(h=h.filter(p=>!p.match(/^access_token=/))),h.length&&(l+=`?${h.join("&")}`),l}canonicalizeTileset(n,t){const i=!!t&&lo(t),l=[];for(const h of n.tiles||[])Zs(h)?l.push(this.canonicalizeTileURL(h,i)):l.push(h);return l}_makeAPIURL(n,t){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",l=Zr(P.API_URL);if(n.protocol=l.protocol,n.authority=l.authority,n.protocol==="http"){const h=n.params.indexOf("secure");h>=0&&n.params.splice(h,1)}if(l.path!=="/"&&(n.path=`${l.path}${n.path}`),!P.REQUIRE_ACCESS_TOKEN)return fs(n);if(t=t||P.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(t[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return n.params=n.params.filter(h=>h.indexOf("access_token")===-1),n.params.push(`access_token=${t||""}`),fs(n)}},s.ResourceType=or,s.SegmentVector=Gi,s.SourceCache=dc,s.StencilMode=h_,s.StructArrayLayout1ui2=ws,s.StructArrayLayout2f1f2i16=yr,s.StructArrayLayout2i4=en,s.StructArrayLayout2ui4=bs,s.StructArrayLayout3f12=xr,s.StructArrayLayout3ui6=br,s.StructArrayLayout4i8=ni,s.StructArrayLayout5f20=Jr,s.Texture=Hd,s.Tile=c_,s.Transitionable=wt,s.Uniform1f=nm,s.Uniform1i=class extends ia{constructor(n){super(n),this.current=0}set(n,t,i){this.fetchUniformLocation(n,t)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},s.Uniform2f=class extends ia{constructor(n){super(n),this.current=[0,0]}set(n,t,i){this.fetchUniformLocation(n,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}},s.Uniform3f=class extends ia{constructor(n){super(n),this.current=[0,0,0]}set(n,t,i){this.fetchUniformLocation(n,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}},s.Uniform4f=px,s.UniformColor=mx,s.UniformMatrix2f=class extends ia{constructor(n){super(n),this.current=iI}set(n,t,i){if(this.fetchUniformLocation(n,t)){for(let l=0;l<4;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}}},s.UniformMatrix3f=class extends ia{constructor(n){super(n),this.current=nI}set(n,t,i){if(this.fetchUniformLocation(n,t)){for(let l=0;l<9;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}},s.UniformMatrix4f=class extends ia{constructor(n){super(n),this.current=tI}set(n,t,i){if(this.fetchUniformLocation(n,t)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}},s.UnwrappedTileID=y1,s.ValidationError=Ot,s.VectorTileFeature=_m,s.VectorTileWorkerSource=class extends Go{constructor(n,t,i,l,h){super(),this.actor=n,this.layerIndex=t,this.availableImages=i,this.loadVectorData=h||Tb,this.loading={},this.loaded={},this.deduped=new Eb(n.scheduler),this.isSpriteLoaded=l,this.scheduler=n.scheduler}loadTile(n,t){const i=n.uid,l=n&&n.request,h=l&&l.collectResourceTiming,p=this.loading[i]=new Sk(n);p.abort=this.loadVectorData(n,(v,x)=>{const S=!this.loading[i];if(delete this.loading[i],S||v||!x)return p.status="done",S||(this.loaded[i]=p),t(v);const T=x.rawData,k={};x.expires&&(k.expires=x.expires),x.cacheControl&&(k.cacheControl=x.cacheControl),p.vectorTile=x.vectorTile||new Hv(new Nd(T));const z=()=>{p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,(R,V)=>{if(R||!V)return t(R);const $={};if(h){const G=nn(l);G.length>0&&($.resourceTiming=JSON.parse(JSON.stringify(G)))}t(null,pt({rawTileData:T.slice(0)},V,k,$))})};this.isSpriteLoaded?z():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(z,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):z()}),this.loaded=this.loaded||{},this.loaded[i]=p})}reloadTile(n,t){const i=this.loaded,l=n.uid,h=this;if(i&&i[l]){const p=i[l];p.showCollisionBoxes=n.showCollisionBoxes,p.enableTerrain=!!n.enableTerrain,p.projection=n.projection,p.tileTransform=hc(n.tileID.canonical,n.projection);const v=(x,S)=>{const T=p.reloadCallback;T&&(delete p.reloadCallback,p.parse(p.vectorTile,h.layerIndex,this.availableImages,h.actor,T)),t(x,S)};p.status==="parsing"?p.reloadCallback=v:p.status==="done"&&(p.vectorTile?p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,v):v())}}abortTile(n,t){const i=n.uid,l=this.loading[i];l&&(l.abort&&l.abort(),delete this.loading[i]),t()}removeTile(n,t){const i=this.loaded,l=n.uid;i&&i[l]&&delete i[l],t()}},s.WritingMode=fo,s.ZoomDependentExpression=ta,s.add=oa,s.addDynamicAttributes=Lm,s.adjoint=function(n,t){var i=t[0],l=t[1],h=t[2],p=t[3],v=t[4],x=t[5],S=t[6],T=t[7],k=t[8];return n[0]=v*k-x*T,n[1]=h*T-l*k,n[2]=l*x-h*v,n[3]=x*S-p*k,n[4]=i*k-h*S,n[5]=h*p-i*x,n[6]=p*T-v*S,n[7]=l*S-i*T,n[8]=i*v-l*p,n},s.asyncAll=at,s.bezier=Je,s.bindAll=bt,s.boundsAttributes=lb,s.bufferConvexPolygon=function(n,t){const i=[];for(let l=0;l<n.length;l++){const h=Pe(l-1,-1,n.length-1),p=Pe(l+1,-1,n.length-1),v=n[l],x=n[p],S=n[h].sub(v).unit(),T=x.sub(v).unit(),k=T.angleWithSep(S.x,S.y),z=S.add(T).unit().mult(-1*t/Math.sin(k/2));i.push(v.add(z))}return i},s.cacheEntryPossiblyAdded=function(n){_i++,_i>fn&&(n.getActor().send("enforceCacheSizeLimit",on),_i=0)},s.calculateGlobeLabelMatrix=function(n,t){const{x:i,y:l}=n.point,h=Bx(i,l,n.worldSize/n._pixelsPerMercatorPixel,0,0);return ic(h,h,Pv(Es(t)))},s.calculateGlobeMatrix=function(n){const{x:t,y:i}=n.point,{lng:l,lat:h}=n._center;return Bx(t,i,n.worldSize,l,h)},s.calculateGlobeMercatorMatrix=function(n){const t=n.pixelsPerMeter,i=t/ts(1,n.center.lat),l=Qo(new Float64Array(16));return xd(l,l,[n.point.x,n.point.y,0]),rc(l,l,[i,i,t]),Float32Array.from(l)},s.circumferenceAtLatitude=Lv,s.clamp=nt,s.clearTileCache=function(n){if(!In())return;const t=w.caches.delete(St);n&&t.catch(n).then(()=>n())},s.clipLine=G1,s.clone=function(n){var t=new Qr(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},s.clone$1=Fn,s.collisionCircleLayout=SA,s.config=P,s.conjugate=function(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=t[3],n},s.create=function(){var n=new Qr(16);return Qr!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},s.create$1=vx,s.createExpression=Ua,s.createLayout=Xt,s.createStyleLayer=function(n){return n.type==="custom"?new pk(n):new gk[n.type](n)},s.cross=Tv,s.degToRad=Ee,s.distance=function(n,t){return Math.hypot(t[0]-n[0],t[1]-n[1],t[2]-n[2])},s.div=function(n,t,i){return n[0]=t[0]/i[0],n[1]=t[1]/i[1],n[2]=t[2]/i[2],n},s.dot=Eo,s.earthRadius=Md,s.ease=ct,s.easeCubicInOut=ze,s.ecefToLatLng=function([n,t,i]){const l=Math.hypot(n,t,i),h=Math.atan2(n,i),p=.5*Math.PI-Math.acos(-t/l);return new Nn(be(h),be(p))},s.emitValidationErrors=Np,s.endsWith=Tt,s.enforceCacheSizeLimit=function(n){Gn(),Jt&&Jt.then(t=>{t.keys().then(i=>{for(let l=0;l<i.length-n;l++)t.delete(i[l])})})},s.evaluateSizeForFeature=wm,s.evaluateSizeForZoom=Nu,s.evaluateVariableOffset=X1,s.evented=pe,s.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]},s.exactEquals$1=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]},s.exported=Zn,s.exported$1=L,s.extend=pt,s.extend$1=qo,s.fillExtrusionHeightLift=g1,s.filterObject=pn,s.fromMat4=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[4],n[4]=t[5],n[5]=t[6],n[6]=t[8],n[7]=t[9],n[8]=t[10],n},s.fromQuat=function(n,t){var i=t[0],l=t[1],h=t[2],p=t[3],v=i+i,x=l+l,S=h+h,T=i*v,k=l*v,z=l*x,R=h*v,V=h*x,$=h*S,G=p*v,X=p*x,le=p*S;return n[0]=1-z-$,n[1]=k+le,n[2]=R-X,n[3]=0,n[4]=k-le,n[5]=1-T-$,n[6]=V+G,n[7]=0,n[8]=R+X,n[9]=V-G,n[10]=1-T-z,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},s.fromRotation=function(n,t){var i=Math.sin(t),l=Math.cos(t);return n[0]=l,n[1]=i,n[2]=0,n[3]=-i,n[4]=l,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},s.fromScaling=yx,s.furthestTileCorner=function(n){const t=Math.round((n+45+360)%360/90)%4;return Re[t]},s.getAABBPointSquareDist=function(n,t,i){let l=0;for(let h=0;h<2;++h){const p=i?i[h]:0;n[h]>p&&(l+=(n[h]-p)*(n[h]-p)),t[h]<p&&(l+=(p-t[h])*(p-t[h]))}return l},s.getAnchorAlignment=e_,s.getAnchorJustification=i_,s.getBounds=function(n){let t=1/0,i=1/0,l=-1/0,h=-1/0;for(const p of n)t=Math.min(t,p.x),i=Math.min(i,p.y),l=Math.max(l,p.x),h=Math.max(h,p.y);return{min:new Y(t,i),max:new Y(l,h)}},s.getColumn=Ft,s.getGridMatrix=function(n,t,i,l){const h=t.getNorth(),p=t.getSouth(),v=t.getWest(),x=t.getEast(),S=1<<n.z,T=x-v,k=h-p,z=T/sc,R=-k/Id[i],V=[0,z,0,R,0,0,h,v,0];if(n.z>0){const $=180/l;_x(V,V,[$/T+1,0,0,0,$/k+1,0,-.5*$/z,.5*$/R,1])}return V[2]=S,V[5]=n.x,V[8]=n.y,V},s.getImage=El,s.getJSON=function(n,t){return Lr(pt(n,{type:"json"}),t)},s.getLatitudinalLod=function(n){const t=Sr-5;n=nt(n,-t,t)/t*90;const i=Math.pow(Math.abs(Math.sin(Ee(n))),3);return Math.round(i*(Id.length-1))},s.getMapSessionAPI=De,s.getPerformanceMeasurement=nn,s.getProjection=ib,s.getRTLTextPluginStatus=Ce,s.getReferrer=ds,s.getTilePoint=function(n,{x:t,y:i},l=0){return new Y(((t-l)*n.scale-n.x)*hn,(i*n.scale-n.y)*hn)},s.getTileVec3=function(n,t,i=0){return Pu(((t.x-i)*n.scale-n.x)*hn,(t.y*n.scale-n.y)*hn,$x(t.z,t.y))},s.getVideo=function(n,t){const i=w.document.createElement("video");i.muted=!0,i.onloadstart=function(){t(null,i)};for(let l=0;l<n.length;l++){const h=w.document.createElement("source");nr(n[l])||(i.crossOrigin="Anonymous"),h.src=n[l],i.appendChild(h)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(n){const t=[0,0,0],i=Qo(new Float64Array(16));return ic(i,n.pixelMatrix,n.globeMatrix),Fi(t,t,i),new Y(t[0],t[1])},s.globeDenormalizeECEF=Pv,s.globeECEFOrigin=function(n,t){const i=[0,0,0];return Fi(i,i,kd(Es(t.canonical))),Fi(i,i,n),i},s.globeMetersToEcef=sm,s.globeNormalizeECEF=kd,s.globePixelsToTileUnits=function(n,t){return hn/(512*Math.pow(2,n))*lm(Es(t))},s.globePoleMatrixForTile=function(n,t,i){const l=Qo(new Float64Array(16)),h=(t/(1<<n)-.5)*Math.PI*2;return om(l,i.globeMatrix,h),Float32Array.from(l)},s.globeTileBounds=Es,s.globeTiltAtLngLat=Ox,s.globeToMercatorTransition=Ru,s.globeUseCustomAntiAliasing=function(n,t,i){const l=Ru(i.zoom),h=n.style.map._antialias,p=!!t.extStandardDerivatives,v=t.extStandardDerivativesForceOff||n.terrain&&n.terrain.exaggeration()>0;return l===0&&!h&&!v&&p},s.identity=Qo,s.identity$1=Ix,s.invert=bv,s.isFullscreen=function(){return!!w.document.fullscreenElement||!!w.document.webkitFullscreenElement},s.isLngLatBehindGlobe=zv,s.isMapAuthenticated=function(n){return ke.has(n)},s.isMapboxURL=lo,s.isSafariWithAntialiasingBug=function(n){const t=n.navigator?n.navigator.userAgent:null;return!!$t(n)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=wr,s.latLngToECEF=Lu,s.len=dI,s.length=bd,s.length$1=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},s.lngFromMercatorX=ho,s.loadVectorTile=Tb,s.makeRequest=Lr,s.mapValue=function(n,t,i,l,h){return nt((n-t)/(i-t)*(h-l)+l,l,h)},s.mercatorScale=Nx,s.mercatorXfromLng=Ts,s.mercatorYfromLat=Cs,s.mercatorZfromAltitude=ts,s.mul=uI,s.mul$1=hI,s.multiply=ic,s.multiply$1=_x,s.multiply$2=wx,s.nextPowerOfTwo=kt,s.normalize=Fr,s.normalize$1=fI,s.normalize$2=Tx,s.number=$n,s.ortho=function(n,t,i,l,h,p,v){var x=1/(t-i),S=1/(l-h),T=1/(p-v);return n[0]=-2*x,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*S,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*T,n[11]=0,n[12]=(t+i)*x,n[13]=(h+l)*S,n[14]=(v+p)*T,n[15]=1,n},s.pbf=Nd,s.perspective=function(n,t,i,l,h){var p,v=1/Math.tan(t/2);return n[0]=v/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=v,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,h!=null&&h!==1/0?(n[10]=(h+l)*(p=1/(l-h)),n[14]=2*h*l*p):(n[10]=-1,n[14]=-2*l),n},s.pick=function(n,t){const i={};for(let l=0;l<t.length;l++){const h=t[l];h in n&&(i[h]=n[h])}return i},s.plugin=Ae,s.pointGeometry=Y,s.polesInViewport=function(n){const t=Qo(new Float64Array(16));ic(t,n.pixelMatrix,n.globeMatrix);const i=[0,To,0],l=[0,Co,0];return Fi(i,i,t),Fi(l,l,t),[i[0]>0&&i[0]<=n.width&&i[1]>0&&i[1]<=n.height&&!zv(n,new Nn(n.center.lat,90)),l[0]>0&&l[0]<=n.width&&l[1]>0&&l[1]<=n.height&&!zv(n,new Nn(n.center.lat,-90))]},s.polygonContainsPoint=cc,s.polygonIntersectsBox=Hx,s.polygonIntersectsPolygon=Gx,s.polygonizeBounds=function(n,t,i=0,l=!0){const h=new Y(i,i),p=n.sub(h),v=t.add(h),x=[p,new Y(v.x,p.y),v,new Y(p.x,v.y)];return l&&x.push(p.clone()),x},s.posAttributes=Cd,s.postMapLoadEvent=oe,s.postPerformanceEvent=Ie,s.postTurnstileEvent=U,s.potpack=Kv,s.prevPowerOfTwo=function(n){return n<=1?1:Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},s.radToDeg=be,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(n){return n({pluginStatus:te,pluginURL:W}),pe.on("pluginStateChange",n),n},s.removeAuthState=function(n){ke.delete(n)},s.renderColorRamp=Nv,s.resample=Ux,s.rotateX=wv,s.rotateX$1=Ax,s.rotateY=om,s.rotateY$1=kx,s.rotateZ=function(n,t,i){var l=Math.sin(i),h=Math.cos(i),p=t[0],v=t[1],x=t[2],S=t[3],T=t[4],k=t[5],z=t[6],R=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=p*h+T*l,n[1]=v*h+k*l,n[2]=x*h+z*l,n[3]=S*h+R*l,n[4]=T*h-p*l,n[5]=k*h-v*l,n[6]=z*h-x*l,n[7]=R*h-S*l,n},s.rotateZ$1=function(n,t,i){i*=.5;var l=t[0],h=t[1],p=t[2],v=t[3],x=Math.sin(i),S=Math.cos(i);return n[0]=l*S+h*x,n[1]=h*S-l*x,n[2]=p*S+v*x,n[3]=v*S-p*x,n},s.scale=rc,s.scale$1=Ex,s.scale$2=uo,s.scaleAndAdd=Ed,s.set=function(n,t,i,l){return n[0]=t,n[1]=i,n[2]=l,n},s.setCacheLimits=function(n,t){on=n,fn=t},s.setColumn=function(n,t,i){n[4*t+0]=i[0],n[4*t+1]=i[1],n[4*t+2]=i[2],n[4*t+3]=i[3]},s.setRTLTextPlugin=function(n,t,i=!1){if(te===H||te===Q||te===J)throw new Error("setRTLTextPlugin cannot be called multiple times.");W=Zn.resolveURL(n),te=H,ee=t,ae(),i||we()},s.smoothstep=ft,s.spec=et,s.squaredLength=function(n){var t=n[0],i=n[1],l=n[2];return t*t+i*i+l*l},s.storeAuthState=function(n,t){t?ke.add(n):ke.delete(n)},s.sub=es,s.subtract=Ev,s.symbolSize=EA,s.tileAABB=function(n,t,i,l,h,p,v,x,S){if(S.name==="globe")return vI(n,t,new xm(i,l,h));const T=hc({z:i,x:l,y:h},S);return new Vr([(p+T.x/T.scale)*t,t*(T.y/T.scale),v],[(p+T.x2/T.scale)*t,t*(T.y2/T.scale),x])},s.tileCornersToBounds=am,s.tileTransform=hc,s.transformMat3=function(n,t,i){var l=t[0],h=t[1],p=t[2];return n[0]=l*i[0]+h*i[3]+p*i[6],n[1]=l*i[1]+h*i[4]+p*i[7],n[2]=l*i[2]+h*i[5]+p*i[8],n},s.transformMat4=Fi,s.transformMat4$1=oc,s.transformQuat=Sx,s.transitionTileAABBinECEF=Lx,s.translate=xd,s.transpose=function(n,t){if(n===t){var i=t[1],l=t[2],h=t[5];n[1]=t[3],n[2]=t[6],n[3]=i,n[5]=t[7],n[6]=l,n[7]=h}else n[0]=t[0],n[1]=t[3],n[2]=t[6],n[3]=t[1],n[4]=t[4],n[5]=t[7],n[6]=t[2],n[7]=t[5],n[8]=t[8];return n},s.triggerPluginCompletionEvent=ue,s.uniqueId=qt,s.updateGlobeVertexNormal=function(n,t,i,l,h){const p=5*t+2;n.float32[p+0]=i,n.float32[p+1]=l,n.float32[p+2]=h},s.validateCustomStyleLayer=function(n){const t=[],i=n.id;return i===void 0&&t.push({message:`layers.${i}: missing required property "id"`}),n.render===void 0&&t.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&t.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),t},s.validateFilter=n=>Ho(ud(n)),s.validateFog=n=>Ho(Fp(n)),s.validateLayer=n=>Ho(dd(n)),s.validateLight=n=>Ho(Op(n)),s.validateSource=n=>Ho(Hl(n)),s.validateStyle=Vp,s.validateTerrain=n=>Ho(fd(n)),s.values=Gt,s.vectorTile=vm,s.version=E,s.warnOnce=he,s.window=w,s.wrap=Pe}),m(["./shared"],function(s){function w(se){if(typeof se=="number"||typeof se=="boolean"||typeof se=="string"||se==null)return JSON.stringify(se);if(Array.isArray(se)){let q="[";for(const oe of se)q+=`${w(oe)},`;return`${q}]`}let U="{";for(const q of Object.keys(se).sort())U+=`${q}:${w(se[q])},`;return`${U}}`}function E(se){let U="";for(const q of s.refProperties)U+=`/${w(se[q])}`;return U}class A{constructor(U){this.keyCache={},U&&this.replace(U)}replace(U){this._layerConfigs={},this._layers={},this.update(U,[])}update(U,q){for(const me of U)this._layerConfigs[me.id]=me,(this._layers[me.id]=s.createStyleLayer(me)).compileFilter(),this.keyCache[me.id]&&delete this.keyCache[me.id];for(const me of q)delete this.keyCache[me],delete this._layerConfigs[me],delete this._layers[me];this.familiesBySource={};const oe=function(me,Ie){const Oe={};for(let ke=0;ke<me.length;ke++){const Ve=Ie&&Ie[me[ke].id]||E(me[ke]);Ie&&(Ie[me[ke].id]=Ve);let ut=Oe[Ve];ut||(ut=Oe[Ve]=[]),ut.push(me[ke])}const De=[];for(const ke in Oe)De.push(Oe[ke]);return De}(s.values(this._layerConfigs),this.keyCache);for(const me of oe){const Ie=me.map(Bt=>this._layers[Bt.id]),Oe=Ie[0];if(Oe.visibility==="none")continue;const De=Oe.source||"";let ke=this.familiesBySource[De];ke||(ke=this.familiesBySource[De]={});const Ve=Oe.sourceLayer||"_geojsonTileLayer";let ut=ke[Ve];ut||(ut=ke[Ve]=[]),ut.push(Ie)}}}class P{loadTile(U,q){const{uid:oe,encoding:me,rawImageData:Ie,padding:Oe,buildQuadTree:De}=U,ke=s.window.ImageBitmap&&Ie instanceof s.window.ImageBitmap?this.getImageData(Ie,Oe):Ie;q(null,new s.DEMData(oe,ke,me,Oe<1,De))}getImageData(U,q){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(U.width,U.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=U.width,this.offscreenCanvas.height=U.height,this.offscreenCanvasContext.drawImage(U,0,0,U.width,U.height);const oe=this.offscreenCanvasContext.getImageData(-q,-q,U.width+2*q,U.height+2*q);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),oe}}var L=function se(U,q){var oe,me=U&&U.type;if(me==="FeatureCollection")for(oe=0;oe<U.features.length;oe++)se(U.features[oe],q);else if(me==="GeometryCollection")for(oe=0;oe<U.geometries.length;oe++)se(U.geometries[oe],q);else if(me==="Feature")se(U.geometry,q);else if(me==="Polygon")D(U.coordinates,q);else if(me==="MultiPolygon")for(oe=0;oe<U.coordinates.length;oe++)D(U.coordinates[oe],q);return U};function D(se,U){if(se.length!==0){N(se[0],U);for(var q=1;q<se.length;q++)N(se[q],!U)}}function N(se,U){for(var q=0,oe=0,me=0,Ie=se.length,Oe=Ie-1;me<Ie;Oe=me++){var De=(se[me][0]-se[Oe][0])*(se[Oe][1]+se[me][1]),ke=q+De;oe+=Math.abs(q)>=Math.abs(De)?q-ke+De:De-ke+q,q=ke}q+oe>=0!=!!U&&se.reverse()}const Z=s.VectorTileFeature.prototype.toGeoJSON;class de{constructor(U){this._feature=U,this.extent=s.EXTENT,this.type=U.type,this.properties=U.tags,"id"in U&&!isNaN(U.id)&&(this.id=parseInt(U.id,10))}loadGeometry(){if(this._feature.type===1){const U=[];for(const q of this._feature.geometry)U.push([new s.pointGeometry(q[0],q[1])]);return U}{const U=[];for(const q of this._feature.geometry){const oe=[];for(const me of q)oe.push(new s.pointGeometry(me[0],me[1]));U.push(oe)}return U}}toGeoJSON(U,q,oe){return Z.call(this,U,q,oe)}}class ne{constructor(U){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=U.length,this._features=U}feature(U){return new de(this._features[U])}}var ce={},K={get exports(){return ce},set exports(se){ce=se}},Se=s.pointGeometry,Y=s.vectorTile.VectorTileFeature,_e=fe;function fe(se,U){this.options=U||{},this.features=se,this.length=se.length}function ve(se,U){this.id=typeof se.id=="number"?se.id:void 0,this.type=se.type,this.rawGeometry=se.type===1?[se.geometry]:se.geometry,this.properties=se.tags,this.extent=U||4096}fe.prototype.feature=function(se){return new ve(this.features[se],this.options.extent)},ve.prototype.loadGeometry=function(){var se=this.rawGeometry;this.geometry=[];for(var U=0;U<se.length;U++){for(var q=se[U],oe=[],me=0;me<q.length;me++)oe.push(new Se(q[me][0],q[me][1]));this.geometry.push(oe)}return this.geometry},ve.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var se=this.geometry,U=1/0,q=-1/0,oe=1/0,me=-1/0,Ie=0;Ie<se.length;Ie++)for(var Oe=se[Ie],De=0;De<Oe.length;De++){var ke=Oe[De];U=Math.min(U,ke.x),q=Math.max(q,ke.x),oe=Math.min(oe,ke.y),me=Math.max(me,ke.y)}return[U,oe,q,me]},ve.prototype.toGeoJSON=Y.prototype.toGeoJSON;var Ee=s.pbf,be=_e;function Re(se){var U=new Ee;return function(q,oe){for(var me in q.layers)oe.writeMessage(3,ze,q.layers[me])}(se,U),U.finish()}function ze(se,U){var q;U.writeVarintField(15,se.version||1),U.writeStringField(1,se.name||""),U.writeVarintField(5,se.extent||4096);var oe={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<se.length;q++)oe.feature=se.feature(q),U.writeMessage(2,Je,oe);var me=oe.keys;for(q=0;q<me.length;q++)U.writeStringField(3,me[q]);var Ie=oe.values;for(q=0;q<Ie.length;q++)U.writeMessage(4,at,Ie[q])}function Je(se,U){var q=se.feature;q.id!==void 0&&U.writeVarintField(1,q.id),U.writeMessage(2,ct,se),U.writeVarintField(3,q.type),U.writeMessage(4,Pe,q)}function ct(se,U){var q=se.feature,oe=se.keys,me=se.values,Ie=se.keycache,Oe=se.valuecache;for(var De in q.properties){var ke=q.properties[De],Ve=Ie[De];if(ke!==null){Ve===void 0&&(oe.push(De),Ie[De]=Ve=oe.length-1),U.writeVarint(Ve);var ut=typeof ke;ut!=="string"&&ut!=="boolean"&&ut!=="number"&&(ke=JSON.stringify(ke));var Bt=ut+":"+ke,gt=Oe[Bt];gt===void 0&&(me.push(ke),Oe[Bt]=gt=me.length-1),U.writeVarint(gt)}}}function nt(se,U){return(U<<3)+(7&se)}function ft(se){return se<<1^se>>31}function Pe(se,U){for(var q=se.loadGeometry(),oe=se.type,me=0,Ie=0,Oe=q.length,De=0;De<Oe;De++){var ke=q[De],Ve=1;oe===1&&(Ve=ke.length),U.writeVarint(nt(1,Ve));for(var ut=oe===3?ke.length-1:ke.length,Bt=0;Bt<ut;Bt++){Bt===1&&oe!==1&&U.writeVarint(nt(2,ut-1));var gt=ke[Bt].x-me,nn=ke[Bt].y-Ie;U.writeVarint(ft(gt)),U.writeVarint(ft(nn)),me+=gt,Ie+=nn}oe===3&&U.writeVarint(nt(7,1))}}function at(se,U){var q=typeof se;q==="string"?U.writeStringField(1,se):q==="boolean"?U.writeBooleanField(7,se):q==="number"&&(se%1!=0?U.writeDoubleField(3,se):se<0?U.writeSVarintField(6,se):U.writeVarintField(5,se))}function Gt(se,U,q,oe,me,Ie){if(me-oe<=q)return;const Oe=oe+me>>1;pt(se,U,Oe,oe,me,Ie%2),Gt(se,U,q,oe,Oe-1,Ie+1),Gt(se,U,q,Oe+1,me,Ie+1)}function pt(se,U,q,oe,me,Ie){for(;me>oe;){if(me-oe>600){const Ve=me-oe+1,ut=q-oe+1,Bt=Math.log(Ve),gt=.5*Math.exp(2*Bt/3),nn=.5*Math.sqrt(Bt*gt*(Ve-gt)/Ve)*(ut-Ve/2<0?-1:1);pt(se,U,q,Math.max(oe,Math.floor(q-ut*gt/Ve+nn)),Math.min(me,Math.floor(q+(Ve-ut)*gt/Ve+nn)),Ie)}const Oe=U[2*q+Ie];let De=oe,ke=me;for(Lt(se,U,oe,q),U[2*me+Ie]>Oe&&Lt(se,U,oe,me);De<ke;){for(Lt(se,U,De,ke),De++,ke--;U[2*De+Ie]<Oe;)De++;for(;U[2*ke+Ie]>Oe;)ke--}U[2*oe+Ie]===Oe?Lt(se,U,oe,ke):(ke++,Lt(se,U,ke,me)),ke<=q&&(oe=ke+1),q<=ke&&(me=ke-1)}}function Lt(se,U,q,oe){qt(se,q,oe),qt(U,2*q,2*oe),qt(U,2*q+1,2*oe+1)}function qt(se,U,q){const oe=se[U];se[U]=se[q],se[q]=oe}function Bn(se,U,q,oe){const me=se-q,Ie=U-oe;return me*me+Ie*Ie}K.exports=Re,ce.fromVectorTileJs=Re,ce.fromGeojsonVt=function(se,U){U=U||{};var q={};for(var oe in se)q[oe]=new be(se[oe].features,U),q[oe].name=oe,q[oe].version=U.version,q[oe].extent=U.extent;return Re({layers:q})},ce.GeoJSONWrapper=be;const kt=se=>se[0],Qe=se=>se[1];class bt{constructor(U,q=kt,oe=Qe,me=64,Ie=Float64Array){this.nodeSize=me,this.points=U;const Oe=U.length<65536?Uint16Array:Uint32Array,De=this.ids=new Oe(U.length),ke=this.coords=new Ie(2*U.length);for(let Ve=0;Ve<U.length;Ve++)De[Ve]=Ve,ke[2*Ve]=q(U[Ve]),ke[2*Ve+1]=oe(U[Ve]);Gt(De,ke,me,0,De.length-1,0)}range(U,q,oe,me){return function(Ie,Oe,De,ke,Ve,ut,Bt){const gt=[0,Ie.length-1,0],nn=[];let Qt,Kt;for(;gt.length;){const un=gt.pop(),yn=gt.pop(),Zn=gt.pop();if(yn-Zn<=Bt){for(let ti=Zn;ti<=yn;ti++)Qt=Oe[2*ti],Kt=Oe[2*ti+1],Qt>=De&&Qt<=Ve&&Kt>=ke&&Kt<=ut&&nn.push(Ie[ti]);continue}const sn=Math.floor((Zn+yn)/2);Qt=Oe[2*sn],Kt=Oe[2*sn+1],Qt>=De&&Qt<=Ve&&Kt>=ke&&Kt<=ut&&nn.push(Ie[sn]);const ei=(un+1)%2;(un===0?De<=Qt:ke<=Kt)&&(gt.push(Zn),gt.push(sn-1),gt.push(ei)),(un===0?Ve>=Qt:ut>=Kt)&&(gt.push(sn+1),gt.push(yn),gt.push(ei))}return nn}(this.ids,this.coords,U,q,oe,me,this.nodeSize)}within(U,q,oe){return function(me,Ie,Oe,De,ke,Ve){const ut=[0,me.length-1,0],Bt=[],gt=ke*ke;for(;ut.length;){const nn=ut.pop(),Qt=ut.pop(),Kt=ut.pop();if(Qt-Kt<=Ve){for(let ei=Kt;ei<=Qt;ei++)Bn(Ie[2*ei],Ie[2*ei+1],Oe,De)<=gt&&Bt.push(me[ei]);continue}const un=Math.floor((Kt+Qt)/2),yn=Ie[2*un],Zn=Ie[2*un+1];Bn(yn,Zn,Oe,De)<=gt&&Bt.push(me[un]);const sn=(nn+1)%2;(nn===0?Oe-ke<=yn:De-ke<=Zn)&&(ut.push(Kt),ut.push(un-1),ut.push(sn)),(nn===0?Oe+ke>=yn:De+ke>=Zn)&&(ut.push(un+1),ut.push(Qt),ut.push(sn))}return Bt}(this.ids,this.coords,U,q,oe,this.nodeSize)}}const Tt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:se=>se},Ut=Math.fround||(pn=new Float32Array(1),se=>(pn[0]=+se,pn[0]));var pn;class Fn{constructor(U){this.options=$t(Object.create(Tt),U),this.trees=new Array(this.options.maxZoom+1)}load(U){const{log:q,minZoom:oe,maxZoom:me,nodeSize:Ie}=this.options;q&&console.time("total time");const Oe=`prepare ${U.length} points`;q&&console.time(Oe),this.points=U;let De=[];for(let ke=0;ke<U.length;ke++)U[ke].geometry&&De.push(he(U[ke],ke));this.trees[me+1]=new bt(De,Pt,Ft,Ie,Float32Array),q&&console.timeEnd(Oe);for(let ke=me;ke>=oe;ke--){const Ve=+Date.now();De=this._cluster(De,ke),this.trees[ke]=new bt(De,Pt,Ft,Ie,Float32Array),q&&console.log("z%d: %d clusters in %dms",ke,De.length,+Date.now()-Ve)}return q&&console.timeEnd("total time"),this}getClusters(U,q){let oe=((U[0]+180)%360+360)%360-180;const me=Math.max(-90,Math.min(90,U[1]));let Ie=U[2]===180?180:((U[2]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,U[3]));if(U[2]-U[0]>=360)oe=-180,Ie=180;else if(oe>Ie){const ut=this.getClusters([oe,me,180,Oe],q),Bt=this.getClusters([-180,me,Ie,Oe],q);return ut.concat(Bt)}const De=this.trees[this._limitZoom(q)],ke=De.range(st(oe),yt(Oe),st(Ie),yt(me)),Ve=[];for(const ut of ke){const Bt=De.points[ut];Ve.push(Bt.numPoints?Me(Bt):this.points[Bt.index])}return Ve}getChildren(U){const q=this._getOriginId(U),oe=this._getOriginZoom(U),me="No cluster with the specified id.",Ie=this.trees[oe];if(!Ie)throw new Error(me);const Oe=Ie.points[q];if(!Oe)throw new Error(me);const De=this.options.radius/(this.options.extent*Math.pow(2,oe-1)),ke=Ie.within(Oe.x,Oe.y,De),Ve=[];for(const ut of ke){const Bt=Ie.points[ut];Bt.parentId===U&&Ve.push(Bt.numPoints?Me(Bt):this.points[Bt.index])}if(Ve.length===0)throw new Error(me);return Ve}getLeaves(U,q,oe){const me=[];return this._appendLeaves(me,U,q=q||10,oe=oe||0,0),me}getTile(U,q,oe){const me=this.trees[this._limitZoom(U)],Ie=Math.pow(2,U),{extent:Oe,radius:De}=this.options,ke=De/Oe,Ve=(oe-ke)/Ie,ut=(oe+1+ke)/Ie,Bt={features:[]};return this._addTileFeatures(me.range((q-ke)/Ie,Ve,(q+1+ke)/Ie,ut),me.points,q,oe,Ie,Bt),q===0&&this._addTileFeatures(me.range(1-ke/Ie,Ve,1,ut),me.points,Ie,oe,Ie,Bt),q===Ie-1&&this._addTileFeatures(me.range(0,Ve,ke/Ie,ut),me.points,-1,oe,Ie,Bt),Bt.features.length?Bt:null}getClusterExpansionZoom(U){let q=this._getOriginZoom(U)-1;for(;q<=this.options.maxZoom;){const oe=this.getChildren(U);if(q++,oe.length!==1)break;U=oe[0].properties.cluster_id}return q}_appendLeaves(U,q,oe,me,Ie){const Oe=this.getChildren(q);for(const De of Oe){const ke=De.properties;if(ke&&ke.cluster?Ie+ke.point_count<=me?Ie+=ke.point_count:Ie=this._appendLeaves(U,ke.cluster_id,oe,me,Ie):Ie<me?Ie++:U.push(De),U.length===oe)break}return Ie}_addTileFeatures(U,q,oe,me,Ie,Oe){for(const De of U){const ke=q[De],Ve=ke.numPoints;let ut,Bt,gt;if(Ve)ut=qe(ke),Bt=ke.x,gt=ke.y;else{const Kt=this.points[ke.index];ut=Kt.properties,Bt=st(Kt.geometry.coordinates[0]),gt=yt(Kt.geometry.coordinates[1])}const nn={type:1,geometry:[[Math.round(this.options.extent*(Bt*Ie-oe)),Math.round(this.options.extent*(gt*Ie-me))]],tags:ut};let Qt;Ve?Qt=ke.id:this.options.generateId?Qt=ke.index:this.points[ke.index].id&&(Qt=this.points[ke.index].id),Qt!==void 0&&(nn.id=Qt),Oe.features.push(nn)}}_limitZoom(U){return Math.max(this.options.minZoom,Math.min(Math.floor(+U),this.options.maxZoom+1))}_cluster(U,q){const oe=[],{radius:me,extent:Ie,reduce:Oe,minPoints:De}=this.options,ke=me/(Ie*Math.pow(2,q));for(let Ve=0;Ve<U.length;Ve++){const ut=U[Ve];if(ut.zoom<=q)continue;ut.zoom=q;const Bt=this.trees[q+1],gt=Bt.within(ut.x,ut.y,ke),nn=ut.numPoints||1;let Qt=nn;for(const Kt of gt){const un=Bt.points[Kt];un.zoom>q&&(Qt+=un.numPoints||1)}if(Qt>nn&&Qt>=De){let Kt=ut.x*nn,un=ut.y*nn,yn=Oe&&nn>1?this._map(ut,!0):null;const Zn=(Ve<<5)+(q+1)+this.points.length;for(const sn of gt){const ei=Bt.points[sn];if(ei.zoom<=q)continue;ei.zoom=q;const ti=ei.numPoints||1;Kt+=ei.x*ti,un+=ei.y*ti,ei.parentId=Zn,Oe&&(yn||(yn=this._map(ut,!0)),Oe(yn,this._map(ei)))}ut.parentId=Zn,oe.push(_n(Kt/Qt,un/Qt,Zn,Qt,yn))}else if(oe.push(ut),Qt>1)for(const Kt of gt){const un=Bt.points[Kt];un.zoom<=q||(un.zoom=q,oe.push(un))}}return oe}_getOriginId(U){return U-this.points.length>>5}_getOriginZoom(U){return(U-this.points.length)%32}_map(U,q){if(U.numPoints)return q?$t({},U.properties):U.properties;const oe=this.points[U.index].properties,me=this.options.map(oe);return q&&me===oe?$t({},me):me}}function _n(se,U,q,oe,me){return{x:Ut(se),y:Ut(U),zoom:1/0,id:q,parentId:-1,numPoints:oe,properties:me}}function he(se,U){const[q,oe]=se.geometry.coordinates;return{x:Ut(st(q)),y:Ut(yt(oe)),zoom:1/0,index:U,parentId:-1}}function Me(se){return{type:"Feature",id:se.id,properties:qe(se),geometry:{type:"Point",coordinates:[(U=se.x,360*(U-.5)),Rt(se.y)]}};var U}function qe(se){const U=se.numPoints,q=U>=1e4?`${Math.round(U/1e3)}k`:U>=1e3?Math.round(U/100)/10+"k":U;return $t($t({},se.properties),{cluster:!0,cluster_id:se.id,point_count:U,point_count_abbreviated:q})}function st(se){return se/360+.5}function yt(se){const U=Math.sin(se*Math.PI/180),q=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return q<0?0:q>1?1:q}function Rt(se){const U=(180-360*se)*Math.PI/180;return 360*Math.atan(Math.exp(U))/Math.PI-90}function $t(se,U){for(const q in U)se[q]=U[q];return se}function Pt(se){return se.x}function Ft(se){return se.y}function St(se,U,q,oe){for(var me,Ie=oe,Oe=q-U>>1,De=q-U,ke=se[U],Ve=se[U+1],ut=se[q],Bt=se[q+1],gt=U+3;gt<q;gt+=3){var nn=Jt(se[gt],se[gt+1],ke,Ve,ut,Bt);if(nn>Ie)me=gt,Ie=nn;else if(nn===Ie){var Qt=Math.abs(gt-Oe);Qt<De&&(me=gt,De=Qt)}}Ie>oe&&(me-U>3&&St(se,U,me,oe),se[me+2]=Ie,q-me>3&&St(se,me,q,oe))}function Jt(se,U,q,oe,me,Ie){var Oe=me-q,De=Ie-oe;if(Oe!==0||De!==0){var ke=((se-q)*Oe+(U-oe)*De)/(Oe*Oe+De*De);ke>1?(q=me,oe=Ie):ke>0&&(q+=Oe*ke,oe+=De*ke)}return(Oe=se-q)*Oe+(De=U-oe)*De}function Wt(se,U,q,oe){var me={id:se===void 0?null:se,type:U,geometry:q,tags:oe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ie){var Oe=Ie.geometry,De=Ie.type;if(De==="Point"||De==="MultiPoint"||De==="LineString")on(Ie,Oe);else if(De==="Polygon"||De==="MultiLineString")for(var ke=0;ke<Oe.length;ke++)on(Ie,Oe[ke]);else if(De==="MultiPolygon")for(ke=0;ke<Oe.length;ke++)for(var Ve=0;Ve<Oe[ke].length;Ve++)on(Ie,Oe[ke][Ve])}(me),me}function on(se,U){for(var q=0;q<U.length;q+=3)se.minX=Math.min(se.minX,U[q]),se.minY=Math.min(se.minY,U[q+1]),se.maxX=Math.max(se.maxX,U[q]),se.maxY=Math.max(se.maxY,U[q+1])}function fn(se,U,q,oe){if(U.geometry){var me=U.geometry.coordinates,Ie=U.geometry.type,Oe=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),De=[],ke=U.id;if(q.promoteId?ke=U.properties[q.promoteId]:q.generateId&&(ke=oe||0),Ie==="Point")In(me,De);else if(Ie==="MultiPoint")for(var Ve=0;Ve<me.length;Ve++)In(me[Ve],De);else if(Ie==="LineString")Gn(me,De,Oe,!1);else if(Ie==="MultiLineString"){if(q.lineMetrics){for(Ve=0;Ve<me.length;Ve++)Gn(me[Ve],De=[],Oe,!1),se.push(Wt(ke,"LineString",De,U.properties));return}qn(me,De,Oe,!1)}else if(Ie==="Polygon")qn(me,De,Oe,!0);else{if(Ie!=="MultiPolygon"){if(Ie==="GeometryCollection"){for(Ve=0;Ve<U.geometry.geometries.length;Ve++)fn(se,{id:ke,geometry:U.geometry.geometries[Ve],properties:U.properties},q,oe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ve=0;Ve<me.length;Ve++){var ut=[];qn(me[Ve],ut,Oe,!0),De.push(ut)}}se.push(Wt(ke,Ie,De,U.properties))}}function In(se,U){U.push(_i(se[0])),U.push(or(se[1])),U.push(0)}function Gn(se,U,q,oe){for(var me,Ie,Oe=0,De=0;De<se.length;De++){var ke=_i(se[De][0]),Ve=or(se[De][1]);U.push(ke),U.push(Ve),U.push(0),De>0&&(Oe+=oe?(me*Ve-ke*Ie)/2:Math.sqrt(Math.pow(ke-me,2)+Math.pow(Ve-Ie,2))),me=ke,Ie=Ve}var ut=U.length-3;U[2]=1,St(U,0,ut,q),U[ut+2]=1,U.size=Math.abs(Oe),U.start=0,U.end=U.size}function qn(se,U,q,oe){for(var me=0;me<se.length;me++){var Ie=[];Gn(se[me],Ie,q,oe),U.push(Ie)}}function _i(se){return se/360+.5}function or(se){var U=Math.sin(se*Math.PI/180),q=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return q<0?0:q>1?1:q}function Ki(se,U,q,oe,me,Ie,Oe,De){if(oe/=U,Ie>=(q/=U)&&Oe<oe)return se;if(Oe<q||Ie>=oe)return null;for(var ke=[],Ve=0;Ve<se.length;Ve++){var ut=se[Ve],Bt=ut.geometry,gt=ut.type,nn=me===0?ut.minX:ut.minY,Qt=me===0?ut.maxX:ut.maxY;if(nn>=q&&Qt<oe)ke.push(ut);else if(!(Qt<q||nn>=oe)){var Kt=[];if(gt==="Point"||gt==="MultiPoint")ds(Bt,Kt,q,oe,me);else if(gt==="LineString")Lr(Bt,Kt,q,oe,me,!1,De.lineMetrics);else if(gt==="MultiLineString")nr(Bt,Kt,q,oe,me,!1);else if(gt==="Polygon")nr(Bt,Kt,q,oe,me,!0);else if(gt==="MultiPolygon")for(var un=0;un<Bt.length;un++){var yn=[];nr(Bt[un],yn,q,oe,me,!0),yn.length&&Kt.push(yn)}if(Kt.length){if(De.lineMetrics&&gt==="LineString"){for(un=0;un<Kt.length;un++)ke.push(Wt(ut.id,gt,Kt[un],ut.tags));continue}gt!=="LineString"&&gt!=="MultiLineString"||(Kt.length===1?(gt="LineString",Kt=Kt[0]):gt="MultiLineString"),gt!=="Point"&&gt!=="MultiPoint"||(gt=Kt.length===3?"Point":"MultiPoint"),ke.push(Wt(ut.id,gt,Kt,ut.tags))}}}return ke.length?ke:null}function ds(se,U,q,oe,me){for(var Ie=0;Ie<se.length;Ie+=3){var Oe=se[Ie+me];Oe>=q&&Oe<=oe&&(U.push(se[Ie]),U.push(se[Ie+1]),U.push(se[Ie+2]))}}function Lr(se,U,q,oe,me,Ie,Oe){for(var De,ke,Ve=yo(se),ut=me===0?jo:Gs,Bt=se.start,gt=0;gt<se.length-3;gt+=3){var nn=se[gt],Qt=se[gt+1],Kt=se[gt+2],un=se[gt+3],yn=se[gt+4],Zn=me===0?nn:Qt,sn=me===0?un:yn,ei=!1;Oe&&(De=Math.sqrt(Math.pow(nn-un,2)+Math.pow(Qt-yn,2))),Zn<q?sn>q&&(ke=ut(Ve,nn,Qt,un,yn,q),Oe&&(Ve.start=Bt+De*ke)):Zn>oe?sn<oe&&(ke=ut(Ve,nn,Qt,un,yn,oe),Oe&&(Ve.start=Bt+De*ke)):ur(Ve,nn,Qt,Kt),sn<q&&Zn>=q&&(ke=ut(Ve,nn,Qt,un,yn,q),ei=!0),sn>oe&&Zn<=oe&&(ke=ut(Ve,nn,Qt,un,yn,oe),ei=!0),!Ie&&ei&&(Oe&&(Ve.end=Bt+De*ke),U.push(Ve),Ve=yo(se)),Oe&&(Bt+=De)}var ti=se.length-3;nn=se[ti],Qt=se[ti+1],Kt=se[ti+2],(Zn=me===0?nn:Qt)>=q&&Zn<=oe&&ur(Ve,nn,Qt,Kt),ti=Ve.length-3,Ie&&ti>=3&&(Ve[ti]!==Ve[0]||Ve[ti+1]!==Ve[1])&&ur(Ve,Ve[0],Ve[1],Ve[2]),Ve.length&&U.push(Ve)}function yo(se){var U=[];return U.size=se.size,U.start=se.start,U.end=se.end,U}function nr(se,U,q,oe,me,Ie){for(var Oe=0;Oe<se.length;Oe++)Lr(se[Oe],U,q,oe,me,Ie,!1)}function ur(se,U,q,oe){se.push(U),se.push(q),se.push(oe)}function jo(se,U,q,oe,me,Ie){var Oe=(Ie-U)/(oe-U);return se.push(Ie),se.push(q+(me-q)*Oe),se.push(1),Oe}function Gs(se,U,q,oe,me,Ie){var Oe=(Ie-q)/(me-q);return se.push(U+(oe-U)*Oe),se.push(Ie),se.push(1),Oe}function El(se,U){for(var q=[],oe=0;oe<se.length;oe++){var me,Ie=se[oe],Oe=Ie.type;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")me=qs(Ie.geometry,U);else if(Oe==="MultiLineString"||Oe==="Polygon"){me=[];for(var De=0;De<Ie.geometry.length;De++)me.push(qs(Ie.geometry[De],U))}else if(Oe==="MultiPolygon")for(me=[],De=0;De<Ie.geometry.length;De++){for(var ke=[],Ve=0;Ve<Ie.geometry[De].length;Ve++)ke.push(qs(Ie.geometry[De][Ve],U));me.push(ke)}q.push(Wt(Ie.id,Oe,me,Ie.tags))}return q}function qs(se,U){var q=[];q.size=se.size,se.start!==void 0&&(q.start=se.start,q.end=se.end);for(var oe=0;oe<se.length;oe+=3)q.push(se[oe]+U,se[oe+1],se[oe+2]);return q}function lo(se,U){if(se.transformed)return se;var q,oe,me,Ie=1<<se.z,Oe=se.x,De=se.y;for(q=0;q<se.features.length;q++){var ke=se.features[q],Ve=ke.geometry,ut=ke.type;if(ke.geometry=[],ut===1)for(oe=0;oe<Ve.length;oe+=2)ke.geometry.push(Zs(Ve[oe],Ve[oe+1],U,Ie,Oe,De));else for(oe=0;oe<Ve.length;oe++){var Bt=[];for(me=0;me<Ve[oe].length;me+=2)Bt.push(Zs(Ve[oe][me],Ve[oe][me+1],U,Ie,Oe,De));ke.geometry.push(Bt)}}return se.transformed=!0,se}function Zs(se,U,q,oe,me,Ie){return[Math.round(q*(se*oe-me)),Math.round(q*(U*oe-Ie))]}function Zc(se,U,q,oe,me){for(var Ie=U===me.maxZoom?0:me.tolerance/((1<<U)*me.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:oe,z:U,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},De=0;De<se.length;De++){Oe.numFeatures++,Wc(Oe,se[De],Ie,me);var ke=se[De].minX,Ve=se[De].minY,ut=se[De].maxX,Bt=se[De].maxY;ke<Oe.minX&&(Oe.minX=ke),Ve<Oe.minY&&(Oe.minY=Ve),ut>Oe.maxX&&(Oe.maxX=ut),Bt>Oe.maxY&&(Oe.maxY=Bt)}return Oe}function Wc(se,U,q,oe){var me=U.geometry,Ie=U.type,Oe=[];if(Ie==="Point"||Ie==="MultiPoint")for(var De=0;De<me.length;De+=3)Oe.push(me[De]),Oe.push(me[De+1]),se.numPoints++,se.numSimplified++;else if(Ie==="LineString")Ia(Oe,me,se,q,!1,!1);else if(Ie==="MultiLineString"||Ie==="Polygon")for(De=0;De<me.length;De++)Ia(Oe,me[De],se,q,Ie==="Polygon",De===0);else if(Ie==="MultiPolygon")for(var ke=0;ke<me.length;ke++){var Ve=me[ke];for(De=0;De<Ve.length;De++)Ia(Oe,Ve[De],se,q,!0,De===0)}if(Oe.length){var ut=U.tags||null;if(Ie==="LineString"&&oe.lineMetrics){for(var Bt in ut={},U.tags)ut[Bt]=U.tags[Bt];ut.mapbox_clip_start=me.start/me.size,ut.mapbox_clip_end=me.end/me.size}var gt={geometry:Oe,type:Ie==="Polygon"||Ie==="MultiPolygon"?3:Ie==="LineString"||Ie==="MultiLineString"?2:1,tags:ut};U.id!==null&&(gt.id=U.id),se.features.push(gt)}}function Ia(se,U,q,oe,me,Ie){var Oe=oe*oe;if(oe>0&&U.size<(me?Oe:oe))q.numPoints+=U.length/3;else{for(var De=[],ke=0;ke<U.length;ke+=3)(oe===0||U[ke+2]>Oe)&&(q.numSimplified++,De.push(U[ke]),De.push(U[ke+1])),q.numPoints++;me&&function(Ve,ut){for(var Bt=0,gt=0,nn=Ve.length,Qt=nn-2;gt<nn;Qt=gt,gt+=2)Bt+=(Ve[gt]-Ve[Qt])*(Ve[gt+1]+Ve[Qt+1]);if(Bt>0===ut)for(gt=0,nn=Ve.length;gt<nn/2;gt+=2){var Kt=Ve[gt],un=Ve[gt+1];Ve[gt]=Ve[nn-2-gt],Ve[gt+1]=Ve[nn-1-gt],Ve[nn-2-gt]=Kt,Ve[nn-1-gt]=un}}(De,Ie),se.push(De)}}function Ws(se,U){var q=(U=this.options=function(me,Ie){for(var Oe in Ie)me[Oe]=Ie[Oe];return me}(Object.create(this.options),U)).debug;if(q&&console.time("preprocess data"),U.maxZoom<0||U.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(U.promoteId&&U.generateId)throw new Error("promoteId and generateId cannot be used together.");var oe=function(me,Ie){var Oe=[];if(me.type==="FeatureCollection")for(var De=0;De<me.features.length;De++)fn(Oe,me.features[De],Ie,De);else fn(Oe,me.type==="Feature"?me:{geometry:me},Ie);return Oe}(se,U);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",U.indexMaxZoom,U.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),oe=function(me,Ie){var Oe=Ie.buffer/Ie.extent,De=me,ke=Ki(me,1,-1-Oe,Oe,0,-1,2,Ie),Ve=Ki(me,1,1-Oe,2+Oe,0,-1,2,Ie);return(ke||Ve)&&(De=Ki(me,1,-Oe,1+Oe,0,-1,2,Ie)||[],ke&&(De=El(ke,1).concat(De)),Ve&&(De=De.concat(El(Ve,-1)))),De}(oe,U),oe.length&&this.splitTile(oe,0,0,0),q&&(oe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Zr(se,U,q){return 32*((1<<se)*q+U)+se}function fs(se,U){const q=se.tileID.canonical;if(!this._geoJSONIndex)return U(null,null);const oe=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!oe)return U(null,null);const me=new ne(oe.features);let Ie=ce(me);Ie.byteOffset===0&&Ie.byteLength===Ie.buffer.byteLength||(Ie=new Uint8Array(Ie)),U(null,{vectorTile:me,rawData:Ie.buffer})}Ws.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ws.prototype.splitTile=function(se,U,q,oe,me,Ie,Oe){for(var De=[se,U,q,oe],ke=this.options,Ve=ke.debug;De.length;){oe=De.pop(),q=De.pop(),U=De.pop(),se=De.pop();var ut=1<<U,Bt=Zr(U,q,oe),gt=this.tiles[Bt];if(!gt&&(Ve>1&&console.time("creation"),gt=this.tiles[Bt]=Zc(se,U,q,oe,ke),this.tileCoords.push({z:U,x:q,y:oe}),Ve)){Ve>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",U,q,oe,gt.numFeatures,gt.numPoints,gt.numSimplified),console.timeEnd("creation"));var nn="z"+U;this.stats[nn]=(this.stats[nn]||0)+1,this.total++}if(gt.source=se,me){if(U===ke.maxZoom||U===me)continue;var Qt=1<<me-U;if(q!==Math.floor(Ie/Qt)||oe!==Math.floor(Oe/Qt))continue}else if(U===ke.indexMaxZoom||gt.numPoints<=ke.indexMaxPoints)continue;if(gt.source=null,se.length!==0){Ve>1&&console.time("clipping");var Kt,un,yn,Zn,sn,ei,ti=.5*ke.buffer/ke.extent,ps=.5-ti,Go=.5+ti,et=1+ti;Kt=un=yn=Zn=null,sn=Ki(se,ut,q-ti,q+Go,0,gt.minX,gt.maxX,ke),ei=Ki(se,ut,q+ps,q+et,0,gt.minX,gt.maxX,ke),se=null,sn&&(Kt=Ki(sn,ut,oe-ti,oe+Go,1,gt.minY,gt.maxY,ke),un=Ki(sn,ut,oe+ps,oe+et,1,gt.minY,gt.maxY,ke),sn=null),ei&&(yn=Ki(ei,ut,oe-ti,oe+Go,1,gt.minY,gt.maxY,ke),Zn=Ki(ei,ut,oe+ps,oe+et,1,gt.minY,gt.maxY,ke),ei=null),Ve>1&&console.timeEnd("clipping"),De.push(Kt||[],U+1,2*q,2*oe),De.push(un||[],U+1,2*q,2*oe+1),De.push(yn||[],U+1,2*q+1,2*oe),De.push(Zn||[],U+1,2*q+1,2*oe+1)}}},Ws.prototype.getTile=function(se,U,q){var oe=this.options,me=oe.extent,Ie=oe.debug;if(se<0||se>24)return null;var Oe=1<<se,De=Zr(se,U=(U%Oe+Oe)%Oe,q);if(this.tiles[De])return lo(this.tiles[De],me);Ie>1&&console.log("drilling down to z%d-%d-%d",se,U,q);for(var ke,Ve=se,ut=U,Bt=q;!ke&&Ve>0;)Ve--,ut=Math.floor(ut/2),Bt=Math.floor(Bt/2),ke=this.tiles[Zr(Ve,ut,Bt)];return ke&&ke.source?(Ie>1&&console.log("found parent tile z%d-%d-%d",Ve,ut,Bt),Ie>1&&console.time("drilling down"),this.splitTile(ke.source,Ve,ut,Bt,se,U,q),Ie>1&&console.timeEnd("drilling down"),this.tiles[De]?lo(this.tiles[De],me):null):null};class Hc extends s.VectorTileWorkerSource{constructor(U,q,oe,me,Ie){super(U,q,oe,me,fs),Ie&&(this.loadGeoJSON=Ie)}loadData(U,q){const oe=U&&U.request,me=oe&&oe.collectResourceTiming;this.loadGeoJSON(U,(Ie,Oe)=>{if(Ie||!Oe)return q(Ie);if(typeof Oe!="object")return q(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`));{L(Oe,!0);try{if(U.filter){const ke=s.createExpression(U.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ke.result==="error")throw new Error(ke.value.map(ut=>`${ut.key}: ${ut.message}`).join(", "));Oe={type:"FeatureCollection",features:Oe.features.filter(ut=>ke.value.evaluate({zoom:0},ut))}}this._geoJSONIndex=U.cluster?new Fn(function({superclusterOptions:ke,clusterProperties:Ve}){if(!Ve||!ke)return ke;const ut={},Bt={},gt={accumulated:null,zoom:0},nn={properties:null},Qt=Object.keys(Ve);for(const Kt of Qt){const[un,yn]=Ve[Kt],Zn=s.createExpression(yn),sn=s.createExpression(typeof un=="string"?[un,["accumulated"],["get",Kt]]:un);ut[Kt]=Zn.value,Bt[Kt]=sn.value}return ke.map=Kt=>{nn.properties=Kt;const un={};for(const yn of Qt)un[yn]=ut[yn].evaluate(gt,nn);return un},ke.reduce=(Kt,un)=>{nn.properties=un;for(const yn of Qt)gt.accumulated=Kt[yn],Kt[yn]=Bt[yn].evaluate(gt,nn)},ke}(U)).load(Oe.features):function(ke,Ve){return new Ws(ke,Ve)}(Oe,U.geojsonVtOptions)}catch(ke){return q(ke)}this.loaded={};const De={};if(me){const ke=s.getPerformanceMeasurement(oe);ke&&(De.resourceTiming={},De.resourceTiming[U.source]=JSON.parse(JSON.stringify(ke)))}q(null,De)}})}reloadTile(U,q){const oe=this.loaded;return oe&&oe[U.uid]?super.reloadTile(U,q):this.loadTile(U,q)}loadGeoJSON(U,q){if(U.request)s.getJSON(U.request,q);else{if(typeof U.data!="string")return q(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`));try{return q(null,JSON.parse(U.data))}catch{return q(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(U,q){try{q(null,this._geoJSONIndex.getClusterExpansionZoom(U.clusterId))}catch(oe){q(oe)}}getClusterChildren(U,q){try{q(null,this._geoJSONIndex.getChildren(U.clusterId))}catch(oe){q(oe)}}getClusterLeaves(U,q){try{q(null,this._geoJSONIndex.getLeaves(U.clusterId,U.limit,U.offset))}catch(oe){q(oe)}}}class Hs{constructor(U){this.self=U,this.actor=new s.Actor(U,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:Hc},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(q,oe)=>{if(this.workerSourceTypes[q])throw new Error(`Worker source with name "${q}" already registered.`);this.workerSourceTypes[q]=oe},this.self.registerRTLTextPlugin=q=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=q.applyArabicShaping,s.plugin.processBidirectionalText=q.processBidirectionalText,s.plugin.processStyledBidirectionalText=q.processStyledBidirectionalText}}clearCaches(U,q,oe){delete this.layerIndexes[U],delete this.availableImages[U],delete this.workerSources[U],delete this.demWorkerSources[U],oe()}checkIfReady(U,q,oe){oe()}setReferrer(U,q){this.referrer=q}spriteLoaded(U,q){this.isSpriteLoaded[U]=q;for(const oe in this.workerSources[U]){const me=this.workerSources[U][oe];for(const Ie in me)me[Ie]instanceof s.VectorTileWorkerSource&&(me[Ie].isSpriteLoaded=q,me[Ie].fire(new s.Event("isSpriteLoaded")))}}setImages(U,q,oe){this.availableImages[U]=q;for(const me in this.workerSources[U]){const Ie=this.workerSources[U][me];for(const Oe in Ie)Ie[Oe].availableImages=q}oe()}enableTerrain(U,q,oe){this.terrain=q,oe()}setProjection(U,q){this.projections[U]=s.getProjection(q)}setLayers(U,q,oe){this.getLayerIndex(U).replace(q),oe()}updateLayers(U,q,oe){this.getLayerIndex(U).update(q.layers,q.removedIds),oe()}loadTile(U,q,oe){const me=this.enableTerrain?s.extend({enableTerrain:this.terrain},q):q;me.projection=this.projections[U]||this.defaultProjection,this.getWorkerSource(U,q.type,q.source).loadTile(me,oe)}loadDEMTile(U,q,oe){const me=this.enableTerrain?s.extend({buildQuadTree:this.terrain},q):q;this.getDEMWorkerSource(U,q.source).loadTile(me,oe)}reloadTile(U,q,oe){const me=this.enableTerrain?s.extend({enableTerrain:this.terrain},q):q;me.projection=this.projections[U]||this.defaultProjection,this.getWorkerSource(U,q.type,q.source).reloadTile(me,oe)}abortTile(U,q,oe){this.getWorkerSource(U,q.type,q.source).abortTile(q,oe)}removeTile(U,q,oe){this.getWorkerSource(U,q.type,q.source).removeTile(q,oe)}removeSource(U,q,oe){if(!this.workerSources[U]||!this.workerSources[U][q.type]||!this.workerSources[U][q.type][q.source])return;const me=this.workerSources[U][q.type][q.source];delete this.workerSources[U][q.type][q.source],me.removeSource!==void 0?me.removeSource(q,oe):oe()}loadWorkerSource(U,q,oe){try{this.self.importScripts(q.url),oe()}catch(me){oe(me.toString())}}syncRTLPluginState(U,q,oe){try{s.plugin.setState(q);const me=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&me!=null){this.self.importScripts(me);const Ie=s.plugin.isParsed();oe(Ie?void 0:new Error(`RTL Text Plugin failed to import scripts from ${me}`),Ie)}}catch(me){oe(me.toString())}}getAvailableImages(U){let q=this.availableImages[U];return q||(q=[]),q}getLayerIndex(U){let q=this.layerIndexes[U];return q||(q=this.layerIndexes[U]=new A),q}getWorkerSource(U,q,oe){if(this.workerSources[U]||(this.workerSources[U]={}),this.workerSources[U][q]||(this.workerSources[U][q]={}),!this.workerSources[U][q][oe]){const me={send:(Ie,Oe,De,ke,Ve,ut)=>{this.actor.send(Ie,Oe,De,U,Ve,ut)},scheduler:this.actor.scheduler};this.workerSources[U][q][oe]=new this.workerSourceTypes[q](me,this.getLayerIndex(U),this.getAvailableImages(U),this.isSpriteLoaded[U])}return this.workerSources[U][q][oe]}getDEMWorkerSource(U,q){return this.demWorkerSources[U]||(this.demWorkerSources[U]={}),this.demWorkerSources[U][q]||(this.demWorkerSources[U][q]=new P),this.demWorkerSources[U][q]}enforceCacheSizeLimit(U,q){s.enforceCacheSizeLimit(q)}getWorkerPerformanceMetrics(U,q,oe){oe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Hs(self)),Hs}),m(["./shared"],function(s){function w(f,r){if(Array.isArray(f)){if(!Array.isArray(r)||f.length!==r.length)return!1;for(let u=0;u<f.length;u++)if(!w(f[u],r[u]))return!1;return!0}if(typeof f=="object"&&f!==null&&r!==null){if(typeof r!="object"||Object.keys(f).length!==Object.keys(r).length)return!1;for(const u in f)if(!w(f[u],r[u]))return!1;return!0}return f===r}var E=A;function A(f){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,y,b=new Blob([""],{type:"text/javascript"}),C=URL.createObjectURL(b);try{y=new Worker(C),g=!0}catch{g=!1}return y&&y.terminate(),URL.revokeObjectURL(C),g}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var g=document.createElement("canvas");g.width=g.height=1;var y=g.getContext("2d");if(!y)return!1;var b=y.getImageData(0,0,1,1);return b&&b.width===g.width}()?(P[u=r&&r.failIfMajorPerformanceCaveat]===void 0&&(P[u]=function(g){var y,b=function(C){var I=document.createElement("canvas"),M=Object.create(A.webGLContextAttributes);return M.failIfMajorPerformanceCaveat=C,I.getContext("webgl",M)||I.getContext("experimental-webgl",M)}(g);if(!b)return!1;try{y=b.createShader(b.VERTEX_SHADER)}catch{return!1}return!(!y||b.isContextLost())&&(b.shaderSource(y,"void main() {}"),b.compileShader(y),b.getShaderParameter(y,b.COMPILE_STATUS)===!0)}(u)),P[u]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var u}(f)}var P={};function L(f,r,u){const g=s.window.document.createElement(f);return r!==void 0&&(g.className=r),u&&u.appendChild(g),g}function D(f,r,u){const g=s.window.document.createElementNS("http://www.w3.org/2000/svg",f);for(const y of Object.keys(r))g.setAttributeNS(null,y,r[y]);return u&&u.appendChild(g),g}A.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const N=s.window.document&&s.window.document.documentElement.style,Z=N&&N.userSelect!==void 0?"userSelect":"WebkitUserSelect";let de;function ne(){N&&Z&&(de=N[Z],N[Z]="none")}function ce(){N&&Z&&(N[Z]=de)}function K(f){f.preventDefault(),f.stopPropagation(),s.window.removeEventListener("click",K,!0)}function Se(){s.window.addEventListener("click",K,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",K,!0)},0)}function Y(f,r){const u=f.getBoundingClientRect();return ve(f,u,r)}function _e(f,r){const u=f.getBoundingClientRect(),g=[];for(let y=0;y<r.length;y++)g.push(ve(f,u,r[y]));return g}function fe(f){return s.window.InstallTrigger!==void 0&&f.button===2&&f.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function ve(f,r,u){const g=f.offsetWidth===r.width?1:f.offsetWidth/r.width;return new s.pointGeometry((u.clientX-r.left)*g,(u.clientY-r.top)*g)}function Ee(f,r){var u=r[0],g=r[1],y=r[2],b=r[3],C=u*b-y*g;return C?(f[0]=b*(C=1/C),f[1]=-g*C,f[2]=-y*C,f[3]=u*C,f):null}function be(f){const{userImage:r}=f;return!!(r&&r.render&&r.render())&&(f.data.replace(new Uint8Array(r.data.buffer)),!0)}class Re extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:u,callback:g}of this.requestors)this._notify(u,g);this.requestors=[]}}hasImage(r){return!!this.getImage(r)}getImage(r){return this.images[r]}addImage(r,u){this._validate(r,u)&&(this.images[r]=u)}_validate(r,u){let g=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),g=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),g=!1),this._validateContent(u.content,u)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),g=!1),g}_validateStretch(r,u){if(!r)return!0;let g=0;for(const y of r){if(y[0]<g||y[1]<y[0]||u<y[1])return!1;g=y[1]}return!0}_validateContent(r,u){return!(r&&(r.length!==4||r[0]<0||u.data.width<r[0]||r[1]<0||u.data.height<r[1]||r[2]<0||u.data.width<r[2]||r[3]<0||u.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,u){u.version=this.images[r].version+1,this.images[r]=u,this.updatedImages[r]=!0}removeImage(r){const u=this.images[r];delete this.images[r],delete this.patterns[r],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,u){let g=!0;if(!this.isLoaded())for(const y of r)this.images[y]||(g=!1);this.isLoaded()||g?this._notify(r,u):this.requestors.push({ids:r,callback:u})}_notify(r,u){const g={};for(const y of r){this.images[y]||this.fire(new s.Event("styleimagemissing",{id:y}));const b=this.images[y];b?g[y]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:Boolean(b.userImage&&b.userImage.render)}:s.warnOnce(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,g)}getPixelSize(){const{width:r,height:u}=this.atlasImage;return{width:r,height:u}}getPattern(r){const u=this.patterns[r],g=this.getImage(r);if(!g)return null;if(u&&u.position.version===g.version)return u.position;if(u)u.position.version=g.version;else{const y={w:g.data.width+2,h:g.data.height+2,x:0,y:0},b=new s.ImagePosition(y,g);this.patterns[r]={bin:y,position:b}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const u=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(r,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const b in this.patterns)r.push(this.patterns[b].bin);const{w:u,h:g}=s.potpack(r),y=this.atlasImage;y.resize({width:u||1,height:g||1});for(const b in this.patterns){const{bin:C}=this.patterns[b],I=C.x+1,M=C.y+1,B=this.images[b].data,O=B.width,j=B.height;s.RGBAImage.copy(B,y,{x:0,y:0},{x:I,y:M},{width:O,height:j}),s.RGBAImage.copy(B,y,{x:0,y:j-1},{x:I,y:M-1},{width:O,height:1}),s.RGBAImage.copy(B,y,{x:0,y:0},{x:I,y:M+j},{width:O,height:1}),s.RGBAImage.copy(B,y,{x:O-1,y:0},{x:I-1,y:M},{width:1,height:j}),s.RGBAImage.copy(B,y,{x:0,y:0},{x:I+O,y:M},{width:1,height:j})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const u of r){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const g=this.images[u];be(g)&&this.updateImage(u,g)}}}const ze=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(f,r){return function([u,g,y]){const b=s.degToRad(g+90),C=s.degToRad(y);return{x:u*Math.cos(b)*Math.sin(C),y:u*Math.sin(b)*Math.sin(C),z:u*Math.cos(C),azimuthal:g,polar:y}}(f.expression.evaluate(r))}interpolate(f,r,u){return{x:s.number(f.x,r.x,u),y:s.number(f.y,r.y,u),z:s.number(f.z,r.z,u),azimuthal:s.number(f.azimuthal,r.azimuthal,u),polar:s.number(f.polar,r.polar,u)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)}),Je="-transition";class ct extends s.Evented{constructor(r){super(),this._transitionable=new s.Transitionable(ze),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,u={}){if(!this._validate(s.validateLight,r,u))for(const g in r){const y=r[g];s.endsWith(g,Je)?this._transitionable.setTransition(g.slice(0,-Je.length),y):this._transitionable.setValue(g,y)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,g){return(!g||g.validate!==!1)&&s.emitValidationErrors(this,r.call(s.validateStyle,s.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const nt=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)}),ft="-transition";class Pe extends s.Evented{constructor(r,u){super(),this._transitionable=new s.Transitionable(nt),this.set(r),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=u}get(){return this._transitionable.serialize()}set(r){for(const u in r){const g=r[u];s.endsWith(u,ft)?this._transitionable.setTransition(u.slice(0,-ft.length),g):this._transitionable.setValue(u,g)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}}function at(f,r,u,g){const y=s.smoothstep(45,65,u),[b,C]=Gt(f,g),I=s.length(r);let M=1-Math.min(1,Math.exp((I-b)/(C-b)*-6));return M*=M*M,M=Math.min(1,1.00747*M),M*y*f.alpha}function Gt(f,r){const u=.5/Math.tan(.5*r);return[f.range[0]+u,f.range[1]+u]}const pt=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])}),Lt="-transition";class qt extends s.Evented{constructor(r,u){super(),this._transitionable=new s.Transitionable(pt),this.set(r),this._transitioning=this._transitionable.untransitioned(),this._transform=u}get state(){const r=this._transform,u=r.projection.name==="globe",g=s.globeToMercatorTransition(r.zoom),y=this.properties.get("range"),b=[.5,3];return{range:u?[s.number(b[0],y[0],g),s.number(b[1],y[1],g)]:y,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,u={}){if(!this._validate(s.validateFog,r,u)){for(const g of Object.keys(s.spec.fog))r&&r[g]===void 0&&(r[g]=s.spec.fog[g].default);for(const g in r){const y=r[g];s.endsWith(g,Lt)?this._transitionable.setTransition(g.slice(0,-Lt.length),y):this._transitionable.setValue(g,y)}}}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,r))*u.a}getOpacityAtLatLng(r,u){return this._transform.projection.supportsFog?function(g,y,b){const C=s.MercatorCoordinate.fromLngLat(y),I=b.elevation?b.elevation.getAtPointOrZero(C):0,M=[C.x,C.y,I];return s.transformMat4(M,M,b.mercatorFogMatrix),at(g,M,b.pitch,b._fov)}(this.state,r,u):0}getFovAdjustedRange(r){return this._transform.projection.supportsFog?Gt(this.state,r):[0,1]}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,g){return(!g||g.validate!==!1)&&s.emitValidationErrors(this,r.call(s.validateStyle,s.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class Bn{constructor(r,u){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const g=this.workerPool.acquire(this.id);for(let y=0;y<g.length;y++){const b=new Bn.Actor(g[y],u,this.id);b.name=`Worker ${y}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,u,g){s.asyncAll(this.actors,(y,b)=>{y.send(r,u,b)},g=g||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function kt(f,r,u){return r*(s.EXTENT/(f.tileSize*Math.pow(2,u-f.tileID.overscaledZ)))}Bn.Actor=s.Actor;class Qe{constructor(r,u,g,y){this.screenBounds=r,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,y)}static createFromScreenPoints(r,u){let g,y;if(r instanceof s.pointGeometry||typeof r[0]=="number"){const b=s.pointGeometry.convert(r);g=[b],y=u.isPointAboveHorizon(b)}else{const b=s.pointGeometry.convert(r[0]),C=s.pointGeometry.convert(r[1]);g=[b,C],y=s.polygonizeBounds(b,C).every(I=>u.isPointAboveHorizon(I))}return new Qe(g,u.getCameraPoint(),y,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],y=s.polygonizeBounds(u,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<g.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?y[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(y[3]=this.cameraPoint)),s.bufferConvexPolygon(y,r)}bufferedCameraGeometryGlobe(r){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],y=s.polygonizeBounds(u,g,r),b=this.cameraPoint.clone();switch(3*((b.y>u.y)+(b.y>g.y))+((b.x>u.x)+(b.x>g.x))){case 0:y[0]=b,y[4]=b.clone();break;case 1:y.splice(1,0,b);break;case 2:y[1]=b;break;case 3:y.splice(4,0,b);break;case 5:y.splice(2,0,b);break;case 6:y[3]=b;break;case 7:y.splice(3,0,b);break;case 8:y[2]=b}return y}containsTile(r,u,g,y=0){const b=r.queryPadding/u._pixelsPerMercatorPixel+1,C=g?this._bufferedCameraMercator(b,u):this._bufferedScreenMercator(b,u);let I=r.tileID.wrap+(C.unwrapped?y:0);const M=C.polygon.map(te=>s.getTilePoint(r.tileTransform,te,I));if(!s.polygonIntersectsBox(M,0,0,s.EXTENT,s.EXTENT))return;I=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?y:0);const B=this.screenGeometryMercator.polygon.map(te=>s.getTileVec3(r.tileTransform,te,I)),O=B.map(te=>new s.pointGeometry(te[0],te[1])),j=u.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),H=s.getTileVec3(r.tileTransform,j,I),Q=B.map(te=>{const W=s.sub(te,te,H);return s.normalize(W,W),new s.Ray(H,W)}),J=kt(r,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:O,tilespaceRays:Q,bufferedTilespaceGeometry:M,bufferedTilespaceBounds:(ee=s.getBounds(M),ee.min.x=s.clamp(ee.min.x,0,s.EXTENT),ee.min.y=s.clamp(ee.min.y,0,s.EXTENT),ee.max.x=s.clamp(ee.max.x,0,s.EXTENT),ee.max.y=s.clamp(ee.max.y,0,s.EXTENT),ee),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:J};var ee}_bufferedScreenMercator(r,u){const g=Ut(r);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let y;return y=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),u):{polygon:this.bufferedScreenGeometry(r).map(b=>u.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[g]=y,y}}_bufferedCameraMercator(r,u){const g=Ut(r);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let y;return y=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),u):{polygon:this.bufferedCameraGeometry(r).map(b=>u.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[g]=y,y}}_projectAndResample(r,u){const g=function(b,C){const I=s.multiply([],C.pixelMatrix,C.globeMatrix),M=[0,-s.GLOBE_RADIUS,0,1],B=[0,s.GLOBE_RADIUS,0,1],O=[0,0,0,1];s.transformMat4$1(M,M,I),s.transformMat4$1(B,B,I),s.transformMat4$1(O,O,I);const j=new s.pointGeometry(M[0]/M[3],M[1]/M[3]),H=new s.pointGeometry(B[0]/B[3],B[1]/B[3]),Q=s.polygonContainsPoint(b,j)&&M[3]<O[3],J=s.polygonContainsPoint(b,H)&&B[3]<O[3];if(!Q&&!J)return null;const ee=function(Ae,Be,Ne){for(let Ge=1;Ge<Ae.length;Ge++){const wt=Tt(Be.pointCoordinate3D(Ae[Ge-1]).x),Fe=Tt(Be.pointCoordinate3D(Ae[Ge]).x);if(Ne<0){if(wt<Fe)return{idx:Ge,t:-wt/(Fe-1-wt)}}else if(Fe<wt)return{idx:Ge,t:(1-wt)/(Fe+1-wt)}}return null}(b,C,Q?-1:1);if(!ee)return null;const{idx:te,t:W}=ee;let ue=te>1?bt(b.slice(0,te),C):[],ae=te<b.length?bt(b.slice(te),C):[];ue=ue.map(Ae=>new s.pointGeometry(Tt(Ae.x),Ae.y)),ae=ae.map(Ae=>new s.pointGeometry(Tt(Ae.x),Ae.y));const pe=[...ue];pe.length===0&&pe.push(ae[ae.length-1]);const Ce=s.number(pe[pe.length-1].y,(ae.length===0?ue[0]:ae[0]).y,W);let we;return we=Q?[new s.pointGeometry(0,Ce),new s.pointGeometry(0,0),new s.pointGeometry(1,0),new s.pointGeometry(1,Ce)]:[new s.pointGeometry(1,Ce),new s.pointGeometry(1,1),new s.pointGeometry(0,1),new s.pointGeometry(0,Ce)],pe.push(...we),ae.length===0?pe.push(ue[0]):pe.push(...ae),{polygon:pe.map(Ae=>new s.MercatorCoordinate(Ae.x,Ae.y)),unwrapped:!1}}(r,u);if(g)return g;const y=function(b,C){let I=!1,M=-1/0,B=0;for(let j=0;j<b.length-1;j++)b[j].x>M&&(M=b[j].x,B=j);for(let j=0;j<b.length-1;j++){const H=(B+j)%(b.length-1),Q=b[H],J=b[H+1];Math.abs(Q.x-J.x)>.5&&(Q.x<J.x?(Q.x+=1,H===0&&(b[b.length-1].x+=1)):(J.x+=1,H+1===b.length-1&&(b[0].x+=1)),I=!0)}const O=s.mercatorXfromLng(C.center.lng);return I&&O<Math.abs(O-1)&&b.forEach(j=>{j.x-=1}),{polygon:b,unwrapped:I}}(bt(r,u).map(b=>new s.pointGeometry(Tt(b.x),b.y)),u);return{polygon:y.polygon.map(b=>new s.MercatorCoordinate(b.x,b.y)),unwrapped:y.unwrapped}}}function bt(f,r){return s.resample(f,u=>{const g=r.pointCoordinate3D(u);u.x=g.x,u.y=g.y},1/256)}function Tt(f){return f<0?1+f%1:f%1}function Ut(f){return 100*f|0}function pn(f,r,u,g,y){const b=function(C,I){if(C)return y(C);if(I){f.url&&I.tiles&&f.tiles&&delete f.tiles;const M=s.pick(s.extend(I,f),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(M.vectorLayers=I.vector_layers,M.vectorLayerIds=M.vectorLayers.map(B=>B.id)),M.tiles=r.canonicalizeTileset(M,f.url),y(null,M)}};return f.url?s.getJSON(r.transformRequest(r.normalizeSourceURL(f.url,null,u,g),s.ResourceType.Source),b):s.exported.frame(()=>b(null,f))}class Fn{constructor(r,u,g){this.bounds=s.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=u||0,this.maxzoom=g||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const u=Math.pow(2,r.z),g=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*u),y=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*u),b=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*u),C=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*u);return r.x>=g&&r.x<b&&r.y>=y&&r.y<C}}class _n{constructor(r,u,g){this.context=r;const y=r.gl;this.buffer=y.createBuffer(),this.dynamicDraw=Boolean(g),this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const he={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Me{constructor(r,u,g,y){this.length=u.length,this.attributes=g,this.itemSize=u.bytesPerElement,this.dynamicDraw=y,this.context=r;const b=r.gl;this.buffer=b.createBuffer(),r.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,u){for(let g=0;g<this.attributes.length;g++){const y=u.attributes[this.attributes[g].name];y!==void 0&&r.enableVertexAttribArray(y)}}setVertexAttribPointers(r,u,g){for(let y=0;y<this.attributes.length;y++){const b=this.attributes[y],C=u.attributes[b.name];C!==void 0&&r.vertexAttribPointer(C,b.components,r[he[b.type]],!1,this.itemSize,b.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class qe{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class st extends qe{getDefault(){return s.Color.transparent}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class yt extends qe{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Rt extends qe{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class $t extends qe{getDefault(){return[!0,!0,!0,!0]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Pt extends qe{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Ft extends qe{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class St extends qe{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const u=this.current;(r.func!==u.func||r.ref!==u.ref||r.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Jt extends qe{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Wt extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=r,this.dirty=!1}}class on extends qe{getDefault(){return[0,1]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class fn extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=r,this.dirty=!1}}class In extends qe{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Gn extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.BLEND):u.disable(u.BLEND),this.current=r,this.dirty=!1}}class qn extends qe{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class _i extends qe{getDefault(){return s.Color.transparent}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class or extends qe{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Ki extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=r,this.dirty=!1}}class ds extends qe{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Lr extends qe{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class yo extends qe{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class nr extends qe{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class ur extends qe{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class jo extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Gs extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class El extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class qs extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class lo extends qe{getDefault(){return null}set(r){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Zs extends qe{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class Zc extends qe{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class Wc extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Ia extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Ws extends qe{constructor(r,u){super(r),this.context=r,this.parent=u}getDefault(){return null}}class Zr extends Ws{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class fs extends Ws{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Hc extends fs{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Hs{constructor(r,u,g,y){this.context=r,this.width=u,this.height=g;const b=this.framebuffer=r.gl.createFramebuffer();this.colorAttachment=new Zr(r,b),y&&(this.depthAttachment=new fs(r,b))}destroy(){const r=this.context.gl,u=this.colorAttachment.get();if(u&&r.deleteTexture(u),this.depthAttachment){const g=this.depthAttachment.get();g&&r.deleteRenderbuffer(g)}r.deleteFramebuffer(this.framebuffer)}}class se{constructor(r,u=!1){if(this.gl=r,this.isWebGL2=u,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),u){const g=r;this.extVertexArrayObject={createVertexArrayOES:g.createVertexArray.bind(r),deleteVertexArrayOES:g.deleteVertexArray.bind(r),bindVertexArrayOES:g.bindVertexArray.bind(r)}}this.clearColor=new st(this),this.clearDepth=new yt(this),this.clearStencil=new Rt(this),this.colorMask=new $t(this),this.depthMask=new Pt(this),this.stencilMask=new Ft(this),this.stencilFunc=new St(this),this.stencilOp=new Jt(this),this.stencilTest=new Wt(this),this.depthRange=new on(this),this.depthTest=new fn(this),this.depthFunc=new In(this),this.blend=new Gn(this),this.blendFunc=new qn(this),this.blendColor=new _i(this),this.blendEquation=new or(this),this.cullFace=new Ki(this),this.cullFaceSide=new ds(this),this.frontFace=new Lr(this),this.program=new yo(this),this.activeTexture=new nr(this),this.viewport=new ur(this),this.bindFramebuffer=new jo(this),this.bindRenderbuffer=new Gs(this),this.bindTexture=new El(this),this.bindVertexBuffer=new qs(this),this.bindElementBuffer=new lo(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Zs(this),this.pixelStoreUnpack=new Zc(this),this.pixelStoreUnpackPremultiplyAlpha=new Wc(this),this.pixelStoreUnpackFlipY=new Ia(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),u||(this.extTextureHalfFloat=r.getExtension("OES_texture_half_float")),(u||this.extTextureHalfFloat&&r.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=u||r.getExtension("OES_standard_derivatives"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,u){return new _n(this,r,u)}createVertexBuffer(r,u,g){return new Me(this,r,u,g)}createRenderbuffer(r,u,g){const y=this.gl,b=y.createRenderbuffer();return this.bindRenderbuffer.set(b),y.renderbufferStorage(y.RENDERBUFFER,r,u,g),this.bindRenderbuffer.set(null),b}createFramebuffer(r,u,g){return new Hs(this,r,u,g)}clear({color:r,depth:u,stencil:g}){const y=this.gl;let b=0;r&&(b|=y.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(b|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),g!==void 0&&(b|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),y.clear(b)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){w(r.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class U extends s.Evented{constructor(r,u,g,y){if(super(),this.id=r,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(u,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(r){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map._worldview;this._tileJSONRequest=pn(this._options,this.map._requestManager,u,g,(y,b)=>{this._tileJSONRequest=null,this._loaded=!0,y?(u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),g&&g.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new s.ErrorEvent(y))):b&&(s.extend(this,b),b.bounds&&(this.tileBounds=new Fn(b.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(b.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),r&&r(y)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(r,u){const g=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(g,s.ResourceType.Tile),data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile};if(y.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=u:r.request=r.actor.send("reloadTile",y,b.bind(this));else if(r.actor=this._tileWorkers[g]=this._tileWorkers[g]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",y,b.bind(this),void 0,!0);else{const C=s.loadVectorTile.call({deduped:this._deduped},y,(I,M)=>{I||!M?b.call(this,I):(y.data={cacheControl:M.cacheControl,expires:M.expires,rawData:M.rawData.slice(0)},r.actor&&r.actor.send("loadTile",y,b.bind(this),void 0,!0))},!0);r.request={cancel:C}}function b(C,I){return delete r.request,r.aborted?u(null):C&&C.status!==404?u(C):(I&&I.resourceTiming&&(r.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&r.setExpiryData(I),r.loadVectorData(I,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id})}unloadTile(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class q extends s.Evented{constructor(r,u,g,y){super(),this.id=r,this.dispatcher=g,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},u),s.extend(this,s.pick(u,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=pn(this._options,this.map._requestManager,null,null,(u,g)=>{this._tileJSONRequest=null,this._loaded=!0,u?this.fire(new s.ErrorEvent(u)):g&&(s.extend(this,g),g.bounds&&(this.tileBounds=new Fn(g.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(g.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),r&&r(u)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,u){const g=s.exported.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);r.request=s.getImage(this.map._requestManager.transformRequest(y,s.ResourceType.Tile),(b,C,I,M)=>(delete r.request,r.aborted?(r.state="unloaded",u(null)):b?(r.state="errored",u(b)):C?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:I,expires:M}),r.setTexture(C,this.map.painter),r.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void u(null)):u(null)))}static loadTileData(r,u,g){r.setTexture(u,g)}static unloadTileData(r,u){r.texture&&u.saveTileTexture(r.texture)}abortTile(r,u){r.request&&(r.request.cancel(),delete r.request),u()}unloadTile(r,u){r.texture&&this.map.painter.saveTileTexture(r.texture),u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let oe;function me(f,r,u,g,y,b,C,I){const M=[f,u,y,r,g,b,1,1,1],B=[C,I,1],O=s.adjoint([],M),[j,H,Q]=s.transformMat3(B,B,s.transpose(O,O));return s.multiply$1(M,[j,0,0,0,H,0,0,0,Q],M)}class Ie extends s.Evented{constructor(r,u,g,y){super(),this.id=r,this.dispatcher=g,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=u,this._dirty=!1}load(r,u){this._loaded=u||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(g,y)=>{if(this._imageRequest=null,this._loaded=!0,g)this.fire(new s.ErrorEvent(g));else if(y){const{HTMLImageElement:b}=s.window;this.image=y instanceof b?s.exported.getImageData(y):y,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading()}})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(r){this.coordinates=r,this._boundsArray=void 0;const u=r.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(g){let y=1/0,b=1/0,C=-1/0,I=-1/0;for(const j of g)y=Math.min(y,j.x),b=Math.min(b,j.y),C=Math.max(C,j.x),I=Math.max(I,j.y);const M=Math.max(C-y,I-b),B=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),O=Math.pow(2,B);return new s.CanonicalTileID(B,Math.floor((y+C)/2*O),Math.floor((b+I)/2*O))}(u),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(r){for(const M in this.tiles){const B=this.tiles[M];B.state!=="loaded"&&(B.state="loaded",B.texture=this.texture)}if(this._boundsArray)return;const u=s.tileTransform(this.tileID,this.map.transform.projection),[g,y,b,C]=this.coordinates.map(M=>{const B=u.projection.project(M[0],M[1]);return s.getTilePoint(u,B)._round()});this.perspectiveTransform=function(M,B,O,j,H,Q,J,ee,te,W){const ue=me(0,0,M,0,0,B,M,B),ae=me(O,j,H,Q,J,ee,te,W);return s.multiply$1(ae,s.adjoint(ue,ue),ae),[ae[6]/ae[8]*M/s.EXTENT,ae[7]/ae[8]*B/s.EXTENT]}(this.width,this.height,g.x,g.y,y.x,y.y,C.x,C.y,b.x,b.y);const I=this._boundsArray=new s.StructArrayLayout4i8;I.emplaceBack(g.x,g.y,0,0),I.emplaceBack(y.x,y.y,s.EXTENT,0),I.emplaceBack(C.x,C.y,0,s.EXTENT),I.emplaceBack(b.x,b.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=r.createVertexBuffer(I,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,u=r.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(r,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(r)}loadTile(r,u){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},u(null)):(r.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Oe={vector:U,raster:q,"raster-dem":class extends q{constructor(f,r,u,g){super(f,r,u,g),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(f,r){const u=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(y,b){y&&(f.state="errored",r(y)),b&&(f.dem=b,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",r(null))}f.request=s.getImage(this.map._requestManager.transformRequest(u,s.ResourceType.Tile),function(y,b,C,I){if(delete f.request,f.aborted)f.state="unloaded",r(null);else if(y)f.state="errored",r(y);else if(b){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:C,expires:I});const M=s.window.ImageBitmap&&b instanceof s.window.ImageBitmap&&(oe==null&&(oe=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),oe),B=1-(b.width-s.prevPowerOfTwo(b.width))/2;B<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const O=M?b:s.exported.getImageData(b,B),j={uid:f.uid,coord:f.tileID,source:this.id,rawImageData:O,encoding:this.encoding,padding:B};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",j,g.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(f){const r=f.canonical,u=Math.pow(2,r.z),g=(r.x-1+u)%u,y=r.x===0?f.wrap-1:f.wrap,b=(r.x+1+u)%u,C=r.x+1===u?f.wrap+1:f.wrap,I={};return I[new s.OverscaledTileID(f.overscaledZ,y,r.z,g,r.y).key]={backfilled:!1},I[new s.OverscaledTileID(f.overscaledZ,C,r.z,b,r.y).key]={backfilled:!1},r.y>0&&(I[new s.OverscaledTileID(f.overscaledZ,y,r.z,g,r.y-1).key]={backfilled:!1},I[new s.OverscaledTileID(f.overscaledZ,f.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},I[new s.OverscaledTileID(f.overscaledZ,C,r.z,b,r.y-1).key]={backfilled:!1}),r.y+1<u&&(I[new s.OverscaledTileID(f.overscaledZ,y,r.z,g,r.y+1).key]={backfilled:!1},I[new s.OverscaledTileID(f.overscaledZ,f.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},I[new s.OverscaledTileID(f.overscaledZ,C,r.z,b,r.y+1).key]={backfilled:!1}),I}unloadTile(f){f.demTexture&&this.map.painter.saveTileTexture(f.demTexture),f.fbo&&(f.fbo.destroy(),delete f.fbo),f.dem&&delete f.dem,delete f.neighboringTiles,f.state="unloaded"}},geojson:class extends s.Evented{constructor(f,r,u,g){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(g),this._data=r.data,this._options=s.extend({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const y=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*y,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*y,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:s.EXTENT,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*y,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}getClusterExpansionZoom(f,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id},r),this}getClusterChildren(f,r){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id},r),this}getClusterLeaves(f,r,u,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:f,limit:r,offset:u},g),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const f=s.extend({},this.workerOptions),r=this._data;typeof r=="string"?(f.request=this.map._requestManager.transformRequest(s.exported.resolveURL(r),s.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,f,(u,g)=>{if(this._loaded=!0,this._pendingLoad=null,u)this.fire(new s.ErrorEvent(u));else{const y={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&g&&g.resourceTiming&&g.resourceTiming[this.id]&&(y.resourceTiming=g.resourceTiming[this.id]),this.fire(new s.Event("data",y)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,r){const u=f.actor?"reloadTile":"loadTile";f.actor=this.actor,f.request=this.actor.send(u,{type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(g,y)=>(delete f.request,f.unloadVectorData(),f.aborted?r(null):g?r(g):(f.loadVectorData(y,this.map.painter,u==="reloadTile"),r(null))),void 0,u==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f){f.unloadVectorData(),this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ie{constructor(f,r,u,g){super(f,r,u,g),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const r of f.urls)this.urls.push(this.map._requestManager.transformRequest(r,s.ResourceType.Source).url);s.getVideo(this.urls,(r,u)=>{this._loaded=!0,r?this.fire(new s.ErrorEvent(r)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const r=this.video.seekable;f<r.start(0)||f>r.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,r=f.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(f,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ie,canvas:class extends Ie{constructor(f,r,u,g){super(f,r,u,g),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(b=>typeof b!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?(f||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(r,this.canvas,r.gl.RGBA,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends s.Evented{constructor(f,r,u,g){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=r,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Fn(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this._map=f,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:r,y:u,z:g}=f.canonical;return this._implementation.hasTile({x:r,y:u,z:g})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,r){const{x:u,y:g,z:y}=f.tileID.canonical,b=new s.window.AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:u,y:g,z:y},{signal:b.signal})).then(function(C){return delete f.request,f.aborted?(f.state="unloaded",r(null)):C===void 0?(f.state="errored",r(null)):C===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",r(null)):function(I){return I instanceof s.window.ImageData||I instanceof s.window.HTMLCanvasElement||I instanceof s.window.ImageBitmap||I instanceof s.window.HTMLImageElement}(C)?(this.loadTileData(f,C),f.state="loaded",void r(null)):(f.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(C=>{C.code!==20&&(f.state="errored",r(C))}),f.request.cancel=()=>b.abort()}loadTileData(f,r){q.loadTileData(f,r,this._map.painter)}unloadTileData(f){q.unloadTileData(f,this._map.painter)}unloadTile(f,r){if(this.unloadTileData(f),this._implementation.unloadTile){const{x:u,y:g,z:y}=f.tileID.canonical;this._implementation.unloadTile({x:u,y:g,z:y})}r()}abortTile(f,r){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),r()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},De=function(f,r,u,g){const y=new Oe[r.type](f,r,u,g);if(y.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${y.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],y),y};function ke(f,r){const u=s.identity([]);return s.scale(u,u,[.5*f.width,.5*-f.height,1]),s.translate(u,u,[1,-1,0]),s.multiply(u,u,f.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(u)}function Ve(f,r,u,g,y,b,C,I=!1){const M=f.tilesIn(g,C,I);M.sort(Bt);const B=[];for(const j of M)B.push({wrappedTileID:j.tile.tileID.wrapped().key,queryResults:j.tile.queryRenderedFeatures(r,u,f._state,j,y,b,ke(f.transform,j.tile.tileID),I)});const O=function(j){const H={},Q={};for(const J of j){const ee=J.queryResults,te=J.wrappedTileID,W=Q[te]=Q[te]||{};for(const ue in ee){const ae=ee[ue],pe=W[ue]=W[ue]||{},Ce=H[ue]=H[ue]||[];for(const we of ae)pe[we.featureIndex]||(pe[we.featureIndex]=!0,Ce.push(we))}}return H}(B);for(const j in O)O[j].forEach(H=>{const Q=H.feature,J=Q.layer;J&&J.type!=="background"&&J.type!=="sky"&&(Q.source=J.source,J["source-layer"]&&(Q.sourceLayer=J["source-layer"]),Q.state=Q.id!==void 0?f.getFeatureState(J["source-layer"],Q.id):{})});return O}function ut(f,r){const u=f.getRenderableIds().map(b=>f.getTileByID(b)),g=[],y={};for(let b=0;b<u.length;b++){const C=u[b],I=C.tileID.canonical.key;y[I]||(y[I]=!0,C.querySourceFeatures(g,r))}return g}function Bt(f,r){const u=f.tileID,g=r.tileID;return u.overscaledZ-g.overscaledZ||u.canonical.y-g.canonical.y||u.wrap-g.wrap||u.canonical.x-g.canonical.x}function gt(){return ec.workerClass!=null?new ec.workerClass:new s.window.Worker(ec.workerUrl)}const nn="mapboxgl_preloaded_worker_pool";class Qt{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Qt.workerCount;)this.workers.push(new gt);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[nn]}numActive(){return Object.keys(this.active).length}}let Kt;function un(){return Kt||(Kt=new Qt),Kt}function yn(f,r){const u={};for(const g in f)g!=="ref"&&(u[g]=f[g]);return s.refProperties.forEach(g=>{g in r&&(u[g]=r[g])}),u}function Zn(f){f=f.slice();const r=Object.create(null);for(let u=0;u<f.length;u++)r[f[u].id]=f[u];for(let u=0;u<f.length;u++)"ref"in f[u]&&(f[u]=yn(f[u],r[f[u].ref]));return f}Qt.workerCount=2;const sn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function ei(f,r,u){u.push({command:sn.addSource,args:[f,r[f]]})}function ti(f,r,u){r.push({command:sn.removeSource,args:[f]}),u[f]=!0}function ps(f,r,u,g){ti(f,u,g),ei(f,r,u)}function Go(f,r,u){let g;for(g in f[u])if(f[u].hasOwnProperty(g)&&g!=="data"&&!w(f[u][g],r[u][g]))return!1;for(g in r[u])if(r[u].hasOwnProperty(g)&&g!=="data"&&!w(f[u][g],r[u][g]))return!1;return!0}function et(f,r,u,g,y,b){let C;for(C in r=r||{},f=f||{})f.hasOwnProperty(C)&&(w(f[C],r[C])||u.push({command:b,args:[g,C,r[C],y]}));for(C in r)r.hasOwnProperty(C)&&!f.hasOwnProperty(C)&&(w(f[C],r[C])||u.push({command:b,args:[g,C,r[C],y]}))}function qo(f){return f.id}function Ui(f,r){return f[r.id]=r,f}class ms{constructor(r,u){this.reset(r,u)}reset(r,u){this.points=r||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=s.clamp(r,0,1);let u=1,g=this._distances[u];const y=r*this.paddedLength+this.padding;for(;g<y&&u<this._distances.length;)g=this._distances[++u];const b=u-1,C=this._distances[b],I=g-C,M=I>0?(y-C)/I:0;return this.points[b].mult(1-M).add(this.points[u].mult(M))}}class np{constructor(r,u,g){const y=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(r/g),this.yCellCount=Math.ceil(u/g);for(let C=0;C<this.xCellCount*this.yCellCount;C++)y.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=u,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,u,g,y,b){this._forEachCell(u,g,y,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(y),this.bboxes.push(b)}insertCircle(r,u,g,y){this._forEachCell(u-y,g-y,u+y,g+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(u),this.circles.push(g),this.circles.push(y)}_insertBoxCell(r,u,g,y,b,C){this.boxCells[b].push(C)}_insertCircleCell(r,u,g,y,b,C){this.circleCells[b].push(C)}_query(r,u,g,y,b,C){if(g<0||r>this.width||y<0||u>this.height)return!b&&[];const I=[];if(r<=0&&u<=0&&this.width<=g&&this.height<=y){if(b)return!0;for(let M=0;M<this.boxKeys.length;M++)I.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const B=this.circles[3*M],O=this.circles[3*M+1],j=this.circles[3*M+2];I.push({key:this.circleKeys[M],x1:B-j,y1:O-j,x2:B+j,y2:O+j})}return C?I.filter(C):I}return this._forEachCell(r,u,g,y,this._queryCell,I,{hitTest:b,seenUids:{box:{},circle:{}}},C),b?I.length>0:I}_queryCircle(r,u,g,y,b){const C=r-g,I=r+g,M=u-g,B=u+g;if(I<0||C>this.width||B<0||M>this.height)return!y&&[];const O=[];return this._forEachCell(C,M,I,B,this._queryCellCircle,O,{hitTest:y,circle:{x:r,y:u,radius:g},seenUids:{box:{},circle:{}}},b),y?O.length>0:O}query(r,u,g,y,b){return this._query(r,u,g,y,!1,b)}hitTest(r,u,g,y,b){return this._query(r,u,g,y,!0,b)}hitTestCircle(r,u,g,y){return this._queryCircle(r,u,g,!0,y)}_queryCell(r,u,g,y,b,C,I,M){const B=I.seenUids,O=this.boxCells[b];if(O!==null){const H=this.bboxes;for(const Q of O)if(!B.box[Q]){B.box[Q]=!0;const J=4*Q;if(r<=H[J+2]&&u<=H[J+3]&&g>=H[J+0]&&y>=H[J+1]&&(!M||M(this.boxKeys[Q]))){if(I.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[Q],x1:H[J],y1:H[J+1],x2:H[J+2],y2:H[J+3]})}}}const j=this.circleCells[b];if(j!==null){const H=this.circles;for(const Q of j)if(!B.circle[Q]){B.circle[Q]=!0;const J=3*Q;if(this._circleAndRectCollide(H[J],H[J+1],H[J+2],r,u,g,y)&&(!M||M(this.circleKeys[Q]))){if(I.hitTest)return C.push(!0),!0;{const ee=H[J],te=H[J+1],W=H[J+2];C.push({key:this.circleKeys[Q],x1:ee-W,y1:te-W,x2:ee+W,y2:te+W})}}}}}_queryCellCircle(r,u,g,y,b,C,I,M){const B=I.circle,O=I.seenUids,j=this.boxCells[b];if(j!==null){const Q=this.bboxes;for(const J of j)if(!O.box[J]){O.box[J]=!0;const ee=4*J;if(this._circleAndRectCollide(B.x,B.y,B.radius,Q[ee+0],Q[ee+1],Q[ee+2],Q[ee+3])&&(!M||M(this.boxKeys[J])))return C.push(!0),!0}}const H=this.circleCells[b];if(H!==null){const Q=this.circles;for(const J of H)if(!O.circle[J]){O.circle[J]=!0;const ee=3*J;if(this._circlesCollide(Q[ee],Q[ee+1],Q[ee+2],B.x,B.y,B.radius)&&(!M||M(this.circleKeys[J])))return C.push(!0),!0}}}_forEachCell(r,u,g,y,b,C,I,M){const B=this._convertToXCellCoord(r),O=this._convertToYCellCoord(u),j=this._convertToXCellCoord(g),H=this._convertToYCellCoord(y);for(let Q=B;Q<=j;Q++)for(let J=O;J<=H;J++)if(b.call(this,r,u,g,y,this.xCellCount*J+Q,C,I,M))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,u,g,y,b,C){const I=y-r,M=b-u,B=g+C;return B*B>I*I+M*M}_circleAndRectCollide(r,u,g,y,b,C,I){const M=(C-y)/2,B=Math.abs(r-(y+M));if(B>M+g)return!1;const O=(I-b)/2,j=Math.abs(u-(b+O));if(j>O+g)return!1;if(B<=M||j<=O)return!0;const H=B-M,Q=j-O;return H*H+Q*Q<=g*g}}const xo=Math.tan(85*Math.PI/180);function Aa(f,r,u,g,y,b,C){const I=s.create();if(u)if(b.name==="globe"){const M=s.calculateGlobeLabelMatrix(y,r);s.multiply(I,I,M)}else{const M=Ee([],C);I[0]=M[0],I[1]=M[1],I[4]=M[2],I[5]=M[3],g||s.rotateZ(I,I,y.angle)}else s.multiply(I,y.labelPlaneMatrix,f);return I}function ip(f,r,u,g,y,b,C){const I=Aa(f,r,u,g,y,b,C);return b.name==="globe"&&u||(I[2]=I[6]=I[10]=I[14]=0),I}function ka(f,r,u,g,y,b,C){if(u){if(b.name==="globe"){const I=Aa(f,r,u,g,y,b,C);return s.invert(I,I),s.multiply(I,f,I),I}{const I=s.clone(f),M=s.identity([]);return M[0]=C[0],M[1]=C[1],M[4]=C[2],M[5]=C[3],s.multiply(I,I,M),g||s.rotateZ(I,I,-y.angle),I}}return y.glCoordMatrix}function Ct(f,r,u,g){const y=[f,r,u,1];u?s.transformMat4$1(y,y,g):rp(y,y,g);const b=y[3];return y[0]/=b,y[1]/=b,y[2]/=b,y}function Rn(f,r){return Math.min(.5+f/r*.5,1.5)}function An(f,r){const u=f[0]/f[3],g=f[1]/f[3];return u>=-r[0]&&u<=r[0]&&g>=-r[1]&&g<=r[1]}function bo(f,r,u,g,y,b,C,I,M,B){const O=u.transform,j=g?f.textSizeData:f.iconSizeData,H=s.evaluateSizeForZoom(j,u.transform.zoom),Q=O.projection.name==="globe",J=[256/u.width*2+1,256/u.height*2+1],ee=g?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;ee.clear();let te=null;Q&&(te=g?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const W=f.lineVertexArray,ue=g?f.text.placedSymbolArray:f.icon.placedSymbolArray,ae=u.transform.width/u.transform.height;let pe,Ce=!1;for(let we=0;we<ue.length;we++){const Ae=ue.get(we),{numGlyphs:Be,writingMode:Ne}=Ae;if(Ne!==s.WritingMode.vertical||Ce||pe===s.WritingMode.horizontal||(Ce=!0),pe=Ne,(Ae.hidden||Ne===s.WritingMode.vertical)&&!Ce){ci(Be,ee);continue}Ce=!1;const Ge=new s.pointGeometry(Ae.tileAnchorX,Ae.tileAnchorY);let{x:wt,y:Fe,z:rt}=O.projection.projectTilePoint(Ge.x,Ge.y,B.canonical);if(M){const[gn,jt,Vt]=M(Ge);wt+=gn,Fe+=jt,rt+=Vt}const Xe=[wt,Fe,rt,1];if(s.transformMat4$1(Xe,Xe,r),!An(Xe,J)){ci(Be,ee);continue}const ht=Rn(u.transform.cameraToCenterDistance,Xe[3]),Ue=s.evaluateSizeForFeature(j,H,Ae),Le=C?Ue/ht:Ue*ht,Ze=Ct(wt,Fe,rt,y);if(Ze[3]<=0){ci(Be,ee);continue}let lt={};const mt=C?null:M,Ht=Tl(Ae,Le,!1,I,r,y,b,f.glyphOffsetArray,W,ee,te,Ze,Ge,lt,ae,mt,O.projection,B,C);Ce=Ht.useVertical,mt&&Ht.needsFlipping&&(lt={}),(Ht.notEnoughRoom||Ce||Ht.needsFlipping&&Tl(Ae,Le,!0,I,r,y,b,f.glyphOffsetArray,W,ee,te,Ze,Ge,lt,ae,mt,O.projection,B,C).notEnoughRoom)&&ci(Be,ee)}g?(f.text.dynamicLayoutVertexBuffer.updateData(ee),te&&f.text.globeExtVertexBuffer.updateData(te)):(f.icon.dynamicLayoutVertexBuffer.updateData(ee),te&&f.icon.globeExtVertexBuffer.updateData(te))}function Xs(f,r,u,g,y,b,C,I,M,B,O,j,H,Q,J,ee){const{lineStartIndex:te,glyphStartIndex:W,segment:ue}=I,ae=W+I.numGlyphs,pe=te+I.lineLength,Ce=r.getoffsetX(W),we=r.getoffsetX(ae-1),Ae=Ir(f*Ce,u,g,y,b,C,ue,te,pe,M,B,O,j,H,!0,Q,J,ee);if(!Ae)return null;const Be=Ir(f*we,u,g,y,b,C,ue,te,pe,M,B,O,j,H,!0,Q,J,ee);return Be?{first:Ae,last:Be}:null}function Sn(f,r,u,g){return f===s.WritingMode.horizontal&&Math.abs(g)>Math.abs(u)?{useVertical:!0}:f===s.WritingMode.vertical?g>0?{needsFlipping:!0}:null:r!==0&&function(y,b){return y===0||Math.abs(b/y)>xo}(u,g)?r===1?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function Tl(f,r,u,g,y,b,C,I,M,B,O,j,H,Q,J,ee,te,W,ue){const ae=r/24,pe=f.lineOffsetX*ae,Ce=f.lineOffsetY*ae,{lineStartIndex:we,glyphStartIndex:Ae,numGlyphs:Be,segment:Ne,writingMode:Ge,flipState:wt}=f,Fe=we+f.lineLength,rt=Xe=>{if(O){const[Ze,lt,mt]=Xe.up,Ht=B.length;s.updateGlobeVertexNormal(O,Ht+0,Ze,lt,mt),s.updateGlobeVertexNormal(O,Ht+1,Ze,lt,mt),s.updateGlobeVertexNormal(O,Ht+2,Ze,lt,mt),s.updateGlobeVertexNormal(O,Ht+3,Ze,lt,mt)}const[ht,Ue,Le]=Xe.point;s.addDynamicAttributes(B,ht,Ue,Le,Xe.angle)};if(Be>1){const Xe=Xs(ae,I,pe,Ce,u,j,H,f,M,b,Q,ee,!1,te,W,ue);if(!Xe)return{notEnoughRoom:!0};if(g&&!u){let[ht,Ue,Le]=Xe.first.point,[Ze,lt,mt]=Xe.last.point;[ht,Ue]=Ct(ht,Ue,Le,C),[Ze,lt]=Ct(Ze,lt,mt,C);const Ht=Sn(Ge,wt,(Ze-ht)*J,lt-Ue);if(f.flipState=Ht&&Ht.needsFlipping?1:2,Ht)return Ht}rt(Xe.first);for(let ht=Ae+1;ht<Ae+Be-1;ht++){const Ue=Ir(ae*I.getoffsetX(ht),pe,Ce,u,j,H,Ne,we,Fe,M,b,Q,ee,!1,!1,te,W,ue);if(!Ue)return B.length-=4*(ht-Ae),{notEnoughRoom:!0};rt(Ue)}rt(Xe.last)}else{if(g&&!u){const ht=Ct(H.x,H.y,0,y),Ue=we+Ne+1,Le=new s.pointGeometry(M.getx(Ue),M.gety(Ue)),Ze=Ct(Le.x,Le.y,0,y),lt=Ze[3]>0?Ze:Pa(H,Le,ht,1,y,void 0,te,W.canonical),mt=Sn(Ge,wt,(lt[0]-ht[0])*J,lt[1]-ht[1]);if(f.flipState=mt&&mt.needsFlipping?1:2,mt)return mt}const Xe=Ir(ae*I.getoffsetX(Ae),pe,Ce,u,j,H,Ne,we,Fe,M,b,Q,ee,!1,!1,te,W,ue);if(!Xe)return{notEnoughRoom:!0};rt(Xe)}return{}}function Ma(f,r,u,g,y){const{x:b,y:C,z:I}=g.projectTilePoint(f.x,f.y,r);if(!y)return Ct(b,C,I,u);const[M,B,O]=y(f);return Ct(b+M,C+B,I+O,u)}function Pa(f,r,u,g,y,b,C,I){const M=Ma(f.sub(r)._unit()._add(f),I,y,C,b);return s.sub(M,u,M),s.normalize(M,M),s.scaleAndAdd(M,u,M,g)}function Ir(f,r,u,g,y,b,C,I,M,B,O,j,H,Q,J,ee,te,W){const ue=g?f-r:f+r;let ae=ue>0?1:-1,pe=0;g&&(ae*=-1,pe=Math.PI),ae<0&&(pe+=Math.PI);let Ce=I+C+(ae>0?0:1)|0,we=y,Ae=y,Be=0,Ne=0;const Ge=Math.abs(ue),wt=[],Fe=[];let rt=b,Xe=rt;const ht=()=>Pa(Xe,rt,Ae,Ge-Be+1,O,H,ee,te.canonical);for(;Be+Ne<=Ge;){if(Ce+=ae,Ce<I||Ce>=M)return null;if(Ae=we,Xe=rt,wt.push(Ae),Q&&Fe.push(Xe),rt=new s.pointGeometry(B.getx(Ce),B.gety(Ce)),we=j[Ce],!we){const Vt=Ma(rt,te.canonical,O,ee,H);we=Vt[3]>0?j[Ce]=Vt:ht()}Be+=Ne,Ne=s.distance(Ae,we)}J&&H&&(j[Ce]&&(we=ht(),Ne=s.distance(Ae,we)),j[Ce]=we);const Ue=(Ge-Be)/Ne,Le=rt.sub(Xe)._mult(Ue)._add(Xe),Ze=s.sub([],we,Ae),lt=s.scaleAndAdd([],Ae,Ze,Ue);let mt=[0,0,1],Ht=Ze[0],gn=Ze[1];if(W&&(mt=ee.upVector(te.canonical,Le.x,Le.y),mt[0]!==0||mt[1]!==0||mt[2]!==1)){const Vt=[mt[2],0,-mt[0]],Xt=s.cross([],mt,Vt);s.normalize(Vt,Vt),s.normalize(Xt,Xt),Ht=s.dot(Ze,Vt),gn=s.dot(Ze,Xt)}if(u){const Vt=s.cross([],mt,Ze);s.normalize(Vt,Vt),s.scaleAndAdd(lt,lt,Vt,u*ae)}const jt=pe+Math.atan2(gn,Ht);return wt.push(lt),Q&&Fe.push(Le),{point:lt,angle:jt,path:wt,tilePath:Fe,up:mt}}function ci(f,r){const u=r.length,g=u+4*f;r.resize(g),r.float32.fill(-1/0,4*u,4*g)}function rp(f,r,u){const g=r[0],y=r[1];return f[0]=u[0]*g+u[4]*y+u[12],f[1]=u[1]*g+u[5]*y+u[13],f[3]=u[3]*g+u[7]*y+u[15],f}const Rr=100;class zh{constructor(r,u,g=new np(r.width+200,r.height+200,25),y=new np(r.width+200,r.height+200,25)){this.transform=r,this.grid=g,this.ignoredGrid=y,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Rr,this.screenBottomBoundary=r.height+Rr,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=u}placeCollisionBox(r,u,g,y,b,C,I,M){let B=g.projectedAnchorX,O=g.projectedAnchorY,j=g.projectedAnchorZ;const H=g.elevation,Q=g.tileID,J=r.getProjection();if(H&&Q){const[we,Ae,Be]=J.upVector(Q.canonical,g.tileAnchorX,g.tileAnchorY),Ne=J.upVectorScale(Q.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;B+=we*H*Ne,O+=Ae*H*Ne,j+=Be*H*Ne}const ee=this.projectAndGetPerspectiveRatio(I,B,O,j,g.tileID,J.name==="globe"||!!H||this.transform.pitch>0,J),te=C*ee.perspectiveRatio,W=(g.x1*u+y.x-g.padding)*te+ee.point.x,ue=(g.y1*u+y.y-g.padding)*te+ee.point.y,ae=(g.x2*u+y.x+g.padding)*te+ee.point.x,pe=(g.y2*u+y.y+g.padding)*te+ee.point.y,Ce=ee.perspectiveRatio<=.55||ee.occluded;return!this.isInsideGrid(W,ue,ae,pe)||!b&&this.grid.hitTest(W,ue,ae,pe,M)||Ce?{box:[],offscreen:!1,occluded:ee.occluded}:{box:[W,ue,ae,pe],offscreen:this.isOffscreen(W,ue,ae,pe),occluded:!1}}placeCollisionCircles(r,u,g,y,b,C,I,M,B,O,j,H,Q,J,ee){const te=[],W=this.transform.elevation,ue=r.getProjection(),ae=W?W.getAtTileOffsetFunc(ee,this.transform.center.lat,this.transform.worldSize,ue):null,pe=new s.pointGeometry(g.tileAnchorX,g.tileAnchorY);let{x:Ce,y:we,z:Ae}=ue.projectTilePoint(pe.x,pe.y,ee.canonical);if(ae){const[Le,Ze,lt]=ae(pe);Ce+=Le,we+=Ze,Ae+=lt}const Be=ue.name==="globe",Ne=this.projectAndGetPerspectiveRatio(I,Ce,we,Ae,ee,Be||!!W||this.transform.pitch>0,ue),{perspectiveRatio:Ge}=Ne,wt=(j?C/Ge:C*Ge)/s.ONE_EM,Fe=Ct(Ce,we,Ae,M),rt=Ne.signedDistanceFromCamera>0?Xs(wt,b,g.lineOffsetX*wt,g.lineOffsetY*wt,!1,Fe,pe,g,y,M,{},W&&!j?ae:null,j&&!!W,ue,ee,j):null;let Xe=!1,ht=!1,Ue=!0;if(rt&&!Ne.occluded){const Le=.5*Q*Ge+J,Ze=new s.pointGeometry(-100,-100),lt=new s.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),mt=new ms,{first:Ht,last:gn}=rt,jt=Ht.path.length;let Vt=[];for(let en=jt-1;en>=1;en--)Vt.push(Ht.path[en]);for(let en=1;en<gn.path.length;en++)Vt.push(gn.path[en]);const Xt=2.5*Le;B&&(Vt=Vt.map(([en,Hn,ni],ui)=>(ae&&!Be&&(ni=ae(ui<jt-1?Ht.tilePath[jt-1-ui]:gn.tilePath[ui-jt+2])[2]),Ct(en,Hn,ni,B))),Vt.some(en=>en[3]<=0)&&(Vt=[]));let kn=[];if(Vt.length>0){let en=1/0,Hn=-1/0,ni=1/0,ui=-1/0;for(const oi of Vt)en=Math.min(en,oi[0]),ni=Math.min(ni,oi[1]),Hn=Math.max(Hn,oi[0]),ui=Math.max(ui,oi[1]);Hn>=Ze.x&&en<=lt.x&&ui>=Ze.y&&ni<=lt.y&&(kn=[Vt.map(oi=>new s.pointGeometry(oi[0],oi[1]))],(en<Ze.x||Hn>lt.x||ni<Ze.y||ui>lt.y)&&(kn=s.clipLine(kn,Ze.x,Ze.y,lt.x,lt.y)))}for(const en of kn){mt.reset(en,.25*Le);let Hn=0;Hn=mt.length<=.5*Le?1:Math.ceil(mt.paddedLength/Xt)+1;for(let ni=0;ni<Hn;ni++){const ui=ni/Math.max(Hn-1,1),oi=mt.lerp(ui),ji=oi.x+Rr,Or=oi.y+Rr;te.push(ji,Or,Le,0);const co=ji-Le,Xo=Or-Le,yi=ji+Le,si=Or+Le;if(Ue=Ue&&this.isOffscreen(co,Xo,yi,si),ht=ht||this.isInsideGrid(co,Xo,yi,si),!u&&this.grid.hitTestCircle(ji,Or,Le,H)&&(Xe=!0,!O))return{circles:[],offscreen:!1,collisionDetected:Xe,occluded:!1}}}}return{circles:!O&&Xe||!ht?[]:te,offscreen:Ue,collisionDetected:Xe,occluded:Ne.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let g=1/0,y=1/0,b=-1/0,C=-1/0;for(const O of r){const j=new s.pointGeometry(O.x+Rr,O.y+Rr);g=Math.min(g,j.x),y=Math.min(y,j.y),b=Math.max(b,j.x),C=Math.max(C,j.y),u.push(j)}const I=this.grid.query(g,y,b,C).concat(this.ignoredGrid.query(g,y,b,C)),M={},B={};for(const O of I){const j=O.key;if(M[j.bucketInstanceId]===void 0&&(M[j.bucketInstanceId]={}),M[j.bucketInstanceId][j.featureIndex])continue;const H=[new s.pointGeometry(O.x1,O.y1),new s.pointGeometry(O.x2,O.y1),new s.pointGeometry(O.x2,O.y2),new s.pointGeometry(O.x1,O.y2)];s.polygonIntersectsPolygon(u,H)&&(M[j.bucketInstanceId][j.featureIndex]=!0,B[j.bucketInstanceId]===void 0&&(B[j.bucketInstanceId]=[]),B[j.bucketInstanceId].push(j.featureIndex))}return B}insertCollisionBox(r,u,g,y,b){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:y,collisionGroupID:b},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,u,g,y,b){const C=u?this.ignoredGrid:this.grid,I={bucketInstanceId:g,featureIndex:y,collisionGroupID:b};for(let M=0;M<r.length;M+=4)C.insertCircle(I,r[M],r[M+1],r[M+2])}projectAndGetPerspectiveRatio(r,u,g,y,b,C,I){const M=[u,g,y,1];let B=!1;if(y||this.transform.pitch>0){s.transformMat4$1(M,M,r);const j=I.name==="globe";this.fogState&&b&&!j&&(B=function(Q,J,ee,te,W,ue){const ae=ue.calculateFogTileMatrix(W),pe=[J,ee,te];return s.transformMat4(pe,pe,ae),at(Q,pe,ue.pitch,ue._fov)}(this.fogState,u,g,y,b.toUnwrapped(),this.transform)>.9)}else rp(M,M,r);const O=M[3];return{point:new s.pointGeometry((M[0]/O+1)/2*this.transform.width+Rr,(-M[1]/O+1)/2*this.transform.height+Rr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/O*.5,1.5),signedDistanceFromCamera:O,occluded:C&&M[2]>O||B}}isOffscreen(r,u,g,y){return g<Rr||r>=this.screenRightBoundary||y<Rr||u>this.screenBottomBoundary}isInsideGrid(r,u,g,y){return g>=0&&r<this.gridRightBoundary&&y>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const r=s.identity([]);return s.translate(r,r,[-100,-100,0]),r}}function Ys(f,r,u){const g=r.createTileMatrix(f,f.worldSize,u.toUnwrapped());return s.multiply(new Float32Array(16),f.projMatrix,g)}function Lh(f,r,u){if(r.projection.name===u.projection.name)return f.projMatrix;const g=u.clone();return g.setProjection(r.projection),Ys(g,r.getProjection(),f)}function Xc(f,r,u){return r.name===u.projection.name?f.projMatrix:Ys(u,r,f)}class Cl{constructor(r,u,g,y){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?u:-u))):y&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class Ks{constructor(r,u,g,y,b,C=!1){this.text=new Cl(r?r.text:null,u,g,b),this.icon=new Cl(r?r.icon:null,u,y,b),this.clipped=C}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class za{constructor(r,u,g,y=!1){this.text=r,this.icon=u,this.skipFade=g,this.clipped=y}}class Rh{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Dr{constructor(r,u,g,y,b){this.bucketInstanceId=r,this.featureIndex=u,this.sourceLayerIndex=g,this.bucketIndex=y,this.tileID=b}}class Oi{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const u=++this.maxGroupID;this.collisionGroups[r]={ID:u,predicate:g=>g.collisionGroupID===u}}return this.collisionGroups[r]}}function Yc(f,r,u,g,y){const{horizontalAlign:b,verticalAlign:C}=s.getAnchorAlignment(f),I=-(b-.5)*r,M=-(C-.5)*u,B=s.evaluateVariableOffset(f,g);return new s.pointGeometry(I+B[0]*y,M+B[1]*y)}function Il(f,r,u,g,y){const b=new s.pointGeometry(f,r);return u&&b._rotate(g?y:-y),b}class Br{constructor(r,u,g,y,b){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new zh(this.transform,b),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Oi(g),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,u,g,y){const b=g.getBucket(u),C=g.latestFeatureIndex;if(!b||!C||u.id!==b.layerIds[0])return;const I=b.layers[0].layout,M=g.collisionBoxArray,B=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),O=g.tileSize/s.EXTENT,j=g.tileID.toUnwrapped();this.transform.setProjection(b.projection);const H=(Q=g.tileID,J=b.getProjection(),ee=this.transform,J.name===this.projection?ee.calculateProjMatrix(Q.toUnwrapped()):Ys(ee,J,Q));var Q,J,ee;const te=I.get("text-pitch-alignment")==="map",W=I.get("text-rotation-alignment")==="map";u.compileFilter();const ue=u.dynamicFilter(),ae=u.dynamicFilterNeedsFeature(),pe=this.transform.calculatePixelsToTileUnitsMatrix(g),Ce=ip(H,g.tileID.canonical,te,W,this.transform,b.getProjection(),pe);let we=null;if(te){const Ne=ka(H,g.tileID.canonical,te,W,this.transform,b.getProjection(),pe);we=s.multiply([],this.transform.labelPlaneMatrix,Ne)}let Ae=null;ue&&g.latestFeatureIndex&&(Ae={unwrappedTileID:j,dynamicFilter:ue,dynamicFilterNeedsFeature:ae,featureIndex:g.latestFeatureIndex}),this.retainedQueryData[b.bucketInstanceId]=new Dr(b.bucketInstanceId,C,b.sourceLayerIndex,b.index,g.tileID);const Be={bucket:b,layout:I,posMatrix:H,textLabelPlaneMatrix:Ce,labelToScreenMatrix:we,clippingData:Ae,scale:B,textPixelRatio:O,holdingForFade:g.holdingForFade(),collisionBoxArray:M,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(b.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(y)for(const Ne of b.sortKeyRanges){const{sortKey:Ge,symbolInstanceStart:wt,symbolInstanceEnd:Fe}=Ne;r.push({sortKey:Ge,symbolInstanceStart:wt,symbolInstanceEnd:Fe,parameters:Be})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Be})}attemptAnchorPlacement(r,u,g,y,b,C,I,M,B,O,j,H,Q,J,ee,te,W,ue){const{textOffset0:ae,textOffset1:pe,crossTileID:Ce}=H,we=[ae,pe],Ae=Yc(r,g,y,we,b),Be=this.collisionIndex.placeCollisionBox(J,b,u,Il(Ae.x,Ae.y,C,I,this.transform.angle),j,M,B,O.predicate);if(te){const Ne=J.getSymbolInstanceIconSize(ue,this.transform.zoom,H.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(J,Ne,te,Il(Ae.x,Ae.y,C,I,this.transform.angle),j,M,B,O.predicate).box.length===0)return}if(Be.box.length>0){let Ne;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ce]&&this.prevPlacement.placements[Ce]&&this.prevPlacement.placements[Ce].text&&(Ne=this.prevPlacement.variableOffsets[Ce].anchor),this.variableOffsets[Ce]={textOffset:we,width:g,height:y,anchor:r,textScale:b,prevAnchor:Ne},this.markUsedJustification(J,r,H,ee),J.allowVerticalPlacement&&(this.markUsedOrientation(J,ee,H),this.placedOrientations[Ce]=ee),{shift:Ae,placedGlyphBoxes:Be}}}placeLayerBucketPart(r,u,g,y){const{bucket:b,layout:C,posMatrix:I,textLabelPlaneMatrix:M,labelToScreenMatrix:B,clippingData:O,textPixelRatio:j,holdingForFade:H,collisionBoxArray:Q,partiallyEvaluatedTextSize:J,partiallyEvaluatedIconSize:ee,collisionGroup:te}=r.parameters,W=C.get("text-optional"),ue=C.get("icon-optional"),ae=C.get("text-allow-overlap"),pe=C.get("icon-allow-overlap"),Ce=C.get("text-rotation-alignment")==="map",we=C.get("text-pitch-alignment")==="map",Ae=C.get("icon-text-fit")!=="none",Be=C.get("symbol-z-order")==="viewport-y";this.transform.setProjection(b.projection);let Ne=ae&&(pe||!b.hasIconData()||ue),Ge=pe&&(ae||!b.hasTextData()||W);!b.collisionArrays&&Q&&b.deserializeCollisionBoxes(Q),g&&y&&b.updateCollisionDebugBuffers(this.transform.zoom,Q);const wt=(Fe,rt,Xe)=>{const{crossTileID:ht,numVerticalGlyphVertices:Ue}=Fe;if(O){const yi={zoom:this.transform.zoom,pitch:this.transform.pitch};let si=null;if(O.dynamicFilterNeedsFeature){const Un=this.retainedQueryData[b.bucketInstanceId];si=O.featureIndex.loadFeature({featureIndex:Fe.featureIndex,bucketIndex:Un.bucketIndex,sourceLayerIndex:Un.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,O.dynamicFilter)(yi,si,this.retainedQueryData[b.bucketInstanceId].tileID.canonical,new s.pointGeometry(Fe.tileAnchorX,Fe.tileAnchorY),this.transform.calculateDistanceTileData(O.unwrappedTileID)))return this.placements[ht]=new za(!1,!1,!1,!0),void(u[ht]=!0)}if(u[ht])return;if(H)return void(this.placements[ht]=new za(!1,!1,!1));let Le=!1,Ze=!1,lt=!0,mt=!1,Ht=!1,gn=null,jt={box:null,offscreen:null,occluded:null},Vt={box:null,offscreen:null,occluded:null},Xt=null,kn=null,en=null,Hn=0,ni=0,ui=0;Xe.textFeatureIndex?Hn=Xe.textFeatureIndex:Fe.useRuntimeCollisionCircles&&(Hn=Fe.featureIndex),Xe.verticalTextFeatureIndex&&(ni=Xe.verticalTextFeatureIndex);const oi=yi=>{yi.tileID=this.retainedQueryData[b.bucketInstanceId].tileID;const si=this.transform.elevation;(si||yi.elevation)&&(yi.elevation=si?si.getAtTileOffset(yi.tileID,yi.tileAnchorX,yi.tileAnchorY):0)},ji=Xe.textBox;if(ji){oi(ji);const yi=Un=>{let Mi=s.WritingMode.horizontal;if(b.allowVerticalPlacement&&!Un&&this.prevPlacement){const yr=this.prevPlacement.placedOrientations[ht];yr&&(this.placedOrientations[ht]=yr,Mi=yr,this.markUsedOrientation(b,Mi,Fe))}return Mi},si=(Un,Mi)=>{if(b.allowVerticalPlacement&&Ue>0&&Xe.verticalTextBox){for(const yr of b.writingModes)if(yr===s.WritingMode.vertical?(jt=Mi(),Vt=jt):jt=Un(),jt&&jt.box&&jt.box.length)break}else jt=Un()};if(C.get("text-variable-anchor")){let Un=C.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ht]){const mi=this.prevPlacement.variableOffsets[ht];Un.indexOf(mi.anchor)>0&&(Un=Un.filter(xr=>xr!==mi.anchor),Un.unshift(mi.anchor))}const Mi=(mi,xr,br)=>{const xs=b.getSymbolInstanceTextSize(J,Fe,this.transform.zoom,rt),Ha=(mi.x2-mi.x1)*xs+2*mi.padding,Wr=(mi.y2-mi.y1)*xs+2*mi.padding,Jr=Ae&&!pe?xr:null;Jr&&oi(Jr);let Yo={box:[],offscreen:!1,occluded:!1};const bs=ae?2*Un.length:Un.length;for(let ws=0;ws<bs;++ws){const Xa=this.attemptAnchorPlacement(Un[ws%Un.length],mi,Ha,Wr,xs,Ce,we,j,I,te,ws>=Un.length,Fe,rt,b,br,Jr,J,ee);if(Xa&&(Yo=Xa.placedGlyphBoxes,Yo&&Yo.box&&Yo.box.length)){Le=!0,gn=Xa.shift;break}}return Yo};si(()=>Mi(ji,Xe.iconBox,s.WritingMode.horizontal),()=>{const mi=Xe.verticalTextBox;return mi&&oi(mi),b.allowVerticalPlacement&&!(jt&&jt.box&&jt.box.length)&&Ue>0&&mi?Mi(mi,Xe.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),jt&&(Le=jt.box,lt=jt.offscreen,mt=jt.occluded);const yr=yi(jt&&jt.box);if(!Le&&this.prevPlacement){const mi=this.prevPlacement.variableOffsets[ht];mi&&(this.variableOffsets[ht]=mi,this.markUsedJustification(b,mi.anchor,Fe,yr))}}else{const Un=(Mi,yr)=>{const mi=b.getSymbolInstanceTextSize(J,Fe,this.transform.zoom,rt),xr=this.collisionIndex.placeCollisionBox(b,mi,Mi,new s.pointGeometry(0,0),ae,j,I,te.predicate);return xr&&xr.box&&xr.box.length&&(this.markUsedOrientation(b,yr,Fe),this.placedOrientations[ht]=yr),xr};si(()=>Un(ji,s.WritingMode.horizontal),()=>{const Mi=Xe.verticalTextBox;return b.allowVerticalPlacement&&Ue>0&&Mi?(oi(Mi),Un(Mi,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),yi(jt&&jt.box&&jt.box.length)}}if(Xt=jt,Le=Xt&&Xt.box&&Xt.box.length>0,lt=Xt&&Xt.offscreen,mt=Xt&&Xt.occluded,Fe.useRuntimeCollisionCircles){const yi=b.text.placedSymbolArray.get(Fe.centerJustifiedTextSymbolIndex>=0?Fe.centerJustifiedTextSymbolIndex:Fe.verticalPlacedTextSymbolIndex),si=s.evaluateSizeForFeature(b.textSizeData,J,yi),Un=C.get("text-padding");kn=this.collisionIndex.placeCollisionCircles(b,ae,yi,b.lineVertexArray,b.glyphOffsetArray,si,I,M,B,g,we,te.predicate,Fe.collisionCircleDiameter*si/s.ONE_EM,Un,this.retainedQueryData[b.bucketInstanceId].tileID),Le=ae||kn.circles.length>0&&!kn.collisionDetected,lt=lt&&kn.offscreen,mt=kn.occluded}if(Xe.iconFeatureIndex&&(ui=Xe.iconFeatureIndex),Xe.iconBox){const yi=si=>{oi(si);const Un=Ae&&gn?Il(gn.x,gn.y,Ce,we,this.transform.angle):new s.pointGeometry(0,0),Mi=b.getSymbolInstanceIconSize(ee,this.transform.zoom,Fe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(b,Mi,si,Un,pe,j,I,te.predicate)};Vt&&Vt.box&&Vt.box.length&&Xe.verticalIconBox?(en=yi(Xe.verticalIconBox),Ze=en.box.length>0):(en=yi(Xe.iconBox),Ze=en.box.length>0),lt=lt&&en.offscreen,Ht=en.occluded}const Or=W||Fe.numHorizontalGlyphVertices===0&&Ue===0,co=ue||Fe.numIconVertices===0;if(Or||co?co?Or||(Ze=Ze&&Le):Le=Ze&&Le:Ze=Le=Ze&&Le,Le&&Xt&&Xt.box&&this.collisionIndex.insertCollisionBox(Xt.box,C.get("text-ignore-placement"),b.bucketInstanceId,Vt&&Vt.box&&ni?ni:Hn,te.ID),Ze&&en&&this.collisionIndex.insertCollisionBox(en.box,C.get("icon-ignore-placement"),b.bucketInstanceId,ui,te.ID),kn&&(Le&&this.collisionIndex.insertCollisionCircles(kn.circles,C.get("text-ignore-placement"),b.bucketInstanceId,Hn,te.ID),g)){const yi=b.bucketInstanceId;let si=this.collisionCircleArrays[yi];si===void 0&&(si=this.collisionCircleArrays[yi]=new Rh);for(let Un=0;Un<kn.circles.length;Un+=4)si.circles.push(kn.circles[Un+0]),si.circles.push(kn.circles[Un+1]),si.circles.push(kn.circles[Un+2]),si.circles.push(kn.collisionDetected?1:0)}const Xo=b.projection.name!=="globe";Ne=Ne&&(Xo||!mt),Ge=Ge&&(Xo||!Ht),this.placements[ht]=new za(Le||Ne,Ze||Ge,lt||b.justReloaded),u[ht]=!0};if(Be){const Fe=b.getSortedSymbolIndexes(this.transform.angle);for(let rt=Fe.length-1;rt>=0;--rt){const Xe=Fe[rt];wt(b.symbolInstances.get(Xe),Xe,b.collisionArrays[Xe])}}else for(let Fe=r.symbolInstanceStart;Fe<r.symbolInstanceEnd;Fe++)wt(b.symbolInstances.get(Fe),Fe,b.collisionArrays[Fe]);if(g&&b.bucketInstanceId in this.collisionCircleArrays){const Fe=this.collisionCircleArrays[b.bucketInstanceId];s.invert(Fe.invProjMatrix,I),Fe.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}markUsedJustification(r,u,g,y){const{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:M,crossTileID:B}=g,O=s.getAnchorJustification(u),j=y===s.WritingMode.vertical?M:O==="left"?b:O==="center"?C:O==="right"?I:-1;b>=0&&(r.text.placedSymbolArray.get(b).crossTileID=j>=0&&b!==j?0:B),C>=0&&(r.text.placedSymbolArray.get(C).crossTileID=j>=0&&C!==j?0:B),I>=0&&(r.text.placedSymbolArray.get(I).crossTileID=j>=0&&I!==j?0:B),M>=0&&(r.text.placedSymbolArray.get(M).crossTileID=j>=0&&M!==j?0:B)}markUsedOrientation(r,u,g){const y=u===s.WritingMode.horizontal||u===s.WritingMode.horizontalOnly?u:0,b=u===s.WritingMode.vertical?u:0,{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:B}=g,O=r.text.placedSymbolArray;C>=0&&(O.get(C).placedOrientation=y),I>=0&&(O.get(I).placedOrientation=y),M>=0&&(O.get(M).placedOrientation=y),B>=0&&(O.get(B).placedOrientation=b)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let g=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const y=u?u.symbolFadeChange(r):1,b=u?u.opacities:{},C=u?u.variableOffsets:{},I=u?u.placedOrientations:{};for(const M in this.placements){const B=this.placements[M],O=b[M];O?(this.opacities[M]=new Ks(O,y,B.text,B.icon,null,B.clipped),g=g||B.text!==O.text.placed||B.icon!==O.icon.placed):(this.opacities[M]=new Ks(null,y,B.text,B.icon,B.skipFade,B.clipped),g=g||B.text||B.icon)}for(const M in b){const B=b[M];if(!this.opacities[M]){const O=new Ks(B,y,!1,!1);O.isHidden()||(this.opacities[M]=O,g=g||B.text.placed||B.icon.placed)}}for(const M in C)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=C[M]);for(const M in I)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=I[M]);g?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:r)}updateLayerOpacities(r,u){const g={};for(const y of u){const b=y.getBucket(r);b&&y.latestFeatureIndex&&r.id===b.layerIds[0]&&this.updateBucketOpacities(b,g,y.collisionBoxArray)}}updateBucketOpacities(r,u,g){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const y=r.layers[0].layout,b=!!r.layers[0].dynamicFilter(),C=new Ks(null,0,!1,!1,!0),I=y.get("text-allow-overlap"),M=y.get("icon-allow-overlap"),B=y.get("text-variable-anchor"),O=y.get("text-rotation-alignment")==="map",j=y.get("text-pitch-alignment")==="map",H=y.get("icon-text-fit")!=="none",Q=new Ks(null,0,I&&(M||!r.hasIconData()||y.get("icon-optional")),M&&(I||!r.hasTextData()||y.get("text-optional")),!0);!r.collisionArrays&&g&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(g);const J=(te,W,ue)=>{for(let ae=0;ae<W/4;ae++)te.opacityVertexArray.emplaceBack(ue)};let ee=0;for(let te=0;te<r.symbolInstances.length;te++){const W=r.symbolInstances.get(te),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:ae,crossTileID:pe,numIconVertices:Ce}=W;let we=this.opacities[pe];u[pe]?we=C:we||(we=Q,this.opacities[pe]=we),u[pe]=!0;const Ae=ue>0||ae>0,Be=Ce>0,Ne=this.placedOrientations[pe],Ge=Ne===s.WritingMode.vertical,wt=Ne===s.WritingMode.horizontal||Ne===s.WritingMode.horizontalOnly;if(!Ae&&!Be||we.isHidden()||ee++,Ae){const Fe=Jc(we.text);J(r.text,ue,Ge?La:Fe),J(r.text,ae,wt?La:Fe);const rt=we.text.isHidden(),{leftJustifiedTextSymbolIndex:Xe,centerJustifiedTextSymbolIndex:ht,rightJustifiedTextSymbolIndex:Ue,verticalPlacedTextSymbolIndex:Le}=W,Ze=r.text.placedSymbolArray,lt=rt||Ge?1:0;Xe>=0&&(Ze.get(Xe).hidden=lt),ht>=0&&(Ze.get(ht).hidden=lt),Ue>=0&&(Ze.get(Ue).hidden=lt),Le>=0&&(Ze.get(Le).hidden=rt||wt?1:0);const mt=this.variableOffsets[pe];mt&&this.markUsedJustification(r,mt.anchor,W,Ne);const Ht=this.placedOrientations[pe];Ht&&(this.markUsedJustification(r,"left",W,Ht),this.markUsedOrientation(r,Ht,W))}if(Be){const Fe=Jc(we.icon),{placedIconSymbolIndex:rt,verticalPlacedIconSymbolIndex:Xe}=W,ht=r.icon.placedSymbolArray,Ue=we.icon.isHidden()?1:0;rt>=0&&(J(r.icon,Ce,Ge?La:Fe),ht.get(rt).hidden=Ue),Xe>=0&&(J(r.icon,W.numVerticalIconVertices,wt?La:Fe),ht.get(Xe).hidden=Ue)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Fe=r.collisionArrays[te];if(Fe){let rt=new s.pointGeometry(0,0),Xe=!0;if(Fe.textBox||Fe.verticalTextBox){if(B){const Ue=this.variableOffsets[pe];Ue?(rt=Yc(Ue.anchor,Ue.width,Ue.height,Ue.textOffset,Ue.textScale),O&&rt._rotate(j?this.transform.angle:-this.transform.angle)):Xe=!1}b&&(Xe=!we.clipped),Fe.textBox&&Ar(r.textCollisionBox.collisionVertexArray,we.text.placed,!Xe||Ge,rt.x,rt.y),Fe.verticalTextBox&&Ar(r.textCollisionBox.collisionVertexArray,we.text.placed,!Xe||wt,rt.x,rt.y)}const ht=Xe&&Boolean(!wt&&Fe.verticalIconBox);Fe.iconBox&&Ar(r.iconCollisionBox.collisionVertexArray,we.icon.placed,ht,H?rt.x:0,H?rt.y:0),Fe.verticalIconBox&&Ar(r.iconCollisionBox.collisionVertexArray,we.icon.placed,!ht,H?rt.x:0,H?rt.y:0)}}}if(r.fullyClipped=ee===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const te=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=te.invProjMatrix,r.placementViewportMatrix=te.viewportMatrix,r.collisionCircleArray=te.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,u){const g=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*g>r}setStale(){this.stale=!0}}function Ar(f,r,u,g,y){f.emplaceBack(r?1:0,u?1:0,g||0,y||0),f.emplaceBack(r?1:0,u?1:0,g||0,y||0),f.emplaceBack(r?1:0,u?1:0,g||0,y||0),f.emplaceBack(r?1:0,u?1:0,g||0,y||0)}const op=Math.pow(2,25),Kc=Math.pow(2,24),Ji=Math.pow(2,17),Al=Math.pow(2,16),Dh=Math.pow(2,9),kl=Math.pow(2,8),hr=Math.pow(2,1);function Jc(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const r=f.placed?1:0,u=Math.floor(127*f.opacity);return u*op+r*Kc+u*Ji+r*Al+u*Dh+r*kl+u*hr+r}const La=0;class Zo{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,u,g,y,b){const C=this._bucketParts;for(;this._currentTileIndex<r.length;)if(u.getBucketParts(C,y,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,C.sort((I,M)=>I.sortKey-M.sortKey));this._currentPartIndex<C.length;){const I=C[this._currentPartIndex];if(u.placeLayerBucketPart(I,this._seenCrossTileIDs,g,I.symbolInstanceStart===0),this._currentPartIndex++,b())return!0}return!1}}class Ml{constructor(r,u,g,y,b,C,I,M){this.placement=new Br(r,b,C,I,M),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(r,u,g){const y=s.exported.now(),b=()=>{const C=s.exported.now()-y;return!this._forceFullPlacement&&C>2};for(;this._currentPlacementIndex>=0;){const C=u[r[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(C.type==="symbol"&&(!C.minzoom||C.minzoom<=I)&&(!C.maxzoom||C.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Zo(C)),this._inProgressLayer.continuePlacement(g[C.source],this.placement,this._showCollisionBoxes,C,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Qc=512/s.EXTENT/2;class rv{constructor(r,u,g){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=g;for(let y=0;y<u.length;y++){const b=u.get(y),C=b.key;this.indexedSymbolInstances[C]||(this.indexedSymbolInstances[C]=[]),this.indexedSymbolInstances[C].push({crossTileID:b.crossTileID,coord:this.getScaledCoordinates(b,r)})}}getScaledCoordinates(r,u){const g=Qc/Math.pow(2,u.canonical.z-this.tileID.canonical.z);return{x:Math.floor((u.canonical.x*s.EXTENT+r.tileAnchorX)*g),y:Math.floor((u.canonical.y*s.EXTENT+r.tileAnchorY)*g)}}findMatches(r,u,g){const y=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let b=0;b<r.length;b++){const C=r.get(b);if(C.crossTileID)continue;const I=this.indexedSymbolInstances[C.key];if(!I)continue;const M=this.getScaledCoordinates(C,u);for(const B of I)if(Math.abs(B.coord.x-M.x)<=y&&Math.abs(B.coord.y-M.y)<=y&&!g[B.crossTileID]){g[B.crossTileID]=!0,C.crossTileID=B.crossTileID;break}}}}class Bh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ra{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const u=Math.round((r-this.lng)/360);if(u!==0)for(const g in this.indexes){const y=this.indexes[g],b={};for(const C in y){const I=y[C];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+u),b[I.tileID.key]=I}this.indexes[g]=b}this.lng=r}addBucket(r,u,g){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let b=0;b<u.symbolInstances.length;b++)u.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const y=this.usedCrossTileIDs[r.overscaledZ];for(const b in this.indexes){const C=this.indexes[b];if(Number(b)>r.overscaledZ)for(const I in C){const M=C[I];M.tileID.isChildOf(r)&&M.findMatches(u.symbolInstances,r,y)}else{const I=C[r.scaledTo(Number(b)).key];I&&I.findMatches(u.symbolInstances,r,y)}}for(let b=0;b<u.symbolInstances.length;b++){const C=u.symbolInstances.get(b);C.crossTileID||(C.crossTileID=g.generate(),y[C.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new rv(r,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(r,u){for(const g in u.indexedSymbolInstances)for(const y of u.indexedSymbolInstances[g])delete this.usedCrossTileIDs[r][y.crossTileID]}removeStaleBuckets(r){let u=!1;for(const g in this.indexes){const y=this.indexes[g];for(const b in y)r[y[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,y[b]),delete y[b],u=!0)}return u}}class sp{constructor(){this.layerIndexes={},this.crossTileIDs=new Bh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,u,g,y){let b=this.layerIndexes[r.id];b===void 0&&(b=this.layerIndexes[r.id]=new Ra);let C=!1;const I={};y.name!=="globe"&&b.handleWrapJump(g);for(const M of u){const B=M.getBucket(r);B&&r.id===B.layerIds[0]&&(B.bucketInstanceId||(B.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(M.tileID,B,this.crossTileIDs)&&(C=!0),I[B.bucketInstanceId]=!0)}return b.removeStaleBuckets(I)&&(C=!0),C}pruneUnusedLayers(r){const u={};r.forEach(g=>{u[g]=!0});for(const g in this.layerIndexes)u[g]||delete this.layerIndexes[g]}}const Pl=(f,r)=>s.emitValidationErrors(f,r&&r.filter(u=>u.identifier!=="source.canvas")),Da=s.pick(sn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),gs=s.pick(sn,["setCenter","setZoom","setBearing","setPitch"]),eu={version:8,layers:[],sources:{}},vs={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Yr extends s.Evented{constructor(r,u={}){super(),this.map=r,this.dispatcher=new Bn(un(),this),this.imageManager=new Re,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(r._requestManager,u.localFontFamily?s.LocalGlyphMode.all:u.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,u.localFontFamily||u.localIdeographFontFamily),this.crossTileSymbolIndex=new sp,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const g=this;this._rtlTextPluginCallback=Yr.registerForPluginStateChange(y=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(b,C)=>{if(s.triggerPluginCompletionEvent(b),C&&C.every(I=>I))for(const I in g._sourceCaches){const M=g._sourceCaches[I],B=M.getSource().type;B!=="vector"&&B!=="geojson"||M.reload()}})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const b=this.getSource(y.sourceId);if(b&&b.vectorLayerIds)for(const C in this._layers){const I=this._layers[C];I.source===b.id&&this._validateLayer(I)}})}loadURL(r,u={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const g=typeof u.validate=="boolean"?u.validate:!s.isMapboxURL(r);r=this.map._requestManager.normalizeStyleURL(r,u.accessToken);const y=this.map._requestManager.transformRequest(r,s.ResourceType.Style);this._request=s.getJSON(y,(b,C)=>{this._request=null,b?this.fire(new s.ErrorEvent(b)):C&&this._load(C,g)})}loadJSON(r,u={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(r,u.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(eu,!1)}_updateLayerCount(r,u){const g=u?1:-1;r.is3D()&&(this._num3DLayers+=g),r.type==="circle"&&(this._numCircleLayers+=g),r.type==="symbol"&&(this._numSymbolLayers+=g)}_load(r,u){if(u&&Pl(this,s.validateStyle(r)))return;this._loaded=!0,this.stylesheet=s.clone$1(r),this._updateMapProjection();for(const y in r.sources)this.addSource(y,r.sources[y],{validate:!1});this._changed=!1,r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(r.glyphs);const g=Zn(this.stylesheet.layers);this._order=g.map(y=>y.id),this._layers={},this._serializedLayers={};for(let y of g)y=s.createStyleLayer(y),y.setEventedParent(this,{layer:{id:y.id}}),this._layers[y.id]=y,this._serializedLayers[y.id]=y.serialize(),this._updateLayerCount(y,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ct(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(r){this._spriteRequest=function(u,g,y){let b,C,I;const M=s.exported.devicePixelRatio>1?"@2x":"";let B=s.getJSON(g.transformRequest(g.normalizeSpriteURL(u,M,".json"),s.ResourceType.SpriteJSON),(H,Q)=>{B=null,I||(I=H,b=Q,j())}),O=s.getImage(g.transformRequest(g.normalizeSpriteURL(u,M,".png"),s.ResourceType.SpriteImage),(H,Q)=>{O=null,I||(I=H,C=Q,j())});function j(){if(I)y(I);else if(b&&C){const H=s.exported.getImageData(C),Q={};for(const J in b){const{width:ee,height:te,x:W,y:ue,sdf:ae,pixelRatio:pe,stretchX:Ce,stretchY:we,content:Ae}=b[J],Be=new s.RGBAImage({width:ee,height:te});s.RGBAImage.copy(H,Be,{x:W,y:ue},{x:0,y:0},{width:ee,height:te}),Q[J]={data:Be,pixelRatio:pe,sdf:ae,stretchX:Ce,stretchY:we,content:Ae}}y(null,Q)}}return{cancel(){B&&(B.cancel(),B=null),O&&(O.cancel(),O=null)}}}(r,this.map._requestManager,(u,g)=>{if(this._spriteRequest=null,u)this.fire(new s.ErrorEvent(u));else if(g)for(const y in g)this.imageManager.addImage(y,g[y]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(r){const u=this.getSource(r.source);if(!u)return;const g=r.sourceLayer;g&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(g)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${g}" does not exist on source "${u.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const u=[];for(const g of r){const y=this._layers[g];y.type!=="custom"&&u.push(y.serialize())}return u}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(r){return!!this.terrain&&(typeof r.isLayerDraped=="function"?r.isLayerDraped():vs[r.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(r){if(!this._loaded)return;const u=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(y.length||b.length)&&this._updateWorkerLayers(y,b);for(const C in this._updatedSources){const I=this._updatedSources[C];I==="reload"?this._reloadSource(C):I==="clear"&&this._clearSource(C)}this._updateTilesForChangedImages();for(const C in this._updatedPaintProps)this._layers[C].updateTransitions(r);this.light.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._resetUpdates()}const g={};for(const y in this._sourceCaches){const b=this._sourceCaches[y];g[y]=b.used,b.used=!1}for(const y of this._order){const b=this._layers[y];if(b.recalculate(r,this._availableImages),!b.isHidden(r.zoom)){const I=this._getLayerSourceCache(b);I&&(I.used=!0)}const C=this.map.painter;if(C){const I=b.getProgramIds();if(!I)continue;const M=b.getProgramConfiguration(r.zoom);for(const B of I)C.useProgram(B,M)}}for(const y in g){const b=this._sourceCaches[y];g[y]!==b.used&&b.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:b.getSource().id}))}this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),u&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const u in this._sourceCaches)this._sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(r){if(this._checkLoaded(),Pl(this,s.validateStyle(r)))return!1;(r=s.clone$1(r)).layers=Zn(r.layers);const u=function(y,b){if(!y)return[{command:sn.setStyle,args:[b]}];let C=[];try{if(!w(y.version,b.version))return[{command:sn.setStyle,args:[b]}];w(y.center,b.center)||C.push({command:sn.setCenter,args:[b.center]}),w(y.zoom,b.zoom)||C.push({command:sn.setZoom,args:[b.zoom]}),w(y.bearing,b.bearing)||C.push({command:sn.setBearing,args:[b.bearing]}),w(y.pitch,b.pitch)||C.push({command:sn.setPitch,args:[b.pitch]}),w(y.sprite,b.sprite)||C.push({command:sn.setSprite,args:[b.sprite]}),w(y.glyphs,b.glyphs)||C.push({command:sn.setGlyphs,args:[b.glyphs]}),w(y.transition,b.transition)||C.push({command:sn.setTransition,args:[b.transition]}),w(y.light,b.light)||C.push({command:sn.setLight,args:[b.light]}),w(y.fog,b.fog)||C.push({command:sn.setFog,args:[b.fog]}),w(y.projection,b.projection)||C.push({command:sn.setProjection,args:[b.projection]});const I={},M=[];(function(j,H,Q,J){let ee;for(ee in H=H||{},j=j||{})j.hasOwnProperty(ee)&&(H.hasOwnProperty(ee)||ti(ee,Q,J));for(ee in H)H.hasOwnProperty(ee)&&(j.hasOwnProperty(ee)?w(j[ee],H[ee])||(j[ee].type==="geojson"&&H[ee].type==="geojson"&&Go(j,H,ee)?Q.push({command:sn.setGeoJSONSourceData,args:[ee,H[ee].data]}):ps(ee,H,Q,J)):ei(ee,H,Q))})(y.sources,b.sources,M,I);const B=[];y.layers&&y.layers.forEach(j=>{j.source&&I[j.source]?C.push({command:sn.removeLayer,args:[j.id]}):B.push(j)});let O=y.terrain;O&&I[O.source]&&(C.push({command:sn.setTerrain,args:[void 0]}),O=void 0),C=C.concat(M),w(O,b.terrain)||C.push({command:sn.setTerrain,args:[b.terrain]}),function(j,H,Q){H=H||[];const J=(j=j||[]).map(qo),ee=H.map(qo),te=j.reduce(Ui,{}),W=H.reduce(Ui,{}),ue=J.slice(),ae=Object.create(null);let pe,Ce,we,Ae,Be,Ne,Ge;for(pe=0,Ce=0;pe<J.length;pe++)we=J[pe],W.hasOwnProperty(we)?Ce++:(Q.push({command:sn.removeLayer,args:[we]}),ue.splice(ue.indexOf(we,Ce),1));for(pe=0,Ce=0;pe<ee.length;pe++)we=ee[ee.length-1-pe],ue[ue.length-1-pe]!==we&&(te.hasOwnProperty(we)?(Q.push({command:sn.removeLayer,args:[we]}),ue.splice(ue.lastIndexOf(we,ue.length-Ce),1)):Ce++,Ne=ue[ue.length-pe],Q.push({command:sn.addLayer,args:[W[we],Ne]}),ue.splice(ue.length-pe,0,we),ae[we]=!0);for(pe=0;pe<ee.length;pe++)if(we=ee[pe],Ae=te[we],Be=W[we],!ae[we]&&!w(Ae,Be))if(w(Ae.source,Be.source)&&w(Ae["source-layer"],Be["source-layer"])&&w(Ae.type,Be.type)){for(Ge in et(Ae.layout,Be.layout,Q,we,null,sn.setLayoutProperty),et(Ae.paint,Be.paint,Q,we,null,sn.setPaintProperty),w(Ae.filter,Be.filter)||Q.push({command:sn.setFilter,args:[we,Be.filter]}),w(Ae.minzoom,Be.minzoom)&&w(Ae.maxzoom,Be.maxzoom)||Q.push({command:sn.setLayerZoomRange,args:[we,Be.minzoom,Be.maxzoom]}),Ae)Ae.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?et(Ae[Ge],Be[Ge],Q,we,Ge.slice(6),sn.setPaintProperty):w(Ae[Ge],Be[Ge])||Q.push({command:sn.setLayerProperty,args:[we,Ge,Be[Ge]]}));for(Ge in Be)Be.hasOwnProperty(Ge)&&!Ae.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?et(Ae[Ge],Be[Ge],Q,we,Ge.slice(6),sn.setPaintProperty):w(Ae[Ge],Be[Ge])||Q.push({command:sn.setLayerProperty,args:[we,Ge,Be[Ge]]}))}else Q.push({command:sn.removeLayer,args:[we]}),Ne=ue[ue.lastIndexOf(we)+1],Q.push({command:sn.addLayer,args:[Be,Ne]})}(B,b.layers,C)}catch(I){console.warn("Unable to compute style diff:",I),C=[{command:sn.setStyle,args:[b]}]}return C}(this.serialize(),r).filter(y=>!(y.command in gs));if(u.length===0)return!1;const g=u.filter(y=>!(y.command in Da));if(g.length>0)throw new Error(`Unimplemented: ${g.map(y=>y.command).join(", ")}.`);return u.forEach(y=>{y.command!=="setTransition"&&y.command!=="setProjection"&&this[y.command].apply(this,y.args)}),this.stylesheet=r,this._updateMapProjection(),!0}addImage(r,u){return this.getImage(r)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,u),this._afterImageUpdated(r),this)}updateImage(r,u){this.imageManager.updateImage(r,u)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r),this._afterImageUpdated(r),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(r,u,g={}){if(this._checkLoaded(),this.getSource(r)!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(s.validateSource,`sources.${r}`,u,null,g))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const y=De(r,u,this.dispatcher,this);y.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(r),source:y.serialize(),sourceId:r}));const b=C=>{const I=(C?"symbol:":"other:")+r,M=this._sourceCaches[I]=new s.SourceCache(I,y,C);(C?this._symbolSourceCaches:this._otherSourceCaches)[r]=M,M.style=this,M.onAdd(this.map)};b(!1),u.type!=="vector"&&u.type!=="geojson"||b(!0),y.onAdd&&y.onAdd(this.map),this._changed=!0}removeSource(r){this._checkLoaded();const u=this.getSource(r);if(!u)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===r)return this.fire(new s.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.get().source===r)return this.fire(new s.ErrorEvent(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const g=this._getSourceCaches(r);for(const y of g)delete this._sourceCaches[y.id],delete this._updatedSources[y.id],y.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles();return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(r,u){this._checkLoaded(),this.getSource(r).setData(u),this._changed=!0}getSource(r){const u=this._getSourceCache(r);return u&&u.getSource()}_getSources(){const r=[];for(const u in this._otherSourceCaches){const g=this._getSourceCache(u);g&&r.push(g.getSource())}return r}addLayer(r,u,g={}){this._checkLoaded();const y=r.id;if(this.getLayer(y))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${y}" already exists on this map`)));let b;if(r.type==="custom"){if(Pl(this,s.validateCustomStyleLayer(r)))return;b=s.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(y,r.source),r=s.clone$1(r),r=s.extend(r,{source:y})),this._validate(s.validateLayer,`layers.${y}`,r,{arrayIndex:-1},g))return;b=s.createStyleLayer(r),this._validateLayer(b),b.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}const C=u?this._order.indexOf(u):this._order.length;if(u&&C===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`)));this._order.splice(C,0,y),this._layerOrderChanged=!0,this._layers[y]=b;const I=this._getLayerSourceCache(b);if(this._removedLayers[y]&&b.source&&I&&b.type!=="custom"){const M=this._removedLayers[y];delete this._removedLayers[y],M.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",I.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(r,u){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===u)return;const g=this._order.indexOf(r);this._order.splice(g,1);const y=u?this._order.indexOf(u):this._order.length;u&&y===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`))):(this._order.splice(y,0,r),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(r){this._checkLoaded();const u=this._layers[r];if(!u)return void this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be removed.`)));u.setEventedParent(null),this._updateLayerCount(u,!1);const g=this._order.indexOf(r);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=u,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],u.onRemove&&u.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}hasLayerType(r){for(const u in this._layers)if(this._layers[u].type===r)return!0;return!1}setLayerZoomRange(r,u,g){this._checkLoaded();const y=this.getLayer(r);y?y.minzoom===u&&y.maxzoom===g||(u!=null&&(y.minzoom=u),g!=null&&(y.maxzoom=g),this._updateLayer(y)):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(r,u,g={}){this._checkLoaded();const y=this.getLayer(r);if(y){if(!w(y.filter,u))return u==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(s.validateFilter,`layers.${y.id}.filter`,u,{layerType:y.type},g)||(y.filter=s.clone$1(u),this._updateLayer(y)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be filtered.`)))}getFilter(r){const u=this.getLayer(r);return u&&s.clone$1(u.filter)}setLayoutProperty(r,u,g,y={}){this._checkLoaded();const b=this.getLayer(r);b?w(b.getLayoutProperty(u),g)||(b.setLayoutProperty(u,g,y),this._updateLayer(b)):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(r,u){const g=this.getLayer(r);if(g)return g.getLayoutProperty(u);this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style.`)))}setPaintProperty(r,u,g,y={}){this._checkLoaded();const b=this.getLayer(r);b?w(b.getPaintProperty(u),g)||(b.setPaintProperty(u,g,y)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(r,u){const g=this.getLayer(r);return g&&g.getPaintProperty(u)}setFeatureState(r,u){this._checkLoaded();const g=r.source,y=r.sourceLayer,b=this.getSource(g);if(!b)return void this.fire(new s.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const C=b.type;if(C==="geojson"&&y)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(C==="vector"&&!y)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const I=this._getSourceCaches(g);for(const M of I)M.setFeatureState(y,r.id,u)}removeFeatureState(r,u){this._checkLoaded();const g=r.source,y=this.getSource(g);if(!y)return void this.fire(new s.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const b=y.type,C=b==="vector"?r.sourceLayer:void 0;if(b==="vector"&&!C)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const I=this._getSourceCaches(g);for(const M of I)M.removeFeatureState(C,r.id,u)}getFeatureState(r){this._checkLoaded();const u=r.source,g=r.sourceLayer,y=this.getSource(u);if(y){if(y.type!=="vector"||g)return r.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(u)[0].getFeatureState(g,r.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const r={};for(const u in this._sourceCaches){const g=this._sourceCaches[u].getSource();r[g.id]||(r[g.id]=g.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:r,layers:this._serializeLayers(this._order)},u=>u!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0;const u=this._getLayerSourceCache(r);r.source&&!this._updatedSources[r.source]&&u&&u.getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",u.pause()),this._changed=!0,r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const u=C=>this._layers[C].type==="fill-extrusion",g={},y=[];for(let C=this._order.length-1;C>=0;C--){const I=this._order[C];if(u(I)){g[I]=C;for(const M of r){const B=M[I];if(B)for(const O of B)y.push(O)}}}y.sort((C,I)=>I.intersectionZ-C.intersectionZ);const b=[];for(let C=this._order.length-1;C>=0;C--){const I=this._order[C];if(u(I))for(let M=y.length-1;M>=0;M--){const B=y[M].feature;if(g[B.layer.id]<C)break;b.push(B),y.pop()}else for(const M of r){const B=M[I];if(B)for(const O of B)b.push(O.feature)}}return b}queryRenderedFeatures(r,u,g){u&&u.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",u.filter,null,u);const y={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const M of u.layers){const B=this._layers[M];if(!B)return this.fire(new s.ErrorEvent(new Error(`The layer '${M}' does not exist in the map's style and cannot be queried for features.`))),[];y[B.source]=!0}}const b=[];u.availableImages=this._availableImages;const C=u&&u.layers?u.layers.some(M=>{const B=this.getLayer(M);return B&&B.is3D()}):this.has3DLayers(),I=Qe.createFromScreenPoints(r,g);for(const M in this._sourceCaches){const B=this._sourceCaches[M].getSource().id;u.layers&&!y[B]||b.push(Ve(this._sourceCaches[M],this._layers,this._serializedLayers,I,u,g,C,!!this.map._showQueryGeometry))}return this.placement&&b.push(function(M,B,O,j,H,Q,J){const ee={},te=Q.queryRenderedSymbols(j),W=[];for(const ue of Object.keys(te).map(Number))W.push(J[ue]);W.sort(Bt);for(const ue of W){const ae=ue.featureIndex.lookupSymbolFeatures(te[ue.bucketInstanceId],B,ue.bucketIndex,ue.sourceLayerIndex,H.filter,H.layers,H.availableImages,M);for(const pe in ae){const Ce=ee[pe]=ee[pe]||[],we=ae[pe];we.sort((Ae,Be)=>{const Ne=ue.featureSortOrder;if(Ne){const Ge=Ne.indexOf(Ae.featureIndex);return Ne.indexOf(Be.featureIndex)-Ge}return Be.featureIndex-Ae.featureIndex});for(const Ae of we)Ce.push(Ae)}}for(const ue in ee)ee[ue].forEach(ae=>{const pe=ae.feature,Ce=O(M[ue]).getFeatureState(pe.layer["source-layer"],pe.id);pe.source=pe.layer.source,pe.layer["source-layer"]&&(pe.sourceLayer=pe.layer["source-layer"]),pe.state=Ce});return ee}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),I.screenGeometry,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(r,u){u&&u.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",u.filter,null,u);const g=this._getSourceCaches(r);let y=[];for(const b of g)y=y.concat(ut(b,u));return y}addSourceType(r,u,g){return Yr.getSourceType(r)?g(new Error(`A source type called "${r}" already exists.`)):(Yr.setSourceType(r,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:u.workerSourceURL},g):g(null,null))}getLight(){return this.light.getLight()}setLight(r,u={}){this._checkLoaded();const g=this.light.getLight();let y=!1;for(const C in r)if(!w(r[C],g[C])){y=!0;break}if(!y)return;const b=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(r,u),this.light.updateTransitions(b)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(r,u=1){if(this._checkLoaded(),!r)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(u===1){if(typeof r.source=="object"){const g="terrain-dem-src";this.addSource(g,r.source),r=s.clone$1(r),r=s.extend(r,{source:g})}if(this._validate(s.validateTerrain,"terrain",r))return}if(!this.terrain||this.terrain&&u!==this.terrain.drapeRenderMode)this._createTerrain(r,u);else{const g=this.terrain,y=g.get();for(const b of Object.keys(s.spec.terrain))!r.hasOwnProperty(b)&&s.spec.terrain[b].default&&(r[b]=s.spec.terrain[b].default);for(const b in r)if(!w(r[b],y[b])){g.set(r),this.stylesheet.terrain=r;const C=this._setTransitionParameters({duration:0});g.updateTransitions(C);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const u=this.fog=new qt(r,this.map.transform);this.stylesheet.fog=r;const g=this._setTransitionParameters({duration:0});u.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog,g=u.get();Object.keys(r).length===0&&u.set(r);for(const y in r)if(!w(r[y],g[y])){u.set(r),this.stylesheet.fog=r;const b=this._setTransitionParameters({duration:0});u.updateTransitions(b);break}}else this._createFog(r);this._markersNeedUpdate=!0}_setTransitionParameters(r){return{now:s.exported.now(),transition:s.extend(r,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const r=this._order.filter(g=>this.isLayerDraped(this._layers[g])),u=this._order.filter(g=>!this.isLayerDraped(this._layers[g]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...u)}_createTerrain(r,u){const g=this.terrain=new Pe(r,u);this.stylesheet.terrain=r,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const y=this._setTransitionParameters({duration:0});g.updateTransitions(y)}_force3DLayerUpdate(){for(const r in this._layers){const u=this._layers[r];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const u=this._layers[r];u.type==="symbol"&&this._updateLayer(u)}}_validate(r,u,g,y,b={}){return(!b||b.validate!==!1)&&Pl(this,r.call(s.validateStyle,s.extend({key:u,style:this.serialize(),value:g,styleSpec:s.spec},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this._sourceCaches)this._sourceCaches[r].clearTiles(),this._sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){const u=this._getSourceCaches(r);for(const g of u)g.clearTiles()}_reloadSource(r){const u=this._getSourceCaches(r);for(const g of u)g.resume(),g.reload()}_reloadSources(){for(const r of this._getSources())r.reload&&r.reload()}_updateSources(r){for(const u in this._sourceCaches)this._sourceCaches[u].update(r)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const u=this._sourceCaches[r];u.resume(),u.reload()}}_updatePlacement(r,u,g,y,b=!1){let C=!1,I=!1;const M={};for(const B of this._order){const O=this._layers[B];if(O.type!=="symbol")continue;if(!M[O.source]){const H=this._getLayerSourceCache(O);if(!H)continue;M[O.source]=H.getRenderableIds(!0).map(Q=>H.getTileByID(Q)).sort((Q,J)=>J.tileID.overscaledZ-Q.tileID.overscaledZ||(Q.tileID.isLessThan(J.tileID)?-1:1))}const j=this.crossTileSymbolIndex.addLayer(O,M[O.source],r.center.lng,r.projection);C=C||j}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),b=b||this._layerOrderChanged||g===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(b||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),r.zoom))&&(this.pauseablePlacement=new Ml(r,this._order,b,u,g,y,this.placement,this.fog&&r.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),I=!0),C&&this.pauseablePlacement.placement.setStale()),I||C)for(const B of this._order){const O=this._layers[B];O.type==="symbol"&&this.placement.updateLayerOpacities(O,M[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,u,g){this.imageManager.getImages(u.icons,g),this._updateTilesForChangedImages();const y=b=>{b&&b.setDependencies(u.tileID.key,u.type,u.icons)};y(this._otherSourceCaches[u.source]),y(this._symbolSourceCaches[u.source])}getGlyphs(r,u,g){this.glyphManager.getGlyphs(u.stacks,g)}getResource(r,u,g){return s.makeRequest(u,g)}_getSourceCache(r){return this._otherSourceCaches[r]}_getLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}_getSourceCaches(r){const u=[];return this._otherSourceCaches[r]&&u.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&u.push(this._symbolSourceCaches[r]),u}_isSourceCacheLoaded(r){const u=this._getSourceCaches(r);return u.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${r}'`))),!1):u.every(g=>g.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Yr.getSourceType=function(f){return Oe[f]},Yr.setSourceType=function(f,r){Oe[f]=r},Yr.registerForPluginStateChange=s.registerForPluginStateChange;var zl=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,ap="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",lp=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,tu=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,cp=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Oh={},Fh={};const Ba=[];Js(zl,Ba),Js(lp,Ba),Js(tu,Ba),Js(cp,Ba),Oh=Wn("",lp),Fh=Wn(cp,tu);const up=Wn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),nu=zl,iu=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Vh={background:Wn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Wn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Wn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Wn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Wn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Wn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Wn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Wn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Wn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Wn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Wn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Wn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Wn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Wn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Wn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Wn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Wn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Wn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Wn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Wn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Wn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Wn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Wn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Wn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Wn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Wn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ap),skyboxGradient:Wn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ap),skyboxCapture:Wn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Wn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Wn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Js(f,r){const u=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of u)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const y=g.split(" ");for(const b of y)r.includes(b)||r.push(b)}}function Wn(f,r){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=r.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),y={},b=[...Ba];return Js(f,b),Js(r,b),{fragmentSource:f=f.replace(u,(C,I,M,B,O)=>(y[O]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${O}
varying ${M} ${B} ${O};
#else
uniform ${M} ${B} u_${O};
#endif
`:`
#ifdef HAS_UNIFORM_u_${O}
    ${M} ${B} ${O} = u_${O};
#endif
`)),vertexSource:r=r.replace(u,(C,I,M,B,O)=>{const j=B==="float"?"vec2":"vec4",H=O.match(/color/)?"color":j;return y[O]?I==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${M} ${j} a_${O};
varying ${M} ${B} ${O};
#else
uniform ${M} ${B} u_${O};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = a_${O};
#else
    ${M} ${B} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = unpack_mix_${H}(a_${O}, u_${O}_t);
#else
    ${M} ${B} ${O} = u_${O};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${M} ${j} a_${O};
#else
uniform ${M} ${B} u_${O};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${M} ${B} ${O} = a_${O};
#else
    ${M} ${B} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${M} ${B} ${O} = unpack_mix_${H}(a_${O}, u_${O}_t);
#else
    ${M} ${B} ${O} = u_${O};
#endif
`}),staticAttributes:g,usedDefines:b}}class Ll{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,u,g,y,b,C,I){this.context=r;let M=this.boundPaintVertexBuffers.length!==y.length;for(let O=0;!M&&O<y.length;O++)this.boundPaintVertexBuffers[O]!==y[O]&&(M=!0);let B=this.boundDynamicVertexBuffers.length!==I.length;for(let O=0;!B&&O<I.length;O++)this.boundDynamicVertexBuffers[O]!==I[O]&&(B=!0);if(!r.extVertexArrayObject||!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==g||M||B||this.boundIndexBuffer!==b||this.boundVertexOffset!==C)this.freshBind(u,g,y,b,C,I);else{r.bindVertexArrayOES.set(this.vao);for(const O of I)O&&O.bind();b&&b.dynamicDraw&&b.bind()}}freshBind(r,u,g,y,b,C){let I;const M=r.numAttributes,B=this.context,O=B.gl;if(B.extVertexArrayObject)this.vao&&this.destroy(),this.vao=B.extVertexArrayObject.createVertexArrayOES(),B.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=r,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=y,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=C;else{I=B.currentNumAttributes||0;for(let j=M;j<I;j++)O.disableVertexAttribArray(j)}u.enableAttributes(O,r),u.bind(),u.setVertexAttribPointers(O,r,b);for(const j of g)j.enableAttributes(O,r),j.bind(),j.setVertexAttribPointers(O,r,b);for(const j of C)j&&(j.enableAttributes(O,r),j.bind(),j.setVertexAttribPointers(O,r,b));y&&y.bind(),B.currentNumAttributes=M}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function $h(f,r){const u=Math.pow(2,r.canonical.z),g=r.canonical.y;return[new s.MercatorCoordinate(0,g/u).toLngLat().lat,new s.MercatorCoordinate(0,(g+1)/u).toLngLat().lat]}function Rl(f,r,u,g,y,b,C){const I=f.context,M=I.gl,B=u.fbo;if(!B)return;f.prepareDrawTile();const O=f.useProgram("hillshade");I.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,B.colorAttachment.get());const j=((ee,te,W,ue)=>{const ae=W.paint.get("hillshade-shadow-color"),pe=W.paint.get("hillshade-highlight-color"),Ce=W.paint.get("hillshade-accent-color");let we=W.paint.get("hillshade-illumination-direction")*(Math.PI/180);W.paint.get("hillshade-illumination-anchor")==="viewport"&&(we-=ee.transform.angle);const Ae=!ee.options.moving;return{u_matrix:ue||ee.transform.calculateProjMatrix(te.tileID.toUnwrapped(),Ae),u_image:0,u_latrange:$h(0,te.tileID),u_light:[W.paint.get("hillshade-exaggeration"),we],u_shadow:ae,u_highlight:pe,u_accent:Ce}})(f,u,g,f.terrain?r.projMatrix:null);f.prepareDrawProgram(I,O,r.toUnwrapped());const{tileBoundsBuffer:H,tileBoundsIndexBuffer:Q,tileBoundsSegments:J}=f.getTileBoundsBuffers(u);O.draw(I,M.TRIANGLES,y,b,C,s.CullFaceMode.disabled,j,g.id,H,Q,J)}function Dl(f,r,u){if(!r.needsDEMTextureUpload)return;const g=f.context,y=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||f.getTileTexture(u.stride);const b=u.getPixels();r.demTexture?r.demTexture.update(b,{premultiply:!1}):r.demTexture=new s.Texture(g,b,y.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}function ru(f,r,u,g,y,b){const C=f.context,I=C.gl;if(!r.dem)return;const M=r.dem;if(C.activeTexture.set(I.TEXTURE1),Dl(f,r,M),!r.demTexture)return;r.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const B=M.dim;C.activeTexture.set(I.TEXTURE0);let O=r.fbo;if(!O){const J=new s.Texture(C,{width:B,height:B,data:null},I.RGBA);J.bind(I.LINEAR,I.CLAMP_TO_EDGE),O=r.fbo=C.createFramebuffer(B,B,!0),O.colorAttachment.set(J.texture)}C.bindFramebuffer.set(O.framebuffer),C.viewport.set([0,0,B,B]);const{tileBoundsBuffer:j,tileBoundsIndexBuffer:H,tileBoundsSegments:Q}=f.getMercatorTileBoundsBuffers();f.useProgram("hillshadePrepare").draw(C,I.TRIANGLES,g,y,b,s.CullFaceMode.disabled,((J,ee)=>{const te=ee.stride,W=s.create();return s.ortho(W,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(W,W,[0,-s.EXTENT,0]),{u_matrix:W,u_image:1,u_dimension:[te,te],u_zoom:J.overscaledZ,u_unpack:ee.unpackVector}})(r.tileID,M),u.id,j,H,Q),r.needsHillshadePrepare=!1}const ou=f=>({u_matrix:new s.UniformMatrix4f(f),u_image0:new s.Uniform1i(f),u_skirt_height:new s.Uniform1f(f)}),Nh=(f,r)=>({u_matrix:f,u_image0:0,u_skirt_height:r}),su=(f,r,u,g,y,b,C,I,M,B,O,j,H,Q,J)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:u,u_zoom_transition:y,u_merc_center:b,u_image0:0,u_frustum_tl:C,u_frustum_tr:I,u_frustum_br:M,u_frustum_bl:B,u_globe_pos:O,u_globe_radius:j,u_viewport:H,u_grid_matrix:J?Float32Array.from(J):new Float32Array(9),u_skirt_height:Q});function Uh(f,r){return f!=null&&r!=null&&!(!f.hasData()||!r.hasData())&&f.demTexture!=null&&r.demTexture!=null&&f.tileID.key!==r.tileID.key}const _s=new class{constructor(){this.operations={}}newMorphing(f,r,u,g,y){if(f in this.operations){const b=this.operations[f];b.to.tileID.key!==u.tileID.key&&(b.queued=u)}else this.operations[f]={startTime:g,phase:0,duration:y,from:r,to:u,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const r=this.operations[f];return{from:r.from,to:r.to,phase:r.phase}}update(f){for(const r in this.operations){const u=this.operations[r];for(u.phase=(f-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,f)){delete this.operations[r];break}}}_nextOp(f,r){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=r,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},Qs={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function au(f){return 6*Math.pow(1.5,22-f)}function jh(f,r){const u=1<<f.z;return!r&&(f.x===0||f.x===u-1)||f.y===0||f.y===u-1}const $n=f=>({u_matrix:f});function Bl(f,r,u,g,y){if(y>0){const b=s.exported.now(),C=(b-f.timeAdded)/y,I=r?(b-r.timeAdded)/y:-1,M=u.getSource(),B=g.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),O=!r||Math.abs(r.tileID.overscaledZ-B)>Math.abs(f.tileID.overscaledZ-B),j=O&&f.refreshedUponExpiration?1:s.clamp(O?C:1-I,0,1);return f.refreshedUponExpiration&&C>=1&&(f.refreshedUponExpiration=!1),r?{opacity:1,mix:1-j}:{opacity:j,mix:0}}return{opacity:1,mix:0}}class hp extends s.SourceCache{constructor(r){const u={type:"raster-dem",maxzoom:r.transform.maxZoom},g=new Bn(un(),null),y=De("mock-dem",u,g,r.style);super("mock-dem",y,!1),y.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,u){r.state="loaded",u(null)}}class dp extends s.SourceCache{constructor(r){const u=De("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new Bn(un(),null),r.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,u,g){if(r.freezeTileCoverage)return;this.transform=r;const y=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,C)=>{if(b[C.key]="",!this._tiles[C.key]){const I=new s.Tile(C,this._source.tileSize*C.overscaleFactor(),r.tileZoom);I.state="loaded",this._tiles[C.key]=I}return b},{});for(const b in this._tiles)b in y||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(r){const u=this.proxyCachedFBO[r];if(u!==void 0){const g=Object.values(u);this.renderCachePool.push(...g),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Gh extends s.OverscaledTileID{constructor(r,u,g){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=u,this.projMatrix=g}}class qh extends s.Elevation{constructor(r,u){super(),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,y,b]=function(M){const B=new s.StructArrayLayout2i4,O=new s.StructArrayLayout3ui6,j=131;B.reserve(17161),O.reserve(33800);const H=s.EXTENT/128,Q=s.EXTENT+H/2,J=Q+H;for(let te=-H;te<J;te+=H)for(let W=-H;W<J;W+=H){const ue=W<0||W>Q||te<0||te>Q?24575:0,ae=s.clamp(Math.round(W),0,s.EXTENT),pe=s.clamp(Math.round(te),0,s.EXTENT);B.emplaceBack(ae+ue,pe)}const ee=(te,W)=>{const ue=W*j+te;O.emplaceBack(ue+1,ue,ue+j),O.emplaceBack(ue+j,ue+j+1,ue+1)};for(let te=1;te<129;te++)for(let W=1;W<129;W++)ee(W,te);return[0,129].forEach(te=>{for(let W=0;W<130;W++)ee(W,te),ee(te,W)}),[B,O,32768]}(),C=r.context;this.gridBuffer=C.createVertexBuffer(g,s.posAttributes.members),this.gridIndexBuffer=C.createIndexBuffer(y),this.gridSegments=s.SegmentVector.simpleSegment(0,0,g.length,y.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,g.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new dp(u.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const I=C.gl;this._overlapStencilMode=new s.StencilMode({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new hp(u.map)}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),r.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=r,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,u,g){if(r&&r.terrain){this._style!==r&&(this.style=r),this.enabled=!0;const y=r.terrain.properties;this.sourceCache=r.terrain.drapeRenderMode===0?this._mockSourceCache:r._getSourceCache(y.get("source")),this._exaggeration=y.get("exaggeration");const b=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const C=this.getScaledDemTileSize();this.sourceCache.update(u,C,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,b(),this._initializing=!0),b(),u.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const r=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||r.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${r.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${r.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._sourceCaches)this._style._sourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const y=this.proxyCoords=u.getIds().map(M=>{const B=u.getTileByID(M).tileID;return B.projMatrix=g.calculateProjMatrix(B.toUnwrapped()),B});(function(M,B){const O=B.transform.pointCoordinate(B.transform.getCameraPoint()),j=new s.pointGeometry(O.x,O.y);M.sort((H,Q)=>{if(Q.overscaledZ-H.overscaledZ)return Q.overscaledZ-H.overscaledZ;const J=new s.pointGeometry(H.canonical.x+(1<<H.canonical.z)*H.wrap,H.canonical.y),ee=new s.pointGeometry(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),te=j.mult(1<<H.canonical.z);return te.x-=.5,te.y-=.5,te.distSqr(J)-te.distSqr(ee)})})(y,this.painter),this._previousZoom=g.zoom;const b=this.proxyToSource||{};this.proxyToSource={},y.forEach(M=>{this.proxyToSource[M.key]={}}),this.terrainTileForTile={};const C=this._style._sourceCaches;for(const M in C){const B=C[M];if(!B.used||(B!==this.sourceCache&&this.resetTileLookupCache(B.id),this._setupProxiedCoordsForOrtho(B,r[M],b),B.usedForTerrain))continue;const O=r[M];B.getSource().reparseOverscaled&&this._assignTerrainTiles(O)}this.proxiedCoords[u.id]=y.map(M=>new Gh(M,M.key,this.orthoMatrix)),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const I={};this._visibleDemTiles=[];for(const M of this.proxyCoords){const B=this.terrainTileForTile[M.key];if(!B)continue;const O=B.tileID.key;O in I||(this._visibleDemTiles.push(B),I[O]=O)}}_assignTerrainTiles(r){this._initializing||r.forEach(u=>{if(this.terrainTileForTile[u.key])return;const g=this._findTileCoveringTileID(u,this.sourceCache);g&&(this.terrainTileForTile[u.key]=g)})}_prepareDEMTextures(){const r=this.painter.context,u=r.gl;for(const g in this.terrainTileForTile){const y=this.terrainTileForTile[g],b=y.dem;!b||y.demTexture&&!y.needsDEMTextureUpload||(r.activeTexture.set(u.TEXTURE1),Dl(this.painter,y,b))}}_prepareDemTileUniforms(r,u,g,y){if(!u||u.demTexture==null)return!1;const b=r.tileID.canonical,C=Math.pow(2,u.tileID.canonical.z-b.z),I=y||"";return g[`u_dem_tl${I}`]=[b.x*C%1,b.y*C%1],g[`u_dem_scale${I}`]=C,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const r=this.painter.context,u=r.gl;if(!this._emptyDepthBufferTexture){const g=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(r,g,u.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let r=0;const u=this._visibleDemTiles.reduce((g,y)=>{if(!y.dem)return g;const b=y.dem.tree.minimums[0];return b>0&&r++,g+b},0);return r?u/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,u=r.gl;r.activeTexture.set(u.TEXTURE2);const g=this._getLoadedAreaMinimum(),y=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(g,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(y,{premultiply:!1}):b=this._emptyDEMTexture=new s.Texture(r,y,u.RGBA,{premultiply:!1}),b}setupElevationDraw(r,u,g){const y=this.painter.context,b=y.gl,C=(I=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(I),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var I;C.u_dem_size=this.sourceCache.getSource().tileSize,C.u_exaggeration=this.exaggeration();let M=null,B=null,O=1;if(g&&g.morphing&&this._useVertexMorphing){const j=g.morphing.srcDemTile,H=g.morphing.dstDemTile;O=g.morphing.phase,j&&H&&(this._prepareDemTileUniforms(r,j,C,"_prev")&&(B=j),this._prepareDemTileUniforms(r,H,C)&&(M=H))}if(B&&M?(y.activeTexture.set(b.TEXTURE2),M.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),y.activeTexture.set(b.TEXTURE4),B.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),C.u_dem_lerp=O):(M=this.terrainTileForTile[r.tileID.key],y.activeTexture.set(b.TEXTURE2),(this._prepareDemTileUniforms(r,M,C)?M.demTexture:this.emptyDEMTexture).bind(b.NEAREST,b.CLAMP_TO_EDGE)),y.activeTexture.set(b.TEXTURE3),g&&g.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),this._depthFBO&&(C.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),C.u_depth_size_inv=[1,1]),g&&g.useMeterToDem&&M){const j=(1<<M.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;C.u_meter_to_dem=j}if(g&&g.labelPlaneMatrixInv&&(C.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),u.setTerrainUniformValues(y,C),this.painter.transform.projection.name==="globe"){const j=this.globeUniformValues(this.painter.transform,r.tileID.canonical,g&&g.useDenormalizedUpVectorScale);u.setGlobeUniformValues(y,j)}}globeUniformValues(r,u,g){const y=r.projection;return{u_tile_tl_up:y.upVector(u,0,0),u_tile_tr_up:y.upVector(u,s.EXTENT,0),u_tile_br_up:y.upVector(u,s.EXTENT,s.EXTENT),u_tile_bl_up:y.upVector(u,0,s.EXTENT),u_tile_up_scale:g?s.globeMetersToEcef(1):y.upVectorScale(u,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const u=this.painter,g=this.painter.context;r.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(y,b,C,I,M){if(y.transform.projection.name==="globe")(function(B,O,j,H,Q){const J=B.context,ee=J.gl;let te,W;const ue=B.options.showTerrainWireframe?2:0,ae=B.transform,pe=s.globeUseCustomAntiAliasing(B,J,ae),Ce=(ht,Ue)=>{if(W===ht)return;const Le=[Qs[ht],"PROJECTION_GLOBE_VIEW"];pe&&Le.push("CUSTOM_ANTIALIASING"),Ue&&Le.push(Qs[ue]),te=B.useProgram("globeRaster",null,Le),W=ht},we=B.colorModeForRenderPass(),Ae=new s.DepthMode(ee.LEQUAL,s.DepthMode.ReadWrite,B.depthRangeFor3D);_s.update(Q);const Be=s.calculateGlobeMercatorMatrix(ae),Ne=[s.mercatorXfromLng(ae.center.lng),s.mercatorYfromLat(ae.center.lat)],Ge=ue?[!1,!0]:[!1],wt=B.globeSharedBuffers,Fe=[ae.width*s.exported.devicePixelRatio,ae.height*s.exported.devicePixelRatio],rt=Float32Array.from(ae.globeMatrix),Xe={useDenormalizedUpVectorScale:!0};if(Ge.forEach(ht=>{const Ue=B.transform,Le=au(Ue.zoom)*O.exaggeration();W=-1;const Ze=ht?ee.LINES:ee.TRIANGLES;for(const lt of H){const mt=j.getTile(lt),Ht=s.StencilMode.disabled,gn=O.prevTerrainTileForTile[lt.key],jt=O.terrainTileForTile[lt.key];Uh(gn,jt)&&_s.newMorphing(lt.key,gn,jt,Q,250),J.activeTexture.set(ee.TEXTURE0),mt.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const Vt=_s.getMorphValuesForProxy(lt.key),Xt=Vt?1:0;Vt&&s.extend$1(Xe,{morphing:{srcDemTile:Vt.from,dstDemTile:Vt.to,phase:s.easeCubicInOut(Vt.phase)}});const kn=s.tileCornersToBounds(lt.canonical),en=s.getLatitudinalLod(kn.getCenter().lat),Hn=s.getGridMatrix(lt.canonical,kn,en,Ue.worldSize/Ue._pixelsPerMercatorPixel),ni=s.globeNormalizeECEF(s.globeTileBounds(lt.canonical)),ui=su(Ue.projMatrix,rt,Be,ni,s.globeToMercatorTransition(Ue.zoom),Ne,Ue.frustumCorners.TL,Ue.frustumCorners.TR,Ue.frustumCorners.BR,Ue.frustumCorners.BL,Ue.globeCenterInViewSpace,Ue.globeRadius,Fe,Le,Hn);if(Ce(Xt,ht),O.setupElevationDraw(mt,te,Xe),B.prepareDrawProgram(J,te,lt.toUnwrapped()),wt){const[oi,ji,Or]=ht?wt.getWirefameBuffers(B.context,en):wt.getGridBuffers(en,Le!==0);te.draw(J,Ze,Ae,Ht,we,s.CullFaceMode.backCCW,ui,"globe_raster",oi,ji,Or)}}}),wt){const ht=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];pe&&ht.push("CUSTOM_ANTIALIASING"),te=B.useProgram("globeRaster",null,ht);for(const Ue of H){const{x:Le,y:Ze,z:lt}=Ue.canonical,mt=Ze===0,Ht=Ze===(1<<lt)-1,[gn,jt,Vt,Xt]=wt.getPoleBuffers(lt);if(Xt&&(mt||Ht)){const kn=j.getTile(Ue);J.activeTexture.set(ee.TEXTURE0),kn.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);let en=s.globePoleMatrixForTile(lt,Le,ae);const Hn=s.globeNormalizeECEF(s.globeTileBounds(Ue.canonical)),ni=(ui,oi)=>ui.draw(J,ee.TRIANGLES,Ae,s.StencilMode.disabled,we,s.CullFaceMode.disabled,su(ae.projMatrix,en,en,Hn,0,Ne,ae.frustumCorners.TL,ae.frustumCorners.TR,ae.frustumCorners.BR,ae.frustumCorners.BL,ae.globeCenterInViewSpace,ae.globeRadius,Fe,0),"globe_pole_raster",oi,Vt,Xt);O.setupElevationDraw(kn,te,Xe),B.prepareDrawProgram(J,te,Ue.toUnwrapped()),mt&&ni(te,gn),Ht&&(en=s.scale(s.create(),en,[1,-1,1]),ni(te,jt))}}}})(y,b,C,I,M);else{const B=y.context,O=B.gl;let j,H;const Q=y.options.showTerrainWireframe?2:0,J=(ae,pe)=>{if(H===ae)return;const Ce=[Qs[ae]];pe&&Ce.push(Qs[Q]),j=y.useProgram("terrainRaster",null,Ce),H=ae},ee=y.colorModeForRenderPass(),te=new s.DepthMode(O.LEQUAL,s.DepthMode.ReadWrite,y.depthRangeFor3D);_s.update(M);const W=y.transform,ue=au(W.zoom)*b.exaggeration();(Q?[!1,!0]:[!1]).forEach(ae=>{H=-1;const pe=ae?O.LINES:O.TRIANGLES,[Ce,we]=ae?b.getWirefameBuffer():[b.gridIndexBuffer,b.gridSegments];for(const Ae of I){const Be=C.getTile(Ae),Ne=s.StencilMode.disabled,Ge=b.prevTerrainTileForTile[Ae.key],wt=b.terrainTileForTile[Ae.key];Uh(Ge,wt)&&_s.newMorphing(Ae.key,Ge,wt,M,250),B.activeTexture.set(O.TEXTURE0),Be.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST);const Fe=_s.getMorphValuesForProxy(Ae.key),rt=Fe?1:0;let Xe;Fe&&(Xe={morphing:{srcDemTile:Fe.from,dstDemTile:Fe.to,phase:s.easeCubicInOut(Fe.phase)}});const ht=Nh(Ae.projMatrix,jh(Ae.canonical,W.renderWorldCopies)?ue/10:ue);J(rt,ae),b.setupElevationDraw(Be,j,Xe),y.prepareDrawProgram(B,j,Ae.toUnwrapped()),j.draw(B,pe,te,Ne,ee,s.CullFaceMode.backCCW,ht,"terrain_raster",b.gridBuffer,Ce,we)}})}}(u,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const u=this.painter,g=this.painter.context,y=this.proxySourceCache,b=this.proxiedCoords[y.id],C=this._drapedRenderBatches.shift(),I=[],M=u.style.order;let B=0;for(const O of b){const j=y.getTileByID(O.proxyTileKey),H=y.proxyCachedFBO[O.key]?y.proxyCachedFBO[O.key][r]:void 0,Q=H!==void 0?y.renderCache[H]:this.pool[B++],J=H!==void 0;if(j.texture=Q.tex,J&&!Q.dirty){I.push(j.tileID);continue}let ee;g.bindFramebuffer.set(Q.fb.framebuffer),this.renderedToTile=!1,Q.dirty&&(g.clear({color:s.Color.transparent,stencil:0}),Q.dirty=!1);for(let te=C.start;te<=C.end;++te){const W=u.style._layers[M[te]];if(W.isHidden(u.transform.zoom))continue;const ue=u.style._getLayerSourceCache(W),ae=ue?this.proxyToSource[O.key][ue.id]:[O];if(!ae)continue;const pe=ae;g.viewport.set([0,0,Q.fb.width,Q.fb.height]),ee!==(ue?ue.id:null)&&(this._setupStencil(Q,ae,W,ue),ee=ue?ue.id:null),u.renderLayer(u,ue,W,pe)}this.renderedToTile?(Q.dirty=!0,I.push(j.tileID)):J||--B,B===5&&(B=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),C.end+1}postRender(){}renderCacheEfficiency(r){const u=r.order.length;if(u===0)return{efficiency:100};let g,y=0,b=0,C=!1;for(let I=0;I<u;++I){const M=r._layers[r.order[I]];this._style.isLayerDraped(M)?(C&&++y,++b):C||(C=!0,g=M.id)}return b===0?{efficiency:100}:{efficiency:100*(1-y/b),firstUndrapedLayer:g}}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{r=Math.min(r,u.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,u,g){if(!this._visibleDemTiles)return null;const y=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const C=b.tileID,I=1<<C.overscaledZ,{x:M,y:B}=C.canonical,O=M/I,j=(M+1)/I,H=B/I,Q=(B+1)/I;return{minx:O,miny:H,maxx:j,maxy:Q,t:b.dem.tree.raycastRoot(O,H,j,Q,r,u,g),tile:b}});y.sort((b,C)=>(b.t!==null?b.t:Number.MAX_VALUE)-(C.t!==null?C.t:Number.MAX_VALUE));for(const b of y){if(b.t==null)return null;const C=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,r,u,g);if(C!=null)return C}return null}_createFBO(){const r=this.painter.context,u=r.gl,g=this.drapeBufferSize;r.activeTexture.set(u.TEXTURE0);const y=new s.Texture(r,{width:g[0],height:g[1],data:null},u.RGBA);y.bind(u.LINEAR,u.CLAMP_TO_EDGE);const b=r.createFramebuffer(g[0],g[1],!1);return b.colorAttachment.set(y.texture),b.depthAttachment=new Hc(r,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&!r.extTextureFilterAnisotropicForceOff&&u.texParameterf(u.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:b,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const r in this._style._sourceCaches)if(this._style._sourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const u=this._style._layers[r],g=u.isHidden(this.painter.transform.zoom);return u.type==="custom"?!g&&u.shouldRedrape():!g&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const g of this._style._getSources())if(g instanceof U){r=!0;break}if(!r)return;const u={};for(let g=0;g<this._style.order.length;++g){const y=this._style._layers[this._style.order[g]],b=this._style._getLayerSourceCache(y);if(b&&!u[b.id]&&!y.isHidden(this.painter.transform.zoom)&&y.type==="line"&&y.widthExpression()instanceof s.ZoomDependentExpression){u[b.id]=!0;for(const C of this.proxyCoords){const I=this.proxyToSource[C.key][b.id];if(I)for(const M of I)this._clearRenderCacheForTile(b.id,M)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const g in this._style._sourceCaches)if(this._style._sourceCaches[g]._source instanceof q){r=!0;break}if(!r)return;const u={};for(let g=0;g<this._style.order.length;++g){const y=this._style._layers[this._style.order[g]],b=this._style._getLayerSourceCache(y);if(!b||u[b.id]||y.isHidden(this.painter.transform.zoom)||y.type!=="raster")continue;const C=y.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const M=this.proxyToSource[I.key][b.id];if(M)for(const B of M){const O=Bl(b.getTile(B),b.findLoadedParent(B,0),b,this.painter.transform,C);(O.opacity!==1||O.mix!==0)&&this._clearRenderCacheForTile(b.id,B)}}}}_setupDrapedRenderBatches(){const r=this._style.order,u=r.length;if(u===0)return;const g=[];let y,b=0,C=this._style._layers[r[b]];for(;!this._style.isLayerDraped(C)&&C.isHidden(this.painter.transform.zoom)&&++b<u;)C=this._style._layers[r[b]];for(;b<u;++b){const I=this._style._layers[r[b]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?y===void 0&&(y=b):y!==void 0&&(g.push({start:y,end:b-1}),y=void 0))}y!==void 0&&g.push({start:y,end:b-1}),this._drapedRenderBatches=g}_setupRenderCache(r){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const C=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let I=0;I<C.length;++I){const M=Object.values(C[I]);u.renderCachePool.push(...M)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,y=this._tilesDirty;for(let C=g.length-1;C>=0;C--){const I=g[C];if(u.getTileByID(I.key),u.proxyCachedFBO[I.key]!==void 0){const M=r[I.key],B=this.proxyToSource[I.key];let O=0;for(const j in B){const H=B[j],Q=M[j];if(!Q||Q.length!==H.length||H.some((J,ee)=>J!==Q[ee]||y[j]&&y[j].hasOwnProperty(J.key))){O=-1;break}++O}for(const j in u.proxyCachedFBO[I.key])u.renderCache[u.proxyCachedFBO[I.key][j]].dirty=O<0||O!==Object.values(M).length}}const b=[...this._drapedRenderBatches];b.sort((C,I)=>I.end-I.start-(C.end-C.start));for(const C of b)for(const I of g){if(u.proxyCachedFBO[I.key])continue;let M=u.renderCachePool.pop();M===void 0&&u.renderCache.length<50&&(M=u.renderCache.length,u.renderCache.push(this._createFBO())),M!==void 0&&(u.proxyCachedFBO[I.key]={},u.proxyCachedFBO[I.key][C.start]=M,u.renderCache[M].dirty=!0)}this._tilesDirty={}}_setupStencil(r,u,g,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,C=b.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let I;if(g.isTileClipped())I=u.length,this._overlapStencilMode.test={func:C.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:C.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(r,u){const g=this.painter,y=this.painter.context,b=y.gl;g._tileClippingMaskIDs={},y.setColorMode(s.ColorMode.disabled),y.setDepthMode(s.DepthMode.disabled);const C=g.useProgram("clippingMask");for(const I of r){const M=g._tileClippingMaskIDs[I.key]=--u;C.draw(y,b.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:b.ALWAYS,mask:0},M,255,b.KEEP,b.KEEP,b.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,$n(I.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(r){const u=this.painter.transform;if(r.x<0||r.x>u.width||r.y<0||r.y>u.height)return null;const g=[r.x,r.y,1,1];s.transformMat4$1(g,g,u.pixelMatrixInverse),s.scale$1(g,g,1/g[3]),g[0]/=u.worldSize,g[1]/=u.worldSize;const y=u._camera.position,b=s.mercatorZfromAltitude(1,u.center.lat),C=[y[0],y[1],y[2]/b,0],I=s.subtract([],g.slice(0,3),C);s.normalize(I,I);const M=this.raycast(C,I,this._exaggeration);return M!==null&&M?(s.scaleAndAdd(C,C,I,M),C[3]=C[2],C[2]*=b,C):null}drawDepth(){const r=this.painter,u=r.context,g=this.proxySourceCache,y=Math.ceil(r.width),b=Math.ceil(r.height);if(!this._depthFBO||this._depthFBO.width===y&&this._depthFBO.height===b||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const C=u.gl,I=u.createFramebuffer(y,b,!0);u.activeTexture.set(C.TEXTURE0);const M=new s.Texture(u,{width:y,height:b,data:null},C.RGBA);M.bind(C.NEAREST,C.CLAMP_TO_EDGE),I.colorAttachment.set(M.texture);const B=u.createRenderbuffer(u.gl.DEPTH_COMPONENT16,y,b);I.depthAttachment.set(B),this._depthFBO=I,this._depthTexture=M}u.bindFramebuffer.set(this._depthFBO.framebuffer),u.viewport.set([0,0,y,b]),function(C,I,M,B){if(C.transform.projection.name==="globe")return;const O=C.context,j=O.gl;O.clear({depth:1});const H=C.useProgram("terrainDepth"),Q=new s.DepthMode(j.LESS,s.DepthMode.ReadWrite,C.depthRangeFor3D);for(const J of B){const ee=M.getTile(J),te=Nh(J.projMatrix,0);I.setupElevationDraw(ee,H),H.draw(O,j.TRIANGLES,Q,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,te,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}}(r,this,g,this.proxyCoords)}_setupProxiedCoordsForOrtho(r,u,g){if(r.getSource()instanceof Ie)return this._setupProxiedCoordsForImageSource(r,u,g);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const y=this.proxiedCoords[r.id]=[],b=this.proxyCoords;for(let I=0;I<b.length;I++){const M=b[I],B=this._findTileCoveringTileID(M,r);if(B){const O=this._createProxiedId(M,B,g[M.key]&&g[M.key][r.id]);y.push(O),this.proxyToSource[M.key][r.id]=[O]}}let C=!1;for(let I=0;I<u.length;I++){const M=r.getTile(u[I]);if(!M||!M.hasData())continue;const B=this._findTileCoveringTileID(M.tileID,this.proxySourceCache);if(B&&B.tileID.canonical.z!==M.tileID.canonical.z){const O=this.proxyToSource[B.tileID.key][r.id],j=this._createProxiedId(B.tileID,M,g[B.tileID.key]&&g[B.tileID.key][r.id]);O?O.splice(O.length-1,0,j):this.proxyToSource[B.tileID.key][r.id]=[j],y.push(j),C=!0}}this._sourceTilesOverlap[r.id]=C}_setupProxiedCoordsForImageSource(r,u,g){if(!r.getSource().loaded())return;const y=this.proxiedCoords[r.id]=[],b=this.proxyCoords,C=r.getSource(),I=new s.pointGeometry(C.tileID.x,C.tileID.y)._div(1<<C.tileID.z),M=C.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((O,j)=>(O.min.x=Math.min(O.min.x,j.x-I.x),O.min.y=Math.min(O.min.y,j.y-I.y),O.max.x=Math.max(O.max.x,j.x-I.x),O.max.y=Math.max(O.max.y,j.y-I.y),O),{min:new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),B=(O,j)=>{const H=O.wrap+O.canonical.x/(1<<O.canonical.z),Q=O.canonical.y/(1<<O.canonical.z),J=s.EXTENT/(1<<O.canonical.z),ee=j.wrap+j.canonical.x/(1<<j.canonical.z),te=j.canonical.y/(1<<j.canonical.z);return H+J<ee+M.min.x||H>ee+M.max.x||Q+J<te+M.min.y||Q>te+M.max.y};for(let O=0;O<b.length;O++){const j=b[O];for(let H=0;H<u.length;H++){const Q=r.getTile(u[H]);if(!Q||!Q.hasData()||B(j,Q.tileID))continue;const J=this._createProxiedId(j,Q,g[j.key]&&g[j.key][r.id]),ee=this.proxyToSource[j.key][r.id];ee?ee.push(J):this.proxyToSource[j.key][r.id]=[J],y.push(J)}}}_createProxiedId(r,u,g){let y=this.orthoMatrix;if(g){const b=g.find(C=>C.key===u.tileID.key);if(b)return b}if(u.tileID.key!==r.key){const b=r.canonical.z-u.tileID.canonical.z;let C,I,M;y=s.create();const B=u.tileID.wrap-r.wrap<<r.overscaledZ;b>0?(C=s.EXTENT>>b,I=C*((u.tileID.canonical.x<<b)-r.canonical.x+B),M=C*((u.tileID.canonical.y<<b)-r.canonical.y)):(C=s.EXTENT<<-b,I=s.EXTENT*(u.tileID.canonical.x-(r.canonical.x+B<<-b)),M=s.EXTENT*(u.tileID.canonical.y-(r.canonical.y<<-b))),s.ortho(y,0,C,0,C,0,1),s.translate(y,y,[I,M,0])}return new Gh(u.tileID,r.key,y)}_findTileCoveringTileID(r,u){let g=u.getTile(r);if(g&&g.hasData())return g;const y=this._findCoveringTileCache[u.id],b=y[r.key];if(g=b?u.getTileByID(b):null,g&&g.hasData()||b===null)return g;let C=g?g.tileID:r,I=C.overscaledZ;const M=u.getSource().minzoom,B=[];if(!b){const j=u.getSource().maxzoom;if(r.canonical.z>=j){const H=r.canonical.z-j;u.getSource().reparseOverscaled?(I=Math.max(r.canonical.z+2,u.transform.tileZoom),C=new s.OverscaledTileID(I,r.wrap,j,r.canonical.x>>H,r.canonical.y>>H)):H!==0&&(I=j,C=new s.OverscaledTileID(I,r.wrap,j,r.canonical.x>>H,r.canonical.y>>H))}C.key!==r.key&&(B.push(C.key),g=u.getTile(C))}const O=j=>{B.forEach(H=>{y[H]=j}),B.length=0};for(I-=1;I>=M&&(!g||!g.hasData());I--){g&&O(g.tileID.key);const j=C.calculateScaledKey(I);if(g=u.getTileByID(j),g&&g.hasData())break;const H=y[j];if(H===null)break;H===void 0?B.push(j):g=u.getTileByID(H)}return O(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,u){let g=this._tilesDirty[r];g||(g=this._tilesDirty[r]={}),g[u.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const r=function(u){let g=0;const y=new s.StructArrayLayout2ui4,b=131;for(let C=1;C<129;C++){for(let I=1;I<129;I++)g=C*b+I,y.emplaceBack(g,g+1),y.emplaceBack(g,g+b),y.emplaceBack(g+1,g+b),C===128&&y.emplaceBack(g+b,g+b+1);y.emplaceBack(g+1,g+1+b)}return y}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(r),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,r.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Zh{static cacheKey(r,u,g,y){let b=`${u}${y?y.cacheKey:""}`;for(const C of g)r.usedDefines.includes(C)&&(b+=`/${C}`);return b}constructor(r,u,g,y,b,C){const I=r.gl;this.program=I.createProgram();const M=function(W){const ue=[];for(let ae=0;ae<W.length;ae++){if(W[ae]===null)continue;const pe=W[ae].split(" ");ue.push(pe.pop())}return ue}(g.staticAttributes),B=y?y.getBinderAttributes():[],O=M.concat(B);let j=y?y.defines():[];j=j.concat(C.map(W=>`#define ${W}`));const H=r.isWebGL2?`#version 300 es
`:"",Q=H+j.concat(r.extStandardDerivatives&&H.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(iu):iu,iu,nu,up.fragmentSource,Fh.fragmentSource,g.fragmentSource).join(`
`),J=H+j.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,nu,up.vertexSource,Fh.vertexSource,Oh.vertexSource,g.vertexSource).join(`
`),ee=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(ee,Q),I.compileShader(ee),I.attachShader(this.program,ee);const te=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(te,J),I.compileShader(te),I.attachShader(this.program,te),this.attributes={},this.numAttributes=O.length;for(let W=0;W<this.numAttributes;W++)O[W]&&(I.bindAttribLocation(this.program,W,O[W]),this.attributes[O[W]]=W);I.linkProgram(this.program),I.deleteShader(te),I.deleteShader(ee),this.fixedUniforms=b(r),this.binderUniforms=y?y.getUniforms(r):[],C.includes("TERRAIN")&&(this.terrainUniforms=(W=>({u_dem:new s.Uniform1i(W),u_dem_prev:new s.Uniform1i(W),u_dem_unpack:new s.Uniform4f(W),u_dem_tl:new s.Uniform2f(W),u_dem_scale:new s.Uniform1f(W),u_dem_tl_prev:new s.Uniform2f(W),u_dem_scale_prev:new s.Uniform1f(W),u_dem_size:new s.Uniform1f(W),u_dem_lerp:new s.Uniform1f(W),u_exaggeration:new s.Uniform1f(W),u_depth:new s.Uniform1i(W),u_depth_size_inv:new s.Uniform2f(W),u_meter_to_dem:new s.Uniform1f(W),u_label_plane_matrix_inv:new s.UniformMatrix4f(W)}))(r)),C.includes("GLOBE")&&(this.globeUniforms=(W=>({u_tile_tl_up:new s.Uniform3f(W),u_tile_tr_up:new s.Uniform3f(W),u_tile_br_up:new s.Uniform3f(W),u_tile_bl_up:new s.Uniform3f(W),u_tile_up_scale:new s.Uniform1f(W)}))(r)),C.includes("FOG")&&(this.fogUniforms=(W=>({u_fog_matrix:new s.UniformMatrix4f(W),u_fog_range:new s.Uniform2f(W),u_fog_color:new s.Uniform4f(W),u_fog_horizon_blend:new s.Uniform1f(W),u_fog_temporal_offset:new s.Uniform1f(W),u_frustum_tl:new s.Uniform3f(W),u_frustum_tr:new s.Uniform3f(W),u_frustum_br:new s.Uniform3f(W),u_frustum_bl:new s.Uniform3f(W),u_globe_pos:new s.Uniform3f(W),u_globe_radius:new s.Uniform1f(W),u_globe_transition:new s.Uniform1f(W),u_is_globe:new s.Uniform1i(W),u_viewport:new s.Uniform2f(W)}))(r))}}setTerrainUniformValues(r,u){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const y in u)g[y]&&g[y].set(this.program,y,u[y])}}setGlobeUniformValues(r,u){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const y in u)g[y]&&g[y].set(this.program,y,u[y])}}setFogUniformValues(r,u){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const y in u)g[y].set(this.program,y,u[y])}}draw(r,u,g,y,b,C,I,M,B,O,j,H,Q,J,ee){const te=r.gl;if(this.failedToCreate)return;r.program.set(this.program),r.setDepthMode(g),r.setStencilMode(y),r.setColorMode(b),r.setCullFace(C);for(const ue of Object.keys(this.fixedUniforms))this.fixedUniforms[ue].set(this.program,ue,I[ue]);J&&J.setUniforms(this.program,r,this.binderUniforms,H,{zoom:Q});const W={[te.LINES]:2,[te.TRIANGLES]:3,[te.LINE_STRIP]:1}[u];for(const ue of j.get()){const ae=ue.vaos||(ue.vaos={});(ae[M]||(ae[M]=new Ll)).bind(r,this,B,J?J.getPaintVertexBuffers():[],O,ue.vertexOffset,ee||[]),te.drawElements(u,ue.primitiveLength*W,te.UNSIGNED_SHORT,ue.primitiveOffset*W*2)}}}function fp(f,r){const u=Math.pow(2,r.tileID.overscaledZ),g=r.tileSize*Math.pow(2,f.transform.tileZoom)/u,y=g*(r.tileID.canonical.x+r.tileID.wrap*u),b=g*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_tile_units_to_pixels:1/kt(r,1,f.transform.tileZoom),u_pixel_coord_upper:[y>>16,b>>16],u_pixel_coord_lower:[65535&y,65535&b]}}const ov=s.create(),lu=(f,r,u,g,y,b,C,I,M,B,O)=>{const j=r.style.light,H=j.properties.get("position"),Q=[H.x,H.y,H.z],J=s.create$1();j.properties.get("anchor")==="viewport"&&(s.fromRotation(J,-r.transform.angle),s.transformMat3(Q,Q,J));const ee=j.properties.get("color"),te=r.transform,W={u_matrix:f,u_lightpos:Q,u_lightintensity:j.properties.get("intensity"),u_lightcolor:[ee.r,ee.g,ee.b],u_vertical_gradient:+u,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ov,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:y,u_edge_radius:b};return te.projection.name==="globe"&&(W.u_tile_id=[C.canonical.x,C.canonical.y,1<<C.canonical.z],W.u_zoom_transition=M,W.u_inv_rot_matrix=O,W.u_merc_center=B,W.u_up_dir=te.projection.upVector(new s.CanonicalTileID(0,0,0),B[0]*s.EXTENT,B[1]*s.EXTENT),W.u_height_lift=I),W},Wh=(f,r,u,g,y,b,C,I,M,B,O,j)=>{const H=lu(f,r,u,g,y,b,C,M,B,O,j),Q={u_height_factor:-Math.pow(2,C.overscaledZ)/I.tileSize/8};return s.extend(H,fp(r,I),Q)},cu=f=>({u_matrix:f}),uu=(f,r,u)=>s.extend(cu(f),fp(r,u)),pp=(f,r)=>({u_matrix:f,u_world:r}),mp=(f,r,u,g)=>s.extend(uu(f,r,u),{u_world:g}),sv=s.create(),Ol=(f,r,u,g,y,b)=>{const C=f.transform,I=C.projection.name==="globe";let M;if(b.paint.get("circle-pitch-alignment")==="map")if(I){const O=s.globePixelsToTileUnits(C.zoom,r.canonical)*C._pixelsPerMercatorPixel;M=Float32Array.from([O,0,0,O])}else M=C.calculatePixelsToTileUnitsMatrix(u);else M=new Float32Array([C.pixelsToGLUnits[0],0,0,C.pixelsToGLUnits[1]]);const B={u_camera_to_center_distance:C.cameraToCenterDistance,u_matrix:f.translatePosMatrix(r.projMatrix,u,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:M,u_inv_rot_matrix:sv,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){B.u_inv_rot_matrix=g,B.u_merc_center=y,B.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],B.u_zoom_transition=s.globeToMercatorTransition(C.zoom);const O=y[0]*s.EXTENT,j=y[1]*s.EXTENT;B.u_up_dir=C.projection.upVector(new s.CanonicalTileID(0,0,0),O,j)}return B},Fl=f=>{const r=[];return f.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),f.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r},gp=(f,r,u,g)=>{const y=s.EXTENT/u.tileSize;return{u_matrix:f,u_camera_to_center_distance:r.getCameraToCenterDistance(g),u_extrude_scale:[r.pixelsToGLUnits[0]/y,r.pixelsToGLUnits[1]/y]}},Vl=(f,r,u=1)=>({u_matrix:f,u_color:r,u_overlay:0,u_overlay_scale:u}),Hh=s.create(),wo=(f,r,u,g,y,b,C)=>{const I=f.transform,M=I.projection.name==="globe",B=M?s.globePixelsToTileUnits(I.zoom,r.canonical)*I._pixelsPerMercatorPixel:kt(u,1,b),O={u_matrix:r.projMatrix,u_extrude_scale:B,u_intensity:C,u_inv_rot_matrix:Hh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(M){O.u_inv_rot_matrix=g,O.u_merc_center=y,O.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],O.u_zoom_transition=s.globeToMercatorTransition(I.zoom);const j=y[0]*s.EXTENT,H=y[1]*s.EXTENT;O.u_up_dir=I.projection.upVector(new s.CanonicalTileID(0,0,0),j,H)}return O},Xh=(f,r,u,g,y,b,C)=>{const I=f.transform,M=I.calculatePixelsToTileUnitsMatrix(r);return{u_matrix:Yh(f,r,u,g),u_pixels_to_tile_units:M,u_device_pixel_ratio:b,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:y,u_texsize:du(u)?r.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:hu(r,f.transform),u_alpha_discard_threshold:0,u_trim_offset:C}},vp=(f,r,u,g,y)=>{const b=f.transform;return{u_matrix:Yh(f,r,u,g),u_texsize:r.imageAtlasTexture.size,u_pixels_to_tile_units:b.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:y,u_image:0,u_tile_units_to_pixels:hu(r,b),u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function hu(f,r){return 1/kt(f,1,r.tileZoom)}function Yh(f,r,u,g){return f.translatePosMatrix(g||r.tileID.projMatrix,r,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}function du(f){const r=f.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}const av=(f,r,u,g,y,b)=>{return{u_matrix:f,u_tl_parent:r,u_scale_parent:u,u_fade_t:g.mix,u_opacity:g.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(I=y.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(C=y.paint.get("raster-contrast"),C>0?1/(1-C):1+C),u_spin_weights:Kh(y.paint.get("raster-hue-rotate")),u_perspective_transform:b};var C,I};function Kh(f){f*=Math.PI/180;const r=Math.sin(f),u=Math.cos(f);return[(2*u+1)/3,(-Math.sqrt(3)*r-u+1)/3,(Math.sqrt(3)*r-u+1)/3]}const _p=s.create(),$l=(f,r,u,g,y,b,C,I,M,B,O,j,H,Q,J,ee)=>{const te=y.transform,W={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:te.cameraToCenterDistance,u_rotate_symbol:+u,u_aspect_ratio:te.width/te.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:C,u_coord_matrix:I,u_is_text:+M,u_pitch_with_map:+g,u_texsize:B,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:_p,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:_p,u_up_vector:[0,-1,0]};return ee.name==="globe"&&(W.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],W.u_zoom_transition=j,W.u_inv_rot_matrix=Q,W.u_merc_center=H,W.u_camera_forward=te._camera.forward(),W.u_ecef_origin=s.globeECEFOrigin(te.globeMatrix,O.toUnwrapped()),W.u_tile_matrix=Float32Array.from(te.globeMatrix),W.u_up_vector=J),W},yp=(f,r,u,g,y,b,C,I,M,B,O,j,H,Q,J,ee,te)=>s.extend($l(f,r,u,g,y,b,C,I,M,B,j,H,Q,J,ee,te),{u_gamma_scale:g?y.transform.cameraToCenterDistance*Math.cos(y.terrain?0:y.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+O}),Jh=(f,r,u,g,y,b,C,I,M,B,O,j,H,Q,J,ee)=>s.extend(yp(f,r,u,g,y,b,C,I,!0,M,!0,O,j,H,Q,J,ee),{u_texsize_icon:B,u_texture_icon:1}),lv=(f,r,u)=>({u_matrix:f,u_opacity:r,u_color:u}),Qh=(f,r,u,g,y)=>s.extend(function(b,C,I){const M=C.imageManager.getPattern(b.toString()),{width:B,height:O}=C.imageManager.getPixelSize(),j=Math.pow(2,I.tileID.overscaledZ),H=I.tileSize*Math.pow(2,C.transform.tileZoom)/j,Q=H*(I.tileID.canonical.x+I.tileID.wrap*j),J=H*I.tileID.canonical.y;return{u_image:0,u_pattern_tl:M.tl,u_pattern_br:M.br,u_texsize:[B,O],u_pattern_size:M.displaySize,u_tile_units_to_pixels:1/kt(I,1,C.transform.tileZoom),u_pixel_coord_upper:[Q>>16,J>>16],u_pixel_coord_lower:[65535&Q,65535&J]}}(g,u,y),{u_matrix:f,u_opacity:r}),cv={fillExtrusion:f=>({u_matrix:new s.UniformMatrix4f(f),u_lightpos:new s.Uniform3f(f),u_lightintensity:new s.Uniform1f(f),u_lightcolor:new s.Uniform3f(f),u_vertical_gradient:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f),u_edge_radius:new s.Uniform1f(f),u_ao:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_up_dir:new s.Uniform3f(f),u_height_lift:new s.Uniform1f(f)}),fillExtrusionPattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_lightpos:new s.Uniform3f(f),u_lightintensity:new s.Uniform1f(f),u_lightcolor:new s.Uniform3f(f),u_vertical_gradient:new s.Uniform1f(f),u_height_factor:new s.Uniform1f(f),u_edge_radius:new s.Uniform1f(f),u_ao:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_up_dir:new s.Uniform3f(f),u_height_lift:new s.Uniform1f(f),u_image:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f)}),fill:f=>({u_matrix:new s.UniformMatrix4f(f)}),fillPattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_image:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f)}),fillOutline:f=>({u_matrix:new s.UniformMatrix4f(f),u_world:new s.Uniform2f(f)}),fillOutlinePattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_world:new s.Uniform2f(f),u_image:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f)}),circle:f=>({u_camera_to_center_distance:new s.Uniform1f(f),u_extrude_scale:new s.UniformMatrix2f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_up_dir:new s.Uniform3f(f)}),collisionBox:f=>({u_matrix:new s.UniformMatrix4f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_extrude_scale:new s.Uniform2f(f)}),collisionCircle:f=>({u_matrix:new s.UniformMatrix4f(f),u_inv_matrix:new s.UniformMatrix4f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_viewport_size:new s.Uniform2f(f)}),debug:f=>({u_color:new s.UniformColor(f),u_matrix:new s.UniformMatrix4f(f),u_overlay:new s.Uniform1i(f),u_overlay_scale:new s.Uniform1f(f)}),clippingMask:f=>({u_matrix:new s.UniformMatrix4f(f)}),heatmap:f=>({u_extrude_scale:new s.Uniform1f(f),u_intensity:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_up_dir:new s.Uniform3f(f)}),heatmapTexture:f=>({u_image:new s.Uniform1i(f),u_color_ramp:new s.Uniform1i(f),u_opacity:new s.Uniform1f(f)}),hillshade:f=>({u_matrix:new s.UniformMatrix4f(f),u_image:new s.Uniform1i(f),u_latrange:new s.Uniform2f(f),u_light:new s.Uniform2f(f),u_shadow:new s.UniformColor(f),u_highlight:new s.UniformColor(f),u_accent:new s.UniformColor(f)}),hillshadePrepare:f=>({u_matrix:new s.UniformMatrix4f(f),u_image:new s.Uniform1i(f),u_dimension:new s.Uniform2f(f),u_zoom:new s.Uniform1f(f),u_unpack:new s.Uniform4f(f)}),line:f=>({u_matrix:new s.UniformMatrix4f(f),u_pixels_to_tile_units:new s.UniformMatrix2f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_units_to_pixels:new s.Uniform2f(f),u_dash_image:new s.Uniform1i(f),u_gradient_image:new s.Uniform1i(f),u_image_height:new s.Uniform1f(f),u_texsize:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f),u_alpha_discard_threshold:new s.Uniform1f(f),u_trim_offset:new s.Uniform2f(f)}),linePattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_texsize:new s.Uniform2f(f),u_pixels_to_tile_units:new s.UniformMatrix2f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_image:new s.Uniform1i(f),u_units_to_pixels:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f),u_alpha_discard_threshold:new s.Uniform1f(f)}),raster:f=>({u_matrix:new s.UniformMatrix4f(f),u_tl_parent:new s.Uniform2f(f),u_scale_parent:new s.Uniform1f(f),u_fade_t:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f),u_image0:new s.Uniform1i(f),u_image1:new s.Uniform1i(f),u_brightness_low:new s.Uniform1f(f),u_brightness_high:new s.Uniform1f(f),u_saturation_factor:new s.Uniform1f(f),u_contrast_factor:new s.Uniform1f(f),u_spin_weights:new s.Uniform3f(f),u_perspective_transform:new s.Uniform2f(f)}),symbolIcon:f=>({u_is_size_zoom_constant:new s.Uniform1i(f),u_is_size_feature_constant:new s.Uniform1i(f),u_size_t:new s.Uniform1f(f),u_size:new s.Uniform1f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_rotate_symbol:new s.Uniform1i(f),u_aspect_ratio:new s.Uniform1f(f),u_fade_change:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_label_plane_matrix:new s.UniformMatrix4f(f),u_coord_matrix:new s.UniformMatrix4f(f),u_is_text:new s.Uniform1i(f),u_pitch_with_map:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_camera_forward:new s.Uniform3f(f),u_tile_matrix:new s.UniformMatrix4f(f),u_up_vector:new s.Uniform3f(f),u_ecef_origin:new s.Uniform3f(f),u_texture:new s.Uniform1i(f)}),symbolSDF:f=>({u_is_size_zoom_constant:new s.Uniform1i(f),u_is_size_feature_constant:new s.Uniform1i(f),u_size_t:new s.Uniform1f(f),u_size:new s.Uniform1f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_rotate_symbol:new s.Uniform1i(f),u_aspect_ratio:new s.Uniform1f(f),u_fade_change:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_label_plane_matrix:new s.UniformMatrix4f(f),u_coord_matrix:new s.UniformMatrix4f(f),u_is_text:new s.Uniform1i(f),u_pitch_with_map:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_texture:new s.Uniform1i(f),u_gamma_scale:new s.Uniform1f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_camera_forward:new s.Uniform3f(f),u_tile_matrix:new s.UniformMatrix4f(f),u_up_vector:new s.Uniform3f(f),u_ecef_origin:new s.Uniform3f(f),u_is_halo:new s.Uniform1i(f)}),symbolTextAndIcon:f=>({u_is_size_zoom_constant:new s.Uniform1i(f),u_is_size_feature_constant:new s.Uniform1i(f),u_size_t:new s.Uniform1f(f),u_size:new s.Uniform1f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_rotate_symbol:new s.Uniform1i(f),u_aspect_ratio:new s.Uniform1f(f),u_fade_change:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_label_plane_matrix:new s.UniformMatrix4f(f),u_coord_matrix:new s.UniformMatrix4f(f),u_is_text:new s.Uniform1i(f),u_pitch_with_map:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_texsize_icon:new s.Uniform2f(f),u_texture:new s.Uniform1i(f),u_texture_icon:new s.Uniform1i(f),u_gamma_scale:new s.Uniform1f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_is_halo:new s.Uniform1i(f)}),background:f=>({u_matrix:new s.UniformMatrix4f(f),u_opacity:new s.Uniform1f(f),u_color:new s.UniformColor(f)}),backgroundPattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_opacity:new s.Uniform1f(f),u_image:new s.Uniform1i(f),u_pattern_tl:new s.Uniform2f(f),u_pattern_br:new s.Uniform2f(f),u_texsize:new s.Uniform2f(f),u_pattern_size:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f)}),terrainRaster:ou,terrainDepth:ou,skybox:f=>({u_matrix:new s.UniformMatrix4f(f),u_sun_direction:new s.Uniform3f(f),u_cubemap:new s.Uniform1i(f),u_opacity:new s.Uniform1f(f),u_temporal_offset:new s.Uniform1f(f)}),skyboxGradient:f=>({u_matrix:new s.UniformMatrix4f(f),u_color_ramp:new s.Uniform1i(f),u_center_direction:new s.Uniform3f(f),u_radius:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f),u_temporal_offset:new s.Uniform1f(f)}),skyboxCapture:f=>({u_matrix_3f:new s.UniformMatrix3f(f),u_sun_direction:new s.Uniform3f(f),u_sun_intensity:new s.Uniform1f(f),u_color_tint_r:new s.Uniform4f(f),u_color_tint_m:new s.Uniform4f(f),u_luminance:new s.Uniform1f(f)}),globeRaster:f=>({u_proj_matrix:new s.UniformMatrix4f(f),u_globe_matrix:new s.UniformMatrix4f(f),u_normalize_matrix:new s.UniformMatrix4f(f),u_merc_matrix:new s.UniformMatrix4f(f),u_zoom_transition:new s.Uniform1f(f),u_merc_center:new s.Uniform2f(f),u_image0:new s.Uniform1i(f),u_grid_matrix:new s.UniformMatrix3f(f),u_skirt_height:new s.Uniform1f(f),u_frustum_tl:new s.Uniform3f(f),u_frustum_tr:new s.Uniform3f(f),u_frustum_br:new s.Uniform3f(f),u_frustum_bl:new s.Uniform3f(f),u_globe_pos:new s.Uniform3f(f),u_globe_radius:new s.Uniform1f(f),u_viewport:new s.Uniform2f(f)}),globeAtmosphere:f=>({u_frustum_tl:new s.Uniform3f(f),u_frustum_tr:new s.Uniform3f(f),u_frustum_br:new s.Uniform3f(f),u_frustum_bl:new s.Uniform3f(f),u_horizon:new s.Uniform1f(f),u_transition:new s.Uniform1f(f),u_fadeout_range:new s.Uniform1f(f),u_color:new s.Uniform4f(f),u_high_color:new s.Uniform4f(f),u_space_color:new s.Uniform4f(f),u_star_intensity:new s.Uniform1f(f),u_star_density:new s.Uniform1f(f),u_star_size:new s.Uniform1f(f),u_temporal_offset:new s.Uniform1f(f),u_horizon_angle:new s.Uniform1f(f),u_rotation_matrix:new s.UniformMatrix4f(f)})};let ea;function xp(f,r,u,g,y,b,C){const I=f.context,M=I.gl,B=f.transform,O=f.useProgram("collisionBox"),j=[];let H=0,Q=0;for(let pe=0;pe<g.length;pe++){const Ce=g[pe],we=r.getTile(Ce),Ae=we.getBucket(u);if(!Ae)continue;const Be=Lh(Ce,Ae,B);let Ne=Be;y[0]===0&&y[1]===0||(Ne=f.translatePosMatrix(Be,we,y,b));const Ge=C?Ae.textCollisionBox:Ae.iconCollisionBox,wt=Ae.collisionCircleArray;if(wt.length>0){const Fe=s.create(),rt=Ne;s.mul(Fe,Ae.placementInvProjMatrix,B.glCoordMatrix),s.mul(Fe,Fe,Ae.placementViewportMatrix),j.push({circleArray:wt,circleOffset:Q,transform:rt,invTransform:Fe,projection:Ae.getProjection()}),H+=wt.length/4,Q=H}Ge&&(f.terrain&&f.terrain.setupElevationDraw(we,O),O.draw(I,M.LINES,s.DepthMode.disabled,s.StencilMode.disabled,f.colorModeForRenderPass(),s.CullFaceMode.disabled,gp(Ne,B,we,Ae.getProjection()),u.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,null,B.zoom,null,[Ge.collisionVertexBuffer,Ge.collisionVertexBufferExt]))}if(!C||!j.length)return;const J=f.useProgram("collisionCircle"),ee=new s.StructArrayLayout2f1f2i16;ee.resize(4*H),ee._trim();let te=0;for(const pe of j)for(let Ce=0;Ce<pe.circleArray.length/4;Ce++){const we=4*Ce,Ae=pe.circleArray[we+0],Be=pe.circleArray[we+1],Ne=pe.circleArray[we+2],Ge=pe.circleArray[we+3];ee.emplace(te++,Ae,Be,Ne,Ge,0),ee.emplace(te++,Ae,Be,Ne,Ge,1),ee.emplace(te++,Ae,Be,Ne,Ge,2),ee.emplace(te++,Ae,Be,Ne,Ge,3)}(!ea||ea.length<2*H)&&(ea=function(pe){const Ce=2*pe,we=new s.StructArrayLayout3ui6;we.resize(Ce),we._trim();for(let Ae=0;Ae<Ce;Ae++){const Be=6*Ae;we.uint16[Be+0]=4*Ae+0,we.uint16[Be+1]=4*Ae+1,we.uint16[Be+2]=4*Ae+2,we.uint16[Be+3]=4*Ae+2,we.uint16[Be+4]=4*Ae+3,we.uint16[Be+5]=4*Ae+0}return we}(H));const W=I.createIndexBuffer(ea,!0),ue=I.createVertexBuffer(ee,s.collisionCircleLayout.members,!0);for(const pe of j){const Ce={u_matrix:pe.transform,u_inv_matrix:pe.invTransform,u_camera_to_center_distance:(ae=B).getCameraToCenterDistance(pe.projection),u_viewport_size:[ae.width,ae.height]};J.draw(I,M.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,f.colorModeForRenderPass(),s.CullFaceMode.disabled,Ce,u.id,ue,W,s.SegmentVector.simpleSegment(0,2*pe.circleOffset,pe.circleArray.length,pe.circleArray.length/2),null,B.zoom)}var ae;ue.destroy(),W.destroy()}const ed=s.create();function bp({width:f,height:r,anchor:u,textOffset:g,textScale:y},b){const{horizontalAlign:C,verticalAlign:I}=s.getAnchorAlignment(u),M=-(C-.5)*f,B=-(I-.5)*r,O=s.evaluateVariableOffset(u,g);return new s.pointGeometry((M/y+O[0])*b,(B/y+O[1])*b)}function Oa(f,r,u,g,y,b,C,I,M,B,O){const j=f.text.placedSymbolArray,H=f.text.dynamicLayoutVertexArray,Q=f.icon.dynamicLayoutVertexArray,J={},ee=f.getProjection(),te=Xc(I,ee,b),W=b.elevation,ue=ee.upVectorScale(I.canonical,b.center.lat,b.worldSize).metersToTile;H.clear();for(let ae=0;ae<j.length;ae++){const pe=j.get(ae),{tileAnchorX:Ce,tileAnchorY:we,numGlyphs:Ae}=pe,Be=f.allowVerticalPlacement&&!pe.placedOrientation,Ne=pe.hidden||!pe.crossTileID||Be?null:g[pe.crossTileID];if(Ne){let Ge=0,wt=0,Fe=0;if(W){const Ht=W?W.getAtTileOffset(I,Ce,we):0,[gn,jt,Vt]=ee.upVector(I.canonical,Ce,we);Ge=Ht*gn*ue,wt=Ht*jt*ue,Fe=Ht*Vt*ue}let[rt,Xe,ht,Ue]=Ct(pe.projectedAnchorX+Ge,pe.projectedAnchorY+wt,pe.projectedAnchorZ+Fe,u?te:C);const Le=Rn(b.getCameraToCenterDistance(ee),Ue);let Ze=y.evaluateSizeForFeature(f.textSizeData,B,pe)*Le/s.ONE_EM;u&&(Ze*=f.tilePixelRatio/M);const lt=bp(Ne,Ze);u?({x:rt,y:Xe,z:ht}=ee.projectTilePoint(Ce+lt.x,we+lt.y,I.canonical),[rt,Xe,ht]=Ct(rt+Ge,Xe+wt,ht+Fe,C)):(r&&lt._rotate(-b.angle),rt+=lt.x,Xe+=lt.y,ht=0);const mt=f.allowVerticalPlacement&&pe.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let Ht=0;Ht<Ae;Ht++)s.addDynamicAttributes(H,rt,Xe,ht,mt);O&&pe.associatedIconIndex>=0&&(J[pe.associatedIconIndex]={x:rt,y:Xe,z:ht,angle:mt})}else ci(Ae,H)}if(O){Q.clear();const ae=f.icon.placedSymbolArray;for(let pe=0;pe<ae.length;pe++){const Ce=ae.get(pe),{numGlyphs:we}=Ce,Ae=J[pe];if(Ce.hidden||!Ae)ci(we,Q);else{const{x:Be,y:Ne,z:Ge,angle:wt}=Ae;for(let Fe=0;Fe<we;Fe++)s.addDynamicAttributes(Q,Be,Ne,Ge,wt)}}f.icon.dynamicLayoutVertexBuffer.updateData(Q)}f.text.dynamicLayoutVertexBuffer.updateData(H)}function uv(f,r,u){return u.iconsInText&&r?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function wp(f,r,u,g,y,b,C,I,M,B,O,j){const H=f.context,Q=H.gl,J=f.transform,ee=I==="map",te=M==="map",W=ee&&u.layout.get("symbol-placement")!=="point",ue=ee&&!te&&!W,ae=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let pe=!1;const Ce=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),we=[s.mercatorXfromLng(J.center.lng),s.mercatorYfromLat(J.center.lat)],Ae=u.layout.get("text-variable-anchor"),Be=J.projection.name==="globe",Ne=[],Ge=[0,-1,0];let wt=Ge;!Be&&!J.mercatorFromTransition||ee||(wt=function(Fe){const rt=Fe._camera.getWorldToCamera(Fe.worldSize,1),Xe=s.multiply([],rt,Fe.globeMatrix);s.invert(Xe,Xe);const ht=[0,0,0],Ue=[0,1,0,0];return s.transformMat4$1(Ue,Ue,Xe),ht[0]=Ue[0],ht[1]=Ue[1],ht[2]=Ue[2],s.normalize(ht,ht),ht}(J));for(const Fe of g){const rt=r.getTile(Fe),Xe=rt.getBucket(u);if(!Xe||Xe.projection.name==="mercator"&&Be)continue;const ht=y?Xe.text:Xe.icon;if(!ht||Xe.fullyClipped||!ht.segments.get().length)continue;const Ue=ht.programConfigurations.get(u.id),Le=y||Xe.sdfIcons,Ze=y?Xe.textSizeData:Xe.iconSizeData,lt=te||J.pitch!==0,mt=s.evaluateSizeForZoom(Ze,J.zoom);let Ht,gn,jt,Vt,Xt=[0,0],kn=null;if(y){if(gn=rt.glyphAtlasTexture,jt=Q.LINEAR,Ht=rt.glyphAtlasTexture.size,Xe.iconsInText){Xt=rt.imageAtlasTexture.size,kn=rt.imageAtlasTexture;const Wr=Ze.kind==="composite"||Ze.kind==="camera";Vt=lt||f.options.rotating||f.options.zooming||Wr?Q.LINEAR:Q.NEAREST}}else{const Wr=u.layout.get("icon-size").constantOr(0)!==1||Xe.iconsNeedLinear;gn=rt.imageAtlasTexture,jt=Le||f.options.rotating||f.options.zooming||Wr||lt?Q.LINEAR:Q.NEAREST,Ht=rt.imageAtlasTexture.size}const en=Xe.projection.name==="globe",Hn=en?wt:Ge,ni=en?s.globeToMercatorTransition(J.zoom):0,ui=Xc(Fe,Xe.getProjection(),J),oi=J.calculatePixelsToTileUnitsMatrix(rt),ji=Aa(ui,rt.tileID.canonical,te,ee,J,Xe.getProjection(),oi),Or=f.terrain&&te&&W?s.invert(s.create(),ji):ed,co=ka(ui,rt.tileID.canonical,te,ee,J,Xe.getProjection(),oi),Xo=Ae&&Xe.hasTextData(),yi=u.layout.get("icon-text-fit")!=="none"&&Xo&&Xe.hasIconData();if(W){const Wr=J.elevation,Jr=Wr?Wr.getAtTileOffsetFunc(Fe,J.center.lat,J.worldSize,Xe.getProjection()):null,Yo=ip(ui,rt.tileID.canonical,te,ee,J,Xe.getProjection(),oi);bo(Xe,ui,f,y,Yo,co,te,B,Jr,Fe)}const si=W||y&&Ae||yi,Un=f.translatePosMatrix(ui,rt,b,C),Mi=si?ed:ji,yr=f.translatePosMatrix(co,rt,b,C,!0),mi=Xe.getProjection().createInversionMatrix(J,Fe.canonical),xr=[];f.terrainRenderModeElevated()&&te&&xr.push("PITCH_WITH_MAP_TERRAIN"),en&&xr.push("PROJECTION_GLOBE_VIEW"),si&&xr.push("PROJECTED_POS_ON_VIEWPORT");const br=Le&&u.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let xs;xs=Le?Xe.iconsInText?Jh(Ze.kind,mt,ue,te,f,Un,Mi,yr,Ht,Xt,Fe,ni,we,mi,Hn,Xe.getProjection()):yp(Ze.kind,mt,ue,te,f,Un,Mi,yr,y,Ht,!0,Fe,ni,we,mi,Hn,Xe.getProjection()):$l(Ze.kind,mt,ue,te,f,Un,Mi,yr,y,Ht,Fe,ni,we,mi,Hn,Xe.getProjection());const Ha={program:f.useProgram(uv(Le,y,Xe),Ue,xr),buffers:ht,uniformValues:xs,atlasTexture:gn,atlasTextureIcon:kn,atlasInterpolation:jt,atlasInterpolationIcon:Vt,isSDF:Le,hasHalo:br,tile:rt,labelPlaneMatrixInv:Or};if(ae&&Xe.canOverlap){pe=!0;const Wr=ht.segments.get();for(const Jr of Wr)Ne.push({segments:new s.SegmentVector([Jr]),sortKey:Jr.sortKey,state:Ha})}else Ne.push({segments:ht.segments,sortKey:0,state:Ha})}pe&&Ne.sort((Fe,rt)=>Fe.sortKey-rt.sortKey);for(const Fe of Ne){const rt=Fe.state;if(f.terrain&&f.terrain.setupElevationDraw(rt.tile,rt.program,{useDepthForOcclusion:!Be,labelPlaneMatrixInv:rt.labelPlaneMatrixInv}),H.activeTexture.set(Q.TEXTURE0),rt.atlasTexture.bind(rt.atlasInterpolation,Q.CLAMP_TO_EDGE),rt.atlasTextureIcon&&(H.activeTexture.set(Q.TEXTURE1),rt.atlasTextureIcon&&rt.atlasTextureIcon.bind(rt.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),rt.isSDF){const Xe=rt.uniformValues;rt.hasHalo&&(Xe.u_is_halo=1,Sp(rt.buffers,Fe.segments,u,f,rt.program,Ce,O,j,Xe)),Xe.u_is_halo=0}Sp(rt.buffers,Fe.segments,u,f,rt.program,Ce,O,j,rt.uniformValues)}}function Sp(f,r,u,g,y,b,C,I,M){const B=g.context,O=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.globeExtVertexBuffer];y.draw(B,B.gl.TRIANGLES,b,C,I,s.CullFaceMode.disabled,M,u.id,f.layoutVertexBuffer,f.indexBuffer,r,u.paint,g.transform.zoom,f.programConfigurations.get(u.id),O)}function Ep(f,r,u,g,y,b,C){const I=f.context.gl,M=u.paint.get("fill-pattern"),B=M&&M.constantOr(1);let O,j,H,Q,J;C?(j=B&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",O=I.LINES):(j=B?"fillPattern":"fill",O=I.TRIANGLES);for(const ee of g){const te=r.getTile(ee);if(B&&!te.patternsLoaded())continue;const W=te.getBucket(u);if(!W)continue;f.prepareDrawTile();const ue=W.programConfigurations.get(u.id),ae=f.useProgram(j,ue);B&&(f.context.activeTexture.set(I.TEXTURE0),te.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ue.updatePaintBuffers());const pe=M.constantOr(null);if(pe&&te.imageAtlas){const we=te.imageAtlas.patternPositions[pe.toString()];we&&ue.setConstantPatternPositions(we)}const Ce=f.translatePosMatrix(ee.projMatrix,te,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(C){Q=W.indexBuffer2,J=W.segments2;const we=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];H=j==="fillOutlinePattern"&&B?mp(Ce,f,te,we):pp(Ce,we)}else Q=W.indexBuffer,J=W.segments,H=B?uu(Ce,f,te):cu(Ce);f.prepareDrawProgram(f.context,ae,ee.toUnwrapped()),ae.draw(f.context,O,y,f.stencilModeForClipping(ee),b,s.CullFaceMode.disabled,H,u.id,W.layoutVertexBuffer,Q,J,u.paint,f.transform.zoom,ue)}}function td(f,r,u,g,y,b,C){const I=f.context,M=I.gl,B=f.transform,O=u.paint.get("fill-extrusion-pattern"),j=O.constantOr(1),H=u.paint.get("fill-extrusion-opacity"),Q=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),u.paint.get("fill-extrusion-ambient-occlusion-radius")],J=u.layout.get("fill-extrusion-edge-radius"),ee=B.projection.name==="globe"?s.fillExtrusionHeightLift():0,te=B.projection.name==="globe",W=te?s.globeToMercatorTransition(B.zoom):0,ue=[s.mercatorXfromLng(B.center.lng),s.mercatorYfromLat(B.center.lat)],ae=[];te&&ae.push("PROJECTION_GLOBE_VIEW"),Q[0]>0&&ae.push("FAUX_AO");for(const pe of g){const Ce=r.getTile(pe),we=Ce.getBucket(u);if(!we||we.projection.name!==B.projection.name)continue;const Ae=we.programConfigurations.get(u.id),Be=f.useProgram(j?"fillExtrusionPattern":"fillExtrusion",Ae,ae);if(f.terrain){const ht=f.terrain;if(f.style.terrainSetForDrapingOnly())ht.setupElevationDraw(Ce,Be,{useMeterToDem:!0});else{if(!we.enableTerrain)continue;if(ht.setupElevationDraw(Ce,Be,{useMeterToDem:!0}),hv(I,r,pe,we,u,ht),!we.centroidVertexBuffer){const Ue=Be.attributes.a_centroid_pos;Ue!==void 0&&M.vertexAttrib2f(Ue,0,0)}}}j&&(f.context.activeTexture.set(M.TEXTURE0),Ce.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),Ae.updatePaintBuffers());const Ne=O.constantOr(null);if(Ne&&Ce.imageAtlas){const ht=Ce.imageAtlas.patternPositions[Ne.toString()];ht&&Ae.setConstantPatternPositions(ht)}const Ge=f.translatePosMatrix(pe.projMatrix,Ce,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),wt=B.projection.createInversionMatrix(B,pe.canonical),Fe=u.paint.get("fill-extrusion-vertical-gradient"),rt=j?Wh(Ge,f,Fe,H,Q,J,pe,Ce,ee,W,ue,wt):lu(Ge,f,Fe,H,Q,J,pe,ee,W,ue,wt);f.prepareDrawProgram(I,Be,pe.toUnwrapped());const Xe=[];f.terrain&&Xe.push(we.centroidVertexBuffer),te&&Xe.push(we.layoutVertexExtBuffer),Be.draw(I,I.gl.TRIANGLES,y,b,C,s.CullFaceMode.backCCW,rt,u.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,u.paint,f.transform.zoom,Ae,Xe)}}function hv(f,r,u,g,y,b){const C=[W=>{let ue=W.canonical.x-1,ae=W.wrap;return ue<0&&(ue=(1<<W.canonical.z)-1,ae--),new s.OverscaledTileID(W.overscaledZ,ae,W.canonical.z,ue,W.canonical.y)},W=>{let ue=W.canonical.x+1,ae=W.wrap;return ue===1<<W.canonical.z&&(ue=0,ae++),new s.OverscaledTileID(W.overscaledZ,ae,W.canonical.z,ue,W.canonical.y)},W=>new s.OverscaledTileID(W.overscaledZ,W.wrap,W.canonical.z,W.canonical.x,(W.canonical.y===0?1<<W.canonical.z:W.canonical.y)-1),W=>new s.OverscaledTileID(W.overscaledZ,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y===(1<<W.canonical.z)-1?0:W.canonical.y+1)],I=W=>{const ue=r.getSource().minzoom,ae=Ce=>{const we=r.getTileByID(Ce);if(we&&we.hasData())return we.getBucket(y)},pe=[0,-1,1];for(const Ce of pe){if(W.overscaledZ+Ce<ue)continue;const we=ae(W.calculateScaledKey(W.overscaledZ+Ce));if(we)return we}},M=[0,0,0],B=(W,ue)=>(M[0]=Math.min(W.min.y,ue.min.y),M[1]=Math.max(W.max.y,ue.max.y),M[2]=s.EXTENT-ue.min.x>W.max.x?ue.min.x-s.EXTENT:W.max.x,M),O=(W,ue)=>(M[0]=Math.min(W.min.x,ue.min.x),M[1]=Math.max(W.max.x,ue.max.x),M[2]=s.EXTENT-ue.min.y>W.max.y?ue.min.y-s.EXTENT:W.max.y,M),j=[(W,ue)=>B(W,ue),(W,ue)=>B(ue,W),(W,ue)=>O(W,ue),(W,ue)=>O(ue,W)],H=new s.pointGeometry(0,0);let Q,J,ee;const te=(W,ue,ae,pe,Ce)=>{const we=[[pe?ae:W,pe?W:ae,0],[pe?ae:ue,pe?ue:ae,0]],Ae=Ce<0?s.EXTENT+Ce:Ce,Be=[pe?Ae:(W+ue)/2,pe?(W+ue)/2:Ae,0];return ae===0&&Ce<0||ae!==0&&Ce>0?b.getForTilePoints(ee,[Be],!0,J):we.push(Be),b.getForTilePoints(u,we,!0,Q),Math.max(we[0][2],we[1][2],Be[2])/b.exaggeration()};for(let W=0;W<4;W++){const ue=(W<2?1:5)-W,ae=g.borders[W];if(ae.length===0)continue;const pe=ee=C[W](u),Ce=I(pe);if(!(Ce&&Ce instanceof s.FillExtrusionBucket&&Ce.enableTerrain)||g.borderDoneWithNeighborZ[W]===Ce.canonical.z&&Ce.borderDoneWithNeighborZ[ue]===g.canonical.z||(J=b.findDEMTileFor(pe),!J||!J.dem))continue;if(!Q){const Ne=b.findDEMTileFor(u);if(!Ne||!Ne.dem)return;Q=Ne}const we=Ce.borders[ue];let Ae=0;const Be=Ce.borderDoneWithNeighborZ[ue]!==g.canonical.z;if(g.canonical.z===Ce.canonical.z){for(let Ne=0;Ne<ae.length;Ne++){const Ge=g.featuresOnBorder[ae[Ne]],wt=Ge.borders[W];let Fe;for(;Ae<we.length&&(Fe=Ce.featuresOnBorder[we[Ae]],!(Fe.borders[ue][1]>wt[0]+3));)Be&&Ce.encodeCentroid(void 0,Fe,!1),Ae++;if(Fe&&Ae<we.length){const rt=Ae;let Xe=0;for(;!(Fe.borders[ue][0]>wt[1]-3)&&(Xe++,++Ae!==we.length);)Fe=Ce.featuresOnBorder[we[Ae]];if(Fe=Ce.featuresOnBorder[we[rt]],Ge.intersectsCount()>1||Fe.intersectsCount()>1||Xe!==1){Xe!==1&&(Ae=rt),g.encodeCentroid(void 0,Ge,!1),Be&&Ce.encodeCentroid(void 0,Fe,!1);continue}const ht=j[W](Ge,Fe),Ue=W%2?s.EXTENT-1:0;H.x=te(ht[0],Math.min(s.EXTENT-1,ht[1]),Ue,W<2,ht[2]),H.y=0,g.encodeCentroid(H,Ge,!1),Be&&Ce.encodeCentroid(H,Fe,!1)}else g.encodeCentroid(void 0,Ge,!1)}g.borderDoneWithNeighborZ[W]=Ce.canonical.z,g.needsCentroidUpdate=!0,Be&&(Ce.borderDoneWithNeighborZ[ue]=g.canonical.z,Ce.needsCentroidUpdate=!0)}else{for(const Ne of ae)g.encodeCentroid(void 0,g.featuresOnBorder[Ne],!1);if(Be){for(const Ne of we)Ce.encodeCentroid(void 0,Ce.featuresOnBorder[Ne],!1);Ce.borderDoneWithNeighborZ[ue]=g.canonical.z,Ce.needsCentroidUpdate=!0}g.borderDoneWithNeighborZ[W]=Ce.canonical.z,g.needsCentroidUpdate=!0}}(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(f)}const nd=new s.Color(1,0,0,1),id=new s.Color(0,1,0,1),Tp=new s.Color(0,0,1,1),Cp=new s.Color(1,0,1,1),Ip=new s.Color(0,1,1,1);function rd(f,r,u){const g=f.context,y=f.transform,b=g.gl,C=y.projection.name==="globe",I=C?["PROJECTION_GLOBE_VIEW"]:null;let M=u.projMatrix;if(C&&s.globeToMercatorTransition(y.zoom)>0){const Ge=s.transitionTileAABBinECEF(u.canonical,y),wt=s.globeDenormalizeECEF(Ge);M=s.multiply(new Float32Array(16),y.globeMatrix,wt),s.multiply(M,y.projMatrix,M)}const B=f.useProgram("debug",null,I),O=r.getTileByID(u.key);f.terrain&&f.terrain.setupElevationDraw(O,B);const j=s.DepthMode.disabled,H=s.StencilMode.disabled,Q=f.colorModeForRenderPass(),J="$debug";g.activeTexture.set(b.TEXTURE0),f.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),C?O._makeGlobeTileDebugBuffers(f.context,y):O._makeDebugTileBoundsBuffers(f.context,y.projection);const ee=O._tileDebugBuffer||f.debugBuffer,te=O._tileDebugIndexBuffer||f.debugIndexBuffer,W=O._tileDebugSegments||f.debugSegments;B.draw(g,b.LINE_STRIP,j,H,Q,s.CullFaceMode.disabled,Vl(M,s.Color.red),J,ee,te,W,null,null,null,[O._globeTileDebugBorderBuffer]);const ue=O.latestRawTileData,ae=Math.floor((ue&&ue.byteLength||0)/1024),pe=r.getTile(u).tileSize,Ce=512/Math.min(pe,512)*(u.overscaledZ/y.zoom)*.5;let we=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(we+=` => ${u.overscaledZ}`),we+=` ${ae}kb`,function(Ge,wt){Ge.initDebugOverlayCanvas();const Fe=Ge.debugOverlayCanvas,rt=Ge.context.gl,Xe=Ge.debugOverlayCanvas.getContext("2d");Xe.clearRect(0,0,Fe.width,Fe.height),Xe.shadowColor="white",Xe.shadowBlur=2,Xe.lineWidth=1.5,Xe.strokeStyle="white",Xe.textBaseline="top",Xe.font="bold 36px Open Sans, sans-serif",Xe.fillText(wt,5,5),Xe.strokeText(wt,5,5),Ge.debugOverlayTexture.update(Fe),Ge.debugOverlayTexture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE)}(f,we);const Ae=O._tileDebugTextBuffer||f.debugBuffer,Be=O._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,Ne=O._tileDebugTextSegments||f.debugSegments;B.draw(g,b.TRIANGLES,j,H,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,Vl(M,s.Color.transparent,Ce),J,Ae,Be,Ne,null,null,null,[O._globeTileDebugTextBuffer])}function ys(f,r,u,g){Nl(f,0,r+u/2,f.transform.width,u,g)}function Fa(f,r,u,g){Nl(f,r-u/2,0,u,f.transform.height,g)}function Nl(f,r,u,g,y,b){const C=f.context,I=C.gl;I.enable(I.SCISSOR_TEST),I.scissor(r*s.exported.devicePixelRatio,u*s.exported.devicePixelRatio,g*s.exported.devicePixelRatio,y*s.exported.devicePixelRatio),C.clear({color:b}),I.disable(I.SCISSOR_TEST)}const Va=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:$a}=Va;function Wo(f,r,u,g){f.emplaceBack(r,u,g)}class fu{constructor(r){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,Wo(this.vertexArray,-1,-1,1),Wo(this.vertexArray,1,-1,1),Wo(this.vertexArray,-1,1,1),Wo(this.vertexArray,1,1,1),Wo(this.vertexArray,-1,-1,-1),Wo(this.vertexArray,1,-1,-1),Wo(this.vertexArray,-1,1,-1),Wo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,$a),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function Vn(f,r,u,g,y,b){const C=f.gl,I=r.paint.get("sky-atmosphere-color"),M=r.paint.get("sky-atmosphere-halo-color"),B=r.paint.get("sky-atmosphere-sun-intensity"),O=((j,H,Q,J,ee)=>({u_matrix_3f:j,u_sun_direction:H,u_sun_intensity:Q,u_color_tint_r:[J.r,J.g,J.b,J.a],u_color_tint_m:[ee.r,ee.g,ee.b,ee.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),g),y,B,I,M);C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+b,r.skyboxTexture,0),u.draw(f,C.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,O,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const pu=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class dv{constructor(r){const u=new s.StructArrayLayout5f20;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const g=new s.StructArrayLayout3ui6;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(u,pu.members),this.indexBuffer=r.createIndexBuffer(g),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const od={symbol:function(f,r,u,g,y){if(f.renderPass!=="translucent")return;const b=s.StencilMode.disabled,C=f.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(I,M,B,O,j,H,Q){const J=M.transform,ee=j==="map",te=H==="map";for(const W of I){const ue=O.getTile(W),ae=ue.getBucket(B);if(!ae||!ae.text||!ae.text.segments.get().length)continue;const pe=s.evaluateSizeForZoom(ae.textSizeData,J.zoom),Ce=Xc(W,ae.getProjection(),J),we=J.calculatePixelsToTileUnitsMatrix(ue),Ae=Aa(Ce,ue.tileID.canonical,te,ee,J,ae.getProjection(),we),Be=B.layout.get("icon-text-fit")!=="none"&&ae.hasIconData();if(pe){const Ne=Math.pow(2,J.zoom-ue.tileID.overscaledZ);Oa(ae,ee,te,Q,s.symbolSize,J,Ae,W,Ne,pe,Be)}}}(g,f,u,r,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),y),u.paint.get("icon-opacity").constantOr(1)!==0&&wp(f,r,u,g,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),b,C),u.paint.get("text-opacity").constantOr(1)!==0&&wp(f,r,u,g,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),b,C),r.map.showCollisionBoxes&&(xp(f,r,u,g,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),xp(f,r,u,g,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(f,r,u,g){if(f.renderPass!=="translucent")return;const y=u.paint.get("circle-opacity"),b=u.paint.get("circle-stroke-width"),C=u.paint.get("circle-stroke-opacity"),I=u.layout.get("circle-sort-key").constantOr(1)!==void 0;if(y.constantOr(1)===0&&(b.constantOr(1)===0||C.constantOr(1)===0))return;const M=f.context,B=M.gl,O=f.transform,j=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),H=s.StencilMode.disabled,Q=f.colorModeForRenderPass(),J=O.projection.name==="globe",ee=[s.mercatorXfromLng(O.center.lng),s.mercatorYfromLat(O.center.lat)],te=[];for(let ue=0;ue<g.length;ue++){const ae=g[ue],pe=r.getTile(ae),Ce=pe.getBucket(u);if(!Ce||Ce.projection.name!==O.projection.name)continue;const we=Ce.programConfigurations.get(u.id),Ae=Fl(u);J&&Ae.push("PROJECTION_GLOBE_VIEW");const Be=f.useProgram("circle",we,Ae),Ne=Ce.layoutVertexBuffer,Ge=Ce.globeExtVertexBuffer,wt=Ce.indexBuffer,Fe=O.projection.createInversionMatrix(O,ae.canonical),rt={programConfiguration:we,program:Be,layoutVertexBuffer:Ne,globeExtVertexBuffer:Ge,indexBuffer:wt,uniformValues:Ol(f,ae,pe,Fe,ee,u),tile:pe};if(I){const Xe=Ce.segments.get();for(const ht of Xe)te.push({segments:new s.SegmentVector([ht]),sortKey:ht.sortKey,state:rt})}else te.push({segments:Ce.segments,sortKey:0,state:rt})}I&&te.sort((ue,ae)=>ue.sortKey-ae.sortKey);const W={useDepthForOcclusion:!J};for(const ue of te){const{programConfiguration:ae,program:pe,layoutVertexBuffer:Ce,globeExtVertexBuffer:we,indexBuffer:Ae,uniformValues:Be,tile:Ne}=ue.state,Ge=ue.segments;f.terrain&&f.terrain.setupElevationDraw(Ne,pe,W),f.prepareDrawProgram(M,pe,Ne.tileID.toUnwrapped()),pe.draw(M,B.TRIANGLES,j,H,Q,s.CullFaceMode.disabled,Be,u.id,Ce,Ae,Ge,u.paint,O.zoom,ae,[we])}},heatmap:function(f,r,u,g){if(u.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const y=f.context,b=y.gl,C=s.StencilMode.disabled,I=new s.ColorMode([b.ONE,b.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(Q,J,ee,te){const W=Q.gl,ue=J.width*te,ae=J.height*te;Q.activeTexture.set(W.TEXTURE1),Q.viewport.set([0,0,ue,ae]);let pe=ee.heatmapFbo;if(!pe||pe&&(pe.width!==ue||pe.height!==ae)){pe&&pe.destroy();const Ce=W.createTexture();W.bindTexture(W.TEXTURE_2D,Ce),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MIN_FILTER,W.LINEAR),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MAG_FILTER,W.LINEAR),pe=ee.heatmapFbo=Q.createFramebuffer(ue,ae,!1),function(we,Ae,Be,Ne,Ge,wt){const Fe=we.gl;Fe.texImage2D(Fe.TEXTURE_2D,0,we.isWebGL2&&we.extRenderToTextureHalfFloat?Fe.RGBA16F:Fe.RGBA,Ge,wt,0,Fe.RGBA,we.extRenderToTextureHalfFloat?we.isWebGL2?Fe.HALF_FLOAT:we.extTextureHalfFloat.HALF_FLOAT_OES:Fe.UNSIGNED_BYTE,null),Ne.colorAttachment.set(Be)}(Q,0,Ce,pe,ue,ae)}else W.bindTexture(W.TEXTURE_2D,pe.colorAttachment.get()),Q.bindFramebuffer.set(pe.framebuffer)})(y,f,u,f.transform.projection.name==="globe"?.5:.25),y.clear({color:s.Color.transparent});const M=f.transform,B=M.projection.name==="globe",O=B?["PROJECTION_GLOBE_VIEW"]:null,j=B?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,H=[s.mercatorXfromLng(M.center.lng),s.mercatorYfromLat(M.center.lat)];for(let Q=0;Q<g.length;Q++){const J=g[Q];if(r.hasRenderableParent(J))continue;const ee=r.getTile(J),te=ee.getBucket(u);if(!te||te.projection.name!==M.projection.name)continue;const W=te.programConfigurations.get(u.id),ue=f.useProgram("heatmap",W,O),{zoom:ae}=f.transform;f.terrain&&f.terrain.setupElevationDraw(ee,ue),f.prepareDrawProgram(y,ue,J.toUnwrapped());const pe=M.projection.createInversionMatrix(M,J.canonical);ue.draw(y,b.TRIANGLES,s.DepthMode.disabled,C,I,j,wo(f,J,ee,pe,H,ae,u.paint.get("heatmap-intensity")),u.id,te.layoutVertexBuffer,te.indexBuffer,te.segments,u.paint,f.transform.zoom,W,B?[te.globeExtVertexBuffer]:null)}y.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(y,b){const C=y.context,I=C.gl,M=b.heatmapFbo;if(!M)return;C.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,M.colorAttachment.get()),C.activeTexture.set(I.TEXTURE1);let B=b.colorRampTexture;B||(B=b.colorRampTexture=new s.Texture(C,b.colorRamp,I.RGBA)),B.bind(I.LINEAR,I.CLAMP_TO_EDGE),y.useProgram("heatmapTexture").draw(C,I.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,y.colorModeForRenderPass(),s.CullFaceMode.disabled,((O,j,H,Q)=>({u_image:0,u_color_ramp:1,u_opacity:j.paint.get("heatmap-opacity")}))(0,b),b.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,b.paint,y.transform.zoom)}(f,u))},line:function(f,r,u,g){if(f.renderPass!=="translucent")return;const y=u.paint.get("line-opacity"),b=u.paint.get("line-width");if(y.constantOr(1)===0||b.constantOr(1)===0)return;const C=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),I=f.colorModeForRenderPass(),M=f.terrain&&f.terrain.renderingToTexture?1:s.exported.devicePixelRatio,B=u.paint.get("line-dasharray"),O=B.constantOr(1),j=u.layout.get("line-cap"),H=u.paint.get("line-pattern"),Q=H.constantOr(1),J=u.paint.get("line-gradient"),ee=Q?"linePattern":"line",te=f.context,W=te.gl,ue=(pe=>{const Ce=[];du(pe)&&Ce.push("RENDER_LINE_DASH"),pe.paint.get("line-gradient")&&Ce.push("RENDER_LINE_GRADIENT");const we=pe.paint.get("line-trim-offset");we[0]===0&&we[1]===0||Ce.push("RENDER_LINE_TRIM_OFFSET");const Ae=pe.paint.get("line-pattern").constantOr(1),Be=pe.paint.get("line-opacity").constantOr(1)!==1;return!Ae&&Be&&Ce.push("RENDER_LINE_ALPHA_DISCARD"),Ce})(u);let ae=ue.includes("RENDER_LINE_ALPHA_DISCARD");f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(ae=!1);for(const pe of g){const Ce=r.getTile(pe);if(Q&&!Ce.patternsLoaded())continue;const we=Ce.getBucket(u);if(!we)continue;f.prepareDrawTile();const Ae=we.programConfigurations.get(u.id),Be=f.useProgram(ee,Ae,ue),Ne=H.constantOr(null);if(Ne&&Ce.imageAtlas){const Le=Ce.imageAtlas.patternPositions[Ne.toString()];Le&&Ae.setConstantPatternPositions(Le)}const Ge=B.constantOr(null),wt=j.constantOr(null);if(!Q&&Ge&&wt&&Ce.lineAtlas){const Le=Ce.lineAtlas.getDash(Ge,wt);Le&&Ae.setConstantPatternPositions(Le)}let[Fe,rt]=u.paint.get("line-trim-offset");(wt==="round"||wt==="square")&&Fe!==rt&&(Fe===0&&(Fe-=1),rt===1&&(rt+=1));const Xe=f.terrain?pe.projMatrix:null,ht=Q?vp(f,Ce,u,Xe,M):Xh(f,Ce,u,Xe,we.lineClipsArray.length,M,[Fe,rt]);if(J){const Le=we.gradients[u.id];let Ze=Le.texture;if(u.gradientVersion!==Le.version){let lt=256;if(u.stepInterpolant){const mt=r.getSource().maxzoom,Ht=pe.canonical.z===mt?Math.ceil(1<<f.transform.maxZoom-pe.canonical.z):1;lt=s.clamp(s.nextPowerOfTwo(we.maxLineLength/s.EXTENT*1024*Ht),256,te.maxTextureSize)}Le.gradient=s.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:lt,image:Le.gradient||void 0,clips:we.lineClipsArray}),Le.texture?Le.texture.update(Le.gradient):Le.texture=new s.Texture(te,Le.gradient,W.RGBA),Le.version=u.gradientVersion,Ze=Le.texture}te.activeTexture.set(W.TEXTURE1),Ze.bind(u.stepInterpolant?W.NEAREST:W.LINEAR,W.CLAMP_TO_EDGE)}O&&(te.activeTexture.set(W.TEXTURE0),Ce.lineAtlasTexture.bind(W.LINEAR,W.REPEAT),Ae.updatePaintBuffers()),Q&&(te.activeTexture.set(W.TEXTURE0),Ce.imageAtlasTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),Ae.updatePaintBuffers()),f.prepareDrawProgram(te,Be,pe.toUnwrapped());const Ue=Le=>{Be.draw(te,W.TRIANGLES,C,Le,I,s.CullFaceMode.disabled,ht,u.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,u.paint,f.transform.zoom,Ae,[we.layoutVertexBuffer2])};if(ae){const Le=f.stencilModeForClipping(pe).ref;Le===0&&f.terrain&&te.clear({stencil:0});const Ze={func:W.EQUAL,mask:255};ht.u_alpha_discard_threshold=.8,Ue(new s.StencilMode(Ze,Le,255,W.KEEP,W.KEEP,W.INVERT)),ht.u_alpha_discard_threshold=0,Ue(new s.StencilMode(Ze,Le,255,W.KEEP,W.KEEP,W.KEEP))}else Ue(f.stencilModeForClipping(pe))}ae&&(f.resetStencilClippingMasks(),f.terrain&&te.clear({stencil:0}))},fill:function(f,r,u,g){const y=u.paint.get("fill-color"),b=u.paint.get("fill-opacity");if(b.constantOr(1)===0)return;const C=f.colorModeForRenderPass(),I=u.paint.get("fill-pattern"),M=f.opaquePassEnabledForLayer()&&!I.constantOr(1)&&y.constantOr(s.Color.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===M){const B=f.depthModeForSublayer(1,f.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);Ep(f,r,u,g,B,C,!1)}if(f.renderPass==="translucent"&&u.paint.get("fill-antialias")){const B=f.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);Ep(f,r,u,g,B,C,!0)}},"fill-extrusion":function(f,r,u,g){const y=u.paint.get("fill-extrusion-opacity");if(y!==0&&f.renderPass==="translucent"){const b=new s.DepthMode(f.context.gl.LEQUAL,s.DepthMode.ReadWrite,f.depthRangeFor3D);if(y!==1||u.paint.get("fill-extrusion-pattern").constantOr(1))td(f,r,u,g,b,s.StencilMode.disabled,s.ColorMode.disabled),td(f,r,u,g,b,f.stencilModeFor3D(),f.colorModeForRenderPass()),f.resetStencilClippingMasks();else{const C=f.colorModeForRenderPass();td(f,r,u,g,b,s.StencilMode.disabled,C)}}},hillshade:function(f,r,u,g){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent")return;const y=f.context,b=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),C=f.colorModeForRenderPass(),I=f.terrain&&f.terrain.renderingToTexture,[M,B]=f.renderPass!=="translucent"||I?[{},g]:f.stencilConfigForOverlap(g);for(const O of B){const j=r.getTile(O);if(j.needsHillshadePrepare&&f.renderPass==="offscreen")ru(f,j,u,b,s.StencilMode.disabled,C);else if(f.renderPass==="translucent"){const H=I&&f.terrain?f.terrain.stencilModeForRTTOverlap(O):M[O.overscaledZ];Rl(f,O,j,u,b,H,C)}}y.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,r,u,g,y,b){if(f.renderPass!=="translucent"||u.paint.get("raster-opacity")===0||!g.length)return;const C=f.context,I=C.gl,M=r.getSource(),B=f.useProgram("raster"),O=f.colorModeForRenderPass(),j=f.terrain&&f.terrain.renderingToTexture,[H,Q]=M instanceof Ie||j?[{},g]:f.stencilConfigForOverlap(g),J=Q[Q.length-1].overscaledZ,ee=!f.options.moving;for(const te of Q){const W=j?s.DepthMode.disabled:f.depthModeForSublayer(te.overscaledZ-J,u.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,I.LESS),ue=te.toUnwrapped(),ae=r.getTile(te);if(j&&(!ae||!ae.hasData()))continue;const pe=j?te.projMatrix:f.transform.calculateProjMatrix(ue,ee),Ce=f.terrain&&j?f.terrain.stencilModeForRTTOverlap(te):H[te.overscaledZ],we=b?0:u.paint.get("raster-fade-duration");ae.registerFadeDuration(we);const Ae=r.findLoadedParent(te,0),Be=Bl(ae,Ae,r,f.transform,we);let Ne,Ge;f.terrain&&f.terrain.prepareDrawTile();const wt=u.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;C.activeTexture.set(I.TEXTURE0),ae.texture.bind(wt,I.CLAMP_TO_EDGE),C.activeTexture.set(I.TEXTURE1),Ae?(Ae.texture.bind(wt,I.CLAMP_TO_EDGE),Ne=Math.pow(2,Ae.tileID.overscaledZ-ae.tileID.overscaledZ),Ge=[ae.tileID.canonical.x*Ne%1,ae.tileID.canonical.y*Ne%1]):ae.texture.bind(wt,I.CLAMP_TO_EDGE);const Fe=av(pe,Ge||[0,0],Ne||1,Be,u,M instanceof Ie?M.perspectiveTransform:[0,0]);if(f.prepareDrawProgram(C,B,ue),M instanceof Ie)M.boundsBuffer&&M.boundsSegments&&B.draw(C,I.TRIANGLES,W,s.StencilMode.disabled,O,s.CullFaceMode.disabled,Fe,u.id,M.boundsBuffer,f.quadTriangleIndexBuffer,M.boundsSegments);else{const{tileBoundsBuffer:rt,tileBoundsIndexBuffer:Xe,tileBoundsSegments:ht}=f.getTileBoundsBuffers(ae);B.draw(C,I.TRIANGLES,W,Ce,O,s.CullFaceMode.disabled,Fe,u.id,rt,Xe,ht)}}f.resetStencilClippingMasks()},background:function(f,r,u,g){const y=u.paint.get("background-color"),b=u.paint.get("background-opacity");if(b===0)return;const C=f.context,I=C.gl,M=f.transform,B=M.tileSize,O=u.paint.get("background-pattern");if(f.isPatternMissing(O))return;const j=!O&&y.a===1&&b===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==j)return;const H=s.StencilMode.disabled,Q=f.depthModeForSublayer(0,j==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),J=f.colorModeForRenderPass(),ee=f.useProgram(O?"backgroundPattern":"background");let te,W=g;W||(te=f.getBackgroundTiles(),W=Object.values(te).map(ue=>ue.tileID)),O&&(C.activeTexture.set(I.TEXTURE0),f.imageManager.bind(f.context));for(const ue of W){const ae=ue.toUnwrapped(),pe=g?ue.projMatrix:f.transform.calculateProjMatrix(ae);f.prepareDrawTile();const Ce=r?r.getTile(ue):te?te[ue.key]:new s.Tile(ue,B,M.zoom,f),we=O?Qh(pe,b,f,O,{tileID:ue,tileSize:B}):lv(pe,b,y);f.prepareDrawProgram(C,ee,ae);const{tileBoundsBuffer:Ae,tileBoundsIndexBuffer:Be,tileBoundsSegments:Ne}=f.getTileBoundsBuffers(Ce);ee.draw(C,I.TRIANGLES,Q,H,J,s.CullFaceMode.disabled,we,u.id,Ae,Be,Ne)}},sky:function(f,r,u){const g=f.transform,y=g.projection.name==="mercator"||g.projection.name==="globe"?1:s.smoothstep(7,8,g.zoom),b=u.paint.get("sky-opacity")*y;if(b===0)return;const C=f.context,I=u.paint.get("sky-type"),M=new s.DepthMode(C.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),B=f.frameCounter/1e3%1;I==="atmosphere"?f.renderPass==="offscreen"?u.needsSkyboxCapture(f)&&(function(O,j,H,Q){const J=O.context,ee=J.gl;let te=j.skyboxFbo;if(!te){te=j.skyboxFbo=J.createFramebuffer(32,32,!1),j.skyboxGeometry=new fu(J),j.skyboxTexture=J.gl.createTexture(),ee.bindTexture(ee.TEXTURE_CUBE_MAP,j.skyboxTexture),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MAG_FILTER,ee.LINEAR);for(let pe=0;pe<6;++pe)ee.texImage2D(ee.TEXTURE_CUBE_MAP_POSITIVE_X+pe,0,ee.RGBA,32,32,0,ee.RGBA,ee.UNSIGNED_BYTE,null)}J.bindFramebuffer.set(te.framebuffer),J.viewport.set([0,0,32,32]);const W=j.getCenter(O,!0),ue=O.useProgram("skyboxCapture"),ae=new Float64Array(16);s.identity(ae),s.rotateY(ae,ae,.5*-Math.PI),Vn(J,j,ue,ae,W,0),s.identity(ae),s.rotateY(ae,ae,.5*Math.PI),Vn(J,j,ue,ae,W,1),s.identity(ae),s.rotateX(ae,ae,.5*-Math.PI),Vn(J,j,ue,ae,W,2),s.identity(ae),s.rotateX(ae,ae,.5*Math.PI),Vn(J,j,ue,ae,W,3),s.identity(ae),Vn(J,j,ue,ae,W,4),s.identity(ae),s.rotateY(ae,ae,Math.PI),Vn(J,j,ue,ae,W,5),J.viewport.set([0,0,O.width,O.height])}(f,u),u.markSkyboxValid(f)):f.renderPass==="sky"&&function(O,j,H,Q,J){const ee=O.context,te=ee.gl,W=O.transform,ue=O.useProgram("skybox");ee.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_CUBE_MAP,j.skyboxTexture);const ae=((pe,Ce,we,Ae,Be)=>({u_matrix:pe,u_sun_direction:Ce,u_cubemap:0,u_opacity:Ae,u_temporal_offset:Be}))(W.skyboxMatrix,j.getCenter(O,!1),0,Q,J);O.prepareDrawProgram(ee,ue),ue.draw(ee,te.TRIANGLES,H,s.StencilMode.disabled,O.colorModeForRenderPass(),s.CullFaceMode.backCW,ae,"skybox",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(f,u,M,b,B):I==="gradient"&&f.renderPass==="sky"&&function(O,j,H,Q,J){const ee=O.context,te=ee.gl,W=O.transform,ue=O.useProgram("skyboxGradient");j.skyboxGeometry||(j.skyboxGeometry=new fu(ee)),ee.activeTexture.set(te.TEXTURE0);let ae=j.colorRampTexture;ae||(ae=j.colorRampTexture=new s.Texture(ee,j.colorRamp,te.RGBA)),ae.bind(te.LINEAR,te.CLAMP_TO_EDGE);const pe=((Ce,we,Ae,Be,Ne)=>({u_matrix:Ce,u_color_ramp:0,u_center_direction:we,u_radius:s.degToRad(Ae),u_opacity:Be,u_temporal_offset:Ne}))(W.skyboxMatrix,j.getCenter(O,!1),j.paint.get("sky-gradient-radius"),Q,J);O.prepareDrawProgram(ee,ue),ue.draw(ee,te.TRIANGLES,H,s.StencilMode.disabled,O.colorModeForRenderPass(),s.CullFaceMode.backCW,pe,"skyboxGradient",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(f,u,M,b,B)},debug:function(f,r,u){for(let g=0;g<u.length;g++)rd(f,r,u[g])},custom:function(f,r,u,g){const y=f.context,b=u.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&u.isLayerDraped()){if(f.renderPass==="offscreen"){const C=b.prerender;if(C){if(f.setCustomLayerDefaults(),y.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const I=f.transform.pointMerc;C.call(b,y.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(f.transform.zoom),[I.x,I.y],f.transform.pixelsPerMeterRatio)}else C.call(b,y.gl,f.transform.customLayerMatrix());y.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const I=b.renderToTile;if(I){const M=g[0].canonical,B=new s.MercatorCoordinate(M.x+g[0].wrap*(1<<M.z),M.y,M.z);y.setDepthMode(s.DepthMode.disabled),y.setStencilMode(s.StencilMode.disabled),y.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),I.call(b,y.gl,B),y.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),y.setColorMode(f.colorModeForRenderPass()),y.setStencilMode(s.StencilMode.disabled);const C=b.renderingMode==="3d"?new s.DepthMode(f.context.gl.LEQUAL,s.DepthMode.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(y.setDepthMode(C),f.transform.projection.name==="globe"){const I=f.transform.pointMerc;b.render(y.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(f.transform.zoom),[I.x,I.y],f.transform.pixelsPerMeterRatio)}else b.render(y.gl,f.transform.customLayerMatrix());y.setDirty(),f.setBaseState(),y.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Ul{constructor(r,u,g=!1){this.context=new se(r,g),this.transform=u,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new sp,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(r,u){const g=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new qh(this,r));const y=this._terrain;this.transform.elevation=g?y:null,y.update(r,this.transform,u)}_updateFog(r){const u=r.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,y]=u.getFovAdjustedRange(this.transform._fov);if(g>y)return void(this.transform.fogCullDistSq=null);const b=g+.78*(y-g);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(r,u){if(this.width=r*s.exported.devicePixelRatio,this.height=u*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._layers[g].resize()}setup(){const r=this.context,u=new s.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(s.EXTENT,0),u.emplaceBack(0,s.EXTENT),u.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(u,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const g=new s.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(s.EXTENT,0),g.emplaceBack(0,s.EXTENT),g.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=r.createVertexBuffer(g,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const y=new s.StructArrayLayout2i4;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(y,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const b=new s.StructArrayLayout4i8;b.emplaceBack(0,0,0,0),b.emplaceBack(s.EXTENT,0,s.EXTENT,0),b.emplaceBack(0,s.EXTENT,0,s.EXTENT),b.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=r.createVertexBuffer(b,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const C=new s.StructArrayLayout3ui6;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(C);const I=new s.StructArrayLayout1ui2;for(const B of[0,1,3,2,0])I.emplaceBack(B);this.debugIndexBuffer=r.createIndexBuffer(I),this.emptyTexture=new s.Texture(r,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA),this.identityMat=s.create();const M=this.context.gl;this.stencilClearMode=new s.StencilMode({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new dv(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context,u=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(r,u.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,$n(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,u,g){if(!u||this.currentStencilSource===u.id||!r.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const M of g)if(this._tileClippingMaskIDs[M.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=u.id;const y=this.context,b=y.gl;this.nextStencilID+g.length>256&&this.clearStencil(),y.setColorMode(s.ColorMode.disabled),y.setDepthMode(s.DepthMode.disabled);const C=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of g){const M=u.getTile(I),B=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:O,tileBoundsIndexBuffer:j,tileBoundsSegments:H}=this.getTileBoundsBuffers(M);C.draw(y,b.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:b.ALWAYS,mask:0},B,255,b.KEEP,b.KEEP,b.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,$n(I.projMatrix),"$clipping",O,j,H)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,u=this.context.gl;return new s.StencilMode({func:u.NOTEQUAL,mask:255},r,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const u=this.context.gl;return new s.StencilMode({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(r){const u=this.context.gl,g=r.sort((C,I)=>I.overscaledZ-C.overscaledZ),y=g[g.length-1].overscaledZ,b=g[0].overscaledZ-y+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const C={};for(let I=0;I<b;I++)C[I+y]=new s.StencilMode({func:u.GEQUAL,mask:255},I+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=b,[C,g]}return[{[y]:s.StencilMode.disabled},g]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([r.CONSTANT_COLOR,r.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(r,u,g){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new s.DepthMode(g||this.context.gl.LEQUAL,u,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,u){this.style=r,this.options=u,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const g=this.style.order,y=this.style._sourceCaches;for(const M in y){const B=y[M];B.used&&B.prepare(this.context)}const b={},C={},I={};for(const M in y){const B=y[M];b[M]=B.getVisibleCoordinates(),C[M]=b[M].slice().reverse(),I[M]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<g.length;M++)if(this.style._layers[g[M]].is3D()){this.opaquePassCutoff=M;break}if(this.terrain&&(this.terrain.updateTileBinding(I),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),s.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const M of g){const B=this.style._layers[M],O=r._getLayerSourceCache(B);if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const j=O?C[O.id]:void 0;(B.type==="custom"||B.isSky()||j&&j.length)&&this.renderLayer(this,O,B,j)}if(this.depthRangeFor3D=[0,1-(r.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:u.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[g[this.currentLayer]],B=r._getLayerSourceCache(M);if(M.isSky())continue;const O=B?C[B.id]:void 0;this._renderTileClippingMasks(M,B,O),this.renderLayer(this,B,M,O)}if(this.style.fog&&this.transform.projection.supportsFog&&function(M,B){const O=M.context,j=O.gl,H=M.transform,Q=new s.DepthMode(j.LEQUAL,s.DepthMode.ReadOnly,[0,1]),J=M.useProgram("globeAtmosphere",null,H.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ee=s.globeToMercatorTransition(H.zoom),te=B.properties.get("color").toArray01(),W=B.properties.get("high-color").toArray01(),ue=B.properties.get("space-color").toArray01PremultipliedAlpha(),ae=s.identity$1([]);s.rotateY$1(ae,ae,-s.degToRad(H._center.lng)),s.rotateX$1(ae,ae,s.degToRad(H._center.lat)),s.rotateZ$1(ae,ae,H.angle),s.rotateX$1(ae,ae,-H._pitch);const pe=s.fromQuat(new Float32Array(16),ae),Ce=s.mapValue(B.properties.get("star-intensity"),0,1,0,.25),we=5e-4,Ae=s.mapValue(B.properties.get("horizon-blend"),0,1,we,.25),Be=s.globeUseCustomAntiAliasing(M,O,H)&&Ae===we?H.worldSize/(2*Math.PI*1.025)-1:H.globeRadius,Ne=M.frameCounter/1e3%1,Ge=s.length(H.globeCenterInViewSpace),wt=Math.sqrt(Math.pow(Ge,2)-Math.pow(Be,2)),Fe=Math.acos(wt/Ge),rt=((ht,Ue,Le,Ze,lt,mt,Ht,gn,jt,Vt,Xt,kn,en,Hn)=>({u_frustum_tl:ht,u_frustum_tr:Ue,u_frustum_br:Le,u_frustum_bl:Ze,u_horizon:lt,u_transition:mt,u_fadeout_range:Ht,u_color:gn,u_high_color:jt,u_space_color:Vt,u_star_intensity:Xt,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:kn,u_horizon_angle:en,u_rotation_matrix:Hn}))(H.frustumCorners.TL,H.frustumCorners.TR,H.frustumCorners.BR,H.frustumCorners.BL,H.frustumCorners.horizon,ee,Ae,te,W,ue,Ce,Ne,Fe,pe);M.prepareDrawProgram(O,J);const Xe=M.atmosphereBuffer;Xe&&J.draw(O,j.TRIANGLES,Q,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,rt,"skybox",Xe.vertexBuffer,Xe.indexBuffer,Xe.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const M=this.style._layers[g[this.currentLayer]],B=r._getLayerSourceCache(M);M.isSky()&&this.renderLayer(this,B,M,B?C[B.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;){const M=this.style._layers[g[this.currentLayer]],B=r._getLayerSourceCache(M);if(M.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(M)){if(M.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const O=B?(M.type==="symbol"?I:C)[B.id]:void 0;this._renderTileClippingMasks(M,B,B?b[B.id]:void 0),this.renderLayer(this,B,M,O),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let M=null;s.values(this.style._layers).forEach(B=>{const O=r._getLayerSourceCache(B);O&&!B.isHidden(this.transform.zoom)&&(!M||M.getSource().maxzoom<O.getSource().maxzoom)&&(M=O)}),M&&this.options.showTileBoundaries&&od.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const B=M.transform.padding;ys(M,M.transform.height-(B.top||0),3,nd),ys(M,B.bottom||0,3,id),Fa(M,B.left||0,3,Tp),Fa(M,M.transform.width-(B.right||0),3,Cp);const O=M.transform.centerPoint;(function(j,H,Q,J){Nl(j,H-1,Q-10,2,20,J),Nl(j,H-10,Q-1,20,2,J)})(M,O.x,M.transform.height-O.y,Ip)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}}renderLayer(r,u,g,y){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||y&&y.length)&&(this.id=g.id,this.gpuTimingStart(g),(!r.transform.projection.unsupportedLayers||!r.transform.projection.unsupportedLayers.includes(g.type)||r.terrain&&g.type==="custom")&&od[g.type](r,u,g,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;let g=this.gpuTimers[r.id];g||(g=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),g.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,g.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,u=r.createQueryEXT();this.deferredRenderGpuTimeQueries.push(u),r.beginQueryEXT(r.TIME_ELAPSED_EXT,u)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const u={};for(const g in r){const y=r[g],b=this.context.extTimerQuery,C=b.getQueryObjectEXT(y.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(y.query),u[g]=C}return u}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.extTimerQuery;let g=0;for(const y of r)g+=u.getQueryObjectEXT(y,u.QUERY_RESULT_EXT)/1e6,u.deleteQueryEXT(y);return g}translatePosMatrix(r,u,g,y,b){if(!g[0]&&!g[1])return r;const C=b?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(C){const B=Math.sin(C),O=Math.cos(C);g=[g[0]*O-g[1]*B,g[0]*B+g[1]*O]}const I=[b?g[0]:kt(u,g[0],this.transform.zoom),b?g[1]:kt(u,g[1],this.transform.zoom),0],M=new Float32Array(16);return s.translate(M,r,I),M}saveTileTexture(r){const u=this._tileTextures[r.size[0]];u?u.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const u=this._tileTextures[r];return u&&u.length>0?u.pop():null}isPatternMissing(r){return r===null||r!==void 0&&!this.imageManager.getPattern(r.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const r=this.terrain&&this.terrain.renderingToTexture,u=this.terrain&&this.terrain.exaggeration()===0,g=this.style&&this.style.fog,y=[];return this.terrainRenderModeElevated()&&y.push("TERRAIN"),this.transform.projection.name==="globe"&&y.push("GLOBE"),u&&y.push("ZERO_EXAGGERATION"),g&&!r&&g.getOpacity(this.transform.pitch)!==0&&y.push("FOG"),r&&y.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&y.push("OVERDRAW_INSPECTOR"),y}useProgram(r,u,g){this.cache=this.cache||{};const y=g||[],b=this.currentGlobalDefines().concat(y),C=Zh.cacheKey(Vh[r],r,b,u);return this.cache[C]||(this.cache[C]=new Zh(this.context,r,Vh[r],u,cv[r],b)),this.cache[C]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(r,u,g){if(this.terrain&&this.terrain.renderingToTexture)return;const y=this.style.fog;if(y){const b=y.getOpacity(this.transform.pitch),C=((I,M,B,O,j,H,Q,J,ee,te,W)=>{const ue=I.transform,ae=M.properties.get("color").toArray01();ae[3]=O;const pe=I.frameCounter/1e3%1;return{u_fog_matrix:B?ue.calculateFogTileMatrix(B):I.identityMat,u_fog_range:M.getFovAdjustedRange(ue._fov),u_fog_color:ae,u_fog_horizon_blend:M.properties.get("horizon-blend"),u_fog_temporal_offset:pe,u_frustum_tl:j,u_frustum_tr:H,u_frustum_br:Q,u_frustum_bl:J,u_globe_pos:ee,u_globe_radius:te,u_viewport:W,u_globe_transition:s.globeToMercatorTransition(ue.zoom),u_is_globe:+(ue.projection.name==="globe")}})(this,y,g,b,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);u.setFogUniformValues(r,C)}}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,u=r.createTexture();return r.bindTexture(r.TEXTURE_2D,u),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,u=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const y of g)u[y.key]=r[y.key]||new s.Tile(y,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}}class sd{constructor(r=0,u=0,g=0,y=0){if(isNaN(r)||r<0||isNaN(u)||u<0||isNaN(g)||g<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=u,this.left=g,this.right=y}interpolate(r,u,g){return u.top!=null&&r.top!=null&&(this.top=s.number(r.top,u.top,g)),u.bottom!=null&&r.bottom!=null&&(this.bottom=s.number(r.bottom,u.bottom,g)),u.left!=null&&r.left!=null&&(this.left=s.number(r.left,u.left,g)),u.right!=null&&r.right!=null&&(this.right=s.number(r.right,u.right,g)),this}getCenter(r,u){const g=s.clamp((this.left+r-this.right)/2,0,r),y=s.clamp((this.top+u-this.bottom)/2,0,u);return new s.pointGeometry(g,y)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new sd(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ap(f,r){const u=s.getColumn(f,3);s.fromQuat(f,r),s.setColumn(f,3,u)}function mu(f,r){const u=s.identity$1([]);return s.rotateZ$1(u,u,-r),s.rotateX$1(u,u,-f),u}function kp(f,r){const u=[f[0],f[1],0],g=[r[0],r[1],0];if(s.length(u)>=1e-15){const C=s.normalize([],u);s.scale$2(g,C,s.dot(g,C)),r[0]=g[0],r[1]=g[1]}const y=s.cross([],r,f);if(s.len(y)<1e-15)return null;const b=Math.atan2(-y[1],y[0]);return mu(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),b)}class gu{constructor(r,u){this.position=r,this.orientation=u}get position(){return this._position}set position(r){if(r){const u=r instanceof s.MercatorCoordinate?r:new s.MercatorCoordinate(r[0],r[1],r[2]);this._renderWorldCopies&&(u.x=s.wrap(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(r,u){if(this.orientation=null,!this.position)return;const g=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(r)):0,y=this.position,b=s.MercatorCoordinate.fromLngLat(r,g),C=[b.x-y.x,b.y-y.y,b.z-y.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=kp(C,u)}setPitchBearing(r,u){this.orientation=mu(s.degToRad(r),s.degToRad(-u))}}class Na{constructor(r,u){this._transform=s.identity([]),this.orientation=u,this.position=r}get mercatorPosition(){const r=this.position;return new s.MercatorCoordinate(r[0],r[1],r[2])}get position(){const r=s.getColumn(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var u;r&&s.setColumn(this._transform,3,[(u=r)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||s.identity$1([]),r&&Ap(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,u){this._orientation=mu(r,u),Ap(this._transform,this._orientation)}forward(){const r=s.getColumn(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=s.getColumn(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=s.getColumn(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,u){const g=new Float64Array(16);return s.invert(g,this.getWorldToCamera(r,u)),g}getWorldToCameraPosition(r,u,g){const y=this.position;s.scale$2(y,y,-r);const b=new Float64Array(16);return s.fromScaling(b,[g,g,g]),s.translate(b,b,y),b[10]*=u,b}getWorldToCamera(r,u){const g=new Float64Array(16),y=new Float64Array(4),b=this.position;return s.conjugate(y,this._orientation),s.scale$2(b,b,-r),s.fromQuat(g,y),s.translate(g,g,b),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=u,g[9]*=u,g[10]*=u,g[11]*=u,g}getCameraToClipPerspective(r,u,g,y){const b=new Float64Array(16);return s.perspective(b,r,u,g,y),b}getDistanceToElevation(r,u=!1){const g=r===0?0:s.mercatorZfromAltitude(r,u?s.latFromMercatorY(this.position[1]):this.position[1]),y=this.forward();return(g-this.position[2])/y[2]}clone(){return new Na([...this.position],[...this.orientation])}}function Ua(f,r){const u=ta(f.projection,f.zoom,f.width,f.height),g=function(b,C,I,M,B){const O=new s.LngLat(I.lng-180*na,I.lat),j=new s.LngLat(I.lng+180*na,I.lat),H=b.project(O.lng,O.lat),Q=b.project(j.lng,j.lat),J=-Math.atan2(Q.y-H.y,Q.x-H.x),ee=s.MercatorCoordinate.fromLngLat(I);ee.y=s.clamp(ee.y,-.999975,.999975);const te=ee.toLngLat(),W=b.project(te.lng,te.lat),ue=s.MercatorCoordinate.fromLngLat(te);ue.x+=na;const ae=ue.toLngLat(),pe=b.project(ae.lng,ae.lat),Ce=Gl(pe.x-W.x,pe.y-W.y,J),we=s.MercatorCoordinate.fromLngLat(te);we.y+=na;const Ae=we.toLngLat(),Be=b.project(Ae.lng,Ae.lat),Ne=Gl(Be.x-W.x,Be.y-W.y,J),Ge=Math.abs(Ce.x)/Math.abs(Ne.y),wt=s.identity([]);s.rotateZ(wt,wt,-J*(1-(B?0:M)));const Fe=s.identity([]);return s.scale(Fe,Fe,[1,1-(1-Ge)*M,1]),Fe[4]=-Ne.x/Ne.y*M,s.rotateZ(Fe,Fe,J),s.multiply(Fe,wt,Fe),Fe}(f.projection,0,f.center,u,r),y=vu(f);return s.scale(g,g,[y,y,1]),g}function vu(f){const r=f.projection,u=ta(f.projection,f.zoom,f.width,f.height),g=jl(r,f.center),y=jl(r,s.LngLat.convert(r.center));return Math.pow(2,g*u+(1-u)*y)}function ta(f,r,u,g,y=1/0){const b=f.range;if(!b)return 0;const C=Math.min(y,Math.max(u,g)),I=Math.log(C/1024)/Math.LN2;return s.smoothstep(b[0]+I,b[1]+I,r)}const na=1/4e4;function jl(f,r){const u=s.clamp(r.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),g=new s.LngLat(r.lng-180*na,u),y=new s.LngLat(r.lng+180*na,u),b=f.project(g.lng,u),C=f.project(y.lng,u),I=s.MercatorCoordinate.fromLngLat(g),M=s.MercatorCoordinate.fromLngLat(y),B=C.x-b.x,O=C.y-b.y,j=M.x-I.x,H=M.y-I.y,Q=Math.sqrt((j*j+H*H)/(B*B+O*O));return Math.log(Q)/Math.LN2}function Gl(f,r,u){const g=Math.cos(u),y=Math.sin(u);return{x:f*g-r*y,y:f*y+r*g}}class Ot{constructor(r,u,g,y,b,C,I){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=r||0,this._maxZoom=u||22,this._minPitch=g==null?0:g,this._maxPitch=y==null?60:y,this.setProjection(C),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new sd,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Na,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const r=new Ot(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(r,u=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(r||g)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const g=!w(u,this.getProjection());return g&&this._calcMatrices(),this.mercatorFromTransition=!1,g}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const u=r!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.pointGeometry(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const u=-r*Math.PI/180;var g;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(g=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g),function(y,b,C){var I=b[0],M=b[1],B=b[2],O=b[3],j=Math.sin(C),H=Math.cos(C);y[0]=I*H+B*j,y[1]=M*H+O*j,y[2]=I*-j+B*H,y[3]=M*-j+O*H}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const u=s.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=s.degToRad(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const u=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const r=this._elevation;this._centerAltitude=r.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=r.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let y=0,b=0;for(let C=0;C<u.length;C++){const I=new s.pointGeometry(u[C][0]*this.width,g+u[C][1]*(this.height-g)),M=r.pointCoordinate(I);if(!M)continue;const B=1/Math.hypot(M[0]-this._camera.position[0],M[1]-this._camera.position[1]);y+=M[3]*B,b+=B}return b===0?NaN:y/b}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*u,y=this._mercatorZfromZoom(r),b=this._mercatorZfromZoom(this._maxZoom),C=Math.max(y-g,b);this._setZoom(this._zoomFromMercatorZ(C))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let g;g=r.z<this._camera.position[2]?[u.x,u.y,u.z]:[r.x,r.y,r.z];const y=s.length(s.sub([],this._camera.position,g));return s.clamp(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let u=!1;if(r.orientation&&!s.exactEquals(r.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(r.orientation)),r.position){const g=[r.position.x,r.position.y,r.position.z];s.exactEquals$1(g,this._camera.position)||(this._setCameraPosition(g),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,u=new gu;return u.position=new s.MercatorCoordinate(r[0],r[1],r[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(r){if(!s.length$1(r))return!1;s.normalize$1(r,r);const u=s.transformQuat([],[0,0,-1],r),g=s.transformQuat([],[0,-1,0],r);if(g[2]<0)return!1;const y=kp(u,g);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(r){const u=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;r[2]=s.clamp(r[2],y/g,y/u),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,u,g){this._unmodified=!1,this._edgeInsets.interpolate(r,u,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const u=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(r){const u=[new s.UnwrappedTileID(0,r)];if(this.renderWorldCopies){const g=this.pointCoordinate(new s.pointGeometry(0,0)),y=this.pointCoordinate(new s.pointGeometry(this.width,0)),b=this.pointCoordinate(new s.pointGeometry(this.width,this.height)),C=this.pointCoordinate(new s.pointGeometry(0,this.height)),I=Math.floor(Math.min(g.x,y.x,b.x,C.x)),M=Math.floor(Math.max(g.x,y.x,b.x,C.x)),B=1;for(let O=I-B;O<=M+B;O++)O!==0&&u.push(new s.UnwrappedTileID(O,r))}return u}coveringTiles(r){let u=this.coveringZoomLevel(r);const g=u,y=this.elevation&&!r.isTerrainDEM,b=this.projection.name==="mercator";if(r.minzoom!==void 0&&u<r.minzoom)return[];r.maxzoom!==void 0&&u>r.maxzoom&&(u=r.maxzoom);const C=this.locationCoordinate(this.center),I=this.center.lat,M=1<<u,B=[M*C.x,M*C.y,0],O=this.projection.name==="globe",j=!O,H=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,j),Q=O?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),J=M*s.mercatorZfromAltitude(1,this.center.lat),ee=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),te=[M*Q.x,M*Q.y,ee*(j?1:J)],W=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),ue=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?u:0,ae=r.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,pe=r.isTerrainDEM?-ae:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ce=this.projection.isReprojectedInTileSpace?vu(this):1,we=Ue=>{const Ze=new s.MercatorCoordinate(Ue.x+25e-6,Ue.y,Ue.z),lt=new s.MercatorCoordinate(Ue.x,Ue.y+25e-6,Ue.z),mt=Ue.toLngLat(),Ht=Ze.toLngLat(),gn=lt.toLngLat(),jt=this.locationCoordinate(mt),Vt=this.locationCoordinate(Ht),Xt=this.locationCoordinate(gn),kn=Math.hypot(Vt.x-jt.x,Vt.y-jt.y),en=Math.hypot(Xt.x-jt.x,Xt.y-jt.y);return Math.sqrt(kn*en)*Ce/25e-6},Ae=Ue=>{const Le=ae,Ze=pe;return{aabb:s.tileAABB(this,M,0,0,0,Ue,Ze,Le,this.projection),zoom:0,x:0,y:0,minZ:Ze,maxZ:Le,wrap:Ue,fullyVisible:!1}},Be=[];let Ne=[];const Ge=u,wt=r.reparseOverscaled?g:u,Fe=Ue=>Ue*Ue,rt=Fe((ee-this._centerAltitude)*J),Xe=Ue=>{if(!this._elevation||!Ue.tileID||!b)return;const Le=this._elevation.getMinMaxForTile(Ue.tileID),Ze=Ue.aabb;Le?(Ze.min[2]=Le.min,Ze.max[2]=Le.max,Ze.center[2]=(Ze.min[2]+Ze.max[2])/2):(Ue.shouldSplit=ht(Ue),Ue.shouldSplit||(Ze.min[2]=Ze.max[2]=Ze.center[2]=this._centerAltitude))},ht=Ue=>{if(Ue.zoom<ue)return!0;if(Ue.zoom===Ge)return!1;if(Ue.shouldSplit!=null)return Ue.shouldSplit;const Le=Ue.aabb.distanceX(te),Ze=Ue.aabb.distanceY(te);let lt=rt,mt=1;if(O){lt=Fe(Ue.aabb.distanceZ(te));const jt=Math.pow(2,Ue.zoom),Vt=s.latFromMercatorY((Ue.y+1)/jt),Xt=s.latFromMercatorY(Ue.y/jt),kn=Math.min(Math.max(I,Vt),Xt),en=s.circumferenceAtLatitude(kn)/s.circumferenceAtLatitude(I);if(mt=kn===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,en/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&Ue.zoom===Ge-1&&en>=.9)return!0}else if(y&&(lt=Fe(Ue.aabb.distanceZ(te)*J)),this.projection.isReprojectedInTileSpace&&g<=5){const jt=Math.pow(2,Ue.zoom),Vt=we(new s.MercatorCoordinate((Ue.x+.5)/jt,(Ue.y+.5)/jt));mt=Vt>.85?1:Vt}const Ht=Le*Le+Ze*Ze+lt,gn=Fe((1<<Ge-Ue.zoom)*W*mt*((jt,Vt)=>{if(Vt*Fe(.707)<jt)return 1;const Xt=Math.sqrt(Vt/jt);return Xt/(1.4144271570014144+(Math.pow(1.1,Xt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(lt,rt),Ht));return Ht<gn};if(this.renderWorldCopies)for(let Ue=1;Ue<=3;Ue++)Be.push(Ae(-Ue)),Be.push(Ae(Ue));for(Be.push(Ae(0));Be.length>0;){const Ue=Be.pop(),Le=Ue.x,Ze=Ue.y;let lt=Ue.fullyVisible;if(!lt){const mt=Ue.aabb.intersects(H);if(mt===0)continue;lt=mt===2}if(Ue.zoom!==Ge&&ht(Ue))for(let mt=0;mt<4;mt++){const Ht=(Le<<1)+mt%2,gn=(Ze<<1)+(mt>>1),jt={aabb:b?Ue.aabb.quadrant(mt):s.tileAABB(this,M,Ue.zoom+1,Ht,gn,Ue.wrap,Ue.minZ,Ue.maxZ,this.projection),zoom:Ue.zoom+1,x:Ht,y:gn,wrap:Ue.wrap,fullyVisible:lt,tileID:void 0,shouldSplit:void 0,minZ:Ue.minZ,maxZ:Ue.maxZ};y&&!O&&(jt.tileID=new s.OverscaledTileID(Ue.zoom+1===Ge?wt:Ue.zoom+1,Ue.wrap,Ue.zoom+1,Ht,gn),Xe(jt)),Be.push(jt)}else{const mt=Ue.zoom===Ge?wt:Ue.zoom;if(r.minzoom&&r.minzoom>mt)continue;const Ht=B[0]-(.5+Le+(Ue.wrap<<Ue.zoom))*(1<<u-Ue.zoom),gn=B[1]-.5-Ze,jt=Ue.tileID?Ue.tileID:new s.OverscaledTileID(mt,Ue.wrap,Ue.zoom,Le,Ze);Ne.push({tileID:jt,distanceSq:Ht*Ht+gn*gn})}}if(this.fogCullDistSq){const Ue=this.fogCullDistSq,Le=this.horizonLineFromTop();Ne=Ne.filter(Ze=>{const lt=[0,0,0,1],mt=[s.EXTENT,s.EXTENT,0,1],Ht=this.calculateFogTileMatrix(Ze.tileID.toUnwrapped());s.transformMat4$1(lt,lt,Ht),s.transformMat4$1(mt,mt,Ht);const gn=s.getAABBPointSquareDist(lt,mt);if(gn===0)return!0;let jt=!1;const Vt=this._elevation;if(Vt&&gn>Ue&&Le!==0){const Xt=this.calculateProjMatrix(Ze.tileID.toUnwrapped());let kn;r.isTerrainDEM||(kn=Vt.getMinMaxForTile(Ze.tileID)),kn||(kn={min:pe,max:ae});const en=s.furthestTileCorner(this.rotation),Hn=[en[0]*s.EXTENT,en[1]*s.EXTENT,kn.max];s.transformMat4(Hn,Hn,Xt),jt=(1-Hn[1])*this.height*.5<Le}return gn<Ue||jt})}return Ne.sort((Ue,Le)=>Ue.distanceSq-Le.distanceSq).map(Ue=>Ue.tileID)}resize(r,u){this.width=r,this.height=u,this.pixelsToGLUnits=[2/r,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const u=s.clamp(r.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),g=this.projection.project(r.lng,u);return new s.pointGeometry(g.x*this.worldSize,g.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,u){let g,y;const b=this.centerPoint;if(this.projection.name==="globe"){const I=this.worldSize;g=(u.x-b.x)/I,y=(u.y-b.y)/I}else{const I=this.pointCoordinate(u),M=this.pointCoordinate(b);g=I.x-M.x,y=I.y-M.y}const C=this.locationCoordinate(r);this.setLocation(new s.MercatorCoordinate(C.x-g,C.y-y))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,u){const g=u?s.mercatorZfromAltitude(u,r.lat):void 0,y=this.projection.project(r.lng,r.lat);return new s.MercatorCoordinate(y.x,y.y,g)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,u){const g=u!=null?u:this._centerAltitude,y=[r.x,r.y,0,1],b=[r.x,r.y,1,1];s.transformMat4$1(y,y,this.pixelMatrixInverse),s.transformMat4$1(b,b,this.pixelMatrixInverse);const C=b[3];s.scale$1(y,y,1/y[3]),s.scale$1(b,b,1/C);const I=y[2],M=b[2];return{p0:y,p1:b,t:I===M?0:(g-I)/(M-I)}}screenPointToMercatorRay(r){const u=[r.x,r.y,0,1],g=[r.x,r.y,1,1];return s.transformMat4$1(u,u,this.pixelMatrixInverse),s.transformMat4$1(g,g,this.pixelMatrixInverse),s.scale$1(u,u,1/u[3]),s.scale$1(g,g,1/g[3]),u[2]=s.mercatorZfromAltitude(u[2],this._center.lat)*this.worldSize,g[2]=s.mercatorZfromAltitude(g[2],this._center.lat)*this.worldSize,s.scale$1(u,u,1/this.worldSize),s.scale$1(g,g,1/this.worldSize),new s.Ray([u[0],u[1],u[2]],s.normalize([],s.sub([],g,u)))}rayIntersectionCoordinate(r){const{p0:u,p1:g,t:y}=r,b=s.mercatorZfromAltitude(u[2],this._center.lat),C=s.mercatorZfromAltitude(g[2],this._center.lat);return new s.MercatorCoordinate(s.number(u[0],g[0],y)/this.worldSize,s.number(u[1],g[1],y)/this.worldSize,s.number(b,C,y))}pointCoordinate(r,u=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,u)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let u=this.projection.pointCoordinate3D(this,r.x,r.y);if(u)return new s.MercatorCoordinate(u[0],u[1],u[2]);let g=0,y=this.horizonLineFromTop();if(r.y>y)return this.pointCoordinate(r);const b=.02*y,C=r.clone();for(let I=0;I<10&&y-g>b;I++){C.y=s.number(g,y,.66);const M=this.projection.pointCoordinate3D(this,C.x,C.y);M?(y=C.y,u=M):g=C.y}return u?new s.MercatorCoordinate(u[0],u[1],u[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}_coordinatePoint(r,u){const g=u&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,y=[r.x*this.worldSize,r.y*this.worldSize,g+r.toAltitude(),1];return s.transformMat4$1(y,y,this.pixelMatrix),y[3]>0?new s.pointGeometry(y[0]/y[3],y[1]/y[3]):new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:u}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,y=this.width-this._edgeInsets.right,b=this.pointLocation3D(new s.pointGeometry(u,r)),C=this.pointLocation3D(new s.pointGeometry(y,r)),I=this.pointLocation3D(new s.pointGeometry(y,g)),M=this.pointLocation3D(new s.pointGeometry(u,g));let B=Math.min(b.lng,C.lng,I.lng,M.lng),O=Math.max(b.lng,C.lng,I.lng,M.lng),j=Math.min(b.lat,C.lat,I.lat,M.lat),H=Math.max(b.lat,C.lat,I.lat,M.lat);const Q=Math.pow(2,-this.zoom)/16*270,J=this.projection.name==="globe"?1:4,ee=(te,W,ue,ae,pe)=>{const Ce=(te+ue)/2,we=(W+ae)/2,Ae=new s.pointGeometry(Ce,we),{lng:Be,lat:Ne}=this.pointLocation3D(Ae),Ge=Math.max(0,B-Be,j-Ne,Be-O,Ne-H);B=Math.min(B,Be),O=Math.max(O,Be),j=Math.min(j,Ne),H=Math.max(H,Ne),(pe<J||Ge>Q)&&(ee(te,W,Ce,we,pe+1),ee(Ce,we,ue,ae,pe+1))};if(ee(u,r,y,r,1),ee(y,r,y,g,1),ee(y,g,u,g,1),ee(u,g,u,r,1),this.projection.name==="globe"){const[te,W]=s.polesInViewport(this);te?(H=90,O=180,B=-180):W&&(j=-90,O=180,B=-180)}return new s.LngLatBounds(new s.LngLat(B,j),new s.LngLat(O,H))}_getBoundsRectangular(r,u){const{top:g,left:y}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,I=new s.pointGeometry(y,g),M=new s.pointGeometry(C,g),B=new s.pointGeometry(C,b),O=new s.pointGeometry(y,b);let j=this.pointCoordinate(I,r),H=this.pointCoordinate(M,r);const Q=this.pointCoordinate(B,u),J=this.pointCoordinate(O,u),ee=(te,W)=>(W.y-te.y)/(W.x-te.x);return j.y>1&&H.y>=0?j=new s.MercatorCoordinate((1-J.y)/ee(J,j)+J.x,1):j.y<0&&H.y<=1&&(j=new s.MercatorCoordinate(-J.y/ee(J,j)+J.x,0)),H.y>1&&j.y>=0?H=new s.MercatorCoordinate((1-Q.y)/ee(Q,H)+Q.x,1):H.y<0&&j.y<=1&&(H=new s.MercatorCoordinate(-Q.y/ee(Q,H)+Q.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(j)).extend(this.coordinateLocation(H)).extend(this.coordinateLocation(J)).extend(this.coordinateLocation(Q))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=r.visibleDemTiles.reduce((g,y)=>{if(y.dem){const b=y.dem.tree;g.min=Math.min(g.min,b.minimums[0]),g.max=Math.max(g.max,b.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*r.exaggeration(),u.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,g=this.height/2-u*(1-this._horizonShift);return r?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,u){return this.projection.createTileMatrix(this,u,r)}calculateDistanceTileData(r){const u=r.key,g=this._distanceTileDataCache;if(g[u])return g[u];const y=r.canonical,b=1/this.height,C=this.cameraWorldSize,I=C/this.zoomScale(y.z),M=(y.x+Math.pow(2,y.z)*r.wrap)*I,B=y.y*I,O=this.point;O.x*=C/this.worldSize,O.y*=C/this.worldSize;const j=this.angle,H=Math.sin(-j),Q=-Math.cos(-j);return g[u]={bearing:[H,Q],center:[(O.x-M)*b,(O.y-B)*b],scale:I/s.EXTENT*b},g[u]}calculateFogTileMatrix(r){const u=r.key,g=this._fogTileMatrixCache;if(g[u])return g[u];const y=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return s.multiply(y,this.worldToFogMatrix,y),g[u]=new Float32Array(y),g[u]}calculateProjMatrix(r,u=!1){const g=r.key,y=u?this._alignedProjMatrixCache:this._projMatrixCache;if(y[g])return y[g];const b=this.calculatePosMatrix(r,this.worldSize);return s.multiply(b,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:u?this.alignedProjMatrix:this.projMatrix,b),y[g]=new Float32Array(b),y[g]}calculatePixelsToTileUnitsMatrix(r){const u=r.tileID.key,g=this._pixelsToTileUnitsCache;if(g[u])return g[u];const y=function(b,C){const{scale:I}=b.tileTransform,M=I*s.EXTENT/(b.tileSize*Math.pow(2,C.zoom-b.tileID.overscaledZ+b.tileID.canonical.z));return B=new Float32Array(4),H=(O=C.inverseAdjustmentMatrix)[1],Q=O[2],J=O[3],te=(j=[M,M])[1],B[0]=O[0]*(ee=j[0]),B[1]=H*ee,B[2]=Q*te,B[3]=J*te,B;var B,O,j,H,Q,J,ee,te}(r,this);return g[u]=y,g[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,u=s.fromScaling([],[r,r,r]);return s.multiply(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const u=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(u),y=this._camera.forward(),b=s.mercatorZfromAltitude(1,this._center.lat);g[2]/=b,y[2]/=b,s.normalize(y,y);const C=r.raycast(g,y,r.exaggeration());if(C){const I=s.scaleAndAdd([],g,y,C),M=new s.MercatorCoordinate(I[0],I[1],s.mercatorZfromAltitude(I[2],s.latFromMercatorY(I[1]))),B=(M.z+s.length([M.x-g[0],M.y-g[1],M.z-g[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(B),this._centerAltitude=M.toAltitude(),this._center=this.coordinateLocation(M),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const u=this._elevation,g=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(g),b=u.getAtPointOrZero(new s.MercatorCoordinate(...y)),C=this.pixelsPerMeter/this.worldSize*b,I=this._minimumHeightOverTerrain(),M=y[2]-C;if(M<=I)if(M<0||r){const B=this.locationCoordinate(this._center,this._centerAltitude),O=[y[0],y[1],B.z-y[2]],j=s.length(O);O[2]-=(I-M)/this._pixelsPerMercatorPixel;const H=s.length(O);if(H===0)return;s.scale$2(O,O,j/H*this._pixelsPerMercatorPixel),this._camera.position=[y[0],y[1],B.z*this._pixelsPerMercatorPixel-O[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const H=this.center;return H.lat=s.clamp(H.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(H.lng=s.clamp(H.lng,this.minLng,this.maxLng)),this.center=H,void(this._constraining=!1)}const u=this._unmodified,{x:g,y}=this.point;let b=0,C=g,I=y;const M=this.width/2,B=this.height/2,O=this.worldMinY*this.scale,j=this.worldMaxY*this.scale;if(y-B<O&&(I=O+B),y+B>j&&(I=j-B),j-O<this.height&&(b=Math.max(b,this.height/(j-O)),I=(j+O)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const H=this.worldMinX*this.scale,Q=this.worldMaxX*this.scale,J=this.worldSize/2-(H+Q)/2;C=(g+J+this.worldSize)%this.worldSize-J,C-M<H&&(C=H+M),C+M>Q&&(C=Q-M),Q-H<this.width&&(b=Math.max(b,this.width/(Q-H)),C=(Q+H)/2)}C===g&&I===y||(this.center=this.unproject(new s.pointGeometry(C,I))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,u=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const g=ta(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,g),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const y=this.projection.zAxisUnit==="meters"?u:1,b=this._camera.getWorldToCamera(this.worldSize,y),C=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);C[8]=2*-r.x/this.width,C[9]=2*r.y/this.height;let I=s.mul([],C,b);if(this.projection.isReprojectedInTileSpace){const we=this.locationCoordinate(this.center),Ae=s.identity([]);s.translate(Ae,Ae,[we.x*this.worldSize,we.y*this.worldSize,0]),s.multiply(Ae,Ae,Ua(this)),s.translate(Ae,Ae,[-we.x*this.worldSize,-we.y*this.worldSize,0]),s.multiply(I,I,Ae),this.inverseAdjustmentMatrix=function(Be){const Ne=Ua(Be,!0);return Ee([],[Ne[0],Ne[1],Ne[4],Ne[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],I,[this.worldSize,this.worldSize,this.worldSize/y,1]),this.projMatrix=I,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const M=s.invert([],C);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(M,this.horizonLineFromTop(),this.height);const B=new Float32Array(16);s.identity(B),s.scale(B,B,[1,-1,1]),s.rotateX(B,B,this._pitch),s.rotateZ(B,B,this.angle);const O=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),j=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;O[8]=2*-r.x/this.width,O[9]=2*(r.y+j)/this.height,this.skyboxMatrix=s.multiply(B,O,B);const H=this.point,Q=H.x,J=H.y,ee=this.width%2/2,te=this.height%2/2,W=Math.cos(this.angle),ue=Math.sin(this.angle),ae=Q-Math.round(Q)+W*ee+ue*te,pe=J-Math.round(J)+W*te+ue*ee,Ce=new Float64Array(I);if(s.translate(Ce,Ce,[ae>.5?ae-1:ae,pe>.5?pe-1:pe,0]),this.alignedProjMatrix=Ce,I=s.create(),s.scale(I,I,[this.width/2,-this.height/2,1]),s.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=s.create(),s.scale(I,I,[1,-1,1]),s.translate(I,I,[-1,-1,0]),s.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=s.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=I,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const we=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(we,we,b),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=I;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,g=this._camera.position,y=1/this.height/this._pixelsPerMercatorPixel,b=[r,r,u];s.scale$2(b,b,y),s.scale$2(g,g,-1),s.multiply$2(g,g,b);const C=s.create();s.translate(C,C,g),s.scale(C,C,b),this.mercatorFogMatrix=C,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,u,y)}_computeCameraPosition(r){const u=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),y=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-r/this.worldSize*this._centerAltitude;return[y.x/this.worldSize-g[0]*b,y.y/this.worldSize-g[1]*b,r/this.worldSize*this._centerAltitude-g[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],y=r[2];let b=1;this.projection.wrap&&(this.center=this.center.wrap()),y>0&&(b=Math.min((u-g)/y,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,r,b),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,u=this._camera.forward(),{pitch:g,bearing:y}=this._camera.getPitchBearing(),b=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,C=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),I=Math.max((r[2]-b)/Math.cos(g),C),M=this._zoomFromMercatorZ(I);s.scaleAndAdd(r,r,u,I),this._pitch=s.clamp(g,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(y,-Math.PI,Math.PI),this._setZoom(s.clamp(M,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let u=0,g=s.GLOBE_ZOOM_THRESHOLD_MAX,y=0,b=1/0;for(;g-u>1e-6&&g>u;){const C=u+.5*(g-u),I=this.tileSize*Math.pow(2,C),M=this.getCameraToCenterDistance(this.projection,C,I),B=this.scaleZoom(M/(r*this.tileSize)),O=Math.abs(C-B);O<b&&(b=O,y=C),C<B?u=C:g=C}return y}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,u){const g=Math.min(r.x,u.x),y=Math.max(r.x,u.x),b=Math.min(r.y,u.y),C=Math.max(r.y,u.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const I=[new s.pointGeometry(g,b),new s.pointGeometry(y,C),new s.pointGeometry(g,C),new s.pointGeometry(y,b)],M=this.renderWorldCopies?-3:0,B=this.renderWorldCopies?4:1;for(const O of I){const j=this.pointRayIntersection(O);if(j.t<0)return!0;const H=this.rayIntersectionCoordinate(j);if(H.x<M||H.y<0||H.x>B||H.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.pointGeometry(0,0),new s.pointGeometry(this.width,this.height))}zoomDeltaToMovement(r,u){const g=s.length(s.sub([],this._camera.position,r)),y=this._zoomFromMercatorZ(g)+u;return g-this._mercatorZfromZoom(y)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([u,g,y],b){const C=[u,g,y,1];s.transformMat4$1(C,C,b);const I=C[3]=Math.max(C[3],1e-6);return C[0]/=I,C[1]/=I,C[2]/=I,C}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.pointGeometry(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.pointGeometry(0,r))}}getCameraToCenterDistance(r,u=this.zoom,g=this.worldSize){const y=ta(r,u,this.width,this.height,1024),b=r.pixelSpaceConversion(this.center.lat,g,y);return .5/Math.tan(.5*this._fov)*this.height*b}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(r,r,this.globeMatrix),r}}function Kr(f,r){let u=!1,g=null;const y=()=>{g=null,u&&(f(),g=setTimeout(y,r),u=!1)};return()=>(u=!0,g||y(),g)}class Mp{constructor(r){this._hashName=r&&encodeURIComponent(r),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Kr(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,s.window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const u=ad(r);if(this._hashName){const g=this._hashName;let y=!1;const b=s.window.location.hash.slice(1).split("&").map(C=>{const I=C.split("=")[0];return I===g?(y=!0,`${I}=${u}`):C}).filter(C=>C);return y||b.push(`${g}=${u}`),`#${b.join("&")}`}return`#${u}`}_getCurrentHash(){const r=s.window.location.hash.replace("#","");if(this._hashName){let u;return r.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(u=g)}),(u&&u[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(g=>isNaN(g))){const g=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(u[3]||0):r.getBearing();return r.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:g,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,r)}}function ad(f,r){const u=f.getCenter(),g=Math.round(100*f.getZoom())/100,y=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,y),C=Math.round(u.lng*b)/b,I=Math.round(u.lat*b)/b,M=f.getBearing(),B=f.getPitch();let O=r?`/${C}/${I}/${g}`:`${g}/${I}/${C}`;return(M||B)&&(O+="/"+Math.round(10*M)/10),B&&(O+=`/${Math.round(B)}`),O}const ql={linearity:.3,easing:s.bezier(0,0,.3,1)},ja=s.extend({deceleration:2500,maxSpeed:1400},ql),Pp=s.extend({deceleration:20,maxSpeed:1400},ql),_u=s.extend({deceleration:1e3,maxSpeed:360},ql),ld=s.extend({deceleration:1e3,maxSpeed:90},ql);class yu{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,u=s.exported.now();for(;r.length>0&&u-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new s.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)u.zoom+=b.zoomDelta||0,u.bearing+=b.bearingDelta||0,u.pitch+=b.pitchDelta||0,b.panDelta&&u.pan._add(b.panDelta),b.around&&(u.around=b.around),b.pinchAround&&(u.pinchAround=b.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(u.pan.mag()){const b=Wl(u.pan.mag(),g,s.extend({},ja,r||{}));y.offset=u.pan.mult(b.amount/u.pan.mag()),y.center=this._map.transform.center,Zl(y,b)}if(u.zoom){const b=Wl(u.zoom,g,Pp);y.zoom=this._map.transform.zoom+b.amount,Zl(y,b)}if(u.bearing){const b=Wl(u.bearing,g,_u);y.bearing=this._map.transform.bearing+s.clamp(b.amount,-179,179),Zl(y,b)}if(u.pitch){const b=Wl(u.pitch,g,ld);y.pitch=this._map.transform.pitch+b.amount,Zl(y,b)}if(y.zoom||y.bearing){const b=u.pinchAround===void 0?u.around:u.pinchAround;y.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),y.noMoveStart=!0,y}}function Zl(f,r){(!f.duration||f.duration<r.duration)&&(f.duration=r.duration,f.easing=r.easing)}function Wl(f,r,u){const{maxSpeed:g,linearity:y,deceleration:b}=u,C=s.clamp(f*y/(r/1e3),-g,g),I=Math.abs(C)/(b*y);return{easing:u.easing,duration:1e3*I,amount:C*(I/2)}}class sr extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,g,y={}){const b=Y(u.getCanvasContainer(),g),C=u.unproject(b);super(r,s.extend({point:b,lngLat:C,originalEvent:g},y)),this._defaultPrevented=!1,this.target=u}}class xu extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,g){const y=r==="touchend"?g.changedTouches:g.touches,b=_e(u.getCanvasContainer(),y),C=b.map(M=>u.unproject(M)),I=b.reduce((M,B,O,j)=>M.add(B.div(j.length)),new s.pointGeometry(0,0));super(r,{points:b,point:I,lngLats:C,lngLat:u.unproject(I),originalEvent:g}),this._defaultPrevented=!1}}class fv extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,g){super(r,{originalEvent:g}),this._defaultPrevented=!1}}class zp{constructor(r,u){this._map=r,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new fv(r.type,this._map,r))}mousedown(r,u){return this._mousedownPos=u,this._firePreventable(new sr(r.type,this._map,r))}mouseup(r){this._map.fire(new sr(r.type,this._map,r))}preclick(r){const u=s.extend({},r);u.type="preclick",this._map.fire(new sr(u.type,this._map,u))}click(r,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(r),this._map.fire(new sr(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new sr(r.type,this._map,r))}mouseover(r){this._map.fire(new sr(r.type,this._map,r))}mouseout(r){this._map.fire(new sr(r.type,this._map,r))}touchstart(r){return this._firePreventable(new xu(r.type,this._map,r))}touchmove(r){this._map.fire(new xu(r.type,this._map,r))}touchend(r){this._map.fire(new xu(r.type,this._map,r))}touchcancel(r){this._map.fire(new xu(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bu{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new sr(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new sr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new sr(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class cd{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,u){this.isEnabled()&&r.shiftKey&&r.button===0&&(ne(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(r,u){if(!this._active)return;const g=u,y=this._startPos,b=this._lastPos;if(!y||!b||b.equals(g)||!this._box&&g.dist(y)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=L("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const C=Math.min(y.x,g.x),I=Math.max(y.x,g.x),M=Math.min(y.y,g.y),B=Math.max(y.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${C}px,${M}px)`,this._box.style.width=I-C+"px",this._box.style.height=B-M+"px")})}mouseupWindow(r,u){if(!this._active)return;const g=this._startPos,y=u;if(g&&r.button===0){if(this.reset(),Se(),g.x!==y.x||g.y!==y.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:b=>b.fitScreenCoordinates(g,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ce(),delete this._startPos,delete this._lastPos}_fireEvent(r,u){return this._map.fire(new s.Event(r,{originalEvent:u}))}}function wu(f,r){const u={};for(let g=0;g<f.length;g++)u[f[g].identifier]=r[g];return u}class Lp{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,u,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),g.length===this.numTouches&&(this.centroid=function(y){const b=new s.pointGeometry(0,0);for(const C of y)b._add(C);return b.div(y.length)}(u),this.touches=wu(g,u)))}touchmove(r,u,g){if(this.aborted||!this.centroid)return;const y=wu(g,u);for(const b in this.touches){const C=this.touches[b],I=y[b];(!I||I.dist(C)>30)&&(this.aborted=!0)}}touchend(r,u,g){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class Ga{constructor(r){this.singleTap=new Lp(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,u,g){this.singleTap.touchstart(r,u,g)}touchmove(r,u,g){this.singleTap.touchmove(r,u,g)}touchend(r,u,g){const y=this.singleTap.touchend(r,u,g);if(y){const b=r.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(y)<30;if(b&&C||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class ud{constructor(){this._zoomIn=new Ga({numTouches:1,numTaps:2}),this._zoomOut=new Ga({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,u,g){this._zoomIn.touchstart(r,u,g),this._zoomOut.touchstart(r,u,g)}touchmove(r,u,g){this._zoomIn.touchmove(r,u,g),this._zoomOut.touchmove(r,u,g)}touchend(r,u,g){const y=this._zoomIn.touchend(r,u,g),b=this._zoomOut.touchend(r,u,g);return y?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()+1,around:C.unproject(y)},{originalEvent:r})}):b?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()-1,around:C.unproject(b)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Rp={0:1,2:2};class Su{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,u){return!1}_move(r,u){return{}}mousedown(r,u){if(this._lastPoint)return;const g=fe(r);this._correctButton(r,g)&&(this._lastPoint=u,this._eventButton=g)}mousemoveWindow(r,u){const g=this._lastPoint;if(g){if(r.preventDefault(),this._eventButton!=null&&function(y,b){const C=Rp[b];return y.buttons===void 0||(y.buttons&C)!==C}(r,this._eventButton))this.reset();else if(this._moved||!(u.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(g,u)}}mouseupWindow(r){this._lastPoint&&fe(r)===this._eventButton&&(this._moved&&Se(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dp extends Su{mousedown(r,u){super.mousedown(r,u),this._lastPoint&&(this._active=!0)}_correctButton(r,u){return u===0&&!r.ctrlKey}_move(r,u){return{around:u,panDelta:u.sub(r)}}}class hd extends Su{_correctButton(r,u){return u===0&&r.ctrlKey||u===2}_move(r,u){const g=.8*(u.x-r.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(r){r.preventDefault()}}class dd extends Su{_correctButton(r,u){return u===0&&r.ctrlKey||u===2}_move(r,u){const g=-.5*(u.y-r.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(r){r.preventDefault()}}class qa{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.pointGeometry(0,0)}touchstart(r,u,g){return this._calculateTransform(r,u,g)}touchmove(r,u,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,u,g)}}touchend(r,u,g){this._calculateTransform(r,u,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,u,g){g.length>0&&(this._active=!0);const y=wu(g,u),b=new s.pointGeometry(0,0),C=new s.pointGeometry(0,0);let I=0;for(const B in y){const O=y[B],j=this._touches[B];j&&(b._add(O),C._add(O.sub(j)),I++,y[B]=O)}if(this._touches=y,I<this._minTouches||!C.mag())return;const M=C.div(I);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(I),panDelta:M}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Eu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,u,g){return{}}touchstart(r,u,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([u[0],u[1]]))}touchmove(r,u,g){const y=this._firstTwoTouches;if(!y)return;r.preventDefault();const[b,C]=y,I=Hl(g,u,b),M=Hl(g,u,C);if(!I||!M)return;const B=this._aroundCenter?null:I.add(M).div(2);return this._move([I,M],B,r)}touchend(r,u,g){if(!this._firstTwoTouches)return;const[y,b]=this._firstTwoTouches,C=Hl(g,u,y),I=Hl(g,u,b);C&&I||(this._active&&Se(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Hl(f,r,u){for(let g=0;g<f.length;g++)if(f[g].identifier===u)return r[g]}function Bp(f,r){return Math.log(f/r)/Math.LN2}class Op extends Eu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,u){const g=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Bp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Bp(this._distance,g),pinchAround:u}}}function fd(f,r){return 180*f.angleWith(r)/Math.PI}class Fp extends Eu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,u){const g=this._vector;if(this._vector=r[0].sub(r[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:fd(this._vector,g),pinchAround:u}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const u=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const y=fd(r,g);return Math.abs(y)<u}}function Tu(f){return Math.abs(f.y)>Math.abs(f.x)}class _r extends Eu{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,Tu(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,u,g){const y=this._lastPoints;if(!y)return;const b=r[0].sub(y[0]),C=r[1].sub(y[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(b,C,g.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(b.y+C.y)/2*-.5})}gestureBeginsVertically(r,u,g){if(this._valid!==void 0)return this._valid;const y=r.mag()>=2,b=u.mag()>=2;if(!y&&!b)return;if(!y||!b)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const C=r.y>0==u.y>0;return Tu(r)&&Tu(u)&&C}}const pv={panStep:100,bearingStep:15,pitchStep:10};class Vp{constructor(){const r=pv;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let u=0,g=0,y=0,b=0,C=0;switch(r.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:r.shiftKey?g=-1:(r.preventDefault(),b=-1);break;case 39:r.shiftKey?g=1:(r.preventDefault(),b=1);break;case 38:r.shiftKey?y=1:(r.preventDefault(),C=-1);break;case 40:r.shiftKey?y=-1:(r.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(g=0,y=0),{cameraAnimation:I=>{const M=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:mv,zoom:u?Math.round(M)+u*(r.shiftKey?2:1):M,bearing:I.getBearing()+g*this._bearingStep,pitch:I.getPitch()+y*this._pitchStep,offset:[-b*this._panStep,-C*this._panStep],center:I.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function mv(f){return f*(2-f)}const $p=4.000244140625;class Ho{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=r.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const g=s.exported.now(),y=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,u!==0&&u%$p==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(y*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),r.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=r,this._delta-=u,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=Y(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const M=this._type==="wheel"&&Math.abs(this._delta)>$p?this._wheelZoomRate:this._defaultZoomRate;let B=2/(1+Math.exp(-Math.abs(this._delta*M)));this._delta<0&&B!==0&&(B=1/B);const O=u(),j=Math.pow(2,O),H=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):j;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(H*B))),this._type==="wheel"&&(this._startZoom=O,this._easing=this._smoothOutEasing(200)),this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:u(),y=this._startZoom,b=this._easing;let C,I=!1;if(this._type==="wheel"&&y&&b){const M=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),B=b(M);C=s.number(y,g,B),M<1?this._frameId||(this._frameId=!0):I=!0}else C=g,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:C-u(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let u=s.ease;if(this._prevEase){const g=this._prevEase,y=(s.exported.now()-g.start)/g.duration,b=g.easing(y+.01)-g.easing(y),C=.27/Math.sqrt(b*b+1e-4)*.01,I=Math.sqrt(.0729-C*C);u=s.bezier(C,I,.25,1)}return this._prevEase={start:s.exported.now(),duration:r,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Np{constructor(r,u){this._clickZoom=r,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Za{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,u){return r.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(r.shiftKey?-1:1),around:g.unproject(u)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class So{constructor(){this._tap=new Ga({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,u,g){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=u[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(r,u,g))}touchmove(r,u,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const y=u[0],b=y.y-this._swipePoint.y;return this._swipePoint=y,r.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(r,u,g)}touchend(r,u,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(r,u,g)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cu{constructor(r,u,g){this._el=r,this._mousePan=u,this._touchPan=g}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Nt{constructor(r,u,g){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=u,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Up{constructor(r,u,g,y){this._el=r,this._touchZoom=u,this._touchRotate=g,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Xl=f=>f.zoom||f.drag||f.pitch||f.rotate;class Yl extends s.Event{}class Kl{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,u){const g=s.sub([],u,r);this.radius=s.length(g[2]<0?s.div([],g,this.constants):[g[0],g[1],0])}projectRay(r){s.div(r,r,this.constants),s.normalize(r,r),s.mul$1(r,r,this.constants);const u=s.scale$2([],r,this.radius);if(u[2]>0){const g=s.scale$2([],[0,0,1],s.dot(u,[0,0,1])),y=s.scale$2([],s.normalize([],[u[0],u[1],0]),this.radius),b=s.add([],u,s.scale$2([],s.sub([],s.add([],y,g),u),2));u[0]=b[0],u[1]=b[1]}return u}}function Jl(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class jp{constructor(r,u){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new yu(r),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Kl,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),s.bindAll(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[y,b,C]of this._listeners)y.addEventListener(b,y===s.window.document?this.handleWindowEvent:this.handleEvent,C)}destroy(){for(const[r,u,g]of this._listeners)r.removeEventListener(u,r===s.window.document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(r){const u=this._map,g=u.getCanvasContainer();this._add("mapEvent",new zp(u,r));const y=u.boxZoom=new cd(u,r);this._add("boxZoom",y);const b=new ud,C=new Za;u.doubleClickZoom=new Np(C,b),this._add("tapZoom",b),this._add("clickZoom",C);const I=new So;this._add("tapDragZoom",I);const M=u.touchPitch=new _r(u);this._add("touchPitch",M);const B=new hd(r),O=new dd(r);u.dragRotate=new Nt(r,B,O),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);const j=new Dp(r),H=new qa(u,r);u.dragPan=new Cu(g,j,H),this._add("mousePan",j),this._add("touchPan",H,["touchZoom","touchRotate"]);const Q=new Fp,J=new Op;u.touchZoomRotate=new Up(g,J,Q,I),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",J,["touchPan","touchRotate"]),this._add("blockableMapEvent",new bu(u));const ee=u.scrollZoom=new Ho(u,this);this._add("scrollZoom",ee,["mousePan"]);const te=u.keyboard=new Vp;this._add("keyboard",te);for(const W of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[W]&&u[W].enable(r[W])}_add(r,u,g){this._handlers.push({handlerName:r,handler:u,allowed:g}),this._handlersById[r]=u}stop(r){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Xl(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,u,g){for(const y in r)if(y!==g&&(!u||u.indexOf(y)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const u=[];for(const g of r)this._el.contains(g.target)&&u.push(g);return u}handleEvent(r,u){this._updatingCamera=!0;const g=r.type==="renderFrame",y=g?void 0:r,b={needsRenderFrame:!1},C={},I={},M=r.touches?this._getMapTouches(r.touches):void 0,B=M?_e(this._el,M):g?void 0:Y(this._el,r);for(const{handlerName:H,handler:Q,allowed:J}of this._handlers){if(!Q.isEnabled())continue;let ee;this._blockedByActive(I,J,H)?Q.reset():Q[u||r.type]&&(ee=Q[u||r.type](r,B,M),this.mergeHandlerResult(b,C,ee,H,y),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()),(ee||Q.isActive())&&(I[H]=Q)}const O={};for(const H in this._previousActiveHandlers)I[H]||(O[H]=y);this._previousActiveHandlers=I,(Object.keys(O).length||Jl(b))&&(this._changes.push([b,C,O]),this._triggerRenderFrame()),(Object.keys(I).length||Jl(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:j}=b;j&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],j(this._map))}mergeHandlerResult(r,u,g,y,b){if(!g)return;s.extend(r,g);const C={handlerName:y,originalEvent:g.originalEvent||b};g.zoomDelta!==void 0&&(u.zoom=C),g.panDelta!==void 0&&(u.drag=C),g.pitchDelta!==void 0&&(u.pitch=C),g.bearingDelta!==void 0&&(u.rotate=C)}_applyChanges(){const r={},u={},g={};for(const[y,b,C]of this._changes)y.panDelta&&(r.panDelta=(r.panDelta||new s.pointGeometry(0,0))._add(y.panDelta)),y.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(r.around=y.around),y.aroundCoord!==void 0&&(r.aroundCoord=y.aroundCoord),y.pinchAround!==void 0&&(r.pinchAround=y.pinchAround),y.noInertia&&(r.noInertia=y.noInertia),s.extend(u,b),s.extend(g,C);this._updateMapTransform(r,u,g),this._changes=[]}_updateMapTransform(r,u,g){const y=this._map,b=y.transform,C=ue=>[ue.x,ue.y,ue.z];if((ue=>{const ae=this._eventsInProgress.drag;return ae&&!this._handlersById[ae.handlerName].isActive()})()&&!Jl(r)){const ue=b.zoom;b.cameraElevationReference="sea",b.recenterOnTerrain(),b.cameraElevationReference="ground",ue!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&y._stop(!0),!Jl(r))return void this._fireEvents(u,g,!0);let{panDelta:I,zoomDelta:M,bearingDelta:B,pitchDelta:O,around:j,aroundCoord:H,pinchAround:Q}=r;b._isCameraConstrained&&(M>0&&(M=0),b._isCameraConstrained=!1),Q!==void 0&&(j=Q),(M||(ue=>u.drag&&!this._eventsInProgress.drag)())&&j&&(this._dragOrigin=C(b.pointCoordinate3D(j)),this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",y._stop(!0),j=j||y.transform.centerPoint,B&&(b.bearing+=B),O&&(b.pitch+=O),b._updateCameraState();const J=[0,0,0];if(I)if(b.projection.name==="mercator"){const ue=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(j).dir),ae=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(j.sub(I)).dir);J[0]=ae[0]-ue[0],J[1]=ae[1]-ue[1]}else{const ue=b.pointCoordinate(j);if(b.projection.name==="globe"){I=I.rotate(-b.angle);const ae=b._pixelsPerMercatorPixel/b.worldSize;J[0]=-I.x*s.mercatorScale(s.latFromMercatorY(ue.y))*ae,J[1]=-I.y*s.mercatorScale(b.center.lat)*ae}else{const ae=b.pointCoordinate(j.sub(I));ue&&ae&&(J[0]=ae.x-ue.x,J[1]=ae.y-ue.y)}}const ee=b.zoom,te=[0,0,0];if(M){const ue=C(H||b.pointCoordinate3D(j)),ae={dir:s.normalize([],s.sub([],ue,b._camera.position))};if(ae.dir[2]<0){const pe=b.zoomDeltaToMovement(ue,M);s.scale$2(te,ae.dir,pe)}}const W=s.add(J,J,te);b._translateCameraConstrained(W),M&&Math.abs(b.zoom-ee)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(u,g,!0)}_fireEvents(r,u,g){const y=Xl(this._eventsInProgress),b=Xl(r),C={};for(const O in r){const{originalEvent:j}=r[O];this._eventsInProgress[O]||(C[`${O}start`]=j),this._eventsInProgress[O]=r[O]}!y&&b&&this._fireEvent("movestart",b.originalEvent);for(const O in C)this._fireEvent(O,C[O]);b&&this._fireEvent("move",b.originalEvent);for(const O in r){const{originalEvent:j}=r[O];this._fireEvent(O,j)}const I={};let M;for(const O in this._eventsInProgress){const{handlerName:j,originalEvent:H}=this._eventsInProgress[O];this._handlersById[j].isActive()||(delete this._eventsInProgress[O],M=u[j]||H,I[`${O}end`]=M)}for(const O in I)this._fireEvent(O,I[O]);const B=Xl(this._eventsInProgress);if(g&&(y||b)&&!B){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;O?(j(O.bearing||this._map.getBearing())&&(O.bearing=0),this._map.easeTo(O,{originalEvent:M})):(this._map.fire(new s.Event("moveend",{originalEvent:M})),j(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,u){this._map.fire(new s.Event(r,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new Yl("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const pd="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Gp extends s.Evented{constructor(r,u){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=u.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,u){return this.jumpTo({center:r},u)}panBy(r,u,g){return r=s.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,s.extend({offset:r},u),g)}panTo(r,u,g){return this.easeTo(s.extend({center:r},u),g)}getZoom(){return this.transform.zoom}setZoom(r,u){return this.jumpTo({zoom:r},u),this}zoomTo(r,u,g){return this.easeTo(s.extend({zoom:r},u),g)}zoomIn(r,u){return this.zoomTo(this.getZoom()+1,r,u),this}zoomOut(r,u){return this.zoomTo(this.getZoom()-1,r,u),this}getBearing(){return this.transform.bearing}setBearing(r,u){return this.jumpTo({bearing:r},u),this}getPadding(){return this.transform.padding}setPadding(r,u){return this.jumpTo({padding:r},u),this}rotateTo(r,u,g){return this.easeTo(s.extend({bearing:r},u),g)}resetNorth(r,u){return this.rotateTo(0,s.extend({duration:1e3},r),u),this}resetNorthPitch(r,u){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},r),u),this}snapToNorth(r,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,u):this}getPitch(){return this.transform.pitch}setPitch(r,u){return this.jumpTo({pitch:r},u),this}cameraForBounds(r,u){r=s.LngLatBounds.convert(r);const g=u&&u.bearing||0,y=u&&u.pitch||0,b=r.getNorthWest(),C=r.getSouthEast();return this._cameraForBounds(this.transform,b,C,g,y,u)}_extendCameraOptions(r){const u={top:0,bottom:0,right:0,left:0};if(typeof(r=s.extend({padding:u,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=="number"){const g=r.padding;r.padding={top:g,bottom:g,right:g,left:g}}return r.padding=s.extend(u,r.padding),r}_minimumAABBFrustumDistance(r,u){const g=u.max[0]-u.min[0],y=u.max[1]-u.min[1];return g/y>r.aspect?g/(2*Math.tan(.5*r.fovX)*r.aspect):y/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,u,g,y,b,C){const I=r.clone(),M=this._extendCameraOptions(C);I.bearing=y,I.pitch=b;const B=s.LngLat.convert(u),O=s.LngLat.convert(g),j=.5*(B.lat+O.lat),H=.5*(B.lng+O.lng),Q=s.latLngToECEF(j,H),J=s.normalize([],Q),ee=s.normalize([],s.cross([],J,[0,1,0])),te=s.cross([],ee,J),W=[ee[0],ee[1],ee[2],0,te[0],te[1],te[2],0,J[0],J[1],J[2],0,0,0,0,1],ue=[Q,s.latLngToECEF(B.lat,B.lng),s.latLngToECEF(O.lat,B.lng),s.latLngToECEF(O.lat,O.lng),s.latLngToECEF(B.lat,O.lng),s.latLngToECEF(j,B.lng),s.latLngToECEF(j,O.lng),s.latLngToECEF(B.lat,H),s.latLngToECEF(O.lat,H)];let ae=s.Aabb.fromPoints(ue.map(lt=>[s.dot(ee,lt),s.dot(te,lt),s.dot(J,lt)]));const pe=s.transformMat4([],ae.center,W);s.squaredLength(pe)===0&&s.set(pe,0,0,1),s.normalize(pe,pe),s.scale$2(pe,pe,s.GLOBE_RADIUS),I.center=s.ecefToLatLng(pe);const Ce=I.getWorldToCameraMatrix(),we=s.invert(new Float64Array(16),Ce);ae=s.Aabb.applyTransform(ae,s.multiply([],Ce,W)),s.transformMat4(pe,pe,Ce);const Ae=.5*(ae.max[2]-ae.min[2]),Be=this._minimumAABBFrustumDistance(I,ae),Ne=s.scale$2([],[0,0,1],Ae),Ge=s.add(Ne,pe,Ne),wt=Be+(I.pitch===0?0:s.distance(pe,Ge)),Fe=I.globeCenterInViewSpace,rt=s.sub([],pe,[Fe[0],Fe[1],Fe[2]]);s.normalize(rt,rt),s.scale$2(rt,rt,wt);const Xe=s.add([],pe,rt);s.transformMat4(Xe,Xe,we);const ht=s.earthRadius/s.GLOBE_RADIUS,Ue=s.length(Xe),Le=s.mercatorZfromAltitude(Math.max(Ue*ht-s.earthRadius,Number.EPSILON),0),Ze=Math.min(I.zoomFromMercatorZAdjusted(Le),M.maxZoom);return Ze>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"mercator"}),I.zoom=Ze,this._cameraForBounds(I,u,g,y,b,C)):{center:I.center,zoom:Ze,bearing:y,pitch:b}}queryTerrainElevation(r,u){const g=this.transform.elevation;return g?(u=s.extend({},{exaggerated:!0},u),g.getAtPoint(s.MercatorCoordinate.fromLngLat(r),null,u.exaggerated)):null}_cameraForBounds(r,u,g,y,b,C){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,u,g,y,b,C);const I=r.clone(),M=this._extendCameraOptions(C),B=I.padding;I.bearing=y,I.pitch=b;const O=s.LngLat.convert(u),j=s.LngLat.convert(g),H=new s.LngLat(O.lng,j.lat),Q=new s.LngLat(j.lng,O.lat),J=I.project(O),ee=I.project(j),te=this.queryTerrainElevation(O),W=this.queryTerrainElevation(j),ue=this.queryTerrainElevation(H),ae=this.queryTerrainElevation(Q),pe=[[J.x,J.y,Math.min(te||0,W||0,ue||0,ae||0)],[ee.x,ee.y,Math.max(te||0,W||0,ue||0,ae||0)]];let Ce=s.Aabb.fromPoints(pe);const we=I.getWorldToCameraMatrix(),Ae=s.invert(new Float64Array(16),we);Ce=s.Aabb.applyTransform(Ce,we);const Be=s.sub([],Ce.max,Ce.min),Ne=B.left||0,Ge=B.right||0,wt=B.bottom||0,Fe=B.top||0,{left:rt,right:Xe,top:ht,bottom:Ue}=M.padding,Le=.5*(Ne+Ge),Ze=.5*(Fe+wt),lt=Math.min(I.scaleZoom(I.scale*Math.min((I.width-(Ne+Ge+rt+Xe))/Be[0],(I.height-(wt+Fe+Ue+ht))/Be[1])),M.maxZoom),mt=I.scale/I.zoomScale(lt);Ce=new s.Aabb([Ce.min[0]-(rt+Le)*mt,Ce.min[1]-(Ue+Ze)*mt,Ce.min[2]],[Ce.max[0]+(Xe+Le)*mt,Ce.max[1]+(ht+Ze)*mt,Ce.max[2]]);const Ht=.5*Be[2],gn=this._minimumAABBFrustumDistance(I,Ce),jt=[0,0,1,0];s.transformMat4$1(jt,jt,we),s.normalize$2(jt,jt);const Vt=s.scale$2([],jt,gn+Ht),Xt=s.add([],Ce.center,Vt),kn=(typeof M.offset.x=="number"&&typeof M.offset.y=="number"?new s.pointGeometry(M.offset.x,M.offset.y):s.pointGeometry.convert(M.offset)).rotate(-s.degToRad(y));Ce.center[0]-=kn.x*mt,Ce.center[1]+=kn.y*mt,s.transformMat4(Ce.center,Ce.center,Ae),s.transformMat4(Xt,Xt,Ae);const en=[Ce.center[0],Ce.center[1],Xt[2]*I.pixelsPerMeter];s.scale$2(en,en,1/I.worldSize);const Hn=s.lngFromMercatorX(en[0]),ni=s.latFromMercatorY(en[1]),ui=Math.min(I._zoomFromMercatorZ(en[2]),M.maxZoom),oi=new s.LngLat(Hn,ni);return I.mercatorFromTransition&&ui<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"globe"}),I.zoom=ui,this._cameraForBounds(I,u,g,y,b,C)):{center:oi,zoom:ui,bearing:y,pitch:b}}fitBounds(r,u,g){const y=this.cameraForBounds(r,u);return this._fitInternal(y,u,g)}fitScreenCoordinates(r,u,g,y,b){const C=s.pointGeometry.convert(r),I=s.pointGeometry.convert(u),M=new s.pointGeometry(Math.min(C.x,I.x),Math.min(C.y,I.y)),B=new s.pointGeometry(Math.max(C.x,I.x),Math.max(C.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(C,I))return this;const O=this.transform.pointLocation3D(M),j=this.transform.pointLocation3D(B),H=this.transform.pointLocation3D(new s.pointGeometry(M.x,B.y)),Q=this.transform.pointLocation3D(new s.pointGeometry(B.x,M.y)),J=[Math.min(O.lng,j.lng,H.lng,Q.lng),Math.min(O.lat,j.lat,H.lat,Q.lat)],ee=[Math.max(O.lng,j.lng,H.lng,Q.lng),Math.max(O.lat,j.lat,H.lat,Q.lat)],te=y&&y.pitch?y.pitch:this.getPitch(),W=this._cameraForBounds(this.transform,J,ee,g,te,y);return this._fitInternal(W,y,b)}_fitInternal(r,u,g){return r?(delete(u=s.extend(r,u)).padding,u.linear?this.easeTo(u,g):this.flyTo(u,g)):this}jumpTo(r,u){this.stop();const g=r.preloadOnly?this.transform.clone():this.transform;let y=!1,b=!1,C=!1;return"zoom"in r&&g.zoom!==+r.zoom&&(y=!0,g.zoom=+r.zoom),r.center!==void 0&&(g.center=s.LngLat.convert(r.center)),"bearing"in r&&g.bearing!==+r.bearing&&(b=!0,g.bearing=+r.bearing),"pitch"in r&&g.pitch!==+r.pitch&&(C=!0,g.pitch=+r.pitch),r.padding==null||g.isPaddingEqual(r.padding)||(g.padding=r.padding),r.preloadOnly?(this._preloadTiles(g),this):(this.fire(new s.Event("movestart",u)).fire(new s.Event("move",u)),y&&this.fire(new s.Event("zoomstart",u)).fire(new s.Event("zoom",u)).fire(new s.Event("zoomend",u)),b&&this.fire(new s.Event("rotatestart",u)).fire(new s.Event("rotate",u)).fire(new s.Event("rotateend",u)),C&&this.fire(new s.Event("pitchstart",u)).fire(new s.Event("pitch",u)).fire(new s.Event("pitchend",u)),this.fire(new s.Event("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(pd),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,u){const g=this.transform;if(!g.projection.supportsFreeCamera)return s.warnOnce(pd),this;this.stop();const y=g.zoom,b=g.pitch,C=g.bearing;g.setFreeCameraOptions(r);const I=y!==g.zoom,M=b!==g.pitch,B=C!==g.bearing;return this.fire(new s.Event("movestart",u)).fire(new s.Event("move",u)),I&&this.fire(new s.Event("zoomstart",u)).fire(new s.Event("zoom",u)).fire(new s.Event("zoomend",u)),B&&this.fire(new s.Event("rotatestart",u)).fire(new s.Event("rotate",u)).fire(new s.Event("rotateend",u)),M&&this.fire(new s.Event("pitchstart",u)).fire(new s.Event("pitch",u)).fire(new s.Event("pitchend",u)),this.fire(new s.Event("moveend",u)),this}easeTo(r,u){this._stop(!1,r.easeId),((r=s.extend({offset:[0,0],duration:500,easing:s.ease},r)).animate===!1||!r.essential&&s.exported.prefersReducedMotion)&&(r.duration=0);const g=this.transform,y=this.getZoom(),b=this.getBearing(),C=this.getPitch(),I=this.getPadding(),M="zoom"in r?+r.zoom:y,B="bearing"in r?this._normalizeBearing(r.bearing,b):b,O="pitch"in r?+r.pitch:C,j="padding"in r?r.padding:g.padding,H=s.pointGeometry.convert(r.offset);let Q,J,ee;if(g.projection.name==="globe"){const Ne=s.MercatorCoordinate.fromLngLat(g.center),Ge=H.rotate(-g.angle);Ne.x+=Ge.x/g.worldSize,Ne.y+=Ge.y/g.worldSize;const wt=Ne.toLngLat(),Fe=s.LngLat.convert(r.center||wt);this._normalizeCenter(Fe),Q=g.centerPoint.add(Ge),J=new s.pointGeometry(Ne.x,Ne.y).mult(g.worldSize),ee=new s.pointGeometry(s.mercatorXfromLng(Fe.lng),s.mercatorYfromLat(Fe.lat)).mult(g.worldSize).sub(J)}else{Q=g.centerPoint.add(H);const Ne=g.pointLocation(Q),Ge=s.LngLat.convert(r.center||Ne);this._normalizeCenter(Ge),J=g.project(Ne),ee=g.project(Ge).sub(J)}const te=g.zoomScale(M-y);let W,ue;r.around&&(W=s.LngLat.convert(r.around),ue=g.locationPoint(W));const ae=this._zooming||M!==y,pe=this._rotating||b!==B,Ce=this._pitching||O!==C,we=!g.isPaddingEqual(j),Ae=Ne=>Ge=>{if(ae&&(Ne.zoom=s.number(y,M,Ge)),pe&&(Ne.bearing=s.number(b,B,Ge)),Ce&&(Ne.pitch=s.number(C,O,Ge)),we&&(Ne.interpolatePadding(I,j,Ge),Q=Ne.centerPoint.add(H)),W)Ne.setLocationAtPoint(W,ue);else{const wt=Ne.zoomScale(Ne.zoom-y),Fe=M>y?Math.min(2,te):Math.max(.5,te),rt=Math.pow(Fe,1-Ge),Xe=Ne.unproject(J.add(ee.mult(Ge*rt)).mult(wt));Ne.setLocationAtPoint(Ne.renderWorldCopies?Xe.wrap():Xe,Q)}return r.preloadOnly||this._fireMoveEvents(u),Ne};if(r.preloadOnly){const Ne=this._emulate(Ae,r.duration,g);return this._preloadTiles(Ne),this}const Be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ae,this._rotating=pe,this._pitching=Ce,this._padding=we,this._easeId=r.easeId,this._prepareEase(u,r.noMoveStart,Be),this._ease(Ae(g),Ne=>{g.recenterOnTerrain(),this._afterEase(u,Ne)},r),this}_prepareEase(r,u,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",u||g.moving||this.fire(new s.Event("movestart",r)),this._zooming&&!g.zooming&&this.fire(new s.Event("zoomstart",r)),this._rotating&&!g.rotating&&this.fire(new s.Event("rotatestart",r)),this._pitching&&!g.pitching&&this.fire(new s.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new s.Event("move",r)),this._zooming&&this.fire(new s.Event("zoom",r)),this._rotating&&this.fire(new s.Event("rotate",r)),this._pitching&&this.fire(new s.Event("pitch",r))}_afterEase(r,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,y=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new s.Event("zoomend",r)),y&&this.fire(new s.Event("rotateend",r)),b&&this.fire(new s.Event("pitchend",r)),this.fire(new s.Event("moveend",r))}flyTo(r,u){if(!r.essential&&s.exported.prefersReducedMotion){const lt=s.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(lt,u)}this.stop(),r=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},r);const g=this.transform,y=this.getZoom(),b=this.getBearing(),C=this.getPitch(),I=this.getPadding(),M="zoom"in r?s.clamp(+r.zoom,g.minZoom,g.maxZoom):y,B="bearing"in r?this._normalizeBearing(r.bearing,b):b,O="pitch"in r?+r.pitch:C,j="padding"in r?r.padding:g.padding,H=g.zoomScale(M-y),Q=s.pointGeometry.convert(r.offset);let J=g.centerPoint.add(Q);const ee=g.pointLocation(J),te=s.LngLat.convert(r.center||ee);this._normalizeCenter(te);const W=g.project(ee),ue=g.project(te).sub(W);let ae=r.curve;const pe=Math.max(g.width,g.height),Ce=pe/H,we=ue.mag();if("minZoom"in r){const lt=s.clamp(Math.min(r.minZoom,y,M),g.minZoom,g.maxZoom),mt=pe/g.zoomScale(lt-y);ae=Math.sqrt(mt/we*2)}const Ae=ae*ae;function Be(lt){const mt=(Ce*Ce-pe*pe+(lt?-1:1)*Ae*Ae*we*we)/(2*(lt?Ce:pe)*Ae*we);return Math.log(Math.sqrt(mt*mt+1)-mt)}function Ne(lt){return(Math.exp(lt)-Math.exp(-lt))/2}function Ge(lt){return(Math.exp(lt)+Math.exp(-lt))/2}const wt=Be(0);let Fe=function(lt){return Ge(wt)/Ge(wt+ae*lt)},rt=function(lt){return pe*((Ge(wt)*(Ne(mt=wt+ae*lt)/Ge(mt))-Ne(wt))/Ae)/we;var mt},Xe=(Be(1)-wt)/ae;if(Math.abs(we)<1e-6||!isFinite(Xe)){if(Math.abs(pe-Ce)<1e-6)return this.easeTo(r,u);const lt=Ce<pe?-1:1;Xe=Math.abs(Math.log(Ce/pe))/ae,rt=function(){return 0},Fe=function(mt){return Math.exp(lt*ae*mt)}}r.duration="duration"in r?+r.duration:1e3*Xe/("screenSpeed"in r?+r.screenSpeed/ae:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const ht=b!==B,Ue=O!==C,Le=!g.isPaddingEqual(j),Ze=lt=>mt=>{const Ht=mt*Xe,gn=1/Fe(Ht);lt.zoom=mt===1?M:y+lt.scaleZoom(gn),ht&&(lt.bearing=s.number(b,B,mt)),Ue&&(lt.pitch=s.number(C,O,mt)),Le&&(lt.interpolatePadding(I,j,mt),J=lt.centerPoint.add(Q));const jt=mt===1?te:lt.unproject(W.add(ue.mult(rt(Ht))).mult(gn));return lt.setLocationAtPoint(lt.renderWorldCopies?jt.wrap():jt,J),lt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(u),lt};if(r.preloadOnly){const lt=this._emulate(Ze,r.duration,g);return this._preloadTiles(lt),this}return this._zooming=!0,this._rotating=ht,this._pitching=Ue,this._padding=Le,this._prepareEase(u,!1),this._ease(Ze(g),()=>this._afterEase(u),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,u)}if(!r){const g=this.handlers;g&&g.stop(!1)}return this}_ease(r,u,g){g.animate===!1||g.duration===0?(r(1),u()):(this._easeStart=s.exported.now(),this._easeOptions=g,this._onEaseFrame=r,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,u){r=s.wrap(r,-180,180);const g=Math.abs(r-u);return Math.abs(r-360-u)<g&&(r-=360),Math.abs(r+360-u)<g&&(r+=360),r}_normalizeCenter(r){const u=this.transform;if(!u.renderWorldCopies||u.maxBounds)return;const g=r.lng-u.center.lng;r.lng+=g>180?-360:g<-180?360:0}_emulate(r,u,g){const y=Math.ceil(15*u/1e3),b=[],C=r(g.clone());for(let I=0;I<=y;I++){const M=C(I/y);b.push(M.clone())}return b}}class md{constructor(r={}){this.options=r,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const u=this.options&&this.options.compact;return this._map=r,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L("button","mapboxgl-ctrl-attrib-button",this._container),L("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(r,u){const g=this._map._getUIString(`AttributionControl.${u}`);r.setAttribute("aria-label",g),r.removeAttribute("title"),r.firstElementChild&&r.firstElementChild.setAttribute("title",g)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(r){const g=u.reduce((y,b,C)=>(b.value&&(y+=`${b.key}=${b.value}${C<u.length-1?"&":""}`),y),"?");r.href=`${s.config.FEEDBACK_URL}/${g}#${ad(this._map,!0)}`,r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const u=this._map.style._sourceCaches;for(const y in u){const b=u[y];if(b.used){const C=b.getSource();C.attribution&&r.indexOf(C.attribution)<0&&r.push(C.attribution)}}r.sort((y,b)=>y.length-b.length),r=r.filter((y,b)=>{for(let C=b+1;C<r.length;C++)if(r[C].indexOf(y)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const g=r.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,r.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class gd{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=L("div","mapboxgl-ctrl");const u=L("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const u in r){const g=r[u].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const u=r[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class Ql{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const u=++this._id;return this._queue.push({callback:r,id:u,cancelled:!1}),u}remove(r){const u=this._currentlyRunning,g=u?this._queue.concat(u):this._queue;for(const y of g)if(y.id===r)return void(y.cancelled=!0)}run(r=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const g of u)if(!g.cancelled&&(g.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Iu(f,r,u){if(f=new s.LngLat(f.lng,f.lat),r){const g=new s.LngLat(f.lng-360,f.lat),y=new s.LngLat(f.lng+360,f.lat),b=360*Math.ceil(Math.abs(f.lng-u.center.lng)/360),C=u.locationPoint(f).distSqr(r),I=r.x<0||r.y<0||r.x>u.width||r.y>u.height;u.locationPoint(g).distSqr(r)<C&&(I||Math.abs(g.lng-u.center.lng)<b)?f=g:u.locationPoint(y).distSqr(r)<C&&(I||Math.abs(y.lng-u.center.lng)<b)&&(f=y)}for(;Math.abs(f.lng-u.center.lng)>180;){const g=u.locationPoint(f);if(g.x>=0&&g.y>=0&&g.x<=u.width&&g.y<=u.height)break;f.lng>u.center.lng?f.lng-=360:f.lng+=360}return f}const Wa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Au extends s.Evented{constructor(r,u){if(super(),(r instanceof s.window.HTMLElement||u)&&(r=s.extend({element:r},u)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=s.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=L("div");const y=41,b=27,C=D("svg",{display:"block",height:y*this._scale+"px",width:b*this._scale+"px",viewBox:`0 0 ${b} ${y}`},this._element),I=D("radialGradient",{id:"shadowGradient"},D("defs",{},C));D("stop",{offset:"10%","stop-opacity":.4},I),D("stop",{offset:"100%","stop-opacity":.05},I),D("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},C),D("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},C),D("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},C),D("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},C),this._offset=s.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()});const g=this._element.classList;for(const y in Wa)g.remove(`mapboxgl-marker-anchor-${y}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=s.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const u=r.code,g=r.charCode||r.keyCode;u!=="Space"&&u!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(r){const u=r.originalEvent.target,g=this._element;this._popup&&(u===g||g.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,u=this._pos;if(!r||!u)return!1;const g=r.unproject(u),y=r.getFreeCameraOptions();if(!y.position)return!1;const b=y.position.toLngLat();return b.distanceTo(g)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const u=this._pos;if(!u||u.x<0||u.x>r.transform.width||u.y<0||u.y>r.transform.height)return void this._clearFadeTimer();const g=r.unproject(u);let y;r._showingGlobe()&&s.isLngLatBehindGlobe(r.transform,this._lngLat)?y=0:(y=1-r._queryFogOpacity(g),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(y*=this._occludedOpacity)),this._element.style.opacity=`${y}`,this._element.style.pointerEvents=y>0?"auto":"none",this._popup&&this._popup._setOpacity(y),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${Wa[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const r=this._pos,u=this._map,g=this.getPitchAlignment();if(!u||!r||g!=="map")return"";if(!u._showingGlobe()){const M=u.getPitch();return M?`rotateX(${M}deg)`:""}const y=s.radToDeg(s.globeTiltAtLngLat(u.transform,this._lngLat)),b=r.sub(s.globeCenterToScreenPoint(u.transform)),C=Math.abs(b.x)+Math.abs(b.y);if(C===0)return"";const I=y/C;return`rotateX(${-b.y*I}deg) rotateY(${b.x*I}deg)`}_calculateZTransform(){const r=this._pos,u=this._map;if(!u||!r)return"";let g=0;const y=this.getRotationAlignment();if(y==="map")if(u._showingGlobe()){const b=u.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),C=u.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);g=s.radToDeg(Math.atan2(C.y,C.x))-90}else g=-u.getBearing();else if(y==="horizon"){const b=s.smoothstep(4,6,u.getZoom()),C=s.globeCenterToScreenPoint(u.transform);C.y+=b*u.transform.height;const I=r.sub(C),M=s.radToDeg(Math.atan2(I.y,I.x));g=(M>90?M-270:M+90)*(1-b)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(r){s.window.cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=Iu(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat),r===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=s.pointGeometry.convert(r),this._update(),this}_onMove(r){const u=this._map;if(!u)return;const g=this._pointerdownPos,y=this._positionDelta;if(g&&y){if(!this._isDragging){const b=this._clickTolerance||u._clickTolerance;if(r.point.dist(g)<b)return;this._isDragging=!0}this._pos=r.point.sub(y),this._lngLat=u.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(r){const u=this._map,g=this._pos;u&&g&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(g),this._pointerdownPos=r.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const u=this._map;return u&&(r?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const qp={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Zp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function vd(f=new s.pointGeometry(0,0),r="bottom"){if(typeof f=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(r){case"top":return new s.pointGeometry(0,f);case"top-left":return new s.pointGeometry(u,u);case"top-right":return new s.pointGeometry(-u,u);case"bottom":return new s.pointGeometry(0,-f);case"bottom-left":return new s.pointGeometry(u,-u);case"bottom-right":return new s.pointGeometry(-u,-u);case"left":return new s.pointGeometry(f,0);case"right":return new s.pointGeometry(-f,0)}return new s.pointGeometry(0,0)}return f instanceof s.pointGeometry||Array.isArray(f)?s.pointGeometry.convert(f):s.pointGeometry.convert(f[r]||[0,0])}class Wp{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const u=s.easeCubicInOut((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,u,g){this._start=this.getValue(u),this._end=r,this._startTime=u,this._endTime=u+g}}const Hp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Xp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},_d={showCompass:!0,showZoom:!0,visualizePitch:!1};class Yp{constructor(r,u,g=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new hd({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,g&&(this.mousePitch=new dd({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(r,u){this.mouseRotate.mousedown(r,u),this.mousePitch&&this.mousePitch.mousedown(r,u),ne()}move(r,u){const g=this.map,y=this.mouseRotate.mousemoveWindow(r,u),b=y&&y.bearingDelta;if(b&&g.setBearing(g.getBearing()+b),this.mousePitch){const C=this.mousePitch.mousemoveWindow(r,u),I=C&&C.pitchDelta;I&&g.setPitch(g.getPitch()+I)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ce(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(s.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),Y(this.element,r)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,Y(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=_e(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=_e(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Kp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Jp={maxWidth:100,unit:"metric"};function Qp(f,r,u){const g=ku(r),y=g/r,b={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[u];this._map._requestDomTask(()=>{this._container.style.width=f*y+"px",this._container.innerHTML=`${g}&nbsp;${b}`})}function ku(f){const r=Math.pow(10,`${Math.floor(f)}`.length-1);let u=f/r;return u=u>=10?10:u>=5?5:u>=3?3:u>=2?2:u>=1?1:function(g){const y=Math.pow(10,Math.ceil(-Math.log(g)/Math.LN10));return Math.round(g*y)/y}(u),r*u}const ec={version:s.version,supported:E,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends Gp{constructor(f){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(f=s.extend({},Xp,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(f.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ot(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._useWebGL2=f.useWebGL2,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._optimizeForTerrain=f.optimizeForTerrain,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new Ql,this._domRenderTaskQueue=new Ql,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},Hp,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Wp(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,typeof f.container=="string"){if(this._container=s.window.document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new jp(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,f.style&&this.setStyle(f.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this._hash=f.hash&&new Mp(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,s.extend({},f.fitBoundsOptions,{duration:0})))),this.resize(),f.attributionControl&&this.addControl(new md({customAttribution:f.customAttribution})),this._logoControl=new gd,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new s.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new s.Event(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(f,r){if(r===void 0&&(r=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=f.onAdd(this);this._controls.push(f);const g=this._controlPositions[r];return r.indexOf("bottom")!==-1?g.insertBefore(u,g.firstChild):g.appendChild(u),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(f);return r>-1&&this._controls.splice(r,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new s.Event("movestart",f)).fire(new s.Event("move",f)),this.fire(new s.Event("resize",f)),r&&this.fire(new s.Event("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(s.LngLatBounds.convert(f)),this._update()}setMinZoom(f){if((f=f==null?-2:f)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f==null?22:f)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f==null?0:f)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f==null?85:f)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?s.window.navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(r=>r==="auto"?s.window.navigator.language:r):f}setLanguage(f){const r=this._parseLanguage(f);if(!this.style||r===this._language)return this;this._language=r,this.style._reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,r=f.projection.name;let u;r==="globe"&&f.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(f.setMercatorFromTransition(),u=!0):r==="mercator"&&f.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(f.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,r){return this._updateProjection(f||r||{name:"mercator"})}_updateProjection(f){let r;if(r=f.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),r){this.painter.clearBackgroundTiles();for(const u in this.style._sourceCaches)this.style._sourceCaches[u].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(f){return this.transform.locationPoint3D(s.LngLat.convert(f))}unproject(f){return this.transform.pointLocation3D(s.pointGeometry.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,r,u){if(f==="mouseenter"||f==="mouseover"){let g=!1;const y=C=>{const I=r.filter(B=>this.getLayer(B)),M=I.length?this.queryRenderedFeatures(C.point,{layers:I}):[];M.length?g||(g=!0,u.call(this,new sr(f,this,C.originalEvent,{features:M}))):g=!1},b=()=>{g=!1};return{layers:new Set(r),listener:u,delegates:{mousemove:y,mouseout:b}}}if(f==="mouseleave"||f==="mouseout"){let g=!1;const y=C=>{const I=r.filter(M=>this.getLayer(M));(I.length?this.queryRenderedFeatures(C.point,{layers:I}):[]).length?g=!0:g&&(g=!1,u.call(this,new sr(f,this,C.originalEvent)))},b=C=>{g&&(g=!1,u.call(this,new sr(f,this,C.originalEvent)))};return{layers:new Set(r),listener:u,delegates:{mousemove:y,mouseout:b}}}{const g=y=>{const b=r.filter(I=>this.getLayer(I)),C=b.length?this.queryRenderedFeatures(y.point,{layers:b}):[];C.length&&(y.features=C,u.call(this,y),delete y.features)};return{layers:new Set(r),listener:u,delegates:{[f]:g}}}}on(f,r,u){if(u===void 0)return super.on(f,r);Array.isArray(r)||(r=[r]);const g=this._createDelegatedListener(f,r,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(g);for(const y in g.delegates)this.on(y,g.delegates[y]);return this}once(f,r,u){if(u===void 0)return super.once(f,r);Array.isArray(r)||(r=[r]);const g=this._createDelegatedListener(f,r,u);for(const y in g.delegates)this.once(y,g.delegates[y]);return this}off(f,r,u){if(u===void 0)return super.off(f,r);r=new Set(Array.isArray(r)?r:[r]);const g=(b,C)=>{if(b.size!==C.size)return!1;for(const I of b)if(!C.has(I))return!1;return!0},y=this._delegatedListeners?this._delegatedListeners[f]:void 0;return y&&(b=>{for(let C=0;C<b.length;C++){const I=b[C];if(I.listener===u&&g(I.layers,r)){for(const M in I.delegates)this.off(M,I.delegates[M]);return b.splice(C,1),this}}})(y),this}queryRenderedFeatures(f,r){return this.style?(r!==void 0||f===void 0||f instanceof s.pointGeometry||Array.isArray(f)||(r=f,f=void 0),this.style.queryRenderedFeatures(f=f||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}querySourceFeatures(f,r){return this.style.querySourceFeatures(f,r)}setStyle(f,r){return(r=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&f?(this._diffStyle(f,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(f,r))}_getUIString(f){const r=this._locale[f];if(r==null)throw new Error(`Missing UI string '${f}'`);return r}_updateStyle(f,r){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f&&(this.style=new Yr(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f):this.style.loadJSON(f)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Yr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,r){if(typeof f=="string"){const u=this._requestManager.normalizeStyleURL(f),g=this._requestManager.transformRequest(u,s.ResourceType.Style);s.getJSON(g,(y,b)=>{y?this.fire(new s.ErrorEvent(y)):b&&this._updateDiff(b,r)})}else typeof f=="object"&&this._updateDiff(f,r)}_updateDiff(f,r){try{this.style.setState(f)&&this._update(!0)}catch(u){s.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(f,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(f,r){return this._lazyInitEmptyStyle(),this.style.addSource(f,r),this._update(!0)}isSourceLoaded(f){return!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){const f=this.style&&this.style._sourceCaches;for(const r in f){const u=f[r]._tiles;for(const g in u){const y=u[g];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}addSourceType(f,r,u){this._lazyInitEmptyStyle(),this.style.addSourceType(f,r,u)}removeSource(f){return this.style.removeSource(f),this._updateTerrain(),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,r,{pixelRatio:u=1,sdf:g=!1,stretchX:y,stretchY:b,content:C}={}){if(this._lazyInitEmptyStyle(),r instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&r instanceof s.window.ImageBitmap){const{width:I,height:M,data:B}=s.exported.getImageData(r);this.style.addImage(f,{data:new s.RGBAImage({width:I,height:M},B),pixelRatio:u,stretchX:y,stretchY:b,content:C,sdf:g,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:M}=r,B=r;this.style.addImage(f,{data:new s.RGBAImage({width:I,height:M},new Uint8Array(B.data)),pixelRatio:u,stretchX:y,stretchY:b,content:C,sdf:g,version:0,userImage:B}),B.onAdd&&B.onAdd(this,f)}}updateImage(f,r){const u=this.style.getImage(f);if(!u)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=r instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&r instanceof s.window.ImageBitmap?s.exported.getImageData(r):r,{width:y,height:b}=g;y!==void 0&&b!==void 0?y===u.data.width&&b===u.data.height?(u.data.replace(g.data,!(r instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&r instanceof s.window.ImageBitmap)),this.style.updateImage(f,u)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${y}, ${b})
                must be that same as the previous version of the image
                (${u.data.width}, ${u.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,r){s.getImage(this._requestManager.transformRequest(f,s.ResourceType.Image),(u,g)=>{r(u,g instanceof s.window.HTMLImageElement?s.exported.getImageData(g):g)})}listImages(){return this.style.listImages()}addLayer(f,r){return this._lazyInitEmptyStyle(),this.style.addLayer(f,r),this._update(!0)}moveLayer(f,r){return this.style.moveLayer(f,r),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}setLayerZoomRange(f,r,u){return this.style.setLayerZoomRange(f,r,u),this._update(!0)}setFilter(f,r,u={}){return this.style.setFilter(f,r,u),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,r,u,g={}){return this.style.setPaintProperty(f,r,u,g),this._update(!0)}getPaintProperty(f,r){return this.style.getPaintProperty(f,r)}setLayoutProperty(f,r,u,g={}){return this.style.setLayoutProperty(f,r,u,g),this._update(!0)}getLayoutProperty(f,r){return this.style.getLayoutProperty(f,r)}setLight(f,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,r),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(f),this.transform):0}setFeatureState(f,r){return this.style.setFeatureState(f,r),this._update()}removeFeatureState(f,r){return this.style.removeFeatureState(f,r),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let u,g,y,b=this._container;for(;b&&(!g||!y);){const C=s.window.getComputedStyle(b).transform;C&&C!=="none"&&(u=C.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(g=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(y=u[3])),b=b.parentElement}this._containerWidth=g?Math.abs(f/g):f,this._containerHeight=y?Math.abs(r/y):r}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=L("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=L("div","mapboxgl-canvas-container",f);this._interactive&&r.classList.add("mapboxgl-interactive"),this._canvas=L("canvas","mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=L("div","mapboxgl-control-container",f),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{g[y]=L("div",`mapboxgl-ctrl-${y}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,r){const u=s.exported.devicePixelRatio||1;this._canvas.width=u*Math.ceil(f),this._canvas.height=u*Math.ceil(r),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${r}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const r=this._markers.indexOf(f);r!==-1&&this._markers.splice(r,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const r=this._popups.indexOf(f);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const f=s.extend({},E.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._useWebGL2&&this._canvas.getContext("webgl2",f),u=r||this._canvas.getContext("webgl",f)||this._canvas.getContext("experimental-webgl",f);u?(this._useWebGL2&&!r&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(u,!0),this.painter=new Ul(u,this.transform,!!r),this.on("data",g=>{g.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(u)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let r;const u=this.painter.context.extTimerQuery,g=s.exported.now();if(this.listens("gpu-timing-frame")&&(r=u.createQueryEXT(),u.beginQueryEXT(u.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const y=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,M=this.transform.pitch,B=s.exported.now(),O=new s.EvaluationParameters(I,{now:B,fadeDuration:y,pitch:M,transition:this.style.getTransition()});this.style.update(O)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let b=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),b=this._updateAverageElevation(g),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):b=this._updateAverageElevation(g),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,y,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const I=s.exported.now()-g;u.endQueryEXT(u.TIME_ELAPSED_EXT,r),setTimeout(()=>{const M=u.getQueryObjectEXT(r,u.QUERY_RESULT_EXT)/1e6;u.deleteQueryEXT(r),this.fire(new s.Event("gpu-timing-frame",{cpuTime:I,gpuTime:M})),s.window.performance.mark("frame-gpu",{startTime:g,detail:{gpuTime:M}})},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const M=this.painter.queryGpuTimers(I);this.fire(new s.Event("gpu-timing-layer",{layerTimes:M}))},50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const M=this.painter.queryGpuTimeDeferredRender(I);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:M}))},50)}const C=this._sourcesDirty||this._styleDirty||this._placementDirty||b;if(C||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(b=this._updateAverageElevation(g,!0)),b)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const M=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:M})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||C||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const r of this._markers)f&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!f||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(f,r=!1){const u=g=>(this.transform.averageElevation=g,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);if((r||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const g=this.transform.averageElevation;let y=this.transform.sampleAverageElevation(),b=!1;this.transform.elevation&&(b=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(y)?y=0:this._averageElevationLastSampledAt=f;const C=Math.abs(g-y);if(C>1){if(this._isInitialLoad||b)return this._averageElevation.jumpTo(y),u(y);this._averageElevation.easeTo(y,f,300)}else if(C>1e-4)return this._averageElevation.jumpTo(y),u(y)}return!!this._averageElevation.isEasing(f)&&u(this._averageElevation.getValue(f))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===s.AUTH_ERR_MSG||f.status===401)){const r=this.painter.context.gl;s.storeAuthState(r,!1),this._logoControl instanceof gd&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const u=this.painter.context.gl,g=u.createFramebuffer();function y(b){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,b,0);const C=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,C),C}return u.bindFramebuffer(u.FRAMEBUFFER,g),this._canvasPixelComparison(y(f),r.canvasCopies.map(y),r.timeStamps)}_canvasPixelComparison(f,r,u){let g=u[1]-u[0];const y=f.length/4;for(let b=0;b<r.length;b++){const C=r[b];let I=0;for(let M=0;M<C.length;M+=4)C[M]===f[M]&&C[M+1]===f[M+1]&&C[M+2]===f[M+2]&&C[M+3]===f[M+3]&&(I+=1);g+=(u[b+2]-u[b+1])*(1-I/y)}return g}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=s.exported.frame(r=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(r)}))}_preloadTiles(f){const r=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(r,(u,g)=>u._preloadTiles(f,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){s.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,f&&this._update())}_setCacheLimits(f,r){s.setCacheLimits(f,r)}get version(){return s.version}},NavigationControl:class{constructor(f){this.options=s.extend({},_d,f),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),L("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),L("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:r}):u.resetNorth({},{originalEvent:r}))}),this._compassIcon=L("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const r=f.getZoom(),u=r===f.getMaxZoom(),g=r===f.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Yp(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,r){const u=L("button",f,this._container);return u.type="button",u.addEventListener("click",r),u}_setButtonTitle(f,r){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${r}`);f.setAttribute("aria-label",u),f.firstElementChild&&f.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends s.Evented{constructor(f){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},Kp,f),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Kr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const r=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,f(u)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(u=>r(u.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(f){const r=this._map.getMaxBounds(),u=f.coords;return!!r&&(u.longitude<r.getWest()||u.longitude>r.getEast()||u.latitude<r.getSouth()||u.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",f)),this._finish()}}_updateCamera(f){const r=new s.LngLat(f.coords.longitude,f.coords.latitude),u=f.coords.accuracy,g=this._map.getBearing(),y=s.extend({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(u),y,{geolocateSource:!0})}_updateMarker(f){if(f){const r=new s.LngLat(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,r=s.mercatorZfromAltitude(1,f._center.lat)*f.worldSize,u=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=L("button","mapboxgl-ctrl-geolocate",this._container),L("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L("div","mapboxgl-user-location"),this._dotElement.appendChild(L("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(L("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Au({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=L("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Au({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:md,ScaleControl:class{constructor(f){this.options=s.extend({},Jp,f),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Qp.bind(this)),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,r=this._map,u=r._containerHeight/2,g=r._containerWidth/2-f/2,y=r.unproject([g,u]),b=r.unproject([g+f,u]),C=y.distanceTo(b);if(this.options.unit==="imperial"){const I=3.2808*C;I>5280?this._setScale(f,I/5280,"mile"):this._setScale(f,I,"foot")}else this.options.unit==="nautical"?this._setScale(f,C/1852,"nautical-mile"):C>=1e3?this._setScale(f,C/1e3,"kilometer"):this._setScale(f,C,"meter")}_setScale(f,r,u){const g=ku(r),y=g/r;this._map._requestDomTask(()=>{this._container.style.width=f*y+"px",this._container.innerHTML=u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:u}).format(g):`${g}&nbsp;nm`})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f){this._fullscreen=!1,f&&f.container&&(f.container instanceof s.window.HTMLElement?this._container=f.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=L("button","mapboxgl-ctrl-fullscreen",this._controlContainer);L("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(f){super(),this.options=s.extend(Object.create(qp),f),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=s.LngLat.convert(f),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(s.window.document.createTextNode(f))}setHTML(f){const r=s.window.document.createDocumentFragment(),u=s.window.document.createElement("body");let g;for(u.innerHTML=f;g=u.firstChild,g;)r.appendChild(g);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=L("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(f),this.options.closeButton){const u=this._closeButton=L("button","mapboxgl-popup-close-button",r);u.type="button",u.setAttribute("aria-label","Close popup"),u.setAttribute("aria-hidden","true"),u.innerHTML="&#215;",u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let r;return this._classList.delete(f)?r=!1:(this._classList.add(f),r=!0),this._updateClassList(),r}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const r=this._map,u=this._container,g=this._pos;if(!r||!u||!g)return"bottom";const y=u.offsetWidth,b=u.offsetHeight,C=g.x<y/2,I=g.x>r.transform.width-y/2;if(g.y+f<b)return C?"top-left":I?"top-right":"top";if(g.y>r.transform.height-b){if(C)return"bottom-left";if(I)return"bottom-right"}return C?"left":I?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),f.className=r.join(" ")}_update(f){const r=this._map,u=this._content;if(!r||!this._lngLat&&!this._trackPointer||!u)return;let g=this._container;if(g||(g=this._container=L("div","mapboxgl-popup",r.getContainer()),this._tip=L("div","mapboxgl-popup-tip",g),g.appendChild(u)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Iu(this._lngLat,this._pos,r.transform)),!this._trackPointer||f){const y=this._pos=this._trackPointer&&f?f:r.project(this._lngLat),b=vd(this.options.offset),C=this._anchor=this._getAnchor(b.y),I=vd(this.options.offset,C),M=y.add(I).round();r._requestDomTask(()=>{this._container&&C&&(this._container.style.transform=`${Wa[C]} translate(${M.x}px,${M.y}px)`)})}if(!this._marker&&r._showingGlobe()){const y=s.isLngLatBehindGlobe(r.transform,this._lngLat)?0:1;this._setOpacity(y)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Zp);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:Au,Style:Yr,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.pointGeometry,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:gu,Evented:s.Evented,config:s.config,prewarm:function(){un().acquire(nn)},clearPrewarmedResources:function(){const f=Kt;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(nn),Kt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(f){s.config.ACCESS_TOKEN=f},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(f){s.config.API_URL=f},get workerCount(){return Qt.workerCount},set workerCount(f){Qt.workerCount=f},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){s.config.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){s.clearTileCache(f)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return ec});var _=d;return _})})(z0);const _l=z0.exports,WL=Tk({__proto__:null,default:_l},[z0.exports]),ki=Symbol(),HL=vn({__name:"Map",props:{accessToken:null,options:null},emits:["loaded"],setup(e,{expose:o,emit:a}){const c=e;_l.accessToken=c.accessToken;const d=Ii(),m=Ii(),_=He(!1),s=ie(()=>m.value);return o({map:s}),Wi(ki,s),Ke(()=>{var w;return(w=c.options)==null?void 0:w.center},w=>{!m.value||!w||m.value.flyTo({center:w})}),Ke(()=>{var w;return(w=c.options)==null?void 0:w.zoom},w=>{!m.value||w===void 0||m.value.flyTo({zoom:w})}),Ke(()=>{var w;return(w=c.options)==null?void 0:w.pitch},w=>{!m.value||w===void 0||m.value.flyTo({pitch:w})}),Ke(()=>{var w;return(w=c.options)==null?void 0:w.bearing},w=>{!m.value||w===void 0||m.value.flyTo({bearing:w})}),Ke(()=>{var w;return(w=c.options)==null?void 0:w.bounds},w=>{!m.value||!w||m.value.fitBounds(w)}),Ke(()=>{var w;return(w=c.options)==null?void 0:w.maxZoom},w=>{!m.value||w===void 0||m.value.setMaxZoom(w)}),Ke(()=>{var w;return(w=c.options)==null?void 0:w.minZoom},w=>{!m.value||w===void 0||m.value.setMinZoom(w)}),Ke(()=>{var w;return(w=c.options)==null?void 0:w.maxBounds},w=>{!m.value||!w||m.value.setMaxBounds(w)}),Ke(()=>{var w;return(w=c.options)==null?void 0:w.maxPitch},w=>{!m.value||w===void 0||m.value.setMaxPitch(w)}),Ke(()=>{var w;return(w=c.options)==null?void 0:w.minPitch},w=>{!m.value||w===void 0||m.value.setMinPitch(w)}),Ke(()=>{var w;return(w=c.options)==null?void 0:w.style},w=>{var E;!m.value||!w||(w instanceof Object?(E=m.value)==null||E.setStyle(w,{diff:!0}):m.value.setStyle(w))}),Ke(()=>{var w;return(w=c.options)==null?void 0:w.projection},w=>{!m.value||m.value.setProjection(w)}),zn(()=>{d.value&&(m.value=new _l.Map({container:d.value,style:"mapbox://styles/mapbox/streets-v11",center:[120,30],zoom:2,...c.options}),m.value.on("load",()=>{a("loaded"),_.value=!0}))}),gr(()=>{m.value&&m.value.remove()}),(w,E)=>(fi(),oo(Dn,null,[va("div",{ref_key:"mapRef",ref:d,style:{position:"absolute",height:"100%",width:"100%"}},null,512),_.value?mh(w.$slots,"default",{key:0}):jE("",!0)],64))}}),XL=vn({__name:"Sprite",props:{name:null,url:null},setup(e){const o=e,a=cn(ki,void 0),c=()=>{if(!a)return;const d=a.value.hasImage(o.name);typeof o.url=="string"?a.value.loadImage(o.url,(m,_)=>{m||!_||(d?a.value.updateImage(o.name,_):a.value.addImage(o.name,_))}):d?a.value.updateImage(o.name,o.url):a.value.addImage(o.name,o.url)};return Ke(()=>o.url,c),zn(c),gr(()=>{a&&a.value.hasImage(o.name)&&a.value.removeImage(o.name)}),(d,m)=>null}});function Wm(e,o,a){const c=()=>{e.value&&e.value.removeEventListener(o,a)};Ke(e,d=>{c(),d&&d.addEventListener(o,a)}),Ai(()=>{c()})}function li(e,o,a,c){zn(()=>{e.on(o,a,c)}),Ai(()=>{e.off(o,a,c)})}function JT(e,o,a){let c;const d=()=>{!c||c.disconnect()};Ke(e,m=>{d(),m&&(c=new MutationObserver(a),c.observe(m,o))}),gr(()=>{d()})}const YL=vn({__name:"Marker",props:{center:null,options:null},emits:["click","mouseenter","mousemove","mouseleave","update:center"],setup(e,{emit:o}){const a=e,c=Ii(),d=cn(ki,void 0),m=He(),_=()=>{if(!d||!a.center)return;const E=a.options||{};m.value.innerHTML&&(E.element=m.value),c.value=new _l.Marker(E).setLngLat(a.center),c.value.addTo(d.value),c.value.on("dragend",w)},s=()=>{!d||!c.value||(c.value.off("dragend",w),c.value.remove(),c.value=void 0)},w=()=>{if(!c.value)return;const{lng:E,lat:A}=c.value.getLngLat();o("update:center",[E,A])};return JT(m.value,{attributes:!0,childList:!0,subtree:!0},()=>{_()}),Wm(ie(()=>{var E;return(E=c.value)==null?void 0:E.getElement()}),"click",E=>{o("click",E)}),Wm(ie(()=>{var E;return(E=c.value)==null?void 0:E.getElement()}),"mouseenter",E=>{o("mouseenter",E)}),Wm(ie(()=>{var E;return(E=c.value)==null?void 0:E.getElement()}),"mousemove",E=>{o("mousemove",E)}),Wm(ie(()=>{var E;return(E=c.value)==null?void 0:E.getElement()}),"mouseleave",E=>{o("mouseleave",E)}),Ke(()=>a.center,()=>{a.center?c.value?c.value.setLngLat(a.center):_():s()}),Ke(()=>{var E;return(E=a.options)==null?void 0:E.offset},E=>{!c.value||!E||c.value.setOffset(E)}),Ke(()=>{var E;return(E=a.options)==null?void 0:E.draggable},E=>{!c.value||E===void 0||c.value.setDraggable(E)}),Ke(()=>{var E;return(E=a.options)==null?void 0:E.scale},()=>{!c.value||(s(),_())}),Ke(()=>{var E;return(E=a.options)==null?void 0:E.rotation},E=>{!c.value||E===void 0||c.value.setRotation(E)}),Ke(()=>{var E;return(E=a.options)==null?void 0:E.color},()=>{!c.value||(s(),_())}),Ke(()=>{var E;return(E=a.options)==null?void 0:E.anchor},()=>{!c.value||(s(),_())}),Ke(()=>{var E;return(E=a.options)==null?void 0:E.rotationAlignment},E=>{!c.value||!E||c.value.setRotationAlignment(E)}),Ke(()=>{var E;return(E=a.options)==null?void 0:E.pitchAlignment},E=>{var A;E&&((A=c.value)==null||A.setPitchAlignment(E))}),zn(()=>{_()}),gr(()=>{s()}),(E,A)=>(fi(),oo("div",{ref_key:"elRef",ref:m},[mh(E.$slots,"default")],512))}}),KL=vn({__name:"Popup",props:{visible:{type:Boolean},center:null,options:null},emits:["update:visible"],setup(e,{emit:o}){const a=e,c=cn(ki,void 0),d=Ii(),m=He();JT(ie(()=>m.value),{attributes:!0,childList:!0,subtree:!0,characterData:!0},()=>{a.visible&&d.value&&m.value&&d.value.setHTML(m.value.innerHTML)});const _=()=>{!c||!a.center||!a.visible||!m.value||(d.value=new _l.Popup(a.options||{}).setLngLat(a.center).setHTML(m.value.innerHTML).addTo(c.value),d.value.on("close",w))},s=()=>{d.value&&(d.value.off("close",w),d.value.remove())};Ke(()=>a.visible,()=>{s(),a.visible&&_()}),Ke(()=>a.center,()=>{!c||!d.value||!a.visible||(a.center?d.value.setLngLat(a.center).addTo(c.value):s())}),Ke(()=>{var E;return(E=a.options)==null?void 0:E.anchor},E=>{!d.value||!a.visible||E&&(s(),_())}),Ke(()=>{var E;return(E=a.options)==null?void 0:E.offset},E=>{!d.value||!a.visible||E&&d.value.setOffset(E)}),Ke(()=>{var E;return(E=a.options)==null?void 0:E.maxWidth},E=>{!d.value||!a.visible||E&&d.value.setMaxWidth(E)});const w=()=>{o("update:visible",!1)};return zn(()=>{_()}),gr(()=>{s()}),(E,A)=>(fi(),oo("div",{style:{display:"none"},ref_key:"popupRef",ref:m},[mh(E.$slots,"default")],512))}}),JL=vn({__name:"Fog",props:{color:null,range:null},setup(e){const o=e,a=cn(ki,void 0),c=()=>{if(!a)return;const d={};Object.keys(o).forEach(m=>{o[m]!==void 0&&(d[m]=o[m])}),a.value.setFog(d)};return Ke(()=>o.color,()=>c()),Ke(()=>o["horizon-blend"],()=>c()),Ke(()=>o["high-color"],()=>c()),Ke(()=>o["space-color"],()=>c()),Ke(()=>o["star-intensity"],()=>c()),Ke(()=>o.range,()=>c()),zn(()=>{c()}),gr(()=>{!a||a.value.setFog()}),(d,m)=>null}}),QL=vn({__name:"FeatureState",props:{feature:null,state:null},setup(e){const o=e,a=cn(ki,void 0),c=(m,_)=>{!a||!m.id||a.value.setFeatureState(m,_)},d=m=>{!a||!m.id||a.value.removeFeatureState(m)};return Ke(()=>o.feature,(m,_)=>{d(_),c(m,o.state)}),Ke(()=>o.state,m=>{c(o.feature,m)}),zn(()=>{c(o.feature,o.state)}),gr(()=>{d(o.feature)}),(m,_)=>null}}),eR=vn({__name:"AttributionControl",props:{compact:{type:Boolean},customAttribution:null,position:null},setup(e){const o=e,a=Ii(),c=cn(ki,void 0);return zn(()=>{!c||(a.value=new _l.AttributionControl({compact:o.compact||!1,customAttribution:o.customAttribution}),c.value.addControl(a.value,o.position||"bottom-right"))}),gr(()=>{!c||!a.value||c.value.removeControl(a.value)}),(d,m)=>null}}),tR=vn({__name:"NavigationControl",props:{showCompass:{type:Boolean},showZoom:{type:Boolean},visualizePitch:{type:Boolean},position:null},setup(e){const o=e,a=Ii(),c=cn(ki,void 0);return zn(()=>{!c||(a.value=new _l.NavigationControl({showCompass:o.showCompass||!0,showZoom:o.showZoom||!0,visualizePitch:o.visualizePitch||!1}),c.value.addControl(a.value,o.position||"top-left"))}),gr(()=>{!c||!a.value||c.value.removeControl(a.value)}),(d,m)=>null}}),nR=vn({__name:"ScaleControl",props:{maxWidth:null,unit:null,position:null},setup(e){const o=e,a=Ii(),c=cn(ki,void 0);return Ke(()=>o.unit,()=>{o.unit&&a.value.setUnit(o.unit)}),zn(()=>{var d;!c||(a.value=new _l.ScaleControl({maxWidth:(d=o.maxWidth)!=null?d:100,unit:o.unit||"metric"}),c.value.addControl(a.value,o.position||"top-right"))}),gr(()=>{!c||!a.value||c.value.removeControl(a.value)}),(d,m)=>null}});function lr(e,o,a){for(const c in e)c in o&&e[c]===o[c]||a(c,e[c]);for(const c in o)c in e||a(c,void 0)}const iR=vn({__name:"BackgroundLayer",props:{id:null,sourceLayer:null,paint:null,layout:null},setup(e){const o=e,a=Ii(),c=cn(ki,void 0),d=(_,s)=>{!c||c.value.setPaintProperty(o.id,_,s)},m=(_,s)=>{!c||c.value.setLayoutProperty(o.id,_,s)};return Ke(()=>({...o.paint}),(_,s)=>{lr(_,s,d)},{deep:!1}),Ke(()=>({...o.layout}),(_,s)=>{lr(_,s,m)},{deep:!1}),zn(()=>{!c||(c.value.addLayer({id:o.id,type:"background",paint:o.paint||{},layout:o.layout||{}},o.sourceLayer),a.value=c.value.getLayer(o.id))}),Ai(()=>{!c||!a.value||c.value.removeLayer(o.id)}),(_,s)=>null}}),rR=vn({__name:"CircleLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ii(),d=cn(ki,void 0);d!=null&&d.value&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const m=(w,E)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,E)},_=(w,E)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,E)},s=()=>{var w,E;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ke(()=>({...a.paint}),(w,E)=>{lr(w,E,m)},{deep:!1}),Ke(()=>({...a.layout}),(w,E)=>{lr(w,E,_)},{deep:!1}),Ke(()=>a.minzoom,s),Ke(()=>a.maxzoom,s),Ke(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),zn(()=>{var w,E;if(!d)return;const A={type:"circle",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ai(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),oR=vn({__name:"FillExtrusionLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ii(),d=cn(ki,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const m=(w,E)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,E)},_=(w,E)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,E)},s=()=>{var w,E;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ke(()=>({...a.paint}),(w,E)=>{lr(w,E,m)},{deep:!1}),Ke(()=>({...a.layout}),(w,E)=>{lr(w,E,_)},{deep:!1}),Ke(()=>a.minzoom,s),Ke(()=>a.maxzoom,s),Ke(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),zn(()=>{var w,E;if(!d)return;const A={type:"fill-extrusion",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ai(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),sR=vn({__name:"FillLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ii(),d=cn(ki,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const m=(w,E)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,E)},_=(w,E)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,E)},s=()=>{var w,E;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ke(()=>({...a.paint}),(w,E)=>{lr(w,E,m)},{deep:!1}),Ke(()=>({...a.layout}),(w,E)=>{lr(w,E,_)},{deep:!1}),Ke(()=>a.minzoom,s),Ke(()=>a.maxzoom,s),Ke(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),zn(()=>{var w,E;if(!d)return;const A={type:"fill",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ai(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),aR=vn({__name:"HeatmapLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ii(),d=cn(ki,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const m=(w,E)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,E)},_=(w,E)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,E)},s=()=>{var w,E;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ke(()=>({...a.paint}),(w,E)=>{lr(w,E,m)},{deep:!1}),Ke(()=>({...a.layout}),(w,E)=>{lr(w,E,_)},{deep:!1}),Ke(()=>a.minzoom,s),Ke(()=>a.maxzoom,s),Ke(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),zn(()=>{var w,E;if(!d)return;const A={type:"heatmap",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ai(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),lR=vn({__name:"HillshadeLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ii(),d=cn(ki,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const m=(w,E)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,E)},_=(w,E)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,E)},s=()=>{var w,E;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ke(()=>({...a.paint}),(w,E)=>{lr(w,E,m)},{deep:!1}),Ke(()=>({...a.layout}),(w,E)=>{lr(w,E,_)},{deep:!1}),Ke(()=>a.minzoom,s),Ke(()=>a.maxzoom,s),Ke(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),zn(()=>{var w,E;if(!d)return;const A={type:"hillshade",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ai(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),cR=vn({__name:"LineLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ii(),d=cn(ki,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const m=(w,E)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,E)},_=(w,E)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,E)},s=()=>{var w,E;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ke(()=>({...a.paint}),(w,E)=>{lr(w,E,m)},{deep:!1}),Ke(()=>({...a.layout}),(w,E)=>{lr(w,E,_)},{deep:!1}),Ke(()=>a.minzoom,s),Ke(()=>a.maxzoom,s),Ke(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),zn(()=>{var w,E;if(!d)return;const A={type:"line",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ai(()=>{d&&c.value&&d.value.removeLayer(a.id)}),(w,E)=>null}}),uR=vn({__name:"RasterLayer",props:{id:null,source:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ii(),d=cn(ki,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const m=(w,E)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,E)},_=(w,E)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,E)},s=()=>{var w,E;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ke(()=>({...a.paint}),(w,E)=>{lr(w,E,m)},{deep:!1}),Ke(()=>({...a.layout}),(w,E)=>{lr(w,E,_)},{deep:!1}),Ke(()=>a.minzoom,s),Ke(()=>a.maxzoom,s),Ke(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),zn(()=>{var w,E;if(!d)return;const A={type:"raster",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(A.filter=a.filter),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ai(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),hR=vn({__name:"SymbolLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ii(),d=cn(ki,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const m=(w,E)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,E)},_=(w,E)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,E)},s=()=>{var w,E;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ke(()=>({...a.paint}),(w,E)=>{lr(w,E,m)},{deep:!1}),Ke(()=>({...a.layout}),(w,E)=>{lr(w,E,_)},{deep:!1}),Ke(()=>a.minzoom,s),Ke(()=>a.maxzoom,s),Ke(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),zn(()=>{var w,E;if(!d)return;const A={type:"symbol",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ai(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),dR=vn({__name:"SkyLayer",props:{id:null,paint:null,layout:null},setup(e){const o=e,a=Ii(),c=cn(ki,void 0),d=(_,s)=>{!c||c.value.setPaintProperty(o.id,_,s)},m=(_,s)=>{!c||c.value.setLayoutProperty(o.id,_,s)};return Ke(()=>({...o.paint}),(_,s)=>{lr(_,s,d)},{deep:!1}),Ke(()=>({...o.layout}),(_,s)=>{lr(_,s,m)},{deep:!1}),zn(()=>{!c||(c.value.addLayer({id:o.id,type:"sky",paint:o.paint||{},layout:o.layout||{}}),a.value=c.value.getLayer(o.id))}),Ai(()=>{!c||!a.value||c.value.removeLayer(o.id)}),(_,s)=>null}}),fR=vn({__name:"GeoSource",props:{id:null,data:null,attribution:null,buffer:null,cluster:{type:Boolean},clusterMaxZoom:null,clusterMinPoints:null,clusterProperties:null,clusterRadius:null,filter:{type:[Boolean,Array,null]},generateId:{type:Boolean},lineMetrics:{type:Boolean},maxzoom:null,protomteId:null,tolerance:null},setup(e){const o=e,a=Ii(),c=cn(ki,void 0);return Ke(()=>o.data,d=>{!c||!d||!a.value||a.value.setData(d)},{deep:!0}),zn(()=>{if(!c)return;const d={type:"geojson",data:o.data};o.buffer!==void 0&&(d.buffer=o.buffer),o.generateId&&(d.generateId=o.generateId),o.lineMetrics&&(d.lineMetrics=o.lineMetrics),o.maxzoom!==void 0&&(d.maxzoom=o.maxzoom),o.tolerance!==void 0&&(d.tolerance=o.tolerance),o.filter&&(d.filter=o.filter),o.attribution&&(d.attribution=o.attribution),o.protomteId&&(d.promoteId=o.protomteId),o.cluster&&(d.cluster=o.cluster,o.clusterMaxZoom&&(d.clusterMaxZoom=o.clusterMaxZoom),o.clusterMinPoints&&(d.clusterMinPoints=o.clusterMinPoints),o.clusterProperties&&(d.clusterProperties=o.clusterProperties),o.clusterRadius&&(d.clusterRadius=o.clusterRadius)),c.value.addSource(o.id,d),a.value=c.value.getSource(o.id)}),gr(()=>{!c||!a.value||c.value.removeSource(o.id)}),(d,m)=>null}}),pR=vn({__name:"RasterSource",props:{id:null,url:null,tiles:null,tileSize:null,scheme:null,attribution:null,bounds:null,minzoom:null,maxzoom:null},setup(e){const o=e,a=Ii(),c=cn(ki,void 0),d=()=>{!c||(c.value.style._sourceCaches[`other:${o.id}`].clearTiles(),c.value.style._sourceCaches[`other:${o.id}`].update(c.value.transform),c.value.triggerRepaint())};return Ke(()=>o.url,m=>{!m||!a.value||(a.value.url=m,d())}),Ke(()=>o.tiles,m=>{o.url||!m||!a.value||(a.value.tiles=m,d())}),zn(()=>{if(!c)return;const m={id:o.id,type:"raster",scheme:o.scheme||"xyz",tileSize:o.tileSize||256,attribution:o.attribution||"",bounds:o.bounds||[-180,-85.051129,180,85.051129],minzoom:o.minzoom||0,maxzoom:o.maxzoom||22};o.tiles&&(m.tiles=o.tiles),o.url&&(delete m.tiles,m.url=o.url),(m.url||m.tiles)&&(c.value.addSource(o.id,m),a.value=c.value.getSource(o.id))}),gr(()=>{!c||!a.value||c.value.removeSource(o.id)}),(m,_)=>null}}),mR=vn({__name:"RasterDemSource",props:{id:null,url:null,tiles:null,tileSize:null,attribution:null,bounds:null,minzoom:null,maxzoom:null,exaggeration:null,encoding:null,volatile:{type:Boolean}},setup(e){const o=e,a=Ii(),c=cn(ki,void 0);return zn(()=>{if(!c)return;const d={id:o.id,type:"raster-dem",tileSize:o.tileSize||256,attribution:o.attribution||"",bounds:o.bounds||[-180,-85.051129,180,85.051129],minzoom:o.minzoom||0,maxzoom:o.maxzoom||22};o.tiles&&(d.tiles=o.tiles),o.url&&(delete d.tiles,d.url=o.url),(d.url||d.tiles)&&(c.value.addSource(o.id,d),a.value=c.value.getSource(o.id),c.value.setTerrain({source:o.id,exaggeration:o.exaggeration||1}))}),gr(()=>{!c||!a.value||(c.value.setTerrain(),c.value.removeSource(o.id))}),(d,m)=>null}}),gR=vn({__name:"VectorSource",props:{id:null,url:null,tiles:null,promoteId:null,scheme:null,attribution:null,bounds:null,minzoom:null,maxzoom:null,volatile:{type:Boolean}},setup(e){const o=e,a=Ii(),c=cn(ki,void 0);return Ke(()=>o.url,d=>{d&&a.value.setUrl(d)}),Ke(()=>o.tiles,d=>{d&&!o.url&&a.value.setTiles(d)}),zn(()=>{if(!c)return;const d={id:o.id,type:"vector",scheme:o.scheme||"xyz",attribution:o.attribution||"",bounds:o.bounds||[-180,-85.051129,180,85.051129],minzoom:o.minzoom||0,maxzoom:o.maxzoom||22};o.promoteId&&(d.promoteId=o.promoteId),o.tiles&&(d.tiles=o.tiles),o.url&&(delete d.tiles,d.url=o.url),(d.url||d.tiles)&&(c.value.addSource(o.id,d),a.value=c.value.getSource(o.id))}),gr(()=>{!c||!a.value||c.value.removeSource(o.id)}),(d,m)=>null}}),vR=vn({__name:"ImageSource",props:{id:null,url:null,coordinates:null},setup(e){const o=e,a=Ii(),c=cn(ki,void 0),d=()=>{!a.value||a.value.updateImage({url:o.url,coordinates:o.coordinates})};return Ke(()=>o.url,d),Ke(()=>o.coordinates,d),zn(()=>{!c||(c.value.addSource(o.id,{type:"image",url:o.url,coordinates:o.coordinates}),a.value=c.value.getSource(o.id))}),gr(()=>{!c||!a.value||c.value.removeSource(o.id)}),(m,_)=>null}}),_R=vn({__name:"VideoSource",props:{id:null,urls:null,coordinates:null,playing:{type:Boolean}},setup(e){const o=e,a=Ii(),c=cn(ki,void 0),d=()=>{!c||!a.value||a.value.setCoordinates(o.coordinates)},m=()=>{o.playing?a.value.play():a.value.pause()};return Ke(()=>o.coordinates,d),Ke(()=>o.playing,m),zn(()=>{!c||(c.value.addSource(o.id,{type:"video",urls:o.urls,coordinates:o.coordinates}),a.value=c.value.getSource(o.id),m())}),gr(()=>{!c||!a.value||c.value.removeSource(o.id)}),(_,s)=>null}}),yR=vn({__name:"CanvasSource",props:{id:null,animate:{type:Boolean},coordinates:null},setup(e,{expose:o}){const a=e,c=He(),d=Ii(),m=cn(ki,void 0);return o({canvas:c}),Ke(()=>a.coordinates,_=>{d.value.setCoordinates(_)}),Ke(()=>a.animate,()=>{a.animate?d.value.play():d.value.pause()}),zn(()=>{m&&(m.value.addSource(a.id,{type:"canvas",canvas:c.value,animate:a.animate||!1,coordinates:a.coordinates}),d.value=m.value.getSource(a.id))}),gr(()=>{m&&d.value&&m.value.removeSource(a.id)}),(_,s)=>(fi(),oo("canvas",{style:{display:"none"},ref_key:"canvasRef",ref:c,height:"400",width:"400"},null,512))}}),xR={install:e=>{e.component("v-map",HL),e.component("v-sprite",XL),e.component("v-marker",YL),e.component("v-popup",KL),e.component("v-fog",JL),e.component("v-feature-state",QL),e.component("v-attribution-control",eR),e.component("v-navigation-control",tR),e.component("v-scale-control",nR),e.component("v-background-layer",iR),e.component("v-circle-layer",rR),e.component("v-fillextrusion-layer",oR),e.component("v-fill-layer",sR),e.component("v-heatmap-layer",aR),e.component("v-hillshade-layer",lR),e.component("v-line-layer",cR),e.component("v-raster-layer",uR),e.component("v-symbol-layer",hR),e.component("v-sky-layer",dR),e.component("v-geo-source",fR),e.component("v-vector-source",gR),e.component("v-raster-source",pR),e.component("v-rasterdem-source",mR),e.component("v-image-source",vR),e.component("v-video-source",_R),e.component("v-canvas-source",yR)}};const _y=Symbol.for("vuetify:display"),Ow={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},bR=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ow;return ya(Ow,e)};function Fw(e){return Li&&!e?window.innerWidth:0}function Vw(e){return Li&&!e?window.innerHeight:0}function wR(){const e=Li?window.navigator.userAgent:"ssr";function o(N){return Boolean(e.match(N))}const a=o(/android/i),c=o(/iphone|ipad|ipod/i),d=o(/cordova/i),m=o(/electron/i),_=o(/chrome/i),s=o(/edge/i),w=o(/firefox/i),E=o(/opera/i),A=o(/win/i),P=o(/mac/i),L=o(/linux/i),D=o(/ssr/i);return{android:a,ios:c,cordova:d,electron:m,chrome:_,edge:s,firefox:w,opera:E,win:A,mac:P,linux:L,touch:Pz,ssr:D}}function SR(e,o){const{thresholds:a,mobileBreakpoint:c}=bR(e),d=He(Vw(o)),m=wR(),_=$i({}),s=He(Fw(o));function w(){d.value=Vw(),s.value=Fw()}return Vs(()=>{const E=s.value<a.sm,A=s.value<a.md&&!E,P=s.value<a.lg&&!(A||E),L=s.value<a.xl&&!(P||A||E),D=s.value<a.xxl&&!(L||P||A||E),N=s.value>=a.xxl,Z=E?"xs":A?"sm":P?"md":L?"lg":D?"xl":"xxl",de=typeof c=="number"?c:a[c],ne=m.ssr?m.android||m.ios||m.opera:s.value<de;_.xs=E,_.sm=A,_.md=P,_.lg=L,_.xl=D,_.xxl=N,_.smAndUp=!E,_.mdAndUp=!(E||A),_.lgAndUp=!(E||A||P),_.xlAndUp=!(E||A||P||L),_.smAndDown=!(P||L||D||N),_.mdAndDown=!(L||D||N),_.lgAndDown=!(D||N),_.xlAndDown=!N,_.name=Z,_.height=d.value,_.width=s.value,_.mobile=ne,_.mobileBreakpoint=c,_.platform=m,_.thresholds=a}),Li&&window.addEventListener("resize",w,{passive:!0}),{...n0(_),update:w}}function qg(){const e=cn(_y);if(!e)throw new Error("Could not find Vuetify display injection");return e}function QT(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:o,...a}=e,c=ya(o,a),{aliases:d={},components:m={},directives:_={}}=c,s=Lz(c.defaults),w=SR(c.display,c.ssr),E=eL(c.theme),A=mL(c.icons),P=AL(c.locale);return{install:D=>{for(const N in _)D.directive(N,_[N]);for(const N in m)D.component(N,m[N]);for(const N in d)D.component(N,zt({...d[N],name:N,aliasName:d[N].name}));if(E.install(D),D.provide(Pf,s),D.provide(_y,w),D.provide(zf,E),D.provide(my,A),D.provide(hh,P),Li&&c.ssr){const{mount:N}=D;D.mount=function(){const Z=N(...arguments);return Xi(()=>w.update()),D.mount=N,Z}}Gr.reset(),D.mixin({computed:{$vuetify(){return $i({defaults:nf.call(this,Pf),display:nf.call(this,_y),theme:nf.call(this,zf),icons:nf.call(this,my),locale:nf.call(this,hh)})}}})},defaults:s,display:w,theme:E,icons:A,locale:P}}const ER="3.0.0";QT.version=ER;function nf(e){var m;var o,a;const c=this.$,d=(m=(o=c.parent)==null?void 0:o.provides)!=null?m:(a=c.vnode.appContext)==null?void 0:a.provides;if(d&&e in d)return d[e]}const TR=zt({name:"VApp",props:{...kT({fullHeight:!0}),...Kn()},setup(e,o){let{slots:a}=o;const c=Si(e),{layoutClasses:d,layoutStyles:m,getLayoutItem:_,items:s,layoutRef:w}=MT(e),{rtlClasses:E}=Ea();return Mt(()=>{var A;return F("div",{ref:w,class:["v-application",c.themeClasses.value,d.value,E.value],style:m.value},[F("div",{class:"v-application__wrap"},[(A=a.default)==null?void 0:A.call(a)])])}),{getLayoutItem:_,items:s,theme:c}}});const e2=Vo("v-alert-title"),CR=["success","info","warning","error"],IR=zt({name:"VAlert",props:{border:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:mn,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>CR.includes(e)},...vr(),...ls(),...cr(),...jc(),...wh(),...Bi(),...Cn(),...Kn(),...No({variant:"flat"})},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=Tn(e,"modelValue"),d=ie(()=>{var Se;if(e.icon!==!1)return e.type?(Se=e.icon)!=null?Se:`$${e.type}`:e.icon}),m=ie(()=>{var Se;return{color:(Se=e.color)!=null?Se:e.type,variant:e.variant}}),{themeClasses:_}=Si(e),{colorClasses:s,colorStyles:w,variantClasses:E}=$c(m),{densityClasses:A}=qr(e),{dimensionStyles:P}=cs(e),{elevationClasses:L}=zr(e),{locationStyles:D}=Gc(e),{positionClasses:N}=Sh(e),{roundedClasses:Z}=tr(e),{textColorClasses:de,textColorStyles:ne}=so(Et(e,"borderColor")),{t:ce}=us(),K=ie(()=>({"aria-label":ce(e.closeLabel),onClick(Se){c.value=!1}}));return()=>{var Se,Y;const _e=!!(a.prepend||d.value),fe=!!(a.title||e.title),ve=!!(e.text||a.text),Ee=!!(a.close||e.closable);return c.value&&F(e.tag,{class:["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${e.border===!0?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},_.value,s.value,A.value,L.value,N.value,Z.value,E.value],style:[w.value,P.value,D.value],role:"alert"},{default:()=>[Vc(!1,"v-alert"),e.border&&F("div",{key:"border",class:["v-alert__border",de.value],style:ne.value},null),_e&&F(Ci,{key:"prepend",defaults:{VIcon:{density:e.density,icon:d.value,size:e.prominent?44:28}}},{default:()=>[F("div",{class:"v-alert__prepend"},[a.prepend?a.prepend():d.value&&F(Ni,null,null)])]}),F("div",{class:"v-alert__content"},[fe&&F(e2,{key:"title"},{default:()=>[a.title?a.title():e.title]}),ve&&(a.text?a.text():e.text),(Se=a.default)==null?void 0:Se.call(a)]),a.append&&F("div",{key:"append",class:"v-alert__append"},[a.append()]),Ee&&F(Ci,{key:"close",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var be;return[F("div",{class:"v-alert__close"},[(be=(Y=a.close)==null?void 0:Y.call(a,{props:K.value}))!=null?be:F(wi,K.value,null)])]}})]})}}});const t2=zt({name:"VMessages",props:{active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},...wa({transition:{component:b0,leaveAbsolute:!0,group:!0}})},setup(e,o){let{slots:a}=o;const c=ie(()=>Ro(e.messages)),{textColorClasses:d,textColorStyles:m}=so(ie(()=>e.color));return Mt(()=>F(Os,{transition:e.transition,tag:"div",class:["v-messages",d.value],style:m.value},{default:()=>[e.active&&c.value.map((_,s)=>F("div",{class:"v-messages__message",key:`${s}-${c.value}`},[a.message?a.message({message:_}):_]))]})),{}}}),n2=Symbol.for("vuetify:form"),AR=Ln({disabled:Boolean,fastFail:Boolean,lazyValidation:Boolean,readonly:Boolean,modelValue:{type:Boolean,default:null},validateOn:{type:String,default:"input"}},"form");function kR(e){const o=Tn(e,"modelValue"),a=ie(()=>e.disabled),c=ie(()=>e.readonly),d=He(!1),m=He([]),_=He([]);async function s(){const A=[];let P=!0;_.value=[],d.value=!0;for(const L of m.value){const D=await L.validate();if(D.length>0&&(P=!1,A.push({id:L.id,errorMessages:D})),!P&&e.fastFail)break}return _.value=A,d.value=!1,{valid:P,errors:_.value}}function w(){m.value.forEach(A=>A.reset()),o.value=null}function E(){m.value.forEach(A=>A.resetValidation()),_.value=[],o.value=null}return Ke(m,()=>{let A=0,P=0;const L=[];for(const D of m.value)D.isValid===!1?(P++,L.push({id:D.id,errorMessages:D.errorMessages})):D.isValid===!0&&A++;_.value=L,o.value=P>0?!1:A===m.value.length?!0:null},{deep:!0}),Wi(n2,{register:A=>{let{id:P,validate:L,reset:D,resetValidation:N}=A;m.value.some(Z=>Z.id===P)&&Pc(`Duplicate input name "${P}"`),m.value.push({id:P,validate:L,reset:D,resetValidation:N,isValid:null,errorMessages:[]})},unregister:A=>{m.value=m.value.filter(P=>P.id!==A)},update:(A,P,L)=>{const D=m.value.find(N=>N.id===A);!D||(D.isValid=P,D.errorMessages=L)},isDisabled:a,isReadonly:c,isValidating:d,items:m,validateOn:Et(e,"validateOn")}),{errors:_,isDisabled:a,isReadonly:c,isValidating:d,items:m,validate:s,reset:w,resetValidation:E}}function MR(){return cn(n2,null)}const Zg=Ln({focused:Boolean},"focus");function qc(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ba();const a=Tn(e,"focused"),c=ie(()=>({[`${o}--focused`]:a.value}));function d(){a.value=!0}function m(){a.value=!1}return{focusClasses:c,isFocused:a,focus:d,blur:m}}const i2=Ln({disabled:Boolean,error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:Boolean,rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...Zg()},"validation");function r2(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ba(),a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Gr();const c=Tn(e,"modelValue"),d=ie(()=>e.validationValue===void 0?c.value:e.validationValue),m=MR(),_=He([]),s=He(!0),w=ie(()=>!!(Ro(c.value===""?null:c.value).length||Ro(d.value===""?null:d.value).length)),E=ie(()=>!!(e.disabled||m!=null&&m.isDisabled.value)),A=ie(()=>!!(e.readonly||m!=null&&m.isReadonly.value)),P=ie(()=>e.errorMessages.length?Ro(e.errorMessages):_.value),L=ie(()=>e.error||P.value.length?!1:e.rules.length&&s.value?null:!0),D=He(!1),N=ie(()=>({[`${o}--error`]:L.value===!1,[`${o}--dirty`]:w.value,[`${o}--disabled`]:E.value,[`${o}--readonly`]:A.value})),Z=ie(()=>{var Se;return(Se=e.name)!=null?Se:pi(a)});Rg(()=>{m==null||m.register({id:Z.value,validate:K,reset:ne,resetValidation:ce})}),Ai(()=>{m==null||m.unregister(Z.value)});const de=ie(()=>e.validateOn||(m==null?void 0:m.validateOn.value)||"input");zn(()=>m==null?void 0:m.update(Z.value,L.value,P.value)),Lf(()=>de.value==="input",()=>{Ke(d,()=>{if(d.value!=null)K();else if(e.focused){const Se=Ke(()=>e.focused,Y=>{Y||K(),Se()})}})}),Lf(()=>de.value==="blur",()=>{Ke(()=>e.focused,Se=>{Se||K()})}),Ke(L,()=>{m==null||m.update(Z.value,L.value,P.value)});function ne(){ce(),c.value=null}function ce(){s.value=!0,_.value=[]}async function K(){const Se=[];D.value=!0;for(const Y of e.rules){if(Se.length>=(e.maxErrors||1))break;const fe=await(typeof Y=="function"?Y:()=>Y)(d.value);if(fe!==!0){if(typeof fe!="string"){console.warn(`${fe} is not a valid value. Rule functions must return boolean true or a string.`);continue}Se.push(fe)}}return _.value=Se,D.value=!1,s.value=!1,_.value}return{errorMessages:P,isDirty:w,isDisabled:E,isReadonly:A,isPristine:s,isValid:L,isValidating:D,reset:ne,resetValidation:ce,validate:K,validationClasses:N}}function o2(e){const{t:o}=us();function a(c){var w;let{name:d}=c;const m={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[d],_=e[`onClick:${d}`],s=_&&m?o(`$vuetify.input.${m}`,(w=e.label)!=null?w:""):void 0;return F(Ni,{icon:e[`${d}Icon`],"aria-label":s,onClick:_},null)}return{InputIcon:a}}const Ta=Ln({id:String,appendIcon:mn,prependIcon:mn,hideDetails:[Boolean,String],messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:e=>["horizontal","vertical"].includes(e)},"onClick:prepend":vf,"onClick:append":vf,...vr(),...i2()},"VInput"),Us=Di()({name:"VInput",props:{...Ta()},emits:{"update:modelValue":e=>!0},setup(e,o){let{attrs:a,slots:c,emit:d}=o;const{densityClasses:m}=qr(e),{InputIcon:_}=o2(e),s=Gr(),w=ie(()=>e.id||`input-${s}`),{errorMessages:E,isDirty:A,isDisabled:P,isReadonly:L,isPristine:D,isValid:N,isValidating:Z,reset:de,resetValidation:ne,validate:ce,validationClasses:K}=r2(e,"v-input",w),Se=ie(()=>({id:w,isDirty:A,isDisabled:P,isReadonly:L,isPristine:D,isValid:N,isValidating:Z,reset:de,resetValidation:ne,validate:ce}));return Mt(()=>{var Y,_e,fe,ve,Ee;const be=!!(c.prepend||e.prependIcon),Re=!!(c.append||e.appendIcon),ze=!!((Y=e.messages)!=null&&Y.length||E.value.length),Je=!e.hideDetails||e.hideDetails==="auto"&&(ze||!!c.details);return F("div",{class:["v-input",`v-input--${e.direction}`,m.value,K.value]},[be&&F("div",{key:"prepend",class:"v-input__prepend"},[(_e=c.prepend)==null?void 0:_e.call(c,Se.value),e.prependIcon&&F(_,{key:"prepend-icon",name:"prepend"},null)]),c.default&&F("div",{class:"v-input__control"},[(fe=c.default)==null?void 0:fe.call(c,Se.value)]),Re&&F("div",{key:"append",class:"v-input__append"},[e.appendIcon&&F(_,{key:"append-icon",name:"append"},null),(ve=c.append)==null?void 0:ve.call(c,Se.value)]),Je&&F("div",{class:"v-input__details"},[F(t2,{active:ze,messages:E.value.length>0?E.value:e.messages},{message:c.message}),(Ee=c.details)==null?void 0:Ee.call(c,Se.value)])])}),{reset:de,resetValidation:ne,validate:ce}}});function Sl(e){const o=Object.keys(Us.props).filter(a=>!rT(a));return Fo(e,o)}const Th=zt({name:"VLabel",props:{text:String,clickable:Boolean,...Kn()},setup(e,o){let{slots:a}=o;return Mt(()=>{var c;return F("label",{class:["v-label",{"v-label--clickable":e.clickable}]},[e.text,(c=a.default)==null?void 0:c.call(a)])}),{}}});const s2=Symbol.for("vuetify:selection-control-group"),L0=Ln({color:String,disabled:Boolean,error:Boolean,id:String,inline:Boolean,falseIcon:mn,trueIcon:mn,ripple:{type:Boolean,default:!0},multiple:{type:Boolean,default:null},name:String,readonly:Boolean,modelValue:null,type:String,valueComparator:{type:Function,default:Gf},...Kn(),...vr()},"VSelectionControlGroup"),a2=zt({name:"VSelectionControlGroup",props:{defaultsTarget:{type:String,default:"VSelectionControl"},...L0()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=Tn(e,"modelValue"),d=Gr(),m=ie(()=>e.id||`v-selection-control-group-${d}`),_=ie(()=>e.name||m.value);return Wi(s2,{modelValue:c}),ar({[e.defaultsTarget]:{color:Et(e,"color"),disabled:Et(e,"disabled"),density:Et(e,"density"),error:Et(e,"error"),inline:Et(e,"inline"),modelValue:c,multiple:ie(()=>!!e.multiple||e.multiple==null&&Array.isArray(c.value)),name:_,falseIcon:Et(e,"falseIcon"),trueIcon:Et(e,"trueIcon"),readonly:Et(e,"readonly"),ripple:Et(e,"ripple"),type:Et(e,"type"),valueComparator:Et(e,"valueComparator")}}),Mt(()=>{var s;return F("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":e.inline}],"aria-labelled-by":e.type==="radio"?m.value:void 0,role:e.type==="radio"?"radiogroup":void 0},[(s=a.default)==null?void 0:s.call(a)])}),{}}}),Wg=Ln({label:String,trueValue:null,falseValue:null,value:null,...L0()},"VSelectionControl");function PR(e){const o=cn(s2,void 0),{densityClasses:a}=qr(e),c=Tn(e,"modelValue"),d=ie(()=>e.trueValue!==void 0?e.trueValue:e.value!==void 0?e.value:!0),m=ie(()=>e.falseValue!==void 0?e.falseValue:!1),_=ie(()=>!!e.multiple||e.multiple==null&&Array.isArray(c.value)),s=ie({get(){const P=o?o.modelValue.value:c.value;return _.value?P.some(L=>e.valueComparator(L,d.value)):e.valueComparator(P,d.value)},set(P){if(e.readonly)return;const L=P?d.value:m.value;let D=L;_.value&&(D=P?[...Ro(c.value),L]:Ro(c.value).filter(N=>!e.valueComparator(N,d.value))),o?o.modelValue.value=D:c.value=D}}),{textColorClasses:w,textColorStyles:E}=so(ie(()=>s.value&&!e.error&&!e.disabled?e.color:void 0)),A=ie(()=>s.value?e.trueIcon:e.falseIcon);return{group:o,densityClasses:a,trueValue:d,falseValue:m,model:s,textColorClasses:w,textColorStyles:E,icon:A}}const Zf=Di()({name:"VSelectionControl",directives:{Ripple:wl},inheritAttrs:!1,props:Wg(),emits:{"update:modelValue":e=>!0},setup(e,o){let{attrs:a,slots:c}=o;const{densityClasses:d,icon:m,model:_,textColorClasses:s,textColorStyles:w,trueValue:E}=PR(e),A=Gr(),P=ie(()=>e.id||`input-${A}`),L=He(!1),D=He(!1),N=He();function Z(ce){L.value=!0,(!fy||fy&&ce.target.matches(":focus-visible"))&&(D.value=!0)}function de(){L.value=!1,D.value=!1}function ne(ce){_.value=ce.target.checked}return Mt(()=>{var ce,K;const Se=c.label?c.label({label:e.label,props:{for:P.value}}):e.label,[Y,_e]=Fc(a);return F("div",tn({class:["v-selection-control",{"v-selection-control--dirty":_.value,"v-selection-control--disabled":e.disabled,"v-selection-control--error":e.error,"v-selection-control--focused":L.value,"v-selection-control--focus-visible":D.value,"v-selection-control--inline":e.inline},d.value]},Y),[F("div",{class:["v-selection-control__wrapper",s.value],style:w.value},[(ce=c.default)==null?void 0:ce.call(c),Yi(F("div",{class:["v-selection-control__input"]},[m.value&&F(Ni,{key:"icon",icon:m.value},null),F("input",tn({ref:N,checked:_.value,disabled:e.disabled,id:P.value,onBlur:de,onFocus:Z,onInput:ne,"aria-readonly":e.readonly,type:e.type,value:E.value,name:e.name,"aria-checked":e.type==="checkbox"?_.value:void 0},_e),null),(K=c.input)==null?void 0:K.call(c,{model:_,textColorClasses:s,textColorStyles:w,props:{onFocus:Z,onBlur:de,id:P.value}})]),[[go("ripple"),e.ripple&&[!e.disabled&&!e.readonly,null,["center","circle"]]]])]),Se&&F(Th,{for:P.value,clickable:!0},{default:()=>[Se]})])}),{isFocused:L,input:N}}});function l2(e){return Fo(e,Object.keys(Zf.props))}const c2=Ln({indeterminate:Boolean,indeterminateIcon:{type:mn,default:"$checkboxIndeterminate"},...Wg({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),Ch=zt({name:"VCheckboxBtn",props:c2(),emits:{"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,o){let{slots:a}=o;const c=Tn(e,"indeterminate"),d=Tn(e,"modelValue");function m(w){c.value&&(c.value=!1)}const _=ie(()=>e.indeterminate?e.indeterminateIcon:e.falseIcon),s=ie(()=>e.indeterminate?e.indeterminateIcon:e.trueIcon);return Mt(()=>F(Zf,tn(e,{modelValue:d.value,"onUpdate:modelValue":[w=>d.value=w,m],class:"v-checkbox-btn",type:"checkbox",inline:!0,falseIcon:_.value,trueIcon:s.value,"aria-checked":e.indeterminate?"mixed":void 0}),a)),{}}});function zR(e){return Fo(e,Object.keys(Ch.props))}const LR=zt({name:"VCheckbox",inheritAttrs:!1,props:{...Ta(),...c2()},emits:{"update:focused":e=>!0},setup(e,o){let{attrs:a,slots:c}=o;const{isFocused:d,focus:m,blur:_}=qc(e),s=Gr(),w=ie(()=>e.id||`checkbox-${s}`);return Mt(()=>{const[E,A]=Fc(a),[P,L]=Sl(e),[D,N]=zR(e);return F(Us,tn({class:"v-checkbox"},E,P,{id:w.value,focused:d.value}),{...c,default:Z=>{let{id:de,isDisabled:ne,isReadonly:ce}=Z;return F(Ch,tn(D,{id:de.value,disabled:ne.value,readonly:ce.value},A,{onFocus:m,onBlur:_}),c)}})}),{}}});const RR=Ln({start:Boolean,end:Boolean,icon:mn,image:String,...vr(),...Bi(),...Sa(),...Cn(),...No({variant:"flat"})},"VAvatar"),yl=zt({name:"VAvatar",props:RR(),setup(e,o){let{slots:a}=o;const{colorClasses:c,colorStyles:d,variantClasses:m}=$c(e),{densityClasses:_}=qr(e),{roundedClasses:s}=tr(e),{sizeClasses:w,sizeStyles:E}=bh(e);return Mt(()=>{var A;return F(e.tag,{class:["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},c.value,_.value,s.value,w.value,m.value],style:[d.value,E.value]},{default:()=>[e.image?F(gh,{key:"image",src:e.image,alt:""},null):e.icon?F(Ni,{key:"icon",icon:e.icon},null):(A=a.default)==null?void 0:A.call(a),Vc(!1,"v-avatar")]})}),{}}});const u2=Symbol.for("vuetify:v-chip-group"),DR=zt({name:"VChipGroup",props:{column:Boolean,filter:Boolean,valueComparator:{type:Function,default:Gf},...yh({selectedClass:"v-chip--selected"}),...Cn(),...Kn(),...No({variant:"tonal"})},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{themeClasses:c}=Si(e),{isSelected:d,select:m,next:_,prev:s,selected:w}=Uc(e,u2);return ar({VChip:{color:Et(e,"color"),filter:Et(e,"filter"),variant:Et(e,"variant")}}),Mt(()=>{var E;return F(e.tag,{class:["v-chip-group",{"v-chip-group--column":e.column},c.value]},{default:()=>[(E=a.default)==null?void 0:E.call(a,{isSelected:d,select:m,next:_,prev:s,selected:w.value})]})}),{}}}),Wf=zt({name:"VChip",directives:{Ripple:wl},props:{activeClass:String,appendAvatar:String,appendIcon:mn,closable:Boolean,closeIcon:{type:mn,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:Boolean,pill:Boolean,prependAvatar:String,prependIcon:mn,ripple:{type:Boolean,default:!0},text:String,modelValue:{type:Boolean,default:!0},..._o(),...vr(),...cr(),...Nc(),...Bi(),...Eh(),...Sa(),...Cn({tag:"span"}),...Kn(),...No({variant:"tonal"})},emits:{"click:close":e=>!0,"update:active":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0},setup(e,o){let{attrs:a,emit:c,slots:d}=o;const{borderClasses:m}=$o(e),{colorClasses:_,colorStyles:s,variantClasses:w}=$c(e),{densityClasses:E}=qr(e),{elevationClasses:A}=zr(e),{roundedClasses:P}=tr(e),{sizeClasses:L}=bh(e),{themeClasses:D}=Si(e),N=Tn(e,"modelValue"),Z=xh(e,u2,!1),de=qf(e,a);function ne(ce){N.value=!1,c("click:close",ce)}return()=>{var ce;const K=de.isLink.value?"a":e.tag,Se=!!(d.append||e.appendIcon||e.appendAvatar),Y=!!(d.close||e.closable),_e=!!(d.filter||e.filter)&&Z,fe=!!(d.prepend||e.prependIcon||e.prependAvatar),ve=!Z||Z.isSelected.value,Ee=!e.disabled&&(!!Z||de.isClickable.value||e.link),be=e.link?e.link:Z==null?void 0:Z.toggle;return N.value&&Yi(F(K,{class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":Ee,"v-chip--filter":_e,"v-chip--pill":e.pill},D.value,m.value,ve?_.value:void 0,E.value,A.value,P.value,L.value,w.value,Z==null?void 0:Z.selectedClass.value],style:[ve?s.value:void 0],disabled:e.disabled||void 0,draggable:e.draggable,href:de.href.value,onClick:Ee&&be},{default:()=>{var Re;return[Vc(Ee,"v-chip"),_e&&F(Ci,{key:"filter",defaults:{VIcon:{icon:e.filterIcon}}},{default:()=>[F(w0,null,{default:()=>[Yi(F("div",{class:"v-chip__filter"},[d.filter?d.filter():F(Ni,null,null)]),[[Ns,Z.isSelected.value]])]})]}),fe&&F(Ci,{key:"prepend",defaults:{VAvatar:{image:e.prependAvatar},VIcon:{icon:e.prependIcon}}},{default:()=>[d.prepend?F("div",{class:"v-chip__prepend"},[d.prepend()]):e.prependAvatar?F(yl,{start:!0},null):e.prependIcon?F(Ni,{start:!0},null):void 0]}),(Re=(ce=d.default)==null?void 0:ce.call(d,{isSelected:Z==null?void 0:Z.isSelected.value,selectedClass:Z==null?void 0:Z.selectedClass.value,select:Z==null?void 0:Z.select,toggle:Z==null?void 0:Z.toggle,value:Z==null?void 0:Z.value.value,disabled:e.disabled}))!=null?Re:e.text,Se&&F(Ci,{key:"append",defaults:{VAvatar:{image:e.appendAvatar},VIcon:{icon:e.appendIcon}}},{default:()=>[d.append?F("div",{class:"v-chip__append"},[d.append()]):e.appendAvatar?F(yl,{end:!0},null):e.appendIcon?F(Ni,{end:!0},null):void 0]}),Y&&F(Ci,{key:"close",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},{default:()=>[F("div",{class:"v-chip__close",onClick:ne},[d.close?d.close():F(Ni,null,null)])]})]}}),[[go("ripple"),Ee&&e.ripple,null]])}}});const h2=zt({name:"VDivider",props:{color:String,inset:Boolean,length:[Number,String],thickness:[Number,String],vertical:Boolean,...Kn()},setup(e,o){let{attrs:a}=o;const{themeClasses:c}=Si(e),{backgroundColorClasses:d,backgroundColorStyles:m}=er(Et(e,"color")),_=ie(()=>{const s={};return e.length&&(s[e.vertical?"maxHeight":"maxWidth"]=Yt(e.length)),e.thickness&&(s[e.vertical?"borderRightWidth":"borderTopWidth"]=Yt(e.thickness)),s});return Mt(()=>F("hr",{class:[{"v-divider":!0,"v-divider--inset":e.inset,"v-divider--vertical":e.vertical},c.value,d.value],style:[_.value,m.value],"aria-orientation":!a.role||a.role==="separator"?e.vertical?"vertical":"horizontal":void 0,role:`${a.role||"separator"}`},null)),{}}}),yy=Symbol.for("vuetify:list");function d2(){const e=cn(yy,{hasPrepend:He(!1),updateHasPrepend:()=>null}),o={hasPrepend:He(!1),updateHasPrepend:a=>{a&&(o.hasPrepend.value=a)}};return Wi(yy,o),e}function f2(){return cn(yy,null)}const BR={open:e=>{let{id:o,value:a,opened:c,parents:d}=e;if(a){const m=new Set;m.add(o);let _=d.get(o);for(;_!=null;)m.add(_),_=d.get(_);return m}else return c.delete(o),c},select:()=>null},p2={open:e=>{let{id:o,value:a,opened:c,parents:d}=e;if(a){let m=d.get(o);for(c.add(o);m!=null&&m!==o;)c.add(m),m=d.get(m);return c}else c.delete(o);return c},select:()=>null},OR={open:p2.open,select:e=>{let{id:o,value:a,opened:c,parents:d}=e;if(!a)return c;const m=[];let _=d.get(o);for(;_!=null;)m.push(_),_=d.get(_);return new Set(m)}},R0=e=>{const o={select:a=>{let{id:c,value:d,selected:m}=a;if(e&&!d){const _=Array.from(m.entries()).reduce((s,w)=>{let[E,A]=w;return A==="on"?[...s,E]:s},[]);if(_.length===1&&_[0]===c)return m}return m.set(c,d?"on":"off"),m},in:(a,c,d)=>{let m=new Map;for(const _ of a||[])m=o.select({id:_,value:!0,selected:new Map(m),children:c,parents:d});return m},out:a=>{const c=[];for(const[d,m]of a.entries())m==="on"&&c.push(d);return c}};return o},m2=e=>{const o=R0(e);return{select:c=>{let{selected:d,id:m,..._}=c;const s=d.has(m)?new Map([[m,d.get(m)]]):new Map;return o.select({..._,id:m,selected:s})},in:(c,d,m)=>{let _=new Map;return c!=null&&c.length&&(_=o.in(c.slice(0,1),d,m)),_},out:(c,d,m)=>o.out(c,d,m)}},FR=e=>{const o=R0(e);return{select:c=>{let{id:d,selected:m,children:_,...s}=c;return _.has(d)?m:o.select({id:d,selected:m,children:_,...s})},in:o.in,out:o.out}},VR=e=>{const o=m2(e);return{select:c=>{let{id:d,selected:m,children:_,...s}=c;return _.has(d)?m:o.select({id:d,selected:m,children:_,...s})},in:o.in,out:o.out}},$R=e=>{const o={select:a=>{let{id:c,value:d,selected:m,children:_,parents:s}=a;const w=new Map(m),E=[c];for(;E.length;){const P=E.shift();m.set(P,d?"on":"off"),_.has(P)&&E.push(..._.get(P))}let A=s.get(c);for(;A;){const P=_.get(A),L=P.every(N=>m.get(N)==="on"),D=P.every(N=>!m.has(N)||m.get(N)==="off");m.set(A,L?"on":D?"off":"indeterminate"),A=s.get(A)}return e&&!d&&Array.from(m.entries()).reduce((L,D)=>{let[N,Z]=D;return Z==="on"?[...L,N]:L},[]).length===0?w:m},in:(a,c,d)=>{let m=new Map;for(const _ of a||[])m=o.select({id:_,value:!0,selected:new Map(m),children:c,parents:d});return m},out:(a,c)=>{const d=[];for(const[m,_]of a.entries())_==="on"&&!c.has(m)&&d.push(m);return d}};return o},Bf=Symbol.for("vuetify:nested"),g2={id:He(),root:{register:()=>null,unregister:()=>null,parents:He(new Map),children:He(new Map),open:()=>null,openOnSelect:()=>null,select:()=>null,opened:He(new Set),selected:He(new Map),selectedValues:He([])}},NR=Ln({selectStrategy:[String,Function],openStrategy:[String,Function],opened:Array,selected:Array,mandatory:Boolean},"nested"),UR=e=>{let o=!1;const a=He(new Map),c=He(new Map),d=Tn(e,"opened",e.opened,P=>new Set(P),P=>[...P.values()]),m=ie(()=>{if(typeof e.selectStrategy=="object")return e.selectStrategy;switch(e.selectStrategy){case"single-leaf":return VR(e.mandatory);case"leaf":return FR(e.mandatory);case"independent":return R0(e.mandatory);case"single-independent":return m2(e.mandatory);case"classic":default:return $R(e.mandatory)}}),_=ie(()=>{if(typeof e.openStrategy=="function")return e.openStrategy;switch(e.openStrategy){case"list":return OR;case"single":return BR;case"multiple":default:return p2}}),s=Tn(e,"selected",e.selected,P=>m.value.in(P,a.value,c.value),P=>m.value.out(P,a.value,c.value));Ai(()=>{o=!0});function w(P){const L=[];let D=P;for(;D!=null;)L.unshift(D),D=c.value.get(D);return L}const E=Pr("nested"),A={id:He(),root:{opened:d,selected:s,selectedValues:ie(()=>{const P=[];for(const[L,D]of s.value.entries())D==="on"&&P.push(L);return P}),register:(P,L,D)=>{L&&P!==L&&c.value.set(P,L),D&&a.value.set(P,[]),L!=null&&a.value.set(L,[...a.value.get(L)||[],P])},unregister:P=>{var D;if(o)return;a.value.delete(P);const L=c.value.get(P);if(L){const N=(D=a.value.get(L))!=null?D:[];a.value.set(L,N.filter(Z=>Z!==P))}c.value.delete(P),d.value.delete(P)},open:(P,L,D)=>{E.emit("click:open",{id:P,value:L,path:w(P),event:D});const N=_.value.open({id:P,value:L,opened:new Set(d.value),children:a.value,parents:c.value,event:D});N&&(d.value=N)},openOnSelect:(P,L,D)=>{const N=_.value.select({id:P,value:L,selected:new Map(s.value),opened:new Set(d.value),children:a.value,parents:c.value,event:D});N&&(d.value=N)},select:(P,L,D)=>{E.emit("click:select",{id:P,value:L,path:w(P),event:D});const N=m.value.select({id:P,value:L,selected:new Map(s.value),children:a.value,parents:c.value,event:D});N&&(s.value=N),A.root.openOnSelect(P,L,D)},children:a,parents:c}};return Wi(Bf,A),A.root},v2=(e,o)=>{const a=cn(Bf,g2),c=ie(()=>{var m;return(m=e.value)!=null?m:Symbol(Gr())}),d={...a,id:c,open:(m,_)=>a.root.open(c.value,m,_),openOnSelect:(m,_)=>a.root.openOnSelect(c.value,m,_),isOpen:ie(()=>a.root.opened.value.has(c.value)),parent:ie(()=>a.root.parents.value.get(c.value)),select:(m,_)=>a.root.select(c.value,m,_),isSelected:ie(()=>a.root.selected.value.get(c.value)==="on"),isIndeterminate:ie(()=>a.root.selected.value.get(c.value)==="indeterminate"),isLeaf:ie(()=>!a.root.children.value.get(c.value)),isGroupActivator:a.isGroupActivator};return!a.isGroupActivator&&a.root.register(c.value,a.id.value,o),Ai(()=>{!a.isGroupActivator&&a.root.unregister(c.value)}),o&&Wi(Bf,d),d},jR=()=>{const e=cn(Bf,g2);Wi(Bf,{...e,isGroupActivator:!0})},GR=zt({name:"VListGroupActivator",setup(e,o){let{slots:a}=o;return jR(),()=>{var c;return(c=a.default)==null?void 0:c.call(a)}}}),qR=Ln({activeColor:String,color:String,collapseIcon:{type:mn,default:"$collapse"},expandIcon:{type:mn,default:"$expand"},prependIcon:mn,appendIcon:mn,fluid:Boolean,subgroup:Boolean,value:null,...Cn()},"VListGroup"),D0=Di()({name:"VListGroup",props:{title:String,...qR()},setup(e,o){let{slots:a}=o;const{isOpen:c,open:d,id:m}=v2(Et(e,"value"),!0),_=ie(()=>`v-list-group--id-${String(m.value)}`),s=f2();function w(P){d(!c.value,P)}const E=ie(()=>({onClick:w,class:"v-list-group__header",id:_.value})),A=ie(()=>c.value?e.collapseIcon:e.expandIcon);return Mt(()=>{var P;return F(e.tag,{class:["v-list-group",{"v-list-group--prepend":s==null?void 0:s.hasPrepend.value,"v-list-group--fluid":e.fluid,"v-list-group--subgroup":e.subgroup}]},{default:()=>[a.activator&&F(Ci,{defaults:{VListItem:{active:c.value,activeColor:e.activeColor,color:e.color,prependIcon:e.prependIcon||e.subgroup&&A.value,appendIcon:e.appendIcon||!e.subgroup&&A.value,title:e.title,value:e.value}}},{default:()=>[F(GR,null,{default:()=>[a.activator({props:E.value,isOpen:c})]})]}),F(Ng,null,{default:()=>[Yi(F("div",{class:"v-list-group__items",role:"group","aria-labelledby":_.value},[(P=a.default)==null?void 0:P.call(a)]),[[Ns,c.value]])]})]})}),{}}});function ZR(e){return Fo(e,Object.keys(D0.props))}const _2=Vo("v-list-item-subtitle"),B0=Vo("v-list-item-title"),Hi=Di()({name:"VListItem",directives:{Ripple:wl},props:{active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:mn,disabled:Boolean,lines:String,link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:mn,subtitle:[String,Number,Boolean],title:[String,Number,Boolean],value:null,..._o(),...vr(),...ls(),...cr(),...Bi(),...Eh(),...Cn(),...Kn(),...No({variant:"text"})},emits:{click:e=>!0},setup(e,o){let{attrs:a,slots:c,emit:d}=o;const m=qf(e,a),_=ie(()=>{var Pe;return(Pe=e.value)!=null?Pe:m.href.value}),{select:s,isSelected:w,isIndeterminate:E,isGroupActivator:A,root:P,parent:L,openOnSelect:D}=v2(_,!1),N=f2(),Z=ie(()=>{var Pe;return e.active!==!1&&(e.active||((Pe=m.isActive)==null?void 0:Pe.value)||w.value)}),de=ie(()=>e.link!==!1&&m.isLink.value),ne=ie(()=>!e.disabled&&e.link!==!1&&(e.link||m.isClickable.value||e.value!=null&&!!N)),ce=ie(()=>e.rounded||e.nav),K=ie(()=>{var Pe;return{color:Z.value&&(Pe=e.activeColor)!=null?Pe:e.color,variant:e.variant}});Ke(()=>{var Pe;return(Pe=m.isActive)==null?void 0:Pe.value},Pe=>{Pe&&L.value!=null&&P.open(L.value,!0),Pe&&D(Pe)},{immediate:!0});const{themeClasses:Se}=Si(e),{borderClasses:Y}=$o(e),{colorClasses:_e,colorStyles:fe,variantClasses:ve}=$c(K),{densityClasses:Ee}=qr(e),{dimensionStyles:be}=cs(e),{elevationClasses:Re}=zr(e),{roundedClasses:ze}=tr(ce),Je=ie(()=>e.lines?`v-list-item--${e.lines}-line`:void 0),ct=ie(()=>({isActive:Z.value,select:s,isSelected:w.value,isIndeterminate:E.value}));function nt(Pe){var at;d("click",Pe),!(A||!ne.value)&&((at=m.navigate)==null||at.call(m,Pe),e.value!=null&&s(!w.value,Pe))}function ft(Pe){(Pe.key==="Enter"||Pe.key===" ")&&(Pe.preventDefault(),nt(Pe))}return Mt(()=>{var Pe,at,Gt,pt,Lt;const qt=de.value?"a":e.tag,Bn=!N||w.value||Z.value,kt=c.title||e.title,Qe=c.subtitle||e.subtitle,bt=!!(c.append||e.appendAvatar||e.appendIcon),Tt=!!(c.prepend||e.prependAvatar||e.prependIcon);return N==null||N.updateHasPrepend(Tt),Yi(F(qt,{class:["v-list-item",{"v-list-item--active":Z.value,"v-list-item--disabled":e.disabled,"v-list-item--link":ne.value,"v-list-item--nav":e.nav,"v-list-item--prepend":!Tt&&(N==null?void 0:N.hasPrepend.value),[`${e.activeClass}`]:e.activeClass&&Z.value},Se.value,Y.value,Bn?_e.value:void 0,Ee.value,Re.value,Je.value,ze.value,ve.value],style:[Bn?fe.value:void 0,be.value],href:m.href.value,tabindex:ne.value?0:void 0,onClick:nt,onKeydown:ne.value&&!de.value&&ft},{default:()=>[Vc(ne.value||Z.value,"v-list-item"),Tt&&F(Ci,{key:"prepend",defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon},VListItemAction:{start:!0}}},{default:()=>[F("div",{class:"v-list-item__prepend"},[e.prependAvatar&&F(yl,{key:"prepend-avatar"},null),e.prependIcon&&F(Ni,{key:"prepend-icon"},null),(Pe=c.prepend)==null?void 0:Pe.call(c,ct.value)])]}),F("div",{class:"v-list-item__content"},[kt&&F(B0,{key:"title"},{default:()=>{var Ut;return[(Ut=(at=c.title)==null?void 0:at.call(c,{title:e.title}))!=null?Ut:e.title]}}),Qe&&F(_2,{key:"subtitle"},{default:()=>{var Ut;return[(Ut=(Gt=c.subtitle)==null?void 0:Gt.call(c,{subtitle:e.subtitle}))!=null?Ut:e.subtitle]}}),(pt=c.default)==null?void 0:pt.call(c,ct.value)]),bt&&F(Ci,{key:"append",defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon},VListItemAction:{end:!0}}},{default:()=>[F("div",{class:"v-list-item__append"},[(Lt=c.append)==null?void 0:Lt.call(c,ct.value),e.appendIcon&&F(Ni,{key:"append-icon"},null),e.appendAvatar&&F(yl,{key:"append-avatar"},null)])]})]}),[[go("ripple"),ne.value]])}),{}}}),y2=zt({name:"VListSubheader",props:{color:String,inset:Boolean,sticky:Boolean,title:String,...Cn()},setup(e,o){let{slots:a}=o;const{textColorClasses:c,textColorStyles:d}=so(Et(e,"color"));return Mt(()=>{var m;const _=!!(a.default||e.title);return F(e.tag,{class:["v-list-subheader",{"v-list-subheader--inset":e.inset,"v-list-subheader--sticky":e.sticky},c.value],style:{textColorStyles:d}},{default:()=>{var s;return[_&&F("div",{class:"v-list-subheader__text"},[(s=(m=a.default)==null?void 0:m.call(a))!=null?s:e.title])]}})}),{}}}),x2=Di()({name:"VListChildren",props:{items:Array},setup(e,o){let{slots:a}=o;return d2(),()=>{var m;var c,d;return(m=(c=a.default)==null?void 0:c.call(a))!=null?m:(d=e.items)==null?void 0:d.map(_=>{var de,ne;let{children:s,props:w,type:E,raw:A}=_;if(E==="divider"){var P;return(de=(P=a.divider)==null?void 0:P.call(a,{props:w}))!=null?de:F(h2,w,null)}if(E==="subheader"){var L;return(ne=(L=a.subheader)==null?void 0:L.call(a,{props:w}))!=null?ne:F(y2,w,{default:a.subheader})}const D={subtitle:a.subtitle?ce=>{var K;return(K=a.subtitle)==null?void 0:K.call(a,{...ce,item:A})}:void 0,prepend:a.prepend?ce=>{var K;return(K=a.prepend)==null?void 0:K.call(a,{...ce,item:A})}:void 0,append:a.append?ce=>{var K;return(K=a.append)==null?void 0:K.call(a,{...ce,item:A})}:void 0,default:a.default?ce=>{var K;return(K=a.default)==null?void 0:K.call(a,{...ce,item:A})}:void 0,title:a.title?ce=>{var K;return(K=a.title)==null?void 0:K.call(a,{...ce,item:A})}:void 0},[N,Z]=ZR(w);return s?F(D0,tn({value:w==null?void 0:w.value},N),{activator:ce=>{let{props:K}=ce;return a.header?a.header({...w,...K}):F(Hi,tn(w,K),D)},default:()=>F(x2,{items:s},a)}):a.item?a.item(w):F(Hi,w,D)})}}}),b2=Ln({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},returnObject:Boolean},"item");function ih(e,o){var s;const a=Bs(o,e.itemTitle,o),c=e.returnObject?o:Bs(o,e.itemValue,a),d=Bs(o,e.itemChildren),m=e.itemProps===!0?typeof o=="object"&&o!=null&&!Array.isArray(o)?"children"in o?Fo(o,["children"])[1]:o:void 0:Bs(o,e.itemProps),_={title:a,value:c,...m};return{title:String((s=_.title)!=null?s:""),value:_.value,props:_,children:Array.isArray(d)?w2(e,d):void 0,raw:o}}function w2(e,o){const a=[];for(const c of o)a.push(ih(e,c));return a}function O0(e){const o=ie(()=>w2(e,e.items));function a(d){return d.map(m=>ih(e,m))}function c(d){return d.map(m=>{let{props:_}=m;return _.value})}return{items:o,transformIn:a,transformOut:c}}function WR(e,o){const a=Bs(o,e.itemType,"item"),c=typeof o=="string"?o:Bs(o,e.itemTitle),d=Bs(o,e.itemValue,void 0),m=Bs(o,e.itemChildren),_=e.itemProps===!0?Fo(o,["children"])[1]:Bs(o,e.itemProps),s={title:c,value:d,..._};return{type:a,title:s.title,value:s.value,props:s,children:a==="item"&&m?S2(e,m):void 0,raw:o}}function S2(e,o){const a=[];for(const c of o)a.push(WR(e,c));return a}function HR(e){return{items:ie(()=>S2(e,e.items))}}const js=Di()({name:"VList",props:{activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,lines:{type:[Boolean,String],default:"one"},nav:Boolean,...NR({selectStrategy:"single-leaf",openStrategy:"list"}),..._o(),...vr(),...ls(),...cr(),itemType:{type:String,default:"type"},...b2(),...Bi(),...Cn(),...Kn(),...No({variant:"text"})},emits:{"update:selected":e=>!0,"update:opened":e=>!0,"click:open":e=>!0,"click:select":e=>!0},setup(e,o){let{slots:a}=o;const{items:c}=HR(e),{themeClasses:d}=Si(e),{backgroundColorClasses:m,backgroundColorStyles:_}=er(Et(e,"bgColor")),{borderClasses:s}=$o(e),{densityClasses:w}=qr(e),{dimensionStyles:E}=cs(e),{elevationClasses:A}=zr(e),{roundedClasses:P}=tr(e),{open:L,select:D}=UR(e),N=ie(()=>e.lines?`v-list--${e.lines}-line`:void 0),Z=Et(e,"activeColor"),de=Et(e,"color");d2(),ar({VListGroup:{activeColor:Z,color:de},VListItem:{activeClass:Et(e,"activeClass"),activeColor:Z,color:de,density:Et(e,"density"),disabled:Et(e,"disabled"),lines:Et(e,"lines"),nav:Et(e,"nav"),variant:Et(e,"variant")}});const ne=He(!1),ce=He();function K(ve){ne.value=!0}function Se(ve){ne.value=!1}function Y(ve){var Ee;!ne.value&&!(ve.relatedTarget&&(Ee=ce.value)!=null&&Ee.contains(ve.relatedTarget))&&fe()}function _e(ve){!ce.value||(ve.key==="ArrowDown"?fe("next"):ve.key==="ArrowUp"?fe("prev"):ve.key==="Home"?fe("first"):ve.key==="End"&&fe("last"))}function fe(ve){if(!ce.value)return;const Ee=[...ce.value.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')].filter(ct=>!ct.hasAttribute("disabled")),be=Ee.indexOf(document.activeElement);if(ve)if(ve==="first"){var ze;(ze=Ee[0])==null||ze.focus()}else if(ve==="last"){var Je;(Je=Ee.at(-1))==null||Je.focus()}else{let ct,nt=be;const ft=ve==="next"?1:-1;do nt+=ft,ct=Ee[nt];while((!ct||ct.offsetParent==null)&&nt<Ee.length&&nt>=0);ct?ct.focus():fe(ve==="next"?"first":"last")}else{var Re;(Re=Ee[0])==null||Re.focus()}}return Mt(()=>F(e.tag,{ref:ce,class:["v-list",{"v-list--disabled":e.disabled,"v-list--nav":e.nav},d.value,m.value,s.value,w.value,A.value,N.value,P.value],style:[_.value,E.value],role:"listbox","aria-activedescendant":void 0,onFocusin:K,onFocusout:Se,onFocus:Y,onKeydown:_e},{default:()=>[F(x2,{items:c.value},a)]})),{open:L,select:D,focus:fe}}}),XR=Vo("v-list-img"),YR=zt({name:"VListItemAction",props:{start:Boolean,end:Boolean,...Cn()},setup(e,o){let{slots:a}=o;return Mt(()=>F(e.tag,{class:["v-list-item-action",{"v-list-item-action--start":e.start,"v-list-item-action--end":e.end}]},a)),{}}}),KR=zt({name:"VListItemMedia",props:{start:Boolean,end:Boolean,...Cn()},setup(e,o){let{slots:a}=o;return Mt(()=>F(e.tag,{class:["v-list-item-media",{"v-list-item-media--start":e.start,"v-list-item-media--end":e.end}]},a)),{}}});const E2=Ln({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function T2(e,o){const a={},c=d=>()=>{if(!Li)return Promise.resolve(!0);const m=d==="openDelay";return a.closeDelay&&window.clearTimeout(a.closeDelay),delete a.closeDelay,a.openDelay&&window.clearTimeout(a.openDelay),delete a.openDelay,new Promise(_=>{var w;const s=parseInt((w=e[d])!=null?w:0,10);a[d]=window.setTimeout(()=>{o==null||o(m),_(m)},s)})};return{runCloseDelay:c("closeDelay"),runOpenDelay:c("openDelay")}}const xy=Symbol.for("vuetify:v-menu"),JR=Ln({activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...E2()},"VOverlay/useActivator");function QR(e,o){let{isActive:a,isTop:c}=o;const d=He();let m=!1,_=!1,s=!0;const w=ie(()=>e.openOnFocus||e.openOnFocus==null&&e.openOnHover),E=ie(()=>e.openOnClick||e.openOnClick==null&&!e.openOnHover&&!w.value),{runOpenDelay:A,runCloseDelay:P}=T2(e,K=>{K===(e.openOnHover&&m||w.value&&_)&&!(e.openOnHover&&a.value&&!c.value)&&(a.value!==K&&(s=!0),a.value=K)}),L={click:K=>{K.stopPropagation(),d.value=K.currentTarget||K.target,a.value=!a.value},mouseenter:K=>{m=!0,d.value=K.currentTarget||K.target,A()},mouseleave:K=>{m=!1,P()},focus:K=>{fy&&!K.target.matches(":focus-visible")||(_=!0,K.stopPropagation(),d.value=K.currentTarget||K.target,A())},blur:K=>{_=!1,K.stopPropagation(),P()}},D=ie(()=>{const K={};return E.value&&(K.click=L.click),e.openOnHover&&(K.mouseenter=L.mouseenter,K.mouseleave=L.mouseleave),w.value&&(K.focus=L.focus,K.blur=L.blur),K}),N=ie(()=>{const K={};if(e.openOnHover&&(K.mouseenter=()=>{m=!0,A()},K.mouseleave=()=>{m=!1,P()}),e.closeOnContentClick){const Se=cn(xy,null);K.click=()=>{a.value=!1,Se==null||Se.closeParents()}}return K}),Z=ie(()=>{const K={};return e.openOnHover&&(K.mouseenter=()=>{s&&(m=!0,s=!1,A())},K.mouseleave=()=>{m=!1,P()}),K});Ke(c,K=>{K&&(e.openOnHover&&!m&&(!w.value||!_)||w.value&&!_&&(!e.openOnHover||!m))&&(a.value=!1)});const de=He();Vs(()=>{!de.value||Xi(()=>{const K=de.value;d.value=rz(K)?K.$el:K})});const ne=Pr("useActivator");let ce;return Ke(()=>!!e.activator,K=>{K&&Li?(ce=Uf(),ce.run(()=>{eD(e,ne,{activatorEl:d,activatorEvents:D})})):ce&&ce.stop()},{flush:"post",immediate:!0}),{activatorEl:d,activatorRef:de,activatorEvents:D,contentEvents:N,scrimEvents:Z}}function eD(e,o,a){let{activatorEl:c,activatorEvents:d}=a;Ke(()=>e.activator,(w,E)=>{if(E&&w!==E){const A=s(E);A&&_(A)}w&&Xi(()=>m())},{immediate:!0}),Ke(()=>e.activatorProps,()=>{m()}),Dc(()=>{_()});function m(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s(),E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;!w||(Object.entries(d.value).forEach(A=>{let[P,L]=A;w.addEventListener(P,L)}),Object.keys(E).forEach(A=>{E[A]==null?w.removeAttribute(A):w.setAttribute(A,E[A])}))}function _(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s(),E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;!w||(Object.entries(d.value).forEach(A=>{let[P,L]=A;w.removeEventListener(P,L)}),Object.keys(E).forEach(A=>{w.removeAttribute(A)}))}function s(){var w;let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.activator,A;if(E)if(E==="parent"){var P,L;let D=o==null||(P=o.proxy)==null||(L=P.$el)==null?void 0:L.parentNode;for(;D.hasAttribute("data-no-activator");)D=D.parentNode;A=D}else typeof E=="string"?A=document.querySelector(E):"$el"in E?A=E.$el:A=E;return c.value=((w=A)==null?void 0:w.nodeType)===Node.ELEMENT_NODE?A:null,c.value}}const Hg=Ln({eager:Boolean},"lazy");function F0(e,o){const a=He(!1),c=ie(()=>a.value||e.eager||o.value);Ke(o,()=>a.value=!0);function d(){e.eager||(a.value=!1)}return{isBooted:a,hasContent:c,onAfterLeave:d}}function D_(e,o){return{x:e.x+o.x,y:e.y+o.y}}function tD(e,o){return{x:e.x-o.x,y:e.y-o.y}}function $w(e,o){if(e.side==="top"||e.side==="bottom"){const{side:a,align:c}=e,d=c==="left"?0:c==="center"?o.width/2:c==="right"?o.width:c,m=a==="top"?0:a==="bottom"?o.height:a;return D_({x:d,y:m},o)}else if(e.side==="left"||e.side==="right"){const{side:a,align:c}=e,d=a==="left"?0:a==="right"?o.width:a,m=c==="top"?0:c==="center"?o.height/2:c==="bottom"?o.height:c;return D_({x:d,y:m},o)}return D_({x:o.width/2,y:o.height/2},o)}const C2={static:rD,connected:sD},nD=Ln({locationStrategy:{type:[String,Function],default:"static",validator:e=>typeof e=="function"||e in C2},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay/locationStrategies");function iD(e,o){const a=He({}),c=He();let d;Vs(async()=>{var _;(_=d)==null||_.stop(),c.value=void 0,Li&&o.isActive.value&&e.locationStrategy&&(d=Uf(),await Xi(),d.run(()=>{if(typeof e.locationStrategy=="function"){var s;c.value=(s=e.locationStrategy(o,e,a))==null?void 0:s.updateLocation}else{var w;c.value=(w=C2[e.locationStrategy](o,e,a))==null?void 0:w.updateLocation}}))}),Li&&window.addEventListener("resize",m,{passive:!0}),Dc(()=>{var _;Li&&window.removeEventListener("resize",m),c.value=void 0,(_=d)==null||_.stop()});function m(_){var s;(s=c.value)==null||s.call(c,_)}return{contentStyles:a,updateLocation:c}}function rD(){}function oD(e){const o=g0(e);return o.x-=parseFloat(e.style.left||0),o.y-=parseFloat(e.style.top||0),o}function sD(e,o,a){const c=zz(e.activatorEl.value);c&&Object.assign(a.value,{position:"fixed"});const{preferredAnchor:d,preferredOrigin:m}=m0(()=>{const D=cy(o.location,e.isRtl.value),N=o.origin==="overlap"?D:o.origin==="auto"?k_(D):cy(o.origin,e.isRtl.value);return D.side===N.side&&D.align===M_(N).align?{preferredAnchor:vw(D),preferredOrigin:vw(N)}:{preferredAnchor:D,preferredOrigin:N}}),[_,s,w,E]=["minWidth","minHeight","maxWidth","maxHeight"].map(D=>ie(()=>{const N=parseFloat(o[D]);return isNaN(N)?1/0:N})),A=ie(()=>{if(Array.isArray(o.offset))return o.offset;if(typeof o.offset=="string"){const D=o.offset.split(" ").map(parseFloat);return D.length<2&&D.push(0),D}return typeof o.offset=="number"?[o.offset,0]:[0,0]});let P=!1;if(Li){const D=new ResizeObserver(()=>{P&&L()});Ke([e.activatorEl,e.contentEl],(N,Z)=>{let[de,ne]=N,[ce,K]=Z;ce&&D.unobserve(ce),de&&D.observe(de),K&&D.unobserve(K),ne&&D.observe(ne)},{immediate:!0}),Dc(()=>{D.disconnect()})}function L(){if(P=!1,requestAnimationFrame(()=>{requestAnimationFrame(()=>P=!0)}),!e.activatorEl.value||!e.contentEl.value)return;const D=e.activatorEl.value.getBoundingClientRect(),N=oD(e.contentEl.value),Z=mg(e.contentEl.value),de=12;Z.length||(Z.push(document.documentElement),e.contentEl.value.style.top&&e.contentEl.value.style.left||(N.x+=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),N.y+=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const ne=Z.reduce((be,Re)=>{const ze=Re.getBoundingClientRect(),Je=new lh({x:Re===document.documentElement?0:ze.x,y:Re===document.documentElement?0:ze.y,width:Re.clientWidth,height:Re.clientHeight});return be?new lh({x:Math.max(be.left,Je.left),y:Math.max(be.top,Je.top),width:Math.min(be.right,Je.right)-Math.max(be.left,Je.left),height:Math.min(be.bottom,Je.bottom)-Math.max(be.top,Je.top)}):Je},void 0);ne.x+=de,ne.y+=de,ne.width-=de*2,ne.height-=de*2;let ce={anchor:d.value,origin:m.value};function K(be){const Re=new lh(N),ze=$w(be.anchor,D),Je=$w(be.origin,Re);let{x:ct,y:nt}=tD(ze,Je);switch(be.anchor.side){case"top":nt-=A.value[0];break;case"bottom":nt+=A.value[0];break;case"left":ct-=A.value[0];break;case"right":ct+=A.value[0];break}switch(be.anchor.align){case"top":nt-=A.value[1];break;case"bottom":nt+=A.value[1];break;case"left":ct-=A.value[1];break;case"right":ct+=A.value[1];break}return Re.x+=ct,Re.y+=nt,Re.width=Math.min(Re.width,w.value),Re.height=Math.min(Re.height,E.value),{overflows:yw(Re,ne),x:ct,y:nt}}let Se=0,Y=0;const _e={x:0,y:0},fe={x:!1,y:!1};let ve=-1;for(;;){if(ve++>10){hy("Infinite loop detected in connectedLocationStrategy");break}const{x:be,y:Re,overflows:ze}=K(ce);Se+=be,Y+=Re,N.x+=be,N.y+=Re;{const Je=_w(ce.anchor),ct=ze.x.before||ze.x.after,nt=ze.y.before||ze.y.after;let ft=!1;if(["x","y"].forEach(Pe=>{if(Pe==="x"&&ct&&!fe.x||Pe==="y"&&nt&&!fe.y){const at={anchor:{...ce.anchor},origin:{...ce.origin}},Gt=Pe==="x"?Je==="y"?M_:k_:Je==="y"?k_:M_;at.anchor=Gt(at.anchor),at.origin=Gt(at.origin);const{overflows:pt}=K(at);(pt[Pe].before<=ze[Pe].before&&pt[Pe].after<=ze[Pe].after||pt[Pe].before+pt[Pe].after<(ze[Pe].before+ze[Pe].after)/2)&&(ce=at,ft=fe[Pe]=!0)}}),ft)continue}ze.x.before&&(Se+=ze.x.before,N.x+=ze.x.before),ze.x.after&&(Se-=ze.x.after,N.x-=ze.x.after),ze.y.before&&(Y+=ze.y.before,N.y+=ze.y.before),ze.y.after&&(Y-=ze.y.after,N.y-=ze.y.after);{const Je=yw(N,ne);_e.x=ne.width-Je.x.before-Je.x.after,_e.y=ne.height-Je.y.before-Je.y.after,Se+=Je.x.before,N.x+=Je.x.before,Y+=Je.y.before,N.y+=Je.y.before}break}const Ee=_w(ce.anchor);Object.assign(a.value,{"--v-overlay-anchor-origin":`${ce.anchor.side} ${ce.anchor.align}`,transformOrigin:`${ce.origin.side} ${ce.origin.align}`,top:Yt(Nw(Y)),left:Yt(Nw(Se)),minWidth:Yt(Ee==="y"?Math.min(_.value,D.width):_.value),maxWidth:Yt(Uw(Mo(_e.x,_.value===1/0?0:_.value,w.value))),maxHeight:Yt(Uw(Mo(_e.y,s.value===1/0?0:s.value,E.value)))})}return Ke(()=>[d.value,m.value,o.offset,o.minWidth,o.minHeight,o.maxWidth,o.maxHeight],()=>L(),{immediate:!c}),c&&Xi(()=>L()),requestAnimationFrame(()=>{a.value.maxHeight&&L()}),{updateLocation:L}}function Nw(e){return Math.round(e*devicePixelRatio)/devicePixelRatio}function Uw(e){return Math.ceil(e*devicePixelRatio)/devicePixelRatio}let by=!0;const xg=[];function aD(e){!by||xg.length?(xg.push(e),wy()):(by=!1,e(),wy())}let jw=-1;function wy(){cancelAnimationFrame(jw),jw=requestAnimationFrame(()=>{const e=xg.shift();e&&e(),xg.length?wy():by=!0})}const Sy={none:null,close:uD,block:hD,reposition:dD},lD=Ln({scrollStrategy:{type:[String,Function],default:"block",validator:e=>typeof e=="function"||e in Sy}},"VOverlay/scrollStrategies");function cD(e,o){if(!Li)return;let a;Vs(async()=>{var c;(c=a)==null||c.stop(),o.isActive.value&&e.scrollStrategy&&(a=Uf(),await Xi(),a.run(()=>{if(typeof e.scrollStrategy=="function")e.scrollStrategy(o,e);else{var d;(d=Sy[e.scrollStrategy])==null||d.call(Sy,o,e)}}))})}function uD(e){var a;function o(c){e.isActive.value=!1}I2((a=e.activatorEl.value)!=null?a:e.contentEl.value,o)}function hD(e,o){var a;const c=(a=e.root.value)==null?void 0:a.offsetParent,d=[...new Set([...mg(e.activatorEl.value,o.contained?c:void 0),...mg(e.contentEl.value,o.contained?c:void 0)])].filter(s=>!s.classList.contains("v-overlay-scroll-blocked")),m=window.innerWidth-document.documentElement.offsetWidth,_=(s=>y0(s)&&s)(c||document.documentElement);_&&e.root.value.classList.add("v-overlay--scroll-blocked"),d.forEach((s,w)=>{s.style.setProperty("--v-body-scroll-x",Yt(-s.scrollLeft)),s.style.setProperty("--v-body-scroll-y",Yt(-s.scrollTop)),s.style.setProperty("--v-scrollbar-offset",Yt(m)),s.classList.add("v-overlay-scroll-blocked")}),Dc(()=>{d.forEach((s,w)=>{const E=parseFloat(s.style.getPropertyValue("--v-body-scroll-x")),A=parseFloat(s.style.getPropertyValue("--v-body-scroll-y"));s.style.removeProperty("--v-body-scroll-x"),s.style.removeProperty("--v-body-scroll-y"),s.style.removeProperty("--v-scrollbar-offset"),s.classList.remove("v-overlay-scroll-blocked"),s.scrollLeft=-E,s.scrollTop=-A}),_&&e.root.value.classList.remove("v-overlay--scroll-blocked")})}function dD(e){var d;let o=!1,a=-1;function c(m){aD(()=>{var _,s;const w=performance.now();(_=(s=e.updateLocation).value)==null||_.call(s,m),o=(performance.now()-w)/(1e3/60)>2})}I2((d=e.activatorEl.value)!=null?d:e.contentEl.value,m=>{o?(cancelAnimationFrame(a),a=requestAnimationFrame(()=>{a=requestAnimationFrame(()=>{c(m)})})):c(m)})}function I2(e,o){const a=[document,...mg(e)];a.forEach(c=>{c.addEventListener("scroll",o,{passive:!0})}),Dc(()=>{a.forEach(c=>{c.removeEventListener("scroll",o)})})}const Gw=Symbol.for("vuetify:stack"),rf=$i([]);function fD(e,o){const a=Pr("useStack"),c=cn(Gw,void 0),d=$i({activeChildren:new Set});Wi(Gw,d);const m=He(+o.value);Lf(e,()=>{var w;const E=(w=rf.at(-1))==null?void 0:w[1];m.value=E?E+10:+o.value,rf.push([a.uid,m.value]),c==null||c.activeChildren.add(a.uid),Dc(()=>{const A=rf.findIndex(P=>P[0]===a.uid);rf.splice(A,1),c==null||c.activeChildren.delete(a.uid)})});const _=He(!0);Vs(()=>{var w;const E=((w=rf.at(-1))==null?void 0:w[0])===a.uid;setTimeout(()=>_.value=E)});const s=ie(()=>!d.activeChildren.size);return{globalTop:jf(_),localTop:s,stackStyles:ie(()=>({zIndex:m.value}))}}function _f(e){return{teleportTarget:ie(()=>{const a=e.value;if(a===!0||!Li)return;const c=a===!1?document.body:typeof a=="string"?document.querySelector(a):a;if(c==null){gM(`Unable to locate target ${a}`);return}if(!_f.cache.has(c)){const d=document.createElement("div");d.className="v-overlay-container",c.appendChild(d),_f.cache.set(c,d)}return _f.cache.get(c)})}}_f.cache=new WeakMap;function pD(){return!0}function A2(e,o,a){if(!e||k2(e,a)===!1)return!1;const c=vT(o);if(typeof ShadowRoot<"u"&&c instanceof ShadowRoot&&c.host===e.target)return!1;const d=(typeof a.value=="object"&&a.value.include||(()=>[]))();return d.push(o),!d.some(m=>m==null?void 0:m.contains(e.target))}function k2(e,o){return(typeof o.value=="object"&&o.value.closeConditional||pD)(e)}function mD(e,o,a){const c=typeof a.value=="function"?a.value:a.value.handler;o._clickOutside.lastMousedownWasOutside&&A2(e,o,a)&&setTimeout(()=>{k2(e,a)&&c&&c(e)},0)}function qw(e,o){const a=vT(e);o(document),typeof ShadowRoot<"u"&&a instanceof ShadowRoot&&o(a)}const M2={mounted(e,o){const a=d=>mD(d,e,o),c=d=>{e._clickOutside.lastMousedownWasOutside=A2(d,e,o)};qw(e,d=>{d.addEventListener("click",a,!0),d.addEventListener("mousedown",c,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!0}),e._clickOutside[o.instance.$.uid]={onClick:a,onMousedown:c}},unmounted(e,o){!e._clickOutside||(qw(e,a=>{var c;if(!a||!((c=e._clickOutside)!=null&&c[o.instance.$.uid]))return;const{onClick:d,onMousedown:m}=e._clickOutside[o.instance.$.uid];a.removeEventListener("click",d,!0),a.removeEventListener("mousedown",m,!0)}),delete e._clickOutside[o.instance.$.uid])}};function gD(e){const{modelValue:o,color:a,...c}=e;return F(Fs,{name:"fade-transition",appear:!0},{default:()=>[e.modelValue&&F("div",tn({class:["v-overlay__scrim",e.color.backgroundColorClasses.value],style:e.color.backgroundColorStyles.value},c),null)]})}const Hf=Ln({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[String,Boolean],default:!0},zIndex:{type:[Number,String],default:2e3},...JR(),...ls(),...Hg(),...nD(),...lD(),...Kn(),...wa()},"v-overlay"),Ih=Di()({name:"VOverlay",directives:{ClickOutside:M2},inheritAttrs:!1,props:Hf(),emits:{"click:outside":e=>!0,"update:modelValue":e=>!0,afterLeave:()=>!0},setup(e,o){let{slots:a,attrs:c,emit:d}=o;const m=Tn(e,"modelValue"),_=ie({get:()=>m.value,set:Pe=>{Pe&&e.disabled||(m.value=Pe)}}),{teleportTarget:s}=_f(ie(()=>e.attach||e.contained)),{themeClasses:w}=Si(e),{rtlClasses:E,isRtl:A}=Ea(),{hasContent:P,onAfterLeave:L}=F0(e,_),D=er(ie(()=>typeof e.scrim=="string"?e.scrim:null)),{globalTop:N,localTop:Z,stackStyles:de}=fD(_,Et(e,"zIndex")),{activatorEl:ne,activatorRef:ce,activatorEvents:K,contentEvents:Se,scrimEvents:Y}=QR(e,{isActive:_,isTop:Z}),{dimensionStyles:_e}=cs(e);Ke(()=>e.disabled,Pe=>{Pe&&(_.value=!1)});const fe=He(),ve=He(),{contentStyles:Ee,updateLocation:be}=iD(e,{isRtl:A,contentEl:ve,activatorEl:ne,isActive:_});cD(e,{root:fe,contentEl:ve,activatorEl:ne,isActive:_,updateLocation:be});function Re(Pe){d("click:outside",Pe),e.persistent?ft():_.value=!1}function ze(){return _.value&&N.value}Li&&Ke(_,Pe=>{Pe?window.addEventListener("keydown",Je):window.removeEventListener("keydown",Je)},{immediate:!0});function Je(Pe){Pe.key==="Escape"&&N.value&&(e.persistent?ft():_.value=!1)}const ct=WT();Lf(()=>e.closeOnBack,()=>{LL(ct,Pe=>{N.value&&_.value?(Pe(!1),e.persistent?ft():_.value=!1):Pe()})});const nt=He();Ke(()=>_.value&&(e.absolute||e.contained)&&s.value==null,Pe=>{if(Pe){const at=_T(fe.value);at&&at!==document.scrollingElement&&(nt.value=at.scrollTop)}});function ft(){e.noClickAnimation||ve.value&&Cc(ve.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:Mf})}return Mt(()=>{var Pe,at;return F(Dn,null,[(Pe=a.activator)==null?void 0:Pe.call(a,{isActive:_.value,props:tn({ref:ce},S_(K.value),e.activatorProps)}),Li&&F(lP,{disabled:!s.value,to:s.value},{default:()=>[P.value&&F("div",tn({class:["v-overlay",{"v-overlay--absolute":e.absolute||e.contained,"v-overlay--active":_.value,"v-overlay--contained":e.contained},w.value,E.value],style:[de.value,{top:Yt(nt.value)}],ref:fe},c),[F(gD,tn({color:D,modelValue:_.value&&!!e.scrim},S_(Y.value)),null),F(Os,{appear:!0,persisted:!0,transition:e.transition,target:ne.value,onAfterLeave:()=>{L(),d("afterLeave")}},{default:()=>[Yi(F("div",tn({ref:ve,class:["v-overlay__content",e.contentClass],style:[_e.value,Ee.value]},S_(Se.value),e.contentProps),[(at=a.default)==null?void 0:at.call(a,{isActive:_})]),[[Ns,_.value],[go("click-outside"),{handler:Re,closeConditional:ze,include:()=>[ne.value]}]])]})])]})])}),{activatorEl:ne,animateClick:ft,contentEl:ve,globalTop:N,localTop:Z,updateLocation:be}}});function Xg(e){return Fo(e,Object.keys(Ih.props))}const B_=Symbol("Forwarded refs");function hs(e){for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];return e[B_]=a,new Proxy(e,{get(d,m){if(Reflect.has(d,m))return Reflect.get(d,m);for(const _ of a)if(_.value&&Reflect.has(_.value,m)){const s=Reflect.get(_.value,m);return typeof s=="function"?s.bind(_.value):s}},getOwnPropertyDescriptor(d,m){const _=Reflect.getOwnPropertyDescriptor(d,m);if(_)return _;if(!(typeof m=="symbol"||m.startsWith("__"))){for(const s of a){if(!s.value)continue;const w=Reflect.getOwnPropertyDescriptor(s.value,m);if(w)return w;if("_"in s.value&&"setupState"in s.value._){const E=Reflect.getOwnPropertyDescriptor(s.value._.setupState,m);if(E)return E}}for(const s of a){let w=s.value&&Object.getPrototypeOf(s.value);for(;w;){const E=Reflect.getOwnPropertyDescriptor(w,m);if(E)return E;w=Object.getPrototypeOf(w)}}for(const s of a){const w=s.value&&s.value[B_];if(!w)continue;const E=w.slice();for(;E.length;){const A=E.shift(),P=Reflect.getOwnPropertyDescriptor(A.value,m);if(P)return P;const L=A.value&&A.value[B_];L&&E.push(...L)}}}}})}function Yg(){const o=Pr("useScopeId").vnode.scopeId;return{scopeId:o?{[o]:""}:void 0}}const Ah=Di()({name:"VMenu",props:{id:String,...Fg(Hf({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:$g}}),["absolute"])},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=Tn(e,"modelValue"),{scopeId:d}=Yg(),m=Gr(),_=ie(()=>e.id||`v-menu-${m}`),s=He(),w=cn(xy,null);let E=0;Wi(xy,{register(){++E},unregister(){--E},closeParents(){setTimeout(()=>{E||(c.value=!1,w==null||w.closeParents())},40)}}),Ke(c,P=>{P?w==null||w.register():w==null||w.unregister()});function A(){w==null||w.closeParents()}return Mt(()=>{const[P]=Xg(e);return F(Ih,tn({ref:s,class:["v-menu"]},P,{modelValue:c.value,"onUpdate:modelValue":L=>c.value=L,absolute:!0,activatorProps:tn({"aria-haspopup":"menu","aria-expanded":String(c.value),"aria-owns":_.value},e.activatorProps),"onClick:outside":A},d),{activator:a.activator,default:function(){for(var L,D=arguments.length,N=new Array(D),Z=0;Z<D;Z++)N[Z]=arguments[Z];return F(Ci,{root:!0},{default:()=>[(L=a.default)==null?void 0:L.call(a,...N)]})}})}),hs({id:_},s)}});const uf=zt({name:"VFieldLabel",props:{floating:Boolean},setup(e,o){let{slots:a}=o;return Mt(()=>F(Th,{class:["v-field-label",{"v-field-label--floating":e.floating}],"aria-hidden":e.floating||void 0},a)),{}}}),vD=["underlined","outlined","filled","solo","plain"],Kg=Ln({appendInnerIcon:mn,bgColor:String,clearable:Boolean,clearIcon:{type:mn,default:"$clear"},active:Boolean,color:String,dirty:Boolean,disabled:Boolean,error:Boolean,label:String,persistentClear:Boolean,prependInnerIcon:mn,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:e=>vD.includes(e)},"onClick:clear":vf,"onClick:appendInner":vf,"onClick:prependInner":vf,...Kn(),...k0()},"v-field"),Xf=Di()({name:"VField",inheritAttrs:!1,props:{id:String,...Zg(),...Kg()},emits:{"click:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,o){let{attrs:a,emit:c,slots:d}=o;const{themeClasses:m}=Si(e),{loaderClasses:_}=Gg(e),{focusClasses:s,isFocused:w,focus:E,blur:A}=qc(e),{InputIcon:P}=o2(e),L=ie(()=>e.dirty||e.active),D=ie(()=>!e.singleLine&&!!(e.label||d.label)),N=Gr(),Z=ie(()=>e.id||`input-${N}`),de=He(),ne=He(),ce=He(),{backgroundColorClasses:K,backgroundColorStyles:Se}=er(Et(e,"bgColor")),{textColorClasses:Y,textColorStyles:_e}=so(ie(()=>L.value&&w.value&&!e.error&&!e.disabled?e.color:void 0));Ke(L,Ee=>{if(D.value){const be=de.value.$el,Re=ne.value.$el,ze=g0(be),Je=Re.getBoundingClientRect(),ct=Je.x-ze.x,nt=Je.y-ze.y-(ze.height/2-Je.height/2),ft=Je.width/.75,Pe=Math.abs(ft-ze.width)>1?{maxWidth:Yt(ft)}:void 0,at=getComputedStyle(be),Gt=getComputedStyle(Re),pt=parseFloat(at.transitionDuration)*1e3||150,Lt=parseFloat(Gt.getPropertyValue("--v-field-label-scale")),qt=Gt.getPropertyValue("color");be.style.visibility="visible",Re.style.visibility="hidden",Cc(be,{transform:`translate(${ct}px, ${nt}px) scale(${Lt})`,color:qt,...Pe},{duration:pt,easing:Mf,direction:Ee?"normal":"reverse"}).finished.then(()=>{be.style.removeProperty("visibility"),Re.style.removeProperty("visibility")})}},{flush:"post"});const fe=ie(()=>({isActive:L,isFocused:w,controlRef:ce,blur:A,focus:E}));function ve(Ee){Ee.target!==document.activeElement&&Ee.preventDefault(),c("click:control",Ee)}return Mt(()=>{var Ee,be,Re;const ze=e.variant==="outlined",Je=d["prepend-inner"]||e.prependInnerIcon,ct=!!(e.clearable||d.clear),nt=!!(d["append-inner"]||e.appendInnerIcon||ct),ft=d.label?d.label({label:e.label,props:{for:Z.value}}):e.label;return F("div",tn({class:["v-field",{"v-field--active":L.value,"v-field--appended":nt,"v-field--disabled":e.disabled,"v-field--dirty":e.dirty,"v-field--error":e.error,"v-field--has-background":!!e.bgColor,"v-field--persistent-clear":e.persistentClear,"v-field--prepended":Je,"v-field--reverse":e.reverse,"v-field--single-line":e.singleLine,"v-field--no-label":!ft,[`v-field--variant-${e.variant}`]:!0},m.value,K.value,s.value,_.value],style:[Se.value,_e.value],onClick:ve},a),[F("div",{class:"v-field__overlay"},null),F(M0,{name:"v-field",active:e.loading,color:e.error?"error":e.color},{default:d.loader}),Je&&F("div",{key:"prepend",class:"v-field__prepend-inner"},[e.prependInnerIcon&&F(P,{key:"prepend-icon",name:"prependInner"},null),(Ee=d["prepend-inner"])==null?void 0:Ee.call(d,fe.value)]),F("div",{class:"v-field__field","data-no-activator":""},[["solo","filled"].includes(e.variant)&&D.value&&F(uf,{key:"floating-label",ref:ne,class:[Y.value],floating:!0,for:Z.value},{default:()=>[ft]}),F(uf,{ref:de,for:Z.value},{default:()=>[ft]}),(be=d.default)==null?void 0:be.call(d,{...fe.value,props:{id:Z.value,class:"v-field__input"},focus:E,blur:A})]),ct&&F(w0,{key:"clear"},{default:()=>[Yi(F("div",{class:"v-field__clearable"},[d.clear?d.clear():F(P,{name:"clear"},null)]),[[Ns,e.dirty]])]}),nt&&F("div",{key:"append",class:"v-field__append-inner"},[(Re=d["append-inner"])==null?void 0:Re.call(d,fe.value),e.appendInnerIcon&&F(P,{key:"append-icon",name:"appendInner"},null)]),F("div",{class:["v-field__outline",Y.value]},[ze&&F(Dn,null,[F("div",{class:"v-field__outline__start"},null),D.value&&F("div",{class:"v-field__outline__notch"},[F(uf,{ref:ne,floating:!0,for:Z.value},{default:()=>[ft]})]),F("div",{class:"v-field__outline__end"},null)]),["plain","underlined"].includes(e.variant)&&D.value&&F(uf,{ref:ne,floating:!0,for:Z.value},{default:()=>[ft]})])])}),{controlRef:ce}}});function V0(e){const o=Object.keys(Xf.props).filter(a=>!rT(a));return Fo(e,o)}const Jg=zt({name:"VCounter",functional:!0,props:{active:Boolean,max:[Number,String],value:{type:[Number,String],default:0},...wa({transition:{component:b0}})},setup(e,o){let{slots:a}=o;const c=ie(()=>e.max?`${e.value} / ${e.max}`:String(e.value));return Mt(()=>F(Os,{transition:e.transition},{default:()=>[Yi(F("div",{class:"v-counter"},[a.default?a.default({counter:c.value,max:e.max,value:e.value}):c.value]),[[Ns,e.active]])]})),{}}}),_D=["color","file","time","date","datetime-local","week","month"],Yf=Di()({name:"VTextField",directives:{Intersect:Ug},inheritAttrs:!1,props:{autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,hint:String,persistentHint:Boolean,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,type:{type:String,default:"text"},...Ta(),...Kg()},emits:{"click:control":e=>!0,"click:input":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,o){let{attrs:a,emit:c,slots:d}=o;const m=Tn(e,"modelValue"),{isFocused:_,focus:s,blur:w}=qc(e),E=ie(()=>{var Y;return typeof e.counterValue=="function"?e.counterValue(m.value):((Y=m.value)!=null?Y:"").toString().length}),A=ie(()=>{if(a.maxlength)return a.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function P(Y,_e){var fe,ve;!e.autofocus||!Y||(fe=_e[0].target)==null||(ve=fe.focus)==null||ve.call(fe)}const L=He(),D=He(),N=He(),Z=ie(()=>_D.includes(e.type)||e.persistentPlaceholder||_.value),de=ie(()=>e.messages.length?e.messages:_.value||e.persistentHint?e.hint:"");function ne(){if(N.value!==document.activeElement){var Y;(Y=N.value)==null||Y.focus()}_.value||s()}function ce(Y){ne(),c("click:control",Y)}function K(Y){Y.stopPropagation(),ne(),Xi(()=>{m.value=null,dg(e["onClick:clear"],Y)})}function Se(Y){m.value=Y.target.value}return Mt(()=>{const Y=!!(d.counter||e.counter||e.counterValue),_e=!!(Y||d.details),[fe,ve]=Fc(a),[{modelValue:Ee,...be}]=Sl(e),[Re]=V0(e);return F(Us,tn({ref:L,modelValue:m.value,"onUpdate:modelValue":ze=>m.value=ze,class:["v-text-field",{"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-text-field--flush-details":["plain","underlined"].includes(e.variant)}],"onClick:prepend":e["onClick:prepend"],"onClick:append":e["onClick:append"]},fe,be,{focused:_.value,messages:de.value}),{...d,default:ze=>{let{id:Je,isDisabled:ct,isDirty:nt,isReadonly:ft,isValid:Pe}=ze;return F(Xf,tn({ref:D,onMousedown:at=>{at.target!==N.value&&at.preventDefault()},"onClick:control":ce,"onClick:clear":K,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},Re,{id:Je.value,active:Z.value||nt.value,dirty:nt.value||e.dirty,focused:_.value,error:Pe.value===!1}),{...d,default:at=>{let{props:{class:Gt,...pt}}=at;const Lt=Yi(F("input",tn({ref:N,value:m.value,onInput:Se,autofocus:e.autofocus,readonly:ft.value,disabled:ct.value,name:e.name,placeholder:e.placeholder,size:1,type:e.type,onFocus:ne,onBlur:w},pt,ve),null),[[go("intersect"),{handler:P},null,{once:!0}]]);return F(Dn,null,[e.prefix&&F("span",{class:"v-text-field__prefix"},[e.prefix]),d.default?F("div",{class:Gt,onClick:qt=>c("click:input",qt),"data-no-activator":""},[d.default(),Lt]):_a(Lt,{class:Gt}),e.suffix&&F("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:_e?ze=>{var Je;return F(Dn,null,[(Je=d.details)==null?void 0:Je.call(d,ze),Y&&F(Dn,null,[F("span",null,null),F(Jg,{active:e.persistentCounter||_.value,value:E.value,max:A.value},d.counter)])])}:void 0})}),hs({},L,D,N)}}),$0=Ln({chips:Boolean,closableChips:Boolean,eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,menu:Boolean,menuIcon:{type:mn,default:"$dropdown"},menuProps:{type:Object},modelValue:null,multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,readonly:Boolean,...b2({itemChildren:!1})},"select"),yD=Di()({name:"VSelect",props:{...$0(),...wa({transition:{component:$g}})},emits:{"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,o){let{slots:a}=o;const{t:c}=us(),d=He(),m=Tn(e,"menu"),{items:_,transformIn:s,transformOut:w}=O0(e),E=Tn(e,"modelValue",[],K=>s(Ro(K)),K=>{var Y;const Se=w(K);return e.multiple?Se:(Y=Se[0])!=null?Y:null}),A=ie(()=>E.value.map(K=>_.value.find(Se=>Se.value===K.value)||K)),P=ie(()=>A.value.map(K=>K.props.value)),L=He();function D(K){E.value=[],e.openOnClear&&(m.value=!0)}function N(){e.hideNoData&&!_.value.length||e.readonly||(m.value=!m.value)}function Z(K){if(!e.readonly){if(["Enter","ArrowDown"," "].includes(K.key)&&(m.value=!0),["Escape","Tab"].includes(K.key)&&(m.value=!1),K.key==="ArrowDown"){var Se;(Se=L.value)==null||Se.focus("next")}else if(K.key==="ArrowUp"){var Y;(Y=L.value)==null||Y.focus("prev")}else if(K.key==="Home"){var _e;(_e=L.value)==null||_e.focus("first")}else if(K.key==="End"){var fe;(fe=L.value)==null||fe.focus("last")}}}function de(K){if(e.multiple){const Se=P.value.findIndex(Y=>Y===K.value);if(Se===-1)E.value=[...E.value,K];else{const Y=[...E.value];Y.splice(Se,1),E.value=Y}}else E.value=[K],m.value=!1}function ne(K){var Se;(Se=L.value)!=null&&Se.$el.contains(K.relatedTarget)||(m.value=!1)}function ce(K){if(K.relatedTarget==null){var Se;(Se=d.value)==null||Se.focus()}}return Mt(()=>{const K=!!(e.chips||a.chip);return F(Yf,{ref:d,modelValue:E.value.map(Se=>Se.props.value).join(", "),"onUpdate:modelValue":Se=>{Se==null&&(E.value=[])},validationValue:E.externalValue,dirty:E.value.length>0,class:["v-select",{"v-select--active-menu":m.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":E.value.length}],appendInnerIcon:e.menuIcon,readonly:!0,"onClick:clear":D,"onClick:control":N,onBlur:ne,onKeydown:Z},{...a,default:()=>{var Se,Y,_e;return F(Dn,null,[F(Ah,tn({modelValue:m.value,"onUpdate:modelValue":fe=>m.value=fe,activator:"parent",contentClass:"v-select__content",eager:e.eager,openOnClick:!1,closeOnContentClick:!1,transition:e.transition},e.menuProps),{default:()=>[F(js,{ref:L,selected:P.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:fe=>fe.preventDefault(),onFocusout:ce},{default:()=>{var fe;return[!_.value.length&&!e.hideNoData&&((fe=(Se=a["no-data"])==null?void 0:Se.call(a))!=null?fe:F(Hi,{title:c(e.noDataText)},null)),(Y=a["prepend-item"])==null?void 0:Y.call(a),_.value.map((ve,Ee)=>{var Re;var be;return(Re=(be=a.item)==null?void 0:be.call(a,{item:ve,index:Ee,props:tn(ve.props,{onClick:()=>de(ve)})}))!=null?Re:F(Hi,tn({key:Ee},ve.props,{onClick:()=>de(ve)}),{prepend:ze=>{let{isSelected:Je}=ze;return e.multiple&&!e.hideSelected?F(Ch,{modelValue:Je,ripple:!1},null):void 0}})}),(_e=a["append-item"])==null?void 0:_e.call(a)]}})]}),A.value.map((fe,ve)=>{function Ee(Re){Re.stopPropagation(),Re.preventDefault(),de(fe)}const be={"onClick:close":Ee,modelValue:!0,"onUpdate:modelValue":void 0};return F("div",{key:fe.value,class:"v-select__selection"},[K?F(Ci,{defaults:{VChip:{closable:e.closableChips,size:"small",text:fe.title}}},{default:()=>[a.chip?a.chip({item:fe,index:ve,props:be}):F(Wf,be,null)]}):a.selection?a.selection({item:fe,index:ve}):F("span",{class:"v-select__selection-text"},[fe.title,e.multiple&&ve<A.value.length-1&&F("span",{class:"v-select__selection-comma"},[gl(",")])])])})])}})}),hs({menu:m,select:de},d)}}),xD=(e,o,a)=>e==null||o==null?-1:e.toString().toLocaleLowerCase().indexOf(o.toString().toLocaleLowerCase()),P2=Ln({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function bD(e,o,a){var w,E;const c=[],d=(w=a==null?void 0:a.default)!=null?w:xD,m=a!=null&&a.filterKeys?Ro(a.filterKeys):!1,_=Object.keys((E=a==null?void 0:a.customKeyFilter)!=null?E:{}).length;if(!(e!=null&&e.length))return c;e:for(let A=0;A<e.length;A++){const P=e[A],L={},D={};let N=-1;if(o&&!(a!=null&&a.noFilter)){if(typeof P=="object"){const ne=m||Object.keys(P);for(const ce of ne){var s;const K=Bs(P,ce,P),Se=a==null||(s=a.customKeyFilter)==null?void 0:s[ce];if(N=Se?Se(K,o,P):d(K,o,P),N!==-1&&N!==!1)Se?L[ce]=N:D[ce]=N;else if((a==null?void 0:a.filterMode)==="every")continue e}}else N=d(P,o,P),N!==-1&&N!==!1&&(D.title=N);const Z=Object.keys(D).length,de=Object.keys(L).length;if(!Z&&!de||(a==null?void 0:a.filterMode)==="union"&&de!==_&&!Z||(a==null?void 0:a.filterMode)==="intersection"&&(de!==_||!Z))continue}c.push({index:A,matches:{...D,...L}})}return c}function z2(e,o,a){const c=ie(()=>typeof(a==null?void 0:a.value)!="string"&&typeof(a==null?void 0:a.value)!="number"?"":String(a.value));return{filteredItems:ie(()=>{const m=pi(o);return bD(m,c.value,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}).map(s=>{let{index:w,matches:E}=s;return{item:m[w],matches:E}})})}}function wD(e,o,a){if(Array.isArray(o))throw new Error("Multiple matches is not implemented");return typeof o=="number"&&~o?F(Dn,null,[F("span",{class:"v-autocomplete__unmask"},[e.substr(0,o)]),F("span",{class:"v-autocomplete__mask"},[e.substr(o,a)]),F("span",{class:"v-autocomplete__unmask"},[e.substr(o+a)])]):e}const SD=Di()({name:"VAutocomplete",props:{search:String,...P2({filterKeys:["title"]}),...$0(),...wa({transition:!1})},emits:{"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,o){let{slots:a}=o;const{t:c}=us(),d=He(),m=He(!1),_=He(!0),s=Tn(e,"menu"),{items:w,transformIn:E,transformOut:A}=O0(e),P=Tn(e,"search",""),L=Tn(e,"modelValue",[],be=>E(Ro(be)),be=>{var ze;const Re=A(be);return e.multiple?Re:(ze=Re[0])!=null?ze:null}),{filteredItems:D}=z2(e,w,ie(()=>_.value?void 0:P.value)),N=ie(()=>L.value.map(be=>w.value.find(Re=>Re.value===be.value)||be)),Z=ie(()=>N.value.map(be=>be.props.value)),de=He();function ne(be){L.value=[],e.openOnClear&&(s.value=!0),P.value=""}function ce(){e.hideNoData&&!w.value.length||e.readonly||(s.value=!0)}function K(be){if(!e.readonly){if(["Enter","ArrowDown"].includes(be.key)&&(s.value=!0),["Escape"].includes(be.key)&&(s.value=!1),["Enter","Escape","Tab"].includes(be.key)&&(_.value=!0),be.key==="ArrowDown"){var Re;(Re=de.value)==null||Re.focus("next")}else if(be.key==="ArrowUp"){var ze;(ze=de.value)==null||ze.focus("prev")}}}function Se(be){P.value=be.target.value}function Y(){m.value&&(_.value=!0)}function _e(be){m.value=!0}function fe(be){if(be.relatedTarget==null){var Re;(Re=d.value)==null||Re.focus()}}const ve=He(!1);function Ee(be){if(e.multiple){const Re=Z.value.findIndex(ze=>ze===be.value);if(Re===-1)L.value=[...L.value,be],P.value="";else{const ze=[...L.value];ze.splice(Re,1),L.value=ze}}else L.value=[be],ve.value=!0,a.selection||(P.value=be.title),s.value=!1,_.value=!0,Xi(()=>ve.value=!1)}return Ke(m,be=>{var ze;if(be){var Re;ve.value=!0,P.value=e.multiple||!!a.selection?"":String((ze=(Re=N.value.at(-1))==null?void 0:Re.props.title)!=null?ze:""),_.value=!0,Xi(()=>ve.value=!1)}else s.value=!1,P.value=""}),Ke(P,be=>{!m.value||ve.value||(be&&(s.value=!0),_.value=!be)}),Mt(()=>{const be=!!(e.chips||a.chip);return F(Yf,{ref:d,modelValue:P.value,"onUpdate:modelValue":Re=>{Re==null&&(L.value=[])},validationValue:L.externalValue,dirty:L.value.length>0,onInput:Se,class:["v-autocomplete",{"v-autocomplete--active-menu":s.value,"v-autocomplete--chips":!!e.chips,[`v-autocomplete--${e.multiple?"multiple":"single"}`]:!0,"v-autocomplete--selection-slot":!!a.selection}],appendInnerIcon:e.menuIcon,readonly:e.readonly,"onClick:clear":ne,"onClick:control":ce,"onClick:input":ce,onFocus:()=>m.value=!0,onBlur:()=>m.value=!1,onKeydown:K},{...a,default:()=>{var Re,ze,Je;return F(Dn,null,[F(Ah,tn({modelValue:s.value,"onUpdate:modelValue":ct=>s.value=ct,activator:"parent",contentClass:"v-autocomplete__content",eager:e.eager,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:Y},e.menuProps),{default:()=>[F(js,{ref:de,selected:Z.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:ct=>ct.preventDefault(),onFocusin:_e,onFocusout:fe},{default:()=>{var ct;return[!D.value.length&&!e.hideNoData&&((ct=(Re=a["no-data"])==null?void 0:Re.call(a))!=null?ct:F(Hi,{title:c(e.noDataText)},null)),(ze=a["prepend-item"])==null?void 0:ze.call(a),D.value.map((nt,ft)=>{var pt;var Pe;let{item:at,matches:Gt}=nt;return(pt=(Pe=a.item)==null?void 0:Pe.call(a,{item:at,index:ft,props:tn(at.props,{onClick:()=>Ee(at)})}))!=null?pt:F(Hi,tn({key:ft},at.props,{onClick:()=>Ee(at)}),{prepend:Lt=>{let{isSelected:qt}=Lt;return e.multiple&&!e.hideSelected?F(Ch,{modelValue:qt,ripple:!1},null):void 0},title:()=>{var qt;var Lt;return _.value?at.title:wD(at.title,Gt.title,(qt=(Lt=P.value)==null?void 0:Lt.length)!=null?qt:0)}})}),(Je=a["append-item"])==null?void 0:Je.call(a)]}})]}),N.value.map((ct,nt)=>{function ft(at){at.stopPropagation(),at.preventDefault(),Ee(ct)}const Pe={"onClick:close":ft,modelValue:!0,"onUpdate:modelValue":void 0};return F("div",{key:ct.value,class:"v-autocomplete__selection"},[be?F(Ci,{defaults:{VChip:{closable:e.closableChips,size:"small",text:ct.title}}},{default:()=>[a.chip?a.chip({item:ct,index:nt,props:Pe}):F(Wf,Pe,null)]}):a.selection?a.selection({item:ct,index:nt}):F("span",{class:"v-autocomplete__selection-text"},[ct.title,e.multiple&&nt<N.value.length-1&&F("span",{class:"v-autocomplete__selection-comma"},[gl(",")])])])})])}})}),hs({isFocused:m,isPristine:_,menu:s,search:P,filteredItems:D,select:Ee},d)}});const ED=zt({name:"VBadge",inheritAttrs:!1,props:{bordered:Boolean,color:String,content:[Number,String],dot:Boolean,floating:Boolean,icon:mn,inline:Boolean,label:{type:String,default:"$vuetify.badge"},max:[Number,String],modelValue:{type:Boolean,default:!0},offsetX:[Number,String],offsetY:[Number,String],textColor:String,...jc({location:"top end"}),...Bi(),...Cn(),...Kn(),...wa({transition:"scale-rotate-transition"})},setup(e,o){const{backgroundColorClasses:a,backgroundColorStyles:c}=er(Et(e,"color")),{roundedClasses:d}=tr(e),{t:m}=us(),{textColorClasses:_,textColorStyles:s}=so(Et(e,"textColor")),{themeClasses:w}=CT(),{locationStyles:E}=Gc(e,!0,A=>{var L,D;return(e.floating?e.dot?2:4:e.dot?8:12)+(["top","bottom"].includes(A)?+((L=e.offsetY)!=null?L:0):["left","right"].includes(A)?+((D=e.offsetX)!=null?D:0):0)});return Mt(()=>{var A,P,L,D;const N=Number(e.content),Z=!e.max||isNaN(N)?e.content:N<=e.max?N:`${e.max}+`,[de,ne]=Fo(o.attrs,["aria-atomic","aria-label","aria-live","role","title"]);return F(e.tag,tn({class:["v-badge",{"v-badge--bordered":e.bordered,"v-badge--dot":e.dot,"v-badge--floating":e.floating,"v-badge--inline":e.inline}]},ne),{default:()=>[F("div",{class:"v-badge__wrapper"},[(A=(P=o.slots).default)==null?void 0:A.call(P),F(Os,{transition:e.transition},{default:()=>[Yi(F("span",tn({class:["v-badge__badge",w.value,a.value,d.value,_.value],style:[c.value,s.value,e.inline?{}:E.value],"aria-atomic":"true","aria-label":m(e.label,N),"aria-live":"polite",role:"status"},de),[e.dot?void 0:o.slots.badge?(L=(D=o.slots).badge)==null?void 0:L.call(D):e.icon?F(Ni,{icon:e.icon},null):Z]),[[Ns,e.modelValue]])]})])]})}),{}}});const L2=zt({name:"VBannerActions",props:{color:String,density:String},setup(e,o){let{slots:a}=o;return ar({VBtn:{color:e.color,density:e.density,variant:"text"}}),Mt(()=>{var c;return F("div",{class:"v-banner-actions"},[(c=a.default)==null?void 0:c.call(a)])}),{}}}),R2=Vo("v-banner-text"),TD=zt({name:"VBanner",props:{avatar:String,color:String,icon:mn,lines:String,stacked:Boolean,sticky:Boolean,text:String,..._o(),...vr(),...ls(),...cr(),...jc(),...wh(),...Bi(),...Cn(),...Kn()},setup(e,o){let{slots:a}=o;const{borderClasses:c}=$o(e),{densityClasses:d}=qr(e),{mobile:m}=qg(),{dimensionStyles:_}=cs(e),{elevationClasses:s}=zr(e),{locationStyles:w}=Gc(e),{positionClasses:E}=Sh(e),{roundedClasses:A}=tr(e),{themeClasses:P}=Si(e),L=Et(e,"color"),D=Et(e,"density");ar({VBannerActions:{color:L,density:D}}),Mt(()=>{var N;const Z=!!(e.text||a.text),de=!!(a.prepend||e.avatar||e.icon);return F(e.tag,{class:["v-banner",{"v-banner--stacked":e.stacked||m.value,"v-banner--sticky":e.sticky,[`v-banner--${e.lines}-line`]:!!e.lines},c.value,d.value,s.value,E.value,A.value,P.value],style:[_.value,w.value],role:"banner"},{default:()=>[de&&F(Ci,{key:"prepend",defaults:{VAvatar:{color:L.value,density:D.value,icon:e.icon,image:e.avatar}}},{default:()=>[F("div",{class:"v-banner__prepend"},[a.prepend?a.prepend():(e.avatar||e.icon)&&F(yl,null,null)])]}),F("div",{class:"v-banner__content"},[Z&&F(R2,{key:"text"},{default:()=>[a.text?a.text():e.text]}),(N=a.default)==null?void 0:N.call(a)]),a.actions&&F(L2,null,{default:()=>[a.actions()]})]})})}});const CD=zt({name:"VBottomNavigation",props:{bgColor:String,color:String,grow:Boolean,mode:{type:String,validator:e=>!e||["horizontal","shift"].includes(e)},height:{type:[Number,String],default:56},..._o(),...vr(),...cr(),...Bi(),...vh({name:"bottom-navigation"}),...Cn({tag:"header"}),...yh({modelValue:!0,selectedClass:"v-btn--selected"}),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{themeClasses:c}=CT(),{borderClasses:d}=$o(e),{backgroundColorClasses:m,backgroundColorStyles:_}=er(Et(e,"bgColor")),{densityClasses:s}=qr(e),{elevationClasses:w}=zr(e),{roundedClasses:E}=tr(e),A=ie(()=>Number(e.height)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0)),P=Tn(e,"modelValue"),{layoutItemStyles:L}=_h({id:e.name,order:ie(()=>parseInt(e.order,10)),position:ie(()=>"bottom"),layoutSize:ie(()=>P.value?A.value:0),elementSize:A,active:P,absolute:Et(e,"absolute")});return Uc(e,E0),ar({VBtn:{color:Et(e,"color"),density:Et(e,"density"),stacked:ie(()=>e.mode!=="horizontal"),variant:"text"}},{scoped:!0}),Mt(()=>F(e.tag,{class:["v-bottom-navigation",{"v-bottom-navigation--active":P.value,"v-bottom-navigation--grow":e.grow,"v-bottom-navigation--shift":e.mode==="shift"},c.value,m.value,d.value,s.value,w.value,E.value],style:[_.value,L.value,{height:Yt(A.value),transform:`translateY(${Yt(P.value?0:100,"%")})`}]},{default:()=>[a.default&&F("div",{class:"v-bottom-navigation__content"},[a.default()])]})),{}}});const D2=Vo("v-breadcrumbs-divider","li"),B2=zt({name:"VBreadcrumbsItem",props:{active:Boolean,activeClass:String,activeColor:String,color:String,disabled:Boolean,title:String,...Eh(),...Cn({tag:"li"})},setup(e,o){let{slots:a,attrs:c}=o;const d=qf(e,c),m=ie(()=>{var E;return e.active||((E=d.isActive)==null?void 0:E.value)}),_=ie(()=>m.value?e.activeColor:e.color),{textColorClasses:s,textColorStyles:w}=so(_);return Mt(()=>{var E;const A=d.isLink.value?"a":e.tag;return F(A,{class:["v-breadcrumbs-item",{"v-breadcrumbs-item--active":m.value,"v-breadcrumbs-item--disabled":e.disabled,"v-breadcrumbs-item--link":d.isLink.value,[`${e.activeClass}`]:m.value&&e.activeClass},s.value],style:[w.value],href:d.href.value,"aria-current":m.value?"page":void 0,onClick:d.navigate},{default:()=>{var P;return[(P=(E=a.default)==null?void 0:E.call(a))!=null?P:e.title]}})}),{}}}),ID=Di()({name:"VBreadcrumbs",props:{activeClass:String,activeColor:String,bgColor:String,color:String,disabled:Boolean,divider:{type:String,default:"/"},icon:mn,items:{type:Array,default:()=>[]},...vr(),...Bi(),...Cn({tag:"ul"})},setup(e,o){let{slots:a}=o;const{backgroundColorClasses:c,backgroundColorStyles:d}=er(Et(e,"bgColor")),{densityClasses:m}=qr(e),{roundedClasses:_}=tr(e);return ar({VBreadcrumbsItem:{activeClass:Et(e,"activeClass"),activeColor:Et(e,"activeColor"),color:Et(e,"color"),disabled:Et(e,"disabled")}}),Mt(()=>{var s;const w=!!(a.prepend||e.icon);return F(e.tag,{class:["v-breadcrumbs",c.value,m.value,_.value],style:d.value},{default:()=>[w&&F(Ci,{key:"prepend",defaults:{VIcon:{icon:e.icon,start:!0}}},{default:()=>[F("div",{class:"v-breadcrumbs__prepend"},[a.prepend?a.prepend():e.icon&&F(Ni,null,null)])]}),e.items.map((E,A,P)=>{var L;return F(Dn,null,[F(B2,tn({key:A,disabled:A>=P.length-1},typeof E=="string"?{title:E}:E),{default:a.title?()=>{var D;return(D=a.title)==null?void 0:D.call(a,{item:E,index:A})}:void 0}),A<P.length-1&&F(D2,null,{default:()=>{var D;return[(D=(L=a.divider)==null?void 0:L.call(a,{item:E,index:A}))!=null?D:e.divider]}})])}),(s=a.default)==null?void 0:s.call(a)]})}),{}}});const N0=zt({name:"VCardActions",setup(e,o){let{slots:a}=o;return ar({VBtn:{variant:"text"}}),Mt(()=>{var c;return F("div",{class:"v-card-actions"},[(c=a.default)==null?void 0:c.call(a)])}),{}}}),O2=Vo("v-card-subtitle"),F2=Vo("v-card-title"),V2=vn({name:"VCardItem",props:{appendAvatar:String,appendIcon:mn,prependAvatar:String,prependIcon:mn,subtitle:String,title:String,...vr()},setup(e,o){let{slots:a}=o;return Mt(()=>{var c,d,m,_,s;const w=!!(e.prependAvatar||e.prependIcon||a.prepend),E=!!(e.appendAvatar||e.appendIcon||a.append),A=!!(e.title||a.title),P=!!(e.subtitle||a.subtitle);return F("div",{class:"v-card-item"},[w&&F(Ci,{key:"prepend",defaults:{VAvatar:{density:e.density,icon:e.prependIcon,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},{default:()=>{var L;return[F("div",{class:"v-card-item__prepend"},[(L=(c=a.prepend)==null?void 0:c.call(a))!=null?L:F(yl,null,null)])]}}),F("div",{class:"v-card-item__content"},[A&&F(F2,{key:"title"},{default:()=>{var L;return[(L=(d=a.title)==null?void 0:d.call(a))!=null?L:e.title]}}),P&&F(O2,{key:"subtitle"},{default:()=>{var L;return[(L=(m=a.subtitle)==null?void 0:m.call(a))!=null?L:e.subtitle]}}),(_=a.default)==null?void 0:_.call(a)]),E&&F(Ci,{key:"append",defaults:{VAvatar:{density:e.density,icon:e.appendIcon,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},{default:()=>{var L;return[F("div",{class:"v-card-item__append"},[(L=(s=a.append)==null?void 0:s.call(a))!=null?L:F(yl,null,null)])]}})])}),{}}}),U0=Vo("v-card-text"),zc=zt({name:"VCard",directives:{Ripple:wl},props:{appendAvatar:String,appendIcon:mn,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:mn,ripple:Boolean,subtitle:String,text:String,title:String,...Kn(),..._o(),...vr(),...ls(),...cr(),...k0(),...jc(),...wh(),...Bi(),...Eh(),...Cn(),...No({variant:"elevated"})},setup(e,o){let{attrs:a,slots:c}=o;const{themeClasses:d}=Si(e),{borderClasses:m}=$o(e),{colorClasses:_,colorStyles:s,variantClasses:w}=$c(e),{densityClasses:E}=qr(e),{dimensionStyles:A}=cs(e),{elevationClasses:P}=zr(e),{loaderClasses:L}=Gg(e),{locationStyles:D}=Gc(e),{positionClasses:N}=Sh(e),{roundedClasses:Z}=tr(e),de=qf(e,a),ne=ie(()=>e.link!==!1&&de.isLink.value),ce=ie(()=>!e.disabled&&e.link!==!1&&(e.link||de.isClickable.value));return Mt(()=>{var K,Se,Y;const _e=ne.value?"a":e.tag,fe=!!(c.title||e.title),ve=!!(c.subtitle||e.subtitle),Ee=fe||ve,be=!!(c.append||e.appendAvatar||e.appendIcon),Re=!!(c.prepend||e.prependAvatar||e.prependIcon),ze=!!(c.image||e.image),Je=Ee||Re||be,ct=!!(c.text||e.text);return Yi(F(_e,{class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":ce.value},d.value,m.value,_.value,E.value,P.value,L.value,N.value,Z.value,w.value],style:[s.value,A.value,D.value],href:de.href.value,onClick:ce.value&&de.navigate},{default:()=>[ze&&F(Ci,{key:"image",defaults:{VImg:{cover:!0,src:e.image}}},{default:()=>{var nt;return[F("div",{class:"v-card__image"},[(nt=(K=c.image)==null?void 0:K.call(c))!=null?nt:F(gh,null,null)])]}}),F(M0,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:c.loader}),Je&&F(V2,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:c.item,prepend:c.prepend,title:c.title,subtitle:c.subtitle,append:c.append}),ct&&F(U0,{key:"text"},{default:()=>{var nt;return[(nt=(Se=c.text)==null?void 0:Se.call(c))!=null?nt:e.text]}}),(Y=c.default)==null?void 0:Y.call(c),c.actions&&F(N0,null,{default:c.actions}),Vc(ce.value,"v-card")]}),[[go("ripple"),ce.value]])}),{}}});const AD=e=>{const{touchstartX:o,touchendX:a,touchstartY:c,touchendY:d}=e,m=.5,_=16;e.offsetX=a-o,e.offsetY=d-c,Math.abs(e.offsetY)<m*Math.abs(e.offsetX)&&(e.left&&a<o-_&&e.left(e),e.right&&a>o+_&&e.right(e)),Math.abs(e.offsetX)<m*Math.abs(e.offsetY)&&(e.up&&d<c-_&&e.up(e),e.down&&d>c+_&&e.down(e))};function kD(e,o){var a;const c=e.changedTouches[0];o.touchstartX=c.clientX,o.touchstartY=c.clientY,(a=o.start)==null||a.call(o,{originalEvent:e,...o})}function MD(e,o){var a;const c=e.changedTouches[0];o.touchendX=c.clientX,o.touchendY=c.clientY,(a=o.end)==null||a.call(o,{originalEvent:e,...o}),AD(o)}function PD(e,o){var a;const c=e.changedTouches[0];o.touchmoveX=c.clientX,o.touchmoveY=c.clientY,(a=o.move)==null||a.call(o,{originalEvent:e,...o})}function zD(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const o={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:a=>kD(a,o),touchend:a=>MD(a,o),touchmove:a=>PD(a,o)}}function LD(e,o){var w,E;var a;const c=o.value,d=c!=null&&c.parent?e.parentElement:e,m=(w=c==null?void 0:c.options)!=null?w:{passive:!0},_=(a=o.instance)==null?void 0:a.$.uid;if(!d||!_)return;const s=zD(o.value);d._touchHandlers=(E=d._touchHandlers)!=null?E:Object.create(null),d._touchHandlers[_]=s,nT(s).forEach(A=>{d.addEventListener(A,s[A],m)})}function RD(e,o){var a,c;const d=(a=o.value)!=null&&a.parent?e.parentElement:e,m=(c=o.instance)==null?void 0:c.$.uid;if(!(d!=null&&d._touchHandlers)||!m)return;const _=d._touchHandlers[m];nT(_).forEach(s=>{d.removeEventListener(s,_[s])}),delete d._touchHandlers[m]}const j0={mounted:LD,unmounted:RD},$2=Symbol.for("vuetify:v-window"),N2=Symbol.for("vuetify:v-window-group"),U2=Di()({name:"VWindow",directives:{Touch:j0},props:{continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{default:"force"},...Cn(),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{themeClasses:c}=Si(e),{isRtl:d}=Ea(),{t:m}=us(),_=Uc(e,N2),s=He(),w=ie(()=>d.value?!e.reverse:e.reverse),E=He(!1),A=ie(()=>{const Se=e.direction==="vertical"?"y":"x",_e=(w.value?!E.value:E.value)?"-reverse":"";return`v-window-${Se}${_e}-transition`}),P=He(0),L=He(void 0),D=ie(()=>_.items.value.findIndex(Se=>_.selected.value.includes(Se.id)));Ke(D,(Se,Y)=>{const _e=_.items.value.length,fe=_e-1;_e<=2?E.value=Se<Y:Se===fe&&Y===0?E.value=!0:Se===0&&Y===fe?E.value=!1:E.value=Se<Y}),Wi($2,{transition:A,isReversed:E,transitionCount:P,transitionHeight:L,rootRef:s});const N=ie(()=>e.continuous||D.value!==0),Z=ie(()=>e.continuous||D.value!==_.items.value.length-1);function de(){N.value&&_.prev()}function ne(){Z.value&&_.next()}const ce=ie(()=>{const Se=[],Y={icon:d.value?e.nextIcon:e.prevIcon,class:`v-window__${w.value?"right":"left"}`,onClick:_.prev,ariaLabel:m("$vuetify.carousel.prev")};Se.push(N.value?a.prev?a.prev({props:Y}):F(wi,Y,null):F("div",null,null));const _e={icon:d.value?e.prevIcon:e.nextIcon,class:`v-window__${w.value?"left":"right"}`,onClick:_.next,ariaLabel:m("$vuetify.carousel.next")};return Se.push(Z.value?a.next?a.next({props:_e}):F(wi,_e,null):F("div",null,null)),Se}),K=ie(()=>e.touch===!1?e.touch:{...{left:()=>{w.value?de():ne()},right:()=>{w.value?ne():de()},start:Y=>{let{originalEvent:_e}=Y;_e.stopPropagation()}},...e.touch===!0?{}:e.touch});return Mt(()=>{var Se,Y;return Yi(F(e.tag,{ref:s,class:["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover"},c.value]},{default:()=>[F("div",{class:"v-window__container",style:{height:L.value}},[(Se=a.default)==null?void 0:Se.call(a,{group:_}),e.showArrows!==!1&&F("div",{class:"v-window__controls"},[ce.value])]),(Y=a.additional)==null?void 0:Y.call(a,{group:_})]}),[[go("touch"),K.value]])}),{group:_}}}),j2=zt({name:"VWindowItem",directives:{Touch:j0},props:{reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Nc(),...Hg()},emits:{"group:selected":e=>!0},setup(e,o){let{slots:a}=o;const c=cn($2),d=xh(e,N2),{isBooted:m}=P0();if(!c||!d)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const _=He(!1),s=ie(()=>c.isReversed.value?e.reverseTransition!==!1:e.transition!==!1);function w(){!_.value||!c||(_.value=!1,c.transitionCount.value>0&&(c.transitionCount.value-=1,c.transitionCount.value===0&&(c.transitionHeight.value=void 0)))}function E(){if(!(_.value||!c)){if(_.value=!0,c.transitionCount.value===0){var N;c.transitionHeight.value=Yt((N=c.rootRef.value)==null?void 0:N.clientHeight)}c.transitionCount.value+=1}}function A(){w()}function P(N){!_.value||Xi(()=>{!s.value||!_.value||!c||(c.transitionHeight.value=Yt(N.clientHeight))})}const L=ie(()=>{const N=c.isReversed.value?e.reverseTransition:e.transition;return s.value?{name:typeof N!="string"?c.transition.value:N,onBeforeEnter:E,onAfterEnter:w,onEnterCancelled:A,onBeforeLeave:E,onAfterLeave:w,onLeaveCancelled:A,onEnter:P}:!1}),{hasContent:D}=F0(e,d.isSelected);return Mt(()=>{var N;return F(Os,{transition:m.value&&L.value},{default:()=>[Yi(F("div",{class:["v-window-item",d.selectedClass.value]},[D.value&&((N=a.default)==null?void 0:N.call(a))]),[[Ns,d.isSelected.value]])]})}),{}}}),DD=zt({name:"VCarousel",props:{color:String,cycle:Boolean,delimiterIcon:{type:mn,default:"$delimiter"},height:{type:[Number,String],default:500},hideDelimiters:Boolean,hideDelimiterBackground:Boolean,interval:{type:[Number,String],default:6e3,validator:e=>e>0},modelValue:null,progress:[Boolean,String],showArrows:{type:[Boolean,String],default:!0,validator:e=>typeof e=="boolean"||e==="hover"},verticalDelimiters:[Boolean,String]},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=Tn(e,"modelValue"),{t:d}=us(),m=He();let _=-1;Ke(c,w),Ke(()=>e.interval,w),Ke(()=>e.cycle,E=>{E?w():window.clearTimeout(_)}),zn(s);function s(){!e.cycle||!m.value||(_=window.setTimeout(m.value.group.next,+e.interval>0?+e.interval:6e3))}function w(){window.clearTimeout(_),window.requestAnimationFrame(s)}return Mt(()=>F(U2,{ref:m,modelValue:c.value,"onUpdate:modelValue":E=>c.value=E,class:["v-carousel",{"v-carousel--hide-delimiter-background":e.hideDelimiterBackground,"v-carousel--vertical-delimiters":e.verticalDelimiters}],style:{height:Yt(e.height)},continuous:!0,mandatory:"force",showArrows:e.showArrows},{default:a.default,additional:E=>{let{group:A}=E;return F(Dn,null,[!e.hideDelimiters&&F("div",{class:"v-carousel__controls",style:{left:e.verticalDelimiters==="left"&&e.verticalDelimiters?0:"auto",right:e.verticalDelimiters==="right"?0:"auto"}},[A.items.value.length>0&&F(Ci,{defaults:{VBtn:{color:e.color,icon:e.delimiterIcon,size:"x-small",variant:"text"}},scoped:!0},{default:()=>[A.items.value.map((P,L)=>{const D={"aria-label":d("$vuetify.carousel.ariaLabel.delimiter",L+1,A.items.value.length),class:[A.isSelected(P.id)&&"v-btn--active"],onClick:()=>A.select(P.id,!0)};return a.item?a.item({props:D,item:P}):F(wi,tn(P,D),null)})]})]),e.progress&&F(A0,{class:"v-carousel__progress",color:typeof e.progress=="string"?e.progress:void 0,modelValue:(A.getItemIndex(c.value)+1)/A.items.value.length*100},null)])},prev:a.prev,next:a.next})),{}}}),BD=zt({name:"VCarouselItem",inheritAttrs:!1,props:{value:null},setup(e,o){let{slots:a,attrs:c}=o;Mt(()=>F(j2,{class:"v-carousel-item",value:e.value},{default:()=>[F(gh,c,a)]}))}});const OD=Vo("v-code");const FD=zt({name:"VColorPickerCanvas",props:{color:{type:Object},disabled:Boolean,dotSize:{type:[Number,String],default:10},height:{type:[Number,String],default:150},width:{type:[Number,String],default:300}},emits:{"update:color":e=>!0,"update:position":e=>!0},setup(e,o){let{emit:a}=o;const c=He(!1),d=He(!1),m=He({x:0,y:0}),_=ie(()=>{const{x:N,y:Z}=m.value,de=parseInt(e.dotSize,10)/2;return{width:Yt(e.dotSize),height:Yt(e.dotSize),transform:`translate(${Yt(N-de)}, ${Yt(Z-de)})`}}),s=He();function w(N,Z,de){const{left:ne,top:ce,width:K,height:Se}=de;m.value={x:Mo(N-ne,0,K),y:Mo(Z-ce,0,Se)}}function E(N){e.disabled||!s.value||w(N.clientX,N.clientY,s.value.getBoundingClientRect())}function A(N){N.preventDefault(),!e.disabled&&(c.value=!0,window.addEventListener("mousemove",P),window.addEventListener("mouseup",L),window.addEventListener("touchmove",P),window.addEventListener("touchend",L))}function P(N){if(e.disabled||!s.value)return;c.value=!0;const Z=az(N);w(Z.clientX,Z.clientY,s.value.getBoundingClientRect())}function L(){window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",L),window.removeEventListener("touchmove",P),window.removeEventListener("touchend",L)}Ke(m,()=>{var Se,Y;var N,Z;if(d.value){d.value=!1;return}if(!s.value)return;const{width:de,height:ne}=s.value.getBoundingClientRect(),{x:ce,y:K}=m.value;a("update:color",{h:(Se=(N=e.color)==null?void 0:N.h)!=null?Se:0,s:Mo(ce,0,de)/de,v:1-Mo(K,0,ne)/ne,a:(Y=(Z=e.color)==null?void 0:Z.a)!=null?Y:1})});function D(){var K;var N;if(!s.value)return;const Z=s.value,de=Z.getContext("2d");if(!de)return;const ne=de.createLinearGradient(0,0,Z.width,0);ne.addColorStop(0,"hsla(0, 0%, 100%, 1)"),ne.addColorStop(1,`hsla(${(K=(N=e.color)==null?void 0:N.h)!=null?K:0}, 100%, 50%, 1)`),de.fillStyle=ne,de.fillRect(0,0,Z.width,Z.height);const ce=de.createLinearGradient(0,0,0,Z.height);ce.addColorStop(0,"hsla(0, 0%, 100%, 0)"),ce.addColorStop(1,"hsla(0, 0%, 0%, 1)"),de.fillStyle=ce,de.fillRect(0,0,Z.width,Z.height)}return Ke(()=>{var N;return(N=e.color)==null?void 0:N.h},D,{immediate:!0}),Ke(()=>e.color,()=>{if(c.value){c.value=!1;return}!e.color||(d.value=!0,m.value={x:e.color.s*parseInt(e.width,10),y:(1-e.color.v)*parseInt(e.height,10)})},{deep:!0,immediate:!0}),zn(()=>D()),Mt(()=>F("div",{class:"v-color-picker-canvas",style:{width:Yt(e.width),height:Yt(e.height)},onClick:E,onMousedown:A,onTouchstart:A},[F("canvas",{ref:s,width:e.width,height:e.height},null),F("div",{class:["v-color-picker-canvas__dot",{"v-color-picker-canvas__dot--disabled":e.disabled}],style:_.value},null)])),{}}});var Zw;function Ic(e,o){return o.every(a=>e.hasOwnProperty(a))}function G2(e){var a;if(!e)return null;let o=null;if(typeof e=="string"){const c=Sz(e);o=fT(c)}return typeof e=="object"&&(Ic(e,["r","g","b"])?o=_0(e):Ic(e,["h","s","l"])?o=hT(e):Ic(e,["h","s","v"])&&(o=e)),o!=null?{...o,a:(a=o.a)!=null?a:1}:null}function VD(e,o){if(o){const{a,...c}=e;return c}return e}function $D(e,o){if(o==null||typeof o=="string"){const a=pT(e);return e.a===1?a.slice(0,7):a}if(typeof o=="object"){let a;return Ic(o,["r","g","b"])?a=Vg(e):Ic(o,["h","s","l"])?a=uT(e):Ic(o,["h","s","v"])&&(a=e),VD(a,!Ic(o,["a"]))}return e}const tg={h:0,s:0,v:1,a:1},Ey={inputProps:{type:"number",min:0},inputs:[{label:"R",max:255,step:1,getValue:e=>Math.round(e.r),getColor:(e,o)=>({...e,r:Number(o)})},{label:"G",max:255,step:1,getValue:e=>Math.round(e.g),getColor:(e,o)=>({...e,g:Number(o)})},{label:"B",max:255,step:1,getValue:e=>Math.round(e.b),getColor:(e,o)=>({...e,b:Number(o)})},{label:"A",max:1,step:.01,getValue:e=>Math.round(e.a*100)/100,getColor:(e,o)=>({...e,a:Number(o)})}],to:Vg,from:_0},ND={...Ey,inputs:(Zw=Ey.inputs)==null?void 0:Zw.slice(0,3)},Ty={inputProps:{type:"number",min:0},inputs:[{label:"H",max:360,step:1,getValue:e=>Math.round(e.h),getColor:(e,o)=>({...e,h:Number(o)})},{label:"S",max:1,step:.01,getValue:e=>Math.round(e.s*100)/100,getColor:(e,o)=>({...e,s:Number(o)})},{label:"L",max:1,step:.01,getValue:e=>Math.round(e.l*100)/100,getColor:(e,o)=>({...e,l:Number(o)})},{label:"A",max:1,step:.01,getValue:e=>Math.round(e.a*100)/100,getColor:(e,o)=>({...e,a:Number(o)})}],to:uT,from:hT},UD={...Ty,inputs:Ty.inputs.slice(0,3)},q2={inputProps:{type:"text"},inputs:[{label:"HEXA",getValue:e=>e,getColor:(e,o)=>o}],to:pT,from:fT},jD={...q2,inputs:[{label:"HEX",getValue:e=>e.slice(0,7),getColor:(e,o)=>o}]},Ac={rgb:ND,rgba:Ey,hsl:UD,hsla:Ty,hex:jD,hexa:q2},GD=e=>{let{label:o,...a}=e;return F("div",{class:"v-color-picker-edit__input"},[F("input",a,null),F("span",null,[o])])},qD=zt({name:"VColorPickerEdit",props:{color:Object,disabled:Boolean,mode:{type:String,default:"rgba",validator:e=>Object.keys(Ac).includes(e)},modes:{type:Array,default:()=>Object.keys(Ac),validator:e=>Array.isArray(e)&&e.every(o=>Object.keys(Ac).includes(o))}},emits:{"update:color":e=>!0,"update:mode":e=>!0},setup(e,o){let{emit:a}=o;const c=ie(()=>e.modes.map(m=>({...Ac[m],name:m}))),d=ie(()=>{var m;const _=c.value.find(w=>w.name===e.mode);if(!_)return[];const s=e.color?_.to(e.color):{};return(m=_.inputs)==null?void 0:m.map(w=>{let{getValue:E,getColor:A,...P}=w;return{..._.inputProps,...P,disabled:e.disabled,value:E(s),onChange:L=>{const D=L.target;!D||a("update:color",_.from(A(s,D.value)))}}})});return Mt(()=>{var m;return F("div",{class:"v-color-picker-edit"},[(m=d.value)==null?void 0:m.map(_=>F(GD,_,null)),c.value.length>1&&F(wi,{icon:"$unfold",size:"x-small",variant:"plain",onClick:()=>{const _=c.value.findIndex(s=>s.name===e.mode);a("update:mode",c.value[(_+1)%c.value.length].name)}},null)])}),{}}});const G0=Symbol.for("vuetify:v-slider");function Cy(e,o,a){const c=a==="vertical",d=o.getBoundingClientRect(),m="touches"in e?e.touches[0]:e;return c?m.clientY-(d.top+d.height/2):m.clientX-(d.left+d.width/2)}function ZD(e,o){return"touches"in e&&e.touches.length?e.touches[0][o]:"changedTouches"in e&&e.changedTouches.length?e.changedTouches[0][o]:e[o]}const Z2=Ln({disabled:Boolean,error:Boolean,readonly:Boolean,max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:0},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:e=>typeof e=="boolean"||e==="always"},thumbSize:{type:[Number,String],default:20},showTicks:{type:[Boolean,String],default:!1,validator:e=>typeof e=="boolean"||e==="always"},ticks:{type:[Array,Object]},tickSize:{type:[Number,String],default:2},color:String,trackColor:String,trackFillColor:String,trackSize:{type:[Number,String],default:4},direction:{type:String,default:"horizontal",validator:e=>["vertical","horizontal"].includes(e)},reverse:Boolean,...Bi(),...cr({elevation:2})},"slider"),W2=e=>{let{props:o,handleSliderMouseUp:a,handleMouseMove:c,getActiveThumb:d}=e;const{isRtl:m}=Ea(),_=ie(()=>m.value!==o.reverse),s=ie(()=>{let kt=m.value?"rtl":"ltr";return o.reverse&&(kt=kt==="rtl"?"ltr":"rtl"),kt}),w=ie(()=>parseFloat(o.min)),E=ie(()=>parseFloat(o.max)),A=ie(()=>o.step>0?parseFloat(o.step):0),P=ie(()=>{const kt=A.value.toString().trim();return kt.includes(".")?kt.length-kt.indexOf(".")-1:0}),L=ie(()=>parseInt(o.thumbSize,10)),D=ie(()=>parseInt(o.tickSize,10)),N=ie(()=>parseInt(o.trackSize,10)),Z=ie(()=>(E.value-w.value)/A.value),de=Et(o,"disabled"),ne=ie(()=>o.direction==="vertical"),ce=ie(()=>{var kt;return o.error||o.disabled?void 0:(kt=o.thumbColor)!=null?kt:o.color}),K=ie(()=>{var kt;return o.error||o.disabled?void 0:(kt=o.trackColor)!=null?kt:o.color}),Se=ie(()=>{var kt;return o.error||o.disabled?void 0:(kt=o.trackFillColor)!=null?kt:o.color}),Y=He(!1),_e=He(0),fe=He(),ve=He();function Ee(kt){if(A.value<=0)return kt;const Qe=Mo(kt,w.value,E.value),bt=w.value%A.value,Tt=Math.round((Qe-bt)/A.value)*A.value+bt;return parseFloat(Math.min(Tt,E.value).toFixed(P.value))}function be(kt){var Qe;const bt=o.direction==="vertical",Tt=bt?"top":"left",Ut=bt?"height":"width",pn=bt?"clientY":"clientX",{[Tt]:Fn,[Ut]:_n}=(Qe=fe.value)==null?void 0:Qe.$el.getBoundingClientRect(),he=ZD(kt,pn);let Me=Math.min(Math.max((he-Fn-_e.value)/_n,0),1)||0;return(bt||_.value)&&(Me=1-Me),Ee(w.value+Me*(E.value-w.value))}let Re=!1;const ze=kt=>{Re||(_e.value=0,a(be(kt))),Y.value=!1,Re=!1,_e.value=0},Je=kt=>{ve.value=d(kt),ve.value&&(ve.value.focus(),Y.value=!0,ve.value.contains(kt.target)?(Re=!0,_e.value=Cy(kt,ve.value,o.direction)):(_e.value=0,c(be(kt))))},ct={passive:!0,capture:!0};function nt(kt){Re=!0,c(be(kt))}function ft(kt){kt.stopPropagation(),kt.preventDefault(),ze(kt),window.removeEventListener("mousemove",nt,ct),window.removeEventListener("mouseup",ft)}function Pe(kt){var Qe;ze(kt),window.removeEventListener("touchmove",nt,ct),(Qe=kt.target)==null||Qe.removeEventListener("touchend",Pe)}function at(kt){var Qe;Je(kt),window.addEventListener("touchmove",nt,ct),(Qe=kt.target)==null||Qe.addEventListener("touchend",Pe,{passive:!1})}function Gt(kt){kt.preventDefault(),Je(kt),window.addEventListener("mousemove",nt,ct),window.addEventListener("mouseup",ft,{passive:!1})}const pt=kt=>{const Qe=(kt-w.value)/(E.value-w.value)*100;return Mo(isNaN(Qe)?0:Qe,0,100)},Lt=ie(()=>o.ticks?Array.isArray(o.ticks)?o.ticks.map(kt=>({value:kt,position:pt(kt),label:kt.toString()})):Object.keys(o.ticks).map(kt=>({value:parseFloat(kt),position:pt(parseFloat(kt)),label:o.ticks[kt]})):Z.value!==1/0?Tc(Z.value+1).map(kt=>{const Qe=w.value+kt*A.value;return{value:Qe,position:pt(Qe)}}):[]),qt=ie(()=>Lt.value.some(kt=>{let{label:Qe}=kt;return!!Qe})),Bn={activeThumbRef:ve,color:Et(o,"color"),decimals:P,disabled:de,direction:Et(o,"direction"),elevation:Et(o,"elevation"),hasLabels:qt,horizontalDirection:s,isReversed:_,min:w,max:E,mousePressed:Y,numTicks:Z,onSliderMousedown:Gt,onSliderTouchstart:at,parsedTicks:Lt,parseMouseMove:be,position:pt,readonly:Et(o,"readonly"),rounded:Et(o,"rounded"),roundValue:Ee,showTicks:Et(o,"showTicks"),startOffset:_e,step:A,thumbSize:L,thumbColor:ce,thumbLabel:Et(o,"thumbLabel"),ticks:Et(o,"ticks"),tickSize:D,trackColor:K,trackContainerRef:fe,trackFillColor:Se,trackSize:N,vertical:ne};return Wi(G0,Bn),Bn},Iy=zt({name:"VSliderThumb",directives:{Ripple:wl},props:{focused:Boolean,max:{type:Number,required:!0},min:{type:Number,required:!0},modelValue:{type:Number,required:!0},position:{type:Number,required:!0}},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a,emit:c}=o;const d=cn(G0);if(!d)throw new Error("[Vuetify] v-slider-thumb must be used inside v-slider or v-range-slider");const{thumbColor:m,step:_,vertical:s,disabled:w,thumbSize:E,thumbLabel:A,direction:P,readonly:L,elevation:D,isReversed:N,horizontalDirection:Z,mousePressed:de,decimals:ne}=d,{textColorClasses:ce,textColorStyles:K}=so(m),{pageup:Se,pagedown:Y,end:_e,home:fe,left:ve,right:Ee,down:be,up:Re}=ly,ze=[Se,Y,_e,fe,ve,Ee,be,Re],Je=ie(()=>_.value?[1,2,3]:[1,5,10]);function ct(ft,Pe){if(!ze.includes(ft.key))return;ft.preventDefault();const at=_.value||.1,Gt=(e.max-e.min)/at;if([ve,Ee,be,Re].includes(ft.key)){const Lt=(N.value?[ve,Re]:[Ee,Re]).includes(ft.key)?1:-1,qt=ft.shiftKey?2:ft.ctrlKey?1:0;Pe=Pe+Lt*at*Je.value[qt]}else if(ft.key===fe)Pe=e.min;else if(ft.key===_e)Pe=e.max;else{const pt=ft.key===Y?1:-1;Pe=Pe-pt*at*(Gt>100?Gt/10:10)}return Math.max(e.min,Math.min(e.max,Pe))}function nt(ft){const Pe=ct(ft,e.modelValue);Pe!=null&&c("update:modelValue",Pe)}return Mt(()=>{var ft;const Pe=Yt(s.value?100-e.position:e.position,"%"),at=s.value?"block":"inline",{elevationClasses:Gt}=zr(ie(()=>w.value?void 0:D.value));return F("div",{class:["v-slider-thumb",{"v-slider-thumb--focused":e.focused,"v-slider-thumb--pressed":e.focused&&de.value}],style:{[`inset-${at}-start`]:`calc(${Pe} - var(--v-slider-thumb-size) / 2)`,"--v-slider-thumb-size":Yt(E.value),direction:s.value?void 0:Z.value},role:"slider",tabindex:w.value?-1:0,"aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.modelValue,"aria-readonly":L.value,"aria-orientation":P.value,onKeydown:L.value?void 0:nt},[F("div",{class:["v-slider-thumb__surface",ce.value,Gt.value],style:{...K.value}},null),Yi(F("div",{class:["v-slider-thumb__ripple",ce.value],style:K.value},null),[[go("ripple"),!0,null,{circle:!0,center:!0}]]),F(wT,{origin:"bottom center"},{default:()=>{var pt;return[Yi(F("div",{class:"v-slider-thumb__label-container"},[F("div",{class:["v-slider-thumb__label"]},[F("div",null,[(pt=(ft=a["thumb-label"])==null?void 0:ft.call(a,{modelValue:e.modelValue}))!=null?pt:e.modelValue.toFixed(_.value?ne.value:1)])])]),[[Ns,A.value&&e.focused||A.value==="always"]])]}})])}),{}}});const H2=zt({name:"VSliderTrack",props:{start:{type:Number,required:!0},stop:{type:Number,required:!0}},emits:{},setup(e,o){let{slots:a}=o;const c=cn(G0);if(!c)throw new Error("[Vuetify] v-slider-track must be inside v-slider or v-range-slider");const{color:d,horizontalDirection:m,parsedTicks:_,rounded:s,showTicks:w,tickSize:E,trackColor:A,trackFillColor:P,trackSize:L,vertical:D,min:N,max:Z}=c,{roundedClasses:de}=tr(s),{backgroundColorClasses:ne,backgroundColorStyles:ce}=er(P),{backgroundColorClasses:K,backgroundColorStyles:Se}=er(A),Y=ie(()=>`inset-${D.value?"block-end":"inline-start"}`),_e=ie(()=>D.value?"height":"width"),fe=ie(()=>({[Y.value]:"0%",[_e.value]:"100%"})),ve=ie(()=>e.stop-e.start),Ee=ie(()=>({[Y.value]:Yt(e.start,"%"),[_e.value]:Yt(ve.value,"%")})),be=ie(()=>(D.value?_.value.slice().reverse():_.value).map((ze,Je)=>{var Pe;var ct;const nt=D.value?"bottom":"margin-inline-start",ft=ze.value!==N.value&&ze.value!==Z.value?Yt(ze.position,"%"):void 0;return F("div",{key:ze.value,class:["v-slider-track__tick",{"v-slider-track__tick--filled":ze.position>=e.start&&ze.position<=e.stop,"v-slider-track__tick--first":ze.value===N.value,"v-slider-track__tick--last":ze.value===Z.value}],style:{[nt]:ft}},[(ze.label||a["tick-label"])&&F("div",{class:"v-slider-track__tick-label"},[(Pe=(ct=a["tick-label"])==null?void 0:ct.call(a,{tick:ze,index:Je}))!=null?Pe:ze.label])])}));return Mt(()=>F("div",{class:["v-slider-track",de.value],style:{"--v-slider-track-size":Yt(L.value),"--v-slider-tick-size":Yt(E.value),direction:D.value?void 0:m.value}},[F("div",{class:["v-slider-track__background",K.value,{"v-slider-track__background--opacity":!!d.value||!P.value}],style:{...fe.value,...Se.value}},null),F("div",{class:["v-slider-track__fill",ne.value],style:{...Ee.value,...ce.value}},null),w.value&&F("div",{class:["v-slider-track__ticks",{"v-slider-track__ticks--always-show":w.value==="always"}]},[be.value])])),{}}}),bg=zt({name:"VSlider",props:{...Zg(),...Z2(),...Ta(),modelValue:{type:[Number,String],default:0}},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=He(),{min:d,max:m,mousePressed:_,roundValue:s,onSliderMousedown:w,onSliderTouchstart:E,trackContainerRef:A,position:P,hasLabels:L,readonly:D}=W2({props:e,handleSliderMouseUp:K=>N.value=s(K),handleMouseMove:K=>N.value=s(K),getActiveThumb:()=>{var K;return(K=c.value)==null?void 0:K.$el}}),N=Tn(e,"modelValue",void 0,K=>{const Se=typeof K=="string"?parseFloat(K):K==null?d.value:K;return s(Se)}),{isFocused:Z,focus:de,blur:ne}=qc(e),ce=ie(()=>P(N.value));return Mt(()=>{const[K,Se]=Sl(e),Y=!!(e.label||a.label||a.prepend);return F(Us,tn({class:["v-slider",{"v-slider--has-labels":!!a["tick-label"]||L.value,"v-slider--focused":Z.value,"v-slider--pressed":_.value,"v-slider--disabled":e.disabled}]},K,{focused:Z.value}),{...a,prepend:Y?_e=>{var Ee;var fe,ve;return F(Dn,null,[((Ee=(fe=a.label)==null?void 0:fe.call(a,_e))!=null?Ee:e.label)?F(Th,{class:"v-slider__label",text:e.label},null):void 0,(ve=a.prepend)==null?void 0:ve.call(a,_e)])}:void 0,default:_e=>{let{id:fe}=_e;return F("div",{class:"v-slider__container",onMousedown:D.value?void 0:w,onTouchstartPassive:D.value?void 0:E},[F("input",{id:fe.value,name:e.name||fe.value,disabled:e.disabled,readonly:e.readonly,tabindex:"-1",value:N.value},null),F(H2,{ref:A,start:0,stop:ce.value},{"tick-label":a["tick-label"]}),F(Iy,{ref:c,focused:Z.value,min:d.value,max:m.value,modelValue:N.value,"onUpdate:modelValue":ve=>N.value=ve,position:ce.value,elevation:e.elevation,onFocus:de,onBlur:ne},{"thumb-label":a["thumb-label"]})])}})}),{}}}),WD=zt({name:"VColorPickerPreview",props:{color:{type:Object},disabled:Boolean,hideAlpha:Boolean},emits:{"update:color":e=>!0},setup(e,o){let{emit:a}=o;return Mt(()=>{var m;var c,d;return F("div",{class:["v-color-picker-preview",{"v-color-picker-preview--hide-alpha":e.hideAlpha}]},[F("div",{class:"v-color-picker-preview__dot"},[F("div",{style:{background:dT((m=e.color)!=null?m:tg)}},null)]),F("div",{class:"v-color-picker-preview__sliders"},[F(bg,{class:"v-color-picker-preview__track v-color-picker-preview__hue",modelValue:(c=e.color)==null?void 0:c.h,"onUpdate:modelValue":_=>{var s;return a("update:color",{...(s=e.color)!=null?s:tg,h:_})},step:0,min:0,max:360,disabled:e.disabled,thumbSize:14,trackSize:8,trackFillColor:"white",hideDetails:!0},null),!e.hideAlpha&&F(bg,{class:"v-color-picker-preview__track v-color-picker-preview__alpha",modelValue:(d=e.color)==null?void 0:d.a,"onUpdate:modelValue":_=>{var s;return a("update:color",{...(s=e.color)!=null?s:tg,a:_})},step:0,min:0,max:1,disabled:e.disabled,thumbSize:14,trackSize:8,trackFillColor:"white",hideDetails:!0},null)])])}),{}}});const HD=Object.freeze({base:"#f44336",lighten5:"#ffebee",lighten4:"#ffcdd2",lighten3:"#ef9a9a",lighten2:"#e57373",lighten1:"#ef5350",darken1:"#e53935",darken2:"#d32f2f",darken3:"#c62828",darken4:"#b71c1c",accent1:"#ff8a80",accent2:"#ff5252",accent3:"#ff1744",accent4:"#d50000"}),XD=Object.freeze({base:"#e91e63",lighten5:"#fce4ec",lighten4:"#f8bbd0",lighten3:"#f48fb1",lighten2:"#f06292",lighten1:"#ec407a",darken1:"#d81b60",darken2:"#c2185b",darken3:"#ad1457",darken4:"#880e4f",accent1:"#ff80ab",accent2:"#ff4081",accent3:"#f50057",accent4:"#c51162"}),YD=Object.freeze({base:"#9c27b0",lighten5:"#f3e5f5",lighten4:"#e1bee7",lighten3:"#ce93d8",lighten2:"#ba68c8",lighten1:"#ab47bc",darken1:"#8e24aa",darken2:"#7b1fa2",darken3:"#6a1b9a",darken4:"#4a148c",accent1:"#ea80fc",accent2:"#e040fb",accent3:"#d500f9",accent4:"#aa00ff"}),KD=Object.freeze({base:"#673ab7",lighten5:"#ede7f6",lighten4:"#d1c4e9",lighten3:"#b39ddb",lighten2:"#9575cd",lighten1:"#7e57c2",darken1:"#5e35b1",darken2:"#512da8",darken3:"#4527a0",darken4:"#311b92",accent1:"#b388ff",accent2:"#7c4dff",accent3:"#651fff",accent4:"#6200ea"}),JD=Object.freeze({base:"#3f51b5",lighten5:"#e8eaf6",lighten4:"#c5cae9",lighten3:"#9fa8da",lighten2:"#7986cb",lighten1:"#5c6bc0",darken1:"#3949ab",darken2:"#303f9f",darken3:"#283593",darken4:"#1a237e",accent1:"#8c9eff",accent2:"#536dfe",accent3:"#3d5afe",accent4:"#304ffe"}),QD=Object.freeze({base:"#2196f3",lighten5:"#e3f2fd",lighten4:"#bbdefb",lighten3:"#90caf9",lighten2:"#64b5f6",lighten1:"#42a5f5",darken1:"#1e88e5",darken2:"#1976d2",darken3:"#1565c0",darken4:"#0d47a1",accent1:"#82b1ff",accent2:"#448aff",accent3:"#2979ff",accent4:"#2962ff"}),eB=Object.freeze({base:"#03a9f4",lighten5:"#e1f5fe",lighten4:"#b3e5fc",lighten3:"#81d4fa",lighten2:"#4fc3f7",lighten1:"#29b6f6",darken1:"#039be5",darken2:"#0288d1",darken3:"#0277bd",darken4:"#01579b",accent1:"#80d8ff",accent2:"#40c4ff",accent3:"#00b0ff",accent4:"#0091ea"}),tB=Object.freeze({base:"#00bcd4",lighten5:"#e0f7fa",lighten4:"#b2ebf2",lighten3:"#80deea",lighten2:"#4dd0e1",lighten1:"#26c6da",darken1:"#00acc1",darken2:"#0097a7",darken3:"#00838f",darken4:"#006064",accent1:"#84ffff",accent2:"#18ffff",accent3:"#00e5ff",accent4:"#00b8d4"}),nB=Object.freeze({base:"#009688",lighten5:"#e0f2f1",lighten4:"#b2dfdb",lighten3:"#80cbc4",lighten2:"#4db6ac",lighten1:"#26a69a",darken1:"#00897b",darken2:"#00796b",darken3:"#00695c",darken4:"#004d40",accent1:"#a7ffeb",accent2:"#64ffda",accent3:"#1de9b6",accent4:"#00bfa5"}),iB=Object.freeze({base:"#4caf50",lighten5:"#e8f5e9",lighten4:"#c8e6c9",lighten3:"#a5d6a7",lighten2:"#81c784",lighten1:"#66bb6a",darken1:"#43a047",darken2:"#388e3c",darken3:"#2e7d32",darken4:"#1b5e20",accent1:"#b9f6ca",accent2:"#69f0ae",accent3:"#00e676",accent4:"#00c853"}),rB=Object.freeze({base:"#8bc34a",lighten5:"#f1f8e9",lighten4:"#dcedc8",lighten3:"#c5e1a5",lighten2:"#aed581",lighten1:"#9ccc65",darken1:"#7cb342",darken2:"#689f38",darken3:"#558b2f",darken4:"#33691e",accent1:"#ccff90",accent2:"#b2ff59",accent3:"#76ff03",accent4:"#64dd17"}),oB=Object.freeze({base:"#cddc39",lighten5:"#f9fbe7",lighten4:"#f0f4c3",lighten3:"#e6ee9c",lighten2:"#dce775",lighten1:"#d4e157",darken1:"#c0ca33",darken2:"#afb42b",darken3:"#9e9d24",darken4:"#827717",accent1:"#f4ff81",accent2:"#eeff41",accent3:"#c6ff00",accent4:"#aeea00"}),sB=Object.freeze({base:"#ffeb3b",lighten5:"#fffde7",lighten4:"#fff9c4",lighten3:"#fff59d",lighten2:"#fff176",lighten1:"#ffee58",darken1:"#fdd835",darken2:"#fbc02d",darken3:"#f9a825",darken4:"#f57f17",accent1:"#ffff8d",accent2:"#ffff00",accent3:"#ffea00",accent4:"#ffd600"}),aB=Object.freeze({base:"#ffc107",lighten5:"#fff8e1",lighten4:"#ffecb3",lighten3:"#ffe082",lighten2:"#ffd54f",lighten1:"#ffca28",darken1:"#ffb300",darken2:"#ffa000",darken3:"#ff8f00",darken4:"#ff6f00",accent1:"#ffe57f",accent2:"#ffd740",accent3:"#ffc400",accent4:"#ffab00"}),lB=Object.freeze({base:"#ff9800",lighten5:"#fff3e0",lighten4:"#ffe0b2",lighten3:"#ffcc80",lighten2:"#ffb74d",lighten1:"#ffa726",darken1:"#fb8c00",darken2:"#f57c00",darken3:"#ef6c00",darken4:"#e65100",accent1:"#ffd180",accent2:"#ffab40",accent3:"#ff9100",accent4:"#ff6d00"}),cB=Object.freeze({base:"#ff5722",lighten5:"#fbe9e7",lighten4:"#ffccbc",lighten3:"#ffab91",lighten2:"#ff8a65",lighten1:"#ff7043",darken1:"#f4511e",darken2:"#e64a19",darken3:"#d84315",darken4:"#bf360c",accent1:"#ff9e80",accent2:"#ff6e40",accent3:"#ff3d00",accent4:"#dd2c00"}),uB=Object.freeze({base:"#795548",lighten5:"#efebe9",lighten4:"#d7ccc8",lighten3:"#bcaaa4",lighten2:"#a1887f",lighten1:"#8d6e63",darken1:"#6d4c41",darken2:"#5d4037",darken3:"#4e342e",darken4:"#3e2723"}),hB=Object.freeze({base:"#607d8b",lighten5:"#eceff1",lighten4:"#cfd8dc",lighten3:"#b0bec5",lighten2:"#90a4ae",lighten1:"#78909c",darken1:"#546e7a",darken2:"#455a64",darken3:"#37474f",darken4:"#263238"}),dB=Object.freeze({base:"#9e9e9e",lighten5:"#fafafa",lighten4:"#f5f5f5",lighten3:"#eeeeee",lighten2:"#e0e0e0",lighten1:"#bdbdbd",darken1:"#757575",darken2:"#616161",darken3:"#424242",darken4:"#212121"}),fB=Object.freeze({black:"#000000",white:"#ffffff",transparent:"#ffffff00"}),pB=Object.freeze({red:HD,pink:XD,purple:YD,deepPurple:KD,indigo:JD,blue:QD,lightBlue:eB,cyan:tB,teal:nB,green:iB,lightGreen:rB,lime:oB,yellow:sB,amber:aB,orange:lB,deepOrange:cB,brown:uB,blueGrey:hB,grey:dB,shades:fB});function mB(e){return Object.keys(e).map(o=>{const a=e[o];return a.base?[a.base,a.darken4,a.darken3,a.darken2,a.darken1,a.lighten1,a.lighten2,a.lighten3,a.lighten4,a.lighten5]:[a.black,a.white,a.transparent]})}const gB=zt({name:"VColorPickerSwatches",props:{swatches:{type:Array,default:()=>mB(pB)},disabled:Boolean,color:Object,maxHeight:[Number,String]},emits:{"update:color":e=>!0},setup(e,o){let{emit:a}=o;return Mt(()=>F("div",{class:"v-color-picker-swatches",style:{maxHeight:Yt(e.maxHeight)}},[F("div",null,[e.swatches.map(c=>F("div",{class:"v-color-picker-swatches__swatch"},[c.map(d=>{const m=G2(d);return F("div",{class:"v-color-picker-swatches__color",onClick:()=>m&&a("update:color",m)},[F("div",{style:{background:d}},[e.color&&Gf(e.color,m)?F(Ni,{size:"x-small",icon:"$success",color:Cz(d,"#FFFFFF")>2?"white":"black"},null):void 0])])})]))])])),{}}});const X2=zt({name:"VSheet",props:{color:String,..._o(),...ls(),...cr(),...jc(),...wh(),...Bi(),...Cn(),...Kn()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=Si(e),{backgroundColorClasses:d,backgroundColorStyles:m}=er(Et(e,"color")),{borderClasses:_}=$o(e),{dimensionStyles:s}=cs(e),{elevationClasses:w}=zr(e),{locationStyles:E}=Gc(e),{positionClasses:A}=Sh(e),{roundedClasses:P}=tr(e);return()=>F(e.tag,{class:["v-sheet",c.value,d.value,_.value,w.value,A.value,P.value],style:[m.value,s.value,E.value]},a)}}),vB=zt({name:"VColorPicker",inheritAttrs:!1,props:{canvasHeight:{type:[String,Number],default:150},disabled:Boolean,dotSize:{type:[Number,String],default:10},hideCanvas:Boolean,hideSliders:Boolean,hideInputs:Boolean,mode:{type:String,default:"rgba",validator:e=>Object.keys(Ac).includes(e)},modes:{type:Array,default:()=>Object.keys(Ac),validator:e=>Array.isArray(e)&&e.every(o=>Object.keys(Ac).includes(o))},showSwatches:Boolean,swatches:Array,swatchesMaxHeight:{type:[Number,String],default:150},modelValue:{type:[Object,String]},width:{type:[Number,String],default:300},...cr(),...Bi(),...Kn()},emits:{"update:modelValue":e=>!0,"update:mode":e=>!0},setup(e){const o=Tn(e,"mode"),a=He(null),c=Tn(e,"modelValue",void 0,m=>{let _=G2(m);return _?(a.value&&(_={..._,h:a.value.h},a.value=null),_):null},m=>m?$D(m,e.modelValue):null),d=m=>{c.value=m,a.value=m};return zn(()=>{e.modes.includes(o.value)||(o.value=e.modes[0])}),Mt(()=>{var m;return F(X2,{rounded:e.rounded,elevation:e.elevation,theme:e.theme,class:["v-color-picker"],style:{"--v-color-picker-color-hsv":dT({...(m=c.value)!=null?m:tg,a:1})},maxWidth:e.width},{default:()=>[!e.hideCanvas&&F(FD,{key:"canvas",color:c.value,"onUpdate:color":d,disabled:e.disabled,dotSize:e.dotSize,width:e.width,height:e.canvasHeight},null),(!e.hideSliders||!e.hideInputs)&&F("div",{key:"controls",class:"v-color-picker__controls"},[!e.hideSliders&&F(WD,{key:"preview",color:c.value,"onUpdate:color":d,hideAlpha:!o.value.endsWith("a"),disabled:e.disabled},null),!e.hideInputs&&F(qD,{key:"edit",modes:e.modes,mode:o.value,"onUpdate:mode":_=>o.value=_,color:c.value,"onUpdate:color":d,disabled:e.disabled},null)]),e.showSwatches&&F(gB,{key:"swatches",color:c.value,"onUpdate:color":d,maxHeight:e.swatchesMaxHeight,swatches:e.swatches,disabled:e.disabled},null)]})}),{}}});function _B(e,o,a){if(Array.isArray(o))throw new Error("Multiple matches is not implemented");return typeof o=="number"&&~o?F(Dn,null,[F("span",{class:"v-combobox__unmask"},[e.substr(0,o)]),F("span",{class:"v-combobox__mask"},[e.substr(o,a)]),F("span",{class:"v-combobox__unmask"},[e.substr(o+a)])]):e}const yB=Di()({name:"VCombobox",props:{delimiters:Array,...P2({filterKeys:["title"]}),...$0({hideNoData:!0,returnObject:!0}),...wa({transition:!1})},emits:{"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,o){var ft;var a;let{emit:c,slots:d}=o;const{t:m}=us(),_=He(),s=He(!1),w=He(!0),E=Tn(e,"menu"),A=He(-1),P=ie(()=>{var Pe;return(Pe=_.value)==null?void 0:Pe.color}),{items:L,transformIn:D,transformOut:N}=O0(e),{textColorClasses:Z,textColorStyles:de}=so(P),ne=Tn(e,"modelValue",[],Pe=>D(Ro(Pe||[])),Pe=>{var Gt;const at=N(Pe);return e.multiple?at:(Gt=at[0])!=null?Gt:null}),ce=He(e.multiple?"":(ft=(a=ne.value[0])==null?void 0:a.title)!=null?ft:""),K=ie({get:()=>ce.value,set:Pe=>{var at;if(ce.value=Pe,e.multiple||(ne.value=[ih(e,Pe)]),Pe&&e.multiple&&(at=e.delimiters)!=null&&at.length){const Gt=Pe.split(new RegExp(`(?:${e.delimiters.join("|")})+`));Gt.length>1&&(Gt.forEach(pt=>{pt=pt.trim(),pt&&Je(ih(e,pt))}),ce.value="")}Pe||(A.value=-1),s.value&&(E.value=!0),w.value=!Pe}});Ke(ce,Pe=>{c("update:search",Pe)}),Ke(ne,Pe=>{var Gt;if(!e.multiple){var at;ce.value=(Gt=(at=Pe[0])==null?void 0:at.title)!=null?Gt:""}});const{filteredItems:Se}=z2(e,L,ie(()=>w.value?void 0:K.value)),Y=ie(()=>ne.value.map(Pe=>L.value.find(at=>at.value===Pe.value)||Pe)),_e=ie(()=>Y.value.map(Pe=>Pe.props.value)),fe=ie(()=>Y.value[A.value]),ve=He();function Ee(Pe){ne.value=[],e.openOnClear&&(E.value=!0)}function be(){e.hideNoData&&!L.value.length||e.readonly||(E.value=!0)}function Re(Pe){if(e.readonly)return;const at=_.value.selectionStart,Gt=_e.value.length;if(A.value>-1&&Pe.preventDefault(),["Enter","ArrowDown"].includes(Pe.key)&&(E.value=!0),["Escape"].includes(Pe.key)&&(E.value=!1),["Enter","Escape","Tab"].includes(Pe.key)&&(w.value=!0),Pe.key==="ArrowDown"){var pt;(pt=ve.value)==null||pt.focus("next")}else if(Pe.key==="ArrowUp"){var Lt;(Lt=ve.value)==null||Lt.focus("prev")}if(!!e.multiple){if(["Backspace","Delete"].includes(Pe.key)){if(A.value<0){Pe.key==="Backspace"&&!K.value&&(A.value=Gt-1);return}Je(fe.value),Xi(()=>!fe.value&&(A.value=Gt-2))}if(Pe.key==="ArrowLeft"){if(A.value<0&&at>0)return;const qt=A.value>-1?A.value-1:Gt-1;Y.value[qt]?A.value=qt:(A.value=-1,_.value.setSelectionRange(K.value.length,K.value.length))}if(Pe.key==="ArrowRight"){if(A.value<0)return;const qt=A.value+1;Y.value[qt]?A.value=qt:(A.value=-1,_.value.setSelectionRange(0,0))}Pe.key==="Enter"&&(Je(ih(e,K.value)),K.value="")}}function ze(){s.value&&(w.value=!0)}function Je(Pe){if(e.multiple){const at=_e.value.findIndex(Gt=>Gt===Pe.value);if(at===-1)ne.value=[...ne.value,Pe];else{const Gt=[...ne.value];Gt.splice(at,1),ne.value=Gt}K.value=""}else ne.value=[Pe],ce.value=Pe.title,Xi(()=>{E.value=!1,w.value=!0})}function ct(Pe){s.value=!0}function nt(Pe){if(Pe.relatedTarget==null){var at;(at=_.value)==null||at.focus()}}return Ke(Se,Pe=>{!Pe.length&&e.hideNoData&&(E.value=!1)}),Ke(s,Pe=>{if(Pe)A.value=-1;else{if(E.value=!1,!e.multiple||!K.value)return;ne.value=[...ne.value,ih(e,K.value)],K.value=""}}),Mt(()=>{const Pe=!!(e.chips||d.chip);return F(Yf,{ref:_,modelValue:K.value,"onUpdate:modelValue":[at=>K.value=at,at=>{at==null&&(ne.value=[])}],validationValue:ne.externalValue,dirty:ne.value.length>0,class:["v-combobox",{"v-combobox--active-menu":E.value,"v-combobox--chips":!!e.chips,"v-combobox--selecting-index":A.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0}],appendInnerIcon:e.items.length?e.menuIcon:void 0,readonly:e.readonly,"onClick:clear":Ee,"onClick:control":be,"onClick:input":be,onFocus:()=>s.value=!0,onBlur:()=>s.value=!1,onKeydown:Re},{...d,default:()=>{var at,Gt,pt;return F(Dn,null,[F(Ah,tn({modelValue:E.value,"onUpdate:modelValue":Lt=>E.value=Lt,activator:"parent",contentClass:"v-combobox__content",eager:e.eager,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ze},e.menuProps),{default:()=>[F(js,{ref:ve,selected:_e.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:Lt=>Lt.preventDefault(),onFocusin:ct,onFocusout:nt},{default:()=>{var Lt;return[!Se.value.length&&!e.hideNoData&&((Lt=(at=d["no-data"])==null?void 0:at.call(d))!=null?Lt:F(Hi,{title:m(e.noDataText)},null)),(Gt=d["prepend-item"])==null?void 0:Gt.call(d),Se.value.map((qt,Bn)=>{var Tt;var kt;let{item:Qe,matches:bt}=qt;return(Tt=(kt=d.item)==null?void 0:kt.call(d,{item:Qe,index:Bn,props:tn(Qe.props,{onClick:()=>Je(Qe)})}))!=null?Tt:F(Hi,tn({key:Bn},Qe.props,{onClick:()=>Je(Qe)}),{prepend:Ut=>{let{isSelected:pn}=Ut;return e.multiple&&!e.hideSelected?F(Ch,{modelValue:pn,ripple:!1},null):void 0},title:()=>{var pn;var Ut;return w.value?Qe.title:_B(Qe.title,bt.title,(pn=(Ut=K.value)==null?void 0:Ut.length)!=null?pn:0)}})}),(pt=d["append-item"])==null?void 0:pt.call(d)]}})]}),Y.value.map((Lt,qt)=>{function Bn(Qe){Qe.stopPropagation(),Qe.preventDefault(),Je(Lt)}const kt={"onClick:close":Bn,modelValue:!0,"onUpdate:modelValue":void 0};return F("div",{key:Lt.value,class:["v-combobox__selection",qt===A.value&&["v-combobox__selection--selected",Z.value]],style:qt===A.value?de.value:{}},[Pe?F(Ci,{defaults:{VChip:{closable:e.closableChips,size:"small",text:Lt.title}}},{default:()=>[d.chip?d.chip({item:Lt,index:qt,props:kt}):F(Wf,kt,null)]}):d.selection?d.selection({item:Lt,index:qt}):F("span",{class:"v-combobox__selection-text"},[Lt.title,e.multiple&&qt<Y.value.length-1&&F("span",{class:"v-combobox__selection-comma"},[gl(",")])])])})])}})}),hs({isFocused:s,isPristine:w,menu:E,search:K,selectionIndex:A,filteredItems:Se,select:Je},_)}});const xB=Di()({name:"VDialog",props:{fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...Hf({origin:"center center",scrollStrategy:"block",transition:{component:$g},zIndex:2400})},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=Tn(e,"modelValue"),{scopeId:d}=Yg(),m=He();function _(s){var w,E;const A=s.relatedTarget,P=s.target;if(A!==P&&(w=m.value)!=null&&w.contentEl&&(E=m.value)!=null&&E.globalTop&&![document,m.value.contentEl].includes(P)&&!m.value.contentEl.contains(P)){const L=[...m.value.contentEl.querySelectorAll('button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])')].filter(Z=>!Z.hasAttribute("disabled")&&!Z.matches('[tabindex="-1"]'));if(!L.length)return;const D=L[0],N=L[L.length-1];A===D?N.focus():D.focus()}}return Li&&Ke(()=>c.value&&e.retainFocus,s=>{s?document.addEventListener("focusin",_):document.removeEventListener("focusin",_)},{immediate:!0}),Ke(c,async s=>{if(await Xi(),s){var w;(w=m.value.contentEl)==null||w.focus({preventScroll:!0})}else{var E;(E=m.value.activatorEl)==null||E.focus({preventScroll:!0})}}),Mt(()=>{const[s]=Xg(e);return F(Ih,tn({ref:m,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable}]},s,{modelValue:c.value,"onUpdate:modelValue":w=>c.value=w,"aria-role":"dialog","aria-modal":"true",activatorProps:tn({"aria-haspopup":"dialog","aria-expanded":String(c.value)},e.activatorProps)},d),{activator:a.activator,default:function(){for(var w,E=arguments.length,A=new Array(E),P=0;P<E;P++)A[P]=arguments[P];return F(Ci,{root:!0},{default:()=>[(w=a.default)==null?void 0:w.call(a,...A)]})}})}),hs({},m)}});const Of=Symbol.for("vuetify:v-expansion-panel"),bB=["default","accordion","inset","popout"],wB=zt({name:"VExpansionPanels",props:{color:String,variant:{type:String,default:"default",validator:e=>bB.includes(e)},readonly:Boolean,...yh(),...Cn(),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;Uc(e,Of);const{themeClasses:c}=Si(e),d=ie(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return ar({VExpansionPanel:{color:Et(e,"color")},VExpansionPanelTitle:{readonly:Et(e,"readonly")}}),Mt(()=>F(e.tag,{class:["v-expansion-panels",c.value,d.value]},a)),{}}}),Y2=Ln({color:String,expandIcon:{type:mn,default:"$expand"},collapseIcon:{type:mn,default:"$collapse"},hideActions:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean},"VExpansionPanelTitle"),K2=zt({name:"VExpansionPanelTitle",directives:{Ripple:wl},props:{...Y2()},setup(e,o){let{slots:a}=o;const c=cn(Of);if(!c)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:d,backgroundColorStyles:m}=er(e,"color"),_=ie(()=>({collapseIcon:e.collapseIcon,disabled:c.disabled.value,expanded:c.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return Mt(()=>{var s;return Yi(F("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":c.isSelected.value},d.value],style:m.value,type:"button",tabindex:c.disabled.value?-1:void 0,disabled:c.disabled.value,"aria-expanded":c.isSelected.value,onClick:e.readonly?void 0:c.toggle},[F("span",{class:"v-expansion-panel-title__overlay"},null),(s=a.default)==null?void 0:s.call(a,_.value),!e.hideActions&&F("span",{class:"v-expansion-panel-title__icon"},[a.actions?a.actions(_.value):F(Ni,{icon:c.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[go("ripple"),e.ripple]])}),{}}}),J2=zt({name:"VExpansionPanelText",props:{...Hg()},setup(e,o){let{slots:a}=o;const c=cn(Of);if(!c)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:d,onAfterLeave:m}=F0(e,c.isSelected);return Mt(()=>{var _;return F(Ng,{onAfterLeave:m},{default:()=>[Yi(F("div",{class:"v-expansion-panel-text"},[a.default&&d.value&&F("div",{class:"v-expansion-panel-text__wrapper"},[(_=a.default)==null?void 0:_.call(a)])]),[[Ns,c.isSelected.value]])]})}),{}}}),SB=zt({name:"VExpansionPanel",props:{title:String,text:String,bgColor:String,...cr(),...Nc(),...Hg(),...Bi(),...Cn(),...Y2()},emits:{"group:selected":e=>!0},setup(e,o){let{slots:a}=o;const c=xh(e,Of),{backgroundColorClasses:d,backgroundColorStyles:m}=er(e,"bgColor"),{elevationClasses:_}=zr(e),{roundedClasses:s}=tr(e),w=ie(()=>(c==null?void 0:c.disabled.value)||e.disabled),E=ie(()=>c.group.items.value.reduce((L,D,N)=>(c.group.selected.value.includes(D.id)&&L.push(N),L),[])),A=ie(()=>{const L=c.group.items.value.findIndex(D=>D.id===c.id);return!c.isSelected.value&&E.value.some(D=>D-L===1)}),P=ie(()=>{const L=c.group.items.value.findIndex(D=>D.id===c.id);return!c.isSelected.value&&E.value.some(D=>D-L===-1)});return Wi(Of,c),Mt(()=>{var L;const D=!!(a.text||e.text),N=!!(a.title||e.title);return F(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":c.isSelected.value,"v-expansion-panel--before-active":A.value,"v-expansion-panel--after-active":P.value,"v-expansion-panel--disabled":w.value},s.value,d.value],style:m.value,"aria-expanded":c.isSelected.value},{default:()=>[F("div",{class:["v-expansion-panel__shadow",..._.value]},null),N&&F(K2,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[a.title?a.title():e.title]}),D&&F(J2,{key:"text",eager:e.eager},{default:()=>[a.text?a.text():e.text]}),(L=a.default)==null?void 0:L.call(a)]})}),{}}});const EB=zt({name:"VFileInput",inheritAttrs:!1,props:{chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,hint:String,persistentHint:Boolean,placeholder:String,showSize:{type:[Boolean,Number],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(e)},...Ta({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>Ro(e).every(o=>o!=null&&typeof o=="object")},...Kg({clearable:!0})},emits:{"click:control":e=>!0,"update:modelValue":e=>!0},setup(e,o){let{attrs:a,emit:c,slots:d}=o;const{t:m}=us(),_=Tn(e,"modelValue"),s=ie(()=>typeof e.showSize!="boolean"?e.showSize:void 0),w=ie(()=>{var Y;return((Y=_.value)!=null?Y:[]).reduce((_e,fe)=>{let{size:ve=0}=fe;return _e+ve},0)}),E=ie(()=>gw(w.value,s.value)),A=ie(()=>{var Y;return((Y=_.value)!=null?Y:[]).map(_e=>{const{name:fe="",size:ve=0}=_e;return e.showSize?`${fe} (${gw(ve,s.value)})`:fe})}),P=ie(()=>{var fe;var Y;const _e=(fe=(Y=_.value)==null?void 0:Y.length)!=null?fe:0;return e.showSize?m(e.counterSizeString,_e,E.value):m(e.counterString,_e)}),L=He(),D=He(),N=He(!1),Z=He(),de=ie(()=>e.messages.length?e.messages:e.persistentHint?e.hint:"");function ne(){if(Z.value!==document.activeElement){var Y;(Y=Z.value)==null||Y.focus()}N.value||(N.value=!0)}function ce(Y){dg(e["onClick:prepend"],Y),K(Y)}function K(Y){var _e;(_e=Z.value)==null||_e.click(),c("click:control",Y)}function Se(Y){Y.stopPropagation(),ne(),Xi(()=>{_.value=[],Z!=null&&Z.value&&(Z.value.value=""),dg(e["onClick:clear"],Y)})}return Mt(()=>{const Y=!!(d.counter||e.counter),_e=!!(Y||d.details),[fe,ve]=Fc(a),[{modelValue:Ee,...be}]=Sl(e),[Re]=V0(e);return F(Us,tn({ref:L,modelValue:_.value,"onUpdate:modelValue":ze=>_.value=ze,class:"v-file-input","onClick:prepend":ce,"onClick:append":e["onClick:append"]},fe,be,{focused:N.value,messages:de.value}),{...d,default:ze=>{let{isDisabled:Je,isDirty:ct,isReadonly:nt,isValid:ft}=ze;return F(Xf,tn({ref:D,"prepend-icon":e.prependIcon,"onClick:control":K,"onClick:clear":Se,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},Re,{active:ct.value||N.value,dirty:ct.value,focused:N.value,error:ft.value===!1}),{...d,default:Pe=>{let{props:{class:at,...Gt}}=Pe;return F(Dn,null,[F("input",tn({ref:Z,type:"file",readonly:nt.value,disabled:Je.value,multiple:e.multiple,name:e.name,onClick:pt=>{pt.stopPropagation(),ne()},onChange:pt=>{var qt;if(!pt.target)return;const Lt=pt.target;_.value=[...(qt=Lt.files)!=null?qt:[]]},onFocus:ne,onBlur:()=>N.value=!1},Gt,ve),null),F("div",{class:at},[_.value.length>0&&(d.selection?d.selection({fileNames:A.value,totalBytes:w.value,totalBytesReadable:E.value}):e.chips?A.value.map(pt=>F(Wf,{key:pt,size:"small",color:e.color},{default:()=>[pt]})):A.value.join(", "))])])}})},details:_e?ze=>{var Je;return F(Dn,null,[(Je=d.details)==null?void 0:Je.call(d,ze),Y&&F(Dn,null,[F("span",null,null),F(Jg,{active:!!_.value.length,value:P.value},d.counter)])])}:void 0})}),hs({},L,D,Z)}});const TB=zt({name:"VFooter",props:{app:Boolean,color:String,height:{type:[Number,String],default:"auto"},..._o(),...cr(),...vh(),...Bi(),...Cn({tag:"footer"}),...Kn()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=Si(e),{backgroundColorClasses:d,backgroundColorStyles:m}=er(Et(e,"color")),{borderClasses:_}=$o(e),{elevationClasses:s}=zr(e),{roundedClasses:w}=tr(e),E=He(32),{resizeRef:A}=Rc(D=>{!D.length||(E.value=D[0].target.clientHeight)}),P=ie(()=>e.height==="auto"?E.value:parseInt(e.height,10)),{layoutItemStyles:L}=_h({id:e.name,order:ie(()=>parseInt(e.order,10)),position:ie(()=>"bottom"),layoutSize:P,elementSize:ie(()=>e.height==="auto"?void 0:P.value),active:ie(()=>e.app),absolute:Et(e,"absolute")});return Mt(()=>F(e.tag,{ref:A,class:["v-footer",c.value,d.value,_.value,s.value,w.value],style:[m,e.app?L.value:void 0]},a)),{}}}),CB=zt({name:"VForm",props:{...AR()},emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,o){let{slots:a,emit:c}=o;const d=kR(e),m=He();function _(w){w.preventDefault(),d.reset()}function s(w){const E=w,A=d.validate();E.then=A.then.bind(A),E.catch=A.catch.bind(A),E.finally=A.finally.bind(A),c("submit",E),E.defaultPrevented||A.then(P=>{let{valid:L}=P;if(L){var D;(D=m.value)==null||D.submit()}}),E.preventDefault()}return Mt(()=>{var w;return F("form",{ref:m,class:"v-form",novalidate:!0,onReset:_,onSubmit:s},[(w=a.default)==null?void 0:w.call(a,d)])}),hs(d,m)}});const IB=zt({name:"VContainer",props:{fluid:{type:Boolean,default:!1},...Cn()},setup(e,o){let{slots:a}=o;return Mt(()=>F(e.tag,{class:["v-container",{"v-container--fluid":e.fluid}]},a)),{}}}),q0=["sm","md","lg","xl","xxl"],Q2=(()=>q0.reduce((e,o)=>(e[o]={type:[Boolean,String,Number],default:!1},e),{}))(),eC=(()=>q0.reduce((e,o)=>(e["offset"+bl(o)]={type:[String,Number],default:null},e),{}))(),tC=(()=>q0.reduce((e,o)=>(e["order"+bl(o)]={type:[String,Number],default:null},e),{}))(),Ww={col:Object.keys(Q2),offset:Object.keys(eC),order:Object.keys(tC)};function AB(e,o,a){let c=e;if(!(a==null||a===!1)){if(o){const d=o.replace(e,"");c+=`-${d}`}return e==="col"&&(c="v-"+c),e==="col"&&(a===""||a===!0)||(c+=`-${a}`),c.toLowerCase()}}const kB=["auto","start","end","center","baseline","stretch"],wg=zt({name:"VCol",props:{cols:{type:[Boolean,String,Number],default:!1},...Q2,offset:{type:[String,Number],default:null},...eC,order:{type:[String,Number],default:null},...tC,alignSelf:{type:String,default:null,validator:e=>kB.includes(e)},...Cn()},setup(e,o){let{slots:a}=o;const c=ie(()=>{const d=[];let m;for(m in Ww)Ww[m].forEach(s=>{const w=e[s],E=AB(m,s,w);E&&d.push(E)});const _=d.some(s=>s.startsWith("v-col-"));return d.push({"v-col":!_||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),d});return()=>{var d;return $s(e.tag,{class:c.value},(d=a.default)==null?void 0:d.call(a))}}}),MB=["sm","md","lg","xl","xxl"],Z0=["start","end","center"],nC=["space-between","space-around","space-evenly"];function W0(e,o){return MB.reduce((a,c)=>(a[e+bl(c)]=o(),a),{})}const PB=[...Z0,"baseline","stretch"],iC=e=>PB.includes(e),rC=W0("align",()=>({type:String,default:null,validator:iC})),zB=[...Z0,...nC],oC=e=>zB.includes(e),sC=W0("justify",()=>({type:String,default:null,validator:oC})),LB=[...Z0,...nC,"stretch"],aC=e=>LB.includes(e),lC=W0("alignContent",()=>({type:String,default:null,validator:aC})),Hw={align:Object.keys(rC),justify:Object.keys(sC),alignContent:Object.keys(lC)},RB={align:"align",justify:"justify",alignContent:"align-content"};function DB(e,o,a){let c=RB[e];if(a!=null){if(o){const d=o.replace(e,"");c+=`-${d}`}return c+=`-${a}`,c.toLowerCase()}}const cC=zt({name:"VRow",props:{dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:iC},...rC,justify:{type:String,default:null,validator:oC},...sC,alignContent:{type:String,default:null,validator:aC},...lC,...Cn()},setup(e,o){let{slots:a}=o;const c=ie(()=>{const d=[];let m;for(m in Hw)Hw[m].forEach(_=>{const s=e[_],w=DB(m,_,s);w&&d.push(w)});return d.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),d});return()=>{var d;return $s(e.tag,{class:["v-row",c.value]},(d=a.default)==null?void 0:d.call(a))}}}),uC=Vo("flex-grow-1","div","VSpacer"),BB=zt({name:"VHover",props:{disabled:Boolean,modelValue:{type:Boolean,default:void 0},...E2()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=Tn(e,"modelValue"),{runOpenDelay:d,runCloseDelay:m}=T2(e,_=>!e.disabled&&(c.value=_));return()=>{var _;return(_=a.default)==null?void 0:_.call(a,{isHovering:c.value,props:{onMouseenter:d,onMouseleave:m}})}}});const hC=Symbol.for("vuetify:v-item-group"),OB=zt({name:"VItemGroup",props:{...yh({selectedClass:"v-item--selected"}),...Cn(),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{themeClasses:c}=Si(e),{isSelected:d,select:m,next:_,prev:s,selected:w}=Uc(e,hC);return()=>{var E;return F(e.tag,{class:["v-item-group",c.value]},{default:()=>[(E=a.default)==null?void 0:E.call(a,{isSelected:d,select:m,next:_,prev:s,selected:w.value})]})}}}),FB=Di()({name:"VItem",props:Nc(),emits:{"group:selected":e=>!0},setup(e,o){let{slots:a}=o;const{isSelected:c,select:d,toggle:m,selectedClass:_,value:s,disabled:w}=xh(e,hC);return()=>{var E;return(E=a.default)==null?void 0:E.call(a,{isSelected:c.value,selectedClass:_.value,select:d,toggle:m,value:s.value,disabled:w.value})}}});const VB=Vo("v-kbd"),$B=zt({name:"VLazy",directives:{intersect:Ug},props:{modelValue:Boolean,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},...ls(),...Cn(),...wa({transition:"fade-transition"})},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{dimensionStyles:c}=cs(e),d=Tn(e,"modelValue");function m(_){d.value||(d.value=_)}return Mt(()=>{var _;return Yi(F(e.tag,{class:"v-lazy",style:c.value},{default:()=>[d.value&&F(Os,{transition:e.transition},{default:()=>[(_=a.default)==null?void 0:_.call(a)]})]}),[[go("intersect"),m,e.options]])}),{}}});const NB=zt({name:"VLocaleProvider",props:{locale:String,fallbackLocale:String,messages:Object,rtl:{type:Boolean,default:void 0}},setup(e,o){let{slots:a}=o;const{rtlClasses:c}=kL(e);return Mt(()=>{var d;return F("div",{class:["v-locale-provider",c.value]},[(d=a.default)==null?void 0:d.call(a)])}),{}}});function UB(e){let{rootEl:o,isSticky:a,layoutItemStyles:c}=e;const d=He(!1),m=He(0),_=ie(()=>{const E=typeof d.value=="boolean"?"top":d.value;return[a.value?{top:"auto",bottom:"auto",height:void 0}:void 0,d.value?{[E]:Yt(m.value)}:{top:c.value.top}]});zn(()=>{Ke(a,E=>{E?window.addEventListener("scroll",w,{passive:!0}):window.removeEventListener("scroll",w)},{immediate:!0})}),Ai(()=>{document.removeEventListener("scroll",w)});let s=0;function w(){var N;const E=s>window.scrollY?"up":"down",A=o.value.getBoundingClientRect(),P=parseFloat((N=c.value.top)!=null?N:0),L=window.scrollY-Math.max(0,m.value-P),D=A.height+Math.max(m.value,P)-window.scrollY-window.innerHeight;A.height<window.innerHeight-P?(d.value="top",m.value=P):E==="up"&&d.value==="bottom"||E==="down"&&d.value==="top"?(m.value=window.scrollY+A.top,d.value=!0):E==="down"&&D<=0?(m.value=0,d.value="bottom"):E==="up"&&L<=0&&(m.value=A.top+L,d.value="top"),s=window.scrollY}return{isStuck:d,stickyStyles:_}}const jB=100,GB=20;function Xw(e){const o=1.41421356237;return(e<0?-1:1)*Math.sqrt(Math.abs(e))*o}function Yw(e){if(e.length<2)return 0;if(e.length===2)return e[1].t===e[0].t?0:(e[1].d-e[0].d)/(e[1].t-e[0].t);let o=0;for(let a=e.length-1;a>0;a--){if(e[a].t===e[a-1].t)continue;const c=Xw(o),d=(e[a].d-e[a-1].d)/(e[a].t-e[a-1].t);o+=(d-c)*Math.abs(d),a===e.length-1&&(o*=.5)}return Xw(o)*1e3}function qB(){const e={};function o(d){Array.from(d.changedTouches).forEach(m=>{var s;((s=e[m.identifier])!=null?s:e[m.identifier]=new sz(GB)).push([d.timeStamp,m])})}function a(d){Array.from(d.changedTouches).forEach(m=>{delete e[m.identifier]})}function c(d){var m;const _=(m=e[d])==null?void 0:m.values().reverse();if(!_)throw new Error(`No samples for touch id ${d}`);const s=_[0],w=[],E=[];for(const A of _){if(s[0]-A[0]>jB)break;w.push({t:A[0],d:A[1].clientX}),E.push({t:A[0],d:A[1].clientY})}return{x:Yw(w),y:Yw(E),get direction(){const{x:A,y:P}=this,[L,D]=[Math.abs(A),Math.abs(P)];return L>D&&A>=0?"right":L>D&&A<=0?"left":D>L&&P>=0?"down":D>L&&P<=0?"up":ZB()}}}return{addMovement:o,endTouch:a,getVelocity:c}}function ZB(){throw new Error}function WB(e){let{isActive:o,isTemporary:a,width:c,touchless:d,position:m}=e;zn(()=>{window.addEventListener("touchstart",ne,{passive:!0}),window.addEventListener("touchmove",ce,{passive:!1}),window.addEventListener("touchend",K,{passive:!0})}),Ai(()=>{window.removeEventListener("touchstart",ne),window.removeEventListener("touchmove",ce),window.removeEventListener("touchend",K)});const _=ie(()=>m.value!=="bottom"),{addMovement:s,endTouch:w,getVelocity:E}=qB();let A=!1;const P=He(!1),L=He(0),D=He(0);let N;function Z(Y,_e){return(m.value==="left"?Y:m.value==="right"?document.documentElement.clientWidth-Y:m.value==="bottom"?document.documentElement.clientHeight-Y:Qu())-(_e?c.value:0)}function de(Y){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const fe=m.value==="left"?(Y-D.value)/c.value:m.value==="right"?(document.documentElement.clientWidth-Y-D.value)/c.value:m.value==="bottom"?(document.documentElement.clientHeight-Y-D.value)/c.value:Qu();return _e?Math.max(0,Math.min(1,fe)):fe}function ne(Y){if(d.value)return;const _e=Y.changedTouches[0].clientX,fe=Y.changedTouches[0].clientY,ve=25,Ee=m.value==="left"?_e<ve:m.value==="right"?_e>document.documentElement.clientWidth-ve:m.value==="bottom"?fe>document.documentElement.clientHeight-ve:Qu(),be=o.value&&(m.value==="left"?_e<c.value:m.value==="right"?_e>document.documentElement.clientWidth-c.value:m.value==="bottom"?fe>document.documentElement.clientHeight-c.value:Qu());(Ee||be||o.value&&a.value)&&(A=!0,N=[_e,fe],D.value=Z(_.value?_e:fe,o.value),L.value=de(_.value?_e:fe),w(Y),s(Y))}function ce(Y){const _e=Y.changedTouches[0].clientX,fe=Y.changedTouches[0].clientY;if(A){if(!Y.cancelable){A=!1;return}const Ee=Math.abs(_e-N[0]),be=Math.abs(fe-N[1]);(_.value?Ee>be&&Ee>3:be>Ee&&be>3)?(P.value=!0,A=!1):(_.value?be:Ee)>3&&(A=!1)}if(!P.value)return;Y.preventDefault(),s(Y);const ve=de(_.value?_e:fe,!1);L.value=Math.max(0,Math.min(1,ve)),ve>1?D.value=Z(_.value?_e:fe,!0):ve<0&&(D.value=Z(_.value?_e:fe,!1))}function K(Y){if(A=!1,!P.value)return;s(Y),P.value=!1;const _e=E(Y.changedTouches[0].identifier),fe=Math.abs(_e.x),ve=Math.abs(_e.y);(_.value?fe>ve&&fe>400:ve>fe&&ve>3)?o.value=_e.direction===({left:"right",right:"left",bottom:"up"}[m.value]||Qu()):o.value=L.value>.5}const Se=ie(()=>P.value?{transform:m.value==="left"?`translateX(calc(-100% + ${L.value*c.value}px))`:m.value==="right"?`translateX(calc(100% - ${L.value*c.value}px))`:m.value==="bottom"?`translateY(calc(100% - ${L.value*c.value}px))`:Qu(),transition:"none"}:void 0);return{isDragging:P,dragProgress:L,dragStyles:Se}}function Qu(){throw new Error}const HB=["start","end","left","right","bottom"],dC=zt({name:"VNavigationDrawer",props:{color:String,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,modelValue:{type:Boolean,default:null},permanent:Boolean,rail:Boolean,railWidth:{type:[Number,String],default:56},scrim:{type:[String,Boolean],default:!0},image:String,temporary:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},location:{type:String,default:"start",validator:e=>HB.includes(e)},sticky:Boolean,..._o(),...cr(),...vh(),...Bi(),...Cn({tag:"nav"}),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{attrs:a,slots:c}=o;const{isRtl:d}=Ea(),{themeClasses:m}=Si(e),{borderClasses:_}=$o(e),{backgroundColorClasses:s,backgroundColorStyles:w}=er(Et(e,"color")),{elevationClasses:E}=zr(e),{mobile:A}=qg(),{roundedClasses:P}=tr(e),L=WT(),D=Tn(e,"modelValue",null,ft=>!!ft),{ssrBootStyles:N}=P0(),Z=He(),de=He(!1),ne=ie(()=>e.rail&&e.expandOnHover&&de.value?Number(e.width):Number(e.rail?e.railWidth:e.width)),ce=ie(()=>uy(e.location,d.value)),K=ie(()=>!e.permanent&&(A.value||e.temporary)),Se=ie(()=>e.sticky&&!K.value&&ce.value!=="bottom");e.disableResizeWatcher||Ke(K,ft=>!e.permanent&&(D.value=!ft)),!e.disableRouteWatcher&&L&&Ke(L.currentRoute,()=>K.value&&(D.value=!1)),Ke(()=>e.permanent,ft=>{ft&&(D.value=!0)}),Rg(()=>{e.modelValue!=null||K.value||(D.value=e.permanent||!A.value)});const{isDragging:Y,dragProgress:_e,dragStyles:fe}=WB({isActive:D,isTemporary:K,width:ne,touchless:Et(e,"touchless"),position:ce}),ve=ie(()=>{const ft=K.value?0:e.rail&&e.expandOnHover?Number(e.railWidth):ne.value;return Y.value?ft*_e.value:ft}),{layoutItemStyles:Ee,layoutRect:be,layoutItemScrimStyles:Re}=_h({id:e.name,order:ie(()=>parseInt(e.order,10)),position:ce,layoutSize:ve,elementSize:ne,active:ie(()=>D.value||Y.value),disableTransitions:ie(()=>Y.value),absolute:ie(()=>e.absolute||Se.value&&typeof ze.value!="string")}),{isStuck:ze,stickyStyles:Je}=UB({rootEl:Z,isSticky:Se,layoutItemStyles:Ee}),ct=er(ie(()=>typeof e.scrim=="string"?e.scrim:null)),nt=ie(()=>({...Y.value?{opacity:_e.value*.2,transition:"none"}:void 0,...be.value?{left:Yt(be.value.left),right:Yt(be.value.right),top:Yt(be.value.top),bottom:Yt(be.value.bottom)}:void 0,...Re.value}));return ar({VList:{bgColor:"transparent"}}),Mt(()=>{var ft,Pe,at,Gt;const pt=c.image||e.image;return F(Dn,null,[F(e.tag,tn({ref:Z,onMouseenter:()=>de.value=!0,onMouseleave:()=>de.value=!1,class:["v-navigation-drawer",`v-navigation-drawer--${ce.value}`,{"v-navigation-drawer--expand-on-hover":e.expandOnHover,"v-navigation-drawer--floating":e.floating,"v-navigation-drawer--is-hovering":de.value,"v-navigation-drawer--rail":e.rail,"v-navigation-drawer--temporary":K.value,"v-navigation-drawer--active":D.value,"v-navigation-drawer--sticky":Se.value},m.value,s.value,_.value,E.value,P.value],style:[w.value,Ee.value,fe.value,N.value,Je.value]},a),{default:()=>[pt&&F("div",{key:"image",class:"v-navigation-drawer__img"},[c.image?(ft=c.image)==null?void 0:ft.call(c,{image:e.image}):F("img",{src:e.image,alt:""},null)]),c.prepend&&F("div",{class:"v-navigation-drawer__prepend"},[(Pe=c.prepend)==null?void 0:Pe.call(c)]),F("div",{class:"v-navigation-drawer__content"},[(at=c.default)==null?void 0:at.call(c)]),c.append&&F("div",{class:"v-navigation-drawer__append"},[(Gt=c.append)==null?void 0:Gt.call(c)])]}),F(Fs,{name:"fade-transition"},{default:()=>[K.value&&(Y.value||D.value)&&!!e.scrim&&F("div",{class:["v-navigation-drawer__scrim",ct.backgroundColorClasses.value],style:[nt.value,ct.backgroundColorStyles.value],onClick:()=>D.value=!1},null)]})])}),{isStuck:ze}}});function XB(e){var o,a,c;if(!Li)return;const d=Pr("useHydration"),m=d==null||(o=d.root)==null||(a=o.appContext)==null||(c=a.app)==null?void 0:c._container;return m!=null&&m.__vue_app__?e():zn(e)}const YB=zt({name:"VNoSsr",setup(e,o){let{slots:a}=o;const c=He(!1);return XB(()=>c.value=!0),()=>{var d;return c.value&&((d=a.default)==null?void 0:d.call(a))}}});function KB(){const e=He([]);ME(()=>e.value=[]);function o(a,c){e.value[c]=a}return{refs:e,updateRef:o}}const JB=zt({name:"VPagination",props:{activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:mn,default:"$first"},prevIcon:{type:mn,default:"$prev"},nextIcon:{type:mn,default:"$next"},lastIcon:{type:mn,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,..._o(),...vr(),...cr(),...Bi(),...Sa(),...Cn({tag:"nav"}),...Kn(),...No({variant:"text"})},emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,o){let{slots:a,emit:c}=o;const d=Tn(e,"modelValue"),{t:m,n:_}=us(),{isRtl:s}=Ea(),{themeClasses:w}=Si(e),E=He(-1);ar(void 0,{scoped:!0});const{resizeRef:A}=Rc(_e=>{if(!_e.length)return;const{target:fe,contentRect:ve}=_e[0],Ee=fe.querySelector(".v-pagination__list > *");if(!Ee)return;const be=ve.width,Re=Ee.offsetWidth+parseFloat(getComputedStyle(Ee).marginRight)*2,ze=e.showFirstLastPage?5:3;E.value=Math.max(0,Math.floor(+((be-Re*ze)/Re).toFixed(2)))}),P=ie(()=>parseInt(e.length,10)),L=ie(()=>parseInt(e.start,10)),D=ie(()=>e.totalVisible?parseInt(e.totalVisible,10):E.value>=0?E.value:P.value),N=ie(()=>{if(P.value<=0||isNaN(P.value)||P.value>Number.MAX_SAFE_INTEGER)return[];if(D.value<=1)return[d.value];if(P.value<=D.value)return Tc(P.value,L.value);const _e=D.value%2===0,fe=_e?D.value/2:Math.floor(D.value/2),ve=_e?fe:fe+1,Ee=P.value-fe;if(ve-d.value>=0)return[...Tc(Math.max(1,D.value-1),L.value),e.ellipsis,P.value];if(d.value-Ee>=(_e?1:0)){const be=D.value-1,Re=P.value-be+L.value;return[L.value,e.ellipsis,...Tc(be,Re)]}else{const be=Math.max(1,D.value-3),Re=be===1?d.value:d.value-Math.ceil(be/2)+L.value;return[L.value,e.ellipsis,...Tc(be,Re),e.ellipsis,P.value]}});function Z(_e,fe,ve){_e.preventDefault(),d.value=fe,ve&&c(ve,fe)}const{refs:de,updateRef:ne}=KB();ar({VPaginationBtn:{color:Et(e,"color"),border:Et(e,"border"),density:Et(e,"density"),size:Et(e,"size"),variant:Et(e,"variant"),rounded:Et(e,"rounded"),elevation:Et(e,"elevation")}});const ce=ie(()=>N.value.map((_e,fe)=>{const ve=Ee=>ne(Ee,fe);if(typeof _e=="string")return{isActive:!1,key:`ellipsis-${fe}`,page:_e,props:{ref:ve,ellipsis:!0,icon:!0,disabled:!0}};{const Ee=_e===d.value;return{isActive:Ee,key:_e,page:_(_e),props:{ref:ve,ellipsis:!1,icon:!0,disabled:!!e.disabled||e.length<2,color:Ee?e.activeColor:e.color,ariaCurrent:Ee,ariaLabel:m(Ee?e.currentPageAriaLabel:e.pageAriaLabel,fe+1),onClick:be=>Z(be,_e)}}}})),K=ie(()=>{const _e=!!e.disabled||d.value<=L.value,fe=!!e.disabled||d.value>=L.value+P.value-1;return{first:e.showFirstLastPage?{icon:s.value?e.lastIcon:e.firstIcon,onClick:ve=>Z(ve,L.value,"first"),disabled:_e,ariaLabel:m(e.firstAriaLabel),ariaDisabled:_e}:void 0,prev:{icon:s.value?e.nextIcon:e.prevIcon,onClick:ve=>Z(ve,d.value-1,"prev"),disabled:_e,ariaLabel:m(e.previousAriaLabel),ariaDisabled:_e},next:{icon:s.value?e.prevIcon:e.nextIcon,onClick:ve=>Z(ve,d.value+1,"next"),disabled:fe,ariaLabel:m(e.nextAriaLabel),ariaDisabled:fe},last:e.showFirstLastPage?{icon:s.value?e.firstIcon:e.lastIcon,onClick:ve=>Z(ve,L.value+P.value-1,"last"),disabled:fe,ariaLabel:m(e.lastAriaLabel),ariaDisabled:fe}:void 0}});function Se(){var _e;const fe=d.value-L.value;(_e=de.value[fe])==null||_e.$el.focus()}function Y(_e){_e.key===ly.left&&!e.disabled&&d.value>e.start?(d.value=d.value-1,Xi(Se)):_e.key===ly.right&&!e.disabled&&d.value<L.value+P.value-1&&(d.value=d.value+1,Xi(Se))}return Mt(()=>F(e.tag,{ref:A,class:["v-pagination",w.value],role:"navigation","aria-label":m(e.ariaLabel),onKeydown:Y,"data-test":"v-pagination-root"},{default:()=>[F("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&F("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[a.first?a.first(K.value.first):F(wi,tn({_as:"VPaginationBtn"},K.value.first),null)]),F("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[a.prev?a.prev(K.value.prev):F(wi,tn({_as:"VPaginationBtn"},K.value.prev),null)]),ce.value.map((_e,fe)=>F("li",{key:_e.key,class:["v-pagination__item",{"v-pagination__item--is-active":_e.isActive}],"data-test":"v-pagination-item"},[a.item?a.item(_e):F(wi,tn({_as:"VPaginationBtn"},_e.props),{default:()=>[_e.page]})])),F("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[a.next?a.next(K.value.next):F(wi,tn({_as:"VPaginationBtn"},K.value.next),null)]),e.showFirstLastPage&&F("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[a.last?a.last(K.value.last):F(wi,tn({_as:"VPaginationBtn"},K.value.last),null)])])]})),{}}});function QB(e){return Math.floor(Math.abs(e))*Math.sign(e)}const eO=zt({name:"VParallax",props:{scale:{type:[Number,String],default:.5}},setup(e,o){let{slots:a}=o;const{intersectionRef:c,isIntersecting:d}=C0(),{resizeRef:m,contentRect:_}=Rc(),{height:s}=qg(),w=He();Vs(()=>{var D;c.value=m.value=(D=w.value)==null?void 0:D.$el});let E;Ke(d,D=>{D?(E=_T(c.value),E=E===document.scrollingElement?document:E,E.addEventListener("scroll",L,{passive:!0}),L()):E.removeEventListener("scroll",L)}),Ai(()=>{var D;(D=E)==null||D.removeEventListener("scroll",L)}),Ke(s,L),Ke(()=>{var D;return(D=_.value)==null?void 0:D.height},L);const A=ie(()=>1-Mo(+e.scale));let P=-1;function L(){!d.value||(cancelAnimationFrame(P),P=requestAnimationFrame(()=>{var _e,fe;var D;const N=((D=w.value)==null?void 0:D.$el).querySelector(".v-img__img");if(!N)return;const Z=(_e=E.clientHeight)!=null?_e:document.documentElement.clientHeight,de=(fe=E.scrollTop)!=null?fe:window.scrollY,ne=c.value.offsetTop,ce=_.value.height,K=ne+(ce-Z)/2,Se=QB((de-K)*A.value),Y=Math.max(1,(A.value*(Z-ce)+ce)/ce);N.style.setProperty("transform",`translateY(${Se}px) scale(${Y})`)}))}return Mt(()=>F(gh,{class:["v-parallax",{"v-parallax--active":d.value}],ref:w,cover:!0,onLoadstart:L,onLoad:L},a)),{}}}),tO=zt({name:"VRadio",props:{...Wg({falseIcon:"$radioOff",trueIcon:"$radioOn"})},setup(e,o){let{slots:a}=o;return Mt(()=>F(Zf,tn(e,{class:"v-radio",type:"radio"}),a)),{}}});const nO=zt({name:"VRadioGroup",inheritAttrs:!1,props:{height:{type:[Number,String],default:"auto"},...Ta(),...Fg(L0(),["multiple"]),trueIcon:{type:mn,default:"$radioOn"},falseIcon:{type:mn,default:"$radioOff"},type:{type:String,default:"radio"}},emits:{"update:modelValue":e=>!0},setup(e,o){let{attrs:a,slots:c}=o;const d=Gr(),m=ie(()=>e.id||`radio-group-${d}`),_=Tn(e,"modelValue");return Mt(()=>{const[s,w]=Fc(a),[E,A]=Sl(e),[P,L]=l2({...e,multiple:!1}),D=c.label?c.label({label:e.label,props:{for:m.value}}):e.label;return F(Us,tn({class:"v-radio-group"},s,E,{modelValue:_.value,"onUpdate:modelValue":N=>_.value=N,id:m.value}),{...c,default:N=>{let{id:Z,isDisabled:de,isReadonly:ne}=N;return F(Dn,null,[D&&F(Th,{for:Z.value,clickable:!0},{default:()=>[D]}),F(a2,tn(P,{id:Z.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:de.value,readonly:ne.value},w,{modelValue:_.value,"onUpdate:modelValue":ce=>_.value=ce}),c)])}})}),{}}}),iO=zt({name:"VRangeSlider",props:{...Zg(),...Ta(),...Z2(),strict:Boolean,modelValue:{type:Array,default:()=>[0,0]}},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=He(),d=He(),m=He();function _(fe){if(!c.value||!d.value)return;const ve=Cy(fe,c.value.$el,e.direction),Ee=Cy(fe,d.value.$el,e.direction),be=Math.abs(ve),Re=Math.abs(Ee);return be<Re||be===Re&&ve<0?c.value.$el:d.value.$el}const{activeThumbRef:s,hasLabels:w,max:E,min:A,mousePressed:P,onSliderMousedown:L,onSliderTouchstart:D,position:N,roundValue:Z,trackContainerRef:de}=W2({props:e,handleSliderMouseUp:fe=>{var ve;ne.value=s.value===((ve=c.value)==null?void 0:ve.$el)?[fe,ne.value[1]]:[ne.value[0],fe]},handleMouseMove:fe=>{var ve;const[Ee,be]=ne.value;if(!e.strict&&Ee===be&&Ee!==A.value){var Re,ze,Je;s.value=fe>Ee?(Re=d.value)==null?void 0:Re.$el:(ze=c.value)==null?void 0:ze.$el,(Je=s.value)==null||Je.focus()}s.value===((ve=c.value)==null?void 0:ve.$el)?ne.value=[Math.min(fe,be),be]:ne.value=[Ee,Math.max(Ee,fe)]},getActiveThumb:_}),ne=Tn(e,"modelValue",void 0,fe=>!fe||!fe.length?[0,0]:fe.map(ve=>Z(ve))),{isFocused:ce,focus:K,blur:Se}=qc(e),Y=ie(()=>N(ne.value[0])),_e=ie(()=>N(ne.value[1]));return Mt(()=>{const[fe,ve]=Sl(e),Ee=!!(e.label||a.label||a.prepend);return F(Us,tn({class:["v-slider","v-range-slider",{"v-slider--has-labels":!!a["tick-label"]||w.value,"v-slider--focused":ce.value,"v-slider--pressed":P.value,"v-slider--disabled":e.disabled}],ref:m},fe,{focused:ce.value}),{...a,prepend:Ee?be=>{var Je;var Re,ze;return F(Dn,null,[((Je=(Re=a.label)==null?void 0:Re.call(a,be))!=null?Je:e.label)?F(Th,{class:"v-slider__label",text:e.label},null):void 0,(ze=a.prepend)==null?void 0:ze.call(a,be)])}:void 0,default:be=>{var Re,ze;let{id:Je}=be;return F("div",{class:"v-slider__container",onMousedown:L,onTouchstartPassive:D},[F("input",{id:`${Je.value}_start`,name:e.name||Je.value,disabled:e.disabled,readonly:e.readonly,tabindex:"-1",value:ne.value[0]},null),F("input",{id:`${Je.value}_stop`,name:e.name||Je.value,disabled:e.disabled,readonly:e.readonly,tabindex:"-1",value:ne.value[1]},null),F(H2,{ref:de,start:Y.value,stop:_e.value},{"tick-label":a["tick-label"]}),F(Iy,{ref:c,focused:ce&&s.value===((Re=c.value)==null?void 0:Re.$el),modelValue:ne.value[0],"onUpdate:modelValue":ct=>ne.value=[ct,ne.value[1]],onFocus:ct=>{var nt,ft;if(K(),s.value=(nt=c.value)==null?void 0:nt.$el,ne.value[0]===ne.value[1]&&ne.value[1]===A.value&&ct.relatedTarget!==((ft=d.value)==null?void 0:ft.$el)){var Pe,at;(Pe=c.value)==null||Pe.$el.blur(),(at=d.value)==null||at.$el.focus()}},onBlur:()=>{Se(),s.value=void 0},min:A.value,max:ne.value[1],position:Y.value},{"thumb-label":a["thumb-label"]}),F(Iy,{ref:d,focused:ce&&s.value===((ze=d.value)==null?void 0:ze.$el),modelValue:ne.value[1],"onUpdate:modelValue":ct=>ne.value=[ne.value[0],ct],onFocus:ct=>{var nt,ft;if(K(),s.value=(nt=d.value)==null?void 0:nt.$el,ne.value[0]===ne.value[1]&&ne.value[0]===E.value&&ct.relatedTarget!==((ft=c.value)==null?void 0:ft.$el)){var Pe,at;(Pe=d.value)==null||Pe.$el.blur(),(at=c.value)==null||at.$el.focus()}},onBlur:()=>{Se(),s.value=void 0},min:ne.value[0],max:E.value,position:_e.value},{"thumb-label":a["thumb-label"]})])}})}),{}}});const rO=Di()({name:"VRating",props:{name:String,itemAriaLabel:{type:String,default:"$vuetify.rating.ariaLabel.item"},activeColor:String,color:String,clearable:Boolean,disabled:Boolean,emptyIcon:{type:mn,default:"$ratingEmpty"},fullIcon:{type:mn,default:"$ratingFull"},halfIncrements:Boolean,hover:Boolean,length:{type:[Number,String],default:5},readonly:Boolean,modelValue:{type:Number,default:0},itemLabels:Array,itemLabelPosition:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},ripple:Boolean,...vr(),...Sa(),...Cn(),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{t:c}=us(),{themeClasses:d}=Si(e),m=Tn(e,"modelValue"),_=ie(()=>Tc(Number(e.length),1)),s=ie(()=>_.value.flatMap(K=>e.halfIncrements?[K-.5,K]:[K])),w=He(-1),E=He(-1),A=He();let P=!1;const L=ie(()=>s.value.map(K=>{var Re;const Se=e.hover&&w.value>-1,Y=m.value>=K,_e=w.value>=K,ve=(Se?_e:Y)?e.fullIcon:e.emptyIcon,Ee=(Re=e.activeColor)!=null?Re:e.color,be=Y||_e?Ee:e.color;return{isFilled:Y,isHovered:_e,icon:ve,color:be}})),D=ie(()=>[0,...s.value].map(K=>{function Se(){w.value=K}function Y(){w.value=-1}function _e(){if(K===0&&m.value===0){var Ee;(Ee=A.value)==null||Ee.focus()}else E.value=K}function fe(){P||(E.value=-1)}function ve(){e.disabled||e.readonly||(m.value=m.value===K&&e.clearable?0:K)}return{onMouseenter:e.hover?Se:void 0,onMouseleave:e.hover?Y:void 0,onFocus:_e,onBlur:fe,onClick:ve}}));function N(){P=!0}function Z(){P=!1}const de=ie(()=>{var K;return(K=e.name)!=null?K:`v-rating-${Gr()}`});function ne(K){var Se,Y;let{value:_e,index:fe,showStar:ve=!0}=K;const{onMouseenter:Ee,onMouseleave:be,onFocus:Re,onBlur:ze,onClick:Je}=D.value[fe+1],ct=`${de.value}-${String(_e).replace(".","-")}`,nt={color:(Se=L.value[fe])==null?void 0:Se.color,density:e.density,disabled:e.disabled,icon:(Y=L.value[fe])==null?void 0:Y.icon,ripple:e.ripple,size:e.size,tag:"span",variant:"plain"};return F(Dn,null,[F("label",{for:ct,class:{"v-rating__item--half":e.halfIncrements&&_e%1>0,"v-rating__item--full":e.halfIncrements&&_e%1===0},onMousedown:N,onMouseup:Z,onMouseenter:Ee,onMouseleave:be},[F("span",{class:"v-rating__hidden"},[c(e.itemAriaLabel,_e,e.length)]),ve?a.item?a.item({...L.value[fe],props:nt,value:_e,index:fe}):F(wi,nt,null):void 0]),F("input",{class:"v-rating__hidden",name:de.value,id:ct,type:"radio",value:_e,checked:m.value===_e,onClick:Je,onFocus:Re,onBlur:ze,ref:fe===0?A:void 0,readonly:e.readonly,disabled:e.disabled},null)])}function ce(K){return a["item-label"]?a["item-label"](K):K.label?F("span",null,[K.label]):F("span",null,[gl("\xA0")])}return Mt(()=>{var K;const Se=!!((K=e.itemLabels)!=null&&K.length)||a["item-label"];return F(e.tag,{class:["v-rating",{"v-rating--hover":e.hover,"v-rating--readonly":e.readonly},d.value]},{default:()=>[F(ne,{value:0,index:-1,showStar:!1},null),_.value.map((Y,_e)=>{var fe,ve;return F("div",{class:"v-rating__wrapper"},[Se&&e.itemLabelPosition==="top"?ce({value:Y,index:_e,label:(fe=e.itemLabels)==null?void 0:fe[_e]}):void 0,F("div",{class:["v-rating__item",{"v-rating__item--focused":Math.ceil(E.value)===Y}]},[e.halfIncrements?F(Dn,null,[F(ne,{value:Y-.5,index:_e*2},null),F(ne,{value:Y,index:_e*2+1},null)]):F(ne,{value:Y,index:_e},null)]),Se&&e.itemLabelPosition==="bottom"?ce({value:Y,index:_e,label:(ve=e.itemLabels)==null?void 0:ve[_e]}):void 0])})]})}),{}}});function Kw(e){const a=Math.abs(e);return Math.sign(e)*(a/((1/.501-2)*(1-a)+1))}function Jw(e){let{selectedElement:o,containerSize:a,contentSize:c,isRtl:d,currentScrollOffset:m,isHorizontal:_}=e;const s=_?o.clientWidth:o.clientHeight,w=_?o.offsetLeft:o.offsetTop,E=d&&_?c-w-s:w,A=a+m,P=s+E,L=s*.4;return E<=m?m=Math.max(E-L,0):A<=P&&(m=Math.min(m-(A-P-L),c-a)),m}function oO(e){let{selectedElement:o,containerSize:a,contentSize:c,isRtl:d,isHorizontal:m}=e;const _=m?o.clientWidth:o.clientHeight,s=m?o.offsetLeft:o.offsetTop,w=d&&m?c-s-_/2-a/2:s+_/2-a/2;return Math.min(c-a,Math.max(0,w))}const fC=Symbol.for("vuetify:v-slide-group"),pC=Di()({name:"VSlideGroup",props:{centerActive:Boolean,direction:{type:String,default:"horizontal"},symbol:{type:null,default:fC},nextIcon:{type:mn,default:"$next"},prevIcon:{type:mn,default:"$prev"},showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["always","desktop","mobile"].includes(e)},...Cn(),...yh({selectedClass:"v-slide-group-item--active"})},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{isRtl:c}=Ea(),{mobile:d}=qg(),m=Uc(e,e.symbol),_=He(!1),s=He(0),w=He(0),E=He(0),A=ie(()=>e.direction==="horizontal"),{resizeRef:P,contentRect:L}=Rc(),{resizeRef:D,contentRect:N}=Rc(),Z=ie(()=>m.selected.value.length?m.items.value.findIndex(pt=>pt.id===m.selected.value[0]):-1),de=ie(()=>m.selected.value.length?m.items.value.findIndex(pt=>pt.id===m.selected.value[m.selected.value.length-1]):-1);if(Li){let pt=-1;Ke(()=>[m.selected.value,L.value,N.value,A.value],()=>{cancelAnimationFrame(pt),pt=requestAnimationFrame(()=>{if(L.value&&N.value){const Lt=A.value?"width":"height";w.value=L.value[Lt],E.value=N.value[Lt],_.value=w.value+1<E.value}if(Z.value>=0&&D.value){const Lt=D.value.children[de.value];Z.value===0||!_.value?s.value=0:e.centerActive?s.value=oO({selectedElement:Lt,containerSize:w.value,contentSize:E.value,isRtl:c.value,isHorizontal:A.value}):_.value&&(s.value=Jw({selectedElement:Lt,containerSize:w.value,contentSize:E.value,isRtl:c.value,currentScrollOffset:s.value,isHorizontal:A.value}))}})})}const ne=He(!1);let ce=0,K=0;function Se(pt){const Lt=A.value?"clientX":"clientY";K=(c.value&&A.value?-1:1)*s.value,ce=pt.touches[0][Lt],ne.value=!0}function Y(pt){if(!_.value)return;const Lt=A.value?"clientX":"clientY",qt=c.value&&A.value?-1:1;s.value=qt*(K+ce-pt.touches[0][Lt])}function _e(pt){const Lt=E.value-w.value;s.value<0||!_.value?s.value=0:s.value>=Lt&&(s.value=Lt),ne.value=!1}function fe(){!P.value||(P.value[A.value?"scrollLeft":"scrollTop"]=0)}const ve=He(!1);function Ee(pt){if(ve.value=!0,!(!_.value||!D.value)){for(const Lt of pt.composedPath())for(const qt of D.value.children)if(qt===Lt){s.value=Jw({selectedElement:qt,containerSize:w.value,contentSize:E.value,isRtl:c.value,currentScrollOffset:s.value,isHorizontal:A.value});return}}}function be(pt){ve.value=!1}function Re(pt){var Lt;!ve.value&&!(pt.relatedTarget&&(Lt=D.value)!=null&&Lt.contains(pt.relatedTarget))&&Je()}function ze(pt){!D.value||(A.value?pt.key==="ArrowRight"?Je(c.value?"prev":"next"):pt.key==="ArrowLeft"&&Je(c.value?"next":"prev"):pt.key==="ArrowDown"?Je("next"):pt.key==="ArrowUp"&&Je("prev"),pt.key==="Home"?Je("first"):pt.key==="End"&&Je("last"))}function Je(pt){if(!!D.value)if(pt){if(pt==="next"){var qt;const bt=(qt=D.value.querySelector(":focus"))==null?void 0:qt.nextElementSibling;bt?bt.focus():Je("first")}else if(pt==="prev"){var Bn;const bt=(Bn=D.value.querySelector(":focus"))==null?void 0:Bn.previousElementSibling;bt?bt.focus():Je("last")}else if(pt==="first"){var kt;(kt=D.value.firstElementChild)==null||kt.focus()}else if(pt==="last"){var Qe;(Qe=D.value.lastElementChild)==null||Qe.focus()}}else{var Lt;(Lt=[...D.value.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')].filter(Tt=>!Tt.hasAttribute("disabled"))[0])==null||Lt.focus()}}function ct(pt){const Lt=s.value+(pt==="prev"?-1:1)*w.value;s.value=Mo(Lt,0,E.value-w.value)}const nt=ie(()=>{let pt=s.value>E.value-w.value?-(E.value-w.value)+Kw(E.value-w.value-s.value):-s.value;s.value<=0&&(pt=Kw(-s.value));const Lt=c.value&&A.value?-1:1;return{transform:`translate${A.value?"X":"Y"}(${Lt*pt}px)`,transition:ne.value?"none":"",willChange:ne.value?"transform":""}}),ft=ie(()=>({next:m.next,prev:m.prev,select:m.select,isSelected:m.isSelected})),Pe=ie(()=>{switch(e.showArrows){case"always":return!0;case"desktop":return!d.value;case!0:return _.value||Math.abs(s.value)>0;case"mobile":return d.value||_.value||Math.abs(s.value)>0;default:return!d.value&&(_.value||Math.abs(s.value)>0)}}),at=ie(()=>Math.abs(s.value)>0),Gt=ie(()=>E.value>Math.abs(s.value)+w.value);return Mt(()=>{var pt,Lt,qt;return F(e.tag,{class:["v-slide-group",{"v-slide-group--vertical":!A.value,"v-slide-group--has-affixes":Pe.value,"v-slide-group--is-overflowing":_.value}],tabindex:ve.value||m.selected.value.length?-1:0,onFocus:Re},{default:()=>{var Bn,kt;return[Pe.value&&F("div",{key:"prev",class:["v-slide-group__prev",{"v-slide-group__prev--disabled":!at.value}],onClick:()=>ct("prev")},[(Bn=(pt=a.prev)==null?void 0:pt.call(a,ft.value))!=null?Bn:F(py,null,{default:()=>[F(Ni,{icon:c.value?e.nextIcon:e.prevIcon},null)]})]),F("div",{key:"container",ref:P,class:"v-slide-group__container",onScroll:fe},[F("div",{ref:D,class:"v-slide-group__content",style:nt.value,onTouchstartPassive:Se,onTouchmovePassive:Y,onTouchendPassive:_e,onFocusin:Ee,onFocusout:be,onKeydown:ze},[(Lt=a.default)==null?void 0:Lt.call(a,ft.value)])]),Pe.value&&F("div",{key:"next",class:["v-slide-group__next",{"v-slide-group__next--disabled":!Gt.value}],onClick:()=>ct("next")},[(kt=(qt=a.next)==null?void 0:qt.call(a,ft.value))!=null?kt:F(py,null,{default:()=>[F(Ni,{icon:c.value?e.prevIcon:e.nextIcon},null)]})])]}})}),{selected:m.selected,scrollTo:ct,scrollOffset:s,focus:Je}}}),sO=Di()({name:"VSlideGroupItem",props:{...Nc()},emits:{"group:selected":e=>!0},setup(e,o){let{slots:a}=o;const c=xh(e,fC);return()=>{var d;return(d=a.default)==null?void 0:d.call(a,{isSelected:c.isSelected.value,select:c.select,toggle:c.toggle,selectedClass:c.selectedClass.value})}}});const aO=Di()({name:"VSnackbar",props:{multiLine:Boolean,timeout:{type:[Number,String],default:5e3},vertical:Boolean,...jc({location:"bottom"}),...wh(),...Bi(),...No(),...Fg(Hf({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=Tn(e,"modelValue"),{locationStyles:d}=Gc(e),{positionClasses:m}=Sh(e),{scopeId:_}=Yg(),{colorClasses:s,colorStyles:w,variantClasses:E}=$c(e),{roundedClasses:A}=tr(e),P=He();Ke(c,D),Ke(()=>e.timeout,D),zn(()=>{c.value&&D()});let L=-1;function D(){window.clearTimeout(L);const Z=Number(e.timeout);!c.value||Z===-1||(L=window.setTimeout(()=>{c.value=!1},Z))}function N(){window.clearTimeout(L)}return Mt(()=>{const[Z]=Xg(e);return F(Ih,tn({ref:P,class:["v-snackbar",{"v-snackbar--active":c.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--vertical":e.vertical},m.value]},Z,{modelValue:c.value,"onUpdate:modelValue":de=>c.value=de,contentProps:tn({style:d.value},Z.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none"},_),{default:()=>[F("div",{class:["v-snackbar__wrapper",s.value,A.value,E.value],style:[w.value],onPointerenter:N,onPointerleave:D},[Vc(!1,"v-snackbar"),a.default&&F("div",{class:"v-snackbar__content",role:"status","aria-live":"polite"},[a.default()]),a.actions&&F(Ci,{defaults:{VBtn:{variant:"text",ripple:!1}}},{default:()=>[F("div",{class:"v-snackbar__actions"},[a.actions()])]})])],activator:a.activator})}),hs({},P)}});const lO=zt({name:"VSwitch",inheritAttrs:!1,props:{indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Ta(),...Wg()},emits:{"update:focused":e=>!0,"update:modelValue":()=>!0,"update:indeterminate":e=>!0},setup(e,o){let{attrs:a,slots:c}=o;const d=Tn(e,"indeterminate"),m=Tn(e,"modelValue"),{loaderClasses:_}=Gg(e),{isFocused:s,focus:w,blur:E}=qc(e),A=ie(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),P=Gr(),L=ie(()=>e.id||`switch-${P}`);function D(){d.value&&(d.value=!1)}return Mt(()=>{const[N,Z]=Fc(a),[de,ne]=Sl(e),[ce,K]=l2(e),Se=He();function Y(){var _e,fe;(_e=Se.value)==null||(fe=_e.input)==null||fe.click()}return F(Us,tn({class:["v-switch",{"v-switch--inset":e.inset},{"v-switch--indeterminate":d.value},_.value]},N,de,{id:L.value,focused:s.value}),{...c,default:_e=>{let{id:fe,isDisabled:ve,isReadonly:Ee,isValid:be}=_e;return F(Zf,tn({ref:Se},ce,{modelValue:m.value,"onUpdate:modelValue":[Re=>m.value=Re,D],id:fe.value,type:"checkbox","aria-checked":d.value?"mixed":void 0,disabled:ve.value,readonly:Ee.value,onFocus:w,onBlur:E},Z),{...c,default:()=>F("div",{class:"v-switch__track",onClick:Y},null),input:Re=>{let{textColorClasses:ze,textColorStyles:Je}=Re;return F("div",{class:["v-switch__thumb",ze.value],style:Je.value},[e.loading&&F(M0,{name:"v-switch",active:!0,color:be.value===!1?void 0:A.value},{default:ct=>c.loader?c.loader(ct):F(I0,{active:ct.isActive,color:ct.color,indeterminate:!0,size:"16",width:"2"},null)})])}})}})}),{}}});const cO=zt({name:"VSystemBar",props:{color:String,height:[Number,String],window:Boolean,...cr(),...vh(),...Bi(),...Cn(),...Kn()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=Si(e),{backgroundColorClasses:d,backgroundColorStyles:m}=er(Et(e,"color")),{elevationClasses:_}=zr(e),{roundedClasses:s}=tr(e),w=ie(()=>{var A;return(A=e.height)!=null?A:e.window?32:24}),{layoutItemStyles:E}=_h({id:e.name,order:ie(()=>parseInt(e.order,10)),position:He("top"),layoutSize:w,elementSize:w,active:ie(()=>!0),absolute:Et(e,"absolute")});return Mt(()=>F(e.tag,{class:["v-system-bar",{"v-system-bar--window":e.window},c.value,d.value,_.value,s.value],style:[m.value,E.value]},a)),{}}});const mC=Symbol.for("vuetify:v-tabs"),gC=zt({name:"VTab",props:{fixed:Boolean,icon:[Boolean,String,Function,Object],prependIcon:mn,appendIcon:mn,stacked:Boolean,title:String,ripple:{type:Boolean,default:!0},color:String,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Cn(),...Eh(),...Nc({selectedClass:"v-tab--selected"}),...Kn()},setup(e,o){let{slots:a,attrs:c}=o;const{textColorClasses:d,textColorStyles:m}=so(e,"sliderColor"),_=ie(()=>e.direction==="horizontal"),s=He(!1),w=He(),E=He();function A(P){let{value:L}=P;if(s.value=L,L){var D,N;const Z=(D=w.value)==null||(N=D.$el.parentElement)==null?void 0:N.querySelector(".v-tab--selected .v-tab__slider"),de=E.value;if(!Z||!de)return;const ne=getComputedStyle(Z).color,ce=Z.getBoundingClientRect(),K=de.getBoundingClientRect(),Se=_.value?"x":"y",Y=_.value?"X":"Y",_e=_.value?"right":"bottom",fe=_.value?"width":"height",ve=ce[Se],Ee=K[Se],be=ve>Ee?ce[_e]-K[_e]:ce[Se]-K[Se],Re=Math.sign(be)>0?_.value?"right":"bottom":Math.sign(be)<0?_.value?"left":"top":"center",Je=(Math.abs(be)+(Math.sign(be)<0?ce[fe]:K[fe]))/Math.max(ce[fe],K[fe]),ct=ce[fe]/K[fe],nt=1.5;Cc(de,{backgroundColor:[ne,""],transform:[`translate${Y}(${be}px) scale${Y}(${ct})`,`translate${Y}(${be/nt}px) scale${Y}(${(Je-1)/nt+1})`,""],transformOrigin:Array(3).fill(Re)},{duration:225,easing:Mf})}}return Mt(()=>{const[P]=Fo(e,["href","to","replace","icon","stacked","prependIcon","appendIcon","ripple","theme","disabled","selectedClass","value","color"]);return F(wi,tn({_as:"VTab",symbol:mC,ref:w,class:["v-tab"],tabindex:s.value?0:-1,role:"tab","aria-selected":String(s.value),active:!1,block:e.fixed,maxWidth:e.fixed?300:void 0,variant:"text",rounded:0},P,c,{"onGroup:selected":A}),{default:()=>[a.default?a.default():e.title,!e.hideSlider&&F("div",{ref:E,class:["v-tab__slider",d.value],style:m.value},null)]})}),{}}});function uO(e){return e?e.map(o=>typeof o=="string"?{title:o,value:o}:o):[]}const hO=zt({name:"VTabs",props:{alignTabs:{type:String,default:"start"},color:String,direction:{type:String,default:"horizontal"},fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,modelValue:null,mandatory:{type:[Boolean,String],default:"force"},...vr(),...Cn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=Tn(e,"modelValue"),d=ie(()=>uO(e.items)),{densityClasses:m}=qr(e),{backgroundColorClasses:_,backgroundColorStyles:s}=er(Et(e,"bgColor"));return ar({VTab:{color:Et(e,"color"),direction:Et(e,"direction"),stacked:Et(e,"stacked"),fixed:Et(e,"fixedTabs"),sliderColor:Et(e,"sliderColor"),hideSlider:Et(e,"hideSlider")}}),Mt(()=>F(pC,{modelValue:c.value,"onUpdate:modelValue":w=>c.value=w,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},m.value,_.value],style:[{"--v-tabs-height":Yt(e.height)},s.value],role:"tablist",symbol:mC,mandatory:e.mandatory,direction:e.direction},{default:()=>[a.default?a.default():d.value.map(w=>F(gC,tn(w,{key:w.title}),null))]})),{}}});const dO=zt({name:"VTable",props:{fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...vr(),...Cn(),...Kn()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=Si(e),{densityClasses:d}=qr(e);return Mt(()=>{var m,_;return F(e.tag,{class:["v-table",{"v-table--fixed-height":!!e.height,"v-table--fixed-header":e.fixedHeader,"v-table--fixed-footer":e.fixedFooter,"v-table--has-top":!!a.top,"v-table--has-bottom":!!a.bottom,"v-table--hover":e.hover},c.value,d.value]},{default:()=>[(m=a.top)==null?void 0:m.call(a),a.default&&F("div",{class:"v-table__wrapper",style:{height:Yt(e.height)}},[F("table",null,[a.default()])]),(_=a.bottom)==null?void 0:_.call(a)]})}),{}}});const fO=zt({name:"VTextarea",directives:{Intersect:Ug},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,hint:String,persistentHint:Boolean,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,...Ta(),...Kg()},emits:{"click:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,o){let{attrs:a,emit:c,slots:d}=o;const m=Tn(e,"modelValue"),{isFocused:_,focus:s,blur:w}=qc(e),E=ie(()=>typeof e.counterValue=="function"?e.counterValue(m.value):(m.value||"").toString().length),A=ie(()=>{if(a.maxlength)return a.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function P(Ee,be){var Re,ze;!e.autofocus||!Ee||(Re=be[0].target)==null||(ze=Re.focus)==null||ze.call(Re)}const L=He(),D=He(),N=He(""),Z=He(),de=ie(()=>_.value||e.persistentPlaceholder),ne=ie(()=>e.messages.length?e.messages:de.value||e.persistentHint?e.hint:"");function ce(){if(Z.value!==document.activeElement){var Ee;(Ee=Z.value)==null||Ee.focus()}_.value||s()}function K(Ee){ce(),c("click:control",Ee)}function Se(Ee){Ee.stopPropagation(),ce(),Xi(()=>{m.value="",dg(e["onClick:clear"],Ee)})}function Y(Ee){m.value=Ee.target.value}const _e=He();function fe(){!e.autoGrow||Xi(()=>{if(!_e.value||!D.value)return;const Ee=getComputedStyle(_e.value),be=getComputedStyle(D.value.$el),Re=parseFloat(Ee.getPropertyValue("--v-field-padding-top"))+parseFloat(Ee.getPropertyValue("--v-input-padding-top"))+parseFloat(Ee.getPropertyValue("--v-field-padding-bottom")),ze=_e.value.scrollHeight,Je=parseFloat(Ee.lineHeight),ct=Math.max(parseFloat(e.rows)*Je+Re,parseFloat(be.getPropertyValue("--v-input-control-height"))),nt=parseFloat(e.maxRows)*Je+Re||1/0;N.value=Yt(Mo(ze!=null?ze:0,ct,nt))})}zn(fe),Ke(m,fe),Ke(()=>e.rows,fe),Ke(()=>e.maxRows,fe),Ke(()=>e.density,fe);let ve;return Ke(_e,Ee=>{if(Ee)ve=new ResizeObserver(fe),ve.observe(_e.value);else{var be;(be=ve)==null||be.disconnect()}}),Ai(()=>{var Ee;(Ee=ve)==null||Ee.disconnect()}),Mt(()=>{const Ee=!!(d.counter||e.counter||e.counterValue),be=!!(Ee||d.details),[Re,ze]=Fc(a),[{modelValue:Je,...ct}]=Sl(e),[nt]=V0(e);return F(Us,tn({ref:L,modelValue:m.value,"onUpdate:modelValue":ft=>m.value=ft,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(e.variant)}],"onClick:prepend":e["onClick:prepend"],"onClick:append":e["onClick:append"]},Re,ct,{focused:_.value,messages:ne.value}),{...d,default:ft=>{let{isDisabled:Pe,isDirty:at,isReadonly:Gt,isValid:pt}=ft;return F(Xf,tn({ref:D,style:{"--v-textarea-control-height":N.value},"onClick:control":K,"onClick:clear":Se,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},nt,{active:de.value||at.value,dirty:at.value||e.dirty,focused:_.value,error:pt.value===!1}),{...d,default:Lt=>{let{props:{class:qt,...Bn}}=Lt;return F(Dn,null,[e.prefix&&F("span",{class:"v-text-field__prefix"},[e.prefix]),Yi(F("textarea",tn({ref:Z,class:qt,value:m.value,onInput:Y,autofocus:e.autofocus,readonly:Gt.value,disabled:Pe.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:ce,onBlur:w},Bn,ze),null),[[go("intersect"),{handler:P},null,{once:!0}]]),e.autoGrow&&Yi(F("textarea",{class:[qt,"v-textarea__sizer"],"onUpdate:modelValue":kt=>m.value=kt,ref:_e,readonly:!0,"aria-hidden":"true"},null),[[XP,m.value]]),e.suffix&&F("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:be?ft=>{var Pe;return F(Dn,null,[(Pe=d.details)==null?void 0:Pe.call(d,ft),Ee&&F(Dn,null,[F("span",null,null),F(Jg,{active:e.persistentCounter||_.value,value:E.value,max:A.value},d.counter)])])}:void 0})}),hs({},L,D,Z)}});const pO=zt({name:"VThemeProvider",props:{withBackground:Boolean,...Kn(),...Cn()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=Si(e);return()=>{var d,m;return e.withBackground?F(e.tag,{class:["v-theme-provider",c.value]},{default:()=>[(m=a.default)==null?void 0:m.call(a)]}):(d=a.default)==null?void 0:d.call(a)}}});const mO=zt({name:"VTimeline",props:{align:{type:String,default:"center",validator:e=>["center","start"].includes(e)},direction:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},justify:{type:String,default:"auto",validator:e=>["auto","center"].includes(e)},side:{type:String,validator:e=>e==null||["start","end"].includes(e)},lineInset:{type:[String,Number],default:0},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:e=>["start","end","both"].includes(e)},...vr(),...Cn(),...Kn()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=Si(e),{densityClasses:d}=qr(e);ar({VTimelineDivider:{lineColor:Et(e,"lineColor")},VTimelineItem:{density:Et(e,"density"),lineInset:Et(e,"lineInset")}});const m=ie(()=>{const s=e.side?e.side:e.density!=="default"?"end":null;return s&&`v-timeline--side-${s}`}),_=ie(()=>{const s=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(e.truncateLine){case"both":return s;case"start":return s[0];case"end":return s[1];default:return null}});return Mt(()=>F(e.tag,{class:["v-timeline",`v-timeline--${e.direction}`,`v-timeline--align-${e.align}`,`v-timeline--justify-${e.justify}`,_.value,{"v-timeline--inset-line":!!e.lineInset},c.value,d.value,m.value],style:{"--v-timeline-line-thickness":Yt(e.lineThickness)}},a)),{}}}),gO=zt({name:"VTimelineDivider",props:{dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:mn,iconColor:String,lineColor:String,...Bi(),...Sa(),...cr()},setup(e,o){let{slots:a}=o;const{sizeClasses:c,sizeStyles:d}=bh(e,"v-timeline-divider__dot"),{backgroundColorStyles:m,backgroundColorClasses:_}=er(Et(e,"dotColor")),{roundedClasses:s}=tr(e,"v-timeline-divider__dot"),{elevationClasses:w}=zr(e),{backgroundColorClasses:E,backgroundColorStyles:A}=er(Et(e,"lineColor"));return ar({VIcon:{color:Et(e,"iconColor"),icon:Et(e,"icon"),size:Et(e,"size")}}),Mt(()=>{var L;var P;return F("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":e.fillDot}]},[F("div",{class:["v-timeline-divider__before",E.value],style:A.value},null),!e.hideDot&&F("div",{key:"dot",class:["v-timeline-divider__dot",w.value,s.value,c.value],style:d.value},[F("div",{class:["v-timeline-divider__inner-dot",_.value,s.value],style:m.value},[(L=(P=a.default)==null?void 0:P.call(a))!=null?L:e.icon?F(Ni,null,null):void 0])]),F("div",{class:["v-timeline-divider__after",E.value],style:A.value},null)])}),{}}}),vO=zt({name:"VTimelineItem",props:{density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:mn,iconColor:String,lineInset:[Number,String],...Bi(),...cr(),...Sa(),...Cn(),...ls()},setup(e,o){let{slots:a}=o;const{dimensionStyles:c}=cs(e),d=He(0),m=He();return Ke(m,_=>{var w;var s;!_||(d.value=(w=(s=_.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:s.getBoundingClientRect().width)!=null?w:0)},{flush:"post"}),Mt(()=>{var _,s;return F("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":e.fillDot}],style:{"--v-timeline-dot-size":Yt(d.value),"--v-timeline-line-inset":e.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${Yt(e.lineInset)})`:Yt(0)}},[F("div",{class:"v-timeline-item__body",style:c.value},[(_=a.default)==null?void 0:_.call(a)]),F(gO,{ref:m,hideDot:e.hideDot,icon:e.icon,iconColor:e.iconColor,size:e.size,elevation:e.elevation,dotColor:e.dotColor,fillDot:e.fillDot,rounded:e.rounded},{default:a.icon}),e.density!=="compact"&&F("div",{class:"v-timeline-item__opposite"},[!e.hideOpposite&&((s=a.opposite)==null?void 0:s.call(a))])])}),{}}});const _O=Di()({name:"VTooltip",props:{id:String,text:String,...Fg(Hf({closeOnBack:!1,location:"end",locationStrategy:"connected",minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent","eager"])},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=Tn(e,"modelValue"),{scopeId:d}=Yg(),m=Gr(),_=ie(()=>e.id||`v-tooltip-${m}`),s=He(),w=ie(()=>e.location.split(" ").length>1?e.location:e.location+" center"),E=ie(()=>e.origin==="auto"||e.origin==="overlap"||e.origin.split(" ").length>1||e.location.split(" ").length>1?e.origin:e.origin+" center"),A=ie(()=>e.transition?e.transition:c.value?"scale-transition":"fade-transition");return Mt(()=>{const[P]=Xg(e);return F(Ih,tn({ref:s,class:["v-tooltip"],id:_.value},P,{modelValue:c.value,"onUpdate:modelValue":L=>c.value=L,transition:A.value,absolute:!0,location:w.value,origin:E.value,persistent:!0,role:"tooltip",eager:!0,activatorProps:tn({"aria-describedby":_.value},e.activatorProps)},d),{activator:a.activator,default:function(){var de;for(var L,D=arguments.length,N=new Array(D),Z=0;Z<D;Z++)N[Z]=arguments[Z];return(de=(L=a.default)==null?void 0:L.call(a,...N))!=null?de:e.text}})}),hs({},s)}}),yO=zt({name:"VValidation",props:{...i2()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=r2(e,"validation");return()=>{var d;return(d=a.default)==null?void 0:d.call(a,c)}}}),xO=Object.freeze(Object.defineProperty({__proto__:null,VApp:TR,VAppBar:PT,VAppBarNavIcon:HT,VAppBarTitle:BL,VAlert:IR,VAlertTitle:e2,VAutocomplete:SD,VAvatar:yl,VBadge:ED,VBanner:TD,VBannerActions:L2,VBannerText:R2,VBottomNavigation:CD,VBreadcrumbs:ID,VBreadcrumbsItem:B2,VBreadcrumbsDivider:D2,VBtn:wi,VBtnGroup:zT,VBtnToggle:uL,VCard:zc,VCardActions:N0,VCardItem:V2,VCardSubtitle:O2,VCardText:U0,VCardTitle:F2,VCarousel:DD,VCarouselItem:BD,VCheckbox:LR,VCheckboxBtn:Ch,VChip:Wf,VChipGroup:DR,VCode:OD,VColorPicker:vB,VCombobox:yB,VCounter:Jg,VDefaultsProvider:Ci,VDialog:xB,VDivider:h2,VExpansionPanels:wB,VExpansionPanel:SB,VExpansionPanelText:J2,VExpansionPanelTitle:K2,VField:Xf,VFieldLabel:uf,VFileInput:EB,VFooter:TB,VForm:CB,VContainer:IB,VCol:wg,VRow:cC,VSpacer:uC,VHover:BB,VIcon:Ni,VComponentIcon:RT,VSvgIcon:DT,VLigatureIcon:fL,VClassIcon:T0,VImg:gh,VInput:Us,VItemGroup:OB,VItem:FB,VKbd:VB,VLabel:Th,VLayout:XT,VLayoutItem:$L,VLazy:$B,VList:js,VListGroup:D0,VListImg:XR,VListItem:Hi,VListItemAction:YR,VListItemMedia:KR,VListItemSubtitle:_2,VListItemTitle:B0,VListSubheader:y2,VLocaleProvider:NB,VMain:YT,VMenu:Ah,VMessages:t2,VNavigationDrawer:dC,VNoSsr:YB,VOverlay:Ih,VPagination:JB,VParallax:eO,VProgressCircular:I0,VProgressLinear:A0,VRadio:tO,VRadioGroup:nO,VRangeSlider:iO,VRating:rO,VResponsive:ST,VSelect:yD,VSelectionControl:Zf,VSelectionControlGroup:a2,VSheet:X2,VSlideGroup:pC,VSlideGroupItem:sO,VSlider:bg,VSnackbar:aO,VSwitch:lO,VSystemBar:cO,VTabs:hO,VTab:gC,VTable:dO,VTextarea:fO,VTextField:Yf,VThemeProvider:pO,VTimeline:mO,VTimelineItem:vO,VToolbar:vg,VToolbarTitle:gg,VToolbarItems:DL,VTooltip:_O,VValidation:yO,VWindow:U2,VWindowItem:j2,VDialogTransition:$g,VFabTransition:Rz,VDialogBottomTransition:Dz,VDialogTopTransition:Bz,VFadeTransition:py,VScaleTransition:wT,VScrollXTransition:Oz,VScrollXReverseTransition:Fz,VScrollYTransition:Vz,VScrollYReverseTransition:$z,VSlideXTransition:Nz,VSlideXReverseTransition:Uz,VSlideYTransition:b0,VSlideYReverseTransition:jz,VExpandTransition:Ng,VExpandXTransition:w0},Symbol.toStringTag,{value:"Module"}));function bO(e,o){var P,L,D,N;const a=o.modifiers||{},c=o.value,{once:d,immediate:m,..._}=a,s=!Object.keys(_).length,{handler:w,options:E}=typeof c=="object"?c:{handler:c,options:{attributes:(P=_==null?void 0:_.attr)!=null?P:s,characterData:(L=_==null?void 0:_.char)!=null?L:s,childList:(D=_==null?void 0:_.child)!=null?D:s,subtree:(N=_==null?void 0:_.sub)!=null?N:s}},A=new MutationObserver(function(){let Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],de=arguments.length>1?arguments[1]:void 0;w==null||w(Z,de),d&&vC(e,o)});m&&(w==null||w([],A)),e._mutate=Object(e._mutate),e._mutate[o.instance.$.uid]={observer:A},A.observe(e,E)}function vC(e,o){var a;!((a=e._mutate)!=null&&a[o.instance.$.uid])||(e._mutate[o.instance.$.uid].observer.disconnect(),delete e._mutate[o.instance.$.uid])}const wO={mounted:bO,unmounted:vC};function SO(e,o){var a,c;const d=o.value,m={passive:!((a=o.modifiers)!=null&&a.active)};window.addEventListener("resize",d,m),e._onResize=Object(e._onResize),e._onResize[o.instance.$.uid]={handler:d,options:m},(c=o.modifiers)!=null&&c.quiet||d()}function EO(e,o){var a;if(!((a=e._onResize)!=null&&a[o.instance.$.uid]))return;const{handler:c,options:d}=e._onResize[o.instance.$.uid];window.removeEventListener("resize",c,d),delete e._onResize[o.instance.$.uid]}const TO={mounted:SO,unmounted:EO};function _C(e,o){var s;const{self:a=!1}=(s=o.modifiers)!=null?s:{},c=o.value,d=typeof c=="object"&&c.options||{passive:!0},m=typeof c=="function"||"handleEvent"in c?c:c.handler,_=a?e:o.arg?document.querySelector(o.arg):window;!_||(_.addEventListener("scroll",m,d),e._onScroll=Object(e._onScroll),e._onScroll[o.instance.$.uid]={handler:m,options:d,target:a?void 0:_})}function yC(e,o){var a;if(!((a=e._onScroll)!=null&&a[o.instance.$.uid]))return;const{handler:c,options:d,target:m=e}=e._onScroll[o.instance.$.uid];m.removeEventListener("scroll",c,d),delete e._onScroll[o.instance.$.uid]}function CO(e,o){o.value!==o.oldValue&&(yC(e,o),_C(e,o))}const IO={mounted:_C,unmounted:yC,updated:CO},AO=Object.freeze(Object.defineProperty({__proto__:null,ClickOutside:M2,Intersect:TT,Mutate:wO,Resize:TO,Ripple:wl,Scroll:IO,Touch:j0},Symbol.toStringTag,{value:"Module"})),kO={dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF",primary:"#f6f8fc",secondary:"#d5e0fc",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},fonts:{body:"Roboto",heading:"Roboto",button:"Roboto"}},MO=QT({components:xO,directives:AO,theme:{defaultTheme:"myCustomLightTheme",themes:{myCustomLightTheme:kO}}});/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const nh=typeof window<"u";function PO(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const bi=Object.assign;function O_(e,o){const a={};for(const c in o){const d=o[c];a[c]=as(d)?d.map(e):e(d)}return a}const yf=()=>{},as=Array.isArray,zO=/\/$/,LO=e=>e.replace(zO,"");function F_(e,o,a="/"){let c,d={},m="",_="";const s=o.indexOf("#");let w=o.indexOf("?");return s<w&&s>=0&&(w=-1),w>-1&&(c=o.slice(0,w),m=o.slice(w+1,s>-1?s:o.length),d=e(m)),s>-1&&(c=c||o.slice(0,s),_=o.slice(s,o.length)),c=OO(c!=null?c:o,a),{fullPath:c+(m&&"?")+m+_,path:c,query:d,hash:_}}function RO(e,o){const a=o.query?e(o.query):"";return o.path+(a&&"?")+a+(o.hash||"")}function Qw(e,o){return!o||!e.toLowerCase().startsWith(o.toLowerCase())?e:e.slice(o.length)||"/"}function DO(e,o,a){const c=o.matched.length-1,d=a.matched.length-1;return c>-1&&c===d&&dh(o.matched[c],a.matched[d])&&xC(o.params,a.params)&&e(o.query)===e(a.query)&&o.hash===a.hash}function dh(e,o){return(e.aliasOf||e)===(o.aliasOf||o)}function xC(e,o){if(Object.keys(e).length!==Object.keys(o).length)return!1;for(const a in e)if(!BO(e[a],o[a]))return!1;return!0}function BO(e,o){return as(e)?eS(e,o):as(o)?eS(o,e):e===o}function eS(e,o){return as(o)?e.length===o.length&&e.every((a,c)=>a===o[c]):e.length===1&&e[0]===o}function OO(e,o){if(e.startsWith("/"))return e;if(!e)return o;const a=o.split("/"),c=e.split("/");let d=a.length-1,m,_;for(m=0;m<c.length;m++)if(_=c[m],_!==".")if(_==="..")d>1&&d--;else break;return a.slice(0,d).join("/")+"/"+c.slice(m-(m===c.length?1:0)).join("/")}var Ff;(function(e){e.pop="pop",e.push="push"})(Ff||(Ff={}));var xf;(function(e){e.back="back",e.forward="forward",e.unknown=""})(xf||(xf={}));function FO(e){if(!e)if(nh){const o=document.querySelector("base");e=o&&o.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),LO(e)}const VO=/^[^#]+#/;function $O(e,o){return e.replace(VO,"#")+o}function NO(e,o){const a=document.documentElement.getBoundingClientRect(),c=e.getBoundingClientRect();return{behavior:o.behavior,left:c.left-a.left-(o.left||0),top:c.top-a.top-(o.top||0)}}const Qg=()=>({left:window.pageXOffset,top:window.pageYOffset});function UO(e){let o;if("el"in e){const a=e.el,c=typeof a=="string"&&a.startsWith("#"),d=typeof a=="string"?c?document.getElementById(a.slice(1)):document.querySelector(a):a;if(!d)return;o=NO(d,e)}else o=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(o):window.scrollTo(o.left!=null?o.left:window.pageXOffset,o.top!=null?o.top:window.pageYOffset)}function tS(e,o){return(history.state?history.state.position-o:-1)+e}const Ay=new Map;function jO(e,o){Ay.set(e,o)}function GO(e){const o=Ay.get(e);return Ay.delete(e),o}let qO=()=>location.protocol+"//"+location.host;function bC(e,o){const{pathname:a,search:c,hash:d}=o,m=e.indexOf("#");if(m>-1){let s=d.includes(e.slice(m))?e.slice(m).length:1,w=d.slice(s);return w[0]!=="/"&&(w="/"+w),Qw(w,"")}return Qw(a,e)+c+d}function ZO(e,o,a,c){let d=[],m=[],_=null;const s=({state:L})=>{const D=bC(e,location),N=a.value,Z=o.value;let de=0;if(L){if(a.value=D,o.value=L,_&&_===N){_=null;return}de=Z?L.position-Z.position:0}else c(D);d.forEach(ne=>{ne(a.value,N,{delta:de,type:Ff.pop,direction:de?de>0?xf.forward:xf.back:xf.unknown})})};function w(){_=a.value}function E(L){d.push(L);const D=()=>{const N=d.indexOf(L);N>-1&&d.splice(N,1)};return m.push(D),D}function A(){const{history:L}=window;!L.state||L.replaceState(bi({},L.state,{scroll:Qg()}),"")}function P(){for(const L of m)L();m=[],window.removeEventListener("popstate",s),window.removeEventListener("beforeunload",A)}return window.addEventListener("popstate",s),window.addEventListener("beforeunload",A),{pauseListeners:w,listen:E,destroy:P}}function nS(e,o,a,c=!1,d=!1){return{back:e,current:o,forward:a,replaced:c,position:window.history.length,scroll:d?Qg():null}}function WO(e){const{history:o,location:a}=window,c={value:bC(e,a)},d={value:o.state};d.value||m(c.value,{back:null,current:c.value,forward:null,position:o.length-1,replaced:!0,scroll:null},!0);function m(w,E,A){const P=e.indexOf("#"),L=P>-1?(a.host&&document.querySelector("base")?e:e.slice(P))+w:qO()+e+w;try{o[A?"replaceState":"pushState"](E,"",L),d.value=E}catch(D){console.error(D),a[A?"replace":"assign"](L)}}function _(w,E){const A=bi({},o.state,nS(d.value.back,w,d.value.forward,!0),E,{position:d.value.position});m(w,A,!0),c.value=w}function s(w,E){const A=bi({},d.value,o.state,{forward:w,scroll:Qg()});m(A.current,A,!0);const P=bi({},nS(c.value,w,null),{position:A.position+1},E);m(w,P,!1),c.value=w}return{location:c,state:d,push:s,replace:_}}function HO(e){e=FO(e);const o=WO(e),a=ZO(e,o.state,o.location,o.replace);function c(m,_=!0){_||a.pauseListeners(),history.go(m)}const d=bi({location:"",base:e,go:c,createHref:$O.bind(null,e)},o,a);return Object.defineProperty(d,"location",{enumerable:!0,get:()=>o.location.value}),Object.defineProperty(d,"state",{enumerable:!0,get:()=>o.state.value}),d}function XO(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),HO(e)}function YO(e){return typeof e=="string"||e&&typeof e=="object"}function wC(e){return typeof e=="string"||typeof e=="symbol"}const ll={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},SC=Symbol("");var iS;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(iS||(iS={}));function fh(e,o){return bi(new Error,{type:e,[SC]:!0},o)}function ha(e,o){return e instanceof Error&&SC in e&&(o==null||!!(e.type&o))}const rS="[^/]+?",KO={sensitive:!1,strict:!1,start:!0,end:!0},JO=/[.+*?^${}()[\]/\\]/g;function QO(e,o){const a=bi({},KO,o),c=[];let d=a.start?"^":"";const m=[];for(const E of e){const A=E.length?[]:[90];a.strict&&!E.length&&(d+="/");for(let P=0;P<E.length;P++){const L=E[P];let D=40+(a.sensitive?.25:0);if(L.type===0)P||(d+="/"),d+=L.value.replace(JO,"\\$&"),D+=40;else if(L.type===1){const{value:N,repeatable:Z,optional:de,regexp:ne}=L;m.push({name:N,repeatable:Z,optional:de});const ce=ne||rS;if(ce!==rS){D+=10;try{new RegExp(`(${ce})`)}catch(Se){throw new Error(`Invalid custom RegExp for param "${N}" (${ce}): `+Se.message)}}let K=Z?`((?:${ce})(?:/(?:${ce}))*)`:`(${ce})`;P||(K=de&&E.length<2?`(?:/${K})`:"/"+K),de&&(K+="?"),d+=K,D+=20,de&&(D+=-8),Z&&(D+=-20),ce===".*"&&(D+=-50)}A.push(D)}c.push(A)}if(a.strict&&a.end){const E=c.length-1;c[E][c[E].length-1]+=.7000000000000001}a.strict||(d+="/?"),a.end?d+="$":a.strict&&(d+="(?:/|$)");const _=new RegExp(d,a.sensitive?"":"i");function s(E){const A=E.match(_),P={};if(!A)return null;for(let L=1;L<A.length;L++){const D=A[L]||"",N=m[L-1];P[N.name]=D&&N.repeatable?D.split("/"):D}return P}function w(E){let A="",P=!1;for(const L of e){(!P||!A.endsWith("/"))&&(A+="/"),P=!1;for(const D of L)if(D.type===0)A+=D.value;else if(D.type===1){const{value:N,repeatable:Z,optional:de}=D,ne=N in E?E[N]:"";if(as(ne)&&!Z)throw new Error(`Provided param "${N}" is an array but it is not repeatable (* or + modifiers)`);const ce=as(ne)?ne.join("/"):ne;if(!ce)if(de)L.length<2&&(A.endsWith("/")?A=A.slice(0,-1):P=!0);else throw new Error(`Missing required param "${N}"`);A+=ce}}return A||"/"}return{re:_,score:c,keys:m,parse:s,stringify:w}}function e3(e,o){let a=0;for(;a<e.length&&a<o.length;){const c=o[a]-e[a];if(c)return c;a++}return e.length<o.length?e.length===1&&e[0]===40+40?-1:1:e.length>o.length?o.length===1&&o[0]===40+40?1:-1:0}function t3(e,o){let a=0;const c=e.score,d=o.score;for(;a<c.length&&a<d.length;){const m=e3(c[a],d[a]);if(m)return m;a++}if(Math.abs(d.length-c.length)===1){if(oS(c))return 1;if(oS(d))return-1}return d.length-c.length}function oS(e){const o=e[e.length-1];return e.length>0&&o[o.length-1]<0}const n3={type:0,value:""},i3=/[a-zA-Z0-9_]/;function r3(e){if(!e)return[[]];if(e==="/")return[[n3]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function o(D){throw new Error(`ERR (${a})/"${E}": ${D}`)}let a=0,c=a;const d=[];let m;function _(){m&&d.push(m),m=[]}let s=0,w,E="",A="";function P(){!E||(a===0?m.push({type:0,value:E}):a===1||a===2||a===3?(m.length>1&&(w==="*"||w==="+")&&o(`A repeatable param (${E}) must be alone in its segment. eg: '/:ids+.`),m.push({type:1,value:E,regexp:A,repeatable:w==="*"||w==="+",optional:w==="*"||w==="?"})):o("Invalid state to consume buffer"),E="")}function L(){E+=w}for(;s<e.length;){if(w=e[s++],w==="\\"&&a!==2){c=a,a=4;continue}switch(a){case 0:w==="/"?(E&&P(),_()):w===":"?(P(),a=1):L();break;case 4:L(),a=c;break;case 1:w==="("?a=2:i3.test(w)?L():(P(),a=0,w!=="*"&&w!=="?"&&w!=="+"&&s--);break;case 2:w===")"?A[A.length-1]=="\\"?A=A.slice(0,-1)+w:a=3:A+=w;break;case 3:P(),a=0,w!=="*"&&w!=="?"&&w!=="+"&&s--,A="";break;default:o("Unknown state");break}}return a===2&&o(`Unfinished custom RegExp for param "${E}"`),P(),_(),d}function o3(e,o,a){const c=QO(r3(e.path),a),d=bi(c,{record:e,parent:o,children:[],alias:[]});return o&&!d.record.aliasOf==!o.record.aliasOf&&o.children.push(d),d}function s3(e,o){const a=[],c=new Map;o=lS({strict:!1,end:!0,sensitive:!1},o);function d(A){return c.get(A)}function m(A,P,L){const D=!L,N=a3(A);N.aliasOf=L&&L.record;const Z=lS(o,A),de=[N];if("alias"in A){const K=typeof A.alias=="string"?[A.alias]:A.alias;for(const Se of K)de.push(bi({},N,{components:L?L.record.components:N.components,path:Se,aliasOf:L?L.record:N}))}let ne,ce;for(const K of de){const{path:Se}=K;if(P&&Se[0]!=="/"){const Y=P.record.path,_e=Y[Y.length-1]==="/"?"":"/";K.path=P.record.path+(Se&&_e+Se)}if(ne=o3(K,P,Z),L?L.alias.push(ne):(ce=ce||ne,ce!==ne&&ce.alias.push(ne),D&&A.name&&!aS(ne)&&_(A.name)),N.children){const Y=N.children;for(let _e=0;_e<Y.length;_e++)m(Y[_e],ne,L&&L.children[_e])}L=L||ne,(ne.record.components&&Object.keys(ne.record.components).length||ne.record.name||ne.record.redirect)&&w(ne)}return ce?()=>{_(ce)}:yf}function _(A){if(wC(A)){const P=c.get(A);P&&(c.delete(A),a.splice(a.indexOf(P),1),P.children.forEach(_),P.alias.forEach(_))}else{const P=a.indexOf(A);P>-1&&(a.splice(P,1),A.record.name&&c.delete(A.record.name),A.children.forEach(_),A.alias.forEach(_))}}function s(){return a}function w(A){let P=0;for(;P<a.length&&t3(A,a[P])>=0&&(A.record.path!==a[P].record.path||!EC(A,a[P]));)P++;a.splice(P,0,A),A.record.name&&!aS(A)&&c.set(A.record.name,A)}function E(A,P){let L,D={},N,Z;if("name"in A&&A.name){if(L=c.get(A.name),!L)throw fh(1,{location:A});Z=L.record.name,D=bi(sS(P.params,L.keys.filter(ce=>!ce.optional).map(ce=>ce.name)),A.params&&sS(A.params,L.keys.map(ce=>ce.name))),N=L.stringify(D)}else if("path"in A)N=A.path,L=a.find(ce=>ce.re.test(N)),L&&(D=L.parse(N),Z=L.record.name);else{if(L=P.name?c.get(P.name):a.find(ce=>ce.re.test(P.path)),!L)throw fh(1,{location:A,currentLocation:P});Z=L.record.name,D=bi({},P.params,A.params),N=L.stringify(D)}const de=[];let ne=L;for(;ne;)de.unshift(ne.record),ne=ne.parent;return{name:Z,path:N,params:D,matched:de,meta:c3(de)}}return e.forEach(A=>m(A)),{addRoute:m,resolve:E,removeRoute:_,getRoutes:s,getRecordMatcher:d}}function sS(e,o){const a={};for(const c of o)c in e&&(a[c]=e[c]);return a}function a3(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:l3(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function l3(e){const o={},a=e.props||!1;if("component"in e)o.default=a;else for(const c in e.components)o[c]=typeof a=="boolean"?a:a[c];return o}function aS(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function c3(e){return e.reduce((o,a)=>bi(o,a.meta),{})}function lS(e,o){const a={};for(const c in e)a[c]=c in o?o[c]:e[c];return a}function EC(e,o){return o.children.some(a=>a===e||EC(e,a))}const TC=/#/g,u3=/&/g,h3=/\//g,d3=/=/g,f3=/\?/g,CC=/\+/g,p3=/%5B/g,m3=/%5D/g,IC=/%5E/g,g3=/%60/g,AC=/%7B/g,v3=/%7C/g,kC=/%7D/g,_3=/%20/g;function H0(e){return encodeURI(""+e).replace(v3,"|").replace(p3,"[").replace(m3,"]")}function y3(e){return H0(e).replace(AC,"{").replace(kC,"}").replace(IC,"^")}function ky(e){return H0(e).replace(CC,"%2B").replace(_3,"+").replace(TC,"%23").replace(u3,"%26").replace(g3,"`").replace(AC,"{").replace(kC,"}").replace(IC,"^")}function x3(e){return ky(e).replace(d3,"%3D")}function b3(e){return H0(e).replace(TC,"%23").replace(f3,"%3F")}function w3(e){return e==null?"":b3(e).replace(h3,"%2F")}function Sg(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function S3(e){const o={};if(e===""||e==="?")return o;const c=(e[0]==="?"?e.slice(1):e).split("&");for(let d=0;d<c.length;++d){const m=c[d].replace(CC," "),_=m.indexOf("="),s=Sg(_<0?m:m.slice(0,_)),w=_<0?null:Sg(m.slice(_+1));if(s in o){let E=o[s];as(E)||(E=o[s]=[E]),E.push(w)}else o[s]=w}return o}function cS(e){let o="";for(let a in e){const c=e[a];if(a=x3(a),c==null){c!==void 0&&(o+=(o.length?"&":"")+a);continue}(as(c)?c.map(m=>m&&ky(m)):[c&&ky(c)]).forEach(m=>{m!==void 0&&(o+=(o.length?"&":"")+a,m!=null&&(o+="="+m))})}return o}function E3(e){const o={};for(const a in e){const c=e[a];c!==void 0&&(o[a]=as(c)?c.map(d=>d==null?null:""+d):c==null?c:""+c)}return o}const T3=Symbol(""),uS=Symbol(""),ev=Symbol(""),MC=Symbol(""),My=Symbol("");function of(){let e=[];function o(c){return e.push(c),()=>{const d=e.indexOf(c);d>-1&&e.splice(d,1)}}function a(){e=[]}return{add:o,list:()=>e,reset:a}}function dl(e,o,a,c,d){const m=c&&(c.enterCallbacks[d]=c.enterCallbacks[d]||[]);return()=>new Promise((_,s)=>{const w=P=>{P===!1?s(fh(4,{from:a,to:o})):P instanceof Error?s(P):YO(P)?s(fh(2,{from:o,to:P})):(m&&c.enterCallbacks[d]===m&&typeof P=="function"&&m.push(P),_())},E=e.call(c&&c.instances[d],o,a,w);let A=Promise.resolve(E);e.length<3&&(A=A.then(w)),A.catch(P=>s(P))})}function V_(e,o,a,c){const d=[];for(const m of e)for(const _ in m.components){let s=m.components[_];if(!(o!=="beforeRouteEnter"&&!m.instances[_]))if(C3(s)){const E=(s.__vccOpts||s)[o];E&&d.push(dl(E,a,c,m,_))}else{let w=s();d.push(()=>w.then(E=>{if(!E)return Promise.reject(new Error(`Couldn't resolve component "${_}" at "${m.path}"`));const A=PO(E)?E.default:E;m.components[_]=A;const L=(A.__vccOpts||A)[o];return L&&dl(L,a,c,m,_)()}))}}return d}function C3(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function hS(e){const o=cn(ev),a=cn(MC),c=ie(()=>o.resolve(pi(e.to))),d=ie(()=>{const{matched:w}=c.value,{length:E}=w,A=w[E-1],P=a.matched;if(!A||!P.length)return-1;const L=P.findIndex(dh.bind(null,A));if(L>-1)return L;const D=dS(w[E-2]);return E>1&&dS(A)===D&&P[P.length-1].path!==D?P.findIndex(dh.bind(null,w[E-2])):L}),m=ie(()=>d.value>-1&&M3(a.params,c.value.params)),_=ie(()=>d.value>-1&&d.value===a.matched.length-1&&xC(a.params,c.value.params));function s(w={}){return k3(w)?o[pi(e.replace)?"replace":"push"](pi(e.to)).catch(yf):Promise.resolve()}return{route:c,href:ie(()=>c.value.href),isActive:m,isExactActive:_,navigate:s}}const I3=vn({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:hS,setup(e,{slots:o}){const a=$i(hS(e)),{options:c}=cn(ev),d=ie(()=>({[fS(e.activeClass,c.linkActiveClass,"router-link-active")]:a.isActive,[fS(e.exactActiveClass,c.linkExactActiveClass,"router-link-exact-active")]:a.isExactActive}));return()=>{const m=o.default&&o.default(a);return e.custom?m:$s("a",{"aria-current":a.isExactActive?e.ariaCurrentValue:null,href:a.href,onClick:a.navigate,class:d.value},m)}}}),A3=I3;function k3(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const o=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(o))return}return e.preventDefault&&e.preventDefault(),!0}}function M3(e,o){for(const a in o){const c=o[a],d=e[a];if(typeof c=="string"){if(c!==d)return!1}else if(!as(d)||d.length!==c.length||c.some((m,_)=>m!==d[_]))return!1}return!0}function dS(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const fS=(e,o,a)=>e!=null?e:o!=null?o:a,P3=vn({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:o,slots:a}){const c=cn(My),d=ie(()=>e.route||c.value),m=cn(uS,0),_=ie(()=>{let E=pi(m);const{matched:A}=d.value;let P;for(;(P=A[E])&&!P.components;)E++;return E}),s=ie(()=>d.value.matched[_.value]);Wi(uS,ie(()=>_.value+1)),Wi(T3,s),Wi(My,d);const w=He();return Ke(()=>[w.value,s.value,e.name],([E,A,P],[L,D,N])=>{A&&(A.instances[P]=E,D&&D!==A&&E&&E===L&&(A.leaveGuards.size||(A.leaveGuards=D.leaveGuards),A.updateGuards.size||(A.updateGuards=D.updateGuards))),E&&A&&(!D||!dh(A,D)||!L)&&(A.enterCallbacks[P]||[]).forEach(Z=>Z(E))},{flush:"post"}),()=>{const E=d.value,A=e.name,P=s.value,L=P&&P.components[A];if(!L)return pS(a.default,{Component:L,route:E});const D=P.props[A],N=D?D===!0?E.params:typeof D=="function"?D(E):D:null,de=$s(L,bi({},N,o,{onVnodeUnmounted:ne=>{ne.component.isUnmounted&&(P.instances[A]=null)},ref:w}));return pS(a.default,{Component:de,route:E})||de}}});function pS(e,o){if(!e)return null;const a=e(o);return a.length===1?a[0]:a}const z3=P3;function L3(e){const o=s3(e.routes,e),a=e.parseQuery||S3,c=e.stringifyQuery||cS,d=e.history,m=of(),_=of(),s=of(),w=Ii(ll);let E=ll;nh&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const A=O_.bind(null,Qe=>""+Qe),P=O_.bind(null,w3),L=O_.bind(null,Sg);function D(Qe,bt){let Tt,Ut;return wC(Qe)?(Tt=o.getRecordMatcher(Qe),Ut=bt):Ut=Qe,o.addRoute(Ut,Tt)}function N(Qe){const bt=o.getRecordMatcher(Qe);bt&&o.removeRoute(bt)}function Z(){return o.getRoutes().map(Qe=>Qe.record)}function de(Qe){return!!o.getRecordMatcher(Qe)}function ne(Qe,bt){if(bt=bi({},bt||w.value),typeof Qe=="string"){const he=F_(a,Qe,bt.path),Me=o.resolve({path:he.path},bt),qe=d.createHref(he.fullPath);return bi(he,Me,{params:L(Me.params),hash:Sg(he.hash),redirectedFrom:void 0,href:qe})}let Tt;if("path"in Qe)Tt=bi({},Qe,{path:F_(a,Qe.path,bt.path).path});else{const he=bi({},Qe.params);for(const Me in he)he[Me]==null&&delete he[Me];Tt=bi({},Qe,{params:P(Qe.params)}),bt.params=P(bt.params)}const Ut=o.resolve(Tt,bt),pn=Qe.hash||"";Ut.params=A(L(Ut.params));const Fn=RO(c,bi({},Qe,{hash:y3(pn),path:Ut.path})),_n=d.createHref(Fn);return bi({fullPath:Fn,hash:pn,query:c===cS?E3(Qe.query):Qe.query||{}},Ut,{redirectedFrom:void 0,href:_n})}function ce(Qe){return typeof Qe=="string"?F_(a,Qe,w.value.path):bi({},Qe)}function K(Qe,bt){if(E!==Qe)return fh(8,{from:bt,to:Qe})}function Se(Qe){return fe(Qe)}function Y(Qe){return Se(bi(ce(Qe),{replace:!0}))}function _e(Qe){const bt=Qe.matched[Qe.matched.length-1];if(bt&&bt.redirect){const{redirect:Tt}=bt;let Ut=typeof Tt=="function"?Tt(Qe):Tt;return typeof Ut=="string"&&(Ut=Ut.includes("?")||Ut.includes("#")?Ut=ce(Ut):{path:Ut},Ut.params={}),bi({query:Qe.query,hash:Qe.hash,params:"path"in Ut?{}:Qe.params},Ut)}}function fe(Qe,bt){const Tt=E=ne(Qe),Ut=w.value,pn=Qe.state,Fn=Qe.force,_n=Qe.replace===!0,he=_e(Tt);if(he)return fe(bi(ce(he),{state:typeof he=="object"?bi({},pn,he.state):pn,force:Fn,replace:_n}),bt||Tt);const Me=Tt;Me.redirectedFrom=bt;let qe;return!Fn&&DO(c,Ut,Tt)&&(qe=fh(16,{to:Me,from:Ut}),pt(Ut,Ut,!0,!1)),(qe?Promise.resolve(qe):Ee(Me,Ut)).catch(st=>ha(st)?ha(st,2)?st:Gt(st):Pe(st,Me,Ut)).then(st=>{if(st){if(ha(st,2))return fe(bi({replace:_n},ce(st.to),{state:typeof st.to=="object"?bi({},pn,st.to.state):pn,force:Fn}),bt||Me)}else st=Re(Me,Ut,!0,_n,pn);return be(Me,Ut,st),st})}function ve(Qe,bt){const Tt=K(Qe,bt);return Tt?Promise.reject(Tt):Promise.resolve()}function Ee(Qe,bt){let Tt;const[Ut,pn,Fn]=R3(Qe,bt);Tt=V_(Ut.reverse(),"beforeRouteLeave",Qe,bt);for(const he of Ut)he.leaveGuards.forEach(Me=>{Tt.push(dl(Me,Qe,bt))});const _n=ve.bind(null,Qe,bt);return Tt.push(_n),eh(Tt).then(()=>{Tt=[];for(const he of m.list())Tt.push(dl(he,Qe,bt));return Tt.push(_n),eh(Tt)}).then(()=>{Tt=V_(pn,"beforeRouteUpdate",Qe,bt);for(const he of pn)he.updateGuards.forEach(Me=>{Tt.push(dl(Me,Qe,bt))});return Tt.push(_n),eh(Tt)}).then(()=>{Tt=[];for(const he of Qe.matched)if(he.beforeEnter&&!bt.matched.includes(he))if(as(he.beforeEnter))for(const Me of he.beforeEnter)Tt.push(dl(Me,Qe,bt));else Tt.push(dl(he.beforeEnter,Qe,bt));return Tt.push(_n),eh(Tt)}).then(()=>(Qe.matched.forEach(he=>he.enterCallbacks={}),Tt=V_(Fn,"beforeRouteEnter",Qe,bt),Tt.push(_n),eh(Tt))).then(()=>{Tt=[];for(const he of _.list())Tt.push(dl(he,Qe,bt));return Tt.push(_n),eh(Tt)}).catch(he=>ha(he,8)?he:Promise.reject(he))}function be(Qe,bt,Tt){for(const Ut of s.list())Ut(Qe,bt,Tt)}function Re(Qe,bt,Tt,Ut,pn){const Fn=K(Qe,bt);if(Fn)return Fn;const _n=bt===ll,he=nh?history.state:{};Tt&&(Ut||_n?d.replace(Qe.fullPath,bi({scroll:_n&&he&&he.scroll},pn)):d.push(Qe.fullPath,pn)),w.value=Qe,pt(Qe,bt,Tt,_n),Gt()}let ze;function Je(){ze||(ze=d.listen((Qe,bt,Tt)=>{if(!kt.listening)return;const Ut=ne(Qe),pn=_e(Ut);if(pn){fe(bi(pn,{replace:!0}),Ut).catch(yf);return}E=Ut;const Fn=w.value;nh&&jO(tS(Fn.fullPath,Tt.delta),Qg()),Ee(Ut,Fn).catch(_n=>ha(_n,12)?_n:ha(_n,2)?(fe(_n.to,Ut).then(he=>{ha(he,20)&&!Tt.delta&&Tt.type===Ff.pop&&d.go(-1,!1)}).catch(yf),Promise.reject()):(Tt.delta&&d.go(-Tt.delta,!1),Pe(_n,Ut,Fn))).then(_n=>{_n=_n||Re(Ut,Fn,!1),_n&&(Tt.delta&&!ha(_n,8)?d.go(-Tt.delta,!1):Tt.type===Ff.pop&&ha(_n,20)&&d.go(-1,!1)),be(Ut,Fn,_n)}).catch(yf)}))}let ct=of(),nt=of(),ft;function Pe(Qe,bt,Tt){Gt(Qe);const Ut=nt.list();return Ut.length?Ut.forEach(pn=>pn(Qe,bt,Tt)):console.error(Qe),Promise.reject(Qe)}function at(){return ft&&w.value!==ll?Promise.resolve():new Promise((Qe,bt)=>{ct.add([Qe,bt])})}function Gt(Qe){return ft||(ft=!Qe,Je(),ct.list().forEach(([bt,Tt])=>Qe?Tt(Qe):bt()),ct.reset()),Qe}function pt(Qe,bt,Tt,Ut){const{scrollBehavior:pn}=e;if(!nh||!pn)return Promise.resolve();const Fn=!Tt&&GO(tS(Qe.fullPath,0))||(Ut||!Tt)&&history.state&&history.state.scroll||null;return Xi().then(()=>pn(Qe,bt,Fn)).then(_n=>_n&&UO(_n)).catch(_n=>Pe(_n,Qe,bt))}const Lt=Qe=>d.go(Qe);let qt;const Bn=new Set,kt={currentRoute:w,listening:!0,addRoute:D,removeRoute:N,hasRoute:de,getRoutes:Z,resolve:ne,options:e,push:Se,replace:Y,go:Lt,back:()=>Lt(-1),forward:()=>Lt(1),beforeEach:m.add,beforeResolve:_.add,afterEach:s.add,onError:nt.add,isReady:at,install(Qe){const bt=this;Qe.component("RouterLink",A3),Qe.component("RouterView",z3),Qe.config.globalProperties.$router=bt,Object.defineProperty(Qe.config.globalProperties,"$route",{enumerable:!0,get:()=>pi(w)}),nh&&!qt&&w.value===ll&&(qt=!0,Se(d.location).catch(pn=>{}));const Tt={};for(const pn in ll)Tt[pn]=ie(()=>w.value[pn]);Qe.provide(ev,bt),Qe.provide(MC,$i(Tt)),Qe.provide(My,w);const Ut=Qe.unmount;Bn.add(Qe),Qe.unmount=function(){Bn.delete(Qe),Bn.size<1&&(E=ll,ze&&ze(),ze=null,w.value=ll,qt=!1,ft=!1),Ut()}}};return kt}function eh(e){return e.reduce((o,a)=>o.then(()=>a()),Promise.resolve())}function R3(e,o){const a=[],c=[],d=[],m=Math.max(o.matched.length,e.matched.length);for(let _=0;_<m;_++){const s=o.matched[_];s&&(e.matched.find(E=>dh(E,s))?c.push(s):a.push(s));const w=e.matched[_];w&&(o.matched.find(E=>dh(E,w))||d.push(w))}return[a,c,d]}function Kf(){return cn(ev)}const D3=vn({__name:"DrawMain",setup(e){const o=He(!0),a=He(!1),c=()=>{a.value=!o.value};return(d,m)=>(fi(),Mr(dC,{modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=_=>o.value=_),width:"240",color:"#E0E0E0",elevation:"0",class:"rounded",onTransitionend:c,floating:""},{default:wn(()=>[mh(d.$slots,"default",{},void 0,!0)]),_:3},8,["modelValue"]))}});const Jf=Oo(D3,[["__scopeId","data-v-84200308"]]);function Qf(e){const{icons:o,activeIcons:a,temp:c}=$i(e);function d(m){Object.keys(o).forEach(_=>{_===m?o[_]=a[_]:o[_]=c[_]})}return{icons:o,toggleIcon:d}}const sf=vn({__name:"LeftIndex",setup(e){const o=Kf(),{icons:a,toggleIcon:c}=Qf({icons:{index:"mdi-map-outline",land:"mdi-tree-outline",elevation:"mdi-landslide-outline"},activeIcons:{index:"mdi-map",land:"mdi-tree",elevation:"mdi-landslide"},temp:{index:"mdi-map-outline",land:"mdi-tree-outline",elevation:"mdi-landslide-outline"}}),d=m=>{o.push({name:m}),c(m)};return(m,_)=>(fi(),Mr(Jf,null,{default:wn(()=>[F(js,{density:"compact",nav:""},{default:wn(()=>[F(Hi,{onClick:_[0]||(_[0]=s=>d("index")),"prepend-icon":pi(a).index,title:"\u5168\u7403\u6838\u7535",value:"nuclear"},null,8,["prepend-icon"]),F(Hi,{onClick:_[1]||(_[1]=s=>d("land")),"prepend-icon":pi(a).land,title:"\u571F\u5730\u5229\u7528",value:"land"},null,8,["prepend-icon"]),F(Hi,{onClick:_[2]||(_[2]=s=>d("elevation")),"prepend-icon":pi(a).elevation,title:"\u5730\u5F62\u9AD8\u7A0B",value:"elevation"},null,8,["prepend-icon"])]),_:1})]),_:1}))}}),$_=vn({__name:"LeftFinance",setup(e){const o=Kf(),{icons:a,toggleIcon:c}=Qf({icons:{GDP:"mdi-bank-outline",density:"mdi-account-multiple-outline"},activeIcons:{GDP:"mdi-bank",density:"mdi-account-multiple"},temp:{GDP:"mdi-bank-outline",density:"mdi-account-multiple-outline"}}),d=m=>{o.push({name:m}),c(m)};return(m,_)=>(fi(),Mr(Jf,null,{default:wn(()=>[F(js,{density:"compact",nav:""},{default:wn(()=>[F(Hi,{onClick:_[0]||(_[0]=s=>d("GDP")),"prepend-icon":pi(a).GDP,title:"\u56FD\u6C11\u751F\u4EA7\u603B\u503C",value:"GDP"},null,8,["prepend-icon"]),F(Hi,{onClick:_[1]||(_[1]=s=>d("density")),"prepend-icon":pi(a).density,title:"\u4EBA\u53E3\u5BC6\u5EA6",value:"density"},null,8,["prepend-icon"])]),_:1})]),_:1}))}}),Hm=vn({__name:"LeftMeteorology",setup(e){const o=Kf(),{icons:a,toggleIcon:c}=Qf({icons:{weather:"mdi-cloud-percent-outline",typhoon:"mdi-lightning-bolt-outline",inversion:"mdi-chart-areaspline"},activeIcons:{weather:"mdi-cloud-percent",typhoon:"mdi-lightning-bolt",inversion:"mdi-chart-areaspline-variant"},temp:{weather:"mdi-cloud-percent-outline",typhoon:"mdi-lightning-bolt-outline",inversion:"mdi-chart-areaspline"}}),d=m=>{o.push({name:m}),c(m)};return(m,_)=>(fi(),Mr(Jf,null,{default:wn(()=>[F(js,{density:"compact",nav:""},{default:wn(()=>[F(Hi,{onClick:_[0]||(_[0]=s=>d("weather")),"prepend-icon":pi(a).weather,title:"\u5168\u7403\u6C14\u8C61",value:"weather"},null,8,["prepend-icon"]),F(Hi,{onClick:_[1]||(_[1]=s=>d("typhoon")),"prepend-icon":pi(a).typhoon,title:"\u53F0\u98CE\u60C5\u51B5",value:"typhoon"},null,8,["prepend-icon"]),F(Hi,{onClick:_[2]||(_[2]=s=>d("inversion")),"prepend-icon":pi(a).inversion,title:"\u6C14\u8C61\u53CD\u6F14",value:"inversion"},null,8,["prepend-icon"])]),_:1})]),_:1}))}}),Xm=vn({__name:"LeftNuclear",setup(e){const o=Kf(),{icons:a,toggleIcon:c}=Qf({icons:{dose_single:"mdi-account-outline",dose_mutilate:"mdi-account-group-outline",other:"mdi-circle-outline"},activeIcons:{dose_single:"mdi-account",dose_mutilate:"mdi-account-group",other:"mdi-circle"},temp:{dose_single:"mdi-account-outline",dose_mutilate:"mdi-account-group-outline",other:"mdi-circle-outline"}}),d=m=>{o.push({name:m}),c(m)};return(m,_)=>(fi(),Mr(Jf,null,{default:wn(()=>[F(js,{density:"compact",nav:""},{default:wn(()=>[F(Hi,{onClick:_[0]||(_[0]=s=>d("single")),"prepend-icon":pi(a).dose_single,title:"\u4E2A\u4EBA\u5242\u91CF",value:"dose_single"},null,8,["prepend-icon"]),F(Hi,{onClick:_[1]||(_[1]=s=>d("multiple")),"prepend-icon":pi(a).dose_mutilate,title:"\u96C6\u4F53\u8BA1\u91CF",value:"dose_mutilate"},null,8,["prepend-icon"]),F(Hi,{onClick:_[2]||(_[2]=s=>d("other")),"prepend-icon":pi(a).other,title:"\u5176\u4ED6",value:"other"},null,8,["prepend-icon"])]),_:1})]),_:1}))}}),N_=vn({__name:"LeftEvacuate",setup(e){const o=Kf(),{icons:a,toggleIcon:c}=Qf({icons:{success:"mdi-run",failure:"mdi-alert-circle-outline"},activeIcons:{success:"mdi-run-fast",failure:"mdi-alert-circle"},temp:{success:"mdi-run",failure:"mdi-alert-circle-outline"}}),d=m=>{o.push({name:m}),c(m)};return(m,_)=>(fi(),Mr(Jf,null,{default:wn(()=>[F(js,{density:"compact",nav:""},{default:wn(()=>[F(Hi,{onClick:_[0]||(_[0]=s=>d("success")),"prepend-icon":pi(a).success,title:"\u64A4\u79BB\u6210\u529F",value:"success"},null,8,["prepend-icon"]),F(Hi,{onClick:_[1]||(_[1]=s=>d("failure")),"prepend-icon":pi(a).failure,title:"\u64A4\u79BB\u5931\u8D25",value:"failure"},null,8,["prepend-icon"])]),_:1})]),_:1}))}});function PC(e,o){return function(){return e.apply(o,arguments)}}const{toString:zC}=Object.prototype,{getPrototypeOf:X0}=Object,Y0=(e=>o=>{const a=zC.call(o);return e[a]||(e[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),Ca=e=>(e=e.toLowerCase(),o=>Y0(o)===e),tv=e=>o=>typeof o===e,{isArray:ep}=Array,Py=tv("undefined");function B3(e){return e!==null&&!Py(e)&&e.constructor!==null&&!Py(e.constructor)&&kh(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const LC=Ca("ArrayBuffer");function O3(e){let o;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?o=ArrayBuffer.isView(e):o=e&&e.buffer&&LC(e.buffer),o}const F3=tv("string"),kh=tv("function"),RC=tv("number"),DC=e=>e!==null&&typeof e=="object",V3=e=>e===!0||e===!1,ng=e=>{if(Y0(e)!=="object")return!1;const o=X0(e);return(o===null||o===Object.prototype||Object.getPrototypeOf(o)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},$3=Ca("Date"),N3=Ca("File"),U3=Ca("Blob"),j3=Ca("FileList"),G3=e=>DC(e)&&kh(e.pipe),q3=e=>{const o="[object FormData]";return e&&(typeof FormData=="function"&&e instanceof FormData||zC.call(e)===o||kh(e.toString)&&e.toString()===o)},Z3=Ca("URLSearchParams"),W3=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function nv(e,o,{allOwnKeys:a=!1}={}){if(e===null||typeof e>"u")return;let c,d;if(typeof e!="object"&&(e=[e]),ep(e))for(c=0,d=e.length;c<d;c++)o.call(null,e[c],c,e);else{const m=a?Object.getOwnPropertyNames(e):Object.keys(e),_=m.length;let s;for(c=0;c<_;c++)s=m[c],o.call(null,e[s],s,e)}}function zy(){const e={},o=(a,c)=>{ng(e[c])&&ng(a)?e[c]=zy(e[c],a):ng(a)?e[c]=zy({},a):ep(a)?e[c]=a.slice():e[c]=a};for(let a=0,c=arguments.length;a<c;a++)arguments[a]&&nv(arguments[a],o);return e}const H3=(e,o,a,{allOwnKeys:c}={})=>(nv(o,(d,m)=>{a&&kh(d)?e[m]=PC(d,a):e[m]=d},{allOwnKeys:c}),e),X3=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Y3=(e,o,a,c)=>{e.prototype=Object.create(o.prototype,c),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:o.prototype}),a&&Object.assign(e.prototype,a)},K3=(e,o,a,c)=>{let d,m,_;const s={};if(o=o||{},e==null)return o;do{for(d=Object.getOwnPropertyNames(e),m=d.length;m-- >0;)_=d[m],(!c||c(_,e,o))&&!s[_]&&(o[_]=e[_],s[_]=!0);e=a!==!1&&X0(e)}while(e&&(!a||a(e,o))&&e!==Object.prototype);return o},J3=(e,o,a)=>{e=String(e),(a===void 0||a>e.length)&&(a=e.length),a-=o.length;const c=e.indexOf(o,a);return c!==-1&&c===a},Q3=e=>{if(!e)return null;if(ep(e))return e;let o=e.length;if(!RC(o))return null;const a=new Array(o);for(;o-- >0;)a[o]=e[o];return a},eF=(e=>o=>e&&o instanceof e)(typeof Uint8Array<"u"&&X0(Uint8Array)),tF=(e,o)=>{const c=(e&&e[Symbol.iterator]).call(e);let d;for(;(d=c.next())&&!d.done;){const m=d.value;o.call(e,m[0],m[1])}},nF=(e,o)=>{let a;const c=[];for(;(a=e.exec(o))!==null;)c.push(a);return c},iF=Ca("HTMLFormElement"),rF=e=>e.toLowerCase().replace(/[_-\s]([a-z\d])(\w*)/g,function(a,c,d){return c.toUpperCase()+d}),mS=(({hasOwnProperty:e})=>(o,a)=>e.call(o,a))(Object.prototype),oF=Ca("RegExp"),BC=(e,o)=>{const a=Object.getOwnPropertyDescriptors(e),c={};nv(a,(d,m)=>{o(d,m,e)!==!1&&(c[m]=d)}),Object.defineProperties(e,c)},sF=e=>{BC(e,(o,a)=>{const c=e[a];if(!!kh(c)){if(o.enumerable=!1,"writable"in o){o.writable=!1;return}o.set||(o.set=()=>{throw Error("Can not read-only method '"+a+"'")})}})},aF=(e,o)=>{const a={},c=d=>{d.forEach(m=>{a[m]=!0})};return ep(e)?c(e):c(String(e).split(o)),a},lF=()=>{},cF=(e,o)=>(e=+e,Number.isFinite(e)?e:o),xt={isArray:ep,isArrayBuffer:LC,isBuffer:B3,isFormData:q3,isArrayBufferView:O3,isString:F3,isNumber:RC,isBoolean:V3,isObject:DC,isPlainObject:ng,isUndefined:Py,isDate:$3,isFile:N3,isBlob:U3,isRegExp:oF,isFunction:kh,isStream:G3,isURLSearchParams:Z3,isTypedArray:eF,isFileList:j3,forEach:nv,merge:zy,extend:H3,trim:W3,stripBOM:X3,inherits:Y3,toFlatObject:K3,kindOf:Y0,kindOfTest:Ca,endsWith:J3,toArray:Q3,forEachEntry:tF,matchAll:nF,isHTMLForm:iF,hasOwnProperty:mS,hasOwnProp:mS,reduceDescriptors:BC,freezeMethods:sF,toObjectSet:aF,toCamelCase:rF,noop:lF,toFiniteNumber:cF};function ai(e,o,a,c,d){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",o&&(this.code=o),a&&(this.config=a),c&&(this.request=c),d&&(this.response=d)}xt.inherits(ai,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const OC=ai.prototype,FC={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{FC[e]={value:e}});Object.defineProperties(ai,FC);Object.defineProperty(OC,"isAxiosError",{value:!0});ai.from=(e,o,a,c,d,m)=>{const _=Object.create(OC);return xt.toFlatObject(e,_,function(w){return w!==Error.prototype},s=>s!=="isAxiosError"),ai.call(_,e.message,o,a,c,d),_.cause=e,_.name=e.name,m&&Object.assign(_,m),_};var uF=typeof self=="object"?self.FormData:window.FormData;function Ly(e){return xt.isPlainObject(e)||xt.isArray(e)}function VC(e){return xt.endsWith(e,"[]")?e.slice(0,-2):e}function gS(e,o,a){return e?e.concat(o).map(function(d,m){return d=VC(d),!a&&m?"["+d+"]":d}).join(a?".":""):o}function hF(e){return xt.isArray(e)&&!e.some(Ly)}const dF=xt.toFlatObject(xt,{},null,function(o){return/^is[A-Z]/.test(o)});function fF(e){return e&&xt.isFunction(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator]}function iv(e,o,a){if(!xt.isObject(e))throw new TypeError("target must be an object");o=o||new(uF||FormData),a=xt.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Z,de){return!xt.isUndefined(de[Z])});const c=a.metaTokens,d=a.visitor||A,m=a.dots,_=a.indexes,w=(a.Blob||typeof Blob<"u"&&Blob)&&fF(o);if(!xt.isFunction(d))throw new TypeError("visitor must be a function");function E(N){if(N===null)return"";if(xt.isDate(N))return N.toISOString();if(!w&&xt.isBlob(N))throw new ai("Blob is not supported. Use a Buffer instead.");return xt.isArrayBuffer(N)||xt.isTypedArray(N)?w&&typeof Blob=="function"?new Blob([N]):Buffer.from(N):N}function A(N,Z,de){let ne=N;if(N&&!de&&typeof N=="object"){if(xt.endsWith(Z,"{}"))Z=c?Z:Z.slice(0,-2),N=JSON.stringify(N);else if(xt.isArray(N)&&hF(N)||xt.isFileList(N)||xt.endsWith(Z,"[]")&&(ne=xt.toArray(N)))return Z=VC(Z),ne.forEach(function(K,Se){!(xt.isUndefined(K)||K===null)&&o.append(_===!0?gS([Z],Se,m):_===null?Z:Z+"[]",E(K))}),!1}return Ly(N)?!0:(o.append(gS(de,Z,m),E(N)),!1)}const P=[],L=Object.assign(dF,{defaultVisitor:A,convertValue:E,isVisitable:Ly});function D(N,Z){if(!xt.isUndefined(N)){if(P.indexOf(N)!==-1)throw Error("Circular reference detected in "+Z.join("."));P.push(N),xt.forEach(N,function(ne,ce){(!(xt.isUndefined(ne)||ne===null)&&d.call(o,ne,xt.isString(ce)?ce.trim():ce,Z,L))===!0&&D(ne,Z?Z.concat(ce):[ce])}),P.pop()}}if(!xt.isObject(e))throw new TypeError("data must be an object");return D(e),o}function vS(e){const o={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(c){return o[c]})}function K0(e,o){this._pairs=[],e&&iv(e,this,o)}const $C=K0.prototype;$C.append=function(o,a){this._pairs.push([o,a])};$C.toString=function(o){const a=o?function(c){return o.call(this,c,vS)}:vS;return this._pairs.map(function(d){return a(d[0])+"="+a(d[1])},"").join("&")};function pF(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function NC(e,o,a){if(!o)return e;const c=a&&a.encode||pF,d=a&&a.serialize;let m;if(d?m=d(o,a):m=xt.isURLSearchParams(o)?o.toString():new K0(o,a).toString(c),m){const _=e.indexOf("#");_!==-1&&(e=e.slice(0,_)),e+=(e.indexOf("?")===-1?"?":"&")+m}return e}class _S{constructor(){this.handlers=[]}use(o,a,c){return this.handlers.push({fulfilled:o,rejected:a,synchronous:c?c.synchronous:!1,runWhen:c?c.runWhen:null}),this.handlers.length-1}eject(o){this.handlers[o]&&(this.handlers[o]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(o){xt.forEach(this.handlers,function(c){c!==null&&o(c)})}}const UC={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},mF=typeof URLSearchParams<"u"?URLSearchParams:K0,gF=FormData,vF=(()=>{let e;return typeof navigator<"u"&&((e=navigator.product)==="ReactNative"||e==="NativeScript"||e==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),ma={isBrowser:!0,classes:{URLSearchParams:mF,FormData:gF,Blob},isStandardBrowserEnv:vF,protocols:["http","https","file","blob","url","data"]};function _F(e,o){return iv(e,new ma.classes.URLSearchParams,Object.assign({visitor:function(a,c,d,m){return ma.isNode&&xt.isBuffer(a)?(this.append(c,a.toString("base64")),!1):m.defaultVisitor.apply(this,arguments)}},o))}function yF(e){return xt.matchAll(/\w+|\[(\w*)]/g,e).map(o=>o[0]==="[]"?"":o[1]||o[0])}function xF(e){const o={},a=Object.keys(e);let c;const d=a.length;let m;for(c=0;c<d;c++)m=a[c],o[m]=e[m];return o}function jC(e){function o(a,c,d,m){let _=a[m++];const s=Number.isFinite(+_),w=m>=a.length;return _=!_&&xt.isArray(d)?d.length:_,w?(xt.hasOwnProp(d,_)?d[_]=[d[_],c]:d[_]=c,!s):((!d[_]||!xt.isObject(d[_]))&&(d[_]=[]),o(a,c,d[_],m)&&xt.isArray(d[_])&&(d[_]=xF(d[_])),!s)}if(xt.isFormData(e)&&xt.isFunction(e.entries)){const a={};return xt.forEachEntry(e,(c,d)=>{o(yF(c),d,a,0)}),a}return null}function bF(e,o,a){const c=a.config.validateStatus;!a.status||!c||c(a.status)?e(a):o(new ai("Request failed with status code "+a.status,[ai.ERR_BAD_REQUEST,ai.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}const wF=ma.isStandardBrowserEnv?function(){return{write:function(a,c,d,m,_,s){const w=[];w.push(a+"="+encodeURIComponent(c)),xt.isNumber(d)&&w.push("expires="+new Date(d).toGMTString()),xt.isString(m)&&w.push("path="+m),xt.isString(_)&&w.push("domain="+_),s===!0&&w.push("secure"),document.cookie=w.join("; ")},read:function(a){const c=document.cookie.match(new RegExp("(^|;\\s*)("+a+")=([^;]*)"));return c?decodeURIComponent(c[3]):null},remove:function(a){this.write(a,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function SF(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function EF(e,o){return o?e.replace(/\/+$/,"")+"/"+o.replace(/^\/+/,""):e}function GC(e,o){return e&&!SF(o)?EF(e,o):o}const TF=ma.isStandardBrowserEnv?function(){const o=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a");let c;function d(m){let _=m;return o&&(a.setAttribute("href",_),_=a.href),a.setAttribute("href",_),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:a.pathname.charAt(0)==="/"?a.pathname:"/"+a.pathname}}return c=d(window.location.href),function(_){const s=xt.isString(_)?d(_):_;return s.protocol===c.protocol&&s.host===c.host}}():function(){return function(){return!0}}();function tp(e,o,a){ai.call(this,e==null?"canceled":e,ai.ERR_CANCELED,o,a),this.name="CanceledError"}xt.inherits(tp,ai,{__CANCEL__:!0});function CF(e){const o=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return o&&o[1]||""}const IF=xt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),AF=e=>{const o={};let a,c,d;return e&&e.split(`
`).forEach(function(_){d=_.indexOf(":"),a=_.substring(0,d).trim().toLowerCase(),c=_.substring(d+1).trim(),!(!a||o[a]&&IF[a])&&(a==="set-cookie"?o[a]?o[a].push(c):o[a]=[c]:o[a]=o[a]?o[a]+", "+c:c)}),o},yS=Symbol("internals"),qC=Symbol("defaults");function hf(e){return e&&String(e).trim().toLowerCase()}function ig(e){return e===!1||e==null?e:xt.isArray(e)?e.map(ig):String(e)}function kF(e){const o=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let c;for(;c=a.exec(e);)o[c[1]]=c[2];return o}function xS(e,o,a,c){if(xt.isFunction(c))return c.call(this,o,a);if(!!xt.isString(o)){if(xt.isString(c))return o.indexOf(c)!==-1;if(xt.isRegExp(c))return c.test(o)}}function MF(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(o,a,c)=>a.toUpperCase()+c)}function PF(e,o){const a=xt.toCamelCase(" "+o);["get","set","has"].forEach(c=>{Object.defineProperty(e,c+a,{value:function(d,m,_){return this[c].call(this,o,d,m,_)},configurable:!0})})}function af(e,o){o=o.toLowerCase();const a=Object.keys(e);let c=a.length,d;for(;c-- >0;)if(d=a[c],o===d.toLowerCase())return d;return null}function Do(e,o){e&&this.set(e),this[qC]=o||null}Object.assign(Do.prototype,{set:function(e,o,a){const c=this;function d(m,_,s){const w=hf(_);if(!w)throw new Error("header name must be a non-empty string");const E=af(c,w);E&&s!==!0&&(c[E]===!1||s===!1)||(c[E||_]=ig(m))}return xt.isPlainObject(e)?xt.forEach(e,(m,_)=>{d(m,_,o)}):d(o,e,a),this},get:function(e,o){if(e=hf(e),!e)return;const a=af(this,e);if(a){const c=this[a];if(!o)return c;if(o===!0)return kF(c);if(xt.isFunction(o))return o.call(this,c,a);if(xt.isRegExp(o))return o.exec(c);throw new TypeError("parser must be boolean|regexp|function")}},has:function(e,o){if(e=hf(e),e){const a=af(this,e);return!!(a&&(!o||xS(this,this[a],a,o)))}return!1},delete:function(e,o){const a=this;let c=!1;function d(m){if(m=hf(m),m){const _=af(a,m);_&&(!o||xS(a,a[_],_,o))&&(delete a[_],c=!0)}}return xt.isArray(e)?e.forEach(d):d(e),c},clear:function(){return Object.keys(this).forEach(this.delete.bind(this))},normalize:function(e){const o=this,a={};return xt.forEach(this,(c,d)=>{const m=af(a,d);if(m){o[m]=ig(c),delete o[d];return}const _=e?MF(d):String(d).trim();_!==d&&delete o[d],o[_]=ig(c),a[_]=!0}),this},toJSON:function(e){const o=Object.create(null);return xt.forEach(Object.assign({},this[qC]||null,this),(a,c)=>{a==null||a===!1||(o[c]=e&&xt.isArray(a)?a.join(", "):a)}),o}});Object.assign(Do,{from:function(e){return xt.isString(e)?new this(AF(e)):e instanceof this?e:new this(e)},accessor:function(e){const a=(this[yS]=this[yS]={accessors:{}}).accessors,c=this.prototype;function d(m){const _=hf(m);a[_]||(PF(c,m),a[_]=!0)}return xt.isArray(e)?e.forEach(d):d(e),this}});Do.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent"]);xt.freezeMethods(Do.prototype);xt.freezeMethods(Do);function zF(e,o){e=e||10;const a=new Array(e),c=new Array(e);let d=0,m=0,_;return o=o!==void 0?o:1e3,function(w){const E=Date.now(),A=c[m];_||(_=E),a[d]=w,c[d]=E;let P=m,L=0;for(;P!==d;)L+=a[P++],P=P%e;if(d=(d+1)%e,d===m&&(m=(m+1)%e),E-_<o)return;const D=A&&E-A;return D?Math.round(L*1e3/D):void 0}}function bS(e,o){let a=0;const c=zF(50,250);return d=>{const m=d.loaded,_=d.lengthComputable?d.total:void 0,s=m-a,w=c(s),E=m<=_;a=m;const A={loaded:m,total:_,progress:_?m/_:void 0,bytes:s,rate:w||void 0,estimated:w&&_&&E?(_-m)/w:void 0};A[o?"download":"upload"]=!0,e(A)}}function wS(e){return new Promise(function(a,c){let d=e.data;const m=Do.from(e.headers).normalize(),_=e.responseType;let s;function w(){e.cancelToken&&e.cancelToken.unsubscribe(s),e.signal&&e.signal.removeEventListener("abort",s)}xt.isFormData(d)&&ma.isStandardBrowserEnv&&m.setContentType(!1);let E=new XMLHttpRequest;if(e.auth){const D=e.auth.username||"",N=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";m.set("Authorization","Basic "+btoa(D+":"+N))}const A=GC(e.baseURL,e.url);E.open(e.method.toUpperCase(),NC(A,e.params,e.paramsSerializer),!0),E.timeout=e.timeout;function P(){if(!E)return;const D=Do.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),Z={data:!_||_==="text"||_==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:D,config:e,request:E};bF(function(ne){a(ne),w()},function(ne){c(ne),w()},Z),E=null}if("onloadend"in E?E.onloadend=P:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(P)},E.onabort=function(){!E||(c(new ai("Request aborted",ai.ECONNABORTED,e,E)),E=null)},E.onerror=function(){c(new ai("Network Error",ai.ERR_NETWORK,e,E)),E=null},E.ontimeout=function(){let N=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const Z=e.transitional||UC;e.timeoutErrorMessage&&(N=e.timeoutErrorMessage),c(new ai(N,Z.clarifyTimeoutError?ai.ETIMEDOUT:ai.ECONNABORTED,e,E)),E=null},ma.isStandardBrowserEnv){const D=(e.withCredentials||TF(A))&&e.xsrfCookieName&&wF.read(e.xsrfCookieName);D&&m.set(e.xsrfHeaderName,D)}d===void 0&&m.setContentType(null),"setRequestHeader"in E&&xt.forEach(m.toJSON(),function(N,Z){E.setRequestHeader(Z,N)}),xt.isUndefined(e.withCredentials)||(E.withCredentials=!!e.withCredentials),_&&_!=="json"&&(E.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&E.addEventListener("progress",bS(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&E.upload&&E.upload.addEventListener("progress",bS(e.onUploadProgress)),(e.cancelToken||e.signal)&&(s=D=>{!E||(c(!D||D.type?new tp(null,e,E):D),E.abort(),E=null)},e.cancelToken&&e.cancelToken.subscribe(s),e.signal&&(e.signal.aborted?s():e.signal.addEventListener("abort",s)));const L=CF(A);if(L&&ma.protocols.indexOf(L)===-1){c(new ai("Unsupported protocol "+L+":",ai.ERR_BAD_REQUEST,e));return}E.send(d||null)})}const SS={http:wS,xhr:wS},ES={getAdapter:e=>{if(xt.isString(e)){const o=SS[e];if(!e)throw Error(xt.hasOwnProp(e)?`Adapter '${e}' is not available in the build`:`Can not resolve adapter '${e}'`);return o}if(!xt.isFunction(e))throw new TypeError("adapter is not a function");return e},adapters:SS},LF={"Content-Type":"application/x-www-form-urlencoded"};function RF(){let e;return typeof XMLHttpRequest<"u"?e=ES.getAdapter("xhr"):typeof process<"u"&&xt.kindOf(process)==="process"&&(e=ES.getAdapter("http")),e}function DF(e,o,a){if(xt.isString(e))try{return(o||JSON.parse)(e),xt.trim(e)}catch(c){if(c.name!=="SyntaxError")throw c}return(a||JSON.stringify)(e)}const Mh={transitional:UC,adapter:RF(),transformRequest:[function(o,a){const c=a.getContentType()||"",d=c.indexOf("application/json")>-1,m=xt.isObject(o);if(m&&xt.isHTMLForm(o)&&(o=new FormData(o)),xt.isFormData(o))return d&&d?JSON.stringify(jC(o)):o;if(xt.isArrayBuffer(o)||xt.isBuffer(o)||xt.isStream(o)||xt.isFile(o)||xt.isBlob(o))return o;if(xt.isArrayBufferView(o))return o.buffer;if(xt.isURLSearchParams(o))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),o.toString();let s;if(m){if(c.indexOf("application/x-www-form-urlencoded")>-1)return _F(o,this.formSerializer).toString();if((s=xt.isFileList(o))||c.indexOf("multipart/form-data")>-1){const w=this.env&&this.env.FormData;return iv(s?{"files[]":o}:o,w&&new w,this.formSerializer)}}return m||d?(a.setContentType("application/json",!1),DF(o)):o}],transformResponse:[function(o){const a=this.transitional||Mh.transitional,c=a&&a.forcedJSONParsing,d=this.responseType==="json";if(o&&xt.isString(o)&&(c&&!this.responseType||d)){const _=!(a&&a.silentJSONParsing)&&d;try{return JSON.parse(o)}catch(s){if(_)throw s.name==="SyntaxError"?ai.from(s,ai.ERR_BAD_RESPONSE,this,null,this.response):s}}return o}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ma.classes.FormData,Blob:ma.classes.Blob},validateStatus:function(o){return o>=200&&o<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};xt.forEach(["delete","get","head"],function(o){Mh.headers[o]={}});xt.forEach(["post","put","patch"],function(o){Mh.headers[o]=xt.merge(LF)});function U_(e,o){const a=this||Mh,c=o||a,d=Do.from(c.headers);let m=c.data;return xt.forEach(e,function(s){m=s.call(a,m,d.normalize(),o?o.status:void 0)}),d.normalize(),m}function ZC(e){return!!(e&&e.__CANCEL__)}function j_(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new tp}function TS(e){return j_(e),e.headers=Do.from(e.headers),e.data=U_.call(e,e.transformRequest),(e.adapter||Mh.adapter)(e).then(function(c){return j_(e),c.data=U_.call(e,e.transformResponse,c),c.headers=Do.from(c.headers),c},function(c){return ZC(c)||(j_(e),c&&c.response&&(c.response.data=U_.call(e,e.transformResponse,c.response),c.response.headers=Do.from(c.response.headers))),Promise.reject(c)})}function Vf(e,o){o=o||{};const a={};function c(E,A){return xt.isPlainObject(E)&&xt.isPlainObject(A)?xt.merge(E,A):xt.isPlainObject(A)?xt.merge({},A):xt.isArray(A)?A.slice():A}function d(E){if(xt.isUndefined(o[E])){if(!xt.isUndefined(e[E]))return c(void 0,e[E])}else return c(e[E],o[E])}function m(E){if(!xt.isUndefined(o[E]))return c(void 0,o[E])}function _(E){if(xt.isUndefined(o[E])){if(!xt.isUndefined(e[E]))return c(void 0,e[E])}else return c(void 0,o[E])}function s(E){if(E in o)return c(e[E],o[E]);if(E in e)return c(void 0,e[E])}const w={url:m,method:m,data:m,baseURL:_,transformRequest:_,transformResponse:_,paramsSerializer:_,timeout:_,timeoutMessage:_,withCredentials:_,adapter:_,responseType:_,xsrfCookieName:_,xsrfHeaderName:_,onUploadProgress:_,onDownloadProgress:_,decompress:_,maxContentLength:_,maxBodyLength:_,beforeRedirect:_,transport:_,httpAgent:_,httpsAgent:_,cancelToken:_,socketPath:_,responseEncoding:_,validateStatus:s};return xt.forEach(Object.keys(e).concat(Object.keys(o)),function(A){const P=w[A]||d,L=P(A);xt.isUndefined(L)&&P!==s||(a[A]=L)}),a}const WC="1.1.3",J0={};["object","boolean","number","function","string","symbol"].forEach((e,o)=>{J0[e]=function(c){return typeof c===e||"a"+(o<1?"n ":" ")+e}});const CS={};J0.transitional=function(o,a,c){function d(m,_){return"[Axios v"+WC+"] Transitional option '"+m+"'"+_+(c?". "+c:"")}return(m,_,s)=>{if(o===!1)throw new ai(d(_," has been removed"+(a?" in "+a:"")),ai.ERR_DEPRECATED);return a&&!CS[_]&&(CS[_]=!0,console.warn(d(_," has been deprecated since v"+a+" and will be removed in the near future"))),o?o(m,_,s):!0}};function BF(e,o,a){if(typeof e!="object")throw new ai("options must be an object",ai.ERR_BAD_OPTION_VALUE);const c=Object.keys(e);let d=c.length;for(;d-- >0;){const m=c[d],_=o[m];if(_){const s=e[m],w=s===void 0||_(s,m,e);if(w!==!0)throw new ai("option "+m+" must be "+w,ai.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new ai("Unknown option "+m,ai.ERR_BAD_OPTION)}}const Ry={assertOptions:BF,validators:J0},cl=Ry.validators;class Lc{constructor(o){this.defaults=o,this.interceptors={request:new _S,response:new _S}}request(o,a){typeof o=="string"?(a=a||{},a.url=o):a=o||{},a=Vf(this.defaults,a);const{transitional:c,paramsSerializer:d}=a;c!==void 0&&Ry.assertOptions(c,{silentJSONParsing:cl.transitional(cl.boolean),forcedJSONParsing:cl.transitional(cl.boolean),clarifyTimeoutError:cl.transitional(cl.boolean)},!1),d!==void 0&&Ry.assertOptions(d,{encode:cl.function,serialize:cl.function},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();const m=a.headers&&xt.merge(a.headers.common,a.headers[a.method]);m&&xt.forEach(["delete","get","head","post","put","patch","common"],function(N){delete a.headers[N]}),a.headers=new Do(a.headers,m);const _=[];let s=!0;this.interceptors.request.forEach(function(N){typeof N.runWhen=="function"&&N.runWhen(a)===!1||(s=s&&N.synchronous,_.unshift(N.fulfilled,N.rejected))});const w=[];this.interceptors.response.forEach(function(N){w.push(N.fulfilled,N.rejected)});let E,A=0,P;if(!s){const D=[TS.bind(this),void 0];for(D.unshift.apply(D,_),D.push.apply(D,w),P=D.length,E=Promise.resolve(a);A<P;)E=E.then(D[A++],D[A++]);return E}P=_.length;let L=a;for(A=0;A<P;){const D=_[A++],N=_[A++];try{L=D(L)}catch(Z){N.call(this,Z);break}}try{E=TS.call(this,L)}catch(D){return Promise.reject(D)}for(A=0,P=w.length;A<P;)E=E.then(w[A++],w[A++]);return E}getUri(o){o=Vf(this.defaults,o);const a=GC(o.baseURL,o.url);return NC(a,o.params,o.paramsSerializer)}}xt.forEach(["delete","get","head","options"],function(o){Lc.prototype[o]=function(a,c){return this.request(Vf(c||{},{method:o,url:a,data:(c||{}).data}))}});xt.forEach(["post","put","patch"],function(o){function a(c){return function(m,_,s){return this.request(Vf(s||{},{method:o,headers:c?{"Content-Type":"multipart/form-data"}:{},url:m,data:_}))}}Lc.prototype[o]=a(),Lc.prototype[o+"Form"]=a(!0)});class Q0{constructor(o){if(typeof o!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(m){a=m});const c=this;this.promise.then(d=>{if(!c._listeners)return;let m=c._listeners.length;for(;m-- >0;)c._listeners[m](d);c._listeners=null}),this.promise.then=d=>{let m;const _=new Promise(s=>{c.subscribe(s),m=s}).then(d);return _.cancel=function(){c.unsubscribe(m)},_},o(function(m,_,s){c.reason||(c.reason=new tp(m,_,s),a(c.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(o){if(this.reason){o(this.reason);return}this._listeners?this._listeners.push(o):this._listeners=[o]}unsubscribe(o){if(!this._listeners)return;const a=this._listeners.indexOf(o);a!==-1&&this._listeners.splice(a,1)}static source(){let o;return{token:new Q0(function(d){o=d}),cancel:o}}}function OF(e){return function(a){return e.apply(null,a)}}function FF(e){return xt.isObject(e)&&e.isAxiosError===!0}function HC(e){const o=new Lc(e),a=PC(Lc.prototype.request,o);return xt.extend(a,Lc.prototype,o,{allOwnKeys:!0}),xt.extend(a,o,null,{allOwnKeys:!0}),a.create=function(d){return HC(Vf(e,d))},a}const ao=HC(Mh);ao.Axios=Lc;ao.CanceledError=tp;ao.CancelToken=Q0;ao.isCancel=ZC;ao.VERSION=WC;ao.toFormData=iv;ao.AxiosError=ai;ao.Cancel=ao.CanceledError;ao.all=function(o){return Promise.all(o)};ao.spread=OF;ao.isAxiosError=FF;ao.formToJSON=e=>jC(xt.isHTMLForm(e)?new FormData(e):e);const XC="pk.eyJ1Ijoia29pZ29rb3JvIiwiYSI6ImNsOXAxZDIzZDA0OHQ0MW1wMHd2Y3Rxa3IifQ.X9ACqkqRQ_m3IvwqsGYy0w",VF={};function $F(e,o){const a=zo("v-scale-control");return fi(),Mr(zc,{color:"blue"},{default:wn(()=>[F(a,{class:"scale-control",position:"bottom-right"})]),_:1})}const NF=Oo(VF,[["render",$F]]),UF=vn({__name:"SwitchBgMap",emits:["switch-map"],setup(e,{emit:o}){const a=He("map://styles/map/light-v11"),c=$i({mapbox:"map://styles/map/light-v11",earth:"map://styles/map/satellite-streets-v11"});function d(m){m==="mapbox"?a.value=c.mapbox:m==="earth"&&(a.value=c.earth),o("switch-map",a.value)}return(m,_)=>(fi(),Mr(Ah,{location:"start",class:"switch-map"},{activator:wn(({props:s})=>[F(wi,tn({width:"36",height:"36",class:"switch-map",elevation:"4",icon:"mdi-switch",color:"primary"},s),null,16)]),default:wn(()=>[F(cC,null,{default:wn(()=>[F(wg,null,{default:wn(()=>[F(wi,{width:"36",height:"36",onClick:_[0]||(_[0]=s=>d("mapbox")),icon:"mdi-earth"})]),_:1}),F(wg,null,{default:wn(()=>[F(wi,{width:"36",height:"36",onClick:_[1]||(_[1]=s=>d("earth")),icon:"mdi-mapbox"})]),_:1})]),_:1})]),_:1}))}});const jF=Oo(UF,[["__scopeId","data-v-9e84af0b"]]),GF={class:"scale-button d-flex flex-column justify-center align-center"},qF=vn({__name:"MapMain",setup(e){const o=$i({center:[120,30],zoom:5,style:"mapbox://styles/mapbox/light-v11",projection:"mercator"}),a=He();function c(){o.zoom++}function d(){o.zoom--}function m(_){o.style=_}return(_,s)=>{const w=zo("v-map");return fi(),Mr(w,{ref_key:"mapRef",ref:a,accessToken:pi(XC),options:o},{default:wn(()=>[mh(_.$slots,"default",{},void 0,!0),F(NF),F(jF,{onReceiveChild:m}),va("div",GF,[F(wi,{width:"36",height:"36",class:"mb-2",onClick:c,icon:"mdi-plus"}),F(wi,{width:"36",height:"36",onClick:d,icon:"mdi-minus"})])]),_:3},8,["accessToken","options"])}}});const Ph=Oo(qF,[["__scopeId","data-v-afef4056"]]),ZF={class:"box"},WF=vn({__name:"SearchPage",props:{data:{type:Object}},setup(e){const o=He(!1),a=He(""),c=He("Search"),d=$i([{text:`${name}`,icon:"mdi-clock"},{text:"Audience",icon:"mdi-account"},{text:"Conversions",icon:"mdi-flag"}]);return(m,_)=>(fi(),oo(Dn,null,[va("div",ZF,[F(Ah,null,{activator:wn(({props:s})=>[F(zc,{width:"300",class:"search-card rounded"},{default:wn(()=>[F(Yf,tn({"bg-color":"white",modelValue:a.value,"onUpdate:modelValue":_[0]||(_[0]=w=>a.value=w),placeholder:c.value,rounded:"",dense:"",class:"search-field no-focus-outline rounded-0"},s),null,16,["modelValue","placeholder"]),F(wi,{variant:"flat",icon:"",color:"white",class:"search-btn rounded-0"},{default:wn(()=>[F(Ni,null,{default:wn(()=>[gl("mdi-magnify")]),_:1})]),_:1}),F(wi,{variant:"flat",icon:"",color:"white",class:"search-btn rounded-0"},{default:wn(()=>[F(Ni,null,{default:wn(()=>[gl("mdi-account")]),_:1})]),_:1}),mh(m.$slots,"default",{},void 0,!0)]),_:2},1024)]),default:wn(()=>[F(zc,{elevation:"2",width:"300",height:"400"},{default:wn(()=>[F(js,{density:"compact"},{default:wn(()=>[(fi(!0),oo(Dn,null,UM(d,(s,w)=>(fi(),Mr(Hi,{key:w,value:s,"active-color":"red",onClick:_[1]||(_[1]=E=>o.value=!0)},{prepend:wn(()=>[F(Ni,{icon:s.icon},null,8,["icon"])]),default:wn(()=>[F(B0,{class:"font-italic",textContent:Pk(s.text)},null,8,["textContent"])]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:3})]),va("div",null,[o.value?(fi(),Mr(zc,{key:0,class:"res d-flex align-center justify-center",color:"white",width:"330",height:"100%"},{default:wn(()=>[F(uC),F(N0,null,{default:wn(()=>[F(wi,{color:"red",onClick:_[2]||(_[2]=s=>o.value=!1)},{default:wn(()=>[gl("close")]),_:1})]),_:1})]),_:1})):jE("",!0)])],64))}});const HF=Oo(WF,[["__scopeId","data-v-96a0ca6f"]]),XF=vn({__name:"MapIndex",setup(e){let o=He("mapbox://styles/mapbox/light-v11");const a=$i({features:[]});let c=$i({mapOptions:{style:o,projection:"mercator"},popupOptions:{visible:!1,center:void 0,content:""}});async function d(){try{const E=await ao.get("http://127.0.0.1:8000/index/index_geojson");a.features=E.data.features}catch(E){console.error(E)}}const m=E=>{const A=E.target;console.log(E.target);const P=A.queryRenderedFeatures(E.point,{layers:["nuclear-stations-circle"]}),L=P[0].properties.cluster_id;A.getSource("nuclear-stations").getClusterExpansionZoom(L,(D,N)=>{D||A.easeTo({center:P[0].geometry.coordinates,zoom:N})})},_=E=>{E.target.getCanvas().style.cursor="pointer"},s=E=>{E.target.getCanvas().style.cursor=""},w=E=>{const A=E.features[0].geometry.coordinates.slice();for(;Math.abs(E.lngLat.lng-A[0])>180;)A[0]+=E.lngLat.lng>A[0]?360:-360;c.popupOptions.visible=!0,c.popupOptions.content=a.features[0].name,c.popupOptions.center=A};return(E,A)=>{const P=zo("v-geo-source"),L=zo("v-circle-layer"),D=zo("v-symbol-layer");return fi(),oo("div",null,[F(Ph,{onLoaded:d},{default:wn(()=>[F(P,{id:"nuclear-stations",data:a,cluster:!0,clusterRadius:50},null,8,["data"]),F(L,{id:"nuclear-stations-circle",source:"nuclear-stations",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#51bbd6",20,"#f1f075",60,"#f28cb1",100,"#e20656"],"circle-radius":["step",["get","point_count"],20,20,30,60,40,100,50]},onClick:m,onMouseenter:_,onMouseleave:s}),F(D,{id:"cluster-count",source:"nuclear-stations",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}}),F(L,{id:"uncluster-point",source:"nuclear-stations",filter:["!",["has","point_count"]],paint:{"circle-color":"#11b4da","circle-radius":4,"circle-stroke-width":1,"circle-stroke-color":"#fff"},onClick:w})]),_:1}),F(HF,{data:a.features},null,8,["data"])])}}});const yc=Oo(XF,[["__scopeId","data-v-6ea9f7e3"]]),YF={class:"scale-button d-flex flex-column justify-center align-center"},KF=vn({__name:"MapLand",setup(e){const o=$i({projection:"mercator"}),a=He();a.value;function c(){o.zoom++}function d(){o.zoom--}return zn(()=>{console.log(a.value.map)}),(m,_)=>{const s=zo("v-map");return fi(),Mr(s,{ref_key:"mapRef",ref:a,accessToken:pi(XC),options:o},{default:wn(()=>[va("div",YF,[F(wi,{width:"36",height:"36",onClick:c,icon:"mdi-plus"}),F(wi,{width:"36",height:"36",onClick:d,icon:"mdi-reduce"})])]),_:1},8,["accessToken","options"])}}});const G_=Oo(KF,[["__scopeId","data-v-ab6c41e7"]]);const JF={},QF={class:"function-card"};function e5(e,o){return fi(),oo("div",QF,[F(zc,{class:"rounded-pill d-flex justify-center align-center",color:"white",width:"36",height:"300"},{default:wn(()=>[F(wg,{class:"pa-0"},{default:wn(()=>[F(wi,{height:"36",variant:"plain",icon:"mdi-weather-hurricane"}),F(wi,{height:"36",variant:"plain",icon:"mdi-weather-cloudy"}),F(wi,{height:"36",variant:"plain",icon:"mdi-temperature-celsius"})]),_:1})]),_:1})])}const t5=Oo(JF,[["render",e5],["__scopeId","data-v-9cc91348"]]),n5=vn({__name:"MapElevation",setup(e){return(o,a)=>{const c=zo("v-raster-source"),d=zo("v-raster-layer");return fi(),oo("div",null,[F(Ph,null,{default:wn(()=>[F(c,{id:"tiles",tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.jpg"]},null,8,["tiles"]),F(d,{id:"tiles",source:"tiles"})]),_:1}),F(t5)])}}});var io=63710088e-1,i5={centimeters:io*100,centimetres:io*100,degrees:io/111325,feet:io*3.28084,inches:io*39.37,kilometers:io/1e3,kilometres:io/1e3,meters:io,metres:io,miles:io/1609.344,millimeters:io*1e3,millimetres:io*1e3,nauticalmiles:io/1852,radians:1,yards:io*1.0936};function $f(e,o,a){a===void 0&&(a={});var c={type:"Feature"};return(a.id===0||a.id)&&(c.id=a.id),a.bbox&&(c.bbox=a.bbox),c.properties=o||{},c.geometry=e,c}function r5(e,o,a){if(a===void 0&&(a={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!kS(e[0])||!kS(e[1]))throw new Error("coordinates must contain numbers");var c={type:"Point",coordinates:e};return $f(c,o,a)}function Dy(e,o,a){a===void 0&&(a={});for(var c=0,d=e;c<d.length;c++){var m=d[c];if(m.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var _=0;_<m[m.length-1].length;_++)if(m[m.length-1][_]!==m[0][_])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:e};return $f(s,o,a)}function ex(e,o){o===void 0&&(o={});var a={type:"FeatureCollection"};return o.id&&(a.id=o.id),o.bbox&&(a.bbox=o.bbox),a.features=e,a}function IS(e,o,a){a===void 0&&(a={});var c={type:"MultiPolygon",coordinates:e};return $f(c,o,a)}function o5(e,o){o===void 0&&(o="kilometers");var a=i5[o];if(!a)throw new Error(o+" units is invalid");return e/a}function AS(e){var o=e%(2*Math.PI);return o*180/Math.PI}function q_(e){var o=e%360;return o*Math.PI/180}function kS(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function s5(e){return!!e&&e.constructor===Object}function a5(e,o){if(e.type==="Feature")o(e,0);else if(e.type==="FeatureCollection")for(var a=0;a<e.features.length&&o(e.features[a],a)!==!1;a++);}function l5(e,o){var a,c,d,m,_,s,w,E,A,P,L=0,D=e.type==="FeatureCollection",N=e.type==="Feature",Z=D?e.features.length:1;for(a=0;a<Z;a++){for(s=D?e.features[a].geometry:N?e.geometry:e,E=D?e.features[a].properties:N?e.properties:{},A=D?e.features[a].bbox:N?e.bbox:void 0,P=D?e.features[a].id:N?e.id:void 0,w=s?s.type==="GeometryCollection":!1,_=w?s.geometries.length:1,d=0;d<_;d++){if(m=w?s.geometries[d]:s,m===null){if(o(null,L,E,A,P)===!1)return!1;continue}switch(m.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(o(m,L,E,A,P)===!1)return!1;break}case"GeometryCollection":{for(c=0;c<m.geometries.length;c++)if(o(m.geometries[c],L,E,A,P)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}L++}}function c5(e,o){l5(e,function(a,c,d,m,_){var s=a===null?null:a.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return o($f(a,d,{bbox:m,id:_}),c,0)===!1?!1:void 0}var w;switch(s){case"MultiPoint":w="Point";break;case"MultiLineString":w="LineString";break;case"MultiPolygon":w="Polygon";break}for(var E=0;E<a.coordinates.length;E++){var A=a.coordinates[E],P={type:w,coordinates:A};if(o($f(P,d),c,E)===!1)return!1}})}function u5(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function h5(e,o,a){if(!e)throw new Error("No featureCollection passed");if(!a)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+a+", FeatureCollection required");for(var c=0,d=e.features;c<d.length;c++){var m=d[c];if(!m||m.type!=="Feature"||!m.geometry)throw new Error("Invalid input to "+a+", Feature with geometry required");if(!m.geometry||m.geometry.type!==o)throw new Error("Invalid input to "+a+": must be a "+o+", given "+m.geometry.type)}}function d5(e,o,a,c){c===void 0&&(c={});var d=u5(e),m=q_(d[0]),_=q_(d[1]),s=q_(a),w=o5(o,c.units),E=Math.asin(Math.sin(_)*Math.cos(w)+Math.cos(_)*Math.sin(w)*Math.cos(s)),A=m+Math.atan2(Math.sin(s)*Math.sin(w)*Math.cos(_),Math.cos(w)-Math.sin(_)*Math.sin(E)),P=AS(A),L=AS(E);return r5([P,L],c.properties)}function MS(e,o,a){a===void 0&&(a={});for(var c=a.steps||64,d=a.properties?a.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},m=[],_=0;_<c;_++)m.push(d5(e,o,_*-360/c,a).geometry.coordinates);return m.push(m[0]),Dy([m],d)}function PS(e){if(!e)throw new Error("geojson is required");var o=[];return c5(e,function(a){o.push(a)}),ex(o)}/**
 * splaytree v3.1.1
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function f5(e,o){var a={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},c,d,m,_;return _={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(_[Symbol.iterator]=function(){return this}),_;function s(E){return function(A){return w([E,A])}}function w(E){if(c)throw new TypeError("Generator is already executing.");for(;a;)try{if(c=1,d&&(m=E[0]&2?d.return:E[0]?d.throw||((m=d.return)&&m.call(d),0):d.next)&&!(m=m.call(d,E[1])).done)return m;switch(d=0,m&&(E=[E[0]&2,m.value]),E[0]){case 0:case 1:m=E;break;case 4:return a.label++,{value:E[1],done:!1};case 5:a.label++,d=E[1],E=[0];continue;case 7:E=a.ops.pop(),a.trys.pop();continue;default:if(m=a.trys,!(m=m.length>0&&m[m.length-1])&&(E[0]===6||E[0]===2)){a=0;continue}if(E[0]===3&&(!m||E[1]>m[0]&&E[1]<m[3])){a.label=E[1];break}if(E[0]===6&&a.label<m[1]){a.label=m[1],m=E;break}if(m&&a.label<m[2]){a.label=m[2],a.ops.push(E);break}m[2]&&a.ops.pop(),a.trys.pop();continue}E=o.call(e,a)}catch(A){E=[6,A],d=0}finally{c=m=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}}var xl=function(){function e(o,a){this.next=null,this.key=o,this.data=a,this.left=null,this.right=null}return e}();function p5(e,o){return e>o?1:e<o?-1:0}function fl(e,o,a){for(var c=new xl(null,null),d=c,m=c;;){var _=a(e,o.key);if(_<0){if(o.left===null)break;if(a(e,o.left.key)<0){var s=o.left;if(o.left=s.right,s.right=o,o=s,o.left===null)break}m.left=o,m=o,o=o.left}else if(_>0){if(o.right===null)break;if(a(e,o.right.key)>0){var s=o.right;if(o.right=s.left,s.left=o,o=s,o.right===null)break}d.right=o,d=o,o=o.right}else break}return d.right=o.left,m.left=o.right,o.left=c.right,o.right=c.left,o}function Z_(e,o,a,c){var d=new xl(e,o);if(a===null)return d.left=d.right=null,d;a=fl(e,a,c);var m=c(e,a.key);return m<0?(d.left=a.left,d.right=a,a.left=null):m>=0&&(d.right=a.right,d.left=a,a.right=null),d}function zS(e,o,a){var c=null,d=null;if(o){o=fl(e,o,a);var m=a(o.key,e);m===0?(c=o.left,d=o.right):m<0?(d=o.right,o.right=null,c=o):(c=o.left,o.left=null,d=o)}return{left:c,right:d}}function m5(e,o,a){return o===null?e:(e===null||(o=fl(e.key,o,a),o.left=e),o)}function By(e,o,a,c,d){if(e){c(""+o+(a?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+d(e)+`
`);var m=o+(a?"    ":"\u2502   ");e.left&&By(e.left,m,!1,c,d),e.right&&By(e.right,m,!0,c,d)}}var tx=function(){function e(o){o===void 0&&(o=p5),this._root=null,this._size=0,this._comparator=o}return e.prototype.insert=function(o,a){return this._size++,this._root=Z_(o,a,this._root,this._comparator)},e.prototype.add=function(o,a){var c=new xl(o,a);this._root===null&&(c.left=c.right=null,this._size++,this._root=c);var d=this._comparator,m=fl(o,this._root,d),_=d(o,m.key);return _===0?this._root=m:(_<0?(c.left=m.left,c.right=m,m.left=null):_>0&&(c.right=m.right,c.left=m,m.right=null),this._size++,this._root=c),this._root},e.prototype.remove=function(o){this._root=this._remove(o,this._root,this._comparator)},e.prototype._remove=function(o,a,c){var d;if(a===null)return null;a=fl(o,a,c);var m=c(o,a.key);return m===0?(a.left===null?d=a.right:(d=fl(o,a.left,c),d.right=a.right),this._size--,d):a},e.prototype.pop=function(){var o=this._root;if(o){for(;o.left;)o=o.left;return this._root=fl(o.key,this._root,this._comparator),this._root=this._remove(o.key,this._root,this._comparator),{key:o.key,data:o.data}}return null},e.prototype.findStatic=function(o){for(var a=this._root,c=this._comparator;a;){var d=c(o,a.key);if(d===0)return a;d<0?a=a.left:a=a.right}return null},e.prototype.find=function(o){return this._root&&(this._root=fl(o,this._root,this._comparator),this._comparator(o,this._root.key)!==0)?null:this._root},e.prototype.contains=function(o){for(var a=this._root,c=this._comparator;a;){var d=c(o,a.key);if(d===0)return!0;d<0?a=a.left:a=a.right}return!1},e.prototype.forEach=function(o,a){for(var c=this._root,d=[],m=!1;!m;)c!==null?(d.push(c),c=c.left):d.length!==0?(c=d.pop(),o.call(a,c),c=c.right):m=!0;return this},e.prototype.range=function(o,a,c,d){for(var m=[],_=this._comparator,s=this._root,w;m.length!==0||s;)if(s)m.push(s),s=s.left;else{if(s=m.pop(),w=_(s.key,a),w>0)break;if(_(s.key,o)>=0&&c.call(d,s))return this;s=s.right}return this},e.prototype.keys=function(){var o=[];return this.forEach(function(a){var c=a.key;return o.push(c)}),o},e.prototype.values=function(){var o=[];return this.forEach(function(a){var c=a.data;return o.push(c)}),o},e.prototype.min=function(){return this._root?this.minNode(this._root).key:null},e.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},e.prototype.minNode=function(o){if(o===void 0&&(o=this._root),o)for(;o.left;)o=o.left;return o},e.prototype.maxNode=function(o){if(o===void 0&&(o=this._root),o)for(;o.right;)o=o.right;return o},e.prototype.at=function(o){for(var a=this._root,c=!1,d=0,m=[];!c;)if(a)m.push(a),a=a.left;else if(m.length>0){if(a=m.pop(),d===o)return a;d++,a=a.right}else c=!0;return null},e.prototype.next=function(o){var a=this._root,c=null;if(o.right){for(c=o.right;c.left;)c=c.left;return c}for(var d=this._comparator;a;){var m=d(o.key,a.key);if(m===0)break;m<0?(c=a,a=a.left):a=a.right}return c},e.prototype.prev=function(o){var a=this._root,c=null;if(o.left!==null){for(c=o.left;c.right;)c=c.right;return c}for(var d=this._comparator;a;){var m=d(o.key,a.key);if(m===0)break;m<0?a=a.left:(c=a,a=a.right)}return c},e.prototype.clear=function(){return this._root=null,this._size=0,this},e.prototype.toList=function(){return v5(this._root)},e.prototype.load=function(o,a,c){a===void 0&&(a=[]),c===void 0&&(c=!1);var d=o.length,m=this._comparator;if(c&&Vy(o,a,0,d-1,m),this._root===null)this._root=Oy(o,a,0,d),this._size=d;else{var _=_5(this.toList(),g5(o,a),m);d=this._size+d,this._root=Fy({head:_},0,d)}return this},e.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.toString=function(o){o===void 0&&(o=function(c){return String(c.key)});var a=[];return By(this._root,"",!0,function(c){return a.push(c)},o),a.join("")},e.prototype.update=function(o,a,c){var d=this._comparator,m=zS(o,this._root,d),_=m.left,s=m.right;d(o,a)<0?s=Z_(a,c,s,d):_=Z_(a,c,_,d),this._root=m5(_,s,d)},e.prototype.split=function(o){return zS(o,this._root,this._comparator)},e.prototype[Symbol.iterator]=function(){var o;return f5(this,function(a){switch(a.label){case 0:o=this.minNode(),a.label=1;case 1:return o?[4,o]:[3,3];case 2:return a.sent(),o=this.next(o),[3,1];case 3:return[2]}})},e}();function Oy(e,o,a,c){var d=c-a;if(d>0){var m=a+Math.floor(d/2),_=e[m],s=o[m],w=new xl(_,s);return w.left=Oy(e,o,a,m),w.right=Oy(e,o,m+1,c),w}return null}function g5(e,o){for(var a=new xl(null,null),c=a,d=0;d<e.length;d++)c=c.next=new xl(e[d],o[d]);return c.next=null,a.next}function v5(e){for(var o=e,a=[],c=!1,d=new xl(null,null),m=d;!c;)o?(a.push(o),o=o.left):a.length>0?(o=m=m.next=a.pop(),o=o.right):c=!0;return m.next=null,d.next}function Fy(e,o,a){var c=a-o;if(c>0){var d=o+Math.floor(c/2),m=Fy(e,o,d),_=e.head;return _.left=m,e.head=e.head.next,_.right=Fy(e,d+1,a),_}return null}function _5(e,o,a){for(var c=new xl(null,null),d=c,m=e,_=o;m!==null&&_!==null;)a(m.key,_.key)<0?(d.next=m,m=m.next):(d.next=_,_=_.next),d=d.next;return m!==null?d.next=m:_!==null&&(d.next=_),c.next}function Vy(e,o,a,c,d){if(!(a>=c)){for(var m=e[a+c>>1],_=a-1,s=c+1;;){do _++;while(d(e[_],m)<0);do s--;while(d(e[s],m)>0);if(_>=s)break;var w=e[_];e[_]=e[s],e[s]=w,w=o[_],o[_]=o[s],o[s]=w}Vy(e,o,a,s,d),Vy(e,o,s+1,c,d)}}function Uo(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function LS(e,o){for(var a=0;a<o.length;a++){var c=o[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function Xr(e,o,a){return o&&LS(e.prototype,o),a&&LS(e,a),e}var lf=function(o,a){return o.ll.x<=a.x&&a.x<=o.ur.x&&o.ll.y<=a.y&&a.y<=o.ur.y},$y=function(o,a){if(a.ur.x<o.ll.x||o.ur.x<a.ll.x||a.ur.y<o.ll.y||o.ur.y<a.ll.y)return null;var c=o.ll.x<a.ll.x?a.ll.x:o.ll.x,d=o.ur.x<a.ur.x?o.ur.x:a.ur.x,m=o.ll.y<a.ll.y?a.ll.y:o.ll.y,_=o.ur.y<a.ur.y?o.ur.y:a.ur.y;return{ll:{x:c,y:m},ur:{x:d,y:_}}},pl=Number.EPSILON;pl===void 0&&(pl=Math.pow(2,-52));var y5=pl*pl,Ny=function(o,a){if(-pl<o&&o<pl&&-pl<a&&a<pl)return 0;var c=o-a;return c*c<y5*o*a?0:o<a?-1:1},x5=function(){function e(){Uo(this,e),this.reset()}return Xr(e,[{key:"reset",value:function(){this.xRounder=new RS,this.yRounder=new RS}},{key:"round",value:function(a,c){return{x:this.xRounder.round(a),y:this.yRounder.round(c)}}}]),e}(),RS=function(){function e(){Uo(this,e),this.tree=new tx,this.round(0)}return Xr(e,[{key:"round",value:function(a){var c=this.tree.add(a),d=this.tree.prev(c);if(d!==null&&Ny(c.key,d.key)===0)return this.tree.remove(a),d.key;var m=this.tree.next(c);return m!==null&&Ny(c.key,m.key)===0?(this.tree.remove(a),m.key):a}}]),e}(),Nf=new x5,bf=function(o,a){return o.x*a.y-o.y*a.x},YC=function(o,a){return o.x*a.x+o.y*a.y},DS=function(o,a,c){var d={x:a.x-o.x,y:a.y-o.y},m={x:c.x-o.x,y:c.y-o.y},_=bf(d,m);return Ny(_,0)},Eg=function(o){return Math.sqrt(YC(o,o))},b5=function(o,a,c){var d={x:a.x-o.x,y:a.y-o.y},m={x:c.x-o.x,y:c.y-o.y};return bf(m,d)/Eg(m)/Eg(d)},w5=function(o,a,c){var d={x:a.x-o.x,y:a.y-o.y},m={x:c.x-o.x,y:c.y-o.y};return YC(m,d)/Eg(m)/Eg(d)},BS=function(o,a,c){return a.y===0?null:{x:o.x+a.x/a.y*(c-o.y),y:c}},OS=function(o,a,c){return a.x===0?null:{x:c,y:o.y+a.y/a.x*(c-o.x)}},S5=function(o,a,c,d){if(a.x===0)return OS(c,d,o.x);if(d.x===0)return OS(o,a,c.x);if(a.y===0)return BS(c,d,o.y);if(d.y===0)return BS(o,a,c.y);var m=bf(a,d);if(m==0)return null;var _={x:c.x-o.x,y:c.y-o.y},s=bf(_,a)/m,w=bf(_,d)/m,E=o.x+w*a.x,A=c.x+s*d.x,P=o.y+w*a.y,L=c.y+s*d.y,D=(E+A)/2,N=(P+L)/2;return{x:D,y:N}},Ls=function(){Xr(e,null,[{key:"compare",value:function(a,c){var d=e.comparePoints(a.point,c.point);return d!==0?d:(a.point!==c.point&&a.link(c),a.isLeft!==c.isLeft?a.isLeft?1:-1:Tg.compare(a.segment,c.segment))}},{key:"comparePoints",value:function(a,c){return a.x<c.x?-1:a.x>c.x?1:a.y<c.y?-1:a.y>c.y?1:0}}]);function e(o,a){Uo(this,e),o.events===void 0?o.events=[this]:o.events.push(this),this.point=o,this.isLeft=a}return Xr(e,[{key:"link",value:function(a){if(a.point===this.point)throw new Error("Tried to link already linked events");for(var c=a.point.events,d=0,m=c.length;d<m;d++){var _=c[d];this.point.events.push(_),_.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var a=this.point.events.length,c=0;c<a;c++){var d=this.point.events[c];if(d.segment.consumedBy===void 0)for(var m=c+1;m<a;m++){var _=this.point.events[m];_.consumedBy===void 0&&d.otherSE.point.events===_.otherSE.point.events&&d.segment.consume(_.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var a=[],c=0,d=this.point.events.length;c<d;c++){var m=this.point.events[c];m!==this&&!m.segment.ringOut&&m.segment.isInResult()&&a.push(m)}return a}},{key:"getLeftmostComparator",value:function(a){var c=this,d=new Map,m=function(s){var w=s.otherSE;d.set(s,{sine:b5(c.point,a.point,w.point),cosine:w5(c.point,a.point,w.point)})};return function(_,s){d.has(_)||m(_),d.has(s)||m(s);var w=d.get(_),E=w.sine,A=w.cosine,P=d.get(s),L=P.sine,D=P.cosine;return E>=0&&L>=0?A<D?1:A>D?-1:0:E<0&&L<0?A<D?-1:A>D?1:0:L<E?-1:L>E?1:0}}}]),e}(),E5=0,Tg=function(){Xr(e,null,[{key:"compare",value:function(a,c){var d=a.leftSE.point.x,m=c.leftSE.point.x,_=a.rightSE.point.x,s=c.rightSE.point.x;if(s<d)return 1;if(_<m)return-1;var w=a.leftSE.point.y,E=c.leftSE.point.y,A=a.rightSE.point.y,P=c.rightSE.point.y;if(d<m){if(E<w&&E<A)return 1;if(E>w&&E>A)return-1;var L=a.comparePoint(c.leftSE.point);if(L<0)return 1;if(L>0)return-1;var D=c.comparePoint(a.rightSE.point);return D!==0?D:-1}if(d>m){if(w<E&&w<P)return-1;if(w>E&&w>P)return 1;var N=c.comparePoint(a.leftSE.point);if(N!==0)return N;var Z=a.comparePoint(c.rightSE.point);return Z<0?1:Z>0?-1:1}if(w<E)return-1;if(w>E)return 1;if(_<s){var de=c.comparePoint(a.rightSE.point);if(de!==0)return de}if(_>s){var ne=a.comparePoint(c.rightSE.point);if(ne<0)return 1;if(ne>0)return-1}if(_!==s){var ce=A-w,K=_-d,Se=P-E,Y=s-m;if(ce>K&&Se<Y)return 1;if(ce<K&&Se>Y)return-1}return _>s?1:_<s||A<P?-1:A>P?1:a.id<c.id?-1:a.id>c.id?1:0}}]);function e(o,a,c,d){Uo(this,e),this.id=++E5,this.leftSE=o,o.segment=this,o.otherSE=a,this.rightSE=a,a.segment=this,a.otherSE=o,this.rings=c,this.windings=d}return Xr(e,[{key:"replaceRightSE",value:function(a){this.rightSE=a,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var a=this.leftSE.point.y,c=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:a<c?a:c},ur:{x:this.rightSE.point.x,y:a>c?a:c}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(a){return a.x===this.leftSE.point.x&&a.y===this.leftSE.point.y||a.x===this.rightSE.point.x&&a.y===this.rightSE.point.y}},{key:"comparePoint",value:function(a){if(this.isAnEndpoint(a))return 0;var c=this.leftSE.point,d=this.rightSE.point,m=this.vector();if(c.x===d.x)return a.x===c.x?0:a.x<c.x?1:-1;var _=(a.y-c.y)/m.y,s=c.x+_*m.x;if(a.x===s)return 0;var w=(a.x-c.x)/m.x,E=c.y+w*m.y;return a.y===E?0:a.y<E?-1:1}},{key:"getIntersection",value:function(a){var c=this.bbox(),d=a.bbox(),m=$y(c,d);if(m===null)return null;var _=this.leftSE.point,s=this.rightSE.point,w=a.leftSE.point,E=a.rightSE.point,A=lf(c,w)&&this.comparePoint(w)===0,P=lf(d,_)&&a.comparePoint(_)===0,L=lf(c,E)&&this.comparePoint(E)===0,D=lf(d,s)&&a.comparePoint(s)===0;if(P&&A)return D&&!L?s:!D&&L?E:null;if(P)return L&&_.x===E.x&&_.y===E.y?null:_;if(A)return D&&s.x===w.x&&s.y===w.y?null:w;if(D&&L)return null;if(D)return s;if(L)return E;var N=S5(_,this.vector(),w,a.vector());return N===null||!lf(m,N)?null:Nf.round(N.x,N.y)}},{key:"split",value:function(a){var c=[],d=a.events!==void 0,m=new Ls(a,!0),_=new Ls(a,!1),s=this.rightSE;this.replaceRightSE(_),c.push(_),c.push(m);var w=new e(m,s,this.rings.slice(),this.windings.slice());return Ls.comparePoints(w.leftSE.point,w.rightSE.point)>0&&w.swapEvents(),Ls.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),d&&(m.checkForConsuming(),_.checkForConsuming()),c}},{key:"swapEvents",value:function(){var a=this.rightSE;this.rightSE=this.leftSE,this.leftSE=a,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var c=0,d=this.windings.length;c<d;c++)this.windings[c]*=-1}},{key:"consume",value:function(a){for(var c=this,d=a;c.consumedBy;)c=c.consumedBy;for(;d.consumedBy;)d=d.consumedBy;var m=e.compare(c,d);if(m!==0){if(m>0){var _=c;c=d,d=_}if(c.prev===d){var s=c;c=d,d=s}for(var w=0,E=d.rings.length;w<E;w++){var A=d.rings[w],P=d.windings[w],L=c.rings.indexOf(A);L===-1?(c.rings.push(A),c.windings.push(P)):c.windings[L]+=P}d.rings=null,d.windings=null,d.consumedBy=c,d.leftSE.consumedBy=c.leftSE,d.rightSE.consumedBy=c.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var a=this.prev.consumedBy||this.prev;this._beforeState=a.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var a=this.beforeState();this._afterState={rings:a.rings.slice(0),windings:a.windings.slice(0),multiPolys:[]};for(var c=this._afterState.rings,d=this._afterState.windings,m=this._afterState.multiPolys,_=0,s=this.rings.length;_<s;_++){var w=this.rings[_],E=this.windings[_],A=c.indexOf(w);A===-1?(c.push(w),d.push(E)):d[A]+=E}for(var P=[],L=[],D=0,N=c.length;D<N;D++)if(d[D]!==0){var Z=c[D],de=Z.poly;if(L.indexOf(de)===-1)if(Z.isExterior)P.push(de);else{L.indexOf(de)===-1&&L.push(de);var ne=P.indexOf(Z.poly);ne!==-1&&P.splice(ne,1)}}for(var ce=0,K=P.length;ce<K;ce++){var Se=P[ce].multiPoly;m.indexOf(Se)===-1&&m.push(Se)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var a=this.beforeState().multiPolys,c=this.afterState().multiPolys;switch(os.type){case"union":{var d=a.length===0,m=c.length===0;this._isInResult=d!==m;break}case"intersection":{var _,s;a.length<c.length?(_=a.length,s=c.length):(_=c.length,s=a.length),this._isInResult=s===os.numMultiPolys&&_<s;break}case"xor":{var w=Math.abs(a.length-c.length);this._isInResult=w%2===1;break}case"difference":{var E=function(P){return P.length===1&&P[0].isSubject};this._isInResult=E(a)!==E(c);break}default:throw new Error("Unrecognized operation type found ".concat(os.type))}return this._isInResult}}],[{key:"fromRing",value:function(a,c,d){var m,_,s,w=Ls.comparePoints(a,c);if(w<0)m=a,_=c,s=1;else if(w>0)m=c,_=a,s=-1;else throw new Error("Tried to create degenerate segment at [".concat(a.x,", ").concat(a.y,"]"));var E=new Ls(m,!0),A=new Ls(_,!1);return new e(E,A,[d],[s])}}]),e}(),FS=function(){function e(o,a,c){if(Uo(this,e),!Array.isArray(o)||o.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=a,this.isExterior=c,this.segments=[],typeof o[0][0]!="number"||typeof o[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var d=Nf.round(o[0][0],o[0][1]);this.bbox={ll:{x:d.x,y:d.y},ur:{x:d.x,y:d.y}};for(var m=d,_=1,s=o.length;_<s;_++){if(typeof o[_][0]!="number"||typeof o[_][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var w=Nf.round(o[_][0],o[_][1]);w.x===m.x&&w.y===m.y||(this.segments.push(Tg.fromRing(m,w,this)),w.x<this.bbox.ll.x&&(this.bbox.ll.x=w.x),w.y<this.bbox.ll.y&&(this.bbox.ll.y=w.y),w.x>this.bbox.ur.x&&(this.bbox.ur.x=w.x),w.y>this.bbox.ur.y&&(this.bbox.ur.y=w.y),m=w)}(d.x!==m.x||d.y!==m.y)&&this.segments.push(Tg.fromRing(m,d,this))}return Xr(e,[{key:"getSweepEvents",value:function(){for(var a=[],c=0,d=this.segments.length;c<d;c++){var m=this.segments[c];a.push(m.leftSE),a.push(m.rightSE)}return a}}]),e}(),T5=function(){function e(o,a){if(Uo(this,e),!Array.isArray(o))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new FS(o[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var c=1,d=o.length;c<d;c++){var m=new FS(o[c],this,!1);m.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=m.bbox.ll.x),m.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=m.bbox.ll.y),m.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=m.bbox.ur.x),m.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=m.bbox.ur.y),this.interiorRings.push(m)}this.multiPoly=a}return Xr(e,[{key:"getSweepEvents",value:function(){for(var a=this.exteriorRing.getSweepEvents(),c=0,d=this.interiorRings.length;c<d;c++)for(var m=this.interiorRings[c].getSweepEvents(),_=0,s=m.length;_<s;_++)a.push(m[_]);return a}}]),e}(),VS=function(){function e(o,a){if(Uo(this,e),!Array.isArray(o))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof o[0][0][0]=="number"&&(o=[o])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var c=0,d=o.length;c<d;c++){var m=new T5(o[c],this);m.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=m.bbox.ll.x),m.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=m.bbox.ll.y),m.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=m.bbox.ur.x),m.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=m.bbox.ur.y),this.polys.push(m)}this.isSubject=a}return Xr(e,[{key:"getSweepEvents",value:function(){for(var a=[],c=0,d=this.polys.length;c<d;c++)for(var m=this.polys[c].getSweepEvents(),_=0,s=m.length;_<s;_++)a.push(m[_]);return a}}]),e}(),C5=function(){Xr(e,null,[{key:"factory",value:function(a){for(var c=[],d=0,m=a.length;d<m;d++){var _=a[d];if(!(!_.isInResult()||_.ringOut)){for(var s=null,w=_.leftSE,E=_.rightSE,A=[w],P=w.point,L=[];s=w,w=E,A.push(w),w.point!==P;)for(;;){var D=w.getAvailableLinkedEvents();if(D.length===0){var N=A[0].point,Z=A[A.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(N.x,",")+" ".concat(N.y,"]. Last matching segment found ends at")+" [".concat(Z.x,", ").concat(Z.y,"]."))}if(D.length===1){E=D[0].otherSE;break}for(var de=null,ne=0,ce=L.length;ne<ce;ne++)if(L[ne].point===w.point){de=ne;break}if(de!==null){var K=L.splice(de)[0],Se=A.splice(K.index);Se.unshift(Se[0].otherSE),c.push(new e(Se.reverse()));continue}L.push({index:A.length,point:w.point});var Y=w.getLeftmostComparator(s);E=D.sort(Y)[0].otherSE;break}c.push(new e(A))}}return c}}]);function e(o){Uo(this,e),this.events=o;for(var a=0,c=o.length;a<c;a++)o[a].segment.ringOut=this;this.poly=null}return Xr(e,[{key:"getGeom",value:function(){for(var a=this.events[0].point,c=[a],d=1,m=this.events.length-1;d<m;d++){var _=this.events[d].point,s=this.events[d+1].point;DS(_,a,s)!==0&&(c.push(_),a=_)}if(c.length===1)return null;var w=c[0],E=c[1];DS(w,a,E)===0&&c.shift(),c.push(c[0]);for(var A=this.isExteriorRing()?1:-1,P=this.isExteriorRing()?0:c.length-1,L=this.isExteriorRing()?c.length:-1,D=[],N=P;N!=L;N+=A)D.push([c[N].x,c[N].y]);return D}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var a=this.enclosingRing();this._isExteriorRing=a?!a.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var a=this.events[0],c=1,d=this.events.length;c<d;c++){var m=this.events[c];Ls.compare(a,m)>0&&(a=m)}for(var _=a.segment.prevInResult(),s=_?_.prevInResult():null;;){if(!_)return null;if(!s)return _.ringOut;if(s.ringOut!==_.ringOut)return s.ringOut.enclosingRing()!==_.ringOut?_.ringOut:_.ringOut.enclosingRing();_=s.prevInResult(),s=_?_.prevInResult():null}}}]),e}(),$S=function(){function e(o){Uo(this,e),this.exteriorRing=o,o.poly=this,this.interiorRings=[]}return Xr(e,[{key:"addInterior",value:function(a){this.interiorRings.push(a),a.poly=this}},{key:"getGeom",value:function(){var a=[this.exteriorRing.getGeom()];if(a[0]===null)return null;for(var c=0,d=this.interiorRings.length;c<d;c++){var m=this.interiorRings[c].getGeom();m!==null&&a.push(m)}return a}}]),e}(),I5=function(){function e(o){Uo(this,e),this.rings=o,this.polys=this._composePolys(o)}return Xr(e,[{key:"getGeom",value:function(){for(var a=[],c=0,d=this.polys.length;c<d;c++){var m=this.polys[c].getGeom();m!==null&&a.push(m)}return a}},{key:"_composePolys",value:function(a){for(var c=[],d=0,m=a.length;d<m;d++){var _=a[d];if(!_.poly)if(_.isExteriorRing())c.push(new $S(_));else{var s=_.enclosingRing();s.poly||c.push(new $S(s)),s.poly.addInterior(_)}}return c}}]),e}(),A5=function(){function e(o){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tg.compare;Uo(this,e),this.queue=o,this.tree=new tx(a),this.segments=[]}return Xr(e,[{key:"process",value:function(a){var c=a.segment,d=[];if(a.consumedBy)return a.isLeft?this.queue.remove(a.otherSE):this.tree.remove(c),d;var m=a.isLeft?this.tree.insert(c):this.tree.find(c);if(!m)throw new Error("Unable to find segment #".concat(c.id," ")+"[".concat(c.leftSE.point.x,", ").concat(c.leftSE.point.y,"] -> ")+"[".concat(c.rightSE.point.x,", ").concat(c.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var _=m,s=m,w=void 0,E=void 0;w===void 0;)_=this.tree.prev(_),_===null?w=null:_.key.consumedBy===void 0&&(w=_.key);for(;E===void 0;)s=this.tree.next(s),s===null?E=null:s.key.consumedBy===void 0&&(E=s.key);if(a.isLeft){var A=null;if(w){var P=w.getIntersection(c);if(P!==null&&(c.isAnEndpoint(P)||(A=P),!w.isAnEndpoint(P)))for(var L=this._splitSafely(w,P),D=0,N=L.length;D<N;D++)d.push(L[D])}var Z=null;if(E){var de=E.getIntersection(c);if(de!==null&&(c.isAnEndpoint(de)||(Z=de),!E.isAnEndpoint(de)))for(var ne=this._splitSafely(E,de),ce=0,K=ne.length;ce<K;ce++)d.push(ne[ce])}if(A!==null||Z!==null){var Se=null;if(A===null)Se=Z;else if(Z===null)Se=A;else{var Y=Ls.comparePoints(A,Z);Se=Y<=0?A:Z}this.queue.remove(c.rightSE),d.push(c.rightSE);for(var _e=c.split(Se),fe=0,ve=_e.length;fe<ve;fe++)d.push(_e[fe])}d.length>0?(this.tree.remove(c),d.push(a)):(this.segments.push(c),c.prev=w)}else{if(w&&E){var Ee=w.getIntersection(E);if(Ee!==null){if(!w.isAnEndpoint(Ee))for(var be=this._splitSafely(w,Ee),Re=0,ze=be.length;Re<ze;Re++)d.push(be[Re]);if(!E.isAnEndpoint(Ee))for(var Je=this._splitSafely(E,Ee),ct=0,nt=Je.length;ct<nt;ct++)d.push(Je[ct])}}this.tree.remove(c)}return d}},{key:"_splitSafely",value:function(a,c){this.tree.remove(a);var d=a.rightSE;this.queue.remove(d);var m=a.split(c);return m.push(d),a.consumedBy===void 0&&this.tree.insert(a),m}}]),e}(),NS=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,k5=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,M5=function(){function e(){Uo(this,e)}return Xr(e,[{key:"run",value:function(a,c,d){os.type=a,Nf.reset();for(var m=[new VS(c,!0)],_=0,s=d.length;_<s;_++)m.push(new VS(d[_],!1));if(os.numMultiPolys=m.length,os.type==="difference")for(var w=m[0],E=1;E<m.length;)$y(m[E].bbox,w.bbox)!==null?E++:m.splice(E,1);if(os.type==="intersection"){for(var A=0,P=m.length;A<P;A++)for(var L=m[A],D=A+1,N=m.length;D<N;D++)if($y(L.bbox,m[D].bbox)===null)return[]}for(var Z=new tx(Ls.compare),de=0,ne=m.length;de<ne;de++)for(var ce=m[de].getSweepEvents(),K=0,Se=ce.length;K<Se;K++)if(Z.insert(ce[K]),Z.size>NS)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var Y=new A5(Z),_e=Z.size,fe=Z.pop();fe;){var ve=fe.key;if(Z.size===_e){var Ee=ve.segment;throw new Error("Unable to pop() ".concat(ve.isLeft?"left":"right"," SweepEvent ")+"[".concat(ve.point.x,", ").concat(ve.point.y,"] from segment #").concat(Ee.id," ")+"[".concat(Ee.leftSE.point.x,", ").concat(Ee.leftSE.point.y,"] -> ")+"[".concat(Ee.rightSE.point.x,", ").concat(Ee.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Z.size>NS)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(Y.segments.length>k5)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var be=Y.process(ve),Re=0,ze=be.length;Re<ze;Re++){var Je=be[Re];Je.consumedBy===void 0&&Z.insert(Je)}_e=Z.size,fe=Z.pop()}Nf.reset();var ct=C5.factory(Y.segments),nt=new I5(ct);return nt.getGeom()}}]),e}(),os=new M5,P5=function(o){for(var a=arguments.length,c=new Array(a>1?a-1:0),d=1;d<a;d++)c[d-1]=arguments[d];return os.run("union",o,c)},z5=function(o){for(var a=arguments.length,c=new Array(a>1?a-1:0),d=1;d<a;d++)c[d-1]=arguments[d];return os.run("intersection",o,c)},L5=function(o){for(var a=arguments.length,c=new Array(a>1?a-1:0),d=1;d<a;d++)c[d-1]=arguments[d];return os.run("xor",o,c)},R5=function(o){for(var a=arguments.length,c=new Array(a>1?a-1:0),d=1;d<a;d++)c[d-1]=arguments[d];return os.run("difference",o,c)},US={union:P5,intersection:z5,xor:L5,difference:R5};function D5(e,o){if(o=o||{},!s5(o))throw new Error("options is invalid");var a=o.propertyName;h5(e,"Polygon","dissolve");var c=[];if(o.propertyName){var d={};a5(e,function(w){Object.prototype.hasOwnProperty.call(d,w.properties[a])||(d[w.properties[a]]=[]),d[w.properties[a]].push(w)});for(var m=Object.keys(d),_=0;_<m.length;_++){var s=IS(US.union.apply(null,d[m[_]].map(function(w){return w.geometry.coordinates})));s.properties[a]=m[_],c.push(s)}}else return PS(IS(US.union.apply(null,e.features.map(function(w){return w.geometry.coordinates}))));return PS(ex(c))}const B5={class:"container"},O5=vn({__name:"MapSPF",setup(e){let o=He(50),a=He();function c(){o.value++}function d(){o.value--}const m=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[4,0,2,4,8,5,4,6,5,9,1,3,2,4,4,6],[3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],[4,0,2,4,8,6,5,6,5,8,1,3,2,4,4,6],[5,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[6,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,1,5,9,2,3,2,4,3,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,8,2,5,9,1,3,2,4,4,6],[5,0,2,4,8,6,4,6,5,9,1,3,2,8,4,6],[1,0,2,4,8,6,4,6,4,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,2,2,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,5,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,3,9,1,3,2,4,4,6],[1,0,6,4,8,6,4,6,5,9,1,3,2,4,4,5],[1,2,2,4,1,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,3,4,6,5,9,2,3,2,4,4,6],[8,0,2,4,8,6,4,6,7,9,1,3,2,4,4,6],[1,2,6,4,8,6,4,6,3,9,1,3,2,4,4,6],[1,6,2,4,8,6,4,6,5,9,1,3,2,5,4,6],[1,8,2,4,8,6,4,6,5,9,1,3,2,4,4,7],[1,0,2,4,8,6,4,6,3,9,1,3,2,4,4,6],[1,0,5,4,8,6,4,6,5,9,1,3,2,4,4,6]],_=["#FFEBEE","#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828","#B71C1C"];He(0);function s(L){return L===0?"black":_[L]}const w=ex([]),E=30,A=[120,30];let P;for(let L=0;L<E;L++){let D=MS(A,L+1,{steps:64,units:"kilometers"});const N=m[L];for(let Z=0;Z<16;Z++)N[Z]!==0&&(L===0?w.features.push(Dy([[A,...D.geometry.coordinates[0].slice(4*Z,4*(Z+1)+1),A]],{color:s(N[Z])})):(P=MS(A,L,{steps:64,units:"kilometers"}),w.features.push(Dy([[...P.geometry.coordinates[0].slice(4*Z,4*(Z+1)+1),...D.geometry.coordinates[0].slice(4*Z,4*(Z+1)+1).reverse(),P.geometry.coordinates[0][4*Z]]],{color:s(N[Z])}))));a=D5(w,{propertyName:"color"})}return(L,D)=>{const N=zo("v-geo-source"),Z=zo("v-fill-layer");return fi(),oo("div",B5,[F(Ph,null,{default:wn(()=>[F(N,{id:"spf",data:pi(a)},null,8,["data"]),F(Z,{ref:"fillLayerRef",id:"spf",source:"spf",paint:{"fill-color":["get","color"],"fill-opacity":pi(o)/100}},null,8,["paint"])]),_:1}),F(zc,{class:"slide-opacity mx-auto",width:"400",color:"primary",height:"74"},{default:wn(()=>[F(U0,null,{default:wn(()=>[F(bg,{modelValue:pi(o),"onUpdate:modelValue":D[0]||(D[0]=de=>zi(o)?o.value=de:o=de),color:"black","track-color":"grey",min:"0",max:"100",step:1},{prepend:wn(()=>[F(wi,{size:"small",variant:"text",icon:"mdi-minus",color:"black",onClick:d})]),append:wn(()=>[F(wi,{size:"small",variant:"text",icon:"mdi-plus",color:"black",onClick:c})]),_:1},8,["modelValue"])]),_:1})]),_:1})])}}});const F5=Oo(O5,[["__scopeId","data-v-3b30b5a1"]]),V5=vn({__name:"MapPopulation",setup(e){return(o,a)=>(fi(),oo("div",null,[F(Ph)]))}}),$5={},N5=vn({__name:"MapTyphoon",setup(e){return(o,a)=>(fi(),oo("div",null,[F(Ph)]))}}),U5="modulepreload",j5=function(e,o){return new URL(e,o).href},jS={},GS=function(o,a,c){if(!a||a.length===0)return o();const d=document.getElementsByTagName("link");return Promise.all(a.map(m=>{if(m=j5(m,c),m in jS)return;jS[m]=!0;const _=m.endsWith(".css"),s=_?'[rel="stylesheet"]':"";if(!!c)for(let A=d.length-1;A>=0;A--){const P=d[A];if(P.href===m&&(!_||P.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${s}`))return;const E=document.createElement("link");if(E.rel=_?"stylesheet":U5,_||(E.as="script",E.crossOrigin=""),E.href=m,document.head.appendChild(E),_)return new Promise((A,P)=>{E.addEventListener("load",A),E.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${m}`)))})})).then(()=>o())};const G5={class:"demo-content"},q5={__name:"MapInversion",setup(e){const o=He(null),a=He(null),c=async(d,m)=>{const _=await GS(()=>Promise.resolve().then(()=>WL),void 0,import.meta.url).then(P=>P.default),{WindLayer:s,ScalarFill:w}=await GS(()=>import("./mapbox-wind.esm.a5b75175.js"),[],import.meta.url);_.accessToken="pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA";const E=new _.Map({container:d,style:{version:8,sources:{carto:{type:"raster",tiles:["//a.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","//b.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","//c.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","//d.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"carto",type:"raster",source:"carto",paint:{"raster-resampling":"nearest","raster-fade-duration":0}},{id:"background",type:"background",layout:{visibility:"none"}}]},center:[113.53450137499999,34.44104525],zoom:4}),A={temp:[[203,[115,70,105,255]],[218,[202,172,195,255]],[233,[162,70,145,255]],[248,[143,89,169,255]],[258,[157,219,217,255]],[265,[106,191,181,255]],[269,[100,166,189,255]],[273.15,[93,133,198,255]],[274,[68,125,99,255]],[283,[128,147,24,255]],[294,[243,183,4,255]],[303,[232,83,25,255]],[320,[71,14,0,255]]],wind:[[0,[98,113,183,255]],[1,[57,97,159,255]],[3,[74,148,169,255]],[5,[77,141,123,255]],[7,[83,165,83,255]],[9,[53,159,53,255]],[11,[167,157,81,255]],[13,[159,127,58,255]],[15,[161,108,92,255]],[17,[129,58,78,255]],[19,[175,80,136,255]],[21,[117,74,147,255]],[24,[109,97,163,255]],[27,[68,105,141,255]],[29,[92,144,152,255]],[36,[125,68,165,255]],[46,[231,215,215,255]],[51,[219,212,135,255]],[77,[205,202,112,255]],[104,[128,128,128,255]]]};E.on("load",()=>{fetch("https://sakitam.oss-cn-beijing.aliyuncs.com/codepen/wind-layer/json/wind.json").then(P=>P.json()).then(P=>{console.log(P);const L=A.wind.reduce((N,Z,de)=>N.concat(Z[0],"rgba("+Z[1].join(",")+")"),[]),D=new w("wind-fill",{type:"image",url:"https://sakitam.oss-cn-beijing.aliyuncs.com/codepen/wind-layer/image/var_ugrd-var_vgrd.png",extent:[[-180,85.051129],[-180,-85.051129],[180,85.051129],[180,-85.051129]]},{styleSpec:{"fill-color":["interpolate",["linear"],["get","value"],...L],opacity:["interpolate",["exponential",.5],["zoom"],5,1,8,1]},renderForm:"rg",widthSegments:720,heightSegments:360,displayRange:[0,150],mappingRange:[0,1e5]});E.addLayer(D),window.windLayer=new s("wind",P,{windOptions:{frameRate:16,maxAge:60,globalAlpha:.9,velocityScale:.01,paths:3782}}),console.log(E,window.windLayer),window.windLayer.addTo(E)})})};return zn(()=>{c(o.value,a.value)}),(d,m)=>(fi(),oo("div",G5,[va("div",{class:"demo-content-datgui",ref_key:"gui",ref:a},null,512),va("div",{class:"map-warp",ref_key:"map",ref:o},null,512)]))}},W_=vn({__name:"MapDose",setup(e){return(o,a)=>(fi(),oo("div",null,[F(Ph)]))}}),Z5=[{path:"/",components:{left_draw:sf,main_view:yc}},{path:"/index",name:"index",components:{left_draw:sf,main_view:yc}},{path:"/finance",name:"finance",components:{left_draw:$_,main_view:yc}},{path:"/meteorology",name:"meteorology",components:{left_draw:Hm,main_view:yc}},{path:"/nuclear",name:"nuclear",components:{left_draw:Xm,main_view:yc}},{path:"/evacuate",name:"evacuate",components:{left_draw:N_,main_view:F5}},{path:"/index/index",name:"sub_index",components:{left_draw:sf,main_view:yc}},{path:"/index/land",name:"land",components:{left_draw:sf,main_view:G_}},{path:"/index/elevation",name:"elevation",components:{left_draw:sf,main_view:n5}},{path:"/finance/gdp",name:"gdp",components:{left_draw:$_,main_view:yc}},{path:"/finance/density",name:"density",components:{left_draw:$_,main_view:V5}},{path:"/meteorology/weather",name:"weather",components:{left_draw:Hm,main_view:$5}},{path:"/meteorology/typhoon",name:"typhoon",components:{left_draw:Hm,main_view:N5}},{path:"/meteorology/inversion",name:"inversion",components:{left_draw:Hm,main_view:q5}},{path:"/nuclear/single",name:"single",components:{left_draw:Xm,main_view:W_}},{path:"/nuclear/multiple",name:"multiple",components:{left_draw:Xm,main_view:W_}},{path:"/nuclear/single",name:"single",components:{left_draw:Xm,main_view:W_}},{path:"/evacuate/success",name:"success",components:{left_draw:N_,main_view:G_}},{path:"/evacuate/failure",name:"failure",components:{left_draw:N_,main_view:G_}}],W5=L3({history:XO(),routes:Z5});JP(qL).use(W5).use(MO).use(xR).mount("#app");export{z0 as m};
