function rA(e,s){for(var a=0;a<s.length;a++){const u=s[a];if(typeof u!="string"&&!Array.isArray(u)){for(const d in u)if(d!=="default"&&!(d in e)){const g=Object.getOwnPropertyDescriptor(u,d);g&&Object.defineProperty(e,d,g.get?g:{enumerable:!0,get:()=>u[d]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))u(d);new MutationObserver(d=>{for(const g of d)if(g.type==="childList")for(const x of g.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&u(x)}).observe(document,{childList:!0,subtree:!0});function a(d){const g={};return d.integrity&&(g.integrity=d.integrity),d.referrerpolicy&&(g.referrerPolicy=d.referrerpolicy),d.crossorigin==="use-credentials"?g.credentials="include":d.crossorigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function u(d){if(d.ep)return;d.ep=!0;const g=a(d);fetch(d.href,g)}})();function dy(e,s){const a=Object.create(null),u=e.split(",");for(let d=0;d<u.length;d++)a[u[d]]=!0;return s?d=>!!a[d.toLowerCase()]:d=>!!a[d]}const oA="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",sA=dy(oA);function Xw(e){return!!e||e===""}function fy(e){if(An(e)){const s={};for(let a=0;a<e.length;a++){const u=e[a],d=fr(u)?cA(u):fy(u);if(d)for(const g in d)s[g]=d[g]}return s}else{if(fr(e))return e;if(Wi(e))return e}}const aA=/;(?![^(]*\))/g,lA=/:(.+)/;function cA(e){const s={};return e.split(aA).forEach(a=>{if(a){const u=a.split(lA);u.length>1&&(s[u[0].trim()]=u[1].trim())}}),s}function py(e){let s="";if(fr(e))s=e;else if(An(e))for(let a=0;a<e.length;a++){const u=py(e[a]);u&&(s+=u+" ")}else if(Wi(e))for(const a in e)e[a]&&(s+=a+" ");return s.trim()}const yi={},Xu=[],Jo=()=>{},uA=()=>!1,hA=/^on[^a-z]/,sg=e=>hA.test(e),my=e=>e.startsWith("onUpdate:"),Tr=Object.assign,gy=(e,s)=>{const a=e.indexOf(s);a>-1&&e.splice(a,1)},dA=Object.prototype.hasOwnProperty,Wn=(e,s)=>dA.call(e,s),An=Array.isArray,Wd=e=>ag(e)==="[object Map]",fA=e=>ag(e)==="[object Set]",Bn=e=>typeof e=="function",fr=e=>typeof e=="string",vy=e=>typeof e=="symbol",Wi=e=>e!==null&&typeof e=="object",Yw=e=>Wi(e)&&Bn(e.then)&&Bn(e.catch),pA=Object.prototype.toString,ag=e=>pA.call(e),mA=e=>ag(e).slice(8,-1),gA=e=>ag(e)==="[object Object]",_y=e=>fr(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,zm=dy(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),lg=e=>{const s=Object.create(null);return a=>s[a]||(s[a]=e(a))},vA=/-(\w)/g,ko=lg(e=>e.replace(vA,(s,a)=>a?a.toUpperCase():"")),_A=/\B([A-Z])/g,rh=lg(e=>e.replace(_A,"-$1").toLowerCase()),dl=lg(e=>e.charAt(0).toUpperCase()+e.slice(1)),Lm=lg(e=>e?`on${dl(e)}`:""),af=(e,s)=>!Object.is(e,s),Dm=(e,s)=>{for(let a=0;a<e.length;a++)e[a](s)},Fm=(e,s,a)=>{Object.defineProperty(e,s,{configurable:!0,enumerable:!1,value:a})},Vm=e=>{const s=parseFloat(e);return isNaN(s)?e:s};let W1;const yA=()=>W1||(W1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let To;class Kw{constructor(s=!1){this.detached=s,this.active=!0,this.effects=[],this.cleanups=[],this.parent=To,!s&&To&&(this.index=(To.scopes||(To.scopes=[])).push(this)-1)}run(s){if(this.active){const a=To;try{return To=this,s()}finally{To=a}}}on(){To=this}off(){To=this.parent}stop(s){if(this.active){let a,u;for(a=0,u=this.effects.length;a<u;a++)this.effects[a].stop();for(a=0,u=this.cleanups.length;a<u;a++)this.cleanups[a]();if(this.scopes)for(a=0,u=this.scopes.length;a<u;a++)this.scopes[a].stop(!0);if(!this.detached&&this.parent&&!s){const d=this.parent.scopes.pop();d&&d!==this&&(this.parent.scopes[this.index]=d,d.index=this.index)}this.parent=void 0,this.active=!1}}}function Cf(e){return new Kw(e)}function xA(e,s=To){s&&s.active&&s.effects.push(e)}function Ec(e){To&&To.cleanups.push(e)}const yy=e=>{const s=new Set(e);return s.w=0,s.n=0,s},Jw=e=>(e.w&ll)>0,Qw=e=>(e.n&ll)>0,bA=({deps:e})=>{if(e.length)for(let s=0;s<e.length;s++)e[s].w|=ll},wA=e=>{const{deps:s}=e;if(s.length){let a=0;for(let u=0;u<s.length;u++){const d=s[u];Jw(d)&&!Qw(d)?d.delete(e):s[a++]=d,d.w&=~ll,d.n&=~ll}s.length=a}},w_=new WeakMap;let qd=0,ll=1;const S_=30;let Xo;const xc=Symbol(""),T_=Symbol("");class xy{constructor(s,a=null,u){this.fn=s,this.scheduler=a,this.active=!0,this.deps=[],this.parent=void 0,xA(this,u)}run(){if(!this.active)return this.fn();let s=Xo,a=sl;for(;s;){if(s===this)return;s=s.parent}try{return this.parent=Xo,Xo=this,sl=!0,ll=1<<++qd,qd<=S_?bA(this):H1(this),this.fn()}finally{qd<=S_&&wA(this),ll=1<<--qd,Xo=this.parent,sl=a,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Xo===this?this.deferStop=!0:this.active&&(H1(this),this.onStop&&this.onStop(),this.active=!1)}}function H1(e){const{deps:s}=e;if(s.length){for(let a=0;a<s.length;a++)s[a].delete(e);s.length=0}}let sl=!0;const eS=[];function Cc(){eS.push(sl),sl=!1}function Ic(){const e=eS.pop();sl=e===void 0?!0:e}function co(e,s,a){if(sl&&Xo){let u=w_.get(e);u||w_.set(e,u=new Map);let d=u.get(a);d||u.set(a,d=yy()),tS(d)}}function tS(e,s){let a=!1;qd<=S_?Qw(e)||(e.n|=ll,a=!Jw(e)):a=!e.has(Xo),a&&(e.add(Xo),Xo.deps.push(e))}function ca(e,s,a,u,d,g){const x=w_.get(e);if(!x)return;let o=[];if(s==="clear")o=[...x.values()];else if(a==="length"&&An(e))x.forEach((w,E)=>{(E==="length"||E>=u)&&o.push(w)});else switch(a!==void 0&&o.push(x.get(a)),s){case"add":An(e)?_y(a)&&o.push(x.get("length")):(o.push(x.get(xc)),Wd(e)&&o.push(x.get(T_)));break;case"delete":An(e)||(o.push(x.get(xc)),Wd(e)&&o.push(x.get(T_)));break;case"set":Wd(e)&&o.push(x.get(xc));break}if(o.length===1)o[0]&&E_(o[0]);else{const w=[];for(const E of o)E&&w.push(...E);E_(yy(w))}}function E_(e,s){const a=An(e)?e:[...e];for(const u of a)u.computed&&X1(u);for(const u of a)u.computed||X1(u)}function X1(e,s){(e!==Xo||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const SA=dy("__proto__,__v_isRef,__isVue"),nS=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(vy)),TA=by(),EA=by(!1,!0),CA=by(!0),Y1=IA();function IA(){const e={};return["includes","indexOf","lastIndexOf"].forEach(s=>{e[s]=function(...a){const u=Hn(this);for(let g=0,x=this.length;g<x;g++)co(u,"get",g+"");const d=u[s](...a);return d===-1||d===!1?u[s](...a.map(Hn)):d}}),["push","pop","shift","unshift","splice"].forEach(s=>{e[s]=function(...a){Cc();const u=Hn(this)[s].apply(this,a);return Ic(),u}}),e}function by(e=!1,s=!1){return function(u,d,g){if(d==="__v_isReactive")return!e;if(d==="__v_isReadonly")return e;if(d==="__v_isShallow")return s;if(d==="__v_raw"&&g===(e?s?jA:aS:s?sS:oS).get(u))return u;const x=An(u);if(!e&&x&&Wn(Y1,d))return Reflect.get(Y1,d,g);const o=Reflect.get(u,d,g);return(vy(d)?nS.has(d):SA(d))||(e||co(u,"get",d),s)?o:ki(o)?x&&_y(d)?o:o.value:Wi(o)?e?If(o):Qi(o):o}}const AA=iS(),kA=iS(!0);function iS(e=!1){return function(a,u,d,g){let x=a[u];if(Qu(x)&&ki(x)&&!ki(d))return!1;if(!e&&(!$m(d)&&!Qu(d)&&(x=Hn(x),d=Hn(d)),!An(a)&&ki(x)&&!ki(d)))return x.value=d,!0;const o=An(a)&&_y(u)?Number(u)<a.length:Wn(a,u),w=Reflect.set(a,u,d,g);return a===Hn(g)&&(o?af(d,x)&&ca(a,"set",u,d):ca(a,"add",u,d)),w}}function MA(e,s){const a=Wn(e,s);e[s];const u=Reflect.deleteProperty(e,s);return u&&a&&ca(e,"delete",s,void 0),u}function PA(e,s){const a=Reflect.has(e,s);return(!vy(s)||!nS.has(s))&&co(e,"has",s),a}function zA(e){return co(e,"iterate",An(e)?"length":xc),Reflect.ownKeys(e)}const rS={get:TA,set:AA,deleteProperty:MA,has:PA,ownKeys:zA},LA={get:CA,set(e,s){return!0},deleteProperty(e,s){return!0}},DA=Tr({},rS,{get:EA,set:kA}),wy=e=>e,cg=e=>Reflect.getPrototypeOf(e);function wm(e,s,a=!1,u=!1){e=e.__v_raw;const d=Hn(e),g=Hn(s);a||(s!==g&&co(d,"get",s),co(d,"get",g));const{has:x}=cg(d),o=u?wy:a?Ey:lf;if(x.call(d,s))return o(e.get(s));if(x.call(d,g))return o(e.get(g));e!==d&&e.get(s)}function Sm(e,s=!1){const a=this.__v_raw,u=Hn(a),d=Hn(e);return s||(e!==d&&co(u,"has",e),co(u,"has",d)),e===d?a.has(e):a.has(e)||a.has(d)}function Tm(e,s=!1){return e=e.__v_raw,!s&&co(Hn(e),"iterate",xc),Reflect.get(e,"size",e)}function K1(e){e=Hn(e);const s=Hn(this);return cg(s).has.call(s,e)||(s.add(e),ca(s,"add",e,e)),this}function J1(e,s){s=Hn(s);const a=Hn(this),{has:u,get:d}=cg(a);let g=u.call(a,e);g||(e=Hn(e),g=u.call(a,e));const x=d.call(a,e);return a.set(e,s),g?af(s,x)&&ca(a,"set",e,s):ca(a,"add",e,s),this}function Q1(e){const s=Hn(this),{has:a,get:u}=cg(s);let d=a.call(s,e);d||(e=Hn(e),d=a.call(s,e)),u&&u.call(s,e);const g=s.delete(e);return d&&ca(s,"delete",e,void 0),g}function eb(){const e=Hn(this),s=e.size!==0,a=e.clear();return s&&ca(e,"clear",void 0,void 0),a}function Em(e,s){return function(u,d){const g=this,x=g.__v_raw,o=Hn(x),w=s?wy:e?Ey:lf;return!e&&co(o,"iterate",xc),x.forEach((E,k)=>u.call(d,w(E),w(k),g))}}function Cm(e,s,a){return function(...u){const d=this.__v_raw,g=Hn(d),x=Wd(g),o=e==="entries"||e===Symbol.iterator&&x,w=e==="keys"&&x,E=d[e](...u),k=a?wy:s?Ey:lf;return!s&&co(g,"iterate",w?T_:xc),{next(){const{value:z,done:L}=E.next();return L?{value:z,done:L}:{value:o?[k(z[0]),k(z[1])]:k(z),done:L}},[Symbol.iterator](){return this}}}}function Ja(e){return function(...s){return e==="delete"?!1:this}}function RA(){const e={get(g){return wm(this,g)},get size(){return Tm(this)},has:Sm,add:K1,set:J1,delete:Q1,clear:eb,forEach:Em(!1,!1)},s={get(g){return wm(this,g,!1,!0)},get size(){return Tm(this)},has:Sm,add:K1,set:J1,delete:Q1,clear:eb,forEach:Em(!1,!0)},a={get(g){return wm(this,g,!0)},get size(){return Tm(this,!0)},has(g){return Sm.call(this,g,!0)},add:Ja("add"),set:Ja("set"),delete:Ja("delete"),clear:Ja("clear"),forEach:Em(!0,!1)},u={get(g){return wm(this,g,!0,!0)},get size(){return Tm(this,!0)},has(g){return Sm.call(this,g,!0)},add:Ja("add"),set:Ja("set"),delete:Ja("delete"),clear:Ja("clear"),forEach:Em(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(g=>{e[g]=Cm(g,!1,!1),a[g]=Cm(g,!0,!1),s[g]=Cm(g,!1,!0),u[g]=Cm(g,!0,!0)}),[e,a,s,u]}const[BA,OA,FA,VA]=RA();function Sy(e,s){const a=s?e?VA:FA:e?OA:BA;return(u,d,g)=>d==="__v_isReactive"?!e:d==="__v_isReadonly"?e:d==="__v_raw"?u:Reflect.get(Wn(a,d)&&d in u?a:u,d,g)}const $A={get:Sy(!1,!1)},NA={get:Sy(!1,!0)},UA={get:Sy(!0,!1)},oS=new WeakMap,sS=new WeakMap,aS=new WeakMap,jA=new WeakMap;function GA(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function qA(e){return e.__v_skip||!Object.isExtensible(e)?0:GA(mA(e))}function Qi(e){return Qu(e)?e:Ty(e,!1,rS,$A,oS)}function lS(e){return Ty(e,!1,DA,NA,sS)}function If(e){return Ty(e,!0,LA,UA,aS)}function Ty(e,s,a,u,d){if(!Wi(e)||e.__v_raw&&!(s&&e.__v_isReactive))return e;const g=d.get(e);if(g)return g;const x=qA(e);if(x===0)return e;const o=new Proxy(e,x===2?u:a);return d.set(e,o),o}function Yu(e){return Qu(e)?Yu(e.__v_raw):!!(e&&e.__v_isReactive)}function Qu(e){return!!(e&&e.__v_isReadonly)}function $m(e){return!!(e&&e.__v_isShallow)}function cS(e){return Yu(e)||Qu(e)}function Hn(e){const s=e&&e.__v_raw;return s?Hn(s):e}function uS(e){return Fm(e,"__v_skip",!0),e}const lf=e=>Wi(e)?Qi(e):e,Ey=e=>Wi(e)?If(e):e;function hS(e){sl&&Xo&&(e=Hn(e),tS(e.dep||(e.dep=yy())))}function dS(e,s){e=Hn(e),e.dep&&E_(e.dep)}function ki(e){return!!(e&&e.__v_isRef===!0)}function Ke(e){return fS(e,!1)}function Si(e){return fS(e,!0)}function fS(e,s){return ki(e)?e:new ZA(e,s)}class ZA{constructor(s,a){this.__v_isShallow=a,this.dep=void 0,this.__v_isRef=!0,this._rawValue=a?s:Hn(s),this._value=a?s:lf(s)}get value(){return hS(this),this._value}set value(s){const a=this.__v_isShallow||$m(s)||Qu(s);s=a?s:Hn(s),af(s,this._rawValue)&&(this._rawValue=s,this._value=a?s:lf(s),dS(this))}}function Ai(e){return ki(e)?e.value:e}const WA={get:(e,s,a)=>Ai(Reflect.get(e,s,a)),set:(e,s,a,u)=>{const d=e[s];return ki(d)&&!ki(a)?(d.value=a,!0):Reflect.set(e,s,a,u)}};function pS(e){return Yu(e)?e:new Proxy(e,WA)}function Cy(e){const s=An(e)?new Array(e.length):{};for(const a in e)s[a]=St(e,a);return s}class HA{constructor(s,a,u){this._object=s,this._key=a,this._defaultValue=u,this.__v_isRef=!0}get value(){const s=this._object[this._key];return s===void 0?this._defaultValue:s}set value(s){this._object[this._key]=s}}function St(e,s,a){const u=e[s];return ki(u)?u:new HA(e,s,a)}var mS;class XA{constructor(s,a,u,d){this._setter=a,this.dep=void 0,this.__v_isRef=!0,this[mS]=!1,this._dirty=!0,this.effect=new xy(s,()=>{this._dirty||(this._dirty=!0,dS(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!d,this.__v_isReadonly=u}get value(){const s=Hn(this);return hS(s),(s._dirty||!s._cacheable)&&(s._dirty=!1,s._value=s.effect.run()),s._value}set value(s){this._setter(s)}}mS="__v_isReadonly";function YA(e,s,a=!1){let u,d;const g=Bn(e);return g?(u=e,d=Jo):(u=e.get,d=e.set),new XA(u,d,g||!d,a)}const Hd=[];function KA(e,...s){Cc();const a=Hd.length?Hd[Hd.length-1].component:null,u=a&&a.appContext.config.warnHandler,d=JA();if(u)la(u,a,11,[e+s.join(""),a&&a.proxy,d.map(({vnode:g})=>`at <${ZS(a,g.type)}>`).join(`
`),d]);else{const g=[`[Vue warn]: ${e}`,...s];d.length&&g.push(`
`,...QA(d)),console.warn(...g)}Ic()}function JA(){let e=Hd[Hd.length-1];if(!e)return[];const s=[];for(;e;){const a=s[0];a&&a.vnode===e?a.recurseCount++:s.push({vnode:e,recurseCount:0});const u=e.component&&e.component.parent;e=u&&u.vnode}return s}function QA(e){const s=[];return e.forEach((a,u)=>{s.push(...u===0?[]:[`
`],...ek(a))}),s}function ek({vnode:e,recurseCount:s}){const a=s>0?`... (${s} recursive calls)`:"",u=e.component?e.component.parent==null:!1,d=` at <${ZS(e.component,e.type,u)}`,g=">"+a;return e.props?[d,...tk(e.props),g]:[d+g]}function tk(e){const s=[],a=Object.keys(e);return a.slice(0,3).forEach(u=>{s.push(...gS(u,e[u]))}),a.length>3&&s.push(" ..."),s}function gS(e,s,a){return fr(s)?(s=JSON.stringify(s),a?s:[`${e}=${s}`]):typeof s=="number"||typeof s=="boolean"||s==null?a?s:[`${e}=${s}`]:ki(s)?(s=gS(e,Hn(s.value),!0),a?s:[`${e}=Ref<`,s,">"]):Bn(s)?[`${e}=fn${s.name?`<${s.name}>`:""}`]:(s=Hn(s),a?s:[`${e}=`,s])}function la(e,s,a,u){let d;try{d=u?e(...u):e()}catch(g){ug(g,s,a)}return d}function Co(e,s,a,u){if(Bn(e)){const g=la(e,s,a,u);return g&&Yw(g)&&g.catch(x=>{ug(x,s,a)}),g}const d=[];for(let g=0;g<e.length;g++)d.push(Co(e[g],s,a,u));return d}function ug(e,s,a,u=!0){const d=s?s.vnode:null;if(s){let g=s.parent;const x=s.proxy,o=a;for(;g;){const E=g.ec;if(E){for(let k=0;k<E.length;k++)if(E[k](e,x,o)===!1)return}g=g.parent}const w=s.appContext.config.errorHandler;if(w){la(w,null,10,[e,x,o]);return}}nk(e,a,d,u)}function nk(e,s,a,u=!0){console.error(e)}let cf=!1,C_=!1;const Vr=[];let ks=0;const Ku=[];let aa=null,dc=0;const vS=Promise.resolve();let Iy=null;function Ui(e){const s=Iy||vS;return e?s.then(this?e.bind(this):e):s}function ik(e){let s=ks+1,a=Vr.length;for(;s<a;){const u=s+a>>>1;uf(Vr[u])<e?s=u+1:a=u}return s}function Ay(e){(!Vr.length||!Vr.includes(e,cf&&e.allowRecurse?ks+1:ks))&&(e.id==null?Vr.push(e):Vr.splice(ik(e.id),0,e),_S())}function _S(){!cf&&!C_&&(C_=!0,Iy=vS.then(xS))}function rk(e){const s=Vr.indexOf(e);s>ks&&Vr.splice(s,1)}function ok(e){An(e)?Ku.push(...e):(!aa||!aa.includes(e,e.allowRecurse?dc+1:dc))&&Ku.push(e),_S()}function tb(e,s=cf?ks+1:0){for(;s<Vr.length;s++){const a=Vr[s];a&&a.pre&&(Vr.splice(s,1),s--,a())}}function yS(e){if(Ku.length){const s=[...new Set(Ku)];if(Ku.length=0,aa){aa.push(...s);return}for(aa=s,aa.sort((a,u)=>uf(a)-uf(u)),dc=0;dc<aa.length;dc++)aa[dc]();aa=null,dc=0}}const uf=e=>e.id==null?1/0:e.id,sk=(e,s)=>{const a=uf(e)-uf(s);if(a===0){if(e.pre&&!s.pre)return-1;if(s.pre&&!e.pre)return 1}return a};function xS(e){C_=!1,cf=!0,Vr.sort(sk);const s=Jo;try{for(ks=0;ks<Vr.length;ks++){const a=Vr[ks];a&&a.active!==!1&&la(a,null,14)}}finally{ks=0,Vr.length=0,yS(),cf=!1,Iy=null,(Vr.length||Ku.length)&&xS()}}function ak(e,s,...a){if(e.isUnmounted)return;const u=e.vnode.props||yi;let d=a;const g=s.startsWith("update:"),x=g&&s.slice(7);if(x&&x in u){const k=`${x==="modelValue"?"model":x}Modifiers`,{number:z,trim:L}=u[k]||yi;L&&(d=a.map(O=>O.trim())),z&&(d=a.map(Vm))}let o,w=u[o=Lm(s)]||u[o=Lm(ko(s))];!w&&g&&(w=u[o=Lm(rh(s))]),w&&Co(w,e,6,d);const E=u[o+"Once"];if(E){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,Co(E,e,6,d)}}function bS(e,s,a=!1){const u=s.emitsCache,d=u.get(e);if(d!==void 0)return d;const g=e.emits;let x={},o=!1;if(!Bn(e)){const w=E=>{const k=bS(E,s,!0);k&&(o=!0,Tr(x,k))};!a&&s.mixins.length&&s.mixins.forEach(w),e.extends&&w(e.extends),e.mixins&&e.mixins.forEach(w)}return!g&&!o?(Wi(e)&&u.set(e,null),null):(An(g)?g.forEach(w=>x[w]=null):Tr(x,g),Wi(e)&&u.set(e,x),x)}function hg(e,s){return!e||!sg(s)?!1:(s=s.slice(2).replace(/Once$/,""),Wn(e,s[0].toLowerCase()+s.slice(1))||Wn(e,rh(s))||Wn(e,s))}let $r=null,wS=null;function Nm(e){const s=$r;return $r=e,wS=e&&e.type.__scopeId||null,s}function xi(e,s=$r,a){if(!s||e._n)return e;const u=(...d)=>{u._d&&fb(-1);const g=Nm(s);let x;try{x=e(...d)}finally{Nm(g),u._d&&fb(1)}return x};return u._n=!0,u._c=!0,u._d=!0,u}function Qv(e){const{type:s,vnode:a,proxy:u,withProxy:d,props:g,propsOptions:[x],slots:o,attrs:w,emit:E,render:k,renderCache:z,data:L,setupState:O,ctx:G,inheritAttrs:H}=e;let pe,se;const he=Nm(e);try{if(a.shapeFlag&4){const Te=d||u;pe=As(k.call(Te,Te,z,g,O,L,G)),se=w}else{const Te=s;pe=As(Te.length>1?Te(g,{attrs:w,slots:o,emit:E}):Te(g,null)),se=s.props?w:lk(w)}}catch(Te){Kd.length=0,ug(Te,e,1),pe=F(Io)}let K=pe;if(se&&H!==!1){const Te=Object.keys(se),{shapeFlag:Y}=K;Te.length&&Y&7&&(x&&Te.some(my)&&(se=ck(se,x)),K=ha(K,se))}return a.dirs&&(K=ha(K),K.dirs=K.dirs?K.dirs.concat(a.dirs):a.dirs),a.transition&&(K.transition=a.transition),pe=K,Nm(he),pe}const lk=e=>{let s;for(const a in e)(a==="class"||a==="style"||sg(a))&&((s||(s={}))[a]=e[a]);return s},ck=(e,s)=>{const a={};for(const u in e)(!my(u)||!(u.slice(9)in s))&&(a[u]=e[u]);return a};function uk(e,s,a){const{props:u,children:d,component:g}=e,{props:x,children:o,patchFlag:w}=s,E=g.emitsOptions;if(s.dirs||s.transition)return!0;if(a&&w>=0){if(w&1024)return!0;if(w&16)return u?nb(u,x,E):!!x;if(w&8){const k=s.dynamicProps;for(let z=0;z<k.length;z++){const L=k[z];if(x[L]!==u[L]&&!hg(E,L))return!0}}}else return(d||o)&&(!o||!o.$stable)?!0:u===x?!1:u?x?nb(u,x,E):!0:!!x;return!1}function nb(e,s,a){const u=Object.keys(s);if(u.length!==Object.keys(e).length)return!0;for(let d=0;d<u.length;d++){const g=u[d];if(s[g]!==e[g]&&!hg(a,g))return!0}return!1}function hk({vnode:e,parent:s},a){for(;s&&s.subTree===e;)(e=s.vnode).el=a,s=s.parent}const dk=e=>e.__isSuspense;function fk(e,s){s&&s.pendingBranch?An(e)?s.effects.push(...e):s.effects.push(e):ok(e)}function Ni(e,s){if(Sr){let a=Sr.provides;const u=Sr.parent&&Sr.parent.provides;u===a&&(a=Sr.provides=Object.create(u)),a[e]=s}}function ln(e,s,a=!1){const u=Sr||$r;if(u){const d=u.parent==null?u.vnode.appContext&&u.vnode.appContext.provides:u.parent.provides;if(d&&e in d)return d[e];if(arguments.length>1)return a&&Bn(s)?s.call(u.proxy):s}}function Ls(e,s){return ky(e,null,s)}const ib={};function Ye(e,s,a){return ky(e,s,a)}function ky(e,s,{immediate:a,deep:u,flush:d,onTrack:g,onTrigger:x}=yi){const o=Sr;let w,E=!1,k=!1;if(ki(e)?(w=()=>e.value,E=$m(e)):Yu(e)?(w=()=>e,u=!0):An(e)?(k=!0,E=e.some(se=>Yu(se)||$m(se)),w=()=>e.map(se=>{if(ki(se))return se.value;if(Yu(se))return mc(se);if(Bn(se))return la(se,o,2)})):Bn(e)?s?w=()=>la(e,o,2):w=()=>{if(!(o&&o.isUnmounted))return z&&z(),Co(e,o,3,[L])}:w=Jo,s&&u){const se=w;w=()=>mc(se())}let z,L=se=>{z=pe.onStop=()=>{la(se,o,4)}};if(pf)return L=Jo,s?a&&Co(s,o,3,[w(),k?[]:void 0,L]):w(),Jo;let O=k?[]:ib;const G=()=>{if(!!pe.active)if(s){const se=pe.run();(u||E||(k?se.some((he,K)=>af(he,O[K])):af(se,O)))&&(z&&z(),Co(s,o,3,[se,O===ib?void 0:O,L]),O=se)}else pe.run()};G.allowRecurse=!!s;let H;d==="sync"?H=G:d==="post"?H=()=>to(G,o&&o.suspense):(G.pre=!0,o&&(G.id=o.uid),H=()=>Ay(G));const pe=new xy(w,H);return s?a?G():O=pe.run():d==="post"?to(pe.run.bind(pe),o&&o.suspense):pe.run(),()=>{pe.stop(),o&&o.scope&&gy(o.scope.effects,pe)}}function pk(e,s,a){const u=this.proxy,d=fr(e)?e.includes(".")?SS(u,e):()=>u[e]:e.bind(u,u);let g;Bn(s)?g=s:(g=s.handler,a=s);const x=Sr;eh(this);const o=ky(d,g.bind(u),a);return x?eh(x):bc(),o}function SS(e,s){const a=s.split(".");return()=>{let u=e;for(let d=0;d<a.length&&u;d++)u=u[a[d]];return u}}function mc(e,s){if(!Wi(e)||e.__v_skip||(s=s||new Set,s.has(e)))return e;if(s.add(e),ki(e))mc(e.value,s);else if(An(e))for(let a=0;a<e.length;a++)mc(e[a],s);else if(fA(e)||Wd(e))e.forEach(a=>{mc(a,s)});else if(gA(e))for(const a in e)mc(e[a],s);return e}function TS(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return kn(()=>{e.isMounted=!0}),Ti(()=>{e.isUnmounting=!0}),e}const So=[Function,Array],mk={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:So,onEnter:So,onAfterEnter:So,onEnterCancelled:So,onBeforeLeave:So,onLeave:So,onAfterLeave:So,onLeaveCancelled:So,onBeforeAppear:So,onAppear:So,onAfterAppear:So,onAppearCancelled:So},setup(e,{slots:s}){const a=gg(),u=TS();let d;return()=>{const g=s.default&&My(s.default(),!0);if(!g||!g.length)return;let x=g[0];if(g.length>1){for(const H of g)if(H.type!==Io){x=H;break}}const o=Hn(e),{mode:w}=o;if(u.isLeaving)return e_(x);const E=rb(x);if(!E)return e_(x);const k=hf(E,o,u,a);df(E,k);const z=a.subTree,L=z&&rb(z);let O=!1;const{getTransitionKey:G}=E.type;if(G){const H=G();d===void 0?d=H:H!==d&&(d=H,O=!0)}if(L&&L.type!==Io&&(!fc(E,L)||O)){const H=hf(L,o,u,a);if(df(L,H),w==="out-in")return u.isLeaving=!0,H.afterLeave=()=>{u.isLeaving=!1,a.update()},e_(x);w==="in-out"&&E.type!==Io&&(H.delayLeave=(pe,se,he)=>{const K=CS(u,L);K[String(L.key)]=L,pe._leaveCb=()=>{se(),pe._leaveCb=void 0,delete k.delayedLeave},k.delayedLeave=he})}return x}}},ES=mk;function CS(e,s){const{leavingVNodes:a}=e;let u=a.get(s.type);return u||(u=Object.create(null),a.set(s.type,u)),u}function hf(e,s,a,u){const{appear:d,mode:g,persisted:x=!1,onBeforeEnter:o,onEnter:w,onAfterEnter:E,onEnterCancelled:k,onBeforeLeave:z,onLeave:L,onAfterLeave:O,onLeaveCancelled:G,onBeforeAppear:H,onAppear:pe,onAfterAppear:se,onAppearCancelled:he}=s,K=String(e.key),Te=CS(a,e),Y=(ve,Se)=>{ve&&Co(ve,u,9,Se)},_e=(ve,Se)=>{const be=Se[1];Y(ve,Se),An(ve)?ve.every(De=>De.length<=1)&&be():ve.length<=1&&be()},de={mode:g,persisted:x,beforeEnter(ve){let Se=o;if(!a.isMounted)if(d)Se=H||o;else return;ve._leaveCb&&ve._leaveCb(!0);const be=Te[K];be&&fc(e,be)&&be.el._leaveCb&&be.el._leaveCb(),Y(Se,[ve])},enter(ve){let Se=w,be=E,De=k;if(!a.isMounted)if(d)Se=pe||w,be=se||E,De=he||k;else return;let ze=!1;const Je=ve._enterCb=ct=>{ze||(ze=!0,ct?Y(De,[ve]):Y(be,[ve]),de.delayedLeave&&de.delayedLeave(),ve._enterCb=void 0)};Se?_e(Se,[ve,Je]):Je()},leave(ve,Se){const be=String(e.key);if(ve._enterCb&&ve._enterCb(!0),a.isUnmounting)return Se();Y(z,[ve]);let De=!1;const ze=ve._leaveCb=Je=>{De||(De=!0,Se(),Je?Y(G,[ve]):Y(O,[ve]),ve._leaveCb=void 0,Te[be]===e&&delete Te[be])};Te[be]=e,L?_e(L,[ve,ze]):ze()},clone(ve){return hf(ve,s,a,u)}};return de}function e_(e){if(dg(e))return e=ha(e),e.children=null,e}function rb(e){return dg(e)?e.children?e.children[0]:void 0:e}function df(e,s){e.shapeFlag&6&&e.component?df(e.component.subTree,s):e.shapeFlag&128?(e.ssContent.transition=s.clone(e.ssContent),e.ssFallback.transition=s.clone(e.ssFallback)):e.transition=s}function My(e,s=!1,a){let u=[],d=0;for(let g=0;g<e.length;g++){let x=e[g];const o=a==null?x.key:String(a)+String(x.key!=null?x.key:g);x.type===On?(x.patchFlag&128&&d++,u=u.concat(My(x.children,s,o))):(s||x.type!==Io)&&u.push(o!=null?ha(x,{key:o}):x)}if(d>1)for(let g=0;g<u.length;g++)u[g].patchFlag=-2;return u}function Ln(e){return Bn(e)?{setup:e,name:e.name}:e}const Xd=e=>!!e.type.__asyncLoader,dg=e=>e.type.__isKeepAlive;function IS(e,s){kS(e,"a",s)}function AS(e,s){kS(e,"da",s)}function kS(e,s,a=Sr){const u=e.__wdc||(e.__wdc=()=>{let d=a;for(;d;){if(d.isDeactivated)return;d=d.parent}return e()});if(fg(s,u,a),a){let d=a.parent;for(;d&&d.parent;)dg(d.parent.vnode)&&gk(u,s,a,d),d=d.parent}}function gk(e,s,a,u){const d=fg(s,e,u,!0);pr(()=>{gy(u[s],d)},a)}function fg(e,s,a=Sr,u=!1){if(a){const d=a[e]||(a[e]=[]),g=s.__weh||(s.__weh=(...x)=>{if(a.isUnmounted)return;Cc(),eh(a);const o=Co(s,a,e,x);return bc(),Ic(),o});return u?d.unshift(g):d.push(g),g}}const fa=e=>(s,a=Sr)=>(!pf||e==="sp")&&fg(e,(...u)=>s(...u),a),pg=fa("bm"),kn=fa("m"),MS=fa("bu"),PS=fa("u"),Ti=fa("bum"),pr=fa("um"),vk=fa("sp"),_k=fa("rtg"),yk=fa("rtc");function xk(e,s=Sr){fg("ec",e,s)}function ji(e,s){const a=$r;if(a===null)return e;const u=vg(a)||a.proxy,d=e.dirs||(e.dirs=[]);for(let g=0;g<s.length;g++){let[x,o,w,E=yi]=s[g];Bn(x)&&(x={mounted:x,updated:x}),x.deep&&mc(o),d.push({dir:x,instance:u,value:o,oldValue:void 0,arg:w,modifiers:E})}return e}function sc(e,s,a,u){const d=e.dirs,g=s&&s.dirs;for(let x=0;x<d.length;x++){const o=d[x];g&&(o.oldValue=g[x].value);let w=o.dir[u];w&&(Cc(),Co(w,a,8,[e.el,o,e,s]),Ic())}}const Py="components",bk="directives";function ua(e,s){return zy(Py,e,!0,s)||e}const zS=Symbol();function wk(e){return fr(e)?zy(Py,e,!1)||e:e||zS}function uo(e){return zy(bk,e)}function zy(e,s,a=!0,u=!1){const d=$r||Sr;if(d){const g=d.type;if(e===Py){const o=qS(g,!1);if(o&&(o===s||o===ko(s)||o===dl(ko(s))))return g}const x=ob(d[e]||g[e],s)||ob(d.appContext[e],s);return!x&&u?g:x}}function ob(e,s){return e&&(e[s]||e[ko(s)]||e[dl(ko(s))])}function Af(e,s,a={},u,d){if($r.isCE||$r.parent&&Xd($r.parent)&&$r.parent.isCE)return F("slot",s==="default"?null:{name:s},u&&u());let g=e[s];g&&g._c&&(g._d=!1),Xi();const x=g&&LS(g(a)),o=ts(On,{key:a.key||x&&x.key||`_${s}`},x||(u?u():[]),x&&e._===1?64:-2);return!d&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),g&&g._c&&(g._d=!0),o}function LS(e){return e.some(s=>Gm(s)?!(s.type===Io||s.type===On&&!LS(s.children)):!0)?e:null}function t_(e,s){const a={};for(const u in e)a[s&&/[A-Z]/.test(u)?`on:${u}`:Lm(u)]=e[u];return a}const I_=e=>e?jS(e)?vg(e)||e.proxy:I_(e.parent):null,Um=Tr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>I_(e.parent),$root:e=>I_(e.root),$emit:e=>e.emit,$options:e=>Ly(e),$forceUpdate:e=>e.f||(e.f=()=>Ay(e.update)),$nextTick:e=>e.n||(e.n=Ui.bind(e.proxy)),$watch:e=>pk.bind(e)}),Sk={get({_:e},s){const{ctx:a,setupState:u,data:d,props:g,accessCache:x,type:o,appContext:w}=e;let E;if(s[0]!=="$"){const O=x[s];if(O!==void 0)switch(O){case 1:return u[s];case 2:return d[s];case 4:return a[s];case 3:return g[s]}else{if(u!==yi&&Wn(u,s))return x[s]=1,u[s];if(d!==yi&&Wn(d,s))return x[s]=2,d[s];if((E=e.propsOptions[0])&&Wn(E,s))return x[s]=3,g[s];if(a!==yi&&Wn(a,s))return x[s]=4,a[s];A_&&(x[s]=0)}}const k=Um[s];let z,L;if(k)return s==="$attrs"&&co(e,"get",s),k(e);if((z=o.__cssModules)&&(z=z[s]))return z;if(a!==yi&&Wn(a,s))return x[s]=4,a[s];if(L=w.config.globalProperties,Wn(L,s))return L[s]},set({_:e},s,a){const{data:u,setupState:d,ctx:g}=e;return d!==yi&&Wn(d,s)?(d[s]=a,!0):u!==yi&&Wn(u,s)?(u[s]=a,!0):Wn(e.props,s)||s[0]==="$"&&s.slice(1)in e?!1:(g[s]=a,!0)},has({_:{data:e,setupState:s,accessCache:a,ctx:u,appContext:d,propsOptions:g}},x){let o;return!!a[x]||e!==yi&&Wn(e,x)||s!==yi&&Wn(s,x)||(o=g[0])&&Wn(o,x)||Wn(u,x)||Wn(Um,x)||Wn(d.config.globalProperties,x)},defineProperty(e,s,a){return a.get!=null?e._.accessCache[s]=0:Wn(a,"value")&&this.set(e,s,a.value,null),Reflect.defineProperty(e,s,a)}};let A_=!0;function Tk(e){const s=Ly(e),a=e.proxy,u=e.ctx;A_=!1,s.beforeCreate&&sb(s.beforeCreate,e,"bc");const{data:d,computed:g,methods:x,watch:o,provide:w,inject:E,created:k,beforeMount:z,mounted:L,beforeUpdate:O,updated:G,activated:H,deactivated:pe,beforeDestroy:se,beforeUnmount:he,destroyed:K,unmounted:Te,render:Y,renderTracked:_e,renderTriggered:de,errorCaptured:ve,serverPrefetch:Se,expose:be,inheritAttrs:De,components:ze,directives:Je,filters:ct}=s;if(E&&Ek(E,u,null,e.appContext.config.unwrapInjectedRef),x)for(const Pe in x){const at=x[Pe];Bn(at)&&(u[Pe]=at.bind(a))}if(d){const Pe=d.call(a,a);Wi(Pe)&&(e.data=Qi(Pe))}if(A_=!0,g)for(const Pe in g){const at=g[Pe],jt=Bn(at)?at.bind(a,a):Bn(at.get)?at.get.bind(a,a):Jo,pt=!Bn(at)&&Bn(at.set)?at.set.bind(a):Jo,zt=ne({get:jt,set:pt});Object.defineProperty(u,Pe,{enumerable:!0,configurable:!0,get:()=>zt.value,set:Gt=>zt.value=Gt})}if(o)for(const Pe in o)DS(o[Pe],u,a,Pe);if(w){const Pe=Bn(w)?w.call(a):w;Reflect.ownKeys(Pe).forEach(at=>{Ni(at,Pe[at])})}k&&sb(k,e,"c");function ft(Pe,at){An(at)?at.forEach(jt=>Pe(jt.bind(a))):at&&Pe(at.bind(a))}if(ft(pg,z),ft(kn,L),ft(MS,O),ft(PS,G),ft(IS,H),ft(AS,pe),ft(xk,ve),ft(yk,_e),ft(_k,de),ft(Ti,he),ft(pr,Te),ft(vk,Se),An(be))if(be.length){const Pe=e.exposed||(e.exposed={});be.forEach(at=>{Object.defineProperty(Pe,at,{get:()=>a[at],set:jt=>a[at]=jt})})}else e.exposed||(e.exposed={});Y&&e.render===Jo&&(e.render=Y),De!=null&&(e.inheritAttrs=De),ze&&(e.components=ze),Je&&(e.directives=Je)}function Ek(e,s,a=Jo,u=!1){An(e)&&(e=k_(e));for(const d in e){const g=e[d];let x;Wi(g)?"default"in g?x=ln(g.from||d,g.default,!0):x=ln(g.from||d):x=ln(g),ki(x)&&u?Object.defineProperty(s,d,{enumerable:!0,configurable:!0,get:()=>x.value,set:o=>x.value=o}):s[d]=x}}function sb(e,s,a){Co(An(e)?e.map(u=>u.bind(s.proxy)):e.bind(s.proxy),s,a)}function DS(e,s,a,u){const d=u.includes(".")?SS(a,u):()=>a[u];if(fr(e)){const g=s[e];Bn(g)&&Ye(d,g)}else if(Bn(e))Ye(d,e.bind(a));else if(Wi(e))if(An(e))e.forEach(g=>DS(g,s,a,u));else{const g=Bn(e.handler)?e.handler.bind(a):s[e.handler];Bn(g)&&Ye(d,g,e)}}function Ly(e){const s=e.type,{mixins:a,extends:u}=s,{mixins:d,optionsCache:g,config:{optionMergeStrategies:x}}=e.appContext,o=g.get(s);let w;return o?w=o:!d.length&&!a&&!u?w=s:(w={},d.length&&d.forEach(E=>jm(w,E,x,!0)),jm(w,s,x)),Wi(s)&&g.set(s,w),w}function jm(e,s,a,u=!1){const{mixins:d,extends:g}=s;g&&jm(e,g,a,!0),d&&d.forEach(x=>jm(e,x,a,!0));for(const x in s)if(!(u&&x==="expose")){const o=Ck[x]||a&&a[x];e[x]=o?o(e[x],s[x]):s[x]}return e}const Ck={data:ab,props:hc,emits:hc,methods:hc,computed:hc,beforeCreate:qr,created:qr,beforeMount:qr,mounted:qr,beforeUpdate:qr,updated:qr,beforeDestroy:qr,beforeUnmount:qr,destroyed:qr,unmounted:qr,activated:qr,deactivated:qr,errorCaptured:qr,serverPrefetch:qr,components:hc,directives:hc,watch:Ak,provide:ab,inject:Ik};function ab(e,s){return s?e?function(){return Tr(Bn(e)?e.call(this,this):e,Bn(s)?s.call(this,this):s)}:s:e}function Ik(e,s){return hc(k_(e),k_(s))}function k_(e){if(An(e)){const s={};for(let a=0;a<e.length;a++)s[e[a]]=e[a];return s}return e}function qr(e,s){return e?[...new Set([].concat(e,s))]:s}function hc(e,s){return e?Tr(Tr(Object.create(null),e),s):s}function Ak(e,s){if(!e)return s;if(!s)return e;const a=Tr(Object.create(null),e);for(const u in s)a[u]=qr(e[u],s[u]);return a}function kk(e,s,a,u=!1){const d={},g={};Fm(g,mg,1),e.propsDefaults=Object.create(null),RS(e,s,d,g);for(const x in e.propsOptions[0])x in d||(d[x]=void 0);a?e.props=u?d:lS(d):e.type.props?e.props=d:e.props=g,e.attrs=g}function Mk(e,s,a,u){const{props:d,attrs:g,vnode:{patchFlag:x}}=e,o=Hn(d),[w]=e.propsOptions;let E=!1;if((u||x>0)&&!(x&16)){if(x&8){const k=e.vnode.dynamicProps;for(let z=0;z<k.length;z++){let L=k[z];if(hg(e.emitsOptions,L))continue;const O=s[L];if(w)if(Wn(g,L))O!==g[L]&&(g[L]=O,E=!0);else{const G=ko(L);d[G]=M_(w,o,G,O,e,!1)}else O!==g[L]&&(g[L]=O,E=!0)}}}else{RS(e,s,d,g)&&(E=!0);let k;for(const z in o)(!s||!Wn(s,z)&&((k=rh(z))===z||!Wn(s,k)))&&(w?a&&(a[z]!==void 0||a[k]!==void 0)&&(d[z]=M_(w,o,z,void 0,e,!0)):delete d[z]);if(g!==o)for(const z in g)(!s||!Wn(s,z)&&!0)&&(delete g[z],E=!0)}E&&ca(e,"set","$attrs")}function RS(e,s,a,u){const[d,g]=e.propsOptions;let x=!1,o;if(s)for(let w in s){if(zm(w))continue;const E=s[w];let k;d&&Wn(d,k=ko(w))?!g||!g.includes(k)?a[k]=E:(o||(o={}))[k]=E:hg(e.emitsOptions,w)||(!(w in u)||E!==u[w])&&(u[w]=E,x=!0)}if(g){const w=Hn(a),E=o||yi;for(let k=0;k<g.length;k++){const z=g[k];a[z]=M_(d,w,z,E[z],e,!Wn(E,z))}}return x}function M_(e,s,a,u,d,g){const x=e[a];if(x!=null){const o=Wn(x,"default");if(o&&u===void 0){const w=x.default;if(x.type!==Function&&Bn(w)){const{propsDefaults:E}=d;a in E?u=E[a]:(eh(d),u=E[a]=w.call(null,s),bc())}else u=w}x[0]&&(g&&!o?u=!1:x[1]&&(u===""||u===rh(a))&&(u=!0))}return u}function BS(e,s,a=!1){const u=s.propsCache,d=u.get(e);if(d)return d;const g=e.props,x={},o=[];let w=!1;if(!Bn(e)){const k=z=>{w=!0;const[L,O]=BS(z,s,!0);Tr(x,L),O&&o.push(...O)};!a&&s.mixins.length&&s.mixins.forEach(k),e.extends&&k(e.extends),e.mixins&&e.mixins.forEach(k)}if(!g&&!w)return Wi(e)&&u.set(e,Xu),Xu;if(An(g))for(let k=0;k<g.length;k++){const z=ko(g[k]);lb(z)&&(x[z]=yi)}else if(g)for(const k in g){const z=ko(k);if(lb(z)){const L=g[k],O=x[z]=An(L)||Bn(L)?{type:L}:L;if(O){const G=hb(Boolean,O.type),H=hb(String,O.type);O[0]=G>-1,O[1]=H<0||G<H,(G>-1||Wn(O,"default"))&&o.push(z)}}}const E=[x,o];return Wi(e)&&u.set(e,E),E}function lb(e){return e[0]!=="$"}function cb(e){const s=e&&e.toString().match(/^\s*function (\w+)/);return s?s[1]:e===null?"null":""}function ub(e,s){return cb(e)===cb(s)}function hb(e,s){return An(s)?s.findIndex(a=>ub(a,e)):Bn(s)&&ub(s,e)?0:-1}const OS=e=>e[0]==="_"||e==="$stable",Dy=e=>An(e)?e.map(As):[As(e)],Pk=(e,s,a)=>{if(s._n)return s;const u=xi((...d)=>Dy(s(...d)),a);return u._c=!1,u},FS=(e,s,a)=>{const u=e._ctx;for(const d in e){if(OS(d))continue;const g=e[d];if(Bn(g))s[d]=Pk(d,g,u);else if(g!=null){const x=Dy(g);s[d]=()=>x}}},VS=(e,s)=>{const a=Dy(s);e.slots.default=()=>a},zk=(e,s)=>{if(e.vnode.shapeFlag&32){const a=s._;a?(e.slots=Hn(s),Fm(s,"_",a)):FS(s,e.slots={})}else e.slots={},s&&VS(e,s);Fm(e.slots,mg,1)},Lk=(e,s,a)=>{const{vnode:u,slots:d}=e;let g=!0,x=yi;if(u.shapeFlag&32){const o=s._;o?a&&o===1?g=!1:(Tr(d,s),!a&&o===1&&delete d._):(g=!s.$stable,FS(s,d)),x=s}else s&&(VS(e,s),x={default:1});if(g)for(const o in d)!OS(o)&&!(o in x)&&delete d[o]};function $S(){return{app:null,config:{isNativeTag:uA,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Dk=0;function Rk(e,s){return function(u,d=null){Bn(u)||(u=Object.assign({},u)),d!=null&&!Wi(d)&&(d=null);const g=$S(),x=new Set;let o=!1;const w=g.app={_uid:Dk++,_component:u,_props:d,_container:null,_context:g,_instance:null,version:iM,get config(){return g.config},set config(E){},use(E,...k){return x.has(E)||(E&&Bn(E.install)?(x.add(E),E.install(w,...k)):Bn(E)&&(x.add(E),E(w,...k))),w},mixin(E){return g.mixins.includes(E)||g.mixins.push(E),w},component(E,k){return k?(g.components[E]=k,w):g.components[E]},directive(E,k){return k?(g.directives[E]=k,w):g.directives[E]},mount(E,k,z){if(!o){const L=F(u,d);return L.appContext=g,k&&s?s(L,E):e(L,E,z),o=!0,w._container=E,E.__vue_app__=w,vg(L.component)||L.component.proxy}},unmount(){o&&(e(null,w._container),delete w._container.__vue_app__)},provide(E,k){return g.provides[E]=k,w}};return w}}function P_(e,s,a,u,d=!1){if(An(e)){e.forEach((L,O)=>P_(L,s&&(An(s)?s[O]:s),a,u,d));return}if(Xd(u)&&!d)return;const g=u.shapeFlag&4?vg(u.component)||u.component.proxy:u.el,x=d?null:g,{i:o,r:w}=e,E=s&&s.r,k=o.refs===yi?o.refs={}:o.refs,z=o.setupState;if(E!=null&&E!==w&&(fr(E)?(k[E]=null,Wn(z,E)&&(z[E]=null)):ki(E)&&(E.value=null)),Bn(w))la(w,o,12,[x,k]);else{const L=fr(w),O=ki(w);if(L||O){const G=()=>{if(e.f){const H=L?Wn(z,w)?z[w]:k[w]:w.value;d?An(H)&&gy(H,g):An(H)?H.includes(g)||H.push(g):L?(k[w]=[g],Wn(z,w)&&(z[w]=k[w])):(w.value=[g],e.k&&(k[e.k]=w.value))}else L?(k[w]=x,Wn(z,w)&&(z[w]=x)):O&&(w.value=x,e.k&&(k[e.k]=x))};x?(G.id=-1,to(G,a)):G()}}}const to=fk;function Bk(e){return Ok(e)}function Ok(e,s){const a=yA();a.__VUE__=!0;const{insert:u,remove:d,patchProp:g,createElement:x,createText:o,createComment:w,setText:E,setElementText:k,parentNode:z,nextSibling:L,setScopeId:O=Jo,insertStaticContent:G}=e,H=(ue,Me,qe,st=null,yt=null,Lt=null,Vt=!1,Mt=null,Ot=!!Me.dynamicChildren)=>{if(ue===Me)return;ue&&!fc(ue,Me)&&(st=Tt(ue),Gt(ue,yt,Lt,!0),ue=null),Me.patchFlag===-2&&(Ot=!1,Me.dynamicChildren=null);const{type:wt,ref:Kt,shapeFlag:Zt}=Me;switch(wt){case By:pe(ue,Me,qe,st);break;case Io:se(ue,Me,qe,st);break;case n_:ue==null&&he(Me,qe,st,Vt);break;case On:ze(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot);break;default:Zt&1?Y(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot):Zt&6?Je(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot):(Zt&64||Zt&128)&&wt.process(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot,fn)}Kt!=null&&yt&&P_(Kt,ue&&ue.ref,Lt,Me||ue,!Me)},pe=(ue,Me,qe,st)=>{if(ue==null)u(Me.el=o(Me.children),qe,st);else{const yt=Me.el=ue.el;Me.children!==ue.children&&E(yt,Me.children)}},se=(ue,Me,qe,st)=>{ue==null?u(Me.el=w(Me.children||""),qe,st):Me.el=ue.el},he=(ue,Me,qe,st)=>{[ue.el,ue.anchor]=G(ue.children,Me,qe,st,ue.el,ue.anchor)},K=({el:ue,anchor:Me},qe,st)=>{let yt;for(;ue&&ue!==Me;)yt=L(ue),u(ue,qe,st),ue=yt;u(Me,qe,st)},Te=({el:ue,anchor:Me})=>{let qe;for(;ue&&ue!==Me;)qe=L(ue),d(ue),ue=qe;d(Me)},Y=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot)=>{Vt=Vt||Me.type==="svg",ue==null?_e(Me,qe,st,yt,Lt,Vt,Mt,Ot):Se(ue,Me,yt,Lt,Vt,Mt,Ot)},_e=(ue,Me,qe,st,yt,Lt,Vt,Mt)=>{let Ot,wt;const{type:Kt,props:Zt,shapeFlag:rn,transition:dn,dirs:Sn}=ue;if(Ot=ue.el=x(ue.type,Lt,Zt&&Zt.is,Zt),rn&8?k(Ot,ue.children):rn&16&&ve(ue.children,Ot,null,st,yt,Lt&&Kt!=="foreignObject",Vt,Mt),Sn&&sc(ue,null,st,"created"),Zt){for(const jn in Zt)jn!=="value"&&!zm(jn)&&g(Ot,jn,null,Zt[jn],Lt,ue.children,st,yt,xt);"value"in Zt&&g(Ot,"value",null,Zt.value),(wt=Zt.onVnodeBeforeMount)&&Cs(wt,st,ue)}de(Ot,ue,ue.scopeId,Vt,st),Sn&&sc(ue,null,st,"beforeMount");const Un=(!yt||yt&&!yt.pendingBranch)&&dn&&!dn.persisted;Un&&dn.beforeEnter(Ot),u(Ot,Me,qe),((wt=Zt&&Zt.onVnodeMounted)||Un||Sn)&&to(()=>{wt&&Cs(wt,st,ue),Un&&dn.enter(Ot),Sn&&sc(ue,null,st,"mounted")},yt)},de=(ue,Me,qe,st,yt)=>{if(qe&&O(ue,qe),st)for(let Lt=0;Lt<st.length;Lt++)O(ue,st[Lt]);if(yt){let Lt=yt.subTree;if(Me===Lt){const Vt=yt.vnode;de(ue,Vt,Vt.scopeId,Vt.slotScopeIds,yt.parent)}}},ve=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot=0)=>{for(let wt=Ot;wt<ue.length;wt++){const Kt=ue[wt]=Mt?nl(ue[wt]):As(ue[wt]);H(null,Kt,Me,qe,st,yt,Lt,Vt,Mt)}},Se=(ue,Me,qe,st,yt,Lt,Vt)=>{const Mt=Me.el=ue.el;let{patchFlag:Ot,dynamicChildren:wt,dirs:Kt}=Me;Ot|=ue.patchFlag&16;const Zt=ue.props||yi,rn=Me.props||yi;let dn;qe&&ac(qe,!1),(dn=rn.onVnodeBeforeUpdate)&&Cs(dn,qe,Me,ue),Kt&&sc(Me,ue,qe,"beforeUpdate"),qe&&ac(qe,!0);const Sn=yt&&Me.type!=="foreignObject";if(wt?be(ue.dynamicChildren,wt,Mt,qe,st,Sn,Lt):Vt||at(ue,Me,Mt,null,qe,st,Sn,Lt,!1),Ot>0){if(Ot&16)De(Mt,Me,Zt,rn,qe,st,yt);else if(Ot&2&&Zt.class!==rn.class&&g(Mt,"class",null,rn.class,yt),Ot&4&&g(Mt,"style",Zt.style,rn.style,yt),Ot&8){const Un=Me.dynamicProps;for(let jn=0;jn<Un.length;jn++){const fi=Un[jn],tr=Zt[fi],Gi=rn[fi];(Gi!==tr||fi==="value")&&g(Mt,fi,tr,Gi,yt,ue.children,qe,st,xt)}}Ot&1&&ue.children!==Me.children&&k(Mt,Me.children)}else!Vt&&wt==null&&De(Mt,Me,Zt,rn,qe,st,yt);((dn=rn.onVnodeUpdated)||Kt)&&to(()=>{dn&&Cs(dn,qe,Me,ue),Kt&&sc(Me,ue,qe,"updated")},st)},be=(ue,Me,qe,st,yt,Lt,Vt)=>{for(let Mt=0;Mt<Me.length;Mt++){const Ot=ue[Mt],wt=Me[Mt],Kt=Ot.el&&(Ot.type===On||!fc(Ot,wt)||Ot.shapeFlag&70)?z(Ot.el):qe;H(Ot,wt,Kt,null,st,yt,Lt,Vt,!0)}},De=(ue,Me,qe,st,yt,Lt,Vt)=>{if(qe!==st){if(qe!==yi)for(const Mt in qe)!zm(Mt)&&!(Mt in st)&&g(ue,Mt,qe[Mt],null,Vt,Me.children,yt,Lt,xt);for(const Mt in st){if(zm(Mt))continue;const Ot=st[Mt],wt=qe[Mt];Ot!==wt&&Mt!=="value"&&g(ue,Mt,wt,Ot,Vt,Me.children,yt,Lt,xt)}"value"in st&&g(ue,"value",qe.value,st.value)}},ze=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot)=>{const wt=Me.el=ue?ue.el:o(""),Kt=Me.anchor=ue?ue.anchor:o("");let{patchFlag:Zt,dynamicChildren:rn,slotScopeIds:dn}=Me;dn&&(Mt=Mt?Mt.concat(dn):dn),ue==null?(u(wt,qe,st),u(Kt,qe,st),ve(Me.children,qe,Kt,yt,Lt,Vt,Mt,Ot)):Zt>0&&Zt&64&&rn&&ue.dynamicChildren?(be(ue.dynamicChildren,rn,qe,yt,Lt,Vt,Mt),(Me.key!=null||yt&&Me===yt.subTree)&&Ry(ue,Me,!0)):at(ue,Me,qe,Kt,yt,Lt,Vt,Mt,Ot)},Je=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot)=>{Me.slotScopeIds=Mt,ue==null?Me.shapeFlag&512?yt.ctx.activate(Me,qe,st,Vt,Ot):ct(Me,qe,st,yt,Lt,Vt,Ot):nt(ue,Me,Ot)},ct=(ue,Me,qe,st,yt,Lt,Vt)=>{const Mt=ue.component=Xk(ue,st,yt);if(dg(ue)&&(Mt.ctx.renderer=fn),Yk(Mt),Mt.asyncDep){if(yt&&yt.registerDep(Mt,ft),!ue.el){const Ot=Mt.subTree=F(Io);se(null,Ot,Me,qe)}return}ft(Mt,ue,Me,qe,yt,Lt,Vt)},nt=(ue,Me,qe)=>{const st=Me.component=ue.component;if(uk(ue,Me,qe))if(st.asyncDep&&!st.asyncResolved){Pe(st,Me,qe);return}else st.next=Me,rk(st.update),st.update();else Me.el=ue.el,st.vnode=Me},ft=(ue,Me,qe,st,yt,Lt,Vt)=>{const Mt=()=>{if(ue.isMounted){let{next:Kt,bu:Zt,u:rn,parent:dn,vnode:Sn}=ue,Un=Kt,jn;ac(ue,!1),Kt?(Kt.el=Sn.el,Pe(ue,Kt,Vt)):Kt=Sn,Zt&&Dm(Zt),(jn=Kt.props&&Kt.props.onVnodeBeforeUpdate)&&Cs(jn,dn,Kt,Sn),ac(ue,!0);const fi=Qv(ue),tr=ue.subTree;ue.subTree=fi,H(tr,fi,z(tr.el),Tt(tr),ue,yt,Lt),Kt.el=fi.el,Un===null&&hk(ue,fi.el),rn&&to(rn,yt),(jn=Kt.props&&Kt.props.onVnodeUpdated)&&to(()=>Cs(jn,dn,Kt,Sn),yt)}else{let Kt;const{el:Zt,props:rn}=Me,{bm:dn,m:Sn,parent:Un}=ue,jn=Xd(Me);if(ac(ue,!1),dn&&Dm(dn),!jn&&(Kt=rn&&rn.onVnodeBeforeMount)&&Cs(Kt,Un,Me),ac(ue,!0),Zt&&gn){const fi=()=>{ue.subTree=Qv(ue),gn(Zt,ue.subTree,ue,yt,null)};jn?Me.type.__asyncLoader().then(()=>!ue.isUnmounted&&fi()):fi()}else{const fi=ue.subTree=Qv(ue);H(null,fi,qe,st,ue,yt,Lt),Me.el=fi.el}if(Sn&&to(Sn,yt),!jn&&(Kt=rn&&rn.onVnodeMounted)){const fi=Me;to(()=>Cs(Kt,Un,fi),yt)}(Me.shapeFlag&256||Un&&Xd(Un.vnode)&&Un.vnode.shapeFlag&256)&&ue.a&&to(ue.a,yt),ue.isMounted=!0,Me=qe=st=null}},Ot=ue.effect=new xy(Mt,()=>Ay(wt),ue.scope),wt=ue.update=()=>Ot.run();wt.id=ue.uid,ac(ue,!0),wt()},Pe=(ue,Me,qe)=>{Me.component=ue;const st=ue.vnode.props;ue.vnode=Me,ue.next=null,Mk(ue,Me.props,st,qe),Lk(ue,Me.children,qe),Cc(),tb(),Ic()},at=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot=!1)=>{const wt=ue&&ue.children,Kt=ue?ue.shapeFlag:0,Zt=Me.children,{patchFlag:rn,shapeFlag:dn}=Me;if(rn>0){if(rn&128){pt(wt,Zt,qe,st,yt,Lt,Vt,Mt,Ot);return}else if(rn&256){jt(wt,Zt,qe,st,yt,Lt,Vt,Mt,Ot);return}}dn&8?(Kt&16&&xt(wt,yt,Lt),Zt!==wt&&k(qe,Zt)):Kt&16?dn&16?pt(wt,Zt,qe,st,yt,Lt,Vt,Mt,Ot):xt(wt,yt,Lt,!0):(Kt&8&&k(qe,""),dn&16&&ve(Zt,qe,st,yt,Lt,Vt,Mt,Ot))},jt=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot)=>{ue=ue||Xu,Me=Me||Xu;const wt=ue.length,Kt=Me.length,Zt=Math.min(wt,Kt);let rn;for(rn=0;rn<Zt;rn++){const dn=Me[rn]=Ot?nl(Me[rn]):As(Me[rn]);H(ue[rn],dn,qe,null,yt,Lt,Vt,Mt,Ot)}wt>Kt?xt(ue,yt,Lt,!0,!1,Zt):ve(Me,qe,st,yt,Lt,Vt,Mt,Ot,Zt)},pt=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot)=>{let wt=0;const Kt=Me.length;let Zt=ue.length-1,rn=Kt-1;for(;wt<=Zt&&wt<=rn;){const dn=ue[wt],Sn=Me[wt]=Ot?nl(Me[wt]):As(Me[wt]);if(fc(dn,Sn))H(dn,Sn,qe,null,yt,Lt,Vt,Mt,Ot);else break;wt++}for(;wt<=Zt&&wt<=rn;){const dn=ue[Zt],Sn=Me[rn]=Ot?nl(Me[rn]):As(Me[rn]);if(fc(dn,Sn))H(dn,Sn,qe,null,yt,Lt,Vt,Mt,Ot);else break;Zt--,rn--}if(wt>Zt){if(wt<=rn){const dn=rn+1,Sn=dn<Kt?Me[dn].el:st;for(;wt<=rn;)H(null,Me[wt]=Ot?nl(Me[wt]):As(Me[wt]),qe,Sn,yt,Lt,Vt,Mt,Ot),wt++}}else if(wt>rn)for(;wt<=Zt;)Gt(ue[wt],yt,Lt,!0),wt++;else{const dn=wt,Sn=wt,Un=new Map;for(wt=Sn;wt<=rn;wt++){const Ki=Me[wt]=Ot?nl(Me[wt]):As(Me[wt]);Ki.key!=null&&Un.set(Ki.key,wt)}let jn,fi=0;const tr=rn-Sn+1;let Gi=!1,ss=0;const Mr=new Array(tr);for(wt=0;wt<tr;wt++)Mr[wt]=0;for(wt=dn;wt<=Zt;wt++){const Ki=ue[wt];if(fi>=tr){Gt(Ki,yt,Lt,!0);continue}let sr;if(Ki.key!=null)sr=Un.get(Ki.key);else for(jn=Sn;jn<=rn;jn++)if(Mr[jn-Sn]===0&&fc(Ki,Me[jn])){sr=jn;break}sr===void 0?Gt(Ki,yt,Lt,!0):(Mr[sr-Sn]=wt+1,sr>=ss?ss=sr:Gi=!0,H(Ki,Me[sr],qe,null,yt,Lt,Vt,Mt,Ot),fi++)}const po=Gi?Fk(Mr):Xu;for(jn=po.length-1,wt=tr-1;wt>=0;wt--){const Ki=Sn+wt,sr=Me[Ki],Ro=Ki+1<Kt?Me[Ki+1].el:st;Mr[wt]===0?H(null,sr,qe,Ro,yt,Lt,Vt,Mt,Ot):Gi&&(jn<0||wt!==po[jn]?zt(sr,qe,Ro,2):jn--)}}},zt=(ue,Me,qe,st,yt=null)=>{const{el:Lt,type:Vt,transition:Mt,children:Ot,shapeFlag:wt}=ue;if(wt&6){zt(ue.component.subTree,Me,qe,st);return}if(wt&128){ue.suspense.move(Me,qe,st);return}if(wt&64){Vt.move(ue,Me,qe,fn);return}if(Vt===On){u(Lt,Me,qe);for(let Zt=0;Zt<Ot.length;Zt++)zt(Ot[Zt],Me,qe,st);u(ue.anchor,Me,qe);return}if(Vt===n_){K(ue,Me,qe);return}if(st!==2&&wt&1&&Mt)if(st===0)Mt.beforeEnter(Lt),u(Lt,Me,qe),to(()=>Mt.enter(Lt),yt);else{const{leave:Zt,delayLeave:rn,afterLeave:dn}=Mt,Sn=()=>u(Lt,Me,qe),Un=()=>{Zt(Lt,()=>{Sn(),dn&&dn()})};rn?rn(Lt,Sn,Un):Un()}else u(Lt,Me,qe)},Gt=(ue,Me,qe,st=!1,yt=!1)=>{const{type:Lt,props:Vt,ref:Mt,children:Ot,dynamicChildren:wt,shapeFlag:Kt,patchFlag:Zt,dirs:rn}=ue;if(Mt!=null&&P_(Mt,null,qe,ue,!0),Kt&256){Me.ctx.deactivate(ue);return}const dn=Kt&1&&rn,Sn=!Xd(ue);let Un;if(Sn&&(Un=Vt&&Vt.onVnodeBeforeUnmount)&&Cs(Un,Me,ue),Kt&6)Qe(ue.component,qe,st);else{if(Kt&128){ue.suspense.unmount(qe,st);return}dn&&sc(ue,null,Me,"beforeUnmount"),Kt&64?ue.type.remove(ue,Me,qe,yt,fn,st):wt&&(Lt!==On||Zt>0&&Zt&64)?xt(wt,Me,qe,!1,!0):(Lt===On&&Zt&384||!yt&&Kt&16)&&xt(Ot,Me,qe),st&&zn(ue)}(Sn&&(Un=Vt&&Vt.onVnodeUnmounted)||dn)&&to(()=>{Un&&Cs(Un,Me,ue),dn&&sc(ue,null,Me,"unmounted")},qe)},zn=ue=>{const{type:Me,el:qe,anchor:st,transition:yt}=ue;if(Me===On){At(qe,st);return}if(Me===n_){Te(ue);return}const Lt=()=>{d(qe),yt&&!yt.persisted&&yt.afterLeave&&yt.afterLeave()};if(ue.shapeFlag&1&&yt&&!yt.persisted){const{leave:Vt,delayLeave:Mt}=yt,Ot=()=>Vt(qe,Lt);Mt?Mt(ue.el,Lt,Ot):Ot()}else Lt()},At=(ue,Me)=>{let qe;for(;ue!==Me;)qe=L(ue),d(ue),ue=qe;d(Me)},Qe=(ue,Me,qe)=>{const{bum:st,scope:yt,update:Lt,subTree:Vt,um:Mt}=ue;st&&Dm(st),yt.stop(),Lt&&(Lt.active=!1,Gt(Vt,ue,Me,qe)),Mt&&to(Mt,Me),to(()=>{ue.isUnmounted=!0},Me),Me&&Me.pendingBranch&&!Me.isUnmounted&&ue.asyncDep&&!ue.asyncResolved&&ue.suspenseId===Me.pendingId&&(Me.deps--,Me.deps===0&&Me.resolve())},xt=(ue,Me,qe,st=!1,yt=!1,Lt=0)=>{for(let Vt=Lt;Vt<ue.length;Vt++)Gt(ue[Vt],Me,qe,st,yt)},Tt=ue=>ue.shapeFlag&6?Tt(ue.component.subTree):ue.shapeFlag&128?ue.suspense.next():L(ue.anchor||ue.el),Nt=(ue,Me,qe)=>{ue==null?Me._vnode&&Gt(Me._vnode,null,null,!0):H(Me._vnode||null,ue,Me,null,null,null,qe),tb(),yS(),Me._vnode=ue},fn={p:H,um:Gt,m:zt,r:zn,mt:ct,mc:ve,pc:at,pbc:be,n:Tt,o:e};let Dn,gn;return s&&([Dn,gn]=s(fn)),{render:Nt,hydrate:Dn,createApp:Rk(Nt,Dn)}}function ac({effect:e,update:s},a){e.allowRecurse=s.allowRecurse=a}function Ry(e,s,a=!1){const u=e.children,d=s.children;if(An(u)&&An(d))for(let g=0;g<u.length;g++){const x=u[g];let o=d[g];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=d[g]=nl(d[g]),o.el=x.el),a||Ry(x,o))}}function Fk(e){const s=e.slice(),a=[0];let u,d,g,x,o;const w=e.length;for(u=0;u<w;u++){const E=e[u];if(E!==0){if(d=a[a.length-1],e[d]<E){s[u]=d,a.push(u);continue}for(g=0,x=a.length-1;g<x;)o=g+x>>1,e[a[o]]<E?g=o+1:x=o;E<e[a[g]]&&(g>0&&(s[u]=a[g-1]),a[g]=u)}}for(g=a.length,x=a[g-1];g-- >0;)a[g]=x,x=s[x];return a}const Vk=e=>e.__isTeleport,Yd=e=>e&&(e.disabled||e.disabled===""),db=e=>typeof SVGElement<"u"&&e instanceof SVGElement,z_=(e,s)=>{const a=e&&e.to;return fr(a)?s?s(a):null:a},$k={__isTeleport:!0,process(e,s,a,u,d,g,x,o,w,E){const{mc:k,pc:z,pbc:L,o:{insert:O,querySelector:G,createText:H,createComment:pe}}=E,se=Yd(s.props);let{shapeFlag:he,children:K,dynamicChildren:Te}=s;if(e==null){const Y=s.el=H(""),_e=s.anchor=H("");O(Y,a,u),O(_e,a,u);const de=s.target=z_(s.props,G),ve=s.targetAnchor=H("");de&&(O(ve,de),x=x||db(de));const Se=(be,De)=>{he&16&&k(K,be,De,d,g,x,o,w)};se?Se(a,_e):de&&Se(de,ve)}else{s.el=e.el;const Y=s.anchor=e.anchor,_e=s.target=e.target,de=s.targetAnchor=e.targetAnchor,ve=Yd(e.props),Se=ve?a:_e,be=ve?Y:de;if(x=x||db(_e),Te?(L(e.dynamicChildren,Te,Se,d,g,x,o),Ry(e,s,!0)):w||z(e,s,Se,be,d,g,x,o,!1),se)ve||Im(s,a,Y,E,1);else if((s.props&&s.props.to)!==(e.props&&e.props.to)){const De=s.target=z_(s.props,G);De&&Im(s,De,null,E,0)}else ve&&Im(s,_e,de,E,1)}},remove(e,s,a,u,{um:d,o:{remove:g}},x){const{shapeFlag:o,children:w,anchor:E,targetAnchor:k,target:z,props:L}=e;if(z&&g(k),(x||!Yd(L))&&(g(E),o&16))for(let O=0;O<w.length;O++){const G=w[O];d(G,s,a,!0,!!G.dynamicChildren)}},move:Im,hydrate:Nk};function Im(e,s,a,{o:{insert:u},m:d},g=2){g===0&&u(e.targetAnchor,s,a);const{el:x,anchor:o,shapeFlag:w,children:E,props:k}=e,z=g===2;if(z&&u(x,s,a),(!z||Yd(k))&&w&16)for(let L=0;L<E.length;L++)d(E[L],s,a,2);z&&u(o,s,a)}function Nk(e,s,a,u,d,g,{o:{nextSibling:x,parentNode:o,querySelector:w}},E){const k=s.target=z_(s.props,w);if(k){const z=k._lpa||k.firstChild;if(s.shapeFlag&16)if(Yd(s.props))s.anchor=E(x(e),s,o(e),a,u,d,g),s.targetAnchor=z;else{s.anchor=x(e);let L=z;for(;L;)if(L=x(L),L&&L.nodeType===8&&L.data==="teleport anchor"){s.targetAnchor=L,k._lpa=s.targetAnchor&&x(s.targetAnchor);break}E(z,s,k,a,u,d,g)}}return s.anchor&&x(s.anchor)}const Uk=$k,On=Symbol(void 0),By=Symbol(void 0),Io=Symbol(void 0),n_=Symbol(void 0),Kd=[];let Yo=null;function Xi(e=!1){Kd.push(Yo=e?null:[])}function jk(){Kd.pop(),Yo=Kd[Kd.length-1]||null}let ff=1;function fb(e){ff+=e}function NS(e){return e.dynamicChildren=ff>0?Yo||Xu:null,jk(),ff>0&&Yo&&Yo.push(e),e}function es(e,s,a,u,d,g){return NS(Sc(e,s,a,u,d,g,!0))}function ts(e,s,a,u,d){return NS(F(e,s,a,u,d,!0))}function Gm(e){return e?e.__v_isVNode===!0:!1}function fc(e,s){return e.type===s.type&&e.key===s.key}const mg="__vInternal",US=({key:e})=>e!=null?e:null,Rm=({ref:e,ref_key:s,ref_for:a})=>e!=null?fr(e)||ki(e)||Bn(e)?{i:$r,r:e,k:s,f:!!a}:e:null;function Sc(e,s=null,a=null,u=0,d=null,g=e===On?0:1,x=!1,o=!1){const w={__v_isVNode:!0,__v_skip:!0,type:e,props:s,key:s&&US(s),ref:s&&Rm(s),scopeId:wS,slotScopeIds:null,children:a,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:g,patchFlag:u,dynamicProps:d,dynamicChildren:null,appContext:null};return o?(Oy(w,a),g&128&&e.normalize(w)):a&&(w.shapeFlag|=fr(a)?8:16),ff>0&&!x&&Yo&&(w.patchFlag>0||g&6)&&w.patchFlag!==32&&Yo.push(w),w}const F=Gk;function Gk(e,s=null,a=null,u=0,d=null,g=!1){if((!e||e===zS)&&(e=Io),Gm(e)){const o=ha(e,s,!0);return a&&Oy(o,a),ff>0&&!g&&Yo&&(o.shapeFlag&6?Yo[Yo.indexOf(e)]=o:Yo.push(o)),o.patchFlag|=-2,o}if(nM(e)&&(e=e.__vccOpts),s){s=qk(s);let{class:o,style:w}=s;o&&!fr(o)&&(s.class=py(o)),Wi(w)&&(cS(w)&&!An(w)&&(w=Tr({},w)),s.style=fy(w))}const x=fr(e)?1:dk(e)?128:Vk(e)?64:Wi(e)?4:Bn(e)?2:0;return Sc(e,s,a,u,d,x,g,!0)}function qk(e){return e?cS(e)||mg in e?Tr({},e):e:null}function ha(e,s,a=!1){const{props:u,ref:d,patchFlag:g,children:x}=e,o=s?tn(u||{},s):u;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:o,key:o&&US(o),ref:s&&s.ref?a&&d?An(d)?d.concat(Rm(s)):[d,Rm(s)]:Rm(s):d,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:x,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:s&&e.type!==On?g===-1?16:g|16:g,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ha(e.ssContent),ssFallback:e.ssFallback&&ha(e.ssFallback),el:e.el,anchor:e.anchor}}function al(e=" ",s=0){return F(By,null,e,s)}function Zk(e="",s=!1){return s?(Xi(),ts(Io,null,e)):F(Io,null,e)}function As(e){return e==null||typeof e=="boolean"?F(Io):An(e)?F(On,null,e.slice()):typeof e=="object"?nl(e):F(By,null,String(e))}function nl(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:ha(e)}function Oy(e,s){let a=0;const{shapeFlag:u}=e;if(s==null)s=null;else if(An(s))a=16;else if(typeof s=="object")if(u&65){const d=s.default;d&&(d._c&&(d._d=!1),Oy(e,d()),d._c&&(d._d=!0));return}else{a=32;const d=s._;!d&&!(mg in s)?s._ctx=$r:d===3&&$r&&($r.slots._===1?s._=1:(s._=2,e.patchFlag|=1024))}else Bn(s)?(s={default:s,_ctx:$r},a=32):(s=String(s),u&64?(a=16,s=[al(s)]):a=8);e.children=s,e.shapeFlag|=a}function tn(...e){const s={};for(let a=0;a<e.length;a++){const u=e[a];for(const d in u)if(d==="class")s.class!==u.class&&(s.class=py([s.class,u.class]));else if(d==="style")s.style=fy([s.style,u.style]);else if(sg(d)){const g=s[d],x=u[d];x&&g!==x&&!(An(g)&&g.includes(x))&&(s[d]=g?[].concat(g,x):x)}else d!==""&&(s[d]=u[d])}return s}function Cs(e,s,a,u=null){Co(e,s,7,[a,u])}const Wk=$S();let Hk=0;function Xk(e,s,a){const u=e.type,d=(s?s.appContext:e.appContext)||Wk,g={uid:Hk++,vnode:e,type:u,parent:s,appContext:d,root:null,next:null,subTree:null,effect:null,update:null,scope:new Kw(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:s?s.provides:Object.create(d.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:BS(u,d),emitsOptions:bS(u,d),emit:null,emitted:null,propsDefaults:yi,inheritAttrs:u.inheritAttrs,ctx:yi,data:yi,props:yi,attrs:yi,slots:yi,refs:yi,setupState:yi,setupContext:null,suspense:a,suspenseId:a?a.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return g.ctx={_:g},g.root=s?s.root:g,g.emit=ak.bind(null,g),e.ce&&e.ce(g),g}let Sr=null;const gg=()=>Sr||$r,eh=e=>{Sr=e,e.scope.on()},bc=()=>{Sr&&Sr.scope.off(),Sr=null};function jS(e){return e.vnode.shapeFlag&4}let pf=!1;function Yk(e,s=!1){pf=s;const{props:a,children:u}=e.vnode,d=jS(e);kk(e,a,d,s),zk(e,u);const g=d?Kk(e,s):void 0;return pf=!1,g}function Kk(e,s){const a=e.type;e.accessCache=Object.create(null),e.proxy=uS(new Proxy(e.ctx,Sk));const{setup:u}=a;if(u){const d=e.setupContext=u.length>1?Qk(e):null;eh(e),Cc();const g=la(u,e,0,[e.props,d]);if(Ic(),bc(),Yw(g)){if(g.then(bc,bc),s)return g.then(x=>{pb(e,x,s)}).catch(x=>{ug(x,e,0)});e.asyncDep=g}else pb(e,g,s)}else GS(e,s)}function pb(e,s,a){Bn(s)?e.type.__ssrInlineRender?e.ssrRender=s:e.render=s:Wi(s)&&(e.setupState=pS(s)),GS(e,a)}let mb;function GS(e,s,a){const u=e.type;if(!e.render){if(!s&&mb&&!u.render){const d=u.template||Ly(e).template;if(d){const{isCustomElement:g,compilerOptions:x}=e.appContext.config,{delimiters:o,compilerOptions:w}=u,E=Tr(Tr({isCustomElement:g,delimiters:o},x),w);u.render=mb(d,E)}}e.render=u.render||Jo}eh(e),Cc(),Tk(e),Ic(),bc()}function Jk(e){return new Proxy(e.attrs,{get(s,a){return co(e,"get","$attrs"),s[a]}})}function Qk(e){const s=u=>{e.exposed=u||{}};let a;return{get attrs(){return a||(a=Jk(e))},slots:e.slots,emit:e.emit,expose:s}}function vg(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(pS(uS(e.exposed)),{get(s,a){if(a in s)return s[a];if(a in Um)return Um[a](e)}}))}const eM=/(?:^|[-_])(\w)/g,tM=e=>e.replace(eM,s=>s.toUpperCase()).replace(/[-_]/g,"");function qS(e,s=!0){return Bn(e)?e.displayName||e.name:e.name||s&&e.__name}function ZS(e,s,a=!1){let u=qS(s);if(!u&&s.__file){const d=s.__file.match(/([^/\\]+)\.\w+$/);d&&(u=d[1])}if(!u&&e&&e.parent){const d=g=>{for(const x in g)if(g[x]===s)return x};u=d(e.components||e.parent.type.components)||d(e.appContext.components)}return u?tM(u):a?"App":"Anonymous"}function nM(e){return Bn(e)&&"__vccOpts"in e}const ne=(e,s)=>YA(e,s,pf);function Ds(e,s,a){const u=arguments.length;return u===2?Wi(s)&&!An(s)?Gm(s)?F(e,null,[s]):F(e,s):F(e,null,s):(u>3?a=Array.prototype.slice.call(arguments,2):u===3&&Gm(a)&&(a=[a]),F(e,s,a))}const iM="3.2.41",rM="http://www.w3.org/2000/svg",pc=typeof document<"u"?document:null,gb=pc&&pc.createElement("template"),oM={insert:(e,s,a)=>{s.insertBefore(e,a||null)},remove:e=>{const s=e.parentNode;s&&s.removeChild(e)},createElement:(e,s,a,u)=>{const d=s?pc.createElementNS(rM,e):pc.createElement(e,a?{is:a}:void 0);return e==="select"&&u&&u.multiple!=null&&d.setAttribute("multiple",u.multiple),d},createText:e=>pc.createTextNode(e),createComment:e=>pc.createComment(e),setText:(e,s)=>{e.nodeValue=s},setElementText:(e,s)=>{e.textContent=s},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>pc.querySelector(e),setScopeId(e,s){e.setAttribute(s,"")},insertStaticContent(e,s,a,u,d,g){const x=a?a.previousSibling:s.lastChild;if(d&&(d===g||d.nextSibling))for(;s.insertBefore(d.cloneNode(!0),a),!(d===g||!(d=d.nextSibling)););else{gb.innerHTML=u?`<svg>${e}</svg>`:e;const o=gb.content;if(u){const w=o.firstChild;for(;w.firstChild;)o.appendChild(w.firstChild);o.removeChild(w)}s.insertBefore(o,a)}return[x?x.nextSibling:s.firstChild,a?a.previousSibling:s.lastChild]}};function sM(e,s,a){const u=e._vtc;u&&(s=(s?[s,...u]:[...u]).join(" ")),s==null?e.removeAttribute("class"):a?e.setAttribute("class",s):e.className=s}function aM(e,s,a){const u=e.style,d=fr(a);if(a&&!d){for(const g in a)L_(u,g,a[g]);if(s&&!fr(s))for(const g in s)a[g]==null&&L_(u,g,"")}else{const g=u.display;d?s!==a&&(u.cssText=a):s&&e.removeAttribute("style"),"_vod"in e&&(u.display=g)}}const vb=/\s*!important$/;function L_(e,s,a){if(An(a))a.forEach(u=>L_(e,s,u));else if(a==null&&(a=""),s.startsWith("--"))e.setProperty(s,a);else{const u=lM(e,s);vb.test(a)?e.setProperty(rh(u),a.replace(vb,""),"important"):e[u]=a}}const _b=["Webkit","Moz","ms"],i_={};function lM(e,s){const a=i_[s];if(a)return a;let u=ko(s);if(u!=="filter"&&u in e)return i_[s]=u;u=dl(u);for(let d=0;d<_b.length;d++){const g=_b[d]+u;if(g in e)return i_[s]=g}return s}const yb="http://www.w3.org/1999/xlink";function cM(e,s,a,u,d){if(u&&s.startsWith("xlink:"))a==null?e.removeAttributeNS(yb,s.slice(6,s.length)):e.setAttributeNS(yb,s,a);else{const g=sA(s);a==null||g&&!Xw(a)?e.removeAttribute(s):e.setAttribute(s,g?"":a)}}function uM(e,s,a,u,d,g,x){if(s==="innerHTML"||s==="textContent"){u&&x(u,d,g),e[s]=a==null?"":a;return}if(s==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=a;const w=a==null?"":a;(e.value!==w||e.tagName==="OPTION")&&(e.value=w),a==null&&e.removeAttribute(s);return}let o=!1;if(a===""||a==null){const w=typeof e[s];w==="boolean"?a=Xw(a):a==null&&w==="string"?(a="",o=!0):w==="number"&&(a=0,o=!0)}try{e[s]=a}catch{}o&&e.removeAttribute(s)}function qu(e,s,a,u){e.addEventListener(s,a,u)}function hM(e,s,a,u){e.removeEventListener(s,a,u)}function dM(e,s,a,u,d=null){const g=e._vei||(e._vei={}),x=g[s];if(u&&x)x.value=u;else{const[o,w]=fM(s);if(u){const E=g[s]=gM(u,d);qu(e,o,E,w)}else x&&(hM(e,o,x,w),g[s]=void 0)}}const xb=/(?:Once|Passive|Capture)$/;function fM(e){let s;if(xb.test(e)){s={};let u;for(;u=e.match(xb);)e=e.slice(0,e.length-u[0].length),s[u[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):rh(e.slice(2)),s]}let r_=0;const pM=Promise.resolve(),mM=()=>r_||(pM.then(()=>r_=0),r_=Date.now());function gM(e,s){const a=u=>{if(!u._vts)u._vts=Date.now();else if(u._vts<=a.attached)return;Co(vM(u,a.value),s,5,[u])};return a.value=e,a.attached=mM(),a}function vM(e,s){if(An(s)){const a=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{a.call(e),e._stopped=!0},s.map(u=>d=>!d._stopped&&u&&u(d))}else return s}const bb=/^on[a-z]/,_M=(e,s,a,u,d=!1,g,x,o,w)=>{s==="class"?sM(e,u,d):s==="style"?aM(e,a,u):sg(s)?my(s)||dM(e,s,a,u,x):(s[0]==="."?(s=s.slice(1),!0):s[0]==="^"?(s=s.slice(1),!1):yM(e,s,u,d))?uM(e,s,u,g,x,o,w):(s==="true-value"?e._trueValue=u:s==="false-value"&&(e._falseValue=u),cM(e,s,u,d))};function yM(e,s,a,u){return u?!!(s==="innerHTML"||s==="textContent"||s in e&&bb.test(s)&&Bn(a)):s==="spellcheck"||s==="draggable"||s==="translate"||s==="form"||s==="list"&&e.tagName==="INPUT"||s==="type"&&e.tagName==="TEXTAREA"||bb.test(s)&&fr(a)?!1:s in e}const Qa="transition",Fd="animation",zs=(e,{slots:s})=>Ds(ES,HS(e),s);zs.displayName="Transition";const WS={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},xM=zs.props=Tr({},ES.props,WS),lc=(e,s=[])=>{An(e)?e.forEach(a=>a(...s)):e&&e(...s)},wb=e=>e?An(e)?e.some(s=>s.length>1):e.length>1:!1;function HS(e){const s={};for(const ze in e)ze in WS||(s[ze]=e[ze]);if(e.css===!1)return s;const{name:a="v",type:u,duration:d,enterFromClass:g=`${a}-enter-from`,enterActiveClass:x=`${a}-enter-active`,enterToClass:o=`${a}-enter-to`,appearFromClass:w=g,appearActiveClass:E=x,appearToClass:k=o,leaveFromClass:z=`${a}-leave-from`,leaveActiveClass:L=`${a}-leave-active`,leaveToClass:O=`${a}-leave-to`}=e,G=bM(d),H=G&&G[0],pe=G&&G[1],{onBeforeEnter:se,onEnter:he,onEnterCancelled:K,onLeave:Te,onLeaveCancelled:Y,onBeforeAppear:_e=se,onAppear:de=he,onAppearCancelled:ve=K}=s,Se=(ze,Je,ct)=>{tl(ze,Je?k:o),tl(ze,Je?E:x),ct&&ct()},be=(ze,Je)=>{ze._isLeaving=!1,tl(ze,z),tl(ze,O),tl(ze,L),Je&&Je()},De=ze=>(Je,ct)=>{const nt=ze?de:he,ft=()=>Se(Je,ze,ct);lc(nt,[Je,ft]),Sb(()=>{tl(Je,ze?w:g),sa(Je,ze?k:o),wb(nt)||Tb(Je,u,H,ft)})};return Tr(s,{onBeforeEnter(ze){lc(se,[ze]),sa(ze,g),sa(ze,x)},onBeforeAppear(ze){lc(_e,[ze]),sa(ze,w),sa(ze,E)},onEnter:De(!1),onAppear:De(!0),onLeave(ze,Je){ze._isLeaving=!0;const ct=()=>be(ze,Je);sa(ze,z),YS(),sa(ze,L),Sb(()=>{!ze._isLeaving||(tl(ze,z),sa(ze,O),wb(Te)||Tb(ze,u,pe,ct))}),lc(Te,[ze,ct])},onEnterCancelled(ze){Se(ze,!1),lc(K,[ze])},onAppearCancelled(ze){Se(ze,!0),lc(ve,[ze])},onLeaveCancelled(ze){be(ze),lc(Y,[ze])}})}function bM(e){if(e==null)return null;if(Wi(e))return[o_(e.enter),o_(e.leave)];{const s=o_(e);return[s,s]}}function o_(e){return Vm(e)}function sa(e,s){s.split(/\s+/).forEach(a=>a&&e.classList.add(a)),(e._vtc||(e._vtc=new Set)).add(s)}function tl(e,s){s.split(/\s+/).forEach(u=>u&&e.classList.remove(u));const{_vtc:a}=e;a&&(a.delete(s),a.size||(e._vtc=void 0))}function Sb(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let wM=0;function Tb(e,s,a,u){const d=e._endId=++wM,g=()=>{d===e._endId&&u()};if(a)return setTimeout(g,a);const{type:x,timeout:o,propCount:w}=XS(e,s);if(!x)return u();const E=x+"end";let k=0;const z=()=>{e.removeEventListener(E,L),g()},L=O=>{O.target===e&&++k>=w&&z()};setTimeout(()=>{k<w&&z()},o+1),e.addEventListener(E,L)}function XS(e,s){const a=window.getComputedStyle(e),u=G=>(a[G]||"").split(", "),d=u(Qa+"Delay"),g=u(Qa+"Duration"),x=Eb(d,g),o=u(Fd+"Delay"),w=u(Fd+"Duration"),E=Eb(o,w);let k=null,z=0,L=0;s===Qa?x>0&&(k=Qa,z=x,L=g.length):s===Fd?E>0&&(k=Fd,z=E,L=w.length):(z=Math.max(x,E),k=z>0?x>E?Qa:Fd:null,L=k?k===Qa?g.length:w.length:0);const O=k===Qa&&/\b(transform|all)(,|$)/.test(a[Qa+"Property"]);return{type:k,timeout:z,propCount:L,hasTransform:O}}function Eb(e,s){for(;e.length<s.length;)e=e.concat(e);return Math.max(...s.map((a,u)=>Cb(a)+Cb(e[u])))}function Cb(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function YS(){return document.body.offsetHeight}const KS=new WeakMap,JS=new WeakMap,SM={name:"TransitionGroup",props:Tr({},xM,{tag:String,moveClass:String}),setup(e,{slots:s}){const a=gg(),u=TS();let d,g;return PS(()=>{if(!d.length)return;const x=e.moveClass||`${e.name||"v"}-move`;if(!AM(d[0].el,a.vnode.el,x))return;d.forEach(EM),d.forEach(CM);const o=d.filter(IM);YS(),o.forEach(w=>{const E=w.el,k=E.style;sa(E,x),k.transform=k.webkitTransform=k.transitionDuration="";const z=E._moveCb=L=>{L&&L.target!==E||(!L||/transform$/.test(L.propertyName))&&(E.removeEventListener("transitionend",z),E._moveCb=null,tl(E,x))};E.addEventListener("transitionend",z)})}),()=>{const x=Hn(e),o=HS(x);let w=x.tag||On;d=g,g=s.default?My(s.default()):[];for(let E=0;E<g.length;E++){const k=g[E];k.key!=null&&df(k,hf(k,o,u,a))}if(d)for(let E=0;E<d.length;E++){const k=d[E];df(k,hf(k,o,u,a)),KS.set(k,k.el.getBoundingClientRect())}return F(w,null,g)}}},TM=SM;function EM(e){const s=e.el;s._moveCb&&s._moveCb(),s._enterCb&&s._enterCb()}function CM(e){JS.set(e,e.el.getBoundingClientRect())}function IM(e){const s=KS.get(e),a=JS.get(e),u=s.left-a.left,d=s.top-a.top;if(u||d){const g=e.el.style;return g.transform=g.webkitTransform=`translate(${u}px,${d}px)`,g.transitionDuration="0s",e}}function AM(e,s,a){const u=e.cloneNode();e._vtc&&e._vtc.forEach(x=>{x.split(/\s+/).forEach(o=>o&&u.classList.remove(o))}),a.split(/\s+/).forEach(x=>x&&u.classList.add(x)),u.style.display="none";const d=s.nodeType===1?s:s.parentNode;d.appendChild(u);const{hasTransform:g}=XS(u);return d.removeChild(u),g}const Ib=e=>{const s=e.props["onUpdate:modelValue"]||!1;return An(s)?a=>Dm(s,a):s};function kM(e){e.target.composing=!0}function Ab(e){const s=e.target;s.composing&&(s.composing=!1,s.dispatchEvent(new Event("input")))}const MM={created(e,{modifiers:{lazy:s,trim:a,number:u}},d){e._assign=Ib(d);const g=u||d.props&&d.props.type==="number";qu(e,s?"change":"input",x=>{if(x.target.composing)return;let o=e.value;a&&(o=o.trim()),g&&(o=Vm(o)),e._assign(o)}),a&&qu(e,"change",()=>{e.value=e.value.trim()}),s||(qu(e,"compositionstart",kM),qu(e,"compositionend",Ab),qu(e,"change",Ab))},mounted(e,{value:s}){e.value=s==null?"":s},beforeUpdate(e,{value:s,modifiers:{lazy:a,trim:u,number:d}},g){if(e._assign=Ib(g),e.composing||document.activeElement===e&&e.type!=="range"&&(a||u&&e.value.trim()===s||(d||e.type==="number")&&Vm(e.value)===s))return;const x=s==null?"":s;e.value!==x&&(e.value=x)}},Rs={beforeMount(e,{value:s},{transition:a}){e._vod=e.style.display==="none"?"":e.style.display,a&&s?a.beforeEnter(e):Vd(e,s)},mounted(e,{value:s},{transition:a}){a&&s&&a.enter(e)},updated(e,{value:s,oldValue:a},{transition:u}){!s!=!a&&(u?s?(u.beforeEnter(e),Vd(e,!0),u.enter(e)):u.leave(e,()=>{Vd(e,!1)}):Vd(e,s))},beforeUnmount(e,{value:s}){Vd(e,s)}};function Vd(e,s){e.style.display=s?e._vod:"none"}const PM=Tr({patchProp:_M},oM);let kb;function zM(){return kb||(kb=Bk(PM))}const LM=(...e)=>{const s=zM().createApp(...e),{mount:a}=s;return s.mount=u=>{const d=DM(u);if(!d)return;const g=s._component;!Bn(g)&&!g.render&&!g.template&&(g.template=d.innerHTML),d.innerHTML="";const x=a(d,!1,d instanceof SVGElement);return d instanceof Element&&(d.removeAttribute("v-cloak"),d.setAttribute("data-v-app","")),x},s};function DM(e){return fr(e)?document.querySelector(e):e}const Bs=(e,s)=>{const a=e.__vccOpts||e;for(const[u,d]of s)a[u]=d;return a};function Mb(e,s,a){RM(e,s),s.set(e,a)}function RM(e,s){if(s.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BM(e,s,a){var u=QS(e,s,"set");return OM(e,u,a),a}function OM(e,s,a){if(s.set)s.set.call(e,a);else{if(!s.writable)throw new TypeError("attempted to set read only private field");s.value=a}}function cc(e,s){var a=QS(e,s,"get");return FM(e,a)}function QS(e,s,a){if(!s.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return s.get(e)}function FM(e,s){return s.get?s.get.call(e):s.value}function eT(e,s,a){const u=s.length-1;if(u<0)return e===void 0?a:e;for(let d=0;d<u;d++){if(e==null)return a;e=e[s[d]]}return e==null||e[s[u]]===void 0?a:e[s[u]]}function kf(e,s){if(e===s)return!0;if(e instanceof Date&&s instanceof Date&&e.getTime()!==s.getTime()||e!==Object(e)||s!==Object(s))return!1;const a=Object.keys(e);return a.length!==Object.keys(s).length?!1:a.every(u=>kf(e[u],s[u]))}function D_(e,s,a){return e==null||!s||typeof s!="string"?a:e[s]!==void 0?e[s]:(s=s.replace(/\[(\w+)\]/g,".$1"),s=s.replace(/^\./,""),eT(e,s.split("."),a))}function Ms(e,s,a){if(s==null)return e===void 0?a:e;if(e!==Object(e))return a;if(typeof s=="string")return D_(e,s,a);if(Array.isArray(s))return eT(e,s,a);if(typeof s!="function")return a;const u=s(e,a);return typeof u>"u"?a:u}function gc(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:e},(a,u)=>s+u)}function Xt(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(!(e==null||e===""))return isNaN(+e)?String(e):isFinite(+e)?`${Number(e)}${s}`:void 0}function R_(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function VM(e){return e==null?void 0:e.$el}const Pb=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16}),B_=Object.freeze({enter:"Enter",tab:"Tab",delete:"Delete",esc:"Escape",space:"Space",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",end:"End",home:"Home",del:"Delete",backspace:"Backspace",insert:"Insert",pageup:"PageUp",pagedown:"PageDown",shift:"Shift"});function tT(e){return Object.keys(e)}function Mo(e,s){const a=Object.create(null),u=Object.create(null);for(const d in e)s.some(g=>g instanceof RegExp?g.test(d):g===d)?a[d]=e[d]:u[d]=e[d];return[a,u]}function _g(e,s){const a={...e};return s.forEach(u=>delete a[u]),a}function Ac(e){return Mo(e,["class","style","id",/^data-/])}function Ao(e){return e==null?[]:Array.isArray(e)?e:[e]}function Eo(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(s,Math.min(a,e))}function s_(e,s){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return e+a.repeat(Math.max(0,s-e.length))}function $M(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const a=[];let u=0;for(;u<e.length;)a.push(e.substr(u,s)),u+=s;return a}function zb(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;if(e<s)return`${e} B`;const a=s===1024?["Ki","Mi","Gi"]:["k","M","G"];let u=-1;for(;Math.abs(e)>=s&&u<a.length-1;)e/=s,++u;return`${e.toFixed(1)} ${a[u]}B`}function da(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;const u={};for(const d in e)u[d]=e[d];for(const d in s){const g=e[d],x=s[d];if(R_(g)&&R_(x)){u[d]=da(g,x,a);continue}if(Array.isArray(g)&&Array.isArray(x)&&a){u[d]=a(g,x);continue}u[d]=x}return u}function nT(e){return e.map(s=>s.type===On?nT(s.children):s).flat()}function Fy(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"").replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase()}function Jd(e,s){if(!s||typeof s!="object")return[];if(Array.isArray(s))return s.map(a=>Jd(e,a)).flat(1);if(Array.isArray(s.children))return s.children.map(a=>Jd(e,a)).flat(1);if(s.component){if(Object.getOwnPropertySymbols(s.component.provides).includes(e))return[s.component];if(s.component.subTree)return Jd(e,s.component.subTree).flat(1)}return[]}var Am=new WeakMap,$u=new WeakMap;class NM{constructor(s){Mb(this,Am,{writable:!0,value:[]}),Mb(this,$u,{writable:!0,value:0}),this.size=s}push(s){cc(this,Am)[cc(this,$u)]=s,BM(this,$u,(cc(this,$u)+1)%this.size)}values(){return cc(this,Am).slice(cc(this,$u)).concat(cc(this,Am).slice(0,cc(this,$u)))}}function UM(e){return"touches"in e?{clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}:{clientX:e.clientX,clientY:e.clientY}}function Vy(e){const s=Qi({}),a=ne(e);return Ls(()=>{for(const u in a.value)s[u]=a.value[u]},{flush:"sync"}),Cy(s)}function qm(e,s){return e.includes(s)}const jM=/^on[^a-z]/,iT=e=>jM.test(e),Qd=[Function,Array];function Zm(e){for(var s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];if(Array.isArray(e))for(const d of e)d(...a);else typeof e=="function"&&e(...a)}const rT=["top","bottom"],GM=["start","end","left","right"];function O_(e,s){let[a,u]=e.split(" ");return u||(u=qm(rT,a)?"start":qm(GM,a)?"top":"center"),{side:F_(a,s),align:F_(u,s)}}function F_(e,s){return e==="start"?s?"right":"left":e==="end"?s?"left":"right":e}function a_(e){return{side:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.side],align:e.align}}function l_(e){return{side:e.side,align:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.align]}}function Lb(e){return{side:e.align,align:e.side}}function Db(e){return qm(rT,e.side)?"y":"x"}class Ju{constructor(s){let{x:a,y:u,width:d,height:g}=s;this.x=a,this.y=u,this.width=d,this.height=g}get top(){return this.y}get bottom(){return this.y+this.height}get left(){return this.x}get right(){return this.x+this.width}}function Rb(e,s){return{x:{before:Math.max(0,s.left-e.left),after:Math.max(0,e.right-s.right)},y:{before:Math.max(0,s.top-e.top),after:Math.max(0,e.bottom-s.bottom)}}}function $y(e){const s=e.getBoundingClientRect(),a=getComputedStyle(e),u=a.transform;if(u){let d,g,x,o,w;if(u.startsWith("matrix3d("))d=u.slice(9,-1).split(/, /),g=+d[0],x=+d[5],o=+d[12],w=+d[13];else if(u.startsWith("matrix("))d=u.slice(7,-1).split(/, /),g=+d[0],x=+d[3],o=+d[4],w=+d[5];else return new Ju(s);const E=a.transformOrigin,k=s.x-o-(1-g)*parseFloat(E),z=s.y-w-(1-x)*parseFloat(E.slice(E.indexOf(" ")+1)),L=g?s.width/g:e.offsetWidth+1,O=x?s.height/x:e.offsetHeight+1;return new Ju({x:k,y:z,width:L,height:O})}else return new Ju(s)}function vc(e,s,a){if(typeof e.animate>"u")return{finished:Promise.resolve()};const u=e.animate(s,a);return typeof u.finished>"u"&&(u.finished=new Promise(d=>{u.onfinish=()=>{d(u)}})),u}function oT(e,s,a){if(a&&(s={_isVue:!0,$parent:a,$options:s}),s){if(s.$_alreadyWarned=s.$_alreadyWarned||[],s.$_alreadyWarned.includes(e))return;s.$_alreadyWarned.push(e)}return`[Vuetify] ${e}`+(s?WM(s):"")}function wc(e,s,a){const u=oT(e,s,a);u!=null&&console.warn(u)}function V_(e,s,a){const u=oT(e,s,a);u!=null&&console.error(u)}const qM=/(?:^|[-_])(\w)/g,ZM=e=>e.replace(qM,s=>s.toUpperCase()).replace(/[-_]/g,"");function c_(e,s){if(e.$root===e)return"<Root>";const a=typeof e=="function"&&e.cid!=null?e.options:e._isVue?e.$options||e.constructor.options:e||{};let u=a.name||a._componentTag;const d=a.__file;if(!u&&d){const g=d.match(/([^/\\]+)\.vue$/);u=g==null?void 0:g[1]}return(u?`<${ZM(u)}>`:"<Anonymous>")+(d&&s!==!1?` at ${d}`:"")}function WM(e){if(e._isVue&&e.$parent){const s=[];let a=0;for(;e;){if(s.length>0){const u=s[s.length-1];if(u.constructor===e.constructor){a++,e=e.$parent;continue}else a>0&&(s[s.length-1]=[u,a],a=0)}s.push(e),e=e.$parent}return`

found in

`+s.map((u,d)=>`${d===0?"---> ":" ".repeat(5+d*2)}${Array.isArray(u)?`${c_(u[0])}... (${u[1]} recursive calls)`:c_(u)}`).join(`
`)}else return`

(found in ${c_(e)})`}const HM=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],XM=e=>e<=.0031308?e*12.92:1.055*e**(1/2.4)-.055,YM=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],KM=e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4;function sT(e){const s=Array(3),a=XM,u=HM;for(let d=0;d<3;++d)s[d]=Math.round(Eo(a(u[d][0]*e[0]+u[d][1]*e[1]+u[d][2]*e[2]))*255);return(s[0]<<16)+(s[1]<<8)+(s[2]<<0)}function Ny(e){const s=[0,0,0],a=KM,u=YM,d=a((e>>16&255)/255),g=a((e>>8&255)/255),x=a((e>>0&255)/255);for(let o=0;o<3;++o)s[o]=u[o][0]*d+u[o][1]*g+u[o][2]*x;return s}const Wm=.20689655172413793,JM=e=>e>Wm**3?Math.cbrt(e):e/(3*Wm**2)+4/29,QM=e=>e>Wm?e**3:3*Wm**2*(e-4/29);function aT(e){const s=JM,a=s(e[1]);return[116*a-16,500*(s(e[0]/.95047)-a),200*(a-s(e[2]/1.08883))]}function lT(e){const s=QM,a=(e[0]+16)/116;return[s(a+e[1]/500)*.95047,s(a),s(a-e[2]/200)*1.08883]}function Bb(e){return!!e&&/^(#|var\(--|(rgb|hsl)a?\()/.test(e)}function Hm(e){let s;if(typeof e=="number")s=e;else if(typeof e=="string"){let a=e.startsWith("#")?e.substring(1):e;a.length===3&&(a=a.split("").map(u=>u+u).join("")),a.length!==6&&a.length!==8&&wc(`'${e}' is not a valid rgb color`),s=parseInt(a,16)}else throw new TypeError(`Colors can only be numbers or strings, recieved ${e==null?e:e.constructor.name} instead`);return s<0?(wc(`Colors cannot be negative: '${e}'`),s=0):(s>4294967295||isNaN(s))&&(wc(`'${e}' is not a valid rgb color`),s=16777215),s}function eP(e){let s=e.toString(16);return s.length<6&&(s="0".repeat(6-s.length)+s),"#"+s}function yg(e){const{h:s,s:a,v:u,a:d}=e,g=o=>{const w=(o+s/60)%6;return u-u*a*Math.max(Math.min(w,4-w,1),0)},x=[g(5),g(3),g(1)].map(o=>Math.round(o*255));return{r:x[0],g:x[1],b:x[2],a:d}}function Uy(e){if(!e)return{h:0,s:1,v:1,a:1};const s=e.r/255,a=e.g/255,u=e.b/255,d=Math.max(s,a,u),g=Math.min(s,a,u);let x=0;d!==g&&(d===s?x=60*(0+(a-u)/(d-g)):d===a?x=60*(2+(u-s)/(d-g)):d===u&&(x=60*(4+(s-a)/(d-g)))),x<0&&(x=x+360);const o=d===0?0:(d-g)/d,w=[x,o,d];return{h:w[0],s:w[1],v:w[2],a:e.a}}function cT(e){const{h:s,s:a,v:u,a:d}=e,g=u-u*a/2,x=g===1||g===0?0:(u-g)/Math.min(g,1-g);return{h:s,s:x,l:g,a:d}}function uT(e){const{h:s,s:a,l:u,a:d}=e,g=u+a*Math.min(u,1-u),x=g===0?0:2-2*u/g;return{h:s,s:x,v:g,a:d}}function tP(e){return`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`}function hT(e){return tP(yg(e))}function nP(e){const s=a=>{const u=Math.round(a).toString(16);return("00".substr(0,2-u.length)+u).toUpperCase()};return`#${[s(e.r),s(e.g),s(e.b),s(Math.round(e.a*255))].join("")}`}function iP(e){const s=$M(e.slice(1),2).map(a=>parseInt(a,16));return{r:s[0],g:s[1],b:s[2],a:Math.round(s[3]/255*100)/100}}function dT(e){const s=iP(e);return Uy(s)}function fT(e){return nP(yg(e))}function rP(e){return e.startsWith("#")&&(e=e.slice(1)),e=e.replace(/([^0-9a-f])/gi,"F"),(e.length===3||e.length===4)&&(e=e.split("").map(s=>s+s).join("")),e.length===6?e=s_(e,8,"F"):e=s_(s_(e,6),8,"F"),`#${e}`.toUpperCase().substr(0,9)}function pT(e){const s=Hm(e);return{r:(s&16711680)>>16,g:(s&65280)>>8,b:s&255}}function oP(e,s){const a=aT(Ny(e));return a[0]=a[0]+s*10,sT(lT(a))}function sP(e,s){const a=aT(Ny(e));return a[0]=a[0]-s*10,sT(lT(a))}function $_(e){const s=Hm(e);return Ny(s)[1]}function aP(e,s){const a=$_(e),u=$_(s),d=Math.max(a,u),g=Math.min(a,u);return(d+.05)/(g+.05)}function Ar(e,s){const a=gg();if(!a)throw new Error(`[Vuetify] ${e} ${s||"must be called from inside a setup function"}`);return a}function pa(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const s=Ar(e).type;return Fy((s==null?void 0:s.aliasName)||(s==null?void 0:s.name))}let mT=0,Bm=new WeakMap;function Nr(){const e=Ar("getUid");if(Bm.has(e))return Bm.get(e);{const s=mT++;return Bm.set(e,s),s}}Nr.reset=()=>{mT=0,Bm=new WeakMap};function lP(e){const{provides:s}=Ar("injectSelf");if(s&&e in s)return s[e]}function Mn(e,s){return a=>Object.keys(e).reduce((u,d)=>{const x=typeof e[d]=="object"&&e[d]!=null&&!Array.isArray(e[d])?e[d]:{type:e[d]};return a&&d in a?u[d]={...x,default:a[d]}:u[d]=x,s&&!u[d].source&&(u[d].source=s),u},{})}function cP(e,s){var a,u;return((a=e.props)==null?void 0:a.hasOwnProperty(s))||((u=e.props)==null?void 0:u.hasOwnProperty(Fy(s)))}const Pt=function(s){var a,u;return s._setup=(a=s._setup)!=null?a:s.setup,s.name?(s._setup&&(s.props=(u=s.props)!=null?u:{},s.props=Mn(s.props,s.name)(),s.props._as=String,s.setup=function(g,x){const o=gg(),w=_T(),E=Si(),k=lS({...Hn(g)});Ls(()=>{var H,pe,se;const O=w.value.global,G=w.value[(H=g._as)!=null?H:s.name];if(G){const he=Object.entries(G).filter(K=>{let[Te]=K;return Te.startsWith("V")});he.length&&(E.value=Object.fromEntries(he))}for(const he of Object.keys(g)){let K=g[he];cP(o.vnode,he)||(K=(se=(pe=G==null?void 0:G[he])!=null?pe:O==null?void 0:O[he])!=null?se:g[he]),k[he]!==K&&(k[he]=K)}});const z=s._setup(k,x);let L;return Ye(E,(O,G)=>{!O&&L?L.stop():O&&!G&&(L=Cf(),L.run(()=>{var pe;var H;ir(da((pe=(H=lP(gf))==null?void 0:H.value)!=null?pe:{},O))}))},{immediate:!0}),z}),s):(wc("The component is missing an explicit name, unable to generate default prop value"),s)};function Pi(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return s=>(e?Pt:Ln)(s)}function Po(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",a=arguments.length>2?arguments[2]:void 0;return Pt({name:a!=null?a:dl(ko(e.replace(/__/g,"-"))),props:{tag:{type:String,default:s}},setup(u,d){let{slots:g}=d;return()=>{var x;return Ds(u.tag,{class:e},(x=g.default)==null?void 0:x.call(g))}}})}function gT(e){if(typeof e.getRootNode!="function"){for(;e.parentNode;)e=e.parentNode;return e!==document?null:document}const s=e.getRootNode();return s!==document&&s.getRootNode({composed:!0})!==document?null:s}const mf="cubic-bezier(0.4, 0, 0.2, 1)",uP="cubic-bezier(0.0, 0, 0.2, 1)",hP="cubic-bezier(0.4, 0, 1, 1)";function vT(e){for(;e;){if(jy(e))return e;e=e.parentElement}return document.scrollingElement}function Xm(e,s){const a=[];if(s&&e&&!s.contains(e))return a;for(;e&&(jy(e)&&a.push(e),e!==s);)e=e.parentElement;return a}function jy(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const s=window.getComputedStyle(e);return s.overflowY==="scroll"||s.overflowY==="auto"&&e.scrollHeight>e.clientHeight}const Mi=typeof window<"u",Gy=Mi&&"IntersectionObserver"in window,dP=Mi&&("ontouchstart"in window||window.navigator.maxTouchPoints>0),N_=Mi&&typeof CSS<"u"&&CSS.supports("selector(:focus-visible)");function fP(e){for(;e;){if(window.getComputedStyle(e).position==="fixed")return!0;e=e.offsetParent}return!1}function kt(e){const s=Ar("useRender");s.render=e}const gf=Symbol.for("vuetify:defaults");function pP(e){return Ke(e!=null?e:{})}function _T(){const e=ln(gf);if(!e)throw new Error("[Vuetify] Could not find defaults instance");return e}function ir(e,s){const a=_T(),u=Ke(e),d=ne(()=>{const g=Ai(s==null?void 0:s.scoped),x=Ai(s==null?void 0:s.reset),o=Ai(s==null?void 0:s.root);let w=da(u.value,{prev:a.value});if(g)return w;if(x||o){const E=Number(x||1/0);for(let k=0;k<=E&&w.prev;k++)w=w.prev;return w}return da(w.prev,w)});return Ni(gf,d),d}const wi=Ln({name:"VDefaultsProvider",props:{defaults:Object,reset:[Number,String],root:Boolean,scoped:Boolean},setup(e,s){let{slots:a}=s;const{defaults:u,reset:d,root:g,scoped:x}=Cy(e);return ir(u,{reset:d,root:g,scoped:x}),()=>{var o;return(o=a.default)==null?void 0:o.call(a)}}});function ho(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top center 0",a=arguments.length>2?arguments[2]:void 0;return Pt({name:e,props:{group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:{type:String,default:a},origin:{type:String,default:s}},setup(u,d){let{slots:g}=d;return()=>{const x=u.group?TM:zs;return Ds(x,{name:e,mode:u.mode,onBeforeEnter(o){o.style.transformOrigin=u.origin},onLeave(o){if(u.leaveAbsolute){const{offsetTop:w,offsetLeft:E,offsetWidth:k,offsetHeight:z}=o;o._transitionInitialStyles={position:o.style.position,top:o.style.top,left:o.style.left,width:o.style.width,height:o.style.height},o.style.position="absolute",o.style.top=`${w}px`,o.style.left=`${E}px`,o.style.width=`${k}px`,o.style.height=`${z}px`}u.hideOnLeave&&o.style.setProperty("display","none","important")},onAfterLeave(o){if(u.leaveAbsolute&&o!=null&&o._transitionInitialStyles){const{position:w,top:E,left:k,width:z,height:L}=o._transitionInitialStyles;delete o._transitionInitialStyles,o.style.position=w||"",o.style.top=E||"",o.style.left=k||"",o.style.width=z||"",o.style.height=L||""}}},g.default)}}})}function yT(e,s){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"in-out";return Pt({name:e,props:{mode:{type:String,default:a}},setup(u,d){let{slots:g}=d;return()=>Ds(zs,{name:e,...s},g.default)}})}function xT(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const a=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?"width":"height",u=ko(`offset-${a}`);return{onBeforeEnter(x){x._parent=x.parentNode,x._initialStyle={transition:x.style.transition,overflow:x.style.overflow,[a]:x.style[a]}},onEnter(x){const o=x._initialStyle;x.style.setProperty("transition","none","important"),x.style.overflow="hidden";const w=`${x[u]}px`;x.style[a]="0",x.offsetHeight,x.style.transition=o.transition,e&&x._parent&&x._parent.classList.add(e),requestAnimationFrame(()=>{x.style[a]=w})},onAfterEnter:g,onEnterCancelled:g,onLeave(x){x._initialStyle={transition:"",overflow:x.style.overflow,[a]:x.style[a]},x.style.overflow="hidden",x.style[a]=`${x[u]}px`,x.offsetHeight,requestAnimationFrame(()=>x.style[a]="0")},onAfterLeave:d,onLeaveCancelled:d};function d(x){e&&x._parent&&x._parent.classList.remove(e),g(x)}function g(x){const o=x._initialStyle[a];x.style.overflow=x._initialStyle.overflow,o!=null&&(x.style[a]=o),delete x._initialStyle}}const xg=Pt({name:"VDialogTransition",props:{target:Object},setup(e,s){let{slots:a}=s;const u={onBeforeEnter(d){d.style.pointerEvents="none",d.style.visibility="hidden"},async onEnter(d,g){var x;await new Promise(O=>requestAnimationFrame(O)),await new Promise(O=>requestAnimationFrame(O)),d.style.visibility="";const{x:o,y:w,sx:E,sy:k,speed:z}=Fb(e.target,d),L=vc(d,[{transform:`translate(${o}px, ${w}px) scale(${E}, ${k})`,opacity:0},{transform:""}],{duration:225*z,easing:uP});(x=Ob(d))==null||x.forEach(O=>{vc(O,[{opacity:0},{opacity:0,offset:.33},{opacity:1}],{duration:225*2*z,easing:mf})}),L.finished.then(()=>g())},onAfterEnter(d){d.style.removeProperty("pointer-events")},onBeforeLeave(d){d.style.pointerEvents="none"},async onLeave(d,g){var x;await new Promise(O=>requestAnimationFrame(O));const{x:o,y:w,sx:E,sy:k,speed:z}=Fb(e.target,d);vc(d,[{transform:""},{transform:`translate(${o}px, ${w}px) scale(${E}, ${k})`,opacity:0}],{duration:125*z,easing:hP}).finished.then(()=>g()),(x=Ob(d))==null||x.forEach(O=>{vc(O,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*z,easing:mf})})},onAfterLeave(d){d.style.removeProperty("pointer-events")}};return()=>e.target?F(zs,tn({name:"dialog-transition"},u,{css:!1}),a):F(zs,{name:"dialog-transition"},a)}});function Ob(e){var s;const a=(s=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:s.children;return a&&[...a]}function Fb(e,s){const a=e.getBoundingClientRect(),u=$y(s),[d,g]=getComputedStyle(s).transformOrigin.split(" ").map(se=>parseFloat(se)),[x,o]=getComputedStyle(s).getPropertyValue("--v-overlay-anchor-origin").split(" ");let w=a.left+a.width/2;x==="left"||o==="left"?w-=a.width/2:(x==="right"||o==="right")&&(w+=a.width/2);let E=a.top+a.height/2;x==="top"||o==="top"?E-=a.height/2:(x==="bottom"||o==="bottom")&&(E+=a.height/2);const k=a.width/u.width,z=a.height/u.height,L=Math.max(1,k,z),O=k/L,G=z/L,H=u.width*u.height/(window.innerWidth*window.innerHeight),pe=H>.12?Math.min(1.5,(H-.12)*10+1):1;return{x:w-(d+u.left),y:E-(g+u.top),sx:O,sy:G,speed:pe}}const mP=ho("fab-transition","center center","out-in"),gP=ho("dialog-bottom-transition"),vP=ho("dialog-top-transition"),U_=ho("fade-transition"),bT=ho("scale-transition"),_P=ho("scroll-x-transition"),yP=ho("scroll-x-reverse-transition"),xP=ho("scroll-y-transition"),bP=ho("scroll-y-reverse-transition"),wP=ho("slide-x-transition"),SP=ho("slide-x-reverse-transition"),qy=ho("slide-y-transition"),TP=ho("slide-y-reverse-transition"),bg=yT("expand-transition",xT()),Zy=yT("expand-x-transition",xT("",!0));const ns=Mn({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function is(e){return{dimensionStyles:ne(()=>({height:Xt(e.height),maxHeight:Xt(e.maxHeight),maxWidth:Xt(e.maxWidth),minHeight:Xt(e.minHeight),minWidth:Xt(e.minWidth),width:Xt(e.width)}))}}function EP(e){return{aspectStyles:ne(()=>{const s=Number(e.aspectRatio);return s?{paddingBottom:String(1/s*100)+"%"}:void 0})}}const wT=Pt({name:"VResponsive",props:{aspectRatio:[String,Number],contentClass:String,...ns()},setup(e,s){let{slots:a}=s;const{aspectStyles:u}=EP(e),{dimensionStyles:d}=is(e);return kt(()=>{var g;return F("div",{class:"v-responsive",style:d.value},[F("div",{class:"v-responsive__sizer",style:u.value},null),(g=a.additional)==null?void 0:g.call(a),a.default&&F("div",{class:["v-responsive__content",e.contentClass]},[a.default()])])}),{}}});function CP(e,s){if(!Gy)return;const a=s.modifiers||{},u=s.value,{handler:d,options:g}=typeof u=="object"?u:{handler:u,options:{}},x=new IntersectionObserver(function(){var o;let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],E=arguments.length>1?arguments[1]:void 0;const k=(o=e._observe)==null?void 0:o[s.instance.$.uid];if(!k)return;const z=w.some(L=>L.isIntersecting);d&&(!a.quiet||k.init)&&(!a.once||z||k.init)&&d(z,w,E),z&&a.once?ST(e,s):k.init=!0},g);e._observe=Object(e._observe),e._observe[s.instance.$.uid]={init:!1,observer:x},x.observe(e)}function ST(e,s){var a;const u=(a=e._observe)==null?void 0:a[s.instance.$.uid];!u||(u.observer.unobserve(e),delete e._observe[s.instance.$.uid])}const Mf={mounted:CP,unmounted:ST},ma=Mn({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:e=>e!==!0}},"transition"),Ps=(e,s)=>{let{slots:a}=s;const{transition:u,...d}=e,{component:g=zs,...x}=typeof u=="object"?u:{};return Ds(g,tn(typeof u=="string"?{name:u}:x,d),a)},oh=Pt({name:"VImg",directives:{intersect:Mf},props:{aspectRatio:[String,Number],alt:String,cover:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},srcset:String,width:[String,Number],...ma()},emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,s){let{emit:a,slots:u}=s;const d=Ke(""),g=Ke(),x=Ke(e.eager?"loading":"idle"),o=Ke(),w=Ke(),E=ne(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),k=ne(()=>E.value.aspect||o.value/w.value||0);Ye(()=>e.src,()=>{z(x.value!=="idle")}),pg(()=>z());function z(de){if(!(e.eager&&de)&&!(Gy&&!de&&!e.eager)){if(x.value="loading",E.value.lazySrc){const ve=new Image;ve.src=E.value.lazySrc,H(ve,null)}!E.value.src||Ui(()=>{var ve,Se;if(a("loadstart",((ve=g.value)==null?void 0:ve.currentSrc)||E.value.src),(Se=g.value)!=null&&Se.complete){if(g.value.naturalWidth||O(),x.value==="error")return;k.value||H(g.value,null),L()}else k.value||H(g.value),G()})}}function L(){var de;G(),x.value="loaded",a("load",((de=g.value)==null?void 0:de.currentSrc)||E.value.src)}function O(){var de;x.value="error",a("error",((de=g.value)==null?void 0:de.currentSrc)||E.value.src)}function G(){const de=g.value;de&&(d.value=de.currentSrc||de.src)}function H(de){let ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const Se=()=>{const{naturalHeight:be,naturalWidth:De}=de;be||De?(o.value=De,w.value=be):!de.complete&&x.value==="loading"&&ve!=null?setTimeout(Se,ve):(de.currentSrc.endsWith(".svg")||de.currentSrc.startsWith("data:image/svg+xml"))&&(o.value=1,w.value=1)};Se()}const pe=ne(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),se=()=>{var de;if(!E.value.src||x.value==="idle")return null;const ve=F("img",{class:["v-img__img",pe.value],src:E.value.src,srcset:E.value.srcset,alt:"",sizes:e.sizes,ref:g,onLoad:L,onError:O},null),Se=(de=u.sources)==null?void 0:de.call(u);return F(Ps,{transition:e.transition,appear:!0},{default:()=>[ji(Se?F("picture",{class:"v-img__picture"},[Se,ve]):ve,[[Rs,x.value==="loaded"]])]})},he=()=>F(Ps,{transition:e.transition},{default:()=>[E.value.lazySrc&&x.value!=="loaded"&&F("img",{class:["v-img__img","v-img__img--preload",pe.value],src:E.value.lazySrc,alt:""},null)]}),K=()=>u.placeholder?F(Ps,{transition:e.transition,appear:!0},{default:()=>[(x.value==="loading"||x.value==="error"&&!u.error)&&F("div",{class:"v-img__placeholder"},[u.placeholder()])]}):null,Te=()=>u.error?F(Ps,{transition:e.transition,appear:!0},{default:()=>[x.value==="error"&&F("div",{class:"v-img__error"},[u.error()])]}):null,Y=()=>e.gradient?F("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,_e=Ke(!1);{const de=Ye(k,ve=>{ve&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{_e.value=!0})}),de())})}return kt(()=>ji(F(wT,{class:["v-img",{"v-img--booting":!_e.value}],style:{width:Xt(e.width==="auto"?o.value:e.width)},aspectRatio:k.value,"aria-label":e.alt,role:e.alt?"img":void 0},{additional:()=>F(On,null,[F(se,null,null),F(he,null,null),F(Y,null,null),F(K,null,null),F(Te,null,null)]),default:u.default}),[[uo("intersect"),{handler:z,options:e.options},null,{once:!0}]])),{currentSrc:d,image:g,state:x,naturalWidth:o,naturalHeight:w}}}),wn=Mn({tag:{type:String,default:"div"}},"tag"),Ym=Pi()({name:"VToolbarTitle",props:{text:String,...wn()},setup(e,s){let{slots:a}=s;return kt(()=>{var u;const d=!!(a.default||a.text||e.text);return F(e.tag,{class:"v-toolbar-title"},{default:()=>[d&&F("div",{class:"v-toolbar-title__placeholder"},[a.text?a.text():e.text,(u=a.default)==null?void 0:u.call(a)])]})}),{}}}),fo=Mn({border:[Boolean,Number,String]},"border");function zo(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pa();return{borderClasses:ne(()=>{const u=ki(e)?e.value:e.border,d=[];if(u===!0||u==="")d.push(`${s}--border`);else if(typeof u=="string"||u===0)for(const g of String(u).split(" "))d.push(`border-${g}`);return d})}}const or=Mn({elevation:{type:[Number,String],validator(e){const s=parseInt(e);return!isNaN(s)&&s>=0&&s<=24}}},"elevation");function kr(e){return{elevationClasses:ne(()=>{const a=ki(e)?e.value:e.elevation,u=[];return a==null||u.push(`elevation-${a}`),u})}}const zi=Mn({rounded:{type:[Boolean,Number,String],default:void 0}},"rounded");function Yi(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pa();return{roundedClasses:ne(()=>{const u=ki(e)?e.value:e.rounded,d=[];if(u===!0||u==="")d.push(`${s}--rounded`);else if(typeof u=="string"||u===0)for(const g of String(u).split(" "))d.push(`rounded-${g}`);return d})}}const Nu=2.4,Vb=.2126729,$b=.7151522,Nb=.072175,IP=.55,AP=.58,kP=.57,MP=.62,km=.03,Ub=1.45,PP=5e-4,zP=1.25,LP=1.25,jb=.078,Gb=12.82051282051282,Mm=.06,qb=.001;function Zb(e,s){const a=((e>>16&255)/255)**Nu,u=((e>>8&255)/255)**Nu,d=((e>>0&255)/255)**Nu,g=((s>>16&255)/255)**Nu,x=((s>>8&255)/255)**Nu,o=((s>>0&255)/255)**Nu;let w=a*Vb+u*$b+d*Nb,E=g*Vb+x*$b+o*Nb;if(w<=km&&(w+=(km-w)**Ub),E<=km&&(E+=(km-E)**Ub),Math.abs(E-w)<PP)return 0;let k;if(E>w){const z=(E**IP-w**AP)*zP;k=z<qb?0:z<jb?z-z*Gb*Mm:z-Mm}else{const z=(E**MP-w**kP)*LP;k=z>-qb?0:z>-jb?z-z*Gb*Mm:z+Mm}return k*100}const vf=Symbol.for("vuetify:theme"),Xn=Mn({theme:String},"theme"),$d={defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#6200EE","primary-darken-1":"#3700B3",secondary:"#03DAC6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-variant":"#BDBDBD","on-surface-variant":"#424242",primary:"#BB86FC","primary-darken-1":"#3700B3",secondary:"#03DAC5","secondary-darken-1":"#03DAC5",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}};function DP(){var d;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$d;if(!e)return{...$d,isDisabled:!0};const s={};for(const[g,x]of Object.entries((d=e.themes)!=null?d:{})){var a,u;const o=x.dark||g==="dark"?(a=$d.themes)==null?void 0:a.dark:(u=$d.themes)==null?void 0:u.light;s[g]=da(o,x)}return da($d,{...e,themes:s})}function RP(e){const s=Qi(DP(e)),a=Ke(s.defaultTheme),u=Ke(s.themes),d=ne(()=>{const E={};for(const[k,z]of Object.entries(u.value)){const L=E[k]={...z,colors:{...z.colors}};if(s.variations)for(const O of s.variations.colors){const G=L.colors[O];if(!!G)for(const H of["lighten","darken"]){const pe=H==="lighten"?oP:sP;for(const se of gc(s.variations[H],1))L.colors[`${O}-${H}-${se}`]=eP(pe(Hm(G),se))}}for(const O of Object.keys(L.colors)){if(/^on-[a-z]/.test(O)||L.colors[`on-${O}`])continue;const G=`on-${O}`,H=Hm(L.colors[O]),pe=Math.abs(Zb(0,H)),se=Math.abs(Zb(16777215,H));L.colors[G]=se>Math.min(pe,50)?"#fff":"#000"}}return E}),g=ne(()=>d.value[a.value]),x=ne(()=>{const E=[];g.value.dark&&Uu(E,":root",["color-scheme: dark"]);for(const[O,G]of Object.entries(d.value)){const{variables:H,dark:pe}=G;Uu(E,`.v-theme--${O}`,[`color-scheme: ${pe?"dark":"normal"}`,...BP(G),...Object.keys(H).map(se=>{const he=H[se],K=typeof he=="string"&&he.startsWith("#")?pT(he):void 0,Te=K?`${K.r}, ${K.g}, ${K.b}`:void 0;return`--v-${se}: ${Te!=null?Te:he}`})])}const k=[],z=[],L=new Set(Object.values(d.value).flatMap(O=>Object.keys(O.colors)));for(const O of L)/^on-[a-z]/.test(O)?Uu(z,`.${O}`,[`color: rgb(var(--v-theme-${O})) !important`]):(Uu(k,`.bg-${O}`,[`--v-theme-overlay-multiplier: var(--v-theme-${O}-overlay-multiplier)`,`background: rgb(var(--v-theme-${O})) !important`,`color: rgb(var(--v-theme-on-${O})) !important`]),Uu(z,`.text-${O}`,[`color: rgb(var(--v-theme-${O})) !important`]),Uu(z,`.border-${O}`,[`--v-border-color: var(--v-theme-${O})`]));return E.push(...k,...z),E.map((O,G)=>G===0?O:`    ${O}`).join("")});function o(E){const k=E._context.provides.usehead;if(k)k.addHeadObjs(ne(()=>{const z={children:x.value,type:"text/css",id:"vuetify-theme-stylesheet"};return s.cspNonce&&(z.nonce=s.cspNonce),{style:[z]}})),Mi&&Ls(()=>k.updateDOM());else{let L=function(){if(!s.isDisabled){if(typeof document<"u"&&!z){const O=document.createElement("style");O.type="text/css",O.id="vuetify-theme-stylesheet",s.cspNonce&&O.setAttribute("nonce",s.cspNonce),z=O,document.head.appendChild(z)}z&&(z.innerHTML=x.value)}},z=Mi?document.getElementById("vuetify-theme-stylesheet"):null;Ye(x,L,{immediate:!0})}}const w=ne(()=>s.isDisabled?void 0:`v-theme--${a.value}`);return{install:o,isDisabled:s.isDisabled,name:a,themes:u,current:g,computedThemes:d,themeClasses:w,styles:x,global:{name:a,current:g}}}function vi(e){Ar("provideTheme");const s=ln(vf,null);if(!s)throw new Error("Could not find Vuetify theme injection");const a=ne(()=>{var g;return(g=e.theme)!=null?g:s==null?void 0:s.name.value}),u=ne(()=>s.isDisabled?void 0:`v-theme--${a.value}`),d={...s,name:a,themeClasses:u};return Ni(vf,d),d}function TT(){Ar("useTheme");const e=ln(vf,null);if(!e)throw new Error("Could not find Vuetify theme injection");return e}function Uu(e,s,a){e.push(`${s} {
`,...a.map(u=>`  ${u};
`),`}
`)}function BP(e){const s=e.dark?2:1,a=e.dark?1:2,u=[];for(const[d,g]of Object.entries(e.colors)){const x=pT(g);u.push(`--v-theme-${d}: ${x.r},${x.g},${x.b}`),d.startsWith("on-")||u.push(`--v-theme-${d}-overlay-multiplier: ${$_(g)>.18?s:a}`)}return u}function Wy(e){return Vy(()=>{const s=[],a={};return e.value.background&&(Bb(e.value.background)?a.backgroundColor=e.value.background:s.push(`bg-${e.value.background}`)),e.value.text&&(Bb(e.value.text)?(a.color=e.value.text,a.caretColor=e.value.text):s.push(`text-${e.value.text}`)),{colorClasses:s,colorStyles:a}})}function no(e,s){const a=ne(()=>({text:ki(e)?e.value:s?e[s]:null})),{colorClasses:u,colorStyles:d}=Wy(a);return{textColorClasses:u,textColorStyles:d}}function Hi(e,s){const a=ne(()=>({background:ki(e)?e.value:s?e[s]:null})),{colorClasses:u,colorStyles:d}=Wy(a);return{backgroundColorClasses:u,backgroundColorStyles:d}}const OP=[null,"prominent","default","comfortable","compact"],ET=Mn({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:e=>OP.includes(e)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...fo(),...or(),...zi(),...wn({tag:"header"}),...Xn()},"v-toolbar"),Km=Pi()({name:"VToolbar",props:ET(),setup(e,s){var a;let{slots:u}=s;const{backgroundColorClasses:d,backgroundColorStyles:g}=Hi(St(e,"color")),{borderClasses:x}=zo(e),{elevationClasses:o}=kr(e),{roundedClasses:w}=Yi(e),{themeClasses:E}=vi(e),k=Ke(!!(e.extended||(a=u.extension)!=null&&a.call(u))),z=ne(()=>parseInt(Number(e.height)+(e.density==="prominent"?Number(e.height):0)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0),10)),L=ne(()=>k.value?parseInt(Number(e.extensionHeight)+(e.density==="prominent"?Number(e.extensionHeight):0)-(e.density==="comfortable"?4:0)-(e.density==="compact"?8:0),10):0);return ir({VBtn:{variant:"text"}}),kt(()=>{var O,G,H,pe,se;const he=!!(e.title||u.title),K=!!(u.image||e.image),Te=(O=u.extension)==null?void 0:O.call(u);return k.value=!!(e.extended||Te),F(e.tag,{class:["v-toolbar",{"v-toolbar--absolute":e.absolute,"v-toolbar--collapse":e.collapse,"v-toolbar--flat":e.flat,"v-toolbar--floating":e.floating,[`v-toolbar--density-${e.density}`]:!0},d.value,x.value,o.value,w.value,E.value],style:[g.value]},{default:()=>[K&&F("div",{key:"image",class:"v-toolbar__image"},[F(wi,{defaults:{VImg:{cover:!0,src:e.image}}},{default:()=>[u.image?(G=u.image)==null?void 0:G.call(u):F(oh,null,null)]})]),F("div",{class:"v-toolbar__content",style:{height:Xt(z.value)}},[u.prepend&&F("div",{class:"v-toolbar__prepend"},[(H=u.prepend)==null?void 0:H.call(u)]),he&&F(Ym,{key:"title",text:e.title},{text:u.title}),(pe=u.default)==null?void 0:pe.call(u),u.append&&F("div",{class:"v-toolbar__append"},[(se=u.append)==null?void 0:se.call(u)])]),F(bg,null,{default:()=>[k.value&&F("div",{class:"v-toolbar__extension",style:{height:Xt(L.value)}},[Te])]})]})}),{contentHeight:z,extensionHeight:L}}});function FP(e){var s;return Mo(e,Object.keys((s=Km==null?void 0:Km.props)!=null?s:{}))}function Tc(e){const s=Ke(),a=Ke();if(Mi){const u=new ResizeObserver(d=>{e==null||e(d,u),d.length&&(a.value=d[0].contentRect)});Ti(()=>{u.disconnect()}),Ye(s,(d,g)=>{g&&(u.unobserve(g),a.value=void 0),d&&u.observe(d)},{flush:"post"})}return{resizeRef:s,contentRect:If(a)}}const Jm=Symbol.for("vuetify:layout"),CT=Symbol.for("vuetify:layout-item"),Wb=1e3,IT=Mn({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),sh=Mn({name:{type:String},order:{type:[Number,String],default:0},absolute:Boolean},"layout-item");function VP(){const e=ln(Jm);if(!e)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:e.getLayoutItem,mainRect:e.mainRect,mainStyles:e.mainStyles}}function ah(e){var o;const s=ln(Jm);if(!s)throw new Error("[Vuetify] Could not find injected layout");const a=(o=e.id)!=null?o:`layout-item-${Nr()}`,u=Ar("useLayoutItem");Ni(CT,{id:a});const d=Ke(!1);AS(()=>d.value=!0),IS(()=>d.value=!1);const{layoutItemStyles:g,layoutItemScrimStyles:x}=s.register(u,{...e,active:ne(()=>d.value?!1:e.active.value),id:a});return Ti(()=>s.unregister(a)),{layoutItemStyles:g,layoutRect:s.layoutRect,layoutItemScrimStyles:x}}const $P=(e,s,a,u)=>{let d={top:0,left:0,right:0,bottom:0};const g=[{id:"",layer:{...d}}];for(const x of e){const o=s.get(x),w=a.get(x),E=u.get(x);if(!o||!w||!E)continue;const k={...d,[o.value]:parseInt(d[o.value],10)+(E.value?parseInt(w.value,10):0)};g.push({id:x,layer:k}),d=k}return g};function AT(e){const s=ln(Jm,null),a=ne(()=>s?s.rootZIndex.value-100:Wb),u=Ke([]),d=Qi(new Map),g=Qi(new Map),x=Qi(new Map),o=Qi(new Map),w=Qi(new Map),{resizeRef:E,contentRect:k}=Tc(),z=ne(()=>{var ve;const _e=new Map,de=(ve=e.overlaps)!=null?ve:[];for(const Se of de.filter(be=>be.includes(":"))){const[be,De]=Se.split(":");if(!u.value.includes(be)||!u.value.includes(De))continue;const ze=d.get(be),Je=d.get(De),ct=g.get(be),nt=g.get(De);!ze||!Je||!ct||!nt||(_e.set(De,{position:ze.value,amount:parseInt(ct.value,10)}),_e.set(be,{position:Je.value,amount:-parseInt(nt.value,10)}))}return _e}),L=ne(()=>{const _e=[...new Set([...x.values()].map(ve=>ve.value))].sort((ve,Se)=>ve-Se),de=[];for(const ve of _e){const Se=u.value.filter(be=>{var De;return((De=x.get(be))==null?void 0:De.value)===ve});de.push(...Se)}return $P(de,d,g,o)}),O=ne(()=>!Array.from(w.values()).some(_e=>_e.value)),G=ne(()=>L.value[L.value.length-1].layer),H=ne(()=>({"--v-layout-left":Xt(G.value.left),"--v-layout-right":Xt(G.value.right),"--v-layout-top":Xt(G.value.top),"--v-layout-bottom":Xt(G.value.bottom),...O.value?void 0:{transition:"none"}})),pe=ne(()=>L.value.slice(1).map((_e,de)=>{let{id:ve}=_e;const{layer:Se}=L.value[de],be=g.get(ve),De=d.get(ve);return{id:ve,...Se,size:Number(be.value),position:De.value}})),se=_e=>pe.value.find(de=>de.id===_e),he=Ar("createLayout"),K=Ke(!1);kn(()=>{K.value=!0}),Ni(Jm,{register:(_e,de)=>{let{id:ve,order:Se,position:be,layoutSize:De,elementSize:ze,active:Je,disableTransitions:ct,absolute:nt}=de;x.set(ve,Se),d.set(ve,be),g.set(ve,De),o.set(ve,Je),ct&&w.set(ve,ct);const Pe=Jd(CT,he==null?void 0:he.vnode).indexOf(_e);Pe>-1?u.value.splice(Pe,0,ve):u.value.push(ve);const at=ne(()=>pe.value.findIndex(Gt=>Gt.id===ve)),jt=ne(()=>a.value+L.value.length*2-at.value*2),pt=ne(()=>{const Gt=be.value==="left"||be.value==="right",zn=be.value==="right",At=be.value==="bottom",Qe={[be.value]:0,zIndex:jt.value,transform:`translate${Gt?"X":"Y"}(${(Je.value?0:-110)*(zn||At?-1:1)}%)`,position:nt.value||a.value!==Wb?"absolute":"fixed",...O.value?void 0:{transition:"none"}};if(!K.value)return Qe;const xt=pe.value[at.value];if(!xt)throw new Error(`[Vuetify] Could not find layout item "${ve}"`);const Tt=z.value.get(ve);return Tt&&(xt[Tt.position]+=Tt.amount),{...Qe,height:Gt?`calc(100% - ${xt.top}px - ${xt.bottom}px)`:ze.value?`${ze.value}px`:void 0,left:zn?void 0:`${xt.left}px`,right:zn?`${xt.right}px`:void 0,top:be.value!=="bottom"?`${xt.top}px`:void 0,bottom:be.value!=="top"?`${xt.bottom}px`:void 0,width:Gt?ze.value?`${ze.value}px`:void 0:`calc(100% - ${xt.left}px - ${xt.right}px)`}}),zt=ne(()=>({zIndex:jt.value-1}));return{layoutItemStyles:pt,layoutItemScrimStyles:zt,zIndex:jt}},unregister:_e=>{x.delete(_e),d.delete(_e),g.delete(_e),o.delete(_e),w.delete(_e),u.value=u.value.filter(de=>de!==_e)},mainRect:G,mainStyles:H,getLayoutItem:se,items:pe,layoutRect:k,rootZIndex:a});const Te=ne(()=>["v-layout",{"v-layout--full-height":e.fullHeight}]),Y=ne(()=>({zIndex:a.value,position:s?"relative":void 0,overflow:s?"hidden":void 0}));return{layoutClasses:Te,layoutStyles:Y,getLayoutItem:se,items:pe,layoutRect:k,layoutRef:E}}function _f(e,s){let a;Ye(e,u=>{if(u&&!a)a=Cf(),a.run(s);else{var d;(d=a)==null||d.stop(),a=void 0}},{immediate:!0})}function bn(e,s,a){let u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:z=>z,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:z=>z;const g=Ar("useProxiedModel"),x=Ke(e[s]!==void 0?e[s]:a),o=Fy(s),E=ne(o!==s?()=>{var z,L,O,G;return e[s],!!(((z=g.vnode.props)!=null&&z.hasOwnProperty(s)||(L=g.vnode.props)!=null&&L.hasOwnProperty(o))&&((O=g.vnode.props)!=null&&O.hasOwnProperty(`onUpdate:${s}`)||(G=g.vnode.props)!=null&&G.hasOwnProperty(`onUpdate:${o}`)))}:()=>{var z,L;return e[s],!!((z=g.vnode.props)!=null&&z.hasOwnProperty(s)&&(L=g.vnode.props)!=null&&L.hasOwnProperty(`onUpdate:${s}`))});_f(()=>!E.value,()=>{Ye(()=>e[s],z=>{x.value=z})});const k=ne({get(){return u(E.value?e[s]:x.value)},set(z){const L=d(z);(E.value?e[s]:x.value)===L||u(E.value?e[s]:x.value)===z||(x.value=L,g==null||g.emit(`update:${s}`,L))}});return Object.defineProperty(k,"externalValue",{get:()=>E.value?e[s]:x.value}),k}const kT=Pt({name:"VAppBar",props:{modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...ET(),...sh(),height:{type:[Number,String],default:64}},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=Ke(),d=bn(e,"modelValue"),g=ne(()=>{var z,L;var o,w;const E=(z=(o=u.value)==null?void 0:o.contentHeight)!=null?z:0,k=(L=(w=u.value)==null?void 0:w.extensionHeight)!=null?L:0;return E+k}),{layoutItemStyles:x}=ah({id:e.name,order:ne(()=>parseInt(e.order,10)),position:St(e,"location"),layoutSize:g,elementSize:g,active:d,absolute:St(e,"absolute")});return kt(()=>{const[o]=FP(e);return F(Km,tn({ref:u,class:["v-app-bar",{"v-app-bar--bottom":e.location==="bottom"}],style:{...x.value,height:void 0}},o),a)}),{}}});const NP=[null,"default","comfortable","compact"],mr=Mn({density:{type:String,default:"default",validator:e=>NP.includes(e)}},"density");function Ur(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pa();return{densityClasses:ne(()=>`${s}--density-${e.density}`)}}const UP=["elevated","flat","tonal","outlined","text","plain"];function kc(e,s){return F(On,null,[e&&F("span",{key:"overlay",class:`${s}__overlay`},null),F("span",{key:"underlay",class:`${s}__underlay`},null)])}const Lo=Mn({color:String,variant:{type:String,default:"elevated",validator:e=>UP.includes(e)}},"variant");function Mc(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pa();const a=ne(()=>{const{variant:g}=Ai(e);return`${s}--variant-${g}`}),{colorClasses:u,colorStyles:d}=Wy(ne(()=>{const{variant:g,color:x}=Ai(e);return{[["elevated","flat"].includes(g)?"background":"text"]:x}}));return{colorClasses:u,colorStyles:d,variantClasses:a}}const MT=Pt({name:"VBtnGroup",props:{divided:Boolean,...fo(),...mr(),...or(),...zi(),...wn(),...Xn(),...Lo()},setup(e,s){let{slots:a}=s;const{themeClasses:u}=vi(e),{densityClasses:d}=Ur(e),{borderClasses:g}=zo(e),{elevationClasses:x}=kr(e),{roundedClasses:o}=Yi(e);ir({VBtn:{height:"auto",color:St(e,"color"),density:St(e,"density"),flat:!0,variant:St(e,"variant")}}),kt(()=>F(e.tag,{class:["v-btn-group",{"v-btn-group--divided":e.divided},u.value,g.value,d.value,x.value,o.value]},a))}}),lh=Mn({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),Pc=Mn({value:null,disabled:Boolean,selectedClass:String},"group-item");function ch(e,s){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const u=Ar("useGroupItem");if(!u)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const d=Nr();Ni(Symbol.for(`${s.description}:id`),d);const g=ln(s,null);if(!g){if(!a)return g;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${s.description}`)}const x=St(e,"value"),o=ne(()=>g.disabled.value||e.disabled);g.register({id:d,value:x,disabled:o},u),Ti(()=>{g.unregister(d)});const w=ne(()=>g.isSelected(d)),E=ne(()=>w.value&&[g.selectedClass.value,e.selectedClass]);return Ye(w,k=>{u.emit("group:selected",{value:k})}),{id:d,isSelected:w,toggle:()=>g.select(d,!w.value),select:k=>g.select(d,k),selectedClass:E,value:x,disabled:o,group:g}}function zc(e,s){let a=!1;const u=Qi([]),d=bn(e,"modelValue",[],L=>L==null?[]:PT(u,Ao(L)),L=>{const O=GP(u,L);return e.multiple?O:O[0]}),g=Ar("useGroup");function x(L,O){const G=L,H=Symbol.for(`${s.description}:id`),se=Jd(H,g==null?void 0:g.vnode).indexOf(O);se>-1?u.splice(se,0,G):u.push(G)}function o(L){if(a)return;w();const O=u.findIndex(G=>G.id===L);u.splice(O,1)}function w(){const L=u.find(O=>!O.disabled);L&&e.mandatory==="force"&&!d.value.length&&(d.value=[L.id])}kn(()=>{w()}),Ti(()=>{a=!0});function E(L,O){const G=u.find(H=>H.id===L);if(!(O&&G!=null&&G.disabled))if(e.multiple){const H=d.value.slice(),pe=H.findIndex(he=>he===L),se=~pe;if(O=O!=null?O:!se,se&&e.mandatory&&H.length<=1||!se&&e.max!=null&&H.length+1>e.max)return;pe<0&&O?H.push(L):pe>=0&&!O&&H.splice(pe,1),d.value=H}else{const H=d.value.includes(L);if(e.mandatory&&H)return;d.value=(O!=null?O:!H)?[L]:[]}}function k(L){if(e.multiple&&wc('This method is not supported when using "multiple" prop'),d.value.length){const O=d.value[0],G=u.findIndex(se=>se.id===O);let H=(G+L)%u.length,pe=u[H];for(;pe.disabled&&H!==G;)H=(H+L)%u.length,pe=u[H];if(pe.disabled)return;d.value=[u[H].id]}else{const O=u.find(G=>!G.disabled);O&&(d.value=[O.id])}}const z={register:x,unregister:o,selected:d,select:E,disabled:St(e,"disabled"),prev:()=>k(u.length-1),next:()=>k(1),isSelected:L=>d.value.includes(L),selectedClass:ne(()=>e.selectedClass),items:ne(()=>u),getItemIndex:L=>jP(u,L)};return Ni(s,z),z}function jP(e,s){const a=PT(e,[s]);return a.length?e.findIndex(u=>u.id===a[0]):-1}function PT(e,s){const a=[];for(let u=0;u<e.length;u++){const d=e[u];d.value!=null?s.find(g=>kf(g,d.value))!=null&&a.push(d.id):s.includes(u)&&a.push(d.id)}return a}function GP(e,s){const a=[];for(let u=0;u<e.length;u++){const d=e[u];s.includes(d.id)&&a.push(d.value!=null?d.value:u)}return a}const Hy=Symbol.for("vuetify:v-btn-toggle"),qP=Pi()({name:"VBtnToggle",props:lh(),emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const{isSelected:u,next:d,prev:g,select:x,selected:o}=zc(e,Hy);return kt(()=>{var w;return F(MT,{class:"v-btn-toggle"},{default:()=>[(w=a.default)==null?void 0:w.call(a,{isSelected:u,next:d,prev:g,select:x,selected:o})]})}),{next:d,prev:g,select:x}}});const ZP={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sort:"mdi-arrow-up",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus"},zT={component:e=>Ds(Sg,{...e,class:"mdi"})},pn=[String,Function,Object],j_=Symbol.for("vuetify:icons"),wg=Mn({icon:{type:pn,required:!0},tag:{type:String,required:!0}},"icon"),LT=Pt({name:"VComponentIcon",props:wg(),setup(e){return()=>F(e.tag,null,{default:()=>[F(e.icon,null,null)]})}}),DT=Pt({name:"VSvgIcon",inheritAttrs:!1,props:wg(),setup(e,s){let{attrs:a}=s;return()=>F(e.tag,tn(a,{style:null}),{default:()=>[F("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[F("path",{d:e.icon},null)])]})}}),WP=Pt({name:"VLigatureIcon",props:wg(),setup(e){return()=>F(e.tag,null,{default:()=>[e.icon]})}}),Sg=Pt({name:"VClassIcon",props:wg(),setup(e){return()=>F(e.tag,{class:e.icon},null)}}),HP={svg:{component:DT},class:{component:Sg}};function XP(e){return da({defaultSet:"mdi",sets:{...HP,mdi:zT},aliases:ZP},e)}const YP=e=>{const s=ln(j_);if(!s)throw new Error("Missing Vuetify Icons provide!");return{iconData:ne(()=>{const u=ki(e)?e.value:e.icon;if(!u)throw new Error("Icon value is undefined or null");let d=u;if(typeof u=="string"&&u.includes("$")){var g;d=(g=s.aliases)==null?void 0:g[u.slice(u.indexOf("$")+1)]}if(!d)throw new Error(`Could not find aliased icon "${u}"`);if(typeof d!="string")return{component:LT,icon:d};const x=Object.keys(s.sets).find(E=>typeof d=="string"&&d.startsWith(`${E}:`)),o=x?d.slice(x.length+1):d;return{component:s.sets[x!=null?x:s.defaultSet].component,icon:o}})}},KP=["x-small","small","default","large","x-large"],ga=Mn({size:{type:[String,Number],default:"default"}},"size");function uh(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pa();return Vy(()=>{let a,u;return qm(KP,e.size)?a=`${s}--size-${e.size}`:e.size&&(u={width:Xt(e.size),height:Xt(e.size)}),{sizeClasses:a,sizeStyles:u}})}const JP=Mn({color:String,start:Boolean,end:Boolean,icon:pn,...ga(),...wn({tag:"i"}),...Xn()},"v-icon"),er=Pt({name:"VIcon",props:JP(),setup(e,s){let{attrs:a,slots:u}=s,d;u.default&&(d=ne(()=>{var k,z;const L=(k=u.default)==null?void 0:k.call(u);if(!!L)return(z=nT(L).filter(O=>O.children&&typeof O.children=="string")[0])==null?void 0:z.children}));const{themeClasses:g}=vi(e),{iconData:x}=YP(d||e),{sizeClasses:o}=uh(e),{textColorClasses:w,textColorStyles:E}=no(St(e,"color"));return kt(()=>F(x.value.component,{tag:e.tag,icon:x.value.icon,class:["v-icon","notranslate",g.value,o.value,w.value,{"v-icon--clickable":!!a.onClick,"v-icon--start":e.start,"v-icon--end":e.end}],style:[o.value?void 0:{fontSize:Xt(e.size),height:Xt(e.size),width:Xt(e.size)},E.value],role:a.onClick?"button":void 0,"aria-hidden":!a.onClick},null)),{}}});function Xy(e){const s=Ke(),a=Ke(!1);if(Gy){const u=new IntersectionObserver(d=>{e==null||e(d,u),a.value=!!d.find(g=>g.isIntersecting)});Ti(()=>{u.disconnect()}),Ye(s,(d,g)=>{g&&(u.unobserve(g),a.value=!1),d&&u.observe(d)},{flush:"post"})}return{intersectionRef:s,isIntersecting:a}}const Yy=Pt({name:"VProgressCircular",props:{bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...ga(),...wn({tag:"div"}),...Xn()},setup(e,s){let{slots:a}=s;const u=20,d=2*Math.PI*u,g=Ke(),{themeClasses:x}=vi(e),{sizeClasses:o,sizeStyles:w}=uh(e),{textColorClasses:E,textColorStyles:k}=no(St(e,"color")),{textColorClasses:z,textColorStyles:L}=no(St(e,"bgColor")),{intersectionRef:O,isIntersecting:G}=Xy(),{resizeRef:H,contentRect:pe}=Tc(),se=ne(()=>Math.max(0,Math.min(100,parseFloat(e.modelValue)))),he=ne(()=>Number(e.width)),K=ne(()=>w.value?Number(e.size):pe.value?pe.value.width:Math.max(he.value,32)),Te=ne(()=>u/(1-he.value/K.value)*2),Y=ne(()=>he.value/K.value*Te.value),_e=ne(()=>Xt((100-se.value)/100*d));return Ls(()=>{O.value=g.value,H.value=g.value}),kt(()=>F(e.tag,{ref:g,class:["v-progress-circular",{"v-progress-circular--indeterminate":!!e.indeterminate,"v-progress-circular--visible":G.value,"v-progress-circular--disable-shrink":e.indeterminate==="disable-shrink"},x.value,o.value,E.value],style:[w.value,k.value],role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.indeterminate?void 0:se.value},{default:()=>[F("svg",{style:{transform:`rotate(calc(-90deg + ${Number(e.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${Te.value} ${Te.value}`},[F("circle",{class:["v-progress-circular__underlay",z.value],style:L.value,fill:"transparent",cx:"50%",cy:"50%",r:u,"stroke-width":Y.value,"stroke-dasharray":d,"stroke-dashoffset":0},null),F("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:u,"stroke-width":Y.value,"stroke-dasharray":d,"stroke-dashoffset":_e.value},null)]),a.default&&F("div",{class:"v-progress-circular__content"},[a.default({value:se.value})])]})),{}}});const G_=Symbol("rippleStop"),QP=80;function Hb(e,s){e.style.transform=s,e.style.webkitTransform=s}function u_(e,s){e.style.opacity=`calc(${s} * var(--v-theme-overlay-multiplier))`}function q_(e){return e.constructor.name==="TouchEvent"}function RT(e){return e.constructor.name==="KeyboardEvent"}const ez=function(e,s){var a;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d=0,g=0;if(!RT(e)){const L=s.getBoundingClientRect(),O=q_(e)?e.touches[e.touches.length-1]:e;d=O.clientX-L.left,g=O.clientY-L.top}let x=0,o=.3;(a=s._ripple)!=null&&a.circle?(o=.15,x=s.clientWidth/2,x=u.center?x:x+Math.sqrt((d-x)**2+(g-x)**2)/4):x=Math.sqrt(s.clientWidth**2+s.clientHeight**2)/2;const w=`${(s.clientWidth-x*2)/2}px`,E=`${(s.clientHeight-x*2)/2}px`,k=u.center?w:`${d-x}px`,z=u.center?E:`${g-x}px`;return{radius:x,scale:o,x:k,y:z,centerX:w,centerY:E}},Qm={show(e,s){var a;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(s!=null&&(a=s._ripple)!=null&&a.enabled))return;const d=document.createElement("span"),g=document.createElement("span");d.appendChild(g),d.className="v-ripple__container",u.class&&(d.className+=` ${u.class}`);const{radius:x,scale:o,x:w,y:E,centerX:k,centerY:z}=ez(e,s,u),L=`${x*2}px`;g.className="v-ripple__animation",g.style.width=L,g.style.height=L,s.appendChild(d);const O=window.getComputedStyle(s);O&&O.position==="static"&&(s.style.position="relative",s.dataset.previousPosition="static"),g.classList.add("v-ripple__animation--enter"),g.classList.add("v-ripple__animation--visible"),Hb(g,`translate(${w}, ${E}) scale3d(${o},${o},${o})`),u_(g,0),g.dataset.activated=String(performance.now()),setTimeout(()=>{g.classList.remove("v-ripple__animation--enter"),g.classList.add("v-ripple__animation--in"),Hb(g,`translate(${k}, ${z}) scale3d(1,1,1)`),u_(g,.08)},0)},hide(e){var s;if(!(e!=null&&(s=e._ripple)!=null&&s.enabled))return;const a=e.getElementsByClassName("v-ripple__animation");if(a.length===0)return;const u=a[a.length-1];if(u.dataset.isHiding)return;u.dataset.isHiding="true";const d=performance.now()-Number(u.dataset.activated),g=Math.max(250-d,0);setTimeout(()=>{u.classList.remove("v-ripple__animation--in"),u.classList.add("v-ripple__animation--out"),u_(u,0),setTimeout(()=>{e.getElementsByClassName("v-ripple__animation").length===1&&e.dataset.previousPosition&&(e.style.position=e.dataset.previousPosition,delete e.dataset.previousPosition),u.parentNode&&e.removeChild(u.parentNode)},300)},g)}};function BT(e){return typeof e>"u"||!!e}function yf(e){const s={},a=e.currentTarget;if(!(!(a!=null&&a._ripple)||a._ripple.touched||e[G_])){if(e[G_]=!0,q_(e))a._ripple.touched=!0,a._ripple.isTouch=!0;else if(a._ripple.isTouch)return;if(s.center=a._ripple.centered||RT(e),a._ripple.class&&(s.class=a._ripple.class),q_(e)){if(a._ripple.showTimerCommit)return;a._ripple.showTimerCommit=()=>{Qm.show(e,a,s)},a._ripple.showTimer=window.setTimeout(()=>{var u;a!=null&&(u=a._ripple)!=null&&u.showTimerCommit&&(a._ripple.showTimerCommit(),a._ripple.showTimerCommit=null)},QP)}else Qm.show(e,a,s)}}function Xb(e){e[G_]=!0}function lo(e){const s=e.currentTarget;if(!(!s||!s._ripple)){if(window.clearTimeout(s._ripple.showTimer),e.type==="touchend"&&s._ripple.showTimerCommit){s._ripple.showTimerCommit(),s._ripple.showTimerCommit=null,s._ripple.showTimer=window.setTimeout(()=>{lo(e)});return}window.setTimeout(()=>{s._ripple&&(s._ripple.touched=!1)}),Qm.hide(s)}}function OT(e){const s=e.currentTarget;!s||!s._ripple||(s._ripple.showTimerCommit&&(s._ripple.showTimerCommit=null),window.clearTimeout(s._ripple.showTimer))}let xf=!1;function FT(e){!xf&&(e.keyCode===Pb.enter||e.keyCode===Pb.space)&&(xf=!0,yf(e))}function VT(e){xf=!1,lo(e)}function $T(e){xf&&(xf=!1,lo(e))}function NT(e,s,a){var x;const{value:u,modifiers:d}=s,g=BT(u);if(g||Qm.hide(e),e._ripple=(x=e._ripple)!=null?x:{},e._ripple.enabled=g,e._ripple.centered=d.center,e._ripple.circle=d.circle,R_(u)&&u.class&&(e._ripple.class=u.class),g&&!a){if(d.stop){e.addEventListener("touchstart",Xb,{passive:!0}),e.addEventListener("mousedown",Xb);return}e.addEventListener("touchstart",yf,{passive:!0}),e.addEventListener("touchend",lo,{passive:!0}),e.addEventListener("touchmove",OT,{passive:!0}),e.addEventListener("touchcancel",lo),e.addEventListener("mousedown",yf),e.addEventListener("mouseup",lo),e.addEventListener("mouseleave",lo),e.addEventListener("keydown",FT),e.addEventListener("keyup",VT),e.addEventListener("blur",$T),e.addEventListener("dragstart",lo,{passive:!0})}else!g&&a&&UT(e)}function UT(e){e.removeEventListener("mousedown",yf),e.removeEventListener("touchstart",yf),e.removeEventListener("touchend",lo),e.removeEventListener("touchmove",OT),e.removeEventListener("touchcancel",lo),e.removeEventListener("mouseup",lo),e.removeEventListener("mouseleave",lo),e.removeEventListener("keydown",FT),e.removeEventListener("keyup",VT),e.removeEventListener("dragstart",lo),e.removeEventListener("blur",$T)}function tz(e,s){NT(e,s,!1)}function nz(e){delete e._ripple,UT(e)}function iz(e,s){if(s.value===s.oldValue)return;const a=BT(s.oldValue);NT(e,s,a)}const fl={mounted:tz,unmounted:nz,updated:iz};const rz={badge:"Badge",close:"Close",dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},datePicker:{itemsSelected:"{0} selected",nextMonthAriaLabel:"Next month",nextYearAriaLabel:"Next year",prevMonthAriaLabel:"Previous month",prevYearAriaLabel:"Previous year"},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Goto Page {0}",currentPage:"Page {0}, Current Page",first:"First page",last:"Last page"}},rating:{ariaLabel:{item:"Rating {0} of {1}"}}},Yb="$vuetify.",Kb=(e,s)=>e.replace(/\{(\d+)\}/g,(a,u)=>String(s[+u])),jT=(e,s,a)=>function(u){for(var d=arguments.length,g=new Array(d>1?d-1:0),x=1;x<d;x++)g[x-1]=arguments[x];if(!u.startsWith(Yb))return Kb(u,g);const o=u.replace(Yb,""),w=e.value&&a.value[e.value],E=s.value&&a.value[s.value];let k=D_(w,o,null);return k||(wc(`Translation key "${u}" not found in "${e.value}", trying fallback locale`),k=D_(E,o,null)),k||(V_(`Translation key "${u}" not found in fallback`),k=u),typeof k!="string"&&(V_(`Translation key "${u}" has a non-string value`),k=u),Kb(k,g)};function GT(e,s){return(a,u)=>new Intl.NumberFormat([e.value,s.value],u).format(a)}function h_(e,s,a){var d,g;const u=bn(e,s,(d=e[s])!=null?d:a.value);return u.value=(g=e[s])!=null?g:a.value,Ye(a,x=>{e[s]==null&&(u.value=a.value)}),u}function qT(e){return s=>{const a=h_(s,"locale",e.current),u=h_(s,"fallback",e.fallback),d=h_(s,"messages",e.messages);return{name:"vuetify",current:a,fallback:u,messages:d,t:jT(a,u,d),n:GT(a,u),provide:qT({current:a,fallback:u,messages:d})}}}function oz(e){var d,g;const s=Ke((d=e==null?void 0:e.locale)!=null?d:"en"),a=Ke((g=e==null?void 0:e.fallback)!=null?g:"en"),u=Ke({en:rz,...e==null?void 0:e.messages});return{name:"vuetify",current:s,fallback:a,messages:u,t:jT(s,a,u),n:GT(s,a),provide:qT({current:s,fallback:a,messages:u})}}const sz={af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!1,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1},th=Symbol.for("vuetify:locale");function az(e){return e.name!=null}function lz(e){const s=e!=null&&e.adapter&&az(e==null?void 0:e.adapter)?e==null?void 0:e.adapter:oz(e),a=uz(s,e);return{...s,...a}}function rs(){const e=ln(th);if(!e)throw new Error("[Vuetify] Could not find injected locale instance");return e}function cz(e){const s=ln(th);if(!s)throw new Error("[Vuetify] Could not find injected locale instance");const a=s.provide(e),u=hz(a,s.rtl,e),d={...a,...u};return Ni(th,d),d}function uz(e,s){var d;const a=Ke((d=s==null?void 0:s.rtl)!=null?d:sz),u=ne(()=>{var g;return(g=a.value[e.current.value])!=null?g:!1});return{isRtl:u,rtl:a,rtlClasses:ne(()=>`v-locale--is-${u.value?"rtl":"ltr"}`)}}function hz(e,s,a){const u=ne(()=>{var d,g;return(g=(d=a.rtl)!=null?d:s.value[e.current.value])!=null?g:!1});return{isRtl:u,rtl:s,rtlClasses:ne(()=>`v-locale--is-${u.value?"rtl":"ltr"}`)}}function va(){const e=ln(th);if(!e)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:e.isRtl,rtlClasses:e.rtlClasses}}const Ky=Pt({name:"VProgressLinear",props:{active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,...zi(),...wn(),...Xn()},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=bn(e,"modelValue"),{isRtl:d}=va(),{themeClasses:g}=vi(e),{textColorClasses:x,textColorStyles:o}=no(e,"color"),{backgroundColorClasses:w,backgroundColorStyles:E}=Hi(ne(()=>e.bgColor||e.color)),{backgroundColorClasses:k,backgroundColorStyles:z}=Hi(e,"color"),{roundedClasses:L}=Yi(e),{intersectionRef:O,isIntersecting:G}=Xy(),H=ne(()=>parseInt(e.max,10)),pe=ne(()=>parseInt(e.height,10)),se=ne(()=>parseFloat(e.bufferValue)/H.value*100),he=ne(()=>parseFloat(u.value)/H.value*100),K=ne(()=>d.value!==e.reverse),Te=ne(()=>e.indeterminate?"fade-transition":"slide-x-transition"),Y=ne(()=>e.bgOpacity==null?e.bgOpacity:parseFloat(e.bgOpacity));function _e(de){if(!O.value)return;const{left:ve,right:Se,width:be}=O.value.getBoundingClientRect(),De=K.value?be-de.clientX+(Se-be):de.clientX-ve;u.value=Math.round(De/be*H.value)}return kt(()=>F(e.tag,{ref:O,class:["v-progress-linear",{"v-progress-linear--active":e.active&&G.value,"v-progress-linear--reverse":K.value,"v-progress-linear--rounded":e.rounded,"v-progress-linear--rounded-bar":e.roundedBar,"v-progress-linear--striped":e.striped},L.value,g.value],style:{height:e.active?Xt(pe.value):0,"--v-progress-linear-height":Xt(pe.value)},role:"progressbar","aria-valuemin":"0","aria-valuemax":e.max,"aria-valuenow":e.indeterminate?void 0:he.value,onClick:e.clickable&&_e},{default:()=>[e.stream&&F("div",{key:"stream",class:["v-progress-linear__stream",x.value],style:{...o.value,[K.value?"left":"right"]:Xt(-pe.value),borderTop:`${Xt(pe.value/2)} dotted`,opacity:Y.value,top:`calc(50% - ${Xt(pe.value/4)})`,width:Xt(100-se.value,"%"),"--v-progress-linear-stream-to":Xt(pe.value*(K.value?1:-1))}},null),F("div",{class:["v-progress-linear__background",w.value],style:[E.value,{opacity:Y.value,width:Xt(e.stream?se.value:100,"%")}]},null),F(zs,{name:Te.value},{default:()=>[e.indeterminate?F("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(de=>F("div",{key:de,class:["v-progress-linear__indeterminate",de,k.value],style:z.value},null))]):F("div",{class:["v-progress-linear__determinate",k.value],style:[z.value,{width:Xt(he.value,"%")}]},null)]}),a.default&&F("div",{class:"v-progress-linear__content"},[a.default({value:he.value,buffer:se.value})])]})),{}}}),Jy=Mn({loading:Boolean},"loader");function Tg(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pa();return{loaderClasses:ne(()=>({[`${s}--loading`]:e.loading}))}}function Qy(e,s){var a;let{slots:u}=s;return F("div",{class:`${e.name}__loader`},[((a=u.default)==null?void 0:a.call(u,{color:e.color,isActive:e.active}))||F(Ky,{active:e.active,color:e.color,height:"2",indeterminate:!0},null)])}const Jb={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},Lc=Mn({location:String},"location");function Dc(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=arguments.length>2?arguments[2]:void 0;const{isRtl:u}=va();return{locationStyles:ne(()=>{if(!e.location)return{};const{side:g,align:x}=O_(e.location.split(" ").length>1?e.location:`${e.location} center`,u.value);function o(E){return a?a(E):0}const w={};return g!=="center"&&(s?w[Jb[g]]=`calc(100% - ${o(g)}px)`:w[g]=0),x!=="center"?s?w[Jb[x]]=`calc(100% - ${o(x)}px)`:w[x]=0:(g==="center"?w.top=w.left="50%":w[{top:"left",bottom:"left",left:"top",right:"top"}[g]]="50%",w.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[g]),w})}}const dz=["static","relative","fixed","absolute","sticky"],hh=Mn({position:{type:String,validator:e=>dz.includes(e)}},"position");function dh(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pa();return{positionClasses:ne(()=>e.position?`${s}--${e.position}`:void 0)}}function ZT(){var e,s;return(e=Ar("useRouter"))==null||(s=e.proxy)==null?void 0:s.$router}function Pf(e,s){const a=wk("RouterLink"),u=ne(()=>!!(e.href||e.to)),d=ne(()=>(u==null?void 0:u.value)||!!(s.onClick||s.onClickOnce));if(typeof a=="string")return{isLink:u,isClickable:d,href:St(e,"href")};const g=e.to?a.useLink(e):void 0;return{isLink:u,isClickable:d,route:g==null?void 0:g.route,navigate:g==null?void 0:g.navigate,isActive:g&&ne(()=>{var x,o;return e.exact?(x=g.isExactActive)==null?void 0:x.value:(o=g.isActive)==null?void 0:o.value}),href:ne(()=>e.to?g==null?void 0:g.route.value.href:e.href)}}const fh=Mn({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let d_=!1;function fz(e,s){let a=!1,u,d;Mi&&(Ui(()=>{window.addEventListener("popstate",g),u=e==null?void 0:e.beforeEach((x,o,w)=>{d_?a?s(w):w():setTimeout(()=>a?s(w):w()),d_=!0}),d=e==null?void 0:e.afterEach(()=>{d_=!1})}),Ec(()=>{var x,o;window.removeEventListener("popstate",g),(x=u)==null||x(),(o=d)==null||o()}));function g(x){var o;(o=x.state)!=null&&o.replaced||(a=!0,setTimeout(()=>a=!1))}}function pz(e,s){Ye(()=>{var a;return(a=e.isActive)==null?void 0:a.value},a=>{e.isLink.value&&a&&s&&Ui(()=>{s(!0)})},{immediate:!0})}const bi=Pt({name:"VBtn",directives:{Ripple:fl},props:{active:{type:Boolean,default:void 0},symbol:{type:null,default:Hy},flat:Boolean,icon:[Boolean,String,Function,Object],prependIcon:pn,appendIcon:pn,block:Boolean,stacked:Boolean,ripple:{type:Boolean,default:!0},...fo(),...zi(),...mr(),...ns(),...or(),...Pc(),...Jy(),...Lc(),...hh(),...fh(),...ga(),...wn({tag:"button"}),...Xn(),...Lo({variant:"elevated"})},emits:{"group:selected":e=>!0},setup(e,s){let{attrs:a,slots:u}=s;const{themeClasses:d}=vi(e),{borderClasses:g}=zo(e),{colorClasses:x,colorStyles:o,variantClasses:w}=Mc(e),{densityClasses:E}=Ur(e),{dimensionStyles:k}=is(e),{elevationClasses:z}=kr(e),{loaderClasses:L}=Tg(e),{locationStyles:O}=Dc(e),{positionClasses:G}=dh(e),{roundedClasses:H}=Yi(e),{sizeClasses:pe,sizeStyles:se}=uh(e),he=ch(e,e.symbol,!1),K=Pf(e,a),Te=ne(()=>{var de;return e.active!==!1&&(e.active||((de=K.isActive)==null?void 0:de.value)||(he==null?void 0:he.isSelected.value))}),Y=ne(()=>(he==null?void 0:he.disabled.value)||e.disabled),_e=ne(()=>e.variant==="elevated"&&!(e.disabled||e.flat||e.border));return pz(K,he==null?void 0:he.select),kt(()=>{var de,ve,Se,be;const De=K.isLink.value?"a":e.tag,ze=!he||he.isSelected.value,Je=!!(e.prependIcon||u.prepend),ct=!!(e.appendIcon||u.append),nt=!!(e.icon&&e.icon!==!0);return ji(F(De,{type:De==="a"?void 0:"button",class:["v-btn",he==null?void 0:he.selectedClass.value,{"v-btn--active":Te.value,"v-btn--block":e.block,"v-btn--disabled":Y.value,"v-btn--elevated":_e.value,"v-btn--flat":e.flat,"v-btn--icon":!!e.icon,"v-btn--loading":e.loading,"v-btn--stacked":e.stacked},d.value,g.value,ze?x.value:void 0,E.value,z.value,L.value,G.value,H.value,pe.value,w.value],style:[ze?o.value:void 0,k.value,O.value,se.value],disabled:Y.value||void 0,href:K.href.value,onClick:ft=>{var Pe;Y.value||((Pe=K.navigate)==null||Pe.call(K,ft),he==null||he.toggle())}},{default:()=>{var ft;return[kc(!0,"v-btn"),!e.icon&&Je&&F(wi,{key:"prepend",defaults:{VIcon:{icon:e.prependIcon}}},{default:()=>{var Pe;return[F("span",{class:"v-btn__prepend"},[(Pe=(de=u.prepend)==null?void 0:de.call(u))!=null?Pe:F(er,null,null)])]}}),F("span",{class:"v-btn__content","data-no-activator":""},[F(wi,{key:"content",defaults:{VIcon:{icon:nt?e.icon:void 0}}},{default:()=>{var Pe;return[(Pe=(ve=u.default)==null?void 0:ve.call(u))!=null?Pe:nt&&F(er,{key:"icon"},null)]}})]),!e.icon&&ct&&F(wi,{key:"append",defaults:{VIcon:{icon:e.appendIcon}}},{default:()=>{var Pe;return[F("span",{class:"v-btn__append"},[(Pe=(Se=u.append)==null?void 0:Se.call(u))!=null?Pe:F(er,null,null)])]}}),!!e.loading&&F("span",{key:"loader",class:"v-btn__loader"},[(ft=(be=u.loader)==null?void 0:be.call(u))!=null?ft:F(Yy,{color:typeof e.loading=="boolean"?void 0:e.loading,indeterminate:!0,size:"23",width:"2"},null)])]}}),[[uo("ripple"),!Y.value&&e.ripple,null]])}),{}}}),mz=Pt({name:"VAppBarNavIcon",props:{icon:{type:pn,default:"$menu"}},setup(e,s){let{slots:a}=s;return kt(()=>F(bi,{class:"v-app-bar-nav-icon",icon:e.icon},a)),{}}}),gz=Pt({name:"VToolbarItems",props:Lo({variant:"text"}),setup(e,s){let{slots:a}=s;return ir({VBtn:{color:St(e,"color"),height:"inherit",variant:St(e,"variant")}}),kt(()=>{var u;return F("div",{class:"v-toolbar-items"},[(u=a.default)==null?void 0:u.call(a)])}),{}}}),vz=Pt({name:"VAppBarTitle",props:{...Ym.props},setup(e,s){let{slots:a}=s;return kt(()=>F(Ym,{class:"v-app-bar-title"},a)),{}}}),_z={};function yz(e,s){return Xi(),ts(kT,{color:"#303F9F",elevation:"1",height:"48"})}const xz=Bs(_z,[["render",yz]]);/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Zu=typeof window<"u";function bz(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const gi=Object.assign;function f_(e,s){const a={};for(const u in s){const d=s[u];a[u]=Qo(d)?d.map(e):e(d)}return a}const ef=()=>{},Qo=Array.isArray,wz=/\/$/,Sz=e=>e.replace(wz,"");function p_(e,s,a="/"){let u,d={},g="",x="";const o=s.indexOf("#");let w=s.indexOf("?");return o<w&&o>=0&&(w=-1),w>-1&&(u=s.slice(0,w),g=s.slice(w+1,o>-1?o:s.length),d=e(g)),o>-1&&(u=u||s.slice(0,o),x=s.slice(o,s.length)),u=Iz(u!=null?u:s,a),{fullPath:u+(g&&"?")+g+x,path:u,query:d,hash:x}}function Tz(e,s){const a=s.query?e(s.query):"";return s.path+(a&&"?")+a+(s.hash||"")}function Qb(e,s){return!s||!e.toLowerCase().startsWith(s.toLowerCase())?e:e.slice(s.length)||"/"}function Ez(e,s,a){const u=s.matched.length-1,d=a.matched.length-1;return u>-1&&u===d&&nh(s.matched[u],a.matched[d])&&WT(s.params,a.params)&&e(s.query)===e(a.query)&&s.hash===a.hash}function nh(e,s){return(e.aliasOf||e)===(s.aliasOf||s)}function WT(e,s){if(Object.keys(e).length!==Object.keys(s).length)return!1;for(const a in e)if(!Cz(e[a],s[a]))return!1;return!0}function Cz(e,s){return Qo(e)?ew(e,s):Qo(s)?ew(s,e):e===s}function ew(e,s){return Qo(s)?e.length===s.length&&e.every((a,u)=>a===s[u]):e.length===1&&e[0]===s}function Iz(e,s){if(e.startsWith("/"))return e;if(!e)return s;const a=s.split("/"),u=e.split("/");let d=a.length-1,g,x;for(g=0;g<u.length;g++)if(x=u[g],x!==".")if(x==="..")d>1&&d--;else break;return a.slice(0,d).join("/")+"/"+u.slice(g-(g===u.length?1:0)).join("/")}var bf;(function(e){e.pop="pop",e.push="push"})(bf||(bf={}));var tf;(function(e){e.back="back",e.forward="forward",e.unknown=""})(tf||(tf={}));function Az(e){if(!e)if(Zu){const s=document.querySelector("base");e=s&&s.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Sz(e)}const kz=/^[^#]+#/;function Mz(e,s){return e.replace(kz,"#")+s}function Pz(e,s){const a=document.documentElement.getBoundingClientRect(),u=e.getBoundingClientRect();return{behavior:s.behavior,left:u.left-a.left-(s.left||0),top:u.top-a.top-(s.top||0)}}const Eg=()=>({left:window.pageXOffset,top:window.pageYOffset});function zz(e){let s;if("el"in e){const a=e.el,u=typeof a=="string"&&a.startsWith("#"),d=typeof a=="string"?u?document.getElementById(a.slice(1)):document.querySelector(a):a;if(!d)return;s=Pz(d,e)}else s=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(s):window.scrollTo(s.left!=null?s.left:window.pageXOffset,s.top!=null?s.top:window.pageYOffset)}function tw(e,s){return(history.state?history.state.position-s:-1)+e}const Z_=new Map;function Lz(e,s){Z_.set(e,s)}function Dz(e){const s=Z_.get(e);return Z_.delete(e),s}let Rz=()=>location.protocol+"//"+location.host;function HT(e,s){const{pathname:a,search:u,hash:d}=s,g=e.indexOf("#");if(g>-1){let o=d.includes(e.slice(g))?e.slice(g).length:1,w=d.slice(o);return w[0]!=="/"&&(w="/"+w),Qb(w,"")}return Qb(a,e)+u+d}function Bz(e,s,a,u){let d=[],g=[],x=null;const o=({state:L})=>{const O=HT(e,location),G=a.value,H=s.value;let pe=0;if(L){if(a.value=O,s.value=L,x&&x===G){x=null;return}pe=H?L.position-H.position:0}else u(O);d.forEach(se=>{se(a.value,G,{delta:pe,type:bf.pop,direction:pe?pe>0?tf.forward:tf.back:tf.unknown})})};function w(){x=a.value}function E(L){d.push(L);const O=()=>{const G=d.indexOf(L);G>-1&&d.splice(G,1)};return g.push(O),O}function k(){const{history:L}=window;!L.state||L.replaceState(gi({},L.state,{scroll:Eg()}),"")}function z(){for(const L of g)L();g=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",k)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",k),{pauseListeners:w,listen:E,destroy:z}}function nw(e,s,a,u=!1,d=!1){return{back:e,current:s,forward:a,replaced:u,position:window.history.length,scroll:d?Eg():null}}function Oz(e){const{history:s,location:a}=window,u={value:HT(e,a)},d={value:s.state};d.value||g(u.value,{back:null,current:u.value,forward:null,position:s.length-1,replaced:!0,scroll:null},!0);function g(w,E,k){const z=e.indexOf("#"),L=z>-1?(a.host&&document.querySelector("base")?e:e.slice(z))+w:Rz()+e+w;try{s[k?"replaceState":"pushState"](E,"",L),d.value=E}catch(O){console.error(O),a[k?"replace":"assign"](L)}}function x(w,E){const k=gi({},s.state,nw(d.value.back,w,d.value.forward,!0),E,{position:d.value.position});g(w,k,!0),u.value=w}function o(w,E){const k=gi({},d.value,s.state,{forward:w,scroll:Eg()});g(k.current,k,!0);const z=gi({},nw(u.value,w,null),{position:k.position+1},E);g(w,z,!1),u.value=w}return{location:u,state:d,push:o,replace:x}}function Fz(e){e=Az(e);const s=Oz(e),a=Bz(e,s.state,s.location,s.replace);function u(g,x=!0){x||a.pauseListeners(),history.go(g)}const d=gi({location:"",base:e,go:u,createHref:Mz.bind(null,e)},s,a);return Object.defineProperty(d,"location",{enumerable:!0,get:()=>s.location.value}),Object.defineProperty(d,"state",{enumerable:!0,get:()=>s.state.value}),d}function Vz(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),Fz(e)}function $z(e){return typeof e=="string"||e&&typeof e=="object"}function XT(e){return typeof e=="string"||typeof e=="symbol"}const el={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},YT=Symbol("");var iw;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(iw||(iw={}));function ih(e,s){return gi(new Error,{type:e,[YT]:!0},s)}function oa(e,s){return e instanceof Error&&YT in e&&(s==null||!!(e.type&s))}const rw="[^/]+?",Nz={sensitive:!1,strict:!1,start:!0,end:!0},Uz=/[.+*?^${}()[\]/\\]/g;function jz(e,s){const a=gi({},Nz,s),u=[];let d=a.start?"^":"";const g=[];for(const E of e){const k=E.length?[]:[90];a.strict&&!E.length&&(d+="/");for(let z=0;z<E.length;z++){const L=E[z];let O=40+(a.sensitive?.25:0);if(L.type===0)z||(d+="/"),d+=L.value.replace(Uz,"\\$&"),O+=40;else if(L.type===1){const{value:G,repeatable:H,optional:pe,regexp:se}=L;g.push({name:G,repeatable:H,optional:pe});const he=se||rw;if(he!==rw){O+=10;try{new RegExp(`(${he})`)}catch(Te){throw new Error(`Invalid custom RegExp for param "${G}" (${he}): `+Te.message)}}let K=H?`((?:${he})(?:/(?:${he}))*)`:`(${he})`;z||(K=pe&&E.length<2?`(?:/${K})`:"/"+K),pe&&(K+="?"),d+=K,O+=20,pe&&(O+=-8),H&&(O+=-20),he===".*"&&(O+=-50)}k.push(O)}u.push(k)}if(a.strict&&a.end){const E=u.length-1;u[E][u[E].length-1]+=.7000000000000001}a.strict||(d+="/?"),a.end?d+="$":a.strict&&(d+="(?:/|$)");const x=new RegExp(d,a.sensitive?"":"i");function o(E){const k=E.match(x),z={};if(!k)return null;for(let L=1;L<k.length;L++){const O=k[L]||"",G=g[L-1];z[G.name]=O&&G.repeatable?O.split("/"):O}return z}function w(E){let k="",z=!1;for(const L of e){(!z||!k.endsWith("/"))&&(k+="/"),z=!1;for(const O of L)if(O.type===0)k+=O.value;else if(O.type===1){const{value:G,repeatable:H,optional:pe}=O,se=G in E?E[G]:"";if(Qo(se)&&!H)throw new Error(`Provided param "${G}" is an array but it is not repeatable (* or + modifiers)`);const he=Qo(se)?se.join("/"):se;if(!he)if(pe)L.length<2&&(k.endsWith("/")?k=k.slice(0,-1):z=!0);else throw new Error(`Missing required param "${G}"`);k+=he}}return k||"/"}return{re:x,score:u,keys:g,parse:o,stringify:w}}function Gz(e,s){let a=0;for(;a<e.length&&a<s.length;){const u=s[a]-e[a];if(u)return u;a++}return e.length<s.length?e.length===1&&e[0]===40+40?-1:1:e.length>s.length?s.length===1&&s[0]===40+40?1:-1:0}function qz(e,s){let a=0;const u=e.score,d=s.score;for(;a<u.length&&a<d.length;){const g=Gz(u[a],d[a]);if(g)return g;a++}if(Math.abs(d.length-u.length)===1){if(ow(u))return 1;if(ow(d))return-1}return d.length-u.length}function ow(e){const s=e[e.length-1];return e.length>0&&s[s.length-1]<0}const Zz={type:0,value:""},Wz=/[a-zA-Z0-9_]/;function Hz(e){if(!e)return[[]];if(e==="/")return[[Zz]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function s(O){throw new Error(`ERR (${a})/"${E}": ${O}`)}let a=0,u=a;const d=[];let g;function x(){g&&d.push(g),g=[]}let o=0,w,E="",k="";function z(){!E||(a===0?g.push({type:0,value:E}):a===1||a===2||a===3?(g.length>1&&(w==="*"||w==="+")&&s(`A repeatable param (${E}) must be alone in its segment. eg: '/:ids+.`),g.push({type:1,value:E,regexp:k,repeatable:w==="*"||w==="+",optional:w==="*"||w==="?"})):s("Invalid state to consume buffer"),E="")}function L(){E+=w}for(;o<e.length;){if(w=e[o++],w==="\\"&&a!==2){u=a,a=4;continue}switch(a){case 0:w==="/"?(E&&z(),x()):w===":"?(z(),a=1):L();break;case 4:L(),a=u;break;case 1:w==="("?a=2:Wz.test(w)?L():(z(),a=0,w!=="*"&&w!=="?"&&w!=="+"&&o--);break;case 2:w===")"?k[k.length-1]=="\\"?k=k.slice(0,-1)+w:a=3:k+=w;break;case 3:z(),a=0,w!=="*"&&w!=="?"&&w!=="+"&&o--,k="";break;default:s("Unknown state");break}}return a===2&&s(`Unfinished custom RegExp for param "${E}"`),z(),x(),d}function Xz(e,s,a){const u=jz(Hz(e.path),a),d=gi(u,{record:e,parent:s,children:[],alias:[]});return s&&!d.record.aliasOf==!s.record.aliasOf&&s.children.push(d),d}function Yz(e,s){const a=[],u=new Map;s=lw({strict:!1,end:!0,sensitive:!1},s);function d(k){return u.get(k)}function g(k,z,L){const O=!L,G=Kz(k);G.aliasOf=L&&L.record;const H=lw(s,k),pe=[G];if("alias"in k){const K=typeof k.alias=="string"?[k.alias]:k.alias;for(const Te of K)pe.push(gi({},G,{components:L?L.record.components:G.components,path:Te,aliasOf:L?L.record:G}))}let se,he;for(const K of pe){const{path:Te}=K;if(z&&Te[0]!=="/"){const Y=z.record.path,_e=Y[Y.length-1]==="/"?"":"/";K.path=z.record.path+(Te&&_e+Te)}if(se=Xz(K,z,H),L?L.alias.push(se):(he=he||se,he!==se&&he.alias.push(se),O&&k.name&&!aw(se)&&x(k.name)),G.children){const Y=G.children;for(let _e=0;_e<Y.length;_e++)g(Y[_e],se,L&&L.children[_e])}L=L||se,(se.record.components&&Object.keys(se.record.components).length||se.record.name||se.record.redirect)&&w(se)}return he?()=>{x(he)}:ef}function x(k){if(XT(k)){const z=u.get(k);z&&(u.delete(k),a.splice(a.indexOf(z),1),z.children.forEach(x),z.alias.forEach(x))}else{const z=a.indexOf(k);z>-1&&(a.splice(z,1),k.record.name&&u.delete(k.record.name),k.children.forEach(x),k.alias.forEach(x))}}function o(){return a}function w(k){let z=0;for(;z<a.length&&qz(k,a[z])>=0&&(k.record.path!==a[z].record.path||!KT(k,a[z]));)z++;a.splice(z,0,k),k.record.name&&!aw(k)&&u.set(k.record.name,k)}function E(k,z){let L,O={},G,H;if("name"in k&&k.name){if(L=u.get(k.name),!L)throw ih(1,{location:k});H=L.record.name,O=gi(sw(z.params,L.keys.filter(he=>!he.optional).map(he=>he.name)),k.params&&sw(k.params,L.keys.map(he=>he.name))),G=L.stringify(O)}else if("path"in k)G=k.path,L=a.find(he=>he.re.test(G)),L&&(O=L.parse(G),H=L.record.name);else{if(L=z.name?u.get(z.name):a.find(he=>he.re.test(z.path)),!L)throw ih(1,{location:k,currentLocation:z});H=L.record.name,O=gi({},z.params,k.params),G=L.stringify(O)}const pe=[];let se=L;for(;se;)pe.unshift(se.record),se=se.parent;return{name:H,path:G,params:O,matched:pe,meta:Qz(pe)}}return e.forEach(k=>g(k)),{addRoute:g,resolve:E,removeRoute:x,getRoutes:o,getRecordMatcher:d}}function sw(e,s){const a={};for(const u of s)u in e&&(a[u]=e[u]);return a}function Kz(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:Jz(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function Jz(e){const s={},a=e.props||!1;if("component"in e)s.default=a;else for(const u in e.components)s[u]=typeof a=="boolean"?a:a[u];return s}function aw(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Qz(e){return e.reduce((s,a)=>gi(s,a.meta),{})}function lw(e,s){const a={};for(const u in e)a[u]=u in s?s[u]:e[u];return a}function KT(e,s){return s.children.some(a=>a===e||KT(e,a))}const JT=/#/g,eL=/&/g,tL=/\//g,nL=/=/g,iL=/\?/g,QT=/\+/g,rL=/%5B/g,oL=/%5D/g,e2=/%5E/g,sL=/%60/g,t2=/%7B/g,aL=/%7C/g,n2=/%7D/g,lL=/%20/g;function e0(e){return encodeURI(""+e).replace(aL,"|").replace(rL,"[").replace(oL,"]")}function cL(e){return e0(e).replace(t2,"{").replace(n2,"}").replace(e2,"^")}function W_(e){return e0(e).replace(QT,"%2B").replace(lL,"+").replace(JT,"%23").replace(eL,"%26").replace(sL,"`").replace(t2,"{").replace(n2,"}").replace(e2,"^")}function uL(e){return W_(e).replace(nL,"%3D")}function hL(e){return e0(e).replace(JT,"%23").replace(iL,"%3F")}function dL(e){return e==null?"":hL(e).replace(tL,"%2F")}function eg(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function fL(e){const s={};if(e===""||e==="?")return s;const u=(e[0]==="?"?e.slice(1):e).split("&");for(let d=0;d<u.length;++d){const g=u[d].replace(QT," "),x=g.indexOf("="),o=eg(x<0?g:g.slice(0,x)),w=x<0?null:eg(g.slice(x+1));if(o in s){let E=s[o];Qo(E)||(E=s[o]=[E]),E.push(w)}else s[o]=w}return s}function cw(e){let s="";for(let a in e){const u=e[a];if(a=uL(a),u==null){u!==void 0&&(s+=(s.length?"&":"")+a);continue}(Qo(u)?u.map(g=>g&&W_(g)):[u&&W_(u)]).forEach(g=>{g!==void 0&&(s+=(s.length?"&":"")+a,g!=null&&(s+="="+g))})}return s}function pL(e){const s={};for(const a in e){const u=e[a];u!==void 0&&(s[a]=Qo(u)?u.map(d=>d==null?null:""+d):u==null?u:""+u)}return s}const mL=Symbol(""),uw=Symbol(""),Cg=Symbol(""),i2=Symbol(""),H_=Symbol("");function Nd(){let e=[];function s(u){return e.push(u),()=>{const d=e.indexOf(u);d>-1&&e.splice(d,1)}}function a(){e=[]}return{add:s,list:()=>e,reset:a}}function il(e,s,a,u,d){const g=u&&(u.enterCallbacks[d]=u.enterCallbacks[d]||[]);return()=>new Promise((x,o)=>{const w=z=>{z===!1?o(ih(4,{from:a,to:s})):z instanceof Error?o(z):$z(z)?o(ih(2,{from:s,to:z})):(g&&u.enterCallbacks[d]===g&&typeof z=="function"&&g.push(z),x())},E=e.call(u&&u.instances[d],s,a,w);let k=Promise.resolve(E);e.length<3&&(k=k.then(w)),k.catch(z=>o(z))})}function m_(e,s,a,u){const d=[];for(const g of e)for(const x in g.components){let o=g.components[x];if(!(s!=="beforeRouteEnter"&&!g.instances[x]))if(gL(o)){const E=(o.__vccOpts||o)[s];E&&d.push(il(E,a,u,g,x))}else{let w=o();d.push(()=>w.then(E=>{if(!E)return Promise.reject(new Error(`Couldn't resolve component "${x}" at "${g.path}"`));const k=bz(E)?E.default:E;g.components[x]=k;const L=(k.__vccOpts||k)[s];return L&&il(L,a,u,g,x)()}))}}return d}function gL(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function hw(e){const s=ln(Cg),a=ln(i2),u=ne(()=>s.resolve(Ai(e.to))),d=ne(()=>{const{matched:w}=u.value,{length:E}=w,k=w[E-1],z=a.matched;if(!k||!z.length)return-1;const L=z.findIndex(nh.bind(null,k));if(L>-1)return L;const O=dw(w[E-2]);return E>1&&dw(k)===O&&z[z.length-1].path!==O?z.findIndex(nh.bind(null,w[E-2])):L}),g=ne(()=>d.value>-1&&xL(a.params,u.value.params)),x=ne(()=>d.value>-1&&d.value===a.matched.length-1&&WT(a.params,u.value.params));function o(w={}){return yL(w)?s[Ai(e.replace)?"replace":"push"](Ai(e.to)).catch(ef):Promise.resolve()}return{route:u,href:ne(()=>u.value.href),isActive:g,isExactActive:x,navigate:o}}const vL=Ln({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:hw,setup(e,{slots:s}){const a=Qi(hw(e)),{options:u}=ln(Cg),d=ne(()=>({[fw(e.activeClass,u.linkActiveClass,"router-link-active")]:a.isActive,[fw(e.exactActiveClass,u.linkExactActiveClass,"router-link-exact-active")]:a.isExactActive}));return()=>{const g=s.default&&s.default(a);return e.custom?g:Ds("a",{"aria-current":a.isExactActive?e.ariaCurrentValue:null,href:a.href,onClick:a.navigate,class:d.value},g)}}}),_L=vL;function yL(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const s=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(s))return}return e.preventDefault&&e.preventDefault(),!0}}function xL(e,s){for(const a in s){const u=s[a],d=e[a];if(typeof u=="string"){if(u!==d)return!1}else if(!Qo(d)||d.length!==u.length||u.some((g,x)=>g!==d[x]))return!1}return!0}function dw(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const fw=(e,s,a)=>e!=null?e:s!=null?s:a,bL=Ln({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:s,slots:a}){const u=ln(H_),d=ne(()=>e.route||u.value),g=ln(uw,0),x=ne(()=>{let E=Ai(g);const{matched:k}=d.value;let z;for(;(z=k[E])&&!z.components;)E++;return E}),o=ne(()=>d.value.matched[x.value]);Ni(uw,ne(()=>x.value+1)),Ni(mL,o),Ni(H_,d);const w=Ke();return Ye(()=>[w.value,o.value,e.name],([E,k,z],[L,O,G])=>{k&&(k.instances[z]=E,O&&O!==k&&E&&E===L&&(k.leaveGuards.size||(k.leaveGuards=O.leaveGuards),k.updateGuards.size||(k.updateGuards=O.updateGuards))),E&&k&&(!O||!nh(k,O)||!L)&&(k.enterCallbacks[z]||[]).forEach(H=>H(E))},{flush:"post"}),()=>{const E=d.value,k=e.name,z=o.value,L=z&&z.components[k];if(!L)return pw(a.default,{Component:L,route:E});const O=z.props[k],G=O?O===!0?E.params:typeof O=="function"?O(E):O:null,pe=Ds(L,gi({},G,s,{onVnodeUnmounted:se=>{se.component.isUnmounted&&(z.instances[k]=null)},ref:w}));return pw(a.default,{Component:pe,route:E})||pe}}});function pw(e,s){if(!e)return null;const a=e(s);return a.length===1?a[0]:a}const wL=bL;function SL(e){const s=Yz(e.routes,e),a=e.parseQuery||fL,u=e.stringifyQuery||cw,d=e.history,g=Nd(),x=Nd(),o=Nd(),w=Si(el);let E=el;Zu&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const k=f_.bind(null,Qe=>""+Qe),z=f_.bind(null,dL),L=f_.bind(null,eg);function O(Qe,xt){let Tt,Nt;return XT(Qe)?(Tt=s.getRecordMatcher(Qe),Nt=xt):Nt=Qe,s.addRoute(Nt,Tt)}function G(Qe){const xt=s.getRecordMatcher(Qe);xt&&s.removeRoute(xt)}function H(){return s.getRoutes().map(Qe=>Qe.record)}function pe(Qe){return!!s.getRecordMatcher(Qe)}function se(Qe,xt){if(xt=gi({},xt||w.value),typeof Qe=="string"){const ue=p_(a,Qe,xt.path),Me=s.resolve({path:ue.path},xt),qe=d.createHref(ue.fullPath);return gi(ue,Me,{params:L(Me.params),hash:eg(ue.hash),redirectedFrom:void 0,href:qe})}let Tt;if("path"in Qe)Tt=gi({},Qe,{path:p_(a,Qe.path,xt.path).path});else{const ue=gi({},Qe.params);for(const Me in ue)ue[Me]==null&&delete ue[Me];Tt=gi({},Qe,{params:z(Qe.params)}),xt.params=z(xt.params)}const Nt=s.resolve(Tt,xt),fn=Qe.hash||"";Nt.params=k(L(Nt.params));const Dn=Tz(u,gi({},Qe,{hash:cL(fn),path:Nt.path})),gn=d.createHref(Dn);return gi({fullPath:Dn,hash:fn,query:u===cw?pL(Qe.query):Qe.query||{}},Nt,{redirectedFrom:void 0,href:gn})}function he(Qe){return typeof Qe=="string"?p_(a,Qe,w.value.path):gi({},Qe)}function K(Qe,xt){if(E!==Qe)return ih(8,{from:xt,to:Qe})}function Te(Qe){return de(Qe)}function Y(Qe){return Te(gi(he(Qe),{replace:!0}))}function _e(Qe){const xt=Qe.matched[Qe.matched.length-1];if(xt&&xt.redirect){const{redirect:Tt}=xt;let Nt=typeof Tt=="function"?Tt(Qe):Tt;return typeof Nt=="string"&&(Nt=Nt.includes("?")||Nt.includes("#")?Nt=he(Nt):{path:Nt},Nt.params={}),gi({query:Qe.query,hash:Qe.hash,params:"path"in Nt?{}:Qe.params},Nt)}}function de(Qe,xt){const Tt=E=se(Qe),Nt=w.value,fn=Qe.state,Dn=Qe.force,gn=Qe.replace===!0,ue=_e(Tt);if(ue)return de(gi(he(ue),{state:typeof ue=="object"?gi({},fn,ue.state):fn,force:Dn,replace:gn}),xt||Tt);const Me=Tt;Me.redirectedFrom=xt;let qe;return!Dn&&Ez(u,Nt,Tt)&&(qe=ih(16,{to:Me,from:Nt}),pt(Nt,Nt,!0,!1)),(qe?Promise.resolve(qe):Se(Me,Nt)).catch(st=>oa(st)?oa(st,2)?st:jt(st):Pe(st,Me,Nt)).then(st=>{if(st){if(oa(st,2))return de(gi({replace:gn},he(st.to),{state:typeof st.to=="object"?gi({},fn,st.to.state):fn,force:Dn}),xt||Me)}else st=De(Me,Nt,!0,gn,fn);return be(Me,Nt,st),st})}function ve(Qe,xt){const Tt=K(Qe,xt);return Tt?Promise.reject(Tt):Promise.resolve()}function Se(Qe,xt){let Tt;const[Nt,fn,Dn]=TL(Qe,xt);Tt=m_(Nt.reverse(),"beforeRouteLeave",Qe,xt);for(const ue of Nt)ue.leaveGuards.forEach(Me=>{Tt.push(il(Me,Qe,xt))});const gn=ve.bind(null,Qe,xt);return Tt.push(gn),ju(Tt).then(()=>{Tt=[];for(const ue of g.list())Tt.push(il(ue,Qe,xt));return Tt.push(gn),ju(Tt)}).then(()=>{Tt=m_(fn,"beforeRouteUpdate",Qe,xt);for(const ue of fn)ue.updateGuards.forEach(Me=>{Tt.push(il(Me,Qe,xt))});return Tt.push(gn),ju(Tt)}).then(()=>{Tt=[];for(const ue of Qe.matched)if(ue.beforeEnter&&!xt.matched.includes(ue))if(Qo(ue.beforeEnter))for(const Me of ue.beforeEnter)Tt.push(il(Me,Qe,xt));else Tt.push(il(ue.beforeEnter,Qe,xt));return Tt.push(gn),ju(Tt)}).then(()=>(Qe.matched.forEach(ue=>ue.enterCallbacks={}),Tt=m_(Dn,"beforeRouteEnter",Qe,xt),Tt.push(gn),ju(Tt))).then(()=>{Tt=[];for(const ue of x.list())Tt.push(il(ue,Qe,xt));return Tt.push(gn),ju(Tt)}).catch(ue=>oa(ue,8)?ue:Promise.reject(ue))}function be(Qe,xt,Tt){for(const Nt of o.list())Nt(Qe,xt,Tt)}function De(Qe,xt,Tt,Nt,fn){const Dn=K(Qe,xt);if(Dn)return Dn;const gn=xt===el,ue=Zu?history.state:{};Tt&&(Nt||gn?d.replace(Qe.fullPath,gi({scroll:gn&&ue&&ue.scroll},fn)):d.push(Qe.fullPath,fn)),w.value=Qe,pt(Qe,xt,Tt,gn),jt()}let ze;function Je(){ze||(ze=d.listen((Qe,xt,Tt)=>{if(!At.listening)return;const Nt=se(Qe),fn=_e(Nt);if(fn){de(gi(fn,{replace:!0}),Nt).catch(ef);return}E=Nt;const Dn=w.value;Zu&&Lz(tw(Dn.fullPath,Tt.delta),Eg()),Se(Nt,Dn).catch(gn=>oa(gn,12)?gn:oa(gn,2)?(de(gn.to,Nt).then(ue=>{oa(ue,20)&&!Tt.delta&&Tt.type===bf.pop&&d.go(-1,!1)}).catch(ef),Promise.reject()):(Tt.delta&&d.go(-Tt.delta,!1),Pe(gn,Nt,Dn))).then(gn=>{gn=gn||De(Nt,Dn,!1),gn&&(Tt.delta&&!oa(gn,8)?d.go(-Tt.delta,!1):Tt.type===bf.pop&&oa(gn,20)&&d.go(-1,!1)),be(Nt,Dn,gn)}).catch(ef)}))}let ct=Nd(),nt=Nd(),ft;function Pe(Qe,xt,Tt){jt(Qe);const Nt=nt.list();return Nt.length?Nt.forEach(fn=>fn(Qe,xt,Tt)):console.error(Qe),Promise.reject(Qe)}function at(){return ft&&w.value!==el?Promise.resolve():new Promise((Qe,xt)=>{ct.add([Qe,xt])})}function jt(Qe){return ft||(ft=!Qe,Je(),ct.list().forEach(([xt,Tt])=>Qe?Tt(Qe):xt()),ct.reset()),Qe}function pt(Qe,xt,Tt,Nt){const{scrollBehavior:fn}=e;if(!Zu||!fn)return Promise.resolve();const Dn=!Tt&&Dz(tw(Qe.fullPath,0))||(Nt||!Tt)&&history.state&&history.state.scroll||null;return Ui().then(()=>fn(Qe,xt,Dn)).then(gn=>gn&&zz(gn)).catch(gn=>Pe(gn,Qe,xt))}const zt=Qe=>d.go(Qe);let Gt;const zn=new Set,At={currentRoute:w,listening:!0,addRoute:O,removeRoute:G,hasRoute:pe,getRoutes:H,resolve:se,options:e,push:Te,replace:Y,go:zt,back:()=>zt(-1),forward:()=>zt(1),beforeEach:g.add,beforeResolve:x.add,afterEach:o.add,onError:nt.add,isReady:at,install(Qe){const xt=this;Qe.component("RouterLink",_L),Qe.component("RouterView",wL),Qe.config.globalProperties.$router=xt,Object.defineProperty(Qe.config.globalProperties,"$route",{enumerable:!0,get:()=>Ai(w)}),Zu&&!Gt&&w.value===el&&(Gt=!0,Te(d.location).catch(fn=>{}));const Tt={};for(const fn in el)Tt[fn]=ne(()=>w.value[fn]);Qe.provide(Cg,xt),Qe.provide(i2,Qi(Tt)),Qe.provide(H_,w);const Nt=Qe.unmount;zn.add(Qe),Qe.unmount=function(){zn.delete(Qe),zn.size<1&&(E=el,ze&&ze(),ze=null,w.value=el,Gt=!1,ft=!1),Nt()}}};return At}function ju(e){return e.reduce((s,a)=>s.then(()=>a()),Promise.resolve())}function TL(e,s){const a=[],u=[],d=[],g=Math.max(s.matched.length,e.matched.length);for(let x=0;x<g;x++){const o=s.matched[x];o&&(e.matched.find(E=>nh(E,o))?u.push(o):a.push(o));const w=e.matched[x];w&&(s.matched.find(E=>nh(E,w))||d.push(w))}return[a,u,d]}function EL(){return ln(Cg)}const X_=Symbol.for("vuetify:display"),mw={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},CL=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mw;return da(mw,e)};function gw(e){return Mi&&!e?window.innerWidth:0}function vw(e){return Mi&&!e?window.innerHeight:0}function IL(){const e=Mi?window.navigator.userAgent:"ssr";function s(G){return Boolean(e.match(G))}const a=s(/android/i),u=s(/iphone|ipad|ipod/i),d=s(/cordova/i),g=s(/electron/i),x=s(/chrome/i),o=s(/edge/i),w=s(/firefox/i),E=s(/opera/i),k=s(/win/i),z=s(/mac/i),L=s(/linux/i),O=s(/ssr/i);return{android:a,ios:u,cordova:d,electron:g,chrome:x,edge:o,firefox:w,opera:E,win:k,mac:z,linux:L,touch:dP,ssr:O}}function AL(e,s){const{thresholds:a,mobileBreakpoint:u}=CL(e),d=Ke(vw(s)),g=IL(),x=Qi({}),o=Ke(gw(s));function w(){d.value=vw(),o.value=gw()}return Ls(()=>{const E=o.value<a.sm,k=o.value<a.md&&!E,z=o.value<a.lg&&!(k||E),L=o.value<a.xl&&!(z||k||E),O=o.value<a.xxl&&!(L||z||k||E),G=o.value>=a.xxl,H=E?"xs":k?"sm":z?"md":L?"lg":O?"xl":"xxl",pe=typeof u=="number"?u:a[u],se=g.ssr?g.android||g.ios||g.opera:o.value<pe;x.xs=E,x.sm=k,x.md=z,x.lg=L,x.xl=O,x.xxl=G,x.smAndUp=!E,x.mdAndUp=!(E||k),x.lgAndUp=!(E||k||z),x.xlAndUp=!(E||k||z||L),x.smAndDown=!(z||L||O||G),x.mdAndDown=!(L||O||G),x.lgAndDown=!(O||G),x.xlAndDown=!G,x.name=H,x.height=d.value,x.width=o.value,x.mobile=se,x.mobileBreakpoint=u,x.platform=g,x.thresholds=a}),Mi&&window.addEventListener("resize",w,{passive:!0}),{...Cy(x),update:w}}function Ig(){const e=ln(X_);if(!e)throw new Error("Could not find Vuetify display injection");return e}function t0(){const e=Ke(!1);return kn(()=>{window.requestAnimationFrame(()=>{e.value=!0})}),{ssrBootStyles:ne(()=>e.value?void 0:{transition:"none !important"}),isBooted:If(e)}}function kL(e){let{rootEl:s,isSticky:a,layoutItemStyles:u}=e;const d=Ke(!1),g=Ke(0),x=ne(()=>{const E=typeof d.value=="boolean"?"top":d.value;return[a.value?{top:"auto",bottom:"auto",height:void 0}:void 0,d.value?{[E]:Xt(g.value)}:{top:u.value.top}]});kn(()=>{Ye(a,E=>{E?window.addEventListener("scroll",w,{passive:!0}):window.removeEventListener("scroll",w)},{immediate:!0})}),Ti(()=>{document.removeEventListener("scroll",w)});let o=0;function w(){var G;const E=o>window.scrollY?"up":"down",k=s.value.getBoundingClientRect(),z=parseFloat((G=u.value.top)!=null?G:0),L=window.scrollY-Math.max(0,g.value-z),O=k.height+Math.max(g.value,z)-window.scrollY-window.innerHeight;k.height<window.innerHeight-z?(d.value="top",g.value=z):E==="up"&&d.value==="bottom"||E==="down"&&d.value==="top"?(g.value=window.scrollY+k.top,d.value=!0):E==="down"&&O<=0?(g.value=0,d.value="bottom"):E==="up"&&L<=0&&(g.value=k.top+L,d.value="top"),o=window.scrollY}return{isStuck:d,stickyStyles:x}}const ML=100,PL=20;function _w(e){const s=1.41421356237;return(e<0?-1:1)*Math.sqrt(Math.abs(e))*s}function yw(e){if(e.length<2)return 0;if(e.length===2)return e[1].t===e[0].t?0:(e[1].d-e[0].d)/(e[1].t-e[0].t);let s=0;for(let a=e.length-1;a>0;a--){if(e[a].t===e[a-1].t)continue;const u=_w(s),d=(e[a].d-e[a-1].d)/(e[a].t-e[a-1].t);s+=(d-u)*Math.abs(d),a===e.length-1&&(s*=.5)}return _w(s)*1e3}function zL(){const e={};function s(d){Array.from(d.changedTouches).forEach(g=>{var o;((o=e[g.identifier])!=null?o:e[g.identifier]=new NM(PL)).push([d.timeStamp,g])})}function a(d){Array.from(d.changedTouches).forEach(g=>{delete e[g.identifier]})}function u(d){var g;const x=(g=e[d])==null?void 0:g.values().reverse();if(!x)throw new Error(`No samples for touch id ${d}`);const o=x[0],w=[],E=[];for(const k of x){if(o[0]-k[0]>ML)break;w.push({t:k[0],d:k[1].clientX}),E.push({t:k[0],d:k[1].clientY})}return{x:yw(w),y:yw(E),get direction(){const{x:k,y:z}=this,[L,O]=[Math.abs(k),Math.abs(z)];return L>O&&k>=0?"right":L>O&&k<=0?"left":O>L&&z>=0?"down":O>L&&z<=0?"up":LL()}}}return{addMovement:s,endTouch:a,getVelocity:u}}function LL(){throw new Error}function DL(e){let{isActive:s,isTemporary:a,width:u,touchless:d,position:g}=e;kn(()=>{window.addEventListener("touchstart",se,{passive:!0}),window.addEventListener("touchmove",he,{passive:!1}),window.addEventListener("touchend",K,{passive:!0})}),Ti(()=>{window.removeEventListener("touchstart",se),window.removeEventListener("touchmove",he),window.removeEventListener("touchend",K)});const x=ne(()=>g.value!=="bottom"),{addMovement:o,endTouch:w,getVelocity:E}=zL();let k=!1;const z=Ke(!1),L=Ke(0),O=Ke(0);let G;function H(Y,_e){return(g.value==="left"?Y:g.value==="right"?document.documentElement.clientWidth-Y:g.value==="bottom"?document.documentElement.clientHeight-Y:Gu())-(_e?u.value:0)}function pe(Y){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const de=g.value==="left"?(Y-O.value)/u.value:g.value==="right"?(document.documentElement.clientWidth-Y-O.value)/u.value:g.value==="bottom"?(document.documentElement.clientHeight-Y-O.value)/u.value:Gu();return _e?Math.max(0,Math.min(1,de)):de}function se(Y){if(d.value)return;const _e=Y.changedTouches[0].clientX,de=Y.changedTouches[0].clientY,ve=25,Se=g.value==="left"?_e<ve:g.value==="right"?_e>document.documentElement.clientWidth-ve:g.value==="bottom"?de>document.documentElement.clientHeight-ve:Gu(),be=s.value&&(g.value==="left"?_e<u.value:g.value==="right"?_e>document.documentElement.clientWidth-u.value:g.value==="bottom"?de>document.documentElement.clientHeight-u.value:Gu());(Se||be||s.value&&a.value)&&(k=!0,G=[_e,de],O.value=H(x.value?_e:de,s.value),L.value=pe(x.value?_e:de),w(Y),o(Y))}function he(Y){const _e=Y.changedTouches[0].clientX,de=Y.changedTouches[0].clientY;if(k){if(!Y.cancelable){k=!1;return}const Se=Math.abs(_e-G[0]),be=Math.abs(de-G[1]);(x.value?Se>be&&Se>3:be>Se&&be>3)?(z.value=!0,k=!1):(x.value?be:Se)>3&&(k=!1)}if(!z.value)return;Y.preventDefault(),o(Y);const ve=pe(x.value?_e:de,!1);L.value=Math.max(0,Math.min(1,ve)),ve>1?O.value=H(x.value?_e:de,!0):ve<0&&(O.value=H(x.value?_e:de,!1))}function K(Y){if(k=!1,!z.value)return;o(Y),z.value=!1;const _e=E(Y.changedTouches[0].identifier),de=Math.abs(_e.x),ve=Math.abs(_e.y);(x.value?de>ve&&de>400:ve>de&&ve>3)?s.value=_e.direction===({left:"right",right:"left",bottom:"up"}[g.value]||Gu()):s.value=L.value>.5}const Te=ne(()=>z.value?{transform:g.value==="left"?`translateX(calc(-100% + ${L.value*u.value}px))`:g.value==="right"?`translateX(calc(100% - ${L.value*u.value}px))`:g.value==="bottom"?`translateY(calc(100% - ${L.value*u.value}px))`:Gu(),transition:"none"}:void 0);return{isDragging:z,dragProgress:L,dragStyles:Te}}function Gu(){throw new Error}const RL=["start","end","left","right","bottom"],r2=Pt({name:"VNavigationDrawer",props:{color:String,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,modelValue:{type:Boolean,default:null},permanent:Boolean,rail:Boolean,railWidth:{type:[Number,String],default:56},scrim:{type:[String,Boolean],default:!0},image:String,temporary:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},location:{type:String,default:"start",validator:e=>RL.includes(e)},sticky:Boolean,...fo(),...or(),...sh(),...zi(),...wn({tag:"nav"}),...Xn()},emits:{"update:modelValue":e=>!0},setup(e,s){let{attrs:a,slots:u}=s;const{isRtl:d}=va(),{themeClasses:g}=vi(e),{borderClasses:x}=zo(e),{backgroundColorClasses:o,backgroundColorStyles:w}=Hi(St(e,"color")),{elevationClasses:E}=kr(e),{mobile:k}=Ig(),{roundedClasses:z}=Yi(e),L=ZT(),O=bn(e,"modelValue",null,ft=>!!ft),{ssrBootStyles:G}=t0(),H=Ke(),pe=Ke(!1),se=ne(()=>e.rail&&e.expandOnHover&&pe.value?Number(e.width):Number(e.rail?e.railWidth:e.width)),he=ne(()=>F_(e.location,d.value)),K=ne(()=>!e.permanent&&(k.value||e.temporary)),Te=ne(()=>e.sticky&&!K.value&&he.value!=="bottom");e.disableResizeWatcher||Ye(K,ft=>!e.permanent&&(O.value=!ft)),!e.disableRouteWatcher&&L&&Ye(L.currentRoute,()=>K.value&&(O.value=!1)),Ye(()=>e.permanent,ft=>{ft&&(O.value=!0)}),pg(()=>{e.modelValue!=null||K.value||(O.value=e.permanent||!k.value)});const{isDragging:Y,dragProgress:_e,dragStyles:de}=DL({isActive:O,isTemporary:K,width:se,touchless:St(e,"touchless"),position:he}),ve=ne(()=>{const ft=K.value?0:e.rail&&e.expandOnHover?Number(e.railWidth):se.value;return Y.value?ft*_e.value:ft}),{layoutItemStyles:Se,layoutRect:be,layoutItemScrimStyles:De}=ah({id:e.name,order:ne(()=>parseInt(e.order,10)),position:he,layoutSize:ve,elementSize:se,active:ne(()=>O.value||Y.value),disableTransitions:ne(()=>Y.value),absolute:ne(()=>e.absolute||Te.value&&typeof ze.value!="string")}),{isStuck:ze,stickyStyles:Je}=kL({rootEl:H,isSticky:Te,layoutItemStyles:Se}),ct=Hi(ne(()=>typeof e.scrim=="string"?e.scrim:null)),nt=ne(()=>({...Y.value?{opacity:_e.value*.2,transition:"none"}:void 0,...be.value?{left:Xt(be.value.left),right:Xt(be.value.right),top:Xt(be.value.top),bottom:Xt(be.value.bottom)}:void 0,...De.value}));return ir({VList:{bgColor:"transparent"}}),kt(()=>{var ft,Pe,at,jt;const pt=u.image||e.image;return F(On,null,[F(e.tag,tn({ref:H,onMouseenter:()=>pe.value=!0,onMouseleave:()=>pe.value=!1,class:["v-navigation-drawer",`v-navigation-drawer--${he.value}`,{"v-navigation-drawer--expand-on-hover":e.expandOnHover,"v-navigation-drawer--floating":e.floating,"v-navigation-drawer--is-hovering":pe.value,"v-navigation-drawer--rail":e.rail,"v-navigation-drawer--temporary":K.value,"v-navigation-drawer--active":O.value,"v-navigation-drawer--sticky":Te.value},g.value,o.value,x.value,E.value,z.value],style:[w.value,Se.value,de.value,G.value,Je.value]},a),{default:()=>[pt&&F("div",{key:"image",class:"v-navigation-drawer__img"},[u.image?(ft=u.image)==null?void 0:ft.call(u,{image:e.image}):F("img",{src:e.image,alt:""},null)]),u.prepend&&F("div",{class:"v-navigation-drawer__prepend"},[(Pe=u.prepend)==null?void 0:Pe.call(u)]),F("div",{class:"v-navigation-drawer__content"},[(at=u.default)==null?void 0:at.call(u)]),u.append&&F("div",{class:"v-navigation-drawer__append"},[(jt=u.append)==null?void 0:jt.call(u)])]}),F(zs,{name:"fade-transition"},{default:()=>[K.value&&(Y.value||O.value)&&!!e.scrim&&F("div",{class:["v-navigation-drawer__scrim",ct.backgroundColorClasses.value],style:[nt.value,ct.backgroundColorStyles.value],onClick:()=>O.value=!1},null)]})])}),{isStuck:ze}}}),BL=Ln({__name:"Bar",setup(e){const s=Ke(!0),a=Ke(!1),u=()=>{a.value=!s.value};return(d,g)=>(Xi(),ts(r2,{modelValue:s.value,"onUpdate:modelValue":g[0]||(g[0]=x=>s.value=x),width:"240",elevation:"0",class:"rounded-0 ml-6 pr-lg-10 bg-grey-lighten-3",onTransitionend:u,floating:""},{default:xi(()=>[Af(d.$slots,"default",{},void 0,!0)]),_:3},8,["modelValue"]))}});const OL=Bs(BL,[["__scopeId","data-v-d280f2ec"]]);function FL(e){const{icons:s,activeIcons:a,temp:u}=Qi(e);function d(g){Object.keys(s).forEach(x=>{x===g?s[x]=a[x]:s[x]=u[x]})}return{icons:s,toggleIcon:d}}const nf=Pt({name:"VDivider",props:{color:String,inset:Boolean,length:[Number,String],thickness:[Number,String],vertical:Boolean,...Xn()},setup(e,s){let{attrs:a}=s;const{themeClasses:u}=vi(e),{backgroundColorClasses:d,backgroundColorStyles:g}=Hi(St(e,"color")),x=ne(()=>{const o={};return e.length&&(o[e.vertical?"maxHeight":"maxWidth"]=Xt(e.length)),e.thickness&&(o[e.vertical?"borderRightWidth":"borderTopWidth"]=Xt(e.thickness)),o});return kt(()=>F("hr",{class:[{"v-divider":!0,"v-divider--inset":e.inset,"v-divider--vertical":e.vertical},u.value,d.value],style:[x.value,g.value],"aria-orientation":!a.role||a.role==="separator"?e.vertical?"vertical":"horizontal":void 0,role:`${a.role||"separator"}`},null)),{}}});const Y_=Symbol.for("vuetify:list");function o2(){const e=ln(Y_,{hasPrepend:Ke(!1),updateHasPrepend:()=>null}),s={hasPrepend:Ke(!1),updateHasPrepend:a=>{a&&(s.hasPrepend.value=a)}};return Ni(Y_,s),e}function s2(){return ln(Y_,null)}const VL={open:e=>{let{id:s,value:a,opened:u,parents:d}=e;if(a){const g=new Set;g.add(s);let x=d.get(s);for(;x!=null;)g.add(x),x=d.get(x);return g}else return u.delete(s),u},select:()=>null},a2={open:e=>{let{id:s,value:a,opened:u,parents:d}=e;if(a){let g=d.get(s);for(u.add(s);g!=null&&g!==s;)u.add(g),g=d.get(g);return u}else u.delete(s);return u},select:()=>null},$L={open:a2.open,select:e=>{let{id:s,value:a,opened:u,parents:d}=e;if(!a)return u;const g=[];let x=d.get(s);for(;x!=null;)g.push(x),x=d.get(x);return new Set(g)}},n0=e=>{const s={select:a=>{let{id:u,value:d,selected:g}=a;if(e&&!d){const x=Array.from(g.entries()).reduce((o,w)=>{let[E,k]=w;return k==="on"?[...o,E]:o},[]);if(x.length===1&&x[0]===u)return g}return g.set(u,d?"on":"off"),g},in:(a,u,d)=>{let g=new Map;for(const x of a||[])g=s.select({id:x,value:!0,selected:new Map(g),children:u,parents:d});return g},out:a=>{const u=[];for(const[d,g]of a.entries())g==="on"&&u.push(d);return u}};return s},l2=e=>{const s=n0(e);return{select:u=>{let{selected:d,id:g,...x}=u;const o=d.has(g)?new Map([[g,d.get(g)]]):new Map;return s.select({...x,id:g,selected:o})},in:(u,d,g)=>{let x=new Map;return u!=null&&u.length&&(x=s.in(u.slice(0,1),d,g)),x},out:(u,d,g)=>s.out(u,d,g)}},NL=e=>{const s=n0(e);return{select:u=>{let{id:d,selected:g,children:x,...o}=u;return x.has(d)?g:s.select({id:d,selected:g,children:x,...o})},in:s.in,out:s.out}},UL=e=>{const s=l2(e);return{select:u=>{let{id:d,selected:g,children:x,...o}=u;return x.has(d)?g:s.select({id:d,selected:g,children:x,...o})},in:s.in,out:s.out}},jL=e=>{const s={select:a=>{let{id:u,value:d,selected:g,children:x,parents:o}=a;const w=new Map(g),E=[u];for(;E.length;){const z=E.shift();g.set(z,d?"on":"off"),x.has(z)&&E.push(...x.get(z))}let k=o.get(u);for(;k;){const z=x.get(k),L=z.every(G=>g.get(G)==="on"),O=z.every(G=>!g.has(G)||g.get(G)==="off");g.set(k,L?"on":O?"off":"indeterminate"),k=o.get(k)}return e&&!d&&Array.from(g.entries()).reduce((L,O)=>{let[G,H]=O;return H==="on"?[...L,G]:L},[]).length===0?w:g},in:(a,u,d)=>{let g=new Map;for(const x of a||[])g=s.select({id:x,value:!0,selected:new Map(g),children:u,parents:d});return g},out:(a,u)=>{const d=[];for(const[g,x]of a.entries())x==="on"&&!u.has(g)&&d.push(g);return d}};return s},wf=Symbol.for("vuetify:nested"),c2={id:Ke(),root:{register:()=>null,unregister:()=>null,parents:Ke(new Map),children:Ke(new Map),open:()=>null,openOnSelect:()=>null,select:()=>null,opened:Ke(new Set),selected:Ke(new Map),selectedValues:Ke([])}},GL=Mn({selectStrategy:[String,Function],openStrategy:[String,Function],opened:Array,selected:Array,mandatory:Boolean},"nested"),qL=e=>{let s=!1;const a=Ke(new Map),u=Ke(new Map),d=bn(e,"opened",e.opened,z=>new Set(z),z=>[...z.values()]),g=ne(()=>{if(typeof e.selectStrategy=="object")return e.selectStrategy;switch(e.selectStrategy){case"single-leaf":return UL(e.mandatory);case"leaf":return NL(e.mandatory);case"independent":return n0(e.mandatory);case"single-independent":return l2(e.mandatory);case"classic":default:return jL(e.mandatory)}}),x=ne(()=>{if(typeof e.openStrategy=="function")return e.openStrategy;switch(e.openStrategy){case"list":return $L;case"single":return VL;case"multiple":default:return a2}}),o=bn(e,"selected",e.selected,z=>g.value.in(z,a.value,u.value),z=>g.value.out(z,a.value,u.value));Ti(()=>{s=!0});function w(z){const L=[];let O=z;for(;O!=null;)L.unshift(O),O=u.value.get(O);return L}const E=Ar("nested"),k={id:Ke(),root:{opened:d,selected:o,selectedValues:ne(()=>{const z=[];for(const[L,O]of o.value.entries())O==="on"&&z.push(L);return z}),register:(z,L,O)=>{L&&z!==L&&u.value.set(z,L),O&&a.value.set(z,[]),L!=null&&a.value.set(L,[...a.value.get(L)||[],z])},unregister:z=>{var O;if(s)return;a.value.delete(z);const L=u.value.get(z);if(L){const G=(O=a.value.get(L))!=null?O:[];a.value.set(L,G.filter(H=>H!==z))}u.value.delete(z),d.value.delete(z)},open:(z,L,O)=>{E.emit("click:open",{id:z,value:L,path:w(z),event:O});const G=x.value.open({id:z,value:L,opened:new Set(d.value),children:a.value,parents:u.value,event:O});G&&(d.value=G)},openOnSelect:(z,L,O)=>{const G=x.value.select({id:z,value:L,selected:new Map(o.value),opened:new Set(d.value),children:a.value,parents:u.value,event:O});G&&(d.value=G)},select:(z,L,O)=>{E.emit("click:select",{id:z,value:L,path:w(z),event:O});const G=g.value.select({id:z,value:L,selected:new Map(o.value),children:a.value,parents:u.value,event:O});G&&(o.value=G),k.root.openOnSelect(z,L,O)},children:a,parents:u}};return Ni(wf,k),k.root},u2=(e,s)=>{const a=ln(wf,c2),u=ne(()=>{var g;return(g=e.value)!=null?g:Symbol(Nr())}),d={...a,id:u,open:(g,x)=>a.root.open(u.value,g,x),openOnSelect:(g,x)=>a.root.openOnSelect(u.value,g,x),isOpen:ne(()=>a.root.opened.value.has(u.value)),parent:ne(()=>a.root.parents.value.get(u.value)),select:(g,x)=>a.root.select(u.value,g,x),isSelected:ne(()=>a.root.selected.value.get(u.value)==="on"),isIndeterminate:ne(()=>a.root.selected.value.get(u.value)==="indeterminate"),isLeaf:ne(()=>!a.root.children.value.get(u.value)),isGroupActivator:a.isGroupActivator};return!a.isGroupActivator&&a.root.register(u.value,a.id.value,s),Ti(()=>{!a.isGroupActivator&&a.root.unregister(u.value)}),s&&Ni(wf,d),d},ZL=()=>{const e=ln(wf,c2);Ni(wf,{...e,isGroupActivator:!0})},WL=Pt({name:"VListGroupActivator",setup(e,s){let{slots:a}=s;return ZL(),()=>{var u;return(u=a.default)==null?void 0:u.call(a)}}}),HL=Mn({activeColor:String,color:String,collapseIcon:{type:pn,default:"$collapse"},expandIcon:{type:pn,default:"$expand"},prependIcon:pn,appendIcon:pn,fluid:Boolean,subgroup:Boolean,value:null,...wn()},"VListGroup"),i0=Pi()({name:"VListGroup",props:{title:String,...HL()},setup(e,s){let{slots:a}=s;const{isOpen:u,open:d,id:g}=u2(St(e,"value"),!0),x=ne(()=>`v-list-group--id-${String(g.value)}`),o=s2();function w(z){d(!u.value,z)}const E=ne(()=>({onClick:w,class:"v-list-group__header",id:x.value})),k=ne(()=>u.value?e.collapseIcon:e.expandIcon);return kt(()=>{var z;return F(e.tag,{class:["v-list-group",{"v-list-group--prepend":o==null?void 0:o.hasPrepend.value,"v-list-group--fluid":e.fluid,"v-list-group--subgroup":e.subgroup}]},{default:()=>[a.activator&&F(wi,{defaults:{VListItem:{active:u.value,activeColor:e.activeColor,color:e.color,prependIcon:e.prependIcon||e.subgroup&&k.value,appendIcon:e.appendIcon||!e.subgroup&&k.value,title:e.title,value:e.value}}},{default:()=>[F(WL,null,{default:()=>[a.activator({props:E.value,isOpen:u})]})]}),F(bg,null,{default:()=>[ji(F("div",{class:"v-list-group__items",role:"group","aria-labelledby":x.value},[(z=a.default)==null?void 0:z.call(a)]),[[Rs,u.value]])]})]})}),{}}});function XL(e){return Mo(e,Object.keys(i0.props))}const YL=Mn({start:Boolean,end:Boolean,icon:pn,image:String,...mr(),...zi(),...ga(),...wn(),...Lo({variant:"flat"})},"VAvatar"),cl=Pt({name:"VAvatar",props:YL(),setup(e,s){let{slots:a}=s;const{colorClasses:u,colorStyles:d,variantClasses:g}=Mc(e),{densityClasses:x}=Ur(e),{roundedClasses:o}=Yi(e),{sizeClasses:w,sizeStyles:E}=uh(e);return kt(()=>{var k;return F(e.tag,{class:["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},u.value,x.value,o.value,w.value,g.value],style:[d.value,E.value]},{default:()=>[e.image?F(oh,{key:"image",src:e.image,alt:""},null):e.icon?F(er,{key:"icon",icon:e.icon},null):(k=a.default)==null?void 0:k.call(a),kc(!1,"v-avatar")]})}),{}}}),h2=Po("v-list-item-subtitle"),d2=Po("v-list-item-title"),dr=Pi()({name:"VListItem",directives:{Ripple:fl},props:{active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:pn,disabled:Boolean,lines:String,link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:pn,subtitle:[String,Number,Boolean],title:[String,Number,Boolean],value:null,...fo(),...mr(),...ns(),...or(),...zi(),...fh(),...wn(),...Xn(),...Lo({variant:"text"})},emits:{click:e=>!0},setup(e,s){let{attrs:a,slots:u,emit:d}=s;const g=Pf(e,a),x=ne(()=>{var Pe;return(Pe=e.value)!=null?Pe:g.href.value}),{select:o,isSelected:w,isIndeterminate:E,isGroupActivator:k,root:z,parent:L,openOnSelect:O}=u2(x,!1),G=s2(),H=ne(()=>{var Pe;return e.active!==!1&&(e.active||((Pe=g.isActive)==null?void 0:Pe.value)||w.value)}),pe=ne(()=>e.link!==!1&&g.isLink.value),se=ne(()=>!e.disabled&&e.link!==!1&&(e.link||g.isClickable.value||e.value!=null&&!!G)),he=ne(()=>e.rounded||e.nav),K=ne(()=>{var Pe;return{color:H.value&&(Pe=e.activeColor)!=null?Pe:e.color,variant:e.variant}});Ye(()=>{var Pe;return(Pe=g.isActive)==null?void 0:Pe.value},Pe=>{Pe&&L.value!=null&&z.open(L.value,!0),Pe&&O(Pe)},{immediate:!0});const{themeClasses:Te}=vi(e),{borderClasses:Y}=zo(e),{colorClasses:_e,colorStyles:de,variantClasses:ve}=Mc(K),{densityClasses:Se}=Ur(e),{dimensionStyles:be}=is(e),{elevationClasses:De}=kr(e),{roundedClasses:ze}=Yi(he),Je=ne(()=>e.lines?`v-list-item--${e.lines}-line`:void 0),ct=ne(()=>({isActive:H.value,select:o,isSelected:w.value,isIndeterminate:E.value}));function nt(Pe){var at;d("click",Pe),!(k||!se.value)&&((at=g.navigate)==null||at.call(g,Pe),e.value!=null&&o(!w.value,Pe))}function ft(Pe){(Pe.key==="Enter"||Pe.key===" ")&&(Pe.preventDefault(),nt(Pe))}return kt(()=>{var Pe,at,jt,pt,zt;const Gt=pe.value?"a":e.tag,zn=!G||w.value||H.value,At=u.title||e.title,Qe=u.subtitle||e.subtitle,xt=!!(u.append||e.appendAvatar||e.appendIcon),Tt=!!(u.prepend||e.prependAvatar||e.prependIcon);return G==null||G.updateHasPrepend(Tt),ji(F(Gt,{class:["v-list-item",{"v-list-item--active":H.value,"v-list-item--disabled":e.disabled,"v-list-item--link":se.value,"v-list-item--nav":e.nav,"v-list-item--prepend":!Tt&&(G==null?void 0:G.hasPrepend.value),[`${e.activeClass}`]:e.activeClass&&H.value},Te.value,Y.value,zn?_e.value:void 0,Se.value,De.value,Je.value,ze.value,ve.value],style:[zn?de.value:void 0,be.value],href:g.href.value,tabindex:se.value?0:void 0,onClick:nt,onKeydown:se.value&&!pe.value&&ft},{default:()=>[kc(se.value||H.value,"v-list-item"),Tt&&F(wi,{key:"prepend",defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon},VListItemAction:{start:!0}}},{default:()=>[F("div",{class:"v-list-item__prepend"},[e.prependAvatar&&F(cl,{key:"prepend-avatar"},null),e.prependIcon&&F(er,{key:"prepend-icon"},null),(Pe=u.prepend)==null?void 0:Pe.call(u,ct.value)])]}),F("div",{class:"v-list-item__content"},[At&&F(d2,{key:"title"},{default:()=>{var Nt;return[(Nt=(at=u.title)==null?void 0:at.call(u,{title:e.title}))!=null?Nt:e.title]}}),Qe&&F(h2,{key:"subtitle"},{default:()=>{var Nt;return[(Nt=(jt=u.subtitle)==null?void 0:jt.call(u,{subtitle:e.subtitle}))!=null?Nt:e.subtitle]}}),(pt=u.default)==null?void 0:pt.call(u,ct.value)]),xt&&F(wi,{key:"append",defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon},VListItemAction:{end:!0}}},{default:()=>[F("div",{class:"v-list-item__append"},[(zt=u.append)==null?void 0:zt.call(u,ct.value),e.appendIcon&&F(er,{key:"append-icon"},null),e.appendAvatar&&F(cl,{key:"append-avatar"},null)])]})]}),[[uo("ripple"),se.value]])}),{}}}),rf=Pt({name:"VListSubheader",props:{color:String,inset:Boolean,sticky:Boolean,title:String,...wn()},setup(e,s){let{slots:a}=s;const{textColorClasses:u,textColorStyles:d}=no(St(e,"color"));return kt(()=>{var g;const x=!!(a.default||e.title);return F(e.tag,{class:["v-list-subheader",{"v-list-subheader--inset":e.inset,"v-list-subheader--sticky":e.sticky},u.value],style:{textColorStyles:d}},{default:()=>{var o;return[x&&F("div",{class:"v-list-subheader__text"},[(o=(g=a.default)==null?void 0:g.call(a))!=null?o:e.title])]}})}),{}}}),f2=Pi()({name:"VListChildren",props:{items:Array},setup(e,s){let{slots:a}=s;return o2(),()=>{var g;var u,d;return(g=(u=a.default)==null?void 0:u.call(a))!=null?g:(d=e.items)==null?void 0:d.map(x=>{var pe,se;let{children:o,props:w,type:E,raw:k}=x;if(E==="divider"){var z;return(pe=(z=a.divider)==null?void 0:z.call(a,{props:w}))!=null?pe:F(nf,w,null)}if(E==="subheader"){var L;return(se=(L=a.subheader)==null?void 0:L.call(a,{props:w}))!=null?se:F(rf,w,{default:a.subheader})}const O={subtitle:a.subtitle?he=>{var K;return(K=a.subtitle)==null?void 0:K.call(a,{...he,item:k})}:void 0,prepend:a.prepend?he=>{var K;return(K=a.prepend)==null?void 0:K.call(a,{...he,item:k})}:void 0,append:a.append?he=>{var K;return(K=a.append)==null?void 0:K.call(a,{...he,item:k})}:void 0,default:a.default?he=>{var K;return(K=a.default)==null?void 0:K.call(a,{...he,item:k})}:void 0,title:a.title?he=>{var K;return(K=a.title)==null?void 0:K.call(a,{...he,item:k})}:void 0},[G,H]=XL(w);return o?F(i0,tn({value:w==null?void 0:w.value},G),{activator:he=>{let{props:K}=he;return a.header?a.header({...w,...K}):F(dr,tn(w,K),O)},default:()=>F(f2,{items:o},a)}):a.item?a.item(w):F(dr,w,O)})}}}),p2=Mn({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},returnObject:Boolean},"item");function Hu(e,s){var o;const a=Ms(s,e.itemTitle,s),u=e.returnObject?s:Ms(s,e.itemValue,a),d=Ms(s,e.itemChildren),g=e.itemProps===!0?typeof s=="object"&&s!=null&&!Array.isArray(s)?"children"in s?Mo(s,["children"])[1]:s:void 0:Ms(s,e.itemProps),x={title:a,value:u,...g};return{title:String((o=x.title)!=null?o:""),value:x.value,props:x,children:Array.isArray(d)?m2(e,d):void 0,raw:s}}function m2(e,s){const a=[];for(const u of s)a.push(Hu(e,u));return a}function r0(e){const s=ne(()=>m2(e,e.items));function a(d){return d.map(g=>Hu(e,g))}function u(d){return d.map(g=>{let{props:x}=g;return x.value})}return{items:s,transformIn:a,transformOut:u}}function KL(e,s){const a=Ms(s,e.itemType,"item"),u=typeof s=="string"?s:Ms(s,e.itemTitle),d=Ms(s,e.itemValue,void 0),g=Ms(s,e.itemChildren),x=e.itemProps===!0?Mo(s,["children"])[1]:Ms(s,e.itemProps),o={title:u,value:d,...x};return{type:a,title:o.title,value:o.value,props:o,children:a==="item"&&g?g2(e,g):void 0,raw:s}}function g2(e,s){const a=[];for(const u of s)a.push(KL(e,u));return a}function JL(e){return{items:ne(()=>g2(e,e.items))}}const zf=Pi()({name:"VList",props:{activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,lines:{type:[Boolean,String],default:"one"},nav:Boolean,...GL({selectStrategy:"single-leaf",openStrategy:"list"}),...fo(),...mr(),...ns(),...or(),itemType:{type:String,default:"type"},...p2(),...zi(),...wn(),...Xn(),...Lo({variant:"text"})},emits:{"update:selected":e=>!0,"update:opened":e=>!0,"click:open":e=>!0,"click:select":e=>!0},setup(e,s){let{slots:a}=s;const{items:u}=JL(e),{themeClasses:d}=vi(e),{backgroundColorClasses:g,backgroundColorStyles:x}=Hi(St(e,"bgColor")),{borderClasses:o}=zo(e),{densityClasses:w}=Ur(e),{dimensionStyles:E}=is(e),{elevationClasses:k}=kr(e),{roundedClasses:z}=Yi(e),{open:L,select:O}=qL(e),G=ne(()=>e.lines?`v-list--${e.lines}-line`:void 0),H=St(e,"activeColor"),pe=St(e,"color");o2(),ir({VListGroup:{activeColor:H,color:pe},VListItem:{activeClass:St(e,"activeClass"),activeColor:H,color:pe,density:St(e,"density"),disabled:St(e,"disabled"),lines:St(e,"lines"),nav:St(e,"nav"),variant:St(e,"variant")}});const se=Ke(!1),he=Ke();function K(ve){se.value=!0}function Te(ve){se.value=!1}function Y(ve){var Se;!se.value&&!(ve.relatedTarget&&(Se=he.value)!=null&&Se.contains(ve.relatedTarget))&&de()}function _e(ve){!he.value||(ve.key==="ArrowDown"?de("next"):ve.key==="ArrowUp"?de("prev"):ve.key==="Home"?de("first"):ve.key==="End"&&de("last"))}function de(ve){if(!he.value)return;const Se=[...he.value.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')].filter(ct=>!ct.hasAttribute("disabled")),be=Se.indexOf(document.activeElement);if(ve)if(ve==="first"){var ze;(ze=Se[0])==null||ze.focus()}else if(ve==="last"){var Je;(Je=Se.at(-1))==null||Je.focus()}else{let ct,nt=be;const ft=ve==="next"?1:-1;do nt+=ft,ct=Se[nt];while((!ct||ct.offsetParent==null)&&nt<Se.length&&nt>=0);ct?ct.focus():de(ve==="next"?"first":"last")}else{var De;(De=Se[0])==null||De.focus()}}return kt(()=>F(e.tag,{ref:he,class:["v-list",{"v-list--disabled":e.disabled,"v-list--nav":e.nav},d.value,g.value,o.value,w.value,k.value,G.value,z.value],style:[x.value,E.value],role:"listbox","aria-activedescendant":void 0,onFocusin:K,onFocusout:Te,onFocus:Y,onKeydown:_e},{default:()=>[F(f2,{items:u.value},a)]})),{open:L,select:O,focus:de}}}),QL=Po("v-list-img"),eD=Pt({name:"VListItemAction",props:{start:Boolean,end:Boolean,...wn()},setup(e,s){let{slots:a}=s;return kt(()=>F(e.tag,{class:["v-list-item-action",{"v-list-item-action--start":e.start,"v-list-item-action--end":e.end}]},a)),{}}}),tD=Pt({name:"VListItemMedia",props:{start:Boolean,end:Boolean,...wn()},setup(e,s){let{slots:a}=s;return kt(()=>F(e.tag,{class:["v-list-item-media",{"v-list-item-media--start":e.start,"v-list-item-media--end":e.end}]},a)),{}}}),Wu=Ln({__name:"BarLeft",setup(e){const s=EL(),{icons:a,toggleIcon:u}=FL({icons:{index:"mdi-core-outline",land:"mdi-tree-outline",elevation:"mdi-landslide-outline"},activeIcons:{index:"mdi-core",land:"mdi-tree",elevation:"mdi-landslide"},temp:{index:"mdi-core-outline",land:"mdi-tree-outline",elevation:"mdi-landslide-outline"}}),d=g=>{s.push({name:g}),u(g)};return(g,x)=>(Xi(),ts(OL,null,{default:xi(()=>[F(zf,{density:"compact",nav:""},{default:xi(()=>[F(nf),F(rf,null,{default:xi(()=>[al("\u6838\u5E94\u6025")]),_:1}),F(dr,{class:"d-flex rounded-b-lg",onClick:x[0]||(x[0]=o=>d("success")),"prepend-icon":Ai(a).success,title:"\u64A4\u79BB\u6210\u529F",value:"success"},null,8,["prepend-icon"]),F(dr,{onClick:x[1]||(x[1]=o=>d("failure")),"prepend-icon":Ai(a).failure,title:"\u64A4\u79BB\u5931\u8D25",value:"failure"},null,8,["prepend-icon"]),F(nf),F(dr,{onClick:x[2]||(x[2]=o=>d("GDP")),"prepend-icon":Ai(a).GDP,title:"\u56FD\u6C11\u751F\u4EA7\u603B\u503C",value:"GDP"},null,8,["prepend-icon"]),F(dr,{onClick:x[3]||(x[3]=o=>d("density")),"prepend-icon":Ai(a).density,title:"\u4EBA\u53E3\u5BC6\u5EA6",value:"density"},null,8,["prepend-icon"]),F(rf,null,{default:xi(()=>[al("\u6C14\u8C61")]),_:1}),F(dr,{onClick:x[4]||(x[4]=o=>d("weather")),"prepend-icon":Ai(a).weather,title:"\u5168\u7403\u6C14\u8C61",value:"weather"},null,8,["prepend-icon"]),F(dr,{onClick:x[5]||(x[5]=o=>d("typhoon")),"prepend-icon":Ai(a).typhoon,title:"\u53F0\u98CE\u60C5\u51B5",value:"typhoon"},null,8,["prepend-icon"]),F(dr,{onClick:x[6]||(x[6]=o=>d("inversion")),"prepend-icon":Ai(a).inversion,title:"\u6C14\u8C61\u53CD\u6F14",value:"inversion"},null,8,["prepend-icon"]),F(nf),F(rf,null,{default:xi(()=>[al("\u5730\u8D28")]),_:1}),F(dr,{onClick:x[7]||(x[7]=o=>d("single")),title:"\u4E2A\u4EBA\u5242\u91CF",value:"dose_single"}),F(dr,{onClick:x[8]||(x[8]=o=>d("multiple")),title:"\u96C6\u4F53\u8BA1\u91CF",value:"dose_mutilate"}),F(dr,{onClick:x[9]||(x[9]=o=>d("other")),title:"\u5176\u4ED6",value:"other"})]),_:1})]),_:1}))}});const v2=Pt({name:"VApp",props:{...IT({fullHeight:!0}),...Xn()},setup(e,s){let{slots:a}=s;const u=vi(e),{layoutClasses:d,layoutStyles:g,getLayoutItem:x,items:o,layoutRef:w}=AT(e),{rtlClasses:E}=va();return kt(()=>{var k;return F("div",{ref:w,class:["v-application",u.themeClasses.value,d.value,E.value],style:g.value},[F("div",{class:"v-application__wrap"},[(k=a.default)==null?void 0:k.call(a)])])}),{getLayoutItem:x,items:o,theme:u}}});const _2=Pt({name:"VCardActions",setup(e,s){let{slots:a}=s;return ir({VBtn:{variant:"text"}}),kt(()=>{var u;return F("div",{class:"v-card-actions"},[(u=a.default)==null?void 0:u.call(a)])}),{}}}),y2=Po("v-card-subtitle"),x2=Po("v-card-title"),b2=Ln({name:"VCardItem",props:{appendAvatar:String,appendIcon:pn,prependAvatar:String,prependIcon:pn,subtitle:String,title:String,...mr()},setup(e,s){let{slots:a}=s;return kt(()=>{var u,d,g,x,o;const w=!!(e.prependAvatar||e.prependIcon||a.prepend),E=!!(e.appendAvatar||e.appendIcon||a.append),k=!!(e.title||a.title),z=!!(e.subtitle||a.subtitle);return F("div",{class:"v-card-item"},[w&&F(wi,{key:"prepend",defaults:{VAvatar:{density:e.density,icon:e.prependIcon,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},{default:()=>{var L;return[F("div",{class:"v-card-item__prepend"},[(L=(u=a.prepend)==null?void 0:u.call(a))!=null?L:F(cl,null,null)])]}}),F("div",{class:"v-card-item__content"},[k&&F(x2,{key:"title"},{default:()=>{var L;return[(L=(d=a.title)==null?void 0:d.call(a))!=null?L:e.title]}}),z&&F(y2,{key:"subtitle"},{default:()=>{var L;return[(L=(g=a.subtitle)==null?void 0:g.call(a))!=null?L:e.subtitle]}}),(x=a.default)==null?void 0:x.call(a)]),E&&F(wi,{key:"append",defaults:{VAvatar:{density:e.density,icon:e.appendIcon,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},{default:()=>{var L;return[F("div",{class:"v-card-item__append"},[(L=(o=a.append)==null?void 0:o.call(a))!=null?L:F(cl,null,null)])]}})])}),{}}}),o0=Po("v-card-text"),Lf=Pt({name:"VCard",directives:{Ripple:fl},props:{appendAvatar:String,appendIcon:pn,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:pn,ripple:Boolean,subtitle:String,text:String,title:String,...Xn(),...fo(),...mr(),...ns(),...or(),...Jy(),...Lc(),...hh(),...zi(),...fh(),...wn(),...Lo({variant:"elevated"})},setup(e,s){let{attrs:a,slots:u}=s;const{themeClasses:d}=vi(e),{borderClasses:g}=zo(e),{colorClasses:x,colorStyles:o,variantClasses:w}=Mc(e),{densityClasses:E}=Ur(e),{dimensionStyles:k}=is(e),{elevationClasses:z}=kr(e),{loaderClasses:L}=Tg(e),{locationStyles:O}=Dc(e),{positionClasses:G}=dh(e),{roundedClasses:H}=Yi(e),pe=Pf(e,a),se=ne(()=>e.link!==!1&&pe.isLink.value),he=ne(()=>!e.disabled&&e.link!==!1&&(e.link||pe.isClickable.value));return kt(()=>{var K,Te,Y;const _e=se.value?"a":e.tag,de=!!(u.title||e.title),ve=!!(u.subtitle||e.subtitle),Se=de||ve,be=!!(u.append||e.appendAvatar||e.appendIcon),De=!!(u.prepend||e.prependAvatar||e.prependIcon),ze=!!(u.image||e.image),Je=Se||De||be,ct=!!(u.text||e.text);return ji(F(_e,{class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":he.value},d.value,g.value,x.value,E.value,z.value,L.value,G.value,H.value,w.value],style:[o.value,k.value,O.value],href:pe.href.value,onClick:he.value&&pe.navigate},{default:()=>[ze&&F(wi,{key:"image",defaults:{VImg:{cover:!0,src:e.image}}},{default:()=>{var nt;return[F("div",{class:"v-card__image"},[(nt=(K=u.image)==null?void 0:K.call(u))!=null?nt:F(oh,null,null)])]}}),F(Qy,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:u.loader}),Je&&F(b2,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:u.item,prepend:u.prepend,title:u.title,subtitle:u.subtitle,append:u.append}),ct&&F(o0,{key:"text"},{default:()=>{var nt;return[(nt=(Te=u.text)==null?void 0:Te.call(u))!=null?nt:e.text]}}),(Y=u.default)==null?void 0:Y.call(u),u.actions&&F(_2,null,{default:u.actions}),kc(he.value,"v-card")]}),[[uo("ripple"),he.value]])}),{}}});const w2=Pt({name:"VMain",props:{scrollable:Boolean,...wn({tag:"main"})},setup(e,s){let{slots:a}=s;const{mainStyles:u}=VP(),{ssrBootStyles:d}=t0();return kt(()=>{var g,x;return F(e.tag,{class:["v-main",{"v-main--scrollable":e.scrollable}],style:[u.value,d.value]},{default:()=>[e.scrollable?F("div",{class:"v-main__scroller"},[(g=a.default)==null?void 0:g.call(a)]):(x=a.default)==null?void 0:x.call(a)]})}),{}}}),nD=Ln({__name:"AppLayout",setup(e){const s=Ke();return kn(()=>{const a=s.value.$el.clientHeight;document.documentElement.style.setProperty("--appbar-height",`${a}px`),document.documentElement.style.setProperty("--draw-width","50px")}),(a,u)=>{const d=ua("router-view");return Xi(),ts(v2,null,{default:xi(()=>[F(xz),F(Wu),F(w2,{class:"bg-grey-lighten-3"},{default:xi(()=>[F(Lf,{elevation:"1",class:"h-100 ml-lg-5 mt-lg-5 mr-lg-5 rounded-0"},{default:xi(()=>[F(d,{class:"map",name:"main_view"})]),_:1})]),_:1})]),_:1})}}});const iD=Bs(nD,[["__scopeId","data-v-55f6bda8"]]),rD={components:{MainLayout:iD}};function oD(e,s,a,u,d,g){const x=ua("MainLayout");return Xi(),ts(x)}const sD=Bs(rD,[["render",oD],["__scopeId","data-v-3135c190"]]);var aD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s0={exports:{}};(function(e,s){(function(a,u){e.exports=u()})(aD,function(){var a,u,d;function g(o,w){if(!a)a=w;else if(!u)u=w;else{var E="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+u+")(sharedChunk); self.onerror = null;",k={};a(k),d=w(k),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([E],{type:"text/javascript"})))}}g(["exports"],function(o){var w=typeof self<"u"?self:{},E="2.13.0";let k;const z={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(k==null){const n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{k={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):n}catch{k=n}}return k},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},L={supported:!1,testSupport:function(n){!H&&G&&(pe?se(n):O=n)}};let O,G,H=!1,pe=!1;function se(n){const t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,G),n.isContextLost())return;L.supported=!0}catch{}n.deleteTexture(t),H=!0}w.document&&(G=w.document.createElement("img"),G.onload=function(){O&&se(O),O=null,pe=!0},G.onerror=function(){H=!0,O=null},G.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const he="01";var K=Te;function Te(n,t,i,l){this.cx=3*n,this.bx=3*(i-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=t,this.p2x=i,this.p2y=l}Te.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,t){if(t===void 0&&(t=1e-6),n<0)return 0;if(n>1)return 1;for(var i=n,l=0;l<8;l++){var h=this.sampleCurveX(i)-n;if(Math.abs(h)<t)return i;var p=this.sampleCurveDerivativeX(i);if(Math.abs(p)<1e-6)break;i-=h/p}var v=0,y=1;for(i=n,l=0;l<20&&(h=this.sampleCurveX(i),!(Math.abs(h-n)<t));l++)n>h?v=i:y=i,i=.5*(y-v)+v;return i},solve:function(n,t){return this.sampleCurveY(this.solveCurveX(n,t))}};var Y=_e;function _e(n,t){this.x=n,this.y=t}_e.prototype={clone:function(){return new _e(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,t){return this.clone()._rotateAround(n,t)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var t=n.x-this.x,i=n.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,t){return Math.atan2(this.x*t-this.y*n,this.x*n+this.y*t)},_matMult:function(n){var t=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=t,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var t=Math.cos(n),i=Math.sin(n),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(n,t){var i=Math.cos(n),l=Math.sin(n),h=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},_e.convert=function(n){return n instanceof _e?n:Array.isArray(n)?new _e(n[0],n[1]):n};const de=Math.PI/180,ve=180/Math.PI;function Se(n){return n*de}function be(n){return n*ve}const De=[[0,0],[1,0],[1,1],[0,1]];function ze(n){if(n<=0)return 0;if(n>=1)return 1;const t=n*n,i=t*n;return 4*(n<.5?i:3*(n-t)+i-.75)}function Je(n,t,i,l){const h=new K(n,t,i,l);return function(p){return h.solve(p)}}const ct=Je(.25,.1,.25,1);function nt(n,t,i){return Math.min(i,Math.max(t,n))}function ft(n,t,i){return(i=nt((i-n)/(t-n),0,1))*i*(3-2*i)}function Pe(n,t,i){const l=i-t,h=((n-t)%l+l)%l+t;return h===t?i:h}function at(n,t,i){if(!n.length)return i(null,[]);let l=n.length;const h=new Array(n.length);let p=null;n.forEach((v,y)=>{t(v,(S,T)=>{S&&(p=S),h[y]=T,--l==0&&i(p,h)})})}function jt(n){const t=[];for(const i in n)t.push(n[i]);return t}function pt(n,...t){for(const i of t)for(const l in i)n[l]=i[l];return n}let zt=1;function Gt(){return zt++}function zn(){return function n(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,n)}()}function At(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Qe(n){return!!n&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)}function xt(n,t){n.forEach(i=>{t[i]&&(t[i]=t[i].bind(t))})}function Tt(n,t){return n.indexOf(t,n.length-t.length)!==-1}function Nt(n,t,i){const l={};for(const h in n)l[h]=t.call(i||this,n[h],h,n);return l}function fn(n,t,i){const l={};for(const h in n)t.call(i||this,n[h],h,n)&&(l[h]=n[h]);return l}function Dn(n){return Array.isArray(n)?n.map(Dn):typeof n=="object"&&n?Nt(n,Dn):n}const gn={};function ue(n){gn[n]||(typeof console<"u"&&console.warn(n),gn[n]=!0)}function Me(n,t,i){return(i.y-n.y)*(t.x-n.x)>(t.y-n.y)*(i.x-n.x)}function qe(n){let t=0;for(let i,l,h=0,p=n.length,v=p-1;h<p;v=h++)i=n[h],l=n[v],t+=(l.x-i.x)*(i.y+l.y);return t}function st(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function yt(n){const t={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,l,h,p)=>{const v=h||p;return t[l]=!v||v.toLowerCase(),""}),t["max-age"]){const i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}let Lt=null;function Vt(n){if(Lt==null){const t=n.navigator?n.navigator.userAgent:null;Lt=!!n.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Lt}function Mt(n){try{const t=w[n];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ot(n,t){return[n[4*t],n[4*t+1],n[4*t+2],n[4*t+3]]}const wt="mapbox-tiles";let Kt,Zt,rn=500,dn=50;function Sn(){try{return w.caches}catch{}}function Un(){Sn()&&!Kt&&(Kt=w.caches.open(wt))}function jn(n){const t=n.indexOf("?");if(t<0)return n;const i=function(h){const p=h.indexOf("?");return p>0?h.slice(p+1).split("&"):[]}(n),l=i.filter(h=>{const p=h.split("=");return p[0]==="language"||p[0]==="worldview"});return l.length?`${n.slice(0,t)}?${l.join("&")}`:n.slice(0,t)}let fi=1/0;const tr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(tr);class Gi extends Error{constructor(t,i,l){i===401&&$s(l)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=i,this.url=l}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ss=st()?()=>self.worker&&self.worker.referrer:()=>(w.location.protocol==="blob:"?w.parent:w).location.href,Mr=function(n,t){if(!(/^file:/.test(i=n.url)||/^file:/.test(ss())&&!/^\w+:/.test(i))){if(w.fetch&&w.Request&&w.AbortController&&w.Request.prototype.hasOwnProperty("signal"))return function(l,h){const p=new w.AbortController,v=new w.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:ss(),signal:p.signal});let y=!1,S=!1;const T=(A=v.url).indexOf("sku=")>0&&$s(A);var A;l.type==="json"&&v.headers.set("Accept","application/json");const P=(V,$,j)=>{if(S)return;if(V&&V.message!=="SecurityError"&&ue(V),$&&j)return D($);const X=Date.now();w.fetch(v).then(le=>{if(le.ok){const ye=T?le.clone():null;return D(le,ye,X)}return h(new Gi(le.statusText,le.status,l.url))}).catch(le=>{le.name!=="AbortError"&&h(new Error(`${le.message} ${l.url}`))})},D=(V,$,j)=>{(l.type==="arrayBuffer"?V.arrayBuffer():l.type==="json"?V.json():V.text()).then(X=>{S||($&&j&&function(le,ye,ie){if(Un(),!Kt)return;const ge={status:ye.status,statusText:ye.statusText,headers:new w.Headers};ye.headers.forEach((je,$e)=>ge.headers.set($e,je));const Ee=yt(ye.headers.get("Cache-Control")||"");if(Ee["no-store"])return;Ee["max-age"]&&ge.headers.set("Expires",new Date(ie+1e3*Ee["max-age"]).toUTCString());const xe=ge.headers.get("Expires");xe&&(new Date(xe).getTime()-ie<42e4||function(je,$e){if(Zt===void 0)try{new Response(new ReadableStream),Zt=!0}catch{Zt=!1}Zt?$e(je.body):je.blob().then($e)}(ye,je=>{const $e=new w.Response(je,ge);Un(),Kt&&Kt.then(tt=>tt.put(jn(le.url),$e)).catch(tt=>ue(tt.message))}))}(v,$,j),y=!0,h(null,X,V.headers.get("Cache-Control"),V.headers.get("Expires")))}).catch(X=>{S||h(new Error(X.message))})};return T?function(V,$){if(Un(),!Kt)return $(null);const j=jn(V.url);Kt.then(X=>{X.match(j).then(le=>{const ye=function(ie){if(!ie)return!1;const ge=new Date(ie.headers.get("Expires")||0),Ee=yt(ie.headers.get("Cache-Control")||"");return ge>Date.now()&&!Ee["no-cache"]}(le);X.delete(j),ye&&X.put(j,le.clone()),$(null,le,ye)}).catch($)}).catch($)}(v,P):P(null,null),{cancel:()=>{S=!0,y||p.abort()}}}(n,t);if(st()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,t,void 0,!0)}var i;return function(l,h){const p=new w.XMLHttpRequest;p.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(p.responseType="arraybuffer");for(const v in l.headers)p.setRequestHeader(v,l.headers[v]);return l.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=l.credentials==="include",p.onerror=()=>{h(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){let v=p.response;if(l.type==="json")try{v=JSON.parse(p.response)}catch(y){return h(y)}h(null,v,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else h(new Gi(p.statusText,p.status,l.url))},p.send(l.body),{cancel:()=>p.abort()}}(n,t)},po=function(n,t){return Mr(pt(n,{type:"arrayBuffer"}),t)};function Ki(n){const t=w.document.createElement("a");return t.href=n,t.protocol===w.document.location.protocol&&t.host===w.document.location.host}const sr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ro,Fs;Ro=[],Fs=0;const ml=function(n,t){if(L.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),Fs>=z.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:n,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return Ro.push(p),p}Fs++;let i=!1;const l=()=>{if(!i)for(i=!0,Fs--;Ro.length&&Fs<z.MAX_PARALLEL_IMAGE_REQUESTS;){const p=Ro.shift(),{requestParameters:v,callback:y,cancelled:S}=p;S||(p.cancel=ml(v,y).cancel)}},h=po(n,(p,v,y,S)=>{l(),p?t(p):v&&(w.createImageBitmap?function(T,A){const P=new w.Blob([new Uint8Array(T)],{type:"image/png"});w.createImageBitmap(P).then(D=>{A(null,D)}).catch(D=>{A(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(T,A)=>t(T,A,y,S)):function(T,A){const P=new w.Image,D=w.URL;P.onload=()=>{A(null,P),D.revokeObjectURL(P.src),P.onload=null,w.requestAnimationFrame(()=>{P.src=sr})},P.onerror=()=>A(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const V=new w.Blob([new Uint8Array(T)],{type:"image/png"});P.src=T.byteLength?D.createObjectURL(V):sr}(v,(T,A)=>t(T,A,y,S)))});return{cancel:()=>{h.cancel(),l()}}},Vs="NO_ACCESS_TOKEN";function io(n){return n.indexOf("mapbox:")===0}function $s(n){return z.API_URL_REGEX.test(n)}function Bc(n){return z.API_CDN_URL_REGEX.test(n)}function Oc(n){return z.API_STYLE_REGEX.test(n)&&!ya(n)}function ya(n){return z.API_SPRITE_REGEX.test(n)}const Ns=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function jr(n){const t=n.match(Ns);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function as(n){const t=n.params.length?`?${n.params.join("&")}`:"";return`${n.protocol}://${n.authority}${n.path}${t}`}function Fc(n){if(!n)return null;const t=n.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(w.atob(t[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Us{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const i=Fc(z.ACCESS_TOKEN);let l="";return l=i&&i.u?w.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(h,p)=>String.fromCharCode(Number("0x"+p)))):z.ACCESS_TOKEN||"",t?`mapbox.eventData.${t}:${l}`:`mapbox.eventData:${l}`}fetchEventData(){const t=Mt("localStorage"),i=this.getStorageKey(),l=this.getStorageKey("uuid");if(t)try{const h=w.localStorage.getItem(i);h&&(this.eventData=JSON.parse(h));const p=w.localStorage.getItem(l);p&&(this.anonId=p)}catch{ue("Unable to read from LocalStorage")}}saveEventData(){const t=Mt("localStorage"),i=this.getStorageKey(),l=this.getStorageKey("uuid");if(t)try{w.localStorage.setItem(l,this.anonId),Object.keys(this.eventData).length>=1&&w.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{ue("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,i,l,h){if(!z.EVENTS_URL)return;const p=jr(z.EVENTS_URL);p.params.push(`access_token=${h||z.ACCESS_TOKEN||""}`);const v={event:this.type,created:new Date(t).toISOString()},y=i?pt(v,i):v,S={url:as(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([y])};this.pendingRequest=function(T,A){return Mr(pt(T,{method:"POST"}),A)}(S,T=>{this.pendingRequest=null,l(T),this.saveEventData(),this.processRequests(h)})}queueRequest(t,i){this.queue.push(t),this.processRequests(i)}}const oe=new class extends Us{constructor(n){super("appUserTurnstile"),this._customAccessToken=n}postTurnstileEvent(n,t){z.EVENTS_URL&&z.ACCESS_TOKEN&&Array.isArray(n)&&n.some(i=>io(i)||$s(i))&&this.queueRequest(Date.now(),t)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Fc(z.ACCESS_TOKEN),i=t?t.u:z.ACCESS_TOKEN;let l=i!==this.eventData.tokenU;Qe(this.anonId)||(this.anonId=zn(),l=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),v=new Date(h),y=(h-this.eventData.lastSuccess)/864e5;l=l||y>=1||y<-1||p.getDate()!==v.getDate()}else l=!0;l?this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:E,skuId:he,"enabled.telemetry":!1,userId:this.anonId},p=>{p||(this.eventData.lastSuccess=h,this.eventData.tokenU=i)},n):this.processRequests()}},N=oe.postTurnstileEvent.bind(oe),q=new class extends Us{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(n,t,i,l){this.skuToken=t,this.errorCb=l,z.EVENTS_URL&&(i||z.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Vs)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),Qe(this.anonId)||(this.anonId=zn()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:E,skuId:he,skuToken:this.skuToken,userId:this.anonId},l=>{l?this.errorCb(l):t&&(this.success[t]=!0)},n))}},re=q.postMapLoadEvent.bind(q),me=new class extends Us{constructor(){super("gljs.performance")}postPerformanceEvent(n,t){z.EVENTS_URL&&(n||z.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},n)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:i}=this.queue.shift(),l=function(h){const p=w.performance.getEntriesByType("resource"),v=w.performance.getEntriesByType("mark"),y=function(D){const V={};if(D){for(const $ in D)if($!=="other")for(const j of D[$]){const X=`${$}ResolveRangeMin`,le=`${$}ResolveRangeMax`,ye=`${$}RequestCount`,ie=`${$}RequestCachedCount`;V[X]=Math.min(V[X]||1/0,j.startTime),V[le]=Math.max(V[le]||-1/0,j.responseEnd);const ge=Ee=>{V[Ee]===void 0&&(V[Ee]=0),++V[Ee]};j.transferSize!==void 0&&j.transferSize===0&&ge(ie),ge(ye)}}return V}(function(D,V){const $={};if(D)for(const j of D){const X=V(j);$[X]===void 0&&($[X]=[]),$[X].push(j)}return $}(p,Rt)),S=w.devicePixelRatio,T=w.navigator.connection||w.navigator.mozConnection||w.navigator.webkitConnection,A={counters:[],metadata:[],attributes:[]},P=(D,V,$)=>{$!=null&&D.push({name:V,value:$.toString()})};for(const D in y)P(A.counters,D,y[D]);if(h.interactionRange[0]!==1/0&&h.interactionRange[1]!==-1/0&&(P(A.counters,"interactionRangeMin",h.interactionRange[0]),P(A.counters,"interactionRangeMax",h.interactionRange[1])),v)for(const D of Object.keys(Ve)){const V=Ve[D],$=v.find(j=>j.name===V);$&&P(A.counters,V,$.startTime)}return P(A.counters,"visibilityHidden",h.visibilityHidden),P(A.attributes,"style",function(D){if(D)for(const V of D){const $=V.name.split("?")[0];if(Oc($)){const j=$.split("/").slice(-2);if(j.length===2)return`mapbox://styles/${j[0]}/${j[1]}`}}}(p)),P(A.attributes,"terrainEnabled",h.terrainEnabled?"true":"false"),P(A.attributes,"fogEnabled",h.fogEnabled?"true":"false"),P(A.attributes,"projection",h.projection),P(A.attributes,"zoom",h.zoom),P(A.metadata,"devicePixelRatio",S),P(A.metadata,"connectionEffectiveType",T?T.effectiveType:void 0),P(A.metadata,"navigatorUserAgent",w.navigator.userAgent),P(A.metadata,"screenWidth",w.screen.width),P(A.metadata,"screenHeight",w.screen.height),P(A.metadata,"windowWidth",w.innerWidth),P(A.metadata,"windowHeight",w.innerHeight),P(A.metadata,"mapWidth",h.width/S),P(A.metadata,"mapHeight",h.height/S),P(A.metadata,"webglRenderer",h.renderer),P(A.metadata,"webglVendor",h.vendor),P(A.metadata,"sdkVersion",E),P(A.metadata,"sdkIdentifier","mapbox-gl-js"),A}(i);for(const h of l.metadata);for(const h of l.counters);for(const h of l.attributes);this.postEvent(t,l,()=>{},n)}},Ie=me.postPerformanceEvent.bind(me),Oe=new class extends Us{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(n,t,i,l){if(!z.API_URL||!z.SESSION_PATH)return;const h=jr(z.API_URL+z.SESSION_PATH);h.params.push(`sku=${t||""}`),h.params.push(`access_token=${l||z.ACCESS_TOKEN||""}`);const p={url:as(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(v,y){return Mr(pt(v,{method:"GET"}),y)}(p,v=>{this.pendingRequest=null,i(v),this.saveEventData(),this.processRequests(l)})}getSessionAPI(n,t,i,l){this.skuToken=t,this.errorCb=l,z.SESSION_PATH&&z.API_URL&&(i||z.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Vs)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||this.getSession(i,this.skuToken,l=>{l?this.errorCb(l):t&&(this.success[t]=!0)},n)}},Re=Oe.getSessionAPI.bind(Oe),ke=new Set,Ve={create:"create",load:"load",fullLoad:"fullLoad"},ut={mark(n){w.performance.mark(n)},measure(n,t,i){w.performance.measure(n,t,i)}};function Rt(n){const t=n.name.split("?")[0];return Bc(t)&&t.includes("mapbox-gl.js")?"javascript":Bc(t)&&t.includes("mapbox-gl.css")?"css":function(i){return z.API_FONTS_REGEX.test(i)}(t)?"fontRange":ya(t)?"sprite":Oc(t)?"style":function(i){return z.API_TILEJSON_REGEX.test(i)}(t)?"tilejson":"other"}const gt=w.performance;function en(n){const t=n?n.url.toString():void 0;return gt.getEntriesByName(t)}let Jt,Yt,cn,vn;const Gn={now:()=>cn!==void 0?cn:w.performance.now(),setNow(n){cn=n},restoreNow(){cn=void 0},frame(n){const t=w.requestAnimationFrame(n);return{cancel:()=>w.cancelAnimationFrame(t)}},getImageData(n,t=0){const{width:i,height:l}=n;vn||(vn=w.document.createElement("canvas"));const h=vn.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return(i>vn.width||l>vn.height)&&(vn.width=i,vn.height=l),h.clearRect(-t,-t,i+2*t,l+2*t),h.drawImage(n,0,0,i,l),h.getImageData(-t,-t,i+2*t,l+2*t)},resolveURL:n=>(Jt||(Jt=w.document.createElement("a")),Jt.href=n,Jt.href),get devicePixelRatio(){return w.devicePixelRatio},get prefersReducedMotion(){return!!w.matchMedia&&(Yt==null&&(Yt=w.matchMedia("(prefers-reduced-motion: reduce)")),Yt.matches)}};function on(n,t,i){i[n]&&i[n].indexOf(t)!==-1||(i[n]=i[n]||[],i[n].push(t))}function Jn(n,t,i){if(i&&i[n]){const l=i[n].indexOf(t);l!==-1&&i[n].splice(l,1)}}class Qn{constructor(t,i={}){pt(this,i),this.type=t}}class ls extends Qn{constructor(t,i={}){super("error",pt({error:t},i))}}class Bo{on(t,i){return this._listeners=this._listeners||{},on(t,i,this._listeners),this}off(t,i){return Jn(t,i,this._listeners),Jn(t,i,this._oneTimeListeners),this}once(t,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},on(t,i,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,i){typeof t=="string"&&(t=new Qn(t,i||{}));const l=t.type;if(this.listens(l)){t.target=this;const h=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const y of h)y.call(this,t);const p=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const y of p)Jn(l,y,this._oneTimeListeners),y.call(this,t);const v=this._eventedParent;v&&(pt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(t))}else t instanceof ls&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,i){return this._eventedParent=t,this._eventedParentData=i,this}}var et=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Oo(n,...t){for(const i of t)for(const l in i)n[l]=i[l];return n}function Bi(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function cs(n){if(Array.isArray(n))return n.map(cs);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const t={};for(const i in n)t[i]=cs(n[i]);return t}return Bi(n)}class $f extends Error{constructor(t,i){super(i),this.message=i,this.key=t}}var mo=$f;class xa{constructor(t,i=[]){this.parent=t,this.bindings={};for(const[l,h]of i)this.bindings[l]=h}concat(t){return new xa(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var Nf=xa;const ba={kind:"null"},Et={kind:"number"},Pn={kind:"string"},Tn={kind:"boolean"},go={kind:"color"},js={kind:"object"},yn={kind:"value"},gl={kind:"collator"},wa={kind:"formatted"},Sa={kind:"resolvedImage"};function Er(n,t){return{kind:"array",itemType:n,N:t}}function si(n){if(n.kind==="array"){const t=si(n.itemType);return typeof n.N=="number"?`array<${t}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${t}>`}return n.kind}const Uf=[ba,Et,Pn,Tn,go,wa,js,Er(yn),Sa];function Pr(n,t){if(t.kind==="error")return null;if(n.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Pr(n.itemType,t.itemType))&&(typeof n.N!="number"||n.N===t.N))return null}else{if(n.kind===t.kind)return null;if(n.kind==="value"){for(const i of Uf)if(!Pr(i,t))return null}}return`Expected ${si(n)} but found ${si(t)} instead.`}function vh(n,t){return t.some(i=>i.kind===n.kind)}function Gs(n,t){return t.some(i=>i==="null"?n===null:i==="array"?Array.isArray(n):i==="object"?n&&!Array.isArray(n)&&typeof n=="object":i===typeof n)}var _h,Vc={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function vl(n){return(n=Math.round(n))<0?0:n>255?255:n}function qs(n){return vl(n[n.length-1]==="%"?parseFloat(n)/100*255:parseInt(n))}function Ta(n){return(t=n[n.length-1]==="%"?parseFloat(n)/100:parseFloat(n))<0?0:t>1?1:t;var t}function yh(n,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?n+(t-n)*i*6:2*i<1?t:3*i<2?n+(t-n)*(2/3-i)*6:n}try{_h={}.parseCSSColor=function(n){var t,i=n.replace(/ /g,"").toLowerCase();if(i in Vc)return Vc[i].slice();if(i[0]==="#")return i.length===4?(t=parseInt(i.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:i.length===7&&(t=parseInt(i.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var l=i.indexOf("("),h=i.indexOf(")");if(l!==-1&&h+1===i.length){var p=i.substr(0,l),v=i.substr(l+1,h-(l+1)).split(","),y=1;switch(p){case"rgba":if(v.length!==4)return null;y=Ta(v.pop());case"rgb":return v.length!==3?null:[qs(v[0]),qs(v[1]),qs(v[2]),y];case"hsla":if(v.length!==4)return null;y=Ta(v.pop());case"hsl":if(v.length!==3)return null;var S=(parseFloat(v[0])%360+360)%360/360,T=Ta(v[1]),A=Ta(v[2]),P=A<=.5?A*(T+1):A+T-A*T,D=2*A-P;return[vl(255*yh(D,P,S+1/3)),vl(255*yh(D,P,S)),vl(255*yh(D,P,S-1/3)),y];default:return null}}return null}}catch{}class zr{constructor(t,i,l,h=1){this.r=t,this.g=i,this.b=l,this.a=h}static parse(t){if(!t)return;if(t instanceof zr)return t;if(typeof t!="string")return;const i=_h(t);return i?new zr(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[t,i,l,h]=this.toArray();return`rgba(${Math.round(t)},${Math.round(i)},${Math.round(l)},${h})`}toArray(){const{r:t,g:i,b:l,a:h}=this;return h===0?[0,0,0,0]:[255*t/h,255*i/h,255*l/h,h]}toArray01(){const{r:t,g:i,b:l,a:h}=this;return h===0?[0,0,0,0]:[t/h,i/h,l/h,h]}toArray01PremultipliedAlpha(){const{r:t,g:i,b:l,a:h}=this;return[t,i,l,h]}}zr.black=new zr(0,0,0,1),zr.white=new zr(1,1,1,1),zr.transparent=new zr(0,0,0,0),zr.red=new zr(1,0,0,1),zr.blue=new zr(0,0,1,1);var Li=zr;class $c{constructor(t,i,l){this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,i){return this.collator.compare(t,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class _l{constructor(t,i,l,h,p){this.text=t.normalize?t.normalize():t,this.image=i,this.scale=l,this.fontStack=h,this.textColor=p}}class Lr{constructor(t){this.sections=t}static fromString(t){return new Lr([new _l(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Lr?t:Lr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const i of this.sections){if(i.image){t.push(["image",i.image.name]);continue}t.push(i.text);const l={};i.fontStack&&(l["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(l["font-scale"]=i.scale),i.textColor&&(l["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(l)}return t}}class Cr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Cr({name:t,available:!1}):null}serialize(){return["image",this.name]}}function jf(n,t,i,l){return typeof n=="number"&&n>=0&&n<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[n,t,i,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[n,t,i,l]:[n,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Nc(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Li||n instanceof $c||n instanceof Lr||n instanceof Cr)return!0;if(Array.isArray(n)){for(const t of n)if(!Nc(t))return!1;return!0}if(typeof n=="object"){for(const t in n)if(!Nc(n[t]))return!1;return!0}return!1}function qi(n){if(n===null)return ba;if(typeof n=="string")return Pn;if(typeof n=="boolean")return Tn;if(typeof n=="number")return Et;if(n instanceof Li)return go;if(n instanceof $c)return gl;if(n instanceof Lr)return wa;if(n instanceof Cr)return Sa;if(Array.isArray(n)){const t=n.length;let i;for(const l of n){const h=qi(l);if(i){if(i===h)continue;i=yn;break}i=h}return Er(i||yn,t)}return js}function yl(n){const t=typeof n;return n===null?"":t==="string"||t==="number"||t==="boolean"?String(n):n instanceof Li||n instanceof Lr||n instanceof Cr?n.toString():JSON.stringify(n)}class xh{constructor(t,i){this.type=t,this.value=i}static parse(t,i){if(t.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Nc(t[1]))return i.error("invalid value");const l=t[1];let h=qi(l);const p=i.expectedType;return h.kind!=="array"||h.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(h=p),new xh(h,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Li?["rgba"].concat(this.value.toArray()):this.value instanceof Lr?this.value.serialize():this.value}}var xl=xh,ar=class{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}};const Uc={string:Pn,number:Et,boolean:Tn,object:js};class Ea{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let l,h=1;const p=t[0];if(p==="array"){let y,S;if(t.length>2){const T=t[1];if(typeof T!="string"||!(T in Uc)||T==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);y=Uc[T],h++}else y=yn;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);S=t[2],h++}l=Er(y,S)}else l=Uc[p];const v=[];for(;h<t.length;h++){const y=i.parse(t[h],h,yn);if(!y)return null;v.push(y)}return new Ea(l,v)}evaluate(t){for(let i=0;i<this.args.length;i++){const l=this.args[i].evaluate(t);if(!Pr(this.type,qi(l)))return l;if(i===this.args.length-1)throw new ar(`Expected value to be of type ${si(this.type)}, but found ${si(qi(l))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,i=[t.kind];if(t.kind==="array"){const l=t.itemType;if(l.kind==="string"||l.kind==="number"||l.kind==="boolean"){i.push(l.kind);const h=t.N;(typeof h=="number"||this.args.length>1)&&i.push(h)}}return i.concat(this.args.map(l=>l.serialize()))}}var Fo=Ea;class bl{constructor(t){this.type=wa,this.sections=t}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return i.error("First argument must be an image or text section.");const h=[];let p=!1;for(let v=1;v<=t.length-1;++v){const y=t[v];if(p&&typeof y=="object"&&!Array.isArray(y)){p=!1;let S=null;if(y["font-scale"]&&(S=i.parse(y["font-scale"],1,Et),!S))return null;let T=null;if(y["text-font"]&&(T=i.parse(y["text-font"],1,Er(Pn)),!T))return null;let A=null;if(y["text-color"]&&(A=i.parse(y["text-color"],1,go),!A))return null;const P=h[h.length-1];P.scale=S,P.font=T,P.textColor=A}else{const S=i.parse(t[v],1,yn);if(!S)return null;const T=S.type.kind;if(T!=="string"&&T!=="value"&&T!=="null"&&T!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,h.push({content:S,scale:null,font:null,textColor:null})}}return new bl(h)}evaluate(t){return new Lr(this.sections.map(i=>{const l=i.content.evaluate(t);return qi(l)===Sa?new _l("",l,null,null,null):new _l(yl(l),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null)}))}eachChild(t){for(const i of this.sections)t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const i of this.sections){t.push(i.content.serialize());const l={};i.scale&&(l["font-scale"]=i.scale.serialize()),i.font&&(l["text-font"]=i.font.serialize()),i.textColor&&(l["text-color"]=i.textColor.serialize()),t.push(l)}return t}}class jc{constructor(t){this.type=Sa,this.input=t}static parse(t,i){if(t.length!==2)return i.error("Expected two arguments.");const l=i.parse(t[1],1,Pn);return l?new jc(l):i.error("No image name provided.")}evaluate(t){const i=this.input.evaluate(t),l=Cr.fromString(i);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(i)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Bg={"to-boolean":Tn,"to-color":go,"to-number":Et,"to-string":Pn};class bh{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const l=t[0];if((l==="to-boolean"||l==="to-string")&&t.length!==2)return i.error("Expected one argument.");const h=Bg[l],p=[];for(let v=1;v<t.length;v++){const y=i.parse(t[v],v,yn);if(!y)return null;p.push(y)}return new bh(h,p)}evaluate(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){let i,l;for(const h of this.args){if(i=h.evaluate(t),l=null,i instanceof Li)return i;if(typeof i=="string"){const p=t.parseColor(i);if(p)return p}else if(Array.isArray(i)&&(l=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:jf(i[0],i[1],i[2],i[3]),!l))return new Li(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new ar(l||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const l of this.args){if(i=l.evaluate(t),i===null)return 0;const h=Number(i);if(!isNaN(h))return h}throw new ar(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?Lr.fromString(yl(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Cr.fromString(yl(this.args[0].evaluate(t))):yl(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new bl([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new jc(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(i=>{t.push(i.serialize())}),t}}var Ca=bh;const Gf=["Unknown","Point","LineString","Polygon"];var wl=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Gf[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:i,y:l}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*t-n[0])+this.featureDistanceData.bearing[1]*(l*t-n[1])}return 0}parseColor(n){let t=this._parseColorCache[n];return t||(t=this._parseColorCache[n]=Li.parse(n)),t}};class Ia{constructor(t,i,l,h){this.name=t,this.type=i,this._evaluate=l,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,i){const l=t[0],h=Ia.definitions[l];if(!h)return i.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(h)?h[0]:h.type,v=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,y=v.filter(([T])=>!Array.isArray(T)||T.length===t.length-1);let S=null;for(const[T,A]of y){S=new Ih(i.registry,i.path,null,i.scope);const P=[];let D=!1;for(let V=1;V<t.length;V++){const $=t[V],j=Array.isArray(T)?T[V-1]:T.type,X=S.parse($,1+P.length,j);if(!X){D=!0;break}P.push(X)}if(!D)if(Array.isArray(T)&&T.length!==P.length)S.error(`Expected ${T.length} arguments, but found ${P.length} instead.`);else{for(let V=0;V<P.length;V++){const $=Array.isArray(T)?T[V]:T.type,j=P[V];S.concat(V+1).checkSubtype($,j.type)}if(S.errors.length===0)return new Ia(l,p,A,P)}}if(y.length===1)i.errors.push(...S.errors);else{const T=(y.length?y:v).map(([P])=>{return D=P,Array.isArray(D)?`(${D.map(si).join(", ")})`:`(${si(D.type)}...)`;var D}).join(" | "),A=[];for(let P=1;P<t.length;P++){const D=i.parse(t[P],1+A.length);if(!D)return null;A.push(si(D.type))}i.error(`Expected arguments of type ${T}, but found (${A.join(", ")}) instead.`)}return null}static register(t,i){Ia.definitions=i;for(const l in i)t[l]=Ia}}var us=Ia;class Gc{constructor(t,i,l){this.type=gl,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=i}static parse(t,i){if(t.length!==2)return i.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return i.error("Collator options argument must be an object.");const h=i.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Tn);if(!h)return null;const p=i.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Tn);if(!p)return null;let v=null;return l.locale&&(v=i.parse(l.locale,1,Pn),!v)?null:new Gc(h,p,v)}evaluate(t){return new $c(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const hs=8192;function Wr(n,t){n[0]=Math.min(n[0],t[0]),n[1]=Math.min(n[1],t[1]),n[2]=Math.max(n[2],t[0]),n[3]=Math.max(n[3],t[1])}function Sl(n,t){return!(n[0]<=t[0]||n[2]>=t[2]||n[1]<=t[1]||n[3]>=t[3])}function qf(n,t){const i=(180+n[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(i*h*hs),Math.round(l*h*hs)]}function Zf(n,t,i){const l=n[0]-t[0],h=n[1]-t[1],p=n[0]-i[0],v=n[1]-i[1];return l*v-p*h==0&&l*p<=0&&h*v<=0}function qc(n,t){let i=!1;for(let v=0,y=t.length;v<y;v++){const S=t[v];for(let T=0,A=S.length;T<A-1;T++){if(Zf(n,S[T],S[T+1]))return!1;(h=S[T])[1]>(l=n)[1]!=(p=S[T+1])[1]>l[1]&&l[0]<(p[0]-h[0])*(l[1]-h[1])/(p[1]-h[1])+h[0]&&(i=!i)}}var l,h,p;return i}function Wf(n,t){for(let i=0;i<t.length;i++)if(qc(n,t[i]))return!0;return!1}function wh(n,t,i,l){const h=l[0]-i[0],p=l[1]-i[1],v=(n[0]-i[0])*p-h*(n[1]-i[1]),y=(t[0]-i[0])*p-h*(t[1]-i[1]);return v>0&&y<0||v<0&&y>0}function Sh(n,t,i){for(const T of i)for(let A=0;A<T.length-1;++A)if((y=[(v=T[A+1])[0]-(p=T[A])[0],v[1]-p[1]])[0]*(S=[(h=t)[0]-(l=n)[0],h[1]-l[1]])[1]-y[1]*S[0]!=0&&wh(l,h,p,v)&&wh(p,v,l,h))return!0;var l,h,p,v,y,S;return!1}function Aa(n,t){for(let i=0;i<n.length;++i)if(!qc(n[i],t))return!1;for(let i=0;i<n.length-1;++i)if(Sh(n[i],n[i+1],t))return!1;return!0}function Hf(n,t){for(let i=0;i<t.length;i++)if(Aa(n,t[i]))return!0;return!1}function Zc(n,t,i){const l=[];for(let h=0;h<n.length;h++){const p=[];for(let v=0;v<n[h].length;v++){const y=qf(n[h][v],i);Wr(t,y),p.push(y)}l.push(p)}return l}function Wc(n,t,i){const l=[];for(let h=0;h<n.length;h++){const p=Zc(n[h],t,i);l.push(p)}return l}function Th(n,t,i,l){if(n[0]<i[0]||n[0]>i[2]){const h=.5*l;let p=n[0]-i[0]>h?-l:i[0]-n[0]>h?l:0;p===0&&(p=n[0]-i[2]>h?-l:i[2]-n[0]>h?l:0),n[0]+=p}Wr(t,n)}function Zs(n,t,i,l){const h=Math.pow(2,l.z)*hs,p=[l.x*hs,l.y*hs],v=[];if(!n)return v;for(const y of n)for(const S of y){const T=[S.x+p[0],S.y+p[1]];Th(T,t,i,h),v.push(T)}return v}function qn(n,t,i,l){const h=Math.pow(2,l.z)*hs,p=[l.x*hs,l.y*hs],v=[];if(!n)return v;for(const S of n){const T=[];for(const A of S){const P=[A.x+p[0],A.y+p[1]];Wr(t,P),T.push(P)}v.push(T)}if(t[2]-t[0]<=h/2){(y=t)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(const S of v)for(const T of S)Th(T,t,i,h)}var y;return v}class Tl{constructor(t,i){this.type=Tn,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Nc(t[1])){const l=t[1];if(l.type==="FeatureCollection")for(let h=0;h<l.features.length;++h){const p=l.features[h].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Tl(l,l.features[h].geometry)}else if(l.type==="Feature"){const h=l.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Tl(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Tl(l,l)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,l){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],v=i.canonicalID();if(!v)return!1;if(l.type==="Polygon"){const y=Zc(l.coordinates,p,v),S=Zs(i.geometry(),h,p,v);if(!Sl(h,p))return!1;for(const T of S)if(!qc(T,y))return!1}if(l.type==="MultiPolygon"){const y=Wc(l.coordinates,p,v),S=Zs(i.geometry(),h,p,v);if(!Sl(h,p))return!1;for(const T of S)if(!Wf(T,y))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,l){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],v=i.canonicalID();if(!v)return!1;if(l.type==="Polygon"){const y=Zc(l.coordinates,p,v),S=qn(i.geometry(),h,p,v);if(!Sl(h,p))return!1;for(const T of S)if(!Aa(T,y))return!1}if(l.type==="MultiPolygon"){const y=Wc(l.coordinates,p,v),S=qn(i.geometry(),h,p,v);if(!Sl(h,p))return!1;for(const T of S)if(!Hf(T,y))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Eh=Tl;function El(n){if(n instanceof us&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof Eh)return!1;let t=!0;return n.eachChild(i=>{t&&!El(i)&&(t=!1)}),t}function Cl(n){if(n instanceof us&&n.name==="feature-state")return!1;let t=!0;return n.eachChild(i=>{t&&!Cl(i)&&(t=!1)}),t}function Hc(n,t){if(n instanceof us&&t.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild(l=>{i&&!Hc(l,t)&&(i=!1)}),i}class Xc{constructor(t,i){this.type=i.type,this.name=t,this.boundExpression=i}static parse(t,i){if(t.length!==2||typeof t[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const l=t[1];return i.scope.has(l)?new Xc(l,i.scope.get(l)):i.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Ch=Xc;class Yc{constructor(t,i=[],l,h=new Nf,p=[]){this.registry=t,this.path=i,this.key=i.map(v=>`[${v}]`).join(""),this.scope=h,this.errors=p,this.expectedType=l}parse(t,i,l,h,p={}){return i?this.concat(i,l,h)._parse(t,p):this._parse(t,p)}_parse(t,i){function l(h,p,v){return v==="assert"?new Fo(p,[h]):v==="coerce"?new Ca(p,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[h];if(p){let v=p.parse(t,this);if(!v)return null;if(this.expectedType){const y=this.expectedType,S=v.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||S.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string"){if(this.checkSubtype(y,S))return null}else v=l(v,y,i.typeAnnotation||"coerce");else v=l(v,y,i.typeAnnotation||"assert")}if(!(v instanceof xl)&&v.type.kind!=="resolvedImage"&&ds(v)){const y=new wl;try{v=new xl(v.type,v.evaluate(y))}catch(S){return this.error(S.message),null}}return v}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,i,l){const h=typeof t=="number"?this.path.concat(t):this.path,p=l?this.scope.concat(l):this.scope;return new Yc(this.registry,h,i||null,p,this.errors)}error(t,...i){const l=`${this.key}${i.map(h=>`[${h}]`).join("")}`;this.errors.push(new mo(l,t))}checkSubtype(t,i){const l=Pr(t,i);return l&&this.error(l),l}}var Ih=Yc;function ds(n){if(n instanceof Ch)return ds(n.boundExpression);if(n instanceof us&&n.name==="error"||n instanceof Gc||n instanceof Eh)return!1;const t=n instanceof Ca||n instanceof Fo;let i=!0;return n.eachChild(l=>{i=t?i&&ds(l):i&&l instanceof xl}),!!i&&El(n)&&Hc(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Ws(n,t){const i=n.length-1;let l,h,p=0,v=i,y=0;for(;p<=v;)if(y=Math.floor((p+v)/2),l=n[y],h=n[y+1],l<=t){if(y===i||t<h)return y;p=y+1}else{if(!(l>t))throw new ar("Input is not a number.");v=y-1}return 0}class Kc{constructor(t,i,l){this.type=t,this.input=i,this.labels=[],this.outputs=[];for(const[h,p]of l)this.labels.push(h),this.outputs.push(p)}static parse(t,i){if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");const l=i.parse(t[1],1,Et);if(!l)return null;const h=[];let p=null;i.expectedType&&i.expectedType.kind!=="value"&&(p=i.expectedType);for(let v=1;v<t.length;v+=2){const y=v===1?-1/0:t[v],S=t[v+1],T=v,A=v+1;if(typeof y!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(h.length&&h[h.length-1][0]>=y)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const P=i.parse(S,A,p);if(!P)return null;p=p||P.type,h.push([y,P])}return new Kc(p,l,h)}evaluate(t){const i=this.labels,l=this.outputs;if(i.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=i[0])return l[0].evaluate(t);const p=i.length;return h>=i[p-1]?l[p-1].evaluate(t):l[Ws(i,h)].evaluate(t)}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&t.push(this.labels[i]),t.push(this.outputs[i].serialize());return t}}var Ah=Kc;function Fn(n,t,i){return n*(1-i)+t*i}var Il=Object.freeze({__proto__:null,number:Fn,color:function(n,t,i){return new Li(Fn(n.r,t.r,i),Fn(n.g,t.g,i),Fn(n.b,t.b,i),Fn(n.a,t.a,i))},array:function(n,t,i){return n.map((l,h)=>Fn(l,t[h],i))}});const Xf=.95047,Yf=1.08883,kh=4/29,Mh=6/29,Ph=3*Mh*Mh,Kf=Math.PI/180,Og=180/Math.PI;function Jc(n){return n>.008856451679035631?Math.pow(n,1/3):n/Ph+kh}function zh(n){return n>Mh?n*n*n:Ph*(n-kh)}function Qc(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function eu(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Jf(n){const t=eu(n.r),i=eu(n.g),l=eu(n.b),h=Jc((.4124564*t+.3575761*i+.1804375*l)/Xf),p=Jc((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*p-16,a:500*(h-p),b:200*(p-Jc((.0193339*t+.119192*i+.9503041*l)/Yf)),alpha:n.a}}function Qf(n){let t=(n.l+16)/116,i=isNaN(n.a)?t:t+n.a/500,l=isNaN(n.b)?t:t-n.b/200;return t=1*zh(t),i=Xf*zh(i),l=Yf*zh(l),new Li(Qc(3.2404542*i-1.5371385*t-.4985314*l),Qc(-.969266*i+1.8760108*t+.041556*l),Qc(.0556434*i-.2040259*t+1.0572252*l),n.alpha)}function Fg(n,t,i){const l=t-n;return n+i*(l>180||l<-180?l-360*Math.round(l/360):l)}const Al={forward:Jf,reverse:Qf,interpolate:function(n,t,i){return{l:Fn(n.l,t.l,i),a:Fn(n.a,t.a,i),b:Fn(n.b,t.b,i),alpha:Fn(n.alpha,t.alpha,i)}}},kl={forward:function(n){const{l:t,a:i,b:l}=Jf(n),h=Math.atan2(l,i)*Og;return{h:h<0?h+360:h,c:Math.sqrt(i*i+l*l),l:t,alpha:n.a}},reverse:function(n){const t=n.h*Kf,i=n.c;return Qf({l:n.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:n.alpha})},interpolate:function(n,t,i){return{h:Fg(n.h,t.h,i),c:Fn(n.c,t.c,i),l:Fn(n.l,t.l,i),alpha:Fn(n.alpha,t.alpha,i)}}};var ep=Object.freeze({__proto__:null,lab:Al,hcl:kl});class Ml{constructor(t,i,l,h,p){this.type=t,this.operator=i,this.interpolation=l,this.input=h,this.labels=[],this.outputs=[];for(const[v,y]of p)this.labels.push(v),this.outputs.push(y)}static interpolationFactor(t,i,l,h){let p=0;if(t.name==="exponential")p=Lh(i,t.base,l,h);else if(t.name==="linear")p=Lh(i,1,l,h);else if(t.name==="cubic-bezier"){const v=t.controlPoints;p=new K(v[0],v[1],v[2],v[3]).solve(Lh(i,1,l,h))}return p}static parse(t,i){let[l,h,p,...v]=t;if(!Array.isArray(h)||h.length===0)return i.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const T=h[1];if(typeof T!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:T}}else{if(h[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const T=h.slice(1);if(T.length!==4||T.some(A=>typeof A!="number"||A<0||A>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:T}}}if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(p=i.parse(p,2,Et),!p)return null;const y=[];let S=null;l==="interpolate-hcl"||l==="interpolate-lab"?S=go:i.expectedType&&i.expectedType.kind!=="value"&&(S=i.expectedType);for(let T=0;T<v.length;T+=2){const A=v[T],P=v[T+1],D=T+3,V=T+4;if(typeof A!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(y.length&&y[y.length-1][0]>=A)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const $=i.parse(P,V,S);if(!$)return null;S=S||$.type,y.push([A,$])}return S.kind==="number"||S.kind==="color"||S.kind==="array"&&S.itemType.kind==="number"&&typeof S.N=="number"?new Ml(S,l,h,p,y):i.error(`Type ${si(S)} is not interpolatable.`)}evaluate(t){const i=this.labels,l=this.outputs;if(i.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=i[0])return l[0].evaluate(t);const p=i.length;if(h>=i[p-1])return l[p-1].evaluate(t);const v=Ws(i,h),y=Ml.interpolationFactor(this.interpolation,h,i[v],i[v+1]),S=l[v].evaluate(t),T=l[v+1].evaluate(t);return this.operator==="interpolate"?Il[this.type.kind.toLowerCase()](S,T,y):this.operator==="interpolate-hcl"?kl.reverse(kl.interpolate(kl.forward(S),kl.forward(T),y)):Al.reverse(Al.interpolate(Al.forward(S),Al.forward(T),y))}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,t,this.input.serialize()];for(let l=0;l<this.labels.length;l++)i.push(this.labels[l],this.outputs[l].serialize());return i}}function Lh(n,t,i,l){const h=l-i,p=n-i;return h===0?0:t===1?p/h:(Math.pow(t,p)-1)/(Math.pow(t,h)-1)}var vo=Ml;class Dh{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expectected at least one argument.");let l=null;const h=i.expectedType;h&&h.kind!=="value"&&(l=h);const p=[];for(const y of t.slice(1)){const S=i.parse(y,1+p.length,l,void 0,{typeAnnotation:"omit"});if(!S)return null;l=l||S.type,p.push(S)}const v=h&&p.some(y=>Pr(h,y.type));return new Dh(v?yn:l,p)}evaluate(t){let i,l=null,h=0;for(const p of this.args){if(h++,l=p.evaluate(t),l&&l instanceof Cr&&!l.available&&(i||(i=l),l=null,h===this.args.length))return i;if(l!==null)break}return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var tp=Dh;class tu{constructor(t,i){this.type=i.type,this.bindings=[].concat(t),this.result=i}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const i of this.bindings)t(i[1]);t(this.result)}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let p=1;p<t.length-1;p+=2){const v=t[p];if(typeof v!="string")return i.error(`Expected string, but found ${typeof v} instead.`,p);if(/[^a-zA-Z0-9_]/.test(v))return i.error("Variable names must contain only alphanumeric characters or '_'.",p);const y=i.parse(t[p+1],p+1);if(!y)return null;l.push([v,y])}const h=i.parse(t[t.length-1],t.length-1,i.expectedType,l);return h?new tu(l,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[i,l]of this.bindings)t.push(i,l.serialize());return t.push(this.result.serialize()),t}}var Rh=tu;class nu{constructor(t,i,l){this.type=t,this.index=i,this.input=l}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=i.parse(t[1],1,Et),h=i.parse(t[2],2,Er(i.expectedType||yn));return l&&h?new nu(h.type.itemType,l,h):null}evaluate(t){const i=this.index.evaluate(t),l=this.input.evaluate(t);if(i<0)throw new ar(`Array index out of bounds: ${i} < 0.`);if(i>=l.length)throw new ar(`Array index out of bounds: ${i} > ${l.length-1}.`);if(i!==Math.floor(i))throw new ar(`Array index must be an integer, but found ${i} instead.`);return l[i]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Vg=nu;class Bh{constructor(t,i){this.type=Tn,this.needle=t,this.haystack=i}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=i.parse(t[1],1,yn),h=i.parse(t[2],2,yn);return l&&h?vh(l.type,[Tn,Pn,Et,ba,yn])?new Bh(l,h):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${si(l.type)} instead`):null}evaluate(t){const i=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(l==null)return!1;if(!Gs(i,["boolean","string","number","null"]))throw new ar(`Expected first argument to be of type boolean, string, number or null, but found ${si(qi(i))} instead.`);if(!Gs(l,["string","array"]))throw new ar(`Expected second argument to be of type array or string, but found ${si(qi(l))} instead.`);return l.indexOf(i)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var np=Bh;class Pl{constructor(t,i,l){this.type=Et,this.needle=t,this.haystack=i,this.fromIndex=l}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=i.parse(t[1],1,yn),h=i.parse(t[2],2,yn);if(!l||!h)return null;if(!vh(l.type,[Tn,Pn,Et,ba,yn]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${si(l.type)} instead`);if(t.length===4){const p=i.parse(t[3],3,Et);return p?new Pl(l,h,p):null}return new Pl(l,h)}evaluate(t){const i=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!Gs(i,["boolean","string","number","null"]))throw new ar(`Expected first argument to be of type boolean, string, number or null, but found ${si(qi(i))} instead.`);if(!Gs(l,["string","array"]))throw new ar(`Expected second argument to be of type array or string, but found ${si(qi(l))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(t);return l.indexOf(i,h)}return l.indexOf(i)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var ip=Pl;class Oh{constructor(t,i,l,h,p,v){this.inputType=t,this.type=i,this.input=l,this.cases=h,this.outputs=p,this.otherwise=v}static parse(t,i){if(t.length<5)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return i.error("Expected an even number of arguments.");let l,h;i.expectedType&&i.expectedType.kind!=="value"&&(h=i.expectedType);const p={},v=[];for(let T=2;T<t.length-1;T+=2){let A=t[T];const P=t[T+1];Array.isArray(A)||(A=[A]);const D=i.concat(T);if(A.length===0)return D.error("Expected at least one branch label.");for(const $ of A){if(typeof $!="number"&&typeof $!="string")return D.error("Branch labels must be numbers or strings.");if(typeof $=="number"&&Math.abs($)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $=="number"&&Math.floor($)!==$)return D.error("Numeric branch labels must be integer values.");if(l){if(D.checkSubtype(l,qi($)))return null}else l=qi($);if(p[String($)]!==void 0)return D.error("Branch labels must be unique.");p[String($)]=v.length}const V=i.parse(P,T,h);if(!V)return null;h=h||V.type,v.push(V)}const y=i.parse(t[1],1,yn);if(!y)return null;const S=i.parse(t[t.length-1],t.length-1,h);return S?y.type.kind!=="value"&&i.concat(1).checkSubtype(l,y.type)?null:new Oh(l,h,y,p,v,S):null}evaluate(t){const i=this.input.evaluate(t);return(qi(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),l=[],h={};for(const v of i){const y=h[this.cases[v]];y===void 0?(h[this.cases[v]]=l.length,l.push([this.cases[v],[v]])):l[y][1].push(v)}const p=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,y]of l)t.push(y.length===1?p(y[0]):y.map(p)),t.push(this.outputs[v].serialize());return t.push(this.otherwise.serialize()),t}}var $g=Oh;class Fh{constructor(t,i,l){this.type=t,this.branches=i,this.otherwise=l}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return i.error("Expected an odd number of arguments.");let l;i.expectedType&&i.expectedType.kind!=="value"&&(l=i.expectedType);const h=[];for(let v=1;v<t.length-1;v+=2){const y=i.parse(t[v],v,Tn);if(!y)return null;const S=i.parse(t[v+1],v+1,l);if(!S)return null;h.push([y,S]),l=l||S.type}const p=i.parse(t[t.length-1],t.length-1,l);return p?new Fh(l,h,p):null}evaluate(t){for(const[i,l]of this.branches)if(i.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[i,l]of this.branches)t(i),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var Ng=Fh;class Hs{constructor(t,i,l,h){this.type=t,this.input=i,this.beginIndex=l,this.endIndex=h}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=i.parse(t[1],1,yn),h=i.parse(t[2],2,Et);if(!l||!h)return null;if(!vh(l.type,[Er(yn),Pn,yn]))return i.error(`Expected first argument to be of type array or string, but found ${si(l.type)} instead`);if(t.length===4){const p=i.parse(t[3],3,Et);return p?new Hs(l.type,l,h,p):null}return new Hs(l.type,l,h)}evaluate(t){const i=this.input.evaluate(t),l=this.beginIndex.evaluate(t);if(!Gs(i,["string","array"]))throw new ar(`Expected first argument to be of type array or string, but found ${si(qi(i))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(t);return i.slice(l,h)}return i.slice(l)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var rp=Hs;function Vh(n,t){return n==="=="||n==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function op(n,t,i,l){return l.compare(t,i)===0}function ka(n,t,i){const l=n!=="=="&&n!=="!=";return class S2{constructor(p,v,y){this.type=Tn,this.lhs=p,this.rhs=v,this.collator=y,this.hasUntypedArgument=p.type.kind==="value"||v.type.kind==="value"}static parse(p,v){if(p.length!==3&&p.length!==4)return v.error("Expected two or three arguments.");const y=p[0];let S=v.parse(p[1],1,yn);if(!S)return null;if(!Vh(y,S.type))return v.concat(1).error(`"${y}" comparisons are not supported for type '${si(S.type)}'.`);let T=v.parse(p[2],2,yn);if(!T)return null;if(!Vh(y,T.type))return v.concat(2).error(`"${y}" comparisons are not supported for type '${si(T.type)}'.`);if(S.type.kind!==T.type.kind&&S.type.kind!=="value"&&T.type.kind!=="value")return v.error(`Cannot compare types '${si(S.type)}' and '${si(T.type)}'.`);l&&(S.type.kind==="value"&&T.type.kind!=="value"?S=new Fo(T.type,[S]):S.type.kind!=="value"&&T.type.kind==="value"&&(T=new Fo(S.type,[T])));let A=null;if(p.length===4){if(S.type.kind!=="string"&&T.type.kind!=="string"&&S.type.kind!=="value"&&T.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(A=v.parse(p[3],3,gl),!A)return null}return new S2(S,T,A)}evaluate(p){const v=this.lhs.evaluate(p),y=this.rhs.evaluate(p);if(l&&this.hasUntypedArgument){const S=qi(v),T=qi(y);if(S.kind!==T.kind||S.kind!=="string"&&S.kind!=="number")throw new ar(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${S.kind}, ${T.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const S=qi(v),T=qi(y);if(S.kind!=="string"||T.kind!=="string")return t(p,v,y)}return this.collator?i(p,v,y,this.collator.evaluate(p)):t(p,v,y)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[n];return this.eachChild(v=>{p.push(v.serialize())}),p}}}const Ug=ka("==",function(n,t,i){return t===i},op),sp=ka("!=",function(n,t,i){return t!==i},function(n,t,i,l){return!op(0,t,i,l)}),ap=ka("<",function(n,t,i){return t<i},function(n,t,i,l){return l.compare(t,i)<0}),lp=ka(">",function(n,t,i){return t>i},function(n,t,i,l){return l.compare(t,i)>0}),$h=ka("<=",function(n,t,i){return t<=i},function(n,t,i,l){return l.compare(t,i)<=0}),jg=ka(">=",function(n,t,i){return t>=i},function(n,t,i,l){return l.compare(t,i)>=0});class Nh{constructor(t,i,l,h,p,v){this.type=Pn,this.number=t,this.locale=i,this.currency=l,this.unit=h,this.minFractionDigits=p,this.maxFractionDigits=v}static parse(t,i){if(t.length!==3)return i.error("Expected two arguments.");const l=i.parse(t[1],1,Et);if(!l)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return i.error("NumberFormat options argument must be an object.");let p=null;if(h.locale&&(p=i.parse(h.locale,1,Pn),!p))return null;let v=null;if(h.currency&&(v=i.parse(h.currency,1,Pn),!v))return null;let y=null;if(h.unit&&(y=i.parse(h.unit,1,Pn),!y))return null;let S=null;if(h["min-fraction-digits"]&&(S=i.parse(h["min-fraction-digits"],1,Et),!S))return null;let T=null;return h["max-fraction-digits"]&&(T=i.parse(h["max-fraction-digits"],1,Et),!T)?null:new Nh(l,p,v,y,S,T)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class Uh{constructor(t){this.type=Et,this.input=t}static parse(t,i){if(t.length!==2)return i.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=i.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${si(l.type)} instead.`):new Uh(l):null}evaluate(t){const i=this.input.evaluate(t);if(typeof i=="string"||Array.isArray(i))return i.length;throw new ar(`Expected value to be of type string or array, but found ${si(qi(i))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(i=>{t.push(i.serialize())}),t}}const cp={"==":Ug,"!=":sp,">":lp,"<":ap,">=":jg,"<=":$h,array:Fo,at:Vg,boolean:Fo,case:Ng,coalesce:tp,collator:Gc,format:bl,image:jc,in:np,"index-of":ip,interpolate:vo,"interpolate-hcl":vo,"interpolate-lab":vo,length:Uh,let:Rh,literal:xl,match:$g,number:Fo,"number-format":Nh,object:Fo,slice:rp,step:Ah,string:Fo,"to-boolean":Ca,"to-color":Ca,"to-number":Ca,"to-string":Ca,var:Ch,within:Eh};function up(n,[t,i,l,h]){t=t.evaluate(n),i=i.evaluate(n),l=l.evaluate(n);const p=h?h.evaluate(n):1,v=jf(t,i,l,p);if(v)throw new ar(v);return new Li(t/255*p,i/255*p,l/255*p,p)}function hp(n,t){return n in t}function jh(n,t){const i=t[n];return i===void 0?null:i}function fs(n){return{type:n}}us.register(cp,{error:[{kind:"error"},[Pn],(n,[t])=>{throw new ar(t.evaluate(n))}],typeof:[Pn,[yn],(n,[t])=>si(qi(t.evaluate(n)))],"to-rgba":[Er(Et,4),[go],(n,[t])=>t.evaluate(n).toArray()],rgb:[go,[Et,Et,Et],up],rgba:[go,[Et,Et,Et,Et],up],has:{type:Tn,overloads:[[[Pn],(n,[t])=>hp(t.evaluate(n),n.properties())],[[Pn,js],(n,[t,i])=>hp(t.evaluate(n),i.evaluate(n))]]},get:{type:yn,overloads:[[[Pn],(n,[t])=>jh(t.evaluate(n),n.properties())],[[Pn,js],(n,[t,i])=>jh(t.evaluate(n),i.evaluate(n))]]},"feature-state":[yn,[Pn],(n,[t])=>jh(t.evaluate(n),n.featureState||{})],properties:[js,[],n=>n.properties()],"geometry-type":[Pn,[],n=>n.geometryType()],id:[yn,[],n=>n.id()],zoom:[Et,[],n=>n.globals.zoom],pitch:[Et,[],n=>n.globals.pitch||0],"distance-from-center":[Et,[],n=>n.distanceFromCenter()],"heatmap-density":[Et,[],n=>n.globals.heatmapDensity||0],"line-progress":[Et,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[Et,[],n=>n.globals.skyRadialProgress||0],accumulated:[yn,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[Et,fs(Et),(n,t)=>{let i=0;for(const l of t)i+=l.evaluate(n);return i}],"*":[Et,fs(Et),(n,t)=>{let i=1;for(const l of t)i*=l.evaluate(n);return i}],"-":{type:Et,overloads:[[[Et,Et],(n,[t,i])=>t.evaluate(n)-i.evaluate(n)],[[Et],(n,[t])=>-t.evaluate(n)]]},"/":[Et,[Et,Et],(n,[t,i])=>t.evaluate(n)/i.evaluate(n)],"%":[Et,[Et,Et],(n,[t,i])=>t.evaluate(n)%i.evaluate(n)],ln2:[Et,[],()=>Math.LN2],pi:[Et,[],()=>Math.PI],e:[Et,[],()=>Math.E],"^":[Et,[Et,Et],(n,[t,i])=>Math.pow(t.evaluate(n),i.evaluate(n))],sqrt:[Et,[Et],(n,[t])=>Math.sqrt(t.evaluate(n))],log10:[Et,[Et],(n,[t])=>Math.log(t.evaluate(n))/Math.LN10],ln:[Et,[Et],(n,[t])=>Math.log(t.evaluate(n))],log2:[Et,[Et],(n,[t])=>Math.log(t.evaluate(n))/Math.LN2],sin:[Et,[Et],(n,[t])=>Math.sin(t.evaluate(n))],cos:[Et,[Et],(n,[t])=>Math.cos(t.evaluate(n))],tan:[Et,[Et],(n,[t])=>Math.tan(t.evaluate(n))],asin:[Et,[Et],(n,[t])=>Math.asin(t.evaluate(n))],acos:[Et,[Et],(n,[t])=>Math.acos(t.evaluate(n))],atan:[Et,[Et],(n,[t])=>Math.atan(t.evaluate(n))],min:[Et,fs(Et),(n,t)=>Math.min(...t.map(i=>i.evaluate(n)))],max:[Et,fs(Et),(n,t)=>Math.max(...t.map(i=>i.evaluate(n)))],abs:[Et,[Et],(n,[t])=>Math.abs(t.evaluate(n))],round:[Et,[Et],(n,[t])=>{const i=t.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[Et,[Et],(n,[t])=>Math.floor(t.evaluate(n))],ceil:[Et,[Et],(n,[t])=>Math.ceil(t.evaluate(n))],"filter-==":[Tn,[Pn,yn],(n,[t,i])=>n.properties()[t.value]===i.value],"filter-id-==":[Tn,[yn],(n,[t])=>n.id()===t.value],"filter-type-==":[Tn,[Pn],(n,[t])=>n.geometryType()===t.value],"filter-<":[Tn,[Pn,yn],(n,[t,i])=>{const l=n.properties()[t.value],h=i.value;return typeof l==typeof h&&l<h}],"filter-id-<":[Tn,[yn],(n,[t])=>{const i=n.id(),l=t.value;return typeof i==typeof l&&i<l}],"filter->":[Tn,[Pn,yn],(n,[t,i])=>{const l=n.properties()[t.value],h=i.value;return typeof l==typeof h&&l>h}],"filter-id->":[Tn,[yn],(n,[t])=>{const i=n.id(),l=t.value;return typeof i==typeof l&&i>l}],"filter-<=":[Tn,[Pn,yn],(n,[t,i])=>{const l=n.properties()[t.value],h=i.value;return typeof l==typeof h&&l<=h}],"filter-id-<=":[Tn,[yn],(n,[t])=>{const i=n.id(),l=t.value;return typeof i==typeof l&&i<=l}],"filter->=":[Tn,[Pn,yn],(n,[t,i])=>{const l=n.properties()[t.value],h=i.value;return typeof l==typeof h&&l>=h}],"filter-id->=":[Tn,[yn],(n,[t])=>{const i=n.id(),l=t.value;return typeof i==typeof l&&i>=l}],"filter-has":[Tn,[yn],(n,[t])=>t.value in n.properties()],"filter-has-id":[Tn,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[Tn,[Er(Pn)],(n,[t])=>t.value.indexOf(n.geometryType())>=0],"filter-id-in":[Tn,[Er(yn)],(n,[t])=>t.value.indexOf(n.id())>=0],"filter-in-small":[Tn,[Pn,Er(yn)],(n,[t,i])=>i.value.indexOf(n.properties()[t.value])>=0],"filter-in-large":[Tn,[Pn,Er(yn)],(n,[t,i])=>function(l,h,p,v){for(;p<=v;){const y=p+v>>1;if(h[y]===l)return!0;h[y]>l?v=y-1:p=y+1}return!1}(n.properties()[t.value],i.value,0,i.value.length-1)],all:{type:Tn,overloads:[[[Tn,Tn],(n,[t,i])=>t.evaluate(n)&&i.evaluate(n)],[fs(Tn),(n,t)=>{for(const i of t)if(!i.evaluate(n))return!1;return!0}]]},any:{type:Tn,overloads:[[[Tn,Tn],(n,[t,i])=>t.evaluate(n)||i.evaluate(n)],[fs(Tn),(n,t)=>{for(const i of t)if(i.evaluate(n))return!0;return!1}]]},"!":[Tn,[Tn],(n,[t])=>!t.evaluate(n)],"is-supported-script":[Tn,[Pn],(n,[t])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(t.evaluate(n))}],upcase:[Pn,[Pn],(n,[t])=>t.evaluate(n).toUpperCase()],downcase:[Pn,[Pn],(n,[t])=>t.evaluate(n).toLowerCase()],concat:[Pn,fs(yn),(n,t)=>t.map(i=>yl(i.evaluate(n))).join("")],"resolved-locale":[Pn,[gl],(n,[t])=>t.evaluate(n).resolvedLocale()]});var Ma=cp;function zl(n){return{result:"success",value:n}}function Pa(n){return{result:"error",value:n}}function za(n){return n["property-type"]==="data-driven"}function Vo(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function iu(n){return!!n.expression&&n.expression.interpolated}function Rn(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function ru(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function Gg(n){return n}function Gh(n,t){const i=t.type==="color",l=n.stops&&typeof n.stops[0][0]=="object",h=l||!(l||n.property!==void 0),p=n.type||(iu(t)?"exponential":"interval");if(i&&((n=Oo({},n)).stops&&(n.stops=n.stops.map(T=>[T[0],Li.parse(T[1])])),n.default=Li.parse(n.default?n.default:t.default)),n.colorSpace&&n.colorSpace!=="rgb"&&!ep[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let v,y,S;if(p==="exponential")v=ou;else if(p==="interval")v=dp;else if(p==="categorical"){v=qh,y=Object.create(null);for(const T of n.stops)y[T[0]]=T[1];S=typeof n.stops[0][0]}else{if(p!=="identity")throw new Error(`Unknown function type "${p}"`);v=fp}if(l){const T={},A=[];for(let V=0;V<n.stops.length;V++){const $=n.stops[V],j=$[0].zoom;T[j]===void 0&&(T[j]={zoom:j,type:n.type,property:n.property,default:n.default,stops:[]},A.push(j)),T[j].stops.push([$[0].value,$[1]])}const P=[];for(const V of A)P.push([T[V].zoom,Gh(T[V],t)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:vo.interpolationFactor.bind(void 0,D),zoomStops:P.map(V=>V[0]),evaluate:({zoom:V},$)=>ou({stops:P,base:n.base},t,V).evaluate(V,$)}}if(h){const T=p==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:vo.interpolationFactor.bind(void 0,T),zoomStops:n.stops.map(A=>A[0]),evaluate:({zoom:A})=>v(n,t,A,y,S)}}return{kind:"source",evaluate(T,A){const P=A&&A.properties?A.properties[n.property]:void 0;return P===void 0?Ll(n.default,t.default):v(n,t,P,y,S)}}}function Ll(n,t,i){return n!==void 0?n:t!==void 0?t:i!==void 0?i:void 0}function qh(n,t,i,l,h){return Ll(typeof i===h?l[i]:void 0,n.default,t.default)}function dp(n,t,i){if(Rn(i)!=="number")return Ll(n.default,t.default);const l=n.stops.length;if(l===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[l-1][0])return n.stops[l-1][1];const h=Ws(n.stops.map(p=>p[0]),i);return n.stops[h][1]}function ou(n,t,i){const l=n.base!==void 0?n.base:1;if(Rn(i)!=="number")return Ll(n.default,t.default);const h=n.stops.length;if(h===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[h-1][0])return n.stops[h-1][1];const p=Ws(n.stops.map(A=>A[0]),i),v=function(A,P,D,V){const $=V-D,j=A-D;return $===0?0:P===1?j/$:(Math.pow(P,j)-1)/(Math.pow(P,$)-1)}(i,l,n.stops[p][0],n.stops[p+1][0]),y=n.stops[p][1],S=n.stops[p+1][1];let T=Il[t.type]||Gg;if(n.colorSpace&&n.colorSpace!=="rgb"){const A=ep[n.colorSpace];T=(P,D)=>A.reverse(A.interpolate(A.forward(P),A.forward(D),v))}return typeof y.evaluate=="function"?{evaluate(...A){const P=y.evaluate.apply(void 0,A),D=S.evaluate.apply(void 0,A);if(P!==void 0&&D!==void 0)return T(P,D,v)}}:T(y,S,v)}function fp(n,t,i){return t.type==="color"?i=Li.parse(i):t.type==="formatted"?i=Lr.fromString(i.toString()):t.type==="resolvedImage"?i=Cr.fromString(i.toString()):Rn(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),Ll(i,n.default,t.default)}class su{constructor(t,i){this.expression=t,this._warningHistory={},this._evaluator=new wl,this._defaultValue=i?function(l){return l.type==="color"&&(ru(l.default)||Array.isArray(l.default))?new Li(0,0,0,0):l.type==="color"?Li.parse(l.default)||null:l.default===void 0?null:l.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(t,i,l,h,p,v,y,S){return this._evaluator.globals=t,this._evaluator.feature=i,this._evaluator.featureState=l,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=S||null,this.expression.evaluate(this._evaluator)}evaluate(t,i,l,h,p,v,y,S){this._evaluator.globals=t,this._evaluator.feature=i||null,this._evaluator.featureState=l||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=S||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new ar(`Expected value to be one of ${Object.keys(this._enumValues).map(A=>JSON.stringify(A)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function La(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in Ma}function Da(n,t){const i=new Ih(Ma,[],t?function(h){const p={color:go,string:Pn,number:Et,enum:Pn,boolean:Tn,formatted:wa,resolvedImage:Sa};return h.type==="array"?Er(p[h.value]||yn,h.length):p[h.type]}(t):void 0),l=i.parse(n,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?zl(new su(l,t)):Pa(i.errors)}class au{constructor(t,i){this.kind=t,this._styleExpression=i,this.isStateDependent=t!=="constant"&&!Cl(i.expression)}evaluateWithoutErrorHandling(t,i,l,h,p,v){return this._styleExpression.evaluateWithoutErrorHandling(t,i,l,h,p,v)}evaluate(t,i,l,h,p,v){return this._styleExpression.evaluate(t,i,l,h,p,v)}}class Xs{constructor(t,i,l,h){this.kind=t,this.zoomStops=l,this._styleExpression=i,this.isStateDependent=t!=="camera"&&!Cl(i.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,i,l,h,p,v){return this._styleExpression.evaluateWithoutErrorHandling(t,i,l,h,p,v)}evaluate(t,i,l,h,p,v){return this._styleExpression.evaluate(t,i,l,h,p,v)}interpolationFactor(t,i,l){return this.interpolationType?vo.interpolationFactor(this.interpolationType,t,i,l):0}}function Ys(n,t){if((n=Da(n,t)).result==="error")return n;const i=n.value.expression,l=El(i);if(!l&&!za(t))return Pa([new mo("","data expressions not supported")]);const h=Hc(i,["zoom","pitch","distance-from-center"]);if(!h&&!Vo(t))return Pa([new mo("","zoom expressions not supported")]);const p=Rl(i);return p||h?p instanceof mo?Pa([p]):p instanceof vo&&!iu(t)?Pa([new mo("",'"interpolate" expressions cannot be used with this property')]):zl(p?new Xs(l?"camera":"composite",n.value,p.labels,p instanceof vo?p.interpolation:void 0):new au(l?"constant":"source",n.value)):Pa([new mo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Dl{constructor(t,i){this._parameters=t,this._specification=i,Oo(this,Gh(this._parameters,this._specification))}static deserialize(t){return new Dl(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Rl(n){let t=null;if(n instanceof Rh)t=Rl(n.result);else if(n instanceof tp){for(const i of n.args)if(t=Rl(i),t)break}else(n instanceof Ah||n instanceof vo)&&n.input instanceof us&&n.input.name==="zoom"&&(t=n);return t instanceof mo||n.eachChild(i=>{const l=Rl(i);l instanceof mo?t=l:!t&&l?t=new mo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new mo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}class Bt{constructor(t,i,l,h){this.message=(t?`${t}: `:"")+l,h&&(this.identifier=h),i!=null&&i.__line__&&(this.line=i.__line__)}}function Hr(n){const t=n.key,i=n.value,l=n.valueSpec||{},h=n.objectElementValidators||{},p=n.style,v=n.styleSpec;let y=[];const S=Rn(i);if(S!=="object")return[new Bt(t,i,`object expected, ${S} found`)];for(const T in i){const A=T.split(".")[0],P=l[A]||l["*"];let D;h[A]?D=h[A]:l[A]?D=gr:h["*"]?D=h["*"]:l["*"]&&(D=gr),D?y=y.concat(D({key:(t&&`${t}.`)+T,value:i[T],valueSpec:P,style:p,styleSpec:v,object:i,objectKey:T},i)):y.push(new Bt(t,i[T],`unknown property "${T}"`))}for(const T in l)h[T]||l[T].required&&l[T].default===void 0&&i[T]===void 0&&y.push(new Bt(t,i,`missing required property "${T}"`));return y}function pp(n){const t=n.value,i=n.valueSpec,l=n.style,h=n.styleSpec,p=n.key,v=n.arrayElementValidator||gr;if(Rn(t)!=="array")return[new Bt(p,t,`array expected, ${Rn(t)} found`)];if(i.length&&t.length!==i.length)return[new Bt(p,t,`array length ${i.length} expected, length ${t.length} found`)];if(i["min-length"]&&t.length<i["min-length"])return[new Bt(p,t,`array length at least ${i["min-length"]} expected, length ${t.length} found`)];let y={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};h.$version<7&&(y.function=i.function),Rn(i.value)==="object"&&(y=i.value);let S=[];for(let T=0;T<t.length;T++)S=S.concat(v({array:t,arrayIndex:T,value:t[T],valueSpec:y,style:l,styleSpec:h,key:`${p}[${T}]`}));return S}function Zh(n){const t=n.key,i=n.value,l=n.valueSpec;let h=Rn(i);if(h==="number"&&i!=i&&(h="NaN"),h!=="number")return[new Bt(t,i,`number expected, ${h} found`)];if("minimum"in l){let p=l.minimum;if(Rn(l.minimum)==="array"&&(p=l.minimum[n.arrayIndex]),i<p)return[new Bt(t,i,`${i} is less than the minimum value ${p}`)]}if("maximum"in l){let p=l.maximum;if(Rn(l.maximum)==="array"&&(p=l.maximum[n.arrayIndex]),i>p)return[new Bt(t,i,`${i} is greater than the maximum value ${p}`)]}return[]}function Bl(n){const t=n.valueSpec,i=Bi(n.value.type);let l,h,p,v={};const y=i!=="categorical"&&n.value.property===void 0,S=!y,T=Rn(n.value.stops)==="array"&&Rn(n.value.stops[0])==="array"&&Rn(n.value.stops[0][0])==="object",A=Hr({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(V){if(i==="identity")return[new Bt(V.key,V.value,'identity function may not have a "stops" property')];let $=[];const j=V.value;return $=$.concat(pp({key:V.key,value:j,valueSpec:V.valueSpec,style:V.style,styleSpec:V.styleSpec,arrayElementValidator:P})),Rn(j)==="array"&&j.length===0&&$.push(new Bt(V.key,j,"array must have at least one stop")),$},default:function(V){return gr({key:V.key,value:V.value,valueSpec:t,style:V.style,styleSpec:V.styleSpec})}}});return i==="identity"&&y&&A.push(new Bt(n.key,n.value,'missing required property "property"')),i==="identity"||n.value.stops||A.push(new Bt(n.key,n.value,'missing required property "stops"')),i==="exponential"&&n.valueSpec.expression&&!iu(n.valueSpec)&&A.push(new Bt(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(S&&!za(n.valueSpec)?A.push(new Bt(n.key,n.value,"property functions not supported")):y&&!Vo(n.valueSpec)&&A.push(new Bt(n.key,n.value,"zoom functions not supported"))),i!=="categorical"&&!T||n.value.property!==void 0||A.push(new Bt(n.key,n.value,'"property" property is required')),A;function P(V){let $=[];const j=V.value,X=V.key;if(Rn(j)!=="array")return[new Bt(X,j,`array expected, ${Rn(j)} found`)];if(j.length!==2)return[new Bt(X,j,`array length 2 expected, length ${j.length} found`)];if(T){if(Rn(j[0])!=="object")return[new Bt(X,j,`object expected, ${Rn(j[0])} found`)];if(j[0].zoom===void 0)return[new Bt(X,j,"object stop key must have zoom")];if(j[0].value===void 0)return[new Bt(X,j,"object stop key must have value")];const le=Bi(j[0].zoom);if(typeof le!="number")return[new Bt(X,j[0].zoom,"stop zoom values must be numbers")];if(p&&p>le)return[new Bt(X,j[0].zoom,"stop zoom values must appear in ascending order")];le!==p&&(p=le,h=void 0,v={}),$=$.concat(Hr({key:`${X}[0]`,value:j[0],valueSpec:{zoom:{}},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{zoom:Zh,value:D}}))}else $=$.concat(D({key:`${X}[0]`,value:j[0],valueSpec:{},style:V.style,styleSpec:V.styleSpec},j));return La(cs(j[1]))?$.concat([new Bt(`${X}[1]`,j[1],"expressions are not allowed in function stops.")]):$.concat(gr({key:`${X}[1]`,value:j[1],valueSpec:t,style:V.style,styleSpec:V.styleSpec}))}function D(V,$){const j=Rn(V.value),X=Bi(V.value),le=V.value!==null?V.value:$;if(l){if(j!==l)return[new Bt(V.key,le,`${j} stop domain type must match previous stop domain type ${l}`)]}else l=j;if(j!=="number"&&j!=="string"&&j!=="boolean"&&typeof X!="number"&&typeof X!="string"&&typeof X!="boolean")return[new Bt(V.key,le,"stop domain value must be a number, string, or boolean")];if(j!=="number"&&i!=="categorical"){let ye=`number expected, ${j} found`;return za(t)&&i===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Bt(V.key,le,ye)]}return i!=="categorical"||j!=="number"||typeof X=="number"&&isFinite(X)&&Math.floor(X)===X?i!=="categorical"&&j==="number"&&typeof X=="number"&&typeof h=="number"&&h!==void 0&&X<h?[new Bt(V.key,le,"stop domain values must appear in ascending order")]:(h=X,i==="categorical"&&X in v?[new Bt(V.key,le,"stop domain values must be unique")]:(v[X]=!0,[])):[new Bt(V.key,le,`integer expected, found ${String(X)}`)]}}function Ra(n){const t=(n.expressionContext==="property"?Ys:Da)(cs(n.value),n.valueSpec);if(t.result==="error")return t.value.map(l=>new Bt(`${n.key}${l.key}`,n.value,l.message));const i=t.value.expression||t.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!i.outputDefined())return[new Bt(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!Cl(i))return[new Bt(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter")return mp(i,n);if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!Hc(i,["zoom","feature-state"]))return[new Bt(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!El(i))return[new Bt(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function mp(n,t){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const h of t.valueSpec.expression.parameters)i.delete(h);if(i.size===0)return[];const l=[];return n instanceof us&&i.has(n.name)?[new Bt(t.key,t.value,`["${n.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(n.eachChild(h=>{l.push(...mp(h,t))}),l)}function lu(n){const t=n.key,i=n.value,l=n.valueSpec,h=[];return Array.isArray(l.values)?l.values.indexOf(Bi(i))===-1&&h.push(new Bt(t,i,`expected one of [${l.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(l.values).indexOf(Bi(i))===-1&&h.push(new Bt(t,i,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(i)} found`)),h}function Wh(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const t of n.slice(1))if(!Wh(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function cu(n,t="fill"){if(n==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Wh(n)||(n=hu(n));const i=n;let l=!0;try{l=function(T){if(!nr(T))return T;let A=cs(T);return Fl(A),A=Ol(A),A}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const h=et[`filter_${t}`],p=Da(l,h);let v=null;if(p.result==="error")throw new Error(p.value.map(T=>`${T.key}: ${T.message}`).join(", "));v=(T,A,P)=>p.value.evaluate(T,A,{},P);let y=null,S=null;if(l!==i){const T=Da(i,h);if(T.result==="error")throw new Error(T.value.map(A=>`${A.key}: ${A.message}`).join(", "));y=(A,P,D,V,$)=>T.value.evaluate(A,P,{},D,void 0,void 0,V,$),S=!El(T.value.expression)}return{filter:v,dynamicFilter:y||void 0,needGeometry:gp(l),needFeature:!!S}}function Ol(n){if(!Array.isArray(n))return n;const t=function(i){if(uu.has(i[0])){for(let l=1;l<i.length;l++)if(nr(i[l]))return!0}return i}(n);return t===!0?t:t.map(i=>Ol(i))}function Fl(n){let t=!1;const i=[];if(n[0]==="case"){for(let l=1;l<n.length-1;l+=2)t=t||nr(n[l]),i.push(n[l+1]);i.push(n[n.length-1])}else if(n[0]==="match"){t=t||nr(n[1]);for(let l=2;l<n.length-1;l+=2)i.push(n[l+1]);i.push(n[n.length-1])}else if(n[0]==="step"){t=t||nr(n[1]);for(let l=1;l<n.length-1;l+=2)i.push(n[l+1])}t&&(n.length=0,n.push("any",...i));for(let l=1;l<n.length;l++)Fl(n[l])}function nr(n){if(!Array.isArray(n))return!1;if((t=n[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let i=1;i<n.length;i++)if(nr(n[i]))return!0;return!1}const uu=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function qg(n,t){return n<t?-1:n>t?1:0}function gp(n){if(!Array.isArray(n))return!1;if(n[0]==="within")return!0;for(let t=1;t<n.length;t++)if(gp(n[t]))return!0;return!1}function hu(n){if(!n)return!0;const t=n[0];return n.length<=1?t!=="any":t==="=="?Hh(n[1],n[2],"=="):t==="!="?Ba(Hh(n[1],n[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Hh(n[1],n[2],t):t==="any"?(i=n.slice(1),["any"].concat(i.map(hu))):t==="all"?["all"].concat(n.slice(1).map(hu)):t==="none"?["all"].concat(n.slice(1).map(hu).map(Ba)):t==="in"?du(n[1],n.slice(2)):t==="!in"?Ba(du(n[1],n.slice(2))):t==="has"?vp(n[1]):t==="!has"?Ba(vp(n[1])):t!=="within"||n;var i}function Hh(n,t,i){switch(n){case"$type":return[`filter-type-${i}`,t];case"$id":return[`filter-id-${i}`,t];default:return[`filter-${i}`,n,t]}}function du(n,t){if(t.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(i=>typeof i!=typeof t[0])?["filter-in-large",n,["literal",t.sort(qg)]]:["filter-in-small",n,["literal",t]]}}function vp(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Ba(n){return["!",n]}function Xh(n){return Wh(cs(n.value))?Ra(Oo({},n,{expressionContext:"filter",valueSpec:n.styleSpec[`filter_${n.layerType||"fill"}`]})):_p(n)}function _p(n){const t=n.value,i=n.key;if(Rn(t)!=="array")return[new Bt(i,t,`array expected, ${Rn(t)} found`)];const l=n.styleSpec;let h,p=[];if(t.length<1)return[new Bt(i,t,"filter array must have at least 1 element")];switch(p=p.concat(lu({key:`${i}[0]`,value:t[0],valueSpec:l.filter_operator,style:n.style,styleSpec:n.styleSpec})),Bi(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Bi(t[1])==="$type"&&p.push(new Bt(i,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&p.push(new Bt(i,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=Rn(t[1]),h!=="string"&&p.push(new Bt(`${i}[1]`,t[1],`string expected, ${h} found`)));for(let v=2;v<t.length;v++)h=Rn(t[v]),Bi(t[1])==="$type"?p=p.concat(lu({key:`${i}[${v}]`,value:t[v],valueSpec:l.geometry_type,style:n.style,styleSpec:n.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&p.push(new Bt(`${i}[${v}]`,t[v],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let v=1;v<t.length;v++)p=p.concat(_p({key:`${i}[${v}]`,value:t[v],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":h=Rn(t[1]),t.length!==2?p.push(new Bt(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&p.push(new Bt(`${i}[1]`,t[1],`string expected, ${h} found`));break;case"within":h=Rn(t[1]),t.length!==2?p.push(new Bt(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="object"&&p.push(new Bt(`${i}[1]`,t[1],`object expected, ${h} found`))}return p}function fu(n,t){const i=n.key,l=n.style,h=n.styleSpec,p=n.value,v=n.objectKey,y=h[`${t}_${n.layerType}`];if(!y)return[];const S=v.match(/^(.*)-transition$/);if(t==="paint"&&S&&y[S[1]]&&y[S[1]].transition)return gr({key:i,value:p,valueSpec:h.transition,style:l,styleSpec:h});const T=n.valueSpec||y[v];if(!T)return[new Bt(i,p,`unknown property "${v}"`)];let A;if(Rn(p)==="string"&&za(T)&&!T.tokens&&(A=/^{([^}]+)}$/.exec(p)))return[new Bt(i,p,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];const P=[];return n.layerType==="symbol"&&(v==="text-field"&&l&&!l.glyphs&&P.push(new Bt(i,p,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&ru(cs(p))&&Bi(p.type)==="identity"&&P.push(new Bt(i,p,'"text-font" does not support identity functions'))),P.concat(gr({key:n.key,value:p,valueSpec:T,style:l,styleSpec:h,expressionContext:"property",propertyType:t,propertyKey:v}))}function yp(n){return fu(n,"paint")}function Yh(n){return fu(n,"layout")}function Kh(n){let t=[];const i=n.value,l=n.key,h=n.style,p=n.styleSpec;i.type||i.ref||t.push(new Bt(l,i,'either "type" or "ref" is required'));let v=Bi(i.type);const y=Bi(i.ref);if(i.id){const S=Bi(i.id);for(let T=0;T<n.arrayIndex;T++){const A=h.layers[T];Bi(A.id)===S&&t.push(new Bt(l,i.id,`duplicate layer id "${i.id}", previously used at line ${A.id.__line__}`))}}if("ref"in i){let S;["type","source","source-layer","filter","layout"].forEach(T=>{T in i&&t.push(new Bt(l,i[T],`"${T}" is prohibited for ref layers`))}),h.layers.forEach(T=>{Bi(T.id)===y&&(S=T)}),S?S.ref?t.push(new Bt(l,i.ref,"ref cannot reference another ref layer")):v=Bi(S.type):typeof y=="string"&&t.push(new Bt(l,i.ref,`ref layer "${y}" not found`))}else if(v!=="background"&&v!=="sky")if(i.source){const S=h.sources&&h.sources[i.source],T=S&&Bi(S.type);S?T==="vector"&&v==="raster"?t.push(new Bt(l,i.source,`layer "${i.id}" requires a raster source`)):T==="raster"&&v!=="raster"?t.push(new Bt(l,i.source,`layer "${i.id}" requires a vector source`)):T!=="vector"||i["source-layer"]?T==="raster-dem"&&v!=="hillshade"?t.push(new Bt(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||T==="geojson"&&S.lineMetrics||t.push(new Bt(l,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Bt(l,i,`layer "${i.id}" must specify a "source-layer"`)):t.push(new Bt(l,i.source,`source "${i.source}" not found`))}else t.push(new Bt(l,i,'missing required property "source"'));return t=t.concat(Hr({key:l,value:i,valueSpec:p.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>gr({key:`${l}.type`,value:i.type,valueSpec:p.layer.type,style:n.style,styleSpec:n.styleSpec,object:i,objectKey:"type"}),filter:S=>Xh(Oo({layerType:v},S)),layout:S=>Hr({layer:i,key:S.key,value:S.value,valueSpec:{},style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":T=>Yh(Oo({layerType:v},T))}}),paint:S=>Hr({layer:i,key:S.key,value:S.value,valueSpec:{},style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":T=>yp(Oo({layerType:v},T))}})}})),t}function Oa(n){const t=n.value,i=n.key,l=Rn(t);return l!=="string"?[new Bt(i,t,`string expected, ${l} found`)]:[]}const pu={promoteId:function({key:n,value:t}){if(Rn(t)==="string")return Oa({key:n,value:t});{const i=[];for(const l in t)i.push(...Oa({key:`${n}.${l}`,value:t[l]}));return i}}};function Vl(n){const t=n.value,i=n.key,l=n.styleSpec,h=n.style;if(!t.type)return[new Bt(i,t,'"type" is required')];const p=Bi(t.type);let v;switch(p){case"vector":case"raster":case"raster-dem":return v=Hr({key:i,value:t,valueSpec:l[`source_${p.replace("-","_")}`],style:n.style,styleSpec:l,objectElementValidators:pu}),v;case"geojson":if(v=Hr({key:i,value:t,valueSpec:l.source_geojson,style:h,styleSpec:l,objectElementValidators:pu}),t.cluster)for(const y in t.clusterProperties){const[S,T]=t.clusterProperties[y],A=typeof S=="string"?[S,["accumulated"],["get",y]]:S;v.push(...Ra({key:`${i}.${y}.map`,value:T,expressionContext:"cluster-map"})),v.push(...Ra({key:`${i}.${y}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return v;case"video":return Hr({key:i,value:t,valueSpec:l.source_video,style:h,styleSpec:l});case"image":return Hr({key:i,value:t,valueSpec:l.source_image,style:h,styleSpec:l});case"canvas":return[new Bt(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return lu({key:`${i}.type`,value:t.type,valueSpec:{values:xp(l)},style:h,styleSpec:l})}}function xp(n){return n.source.reduce((t,i)=>{const l=n[i];return l.type.type==="enum"&&(t=t.concat(Object.keys(l.type.values))),t},[])}function bp(n){const t=n.value,i=n.styleSpec,l=i.light,h=n.style;let p=[];const v=Rn(t);if(t===void 0)return p;if(v!=="object")return p=p.concat([new Bt("light",t,`object expected, ${v} found`)]),p;for(const y in t){const S=y.match(/^(.*)-transition$/);p=p.concat(S&&l[S[1]]&&l[S[1]].transition?gr({key:y,value:t[y],valueSpec:i.transition,style:h,styleSpec:i}):l[y]?gr({key:y,value:t[y],valueSpec:l[y],style:h,styleSpec:i}):[new Bt(y,t[y],`unknown property "${y}"`)])}return p}function Jh(n){const t=n.value,i=n.key,l=n.style,h=n.styleSpec,p=h.terrain;let v=[];const y=Rn(t);if(t===void 0)return v;if(y!=="object")return v=v.concat([new Bt("terrain",t,`object expected, ${y} found`)]),v;for(const S in t){const T=S.match(/^(.*)-transition$/);v=v.concat(T&&p[T[1]]&&p[T[1]].transition?gr({key:S,value:t[S],valueSpec:h.transition,style:l,styleSpec:h}):p[S]?gr({key:S,value:t[S],valueSpec:p[S],style:l,styleSpec:h}):[new Bt(S,t[S],`unknown property "${S}"`)])}if(t.source){const S=l.sources&&l.sources[t.source],T=S&&Bi(S.type);S?T!=="raster-dem"&&v.push(new Bt(i,t.source,`terrain cannot be used with a source of type ${String(T)}, it only be used with a "raster-dem" source type`)):v.push(new Bt(i,t.source,`source "${t.source}" not found`))}else v.push(new Bt(i,t,'terrain is missing required property "source"'));return v}function wp(n){const t=n.value,i=n.style,l=n.styleSpec,h=l.fog;let p=[];const v=Rn(t);if(t===void 0)return p;if(v!=="object")return p=p.concat([new Bt("fog",t,`object expected, ${v} found`)]),p;for(const y in t){const S=y.match(/^(.*)-transition$/);p=p.concat(S&&h[S[1]]&&h[S[1]].transition?gr({key:y,value:t[y],valueSpec:l.transition,style:i,styleSpec:l}):h[y]?gr({key:y,value:t[y],valueSpec:h[y],style:i,styleSpec:l}):[new Bt(y,t[y],`unknown property "${y}"`)])}return p}const mu={"*":()=>[],array:pp,boolean:function(n){const t=n.value,i=n.key,l=Rn(t);return l!=="boolean"?[new Bt(i,t,`boolean expected, ${l} found`)]:[]},number:Zh,color:function(n){const t=n.key,i=n.value,l=Rn(i);return l!=="string"?[new Bt(t,i,`color expected, ${l} found`)]:_h(i)===null?[new Bt(t,i,`color expected, "${i}" found`)]:[]},enum:lu,filter:Xh,function:Bl,layer:Kh,object:Hr,source:Vl,light:bp,terrain:Jh,fog:wp,string:Oa,formatted:function(n){return Oa(n).length===0?[]:Ra(n)},resolvedImage:function(n){return Oa(n).length===0?[]:Ra(n)},projection:function(n){const t=n.value,i=n.styleSpec,l=i.projection,h=n.style;let p=[];const v=Rn(t);if(v==="object")for(const y in t)p=p.concat(gr({key:y,value:t[y],valueSpec:l[y],style:h,styleSpec:i}));else v!=="string"&&(p=p.concat([new Bt("projection",t,`object or string expected, ${v} found`)]));return p}};function gr(n){const t=n.value,i=n.valueSpec,l=n.styleSpec;return i.expression&&ru(Bi(t))?Bl(n):i.expression&&La(cs(t))?Ra(n):i.type&&mu[i.type]?mu[i.type](n):Hr(Oo({},n,{valueSpec:i.type?l[i.type]:i}))}function Zg(n){const t=n.value,i=n.key,l=Oa(n);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new Bt(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new Bt(i,t,'"glyphs" url must include a "{range}" token'))),l}function Sp(n,t=et){return $o(gr({key:"",value:n,valueSpec:t.$root,styleSpec:t,style:n,objectElementValidators:{glyphs:Zg,"*":()=>[]}}))}const Wg=n=>$o(yp(n)),Tp=n=>$o(Yh(n));function $o(n){return n.slice().sort((t,i)=>t.line&&i.line?t.line-i.line:0)}function Ep(n,t){let i=!1;if(t&&t.length)for(const l of t)n.fire(new ls(new Error(l.message))),i=!0;return i}var Fa=_o;function _o(n,t,i){var l=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var h=new Int32Array(this.arrayBuffer);n=h[0],this.d=(t=h[1])+2*(i=h[2]);for(var p=0;p<this.d*this.d;p++){var v=h[3+p],y=h[3+p+1];l.push(v===y?null:h.subarray(v,y))}var S=h[3+l.length+1];this.keys=h.subarray(h[3+l.length],S),this.bboxes=h.subarray(S),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var T=0;T<this.d*this.d;T++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=n,this.padding=i,this.scale=t/n,this.uid=0;var A=i/t*n;this.min=-A,this.max=n+A}_o.prototype.insert=function(n,t,i,l,h){this._forEachCell(t,i,l,h,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(h)},_o.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},_o.prototype._insertCell=function(n,t,i,l,h,p){this.cells[h].push(p)},_o.prototype.query=function(n,t,i,l,h){var p=this.min,v=this.max;if(n<=p&&t<=p&&v<=i&&v<=l&&!h)return Array.prototype.slice.call(this.keys);var y=[];return this._forEachCell(n,t,i,l,this._queryCell,y,{},h),y},_o.prototype._queryCell=function(n,t,i,l,h,p,v,y){var S=this.cells[h];if(S!==null)for(var T=this.keys,A=this.bboxes,P=0;P<S.length;P++){var D=S[P];if(v[D]===void 0){var V=4*D;(y?y(A[V+0],A[V+1],A[V+2],A[V+3]):n<=A[V+2]&&t<=A[V+3]&&i>=A[V+0]&&l>=A[V+1])?(v[D]=!0,p.push(T[D])):v[D]=!1}}},_o.prototype._forEachCell=function(n,t,i,l,h,p,v,y){for(var S=this._convertToCellCoord(n),T=this._convertToCellCoord(t),A=this._convertToCellCoord(i),P=this._convertToCellCoord(l),D=S;D<=A;D++)for(var V=T;V<=P;V++){var $=this.d*V+D;if((!y||y(this._convertFromCellCoord(D),this._convertFromCellCoord(V),this._convertFromCellCoord(D+1),this._convertFromCellCoord(V+1)))&&h.call(this,n,t,i,l,$,p,v,y))return}},_o.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},_o.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},_o.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var h=new Int32Array(t+i+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var p=t,v=0;v<n.length;v++){var y=n[v];h[3+v]=p,h.set(y,p),p+=y.length}return h[3+n.length]=p,h.set(this.keys,p),h[3+n.length+1]=p+=this.keys.length,h.set(this.bboxes,p),p+=this.bboxes.length,h.buffer};const gu={};function $t(n,t,i={}){Object.defineProperty(n,"_classRegistryKey",{value:t,writeable:!1}),gu[t]={klass:n,omit:i.omit||[]}}$t(Object,"Object"),Fa.serialize=function(n,t){const i=n.toArrayBuffer();return t&&t.push(i),{buffer:i}},Fa.deserialize=function(n){return new Fa(n.buffer)},Object.defineProperty(Fa,"name",{value:"Grid"}),$t(Fa,"Grid"),$t(Li,"Color"),$t(Error,"Error"),$t(Gi,"AJAXError"),$t(Cr,"ResolvedImage"),$t(Dl,"StylePropertyFunction"),$t(su,"StyleExpression",{omit:["_evaluator"]}),$t(Xs,"ZoomDependentExpression"),$t(au,"ZoomConstantExpression"),$t(us,"CompoundExpression",{omit:["_evaluate"]});for(const n in Ma)gu[Ma[n]._classRegistryKey]||$t(Ma[n],`Expression${n}`);function Cp(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function $l(n){return w.ImageBitmap&&n instanceof w.ImageBitmap}function Nl(n,t){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp)return n;if(Cp(n)||$l(n))return t&&t.push(n),n;if(ArrayBuffer.isView(n)){const i=n;return t&&t.push(i.buffer),i}if(n instanceof w.ImageData)return t&&t.push(n.data.buffer),n;if(Array.isArray(n)){const i=[];for(const l of n)i.push(Nl(l,t));return i}if(typeof n=="object"){const i=n.constructor,l=i._classRegistryKey;if(!l)throw new Error(`can't serialize object of unregistered class ${l}`);const h=i.serialize?i.serialize(n,t):{};if(!i.serialize){for(const p in n)n.hasOwnProperty(p)&&(gu[l].omit.indexOf(p)>=0||(h[p]=Nl(n[p],t)));n instanceof Error&&(h.message=n.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(h.$name=l),h}throw new Error("can't serialize object of type "+typeof n)}function Ul(n){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||Cp(n)||$l(n)||ArrayBuffer.isView(n)||n instanceof w.ImageData)return n;if(Array.isArray(n))return n.map(Ul);if(typeof n=="object"){const t=n.$name||"Object",{klass:i}=gu[t];if(!i)throw new Error(`can't deserialize unregistered class ${t}`);if(i.deserialize)return i.deserialize(n);const l=Object.create(i.prototype);for(const h of Object.keys(n))h!=="$name"&&(l[h]=Ul(n[h]));return l}throw new Error("can't deserialize object of type "+typeof n)}const jl=n=>n>=1536&&n<=1791,Ip=n=>n>=1872&&n<=1919,Qh=n=>n>=2208&&n<=2303,Ap=n=>n>=11904&&n<=12031,ed=n=>n>=12032&&n<=12255,td=n=>n>=12272&&n<=12287,Gl=n=>n>=12288&&n<=12351,vu=n=>n>=12352&&n<=12447,Va=n=>n>=12448&&n<=12543,_u=n=>n>=12544&&n<=12591,kp=n=>n>=12704&&n<=12735,Mp=n=>n>=12736&&n<=12783,nd=n=>n>=12784&&n<=12799,Pp=n=>n>=12800&&n<=13055,zp=n=>n>=13056&&n<=13311,Lp=n=>n>=13312&&n<=19903,id=n=>n>=19968&&n<=40959,Dp=n=>n>=40960&&n<=42127,Rp=n=>n>=42128&&n<=42191,Bp=n=>n>=44032&&n<=55215,Op=n=>n>=63744&&n<=64255,yu=n=>n>=64336&&n<=65023,ql=n=>n>=65040&&n<=65055,f=n=>n>=65072&&n<=65103,r=n=>n>=65104&&n<=65135,c=n=>n>=65136&&n<=65279,m=n=>n>=65280&&n<=65519;function _(n){for(const t of n)if(I(t.charCodeAt(0)))return!0;return!1}function b(n){for(const t of n)if(!C(t.charCodeAt(0)))return!1;return!0}function C(n){return!(jl(n)||Ip(n)||Qh(n)||yu(n)||c(n))}function I(n){return!(n!==746&&n!==747&&(n<4352||!(kp(n)||_u(n)||f(n)&&!(n>=65097&&n<=65103)||Op(n)||zp(n)||Ap(n)||Mp(n)||!(!Gl(n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||Lp(n)||id(n)||Pp(n)||(t=>t>=12592&&t<=12687)(n)||(t=>t>=43360&&t<=43391)(n)||(t=>t>=55216&&t<=55295)(n)||(t=>t>=4352&&t<=4607)(n)||Bp(n)||vu(n)||td(n)||(t=>t>=12688&&t<=12703)(n)||ed(n)||nd(n)||Va(n)&&n!==12540||!(!m(n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!r(n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||(t=>t>=5120&&t<=5759)(n)||(t=>t>=6320&&t<=6399)(n)||ql(n)||(t=>t>=19904&&t<=19967)(n)||Dp(n)||Rp(n))))}function M(n){return!(I(n)||function(t){return!!((i=>i>=128&&i<=255)(t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||(i=>i>=8192&&i<=8303)(t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||(i=>i>=8448&&i<=8527)(t)||(i=>i>=8528&&i<=8591)(t)||(i=>i>=8960&&i<=9215)(t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||(i=>i>=9216&&i<=9279)(t)&&t!==9251||(i=>i>=9280&&i<=9311)(t)||(i=>i>=9312&&i<=9471)(t)||(i=>i>=9632&&i<=9727)(t)||(i=>i>=9728&&i<=9983)(t)&&!(t>=9754&&t<=9759)||(i=>i>=11008&&i<=11263)(t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Gl(t)||Va(t)||(i=>i>=57344&&i<=63743)(t)||f(t)||r(t)||m(t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(n))}function R(n){return n>=1424&&n<=2303||yu(n)||c(n)}function B(n,t){return!(!t&&R(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||(i=>i>=6016&&i<=6143)(n))}function U(n){for(const t of n)if(R(t.charCodeAt(0)))return!0;return!1}const W="deferred",Q="loading",J="loaded";let ee=null,te="unavailable",Z=null;const ce=function(n){n&&typeof n=="string"&&n.indexOf("NetworkError")>-1&&(te="error"),ee&&ee(n)};function ae(){fe.fire(new Qn("pluginStateChange",{pluginStatus:te,pluginURL:Z}))}const fe=new Bo,Ce=function(){return te},we=function(){if(te!==W||!Z)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");te=Q,ae(),Z&&po({url:Z},n=>{n?ce(n):(te=J,ae())})},Ae={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>te===J||Ae.applyArabicShaping!=null,isLoading:()=>te===Q,setState(n){te=n.pluginStatus,Z=n.pluginURL},isParsed:()=>Ae.applyArabicShaping!=null&&Ae.processBidirectionalText!=null&&Ae.processStyledBidirectionalText!=null,getPluginURL:()=>Z};class Be{constructor(t,i){this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(t){return function(i,l){for(const h of i)if(!B(h.charCodeAt(0),l))return!1;return!0}(t,Ae.isLoaded())}}class Ne{constructor(t,i){this.property=t,this.value=i,this.expression=function(l,h){if(ru(l))return new Dl(l,h);if(La(l)){const p=Ys(l,h);if(p.result==="error")throw new Error(p.value.map(v=>`${v.key}: ${v.message}`).join(", "));return p.value}{let p=l;return typeof l=="string"&&h.type==="color"&&(p=Li.parse(l)),{kind:"constant",evaluate:()=>p}}}(i===void 0?t.specification.default:i,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,i,l){return this.property.possiblyEvaluate(this,t,i,l)}}class Ge{constructor(t){this.property=t,this.value=new Ne(t,void 0)}transitioned(t,i){return new Fe(this.property,this.value,i,pt({},t.transition,this.transition),t.now)}untransitioned(){return new Fe(this.property,this.value,null,{},0)}}class bt{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Dn(this._values[t].value.value)}setValue(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new Ge(this._values[t].property)),this._values[t].value=new Ne(this._values[t].property,i===null?void 0:Dn(i))}getTransition(t){return Dn(this._values[t].transition)}setTransition(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new Ge(this._values[t].property)),this._values[t].transition=Dn(i)||void 0}serialize(){const t={};for(const i of Object.keys(this._values)){const l=this.getValue(i);l!==void 0&&(t[i]=l);const h=this.getTransition(i);h!==void 0&&(t[`${i}-transition`]=h)}return t}transitioned(t,i){const l=new rt(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].transitioned(t,i._values[h]);return l}untransitioned(){const t=new rt(this._properties);for(const i of Object.keys(this._values))t._values[i]=this._values[i].untransitioned();return t}}class Fe{constructor(t,i,l,h,p){const v=h.delay||0,y=h.duration||0;p=p||0,this.property=t,this.value=i,this.begin=p+v,this.end=this.begin+y,t.specification.transition&&(h.delay||h.duration)&&(this.prior=l)}possiblyEvaluate(t,i,l){const h=t.now||0,p=this.value.possiblyEvaluate(t,i,l),v=this.prior;if(v){if(h>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(h<this.begin)return v.possiblyEvaluate(t,i,l);{const y=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(t,i,l),p,ze(y))}}return p}}class rt{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,i,l){const h=new Ue(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(t,i,l);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class He{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return Dn(this._values[t].value)}setValue(t,i){this._values[t]=new Ne(this._values[t].property,i===null?void 0:Dn(i))}serialize(){const t={};for(const i of Object.keys(this._values)){const l=this.getValue(i);l!==void 0&&(t[i]=l)}return t}possiblyEvaluate(t,i,l){const h=new Ue(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(t,i,l);return h}}class ht{constructor(t,i,l){this.property=t,this.value=i,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,i,l,h){return this.property.evaluate(this.value,this.parameters,t,i,l,h)}}class Ue{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Le{constructor(t){this.specification=t}possiblyEvaluate(t,i){return t.expression.evaluate(i)}interpolate(t,i,l){const h=Il[this.specification.type];return h?h(t,i,l):t}}class Ze{constructor(t,i){this.specification=t,this.overrides=i}possiblyEvaluate(t,i,l,h){return new ht(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(i,null,{},l,h)}:t.expression,i)}interpolate(t,i,l){if(t.value.kind!=="constant"||i.value.kind!=="constant")return t;if(t.value.value===void 0||i.value.value===void 0)return new ht(this,{kind:"constant",value:void 0},t.parameters);const h=Il[this.specification.type];return h?new ht(this,{kind:"constant",value:h(t.value.value,i.value.value,l)},t.parameters):t}evaluate(t,i,l,h,p,v){return t.kind==="constant"?t.value:t.evaluate(i,l,h,p,v)}}class lt{constructor(t){this.specification=t}possiblyEvaluate(t,i,l,h){return!!t.expression.evaluate(i,null,{},l,h)}interpolate(){return!1}}class mt{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new Be(0,{});for(const l in t){const h=t[l];h.specification.overridable&&this.overridableProperties.push(l);const p=this.defaultPropertyValues[l]=new Ne(h,void 0),v=this.defaultTransitionablePropertyValues[l]=new Ge(h);this.defaultTransitioningPropertyValues[l]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=p.possiblyEvaluate(i)}}}function Wt(n,t){return 256*(n=nt(Math.floor(n),0,255))+nt(Math.floor(t),0,255)}$t(Ze,"DataDrivenProperty"),$t(Le,"DataConstantProperty"),$t(lt,"ColorRampProperty");const mn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ut{constructor(t,i){this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ft{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,i){return t._trim(),i&&(t.isTransferred=!0,i.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const i=Object.create(this.prototype);return i.arrayBuffer=t.arrayBuffer,i.length=t.length,i.capacity=t.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ht(n,t=1){let i=0,l=0;return{members:n.map(h=>{const p=mn[h.type].BYTES_PER_ELEMENT,v=i=En(i,Math.max(t,p)),y=h.components||1;return l=Math.max(l,p),i+=p*y,{name:h.name,type:h.type,components:y,offset:v}}),size:En(i,Math.max(l,t)),alignment:t}}function En(n,t){return Math.ceil(n/t)*t}class Qt extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i){const l=this.length;return this.resize(l+1),this.emplace(l,t,i)}emplace(t,i,l){const h=2*t;return this.int16[h+0]=i,this.int16[h+1]=l,t}}Qt.prototype.bytesPerElement=4,$t(Qt,"StructArrayLayout2i4");class Zn extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,l)}emplace(t,i,l,h){const p=3*t;return this.int16[p+0]=i,this.int16[p+1]=l,this.int16[p+2]=h,t}}Zn.prototype.bytesPerElement=6,$t(Zn,"StructArrayLayout3i6");class ei extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=4*t;return this.int16[v+0]=i,this.int16[v+1]=l,this.int16[v+2]=h,this.int16[v+3]=p,t}}ei.prototype.bytesPerElement=8,$t(ei,"StructArrayLayout4i8");class ai extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,y){const S=this.length;return this.resize(S+1),this.emplace(S,t,i,l,h,p,v,y)}emplace(t,i,l,h,p,v,y,S){const T=6*t,A=12*t,P=3*t;return this.int16[T+0]=i,this.int16[T+1]=l,this.uint8[A+4]=h,this.uint8[A+5]=p,this.uint8[A+6]=v,this.uint8[A+7]=y,this.float32[P+2]=S,t}}ai.prototype.bytesPerElement=12,$t(ai,"StructArrayLayout2i4ub1f12");class ii extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=4*t;return this.float32[v+0]=i,this.float32[v+1]=l,this.float32[v+2]=h,this.float32[v+3]=p,t}}ii.prototype.bytesPerElement=16,$t(ii,"StructArrayLayout4f16");class Oi extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,l,h,p)}emplace(t,i,l,h,p,v){const y=6*t,S=3*t;return this.uint16[y+0]=i,this.uint16[y+1]=l,this.uint16[y+2]=h,this.uint16[y+3]=p,this.float32[S+2]=v,t}}Oi.prototype.bytesPerElement=12,$t(Oi,"StructArrayLayout4ui1f12");class Dr extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=4*t;return this.uint16[v+0]=i,this.uint16[v+1]=l,this.uint16[v+2]=h,this.uint16[v+3]=p,t}}Dr.prototype.bytesPerElement=8,$t(Dr,"StructArrayLayout4ui8");class ro extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v){const y=this.length;return this.resize(y+1),this.emplace(y,t,i,l,h,p,v)}emplace(t,i,l,h,p,v,y){const S=6*t;return this.int16[S+0]=i,this.int16[S+1]=l,this.int16[S+2]=h,this.int16[S+3]=p,this.int16[S+4]=v,this.int16[S+5]=y,t}}ro.prototype.bytesPerElement=12,$t(ro,"StructArrayLayout6i12");class No extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,y,S,T,A,P,D){const V=this.length;return this.resize(V+1),this.emplace(V,t,i,l,h,p,v,y,S,T,A,P,D)}emplace(t,i,l,h,p,v,y,S,T,A,P,D,V){const $=12*t;return this.int16[$+0]=i,this.int16[$+1]=l,this.int16[$+2]=h,this.int16[$+3]=p,this.uint16[$+4]=v,this.uint16[$+5]=y,this.uint16[$+6]=S,this.uint16[$+7]=T,this.int16[$+8]=A,this.int16[$+9]=P,this.int16[$+10]=D,this.int16[$+11]=V,t}}No.prototype.bytesPerElement=24,$t(No,"StructArrayLayout4i4ui4i24");class pi extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v){const y=this.length;return this.resize(y+1),this.emplace(y,t,i,l,h,p,v)}emplace(t,i,l,h,p,v,y){const S=10*t,T=5*t;return this.int16[S+0]=i,this.int16[S+1]=l,this.int16[S+2]=h,this.float32[T+2]=p,this.float32[T+3]=v,this.float32[T+4]=y,t}}pi.prototype.bytesPerElement=20,$t(pi,"StructArrayLayout3i3f20");class ri extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint32[1*t+0]=i,t}}ri.prototype.bytesPerElement=4,$t(ri,"StructArrayLayout1ul4");class $n extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,y,S,T,A,P,D,V){const $=this.length;return this.resize($+1),this.emplace($,t,i,l,h,p,v,y,S,T,A,P,D,V)}emplace(t,i,l,h,p,v,y,S,T,A,P,D,V,$){const j=20*t,X=10*t;return this.int16[j+0]=i,this.int16[j+1]=l,this.int16[j+2]=h,this.int16[j+3]=p,this.int16[j+4]=v,this.float32[X+3]=y,this.float32[X+4]=S,this.float32[X+5]=T,this.float32[X+6]=A,this.int16[j+14]=P,this.uint32[X+8]=D,this.uint16[j+18]=V,this.uint16[j+19]=$,t}}$n.prototype.bytesPerElement=40,$t($n,"StructArrayLayout5i4f1i1ul2ui40");class Ci extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,y){const S=this.length;return this.resize(S+1),this.emplace(S,t,i,l,h,p,v,y)}emplace(t,i,l,h,p,v,y,S){const T=8*t;return this.int16[T+0]=i,this.int16[T+1]=l,this.int16[T+2]=h,this.int16[T+4]=p,this.int16[T+5]=v,this.int16[T+6]=y,this.int16[T+7]=S,t}}Ci.prototype.bytesPerElement=16,$t(Ci,"StructArrayLayout3i2i2i16");class vr extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,l,h,p)}emplace(t,i,l,h,p,v){const y=4*t,S=8*t;return this.float32[y+0]=i,this.float32[y+1]=l,this.float32[y+2]=h,this.int16[S+6]=p,this.int16[S+7]=v,t}}vr.prototype.bytesPerElement=16,$t(vr,"StructArrayLayout2f1f2i16");class ui extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=12*t,y=3*t;return this.uint8[v+0]=i,this.uint8[v+1]=l,this.float32[y+1]=h,this.float32[y+2]=p,t}}ui.prototype.bytesPerElement=12,$t(ui,"StructArrayLayout2ub2f12");class _r extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,l)}emplace(t,i,l,h){const p=3*t;return this.float32[p+0]=i,this.float32[p+1]=l,this.float32[p+2]=h,t}}_r.prototype.bytesPerElement=12,$t(_r,"StructArrayLayout3f12");class yr extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,l)}emplace(t,i,l,h){const p=3*t;return this.uint16[p+0]=i,this.uint16[p+1]=l,this.uint16[p+2]=h,t}}yr.prototype.bytesPerElement=6,$t(yr,"StructArrayLayout3ui6");class ps extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,y,S,T,A,P,D,V,$,j,X,le,ye,ie,ge,Ee){const xe=this.length;return this.resize(xe+1),this.emplace(xe,t,i,l,h,p,v,y,S,T,A,P,D,V,$,j,X,le,ye,ie,ge,Ee)}emplace(t,i,l,h,p,v,y,S,T,A,P,D,V,$,j,X,le,ye,ie,ge,Ee,xe){const je=30*t,$e=15*t,tt=60*t;return this.int16[je+0]=i,this.int16[je+1]=l,this.int16[je+2]=h,this.float32[$e+2]=p,this.float32[$e+3]=v,this.uint16[je+8]=y,this.uint16[je+9]=S,this.uint32[$e+5]=T,this.uint32[$e+6]=A,this.uint32[$e+7]=P,this.uint16[je+16]=D,this.uint16[je+17]=V,this.uint16[je+18]=$,this.float32[$e+10]=j,this.float32[$e+11]=X,this.uint8[tt+48]=le,this.uint8[tt+49]=ye,this.uint8[tt+50]=ie,this.uint32[$e+13]=ge,this.int16[je+28]=Ee,this.uint8[tt+58]=xe,t}}ps.prototype.bytesPerElement=60,$t(ps,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class $a extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,y,S,T,A,P,D,V,$,j,X,le,ye,ie,ge,Ee,xe,je,$e,tt,vt,We,it,ot,dt){const _t=this.length;return this.resize(_t+1),this.emplace(_t,t,i,l,h,p,v,y,S,T,A,P,D,V,$,j,X,le,ye,ie,ge,Ee,xe,je,$e,tt,vt,We,it,ot,dt)}emplace(t,i,l,h,p,v,y,S,T,A,P,D,V,$,j,X,le,ye,ie,ge,Ee,xe,je,$e,tt,vt,We,it,ot,dt,_t){const Xe=38*t,Ct=19*t;return this.int16[Xe+0]=i,this.int16[Xe+1]=l,this.int16[Xe+2]=h,this.float32[Ct+2]=p,this.float32[Ct+3]=v,this.int16[Xe+8]=y,this.int16[Xe+9]=S,this.int16[Xe+10]=T,this.int16[Xe+11]=A,this.int16[Xe+12]=P,this.int16[Xe+13]=D,this.uint16[Xe+14]=V,this.uint16[Xe+15]=$,this.uint16[Xe+16]=j,this.uint16[Xe+17]=X,this.uint16[Xe+18]=le,this.uint16[Xe+19]=ye,this.uint16[Xe+20]=ie,this.uint16[Xe+21]=ge,this.uint16[Xe+22]=Ee,this.uint16[Xe+23]=xe,this.uint16[Xe+24]=je,this.uint16[Xe+25]=$e,this.uint16[Xe+26]=tt,this.uint16[Xe+27]=vt,this.uint16[Xe+28]=We,this.uint32[Ct+15]=it,this.float32[Ct+16]=ot,this.float32[Ct+17]=dt,this.float32[Ct+18]=_t,t}}$a.prototype.bytesPerElement=76,$t($a,"StructArrayLayout3i2f6i15ui1ul3f76");class Gr extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.float32[1*t+0]=i,t}}Gr.prototype.bytesPerElement=4,$t(Gr,"StructArrayLayout1f4");class Xr extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,l,h,p)}emplace(t,i,l,h,p,v){const y=5*t;return this.float32[y+0]=i,this.float32[y+1]=l,this.float32[y+2]=h,this.float32[y+3]=p,this.float32[y+4]=v,t}}Xr.prototype.bytesPerElement=20,$t(Xr,"StructArrayLayout5f20");class Uo extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=6*t;return this.uint32[3*t+0]=i,this.uint16[v+2]=l,this.uint16[v+3]=h,this.uint16[v+4]=p,t}}Uo.prototype.bytesPerElement=12,$t(Uo,"StructArrayLayout1ul3ui12");class ms extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i){const l=this.length;return this.resize(l+1),this.emplace(l,t,i)}emplace(t,i,l){const h=2*t;return this.uint16[h+0]=i,this.uint16[h+1]=l,t}}ms.prototype.bytesPerElement=4,$t(ms,"StructArrayLayout2ui4");class gs extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint16[1*t+0]=i,t}}gs.prototype.bytesPerElement=2,$t(gs,"StructArrayLayout1ui2");class Na extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i){const l=this.length;return this.resize(l+1),this.emplace(l,t,i)}emplace(t,i,l){const h=2*t;return this.float32[h+0]=i,this.float32[h+1]=l,t}}Na.prototype.bytesPerElement=8,$t(Na,"StructArrayLayout2f8");class _0 extends Ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}_0.prototype.size=40;class Hg extends $n{get(t){return new _0(this,t)}}$t(Hg,"CollisionBoxArray");class y0 extends Ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}y0.prototype.size=60;class x0 extends ps{get(t){return new y0(this,t)}}$t(x0,"PlacedSymbolArray");class b0 extends Ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(t){this._structArray.uint32[this._pos4+15]=t}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}b0.prototype.size=76;class w0 extends $a{get(t){return new b0(this,t)}}$t(w0,"SymbolInstanceArray");class S0 extends Gr{getoffsetX(t){return this.float32[1*t+0]}}$t(S0,"GlyphOffsetArray");class T0 extends Qt{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}$t(T0,"SymbolLineVertexArray");class E0 extends Ut{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}E0.prototype.size=12;class C0 extends Uo{get(t){return new E0(this,t)}}$t(C0,"FeatureIndexArray");class I0 extends ms{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}$t(I0,"FillExtrusionCentroidArray");const ME=Ht([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),PE=Ht([{name:"a_dash",components:4,type:"Uint16"}]);var Zl={},zE={get exports(){return Zl},set exports(n){Zl=n}},Xg={};({get exports(){return Xg},set exports(n){Xg=n}}).exports=function(n,t){var i,l,h,p,v,y,S,T;for(l=n.length-(i=3&n.length),h=t,v=3432918353,y=461845907,T=0;T<l;)S=255&n.charCodeAt(T)|(255&n.charCodeAt(++T))<<8|(255&n.charCodeAt(++T))<<16|(255&n.charCodeAt(++T))<<24,++T,h=27492+(65535&(p=5*(65535&(h=(h^=S=(65535&(S=(S=(65535&S)*v+(((S>>>16)*v&65535)<<16)&4294967295)<<15|S>>>17))*y+(((S>>>16)*y&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(p>>>16)&65535)<<16);switch(S=0,i){case 3:S^=(255&n.charCodeAt(T+2))<<16;case 2:S^=(255&n.charCodeAt(T+1))<<8;case 1:h^=S=(65535&(S=(S=(65535&(S^=255&n.charCodeAt(T)))*v+(((S>>>16)*v&65535)<<16)&4294967295)<<15|S>>>17))*y+(((S>>>16)*y&65535)<<16)&4294967295}return h^=n.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var Yg={};({get exports(){return Yg},set exports(n){Yg=n}}).exports=function(n,t){for(var i,l=n.length,h=t^l,p=0;l>=4;)i=1540483477*(65535&(i=255&n.charCodeAt(p)|(255&n.charCodeAt(++p))<<8|(255&n.charCodeAt(++p))<<16|(255&n.charCodeAt(++p))<<24))+((1540483477*(i>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),l-=4,++p;switch(l){case 3:h^=(255&n.charCodeAt(p+2))<<16;case 2:h^=(255&n.charCodeAt(p+1))<<8;case 1:h=1540483477*(65535&(h^=255&n.charCodeAt(p)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var A0=Xg,LE=Yg;zE.exports=A0,Zl.murmur3=A0,Zl.murmur2=LE;class Fp{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,i,l,h){this.ids.push(k0(t)),this.positions.push(i,l,h)}getPositions(t){const i=k0(t);let l=0,h=this.ids.length-1;for(;l<h;){const v=l+h>>1;this.ids[v]>=i?h=v:l=v+1}const p=[];for(;this.ids[l]===i;)p.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return p}static serialize(t,i){const l=new Float64Array(t.ids),h=new Uint32Array(t.positions);return Kg(l,h,0,l.length-1),i&&i.push(l.buffer,h.buffer),{ids:l,positions:h}}static deserialize(t){const i=new Fp;return i.ids=t.ids,i.positions=t.positions,i.indexed=!0,i}}function k0(n){const t=+n;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:Zl(String(n))}function Kg(n,t,i,l){for(;i<l;){const h=n[i+l>>1];let p=i-1,v=l+1;for(;;){do p++;while(n[p]<h);do v--;while(n[v]>h);if(p>=v)break;Vp(n,p,v),Vp(t,3*p,3*v),Vp(t,3*p+1,3*v+1),Vp(t,3*p+2,3*v+2)}v-i<l-v?(Kg(n,t,i,v),i=v+1):(Kg(n,t,v+1,l),l=v)}}function Vp(n,t,i){const l=n[t];n[t]=n[i],n[i]=l}$t(Fp,"FeaturePositionMap");class Ks{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,i),this.initialized=!0),!!this.location}}class $p extends Ks{constructor(t){super(t),this.current=0}set(t,i,l){this.fetchUniformLocation(t,i)&&this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class M0 extends Ks{constructor(t){super(t),this.current=[0,0,0,0]}set(t,i,l){this.fetchUniformLocation(t,i)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3])))}}class P0 extends Ks{constructor(t){super(t),this.current=Li.transparent}set(t,i,l){this.fetchUniformLocation(t,i)&&(l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a)))}}const DE=new Float32Array(16),RE=new Float32Array(9),BE=new Float32Array(4);function Jg(n){return[Wt(255*n.r,255*n.g),Wt(255*n.b,255*n.a)]}class rd{constructor(t,i,l){this.value=t,this.uniformNames=i.map(h=>`u_${h}`),this.type=l}setUniform(t,i,l,h,p){i.set(t,p,h.constantOr(this.value))}getBinding(t,i){return this.type==="color"?new P0(t):new $p(t)}}class xu{constructor(t,i){this.uniformNames=i.map(l=>`u_${l}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,i,l,h,p){const v=p==="u_pattern"||p==="u_dash"?this.pattern:p==="u_pixel_ratio"?this.pixelRatio:null;v&&i.set(t,p,v)}getBinding(t,i){return i==="u_pattern"||i==="u_dash"?new M0(t):new $p(t)}}class Js{constructor(t,i,l,h){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=i.map(p=>({name:`a_${p}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,i,l,h,p,v){const y=this.paintVertexArray.length,S=this.expression.evaluate(new Be(0),i,{},p,h,v);this.paintVertexArray.resize(t),this._setPaintValue(y,t,S)}updatePaintArray(t,i,l,h,p){const v=this.expression.evaluate({zoom:0},l,h,void 0,p);this._setPaintValue(t,i,v)}_setPaintValue(t,i,l){if(this.type==="color"){const h=Jg(l);for(let p=t;p<i;p++)this.paintVertexArray.emplace(p,h[0],h[1])}else{for(let h=t;h<i;h++)this.paintVertexArray.emplace(h,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class jo{constructor(t,i,l,h,p,v){this.expression=t,this.uniformNames=i.map(y=>`u_${y}_t`),this.type=l,this.useIntegerZoom=h,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=i.map(y=>({name:`a_${y}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(t,i,l,h,p,v){const y=this.expression.evaluate(new Be(this.zoom),i,{},p,h,v),S=this.expression.evaluate(new Be(this.zoom+1),i,{},p,h,v),T=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(T,t,y,S)}updatePaintArray(t,i,l,h,p){const v=this.expression.evaluate({zoom:this.zoom},l,h,void 0,p),y=this.expression.evaluate({zoom:this.zoom+1},l,h,void 0,p);this._setPaintValue(t,i,v,y)}_setPaintValue(t,i,l,h){if(this.type==="color"){const p=Jg(l),v=Jg(h);for(let y=t;y<i;y++)this.paintVertexArray.emplace(y,p[0],p[1],v[0],v[1])}else{for(let p=t;p<i;p++)this.paintVertexArray.emplace(p,l,h);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,i,l,h,p){const v=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,y=nt(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);i.set(t,p,y)}getBinding(t,i){return new $p(t)}}class Ua{constructor(t,i,l,h,p){this.expression=t,this.layerId=p,this.paintVertexAttributes=(l==="array"?PE:ME).members;for(let v=0;v<i.length;++v);this.paintVertexArray=new h}populatePaintArray(t,i,l){const h=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(h,t,i.patterns&&i.patterns[this.layerId],l)}updatePaintArray(t,i,l,h,p,v){this._setPaintValues(t,i,l.patterns&&l.patterns[this.layerId],v)}_setPaintValues(t,i,l,h){if(!h||!l)return;const p=h[l];if(!p)return;const{tl:v,br:y,pixelRatio:S}=p;for(let T=t;T<i;T++)this.paintVertexArray.emplace(T,v[0],v[1],y[0],y[1],S)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ja{constructor(t,i,l=()=>!0){this.binders={},this._buffers=[];const h=[];for(const p in t.paint._values){if(!l(p))continue;const v=t.paint.get(p);if(!(v instanceof ht&&za(v.property.specification)))continue;const y=FE(p,t.type),S=v.value,T=v.property.specification.type,A=v.property.useIntegerZoom,P=p==="line-dasharray"||p.endsWith("pattern"),D=p==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(S.kind!=="constant"||D)if(S.kind==="source"||D||P){const V=z0(p,T,"source");this.binders[p]=P?new Ua(S,y,T,V,t.id):new Js(S,y,T,V),h.push(`/a_${p}`)}else{const V=z0(p,T,"composite");this.binders[p]=new jo(S,y,T,A,i,V),h.push(`/z_${p}`)}else this.binders[p]=P?new xu(S.value,y):new rd(S.value,y,T),h.push(`/u_${p}`)}this.cacheKey=h.sort().join("")}getMaxValue(t){const i=this.binders[t];return i instanceof Js||i instanceof jo?i.maxValue:0}populatePaintArrays(t,i,l,h,p,v){for(const y in this.binders){const S=this.binders[y];(S instanceof Js||S instanceof jo||S instanceof Ua)&&S.populatePaintArray(t,i,l,h,p,v)}}setConstantPatternPositions(t){for(const i in this.binders){const l=this.binders[i];l instanceof xu&&l.setConstantPatternPositions(t)}}updatePaintArrays(t,i,l,h,p,v){let y=!1;for(const S in t){const T=i.getPositions(S);for(const A of T){const P=l.feature(A.index);for(const D in this.binders){const V=this.binders[D];if((V instanceof Js||V instanceof jo||V instanceof Ua)&&V.expression.isStateDependent===!0){const $=h.paint.get(D);V.expression=$.value,V.updatePaintArray(A.start,A.end,P,t[S],p,v),y=!0}}}}return y}defines(){const t=[];for(const i in this.binders){const l=this.binders[i];(l instanceof rd||l instanceof xu)&&t.push(...l.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const i in this.binders){const l=this.binders[i];if(l instanceof Js||l instanceof jo||l instanceof Ua)for(let h=0;h<l.paintVertexAttributes.length;h++)t.push(l.paintVertexAttributes[h].name)}return t}getBinderUniforms(){const t=[];for(const i in this.binders){const l=this.binders[i];if(l instanceof rd||l instanceof xu||l instanceof jo)for(const h of l.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const i=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof rd||h instanceof xu||h instanceof jo)for(const p of h.uniformNames)i.push({name:p,property:l,binding:h.getBinding(t,p)})}return i}setUniforms(t,i,l,h,p){for(const{name:v,property:y,binding:S}of l)this.binders[y].setUniform(t,S,p,h.get(y),v)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const i=this.binders[t];(i instanceof Js||i instanceof jo||i instanceof Ua)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(t){for(const i in this.binders){const l=this.binders[i];(l instanceof Js||l instanceof jo||l instanceof Ua)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const i=this.binders[t];(i instanceof Js||i instanceof jo||i instanceof Ua)&&i.destroy()}}}class Wl{constructor(t,i,l=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new ja(h,i,l);this.needsUpload=!1,this._featureMap=new Fp,this._bufferOffset=0}populatePaintArrays(t,i,l,h,p,v,y){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(t,i,h,p,v,y);i.id!==void 0&&this._featureMap.add(i.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,i,l,h,p){for(const v of l)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(t,this._featureMap,i,v,h,p)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const OE={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function FE(n,t){return OE[n]||[n.replace(`${t}-`,"").replace(/-/g,"_")]}const VE={"line-pattern":{source:Oi,composite:Oi},"fill-pattern":{source:Oi,composite:Oi},"fill-extrusion-pattern":{source:Oi,composite:Oi},"line-dasharray":{source:Dr,composite:Dr}},$E={color:{source:Na,composite:ii},number:{source:Gr,composite:Na}};function z0(n,t,i){const l=VE[n];return l&&l[i]||$E[t][i]}$t(rd,"ConstantBinder"),$t(xu,"PatternConstantBinder"),$t(Js,"SourceExpressionBinder"),$t(Ua,"PatternCompositeBinder"),$t(jo,"CompositeExpressionBinder"),$t(ja,"ProgramConfiguration",{omit:["_buffers"]}),$t(Wl,"ProgramConfigurationSet");const Np="-transition";class Go extends Bo{constructor(t,i){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),i.layout&&(this._unevaluatedLayout=new He(i.layout)),i.paint)){this._transitionablePaint=new bt(i.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ue(i.paint)}}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,i,l={}){i!=null&&this._validate(Tp,`layers.${this.id}.layout.${t}`,t,i,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,i):this.visibility=i)}getPaintProperty(t){return Tt(t,Np)?this._transitionablePaint.getTransition(t.slice(0,-Np.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,i,l={}){if(i!=null&&this._validate(Wg,`layers.${this.id}.paint.${t}`,t,i,l))return!1;if(Tt(t,Np))return this._transitionablePaint.setTransition(t.slice(0,-Np.length),i||void 0),!1;{const h=this._transitionablePaint._values[t],p=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(t,i),this._handleSpecialPaintPropertyUpdate(t);const y=this._transitionablePaint._values[t].value,S=y.isDataDriven(),T=Tt(t,"pattern")||t==="line-dasharray";return S||p||T||this._handleOverridablePaintPropertyUpdate(t,v,y)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,i,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,i)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),fn(t,(i,l)=>!(i===void 0||l==="layout"&&!Object.keys(i).length||l==="paint"&&!Object.keys(i).length))}_validate(t,i,l,h,p={}){return(!p||p.validate!==!1)&&Ep(this,t.call(Sp,{key:i,layerType:this.type,objectKey:l,value:h,styleSpec:et,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const i=this.paint.get(t);if(i instanceof ht&&za(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=cu(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const NE=Ht([{name:"a_pos",components:2,type:"Int16"}],4),UE=Ht([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Fi{constructor(t=[]){this.segments=t}prepareSegment(t,i,l,h){let p=this.segments[this.segments.length-1];return t>Fi.MAX_VERTEX_ARRAY_LENGTH&&ue(`Max vertices per segment is ${Fi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!p||p.vertexLength+t>Fi.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==h)&&(p={vertexOffset:i.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},h!==void 0&&(p.sortKey=h),this.segments.push(p)),p}get(){return this.segments}destroy(){for(const t of this.segments)for(const i in t.vaos)t.vaos[i].destroy()}static simpleSegment(t,i,l,h){return new Fi([{vertexOffset:t,primitiveOffset:i,vertexLength:l,primitiveLength:h,vaos:{},sortKey:0}])}}Fi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,$t(Fi,"SegmentVector");var un=8192;class Ga{constructor(t,i){t&&(i?this.setSouthWest(t).setNorthEast(i):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Vn?new Vn(t.lng,t.lat):Vn.convert(t),this}setSouthWest(t){return this._sw=t instanceof Vn?new Vn(t.lng,t.lat):Vn.convert(t),this}extend(t){const i=this._sw,l=this._ne;let h,p;if(t instanceof Vn)h=t,p=t;else{if(!(t instanceof Ga))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Ga.convert(t)):this.extend(Vn.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&t.hasOwnProperty("lon")?this.extend(Vn.convert(t)):this;if(h=t._sw,p=t._ne,!h||!p)return this}return i||l?(i.lng=Math.min(h.lng,i.lng),i.lat=Math.min(h.lat,i.lat),l.lng=Math.max(p.lng,l.lng),l.lat=Math.max(p.lat,l.lat)):(this._sw=new Vn(h.lng,h.lat),this._ne=new Vn(p.lng,p.lat)),this}getCenter(){return new Vn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Vn(this.getWest(),this.getNorth())}getSouthEast(){return new Vn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:i,lat:l}=Vn.convert(t);let h=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&h}static convert(t){return!t||t instanceof Ga?t:new Ga(t)}}var Up=1e-6,Yr=typeof Float32Array<"u"?Float32Array:Array;function L0(){var n=new Yr(9);return Yr!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function D0(n,t,i){var l=t[0],h=t[1],p=t[2],v=t[3],y=t[4],S=t[5],T=t[6],A=t[7],P=t[8],D=i[0],V=i[1],$=i[2],j=i[3],X=i[4],le=i[5],ye=i[6],ie=i[7],ge=i[8];return n[0]=D*l+V*v+$*T,n[1]=D*h+V*y+$*A,n[2]=D*p+V*S+$*P,n[3]=j*l+X*v+le*T,n[4]=j*h+X*y+le*A,n[5]=j*p+X*S+le*P,n[6]=ye*l+ie*v+ge*T,n[7]=ye*h+ie*y+ge*A,n[8]=ye*p+ie*S+ge*P,n}function qo(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Qg(n,t){var i=t[0],l=t[1],h=t[2],p=t[3],v=t[4],y=t[5],S=t[6],T=t[7],A=t[8],P=t[9],D=t[10],V=t[11],$=t[12],j=t[13],X=t[14],le=t[15],ye=i*y-l*v,ie=i*S-h*v,ge=i*T-p*v,Ee=l*S-h*y,xe=l*T-p*y,je=h*T-p*S,$e=A*j-P*$,tt=A*X-D*$,vt=A*le-V*$,We=P*X-D*j,it=P*le-V*j,ot=D*le-V*X,dt=ye*ot-ie*it+ge*We+Ee*vt-xe*tt+je*$e;return dt?(n[0]=(y*ot-S*it+T*We)*(dt=1/dt),n[1]=(h*it-l*ot-p*We)*dt,n[2]=(j*je-X*xe+le*Ee)*dt,n[3]=(D*xe-P*je-V*Ee)*dt,n[4]=(S*vt-v*ot-T*tt)*dt,n[5]=(i*ot-h*vt+p*tt)*dt,n[6]=(X*ge-$*je-le*ie)*dt,n[7]=(A*je-D*ge+V*ie)*dt,n[8]=(v*it-y*vt+T*$e)*dt,n[9]=(l*vt-i*it-p*$e)*dt,n[10]=($*xe-j*ge+le*ye)*dt,n[11]=(P*ge-A*xe-V*ye)*dt,n[12]=(y*tt-v*We-S*$e)*dt,n[13]=(i*We-l*tt+h*$e)*dt,n[14]=(j*ie-$*Ee-X*ye)*dt,n[15]=(A*Ee-P*ie+D*ye)*dt,n):null}function Hl(n,t,i){var l=t[0],h=t[1],p=t[2],v=t[3],y=t[4],S=t[5],T=t[6],A=t[7],P=t[8],D=t[9],V=t[10],$=t[11],j=t[12],X=t[13],le=t[14],ye=t[15],ie=i[0],ge=i[1],Ee=i[2],xe=i[3];return n[0]=ie*l+ge*y+Ee*P+xe*j,n[1]=ie*h+ge*S+Ee*D+xe*X,n[2]=ie*p+ge*T+Ee*V+xe*le,n[3]=ie*v+ge*A+Ee*$+xe*ye,n[4]=(ie=i[4])*l+(ge=i[5])*y+(Ee=i[6])*P+(xe=i[7])*j,n[5]=ie*h+ge*S+Ee*D+xe*X,n[6]=ie*p+ge*T+Ee*V+xe*le,n[7]=ie*v+ge*A+Ee*$+xe*ye,n[8]=(ie=i[8])*l+(ge=i[9])*y+(Ee=i[10])*P+(xe=i[11])*j,n[9]=ie*h+ge*S+Ee*D+xe*X,n[10]=ie*p+ge*T+Ee*V+xe*le,n[11]=ie*v+ge*A+Ee*$+xe*ye,n[12]=(ie=i[12])*l+(ge=i[13])*y+(Ee=i[14])*P+(xe=i[15])*j,n[13]=ie*h+ge*S+Ee*D+xe*X,n[14]=ie*p+ge*T+Ee*V+xe*le,n[15]=ie*v+ge*A+Ee*$+xe*ye,n}function od(n,t,i){var l,h,p,v,y,S,T,A,P,D,V,$,j=i[0],X=i[1],le=i[2];return t===n?(n[12]=t[0]*j+t[4]*X+t[8]*le+t[12],n[13]=t[1]*j+t[5]*X+t[9]*le+t[13],n[14]=t[2]*j+t[6]*X+t[10]*le+t[14],n[15]=t[3]*j+t[7]*X+t[11]*le+t[15]):(h=t[1],p=t[2],v=t[3],y=t[4],S=t[5],T=t[6],A=t[7],P=t[8],D=t[9],V=t[10],$=t[11],n[0]=l=t[0],n[1]=h,n[2]=p,n[3]=v,n[4]=y,n[5]=S,n[6]=T,n[7]=A,n[8]=P,n[9]=D,n[10]=V,n[11]=$,n[12]=l*j+y*X+P*le+t[12],n[13]=h*j+S*X+D*le+t[13],n[14]=p*j+T*X+V*le+t[14],n[15]=v*j+A*X+$*le+t[15]),n}function Xl(n,t,i){var l=i[0],h=i[1],p=i[2];return n[0]=t[0]*l,n[1]=t[1]*l,n[2]=t[2]*l,n[3]=t[3]*l,n[4]=t[4]*h,n[5]=t[5]*h,n[6]=t[6]*h,n[7]=t[7]*h,n[8]=t[8]*p,n[9]=t[9]*p,n[10]=t[10]*p,n[11]=t[11]*p,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function ev(n,t,i){var l=Math.sin(i),h=Math.cos(i),p=t[4],v=t[5],y=t[6],S=t[7],T=t[8],A=t[9],P=t[10],D=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=p*h+T*l,n[5]=v*h+A*l,n[6]=y*h+P*l,n[7]=S*h+D*l,n[8]=T*h-p*l,n[9]=A*h-v*l,n[10]=P*h-y*l,n[11]=D*h-S*l,n}function jp(n,t,i){var l=Math.sin(i),h=Math.cos(i),p=t[0],v=t[1],y=t[2],S=t[3],T=t[8],A=t[9],P=t[10],D=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=p*h-T*l,n[1]=v*h-A*l,n[2]=y*h-P*l,n[3]=S*h-D*l,n[8]=p*l+T*h,n[9]=v*l+A*h,n[10]=y*l+P*h,n[11]=S*l+D*h,n}function R0(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=t[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function B0(n,t,i){var l,h,p,v=i[0],y=i[1],S=i[2],T=Math.hypot(v,y,S);return T<Up?null:(v*=T=1/T,y*=T,S*=T,l=Math.sin(t),h=Math.cos(t),n[0]=v*v*(p=1-h)+h,n[1]=y*v*p+S*l,n[2]=S*v*p-y*l,n[3]=0,n[4]=v*y*p-S*l,n[5]=y*y*p+h,n[6]=S*y*p+v*l,n[7]=0,n[8]=v*S*p+y*l,n[9]=y*S*p-v*l,n[10]=S*S*p+h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});var jE=Hl;function tv(){var n=new Yr(3);return Yr!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function O0(n){var t=new Yr(3);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function sd(n){return Math.hypot(n[0],n[1],n[2])}function bu(n,t,i){var l=new Yr(3);return l[0]=n,l[1]=t,l[2]=i,l}function Qs(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n}function nv(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n}function F0(n,t,i){return n[0]=t[0]*i[0],n[1]=t[1]*i[1],n[2]=t[2]*i[2],n}function ad(n,t,i){return n[0]=Math.min(t[0],i[0]),n[1]=Math.min(t[1],i[1]),n[2]=Math.min(t[2],i[2]),n}function ld(n,t,i){return n[0]=Math.max(t[0],i[0]),n[1]=Math.max(t[1],i[1]),n[2]=Math.max(t[2],i[2]),n}function oo(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n}function cd(n,t,i,l){return n[0]=t[0]+i[0]*l,n[1]=t[1]+i[1]*l,n[2]=t[2]+i[2]*l,n}function Rr(n,t){var i=t[0],l=t[1],h=t[2],p=i*i+l*l+h*h;return p>0&&(p=1/Math.sqrt(p)),n[0]=t[0]*p,n[1]=t[1]*p,n[2]=t[2]*p,n}function yo(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function iv(n,t,i){var l=t[0],h=t[1],p=t[2],v=i[0],y=i[1],S=i[2];return n[0]=h*S-p*y,n[1]=p*v-l*S,n[2]=l*y-h*v,n}function Di(n,t,i){var l=t[0],h=t[1],p=t[2],v=i[3]*l+i[7]*h+i[11]*p+i[15];return n[0]=(i[0]*l+i[4]*h+i[8]*p+i[12])/(v=v||1),n[1]=(i[1]*l+i[5]*h+i[9]*p+i[13])/v,n[2]=(i[2]*l+i[6]*h+i[10]*p+i[14])/v,n}function V0(n,t,i){var l=i[0],h=i[1],p=i[2],v=t[0],y=t[1],S=t[2],T=h*S-p*y,A=p*v-l*S,P=l*y-h*v,D=h*P-p*A,V=p*T-l*P,$=l*A-h*T,j=2*i[3];return A*=j,P*=j,V*=2,$*=2,n[0]=v+(T*=j)+(D*=2),n[1]=y+A+V,n[2]=S+P+$,n}var ud,Zo=nv,GE=F0,qE=sd;function $0(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n}function N0(n,t){var i=t[0],l=t[1],h=t[2],p=t[3],v=i*i+l*l+h*h+p*p;return v>0&&(v=1/Math.sqrt(v)),n[0]=i*v,n[1]=l*v,n[2]=h*v,n[3]=p*v,n}function Yl(n,t,i){var l=t[0],h=t[1],p=t[2],v=t[3];return n[0]=i[0]*l+i[4]*h+i[8]*p+i[12]*v,n[1]=i[1]*l+i[5]*h+i[9]*p+i[13]*v,n[2]=i[2]*l+i[6]*h+i[10]*p+i[14]*v,n[3]=i[3]*l+i[7]*h+i[11]*p+i[15]*v,n}function U0(){var n=new Yr(4);return Yr!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function j0(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function G0(n,t,i){i*=.5;var l=t[0],h=t[1],p=t[2],v=t[3],y=Math.sin(i),S=Math.cos(i);return n[0]=l*S+v*y,n[1]=h*S+p*y,n[2]=p*S-h*y,n[3]=v*S-l*y,n}function q0(n,t,i){i*=.5;var l=t[0],h=t[1],p=t[2],v=t[3],y=Math.sin(i),S=Math.cos(i);return n[0]=l*S-p*y,n[1]=h*S+v*y,n[2]=p*S+l*y,n[3]=v*S-h*y,n}tv(),ud=new Yr(4),Yr!=Float32Array&&(ud[0]=0,ud[1]=0,ud[2]=0,ud[3]=0);var ZE=N0;tv(),bu(1,0,0),bu(0,1,0),U0(),U0(),L0();const WE=Ht([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Z0}=WE,W0=Ht([{name:"a_pos_3",components:3,type:"Int16"}]);var hd=Ht([{name:"a_pos",type:"Int16",components:2}]);class rv{constructor(t,i){this.pos=t,this.dir=i}intersectsPlane(t,i,l){const h=yo(i,this.dir);if(Math.abs(h)<1e-6)return!1;const p=((t[0]-this.pos[0])*i[0]+(t[1]-this.pos[1])*i[1]+(t[2]-this.pos[2])*i[2])/h;return l[0]=this.pos[0]+this.dir[0]*p,l[1]=this.pos[1]+this.dir[1]*p,l[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(t,i,l){if(function(V,$){var j=V[0],X=V[1],le=V[2],ye=$[0],ie=$[1],ge=$[2];return Math.abs(j-ye)<=Up*Math.max(1,Math.abs(j),Math.abs(ye))&&Math.abs(X-ie)<=Up*Math.max(1,Math.abs(X),Math.abs(ie))&&Math.abs(le-ge)<=Up*Math.max(1,Math.abs(le),Math.abs(ge))}(this.pos,t)||i===0)return l[0]=l[1]=l[2]=0,!1;const[h,p,v]=this.dir,y=this.pos[0]-t[0],S=this.pos[1]-t[1],T=this.pos[2]-t[2],A=h*h+p*p+v*v,P=2*(y*h+S*p+T*v),D=P*P-4*A*(y*y+S*S+T*T-i*i);if(D<0){const V=Math.max(-P/2,0),$=y+h*V,j=S+p*V,X=T+v*V,le=Math.hypot($,j,X);return l[0]=$*i/le,l[1]=j*i/le,l[2]=X*i/le,!1}{const V=(-P-Math.sqrt(D))/(2*A);if(V<0){const $=Math.hypot(y,S,T);return l[0]=y*i/$,l[1]=S*i/$,l[2]=T*i/$,!1}return l[0]=y+h*V,l[1]=S+p*V,l[2]=T+v*V,!0}}}class ov{constructor(t,i,l,h,p){this.TL=t,this.TR=i,this.BR=l,this.BL=h,this.horizon=p}static fromInvProjectionMatrix(t,i,l){const h=[-1,1,1],p=[1,1,1],v=[1,-1,1],y=[-1,-1,1],S=Di(h,h,t),T=Di(p,p,t),A=Di(v,v,t),P=Di(y,y,t);return new ov(S,T,A,P,i/l)}}class sv{constructor(t,i){this.points=t,this.planes=i}static fromInvProjectionMatrix(t,i,l,h){const p=Math.pow(2,l),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const T=Yl([],S,t),A=1/T[3]/i*p;return function(P,D,V){return P[0]=D[0]*V[0],P[1]=D[1]*V[1],P[2]=D[2]*V[2],P[3]=D[3]*V[3],P}(T,T,[A,A,h?1/T[3]:A,A])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const T=Rr([],iv([],Zo([],v[S[0]],v[S[1]]),Zo([],v[S[2]],v[S[1]]))),A=-yo(T,v[S[1]]);return T.concat(A)});return new sv(v,y)}}class Br{static fromPoints(t){const i=[1/0,1/0,1/0],l=[-1/0,-1/0,-1/0];for(const h of t)ad(i,i,h),ld(l,l,h);return new Br(i,l)}static applyTransform(t,i){const l=t.getCorners();for(let h=0;h<l.length;++h)Di(l[h],l[h],i);return Br.fromPoints(l)}constructor(t,i){this.min=t,this.max=i,this.center=oo([],Qs([],this.min,this.max),.5)}quadrant(t){const i=[t%2==0,t<2],l=O0(this.min),h=O0(this.max);for(let p=0;p<i.length;p++)l[p]=i[p]?this.min[p]:this.center[p],h[p]=i[p]?this.center[p]:this.max[p];return h[2]=this.max[2],new Br(l,h)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,i=this.max;return[[t[0],t[1],t[2]],[i[0],t[1],t[2]],[i[0],i[1],t[2]],[t[0],i[1],t[2]],[t[0],t[1],i[2]],[i[0],t[1],i[2]],[i[0],i[1],i[2]],[t[0],i[1],i[2]]]}intersects(t){const i=this.getCorners();let l=!0;for(let h=0;h<t.planes.length;h++){const p=t.planes[h];let v=0;for(let y=0;y<i.length;y++)v+=yo(p,i[y])+p[3]>=0;if(v===0)return 0;v!==i.length&&(l=!1)}if(l)return 2;for(let h=0;h<3;h++){let p=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let y=0;y<t.points.length;y++){const S=t.points[y][h]-this.min[h];p=Math.min(p,S),v=Math.max(v,S)}if(v<0||p>this.max[h]-this.min[h])return 0}return 1}}const vs=un/Math.PI/2,Kl=64,dd=[Kl,32,16],xo=-vs,bo=vs,HE=[new Br([xo,xo,xo],[bo,bo,bo]),new Br([xo,xo,xo],[0,0,bo]),new Br([0,xo,xo],[bo,0,bo]),new Br([xo,0,xo],[0,bo,bo]),new Br([0,0,xo],[bo,bo,bo])];function Gp(n){return n*vs/md}function H0(n,t,i,l=!0){const h=oo([],n._camera.position,n.worldSize),p=[t,i,1,1];Yl(p,p,n.pixelMatrixInverse),$0(p,p,1/p[3]);const v=Rr([],Zo([],p,h)),y=n.globeMatrix,S=[y[12],y[13],y[14]],T=Zo([],S,h),A=sd(T),P=Rr([],T),D=n.worldSize/(2*Math.PI),V=yo(P,v),$=Math.asin(D/A);if($<Math.acos(V)){if(!l)return null;const vt=[],We=[];oo(vt,v,A/V),Rr(We,Zo(We,vt,T)),Rr(v,Qs(v,T,oo(v,We,Math.tan($)*A)))}const j=[];new rv(h,v).closestPointOnSphere(S,D,j);const X=Rr([],Ot(y,0)),le=Rr([],Ot(y,1)),ye=Rr([],Ot(y,2)),ie=yo(X,j),ge=yo(le,j),Ee=yo(ye,j),xe=be(Math.asin(-ge/D));let je=be(Math.atan2(ie,Ee));je=n.center.lng+function(vt,We){const it=(We-vt+180)%360-180;return it<-180?it+360:it}(n.center.lng,je);const $e=ys(je),tt=nt(xs(xe),0,1);return new Eu($e,tt)}class XE{constructor(t,i,l){this.a=Zo([],t,l),this.b=Zo([],i,l),this.center=l;const h=Rr([],this.a),p=Rr([],this.b);this.angle=Math.acos(yo(h,p))}}function av(n,t){if(n.angle===0)return null;let i;return i=n.a[t]===0?1/n.angle*.5*Math.PI:1/n.angle*Math.atan(n.b[t]/n.a[t]/Math.sin(n.angle)-1/Math.tan(n.angle)),i<0||i>1?null:function(l,h,p,v){const y=Math.sin(p);return l*(Math.sin((1-v)*p)/y)+h*(Math.sin(v*p)/y)}(n.a[t],n.b[t],n.angle,nt(i,0,1))+n.center[t]}function _s(n){if(n.z<=1)return HE[n.z+2*n.y+n.x];const t=lv(qp(n));return Br.fromPoints(t)}function Jl(n,t,i){return oo(n,n,1-i),cd(n,n,t,i)}function X0(n,t){const i=Tu(t.zoom);if(i===0)return _s(n);const l=qp(n),h=lv(l),p=ys(l.getWest())*t.worldSize,v=ys(l.getEast())*t.worldSize,y=xs(l.getNorth())*t.worldSize,S=xs(l.getSouth())*t.worldSize,T=[p,y,0],A=[v,y,0],P=[p,S,0],D=[v,S,0],V=Qg([],t.globeMatrix);return Di(T,T,V),Di(A,A,V),Di(P,P,V),Di(D,D,V),h[0]=Jl(h[0],P,i),h[1]=Jl(h[1],D,i),h[2]=Jl(h[2],A,i),h[3]=Jl(h[3],T,i),Br.fromPoints(h)}function Y0(n,t,i){for(const l of n)Di(l,l,t),oo(l,l,i)}function YE(n,t,i){const l=t/n.worldSize,h=n.globeMatrix;if(i.z<=1){const $e=_s(i).getCorners();return Y0($e,h,l),Br.fromPoints($e)}const p=qp(i),v=lv(p);Y0(v,h,l);const y=Number.MAX_VALUE,S=[-y,-y,-y],T=[y,y,y];if(p.contains(n.center)){for(const vt of v)ad(T,T,vt),ld(S,S,vt);S[2]=0;const $e=n.point,tt=[$e.x*l,$e.y*l,0];return ad(T,T,tt),ld(S,S,tt),new Br(T,S)}const A=[h[12]*l,h[13]*l,h[14]*l],P=p.getCenter(),D=nt(n.center.lat,-br,br),V=nt(P.lat,-br,br),$=ys(n.center.lng),j=xs(D);let X=$-ys(P.lng);const le=j-xs(V);X>.5?X-=1:X<-.5&&(X+=1);let ye=0;Math.abs(X)>Math.abs(le)?ye=X>=0?1:3:(ye=le>=0?0:2,cd(A,A,[h[4]*l,h[5]*l,h[6]*l],-Math.sin(Se(le>=0?p.getSouth():p.getNorth()))*vs));const ie=v[ye],ge=v[(ye+1)%4],Ee=new XE(ie,ge,A),xe=[av(Ee,0)||ie[0],av(Ee,1)||ie[1],av(Ee,2)||ie[2]],je=Tu(n.zoom);if(je>0){const $e=function({x:vt,y:We,z:it},ot,dt,_t,Xe){const Ct=1/(1<<it);let nn=vt*Ct,Dt=nn+Ct,qt=We*Ct,It=qt+Ct,sn=0;const Cn=(nn+Dt)/2-_t;return Cn>.5?sn=-1:Cn<-.5&&(sn=1),nn=((nn+sn)*ot-(_t*=ot))*dt+_t,Dt=((Dt+sn)*ot-_t)*dt+_t,qt=(qt*ot-(Xe*=ot))*dt+Xe,It=(It*ot-Xe)*dt+Xe,[[nn,It,0],[Dt,It,0],[Dt,qt,0],[nn,qt,0]]}(i,t,n._pixelsPerMercatorPixel,$,j);for(let vt=0;vt<v.length;vt++)Jl(v[vt],$e[vt],je);const tt=Qs([],$e[ye],$e[(ye+1)%4]);oo(tt,tt,.5),Jl(xe,tt,je)}for(const $e of v)ad(T,T,$e),ld(S,S,$e);return T[2]=Math.min(ie[2],ge[2]),ad(T,T,xe),ld(S,S,xe),new Br(T,S)}function qp({x:n,y:t,z:i}){const l=1/(1<<i),h=new Vn(so(n*l),xr((t+1)*l)),p=new Vn(so((n+1)*l),xr(t*l));return new Ga(h,p)}function lv(n){const t=Se(n.getNorth()),i=Se(n.getSouth()),l=Math.cos(t),h=Math.cos(i),p=Math.sin(t),v=Math.sin(i),y=n.getWest(),S=n.getEast();return[wu(h,v,y),wu(h,v,S),wu(l,p,S),wu(l,p,y)]}function wu(n,t,i,l=vs){return i=Se(i),[n*Math.sin(i)*l,-t*l,n*Math.cos(i)*l]}function Su(n,t,i){return wu(Math.cos(Se(n)),Math.sin(Se(n)),t,i)}function fd(n,t,i,l){const h=1<<i.z,p=(n/un+i.x)/h;return Su(xr((t/un+i.y)/h),so(p),l)}function Zp({min:n,max:t}){return 16383/Math.max(t[0]-n[0],t[1]-n[1],t[2]-n[2])}const K0=new Float64Array(16);function pd(n){const t=Zp(n),i=R0(K0,[t,t,t]);return od(i,i,((l=[])[0]=-(h=n.min)[0],l[1]=-h[1],l[2]=-h[2],l));var l,h}function cv(n){const t=(l=n.min,(i=K0)[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=l[0],i[13]=l[1],i[14]=l[2],i[15]=1,i);var i,l;const h=1/Zp(n);return Xl(t,t,[h,h,h])}function J0(n,t,i,l,h){const p=function(S){const T=un/(2*Math.PI);return S/(2*Math.PI)/T}(i),v=[n,t,-i/(2*Math.PI)],y=qo(new Float64Array(16));return od(y,y,v),Xl(y,y,[p,p,p]),ev(y,y,Se(-h)),jp(y,y,Se(-l)),y}function Tu(n){return ft(5,6,n)}function Q0(n,t){const i=Su(t.lat,t.lng),l=function($){const j=Su($._center.lat,$._center.lng);let X=iv([],bu(0,1,0),j);const le=B0([],-$.angle,j);X=Di(X,X,le),B0(le,-$._pitch,X);const ye=Rr([],j);return oo(ye,ye,Gp($.cameraToCenterDistance/$.pixelsPerMeter)),Di(ye,ye,le),Qs([],j,ye)}(n);return v=(h=nv([],l,i))[0],y=h[1],S=h[2],T=(p=i)[0],A=p[1],P=p[2],V=(D=Math.sqrt(v*v+y*y+S*S)*Math.sqrt(T*T+A*A+P*P))&&yo(h,p)/D,Math.acos(Math.min(Math.max(V,-1),1));var h,p,v,y,S,T,A,P,D,V}function uv(n,t){return Q0(n,t)>Math.PI/2*1.01}const ex=Se(85),KE=Math.cos(ex),JE=Math.sin(ex),md=63710088e-1,tx=2*Math.PI*md;class Vn{constructor(t,i){if(isNaN(t)||isNaN(i))throw new Error(`Invalid LngLat object: (${t}, ${i})`);if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Vn(Pe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const i=Math.PI/180,l=this.lat*i,h=t.lat*i,p=Math.sin(l)*Math.sin(h)+Math.cos(l)*Math.cos(h)*Math.cos((t.lng-this.lng)*i);return md*Math.acos(Math.min(p,1))}toBounds(t=0){const i=360*t/40075017,l=i/Math.cos(Math.PI/180*this.lat);return new Ga(new Vn(this.lng-l,this.lat-i),new Vn(this.lng+l,this.lat+i))}toEcef(t){const i=Gp(t);return Su(this.lat,this.lng,vs+i)}static convert(t){if(t instanceof Vn)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Vn(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Vn(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function hv(n){return tx*Math.cos(n*Math.PI/180)}function ys(n){return(180+n)/360}function xs(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function Wo(n,t){return n/hv(t)}function so(n){return 360*n-180}function xr(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function nx(n,t){return n*hv(xr(t))}const br=85.051129;function ix(n){return 1/Math.cos(n*Math.PI/180)}class Eu{constructor(t,i,l=0){this.x=+t,this.y=+i,this.z=+l}static fromLngLat(t,i=0){const l=Vn.convert(t);return new Eu(ys(l.lng),xs(l.lat),Wo(i,l.lat))}toLngLat(){return new Vn(so(this.x),xr(this.y))}toAltitude(){return nx(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/tx*ix(xr(this.y))}}function dv(n,t,i,l,h,p,v,y,S){const T=(t+l)/2,A=(i+h)/2,P=new Y(T,A);y(P),function(D,V,$,j,X,le){const ye=$-X,ie=j-le;return Math.abs((j-V)*ye-($-D)*ie)/Math.hypot(ye,ie)}(P.x,P.y,p.x,p.y,v.x,v.y)>=S?(dv(n,t,i,T,A,p,P,y,S),dv(n,T,A,l,h,P,v,y,S)):n.push(v)}function rx(n,t,i){let l=n[0],h=l.x,p=l.y;t(l);const v=[l];for(let y=1;y<n.length;y++){const S=n[y],{x:T,y:A}=S;t(S),dv(v,h,p,T,A,l,S,t,i),h=T,p=A,l=S}return v}function fv(n,t,i,l){if(l(t,i)){const h=t.add(i)._mult(.5);fv(n,t,h,l),fv(n,h,i,l)}else n.push(i)}function QE(n,t){let i=n[0];const l=[i];for(let h=1;h<n.length;h++){const p=n[h];fv(l,i,p,t),i=p}return l}const pv=Math.pow(2,14)-1,ox=-pv-1;function eC(n,t){const i=Math.round(n.x*t),l=Math.round(n.y*t);return n.x=nt(i,ox,pv),n.y=nt(l,ox,pv),(i<n.x||i>n.x+1||l<n.y||l>n.y+1)&&ue("Geometry exceeds allowed extent, reduce your vector tile buffer size"),n}function ea(n,t,i){const l=n.loadGeometry(),h=n.extent,p=un/h;if(t&&i&&i.projection.isReprojectedInTileSpace){const v=1<<t.z,{scale:y,x:S,y:T,projection:A}=i,P=D=>{const V=so((t.x+D.x/h)/v),$=xr((t.y+D.y/h)/v),j=A.project(V,$);D.x=(j.x*y-S)*h,D.y=(j.y*y-T)*h};for(let D=0;D<l.length;D++)if(n.type!==1)l[D]=rx(l[D],P,1);else{const V=[];for(const $ of l[D])$.x<0||$.x>=h||$.y<0||$.y>=h||(P($),V.push($));l[D]=V}}for(const v of l)for(const y of v)eC(y,p);return l}function Ql(n,t){return{type:n.type,id:n.id,properties:n.properties,geometry:t?ea(n):[]}}function Wp(n,t,i,l,h){n.emplaceBack(2*t+(l+1)/2,2*i+(h+1)/2)}function Hp(n,t,i){n.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class mv{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new Qt,this.indexArray=new yr,this.segments=new Fi,this.programConfigurations=new Wl(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,l,h){const p=this.layers[0],v=[];let y=null;p.type==="circle"&&(y=p.layout.get("circle-sort-key"));for(const{feature:T,id:A,index:P,sourceLayerIndex:D}of t){const V=this.layers[0]._featureFilter.needGeometry,$=Ql(T,V);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),$,l))continue;const j=y?y.evaluate($,{},l):void 0,X={id:A,properties:T.properties,type:T.type,sourceLayerIndex:D,index:P,geometry:V?$.geometry:ea(T,l,h),patterns:{},sortKey:j};v.push(X)}y&&v.sort((T,A)=>T.sortKey-A.sortKey);let S=null;h.projection.name==="globe"&&(this.globeExtVertexArray=new ro,S=h.projection);for(const T of v){const{geometry:A,index:P,sourceLayerIndex:D}=T,V=t[P].feature;this.addFeature(T,A,P,i.availableImages,l,S),i.featureIndex.insert(V,A,P,D,this.index)}}update(t,i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,NE.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,UE.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,i,l,h,p,v){for(const y of i)for(const S of y){const T=S.x,A=S.y;if(T<0||T>=un||A<0||A>=un)continue;if(v){const V=v.projectTilePoint(T,A,p),$=v.upVector(p,T,A),j=this.globeExtVertexArray;Hp(j,V,$),Hp(j,V,$),Hp(j,V,$),Hp(j,V,$)}const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),D=P.vertexLength;Wp(this.layoutVertexArray,T,A,-1,-1),Wp(this.layoutVertexArray,T,A,1,-1),Wp(this.layoutVertexArray,T,A,1,1),Wp(this.layoutVertexArray,T,A,-1,1),this.indexArray.emplaceBack(D,D+1,D+2),this.indexArray.emplaceBack(D,D+2,D+3),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},h,p)}}function sx(n,t){for(let i=0;i<n.length;i++)if(ec(t,n[i]))return!0;for(let i=0;i<t.length;i++)if(ec(n,t[i]))return!0;return!!gv(n,t)}function tC(n,t,i){return!!ec(n,t)||!!vv(t,n,i)}function ax(n,t){if(n.length===1)return cx(t,n[0]);for(let i=0;i<t.length;i++){const l=t[i];for(let h=0;h<l.length;h++)if(ec(n,l[h]))return!0}for(let i=0;i<n.length;i++)if(cx(t,n[i]))return!0;for(let i=0;i<t.length;i++)if(gv(n,t[i]))return!0;return!1}function nC(n,t,i){if(n.length>1){if(gv(n,t))return!0;for(let l=0;l<t.length;l++)if(vv(t[l],n,i))return!0}for(let l=0;l<n.length;l++)if(vv(n[l],t,i))return!0;return!1}function gv(n,t){if(n.length===0||t.length===0)return!1;for(let i=0;i<n.length-1;i++){const l=n[i],h=n[i+1];for(let p=0;p<t.length-1;p++)if(iC(l,h,t[p],t[p+1]))return!0}return!1}function iC(n,t,i,l){return Me(n,i,l)!==Me(t,i,l)&&Me(n,t,i)!==Me(n,t,l)}function vv(n,t,i){const l=i*i;if(t.length===1)return n.distSqr(t[0])<l;for(let h=1;h<t.length;h++)if(lx(n,t[h-1],t[h])<l)return!0;return!1}function lx(n,t,i){const l=t.distSqr(i);if(l===0)return n.distSqr(t);const h=((n.x-t.x)*(i.x-t.x)+(n.y-t.y)*(i.y-t.y))/l;return n.distSqr(h<0?t:h>1?i:i.sub(t)._mult(h)._add(t))}function cx(n,t){let i,l,h,p=!1;for(let v=0;v<n.length;v++){i=n[v];for(let y=0,S=i.length-1;y<i.length;S=y++)l=i[y],h=i[S],l.y>t.y!=h.y>t.y&&t.x<(h.x-l.x)*(t.y-l.y)/(h.y-l.y)+l.x&&(p=!p)}return p}function ec(n,t){let i=!1;for(let l=0,h=n.length-1;l<n.length;h=l++){const p=n[l],v=n[h];p.y>t.y!=v.y>t.y&&t.x<(v.x-p.x)*(t.y-p.y)/(v.y-p.y)+p.x&&(i=!i)}return i}function ux(n,t,i,l,h){for(const v of n)if(t<=v.x&&i<=v.y&&l>=v.x&&h>=v.y)return!0;const p=[new Y(t,i),new Y(t,h),new Y(l,h),new Y(l,i)];if(n.length>2){for(const v of p)if(ec(n,v))return!0}for(let v=0;v<n.length-1;v++)if(rC(n[v],n[v+1],p))return!0;return!1}function rC(n,t,i){const l=i[0],h=i[2];if(n.x<l.x&&t.x<l.x||n.x>h.x&&t.x>h.x||n.y<l.y&&t.y<l.y||n.y>h.y&&t.y>h.y)return!1;const p=Me(n,t,i[0]);return p!==Me(n,t,i[1])||p!==Me(n,t,i[2])||p!==Me(n,t,i[3])}function Cu(n,t,i){const l=t.paint.get(n).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(n)}function Xp(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function hx(n,t,i,l,h){if(!t[0]&&!t[1])return n;const p=Y.convert(t)._mult(h);i==="viewport"&&p._rotate(-l);const v=[];for(let y=0;y<n.length;y++)v.push(n[y].sub(p));return v}function dx(n,t,i,l){const h=Y.convert(n)._mult(l);return t==="viewport"&&h._rotate(-i),h}$t(mv,"CircleBucket",{omit:["layers"]});const oC=new mt({"circle-sort-key":new Ze(et.layout_circle["circle-sort-key"])});var sC={paint:new mt({"circle-radius":new Ze(et.paint_circle["circle-radius"]),"circle-color":new Ze(et.paint_circle["circle-color"]),"circle-blur":new Ze(et.paint_circle["circle-blur"]),"circle-opacity":new Ze(et.paint_circle["circle-opacity"]),"circle-translate":new Le(et.paint_circle["circle-translate"]),"circle-translate-anchor":new Le(et.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Le(et.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Le(et.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ze(et.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ze(et.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ze(et.paint_circle["circle-stroke-opacity"])}),layout:oC};function fx(n,t,i,l,h,p,v,y,S){if(p&&n.queryGeometry.isAboveHorizon)return!1;p&&(S*=n.pixelToTileUnitsFactor);const T=n.tileID.canonical,A=i.projection.upVectorScale(T,i.center.lat,i.worldSize).metersToTile;for(const P of t)for(const D of P){const V=D.add(y),$=h&&i.elevation?i.elevation.exaggeration()*h.getElevationAt(V.x,V.y,!0):0,j=i.projection.projectTilePoint(V.x,V.y,T);if($>0){const ie=i.projection.upVector(T,V.x,V.y);j.x+=ie[0]*A*$,j.y+=ie[1]*A*$,j.z+=ie[2]*A*$}const X=p?V:aC(j.x,j.y,j.z,l),le=p?n.tilespaceRays.map(ie=>cC(ie,$)):n.queryGeometry.screenGeometry,ye=Yl([],[j.x,j.y,j.z,1],l);if(!v&&p?S*=ye[3]/i.cameraToCenterDistance:v&&!p&&(S*=i.cameraToCenterDistance/ye[3]),p){const ie=xr((D.y/un+T.y)/(1<<T.z));S/=i.projection.pixelsPerMeter(ie,1)/Wo(1,ie)}if(tC(le,X,S))return!0}return!1}function aC(n,t,i,l){const h=Yl([],[n,t,i,1],l);return new Y(h[0]/h[3],h[1]/h[3])}const px=bu(0,0,0),lC=bu(0,0,1);function cC(n,t){const i=tv();return px[2]=t,n.intersectsPlane(px,lC,i),new Y(i[0],i[1])}class mx extends mv{}function gx(n,{width:t,height:i},l,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*i*l)throw new RangeError("mismatched image size")}else h=new Uint8Array(t*i*l);return n.width=t,n.height=i,n.data=h,n}function vx(n,t,i){const{width:l,height:h}=t;l===n.width&&h===n.height||(_v(n,t,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,l),height:Math.min(n.height,h)},i),n.width=l,n.height=h,n.data=t.data)}function _v(n,t,i,l,h,p){if(h.width===0||h.height===0)return t;if(h.width>n.width||h.height>n.height||i.x>n.width-h.width||i.y>n.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||l.x>t.width-h.width||l.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const v=n.data,y=t.data;for(let S=0;S<h.height;S++){const T=((i.y+S)*n.width+i.x)*p,A=((l.y+S)*t.width+l.x)*p;for(let P=0;P<h.width*p;P++)y[A+P]=v[T+P]}return t}$t(mx,"HeatmapBucket",{omit:["layers"]});class ta{constructor(t,i){gx(this,t,1,i)}resize(t){vx(this,new ta(t),1)}clone(){return new ta({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,l,h,p){_v(t,i,l,h,p,1)}}class Kr{constructor(t,i){gx(this,t,4,i)}resize(t){vx(this,new Kr(t),4)}replace(t,i){i?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Kr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,l,h,p){_v(t,i,l,h,p,4)}}$t(ta,"AlphaImage"),$t(Kr,"RGBAImage");var uC={paint:new mt({"heatmap-radius":new Ze(et.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ze(et.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Le(et.paint_heatmap["heatmap-intensity"]),"heatmap-color":new lt(et.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Le(et.paint_heatmap["heatmap-opacity"])})};function yv(n){const t={},i=n.resolution||256,l=n.clips?n.clips.length:1,h=n.image||new Kr({width:i,height:l}),p=(v,y,S)=>{t[n.evaluationKey]=S;const T=n.expression.evaluate(t);h.data[v+y+0]=Math.floor(255*T.r/T.a),h.data[v+y+1]=Math.floor(255*T.g/T.a),h.data[v+y+2]=Math.floor(255*T.b/T.a),h.data[v+y+3]=Math.floor(255*T.a)};if(n.clips)for(let v=0,y=0;v<l;++v,y+=4*i)for(let S=0,T=0;S<i;S++,T+=4){const A=S/(i-1),{start:P,end:D}=n.clips[v];p(y,T,P*(1-A)+D*A)}else for(let v=0,y=0;v<i;v++,y+=4)p(0,y,v/(i-1));return h}var hC={paint:new mt({"hillshade-illumination-direction":new Le(et.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Le(et.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Le(et.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Le(et.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Le(et.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Le(et.paint_hillshade["hillshade-accent-color"])})};const dC=Ht([{name:"a_pos",components:2,type:"Int16"}],4),{members:fC}=dC;var Iu={};function Yp(n,t,i){i=i||2;var l,h,p,v,y,S,T,A=t&&t.length,P=A?t[0]*i:n.length,D=_x(n,0,P,i,!0),V=[];if(!D||D.next===D.prev)return V;if(A&&(D=function(j,X,le,ye){var ie,ge,Ee,xe=[];for(ie=0,ge=X.length;ie<ge;ie++)(Ee=_x(j,X[ie]*ye,ie<ge-1?X[ie+1]*ye:j.length,ye,!1))===Ee.next&&(Ee.steiner=!0),xe.push(bC(Ee));for(xe.sort(_C),ie=0;ie<xe.length;ie++)le=yC(xe[ie],le);return le}(n,t,D,i)),n.length>80*i){l=p=n[0],h=v=n[1];for(var $=i;$<P;$+=i)(y=n[$])<l&&(l=y),(S=n[$+1])<h&&(h=S),y>p&&(p=y),S>v&&(v=S);T=(T=Math.max(p-l,v-h))!==0?32767/T:0}return gd(D,V,i,l,h,T,0),V}function _x(n,t,i,l,h){var p,v;if(h===wv(n,t,i,l)>0)for(p=t;p<i;p+=l)v=bx(p,n[p],n[p+1],v);else for(p=i-l;p>=t;p-=l)v=bx(p,n[p],n[p+1],v);return v&&Kp(v,v.next)&&(_d(v),v=v.next),v}function tc(n,t){if(!n)return n;t||(t=n);var i,l=n;do if(i=!1,l.steiner||!Kp(l,l.next)&&Vi(l.prev,l,l.next)!==0)l=l.next;else{if(_d(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function gd(n,t,i,l,h,p,v){if(n){!v&&p&&function(A,P,D,V){var $=A;do $.z===0&&($.z=xv($.x,$.y,P,D,V)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==A);$.prevZ.nextZ=null,$.prevZ=null,function(j){var X,le,ye,ie,ge,Ee,xe,je,$e=1;do{for(le=j,j=null,ge=null,Ee=0;le;){for(Ee++,ye=le,xe=0,X=0;X<$e&&(xe++,ye=ye.nextZ);X++);for(je=$e;xe>0||je>0&&ye;)xe!==0&&(je===0||!ye||le.z<=ye.z)?(ie=le,le=le.nextZ,xe--):(ie=ye,ye=ye.nextZ,je--),ge?ge.nextZ=ie:j=ie,ie.prevZ=ge,ge=ie;le=ye}ge.nextZ=null,$e*=2}while(Ee>1)}($)}(n,l,h,p);for(var y,S,T=n;n.prev!==n.next;)if(y=n.prev,S=n.next,p?mC(n,l,h,p):pC(n))t.push(y.i/i|0),t.push(n.i/i|0),t.push(S.i/i|0),_d(n),n=S.next,T=S.next;else if((n=S)===T){v?v===1?gd(n=gC(tc(n),t,i),t,i,l,h,p,2):v===2&&vC(n,t,i,l,h,p):gd(tc(n),t,i,l,h,p,1);break}}}function pC(n){var t=n.prev,i=n,l=n.next;if(Vi(t,i,l)>=0)return!1;for(var h=t.x,p=i.x,v=l.x,y=t.y,S=i.y,T=l.y,A=h<p?h<v?h:v:p<v?p:v,P=y<S?y<T?y:T:S<T?S:T,D=h>p?h>v?h:v:p>v?p:v,V=y>S?y>T?y:T:S>T?S:T,$=l.next;$!==t;){if($.x>=A&&$.x<=D&&$.y>=P&&$.y<=V&&Au(h,y,p,S,v,T,$.x,$.y)&&Vi($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function mC(n,t,i,l){var h=n.prev,p=n,v=n.next;if(Vi(h,p,v)>=0)return!1;for(var y=h.x,S=p.x,T=v.x,A=h.y,P=p.y,D=v.y,V=y<S?y<T?y:T:S<T?S:T,$=A<P?A<D?A:D:P<D?P:D,j=y>S?y>T?y:T:S>T?S:T,X=A>P?A>D?A:D:P>D?P:D,le=xv(V,$,t,i,l),ye=xv(j,X,t,i,l),ie=n.prevZ,ge=n.nextZ;ie&&ie.z>=le&&ge&&ge.z<=ye;){if(ie.x>=V&&ie.x<=j&&ie.y>=$&&ie.y<=X&&ie!==h&&ie!==v&&Au(y,A,S,P,T,D,ie.x,ie.y)&&Vi(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,ge.x>=V&&ge.x<=j&&ge.y>=$&&ge.y<=X&&ge!==h&&ge!==v&&Au(y,A,S,P,T,D,ge.x,ge.y)&&Vi(ge.prev,ge,ge.next)>=0))return!1;ge=ge.nextZ}for(;ie&&ie.z>=le;){if(ie.x>=V&&ie.x<=j&&ie.y>=$&&ie.y<=X&&ie!==h&&ie!==v&&Au(y,A,S,P,T,D,ie.x,ie.y)&&Vi(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;ge&&ge.z<=ye;){if(ge.x>=V&&ge.x<=j&&ge.y>=$&&ge.y<=X&&ge!==h&&ge!==v&&Au(y,A,S,P,T,D,ge.x,ge.y)&&Vi(ge.prev,ge,ge.next)>=0)return!1;ge=ge.nextZ}return!0}function gC(n,t,i){var l=n;do{var h=l.prev,p=l.next.next;!Kp(h,p)&&yx(h,l,l.next,p)&&vd(h,p)&&vd(p,h)&&(t.push(h.i/i|0),t.push(l.i/i|0),t.push(p.i/i|0),_d(l),_d(l.next),l=n=p),l=l.next}while(l!==n);return tc(l)}function vC(n,t,i,l,h,p){var v=n;do{for(var y=v.next.next;y!==v.prev;){if(v.i!==y.i&&wC(v,y)){var S=xx(v,y);return v=tc(v,v.next),S=tc(S,S.next),gd(v,t,i,l,h,p,0),void gd(S,t,i,l,h,p,0)}y=y.next}v=v.next}while(v!==n)}function _C(n,t){return n.x-t.x}function yC(n,t){var i=function(h,p){var v,y=p,S=h.x,T=h.y,A=-1/0;do{if(T<=y.y&&T>=y.next.y&&y.next.y!==y.y){var P=y.x+(T-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(P<=S&&P>A&&(A=P,v=y.x<y.next.x?y:y.next,P===S))return v}y=y.next}while(y!==p);if(!v)return null;var D,V=v,$=v.x,j=v.y,X=1/0;y=v;do S>=y.x&&y.x>=$&&S!==y.x&&Au(T<j?S:A,T,$,j,T<j?A:S,T,y.x,y.y)&&(D=Math.abs(T-y.y)/(S-y.x),vd(y,h)&&(D<X||D===X&&(y.x>v.x||y.x===v.x&&xC(v,y)))&&(v=y,X=D)),y=y.next;while(y!==V);return v}(n,t);if(!i)return t;var l=xx(i,n);return tc(l,l.next),tc(i,i.next)}function xC(n,t){return Vi(n.prev,n,t.prev)<0&&Vi(t.next,n,n.next)<0}function xv(n,t,i,l,h){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*h|0)|n<<8))|n<<4))|n<<2))|n<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function bC(n){var t=n,i=n;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==n);return i}function Au(n,t,i,l,h,p,v,y){return(h-v)*(t-y)>=(n-v)*(p-y)&&(n-v)*(l-y)>=(i-v)*(t-y)&&(i-v)*(p-y)>=(h-v)*(l-y)}function wC(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!function(i,l){var h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==l.i&&h.next.i!==l.i&&yx(h,h.next,i,l))return!0;h=h.next}while(h!==i);return!1}(n,t)&&(vd(n,t)&&vd(t,n)&&function(i,l){var h=i,p=!1,v=(i.x+l.x)/2,y=(i.y+l.y)/2;do h.y>y!=h.next.y>y&&h.next.y!==h.y&&v<(h.next.x-h.x)*(y-h.y)/(h.next.y-h.y)+h.x&&(p=!p),h=h.next;while(h!==i);return p}(n,t)&&(Vi(n.prev,n,t.prev)||Vi(n,t.prev,t))||Kp(n,t)&&Vi(n.prev,n,n.next)>0&&Vi(t.prev,t,t.next)>0)}function Vi(n,t,i){return(t.y-n.y)*(i.x-t.x)-(t.x-n.x)*(i.y-t.y)}function Kp(n,t){return n.x===t.x&&n.y===t.y}function yx(n,t,i,l){var h=Qp(Vi(n,t,i)),p=Qp(Vi(n,t,l)),v=Qp(Vi(i,l,n)),y=Qp(Vi(i,l,t));return h!==p&&v!==y||!(h!==0||!Jp(n,i,t))||!(p!==0||!Jp(n,l,t))||!(v!==0||!Jp(i,n,l))||!(y!==0||!Jp(i,t,l))}function Jp(n,t,i){return t.x<=Math.max(n.x,i.x)&&t.x>=Math.min(n.x,i.x)&&t.y<=Math.max(n.y,i.y)&&t.y>=Math.min(n.y,i.y)}function Qp(n){return n>0?1:n<0?-1:0}function vd(n,t){return Vi(n.prev,n,n.next)<0?Vi(n,t,n.next)>=0&&Vi(n,n.prev,t)>=0:Vi(n,t,n.prev)<0||Vi(n,n.next,t)<0}function xx(n,t){var i=new bv(n.i,n.x,n.y),l=new bv(t.i,t.x,t.y),h=n.next,p=t.prev;return n.next=t,t.prev=n,i.next=h,h.prev=i,l.next=i,i.prev=l,p.next=l,l.prev=p,l}function bx(n,t,i,l){var h=new bv(n,t,i);return l?(h.next=l.next,h.prev=l,l.next.prev=h,l.next=h):(h.prev=h,h.next=h),h}function _d(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function bv(n,t,i){this.i=n,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function wv(n,t,i,l){for(var h=0,p=t,v=i-l;p<i;p+=l)h+=(n[v]-n[p])*(n[p+1]+n[v+1]),v=p;return h}function SC(n,t,i,l,h){wx(n,t,i||0,l||n.length-1,h||TC)}function wx(n,t,i,l,h){for(;l>i;){if(l-i>600){var p=l-i+1,v=t-i+1,y=Math.log(p),S=.5*Math.exp(2*y/3),T=.5*Math.sqrt(y*S*(p-S)/p)*(v-p/2<0?-1:1);wx(n,t,Math.max(i,Math.floor(t-v*S/p+T)),Math.min(l,Math.floor(t+(p-v)*S/p+T)),h)}var A=n[t],P=i,D=l;for(yd(n,i,t),h(n[l],A)>0&&yd(n,i,l);P<D;){for(yd(n,P,D),P++,D--;h(n[P],A)<0;)P++;for(;h(n[D],A)>0;)D--}h(n[i],A)===0?yd(n,i,D):yd(n,++D,l),D<=t&&(i=D+1),t<=D&&(l=D-1)}}function yd(n,t,i){var l=n[t];n[t]=n[i],n[i]=l}function TC(n,t){return n<t?-1:n>t?1:0}function Sv(n,t){const i=n.length;if(i<=1)return[n];const l=[];let h,p;for(let v=0;v<i;v++){const y=qe(n[v]);y!==0&&(n[v].area=Math.abs(y),p===void 0&&(p=y<0),p===y<0?(h&&l.push(h),h=[n[v]]):h.push(n[v]))}if(h&&l.push(h),t>1)for(let v=0;v<l.length;v++)l[v].length<=t||(SC(l[v],t,1,l[v].length-1,EC),l[v]=l[v].slice(0,t));return l}function EC(n,t){return t.area-n.area}function Tv(n,t,i){const l=i.patternDependencies;let h=!1;for(const p of t){const v=p.paint.get(`${n}-pattern`);v.isConstant()||(h=!0);const y=v.constantOr(null);y&&(h=!0,l[y]=!0)}return h}function Ev(n,t,i,l,h){const p=h.patternDependencies;for(const v of t){const y=v.paint.get(`${n}-pattern`).value;if(y.kind!=="constant"){let S=y.evaluate({zoom:l},i,{},h.availableImages);S=S&&S.name?S.name:S,p[S]=!0,i.patterns[v.id]=S}}return i}({get exports(){return Iu},set exports(n){Iu=n}}).exports=Yp,Iu.default=Yp,Yp.deviation=function(n,t,i,l){var h=t&&t.length,p=Math.abs(wv(n,0,h?t[0]*i:n.length,i));if(h)for(var v=0,y=t.length;v<y;v++)p-=Math.abs(wv(n,t[v]*i,v<y-1?t[v+1]*i:n.length,i));var S=0;for(v=0;v<l.length;v+=3){var T=l[v]*i,A=l[v+1]*i,P=l[v+2]*i;S+=Math.abs((n[T]-n[P])*(n[A+1]-n[T+1])-(n[T]-n[A])*(n[P+1]-n[T+1]))}return p===0&&S===0?0:Math.abs((S-p)/p)},Yp.flatten=function(n){for(var t=n[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,h=0;h<n.length;h++){for(var p=0;p<n[h].length;p++)for(var v=0;v<t;v++)i.vertices.push(n[h][p][v]);h>0&&i.holes.push(l+=n[h-1].length)}return i};class em{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Qt,this.indexArray=new yr,this.indexArray2=new ms,this.programConfigurations=new Wl(t.layers,t.zoom),this.segments=new Fi,this.segments2=new Fi,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=t.projection}populate(t,i,l,h){this.hasPattern=Tv("fill",this.layers,i);const p=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:y,id:S,index:T,sourceLayerIndex:A}of t){const P=this.layers[0]._featureFilter.needGeometry,D=Ql(y,P);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),D,l))continue;const V=p?p.evaluate(D,{},l,i.availableImages):void 0,$={id:S,properties:y.properties,type:y.type,sourceLayerIndex:A,index:T,geometry:P?D.geometry:ea(y,l,h),patterns:{},sortKey:V};v.push($)}p&&v.sort((y,S)=>y.sortKey-S.sortKey);for(const y of v){const{geometry:S,index:T,sourceLayerIndex:A}=y;if(this.hasPattern){const P=Ev("fill",this.layers,y,this.zoom,i);this.patternFeatures.push(P)}else this.addFeature(y,S,T,l,{},i.availableImages);i.featureIndex.insert(t[T].feature,S,T,A,this.index)}}update(t,i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,l,h)}addFeatures(t,i,l,h,p){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,i,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,fC),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,i,l,h,p,v=[]){for(const y of Sv(i,500)){let S=0;for(const $ of y)S+=$.length;const T=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),A=T.vertexLength,P=[],D=[];for(const $ of y){if($.length===0)continue;$!==y[0]&&D.push(P.length/2);const j=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),X=j.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(X+$.length-1,X),P.push($[0].x),P.push($[0].y);for(let le=1;le<$.length;le++)this.layoutVertexArray.emplaceBack($[le].x,$[le].y),this.indexArray2.emplaceBack(X+le-1,X+le),P.push($[le].x),P.push($[le].y);j.vertexLength+=$.length,j.primitiveLength+=$.length}const V=Iu(P,D);for(let $=0;$<V.length;$+=3)this.indexArray.emplaceBack(A+V[$],A+V[$+1],A+V[$+2]);T.vertexLength+=S,T.primitiveLength+=V.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,p,v,h)}}$t(em,"FillBucket",{omit:["layers","patternFeatures"]});const CC=new mt({"fill-sort-key":new Ze(et.layout_fill["fill-sort-key"])});var IC={paint:new mt({"fill-antialias":new Le(et.paint_fill["fill-antialias"]),"fill-opacity":new Ze(et.paint_fill["fill-opacity"]),"fill-color":new Ze(et.paint_fill["fill-color"]),"fill-outline-color":new Ze(et.paint_fill["fill-outline-color"]),"fill-translate":new Le(et.paint_fill["fill-translate"]),"fill-translate-anchor":new Le(et.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ze(et.paint_fill["fill-pattern"])}),layout:CC};const AC=Ht([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),kC=Ht([{name:"a_centroid_pos",components:2,type:"Uint16"}]),MC=Ht([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:PC}=AC;var tm={},zC=Y,Sx=ku;function ku(n,t,i,l,h){this.properties={},this.extent=i,this.type=0,this._pbf=n,this._geometry=-1,this._keys=l,this._values=h,n.readFields(LC,this,t)}function LC(n,t,i){n==1?t.id=i.readVarint():n==2?function(l,h){for(var p=l.readVarint()+l.pos;l.pos<p;){var v=h._keys[l.readVarint()],y=h._values[l.readVarint()];h.properties[v]=y}}(i,t):n==3?t.type=i.readVarint():n==4&&(t._geometry=i.pos)}function DC(n){for(var t,i,l=0,h=0,p=n.length,v=p-1;h<p;v=h++)l+=((i=n[v]).x-(t=n[h]).x)*(t.y+i.y);return l}ku.types=["Unknown","Point","LineString","Polygon"],ku.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var t,i=n.readVarint()+n.pos,l=1,h=0,p=0,v=0,y=[];n.pos<i;){if(h<=0){var S=n.readVarint();l=7&S,h=S>>3}if(h--,l===1||l===2)p+=n.readSVarint(),v+=n.readSVarint(),l===1&&(t&&y.push(t),t=[]),t.push(new zC(p,v));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&y.push(t),y},ku.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var t=n.readVarint()+n.pos,i=1,l=0,h=0,p=0,v=1/0,y=-1/0,S=1/0,T=-1/0;n.pos<t;){if(l<=0){var A=n.readVarint();i=7&A,l=A>>3}if(l--,i===1||i===2)(h+=n.readSVarint())<v&&(v=h),h>y&&(y=h),(p+=n.readSVarint())<S&&(S=p),p>T&&(T=p);else if(i!==7)throw new Error("unknown command "+i)}return[v,S,y,T]},ku.prototype.toGeoJSON=function(n,t,i){var l,h,p=this.extent*Math.pow(2,i),v=this.extent*n,y=this.extent*t,S=this.loadGeometry(),T=ku.types[this.type];function A(V){for(var $=0;$<V.length;$++){var j=V[$];V[$]=[360*(j.x+v)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(j.y+y)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(l=0;l<S.length;l++)P[l]=S[l][0];A(S=P);break;case 2:for(l=0;l<S.length;l++)A(S[l]);break;case 3:for(S=function(V){var $=V.length;if($<=1)return[V];for(var j,X,le=[],ye=0;ye<$;ye++){var ie=DC(V[ye]);ie!==0&&(X===void 0&&(X=ie<0),X===ie<0?(j&&le.push(j),j=[V[ye]]):j.push(V[ye]))}return j&&le.push(j),le}(S),l=0;l<S.length;l++)for(h=0;h<S[l].length;h++)A(S[l][h])}S.length===1?S=S[0]:T="Multi"+T;var D={type:"Feature",geometry:{type:T,coordinates:S},properties:this.properties};return"id"in this&&(D.id=this.id),D};var RC=Sx,Tx=Ex;function Ex(n,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(BC,this,t),this.length=this._features.length}function BC(n,t,i){n===15?t.version=i.readVarint():n===1?t.name=i.readString():n===5?t.extent=i.readVarint():n===2?t._features.push(i.pos):n===3?t._keys.push(i.readString()):n===4&&t._values.push(function(l){for(var h=null,p=l.readVarint()+l.pos;l.pos<p;){var v=l.readVarint()>>3;h=v===1?l.readString():v===2?l.readFloat():v===3?l.readDouble():v===4?l.readVarint64():v===5?l.readVarint():v===6?l.readSVarint():v===7?l.readBoolean():null}return h}(i))}Ex.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var t=this._pbf.readVarint()+this._pbf.pos;return new RC(this._pbf,t,this.extent,this._keys,this._values)};var OC=Tx;function FC(n,t,i){if(n===3){var l=new OC(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}var Cv=tm.VectorTile=function(n,t){this.layers=n.readFields(FC,{},t)},nm=tm.VectorTileFeature=Sx;function im(n,t,i,l){const h=[],p=l===0?(v,y,S,T,A,P)=>{v.push(new Y(P,S+(P-y)/(T-y)*(A-S)))}:(v,y,S,T,A,P)=>{v.push(new Y(y+(P-S)/(A-S)*(T-y),P))};for(const v of n){const y=[];for(const S of v){if(S.length<=2)continue;const T=[];for(let D=0;D<S.length-1;D++){const V=S[D].x,$=S[D].y,j=S[D+1].x,X=S[D+1].y,le=l===0?V:$,ye=l===0?j:X;le<t?ye>t&&p(T,V,$,j,X,t):le>i?ye<i&&p(T,V,$,j,X,i):T.push(S[D]),ye<t&&le>=t&&p(T,V,$,j,X,t),ye>i&&le<=i&&p(T,V,$,j,X,i)}let A=S[S.length-1];const P=l===0?A.x:A.y;P>=t&&P<=i&&T.push(A),T.length&&(A=T[T.length-1],T[0].x===A.x&&T[0].y===A.y||T.push(T[0]),y.push(T))}y.length&&h.push(y)}return h}tm.VectorTileLayer=Tx;const VC=nm.types,$C=Math.pow(2,13);function xd(n,t,i,l,h,p,v,y){n.emplaceBack((t<<1)+v,(i<<1)+p,(Math.floor(l*$C)<<1)+h,Math.round(y))}function bd(n,t,i){n.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class Cx{constructor(){this.acc=new Y(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Y(t.x,t.y),this.max=new Y(t.x,t.y))}append(t,i){this.currentPolyCount.edges++,this.acc._add(t);const l=this.min,h=this.max;t.x<l.x?l.x=t.x:t.x>h.x&&(h.x=t.x),t.y<l.y?l.y=t.y:t.y>h.y&&(h.y=t.y),((t.x===0||t.x===un)&&t.x===i.x)!=((t.y===0||t.y===un)&&t.y===i.y)&&this.processBorderOverlap(t,i),i.x<0!=t.x<0&&this.addBorderIntersection(0,Fn(i.y,t.y,(0-i.x)/(t.x-i.x))),i.x>un!=t.x>un&&this.addBorderIntersection(1,Fn(i.y,t.y,(un-i.x)/(t.x-i.x))),i.y<0!=t.y<0&&this.addBorderIntersection(2,Fn(i.x,t.x,(0-i.y)/(t.y-i.y))),i.y>un!=t.y>un&&this.addBorderIntersection(3,Fn(i.x,t.x,(un-i.y)/(t.y-i.y)))}addBorderIntersection(t,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const l=this.borders[t];i<l[0]&&(l[0]=i),i>l[1]&&(l[1]=i)}processBorderOverlap(t,i){if(t.x===i.x){if(t.y===i.y)return;const l=t.x===0?0:1;this.addBorderIntersection(l,i.y),this.addBorderIntersection(l,t.y)}else{const l=t.y===0?2:3;this.addBorderIntersection(l,i.x),this.addBorderIntersection(l,t.x)}}centroid(){const t=this.polyCount.reduce((i,l)=>i+l.edges,0);return t!==0?this.acc.div(t)._round():new Y(0,0)}span(){return new Y(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((t,i)=>t+ +(i[0]!==Number.MAX_VALUE),0)}}class wd{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.layoutVertexArray=new ei,this.centroidVertexArray=new I0,this.indexArray=new yr,this.programConfigurations=new Wl(t.layers,t.zoom),this.segments=new Fi,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=t.enableTerrain}populate(t,i,l,h){this.features=[],this.hasPattern=Tv("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(p){const v=Math.exp(Math.PI*(1-p.y/(1<<p.z)*2));return 80150034*v/(v*v+1)/un/(1<<p.z)}(l),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:p,id:v,index:y,sourceLayerIndex:S}of t){const T=this.layers[0]._featureFilter.needGeometry,A=Ql(p,T);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),A,l))continue;const P={id:v,sourceLayerIndex:S,index:y,geometry:T?A.geometry:ea(p,l,h),properties:p.properties,type:p.type,patterns:{}},D=this.layoutVertexArray.length;this.hasPattern?this.features.push(Ev("fill-extrusion",this.layers,P,this.zoom,i)):this.addFeature(P,P.geometry,y,l,{},i.availableImages,h),i.featureIndex.insert(p,P.geometry,y,S,this.index,D)}this.sortBorders()}addFeatures(t,i,l,h,p){for(const v of this.features){const{geometry:y}=v;this.addFeature(v,y,v.index,i,l,h,p)}this.sortBorders()}update(t,i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,PC),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,MC.members,!0))),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,kC.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,i,l,h,p,v,y){const S=[new Y(0,0),new Y(un,un)],T=y.projection,A=T.name==="globe",P=this.enableTerrain&&!A?new Cx:null,D=VC[t.type]==="Polygon";A&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new ro);const V=Sv(i,500);for(let le=V.length-1;le>=0;le--){const ye=V[le];(ye.length===0||($=ye[0]).every(ie=>ie.x<=0)||$.every(ie=>ie.x>=un)||$.every(ie=>ie.y<=0)||$.every(ie=>ie.y>=un))&&V.splice(le,1)}var $;let j;if(A)j=Lx(V,S,h);else{j=[];for(const le of V)j.push({polygon:le,bounds:S})}const X=D?this.edgeRadius:0;for(const{polygon:le,bounds:ye}of j){let ie=0,ge=0;for(const xe of le)D&&!xe[0].equals(xe[xe.length-1])&&xe.push(xe[0]),ge+=D?xe.length-1:xe.length;const Ee=this.segments.prepareSegment((D?5:4)*ge,this.layoutVertexArray,this.indexArray);if(D){const xe=[],je=[];ie=Ee.vertexLength;for(const tt of le){let vt,We;tt.length&&tt!==le[0]&&je.push(xe.length/2),vt=tt[1].sub(tt[0])._perp()._unit();for(let it=1;it<tt.length;it++){const ot=tt[it],dt=tt[it===tt.length-1?1:it+1];let{x:_t,y:Xe}=ot;if(X){We=dt.sub(ot)._perp()._unit();const Ct=vt.add(We)._unit(),nn=X*Math.min(4,1/(vt.x*Ct.x+vt.y*Ct.y));_t+=nn*Ct.x,Xe+=nn*Ct.y,vt=We}xd(this.layoutVertexArray,_t,Xe,0,0,1,1,0),Ee.vertexLength++,xe.push(ot.x,ot.y),A&&bd(this.layoutVertexExtArray,T.projectTilePoint(_t,Xe,h),T.upVector(h,_t,Xe))}}const $e=Iu(xe,je);for(let tt=0;tt<$e.length;tt+=3)this.indexArray.emplaceBack(ie+$e[tt],ie+$e[tt+2],ie+$e[tt+1]),Ee.primitiveLength++}for(const xe of le){P&&xe.length&&P.startRing(xe[0]);let je,$e,tt,vt=xe.length>4&&Mx(xe[xe.length-2],xe[0],xe[1]),We=X?NC(xe[xe.length-2],xe[0],xe[1],X):0;$e=xe[1].sub(xe[0])._perp()._unit();let it=!0;for(let ot=1,dt=0;ot<xe.length;ot++){let _t=xe[ot-1],Xe=xe[ot];const Ct=xe[ot===xe.length-1?1:ot+1];if(P&&D&&P.currentPolyCount.top++,kx(Xe,_t,ye)){X&&($e=Ct.sub(Xe)._perp()._unit(),it=!it);continue}P&&P.append(Xe,_t);const nn=Xe.sub(_t)._perp(),Dt=nn.x/(Math.abs(nn.x)+Math.abs(nn.y)),qt=nn.y>0?1:0,It=_t.dist(Xe);if(dt+It>32768&&(dt=0),X){tt=Ct.sub(Xe)._perp()._unit();let _n=Ax(_t,Xe,Ct,Ix($e,tt),X);isNaN(_n)&&(_n=0);const an=Xe.sub(_t)._unit();_t=_t.add(an.mult(We))._round(),Xe=Xe.add(an.mult(-_n))._round(),We=_n,$e=tt}const sn=Ee.vertexLength,Cn=xe.length>4&&Mx(_t,Xe,Ct);let xn=Px(dt,vt,it);if(xd(this.layoutVertexArray,_t.x,_t.y,Dt,qt,0,0,xn),xd(this.layoutVertexArray,_t.x,_t.y,Dt,qt,0,1,xn),dt+=It,xn=Px(dt,Cn,!it),vt=Cn,xd(this.layoutVertexArray,Xe.x,Xe.y,Dt,qt,0,0,xn),xd(this.layoutVertexArray,Xe.x,Xe.y,Dt,qt,0,1,xn),Ee.vertexLength+=4,this.indexArray.emplaceBack(sn+0,sn+1,sn+2),this.indexArray.emplaceBack(sn+1,sn+3,sn+2),Ee.primitiveLength+=2,X){const _n=ie+(ot===1?xe.length-2:ot-2),an=ot===1?ie:_n+1;if(this.indexArray.emplaceBack(sn+1,_n,sn+3),this.indexArray.emplaceBack(_n,an,sn+3),Ee.primitiveLength+=2,je===void 0&&(je=sn),!kx(Ct,xe[ot],ye)){const Yn=ot===xe.length-1?je:Ee.vertexLength;this.indexArray.emplaceBack(sn+2,sn+3,Yn),this.indexArray.emplaceBack(sn+3,Yn+1,Yn),this.indexArray.emplaceBack(sn+3,an,Yn+1),Ee.primitiveLength+=3}it=!it}if(A){const _n=this.layoutVertexExtArray,an=T.projectTilePoint(_t.x,_t.y,h),Yn=T.projectTilePoint(Xe.x,Xe.y,h),hn=T.upVector(h,_t.x,_t.y),In=T.upVector(h,Xe.x,Xe.y);bd(_n,an,hn),bd(_n,an,hn),bd(_n,Yn,In),bd(_n,Yn,In)}}D&&(ie+=xe.length-1)}}if(P&&P.polyCount.length>0){if(P.borders){P.vertexArrayOffset=this.centroidVertexArray.length;const le=P.borders,ye=this.featuresOnBorder.push(P)-1;for(let ie=0;ie<4;ie++)le[ie][0]!==Number.MAX_VALUE&&this.borders[ie].push(ye)}this.encodeCentroid(P.borders?void 0:P.centroid(),P)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,p,v,h)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort((i,l)=>this.featuresOnBorder[i].borders[t][0]-this.featuresOnBorder[l].borders[t][0])}encodeCentroid(t,i,l=!0){let h,p;if(t)if(t.y!==0){const y=i.span()._mult(this.tileToMeter);h=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(y.x/10)),p=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(y.y/10))}else h=Math.ceil(7*(t.x+450)),p=0;else h=0,p=+l;let v=l?this.centroidVertexArray.length:i.vertexArrayOffset;for(const y of i.polyCount){l&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*y.edges+y.top);for(let S=0;S<y.top;S++)this.centroidVertexArray.emplace(v++,h,p);for(let S=0;S<2*y.edges;S++)this.centroidVertexArray.emplace(v++,0,p),this.centroidVertexArray.emplace(v++,h,p)}}}function Ix(n,t){const i=n.add(t)._unit();return n.x*i.x+n.y*i.y}function NC(n,t,i,l){const h=t.sub(n)._perp()._unit(),p=i.sub(t)._perp()._unit();return Ax(n,t,i,Ix(h,p),l)}function Ax(n,t,i,l,h){const p=Math.sqrt(1-l*l);return Math.min(n.dist(t)/3,t.dist(i)/3,h*p/l)}function kx(n,t,i){return n.x<i[0].x&&t.x<i[0].x||n.x>i[1].x&&t.x>i[1].x||n.y<i[0].y&&t.y<i[0].y||n.y>i[1].y&&t.y>i[1].y}function Mx(n,t,i){if(n.x<0||n.x>=un||t.x<0||t.x>=un||i.x<0||i.x>=un)return!1;const l=i.sub(t),h=l.perp(),p=n.sub(t);return(l.x*p.x+l.y*p.y)/Math.sqrt((l.x*l.x+l.y*l.y)*(p.x*p.x+p.y*p.y))>-.866&&h.x*p.x+h.y*p.y<0}function Px(n,t,i){const l=t?2|n:-3&n;return i?1|l:-2&l}function zx(){const n=Math.PI/32,t=Math.tan(n),i=md;return i*Math.sqrt(1+2*t*t)-i}function Lx(n,t,i){const l=1<<i.z,h=so(i.x/l),p=so((i.x+1)/l),v=xr(i.y/l),y=xr((i.y+1)/l);return function(S,T,A,P,D=0,V){const $=[];if(!S.length||!A||!P)return $;const j=(xe,je)=>{for(const $e of xe)$.push({polygon:$e,bounds:je})},X=Math.ceil(Math.log2(A)),le=Math.ceil(Math.log2(P)),ye=X-le,ie=[];for(let xe=0;xe<Math.abs(ye);xe++)ie.push(ye>0?0:1);for(let xe=0;xe<Math.min(X,le);xe++)ie.push(0),ie.push(1);let ge=S;if(ge=im(ge,T[0].y-D,T[1].y+D,1),ge=im(ge,T[0].x-D,T[1].x+D,0),!ge.length)return $;const Ee=[];for(ie.length?Ee.push({polygons:ge,bounds:T,depth:0}):j(ge,T);Ee.length;){const xe=Ee.pop(),je=xe.depth,$e=ie[je],tt=xe.bounds[0],vt=xe.bounds[1],We=$e===0?tt.x:tt.y,it=$e===0?vt.x:vt.y,ot=V?V($e,We,it):.5*(We+it),dt=im(xe.polygons,We-D,ot+D,$e),_t=im(xe.polygons,ot-D,it+D,$e);if(dt.length){const Xe=[tt,new Y($e===0?ot:vt.x,$e===1?ot:vt.y)];ie.length>je+1?Ee.push({polygons:dt,bounds:Xe,depth:je+1}):j(dt,Xe)}if(_t.length){const Xe=[new Y($e===0?ot:tt.x,$e===1?ot:tt.y),vt];ie.length>je+1?Ee.push({polygons:_t,bounds:Xe,depth:je+1}):j(_t,Xe)}}return $}(n,t,Math.ceil((p-h)/11.25),Math.ceil((v-y)/11.25),1,(S,T,A)=>{if(S===0)return .5*(T+A);{const P=xr((i.y+T/un)/l);return(xs(.5*(xr((i.y+A/un)/l)+P))*l-i.y)*un}})}$t(wd,"FillExtrusionBucket",{omit:["layers","features"]}),$t(Cx,"PartMetadata");const UC=new mt({"fill-extrusion-edge-radius":new Le(et["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var jC={paint:new mt({"fill-extrusion-opacity":new Le(et["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ze(et["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Le(et["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Le(et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ze(et["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ze(et["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ze(et["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Le(et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Le(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Le(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:UC};function Dx(n,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[n*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class rm{constructor(t,i,l){this.z=t,this.x=i,this.y=l,this.key=Sd(0,t,t,i,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,i){const l=function(p,v,y){var S=Dx(256*p,256*(v=Math.pow(2,y)-v-1),y),T=Dx(256*(p+1),256*(v+1),y);return S[0]+","+S[1]+","+T[0]+","+T[1]}(this.x,this.y,this.z),h=function(p,v,y){let S,T="";for(let A=p;A>0;A--)S=1<<A-1,T+=(v&S?1:0)+(y&S?2:0);return T}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",l)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Rx{constructor(t,i){this.wrap=t,this.canonical=i,this.key=Sd(t,i.z,i.z,i.x,i.y)}}class Or{constructor(t,i,l,h,p){this.overscaledZ=t,this.wrap=i,this.canonical=new rm(l,+h,+p),this.key=i===0&&t===l?this.canonical.key:Sd(i,t,l,h,p)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const i=this.canonical.z-t;return t>this.canonical.z?new Or(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Or(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(t,i=!0){if(this.overscaledZ===t&&i)return this.key;if(t>this.canonical.z)return Sd(this.wrap*+i,t,this.canonical.z,this.canonical.x,this.canonical.y);{const l=this.canonical.z-t;return Sd(this.wrap*+i,t,t,this.canonical.x>>l,this.canonical.y>>l)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const i=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>i&&t.canonical.y===this.canonical.y>>i}children(t){if(this.overscaledZ>=t)return[new Or(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,l=2*this.canonical.x,h=2*this.canonical.y;return[new Or(i,this.wrap,i,l,h),new Or(i,this.wrap,i,l+1,h),new Or(i,this.wrap,i,l,h+1),new Or(i,this.wrap,i,l+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Or(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Or(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Rx(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Sd(n,t,i,l,h){const p=1<<Math.min(i,22);let v=p*(h%p)+l%p;return n&&i<22&&(v+=p*p*((n<0?-2*n-1:2*n)%(1<<2*(22-i)))),16*(32*v+i)+(t-i)}$t(rm,"CanonicalTileID"),$t(Or,"OverscaledTileID",{omit:["projMatrix"]});class Mu extends Y{constructor(t,i,l){super(t,i),this.z=l}}function Td(n,t){return n.x*t.x+n.y*t.y}function Bx(n,t){if(n.length===1){let i=0;const l=t[i++];let h;for(;!h||l.equals(h);)if(h=t[i++],!h)return 1/0;for(;i<t.length;i++){const p=t[i],v=n[0],y=h.sub(l),S=p.sub(l),T=v.sub(l),A=Td(y,y),P=Td(y,S),D=Td(S,S),V=Td(T,y),$=Td(T,S),j=A*D-P*P,X=(D*V-P*$)/j,le=(A*$-P*V)/j,ye=l.z*(1-X-le)+h.z*X+p.z*le;if(isFinite(ye))return ye}return 1/0}{let i=1/0;for(const l of t)i=Math.min(i,l.z);return i}}function Ox(n,t,i,l,h,p,v,y){const S=v*h.getElevationAt(n,t,!0,!0),T=p[0]!==0,A=T?p[1]===0?v*(p[0]/7-450):v*function(P,D,V){const $=Math.floor(D[0]/8),j=Math.floor(D[1]/8),X=10*(D[0]-8*$),le=10*(D[1]-8*j),ye=P.getElevationAt($,j,!0,!0),ie=P.getMeterToDEM(V),ge=Math.floor(.5*(X*ie-1)),Ee=Math.floor(.5*(le*ie-1)),xe=P.tileCoordToPixel($,j),je=2*ge+1,$e=2*Ee+1,tt=function(_t,Xe,Ct,nn,Dt){return[_t.getElevationAtPixel(Xe,Ct,!0),_t.getElevationAtPixel(Xe+Dt,Ct,!0),_t.getElevationAtPixel(Xe,Ct+Dt,!0),_t.getElevationAtPixel(Xe+nn,Ct+Dt,!0)]}(P,xe.x-ge,xe.y-Ee,je,$e),vt=Math.abs(tt[0]-tt[1]),We=Math.abs(tt[2]-tt[3]),it=Math.abs(tt[0]-tt[2])+Math.abs(tt[1]-tt[3]),ot=Math.min(.25,.5*ie*(vt+We)/je),dt=Math.min(.25,.5*ie*it/$e);return ye+Math.max(ot*X,dt*le)}(h,p,y):S;return{base:S+(i===0)?-1:i,top:T?Math.max(A+l,S+i+2):S+l}}const GC=Ht([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:qC}=GC,ZC=Ht([{name:"a_packed",components:4,type:"Float32"}]),{members:WC}=ZC,HC=nm.types,XC=Math.cos(Math.PI/180*37.5);class om{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new ai,this.layoutVertexArray2=new ii,this.indexArray=new yr,this.programConfigurations=new Wl(t.layers,t.zoom),this.segments=new Fi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,l,h){this.hasPattern=Tv("line",this.layers,i);const p=this.layers[0].layout.get("line-sort-key"),v=[];for(const{feature:A,id:P,index:D,sourceLayerIndex:V}of t){const $=this.layers[0]._featureFilter.needGeometry,j=Ql(A,$);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),j,l))continue;const X=p?p.evaluate(j,{},l):void 0,le={id:P,properties:A.properties,type:A.type,sourceLayerIndex:V,index:D,geometry:$?j.geometry:ea(A,l,h),patterns:{},sortKey:X};v.push(le)}p&&v.sort((A,P)=>A.sortKey-P.sortKey);const{lineAtlas:y,featureIndex:S}=i,T=this.addConstantDashes(y);for(const A of v){const{geometry:P,index:D,sourceLayerIndex:V}=A;if(T&&this.addFeatureDashes(A,y),this.hasPattern){const $=Ev("line",this.layers,A,this.zoom,i);this.patternFeatures.push($)}else this.addFeature(A,P,D,l,y.positions,i.availableImages);S.insert(t[D].feature,P,D,V,this.index)}}addConstantDashes(t){let i=!1;for(const l of this.layers){const h=l.paint.get("line-dasharray").value,p=l.layout.get("line-cap").value;if(h.kind!=="constant"||p.kind!=="constant")i=!0;else{const v=p.value,y=h.value;if(!y)continue;t.addDash(y,v)}}return i}addFeatureDashes(t,i){const l=this.zoom;for(const h of this.layers){const p=h.paint.get("line-dasharray").value,v=h.layout.get("line-cap").value;if(p.kind==="constant"&&v.kind==="constant")continue;let y,S;if(p.kind==="constant"){if(y=p.value,!y)continue}else y=p.evaluate({zoom:l},t);S=v.kind==="constant"?v.value:v.evaluate({zoom:l},t),i.addDash(y,S),t.patterns[h.id]=i.getKey(y,S)}}update(t,i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,l,h)}addFeatures(t,i,l,h,p){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,i,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,WC)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qC),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,i,l,h,p,v){const y=this.layers[0].layout,S=y.get("line-join").evaluate(t,{}),T=y.get("line-cap").evaluate(t,{}),A=y.get("line-miter-limit"),P=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const D of i)this.addLine(D,t,S,T,A,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,p,v,h)}addLine(t,i,l,h,p,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let le=0;le<t.length-1;le++)this.totalDistance+=t[le].dist(t[le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const y=HC[i.type]==="Polygon";let S=t.length;for(;S>=2&&t[S-1].equals(t[S-2]);)S--;let T=0;for(;T<S-1&&t[T].equals(t[T+1]);)T++;if(S<(y?3:2))return;l==="bevel"&&(p=1.05);const A=this.overscaling<=16?122880/(512*this.overscaling):0,P=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let D,V,$,j,X;this.e1=this.e2=-1,y&&(D=t[S-2],X=t[T].sub(D)._unit()._perp());for(let le=T;le<S;le++){if($=le===S-1?y?t[T+1]:void 0:t[le+1],$&&t[le].equals($))continue;X&&(j=X),D&&(V=D),D=t[le],X=$?$.sub(D)._unit()._perp():j,j=j||X;let ye=j.add(X);ye.x===0&&ye.y===0||ye._unit();const ie=j.x*X.x+j.y*X.y,ge=ye.x*X.x+ye.y*X.y,Ee=ge!==0?1/ge:1/0,xe=2*Math.sqrt(2-2*ge),je=ge<XC&&V&&$,$e=j.x*X.y-j.y*X.x>0;if(je&&le>T){const We=D.dist(V);if(We>2*A){const it=D.sub(D.sub(V)._mult(A/We)._round());this.updateDistance(V,it),this.addCurrentVertex(it,j,0,0,P),V=it}}const tt=V&&$;let vt=tt?l:y?"butt":h;if(tt&&vt==="round"&&(Ee<v?vt="miter":Ee<=2&&(vt="fakeround")),vt==="miter"&&Ee>p&&(vt="bevel"),vt==="bevel"&&(Ee>2&&(vt="flipbevel"),Ee<p&&(vt="miter")),V&&this.updateDistance(V,D),vt==="miter")ye._mult(Ee),this.addCurrentVertex(D,ye,0,0,P);else if(vt==="flipbevel"){if(Ee>100)ye=X.mult(-1);else{const We=Ee*j.add(X).mag()/j.sub(X).mag();ye._perp()._mult(We*($e?-1:1))}this.addCurrentVertex(D,ye,0,0,P),this.addCurrentVertex(D,ye.mult(-1),0,0,P)}else if(vt==="bevel"||vt==="fakeround"){const We=-Math.sqrt(Ee*Ee-1),it=$e?We:0,ot=$e?0:We;if(V&&this.addCurrentVertex(D,j,it,ot,P),vt==="fakeround"){const dt=Math.round(180*xe/Math.PI/20);for(let _t=1;_t<dt;_t++){let Xe=_t/dt;if(Xe!==.5){const nn=Xe-.5;Xe+=Xe*nn*(Xe-1)*((1.0904+ie*(ie*(3.55645-1.43519*ie)-3.2452))*nn*nn+(.848013+ie*(.215638*ie-1.06021)))}const Ct=X.sub(j)._mult(Xe)._add(j)._unit()._mult($e?-1:1);this.addHalfVertex(D,Ct.x,Ct.y,!1,$e,0,P)}}$&&this.addCurrentVertex(D,X,-it,-ot,P)}else if(vt==="butt")this.addCurrentVertex(D,ye,0,0,P);else if(vt==="square"){const We=V?1:-1;V||this.addCurrentVertex(D,ye,We,We,P),this.addCurrentVertex(D,ye,0,0,P),V&&this.addCurrentVertex(D,ye,We,We,P)}else vt==="round"&&(V&&(this.addCurrentVertex(D,j,0,0,P),this.addCurrentVertex(D,j,1,1,P,!0)),$&&(this.addCurrentVertex(D,X,-1,-1,P,!0),this.addCurrentVertex(D,X,0,0,P)));if(je&&le<S-1){const We=D.dist($);if(We>2*A){const it=D.add($.sub(D)._mult(A/We)._round());this.updateDistance(D,it),this.addCurrentVertex(it,X,0,0,P),D=it}}}}addCurrentVertex(t,i,l,h,p,v=!1){const y=i.y*h-i.x,S=-i.y-i.x*h;this.addHalfVertex(t,i.x+i.y*l,i.y-i.x*l,v,!1,l,p),this.addHalfVertex(t,y,S,v,!0,-h,p)}addHalfVertex({x:t,y:i},l,h,p,v,y,S){this.layoutVertexArray.emplaceBack((t<<1)+(p?1:0),(i<<1)+(v?1:0),Math.round(63*l)+128,Math.round(63*h)+128,1+(y===0?0:y<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const T=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),S.primitiveLength++),v?this.e2=T:this.e1=T}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,i){this.distance+=t.dist(i),this.updateScaledDistance()}}$t(om,"LineBucket",{omit:["layers","patternFeatures"]});const YC=new mt({"line-cap":new Ze(et.layout_line["line-cap"]),"line-join":new Ze(et.layout_line["line-join"]),"line-miter-limit":new Le(et.layout_line["line-miter-limit"]),"line-round-limit":new Le(et.layout_line["line-round-limit"]),"line-sort-key":new Ze(et.layout_line["line-sort-key"])});var Fx={paint:new mt({"line-opacity":new Ze(et.paint_line["line-opacity"]),"line-color":new Ze(et.paint_line["line-color"]),"line-translate":new Le(et.paint_line["line-translate"]),"line-translate-anchor":new Le(et.paint_line["line-translate-anchor"]),"line-width":new Ze(et.paint_line["line-width"]),"line-gap-width":new Ze(et.paint_line["line-gap-width"]),"line-offset":new Ze(et.paint_line["line-offset"]),"line-blur":new Ze(et.paint_line["line-blur"]),"line-dasharray":new Ze(et.paint_line["line-dasharray"]),"line-pattern":new Ze(et.paint_line["line-pattern"]),"line-gradient":new lt(et.paint_line["line-gradient"]),"line-trim-offset":new Le(et.paint_line["line-trim-offset"])}),layout:YC};const Vx=new class extends Ze{possiblyEvaluate(n,t){return t=new Be(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(n,t)}evaluate(n,t,i,l){return t=pt({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(n,t,i,l)}}(Fx.paint.properties["line-width"].specification);function $x(n,t){return t>0?t+2*n:n}Vx.useIntegerZoom=!0;const KC=Ht([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),JC=Ht([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),QC=Ht([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ht([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const eI=Ht([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),tI=Ht([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ht([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Nx=Ht([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),nI=Ht([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ht([{name:"triangle",components:3,type:"Uint16"}]),Ht([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ht([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ht([{type:"Float32",name:"offsetX"}]),Ht([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var wr=24;const bs=128;function Iv(n,t){const{expression:i}=t;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new Be(n+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:h}=i;let p=0;for(;p<l.length&&l[p]<=n;)p++;p=Math.max(0,p-1);let v=p;for(;v<l.length&&l[v]<n+1;)v++;v=Math.min(l.length-1,v);const y=l[p],S=l[v];return i.kind==="composite"?{kind:"composite",minZoom:y,maxZoom:S,interpolationType:h}:{kind:"camera",minZoom:y,maxZoom:S,minSize:i.evaluate(new Be(y)),maxSize:i.evaluate(new Be(S)),interpolationType:h}}}function sm(n,{uSize:t,uSizeT:i},{lowerSize:l,upperSize:h}){return n.kind==="source"?l/bs:n.kind==="composite"?Fn(l/bs,h/bs,i):t}function Pu(n,t){let i=0,l=0;if(n.kind==="constant")l=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:h,minZoom:p,maxZoom:v}=n,y=h?nt(vo.interpolationFactor(h,t,p,v),0,1):0;n.kind==="camera"?l=Fn(n.minSize,n.maxSize,y):i=y}return{uSizeT:i,uSize:l}}var iI=Object.freeze({__proto__:null,getSizeData:Iv,evaluateSizeForFeature:sm,evaluateSizeForZoom:Pu,SIZE_PACK_FACTOR:bs});function rI(n,t,i){return n.sections.forEach(l=>{l.text=function(h,p,v){const y=p.layout.get("text-transform").evaluate(v,{});return y==="uppercase"?h=h.toLocaleUpperCase():y==="lowercase"&&(h=h.toLocaleLowerCase()),Ae.applyArabicShaping&&(h=Ae.applyArabicShaping(h)),h}(l.text,t,i)}),n}const Ed={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function oI(n){return n==="\uFE36"||n==="\uFE48"||n==="\uFE38"||n==="\uFE44"||n==="\uFE42"||n==="\uFE3E"||n==="\uFE3C"||n==="\uFE3A"||n==="\uFE18"||n==="\uFE40"||n==="\uFE10"||n==="\uFE13"||n==="\uFE14"||n==="\uFF40"||n==="\uFFE3"||n==="\uFE11"||n==="\uFE12"}function sI(n){return n==="\uFE35"||n==="\uFE47"||n==="\uFE37"||n==="\uFE43"||n==="\uFE41"||n==="\uFE3D"||n==="\uFE3B"||n==="\uFE39"||n==="\uFE17"||n==="\uFE3F"}var Cd=li,Ux=function(n,t,i,l,h){var p,v,y=8*h-l-1,S=(1<<y)-1,T=S>>1,A=-7,P=i?h-1:0,D=i?-1:1,V=n[t+P];for(P+=D,p=V&(1<<-A)-1,V>>=-A,A+=y;A>0;p=256*p+n[t+P],P+=D,A-=8);for(v=p&(1<<-A)-1,p>>=-A,A+=l;A>0;v=256*v+n[t+P],P+=D,A-=8);if(p===0)p=1-T;else{if(p===S)return v?NaN:1/0*(V?-1:1);v+=Math.pow(2,l),p-=T}return(V?-1:1)*v*Math.pow(2,p-l)},jx=function(n,t,i,l,h,p){var v,y,S,T=8*p-h-1,A=(1<<T)-1,P=A>>1,D=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,V=l?0:p-1,$=l?1:-1,j=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(y=isNaN(t)?1:0,v=A):(v=Math.floor(Math.log(t)/Math.LN2),t*(S=Math.pow(2,-v))<1&&(v--,S*=2),(t+=v+P>=1?D/S:D*Math.pow(2,1-P))*S>=2&&(v++,S/=2),v+P>=A?(y=0,v=A):v+P>=1?(y=(t*S-1)*Math.pow(2,h),v+=P):(y=t*Math.pow(2,P-1)*Math.pow(2,h),v=0));h>=8;n[i+V]=255&y,V+=$,y/=256,h-=8);for(v=v<<h|y,T+=h;T>0;n[i+V]=255&v,V+=$,v/=256,T-=8);n[i+V-$]|=128*j};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function li(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}li.Varint=0,li.Fixed64=1,li.Bytes=2,li.Fixed32=5;var Av=4294967296,Gx=1/Av,qx=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function na(n){return n.type===li.Bytes?n.readVarint()+n.pos:n.pos+1}function zu(n,t,i){return i?4294967296*t+(n>>>0):4294967296*(t>>>0)+(n>>>0)}function Zx(n,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var h=i.pos-1;h>=n;h--)i.buf[h+l]=i.buf[h]}function aI(n,t){for(var i=0;i<n.length;i++)t.writeVarint(n[i])}function lI(n,t){for(var i=0;i<n.length;i++)t.writeSVarint(n[i])}function cI(n,t){for(var i=0;i<n.length;i++)t.writeFloat(n[i])}function uI(n,t){for(var i=0;i<n.length;i++)t.writeDouble(n[i])}function hI(n,t){for(var i=0;i<n.length;i++)t.writeBoolean(n[i])}function dI(n,t){for(var i=0;i<n.length;i++)t.writeFixed32(n[i])}function fI(n,t){for(var i=0;i<n.length;i++)t.writeSFixed32(n[i])}function pI(n,t){for(var i=0;i<n.length;i++)t.writeFixed64(n[i])}function mI(n,t){for(var i=0;i<n.length;i++)t.writeSFixed64(n[i])}function am(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16)+16777216*n[t+3]}function Lu(n,t,i){n[i]=t,n[i+1]=t>>>8,n[i+2]=t>>>16,n[i+3]=t>>>24}function Wx(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16)+(n[t+3]<<24)}function gI(n,t,i){t.glyphs=[],n===1&&i.readMessage(vI,t)}function vI(n,t,i){if(n===3){const{id:l,bitmap:h,width:p,height:v,left:y,top:S,advance:T}=i.readMessage(_I,{});t.glyphs.push({id:l,bitmap:new ta({width:p+6,height:v+6},h),metrics:{width:p,height:v,left:y,top:S,advance:T}})}else n===4?t.ascender=i.readSVarint():n===5&&(t.descender=i.readSVarint())}function _I(n,t,i){n===1?t.id=i.readVarint():n===2?t.bitmap=i.readBytes():n===3?t.width=i.readVarint():n===4?t.height=i.readVarint():n===5?t.left=i.readSVarint():n===6?t.top=i.readSVarint():n===7&&(t.advance=i.readVarint())}function kv(n){let t=0,i=0;for(const v of n)t+=v.w*v.h,i=Math.max(i,v.w);n.sort((v,y)=>y.h-v.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let h=0,p=0;for(const v of n)for(let y=l.length-1;y>=0;y--){const S=l[y];if(!(v.w>S.w||v.h>S.h)){if(v.x=S.x,v.y=S.y,p=Math.max(p,v.y+v.h),h=Math.max(h,v.x+v.w),v.w===S.w&&v.h===S.h){const T=l.pop();y<l.length&&(l[y]=T)}else v.h===S.h?(S.x+=v.w,S.w-=v.w):v.w===S.w?(S.y+=v.h,S.h-=v.h):(l.push({x:S.x+v.w,y:S.y,w:S.w-v.w,h:v.h}),S.y+=v.h,S.h-=v.h);break}}return{w:h,h:p,fill:t/(h*p)||0}}li.prototype={destroy:function(){this.buf=null},readFields:function(n,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),h=l>>3,p=this.pos;this.type=7&l,n(h,t,this),this.pos===p&&this.skip(l)}return t},readMessage:function(n,t){return this.readFields(n,t,this.readVarint()+this.pos)},readFixed32:function(){var n=am(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=Wx(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=am(this.buf,this.pos)+am(this.buf,this.pos+4)*Av;return this.pos+=8,n},readSFixed64:function(){var n=am(this.buf,this.pos)+Wx(this.buf,this.pos+4)*Av;return this.pos+=8,n},readFloat:function(){var n=Ux(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=Ux(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(h,p,v){var y,S,T=v.buf;if(y=(112&(S=T[v.pos++]))>>4,S<128||(y|=(127&(S=T[v.pos++]))<<3,S<128)||(y|=(127&(S=T[v.pos++]))<<10,S<128)||(y|=(127&(S=T[v.pos++]))<<17,S<128)||(y|=(127&(S=T[v.pos++]))<<24,S<128)||(y|=(1&(S=T[v.pos++]))<<31,S<128))return zu(h,y,p);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var n=this.readVarint()+this.pos,t=this.pos;return this.pos=n,n-t>=12&&qx?function(i,l,h){return qx.decode(i.subarray(l,h))}(this.buf,t,n):function(i,l,h){for(var p="",v=l;v<h;){var y,S,T,A=i[v],P=null,D=A>239?4:A>223?3:A>191?2:1;if(v+D>h)break;D===1?A<128&&(P=A):D===2?(192&(y=i[v+1]))==128&&(P=(31&A)<<6|63&y)<=127&&(P=null):D===3?(S=i[v+2],(192&(y=i[v+1]))==128&&(192&S)==128&&((P=(15&A)<<12|(63&y)<<6|63&S)<=2047||P>=55296&&P<=57343)&&(P=null)):D===4&&(S=i[v+2],T=i[v+3],(192&(y=i[v+1]))==128&&(192&S)==128&&(192&T)==128&&((P=(15&A)<<18|(63&y)<<12|(63&S)<<6|63&T)<=65535||P>=1114112)&&(P=null)),P===null?(P=65533,D=1):P>65535&&(P-=65536,p+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),p+=String.fromCharCode(P),v+=D}return p}(this.buf,t,n)},readBytes:function(){var n=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,n);return this.pos=n,t},readPackedVarint:function(n,t){if(this.type!==li.Bytes)return n.push(this.readVarint(t));var i=na(this);for(n=n||[];this.pos<i;)n.push(this.readVarint(t));return n},readPackedSVarint:function(n){if(this.type!==li.Bytes)return n.push(this.readSVarint());var t=na(this);for(n=n||[];this.pos<t;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==li.Bytes)return n.push(this.readBoolean());var t=na(this);for(n=n||[];this.pos<t;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==li.Bytes)return n.push(this.readFloat());var t=na(this);for(n=n||[];this.pos<t;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==li.Bytes)return n.push(this.readDouble());var t=na(this);for(n=n||[];this.pos<t;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==li.Bytes)return n.push(this.readFixed32());var t=na(this);for(n=n||[];this.pos<t;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==li.Bytes)return n.push(this.readSFixed32());var t=na(this);for(n=n||[];this.pos<t;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==li.Bytes)return n.push(this.readFixed64());var t=na(this);for(n=n||[];this.pos<t;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==li.Bytes)return n.push(this.readSFixed64());var t=na(this);for(n=n||[];this.pos<t;)n.push(this.readSFixed64());return n},skip:function(n){var t=7&n;if(t===li.Varint)for(;this.buf[this.pos++]>127;);else if(t===li.Bytes)this.pos=this.readVarint()+this.pos;else if(t===li.Fixed32)this.pos+=4;else{if(t!==li.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(n,t){this.writeVarint(n<<3|t)},realloc:function(n){for(var t=this.length||16;t<this.pos+n;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),Lu(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),Lu(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),Lu(this.buf,-1&n,this.pos),Lu(this.buf,Math.floor(n*Gx),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),Lu(this.buf,-1&n,this.pos),Lu(this.buf,Math.floor(n*Gx),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(t,i){var l,h;if(t>=0?(l=t%4294967296|0,h=t/4294967296|0):(h=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,h=h+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(p,v,y){y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,y.buf[y.pos]=127&(p>>>=7)}(l,0,i),function(p,v){var y=(7&p)<<4;v.buf[v.pos++]|=y|((p>>>=3)?128:0),p&&(v.buf[v.pos++]=127&p|((p>>>=7)?128:0),p&&(v.buf[v.pos++]=127&p|((p>>>=7)?128:0),p&&(v.buf[v.pos++]=127&p|((p>>>=7)?128:0),p&&(v.buf[v.pos++]=127&p|((p>>>=7)?128:0),p&&(v.buf[v.pos++]=127&p)))))}(h,i)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(Boolean(n))},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var t=this.pos;this.pos=function(l,h,p){for(var v,y,S=0;S<h.length;S++){if((v=h.charCodeAt(S))>55295&&v<57344){if(!y){v>56319||S+1===h.length?(l[p++]=239,l[p++]=191,l[p++]=189):y=v;continue}if(v<56320){l[p++]=239,l[p++]=191,l[p++]=189,y=v;continue}v=y-55296<<10|v-56320|65536,y=null}else y&&(l[p++]=239,l[p++]=191,l[p++]=189,y=null);v<128?l[p++]=v:(v<2048?l[p++]=v>>6|192:(v<65536?l[p++]=v>>12|224:(l[p++]=v>>18|240,l[p++]=v>>12&63|128),l[p++]=v>>6&63|128),l[p++]=63&v|128)}return p}(this.buf,n,this.pos);var i=this.pos-t;i>=128&&Zx(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(n){this.realloc(4),jx(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),jx(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var t=n.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=n[i]},writeRawMessage:function(n,t){this.pos++;var i=this.pos;n(t,this);var l=this.pos-i;l>=128&&Zx(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(n,t,i){this.writeTag(n,li.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(n,t){t.length&&this.writeMessage(n,aI,t)},writePackedSVarint:function(n,t){t.length&&this.writeMessage(n,lI,t)},writePackedBoolean:function(n,t){t.length&&this.writeMessage(n,hI,t)},writePackedFloat:function(n,t){t.length&&this.writeMessage(n,cI,t)},writePackedDouble:function(n,t){t.length&&this.writeMessage(n,uI,t)},writePackedFixed32:function(n,t){t.length&&this.writeMessage(n,dI,t)},writePackedSFixed32:function(n,t){t.length&&this.writeMessage(n,fI,t)},writePackedFixed64:function(n,t){t.length&&this.writeMessage(n,pI,t)},writePackedSFixed64:function(n,t){t.length&&this.writeMessage(n,mI,t)},writeBytesField:function(n,t){this.writeTag(n,li.Bytes),this.writeBytes(t)},writeFixed32Field:function(n,t){this.writeTag(n,li.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(n,t){this.writeTag(n,li.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(n,t){this.writeTag(n,li.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(n,t){this.writeTag(n,li.Fixed64),this.writeSFixed64(t)},writeVarintField:function(n,t){this.writeTag(n,li.Varint),this.writeVarint(t)},writeSVarintField:function(n,t){this.writeTag(n,li.Varint),this.writeSVarint(t)},writeStringField:function(n,t){this.writeTag(n,li.Bytes),this.writeString(t)},writeFloatField:function(n,t){this.writeTag(n,li.Fixed32),this.writeFloat(t)},writeDoubleField:function(n,t){this.writeTag(n,li.Fixed64),this.writeDouble(t)},writeBooleanField:function(n,t){this.writeVarintField(n,Boolean(t))}};class Mv{constructor(t,{pixelRatio:i,version:l,stretchX:h,stretchY:p,content:v}){this.paddedRect=t,this.pixelRatio=i,this.stretchX=h,this.stretchY=p,this.content=v,this.version=l}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Hx{constructor(t,i){const l={},h={};this.haveRenderCallbacks=[];const p=[];this.addImages(t,l,p),this.addImages(i,h,p);const{w:v,h:y}=kv(p),S=new Kr({width:v||1,height:y||1});for(const T in t){const A=t[T],P=l[T].paddedRect;Kr.copy(A.data,S,{x:0,y:0},{x:P.x+1,y:P.y+1},A.data)}for(const T in i){const A=i[T],P=h[T].paddedRect,D=P.x+1,V=P.y+1,$=A.data.width,j=A.data.height;Kr.copy(A.data,S,{x:0,y:0},{x:D,y:V},A.data),Kr.copy(A.data,S,{x:0,y:j-1},{x:D,y:V-1},{width:$,height:1}),Kr.copy(A.data,S,{x:0,y:0},{x:D,y:V+j},{width:$,height:1}),Kr.copy(A.data,S,{x:$-1,y:0},{x:D-1,y:V},{width:1,height:j}),Kr.copy(A.data,S,{x:0,y:0},{x:D+$,y:V},{width:1,height:j})}this.image=S,this.iconPositions=l,this.patternPositions=h}addImages(t,i,l){for(const h in t){const p=t[h],v={x:0,y:0,w:p.data.width+2,h:p.data.height+2};l.push(v),i[h]=new Mv(v,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(l=>t.hasImage(l)),t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),i),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),i)}patchUpdatedImage(t,i,l){if(!t||!i||t.version===i.version)return;t.version=i.version;const[h,p]=t.tl;l.update(i.data,void 0,{x:h,y:p})}}$t(Mv,"ImagePosition"),$t(Hx,"ImageAtlas");const ao={horizontal:1,vertical:2,horizontalOnly:3};class Id{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,i){const l=new Id;return l.scale=t||1,l.fontStack=i,l}static forImage(t){const i=new Id;return i.imageName=t,i}}class Du{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,i){const l=new Du;for(let h=0;h<t.sections.length;h++){const p=t.sections[h];p.image?l.addImageSection(p):l.addTextSection(p,i)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(t){this.text=function(i,l){let h="";for(let p=0;p<i.length;p++){const v=i.charCodeAt(p+1)||null,y=i.charCodeAt(p-1)||null;h+=!l&&(v&&M(v)&&!Ed[i[p+1]]||y&&M(y)&&!Ed[i[p-1]])||!Ed[i[p]]?i[p]:Ed[i[p]]}return h}(this.text,t)}trim(){let t=0;for(let l=0;l<this.text.length&&lm[this.text.charCodeAt(l)];l++)t++;let i=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&lm[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)}substring(t,i){const l=new Du;return l.text=this.text.substring(t,i),l.sectionIndex=this.sectionIndex.slice(t,i),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,i)=>Math.max(t,this.sections[i].scale),0)}addTextSection(t,i){this.text+=t.text,this.sections.push(Id.forText(t.scale,t.fontStack||i));const l=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(l)}addImageSection(t){const i=t.image?t.image.name:"";if(i.length===0)return void ue("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Id.forImage(i)),this.sectionIndex.push(this.sections.length-1)):ue("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Pv(n,t,i,l,h,p,v,y,S,T,A,P,D,V,$){const j=Du.fromFeature(n,h);P===ao.vertical&&j.verticalizePunctuation(D);let X=[];const le=function(xe,je,$e,tt,vt,We){if(!xe)return[];const it=[],ot=function(Ct,nn,Dt,qt,It,sn){let Cn=0;for(let xn=0;xn<Ct.length();xn++){const _n=Ct.getSection(xn);Cn+=Xx(Ct.getCharCode(xn),_n,qt,It,nn,sn)}return Cn/Math.max(1,Math.ceil(Cn/Dt))}(xe,je,$e,tt,vt,We),dt=xe.text.indexOf("\u200B")>=0;let _t=0;for(let Ct=0;Ct<xe.length();Ct++){const nn=xe.getSection(Ct),Dt=xe.getCharCode(Ct);if(lm[Dt]||(_t+=Xx(Dt,nn,tt,vt,je,We)),Ct<xe.length()-1){const qt=!((Xe=Dt)<11904||!(kp(Xe)||_u(Xe)||f(Xe)||Op(Xe)||zp(Xe)||Ap(Xe)||Mp(Xe)||Gl(Xe)||Lp(Xe)||id(Xe)||Pp(Xe)||m(Xe)||vu(Xe)||td(Xe)||ed(Xe)||nd(Xe)||Va(Xe)||ql(Xe)||Rp(Xe)||Dp(Xe)));(yI[Dt]||qt||nn.imageName)&&it.push(Kx(Ct+1,_t,ot,it,xI(Dt,xe.getCharCode(Ct+1),qt&&dt),!1))}}var Xe;return Jx(Kx(xe.length(),_t,ot,it,0,!0))}(j,T,p,t,l,V),{processBidirectionalText:ye,processStyledBidirectionalText:ie}=Ae;if(ye&&j.sections.length===1){const xe=ye(j.toString(),le);for(const je of xe){const $e=new Du;$e.text=je,$e.sections=j.sections;for(let tt=0;tt<je.length;tt++)$e.sectionIndex.push(0);X.push($e)}}else if(ie){const xe=ie(j.text,j.sectionIndex,le);for(const je of xe){const $e=new Du;$e.text=je[0],$e.sectionIndex=je[1],$e.sections=j.sections,X.push($e)}}else X=function(xe,je){const $e=[],tt=xe.text;let vt=0;for(const We of je)$e.push(xe.substring(vt,We)),vt=We;return vt<tt.length&&$e.push(xe.substring(vt,tt.length)),$e}(j,le);const ge=[],Ee={positionedLines:ge,text:j.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(xe,je,$e,tt,vt,We,it,ot,dt,_t,Xe,Ct){let nn=0,Dt=0,qt=0;const It=ot==="right"?1:ot==="left"?0:.5;let sn=!1;for(const hn of vt){const In=hn.getSections();for(const ti of In){if(ti.imageName)continue;const hi=je[ti.fontStack];if(hi&&(sn=hi.ascender!==void 0&&hi.descender!==void 0,!sn))break}if(!sn)break}let Cn=0;for(const hn of vt){hn.trim();const In=hn.getMaxScale(),ti=(In-1)*wr,hi={positionedGlyphs:[],lineOffset:0};xe.positionedLines[Cn]=hi;const ci=hi.positionedGlyphs;let di=0;if(!hn.length()){Dt+=We,++Cn;continue}let mi=0,Ii=0;for(let Kn=0;Kn<hn.length();Kn++){const Zi=hn.getSection(Kn),$i=hn.getSectionIndex(Kn),Nn=hn.getCharCode(Kn);let _i=Zi.scale,Ji=null,ni=null,Ri=null,Ir=wr,cr=0;const ur=!(dt===ao.horizontal||!Xe&&!I(Nn)||Xe&&(lm[Nn]||(xn=Nn,jl(xn)||Ip(xn)||Qh(xn)||yu(xn)||c(xn))));if(Zi.imageName){const Fr=tt[Zi.imageName];if(!Fr)continue;Ri=Zi.imageName,xe.iconsInText=xe.iconsInText||!0,ni=Fr.paddedRect;const hr=Fr.displaySize;_i=_i*wr/Ct,Ji={width:hr[0],height:hr[1],left:1,top:-3,advance:ur?hr[1]:hr[0],localGlyph:!1},cr=sn?-Ji.height*_i:In*wr-17-hr[1]*_i,Ir=Ji.advance;const ra=(ur?hr[0]:hr[1])*_i-wr*In;ra>0&&ra>di&&(di=ra)}else{const Fr=$e[Zi.fontStack];if(!Fr)continue;Fr[Nn]&&(ni=Fr[Nn]);const hr=je[Zi.fontStack];if(!hr)continue;const ra=hr.glyphs[Nn];if(!ra)continue;if(Ji=ra.metrics,Ir=Nn!==8203?wr:0,sn){const Vu=hr.ascender!==void 0?Math.abs(hr.ascender):0,Rd=hr.descender!==void 0?Math.abs(hr.descender):0,Bd=(Vu+Rd)*_i;mi<Bd&&(mi=Bd,Ii=(Vu-Rd)/2*_i),cr=-Vu*_i}else cr=(In-_i)*wr-17}ur?(xe.verticalizable=!0,ci.push({glyph:Nn,imageName:Ri,x:nn,y:Dt+cr,vertical:ur,scale:_i,localGlyph:Ji.localGlyph,fontStack:Zi.fontStack,sectionIndex:$i,metrics:Ji,rect:ni}),nn+=Ir*_i+_t):(ci.push({glyph:Nn,imageName:Ri,x:nn,y:Dt+cr,vertical:ur,scale:_i,localGlyph:Ji.localGlyph,fontStack:Zi.fontStack,sectionIndex:$i,metrics:Ji,rect:ni}),nn+=Ji.advance*_i+_t)}ci.length!==0&&(qt=Math.max(nn-_t,qt),sn?Qx(ci,It,di,Ii,We*In/2):Qx(ci,It,di,0,We/2)),nn=0;const lr=We*In+di;hi.lineOffset=Math.max(di,ti),Dt+=lr,++Cn}var xn;const _n=Dt,{horizontalAlign:an,verticalAlign:Yn}=zv(it);(function(hn,In,ti,hi,ci,di){const mi=(In-ti)*ci,Ii=-di*hi;for(const lr of hn)for(const Kn of lr.positionedGlyphs)Kn.x+=mi,Kn.y+=Ii})(xe.positionedLines,It,an,Yn,qt,_n),xe.top+=-Yn*_n,xe.bottom=xe.top+_n,xe.left+=-an*qt,xe.right=xe.left+qt,xe.hasBaseline=sn}(Ee,t,i,l,X,v,y,S,P,T,D,$),!function(xe){for(const je of xe)if(je.positionedGlyphs.length!==0)return!1;return!0}(ge)&&Ee}const lm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},yI={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Xx(n,t,i,l,h,p){if(t.imageName){const v=l[t.imageName];return v?v.displaySize[0]*t.scale*wr/p+h:0}{const v=i[t.fontStack],y=v&&v.glyphs[n];return y?y.metrics.advance*t.scale+h:0}}function Yx(n,t,i,l){const h=Math.pow(n-t,2);return l?n<t?h/2:2*h:h+Math.abs(i)*i}function xI(n,t,i){let l=0;return n===10&&(l-=1e4),i&&(l+=150),n!==40&&n!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function Kx(n,t,i,l,h,p){let v=null,y=Yx(t,i,h,p);for(const S of l){const T=Yx(t-S.x,i,h,p)+S.badness;T<=y&&(v=S,y=T)}return{index:n,x:t,priorBreak:v,badness:y}}function Jx(n){return n?Jx(n.priorBreak).concat(n.index):[]}function zv(n){let t=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Qx(n,t,i,l,h){if(!(t||i||l||h))return;const p=n.length-1,v=n[p],y=(v.x+v.metrics.advance*v.scale)*t;for(let S=0;S<=p;S++)n[S].x-=y,n[S].y+=i+l+h}function bI(n,t,i){const{horizontalAlign:l,verticalAlign:h}=zv(i),p=t[0]-n.displaySize[0]*l,v=t[1]-n.displaySize[1]*h;return{image:n,top:v,bottom:v+n.displaySize[1],left:p,right:p+n.displaySize[0]}}function e1(n,t,i,l,h,p){const v=n.image;let y;if(v.content){const X=v.content,le=v.pixelRatio||1;y=[X[0]/le,X[1]/le,v.displaySize[0]-X[2]/le,v.displaySize[1]-X[3]/le]}const S=t.left*p,T=t.right*p;let A,P,D,V;i==="width"||i==="both"?(V=h[0]+S-l[3],P=h[0]+T+l[1]):(V=h[0]+(S+T-v.displaySize[0])/2,P=V+v.displaySize[0]);const $=t.top*p,j=t.bottom*p;return i==="height"||i==="both"?(A=h[1]+$-l[0],D=h[1]+j+l[2]):(A=h[1]+($+j-v.displaySize[1])/2,D=A+v.displaySize[1]),{image:v,top:A,right:P,bottom:D,left:V,collisionPadding:y}}class ia extends Y{constructor(t,i,l,h,p){super(t,i),this.angle=h,this.z=l,p!==void 0&&(this.segment=p)}clone(){return new ia(this.x,this.y,this.z,this.angle,this.segment)}}function t1(n,t,i,l,h){if(t.segment===void 0)return!0;let p=t,v=t.segment+1,y=0;for(;y>-i/2;){if(v--,v<0)return!1;y-=n[v].dist(p),p=n[v]}y+=n[v].dist(n[v+1]),v++;const S=[];let T=0;for(;y<i/2;){const A=n[v],P=n[v+1];if(!P)return!1;let D=n[v-1].angleTo(A)-A.angleTo(P);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:y,angleDelta:D}),T+=D;y-S[0].distance>l;)T-=S.shift().angleDelta;if(T>h)return!1;v++,y+=A.dist(P)}return!0}function n1(n){let t=0;for(let i=0;i<n.length-1;i++)t+=n[i].dist(n[i+1]);return t}function i1(n,t,i){return n?.6*t*i:0}function r1(n,t){return Math.max(n?n.right-n.left:0,t?t.right-t.left:0)}function wI(n,t,i,l,h,p){const v=i1(i,h,p),y=r1(i,l)*p;let S=0;const T=n1(n)/2;for(let A=0;A<n.length-1;A++){const P=n[A],D=n[A+1],V=P.dist(D);if(S+V>T){const $=(T-S)/V,j=Fn(P.x,D.x,$),X=Fn(P.y,D.y,$),le=new ia(j,X,0,D.angleTo(P),A);return!v||t1(n,le,y,v,t)?le:void 0}S+=V}}function SI(n,t,i,l,h,p,v,y,S){const T=i1(l,p,v),A=r1(l,h),P=A*v,D=n[0].x===0||n[0].x===S||n[0].y===0||n[0].y===S;return t-P<t/4&&(t=P+t/4),o1(n,D?t/2*y%t:(A/2+2*p)*v*y%t,t,T,i,P,D,!1,S)}function o1(n,t,i,l,h,p,v,y,S){const T=p/2,A=n1(n);let P=0,D=t-i,V=[];for(let $=0;$<n.length-1;$++){const j=n[$],X=n[$+1],le=j.dist(X),ye=X.angleTo(j);for(;D+i<P+le;){D+=i;const ie=(D-P)/le,ge=Fn(j.x,X.x,ie),Ee=Fn(j.y,X.y,ie);if(ge>=0&&ge<S&&Ee>=0&&Ee<S&&D-T>=0&&D+T<=A){const xe=new ia(ge,Ee,0,ye,$);xe._round(),l&&!t1(n,xe,p,l,h)||V.push(xe)}}P+=le}return y||V.length||v||(V=o1(n,P/2,i,l,h,p,v,!0,S)),V}function s1(n,t,i,l,h){const p=[];for(let v=0;v<n.length;v++){const y=n[v];let S;for(let T=0;T<y.length-1;T++){let A=y[T],P=y[T+1];A.x<t&&P.x<t||(A.x<t?A=new Y(t,A.y+(t-A.x)/(P.x-A.x)*(P.y-A.y))._round():P.x<t&&(P=new Y(t,A.y+(t-A.x)/(P.x-A.x)*(P.y-A.y))._round()),A.y<i&&P.y<i||(A.y<i?A=new Y(A.x+(i-A.y)/(P.y-A.y)*(P.x-A.x),i)._round():P.y<i&&(P=new Y(A.x+(i-A.y)/(P.y-A.y)*(P.x-A.x),i)._round()),A.x>=l&&P.x>=l||(A.x>=l?A=new Y(l,A.y+(l-A.x)/(P.x-A.x)*(P.y-A.y))._round():P.x>=l&&(P=new Y(l,A.y+(l-A.x)/(P.x-A.x)*(P.y-A.y))._round()),A.y>=h&&P.y>=h||(A.y>=h?A=new Y(A.x+(h-A.y)/(P.y-A.y)*(P.x-A.x),h)._round():P.y>=h&&(P=new Y(A.x+(h-A.y)/(P.y-A.y)*(P.x-A.x),h)._round()),S&&A.equals(S[S.length-1])||(S=[A],p.push(S)),S.push(P)))))}}return p}$t(ia,"Anchor");const Ad=1e20;function a1(n,t,i,l,h,p,v,y,S){for(let T=t;T<t+l;T++)l1(n,i*p+T,p,h,v,y,S);for(let T=i;T<i+h;T++)l1(n,T*p+t,1,l,v,y,S)}function l1(n,t,i,l,h,p,v){p[0]=0,v[0]=-Ad,v[1]=Ad,h[0]=n[t];for(let y=1,S=0,T=0;y<l;y++){h[y]=n[t+y*i];const A=y*y;do{const P=p[S];T=(h[y]-h[P]+A-P*P)/(y-P)/2}while(T<=v[S]&&--S>-1);S++,p[S]=y,v[S]=T,v[S+1]=Ad}for(let y=0,S=0;y<l;y++){for(;v[S+1]<y;)S++;const T=p[S],A=y-T;n[t+y*i]=h[T]+A*A}}const Lv={none:0,ideographs:1,all:2};class Ru{constructor(t,i,l){this.requestManager=t,this.localGlyphMode=i,this.localFontFamily=l,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,i){const l=[];for(const h in t)for(const p of t[h])l.push({stack:h,id:p});at(l,({stack:h,id:p},v)=>{let y=this.entries[h];y||(y=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let S=y.glyphs[p];if(S!==void 0)return void v(null,{stack:h,id:p,glyph:S});if(S=this._tinySDF(y,h,p),S)return y.glyphs[p]=S,void v(null,{stack:h,id:p,glyph:S});const T=Math.floor(p/256);if(256*T>65535)return void v(new Error("glyphs > 65535 not supported"));if(y.ranges[T])return void v(null,{stack:h,id:p,glyph:S});let A=y.requests[T];A||(A=y.requests[T]=[],Ru.loadGlyphRange(h,T,this.url,this.requestManager,(P,D)=>{if(D){y.ascender=D.ascender,y.descender=D.descender;for(const V in D.glyphs)this._doesCharSupportLocalGlyph(+V)||(y.glyphs[+V]=D.glyphs[+V]);y.ranges[T]=!0}for(const V of A)V(P,D);delete y.requests[T]})),A.push((P,D)=>{P?v(P):D&&v(null,{stack:h,id:p,glyph:D.glyphs[p]||null})})},(h,p)=>{if(h)i(h);else if(p){const v={};for(const{stack:y,id:S,glyph:T}of p)v[y]===void 0&&(v[y]={}),v[y].glyphs===void 0&&(v[y].glyphs={}),v[y].glyphs[S]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics},v[y].ascender=this.entries[y].ascender,v[y].descender=this.entries[y].descender;i(null,v)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==Lv.none&&(this.localGlyphMode===Lv.all?!!this.localFontFamily:!!this.localFontFamily&&(id(t)||Bp(t)||vu(t)||Va(t)||Gl(t)))}_tinySDF(t,i,l){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(l))return;let p=t.tinySDF;if(!p){let j="400";/bold/i.test(i)?j="900":/medium/i.test(i)?j="500":/light/i.test(i)&&(j="200"),p=t.tinySDF=new Ru.TinySDF({fontFamily:h,fontWeight:j,fontSize:48,buffer:6,radius:16}),p.fontWeight=j}if(this.localGlyphs[p.fontWeight][l])return this.localGlyphs[p.fontWeight][l];const v=String.fromCharCode(l),{data:y,width:S,height:T,glyphWidth:A,glyphHeight:P,glyphLeft:D,glyphTop:V,glyphAdvance:$}=p.draw(v);return this.localGlyphs[p.fontWeight][l]={id:l,bitmap:new ta({width:S,height:T},y),metrics:{width:A/2,height:P/2,left:D/2,top:V/2-27,advance:$/2,localGlyph:!0}}}}function c1(n,t,i,l){const h=[],p=n.image,v=p.pixelRatio,y=p.paddedRect.w-2,S=p.paddedRect.h-2,T=n.right-n.left,A=n.bottom-n.top,P=p.stretchX||[[0,y]],D=p.stretchY||[[0,S]],V=(We,it)=>We+it[1]-it[0],$=P.reduce(V,0),j=D.reduce(V,0),X=y-$,le=S-j;let ye=0,ie=$,ge=0,Ee=j,xe=0,je=X,$e=0,tt=le;if(p.content&&l){const We=p.content;ye=cm(P,0,We[0]),ge=cm(D,0,We[1]),ie=cm(P,We[0],We[2]),Ee=cm(D,We[1],We[3]),xe=We[0]-ye,$e=We[1]-ge,je=We[2]-We[0]-ie,tt=We[3]-We[1]-Ee}const vt=(We,it,ot,dt)=>{const _t=um(We.stretch-ye,ie,T,n.left),Xe=hm(We.fixed-xe,je,We.stretch,$),Ct=um(it.stretch-ge,Ee,A,n.top),nn=hm(it.fixed-$e,tt,it.stretch,j),Dt=um(ot.stretch-ye,ie,T,n.left),qt=hm(ot.fixed-xe,je,ot.stretch,$),It=um(dt.stretch-ge,Ee,A,n.top),sn=hm(dt.fixed-$e,tt,dt.stretch,j),Cn=new Y(_t,Ct),xn=new Y(Dt,Ct),_n=new Y(Dt,It),an=new Y(_t,It),Yn=new Y(Xe/v,nn/v),hn=new Y(qt/v,sn/v),In=t*Math.PI/180;if(In){const ci=Math.sin(In),di=Math.cos(In),mi=[di,-ci,ci,di];Cn._matMult(mi),xn._matMult(mi),an._matMult(mi),_n._matMult(mi)}const ti=We.stretch+We.fixed,hi=it.stretch+it.fixed;return{tl:Cn,tr:xn,bl:an,br:_n,tex:{x:p.paddedRect.x+1+ti,y:p.paddedRect.y+1+hi,w:ot.stretch+ot.fixed-ti,h:dt.stretch+dt.fixed-hi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yn,pixelOffsetBR:hn,minFontScaleX:je/v/T,minFontScaleY:tt/v/A,isSDF:i}};if(l&&(p.stretchX||p.stretchY)){const We=u1(P,X,$),it=u1(D,le,j);for(let ot=0;ot<We.length-1;ot++){const dt=We[ot],_t=We[ot+1];for(let Xe=0;Xe<it.length-1;Xe++)h.push(vt(dt,it[Xe],_t,it[Xe+1]))}}else h.push(vt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:y+1},{fixed:0,stretch:S+1}));return h}function cm(n,t,i){let l=0;for(const h of n)l+=Math.max(t,Math.min(i,h[1]))-Math.max(t,Math.min(i,h[0]));return l}function u1(n,t,i){const l=[{fixed:-1,stretch:0}];for(const[h,p]of n){const v=l[l.length-1];l.push({fixed:h-v.stretch,stretch:v.stretch}),l.push({fixed:h-v.stretch,stretch:v.stretch+(p-h)})}return l.push({fixed:t+1,stretch:i}),l}function um(n,t,i,l){return n/t*i+l}function hm(n,t,i,l){return n-t*i/l}function TI(n,t,i,l){const h=t+n.positionedLines[l].lineOffset;return l===0?i+h/2:i+(h+(t+n.positionedLines[l-1].lineOffset))/2}Ru.loadGlyphRange=function(n,t,i,l,h){const p=256*t,v=p+255,y=l.transformRequest(l.normalizeGlyphsURL(i).replace("{fontstack}",n).replace("{range}",`${p}-${v}`),tr.Glyphs);po(y,(S,T)=>{if(S)h(S);else if(T){const A={},P=function(D){return new Cd(D).readFields(gI,{})}(T);for(const D of P.glyphs)A[D.id]=D;h(null,{glyphs:A,ascender:P.ascender,descender:P.descender})}})},Ru.TinySDF=class{constructor({fontSize:n=24,buffer:t=3,radius:i=8,cutoff:l=.25,fontFamily:h="sans-serif",fontWeight:p="normal",fontStyle:v="normal"}={}){this.buffer=t,this.cutoff=l,this.radius=i;const y=this.size=n+4*t,S=this._createCanvas(y),T=this.ctx=S.getContext("2d",{willReadFrequently:!0});T.font=`${v} ${p} ${n}px ${h}`,T.textBaseline="alphabetic",T.textAlign="left",T.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(n){const t=document.createElement("canvas");return t.width=t.height=n,t}draw(n){const{width:t,actualBoundingBoxAscent:i,actualBoundingBoxDescent:l,actualBoundingBoxLeft:h,actualBoundingBoxRight:p}=this.ctx.measureText(n),v=Math.ceil(i),y=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-h))),S=Math.min(this.size-this.buffer,v+Math.ceil(l)),T=y+2*this.buffer,A=S+2*this.buffer,P=Math.max(T*A,0),D=new Uint8ClampedArray(P),V={data:D,width:T,height:A,glyphWidth:y,glyphHeight:S,glyphTop:v,glyphLeft:0,glyphAdvance:t};if(y===0||S===0)return V;const{ctx:$,buffer:j,gridInner:X,gridOuter:le}=this;$.clearRect(j,j,y,S),$.fillText(n,j,j+v);const ye=$.getImageData(j,j,y,S);le.fill(Ad,0,P),X.fill(0,0,P);for(let ie=0;ie<S;ie++)for(let ge=0;ge<y;ge++){const Ee=ye.data[4*(ie*y+ge)+3]/255;if(Ee===0)continue;const xe=(ie+j)*T+ge+j;if(Ee===1)le[xe]=0,X[xe]=Ad;else{const je=.5-Ee;le[xe]=je>0?je*je:0,X[xe]=je<0?je*je:0}}a1(le,0,0,T,A,T,this.f,this.v,this.z),a1(X,j,j,y,S,T,this.f,this.v,this.z);for(let ie=0;ie<P;ie++){const ge=Math.sqrt(le[ie])-Math.sqrt(X[ie]);D[ie]=Math.round(255-255*(ge/this.radius+this.cutoff))}return V}};class EI{constructor(t=[],i=CI){if(this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:i,compare:l}=this,h=i[t];for(;t>0;){const p=t-1>>1,v=i[p];if(l(h,v)>=0)break;i[t]=v,t=p}i[t]=h}_down(t){const{data:i,compare:l}=this,h=this.length>>1,p=i[t];for(;t<h;){let v=1+(t<<1),y=i[v];const S=v+1;if(S<this.length&&l(i[S],y)<0&&(v=S,y=i[S]),l(y,p)>=0)break;i[t]=y,t=v}i[t]=p}}function CI(n,t){return n<t?-1:n>t?1:0}function II(n,t=1,i=!1){let l=1/0,h=1/0,p=-1/0,v=-1/0;const y=n[0];for(let V=0;V<y.length;V++){const $=y[V];(!V||$.x<l)&&(l=$.x),(!V||$.y<h)&&(h=$.y),(!V||$.x>p)&&(p=$.x),(!V||$.y>v)&&(v=$.y)}const S=Math.min(p-l,v-h);let T=S/2;const A=new EI([],AI);if(S===0)return new Y(l,h);for(let V=l;V<p;V+=S)for(let $=h;$<v;$+=S)A.push(new Bu(V+T,$+T,T,n));let P=function(V){let $=0,j=0,X=0;const le=V[0];for(let ye=0,ie=le.length,ge=ie-1;ye<ie;ge=ye++){const Ee=le[ye],xe=le[ge],je=Ee.x*xe.y-xe.x*Ee.y;j+=(Ee.x+xe.x)*je,X+=(Ee.y+xe.y)*je,$+=3*je}return new Bu(j/$,X/$,0,V)}(n),D=A.length;for(;A.length;){const V=A.pop();(V.d>P.d||!P.d)&&(P=V,i&&console.log("found best %d after %d probes",Math.round(1e4*V.d)/1e4,D)),V.max-P.d<=t||(T=V.h/2,A.push(new Bu(V.p.x-T,V.p.y-T,T,n)),A.push(new Bu(V.p.x+T,V.p.y-T,T,n)),A.push(new Bu(V.p.x-T,V.p.y+T,T,n)),A.push(new Bu(V.p.x+T,V.p.y+T,T,n)),D+=4)}return i&&(console.log(`num probes: ${D}`),console.log(`best distance: ${P.d}`)),P.p}function AI(n,t){return t.max-n.max}function Bu(n,t,i,l){this.p=new Y(n,t),this.h=i,this.d=function(h,p){let v=!1,y=1/0;for(let S=0;S<p.length;S++){const T=p[S];for(let A=0,P=T.length,D=P-1;A<P;D=A++){const V=T[A],$=T[D];V.y>h.y!=$.y>h.y&&h.x<($.x-V.x)*(h.y-V.y)/($.y-V.y)+V.x&&(v=!v),y=Math.min(y,lx(h,V,$))}}return(v?1:-1)*Math.sqrt(y)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}const Dv=Number.POSITIVE_INFINITY,kI=Math.sqrt(2);function h1(n,[t,i]){let l=0,h=0;if(i===Dv){t<0&&(t=0);const p=t/kI;switch(n){case"top-right":case"top-left":h=p-7;break;case"bottom-right":case"bottom-left":h=7-p;break;case"bottom":h=7-t;break;case"top":h=t-7}switch(n){case"top-right":case"bottom-right":l=-p;break;case"top-left":case"bottom-left":l=p;break;case"left":l=t;break;case"right":l=-t}}else{switch(t=Math.abs(t),i=Math.abs(i),n){case"top-right":case"top-left":case"top":h=i-7;break;case"bottom-right":case"bottom-left":case"bottom":h=7-i}switch(n){case"top-right":case"bottom-right":case"right":l=-t;break;case"top-left":case"bottom-left":case"left":l=t}}return[l,h]}function MI(n,t,i,l,h,p,v,y,S,T){n.createArrays(),n.tilePixelRatio=un/(512*n.overscaling),n.compareText={},n.iconsNeedLinear=!1;const A=n.layers[0].layout,P=n.layers[0]._unevaluatedLayout._values,D={};if(n.textSizeData.kind==="composite"){const{minZoom:j,maxZoom:X}=n.textSizeData;D.compositeTextSizes=[P["text-size"].possiblyEvaluate(new Be(j),y),P["text-size"].possiblyEvaluate(new Be(X),y)]}if(n.iconSizeData.kind==="composite"){const{minZoom:j,maxZoom:X}=n.iconSizeData;D.compositeIconSizes=[P["icon-size"].possiblyEvaluate(new Be(j),y),P["icon-size"].possiblyEvaluate(new Be(X),y)]}D.layoutTextSize=P["text-size"].possiblyEvaluate(new Be(S+1),y),D.layoutIconSize=P["icon-size"].possiblyEvaluate(new Be(S+1),y),D.textMaxSize=P["text-size"].possiblyEvaluate(new Be(18),y);const V=A.get("text-rotation-alignment")==="map"&&A.get("symbol-placement")!=="point",$=A.get("text-size");for(const j of n.features){const X=A.get("text-font").evaluate(j,{},y).join(","),le=$.evaluate(j,{},y),ye=D.layoutTextSize.evaluate(j,{},y),ie=(D.layoutIconSize.evaluate(j,{},y),{horizontal:{},vertical:void 0}),ge=j.text;let Ee,xe=[0,0];if(ge){const tt=ge.toString(),vt=A.get("text-letter-spacing").evaluate(j,{},y)*wr,We=A.get("text-line-height").evaluate(j,{},y)*wr,it=b(tt)?vt:0,ot=A.get("text-anchor").evaluate(j,{},y),dt=A.get("text-variable-anchor");if(!dt){const Dt=A.get("text-radial-offset").evaluate(j,{},y);xe=Dt?h1(ot,[Dt*wr,Dv]):A.get("text-offset").evaluate(j,{},y).map(qt=>qt*wr)}let _t=V?"center":A.get("text-justify").evaluate(j,{},y);const Xe=A.get("symbol-placement")==="point",Ct=Xe?A.get("text-max-width").evaluate(j,{},y)*wr:1/0,nn=Dt=>{n.allowVerticalPlacement&&_(tt)&&(ie.vertical=Pv(ge,t,i,h,X,Ct,We,ot,Dt,it,xe,ao.vertical,!0,ye,le))};if(!V&&dt){const Dt=_t==="auto"?dt.map(It=>Rv(It)):[_t];let qt=!1;for(let It=0;It<Dt.length;It++){const sn=Dt[It];if(!ie.horizontal[sn])if(qt)ie.horizontal[sn]=ie.horizontal[0];else{const Cn=Pv(ge,t,i,h,X,Ct,We,"center",sn,it,xe,ao.horizontal,!1,ye,le);Cn&&(ie.horizontal[sn]=Cn,qt=Cn.positionedLines.length===1)}}nn("left")}else{if(_t==="auto"&&(_t=Rv(ot)),Xe||A.get("text-writing-mode").indexOf("horizontal")>=0||!_(tt)){const Dt=Pv(ge,t,i,h,X,Ct,We,ot,_t,it,xe,ao.horizontal,!1,ye,le);Dt&&(ie.horizontal[_t]=Dt)}nn(Xe?"left":_t)}}let je=!1;if(j.icon&&j.icon.name){const tt=l[j.icon.name];tt&&(Ee=bI(h[j.icon.name],A.get("icon-offset").evaluate(j,{},y),A.get("icon-anchor").evaluate(j,{},y)),je=tt.sdf,n.sdfIcons===void 0?n.sdfIcons=tt.sdf:n.sdfIcons!==tt.sdf&&ue("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(tt.pixelRatio!==n.pixelRatio||A.get("icon-rotate").constantOr(1)!==0)&&(n.iconsNeedLinear=!0))}const $e=f1(ie.horizontal)||ie.vertical;n.iconsInText||(n.iconsInText=!!$e&&$e.iconsInText),($e||Ee)&&PI(n,j,ie,Ee,l,D,ye,0,xe,je,v,y,T)}p&&n.generateCollisionDebugBuffers(S,n.collisionBoxArray)}function Rv(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function PI(n,t,i,l,h,p,v,y,S,T,A,P,D){let V=p.textMaxSize.evaluate(t,{},P);V===void 0&&(V=v);const $=n.layers[0].layout,j=$.get("icon-offset").evaluate(t,{},P),X=f1(i.horizontal)||i.vertical,le=D.name==="globe",ye=v/24,ie=n.tilePixelRatio*V/24,ge=(it=n.overscaling,n.zoom>18&&it>2&&(it>>=1),Math.max(un/(512*it),1)*$.get("symbol-spacing")),Ee=$.get("text-padding")*n.tilePixelRatio,xe=$.get("icon-padding")*n.tilePixelRatio,je=Se($.get("text-max-angle")),$e=$.get("text-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",tt=$.get("icon-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",vt=$.get("symbol-placement"),We=ge/2;var it;const ot=$.get("icon-text-fit");let dt;l&&ot!=="none"&&(n.allowVerticalPlacement&&i.vertical&&(dt=e1(l,i.vertical,ot,$.get("icon-text-fit-padding"),j,ye)),X&&(l=e1(l,X,ot,$.get("icon-text-fit-padding"),j,ye)));const _t=(Xe,Ct,nn)=>{if(Ct.x<0||Ct.x>=un||Ct.y<0||Ct.y>=un)return;let Dt=null;if(le){const{x:qt,y:It,z:sn}=D.projectTilePoint(Ct.x,Ct.y,nn);Dt={anchor:new ia(qt,It,sn,0,void 0),up:D.upVector(nn,Ct.x,Ct.y)}}(function(qt,It,sn,Cn,xn,_n,an,Yn,hn,In,ti,hi,ci,di,mi,Ii,lr,Kn,Zi,$i,Nn,_i,Ji,ni,Ri){const Ir=qt.addToLineVertexArray(It,Cn);let cr,ur,Fr,hr,ra,Vu,Rd,Bd=0,U1=0,j1=0,G1=0,Wv=-1,Hv=-1;const Es={};let q1=Zl("");const rc=sn?sn.anchor:It;let Xv=0,Yv=0;if(hn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Xv,Yv]=hn.layout.get("text-offset").evaluate(Nn,{},Ri).map(Jr=>Jr*wr):(Xv=hn.layout.get("text-radial-offset").evaluate(Nn,{},Ri)*wr,Yv=Dv),qt.allowVerticalPlacement&&xn.vertical){const Jr=xn.vertical;if(mi)Vu=Bv(Jr),Yn&&(Rd=Bv(Yn));else{const Qr=hn.layout.get("text-rotate").evaluate(Nn,{},Ri)+90;Fr=dm(In,rc,It,ti,hi,ci,Jr,di,Qr,Ii),Yn&&(hr=dm(In,rc,It,ti,hi,ci,Yn,Kn,Qr))}}if(_n){const Jr=hn.layout.get("icon-rotate").evaluate(Nn,{},Ri),Qr=hn.layout.get("icon-text-fit")!=="none",Od=c1(_n,Jr,Ji,Qr),Jv=Yn?c1(Yn,Jr,Ji,Qr):void 0;ur=dm(In,rc,It,ti,hi,ci,_n,Kn,Jr),Bd=4*Od.length;const Z1=qt.iconSizeData;let oc=null;Z1.kind==="source"?(oc=[bs*hn.layout.get("icon-size").evaluate(Nn,{},Ri)],oc[0]>qa&&ue(`${qt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Z1.kind==="composite"&&(oc=[bs*_i.compositeIconSizes[0].evaluate(Nn,{},Ri),bs*_i.compositeIconSizes[1].evaluate(Nn,{},Ri)],(oc[0]>qa||oc[1]>qa)&&ue(`${qt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),qt.addSymbols(qt.icon,Od,oc,$i,Zi,Nn,!1,sn,It,Ir.lineStartIndex,Ir.lineLength,-1,ni,Ri),Wv=qt.icon.placedSymbolArray.length-1,Jv&&(U1=4*Jv.length,qt.addSymbols(qt.icon,Jv,oc,$i,Zi,Nn,ao.vertical,sn,It,Ir.lineStartIndex,Ir.lineLength,-1,ni,Ri),Hv=qt.icon.placedSymbolArray.length-1)}for(const Jr in xn.horizontal){const Qr=xn.horizontal[Jr];cr||(q1=Zl(Qr.text),mi?ra=Bv(Qr):cr=dm(In,rc,It,ti,hi,ci,Qr,di,hn.layout.get("text-rotate").evaluate(Nn,{},Ri),Ii));const Od=Qr.positionedLines.length===1;if(j1+=d1(qt,sn,It,Qr,an,hn,mi,Nn,Ii,Ir,xn.vertical?ao.horizontal:ao.horizontalOnly,Od?Object.keys(xn.horizontal):[Jr],Es,Wv,_i,ni,Ri),Od)break}xn.vertical&&(G1+=d1(qt,sn,It,xn.vertical,an,hn,mi,Nn,Ii,Ir,ao.vertical,["vertical"],Es,Hv,_i,ni,Ri));let Ka=-1;const Kv=(Jr,Qr)=>Jr?Math.max(Jr,Qr):Qr;Ka=Kv(ra,Ka),Ka=Kv(Vu,Ka),Ka=Kv(Rd,Ka);const iA=Ka>-1?1:0;qt.glyphOffsetArray.length>=Wa.MAX_GLYPHS&&ue("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Nn.sortKey!==void 0&&qt.addToSortKeyRanges(qt.symbolInstances.length,Nn.sortKey),qt.symbolInstances.emplaceBack(rc.x,rc.y,rc.z,It.x,It.y,Es.right>=0?Es.right:-1,Es.center>=0?Es.center:-1,Es.left>=0?Es.left:-1,Es.vertical>=0?Es.vertical:-1,Wv,Hv,q1,cr!==void 0?cr:qt.collisionBoxArray.length,cr!==void 0?cr+1:qt.collisionBoxArray.length,Fr!==void 0?Fr:qt.collisionBoxArray.length,Fr!==void 0?Fr+1:qt.collisionBoxArray.length,ur!==void 0?ur:qt.collisionBoxArray.length,ur!==void 0?ur+1:qt.collisionBoxArray.length,hr||qt.collisionBoxArray.length,hr?hr+1:qt.collisionBoxArray.length,ti,j1,G1,Bd,U1,iA,0,Xv,Yv,Ka)})(n,Ct,Dt,Xe,i,l,h,dt,n.layers[0],n.collisionBoxArray,t.index,t.sourceLayerIndex,n.index,Ee,$e,S,0,xe,tt,j,t,p,T,A,P)};if(vt==="line")for(const Xe of s1(t.geometry,0,0,un,un)){const Ct=SI(Xe,ge,je,i.vertical||X,l,24,ie,n.overscaling,un);for(const nn of Ct){const Dt=X;Dt&&zI(n,Dt.text,We,nn)||_t(Xe,nn,P)}}else if(vt==="line-center"){for(const Xe of t.geometry)if(Xe.length>1){const Ct=wI(Xe,je,i.vertical||X,l,24,ie);Ct&&_t(Xe,Ct,P)}}else if(t.type==="Polygon")for(const Xe of Sv(t.geometry,0)){const Ct=II(Xe,16);_t(Xe[0],new ia(Ct.x,Ct.y,0,0,void 0),P)}else if(t.type==="LineString")for(const Xe of t.geometry)_t(Xe,new ia(Xe[0].x,Xe[0].y,0,0,void 0),P);else if(t.type==="Point")for(const Xe of t.geometry)for(const Ct of Xe)_t([Ct],new ia(Ct.x,Ct.y,0,0,void 0),P)}const qa=32640;function d1(n,t,i,l,h,p,v,y,S,T,A,P,D,V,$,j,X){const le=function(ge,Ee,xe,je,$e,tt,vt,We){const it=[];if(Ee.positionedLines.length===0)return it;const ot=je.layout.get("text-rotate").evaluate(tt,{})*Math.PI/180,dt=function(Dt){const qt=Dt[0],It=Dt[1],sn=qt*It;return sn>0?[qt,-It]:sn<0?[-qt,It]:qt===0?[It,qt]:[It,-qt]}(xe);let _t=Math.abs(Ee.top-Ee.bottom);for(const Dt of Ee.positionedLines)_t-=Dt.lineOffset;const Xe=Ee.positionedLines.length,Ct=_t/Xe;let nn=Ee.top-xe[1];for(let Dt=0;Dt<Xe;++Dt){const qt=Ee.positionedLines[Dt];nn=TI(Ee,Ct,nn,Dt);for(const It of qt.positionedGlyphs){if(!It.rect)continue;const sn=It.rect||{};let Cn=4,xn=!0,_n=1,an=0;if(It.imageName){const ni=vt[It.imageName];if(!ni)continue;if(ni.sdf){ue("SDF images are not supported in formatted text and will be ignored.");continue}xn=!1,_n=ni.pixelRatio,Cn=1/_n}const Yn=($e||We)&&It.vertical,hn=It.metrics.advance*It.scale/2,In=It.metrics,ti=It.rect;if(ti===null)continue;We&&Ee.verticalizable&&(an=It.imageName?hn-It.metrics.width*It.scale/2:0);const hi=$e?[It.x+hn,It.y]:[0,0];let ci=[0,0],di=[0,0],mi=!1;$e||(Yn?(di=[It.x+hn+dt[0],It.y+dt[1]-an],mi=!0):ci=[It.x+hn+xe[0],It.y+xe[1]-an]);const Ii=ti.w*It.scale/(_n*(It.localGlyph?2:1)),lr=ti.h*It.scale/(_n*(It.localGlyph?2:1));let Kn,Zi,$i,Nn;if(Yn){const ni=It.y-nn,Ri=new Y(-hn,hn-ni),Ir=-Math.PI/2,cr=new Y(...di);Kn=new Y(-hn+ci[0],ci[1]),Kn._rotateAround(Ir,Ri)._add(cr),Kn.x+=-ni+hn,Kn.y-=(In.left-Cn)*It.scale;const ur=It.imageName?In.advance*It.scale:wr*It.scale,Fr=String.fromCharCode(It.glyph);oI(Fr)?Kn.x+=(1-Cn)*It.scale:sI(Fr)?Kn.x+=ur-In.height*It.scale+(-Cn-1)*It.scale:Kn.x+=It.imageName||In.width+2*Cn===ti.w&&In.height+2*Cn===ti.h?(ur-lr)/2:(ur-(In.height+2*Cn)*It.scale)/2,Zi=new Y(Kn.x,Kn.y-Ii),$i=new Y(Kn.x+lr,Kn.y),Nn=new Y(Kn.x+lr,Kn.y-Ii)}else{const ni=(In.left-Cn)*It.scale-hn+ci[0],Ri=(-In.top-Cn)*It.scale+ci[1],Ir=ni+Ii,cr=Ri+lr;Kn=new Y(ni,Ri),Zi=new Y(Ir,Ri),$i=new Y(ni,cr),Nn=new Y(Ir,cr)}if(ot){let ni;ni=$e?new Y(0,0):mi?new Y(dt[0],dt[1]):new Y(xe[0],xe[1]),Kn._rotateAround(ot,ni),Zi._rotateAround(ot,ni),$i._rotateAround(ot,ni),Nn._rotateAround(ot,ni)}const _i=new Y(0,0),Ji=new Y(0,0);it.push({tl:Kn,tr:Zi,bl:$i,br:Nn,tex:sn,writingMode:Ee.writingMode,glyphOffset:hi,sectionIndex:It.sectionIndex,isSDF:xn,pixelOffsetTL:_i,pixelOffsetBR:Ji,minFontScaleX:0,minFontScaleY:0})}}return it}(0,l,S,p,v,y,h,n.allowVerticalPlacement),ye=n.textSizeData;let ie=null;ye.kind==="source"?(ie=[bs*p.layout.get("text-size").evaluate(y,{},X)],ie[0]>qa&&ue(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ye.kind==="composite"&&(ie=[bs*$.compositeTextSizes[0].evaluate(y,{},X),bs*$.compositeTextSizes[1].evaluate(y,{},X)],(ie[0]>qa||ie[1]>qa)&&ue(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,le,ie,S,v,y,A,t,i,T.lineStartIndex,T.lineLength,V,j,X);for(const ge of P)D[ge]=n.text.placedSymbolArray.length-1;return 4*le.length}function f1(n){for(const t in n)return n[t];return null}function dm(n,t,i,l,h,p,v,y,S,T){let A=v.top,P=v.bottom,D=v.left,V=v.right;const $=v.collisionPadding;if($&&(D-=$[0],A-=$[1],V+=$[2],P+=$[3]),S){const j=new Y(D,A),X=new Y(V,A),le=new Y(D,P),ye=new Y(V,P),ie=Se(S);let ge=new Y(0,0);T&&(ge=new Y(T[0],T[1])),j._rotateAround(ie,ge),X._rotateAround(ie,ge),le._rotateAround(ie,ge),ye._rotateAround(ie,ge),D=Math.min(j.x,X.x,le.x,ye.x),V=Math.max(j.x,X.x,le.x,ye.x),A=Math.min(j.y,X.y,le.y,ye.y),P=Math.max(j.y,X.y,le.y,ye.y)}return n.emplaceBack(t.x,t.y,t.z,i.x,i.y,D,A,V,P,y,l,h,p),n.length-1}function Bv(n){n.collisionPadding&&(n.top-=n.collisionPadding[1],n.bottom+=n.collisionPadding[3]);const t=n.bottom-n.top;return t>0?Math.max(10,t):null}function zI(n,t,i,l){const h=n.compareText;if(t in h){const p=h[t];for(let v=p.length-1;v>=0;v--)if(l.dist(p[v])<i)return!0}else h[t]=[];return h[t].push(l),!1}function p1(n,t){const i=n.fovAboveCenter,l=n.elevation?n.elevation.getMinElevationBelowMSL()*t:0,h=(n._camera.position[2]*n.worldSize-l)/Math.cos(n._pitch),p=Math.sin(i)*h/Math.sin(Math.max(Math.PI/2-n._pitch-i,.01)),v=Math.sin(n._pitch)*p+h;return Math.min(1.01*v,h*(1/n._horizonShift))}function nc(n,t){if(!t.isReprojectedInTileSpace)return{scale:1<<n.z,x:n.x,y:n.y,x2:n.x+1,y2:n.y+1,projection:t};const i=Math.pow(2,-n.z),l=n.x*i,h=(n.x+1)*i,p=n.y*i,v=(n.y+1)*i,y=so(l),S=so(h),T=xr(p),A=xr(v),P=t.project(y,T),D=t.project(S,T),V=t.project(S,A),$=t.project(y,A);let j=Math.min(P.x,D.x,V.x,$.x),X=Math.min(P.y,D.y,V.y,$.y),le=Math.max(P.x,D.x,V.x,$.x),ye=Math.max(P.y,D.y,V.y,$.y);const ie=i/16;function ge(xe,je,$e,tt,vt,We){const it=($e+vt)/2,ot=(tt+We)/2,dt=t.project(so(it),xr(ot)),_t=Math.max(0,j-dt.x,X-dt.y,dt.x-le,dt.y-ye);j=Math.min(j,dt.x),le=Math.max(le,dt.x),X=Math.min(X,dt.y),ye=Math.max(ye,dt.y),_t>ie&&(ge(xe,dt,$e,tt,it,ot),ge(dt,je,it,ot,vt,We))}ge(P,D,l,p,h,p),ge(D,V,h,p,h,v),ge(V,$,h,v,l,v),ge($,P,l,v,l,p),j-=ie,X-=ie,le+=ie,ye+=ie;const Ee=1/Math.max(le-j,ye-X);return{scale:Ee,x:j*Ee,y:X*Ee,x2:le*Ee,y2:ye*Ee,projection:t}}const LI=qo(new Float32Array(16));class Za{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,i){return{x:0,y:0,z:0}}unproject(t,i){return new Vn(0,0)}projectTilePoint(t,i,l){return{x:t,y:i,z:0}}locationPoint(t,i,l=!0){return t._coordinatePoint(t.locationCoordinate(i),l)}pixelsPerMeter(t,i){return Wo(1,t)*i}pixelSpaceConversion(t,i,l){return 1}farthestPixelDistance(t){return p1(t,t.pixelsPerMeter)}pointCoordinate(t,i,l,h){const p=t.horizonLineFromTop(!1),v=new Y(i,Math.max(p,l));return t.rayIntersectionCoordinate(t.pointRayIntersection(v,h))}pointCoordinate3D(t,i,l){const h=new Y(i,l);if(t.elevation)return t.elevation.pointCoordinate(h);{const p=this.pointCoordinate(t,h.x,h.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(t,i){if(t.elevation)return!this.pointCoordinate3D(t,i.x,i.y);const l=t.horizonLineFromTop();return i.y<l}createInversionMatrix(t,i){return LI}createTileMatrix(t,i,l){let h,p,v;const y=l.canonical,S=qo(new Float64Array(16));if(this.isReprojectedInTileSpace){const T=nc(y,this);h=1,p=T.x+l.wrap*T.scale,v=T.y,Xl(S,S,[h/T.scale,h/T.scale,t.pixelsPerMeter/i])}else h=i/t.zoomScale(y.z),p=(y.x+Math.pow(2,y.z)*l.wrap)*h,v=y.y*h;return od(S,S,[p,v,0]),Xl(S,S,[h/un,h/un,1]),S}upVector(t,i,l){return[0,0,1]}upVectorScale(t,i,l){return{metersToTile:1}}}class DI extends Za{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[i,l]=this.parallels=t.parallels||[29.5,45.5],h=Math.sin(Se(i));this.n=(h+Math.sin(Se(l)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(t,i){const{n:l,c:h,r0:p}=this,v=Se(t-this.center[0]),y=Se(i),S=Math.sqrt(h-2*l*Math.sin(y))/l;return{x:S*Math.sin(v*l),y:S*Math.cos(v*l)-p,z:0}}unproject(t,i){const{n:l,c:h,r0:p}=this,v=p+i;let y=Math.atan2(t,Math.abs(v))*Math.sign(v);v*l<0&&(y-=Math.PI*Math.sign(t)*Math.sign(v));const S=Se(this.center[0])*l;y=Pe(y,-Math.PI-S,Math.PI-S);const T=nt(be(y/l)+this.center[0],-180,180),A=Math.asin(nt((h-(t*t+v*v)*l*l)/(2*l),-1,1)),P=nt(be(A),-br,br);return new Vn(T,P)}}const kd=1.340264,Md=-.081106,Pd=893e-6,zd=.003796,fm=Math.sqrt(3)/2;class RI extends Za{project(t,i){i=i/180*Math.PI,t=t/180*Math.PI;const l=Math.asin(fm*Math.sin(i)),h=l*l,p=h*h*h;return{x:.5*(t*Math.cos(l)/(fm*(kd+3*Md*h+p*(7*Pd+9*zd*h)))/Math.PI+.5),y:1-.5*(l*(kd+Md*h+p*(Pd+zd*h))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let l=i=(2*(1-i)-1)*Math.PI,h=l*l,p=h*h*h;for(let A,P,D,V=0;V<12&&(P=l*(kd+Md*h+p*(Pd+zd*h))-i,D=kd+3*Md*h+p*(7*Pd+9*zd*h),A=P/D,l=nt(l-A,-Math.PI/3,Math.PI/3),h=l*l,p=h*h*h,!(Math.abs(A)<1e-12));++V);const v=fm*t*(kd+3*Md*h+p*(7*Pd+9*zd*h))/Math.cos(l),y=Math.asin(Math.sin(l)/fm),S=nt(180*v/Math.PI,-180,180),T=nt(180*y/Math.PI,-br,br);return new Vn(S,T)}}class BI extends Za{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){return{x:.5+t/360,y:.5-i/360,z:0}}unproject(t,i){const l=360*(t-.5),h=nt(360*(.5-i),-br,br);return new Vn(l,h)}}const Ou=Math.PI/2;function pm(n){return Math.tan((Ou+n)/2)}class OI extends Za{constructor(t){super(t),this.center=t.center||[0,30];const[i,l]=this.parallels=t.parallels||[30,30];let h=Se(i),p=Se(l);this.southernCenter=h+p<0,this.southernCenter&&(h=-h,p=-p);const v=Math.cos(h),y=pm(h);this.n=h===p?Math.sin(h):Math.log(v/Math.cos(p))/Math.log(pm(p)/y),this.f=v*Math.pow(pm(h),this.n)/this.n}project(t,i){i=Se(i),this.southernCenter&&(i=-i),t=Se(t-this.center[0]);const l=1e-6,{n:h,f:p}=this;p>0?i<-Ou+l&&(i=-Ou+l):i>Ou-l&&(i=Ou-l);const v=p/Math.pow(pm(i),h);let y=v*Math.sin(h*t),S=p-v*Math.cos(h*t);return y=.5*(y/Math.PI+.5),S=.5*(S/Math.PI+.5),{x:y,y:this.southernCenter?S:1-S,z:0}}unproject(t,i){t=(2*t-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:l,f:h}=this,p=h-i,v=Math.sign(p),y=Math.sign(l)*Math.sqrt(t*t+p*p);let S=Math.atan2(t,Math.abs(p))*v;p*l<0&&(S-=Math.PI*Math.sign(t)*v);const T=nt(be(S/l)+this.center[0],-180,180),A=nt(be(2*Math.atan(Math.pow(h/y,1/l))-Ou),-br,br);return new Vn(T,this.southernCenter?-A:A)}}class m1 extends Za{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,i){return{x:ys(t),y:xs(i),z:0}}unproject(t,i){const l=so(t),h=xr(i);return new Vn(l,h)}}const g1=Se(br);class FI extends Za{project(t,i){const l=(i=Se(i))*i,h=l*l;return{x:.5*((t=Se(t))*(.8707-.131979*l+h*(h*(.003971*l-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+l*(.015085+h*(.028874*l-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let l=i=(2*(1-i)-1)*Math.PI,h=25,p=0,v=l*l;do{v=l*l;const T=v*v;p=(l*(1.007226+v*(.015085+T*(.028874*v-.044475-.005916*T)))-i)/(1.007226+v*(.045255+T*(.259866*v-.311325-.005916*11*T))),l=nt(l-p,-g1,g1)}while(Math.abs(p)>1e-6&&--h>0);v=l*l;const y=nt(be(t/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),S=be(l);return new Vn(y,S)}}const v1=Se(br);class VI extends Za{project(t,i){i=Se(i),t=Se(t);const l=Math.cos(i),h=2/Math.PI,p=Math.acos(l*Math.cos(t/2)),v=Math.sin(p)/p,y=.5*(t*h+2*l*Math.sin(t/2)/v)||0,S=.5*(i+Math.sin(i)/v)||0;return{x:.5*(y/Math.PI+.5),y:1-.5*(S/Math.PI+1),z:0}}unproject(t,i){let l=t=(2*t-.5)*Math.PI,h=i=(2*(1-i)-1)*Math.PI,p=25;const v=1e-6;let y=0,S=0;do{const T=Math.cos(h),A=Math.sin(h),P=2*A*T,D=A*A,V=T*T,$=Math.cos(l/2),j=Math.sin(l/2),X=2*$*j,le=j*j,ye=1-V*$*$,ie=ye?1/ye:0,ge=ye?Math.acos(T*$)*Math.sqrt(1/ye):0,Ee=.5*(2*ge*T*j+2*l/Math.PI)-t,xe=.5*(ge*A+h)-i,je=.5*ie*(V*le+ge*T*$*D)+1/Math.PI,$e=ie*(X*P/4-ge*A*j),tt=.125*ie*(P*j-ge*A*V*X),vt=.5*ie*(D*$+ge*le*T)+.5,We=$e*tt-vt*je;y=(xe*$e-Ee*vt)/We,S=(Ee*tt-xe*je)/We,l=nt(l-y,-Math.PI,Math.PI),h=nt(h-S,-v1,v1)}while((Math.abs(y)>v||Math.abs(S)>v)&&--p>0);return new Vn(be(l),be(h))}}class _1 extends Za{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Se(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){const{scale:l,cosPhi:h}=this;return{x:Se(t)*h*l+.5,y:-Math.sin(Se(i))/h*l+.5,z:0}}unproject(t,i){const{scale:l,cosPhi:h}=this,p=-(i-.5)/l,v=nt(be((t-.5)/l)/h,-180,180),y=Math.asin(nt(p*h,-1,1)),S=nt(be(y),-br,br);return new Vn(v,S)}}class $I extends m1{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,i,l){const h=fd(t,i,l);return Di(h,h,pd(_s(l))),{x:h[0],y:h[1],z:h[2]}}locationPoint(t,i){const l=Su(i.lat,i.lng),h=Rr([],l),p=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(i),t._centerAltitude):t._centerAltitude;cd(l,l,h,Wo(1,0)*un*p);const v=qo(new Float64Array(16));return Hl(v,t.pixelMatrix,t.globeMatrix),Di(l,l,v),new Y(l[0],l[1])}pixelsPerMeter(t,i){return Wo(1,0)*i}pixelSpaceConversion(t,i,l){const h=Wo(1,t)*i,p=Fn(Wo(1,45)*i,h,l);return this.pixelsPerMeter(t,i)/p}createTileMatrix(t,i,l){const h=cv(_s(l.canonical));return Hl(new Float64Array(16),t.globeMatrix,h)}createInversionMatrix(t,i){const{center:l}=t,h=pd(_s(i));return jp(h,h,Se(l.lng)),ev(h,h,Se(l.lat)),Xl(h,h,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(t,i,l,h){return H0(t,i,l,!0)||new Eu(0,0)}pointCoordinate3D(t,i,l){const h=this.pointCoordinate(t,i,l,0);return[h.x,h.y,h.z]}isPointAboveHorizon(t,i){return!H0(t,i.x,i.y,!1)}farthestPixelDistance(t){const i=function(h,p){const v=h.cameraToCenterDistance,y=h._centerAltitude*p,S=h._camera,T=h._camera.forward(),A=Qs([],oo([],T,-v),[0,0,y]),P=h.worldSize/(2*Math.PI),D=[0,0,-P],V=h.width/h.height,$=Math.tan(h.fovAboveCenter),j=oo([],S.up(),$),X=oo([],S.right(),$*V),le=Rr([],Qs([],Qs([],T,j),X)),ye=[];let ie;if(new rv(A,le).closestPointOnSphere(D,P,ye)){const ge=Qs([],ye,D),Ee=Zo([],ge,A);ie=Math.cos(h.fovAboveCenter)*sd(Ee)}else{const ge=Zo([],A,D),Ee=Zo([],D,A);Rr(Ee,Ee);const xe=sd(ge)-P;ie=Math.sqrt(xe*(xe+2*P));const je=Math.acos(ie/(P+xe))-Math.acos(yo(T,Ee));ie*=Math.cos(je)}return 1.01*ie}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),l=Tu(t.zoom);if(l>0){const h=p1(t,Wo(1,t.center.lat)*t.worldSize),p=t.worldSize/(2*Math.PI),v=Math.max(t.width,t.height)/t.worldSize*Math.PI;return Fn(i,h+p*(1-Math.cos(v)),Math.pow(l,10))}return i}upVector(t,i,l){return fd(i,l,t,1)}upVectorScale(t){return{metersToTile:Gp(Zp(_s(t)))}}}function y1(n){const t=n.parallels,i=!!t&&Math.abs(t[0]+t[1])<.01;switch(n.name){case"mercator":return new m1(n);case"equirectangular":return new BI(n);case"naturalEarth":return new FI(n);case"equalEarth":return new RI(n);case"winkelTripel":return new VI(n);case"albers":return i?new _1(n):new DI(n);case"lambertConformalConic":return i?new _1(n):new OI(n);case"globe":return new $I(n)}throw new Error(`Invalid projection name: ${n.name}`)}const NI=nm.types,UI=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function mm(n,t,i,l,h,p,v,y,S,T,A,P,D){const V=y?Math.min(qa,Math.round(y[0])):0,$=y?Math.min(qa,Math.round(y[1])):0;n.emplaceBack(t,i,Math.round(32*l),Math.round(32*h),p,v,(V<<1)+(S?1:0),$,16*T,16*A,256*P,256*D)}function gm(n,t,i,l,h,p,v){n.emplaceBack(t,i,l,h,p,v)}function vm(n,t,i,l,h){n.emplaceBack(t,i,l,h),n.emplaceBack(t,i,l,h),n.emplaceBack(t,i,l,h),n.emplaceBack(t,i,l,h)}function jI(n){for(const t of n.sections)if(U(t.text))return!0;return!1}class Ov{constructor(t){this.layoutVertexArray=new No,this.indexArray=new yr,this.programConfigurations=t,this.segments=new Fi,this.dynamicLayoutVertexArray=new ii,this.opacityVertexArray=new ri,this.placedSymbolArray=new x0,this.globeExtVertexArray=new pi}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,i,l,h){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,KC.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,QC.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,UI,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,JC.members,!0)),this.opacityVertexBuffer.itemSize=1),(l||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}$t(Ov,"SymbolBuffers");class Fv{constructor(t,i,l){this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new l,this.segments=new Fi,this.collisionVertexArray=new ui,this.collisionVertexArrayExt=new _r}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,eI.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,tI.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}$t(Fv,"CollisionBuffers");class Wa{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(v=>v.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=qo([]),this.placementViewportMatrix=qo([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Iv(this.zoom,i["text-size"]),this.iconSizeData=Iv(this.zoom,i["icon-size"]);const l=this.layers[0].layout,h=l.get("symbol-sort-key"),p=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=l.get("text-writing-mode").map(v=>ao[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=t.sourceID,this.projection=t.projection}createArrays(){this.text=new Ov(new Wl(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Ov(new Wl(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new S0,this.lineVertexArray=new T0,this.symbolInstances=new w0}calculateGlyphDependencies(t,i,l,h,p){for(let v=0;v<t.length;v++)if(i[t.charCodeAt(v)]=!0,h&&p){const y=Ed[t.charAt(v)];y&&(i[y.charCodeAt(0)]=!0)}}populate(t,i,l,h){const p=this.layers[0],v=p.layout,y=this.projection.name==="globe",S=v.get("text-font"),T=v.get("text-field"),A=v.get("icon-image"),P=(T.value.kind!=="constant"||T.value.value instanceof Lr&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),D=A.value.kind!=="constant"||!!A.value.value||Object.keys(A.parameters).length>0,V=v.get("symbol-sort-key");if(this.features=[],!P&&!D)return;const $=i.iconDependencies,j=i.glyphDependencies,X=i.availableImages,le=new Be(this.zoom);for(const{feature:ye,id:ie,index:ge,sourceLayerIndex:Ee}of t){const xe=p._featureFilter.needGeometry,je=Ql(ye,xe);if(!p._featureFilter.filter(le,je,l))continue;if(xe||(je.geometry=ea(ye,l,h)),y&&ye.type!==1&&l.z<=5){const We=je.geometry,it=.98078528056,ot=(dt,_t)=>yo(fd(dt.x,dt.y,l,1),fd(_t.x,_t.y,l,1))<it;for(let dt=0;dt<We.length;dt++)We[dt]=QE(We[dt],ot)}let $e,tt;if(P){const We=p.getValueAndResolveTokens("text-field",je,l,X),it=Lr.factory(We);jI(it)&&(this.hasRTLText=!0),(!this.hasRTLText||Ce()==="unavailable"||this.hasRTLText&&Ae.isParsed())&&($e=rI(it,p,je))}if(D){const We=p.getValueAndResolveTokens("icon-image",je,l,X);tt=We instanceof Cr?We:Cr.fromString(We)}if(!$e&&!tt)continue;const vt=this.sortFeaturesByKey?V.evaluate(je,{},l):void 0;if(this.features.push({id:ie,text:$e,icon:tt,index:ge,sourceLayerIndex:Ee,geometry:je.geometry,properties:ye.properties,type:NI[ye.type],sortKey:vt}),tt&&($[tt.name]=!0),$e){const We=S.evaluate(je,{},l).join(","),it=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ao.vertical)>=0;for(const ot of $e.sections)if(ot.image)$[ot.image.name]=!0;else{const dt=_($e.toString()),_t=ot.fontStack||We,Xe=j[_t]=j[_t]||{};this.calculateGlyphDependencies(ot.text,Xe,it,this.allowVerticalPlacement,dt)}}}v.get("symbol-placement")==="line"&&(this.features=function(ye){const ie={},ge={},Ee=[];let xe=0;function je(We){Ee.push(ye[We]),xe++}function $e(We,it,ot){const dt=ge[We];return delete ge[We],ge[it]=dt,Ee[dt].geometry[0].pop(),Ee[dt].geometry[0]=Ee[dt].geometry[0].concat(ot[0]),dt}function tt(We,it,ot){const dt=ie[it];return delete ie[it],ie[We]=dt,Ee[dt].geometry[0].shift(),Ee[dt].geometry[0]=ot[0].concat(Ee[dt].geometry[0]),dt}function vt(We,it,ot){const dt=ot?it[0][it[0].length-1]:it[0][0];return`${We}:${dt.x}:${dt.y}`}for(let We=0;We<ye.length;We++){const it=ye[We],ot=it.geometry,dt=it.text?it.text.toString():null;if(!dt){je(We);continue}const _t=vt(dt,ot),Xe=vt(dt,ot,!0);if(_t in ge&&Xe in ie&&ge[_t]!==ie[Xe]){const Ct=tt(_t,Xe,ot),nn=$e(_t,Xe,Ee[Ct].geometry);delete ie[_t],delete ge[Xe],ge[vt(dt,Ee[nn].geometry,!0)]=nn,Ee[Ct].geometry=null}else _t in ge?$e(_t,Xe,ot):Xe in ie?tt(_t,Xe,ot):(je(We),ie[_t]=xe-1,ge[Xe]=xe-1)}return Ee.filter(We=>We.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ye,ie)=>ye.sortKey-ie.sortKey)}update(t,i,l,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,i,this.layers,l,h),this.icon.programConfigurations.updatePaintArrays(t,i,this.layers,l,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=y1(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,i){const l=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:h,y:p}of i)this.lineVertexArray.emplaceBack(h,p);return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,i,l,h,p,v,y,S,T,A,P,D,V,$){const j=t.indexArray,X=t.layoutVertexArray,le=t.globeExtVertexArray,ye=t.segments.prepareSegment(4*i.length,X,j,this.canOverlap?v.sortKey:void 0),ie=this.glyphOffsetArray.length,ge=ye.vertexLength,Ee=this.allowVerticalPlacement&&y===ao.vertical?Math.PI/2:0,xe=v.text&&v.text.sections;for(let $e=0;$e<i.length;$e++){const{tl:tt,tr:vt,bl:We,br:it,tex:ot,pixelOffsetTL:dt,pixelOffsetBR:_t,minFontScaleX:Xe,minFontScaleY:Ct,glyphOffset:nn,isSDF:Dt,sectionIndex:qt}=i[$e],It=ye.vertexLength,sn=nn[1];if(mm(X,T.x,T.y,tt.x,sn+tt.y,ot.x,ot.y,l,Dt,dt.x,dt.y,Xe,Ct),mm(X,T.x,T.y,vt.x,sn+vt.y,ot.x+ot.w,ot.y,l,Dt,_t.x,dt.y,Xe,Ct),mm(X,T.x,T.y,We.x,sn+We.y,ot.x,ot.y+ot.h,l,Dt,dt.x,_t.y,Xe,Ct),mm(X,T.x,T.y,it.x,sn+it.y,ot.x+ot.w,ot.y+ot.h,l,Dt,_t.x,_t.y,Xe,Ct),S){const{x:Cn,y:xn,z:_n}=S.anchor,[an,Yn,hn]=S.up;gm(le,Cn,xn,_n,an,Yn,hn),gm(le,Cn,xn,_n,an,Yn,hn),gm(le,Cn,xn,_n,an,Yn,hn),gm(le,Cn,xn,_n,an,Yn,hn),vm(t.dynamicLayoutVertexArray,Cn,xn,_n,Ee)}else vm(t.dynamicLayoutVertexArray,T.x,T.y,T.z,Ee);j.emplaceBack(It,It+1,It+2),j.emplaceBack(It+1,It+2,It+3),ye.vertexLength+=4,ye.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(nn[0]),$e!==i.length-1&&qt===i[$e+1].sectionIndex||t.programConfigurations.populatePaintArrays(X.length,v,v.index,{},V,$,xe&&xe[qt])}const je=S?S.anchor:T;t.placedSymbolArray.emplaceBack(je.x,je.y,je.z,T.x,T.y,ie,this.glyphOffsetArray.length-ie,ge,A,P,T.segment,l?l[0]:0,l?l[1]:0,h[0],h[1],y,0,!1,0,D,0)}_commitLayoutVertex(t,i,l,h,p,v,y){t.emplaceBack(i,l,h,p,v,Math.round(y.x),Math.round(y.y))}_addCollisionDebugVertices(t,i,l,h,p,v,y){const S=l.segments.prepareSegment(4,l.layoutVertexArray,l.indexArray),T=S.vertexLength,A=y.tileAnchorX,P=y.tileAnchorY;for(let V=0;V<4;V++)l.collisionVertexArray.emplaceBack(0,0,0,0);l.collisionVertexArrayExt.emplaceBack(i,-t.padding,-t.padding),l.collisionVertexArrayExt.emplaceBack(i,t.padding,-t.padding),l.collisionVertexArrayExt.emplaceBack(i,t.padding,t.padding),l.collisionVertexArrayExt.emplaceBack(i,-t.padding,t.padding),this._commitLayoutVertex(l.layoutVertexArray,h,p,v,A,P,new Y(t.x1,t.y1)),this._commitLayoutVertex(l.layoutVertexArray,h,p,v,A,P,new Y(t.x2,t.y1)),this._commitLayoutVertex(l.layoutVertexArray,h,p,v,A,P,new Y(t.x2,t.y2)),this._commitLayoutVertex(l.layoutVertexArray,h,p,v,A,P,new Y(t.x1,t.y2)),S.vertexLength+=4;const D=l.indexArray;D.emplaceBack(T,T+1),D.emplaceBack(T+1,T+2),D.emplaceBack(T+2,T+3),D.emplaceBack(T+3,T),S.primitiveLength+=4}_addTextDebugCollisionBoxes(t,i,l,h,p,v){for(let y=h;y<p;y++){const S=l.get(y),T=this.getSymbolInstanceTextSize(t,v,i,y);this._addCollisionDebugVertices(S,T,this.textCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(t,i,l,h,p,v){for(let y=h;y<p;y++){const S=l.get(y),T=this.getSymbolInstanceIconSize(t,i,v.placedIconSymbolIndex);this._addCollisionDebugVertices(S,T,this.iconCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,v)}}generateCollisionDebugBuffers(t,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Fv(Ci,Nx.members,ms),this.iconCollisionBox=new Fv(Ci,Nx.members,ms);const l=Pu(this.iconSizeData,t),h=Pu(this.textSizeData,t);for(let p=0;p<this.symbolInstances.length;p++){const v=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(h,t,i,v.textBoxStartIndex,v.textBoxEndIndex,v),this._addTextDebugCollisionBoxes(h,t,i,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._addIconDebugCollisionBoxes(l,t,i,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._addIconDebugCollisionBoxes(l,t,i,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}}getSymbolInstanceTextSize(t,i,l,h){const p=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:h),v=sm(this.textSizeData,t,p)/wr;return this.tilePixelRatio*v}getSymbolInstanceIconSize(t,i,l){const h=this.icon.placedSymbolArray.get(l),p=sm(this.iconSizeData,t,h);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(t,i,l){t.emplaceBack(i,-l,-l),t.emplaceBack(i,l,-l),t.emplaceBack(i,l,l),t.emplaceBack(i,-l,l)}_updateTextDebugCollisionBoxes(t,i,l,h,p,v){for(let y=h;y<p;y++){const S=l.get(y),T=this.getSymbolInstanceTextSize(t,v,i,y);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,T,S.padding)}}_updateIconDebugCollisionBoxes(t,i,l,h,p,v){for(let y=h;y<p;y++){const S=l.get(y),T=this.getSymbolInstanceIconSize(t,i,v);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,T,S.padding)}}updateCollisionDebugBuffers(t,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const l=Pu(this.iconSizeData,t),h=Pu(this.textSizeData,t);for(let p=0;p<this.symbolInstances.length;p++){const v=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(h,t,i,v.textBoxStartIndex,v.textBoxEndIndex,v),this._updateTextDebugCollisionBoxes(h,t,i,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._updateIconDebugCollisionBoxes(l,t,i,v.iconBoxStartIndex,v.iconBoxEndIndex,v.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(l,t,i,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,i,l,h,p,v,y,S,T){const A={};if(i<l){const{x1:P,y1:D,x2:V,y2:$,padding:j,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ie,tileAnchorY:ge,featureIndex:Ee}=t.get(i);A.textBox={x1:P,y1:D,x2:V,y2:$,padding:j,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ie,tileAnchorY:ge},A.textFeatureIndex=Ee}if(h<p){const{x1:P,y1:D,x2:V,y2:$,padding:j,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ie,tileAnchorY:ge,featureIndex:Ee}=t.get(h);A.verticalTextBox={x1:P,y1:D,x2:V,y2:$,padding:j,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ie,tileAnchorY:ge},A.verticalTextFeatureIndex=Ee}if(v<y){const{x1:P,y1:D,x2:V,y2:$,padding:j,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ie,tileAnchorY:ge,featureIndex:Ee}=t.get(v);A.iconBox={x1:P,y1:D,x2:V,y2:$,padding:j,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ie,tileAnchorY:ge},A.iconFeatureIndex=Ee}if(S<T){const{x1:P,y1:D,x2:V,y2:$,padding:j,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ie,tileAnchorY:ge,featureIndex:Ee}=t.get(S);A.verticalIconBox={x1:P,y1:D,x2:V,y2:$,padding:j,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ie,tileAnchorY:ge},A.verticalIconFeatureIndex=Ee}return A}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const l=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,i){const l=t.placedSymbolArray.get(i),h=l.vertexStartIndex+4*l.numGlyphs;for(let p=l.vertexStartIndex;p<h;p+=4)t.indexArray.emplaceBack(p,p+1,p+2),t.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(t),l=Math.cos(t),h=[],p=[],v=[];for(let y=0;y<this.symbolInstances.length;++y){v.push(y);const S=this.symbolInstances.get(y);h.push(0|Math.round(i*S.tileAnchorX+l*S.tileAnchorY)),p.push(S.featureIndex)}return v.sort((y,S)=>h[y]-h[S]||p[S]-p[y]),v}addToSortKeyRanges(t,i){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===i?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const l=this.symbolInstances.get(i);this.featureSortOrder.push(l.featureIndex);const{rightJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:p,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:y,placedIconSymbolIndex:S,verticalPlacedIconSymbolIndex:T}=l;h>=0&&this.addIndicesForPlacedSymbol(this.text,h),p>=0&&p!==h&&this.addIndicesForPlacedSymbol(this.text,p),v>=0&&v!==p&&v!==h&&this.addIndicesForPlacedSymbol(this.text,v),y>=0&&this.addIndicesForPlacedSymbol(this.text,y),S>=0&&this.addIndicesForPlacedSymbol(this.icon,S),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}$t(Wa,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Wa.MAX_GLYPHS=65535,Wa.addDynamicAttributes=vm;const GI=new mt({"symbol-placement":new Le(et.layout_symbol["symbol-placement"]),"symbol-spacing":new Le(et.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Le(et.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ze(et.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Le(et.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Le(et.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Le(et.layout_symbol["icon-ignore-placement"]),"icon-optional":new Le(et.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Le(et.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ze(et.layout_symbol["icon-size"]),"icon-text-fit":new Le(et.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Le(et.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ze(et.layout_symbol["icon-image"]),"icon-rotate":new Ze(et.layout_symbol["icon-rotate"]),"icon-padding":new Le(et.layout_symbol["icon-padding"]),"icon-keep-upright":new Le(et.layout_symbol["icon-keep-upright"]),"icon-offset":new Ze(et.layout_symbol["icon-offset"]),"icon-anchor":new Ze(et.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Le(et.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Le(et.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Le(et.layout_symbol["text-rotation-alignment"]),"text-field":new Ze(et.layout_symbol["text-field"]),"text-font":new Ze(et.layout_symbol["text-font"]),"text-size":new Ze(et.layout_symbol["text-size"]),"text-max-width":new Ze(et.layout_symbol["text-max-width"]),"text-line-height":new Ze(et.layout_symbol["text-line-height"]),"text-letter-spacing":new Ze(et.layout_symbol["text-letter-spacing"]),"text-justify":new Ze(et.layout_symbol["text-justify"]),"text-radial-offset":new Ze(et.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Le(et.layout_symbol["text-variable-anchor"]),"text-anchor":new Ze(et.layout_symbol["text-anchor"]),"text-max-angle":new Le(et.layout_symbol["text-max-angle"]),"text-writing-mode":new Le(et.layout_symbol["text-writing-mode"]),"text-rotate":new Ze(et.layout_symbol["text-rotate"]),"text-padding":new Le(et.layout_symbol["text-padding"]),"text-keep-upright":new Le(et.layout_symbol["text-keep-upright"]),"text-transform":new Ze(et.layout_symbol["text-transform"]),"text-offset":new Ze(et.layout_symbol["text-offset"]),"text-allow-overlap":new Le(et.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Le(et.layout_symbol["text-ignore-placement"]),"text-optional":new Le(et.layout_symbol["text-optional"])});var Vv={paint:new mt({"icon-opacity":new Ze(et.paint_symbol["icon-opacity"]),"icon-color":new Ze(et.paint_symbol["icon-color"]),"icon-halo-color":new Ze(et.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ze(et.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ze(et.paint_symbol["icon-halo-blur"]),"icon-translate":new Le(et.paint_symbol["icon-translate"]),"icon-translate-anchor":new Le(et.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ze(et.paint_symbol["text-opacity"]),"text-color":new Ze(et.paint_symbol["text-color"],{runtimeType:go,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new Ze(et.paint_symbol["text-halo-color"]),"text-halo-width":new Ze(et.paint_symbol["text-halo-width"]),"text-halo-blur":new Ze(et.paint_symbol["text-halo-blur"]),"text-translate":new Le(et.paint_symbol["text-translate"]),"text-translate-anchor":new Le(et.paint_symbol["text-translate-anchor"])}),layout:GI};class x1{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:ba,this.defaultValue=t}evaluate(t){if(t.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(t.formattedSection))return i.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}$t(x1,"FormatSectionOverride",{omit:["defaultValue"]});class _m extends Go{constructor(t){super(t,Vv)}recalculate(t,i){super.recalculate(t,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const l=this.layout.get("text-writing-mode");if(l){const h=[];for(const p of l)h.indexOf(p)<0&&h.push(p);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,i,l,h){const p=this.layout.get(t).evaluate(i,{},l,h),v=this._unevaluatedLayout._values[t];return v.isDataDriven()||La(v.value)||!p?p:function(y,S){return S.replace(/{([^{}]+)}/g,(T,A)=>A in y?String(y[A]):"")}(i.properties,p)}createBucket(t){return new Wa(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of Vv.paint.overridableProperties){if(!_m.hasPaintOverride(this.layout,t))continue;const i=this.paint.get(t),l=new x1(i),h=new su(l,i.property.specification);let p=null;p=i.value.kind==="constant"||i.value.kind==="source"?new au("source",h):new Xs("composite",h,i.value.zoomStops,i.value._interpolationType),this.paint._values[t]=new ht(i.property,p,i.parameters)}}_handleOverridablePaintPropertyUpdate(t,i,l){return!(!this.layout||i.isDataDriven()||l.isDataDriven())&&_m.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,i){const l=t.get("text-field"),h=Vv.paint.properties[i];let p=!1;const v=y=>{for(const S of y)if(h.overrides&&h.overrides.hasOverride(S))return void(p=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Lr)v(l.value.value.sections);else if(l.value.kind==="source"){const y=T=>{p||(T instanceof xl&&qi(T.value)===wa?v(T.value.sections):T instanceof bl?v(T.sections):T.eachChild(y))},S=l.value;S._styleExpression&&y(S._styleExpression.expression)}return p}getProgramConfiguration(t){return new ja(this,t)}}var qI={paint:new mt({"background-color":new Le(et.paint_background["background-color"]),"background-pattern":new Le(et.paint_background["background-pattern"]),"background-opacity":new Le(et.paint_background["background-opacity"])})},ZI={paint:new mt({"raster-opacity":new Le(et.paint_raster["raster-opacity"]),"raster-hue-rotate":new Le(et.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Le(et.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Le(et.paint_raster["raster-brightness-max"]),"raster-saturation":new Le(et.paint_raster["raster-saturation"]),"raster-contrast":new Le(et.paint_raster["raster-contrast"]),"raster-resampling":new Le(et.paint_raster["raster-resampling"]),"raster-fade-duration":new Le(et.paint_raster["raster-fade-duration"])})};class WI extends Go{constructor(t){super(t,{}),this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var HI={paint:new mt({"sky-type":new Le(et.paint_sky["sky-type"]),"sky-atmosphere-sun":new Le(et.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Le(et.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Le(et.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Le(et.paint_sky["sky-gradient-radius"]),"sky-gradient":new lt(et.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Le(et.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Le(et.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Le(et.paint_sky["sky-opacity"])})};function $v(n,t,i){const l=[0,0,1],h=j0([]);return q0(h,h,i?-Se(n)+Math.PI:Se(n)),G0(h,h,-Se(t)),V0(l,l,h),Rr(l,l)}const XI={circle:class extends Go{constructor(n){super(n,sC)}createBucket(n){return new mv(n)}queryRadius(n){const t=n;return Cu("circle-radius",this,t)+Cu("circle-stroke-width",this,t)+Xp(this.paint.get("circle-translate"))}queryIntersectsFeature(n,t,i,l,h,p,v,y){const S=dx(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,n.pixelToTileUnitsFactor),T=this.paint.get("circle-radius").evaluate(t,i)+this.paint.get("circle-stroke-width").evaluate(t,i);return fx(n,l,p,v,y,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",S,T)}getProgramIds(){return["circle"]}getProgramConfiguration(n){return new ja(this,n)}},heatmap:class extends Go{createBucket(n){return new mx(n)}constructor(n){super(n,uC),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=yv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(n){return Cu("heatmap-radius",this,n)}queryIntersectsFeature(n,t,i,l,h,p,v,y){const S=this.paint.get("heatmap-radius").evaluate(t,i);return fx(n,l,p,v,y,!0,!0,new Y(0,0),S)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(n){return new ja(this,n)}},hillshade:class extends Go{constructor(n){super(n,hC)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Go{constructor(n){super(n,IC)}getProgramIds(){const n=this.paint.get("fill-pattern"),t=n&&n.constantOr(1),i=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(n){return new ja(this,n)}recalculate(n,t){super.recalculate(n,t);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new em(n)}queryRadius(){return Xp(this.paint.get("fill-translate"))}queryIntersectsFeature(n,t,i,l,h,p){return!n.queryGeometry.isAboveHorizon&&ax(hx(n.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,n.pixelToTileUnitsFactor),l)}isTileClipped(){return!0}},"fill-extrusion":class extends Go{constructor(n){super(n,jC)}createBucket(n){return new wd(n)}queryRadius(){return Xp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(n){return new ja(this,n)}queryIntersectsFeature(n,t,i,l,h,p,v,y,S){const T=dx(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,n.pixelToTileUnitsFactor),A=this.paint.get("fill-extrusion-height").evaluate(t,i),P=this.paint.get("fill-extrusion-base").evaluate(t,i),D=[0,0],V=y&&p.elevation,$=p.elevation?p.elevation.exaggeration():1,j=n.tile.getBucket(this);if(V&&j instanceof wd){const ge=j.centroidVertexArray,Ee=S+1;Ee<ge.length&&(D[0]=ge.geta_centroid_pos0(Ee),D[1]=ge.geta_centroid_pos1(Ee))}if(D[0]===0&&D[1]===1)return!1;p.projection.name==="globe"&&(l=Lx([l],[new Y(0,0),new Y(un,un)],n.tileID.canonical).map(ge=>ge.polygon).flat());const X=V?y:null,[le,ye]=function(ge,Ee,xe,je,$e,tt,vt,We,it,ot,dt){return ge.projection.name==="globe"?function(_t,Xe,Ct,nn,Dt,qt,It,sn,Cn,xn,_n){const an=[],Yn=[],hn=_t.projection.upVectorScale(_n,_t.center.lat,_t.worldSize).metersToTile,In=[0,0,0,1],ti=[0,0,0,1],hi=(di,mi,Ii,lr)=>{di[0]=mi,di[1]=Ii,di[2]=lr,di[3]=1},ci=zx();Ct>0&&(Ct+=ci),nn+=ci;for(const di of Xe){const mi=[],Ii=[];for(const lr of di){const Kn=lr.x+Dt.x,Zi=lr.y+Dt.y,$i=_t.projection.projectTilePoint(Kn,Zi,_n),Nn=_t.projection.upVector(_n,lr.x,lr.y);let _i=Ct,Ji=nn;if(It){const ni=Ox(Kn,Zi,Ct,nn,It,sn,Cn,xn);_i+=ni.base,Ji+=ni.top}Ct!==0?hi(In,$i.x+Nn[0]*hn*_i,$i.y+Nn[1]*hn*_i,$i.z+Nn[2]*hn*_i):hi(In,$i.x,$i.y,$i.z),hi(ti,$i.x+Nn[0]*hn*Ji,$i.y+Nn[1]*hn*Ji,$i.z+Nn[2]*hn*Ji),Di(In,In,qt),Di(ti,ti,qt),mi.push(new Mu(In[0],In[1],In[2])),Ii.push(new Mu(ti[0],ti[1],ti[2]))}an.push(mi),Yn.push(Ii)}return[an,Yn]}(ge,Ee,xe,je,$e,tt,vt,We,it,ot,dt):vt?function(_t,Xe,Ct,nn,Dt,qt,It,sn,Cn){const xn=[],_n=[],an=[0,0,0,1];for(const Yn of _t){const hn=[],In=[];for(const ti of Yn){const hi=ti.x+nn.x,ci=ti.y+nn.y,di=Ox(hi,ci,Xe,Ct,qt,It,sn,Cn);an[0]=hi,an[1]=ci,an[2]=di.base,an[3]=1,Yl(an,an,Dt),an[3]=Math.max(an[3],1e-5);const mi=new Mu(an[0]/an[3],an[1]/an[3],an[2]/an[3]);an[0]=hi,an[1]=ci,an[2]=di.top,an[3]=1,Yl(an,an,Dt),an[3]=Math.max(an[3],1e-5);const Ii=new Mu(an[0]/an[3],an[1]/an[3],an[2]/an[3]);hn.push(mi),In.push(Ii)}xn.push(hn),_n.push(In)}return[xn,_n]}(Ee,xe,je,$e,tt,vt,We,it,ot):function(_t,Xe,Ct,nn,Dt){const qt=[],It=[],sn=Dt[8]*Xe,Cn=Dt[9]*Xe,xn=Dt[10]*Xe,_n=Dt[11]*Xe,an=Dt[8]*Ct,Yn=Dt[9]*Ct,hn=Dt[10]*Ct,In=Dt[11]*Ct;for(const ti of _t){const hi=[],ci=[];for(const di of ti){const mi=di.x+nn.x,Ii=di.y+nn.y,lr=Dt[0]*mi+Dt[4]*Ii+Dt[12],Kn=Dt[1]*mi+Dt[5]*Ii+Dt[13],Zi=Dt[2]*mi+Dt[6]*Ii+Dt[14],$i=Dt[3]*mi+Dt[7]*Ii+Dt[15],Nn=lr+sn,_i=Kn+Cn,Ji=Zi+xn,ni=Math.max($i+_n,1e-5),Ri=lr+an,Ir=Kn+Yn,cr=Zi+hn,ur=Math.max($i+In,1e-5);hi.push(new Mu(Nn/ni,_i/ni,Ji/ni)),ci.push(new Mu(Ri/ur,Ir/ur,cr/ur))}qt.push(hi),It.push(ci)}return[qt,It]}(Ee,xe,je,$e,tt)}(p,l,P,A,T,v,X,D,$,p.center.lat,n.tileID.canonical),ie=n.queryGeometry;return function(ge,Ee,xe){let je=1/0;ax(xe,Ee)&&(je=Bx(xe,Ee[0]));for(let $e=0;$e<Ee.length;$e++){const tt=Ee[$e],vt=ge[$e];for(let We=0;We<tt.length-1;We++){const it=tt[We],ot=[it,tt[We+1],vt[We+1],vt[We],it];sx(xe,ot)&&(je=Math.min(je,Bx(xe,ot)))}}return je!==1/0&&je}(le,ye,ie.isPointQuery()?ie.screenBounds:ie.screenGeometry)}},line:class extends Go{constructor(n){super(n,Fx),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Ah,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(n,t){super.recalculate(n,t),this.paint._values["line-floorwidth"]=Vx.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new om(n)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(n){return new ja(this,n)}queryRadius(n){const t=n,i=$x(Cu("line-width",this,t),Cu("line-gap-width",this,t)),l=Cu("line-offset",this,t);return i/2+Math.abs(l)+Xp(this.paint.get("line-translate"))}queryIntersectsFeature(n,t,i,l,h,p){if(n.queryGeometry.isAboveHorizon)return!1;const v=hx(n.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,n.pixelToTileUnitsFactor),y=n.pixelToTileUnitsFactor/2*$x(this.paint.get("line-width").evaluate(t,i),this.paint.get("line-gap-width").evaluate(t,i)),S=this.paint.get("line-offset").evaluate(t,i);return S&&(l=function(T,A){const P=[],D=new Y(0,0);for(let V=0;V<T.length;V++){const $=T[V],j=[];for(let X=0;X<$.length;X++){const le=$[X-1],ye=$[X],ie=$[X+1],ge=X===0?D:ye.sub(le)._unit()._perp(),Ee=X===$.length-1?D:ie.sub(ye)._unit()._perp(),xe=ge._add(Ee)._unit();xe._mult(1/(xe.x*Ee.x+xe.y*Ee.y)),j.push(xe._mult(A)._add(ye))}P.push(j)}return P}(l,S*n.pixelToTileUnitsFactor)),function(T,A,P){for(let D=0;D<A.length;D++){const V=A[D];if(T.length>=3){for(let $=0;$<V.length;$++)if(ec(T,V[$]))return!0}if(nC(T,V,P))return!0}return!1}(v,l,y)}isTileClipped(){return!0}},symbol:_m,background:class extends Go{constructor(n){super(n,qI)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Go{constructor(n){super(n,ZI)}getProgramIds(){return["raster"]}},sky:class extends Go{constructor(n){super(n,HI),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="sky-gradient"?this._updateColorRamp():n!=="sky-atmosphere-sun"&&n!=="sky-atmosphere-halo-color"&&n!=="sky-atmosphere-color"&&n!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=yv({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(n){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=n.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(n,t){if(this.paint.get("sky-type")==="atmosphere"){const l=this.paint.get("sky-atmosphere-sun"),h=!l,p=n.style.light,v=p.properties.get("position");return h&&p.properties.get("anchor")==="viewport"&&ue("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?$v(v.azimuthal,90-v.polar,t):$v(l[0],90-l[1],t)}const i=this.paint.get("sky-gradient-center");return $v(i[0],90-i[1],t)}is3D(){return!1}isSky(){return!0}markSkyboxValid(n){this._skyboxInvalidated=!1,this._lightPosition=n.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const n=this.paint.get("sky-type");return n==="atmosphere"?["skyboxCapture","skybox"]:n==="gradient"?["skyboxGradient"]:null}}};class Ld{constructor(t,i,l,h){this.context=t,this.format=l,this.texture=t.gl.createTexture(),this.update(i,h)}update(t,i,l){const{width:h,height:p}=t,{context:v}=this,{gl:y}=v,{HTMLImageElement:S,HTMLCanvasElement:T,HTMLVideoElement:A,ImageData:P,ImageBitmap:D}=w;if(y.bindTexture(y.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA&&(!i||i.premultiply!==!1)),l||this.size&&this.size[0]===h&&this.size[1]===p){const{x:V,y:$}=l||{x:0,y:0};t instanceof S||t instanceof T||t instanceof A||t instanceof P||D&&t instanceof D?y.texSubImage2D(y.TEXTURE_2D,0,V,$,y.RGBA,y.UNSIGNED_BYTE,t):y.texSubImage2D(y.TEXTURE_2D,0,V,$,h,p,y.RGBA,y.UNSIGNED_BYTE,t.data)}else this.size=[h,p],t instanceof S||t instanceof T||t instanceof A||t instanceof P||D&&t instanceof D?y.texImage2D(y.TEXTURE_2D,0,this.format,this.format,y.UNSIGNED_BYTE,t):y.texImage2D(y.TEXTURE_2D,0,this.format,h,p,0,this.format,y.UNSIGNED_BYTE,t.data);this.useMipmap=Boolean(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(t,i){const{context:l}=this,{gl:h}=l;h.bindTexture(h.TEXTURE_2D,this.texture),t!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,t),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?t===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:t),this.filter=t),i!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,i),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class YI{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class KI{constructor(){this.tasks={},this.taskQueue=[],xt(["process"],this),this.invoker=new YI(this.process),this.nextId=0}add(t,i){const l=this.nextId++,h=function({type:p,isSymbolTile:v,zoom:y}){return y=y||0,p==="message"?0:p!=="maybePrepare"||v?p!=="parseTile"||v?p==="parseTile"&&v?300-y:p==="maybePrepare"&&v?400-y:500:200-y:100-y}(i);if(h===0){st();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[l]={fn:t,metadata:i,priority:h,id:l},this.taskQueue.push(l),this.invoker.trigger(),{cancel:()=>{delete this.tasks[l]}}}process(){st();try{if(this.taskQueue=this.taskQueue.filter(l=>!!this.tasks[l]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const i=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let t=null,i=1/0;for(let h=0;h<this.taskQueue.length;h++){const p=this.tasks[this.taskQueue[h]];p.priority<i&&(i=p.priority,t=h)}if(t===null)return null;const l=this.taskQueue[t];return this.taskQueue.splice(t,1),l}remove(){this.invoker.remove()}}class b1{constructor(t){this._stringToNumber={},this._numberToString=[];for(let i=0;i<t.length;i++){const l=t[i];this._stringToNumber[l]=i,this._numberToString[i]=l}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const JI=["tile","layer","source","sourceLayer","state"];class w1{constructor(t,i,l,h,p){this.type="Feature",this._vectorTileFeature=t,this._z=i,this._x=l,this._y=h,this.properties=t.properties,this.id=p}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const i of JI)this[i]!==void 0&&(t[i]=this[i]);return t}}const wo=32,ws=33,Ha=new Uint16Array(8184);for(let n=0;n<2046;n++){let t=n+2,i=0,l=0,h=0,p=0,v=0,y=0;for(1&t?h=p=v=wo:i=l=y=wo;(t>>=1)>1;){const T=i+h>>1,A=l+p>>1;1&t?(h=i,p=l,i=v,l=y):(i=h,l=p,h=v,p=y),v=T,y=A}const S=4*n;Ha[S+0]=i,Ha[S+1]=l,Ha[S+2]=h,Ha[S+3]=p}const Ss=new Uint16Array(2178),Xa=new Uint8Array(1089),ym=new Uint16Array(1089);function S1(n){return n===0?-.03125:n===32?.03125:0}var T1=Ht([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const E1={type:2,extent:un,loadGeometry:()=>[[new Y(0,0),new Y(8193,0),new Y(8193,8193),new Y(0,8193),new Y(0,0)]]};class Nv{constructor(t,i,l,h,p){this.tileID=t,this.uid=Gt(),this.uses=0,this.tileSize=i,this.tileZoom=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=p,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(t){const i=t+this.timeAdded;i<Gn.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=nc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,i,l){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(h,p){const v={};if(!p)return v;for(const y of h){const S=y.layerIds.map(T=>p.getLayer(T)).filter(Boolean);if(S.length!==0){y.layers=S,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(T=>S.filter(A=>A.id===T)[0]));for(const T of S)v[T.id]=y}}return v}(t.buckets,i.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const p=this.buckets[h];if(p instanceof Wa){if(this.hasSymbolBuckets=!0,!l)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const p=this.buckets[h];if(p instanceof Wa&&p.hasRTLText){this.hasRTLText=!0,Ae.isLoading()||Ae.isLoaded()||Ce()!=="deferred"||we();break}}this.queryPadding=0;for(const h in this.buckets){const p=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(h).queryRadius(p))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas)}else this.collisionBoxArray=new Hg}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.id]}upload(t){for(const l in this.buckets){const h=this.buckets[l];h.uploadPending()&&h.upload(t)}const i=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ld(t,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ld(t,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Ld(t,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,i,l,h,p,v,y,S){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:y,transform:v,params:p,tileTransform:this.tileTransform},t,i,l):{}}querySourceFeatures(t,i){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const h=l.loadVTLayers(),p=i?i.sourceLayer:"",v=h._geojsonTileLayer||h[p];if(!v)return;const y=cu(i&&i.filter),{z:S,x:T,y:A}=this.tileID.canonical,P={z:S,x:T,y:A};for(let D=0;D<v.length;D++){const V=v.feature(D);if(y.needGeometry){const X=Ql(V,!0);if(!y.filter(new Be(this.tileID.overscaledZ),X,this.tileID.canonical))continue}else if(!y.filter(new Be(this.tileID.overscaledZ),V))continue;const $=l.getId(V,p),j=new w1(V,S,T,A,$);j.tile=P,t.push(j)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const i=this.expirationTime;if(t.cacheControl){const l=yt(t.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const l=Date.now();let h=!1;if(this.expirationTime>l)h=!1;else if(i)if(this.expirationTime<i)h=!0;else{const p=this.expirationTime-i;p?this.expirationTime=l+Math.max(p,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0||!i)return;const l=this.latestFeatureIndex.loadVTLayers(),h=i.style.listImages();for(const p in this.buckets){if(!i.style.hasLayer(p))continue;const v=this.buckets[p],y=v.layers[0].sourceLayer||"_geojsonTileLayer",S=l[y],T=t[y];if(!S||!T||Object.keys(T).length===0)continue;if(v.update(T,S,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),v instanceof om||v instanceof em){const P=i.style._getSourceCache(v.layers[0].source);i._terrain&&i._terrain.enabled&&P&&v.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(P.id,this.tileID)}const A=i&&i.style&&i.style.getLayer(p);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Gn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Gn.now()+t}setTexture(t,i){const l=i.context,h=l.gl;this.texture=this.texture||i.getTileTexture(t.width),this.texture?this.texture.update(t,{useMipmap:!0}):(this.texture=new Ld(l,t,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),l.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax))}setDependencies(t,i){const l={};for(const h of i)l[h]=!0;this.dependencies[t]=l}hasDependency(t,i){for(const l of t){const h=this.dependencies[l];if(h){for(const p of i)if(h[p])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,i){if(!i||i.name==="mercator"||this._tileDebugBuffer)return;const l=ea(E1,this.tileID.canonical,this.tileTransform)[0],h=new Qt,p=new gs;for(let v=0;v<l.length;v++){const{x:y,y:S}=l[v];h.emplaceBack(y,S),p.emplaceBack(v)}p.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(p),this._tileDebugBuffer=t.createVertexBuffer(h,hd.members),this._tileDebugSegments=Fi.simpleSegment(0,0,h.length,p.length)}_makeTileBoundsBuffers(t,i){if(this._tileBoundsBuffer||!i||i.name==="mercator")return;const l=ea(E1,this.tileID.canonical,this.tileTransform)[0];let h,p;if(this.isRaster){const v=function(y,S){const T=nc(y,S),A=Math.pow(2,y.z);for(let X=0;X<ws;X++)for(let le=0;le<ws;le++){const ye=so((y.x+(le+S1(le))/wo)/A),ie=xr((y.y+(X+S1(X))/wo)/A),ge=S.project(ye,ie),Ee=X*ws+le;Ss[2*Ee+0]=Math.round((ge.x*T.scale-T.x)*un),Ss[2*Ee+1]=Math.round((ge.y*T.scale-T.y)*un)}Xa.fill(0),ym.fill(0);for(let X=2045;X>=0;X--){const le=4*X,ye=Ha[le+0],ie=Ha[le+1],ge=Ha[le+2],Ee=Ha[le+3],xe=ye+ge>>1,je=ie+Ee>>1,$e=xe+je-ie,tt=je+ye-xe,vt=ie*ws+ye,We=Ee*ws+ge,it=je*ws+xe,ot=Math.hypot((Ss[2*vt+0]+Ss[2*We+0])/2-Ss[2*it+0],(Ss[2*vt+1]+Ss[2*We+1])/2-Ss[2*it+1])>=16;if(Xa[it]=Xa[it]||(ot?1:0),X<1022){const dt=(ie+tt>>1)*ws+(ye+$e>>1),_t=(Ee+tt>>1)*ws+(ge+$e>>1);Xa[it]=Xa[it]||Xa[dt]||Xa[_t]}}const P=new ei,D=new yr;let V=0;function $(X,le){const ye=le*ws+X;return ym[ye]===0&&(P.emplaceBack(Ss[2*ye+0],Ss[2*ye+1],X*un/wo,le*un/wo),ym[ye]=++V),ym[ye]-1}function j(X,le,ye,ie,ge,Ee){const xe=X+ye>>1,je=le+ie>>1;if(Math.abs(X-ge)+Math.abs(le-Ee)>1&&Xa[je*ws+xe])j(ge,Ee,X,le,xe,je),j(ye,ie,ge,Ee,xe,je);else{const $e=$(X,le),tt=$(ye,ie),vt=$(ge,Ee);D.emplaceBack($e,tt,vt)}}return j(0,0,wo,wo,wo,0),j(wo,wo,0,0,0,wo),{vertices:P,indices:D}}(this.tileID.canonical,i);h=v.vertices,p=v.indices}else{h=new ei,p=new yr;for(const{x:y,y:S}of l)h.emplaceBack(y,S,0,0);const v=Iu(h.int16,void 0,4);for(let y=0;y<v.length;y+=3)p.emplaceBack(v[y],v[y+1],v[y+2])}this._tileBoundsBuffer=t.createVertexBuffer(h,T1.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(p),this._tileBoundsSegments=Fi.simpleSegment(0,0,h.length,p.length)}_makeGlobeTileDebugBuffers(t,i){const l=i.projection;if(!l||l.name!=="globe"||i.freezeTileCoverage)return;const h=this.tileID.canonical,p=pd(X0(h,i)),v=Tu(i.zoom);let y;v>0&&(y=Qg(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,h,i,p,y,v),this._makeGlobeTileDebugTextBuffer(t,h,i,p,y,v)}_globePoint(t,i,l,h,p,v,y){let S=fd(t,i,l);if(v){const T=1<<l.z,A=ys(h.center.lng),P=xs(h.center.lat),D=(l.x+.5)/T-A;let V=0;D>.5?V=-1:D<-.5&&(V=1);let $=(t/un+l.x)/T+V,j=(i/un+l.y)/T;$=($-A)*h._pixelsPerMercatorPixel+A,j=(j-P)*h._pixelsPerMercatorPixel+P;const X=[$*h.worldSize,j*h.worldSize,0];Di(X,X,v),S=Jl(S,X,y)}return Di(S,S,p)}_makeGlobeTileDebugBorderBuffer(t,i,l,h,p,v){const y=new Qt,S=new gs,T=new Zn,A=(D,V,$,j,X)=>{const le=($-D)/(X-1),ye=(j-V)/(X-1),ie=y.length;for(let ge=0;ge<X;ge++){const Ee=D+ge*le,xe=V+ge*ye;y.emplaceBack(Ee,xe);const je=this._globePoint(Ee,xe,i,l,h,p,v);T.emplaceBack(je[0],je[1],je[2]),S.emplaceBack(ie+ge)}},P=un;A(0,0,P,0,16),A(P,0,P,P,16),A(P,P,0,P,16),A(0,P,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(S),this._tileDebugBuffer=t.createVertexBuffer(y,hd.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(T,W0.members),this._tileDebugSegments=Fi.simpleSegment(0,0,y.length,S.length)}_makeGlobeTileDebugTextBuffer(t,i,l,h,p,v){const y=new Qt,S=new yr,T=new Zn,A=25;S.reserve(32),y.reserve(A),T.reserve(A);const P=(D,V)=>A*D+V;for(let D=0;D<A;D++){const V=2048*D;for(let $=0;$<A;$++){const j=2048*$;y.emplaceBack(j,V);const X=this._globePoint(j,V,i,l,h,p,v);T.emplaceBack(X[0],X[1],X[2])}}for(let D=0;D<4;D++)for(let V=0;V<4;V++){const $=P(D,V),j=P(D,V+1),X=P(D+1,V),le=P(D+1,V+1);S.emplaceBack($,j,X),S.emplaceBack(X,j,le)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(S),this._tileDebugTextBuffer=t.createVertexBuffer(y,hd.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(T,W0.members),this._tileDebugTextSegments=Fi.simpleSegment(0,0,A,32)}}class QI{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,i,l){const h=String(i);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][h]=this.stateChanges[t][h]||{},pt(this.stateChanges[t][h],l),this.deletedStates[t]===null){this.deletedStates[t]={};for(const p in this.state[t])p!==h&&(this.deletedStates[t][p]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][h]===null){this.deletedStates[t][h]={};for(const p in this.state[t][h])l[p]||(this.deletedStates[t][h][p]=null)}else for(const p in l)this.deletedStates[t]&&this.deletedStates[t][h]&&this.deletedStates[t][h][p]===null&&delete this.deletedStates[t][h][p]}removeFeatureState(t,i,l){if(this.deletedStates[t]===null)return;const h=String(i);if(this.deletedStates[t]=this.deletedStates[t]||{},l&&i!==void 0)this.deletedStates[t][h]!==null&&(this.deletedStates[t][h]=this.deletedStates[t][h]||{},this.deletedStates[t][h][l]=null);else if(i!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][h])for(l in this.deletedStates[t][h]={},this.stateChanges[t][h])this.deletedStates[t][h][l]=null;else this.deletedStates[t][h]=null;else this.deletedStates[t]=null}getState(t,i){const l=String(i),h=pt({},(this.state[t]||{})[l],(this.stateChanges[t]||{})[l]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const p=this.deletedStates[t][i];if(p===null)return{};for(const v in p)delete h[v]}return h}initializeTileState(t,i){t.setFeatureState(this.state,i)}coalesceChanges(t,i){const l={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const p={};for(const v in this.stateChanges[h])this.state[h][v]||(this.state[h][v]={}),pt(this.state[h][v],this.stateChanges[h][v]),p[v]=this.state[h][v];l[h]=p}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const p={};if(this.deletedStates[h]===null)for(const v in this.state[h])p[v]={},this.state[h][v]={};else for(const v in this.deletedStates[h]){if(this.deletedStates[h][v]===null)this.state[h][v]={};else if(this.state[h][v])for(const y of Object.keys(this.deletedStates[h][v]))delete this.state[h][v][y];p[v]=this.state[h][v]}l[h]=l[h]||{},pt(l[h],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const h in t)t[h].setFeatureState(l,i)}}class C1{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,i){const l=this.toIdx(t,i);return{min:this.minimums[l],max:this.maximums[l]}}isLeaf(t,i){return this.leaves[this.toIdx(t,i)]}toIdx(t,i){return i*this.size+t}}function I1(n,t,i,l){let h=0,p=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(l[v])<1e-15){if(i[v]<n[v]||i[v]>t[v])return null}else{const y=1/l[v];let S=(n[v]-i[v])*y,T=(t[v]-i[v])*y;if(S>T){const A=S;S=T,T=A}if(S>h&&(h=S),T<p&&(p=T),h>p)return null}return h}function A1(n,t,i,l,h,p,v,y,S,T,A){const P=l-n,D=h-t,V=p-i,$=v-n,j=y-t,X=S-i,le=A[1]*X-A[2]*j,ye=A[2]*$-A[0]*X,ie=A[0]*j-A[1]*$,ge=P*le+D*ye+V*ie;if(Math.abs(ge)<1e-15)return null;const Ee=1/ge,xe=T[0]-n,je=T[1]-t,$e=T[2]-i,tt=(xe*le+je*ye+$e*ie)*Ee;if(tt<0||tt>1)return null;const vt=je*V-$e*D,We=$e*P-xe*V,it=xe*D-je*P,ot=(A[0]*vt+A[1]*We+A[2]*it)*Ee;return ot<0||tt+ot>1?null:($*vt+j*We+X*it)*Ee}function k1(n,t,i){return(n-t)/(i-t)}function M1(n,t,i,l,h,p,v,y,S){const T=1<<i,A=p-l,P=v-h,D=(n+1)/T*A+l,V=(t+0)/T*P+h,$=(t+1)/T*P+h;y[0]=(n+0)/T*A+l,y[1]=V,S[0]=D,S[1]=$}class P1{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(p){const v=Math.ceil(Math.log2(p.dim/8)),y=[];let S=Math.ceil(Math.pow(2,v));const T=1/S,A=(V,$,j,X,le)=>{const ye=X?1:0,ie=(V+1)*j-ye,ge=$*j,Ee=($+1)*j-ye;le[0]=V*j,le[1]=ge,le[2]=ie,le[3]=Ee};let P=new C1(S);const D=[];for(let V=0;V<S*S;V++){A(V%S,Math.floor(V/S),T,!1,D);const $=Ya(D[0],D[1],p),j=Ya(D[2],D[1],p),X=Ya(D[2],D[3],p),le=Ya(D[0],D[3],p);P.minimums.push(Math.min($,j,X,le)),P.maximums.push(Math.max($,j,X,le)),P.leaves.push(1)}for(y.push(P),S/=2;S>=1;S/=2){const V=y[y.length-1];P=new C1(S);for(let $=0;$<S*S;$++){A($%S,Math.floor($/S),2,!0,D);const j=V.getElevation(D[0],D[1]),X=V.getElevation(D[2],D[1]),le=V.getElevation(D[2],D[3]),ye=V.getElevation(D[0],D[3]),ie=V.isLeaf(D[0],D[1]),ge=V.isLeaf(D[2],D[1]),Ee=V.isLeaf(D[2],D[3]),xe=V.isLeaf(D[0],D[3]),je=Math.min(j.min,X.min,le.min,ye.min),$e=Math.max(j.max,X.max,le.max,ye.max),tt=ie&&ge&&Ee&&xe;P.maximums.push($e),P.minimums.push(je),P.leaves.push($e-je<=5&&tt?1:0)}y.push(P)}return y}(this.dem),l=i.length-1,h=i[l];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(i,0,0,l,0)}raycastRoot(t,i,l,h,p,v,y=1){return I1([t,i,-100],[l,h,this.maximums[0]*y],p,v)}raycast(t,i,l,h,p,v,y=1){if(!this.nodeCount)return null;const S=this.raycastRoot(t,i,l,h,p,v,y);if(S==null)return null;const T=[],A=[],P=[],D=[],V=[{idx:0,t:S,nodex:0,nodey:0,depth:0}];for(;V.length>0;){const{idx:$,t:j,nodex:X,nodey:le,depth:ye}=V.pop();if(this.leaves[$]){M1(X,le,ye,t,i,l,h,P,D);const ge=1<<ye,Ee=(X+0)/ge,xe=(X+1)/ge,je=(le+0)/ge,$e=(le+1)/ge,tt=Ya(Ee,je,this.dem)*y,vt=Ya(xe,je,this.dem)*y,We=Ya(xe,$e,this.dem)*y,it=Ya(Ee,$e,this.dem)*y,ot=A1(P[0],P[1],tt,D[0],P[1],vt,D[0],D[1],We,p,v),dt=A1(D[0],D[1],We,P[0],D[1],it,P[0],P[1],tt,p,v),_t=Math.min(ot!==null?ot:Number.MAX_VALUE,dt!==null?dt:Number.MAX_VALUE);if(_t!==Number.MAX_VALUE)return _t;{const Xe=cd([],p,v,j);if(z1(tt,vt,it,We,k1(Xe[0],P[0],D[0]),k1(Xe[1],P[1],D[1]))>=Xe[2])return j}continue}let ie=0;for(let ge=0;ge<this._siblingOffset.length;ge++){M1((X<<1)+this._siblingOffset[ge][0],(le<<1)+this._siblingOffset[ge][1],ye+1,t,i,l,h,P,D),P[2]=-100,D[2]=this.maximums[this.childOffsets[$]+ge]*y;const Ee=I1(P,D,p,v);if(Ee!=null){const xe=Ee;T[ge]=xe;let je=!1;for(let $e=0;$e<ie&&!je;$e++)xe>=T[A[$e]]&&(A.splice($e,0,ge),je=!0);je||(A[ie]=ge),ie++}}for(let ge=0;ge<ie;ge++){const Ee=A[ge];V.push({idx:this.childOffsets[$]+Ee,t:T[Ee],nodex:(X<<1)+this._siblingOffset[Ee][0],nodey:(le<<1)+this._siblingOffset[Ee][1],depth:ye+1})}}return null}_addNode(t,i,l){return this.minimums.push(t),this.maximums.push(i),this.leaves.push(l),this.childOffsets.push(0),this.nodeCount++}_construct(t,i,l,h,p){if(t[h].isLeaf(i,l)===1)return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const v=h-1,y=t[v];let S=0,T=0;for(let A=0;A<this._siblingOffset.length;A++){const P=2*i+this._siblingOffset[A][0],D=2*l+this._siblingOffset[A][1],V=y.getElevation(P,D),$=y.isLeaf(P,D),j=this._addNode(V.min,V.max,$);$&&(S|=1<<A),T||(T=j)}for(let A=0;A<this._siblingOffset.length;A++)S&1<<A||this._construct(t,2*i+this._siblingOffset[A][0],2*l+this._siblingOffset[A][1],v,T+A)}}function z1(n,t,i,l,h,p){return Fn(Fn(n,i,p),Fn(t,l,p),h)}function Ya(n,t,i){const l=i.dim,h=nt(n*l-.5,0,l-1),p=nt(t*l-.5,0,l-1),v=Math.floor(h),y=Math.floor(p),S=Math.min(v+1,l-1),T=Math.min(y+1,l-1);return z1(i.get(v,y),i.get(S,y),i.get(v,T),i.get(S,T),h-v,p-y)}const L1={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class xm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,i,l,h=!1,p=!1){if(this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return ue(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const v=this.dim=i.height-2,y=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=l||"mapbox",this.borderReady=h,!h){for(let S=0;S<v;S++)y[this._idx(-1,S)]=y[this._idx(0,S)],y[this._idx(v,S)]=y[this._idx(v-1,S)],y[this._idx(S,-1)]=y[this._idx(S,0)],y[this._idx(S,v)]=y[this._idx(S,v-1)];y[this._idx(-1,-1)]=y[this._idx(0,0)],y[this._idx(v,-1)]=y[this._idx(v-1,0)],y[this._idx(-1,v)]=y[this._idx(0,v-1)],y[this._idx(v,v)]=y[this._idx(v-1,v-1)],p&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new P1(this)}get(t,i,l=!1){l&&(t=nt(t,-1,this.dim),i=nt(i,-1,this.dim));const h=4*this._idx(t,i);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}static getUnpackVector(t){return L1[t]}get unpackVector(){return L1[this.encoding]}_idx(t,i){if(t<-1||t>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(t+1)}_unpackMapbox(t,i,l){return(256*t*256+256*i+l)/10-1e4}_unpackTerrarium(t,i,l){return 256*t+i+l/256-32768}static pack(t,i){const l=[0,0,0,0],h=xm.getUnpackVector(i);let p=Math.floor((t+h[3])/h[2]);return l[2]=p%256,p=Math.floor(p/256),l[1]=p%256,p=Math.floor(p/256),l[0]=p,l}getPixels(){return new Kr({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,i,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=i*this.dim,p=i*this.dim+this.dim,v=l*this.dim,y=l*this.dim+this.dim;switch(i){case-1:h=p-1;break;case 1:p=h+1}switch(l){case-1:v=y-1;break;case 1:y=v+1}const S=-i*this.dim,T=-l*this.dim;for(let A=v;A<y;A++)for(let P=h;P<p;P++){const D=4*this._idx(P,A),V=4*this._idx(P+S,A+T);this.pixels[D+0]=t.pixels[V+0],this.pixels[D+1]=t.pixels[V+1],this.pixels[D+2]=t.pixels[V+2],this.pixels[D+3]=t.pixels[V+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}$t(xm,"DEMData"),$t(P1,"DemMinMaxQuadTree",{omit:["dem"]});class eA{constructor(t,i){this.max=t,this.onRemove=i,this.reset()}reset(){for(const t in this.data)for(const i of this.data[t])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(t,i,l){const h=t.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const p={value:i,timeout:void 0};if(l!==void 0&&(p.timeout=setTimeout(()=>{this.remove(t,p)},l)),this.data[h].push(p),this.order.push(h),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const i=this.data[t].shift();return i.timeout&&clearTimeout(i.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),i.value}getByKey(t){const i=this.data[t];return i?i[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,i){if(!this.has(t))return this;const l=t.wrapped().key,h=i===void 0?0:this.data[l].indexOf(i),p=this.data[l][h];return this.data[l].splice(h,1),p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(p.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(t){const i=[];for(const l in this.data)for(const h of this.data[l])t(h.value)||i.push(h);for(const l of i)this.remove(l.value.tileID,l)}}class Fu{constructor(t,i,l){this.func=t,this.mask=i,this.range=l}}Fu.ReadOnly=!1,Fu.ReadWrite=!0,Fu.disabled=new Fu(519,Fu.ReadOnly,[0,1]);const Uv=7680;class jv{constructor(t,i,l,h,p,v){this.test=t,this.ref=i,this.mask=l,this.fail=h,this.depthFail=p,this.pass=v}}jv.disabled=new jv({func:519,mask:0},0,0,Uv,Uv,Uv);class Ts{constructor(t,i,l){this.blendFunction=t,this.blendColor=i,this.mask=l}}Ts.Replace=[1,0],Ts.disabled=new Ts(Ts.Replace,Li.transparent,[!1,!1,!1,!1]),Ts.unblended=new Ts(Ts.Replace,Li.transparent,[!0,!0,!0,!0]),Ts.alphaBlended=new Ts([1,771],Li.transparent,[!0,!0,!0,!0]);const Gv=1029,qv=2305;class Ho{constructor(t,i,l){this.enable=t,this.mode=i,this.frontFace=l}}Ho.disabled=new Ho(!1,Gv,qv),Ho.backCCW=new Ho(!0,Gv,qv),Ho.backCW=new Ho(!0,Gv,2304),Ho.frontCW=new Ho(!0,1028,2304),Ho.frontCCW=new Ho(!0,1028,qv);class ic extends Bo{constructor(t,i,l){super(),this.id=t,this._onlySymbols=l,i.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new eA(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new QI,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const i=this._tiles[t];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,i){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,i)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const l=this._tiles[i];l.upload(t),l.prepare(this.map.style.imageManager)}}getIds(){return jt(this._tiles).map(t=>t.tileID).sort(D1).map(t=>t.key)}getRenderableIds(t){const i=[];for(const l in this._tiles)this._isIdRenderable(+l,t)&&i.push(this._tiles[l]);return t?i.sort((l,h)=>{const p=l.tileID,v=h.tileID,y=new Y(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),S=new Y(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-v.overscaledZ||S.y-y.y||S.x-y.x}).map(l=>l.tileID.key):i.map(l=>l.tileID).sort(D1).map(l=>l.key)}hasRenderableParent(t){const i=this.findLoadedParent(t,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(t,i){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(i||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,i){const l=this._tiles[t];l&&(l.state!=="loading"&&(l.state=i),this._loadTile(l,this._tileLoaded.bind(this,l,t,i)))}_tileLoaded(t,i,l,h){if(h)if(t.state="errored",h.status!==404)this._source.fire(new ls(h,{tile:t}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const p=this.map.painter.terrain;this.update(this.transform,p.getScaledDemTileSize(),!0),p.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=Gn.now(),l==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(i,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Qn("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const i=this.getRenderableIds();for(let h=0;h<i.length;h++){const p=i[h];if(t.neighboringTiles&&t.neighboringTiles[p]){const v=this.getTileByID(p);l(t,v),l(v,t)}}function l(h,p){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let v=p.tileID.canonical.x-h.tileID.canonical.x;const y=p.tileID.canonical.y-h.tileID.canonical.y,S=Math.pow(2,h.tileID.canonical.z),T=p.tileID.key;v===0&&y===0||Math.abs(y)>1||(Math.abs(v)>1&&(Math.abs(v+S)===1?v+=S:Math.abs(v-S)===1&&(v-=S)),p.dem&&h.dem&&(h.dem.backfillBorder(p.dem,v,y),h.neighboringTiles&&h.neighboringTiles[T]&&(h.neighboringTiles[T].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,i,l,h){for(const p in this._tiles){let v=this._tiles[p];if(h[p]||!v.hasData()||v.tileID.overscaledZ<=i||v.tileID.overscaledZ>l)continue;let y=v.tileID;for(;v&&v.tileID.overscaledZ>i+1;){const T=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[T.key],v&&v.hasData()&&(y=T)}let S=y;for(;S.overscaledZ>i;)if(S=S.scaledTo(S.overscaledZ-1),t[S.key]){h[y.key]=y;break}}}findLoadedParent(t,i){if(t.key in this._loadedParentTiles){const l=this._loadedParentTiles[t.key];return l&&l.tileID.overscaledZ>=i?l:null}for(let l=t.overscaledZ-1;l>=i;l--){const h=t.scaledTo(l),p=this._getLoadedTile(h);if(p)return p}}_getLoadedTile(t){const i=this._tiles[t.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,i){i=i||this._source.tileSize;const l=Math.ceil(t.width/i)+1,h=Math.ceil(t.height/i)+1,p=Math.floor(l*h*5),v=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,p):p,y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(y)}handleWrapJump(t){const i=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,i){const l={};for(const h in this._tiles){const p=this._tiles[h];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+i),l[p.tileID.key]=p}this._tiles=l;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(t,i,l){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!l)return;let h;this.updateCacheSize(t,i),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(y=>new Or(y.canonical.z,y.wrap,y.canonical.z,y.canonical.x,y.canonical.y)):(h=t.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!l,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(y=>this._source.hasTile(y)))):h=[];const p=this._updateRetainedTiles(h);if(R1(this._source.type)&&h.length!==0){const y={},S={},T=Object.keys(p);for(const P of T){const D=p[P],V=this._tiles[P];if(!V||V.fadeEndTime&&V.fadeEndTime<=Gn.now())continue;const $=this.findLoadedParent(D,Math.max(D.overscaledZ-ic.maxOverzooming,this._source.minzoom));$&&(this._addTile($.tileID),y[$.tileID.key]=$.tileID),S[P]=D}const A=h[h.length-1].overscaledZ;for(const P in this._tiles){const D=this._tiles[P];if(p[P]||!D.hasData())continue;let V=D.tileID;for(;V.overscaledZ>A;){V=V.scaledTo(V.overscaledZ-1);const $=this._tiles[V.key];if($&&$.hasData()&&S[V.key]){p[P]=D.tileID;break}}}for(const P in y)p[P]||(this._coveredTiles[P]=!0,p[P]=y[P])}for(const y in p)this._tiles[y].clearFadeHold();const v=function(y,S){const T=[];for(const A in y)A in S||T.push(A);return T}(this._tiles,p);for(const y of v){const S=this._tiles[y];S.hasSymbolBuckets&&!S.holdingForFade()?S.setHoldDuration(this.map._fadeDuration):S.hasSymbolBuckets&&!S.symbolFadeFinished()||this._removeTile(+y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const i={};if(t.length===0)return i;const l={},h=t.reduce((T,A)=>Math.min(T,A.overscaledZ),1/0),p=t[0].overscaledZ,v=Math.max(p-ic.maxOverzooming,this._source.minzoom),y=Math.max(p+ic.maxUnderzooming,this._source.minzoom),S={};for(const T of t){const A=this._addTile(T);i[T.key]=T,A.hasData()||h<this._source.maxzoom&&(S[T.key]=T)}this._retainLoadedChildren(S,h,y,i);for(const T of t){let A=this._tiles[T.key];if(A.hasData())continue;if(T.canonical.z>=this._source.maxzoom){const D=T.children(this._source.maxzoom)[0],V=this.getTile(D);if(V&&V.hasData()){i[D.key]=D;continue}}else{const D=T.children(this._source.maxzoom);if(i[D[0].key]&&i[D[1].key]&&i[D[2].key]&&i[D[3].key])continue}let P=A.wasRequested();for(let D=T.overscaledZ-1;D>=v;--D){const V=T.scaledTo(D);if(l[V.key]||(l[V.key]=!0,A=this.getTile(V),!A&&P&&(A=this._addTile(V)),A&&(i[V.key]=V,P=A.wasRequested(),A.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const i=[];let l,h=this._tiles[t].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){l=this._loadedParentTiles[h.key];break}i.push(h.key);const p=h.scaledTo(h.overscaledZ-1);if(l=this._getLoadedTile(p),l)break;h=p}for(const p of i)this._loadedParentTiles[p]=l}}_addTile(t){let i=this._tiles[t.key];if(i)return i;i=this._cache.getAndRemove(t),i&&(this._setTileReloadTimer(t.key,i),i.tileID=t,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,i)));const l=Boolean(i);if(!l){const h=this.map?this.map.painter:null;i=new Nv(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,h,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,t.key,i.state))}return i?(i.uses++,this._tiles[t.key]=i,l||this._source.fire(new Qn("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(t,i){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const l=i.getExpiryTimeout();l&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},l))}_removeTile(t){const i=this._tiles[t];i&&(i.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,i,l){const h=[],p=this.transform;if(!p)return h;const v=p.projection.name==="globe",y=ys(p.center.lng);for(const S in this._tiles){const T=this._tiles[S];if(l&&T.clearQueryDebugViz(),T.holdingForFade())continue;let A;if(v){const P=T.tileID.canonical;if(P.z===0){const D=[Math.abs(nt(y,...Dd(P,-1))-y),Math.abs(nt(y,...Dd(P,1))-y)];A=[0,2*D.indexOf(Math.min(...D))-1]}else{const D=[Math.abs(nt(y,...Dd(P,-1))-y),Math.abs(nt(y,...Dd(P,0))-y),Math.abs(nt(y,...Dd(P,1))-y)];A=[D.indexOf(Math.min(...D))-1]}}else A=[0];for(const P of A){const D=t.containsTile(T,p,i,P);D&&h.push(D)}}return h}getVisibleCoordinates(t){const i=this.getRenderableIds(t).map(l=>this._tiles[l].tileID);for(const l of i)l.projMatrix=this.transform.calculateProjMatrix(l.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(R1(this._source.type))for(const t in this._tiles){const i=this._tiles[t];if(i.fadeEndTime!==void 0&&i.fadeEndTime>=Gn.now())return!0}return!1}setFeatureState(t,i,l){this._state.updateState(t=t||"_geojsonTileLayer",i,l)}removeFeatureState(t,i,l){this._state.removeFeatureState(t=t||"_geojsonTileLayer",i,l)}getFeatureState(t,i){return this._state.getState(t=t||"_geojsonTileLayer",i)}setDependencies(t,i,l){const h=this._tiles[t];h&&h.setDependencies(i,l)}reloadTilesForDependencies(t,i){for(const l in this._tiles)this._tiles[l].hasDependency(t,i)&&this._reloadTile(+l,"reloading");this._cache.filter(l=>!l.hasDependency(t,i))}_preloadTiles(t,i){const l=new Map,h=Array.isArray(t)?t:[t],p=this.map.painter.terrain,v=this.usedForTerrain&&p?p.getScaledDemTileSize():this._source.tileSize;for(const y of h){const S=y.coveringTiles({tileSize:v,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const T of S)l.set(T.key,T);this.usedForTerrain&&y.updateElevation(!1)}at(Array.from(l.values()),(y,S)=>{const T=new Nv(y,this._source.tileSize*y.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(T,A=>{this._source.type==="raster-dem"&&T.dem&&this._backfillDEM(T),S(A,T)})},i)}}function D1(n,t){const i=Math.abs(2*n.wrap)-+(n.wrap<0),l=Math.abs(2*t.wrap)-+(t.wrap<0);return n.overscaledZ-t.overscaledZ||l-i||t.canonical.y-n.canonical.y||t.canonical.x-n.canonical.x}function R1(n){return n==="raster"||n==="image"||n==="video"||n==="custom"}function Dd(n,t){const i=1<<n.z;return[n.x/i+t,(n.x+1)/i+t]}ic.maxOverzooming=10,ic.maxUnderzooming=3;class bm{constructor(t,i,l){this._demTile=t,this._dem=this._demTile.dem,this._scale=i,this._offset=l}static create(t,i,l){const h=l||t.findDEMTileFor(i);if(!h||!h.dem)return;const p=h.dem,v=h.tileID,y=1<<i.canonical.z-v.canonical.z;return new bm(h,h.tileSize/un/y,[(i.canonical.x/y-v.canonical.x)*p.dim,(i.canonical.y/y-v.canonical.y)*p.dim])}tileCoordToPixel(t,i){const l=i*this._scale+this._offset[1],h=Math.floor(t*this._scale+this._offset[0]),p=Math.floor(l);return new Y(h,p)}getElevationAt(t,i,l,h){const p=t*this._scale+this._offset[0],v=i*this._scale+this._offset[1],y=Math.floor(p),S=Math.floor(v),T=this._dem;return h=!!h,l?Fn(Fn(T.get(y,S,h),T.get(y,S+1,h),v-S),Fn(T.get(y+1,S,h),T.get(y+1,S+1,h),v-S),p-y):T.get(y,S,h)}getElevationAtPixel(t,i,l){return this._dem.get(t,i,!!l)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*Wo(1,t)*this._dem.stride}}class B1{constructor(t,i){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Fa(un,16,0),this.featureIndexArray=new C0,this.promoteId=i}insert(t,i,l,h,p,v=0){const y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,h,p,v);const S=this.grid;for(let T=0;T<i.length;T++){const A=i[T],P=[1/0,1/0,-1/0,-1/0];for(let D=0;D<A.length;D++){const V=A[D];P[0]=Math.min(P[0],V.x),P[1]=Math.min(P[1],V.y),P[2]=Math.max(P[2],V.x),P[3]=Math.max(P[3],V.y)}P[0]<un&&P[1]<un&&P[2]>=0&&P[3]>=0&&S.insert(y,P[0],P[1],P[2],P[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Cv(new Cd(this.rawTileData)).layers,this.sourceLayerCoder=new b1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,i,l,h){this.loadVTLayers();const p=t.params||{},v=cu(p.filter),y=t.tileResult,S=t.transform,T=y.bufferedTilespaceBounds,A=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,($,j,X,le)=>ux(y.bufferedTilespaceGeometry,$,j,X,le));A.sort(tA);let P=null;S.elevation&&A.length>0&&(P=bm.create(S.elevation,this.tileID));const D={};let V;for(let $=0;$<A.length;$++){const j=A[$];if(j===V)continue;V=j;const X=this.featureIndexArray.get(j);let le=null;this.loadMatchingFeature(D,X,v,p.layers,p.availableImages,i,l,h,(ye,ie,ge,Ee=0)=>(le||(le=ea(ye,this.tileID.canonical,t.tileTransform)),ie.queryIntersectsFeature(y,ye,ge,le,this.z,t.transform,t.pixelPosMatrix,P,Ee)))}return D}loadMatchingFeature(t,i,l,h,p,v,y,S,T){const{featureIndex:A,bucketIndex:P,sourceLayerIndex:D,layoutVertexArrayOffset:V}=i,$=this.bucketLayerIDs[P];if(h&&!function(ye,ie){for(let ge=0;ge<ye.length;ge++)if(ie.indexOf(ye[ge])>=0)return!0;return!1}(h,$))return;const j=this.sourceLayerCoder.decode(D),X=this.vtLayers[j].feature(A);if(l.needGeometry){const ye=Ql(X,!0);if(!l.filter(new Be(this.tileID.overscaledZ),ye,this.tileID.canonical))return}else if(!l.filter(new Be(this.tileID.overscaledZ),X))return;const le=this.getId(X,j);for(let ye=0;ye<$.length;ye++){const ie=$[ye];if(h&&h.indexOf(ie)<0)continue;const ge=v[ie];if(!ge)continue;let Ee={};le!==void 0&&S&&(Ee=S.getState(ge.sourceLayer||"_geojsonTileLayer",le));const xe=pt({},y[ie]);xe.paint=O1(xe.paint,ge.paint,X,Ee,p),xe.layout=O1(xe.layout,ge.layout,X,Ee,p);const je=!T||T(X,ge,Ee,V);if(!je)continue;const $e=new w1(X,this.z,this.x,this.y,le);$e.layer=xe;let tt=t[ie];tt===void 0&&(tt=t[ie]=[]),tt.push({featureIndex:A,feature:$e,intersectionZ:je})}}lookupSymbolFeatures(t,i,l,h,p,v,y,S){const T={};this.loadVTLayers();const A=cu(p);for(const P of t)this.loadMatchingFeature(T,{bucketIndex:l,sourceLayerIndex:h,featureIndex:P,layoutVertexArrayOffset:0},A,v,y,S,i);return T}loadFeature(t){const{featureIndex:i,sourceLayerIndex:l}=t;this.loadVTLayers();const h=this.sourceLayerCoder.decode(l),p=this.vtFeatures[h];if(p[i])return p[i];const v=this.vtLayers[h].feature(i);return p[i]=v,v}hasLayer(t){for(const i of this.bucketLayerIDs)for(const l of i)if(t===l)return!0;return!1}getId(t,i){let l=t.id;if(this.promoteId){const h=typeof this.promoteId=="string"?this.promoteId:this.promoteId[i];h!=null&&(l=t.properties[h]),typeof l=="boolean"&&(l=Number(l))}return l}}function O1(n,t,i,l,h){return Nt(n,(p,v)=>{const y=t instanceof Ue?t.get(v):null;return y&&y.evaluate?y.evaluate(i,l,h):y})}function tA(n,t){return t-n}$t(B1,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class F1{constructor(t,i){this.width=t,this.height=i,this.nextRow=0,this.image=new ta({width:t,height:i}),this.positions={},this.uploaded=!1}getDash(t,i){const l=this.getKey(t,i);return this.positions[l]}trim(){const t=this.width,i=this.height=At(this.nextRow);this.image.resize({width:t,height:i})}getKey(t,i){return t.join(",")+i}getDashRanges(t,i,l){const h=[];let p=t.length%2==1?-t[t.length-1]*l:0,v=t[0]*l,y=!0;h.push({left:p,right:v,isDash:y,zeroLength:t[0]===0});let S=t[0];for(let T=1;T<t.length;T++){y=!y;const A=t[T];p=S*l,S+=A,v=S*l,h.push({left:p,right:v,isDash:y,zeroLength:A===0})}return h}addRoundDash(t,i,l){const h=i/2;for(let p=-l;p<=l;p++){const v=this.width*(this.nextRow+l+p);let y=0,S=t[y];for(let T=0;T<this.width;T++){T/S.right>1&&(S=t[++y]);const A=Math.abs(T-S.left),P=Math.abs(T-S.right),D=Math.min(A,P);let V;const $=p/l*(h+1);if(S.isDash){const j=h-Math.abs($);V=Math.sqrt(D*D+j*j)}else V=h-Math.sqrt(D*D+$*$);this.image.data[v+T]=Math.max(0,Math.min(255,V+128))}}}addRegularDash(t,i){for(let S=t.length-1;S>=0;--S){const T=t[S],A=t[S+1];T.zeroLength?t.splice(S,1):A&&A.isDash===T.isDash&&(A.left=T.left,t.splice(S,1))}const l=t[0],h=t[t.length-1];l.isDash===h.isDash&&(l.left=h.left-this.width,h.right=l.right+this.width);const p=this.width*this.nextRow;let v=0,y=t[v];for(let S=0;S<this.width;S++){S/y.right>1&&(y=t[++v]);const T=Math.abs(S-y.left),A=Math.abs(S-y.right),P=Math.min(T,A);this.image.data[p+S]=Math.max(0,Math.min(255,(y.isDash?P:-P)+i+128))}}addDash(t,i){const l=this.getKey(t,i);if(this.positions[l])return this.positions[l];const h=i==="round",p=h?7:0,v=2*p+1;if(this.nextRow+v>this.height)return ue("LineAtlas out of space"),null;t.length===0&&t.push(1);let y=0;for(let A=0;A<t.length;A++)t[A]<0&&(ue("Negative value is found in line dasharray, replacing values with 0"),t[A]=0),y+=t[A];if(y!==0){const A=this.width/y,P=this.getDashRanges(t,this.width,A);h?this.addRoundDash(P,A,p):this.addRegularDash(P,i==="square"?.5*A:0)}const S=this.nextRow+p;this.nextRow+=v;const T={tl:[S,p],br:[y,0]};return this.positions[l]=T,T}}$t(F1,"LineAtlas");class V1{constructor(t){const i={},l=[];for(const y in t){const S=t[y],T=i[y]={};for(const A in S.glyphs){const P=S.glyphs[+A];if(!P||P.bitmap.width===0||P.bitmap.height===0)continue;const D=P.metrics.localGlyph?2:1,V={x:0,y:0,w:P.bitmap.width+2*D,h:P.bitmap.height+2*D};l.push(V),T[A]=V}}const{w:h,h:p}=kv(l),v=new ta({width:h||1,height:p||1});for(const y in t){const S=t[y];for(const T in S.glyphs){const A=S.glyphs[+T];if(!A||A.bitmap.width===0||A.bitmap.height===0)continue;const P=i[y][T],D=A.metrics.localGlyph?2:1;ta.copy(A.bitmap,v,{x:0,y:0},{x:P.x+D,y:P.y+D},A.bitmap)}}this.image=v,this.positions=i}}$t(V1,"GlyphAtlas");class nA{constructor(t){this.tileID=new Or(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile,this.tileTransform=nc(t.tileID.canonical,t.projection),this.projection=t.projection}parse(t,i,l,h,p){this.status="parsing",this.data=t,this.collisionBoxArray=new Hg;const v=new b1(Object.keys(t.layers).sort()),y=new B1(this.tileID,this.promoteId);y.bucketLayerIDs=[];const S={},T=new F1(256,256),A={featureIndex:y,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:T,availableImages:l},P=i.familiesBySource[this.source];for(const Ee in P){const xe=t.layers[Ee];if(!xe)continue;let je=!1,$e=!1;for(const We of P[Ee])We[0].type==="symbol"?je=!0:$e=!0;if(this.isSymbolTile===!0&&!je||this.isSymbolTile===!1&&!$e)continue;xe.version===1&&ue(`Vector tile source "${this.source}" layer "${Ee}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const tt=v.encode(Ee),vt=[];for(let We=0;We<xe.length;We++){const it=xe.feature(We),ot=y.getId(it,Ee);vt.push({feature:it,id:ot,index:We,sourceLayerIndex:tt})}for(const We of P[Ee]){const it=We[0];this.isSymbolTile!==void 0&&it.type==="symbol"!==this.isSymbolTile||it.minzoom&&this.zoom<Math.floor(it.minzoom)||it.maxzoom&&this.zoom>=it.maxzoom||it.visibility!=="none"&&(Zv(We,this.zoom,l),(S[it.id]=it.createBucket({index:y.bucketLayerIDs.length,layers:We,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:tt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:l})).populate(vt,A,this.tileID.canonical,this.tileTransform),y.bucketLayerIDs.push(We.map(ot=>ot.id)))}}let D,V,$,j;T.trim();const X={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},le=Nt(A.glyphDependencies,Ee=>Object.keys(Ee).map(Number));Object.keys(le).length?h.send("getGlyphs",{uid:this.uid,stacks:le},(Ee,xe)=>{D||(D=Ee,V=xe,ge.call(this))},void 0,!1,X):V={};const ye=Object.keys(A.iconDependencies);ye.length?h.send("getImages",{icons:ye,source:this.source,tileID:this.tileID,type:"icons"},(Ee,xe)=>{D||(D=Ee,$=xe,ge.call(this))},void 0,!1,X):$={};const ie=Object.keys(A.patternDependencies);function ge(){if(D)return p(D);if(V&&$&&j){const Ee=new V1(V),xe=new Hx($,j);for(const je in S){const $e=S[je];$e instanceof Wa?(Zv($e.layers,this.zoom,l),MI($e,V,Ee.positions,$,xe.iconPositions,this.showCollisionBoxes,l,this.tileID.canonical,this.tileZoom,this.projection)):$e.hasPattern&&($e instanceof om||$e instanceof em||$e instanceof wd)&&(Zv($e.layers,this.zoom,l),$e.addFeatures(A,this.tileID.canonical,xe.patternPositions,l,this.tileTransform))}this.status="done",p(null,{buckets:jt(S).filter(je=>!je.isEmpty()),featureIndex:y,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ee.image,lineAtlas:T,imageAtlas:xe,glyphMap:this.returnDependencies?V:null,iconMap:this.returnDependencies?$:null,glyphPositions:this.returnDependencies?Ee.positions:null})}}ie.length?h.send("getImages",{icons:ie,source:this.source,tileID:this.tileID,type:"patterns"},(Ee,xe)=>{D||(D=Ee,j=xe,ge.call(this))},void 0,!1,X):j={},ge.call(this)}}function Zv(n,t,i){const l=new Be(t);for(const h of n)h.recalculate(l,i)}class $1{constructor(t){this.entries={},this.scheduler=t}request(t,i,l,h){const p=this.entries[t]=this.entries[t]||{callbacks:[]};if(p.result){const[v,y]=p.result;return this.scheduler?this.scheduler.add(()=>{h(v,y)},i):h(v,y),()=>{}}return p.callbacks.push(h),p.cancel||(p.cancel=l((v,y)=>{p.result=[v,y];for(const S of p.callbacks)this.scheduler?this.scheduler.add(()=>{S(v,y)},i):S(v,y);setTimeout(()=>delete this.entries[t],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(v=>v!==h),p.callbacks.length||(p.cancel(),delete this.entries[t]))}}}function N1(n,t,i){const l=JSON.stringify(n.request);return n.data&&(this.deduped.entries[l]={result:[null,n.data]}),this.deduped.request(l,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom},h=>{const p=po(n.request,(v,y,S,T)=>{v?h(v):y&&h(null,{vectorTile:i?void 0:new Cv(new Cd(y)),rawData:y,cacheControl:S,expires:T})});return()=>{p.cancel(),h()}},t)}o.ARRAY_TYPE=Yr,o.AUTH_ERR_MSG=Vs,o.Aabb=Br,o.Actor=class{constructor(n,t,i){this.target=n,this.parent=t,this.mapId=i,this.callbacks={},this.cancelCallbacks={},xt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=st()?n:w,this.scheduler=new KI}send(n,t,i,l,h=!1,p){const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=p,this.callbacks[v]=i);const y=Vt(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:n,hasCallback:!!i,targetMapId:l,mustQueue:h,sourceMapId:this.mapId,data:Nl(t,y)},y),{cancel:()=>{i&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}receive(n){const t=n.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){const l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l.cancel()}else if(t.mustQueue||st()){const l=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,t),l&&l.metadata||{type:"message"})}else this.processTask(i,t)}processTask(n,t){if(t.type==="<response>"){const i=this.callbacks[n];delete this.callbacks[n],i&&(t.error?i(Ul(t.error)):i(null,Ul(t.data)))}else{const i=Vt(this.globalScope)?void 0:[],l=t.hasCallback?(p,v)=>{delete this.cancelCallbacks[n],this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:p?Nl(p):null,data:Nl(v,i)},i)}:p=>{},h=Ul(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,h,l);else if(this.parent.getWorkerSource){const p=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,p[0],h.source)[p[1]](h,l)}else l(new Error(`Could not find function ${t.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.CanonicalTileID=rm,o.Color=Li,o.ColorMode=Ts,o.CullFaceMode=Ho,o.DEMData=xm,o.DataConstantProperty=Le,o.DedupedRequest=$1,o.DepthMode=Fu,o.EXTENT=un,o.Elevation=class{isDataAvailableAtPoint(n){const t=this._source();if(this.isUsingMockSource()||!t||n.y<0||n.y>1)return!1;const i=t.getSource().maxzoom,l=1<<i,h=Math.floor(n.x),p=Math.floor((n.x-h)*l),v=Math.floor(n.y*l),y=this.findDEMTileFor(new Or(i,h,i,p,v));return!(!y||!y.dem)}getAtPointOrZero(n,t=0){return this.getAtPoint(n,t)||0}getAtPoint(n,t,i=!0){if(this.isUsingMockSource())return null;t==null&&(t=null);const l=this._source();if(!l||n.y<0||n.y>1)return t;const h=l.getSource().maxzoom,p=1<<h,v=Math.floor(n.x),y=n.x-v,S=new Or(h,v,h,Math.floor(y*p),Math.floor(n.y*p)),T=this.findDEMTileFor(S);if(!T||!T.dem)return t;const A=T.dem,P=1<<T.tileID.canonical.z,D=(y*P-T.tileID.canonical.x)*A.dim,V=(n.y*P-T.tileID.canonical.y)*A.dim,$=Math.floor(D),j=Math.floor(V);return(i?this.exaggeration():1)*Fn(Fn(A.get($,j),A.get($,j+1),V-j),Fn(A.get($+1,j),A.get($+1,j+1),V-j),D-$)}getAtTileOffset(n,t,i){const l=1<<n.canonical.z;return this.getAtPointOrZero(new Eu(n.wrap+(n.canonical.x+t/un)/l,(n.canonical.y+i/un)/l))}getAtTileOffsetFunc(n,t,i,l){return h=>{const p=this.getAtTileOffset(n,h.x,h.y),v=l.upVector(n.canonical,h.x,h.y);return oo(v,v,p*l.upVectorScale(n.canonical,t,i).metersToTile),v}}getForTilePoints(n,t,i,l){if(this.isUsingMockSource())return!1;const h=bm.create(this,n,l);return!!h&&(t.forEach(p=>{p[2]=this.exaggeration()*h.getElevationAt(p[0],p[1],i)}),!0)}getMinMaxForTile(n){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(n);if(!t||!t.dem)return null;const i=t.dem.tree,l=t.tileID,h=1<<n.canonical.z-l.canonical.z;let p=n.canonical.x/h-l.canonical.x,v=n.canonical.y/h-l.canonical.y,y=0;for(let S=0;S<n.canonical.z-l.canonical.z&&!i.leaves[y];S++){p*=2,v*=2;const T=2*Math.floor(v)+Math.floor(p);y=i.childOffsets[y]+T,p%=1,v%=1}return{min:this.exaggeration()*i.minimums[y],max:this.exaggeration()*i.maximums[y]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(n,t,i){throw new Error("Pure virtual method called.")}pointCoordinate(n){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(n){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},o.ErrorEvent=ls,o.EvaluationParameters=Be,o.Event=Qn,o.Evented=Bo,o.FillExtrusionBucket=wd,o.Frustum=sv,o.FrustumCorners=ov,o.GLOBE_RADIUS=vs,o.GLOBE_SCALE_MATCH_LATITUDE=45,o.GLOBE_ZOOM_THRESHOLD_MAX=6,o.GLOBE_ZOOM_THRESHOLD_MIN=5,o.GlobeSharedBuffers=class{constructor(n){this._createGrid(n),this._createPoles(n)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const n of this._poleSegments)n.destroy();for(const n of this._gridSegments)n.withSkirts.destroy(),n.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const n of this._wireframeSegments)n.destroy()}}_fillGridMeshWithLods(n,t){const i=new Qt,l=new yr,h=[],p=n+1+2,v=t[0]+1,y=t[0]+1+(1+t.length),S=(T,A,P)=>{let D=T===p-1?T-2:T===0?T:T-1;return D+=P?24575:0,[D,A]};for(let T=0;T<p;++T)i.emplaceBack(...S(T,0,!0));for(let T=0;T<v;++T)for(let A=0;A<p;++A)i.emplaceBack(...S(A,T,(A===0||A===p-1)&&!0));for(let T=0;T<t.length;++T){const A=t[T];for(let P=0;P<p;++P)i.emplaceBack(...S(P,A,!0))}for(let T=0;T<t.length;++T){const A=l.length,P=t[T]+1+2,D=new yr;for(let j=0;j<P-1;j++){const X=j===P-2,le=X?p*(y-t.length+T-j):p;for(let ye=0;ye<p-1;ye++){const ie=j*p+ye;j===0||X||ye===0||ye===p-2?(D.emplaceBack(ie+1,ie,ie+le),D.emplaceBack(ie+le,ie+le+1,ie+1)):(l.emplaceBack(ie+1,ie,ie+le),l.emplaceBack(ie+le,ie+le+1,ie+1))}}const V=Fi.simpleSegment(0,A,i.length,l.length-A);for(let j=0;j<D.uint16.length;j+=3)l.emplaceBack(D.uint16[j],D.uint16[j+1],D.uint16[j+2]);const $=Fi.simpleSegment(0,A,i.length,l.length-A);h.push({withoutSkirts:V,withSkirts:$})}return{vertices:i,indices:l,segments:h}}_createGrid(n){const t=this._fillGridMeshWithLods(Kl,dd);this._gridSegments=t.segments,this._gridBuffer=n.createVertexBuffer(t.vertices,hd.members),this._gridIndexBuffer=n.createIndexBuffer(t.indices,!0)}_createPoles(n){const t=new yr;for(let h=0;h<=Kl;h++)t.emplaceBack(0,h+1,h+2);this._poleIndexBuffer=n.createIndexBuffer(t,!0);const i=new Xr,l=new Xr;this._poleSegments=[];for(let h=0,p=0;h<5;h++){const v=360/(1<<h);i.emplaceBack(0,-vs,0,.5,0),l.emplaceBack(0,-vs,0,.5,1);for(let y=0;y<=Kl;y++){const S=y/Kl,T=Fn(0,v,S),[A,P,D]=wu(KE,JE,T,vs);i.emplaceBack(A,P,D,S,0),l.emplaceBack(A,P,D,S,1)}this._poleSegments.push(Fi.simpleSegment(p,0,66,64)),p+=66}this._poleNorthVertexBuffer=n.createVertexBuffer(i,Z0,!1),this._poleSouthVertexBuffer=n.createVertexBuffer(l,Z0,!1)}getGridBuffers(n,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[n].withSkirts:this._gridSegments[n].withoutSkirts]}getPoleBuffers(n){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[n]]}getWirefameBuffers(n,t){if(!this._wireframeSegments){const i=new ms,l=Kl,h=l+1+2,p=1;this._wireframeSegments=[];for(let v=0,y=0;v<dd.length;v++){const S=dd[v];for(let A=p;A<S+p;A++)for(let P=p;P<l+p;P++){const D=A*h+P;i.emplaceBack(D,D+1),i.emplaceBack(D,D+h),i.emplaceBack(D,D+h+1)}const T=S*l*3;this._wireframeSegments.push(Fi.simpleSegment(0,y,(S+1)*h,T)),y+=T}this._wireframeIndexBuffer=n.createIndexBuffer(i)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[t]]}},o.GlyphManager=Ru,o.ImagePosition=Mv,o.LivePerformanceUtils=ut,o.LngLat=Vn,o.LngLatBounds=Ga,o.LocalGlyphMode=Lv,o.MAX_MERCATOR_LATITUDE=br,o.MercatorCoordinate=Eu,o.ONE_EM=wr,o.OverscaledTileID=Or,o.PerformanceMarkers=Ve,o.Properties=mt,o.RGBAImage=Kr,o.Ray=rv,o.RequestManager=class{constructor(n,t,i){this._transformRequestFn=n,this._customAccessToken=t,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const n=function(){let t="";for(let i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",he,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,t){return this._transformRequestFn&&this._transformRequestFn(n,t)||{url:n}}normalizeStyleURL(n,t){if(!io(n))return n;const i=jr(n);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeGlyphsURL(n,t){if(!io(n))return n;const i=jr(n);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeSourceURL(n,t,i,l){if(!io(n))return n;const h=jr(n);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),i&&h.params.push(`language=${i}`),l&&h.params.push(`worldview=${l}`),this._makeAPIURL(h,this._customAccessToken||t)}normalizeSpriteURL(n,t,i,l){const h=jr(n);return io(n)?(h.path=`/styles/v1${h.path}/sprite${t}${i}`,this._makeAPIURL(h,this._customAccessToken||l)):(h.path+=`${t}${i}`,as(h))}normalizeTileURL(n,t,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!io(n))return n;const l=jr(n);l.path=l.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${t||i&&l.authority!=="raster"&&i===512?"@2x":""}${L.supported?".webp":"$1"}`),l.authority==="raster"?l.path=`/${z.RASTER_URL_PREFIX}${l.path}`:(l.path=l.path.replace(/^.+\/v4\//,"/"),l.path=`/${z.TILE_URL_VERSION}${l.path}`);const h=this._customAccessToken||function(p){for(const v of p){const y=v.match(/^access_token=(.*)$/);if(y)return y[1]}return null}(l.params)||z.ACCESS_TOKEN;return z.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&l.params.push(`sku=${this._skuToken}`),this._makeAPIURL(l,h)}canonicalizeTileURL(n,t){const i=jr(n);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return n;let l="mapbox://";i.path.match(/^\/raster\/v1\//)?l+=`raster/${i.path.replace(`/${z.RASTER_URL_PREFIX}/`,"")}`:l+=`tiles/${i.path.replace(`/${z.TILE_URL_VERSION}/`,"")}`;let h=i.params;return t&&(h=h.filter(p=>!p.match(/^access_token=/))),h.length&&(l+=`?${h.join("&")}`),l}canonicalizeTileset(n,t){const i=!!t&&io(t),l=[];for(const h of n.tiles||[])$s(h)?l.push(this.canonicalizeTileURL(h,i)):l.push(h);return l}_makeAPIURL(n,t){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",l=jr(z.API_URL);if(n.protocol=l.protocol,n.authority=l.authority,n.protocol==="http"){const h=n.params.indexOf("secure");h>=0&&n.params.splice(h,1)}if(l.path!=="/"&&(n.path=`${l.path}${n.path}`),!z.REQUIRE_ACCESS_TOKEN)return as(n);if(t=t||z.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(t[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return n.params=n.params.filter(h=>h.indexOf("access_token")===-1),n.params.push(`access_token=${t||""}`),as(n)}},o.ResourceType=tr,o.SegmentVector=Fi,o.SourceCache=ic,o.StencilMode=jv,o.StructArrayLayout1ui2=gs,o.StructArrayLayout2f1f2i16=vr,o.StructArrayLayout2i4=Qt,o.StructArrayLayout2ui4=ms,o.StructArrayLayout3f12=_r,o.StructArrayLayout3ui6=yr,o.StructArrayLayout4i8=ei,o.StructArrayLayout5f20=Xr,o.Texture=Ld,o.Tile=Nv,o.Transitionable=bt,o.Uniform1f=$p,o.Uniform1i=class extends Ks{constructor(n){super(n),this.current=0}set(n,t,i){this.fetchUniformLocation(n,t)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},o.Uniform2f=class extends Ks{constructor(n){super(n),this.current=[0,0]}set(n,t,i){this.fetchUniformLocation(n,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}},o.Uniform3f=class extends Ks{constructor(n){super(n),this.current=[0,0,0]}set(n,t,i){this.fetchUniformLocation(n,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}},o.Uniform4f=M0,o.UniformColor=P0,o.UniformMatrix2f=class extends Ks{constructor(n){super(n),this.current=BE}set(n,t,i){if(this.fetchUniformLocation(n,t)){for(let l=0;l<4;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}}},o.UniformMatrix3f=class extends Ks{constructor(n){super(n),this.current=RE}set(n,t,i){if(this.fetchUniformLocation(n,t)){for(let l=0;l<9;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}},o.UniformMatrix4f=class extends Ks{constructor(n){super(n),this.current=DE}set(n,t,i){if(this.fetchUniformLocation(n,t)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}},o.UnwrappedTileID=Rx,o.ValidationError=Bt,o.VectorTileFeature=nm,o.VectorTileWorkerSource=class extends Bo{constructor(n,t,i,l,h){super(),this.actor=n,this.layerIndex=t,this.availableImages=i,this.loadVectorData=h||N1,this.loading={},this.loaded={},this.deduped=new $1(n.scheduler),this.isSpriteLoaded=l,this.scheduler=n.scheduler}loadTile(n,t){const i=n.uid,l=n&&n.request,h=l&&l.collectResourceTiming,p=this.loading[i]=new nA(n);p.abort=this.loadVectorData(n,(v,y)=>{const S=!this.loading[i];if(delete this.loading[i],S||v||!y)return p.status="done",S||(this.loaded[i]=p),t(v);const T=y.rawData,A={};y.expires&&(A.expires=y.expires),y.cacheControl&&(A.cacheControl=y.cacheControl),p.vectorTile=y.vectorTile||new Cv(new Cd(T));const P=()=>{p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,(D,V)=>{if(D||!V)return t(D);const $={};if(h){const j=en(l);j.length>0&&($.resourceTiming=JSON.parse(JSON.stringify(j)))}t(null,pt({rawTileData:T.slice(0)},V,A,$))})};this.isSpriteLoaded?P():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(P,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):P()}),this.loaded=this.loaded||{},this.loaded[i]=p})}reloadTile(n,t){const i=this.loaded,l=n.uid,h=this;if(i&&i[l]){const p=i[l];p.showCollisionBoxes=n.showCollisionBoxes,p.enableTerrain=!!n.enableTerrain,p.projection=n.projection,p.tileTransform=nc(n.tileID.canonical,n.projection);const v=(y,S)=>{const T=p.reloadCallback;T&&(delete p.reloadCallback,p.parse(p.vectorTile,h.layerIndex,this.availableImages,h.actor,T)),t(y,S)};p.status==="parsing"?p.reloadCallback=v:p.status==="done"&&(p.vectorTile?p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,v):v())}}abortTile(n,t){const i=n.uid,l=this.loading[i];l&&(l.abort&&l.abort(),delete this.loading[i]),t()}removeTile(n,t){const i=this.loaded,l=n.uid;i&&i[l]&&delete i[l],t()}},o.WritingMode=ao,o.ZoomDependentExpression=Xs,o.add=Qs,o.addDynamicAttributes=vm,o.adjoint=function(n,t){var i=t[0],l=t[1],h=t[2],p=t[3],v=t[4],y=t[5],S=t[6],T=t[7],A=t[8];return n[0]=v*A-y*T,n[1]=h*T-l*A,n[2]=l*y-h*v,n[3]=y*S-p*A,n[4]=i*A-h*S,n[5]=h*p-i*y,n[6]=p*T-v*S,n[7]=l*S-i*T,n[8]=i*v-l*p,n},o.asyncAll=at,o.bezier=Je,o.bindAll=xt,o.boundsAttributes=T1,o.bufferConvexPolygon=function(n,t){const i=[];for(let l=0;l<n.length;l++){const h=Pe(l-1,-1,n.length-1),p=Pe(l+1,-1,n.length-1),v=n[l],y=n[p],S=n[h].sub(v).unit(),T=y.sub(v).unit(),A=T.angleWithSep(S.x,S.y),P=S.add(T).unit().mult(-1*t/Math.sin(A/2));i.push(v.add(P))}return i},o.cacheEntryPossiblyAdded=function(n){fi++,fi>dn&&(n.getActor().send("enforceCacheSizeLimit",rn),fi=0)},o.calculateGlobeLabelMatrix=function(n,t){const{x:i,y:l}=n.point,h=J0(i,l,n.worldSize/n._pixelsPerMercatorPixel,0,0);return Hl(h,h,cv(_s(t)))},o.calculateGlobeMatrix=function(n){const{x:t,y:i}=n.point,{lng:l,lat:h}=n._center;return J0(t,i,n.worldSize,l,h)},o.calculateGlobeMercatorMatrix=function(n){const t=n.pixelsPerMeter,i=t/Wo(1,n.center.lat),l=qo(new Float64Array(16));return od(l,l,[n.point.x,n.point.y,0]),Xl(l,l,[i,i,t]),Float32Array.from(l)},o.circumferenceAtLatitude=hv,o.clamp=nt,o.clearTileCache=function(n){if(!Sn())return;const t=w.caches.delete(wt);n&&t.catch(n).then(()=>n())},o.clipLine=s1,o.clone=function(n){var t=new Yr(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},o.clone$1=Dn,o.collisionCircleLayout=nI,o.config=z,o.conjugate=function(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=t[3],n},o.create=function(){var n=new Yr(16);return Yr!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},o.create$1=L0,o.createExpression=Da,o.createLayout=Ht,o.createStyleLayer=function(n){return n.type==="custom"?new WI(n):new XI[n.type](n)},o.cross=iv,o.degToRad=Se,o.distance=function(n,t){return Math.hypot(t[0]-n[0],t[1]-n[1],t[2]-n[2])},o.div=function(n,t,i){return n[0]=t[0]/i[0],n[1]=t[1]/i[1],n[2]=t[2]/i[2],n},o.dot=yo,o.earthRadius=md,o.ease=ct,o.easeCubicInOut=ze,o.ecefToLatLng=function([n,t,i]){const l=Math.hypot(n,t,i),h=Math.atan2(n,i),p=.5*Math.PI-Math.acos(-t/l);return new Vn(be(h),be(p))},o.emitValidationErrors=Ep,o.endsWith=Tt,o.enforceCacheSizeLimit=function(n){Un(),Kt&&Kt.then(t=>{t.keys().then(i=>{for(let l=0;l<i.length-n;l++)t.delete(i[l])})})},o.evaluateSizeForFeature=sm,o.evaluateSizeForZoom=Pu,o.evaluateVariableOffset=h1,o.evented=fe,o.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]},o.exactEquals$1=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]},o.exported=Gn,o.exported$1=L,o.extend=pt,o.extend$1=Oo,o.fillExtrusionHeightLift=zx,o.filterObject=fn,o.fromMat4=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[4],n[4]=t[5],n[5]=t[6],n[6]=t[8],n[7]=t[9],n[8]=t[10],n},o.fromQuat=function(n,t){var i=t[0],l=t[1],h=t[2],p=t[3],v=i+i,y=l+l,S=h+h,T=i*v,A=l*v,P=l*y,D=h*v,V=h*y,$=h*S,j=p*v,X=p*y,le=p*S;return n[0]=1-P-$,n[1]=A+le,n[2]=D-X,n[3]=0,n[4]=A-le,n[5]=1-T-$,n[6]=V+j,n[7]=0,n[8]=D+X,n[9]=V-j,n[10]=1-T-P,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},o.fromRotation=function(n,t){var i=Math.sin(t),l=Math.cos(t);return n[0]=l,n[1]=i,n[2]=0,n[3]=-i,n[4]=l,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},o.fromScaling=R0,o.furthestTileCorner=function(n){const t=Math.round((n+45+360)%360/90)%4;return De[t]},o.getAABBPointSquareDist=function(n,t,i){let l=0;for(let h=0;h<2;++h){const p=i?i[h]:0;n[h]>p&&(l+=(n[h]-p)*(n[h]-p)),t[h]<p&&(l+=(p-t[h])*(p-t[h]))}return l},o.getAnchorAlignment=zv,o.getAnchorJustification=Rv,o.getBounds=function(n){let t=1/0,i=1/0,l=-1/0,h=-1/0;for(const p of n)t=Math.min(t,p.x),i=Math.min(i,p.y),l=Math.max(l,p.x),h=Math.max(h,p.y);return{min:new Y(t,i),max:new Y(l,h)}},o.getColumn=Ot,o.getGridMatrix=function(n,t,i,l){const h=t.getNorth(),p=t.getSouth(),v=t.getWest(),y=t.getEast(),S=1<<n.z,T=y-v,A=h-p,P=T/Kl,D=-A/dd[i],V=[0,P,0,D,0,0,h,v,0];if(n.z>0){const $=180/l;D0(V,V,[$/T+1,0,0,0,$/A+1,0,-.5*$/P,.5*$/D,1])}return V[2]=S,V[5]=n.x,V[8]=n.y,V},o.getImage=ml,o.getJSON=function(n,t){return Mr(pt(n,{type:"json"}),t)},o.getLatitudinalLod=function(n){const t=br-5;n=nt(n,-t,t)/t*90;const i=Math.pow(Math.abs(Math.sin(Se(n))),3);return Math.round(i*(dd.length-1))},o.getMapSessionAPI=Re,o.getPerformanceMeasurement=en,o.getProjection=y1,o.getRTLTextPluginStatus=Ce,o.getReferrer=ss,o.getTilePoint=function(n,{x:t,y:i},l=0){return new Y(((t-l)*n.scale-n.x)*un,(i*n.scale-n.y)*un)},o.getTileVec3=function(n,t,i=0){return bu(((t.x-i)*n.scale-n.x)*un,(t.y*n.scale-n.y)*un,nx(t.z,t.y))},o.getVideo=function(n,t){const i=w.document.createElement("video");i.muted=!0,i.onloadstart=function(){t(null,i)};for(let l=0;l<n.length;l++){const h=w.document.createElement("source");Ki(n[l])||(i.crossOrigin="Anonymous"),h.src=n[l],i.appendChild(h)}return{cancel:()=>{}}},o.globeCenterToScreenPoint=function(n){const t=[0,0,0],i=qo(new Float64Array(16));return Hl(i,n.pixelMatrix,n.globeMatrix),Di(t,t,i),new Y(t[0],t[1])},o.globeDenormalizeECEF=cv,o.globeECEFOrigin=function(n,t){const i=[0,0,0];return Di(i,i,pd(_s(t.canonical))),Di(i,i,n),i},o.globeMetersToEcef=Gp,o.globeNormalizeECEF=pd,o.globePixelsToTileUnits=function(n,t){return un/(512*Math.pow(2,n))*Zp(_s(t))},o.globePoleMatrixForTile=function(n,t,i){const l=qo(new Float64Array(16)),h=(t/(1<<n)-.5)*Math.PI*2;return jp(l,i.globeMatrix,h),Float32Array.from(l)},o.globeTileBounds=_s,o.globeTiltAtLngLat=Q0,o.globeToMercatorTransition=Tu,o.globeUseCustomAntiAliasing=function(n,t,i){const l=Tu(i.zoom),h=n.style.map._antialias,p=!!t.extStandardDerivatives,v=t.extStandardDerivativesForceOff||n.terrain&&n.terrain.exaggeration()>0;return l===0&&!h&&!v&&p},o.identity=qo,o.identity$1=j0,o.invert=Qg,o.isFullscreen=function(){return!!w.document.fullscreenElement||!!w.document.webkitFullscreenElement},o.isLngLatBehindGlobe=uv,o.isMapAuthenticated=function(n){return ke.has(n)},o.isMapboxURL=io,o.isSafariWithAntialiasingBug=function(n){const t=n.navigator?n.navigator.userAgent:null;return!!Vt(n)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.latFromMercatorY=xr,o.latLngToECEF=Su,o.len=qE,o.length=sd,o.length$1=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},o.lngFromMercatorX=so,o.loadVectorTile=N1,o.makeRequest=Mr,o.mapValue=function(n,t,i,l,h){return nt((n-t)/(i-t)*(h-l)+l,l,h)},o.mercatorScale=ix,o.mercatorXfromLng=ys,o.mercatorYfromLat=xs,o.mercatorZfromAltitude=Wo,o.mul=jE,o.mul$1=GE,o.multiply=Hl,o.multiply$1=D0,o.multiply$2=F0,o.nextPowerOfTwo=At,o.normalize=Rr,o.normalize$1=ZE,o.normalize$2=N0,o.number=Fn,o.ortho=function(n,t,i,l,h,p,v){var y=1/(t-i),S=1/(l-h),T=1/(p-v);return n[0]=-2*y,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*S,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*T,n[11]=0,n[12]=(t+i)*y,n[13]=(h+l)*S,n[14]=(v+p)*T,n[15]=1,n},o.pbf=Cd,o.perspective=function(n,t,i,l,h){var p,v=1/Math.tan(t/2);return n[0]=v/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=v,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,h!=null&&h!==1/0?(n[10]=(h+l)*(p=1/(l-h)),n[14]=2*h*l*p):(n[10]=-1,n[14]=-2*l),n},o.pick=function(n,t){const i={};for(let l=0;l<t.length;l++){const h=t[l];h in n&&(i[h]=n[h])}return i},o.plugin=Ae,o.pointGeometry=Y,o.polesInViewport=function(n){const t=qo(new Float64Array(16));Hl(t,n.pixelMatrix,n.globeMatrix);const i=[0,xo,0],l=[0,bo,0];return Di(i,i,t),Di(l,l,t),[i[0]>0&&i[0]<=n.width&&i[1]>0&&i[1]<=n.height&&!uv(n,new Vn(n.center.lat,90)),l[0]>0&&l[0]<=n.width&&l[1]>0&&l[1]<=n.height&&!uv(n,new Vn(n.center.lat,-90))]},o.polygonContainsPoint=ec,o.polygonIntersectsBox=ux,o.polygonIntersectsPolygon=sx,o.polygonizeBounds=function(n,t,i=0,l=!0){const h=new Y(i,i),p=n.sub(h),v=t.add(h),y=[p,new Y(v.x,p.y),v,new Y(p.x,v.y)];return l&&y.push(p.clone()),y},o.posAttributes=hd,o.postMapLoadEvent=re,o.postPerformanceEvent=Ie,o.postTurnstileEvent=N,o.potpack=kv,o.prevPowerOfTwo=function(n){return n<=1?1:Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},o.radToDeg=be,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.registerForPluginStateChange=function(n){return n({pluginStatus:te,pluginURL:Z}),fe.on("pluginStateChange",n),n},o.removeAuthState=function(n){ke.delete(n)},o.renderColorRamp=yv,o.resample=rx,o.rotateX=ev,o.rotateX$1=G0,o.rotateY=jp,o.rotateY$1=q0,o.rotateZ=function(n,t,i){var l=Math.sin(i),h=Math.cos(i),p=t[0],v=t[1],y=t[2],S=t[3],T=t[4],A=t[5],P=t[6],D=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=p*h+T*l,n[1]=v*h+A*l,n[2]=y*h+P*l,n[3]=S*h+D*l,n[4]=T*h-p*l,n[5]=A*h-v*l,n[6]=P*h-y*l,n[7]=D*h-S*l,n},o.rotateZ$1=function(n,t,i){i*=.5;var l=t[0],h=t[1],p=t[2],v=t[3],y=Math.sin(i),S=Math.cos(i);return n[0]=l*S+h*y,n[1]=h*S-l*y,n[2]=p*S+v*y,n[3]=v*S-p*y,n},o.scale=Xl,o.scale$1=$0,o.scale$2=oo,o.scaleAndAdd=cd,o.set=function(n,t,i,l){return n[0]=t,n[1]=i,n[2]=l,n},o.setCacheLimits=function(n,t){rn=n,dn=t},o.setColumn=function(n,t,i){n[4*t+0]=i[0],n[4*t+1]=i[1],n[4*t+2]=i[2],n[4*t+3]=i[3]},o.setRTLTextPlugin=function(n,t,i=!1){if(te===W||te===Q||te===J)throw new Error("setRTLTextPlugin cannot be called multiple times.");Z=Gn.resolveURL(n),te=W,ee=t,ae(),i||we()},o.smoothstep=ft,o.spec=et,o.squaredLength=function(n){var t=n[0],i=n[1],l=n[2];return t*t+i*i+l*l},o.storeAuthState=function(n,t){t?ke.add(n):ke.delete(n)},o.sub=Zo,o.subtract=nv,o.symbolSize=iI,o.tileAABB=function(n,t,i,l,h,p,v,y,S){if(S.name==="globe")return YE(n,t,new rm(i,l,h));const T=nc({z:i,x:l,y:h},S);return new Br([(p+T.x/T.scale)*t,t*(T.y/T.scale),v],[(p+T.x2/T.scale)*t,t*(T.y2/T.scale),y])},o.tileCornersToBounds=qp,o.tileTransform=nc,o.transformMat3=function(n,t,i){var l=t[0],h=t[1],p=t[2];return n[0]=l*i[0]+h*i[3]+p*i[6],n[1]=l*i[1]+h*i[4]+p*i[7],n[2]=l*i[2]+h*i[5]+p*i[8],n},o.transformMat4=Di,o.transformMat4$1=Yl,o.transformQuat=V0,o.transitionTileAABBinECEF=X0,o.translate=od,o.transpose=function(n,t){if(n===t){var i=t[1],l=t[2],h=t[5];n[1]=t[3],n[2]=t[6],n[3]=i,n[5]=t[7],n[6]=l,n[7]=h}else n[0]=t[0],n[1]=t[3],n[2]=t[6],n[3]=t[1],n[4]=t[4],n[5]=t[7],n[6]=t[2],n[7]=t[5],n[8]=t[8];return n},o.triggerPluginCompletionEvent=ce,o.uniqueId=Gt,o.updateGlobeVertexNormal=function(n,t,i,l,h){const p=5*t+2;n.float32[p+0]=i,n.float32[p+1]=l,n.float32[p+2]=h},o.validateCustomStyleLayer=function(n){const t=[],i=n.id;return i===void 0&&t.push({message:`layers.${i}: missing required property "id"`}),n.render===void 0&&t.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&t.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),t},o.validateFilter=n=>$o(Xh(n)),o.validateFog=n=>$o(wp(n)),o.validateLayer=n=>$o(Kh(n)),o.validateLight=n=>$o(bp(n)),o.validateSource=n=>$o(Vl(n)),o.validateStyle=Sp,o.validateTerrain=n=>$o(Jh(n)),o.values=jt,o.vectorTile=tm,o.version=E,o.warnOnce=ue,o.window=w,o.wrap=Pe}),g(["./shared"],function(o){function w(oe){if(typeof oe=="number"||typeof oe=="boolean"||typeof oe=="string"||oe==null)return JSON.stringify(oe);if(Array.isArray(oe)){let q="[";for(const re of oe)q+=`${w(re)},`;return`${q}]`}let N="{";for(const q of Object.keys(oe).sort())N+=`${q}:${w(oe[q])},`;return`${N}}`}function E(oe){let N="";for(const q of o.refProperties)N+=`/${w(oe[q])}`;return N}class k{constructor(N){this.keyCache={},N&&this.replace(N)}replace(N){this._layerConfigs={},this._layers={},this.update(N,[])}update(N,q){for(const me of N)this._layerConfigs[me.id]=me,(this._layers[me.id]=o.createStyleLayer(me)).compileFilter(),this.keyCache[me.id]&&delete this.keyCache[me.id];for(const me of q)delete this.keyCache[me],delete this._layerConfigs[me],delete this._layers[me];this.familiesBySource={};const re=function(me,Ie){const Oe={};for(let ke=0;ke<me.length;ke++){const Ve=Ie&&Ie[me[ke].id]||E(me[ke]);Ie&&(Ie[me[ke].id]=Ve);let ut=Oe[Ve];ut||(ut=Oe[Ve]=[]),ut.push(me[ke])}const Re=[];for(const ke in Oe)Re.push(Oe[ke]);return Re}(o.values(this._layerConfigs),this.keyCache);for(const me of re){const Ie=me.map(Rt=>this._layers[Rt.id]),Oe=Ie[0];if(Oe.visibility==="none")continue;const Re=Oe.source||"";let ke=this.familiesBySource[Re];ke||(ke=this.familiesBySource[Re]={});const Ve=Oe.sourceLayer||"_geojsonTileLayer";let ut=ke[Ve];ut||(ut=ke[Ve]=[]),ut.push(Ie)}}}class z{loadTile(N,q){const{uid:re,encoding:me,rawImageData:Ie,padding:Oe,buildQuadTree:Re}=N,ke=o.window.ImageBitmap&&Ie instanceof o.window.ImageBitmap?this.getImageData(Ie,Oe):Ie;q(null,new o.DEMData(re,ke,me,Oe<1,Re))}getImageData(N,q){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(N.width,N.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=N.width,this.offscreenCanvas.height=N.height,this.offscreenCanvasContext.drawImage(N,0,0,N.width,N.height);const re=this.offscreenCanvasContext.getImageData(-q,-q,N.width+2*q,N.height+2*q);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),re}}var L=function oe(N,q){var re,me=N&&N.type;if(me==="FeatureCollection")for(re=0;re<N.features.length;re++)oe(N.features[re],q);else if(me==="GeometryCollection")for(re=0;re<N.geometries.length;re++)oe(N.geometries[re],q);else if(me==="Feature")oe(N.geometry,q);else if(me==="Polygon")O(N.coordinates,q);else if(me==="MultiPolygon")for(re=0;re<N.coordinates.length;re++)O(N.coordinates[re],q);return N};function O(oe,N){if(oe.length!==0){G(oe[0],N);for(var q=1;q<oe.length;q++)G(oe[q],!N)}}function G(oe,N){for(var q=0,re=0,me=0,Ie=oe.length,Oe=Ie-1;me<Ie;Oe=me++){var Re=(oe[me][0]-oe[Oe][0])*(oe[Oe][1]+oe[me][1]),ke=q+Re;re+=Math.abs(q)>=Math.abs(Re)?q-ke+Re:Re-ke+q,q=ke}q+re>=0!=!!N&&oe.reverse()}const H=o.VectorTileFeature.prototype.toGeoJSON;class pe{constructor(N){this._feature=N,this.extent=o.EXTENT,this.type=N.type,this.properties=N.tags,"id"in N&&!isNaN(N.id)&&(this.id=parseInt(N.id,10))}loadGeometry(){if(this._feature.type===1){const N=[];for(const q of this._feature.geometry)N.push([new o.pointGeometry(q[0],q[1])]);return N}{const N=[];for(const q of this._feature.geometry){const re=[];for(const me of q)re.push(new o.pointGeometry(me[0],me[1]));N.push(re)}return N}}toGeoJSON(N,q,re){return H.call(this,N,q,re)}}class se{constructor(N){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=N.length,this._features=N}feature(N){return new pe(this._features[N])}}var he={},K={get exports(){return he},set exports(oe){he=oe}},Te=o.pointGeometry,Y=o.vectorTile.VectorTileFeature,_e=de;function de(oe,N){this.options=N||{},this.features=oe,this.length=oe.length}function ve(oe,N){this.id=typeof oe.id=="number"?oe.id:void 0,this.type=oe.type,this.rawGeometry=oe.type===1?[oe.geometry]:oe.geometry,this.properties=oe.tags,this.extent=N||4096}de.prototype.feature=function(oe){return new ve(this.features[oe],this.options.extent)},ve.prototype.loadGeometry=function(){var oe=this.rawGeometry;this.geometry=[];for(var N=0;N<oe.length;N++){for(var q=oe[N],re=[],me=0;me<q.length;me++)re.push(new Te(q[me][0],q[me][1]));this.geometry.push(re)}return this.geometry},ve.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var oe=this.geometry,N=1/0,q=-1/0,re=1/0,me=-1/0,Ie=0;Ie<oe.length;Ie++)for(var Oe=oe[Ie],Re=0;Re<Oe.length;Re++){var ke=Oe[Re];N=Math.min(N,ke.x),q=Math.max(q,ke.x),re=Math.min(re,ke.y),me=Math.max(me,ke.y)}return[N,re,q,me]},ve.prototype.toGeoJSON=Y.prototype.toGeoJSON;var Se=o.pbf,be=_e;function De(oe){var N=new Se;return function(q,re){for(var me in q.layers)re.writeMessage(3,ze,q.layers[me])}(oe,N),N.finish()}function ze(oe,N){var q;N.writeVarintField(15,oe.version||1),N.writeStringField(1,oe.name||""),N.writeVarintField(5,oe.extent||4096);var re={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<oe.length;q++)re.feature=oe.feature(q),N.writeMessage(2,Je,re);var me=re.keys;for(q=0;q<me.length;q++)N.writeStringField(3,me[q]);var Ie=re.values;for(q=0;q<Ie.length;q++)N.writeMessage(4,at,Ie[q])}function Je(oe,N){var q=oe.feature;q.id!==void 0&&N.writeVarintField(1,q.id),N.writeMessage(2,ct,oe),N.writeVarintField(3,q.type),N.writeMessage(4,Pe,q)}function ct(oe,N){var q=oe.feature,re=oe.keys,me=oe.values,Ie=oe.keycache,Oe=oe.valuecache;for(var Re in q.properties){var ke=q.properties[Re],Ve=Ie[Re];if(ke!==null){Ve===void 0&&(re.push(Re),Ie[Re]=Ve=re.length-1),N.writeVarint(Ve);var ut=typeof ke;ut!=="string"&&ut!=="boolean"&&ut!=="number"&&(ke=JSON.stringify(ke));var Rt=ut+":"+ke,gt=Oe[Rt];gt===void 0&&(me.push(ke),Oe[Rt]=gt=me.length-1),N.writeVarint(gt)}}}function nt(oe,N){return(N<<3)+(7&oe)}function ft(oe){return oe<<1^oe>>31}function Pe(oe,N){for(var q=oe.loadGeometry(),re=oe.type,me=0,Ie=0,Oe=q.length,Re=0;Re<Oe;Re++){var ke=q[Re],Ve=1;re===1&&(Ve=ke.length),N.writeVarint(nt(1,Ve));for(var ut=re===3?ke.length-1:ke.length,Rt=0;Rt<ut;Rt++){Rt===1&&re!==1&&N.writeVarint(nt(2,ut-1));var gt=ke[Rt].x-me,en=ke[Rt].y-Ie;N.writeVarint(ft(gt)),N.writeVarint(ft(en)),me+=gt,Ie+=en}re===3&&N.writeVarint(nt(7,1))}}function at(oe,N){var q=typeof oe;q==="string"?N.writeStringField(1,oe):q==="boolean"?N.writeBooleanField(7,oe):q==="number"&&(oe%1!=0?N.writeDoubleField(3,oe):oe<0?N.writeSVarintField(6,oe):N.writeVarintField(5,oe))}function jt(oe,N,q,re,me,Ie){if(me-re<=q)return;const Oe=re+me>>1;pt(oe,N,Oe,re,me,Ie%2),jt(oe,N,q,re,Oe-1,Ie+1),jt(oe,N,q,Oe+1,me,Ie+1)}function pt(oe,N,q,re,me,Ie){for(;me>re;){if(me-re>600){const Ve=me-re+1,ut=q-re+1,Rt=Math.log(Ve),gt=.5*Math.exp(2*Rt/3),en=.5*Math.sqrt(Rt*gt*(Ve-gt)/Ve)*(ut-Ve/2<0?-1:1);pt(oe,N,q,Math.max(re,Math.floor(q-ut*gt/Ve+en)),Math.min(me,Math.floor(q+(Ve-ut)*gt/Ve+en)),Ie)}const Oe=N[2*q+Ie];let Re=re,ke=me;for(zt(oe,N,re,q),N[2*me+Ie]>Oe&&zt(oe,N,re,me);Re<ke;){for(zt(oe,N,Re,ke),Re++,ke--;N[2*Re+Ie]<Oe;)Re++;for(;N[2*ke+Ie]>Oe;)ke--}N[2*re+Ie]===Oe?zt(oe,N,re,ke):(ke++,zt(oe,N,ke,me)),ke<=q&&(re=ke+1),q<=ke&&(me=ke-1)}}function zt(oe,N,q,re){Gt(oe,q,re),Gt(N,2*q,2*re),Gt(N,2*q+1,2*re+1)}function Gt(oe,N,q){const re=oe[N];oe[N]=oe[q],oe[q]=re}function zn(oe,N,q,re){const me=oe-q,Ie=N-re;return me*me+Ie*Ie}K.exports=De,he.fromVectorTileJs=De,he.fromGeojsonVt=function(oe,N){N=N||{};var q={};for(var re in oe)q[re]=new be(oe[re].features,N),q[re].name=re,q[re].version=N.version,q[re].extent=N.extent;return De({layers:q})},he.GeoJSONWrapper=be;const At=oe=>oe[0],Qe=oe=>oe[1];class xt{constructor(N,q=At,re=Qe,me=64,Ie=Float64Array){this.nodeSize=me,this.points=N;const Oe=N.length<65536?Uint16Array:Uint32Array,Re=this.ids=new Oe(N.length),ke=this.coords=new Ie(2*N.length);for(let Ve=0;Ve<N.length;Ve++)Re[Ve]=Ve,ke[2*Ve]=q(N[Ve]),ke[2*Ve+1]=re(N[Ve]);jt(Re,ke,me,0,Re.length-1,0)}range(N,q,re,me){return function(Ie,Oe,Re,ke,Ve,ut,Rt){const gt=[0,Ie.length-1,0],en=[];let Jt,Yt;for(;gt.length;){const cn=gt.pop(),vn=gt.pop(),Gn=gt.pop();if(vn-Gn<=Rt){for(let Qn=Gn;Qn<=vn;Qn++)Jt=Oe[2*Qn],Yt=Oe[2*Qn+1],Jt>=Re&&Jt<=Ve&&Yt>=ke&&Yt<=ut&&en.push(Ie[Qn]);continue}const on=Math.floor((Gn+vn)/2);Jt=Oe[2*on],Yt=Oe[2*on+1],Jt>=Re&&Jt<=Ve&&Yt>=ke&&Yt<=ut&&en.push(Ie[on]);const Jn=(cn+1)%2;(cn===0?Re<=Jt:ke<=Yt)&&(gt.push(Gn),gt.push(on-1),gt.push(Jn)),(cn===0?Ve>=Jt:ut>=Yt)&&(gt.push(on+1),gt.push(vn),gt.push(Jn))}return en}(this.ids,this.coords,N,q,re,me,this.nodeSize)}within(N,q,re){return function(me,Ie,Oe,Re,ke,Ve){const ut=[0,me.length-1,0],Rt=[],gt=ke*ke;for(;ut.length;){const en=ut.pop(),Jt=ut.pop(),Yt=ut.pop();if(Jt-Yt<=Ve){for(let Jn=Yt;Jn<=Jt;Jn++)zn(Ie[2*Jn],Ie[2*Jn+1],Oe,Re)<=gt&&Rt.push(me[Jn]);continue}const cn=Math.floor((Yt+Jt)/2),vn=Ie[2*cn],Gn=Ie[2*cn+1];zn(vn,Gn,Oe,Re)<=gt&&Rt.push(me[cn]);const on=(en+1)%2;(en===0?Oe-ke<=vn:Re-ke<=Gn)&&(ut.push(Yt),ut.push(cn-1),ut.push(on)),(en===0?Oe+ke>=vn:Re+ke>=Gn)&&(ut.push(cn+1),ut.push(Jt),ut.push(on))}return Rt}(this.ids,this.coords,N,q,re,this.nodeSize)}}const Tt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:oe=>oe},Nt=Math.fround||(fn=new Float32Array(1),oe=>(fn[0]=+oe,fn[0]));var fn;class Dn{constructor(N){this.options=Vt(Object.create(Tt),N),this.trees=new Array(this.options.maxZoom+1)}load(N){const{log:q,minZoom:re,maxZoom:me,nodeSize:Ie}=this.options;q&&console.time("total time");const Oe=`prepare ${N.length} points`;q&&console.time(Oe),this.points=N;let Re=[];for(let ke=0;ke<N.length;ke++)N[ke].geometry&&Re.push(ue(N[ke],ke));this.trees[me+1]=new xt(Re,Mt,Ot,Ie,Float32Array),q&&console.timeEnd(Oe);for(let ke=me;ke>=re;ke--){const Ve=+Date.now();Re=this._cluster(Re,ke),this.trees[ke]=new xt(Re,Mt,Ot,Ie,Float32Array),q&&console.log("z%d: %d clusters in %dms",ke,Re.length,+Date.now()-Ve)}return q&&console.timeEnd("total time"),this}getClusters(N,q){let re=((N[0]+180)%360+360)%360-180;const me=Math.max(-90,Math.min(90,N[1]));let Ie=N[2]===180?180:((N[2]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,N[3]));if(N[2]-N[0]>=360)re=-180,Ie=180;else if(re>Ie){const ut=this.getClusters([re,me,180,Oe],q),Rt=this.getClusters([-180,me,Ie,Oe],q);return ut.concat(Rt)}const Re=this.trees[this._limitZoom(q)],ke=Re.range(st(re),yt(Oe),st(Ie),yt(me)),Ve=[];for(const ut of ke){const Rt=Re.points[ut];Ve.push(Rt.numPoints?Me(Rt):this.points[Rt.index])}return Ve}getChildren(N){const q=this._getOriginId(N),re=this._getOriginZoom(N),me="No cluster with the specified id.",Ie=this.trees[re];if(!Ie)throw new Error(me);const Oe=Ie.points[q];if(!Oe)throw new Error(me);const Re=this.options.radius/(this.options.extent*Math.pow(2,re-1)),ke=Ie.within(Oe.x,Oe.y,Re),Ve=[];for(const ut of ke){const Rt=Ie.points[ut];Rt.parentId===N&&Ve.push(Rt.numPoints?Me(Rt):this.points[Rt.index])}if(Ve.length===0)throw new Error(me);return Ve}getLeaves(N,q,re){const me=[];return this._appendLeaves(me,N,q=q||10,re=re||0,0),me}getTile(N,q,re){const me=this.trees[this._limitZoom(N)],Ie=Math.pow(2,N),{extent:Oe,radius:Re}=this.options,ke=Re/Oe,Ve=(re-ke)/Ie,ut=(re+1+ke)/Ie,Rt={features:[]};return this._addTileFeatures(me.range((q-ke)/Ie,Ve,(q+1+ke)/Ie,ut),me.points,q,re,Ie,Rt),q===0&&this._addTileFeatures(me.range(1-ke/Ie,Ve,1,ut),me.points,Ie,re,Ie,Rt),q===Ie-1&&this._addTileFeatures(me.range(0,Ve,ke/Ie,ut),me.points,-1,re,Ie,Rt),Rt.features.length?Rt:null}getClusterExpansionZoom(N){let q=this._getOriginZoom(N)-1;for(;q<=this.options.maxZoom;){const re=this.getChildren(N);if(q++,re.length!==1)break;N=re[0].properties.cluster_id}return q}_appendLeaves(N,q,re,me,Ie){const Oe=this.getChildren(q);for(const Re of Oe){const ke=Re.properties;if(ke&&ke.cluster?Ie+ke.point_count<=me?Ie+=ke.point_count:Ie=this._appendLeaves(N,ke.cluster_id,re,me,Ie):Ie<me?Ie++:N.push(Re),N.length===re)break}return Ie}_addTileFeatures(N,q,re,me,Ie,Oe){for(const Re of N){const ke=q[Re],Ve=ke.numPoints;let ut,Rt,gt;if(Ve)ut=qe(ke),Rt=ke.x,gt=ke.y;else{const Yt=this.points[ke.index];ut=Yt.properties,Rt=st(Yt.geometry.coordinates[0]),gt=yt(Yt.geometry.coordinates[1])}const en={type:1,geometry:[[Math.round(this.options.extent*(Rt*Ie-re)),Math.round(this.options.extent*(gt*Ie-me))]],tags:ut};let Jt;Ve?Jt=ke.id:this.options.generateId?Jt=ke.index:this.points[ke.index].id&&(Jt=this.points[ke.index].id),Jt!==void 0&&(en.id=Jt),Oe.features.push(en)}}_limitZoom(N){return Math.max(this.options.minZoom,Math.min(Math.floor(+N),this.options.maxZoom+1))}_cluster(N,q){const re=[],{radius:me,extent:Ie,reduce:Oe,minPoints:Re}=this.options,ke=me/(Ie*Math.pow(2,q));for(let Ve=0;Ve<N.length;Ve++){const ut=N[Ve];if(ut.zoom<=q)continue;ut.zoom=q;const Rt=this.trees[q+1],gt=Rt.within(ut.x,ut.y,ke),en=ut.numPoints||1;let Jt=en;for(const Yt of gt){const cn=Rt.points[Yt];cn.zoom>q&&(Jt+=cn.numPoints||1)}if(Jt>en&&Jt>=Re){let Yt=ut.x*en,cn=ut.y*en,vn=Oe&&en>1?this._map(ut,!0):null;const Gn=(Ve<<5)+(q+1)+this.points.length;for(const on of gt){const Jn=Rt.points[on];if(Jn.zoom<=q)continue;Jn.zoom=q;const Qn=Jn.numPoints||1;Yt+=Jn.x*Qn,cn+=Jn.y*Qn,Jn.parentId=Gn,Oe&&(vn||(vn=this._map(ut,!0)),Oe(vn,this._map(Jn)))}ut.parentId=Gn,re.push(gn(Yt/Jt,cn/Jt,Gn,Jt,vn))}else if(re.push(ut),Jt>1)for(const Yt of gt){const cn=Rt.points[Yt];cn.zoom<=q||(cn.zoom=q,re.push(cn))}}return re}_getOriginId(N){return N-this.points.length>>5}_getOriginZoom(N){return(N-this.points.length)%32}_map(N,q){if(N.numPoints)return q?Vt({},N.properties):N.properties;const re=this.points[N.index].properties,me=this.options.map(re);return q&&me===re?Vt({},me):me}}function gn(oe,N,q,re,me){return{x:Nt(oe),y:Nt(N),zoom:1/0,id:q,parentId:-1,numPoints:re,properties:me}}function ue(oe,N){const[q,re]=oe.geometry.coordinates;return{x:Nt(st(q)),y:Nt(yt(re)),zoom:1/0,index:N,parentId:-1}}function Me(oe){return{type:"Feature",id:oe.id,properties:qe(oe),geometry:{type:"Point",coordinates:[(N=oe.x,360*(N-.5)),Lt(oe.y)]}};var N}function qe(oe){const N=oe.numPoints,q=N>=1e4?`${Math.round(N/1e3)}k`:N>=1e3?Math.round(N/100)/10+"k":N;return Vt(Vt({},oe.properties),{cluster:!0,cluster_id:oe.id,point_count:N,point_count_abbreviated:q})}function st(oe){return oe/360+.5}function yt(oe){const N=Math.sin(oe*Math.PI/180),q=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return q<0?0:q>1?1:q}function Lt(oe){const N=(180-360*oe)*Math.PI/180;return 360*Math.atan(Math.exp(N))/Math.PI-90}function Vt(oe,N){for(const q in N)oe[q]=N[q];return oe}function Mt(oe){return oe.x}function Ot(oe){return oe.y}function wt(oe,N,q,re){for(var me,Ie=re,Oe=q-N>>1,Re=q-N,ke=oe[N],Ve=oe[N+1],ut=oe[q],Rt=oe[q+1],gt=N+3;gt<q;gt+=3){var en=Kt(oe[gt],oe[gt+1],ke,Ve,ut,Rt);if(en>Ie)me=gt,Ie=en;else if(en===Ie){var Jt=Math.abs(gt-Oe);Jt<Re&&(me=gt,Re=Jt)}}Ie>re&&(me-N>3&&wt(oe,N,me,re),oe[me+2]=Ie,q-me>3&&wt(oe,me,q,re))}function Kt(oe,N,q,re,me,Ie){var Oe=me-q,Re=Ie-re;if(Oe!==0||Re!==0){var ke=((oe-q)*Oe+(N-re)*Re)/(Oe*Oe+Re*Re);ke>1?(q=me,re=Ie):ke>0&&(q+=Oe*ke,re+=Re*ke)}return(Oe=oe-q)*Oe+(Re=N-re)*Re}function Zt(oe,N,q,re){var me={id:oe===void 0?null:oe,type:N,geometry:q,tags:re,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ie){var Oe=Ie.geometry,Re=Ie.type;if(Re==="Point"||Re==="MultiPoint"||Re==="LineString")rn(Ie,Oe);else if(Re==="Polygon"||Re==="MultiLineString")for(var ke=0;ke<Oe.length;ke++)rn(Ie,Oe[ke]);else if(Re==="MultiPolygon")for(ke=0;ke<Oe.length;ke++)for(var Ve=0;Ve<Oe[ke].length;Ve++)rn(Ie,Oe[ke][Ve])}(me),me}function rn(oe,N){for(var q=0;q<N.length;q+=3)oe.minX=Math.min(oe.minX,N[q]),oe.minY=Math.min(oe.minY,N[q+1]),oe.maxX=Math.max(oe.maxX,N[q]),oe.maxY=Math.max(oe.maxY,N[q+1])}function dn(oe,N,q,re){if(N.geometry){var me=N.geometry.coordinates,Ie=N.geometry.type,Oe=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),Re=[],ke=N.id;if(q.promoteId?ke=N.properties[q.promoteId]:q.generateId&&(ke=re||0),Ie==="Point")Sn(me,Re);else if(Ie==="MultiPoint")for(var Ve=0;Ve<me.length;Ve++)Sn(me[Ve],Re);else if(Ie==="LineString")Un(me,Re,Oe,!1);else if(Ie==="MultiLineString"){if(q.lineMetrics){for(Ve=0;Ve<me.length;Ve++)Un(me[Ve],Re=[],Oe,!1),oe.push(Zt(ke,"LineString",Re,N.properties));return}jn(me,Re,Oe,!1)}else if(Ie==="Polygon")jn(me,Re,Oe,!0);else{if(Ie!=="MultiPolygon"){if(Ie==="GeometryCollection"){for(Ve=0;Ve<N.geometry.geometries.length;Ve++)dn(oe,{id:ke,geometry:N.geometry.geometries[Ve],properties:N.properties},q,re);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ve=0;Ve<me.length;Ve++){var ut=[];jn(me[Ve],ut,Oe,!0),Re.push(ut)}}oe.push(Zt(ke,Ie,Re,N.properties))}}function Sn(oe,N){N.push(fi(oe[0])),N.push(tr(oe[1])),N.push(0)}function Un(oe,N,q,re){for(var me,Ie,Oe=0,Re=0;Re<oe.length;Re++){var ke=fi(oe[Re][0]),Ve=tr(oe[Re][1]);N.push(ke),N.push(Ve),N.push(0),Re>0&&(Oe+=re?(me*Ve-ke*Ie)/2:Math.sqrt(Math.pow(ke-me,2)+Math.pow(Ve-Ie,2))),me=ke,Ie=Ve}var ut=N.length-3;N[2]=1,wt(N,0,ut,q),N[ut+2]=1,N.size=Math.abs(Oe),N.start=0,N.end=N.size}function jn(oe,N,q,re){for(var me=0;me<oe.length;me++){var Ie=[];Un(oe[me],Ie,q,re),N.push(Ie)}}function fi(oe){return oe/360+.5}function tr(oe){var N=Math.sin(oe*Math.PI/180),q=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return q<0?0:q>1?1:q}function Gi(oe,N,q,re,me,Ie,Oe,Re){if(re/=N,Ie>=(q/=N)&&Oe<re)return oe;if(Oe<q||Ie>=re)return null;for(var ke=[],Ve=0;Ve<oe.length;Ve++){var ut=oe[Ve],Rt=ut.geometry,gt=ut.type,en=me===0?ut.minX:ut.minY,Jt=me===0?ut.maxX:ut.maxY;if(en>=q&&Jt<re)ke.push(ut);else if(!(Jt<q||en>=re)){var Yt=[];if(gt==="Point"||gt==="MultiPoint")ss(Rt,Yt,q,re,me);else if(gt==="LineString")Mr(Rt,Yt,q,re,me,!1,Re.lineMetrics);else if(gt==="MultiLineString")Ki(Rt,Yt,q,re,me,!1);else if(gt==="Polygon")Ki(Rt,Yt,q,re,me,!0);else if(gt==="MultiPolygon")for(var cn=0;cn<Rt.length;cn++){var vn=[];Ki(Rt[cn],vn,q,re,me,!0),vn.length&&Yt.push(vn)}if(Yt.length){if(Re.lineMetrics&&gt==="LineString"){for(cn=0;cn<Yt.length;cn++)ke.push(Zt(ut.id,gt,Yt[cn],ut.tags));continue}gt!=="LineString"&&gt!=="MultiLineString"||(Yt.length===1?(gt="LineString",Yt=Yt[0]):gt="MultiLineString"),gt!=="Point"&&gt!=="MultiPoint"||(gt=Yt.length===3?"Point":"MultiPoint"),ke.push(Zt(ut.id,gt,Yt,ut.tags))}}}return ke.length?ke:null}function ss(oe,N,q,re,me){for(var Ie=0;Ie<oe.length;Ie+=3){var Oe=oe[Ie+me];Oe>=q&&Oe<=re&&(N.push(oe[Ie]),N.push(oe[Ie+1]),N.push(oe[Ie+2]))}}function Mr(oe,N,q,re,me,Ie,Oe){for(var Re,ke,Ve=po(oe),ut=me===0?Ro:Fs,Rt=oe.start,gt=0;gt<oe.length-3;gt+=3){var en=oe[gt],Jt=oe[gt+1],Yt=oe[gt+2],cn=oe[gt+3],vn=oe[gt+4],Gn=me===0?en:Jt,on=me===0?cn:vn,Jn=!1;Oe&&(Re=Math.sqrt(Math.pow(en-cn,2)+Math.pow(Jt-vn,2))),Gn<q?on>q&&(ke=ut(Ve,en,Jt,cn,vn,q),Oe&&(Ve.start=Rt+Re*ke)):Gn>re?on<re&&(ke=ut(Ve,en,Jt,cn,vn,re),Oe&&(Ve.start=Rt+Re*ke)):sr(Ve,en,Jt,Yt),on<q&&Gn>=q&&(ke=ut(Ve,en,Jt,cn,vn,q),Jn=!0),on>re&&Gn<=re&&(ke=ut(Ve,en,Jt,cn,vn,re),Jn=!0),!Ie&&Jn&&(Oe&&(Ve.end=Rt+Re*ke),N.push(Ve),Ve=po(oe)),Oe&&(Rt+=Re)}var Qn=oe.length-3;en=oe[Qn],Jt=oe[Qn+1],Yt=oe[Qn+2],(Gn=me===0?en:Jt)>=q&&Gn<=re&&sr(Ve,en,Jt,Yt),Qn=Ve.length-3,Ie&&Qn>=3&&(Ve[Qn]!==Ve[0]||Ve[Qn+1]!==Ve[1])&&sr(Ve,Ve[0],Ve[1],Ve[2]),Ve.length&&N.push(Ve)}function po(oe){var N=[];return N.size=oe.size,N.start=oe.start,N.end=oe.end,N}function Ki(oe,N,q,re,me,Ie){for(var Oe=0;Oe<oe.length;Oe++)Mr(oe[Oe],N,q,re,me,Ie,!1)}function sr(oe,N,q,re){oe.push(N),oe.push(q),oe.push(re)}function Ro(oe,N,q,re,me,Ie){var Oe=(Ie-N)/(re-N);return oe.push(Ie),oe.push(q+(me-q)*Oe),oe.push(1),Oe}function Fs(oe,N,q,re,me,Ie){var Oe=(Ie-q)/(me-q);return oe.push(N+(re-N)*Oe),oe.push(Ie),oe.push(1),Oe}function ml(oe,N){for(var q=[],re=0;re<oe.length;re++){var me,Ie=oe[re],Oe=Ie.type;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")me=Vs(Ie.geometry,N);else if(Oe==="MultiLineString"||Oe==="Polygon"){me=[];for(var Re=0;Re<Ie.geometry.length;Re++)me.push(Vs(Ie.geometry[Re],N))}else if(Oe==="MultiPolygon")for(me=[],Re=0;Re<Ie.geometry.length;Re++){for(var ke=[],Ve=0;Ve<Ie.geometry[Re].length;Ve++)ke.push(Vs(Ie.geometry[Re][Ve],N));me.push(ke)}q.push(Zt(Ie.id,Oe,me,Ie.tags))}return q}function Vs(oe,N){var q=[];q.size=oe.size,oe.start!==void 0&&(q.start=oe.start,q.end=oe.end);for(var re=0;re<oe.length;re+=3)q.push(oe[re]+N,oe[re+1],oe[re+2]);return q}function io(oe,N){if(oe.transformed)return oe;var q,re,me,Ie=1<<oe.z,Oe=oe.x,Re=oe.y;for(q=0;q<oe.features.length;q++){var ke=oe.features[q],Ve=ke.geometry,ut=ke.type;if(ke.geometry=[],ut===1)for(re=0;re<Ve.length;re+=2)ke.geometry.push($s(Ve[re],Ve[re+1],N,Ie,Oe,Re));else for(re=0;re<Ve.length;re++){var Rt=[];for(me=0;me<Ve[re].length;me+=2)Rt.push($s(Ve[re][me],Ve[re][me+1],N,Ie,Oe,Re));ke.geometry.push(Rt)}}return oe.transformed=!0,oe}function $s(oe,N,q,re,me,Ie){return[Math.round(q*(oe*re-me)),Math.round(q*(N*re-Ie))]}function Bc(oe,N,q,re,me){for(var Ie=N===me.maxZoom?0:me.tolerance/((1<<N)*me.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:re,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Re=0;Re<oe.length;Re++){Oe.numFeatures++,Oc(Oe,oe[Re],Ie,me);var ke=oe[Re].minX,Ve=oe[Re].minY,ut=oe[Re].maxX,Rt=oe[Re].maxY;ke<Oe.minX&&(Oe.minX=ke),Ve<Oe.minY&&(Oe.minY=Ve),ut>Oe.maxX&&(Oe.maxX=ut),Rt>Oe.maxY&&(Oe.maxY=Rt)}return Oe}function Oc(oe,N,q,re){var me=N.geometry,Ie=N.type,Oe=[];if(Ie==="Point"||Ie==="MultiPoint")for(var Re=0;Re<me.length;Re+=3)Oe.push(me[Re]),Oe.push(me[Re+1]),oe.numPoints++,oe.numSimplified++;else if(Ie==="LineString")ya(Oe,me,oe,q,!1,!1);else if(Ie==="MultiLineString"||Ie==="Polygon")for(Re=0;Re<me.length;Re++)ya(Oe,me[Re],oe,q,Ie==="Polygon",Re===0);else if(Ie==="MultiPolygon")for(var ke=0;ke<me.length;ke++){var Ve=me[ke];for(Re=0;Re<Ve.length;Re++)ya(Oe,Ve[Re],oe,q,!0,Re===0)}if(Oe.length){var ut=N.tags||null;if(Ie==="LineString"&&re.lineMetrics){for(var Rt in ut={},N.tags)ut[Rt]=N.tags[Rt];ut.mapbox_clip_start=me.start/me.size,ut.mapbox_clip_end=me.end/me.size}var gt={geometry:Oe,type:Ie==="Polygon"||Ie==="MultiPolygon"?3:Ie==="LineString"||Ie==="MultiLineString"?2:1,tags:ut};N.id!==null&&(gt.id=N.id),oe.features.push(gt)}}function ya(oe,N,q,re,me,Ie){var Oe=re*re;if(re>0&&N.size<(me?Oe:re))q.numPoints+=N.length/3;else{for(var Re=[],ke=0;ke<N.length;ke+=3)(re===0||N[ke+2]>Oe)&&(q.numSimplified++,Re.push(N[ke]),Re.push(N[ke+1])),q.numPoints++;me&&function(Ve,ut){for(var Rt=0,gt=0,en=Ve.length,Jt=en-2;gt<en;Jt=gt,gt+=2)Rt+=(Ve[gt]-Ve[Jt])*(Ve[gt+1]+Ve[Jt+1]);if(Rt>0===ut)for(gt=0,en=Ve.length;gt<en/2;gt+=2){var Yt=Ve[gt],cn=Ve[gt+1];Ve[gt]=Ve[en-2-gt],Ve[gt+1]=Ve[en-1-gt],Ve[en-2-gt]=Yt,Ve[en-1-gt]=cn}}(Re,Ie),oe.push(Re)}}function Ns(oe,N){var q=(N=this.options=function(me,Ie){for(var Oe in Ie)me[Oe]=Ie[Oe];return me}(Object.create(this.options),N)).debug;if(q&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var re=function(me,Ie){var Oe=[];if(me.type==="FeatureCollection")for(var Re=0;Re<me.features.length;Re++)dn(Oe,me.features[Re],Ie,Re);else dn(Oe,me.type==="Feature"?me:{geometry:me},Ie);return Oe}(oe,N);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),re=function(me,Ie){var Oe=Ie.buffer/Ie.extent,Re=me,ke=Gi(me,1,-1-Oe,Oe,0,-1,2,Ie),Ve=Gi(me,1,1-Oe,2+Oe,0,-1,2,Ie);return(ke||Ve)&&(Re=Gi(me,1,-Oe,1+Oe,0,-1,2,Ie)||[],ke&&(Re=ml(ke,1).concat(Re)),Ve&&(Re=Re.concat(ml(Ve,-1)))),Re}(re,N),re.length&&this.splitTile(re,0,0,0),q&&(re.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function jr(oe,N,q){return 32*((1<<oe)*q+N)+oe}function as(oe,N){const q=oe.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);const re=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!re)return N(null,null);const me=new se(re.features);let Ie=he(me);Ie.byteOffset===0&&Ie.byteLength===Ie.buffer.byteLength||(Ie=new Uint8Array(Ie)),N(null,{vectorTile:me,rawData:Ie.buffer})}Ns.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ns.prototype.splitTile=function(oe,N,q,re,me,Ie,Oe){for(var Re=[oe,N,q,re],ke=this.options,Ve=ke.debug;Re.length;){re=Re.pop(),q=Re.pop(),N=Re.pop(),oe=Re.pop();var ut=1<<N,Rt=jr(N,q,re),gt=this.tiles[Rt];if(!gt&&(Ve>1&&console.time("creation"),gt=this.tiles[Rt]=Bc(oe,N,q,re,ke),this.tileCoords.push({z:N,x:q,y:re}),Ve)){Ve>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,q,re,gt.numFeatures,gt.numPoints,gt.numSimplified),console.timeEnd("creation"));var en="z"+N;this.stats[en]=(this.stats[en]||0)+1,this.total++}if(gt.source=oe,me){if(N===ke.maxZoom||N===me)continue;var Jt=1<<me-N;if(q!==Math.floor(Ie/Jt)||re!==Math.floor(Oe/Jt))continue}else if(N===ke.indexMaxZoom||gt.numPoints<=ke.indexMaxPoints)continue;if(gt.source=null,oe.length!==0){Ve>1&&console.time("clipping");var Yt,cn,vn,Gn,on,Jn,Qn=.5*ke.buffer/ke.extent,ls=.5-Qn,Bo=.5+Qn,et=1+Qn;Yt=cn=vn=Gn=null,on=Gi(oe,ut,q-Qn,q+Bo,0,gt.minX,gt.maxX,ke),Jn=Gi(oe,ut,q+ls,q+et,0,gt.minX,gt.maxX,ke),oe=null,on&&(Yt=Gi(on,ut,re-Qn,re+Bo,1,gt.minY,gt.maxY,ke),cn=Gi(on,ut,re+ls,re+et,1,gt.minY,gt.maxY,ke),on=null),Jn&&(vn=Gi(Jn,ut,re-Qn,re+Bo,1,gt.minY,gt.maxY,ke),Gn=Gi(Jn,ut,re+ls,re+et,1,gt.minY,gt.maxY,ke),Jn=null),Ve>1&&console.timeEnd("clipping"),Re.push(Yt||[],N+1,2*q,2*re),Re.push(cn||[],N+1,2*q,2*re+1),Re.push(vn||[],N+1,2*q+1,2*re),Re.push(Gn||[],N+1,2*q+1,2*re+1)}}},Ns.prototype.getTile=function(oe,N,q){var re=this.options,me=re.extent,Ie=re.debug;if(oe<0||oe>24)return null;var Oe=1<<oe,Re=jr(oe,N=(N%Oe+Oe)%Oe,q);if(this.tiles[Re])return io(this.tiles[Re],me);Ie>1&&console.log("drilling down to z%d-%d-%d",oe,N,q);for(var ke,Ve=oe,ut=N,Rt=q;!ke&&Ve>0;)Ve--,ut=Math.floor(ut/2),Rt=Math.floor(Rt/2),ke=this.tiles[jr(Ve,ut,Rt)];return ke&&ke.source?(Ie>1&&console.log("found parent tile z%d-%d-%d",Ve,ut,Rt),Ie>1&&console.time("drilling down"),this.splitTile(ke.source,Ve,ut,Rt,oe,N,q),Ie>1&&console.timeEnd("drilling down"),this.tiles[Re]?io(this.tiles[Re],me):null):null};class Fc extends o.VectorTileWorkerSource{constructor(N,q,re,me,Ie){super(N,q,re,me,as),Ie&&(this.loadGeoJSON=Ie)}loadData(N,q){const re=N&&N.request,me=re&&re.collectResourceTiming;this.loadGeoJSON(N,(Ie,Oe)=>{if(Ie||!Oe)return q(Ie);if(typeof Oe!="object")return q(new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`));{L(Oe,!0);try{if(N.filter){const ke=o.createExpression(N.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ke.result==="error")throw new Error(ke.value.map(ut=>`${ut.key}: ${ut.message}`).join(", "));Oe={type:"FeatureCollection",features:Oe.features.filter(ut=>ke.value.evaluate({zoom:0},ut))}}this._geoJSONIndex=N.cluster?new Dn(function({superclusterOptions:ke,clusterProperties:Ve}){if(!Ve||!ke)return ke;const ut={},Rt={},gt={accumulated:null,zoom:0},en={properties:null},Jt=Object.keys(Ve);for(const Yt of Jt){const[cn,vn]=Ve[Yt],Gn=o.createExpression(vn),on=o.createExpression(typeof cn=="string"?[cn,["accumulated"],["get",Yt]]:cn);ut[Yt]=Gn.value,Rt[Yt]=on.value}return ke.map=Yt=>{en.properties=Yt;const cn={};for(const vn of Jt)cn[vn]=ut[vn].evaluate(gt,en);return cn},ke.reduce=(Yt,cn)=>{en.properties=cn;for(const vn of Jt)gt.accumulated=Yt[vn],Yt[vn]=Rt[vn].evaluate(gt,en)},ke}(N)).load(Oe.features):function(ke,Ve){return new Ns(ke,Ve)}(Oe,N.geojsonVtOptions)}catch(ke){return q(ke)}this.loaded={};const Re={};if(me){const ke=o.getPerformanceMeasurement(re);ke&&(Re.resourceTiming={},Re.resourceTiming[N.source]=JSON.parse(JSON.stringify(ke)))}q(null,Re)}})}reloadTile(N,q){const re=this.loaded;return re&&re[N.uid]?super.reloadTile(N,q):this.loadTile(N,q)}loadGeoJSON(N,q){if(N.request)o.getJSON(N.request,q);else{if(typeof N.data!="string")return q(new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`));try{return q(null,JSON.parse(N.data))}catch{return q(new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(N,q){try{q(null,this._geoJSONIndex.getClusterExpansionZoom(N.clusterId))}catch(re){q(re)}}getClusterChildren(N,q){try{q(null,this._geoJSONIndex.getChildren(N.clusterId))}catch(re){q(re)}}getClusterLeaves(N,q){try{q(null,this._geoJSONIndex.getLeaves(N.clusterId,N.limit,N.offset))}catch(re){q(re)}}}class Us{constructor(N){this.self=N,this.actor=new o.Actor(N,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.getProjection({name:"mercator"}),this.workerSourceTypes={vector:o.VectorTileWorkerSource,geojson:Fc},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(q,re)=>{if(this.workerSourceTypes[q])throw new Error(`Worker source with name "${q}" already registered.`);this.workerSourceTypes[q]=re},this.self.registerRTLTextPlugin=q=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=q.applyArabicShaping,o.plugin.processBidirectionalText=q.processBidirectionalText,o.plugin.processStyledBidirectionalText=q.processStyledBidirectionalText}}clearCaches(N,q,re){delete this.layerIndexes[N],delete this.availableImages[N],delete this.workerSources[N],delete this.demWorkerSources[N],re()}checkIfReady(N,q,re){re()}setReferrer(N,q){this.referrer=q}spriteLoaded(N,q){this.isSpriteLoaded[N]=q;for(const re in this.workerSources[N]){const me=this.workerSources[N][re];for(const Ie in me)me[Ie]instanceof o.VectorTileWorkerSource&&(me[Ie].isSpriteLoaded=q,me[Ie].fire(new o.Event("isSpriteLoaded")))}}setImages(N,q,re){this.availableImages[N]=q;for(const me in this.workerSources[N]){const Ie=this.workerSources[N][me];for(const Oe in Ie)Ie[Oe].availableImages=q}re()}enableTerrain(N,q,re){this.terrain=q,re()}setProjection(N,q){this.projections[N]=o.getProjection(q)}setLayers(N,q,re){this.getLayerIndex(N).replace(q),re()}updateLayers(N,q,re){this.getLayerIndex(N).update(q.layers,q.removedIds),re()}loadTile(N,q,re){const me=this.enableTerrain?o.extend({enableTerrain:this.terrain},q):q;me.projection=this.projections[N]||this.defaultProjection,this.getWorkerSource(N,q.type,q.source).loadTile(me,re)}loadDEMTile(N,q,re){const me=this.enableTerrain?o.extend({buildQuadTree:this.terrain},q):q;this.getDEMWorkerSource(N,q.source).loadTile(me,re)}reloadTile(N,q,re){const me=this.enableTerrain?o.extend({enableTerrain:this.terrain},q):q;me.projection=this.projections[N]||this.defaultProjection,this.getWorkerSource(N,q.type,q.source).reloadTile(me,re)}abortTile(N,q,re){this.getWorkerSource(N,q.type,q.source).abortTile(q,re)}removeTile(N,q,re){this.getWorkerSource(N,q.type,q.source).removeTile(q,re)}removeSource(N,q,re){if(!this.workerSources[N]||!this.workerSources[N][q.type]||!this.workerSources[N][q.type][q.source])return;const me=this.workerSources[N][q.type][q.source];delete this.workerSources[N][q.type][q.source],me.removeSource!==void 0?me.removeSource(q,re):re()}loadWorkerSource(N,q,re){try{this.self.importScripts(q.url),re()}catch(me){re(me.toString())}}syncRTLPluginState(N,q,re){try{o.plugin.setState(q);const me=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&me!=null){this.self.importScripts(me);const Ie=o.plugin.isParsed();re(Ie?void 0:new Error(`RTL Text Plugin failed to import scripts from ${me}`),Ie)}}catch(me){re(me.toString())}}getAvailableImages(N){let q=this.availableImages[N];return q||(q=[]),q}getLayerIndex(N){let q=this.layerIndexes[N];return q||(q=this.layerIndexes[N]=new k),q}getWorkerSource(N,q,re){if(this.workerSources[N]||(this.workerSources[N]={}),this.workerSources[N][q]||(this.workerSources[N][q]={}),!this.workerSources[N][q][re]){const me={send:(Ie,Oe,Re,ke,Ve,ut)=>{this.actor.send(Ie,Oe,Re,N,Ve,ut)},scheduler:this.actor.scheduler};this.workerSources[N][q][re]=new this.workerSourceTypes[q](me,this.getLayerIndex(N),this.getAvailableImages(N),this.isSpriteLoaded[N])}return this.workerSources[N][q][re]}getDEMWorkerSource(N,q){return this.demWorkerSources[N]||(this.demWorkerSources[N]={}),this.demWorkerSources[N][q]||(this.demWorkerSources[N][q]=new z),this.demWorkerSources[N][q]}enforceCacheSizeLimit(N,q){o.enforceCacheSizeLimit(q)}getWorkerPerformanceMetrics(N,q,re){re(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Us(self)),Us}),g(["./shared"],function(o){function w(f,r){if(Array.isArray(f)){if(!Array.isArray(r)||f.length!==r.length)return!1;for(let c=0;c<f.length;c++)if(!w(f[c],r[c]))return!1;return!0}if(typeof f=="object"&&f!==null&&r!==null){if(typeof r!="object"||Object.keys(f).length!==Object.keys(r).length)return!1;for(const c in f)if(!w(f[c],r[c]))return!1;return!0}return f===r}var E=k;function k(f){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var m,_,b=new Blob([""],{type:"text/javascript"}),C=URL.createObjectURL(b);try{_=new Worker(C),m=!0}catch{m=!1}return _&&_.terminate(),URL.revokeObjectURL(C),m}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var m=document.createElement("canvas");m.width=m.height=1;var _=m.getContext("2d");if(!_)return!1;var b=_.getImageData(0,0,1,1);return b&&b.width===m.width}()?(z[c=r&&r.failIfMajorPerformanceCaveat]===void 0&&(z[c]=function(m){var _,b=function(C){var I=document.createElement("canvas"),M=Object.create(k.webGLContextAttributes);return M.failIfMajorPerformanceCaveat=C,I.getContext("webgl",M)||I.getContext("experimental-webgl",M)}(m);if(!b)return!1;try{_=b.createShader(b.VERTEX_SHADER)}catch{return!1}return!(!_||b.isContextLost())&&(b.shaderSource(_,"void main() {}"),b.compileShader(_),b.getShaderParameter(_,b.COMPILE_STATUS)===!0)}(c)),z[c]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var c}(f)}var z={};function L(f,r,c){const m=o.window.document.createElement(f);return r!==void 0&&(m.className=r),c&&c.appendChild(m),m}function O(f,r,c){const m=o.window.document.createElementNS("http://www.w3.org/2000/svg",f);for(const _ of Object.keys(r))m.setAttributeNS(null,_,r[_]);return c&&c.appendChild(m),m}k.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const G=o.window.document&&o.window.document.documentElement.style,H=G&&G.userSelect!==void 0?"userSelect":"WebkitUserSelect";let pe;function se(){G&&H&&(pe=G[H],G[H]="none")}function he(){G&&H&&(G[H]=pe)}function K(f){f.preventDefault(),f.stopPropagation(),o.window.removeEventListener("click",K,!0)}function Te(){o.window.addEventListener("click",K,!0),o.window.setTimeout(()=>{o.window.removeEventListener("click",K,!0)},0)}function Y(f,r){const c=f.getBoundingClientRect();return ve(f,c,r)}function _e(f,r){const c=f.getBoundingClientRect(),m=[];for(let _=0;_<r.length;_++)m.push(ve(f,c,r[_]));return m}function de(f){return o.window.InstallTrigger!==void 0&&f.button===2&&f.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function ve(f,r,c){const m=f.offsetWidth===r.width?1:f.offsetWidth/r.width;return new o.pointGeometry((c.clientX-r.left)*m,(c.clientY-r.top)*m)}function Se(f,r){var c=r[0],m=r[1],_=r[2],b=r[3],C=c*b-_*m;return C?(f[0]=b*(C=1/C),f[1]=-m*C,f[2]=-_*C,f[3]=c*C,f):null}function be(f){const{userImage:r}=f;return!!(r&&r.render&&r.render())&&(f.data.replace(new Uint8Array(r.data.buffer)),!0)}class De extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:c,callback:m}of this.requestors)this._notify(c,m);this.requestors=[]}}hasImage(r){return!!this.getImage(r)}getImage(r){return this.images[r]}addImage(r,c){this._validate(r,c)&&(this.images[r]=c)}_validate(r,c){let m=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),m=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),m=!1),this._validateContent(c.content,c)||(this.fire(new o.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),m=!1),m}_validateStretch(r,c){if(!r)return!0;let m=0;for(const _ of r){if(_[0]<m||_[1]<_[0]||c<_[1])return!1;m=_[1]}return!0}_validateContent(r,c){return!(r&&(r.length!==4||r[0]<0||c.data.width<r[0]||r[1]<0||c.data.height<r[1]||r[2]<0||c.data.width<r[2]||r[3]<0||c.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,c){c.version=this.images[r].version+1,this.images[r]=c,this.updatedImages[r]=!0}removeImage(r){const c=this.images[r];delete this.images[r],delete this.patterns[r],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,c){let m=!0;if(!this.isLoaded())for(const _ of r)this.images[_]||(m=!1);this.isLoaded()||m?this._notify(r,c):this.requestors.push({ids:r,callback:c})}_notify(r,c){const m={};for(const _ of r){this.images[_]||this.fire(new o.Event("styleimagemissing",{id:_}));const b=this.images[_];b?m[_]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:Boolean(b.userImage&&b.userImage.render)}:o.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,m)}getPixelSize(){const{width:r,height:c}=this.atlasImage;return{width:r,height:c}}getPattern(r){const c=this.patterns[r],m=this.getImage(r);if(!m)return null;if(c&&c.position.version===m.version)return c.position;if(c)c.position.version=m.version;else{const _={w:m.data.width+2,h:m.data.height+2,x:0,y:0},b=new o.ImagePosition(_,m);this.patterns[r]={bin:_,position:b}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const c=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(r,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const b in this.patterns)r.push(this.patterns[b].bin);const{w:c,h:m}=o.potpack(r),_=this.atlasImage;_.resize({width:c||1,height:m||1});for(const b in this.patterns){const{bin:C}=this.patterns[b],I=C.x+1,M=C.y+1,R=this.images[b].data,B=R.width,U=R.height;o.RGBAImage.copy(R,_,{x:0,y:0},{x:I,y:M},{width:B,height:U}),o.RGBAImage.copy(R,_,{x:0,y:U-1},{x:I,y:M-1},{width:B,height:1}),o.RGBAImage.copy(R,_,{x:0,y:0},{x:I,y:M+U},{width:B,height:1}),o.RGBAImage.copy(R,_,{x:B-1,y:0},{x:I-1,y:M},{width:1,height:U}),o.RGBAImage.copy(R,_,{x:0,y:0},{x:I+B,y:M},{width:1,height:U})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const c of r){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const m=this.images[c];be(m)&&this.updateImage(c,m)}}}const ze=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(f,r){return function([c,m,_]){const b=o.degToRad(m+90),C=o.degToRad(_);return{x:c*Math.cos(b)*Math.sin(C),y:c*Math.sin(b)*Math.sin(C),z:c*Math.cos(C),azimuthal:m,polar:_}}(f.expression.evaluate(r))}interpolate(f,r,c){return{x:o.number(f.x,r.x,c),y:o.number(f.y,r.y,c),z:o.number(f.z,r.z,c),azimuthal:o.number(f.azimuthal,r.azimuthal,c),polar:o.number(f.polar,r.polar,c)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),Je="-transition";class ct extends o.Evented{constructor(r){super(),this._transitionable=new o.Transitionable(ze),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,c={}){if(!this._validate(o.validateLight,r,c))for(const m in r){const _=r[m];o.endsWith(m,Je)?this._transitionable.setTransition(m.slice(0,-Je.length),_):this._transitionable.setValue(m,_)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,m){return(!m||m.validate!==!1)&&o.emitValidationErrors(this,r.call(o.validateStyle,o.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}const nt=new o.Properties({source:new o.DataConstantProperty(o.spec.terrain.source),exaggeration:new o.DataConstantProperty(o.spec.terrain.exaggeration)}),ft="-transition";class Pe extends o.Evented{constructor(r,c){super(),this._transitionable=new o.Transitionable(nt),this.set(r),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=c}get(){return this._transitionable.serialize()}set(r){for(const c in r){const m=r[c];o.endsWith(c,ft)?this._transitionable.setTransition(c.slice(0,-ft.length),m):this._transitionable.setValue(c,m)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}}function at(f,r,c,m){const _=o.smoothstep(45,65,c),[b,C]=jt(f,m),I=o.length(r);let M=1-Math.min(1,Math.exp((I-b)/(C-b)*-6));return M*=M*M,M=Math.min(1,1.00747*M),M*_*f.alpha}function jt(f,r){const c=.5/Math.tan(.5*r);return[f.range[0]+c,f.range[1]+c]}const pt=new o.Properties({range:new o.DataConstantProperty(o.spec.fog.range),color:new o.DataConstantProperty(o.spec.fog.color),"high-color":new o.DataConstantProperty(o.spec.fog["high-color"]),"space-color":new o.DataConstantProperty(o.spec.fog["space-color"]),"horizon-blend":new o.DataConstantProperty(o.spec.fog["horizon-blend"]),"star-intensity":new o.DataConstantProperty(o.spec.fog["star-intensity"])}),zt="-transition";class Gt extends o.Evented{constructor(r,c){super(),this._transitionable=new o.Transitionable(pt),this.set(r),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const r=this._transform,c=r.projection.name==="globe",m=o.globeToMercatorTransition(r.zoom),_=this.properties.get("range"),b=[.5,3];return{range:c?[o.number(b[0],_[0],m),o.number(b[1],_[1],m)]:_,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,c={}){if(!this._validate(o.validateFog,r,c)){for(const m of Object.keys(o.spec.fog))r&&r[m]===void 0&&(r[m]=o.spec.fog[m].default);for(const m in r){const _=r[m];o.endsWith(m,zt)?this._transitionable.setTransition(m.slice(0,-zt.length),_):this._transitionable.setValue(m,_)}}}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.smoothstep(45,65,r))*c.a}getOpacityAtLatLng(r,c){return this._transform.projection.supportsFog?function(m,_,b){const C=o.MercatorCoordinate.fromLngLat(_),I=b.elevation?b.elevation.getAtPointOrZero(C):0,M=[C.x,C.y,I];return o.transformMat4(M,M,b.mercatorFogMatrix),at(m,M,b.pitch,b._fov)}(this.state,r,c):0}getFovAdjustedRange(r){return this._transform.projection.supportsFog?jt(this.state,r):[0,1]}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,m){return(!m||m.validate!==!1)&&o.emitValidationErrors(this,r.call(o.validateStyle,o.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class zn{constructor(r,c){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const m=this.workerPool.acquire(this.id);for(let _=0;_<m.length;_++){const b=new zn.Actor(m[_],c,this.id);b.name=`Worker ${_}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,c,m){o.asyncAll(this.actors,(_,b)=>{_.send(r,c,b)},m=m||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function At(f,r,c){return r*(o.EXTENT/(f.tileSize*Math.pow(2,c-f.tileID.overscaledZ)))}zn.Actor=o.Actor;class Qe{constructor(r,c,m,_){this.screenBounds=r,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,_)}static createFromScreenPoints(r,c){let m,_;if(r instanceof o.pointGeometry||typeof r[0]=="number"){const b=o.pointGeometry.convert(r);m=[b],_=c.isPointAboveHorizon(b)}else{const b=o.pointGeometry.convert(r[0]),C=o.pointGeometry.convert(r[1]);m=[b,C],_=o.polygonizeBounds(b,C).every(I=>c.isPointAboveHorizon(I))}return new Qe(m,c.getCameraPoint(),_,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return o.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const c=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new o.pointGeometry(1,1)):this.screenBounds[1],_=o.polygonizeBounds(c,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<m.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?_[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(_[3]=this.cameraPoint)),o.bufferConvexPolygon(_,r)}bufferedCameraGeometryGlobe(r){const c=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new o.pointGeometry(1,1)):this.screenBounds[1],_=o.polygonizeBounds(c,m,r),b=this.cameraPoint.clone();switch(3*((b.y>c.y)+(b.y>m.y))+((b.x>c.x)+(b.x>m.x))){case 0:_[0]=b,_[4]=b.clone();break;case 1:_.splice(1,0,b);break;case 2:_[1]=b;break;case 3:_.splice(4,0,b);break;case 5:_.splice(2,0,b);break;case 6:_[3]=b;break;case 7:_.splice(3,0,b);break;case 8:_[2]=b}return _}containsTile(r,c,m,_=0){const b=r.queryPadding/c._pixelsPerMercatorPixel+1,C=m?this._bufferedCameraMercator(b,c):this._bufferedScreenMercator(b,c);let I=r.tileID.wrap+(C.unwrapped?_:0);const M=C.polygon.map(te=>o.getTilePoint(r.tileTransform,te,I));if(!o.polygonIntersectsBox(M,0,0,o.EXTENT,o.EXTENT))return;I=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?_:0);const R=this.screenGeometryMercator.polygon.map(te=>o.getTileVec3(r.tileTransform,te,I)),B=R.map(te=>new o.pointGeometry(te[0],te[1])),U=c.getFreeCameraOptions().position||new o.MercatorCoordinate(0,0,0),W=o.getTileVec3(r.tileTransform,U,I),Q=R.map(te=>{const Z=o.sub(te,te,W);return o.normalize(Z,Z),new o.Ray(W,Z)}),J=At(r,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:B,tilespaceRays:Q,bufferedTilespaceGeometry:M,bufferedTilespaceBounds:(ee=o.getBounds(M),ee.min.x=o.clamp(ee.min.x,0,o.EXTENT),ee.min.y=o.clamp(ee.min.y,0,o.EXTENT),ee.max.x=o.clamp(ee.max.x,0,o.EXTENT),ee.max.y=o.clamp(ee.max.y,0,o.EXTENT),ee),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:J};var ee}_bufferedScreenMercator(r,c){const m=Nt(r);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let _;return _=c.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),c):{polygon:this.bufferedScreenGeometry(r).map(b=>c.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[m]=_,_}}_bufferedCameraMercator(r,c){const m=Nt(r);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let _;return _=c.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),c):{polygon:this.bufferedCameraGeometry(r).map(b=>c.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[m]=_,_}}_projectAndResample(r,c){const m=function(b,C){const I=o.multiply([],C.pixelMatrix,C.globeMatrix),M=[0,-o.GLOBE_RADIUS,0,1],R=[0,o.GLOBE_RADIUS,0,1],B=[0,0,0,1];o.transformMat4$1(M,M,I),o.transformMat4$1(R,R,I),o.transformMat4$1(B,B,I);const U=new o.pointGeometry(M[0]/M[3],M[1]/M[3]),W=new o.pointGeometry(R[0]/R[3],R[1]/R[3]),Q=o.polygonContainsPoint(b,U)&&M[3]<B[3],J=o.polygonContainsPoint(b,W)&&R[3]<B[3];if(!Q&&!J)return null;const ee=function(Ae,Be,Ne){for(let Ge=1;Ge<Ae.length;Ge++){const bt=Tt(Be.pointCoordinate3D(Ae[Ge-1]).x),Fe=Tt(Be.pointCoordinate3D(Ae[Ge]).x);if(Ne<0){if(bt<Fe)return{idx:Ge,t:-bt/(Fe-1-bt)}}else if(Fe<bt)return{idx:Ge,t:(1-bt)/(Fe+1-bt)}}return null}(b,C,Q?-1:1);if(!ee)return null;const{idx:te,t:Z}=ee;let ce=te>1?xt(b.slice(0,te),C):[],ae=te<b.length?xt(b.slice(te),C):[];ce=ce.map(Ae=>new o.pointGeometry(Tt(Ae.x),Ae.y)),ae=ae.map(Ae=>new o.pointGeometry(Tt(Ae.x),Ae.y));const fe=[...ce];fe.length===0&&fe.push(ae[ae.length-1]);const Ce=o.number(fe[fe.length-1].y,(ae.length===0?ce[0]:ae[0]).y,Z);let we;return we=Q?[new o.pointGeometry(0,Ce),new o.pointGeometry(0,0),new o.pointGeometry(1,0),new o.pointGeometry(1,Ce)]:[new o.pointGeometry(1,Ce),new o.pointGeometry(1,1),new o.pointGeometry(0,1),new o.pointGeometry(0,Ce)],fe.push(...we),ae.length===0?fe.push(ce[0]):fe.push(...ae),{polygon:fe.map(Ae=>new o.MercatorCoordinate(Ae.x,Ae.y)),unwrapped:!1}}(r,c);if(m)return m;const _=function(b,C){let I=!1,M=-1/0,R=0;for(let U=0;U<b.length-1;U++)b[U].x>M&&(M=b[U].x,R=U);for(let U=0;U<b.length-1;U++){const W=(R+U)%(b.length-1),Q=b[W],J=b[W+1];Math.abs(Q.x-J.x)>.5&&(Q.x<J.x?(Q.x+=1,W===0&&(b[b.length-1].x+=1)):(J.x+=1,W+1===b.length-1&&(b[0].x+=1)),I=!0)}const B=o.mercatorXfromLng(C.center.lng);return I&&B<Math.abs(B-1)&&b.forEach(U=>{U.x-=1}),{polygon:b,unwrapped:I}}(xt(r,c).map(b=>new o.pointGeometry(Tt(b.x),b.y)),c);return{polygon:_.polygon.map(b=>new o.MercatorCoordinate(b.x,b.y)),unwrapped:_.unwrapped}}}function xt(f,r){return o.resample(f,c=>{const m=r.pointCoordinate3D(c);c.x=m.x,c.y=m.y},1/256)}function Tt(f){return f<0?1+f%1:f%1}function Nt(f){return 100*f|0}function fn(f,r,c,m,_){const b=function(C,I){if(C)return _(C);if(I){f.url&&I.tiles&&f.tiles&&delete f.tiles;const M=o.pick(o.extend(I,f),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(M.vectorLayers=I.vector_layers,M.vectorLayerIds=M.vectorLayers.map(R=>R.id)),M.tiles=r.canonicalizeTileset(M,f.url),_(null,M)}};return f.url?o.getJSON(r.transformRequest(r.normalizeSourceURL(f.url,null,c,m),o.ResourceType.Source),b):o.exported.frame(()=>b(null,f))}class Dn{constructor(r,c,m){this.bounds=o.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=c||0,this.maxzoom=m||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const c=Math.pow(2,r.z),m=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*c),_=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*c),b=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*c),C=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*c);return r.x>=m&&r.x<b&&r.y>=_&&r.y<C}}class gn{constructor(r,c,m){this.context=r;const _=r.gl;this.buffer=_.createBuffer(),this.dynamicDraw=Boolean(m),this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ue={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Me{constructor(r,c,m,_){this.length=c.length,this.attributes=m,this.itemSize=c.bytesPerElement,this.dynamicDraw=_,this.context=r;const b=r.gl;this.buffer=b.createBuffer(),r.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,c){for(let m=0;m<this.attributes.length;m++){const _=c.attributes[this.attributes[m].name];_!==void 0&&r.enableVertexAttribArray(_)}}setVertexAttribPointers(r,c,m){for(let _=0;_<this.attributes.length;_++){const b=this.attributes[_],C=c.attributes[b.name];C!==void 0&&r.vertexAttribPointer(C,b.components,r[ue[b.type]],!1,this.itemSize,b.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class qe{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class st extends qe{getDefault(){return o.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class yt extends qe{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Lt extends qe{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Vt extends qe{getDefault(){return[!0,!0,!0,!0]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Mt extends qe{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Ot extends qe{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class wt extends qe{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const c=this.current;(r.func!==c.func||r.ref!==c.ref||r.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Kt extends qe{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Zt extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=r,this.dirty=!1}}class rn extends qe{getDefault(){return[0,1]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class dn extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=r,this.dirty=!1}}class Sn extends qe{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Un extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.BLEND):c.disable(c.BLEND),this.current=r,this.dirty=!1}}class jn extends qe{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class fi extends qe{getDefault(){return o.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class tr extends qe{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Gi extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=r,this.dirty=!1}}class ss extends qe{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Mr extends qe{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class po extends qe{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Ki extends qe{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class sr extends qe{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Ro extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Fs extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ml extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Vs extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class io extends qe{getDefault(){return null}set(r){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class $s extends qe{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class Bc extends qe{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class Oc extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class ya extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Ns extends qe{constructor(r,c){super(r),this.context=r,this.parent=c}getDefault(){return null}}class jr extends Ns{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class as extends Ns{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Fc extends as{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Us{constructor(r,c,m,_){this.context=r,this.width=c,this.height=m;const b=this.framebuffer=r.gl.createFramebuffer();this.colorAttachment=new jr(r,b),_&&(this.depthAttachment=new as(r,b))}destroy(){const r=this.context.gl,c=this.colorAttachment.get();if(c&&r.deleteTexture(c),this.depthAttachment){const m=this.depthAttachment.get();m&&r.deleteRenderbuffer(m)}r.deleteFramebuffer(this.framebuffer)}}class oe{constructor(r,c=!1){if(this.gl=r,this.isWebGL2=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),c){const m=r;this.extVertexArrayObject={createVertexArrayOES:m.createVertexArray.bind(r),deleteVertexArrayOES:m.deleteVertexArray.bind(r),bindVertexArrayOES:m.bindVertexArray.bind(r)}}this.clearColor=new st(this),this.clearDepth=new yt(this),this.clearStencil=new Lt(this),this.colorMask=new Vt(this),this.depthMask=new Mt(this),this.stencilMask=new Ot(this),this.stencilFunc=new wt(this),this.stencilOp=new Kt(this),this.stencilTest=new Zt(this),this.depthRange=new rn(this),this.depthTest=new dn(this),this.depthFunc=new Sn(this),this.blend=new Un(this),this.blendFunc=new jn(this),this.blendColor=new fi(this),this.blendEquation=new tr(this),this.cullFace=new Gi(this),this.cullFaceSide=new ss(this),this.frontFace=new Mr(this),this.program=new po(this),this.activeTexture=new Ki(this),this.viewport=new sr(this),this.bindFramebuffer=new Ro(this),this.bindRenderbuffer=new Fs(this),this.bindTexture=new ml(this),this.bindVertexBuffer=new Vs(this),this.bindElementBuffer=new io(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new $s(this),this.pixelStoreUnpack=new Bc(this),this.pixelStoreUnpackPremultiplyAlpha=new Oc(this),this.pixelStoreUnpackFlipY=new ya(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),c||(this.extTextureHalfFloat=r.getExtension("OES_texture_half_float")),(c||this.extTextureHalfFloat&&r.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=c||r.getExtension("OES_standard_derivatives"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,c){return new gn(this,r,c)}createVertexBuffer(r,c,m){return new Me(this,r,c,m)}createRenderbuffer(r,c,m){const _=this.gl,b=_.createRenderbuffer();return this.bindRenderbuffer.set(b),_.renderbufferStorage(_.RENDERBUFFER,r,c,m),this.bindRenderbuffer.set(null),b}createFramebuffer(r,c,m){return new Us(this,r,c,m)}clear({color:r,depth:c,stencil:m}){const _=this.gl;let b=0;r&&(b|=_.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(b|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),m!==void 0&&(b|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),_.clear(b)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){w(r.blendFunction,o.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class N extends o.Evented{constructor(r,c,m,_){if(super(),this.id=r,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(c,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new o.DedupedRequest}load(r){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map._worldview;this._tileJSONRequest=fn(this._options,this.map._requestManager,c,m,(_,b)=>{this._tileJSONRequest=null,this._loaded=!0,_?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),m&&m.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new o.ErrorEvent(_))):b&&(o.extend(this,b),b.bounds&&(this.tileBounds=new Dn(b.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(b.tiles,this.map._requestManager._customAccessToken),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),r&&r(_)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}loadTile(r,c){const m=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(m,o.ResourceType.Tile),data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile};if(_.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=c:r.request=r.actor.send("reloadTile",_,b.bind(this));else if(r.actor=this._tileWorkers[m]=this._tileWorkers[m]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",_,b.bind(this),void 0,!0);else{const C=o.loadVectorTile.call({deduped:this._deduped},_,(I,M)=>{I||!M?b.call(this,I):(_.data={cacheControl:M.cacheControl,expires:M.expires,rawData:M.rawData.slice(0)},r.actor&&r.actor.send("loadTile",_,b.bind(this),void 0,!0))},!0);r.request={cancel:C}}function b(C,I){return delete r.request,r.aborted?c(null):C&&C.status!==404?c(C):(I&&I.resourceTiming&&(r.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&r.setExpiryData(I),r.loadVectorData(I,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id})}unloadTile(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class q extends o.Evented{constructor(r,c,m,_){super(),this.id=r,this.dispatcher=m,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},c),o.extend(this,o.pick(c,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=fn(this._options,this.map._requestManager,null,null,(c,m)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new o.ErrorEvent(c)):m&&(o.extend(this,m),m.bounds&&(this.tileBounds=new Dn(m.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(m.tiles),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),r&&r(c)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,c){const m=o.exported.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);r.request=o.getImage(this.map._requestManager.transformRequest(_,o.ResourceType.Tile),(b,C,I,M)=>(delete r.request,r.aborted?(r.state="unloaded",c(null)):b?(r.state="errored",c(b)):C?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:I,expires:M}),r.setTexture(C,this.map.painter),r.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(r,c,m){r.setTexture(c,m)}static unloadTileData(r,c){r.texture&&c.saveTileTexture(r.texture)}abortTile(r,c){r.request&&(r.request.cancel(),delete r.request),c()}unloadTile(r,c){r.texture&&this.map.painter.saveTileTexture(r.texture),c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let re;function me(f,r,c,m,_,b,C,I){const M=[f,c,_,r,m,b,1,1,1],R=[C,I,1],B=o.adjoint([],M),[U,W,Q]=o.transformMat3(R,R,o.transpose(B,B));return o.multiply$1(M,[U,0,0,0,W,0,0,0,Q],M)}class Ie extends o.Evented{constructor(r,c,m,_){super(),this.id=r,this.dispatcher=m,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=c,this._dirty=!1}load(r,c){this._loaded=c||!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(m,_)=>{if(this._imageRequest=null,this._loaded=!0,m)this.fire(new o.ErrorEvent(m));else if(_){const{HTMLImageElement:b}=o.window;this.image=_ instanceof b?o.exported.getImageData(_):_,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading()}})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(r){this.coordinates=r,this._boundsArray=void 0;const c=r.map(o.MercatorCoordinate.fromLngLat);return this.tileID=function(m){let _=1/0,b=1/0,C=-1/0,I=-1/0;for(const U of m)_=Math.min(_,U.x),b=Math.min(b,U.y),C=Math.max(C,U.x),I=Math.max(I,U.y);const M=Math.max(C-_,I-b),R=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),B=Math.pow(2,R);return new o.CanonicalTileID(R,Math.floor((_+C)/2*B),Math.floor((b+I)/2*B))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(r){for(const M in this.tiles){const R=this.tiles[M];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture)}if(this._boundsArray)return;const c=o.tileTransform(this.tileID,this.map.transform.projection),[m,_,b,C]=this.coordinates.map(M=>{const R=c.projection.project(M[0],M[1]);return o.getTilePoint(c,R)._round()});this.perspectiveTransform=function(M,R,B,U,W,Q,J,ee,te,Z){const ce=me(0,0,M,0,0,R,M,R),ae=me(B,U,W,Q,J,ee,te,Z);return o.multiply$1(ae,o.adjoint(ce,ce),ae),[ae[6]/ae[8]*M/o.EXTENT,ae[7]/ae[8]*R/o.EXTENT]}(this.width,this.height,m.x,m.y,_.x,_.y,C.x,C.y,b.x,b.y);const I=this._boundsArray=new o.StructArrayLayout4i8;I.emplaceBack(m.x,m.y,0,0),I.emplaceBack(_.x,_.y,o.EXTENT,0),I.emplaceBack(C.x,C.y,0,o.EXTENT),I.emplaceBack(b.x,b.y,o.EXTENT,o.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=r.createVertexBuffer(I,o.boundsAttributes.members),this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,c=r.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new o.Texture(r,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(r)}loadTile(r,c){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},c(null)):(r.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Oe={vector:N,raster:q,"raster-dem":class extends q{constructor(f,r,c,m){super(f,r,c,m),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(f,r){const c=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(_,b){_&&(f.state="errored",r(_)),b&&(f.dem=b,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",r(null))}f.request=o.getImage(this.map._requestManager.transformRequest(c,o.ResourceType.Tile),function(_,b,C,I){if(delete f.request,f.aborted)f.state="unloaded",r(null);else if(_)f.state="errored",r(_);else if(b){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:C,expires:I});const M=o.window.ImageBitmap&&b instanceof o.window.ImageBitmap&&(re==null&&(re=o.window.OffscreenCanvas&&new o.window.OffscreenCanvas(1,1).getContext("2d")&&typeof o.window.createImageBitmap=="function"),re),R=1-(b.width-o.prevPowerOfTwo(b.width))/2;R<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const B=M?b:o.exported.getImageData(b,R),U={uid:f.uid,coord:f.tileID,source:this.id,rawImageData:B,encoding:this.encoding,padding:R};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",U,m.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(f){const r=f.canonical,c=Math.pow(2,r.z),m=(r.x-1+c)%c,_=r.x===0?f.wrap-1:f.wrap,b=(r.x+1+c)%c,C=r.x+1===c?f.wrap+1:f.wrap,I={};return I[new o.OverscaledTileID(f.overscaledZ,_,r.z,m,r.y).key]={backfilled:!1},I[new o.OverscaledTileID(f.overscaledZ,C,r.z,b,r.y).key]={backfilled:!1},r.y>0&&(I[new o.OverscaledTileID(f.overscaledZ,_,r.z,m,r.y-1).key]={backfilled:!1},I[new o.OverscaledTileID(f.overscaledZ,f.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},I[new o.OverscaledTileID(f.overscaledZ,C,r.z,b,r.y-1).key]={backfilled:!1}),r.y+1<c&&(I[new o.OverscaledTileID(f.overscaledZ,_,r.z,m,r.y+1).key]={backfilled:!1},I[new o.OverscaledTileID(f.overscaledZ,f.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},I[new o.OverscaledTileID(f.overscaledZ,C,r.z,b,r.y+1).key]={backfilled:!1}),I}unloadTile(f){f.demTexture&&this.map.painter.saveTileTexture(f.demTexture),f.fbo&&(f.fbo.destroy(),delete f.fbo),f.dem&&delete f.dem,delete f.neighboringTiles,f.state="unloaded"}},geojson:class extends o.Evented{constructor(f,r,c,m){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(m),this._data=r.data,this._options=o.extend({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const _=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*_,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*_,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:o.EXTENT,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*_,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}getClusterExpansionZoom(f,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id},r),this}getClusterChildren(f,r){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id},r),this}getClusterLeaves(f,r,c,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:f,limit:r,offset:c},m),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.Event("dataloading",{dataType:"source"})),this._loaded=!1;const f=o.extend({},this.workerOptions),r=this._data;typeof r=="string"?(f.request=this.map._requestManager.transformRequest(o.exported.resolveURL(r),o.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,f,(c,m)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new o.ErrorEvent(c));else{const _={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&m&&m.resourceTiming&&m.resourceTiming[this.id]&&(_.resourceTiming=m.resourceTiming[this.id]),this.fire(new o.Event("data",_)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,r){const c=f.actor?"reloadTile":"loadTile";f.actor=this.actor,f.request=this.actor.send(c,{type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(m,_)=>(delete f.request,f.unloadVectorData(),f.aborted?r(null):m?r(m):(f.loadVectorData(_,this.map.painter,c==="reloadTile"),r(null))),void 0,c==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f){f.unloadVectorData(),this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ie{constructor(f,r,c,m){super(f,r,c,m),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const r of f.urls)this.urls.push(this.map._requestManager.transformRequest(r,o.ResourceType.Source).url);o.getVideo(this.urls,(r,c)=>{this._loaded=!0,r?this.fire(new o.ErrorEvent(r)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const r=this.video.seekable;f<r.start(0)||f>r.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,r=f.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(f,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ie,canvas:class extends Ie{constructor(f,r,c,m){super(f,r,c,m),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(b=>typeof b!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${f}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${f}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?(f||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(r,this.canvas,r.gl.RGBA,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends o.Evented{constructor(f,r,c,m){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=r,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Dn(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),o.extend(this,o.pick(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this._map=f,this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:r,y:c,z:m}=f.canonical;return this._implementation.hasTile({x:r,y:c,z:m})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,r){const{x:c,y:m,z:_}=f.tileID.canonical,b=new o.window.AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:c,y:m,z:_},{signal:b.signal})).then(function(C){return delete f.request,f.aborted?(f.state="unloaded",r(null)):C===void 0?(f.state="errored",r(null)):C===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",r(null)):function(I){return I instanceof o.window.ImageData||I instanceof o.window.HTMLCanvasElement||I instanceof o.window.ImageBitmap||I instanceof o.window.HTMLImageElement}(C)?(this.loadTileData(f,C),f.state="loaded",void r(null)):(f.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(C=>{C.code!==20&&(f.state="errored",r(C))}),f.request.cancel=()=>b.abort()}loadTileData(f,r){q.loadTileData(f,r,this._map.painter)}unloadTileData(f){q.unloadTileData(f,this._map.painter)}unloadTile(f,r){if(this.unloadTileData(f),this._implementation.unloadTile){const{x:c,y:m,z:_}=f.tileID.canonical;this._implementation.unloadTile({x:c,y:m,z:_})}r()}abortTile(f,r){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),r()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Re=function(f,r,c,m){const _=new Oe[r.type](f,r,c,m);if(_.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${_.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],_),_};function ke(f,r){const c=o.identity([]);return o.scale(c,c,[.5*f.width,.5*-f.height,1]),o.translate(c,c,[1,-1,0]),o.multiply(c,c,f.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(c)}function Ve(f,r,c,m,_,b,C,I=!1){const M=f.tilesIn(m,C,I);M.sort(Rt);const R=[];for(const U of M)R.push({wrappedTileID:U.tile.tileID.wrapped().key,queryResults:U.tile.queryRenderedFeatures(r,c,f._state,U,_,b,ke(f.transform,U.tile.tileID),I)});const B=function(U){const W={},Q={};for(const J of U){const ee=J.queryResults,te=J.wrappedTileID,Z=Q[te]=Q[te]||{};for(const ce in ee){const ae=ee[ce],fe=Z[ce]=Z[ce]||{},Ce=W[ce]=W[ce]||[];for(const we of ae)fe[we.featureIndex]||(fe[we.featureIndex]=!0,Ce.push(we))}}return W}(R);for(const U in B)B[U].forEach(W=>{const Q=W.feature,J=Q.layer;J&&J.type!=="background"&&J.type!=="sky"&&(Q.source=J.source,J["source-layer"]&&(Q.sourceLayer=J["source-layer"]),Q.state=Q.id!==void 0?f.getFeatureState(J["source-layer"],Q.id):{})});return B}function ut(f,r){const c=f.getRenderableIds().map(b=>f.getTileByID(b)),m=[],_={};for(let b=0;b<c.length;b++){const C=c[b],I=C.tileID.canonical.key;_[I]||(_[I]=!0,C.querySourceFeatures(m,r))}return m}function Rt(f,r){const c=f.tileID,m=r.tileID;return c.overscaledZ-m.overscaledZ||c.canonical.y-m.canonical.y||c.wrap-m.wrap||c.canonical.x-m.canonical.x}function gt(){return ql.workerClass!=null?new ql.workerClass:new o.window.Worker(ql.workerUrl)}const en="mapboxgl_preloaded_worker_pool";class Jt{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Jt.workerCount;)this.workers.push(new gt);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[en]}numActive(){return Object.keys(this.active).length}}let Yt;function cn(){return Yt||(Yt=new Jt),Yt}function vn(f,r){const c={};for(const m in f)m!=="ref"&&(c[m]=f[m]);return o.refProperties.forEach(m=>{m in r&&(c[m]=r[m])}),c}function Gn(f){f=f.slice();const r=Object.create(null);for(let c=0;c<f.length;c++)r[f[c].id]=f[c];for(let c=0;c<f.length;c++)"ref"in f[c]&&(f[c]=vn(f[c],r[f[c].ref]));return f}Jt.workerCount=2;const on={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Jn(f,r,c){c.push({command:on.addSource,args:[f,r[f]]})}function Qn(f,r,c){r.push({command:on.removeSource,args:[f]}),c[f]=!0}function ls(f,r,c,m){Qn(f,c,m),Jn(f,r,c)}function Bo(f,r,c){let m;for(m in f[c])if(f[c].hasOwnProperty(m)&&m!=="data"&&!w(f[c][m],r[c][m]))return!1;for(m in r[c])if(r[c].hasOwnProperty(m)&&m!=="data"&&!w(f[c][m],r[c][m]))return!1;return!0}function et(f,r,c,m,_,b){let C;for(C in r=r||{},f=f||{})f.hasOwnProperty(C)&&(w(f[C],r[C])||c.push({command:b,args:[m,C,r[C],_]}));for(C in r)r.hasOwnProperty(C)&&!f.hasOwnProperty(C)&&(w(f[C],r[C])||c.push({command:b,args:[m,C,r[C],_]}))}function Oo(f){return f.id}function Bi(f,r){return f[r.id]=r,f}class cs{constructor(r,c){this.reset(r,c)}reset(r,c){this.points=r||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=o.clamp(r,0,1);let c=1,m=this._distances[c];const _=r*this.paddedLength+this.padding;for(;m<_&&c<this._distances.length;)m=this._distances[++c];const b=c-1,C=this._distances[b],I=m-C,M=I>0?(_-C)/I:0;return this.points[b].mult(1-M).add(this.points[c].mult(M))}}class $f{constructor(r,c,m){const _=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(r/m),this.yCellCount=Math.ceil(c/m);for(let C=0;C<this.xCellCount*this.yCellCount;C++)_.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=c,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,c,m,_,b){this._forEachCell(c,m,_,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(c),this.bboxes.push(m),this.bboxes.push(_),this.bboxes.push(b)}insertCircle(r,c,m,_){this._forEachCell(c-_,m-_,c+_,m+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(c),this.circles.push(m),this.circles.push(_)}_insertBoxCell(r,c,m,_,b,C){this.boxCells[b].push(C)}_insertCircleCell(r,c,m,_,b,C){this.circleCells[b].push(C)}_query(r,c,m,_,b,C){if(m<0||r>this.width||_<0||c>this.height)return!b&&[];const I=[];if(r<=0&&c<=0&&this.width<=m&&this.height<=_){if(b)return!0;for(let M=0;M<this.boxKeys.length;M++)I.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const R=this.circles[3*M],B=this.circles[3*M+1],U=this.circles[3*M+2];I.push({key:this.circleKeys[M],x1:R-U,y1:B-U,x2:R+U,y2:B+U})}return C?I.filter(C):I}return this._forEachCell(r,c,m,_,this._queryCell,I,{hitTest:b,seenUids:{box:{},circle:{}}},C),b?I.length>0:I}_queryCircle(r,c,m,_,b){const C=r-m,I=r+m,M=c-m,R=c+m;if(I<0||C>this.width||R<0||M>this.height)return!_&&[];const B=[];return this._forEachCell(C,M,I,R,this._queryCellCircle,B,{hitTest:_,circle:{x:r,y:c,radius:m},seenUids:{box:{},circle:{}}},b),_?B.length>0:B}query(r,c,m,_,b){return this._query(r,c,m,_,!1,b)}hitTest(r,c,m,_,b){return this._query(r,c,m,_,!0,b)}hitTestCircle(r,c,m,_){return this._queryCircle(r,c,m,!0,_)}_queryCell(r,c,m,_,b,C,I,M){const R=I.seenUids,B=this.boxCells[b];if(B!==null){const W=this.bboxes;for(const Q of B)if(!R.box[Q]){R.box[Q]=!0;const J=4*Q;if(r<=W[J+2]&&c<=W[J+3]&&m>=W[J+0]&&_>=W[J+1]&&(!M||M(this.boxKeys[Q]))){if(I.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[Q],x1:W[J],y1:W[J+1],x2:W[J+2],y2:W[J+3]})}}}const U=this.circleCells[b];if(U!==null){const W=this.circles;for(const Q of U)if(!R.circle[Q]){R.circle[Q]=!0;const J=3*Q;if(this._circleAndRectCollide(W[J],W[J+1],W[J+2],r,c,m,_)&&(!M||M(this.circleKeys[Q]))){if(I.hitTest)return C.push(!0),!0;{const ee=W[J],te=W[J+1],Z=W[J+2];C.push({key:this.circleKeys[Q],x1:ee-Z,y1:te-Z,x2:ee+Z,y2:te+Z})}}}}}_queryCellCircle(r,c,m,_,b,C,I,M){const R=I.circle,B=I.seenUids,U=this.boxCells[b];if(U!==null){const Q=this.bboxes;for(const J of U)if(!B.box[J]){B.box[J]=!0;const ee=4*J;if(this._circleAndRectCollide(R.x,R.y,R.radius,Q[ee+0],Q[ee+1],Q[ee+2],Q[ee+3])&&(!M||M(this.boxKeys[J])))return C.push(!0),!0}}const W=this.circleCells[b];if(W!==null){const Q=this.circles;for(const J of W)if(!B.circle[J]){B.circle[J]=!0;const ee=3*J;if(this._circlesCollide(Q[ee],Q[ee+1],Q[ee+2],R.x,R.y,R.radius)&&(!M||M(this.circleKeys[J])))return C.push(!0),!0}}}_forEachCell(r,c,m,_,b,C,I,M){const R=this._convertToXCellCoord(r),B=this._convertToYCellCoord(c),U=this._convertToXCellCoord(m),W=this._convertToYCellCoord(_);for(let Q=R;Q<=U;Q++)for(let J=B;J<=W;J++)if(b.call(this,r,c,m,_,this.xCellCount*J+Q,C,I,M))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,c,m,_,b,C){const I=_-r,M=b-c,R=m+C;return R*R>I*I+M*M}_circleAndRectCollide(r,c,m,_,b,C,I){const M=(C-_)/2,R=Math.abs(r-(_+M));if(R>M+m)return!1;const B=(I-b)/2,U=Math.abs(c-(b+B));if(U>B+m)return!1;if(R<=M||U<=B)return!0;const W=R-M,Q=U-B;return W*W+Q*Q<=m*m}}const mo=Math.tan(85*Math.PI/180);function xa(f,r,c,m,_,b,C){const I=o.create();if(c)if(b.name==="globe"){const M=o.calculateGlobeLabelMatrix(_,r);o.multiply(I,I,M)}else{const M=Se([],C);I[0]=M[0],I[1]=M[1],I[4]=M[2],I[5]=M[3],m||o.rotateZ(I,I,_.angle)}else o.multiply(I,_.labelPlaneMatrix,f);return I}function Nf(f,r,c,m,_,b,C){const I=xa(f,r,c,m,_,b,C);return b.name==="globe"&&c||(I[2]=I[6]=I[10]=I[14]=0),I}function ba(f,r,c,m,_,b,C){if(c){if(b.name==="globe"){const I=xa(f,r,c,m,_,b,C);return o.invert(I,I),o.multiply(I,f,I),I}{const I=o.clone(f),M=o.identity([]);return M[0]=C[0],M[1]=C[1],M[4]=C[2],M[5]=C[3],o.multiply(I,I,M),m||o.rotateZ(I,I,-_.angle),I}}return _.glCoordMatrix}function Et(f,r,c,m){const _=[f,r,c,1];c?o.transformMat4$1(_,_,m):Uf(_,_,m);const b=_[3];return _[0]/=b,_[1]/=b,_[2]/=b,_}function Pn(f,r){return Math.min(.5+f/r*.5,1.5)}function Tn(f,r){const c=f[0]/f[3],m=f[1]/f[3];return c>=-r[0]&&c<=r[0]&&m>=-r[1]&&m<=r[1]}function go(f,r,c,m,_,b,C,I,M,R){const B=c.transform,U=m?f.textSizeData:f.iconSizeData,W=o.evaluateSizeForZoom(U,c.transform.zoom),Q=B.projection.name==="globe",J=[256/c.width*2+1,256/c.height*2+1],ee=m?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;ee.clear();let te=null;Q&&(te=m?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const Z=f.lineVertexArray,ce=m?f.text.placedSymbolArray:f.icon.placedSymbolArray,ae=c.transform.width/c.transform.height;let fe,Ce=!1;for(let we=0;we<ce.length;we++){const Ae=ce.get(we),{numGlyphs:Be,writingMode:Ne}=Ae;if(Ne!==o.WritingMode.vertical||Ce||fe===o.WritingMode.horizontal||(Ce=!0),fe=Ne,(Ae.hidden||Ne===o.WritingMode.vertical)&&!Ce){si(Be,ee);continue}Ce=!1;const Ge=new o.pointGeometry(Ae.tileAnchorX,Ae.tileAnchorY);let{x:bt,y:Fe,z:rt}=B.projection.projectTilePoint(Ge.x,Ge.y,R.canonical);if(M){const[mn,Ut,Ft]=M(Ge);bt+=mn,Fe+=Ut,rt+=Ft}const He=[bt,Fe,rt,1];if(o.transformMat4$1(He,He,r),!Tn(He,J)){si(Be,ee);continue}const ht=Pn(c.transform.cameraToCenterDistance,He[3]),Ue=o.evaluateSizeForFeature(U,W,Ae),Le=C?Ue/ht:Ue*ht,Ze=Et(bt,Fe,rt,_);if(Ze[3]<=0){si(Be,ee);continue}let lt={};const mt=C?null:M,Wt=gl(Ae,Le,!1,I,r,_,b,f.glyphOffsetArray,Z,ee,te,Ze,Ge,lt,ae,mt,B.projection,R,C);Ce=Wt.useVertical,mt&&Wt.needsFlipping&&(lt={}),(Wt.notEnoughRoom||Ce||Wt.needsFlipping&&gl(Ae,Le,!0,I,r,_,b,f.glyphOffsetArray,Z,ee,te,Ze,Ge,lt,ae,mt,B.projection,R,C).notEnoughRoom)&&si(Be,ee)}m?(f.text.dynamicLayoutVertexBuffer.updateData(ee),te&&f.text.globeExtVertexBuffer.updateData(te)):(f.icon.dynamicLayoutVertexBuffer.updateData(ee),te&&f.icon.globeExtVertexBuffer.updateData(te))}function js(f,r,c,m,_,b,C,I,M,R,B,U,W,Q,J,ee){const{lineStartIndex:te,glyphStartIndex:Z,segment:ce}=I,ae=Z+I.numGlyphs,fe=te+I.lineLength,Ce=r.getoffsetX(Z),we=r.getoffsetX(ae-1),Ae=Er(f*Ce,c,m,_,b,C,ce,te,fe,M,R,B,U,W,!0,Q,J,ee);if(!Ae)return null;const Be=Er(f*we,c,m,_,b,C,ce,te,fe,M,R,B,U,W,!0,Q,J,ee);return Be?{first:Ae,last:Be}:null}function yn(f,r,c,m){return f===o.WritingMode.horizontal&&Math.abs(m)>Math.abs(c)?{useVertical:!0}:f===o.WritingMode.vertical?m>0?{needsFlipping:!0}:null:r!==0&&function(_,b){return _===0||Math.abs(b/_)>mo}(c,m)?r===1?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null}function gl(f,r,c,m,_,b,C,I,M,R,B,U,W,Q,J,ee,te,Z,ce){const ae=r/24,fe=f.lineOffsetX*ae,Ce=f.lineOffsetY*ae,{lineStartIndex:we,glyphStartIndex:Ae,numGlyphs:Be,segment:Ne,writingMode:Ge,flipState:bt}=f,Fe=we+f.lineLength,rt=He=>{if(B){const[Ze,lt,mt]=He.up,Wt=R.length;o.updateGlobeVertexNormal(B,Wt+0,Ze,lt,mt),o.updateGlobeVertexNormal(B,Wt+1,Ze,lt,mt),o.updateGlobeVertexNormal(B,Wt+2,Ze,lt,mt),o.updateGlobeVertexNormal(B,Wt+3,Ze,lt,mt)}const[ht,Ue,Le]=He.point;o.addDynamicAttributes(R,ht,Ue,Le,He.angle)};if(Be>1){const He=js(ae,I,fe,Ce,c,U,W,f,M,b,Q,ee,!1,te,Z,ce);if(!He)return{notEnoughRoom:!0};if(m&&!c){let[ht,Ue,Le]=He.first.point,[Ze,lt,mt]=He.last.point;[ht,Ue]=Et(ht,Ue,Le,C),[Ze,lt]=Et(Ze,lt,mt,C);const Wt=yn(Ge,bt,(Ze-ht)*J,lt-Ue);if(f.flipState=Wt&&Wt.needsFlipping?1:2,Wt)return Wt}rt(He.first);for(let ht=Ae+1;ht<Ae+Be-1;ht++){const Ue=Er(ae*I.getoffsetX(ht),fe,Ce,c,U,W,Ne,we,Fe,M,b,Q,ee,!1,!1,te,Z,ce);if(!Ue)return R.length-=4*(ht-Ae),{notEnoughRoom:!0};rt(Ue)}rt(He.last)}else{if(m&&!c){const ht=Et(W.x,W.y,0,_),Ue=we+Ne+1,Le=new o.pointGeometry(M.getx(Ue),M.gety(Ue)),Ze=Et(Le.x,Le.y,0,_),lt=Ze[3]>0?Ze:Sa(W,Le,ht,1,_,void 0,te,Z.canonical),mt=yn(Ge,bt,(lt[0]-ht[0])*J,lt[1]-ht[1]);if(f.flipState=mt&&mt.needsFlipping?1:2,mt)return mt}const He=Er(ae*I.getoffsetX(Ae),fe,Ce,c,U,W,Ne,we,Fe,M,b,Q,ee,!1,!1,te,Z,ce);if(!He)return{notEnoughRoom:!0};rt(He)}return{}}function wa(f,r,c,m,_){const{x:b,y:C,z:I}=m.projectTilePoint(f.x,f.y,r);if(!_)return Et(b,C,I,c);const[M,R,B]=_(f);return Et(b+M,C+R,I+B,c)}function Sa(f,r,c,m,_,b,C,I){const M=wa(f.sub(r)._unit()._add(f),I,_,C,b);return o.sub(M,c,M),o.normalize(M,M),o.scaleAndAdd(M,c,M,m)}function Er(f,r,c,m,_,b,C,I,M,R,B,U,W,Q,J,ee,te,Z){const ce=m?f-r:f+r;let ae=ce>0?1:-1,fe=0;m&&(ae*=-1,fe=Math.PI),ae<0&&(fe+=Math.PI);let Ce=I+C+(ae>0?0:1)|0,we=_,Ae=_,Be=0,Ne=0;const Ge=Math.abs(ce),bt=[],Fe=[];let rt=b,He=rt;const ht=()=>Sa(He,rt,Ae,Ge-Be+1,B,W,ee,te.canonical);for(;Be+Ne<=Ge;){if(Ce+=ae,Ce<I||Ce>=M)return null;if(Ae=we,He=rt,bt.push(Ae),Q&&Fe.push(He),rt=new o.pointGeometry(R.getx(Ce),R.gety(Ce)),we=U[Ce],!we){const Ft=wa(rt,te.canonical,B,ee,W);we=Ft[3]>0?U[Ce]=Ft:ht()}Be+=Ne,Ne=o.distance(Ae,we)}J&&W&&(U[Ce]&&(we=ht(),Ne=o.distance(Ae,we)),U[Ce]=we);const Ue=(Ge-Be)/Ne,Le=rt.sub(He)._mult(Ue)._add(He),Ze=o.sub([],we,Ae),lt=o.scaleAndAdd([],Ae,Ze,Ue);let mt=[0,0,1],Wt=Ze[0],mn=Ze[1];if(Z&&(mt=ee.upVector(te.canonical,Le.x,Le.y),mt[0]!==0||mt[1]!==0||mt[2]!==1)){const Ft=[mt[2],0,-mt[0]],Ht=o.cross([],mt,Ft);o.normalize(Ft,Ft),o.normalize(Ht,Ht),Wt=o.dot(Ze,Ft),mn=o.dot(Ze,Ht)}if(c){const Ft=o.cross([],mt,Ze);o.normalize(Ft,Ft),o.scaleAndAdd(lt,lt,Ft,c*ae)}const Ut=fe+Math.atan2(mn,Wt);return bt.push(lt),Q&&Fe.push(Le),{point:lt,angle:Ut,path:bt,tilePath:Fe,up:mt}}function si(f,r){const c=r.length,m=c+4*f;r.resize(m),r.float32.fill(-1/0,4*c,4*m)}function Uf(f,r,c){const m=r[0],_=r[1];return f[0]=c[0]*m+c[4]*_+c[12],f[1]=c[1]*m+c[5]*_+c[13],f[3]=c[3]*m+c[7]*_+c[15],f}const Pr=100;class vh{constructor(r,c,m=new $f(r.width+200,r.height+200,25),_=new $f(r.width+200,r.height+200,25)){this.transform=r,this.grid=m,this.ignoredGrid=_,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Pr,this.screenBottomBoundary=r.height+Pr,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=c}placeCollisionBox(r,c,m,_,b,C,I,M){let R=m.projectedAnchorX,B=m.projectedAnchorY,U=m.projectedAnchorZ;const W=m.elevation,Q=m.tileID,J=r.getProjection();if(W&&Q){const[we,Ae,Be]=J.upVector(Q.canonical,m.tileAnchorX,m.tileAnchorY),Ne=J.upVectorScale(Q.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;R+=we*W*Ne,B+=Ae*W*Ne,U+=Be*W*Ne}const ee=this.projectAndGetPerspectiveRatio(I,R,B,U,m.tileID,J.name==="globe"||!!W||this.transform.pitch>0,J),te=C*ee.perspectiveRatio,Z=(m.x1*c+_.x-m.padding)*te+ee.point.x,ce=(m.y1*c+_.y-m.padding)*te+ee.point.y,ae=(m.x2*c+_.x+m.padding)*te+ee.point.x,fe=(m.y2*c+_.y+m.padding)*te+ee.point.y,Ce=ee.perspectiveRatio<=.55||ee.occluded;return!this.isInsideGrid(Z,ce,ae,fe)||!b&&this.grid.hitTest(Z,ce,ae,fe,M)||Ce?{box:[],offscreen:!1,occluded:ee.occluded}:{box:[Z,ce,ae,fe],offscreen:this.isOffscreen(Z,ce,ae,fe),occluded:!1}}placeCollisionCircles(r,c,m,_,b,C,I,M,R,B,U,W,Q,J,ee){const te=[],Z=this.transform.elevation,ce=r.getProjection(),ae=Z?Z.getAtTileOffsetFunc(ee,this.transform.center.lat,this.transform.worldSize,ce):null,fe=new o.pointGeometry(m.tileAnchorX,m.tileAnchorY);let{x:Ce,y:we,z:Ae}=ce.projectTilePoint(fe.x,fe.y,ee.canonical);if(ae){const[Le,Ze,lt]=ae(fe);Ce+=Le,we+=Ze,Ae+=lt}const Be=ce.name==="globe",Ne=this.projectAndGetPerspectiveRatio(I,Ce,we,Ae,ee,Be||!!Z||this.transform.pitch>0,ce),{perspectiveRatio:Ge}=Ne,bt=(U?C/Ge:C*Ge)/o.ONE_EM,Fe=Et(Ce,we,Ae,M),rt=Ne.signedDistanceFromCamera>0?js(bt,b,m.lineOffsetX*bt,m.lineOffsetY*bt,!1,Fe,fe,m,_,M,{},Z&&!U?ae:null,U&&!!Z,ce,ee,U):null;let He=!1,ht=!1,Ue=!0;if(rt&&!Ne.occluded){const Le=.5*Q*Ge+J,Ze=new o.pointGeometry(-100,-100),lt=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),mt=new cs,{first:Wt,last:mn}=rt,Ut=Wt.path.length;let Ft=[];for(let Qt=Ut-1;Qt>=1;Qt--)Ft.push(Wt.path[Qt]);for(let Qt=1;Qt<mn.path.length;Qt++)Ft.push(mn.path[Qt]);const Ht=2.5*Le;R&&(Ft=Ft.map(([Qt,Zn,ei],ai)=>(ae&&!Be&&(ei=ae(ai<Ut-1?Wt.tilePath[Ut-1-ai]:mn.tilePath[ai-Ut+2])[2]),Et(Qt,Zn,ei,R))),Ft.some(Qt=>Qt[3]<=0)&&(Ft=[]));let En=[];if(Ft.length>0){let Qt=1/0,Zn=-1/0,ei=1/0,ai=-1/0;for(const ii of Ft)Qt=Math.min(Qt,ii[0]),ei=Math.min(ei,ii[1]),Zn=Math.max(Zn,ii[0]),ai=Math.max(ai,ii[1]);Zn>=Ze.x&&Qt<=lt.x&&ai>=Ze.y&&ei<=lt.y&&(En=[Ft.map(ii=>new o.pointGeometry(ii[0],ii[1]))],(Qt<Ze.x||Zn>lt.x||ei<Ze.y||ai>lt.y)&&(En=o.clipLine(En,Ze.x,Ze.y,lt.x,lt.y)))}for(const Qt of En){mt.reset(Qt,.25*Le);let Zn=0;Zn=mt.length<=.5*Le?1:Math.ceil(mt.paddedLength/Ht)+1;for(let ei=0;ei<Zn;ei++){const ai=ei/Math.max(Zn-1,1),ii=mt.lerp(ai),Oi=ii.x+Pr,Dr=ii.y+Pr;te.push(Oi,Dr,Le,0);const ro=Oi-Le,No=Dr-Le,pi=Oi+Le,ri=Dr+Le;if(Ue=Ue&&this.isOffscreen(ro,No,pi,ri),ht=ht||this.isInsideGrid(ro,No,pi,ri),!c&&this.grid.hitTestCircle(Oi,Dr,Le,W)&&(He=!0,!B))return{circles:[],offscreen:!1,collisionDetected:He,occluded:!1}}}}return{circles:!B&&He||!ht?[]:te,offscreen:Ue,collisionDetected:He,occluded:Ne.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let m=1/0,_=1/0,b=-1/0,C=-1/0;for(const B of r){const U=new o.pointGeometry(B.x+Pr,B.y+Pr);m=Math.min(m,U.x),_=Math.min(_,U.y),b=Math.max(b,U.x),C=Math.max(C,U.y),c.push(U)}const I=this.grid.query(m,_,b,C).concat(this.ignoredGrid.query(m,_,b,C)),M={},R={};for(const B of I){const U=B.key;if(M[U.bucketInstanceId]===void 0&&(M[U.bucketInstanceId]={}),M[U.bucketInstanceId][U.featureIndex])continue;const W=[new o.pointGeometry(B.x1,B.y1),new o.pointGeometry(B.x2,B.y1),new o.pointGeometry(B.x2,B.y2),new o.pointGeometry(B.x1,B.y2)];o.polygonIntersectsPolygon(c,W)&&(M[U.bucketInstanceId][U.featureIndex]=!0,R[U.bucketInstanceId]===void 0&&(R[U.bucketInstanceId]=[]),R[U.bucketInstanceId].push(U.featureIndex))}return R}insertCollisionBox(r,c,m,_,b){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:_,collisionGroupID:b},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,c,m,_,b){const C=c?this.ignoredGrid:this.grid,I={bucketInstanceId:m,featureIndex:_,collisionGroupID:b};for(let M=0;M<r.length;M+=4)C.insertCircle(I,r[M],r[M+1],r[M+2])}projectAndGetPerspectiveRatio(r,c,m,_,b,C,I){const M=[c,m,_,1];let R=!1;if(_||this.transform.pitch>0){o.transformMat4$1(M,M,r);const U=I.name==="globe";this.fogState&&b&&!U&&(R=function(Q,J,ee,te,Z,ce){const ae=ce.calculateFogTileMatrix(Z),fe=[J,ee,te];return o.transformMat4(fe,fe,ae),at(Q,fe,ce.pitch,ce._fov)}(this.fogState,c,m,_,b.toUnwrapped(),this.transform)>.9)}else Uf(M,M,r);const B=M[3];return{point:new o.pointGeometry((M[0]/B+1)/2*this.transform.width+Pr,(-M[1]/B+1)/2*this.transform.height+Pr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/B*.5,1.5),signedDistanceFromCamera:B,occluded:C&&M[2]>B||R}}isOffscreen(r,c,m,_){return m<Pr||r>=this.screenRightBoundary||_<Pr||c>this.screenBottomBoundary}isInsideGrid(r,c,m,_){return m>=0&&r<this.gridRightBoundary&&_>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const r=o.identity([]);return o.translate(r,r,[-100,-100,0]),r}}function Gs(f,r,c){const m=r.createTileMatrix(f,f.worldSize,c.toUnwrapped());return o.multiply(new Float32Array(16),f.projMatrix,m)}function _h(f,r,c){if(r.projection.name===c.projection.name)return f.projMatrix;const m=c.clone();return m.setProjection(r.projection),Gs(m,r.getProjection(),f)}function Vc(f,r,c){return r.name===c.projection.name?f.projMatrix:Gs(c,r,f)}class vl{constructor(r,c,m,_){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?c:-c))):_&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class qs{constructor(r,c,m,_,b,C=!1){this.text=new vl(r?r.text:null,c,m,b),this.icon=new vl(r?r.icon:null,c,_,b),this.clipped=C}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ta{constructor(r,c,m,_=!1){this.text=r,this.icon=c,this.skipFade=m,this.clipped=_}}class yh{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class zr{constructor(r,c,m,_,b){this.bucketInstanceId=r,this.featureIndex=c,this.sourceLayerIndex=m,this.bucketIndex=_,this.tileID=b}}class Li{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const c=++this.maxGroupID;this.collisionGroups[r]={ID:c,predicate:m=>m.collisionGroupID===c}}return this.collisionGroups[r]}}function $c(f,r,c,m,_){const{horizontalAlign:b,verticalAlign:C}=o.getAnchorAlignment(f),I=-(b-.5)*r,M=-(C-.5)*c,R=o.evaluateVariableOffset(f,m);return new o.pointGeometry(I+R[0]*_,M+R[1]*_)}function _l(f,r,c,m,_){const b=new o.pointGeometry(f,r);return c&&b._rotate(m?_:-_),b}class Lr{constructor(r,c,m,_,b){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new vh(this.transform,b),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Li(m),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,c,m,_){const b=m.getBucket(c),C=m.latestFeatureIndex;if(!b||!C||c.id!==b.layerIds[0])return;const I=b.layers[0].layout,M=m.collisionBoxArray,R=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),B=m.tileSize/o.EXTENT,U=m.tileID.toUnwrapped();this.transform.setProjection(b.projection);const W=(Q=m.tileID,J=b.getProjection(),ee=this.transform,J.name===this.projection?ee.calculateProjMatrix(Q.toUnwrapped()):Gs(ee,J,Q));var Q,J,ee;const te=I.get("text-pitch-alignment")==="map",Z=I.get("text-rotation-alignment")==="map";c.compileFilter();const ce=c.dynamicFilter(),ae=c.dynamicFilterNeedsFeature(),fe=this.transform.calculatePixelsToTileUnitsMatrix(m),Ce=Nf(W,m.tileID.canonical,te,Z,this.transform,b.getProjection(),fe);let we=null;if(te){const Ne=ba(W,m.tileID.canonical,te,Z,this.transform,b.getProjection(),fe);we=o.multiply([],this.transform.labelPlaneMatrix,Ne)}let Ae=null;ce&&m.latestFeatureIndex&&(Ae={unwrappedTileID:U,dynamicFilter:ce,dynamicFilterNeedsFeature:ae,featureIndex:m.latestFeatureIndex}),this.retainedQueryData[b.bucketInstanceId]=new zr(b.bucketInstanceId,C,b.sourceLayerIndex,b.index,m.tileID);const Be={bucket:b,layout:I,posMatrix:W,textLabelPlaneMatrix:Ce,labelToScreenMatrix:we,clippingData:Ae,scale:R,textPixelRatio:B,holdingForFade:m.holdingForFade(),collisionBoxArray:M,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.evaluateSizeForZoom(b.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(_)for(const Ne of b.sortKeyRanges){const{sortKey:Ge,symbolInstanceStart:bt,symbolInstanceEnd:Fe}=Ne;r.push({sortKey:Ge,symbolInstanceStart:bt,symbolInstanceEnd:Fe,parameters:Be})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Be})}attemptAnchorPlacement(r,c,m,_,b,C,I,M,R,B,U,W,Q,J,ee,te,Z,ce){const{textOffset0:ae,textOffset1:fe,crossTileID:Ce}=W,we=[ae,fe],Ae=$c(r,m,_,we,b),Be=this.collisionIndex.placeCollisionBox(J,b,c,_l(Ae.x,Ae.y,C,I,this.transform.angle),U,M,R,B.predicate);if(te){const Ne=J.getSymbolInstanceIconSize(ce,this.transform.zoom,W.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(J,Ne,te,_l(Ae.x,Ae.y,C,I,this.transform.angle),U,M,R,B.predicate).box.length===0)return}if(Be.box.length>0){let Ne;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ce]&&this.prevPlacement.placements[Ce]&&this.prevPlacement.placements[Ce].text&&(Ne=this.prevPlacement.variableOffsets[Ce].anchor),this.variableOffsets[Ce]={textOffset:we,width:m,height:_,anchor:r,textScale:b,prevAnchor:Ne},this.markUsedJustification(J,r,W,ee),J.allowVerticalPlacement&&(this.markUsedOrientation(J,ee,W),this.placedOrientations[Ce]=ee),{shift:Ae,placedGlyphBoxes:Be}}}placeLayerBucketPart(r,c,m,_){const{bucket:b,layout:C,posMatrix:I,textLabelPlaneMatrix:M,labelToScreenMatrix:R,clippingData:B,textPixelRatio:U,holdingForFade:W,collisionBoxArray:Q,partiallyEvaluatedTextSize:J,partiallyEvaluatedIconSize:ee,collisionGroup:te}=r.parameters,Z=C.get("text-optional"),ce=C.get("icon-optional"),ae=C.get("text-allow-overlap"),fe=C.get("icon-allow-overlap"),Ce=C.get("text-rotation-alignment")==="map",we=C.get("text-pitch-alignment")==="map",Ae=C.get("icon-text-fit")!=="none",Be=C.get("symbol-z-order")==="viewport-y";this.transform.setProjection(b.projection);let Ne=ae&&(fe||!b.hasIconData()||ce),Ge=fe&&(ae||!b.hasTextData()||Z);!b.collisionArrays&&Q&&b.deserializeCollisionBoxes(Q),m&&_&&b.updateCollisionDebugBuffers(this.transform.zoom,Q);const bt=(Fe,rt,He)=>{const{crossTileID:ht,numVerticalGlyphVertices:Ue}=Fe;if(B){const pi={zoom:this.transform.zoom,pitch:this.transform.pitch};let ri=null;if(B.dynamicFilterNeedsFeature){const $n=this.retainedQueryData[b.bucketInstanceId];ri=B.featureIndex.loadFeature({featureIndex:Fe.featureIndex,bucketIndex:$n.bucketIndex,sourceLayerIndex:$n.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,B.dynamicFilter)(pi,ri,this.retainedQueryData[b.bucketInstanceId].tileID.canonical,new o.pointGeometry(Fe.tileAnchorX,Fe.tileAnchorY),this.transform.calculateDistanceTileData(B.unwrappedTileID)))return this.placements[ht]=new Ta(!1,!1,!1,!0),void(c[ht]=!0)}if(c[ht])return;if(W)return void(this.placements[ht]=new Ta(!1,!1,!1));let Le=!1,Ze=!1,lt=!0,mt=!1,Wt=!1,mn=null,Ut={box:null,offscreen:null,occluded:null},Ft={box:null,offscreen:null,occluded:null},Ht=null,En=null,Qt=null,Zn=0,ei=0,ai=0;He.textFeatureIndex?Zn=He.textFeatureIndex:Fe.useRuntimeCollisionCircles&&(Zn=Fe.featureIndex),He.verticalTextFeatureIndex&&(ei=He.verticalTextFeatureIndex);const ii=pi=>{pi.tileID=this.retainedQueryData[b.bucketInstanceId].tileID;const ri=this.transform.elevation;(ri||pi.elevation)&&(pi.elevation=ri?ri.getAtTileOffset(pi.tileID,pi.tileAnchorX,pi.tileAnchorY):0)},Oi=He.textBox;if(Oi){ii(Oi);const pi=$n=>{let Ci=o.WritingMode.horizontal;if(b.allowVerticalPlacement&&!$n&&this.prevPlacement){const vr=this.prevPlacement.placedOrientations[ht];vr&&(this.placedOrientations[ht]=vr,Ci=vr,this.markUsedOrientation(b,Ci,Fe))}return Ci},ri=($n,Ci)=>{if(b.allowVerticalPlacement&&Ue>0&&He.verticalTextBox){for(const vr of b.writingModes)if(vr===o.WritingMode.vertical?(Ut=Ci(),Ft=Ut):Ut=$n(),Ut&&Ut.box&&Ut.box.length)break}else Ut=$n()};if(C.get("text-variable-anchor")){let $n=C.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ht]){const ui=this.prevPlacement.variableOffsets[ht];$n.indexOf(ui.anchor)>0&&($n=$n.filter(_r=>_r!==ui.anchor),$n.unshift(ui.anchor))}const Ci=(ui,_r,yr)=>{const ps=b.getSymbolInstanceTextSize(J,Fe,this.transform.zoom,rt),$a=(ui.x2-ui.x1)*ps+2*ui.padding,Gr=(ui.y2-ui.y1)*ps+2*ui.padding,Xr=Ae&&!fe?_r:null;Xr&&ii(Xr);let Uo={box:[],offscreen:!1,occluded:!1};const ms=ae?2*$n.length:$n.length;for(let gs=0;gs<ms;++gs){const Na=this.attemptAnchorPlacement($n[gs%$n.length],ui,$a,Gr,ps,Ce,we,U,I,te,gs>=$n.length,Fe,rt,b,yr,Xr,J,ee);if(Na&&(Uo=Na.placedGlyphBoxes,Uo&&Uo.box&&Uo.box.length)){Le=!0,mn=Na.shift;break}}return Uo};ri(()=>Ci(Oi,He.iconBox,o.WritingMode.horizontal),()=>{const ui=He.verticalTextBox;return ui&&ii(ui),b.allowVerticalPlacement&&!(Ut&&Ut.box&&Ut.box.length)&&Ue>0&&ui?Ci(ui,He.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Ut&&(Le=Ut.box,lt=Ut.offscreen,mt=Ut.occluded);const vr=pi(Ut&&Ut.box);if(!Le&&this.prevPlacement){const ui=this.prevPlacement.variableOffsets[ht];ui&&(this.variableOffsets[ht]=ui,this.markUsedJustification(b,ui.anchor,Fe,vr))}}else{const $n=(Ci,vr)=>{const ui=b.getSymbolInstanceTextSize(J,Fe,this.transform.zoom,rt),_r=this.collisionIndex.placeCollisionBox(b,ui,Ci,new o.pointGeometry(0,0),ae,U,I,te.predicate);return _r&&_r.box&&_r.box.length&&(this.markUsedOrientation(b,vr,Fe),this.placedOrientations[ht]=vr),_r};ri(()=>$n(Oi,o.WritingMode.horizontal),()=>{const Ci=He.verticalTextBox;return b.allowVerticalPlacement&&Ue>0&&Ci?(ii(Ci),$n(Ci,o.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),pi(Ut&&Ut.box&&Ut.box.length)}}if(Ht=Ut,Le=Ht&&Ht.box&&Ht.box.length>0,lt=Ht&&Ht.offscreen,mt=Ht&&Ht.occluded,Fe.useRuntimeCollisionCircles){const pi=b.text.placedSymbolArray.get(Fe.centerJustifiedTextSymbolIndex>=0?Fe.centerJustifiedTextSymbolIndex:Fe.verticalPlacedTextSymbolIndex),ri=o.evaluateSizeForFeature(b.textSizeData,J,pi),$n=C.get("text-padding");En=this.collisionIndex.placeCollisionCircles(b,ae,pi,b.lineVertexArray,b.glyphOffsetArray,ri,I,M,R,m,we,te.predicate,Fe.collisionCircleDiameter*ri/o.ONE_EM,$n,this.retainedQueryData[b.bucketInstanceId].tileID),Le=ae||En.circles.length>0&&!En.collisionDetected,lt=lt&&En.offscreen,mt=En.occluded}if(He.iconFeatureIndex&&(ai=He.iconFeatureIndex),He.iconBox){const pi=ri=>{ii(ri);const $n=Ae&&mn?_l(mn.x,mn.y,Ce,we,this.transform.angle):new o.pointGeometry(0,0),Ci=b.getSymbolInstanceIconSize(ee,this.transform.zoom,Fe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(b,Ci,ri,$n,fe,U,I,te.predicate)};Ft&&Ft.box&&Ft.box.length&&He.verticalIconBox?(Qt=pi(He.verticalIconBox),Ze=Qt.box.length>0):(Qt=pi(He.iconBox),Ze=Qt.box.length>0),lt=lt&&Qt.offscreen,Wt=Qt.occluded}const Dr=Z||Fe.numHorizontalGlyphVertices===0&&Ue===0,ro=ce||Fe.numIconVertices===0;if(Dr||ro?ro?Dr||(Ze=Ze&&Le):Le=Ze&&Le:Ze=Le=Ze&&Le,Le&&Ht&&Ht.box&&this.collisionIndex.insertCollisionBox(Ht.box,C.get("text-ignore-placement"),b.bucketInstanceId,Ft&&Ft.box&&ei?ei:Zn,te.ID),Ze&&Qt&&this.collisionIndex.insertCollisionBox(Qt.box,C.get("icon-ignore-placement"),b.bucketInstanceId,ai,te.ID),En&&(Le&&this.collisionIndex.insertCollisionCircles(En.circles,C.get("text-ignore-placement"),b.bucketInstanceId,Zn,te.ID),m)){const pi=b.bucketInstanceId;let ri=this.collisionCircleArrays[pi];ri===void 0&&(ri=this.collisionCircleArrays[pi]=new yh);for(let $n=0;$n<En.circles.length;$n+=4)ri.circles.push(En.circles[$n+0]),ri.circles.push(En.circles[$n+1]),ri.circles.push(En.circles[$n+2]),ri.circles.push(En.collisionDetected?1:0)}const No=b.projection.name!=="globe";Ne=Ne&&(No||!mt),Ge=Ge&&(No||!Wt),this.placements[ht]=new Ta(Le||Ne,Ze||Ge,lt||b.justReloaded),c[ht]=!0};if(Be){const Fe=b.getSortedSymbolIndexes(this.transform.angle);for(let rt=Fe.length-1;rt>=0;--rt){const He=Fe[rt];bt(b.symbolInstances.get(He),He,b.collisionArrays[He])}}else for(let Fe=r.symbolInstanceStart;Fe<r.symbolInstanceEnd;Fe++)bt(b.symbolInstances.get(Fe),Fe,b.collisionArrays[Fe]);if(m&&b.bucketInstanceId in this.collisionCircleArrays){const Fe=this.collisionCircleArrays[b.bucketInstanceId];o.invert(Fe.invProjMatrix,I),Fe.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}markUsedJustification(r,c,m,_){const{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:M,crossTileID:R}=m,B=o.getAnchorJustification(c),U=_===o.WritingMode.vertical?M:B==="left"?b:B==="center"?C:B==="right"?I:-1;b>=0&&(r.text.placedSymbolArray.get(b).crossTileID=U>=0&&b!==U?0:R),C>=0&&(r.text.placedSymbolArray.get(C).crossTileID=U>=0&&C!==U?0:R),I>=0&&(r.text.placedSymbolArray.get(I).crossTileID=U>=0&&I!==U?0:R),M>=0&&(r.text.placedSymbolArray.get(M).crossTileID=U>=0&&M!==U?0:R)}markUsedOrientation(r,c,m){const _=c===o.WritingMode.horizontal||c===o.WritingMode.horizontalOnly?c:0,b=c===o.WritingMode.vertical?c:0,{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:R}=m,B=r.text.placedSymbolArray;C>=0&&(B.get(C).placedOrientation=_),I>=0&&(B.get(I).placedOrientation=_),M>=0&&(B.get(M).placedOrientation=_),R>=0&&(B.get(R).placedOrientation=b)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let m=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const _=c?c.symbolFadeChange(r):1,b=c?c.opacities:{},C=c?c.variableOffsets:{},I=c?c.placedOrientations:{};for(const M in this.placements){const R=this.placements[M],B=b[M];B?(this.opacities[M]=new qs(B,_,R.text,R.icon,null,R.clipped),m=m||R.text!==B.text.placed||R.icon!==B.icon.placed):(this.opacities[M]=new qs(null,_,R.text,R.icon,R.skipFade,R.clipped),m=m||R.text||R.icon)}for(const M in b){const R=b[M];if(!this.opacities[M]){const B=new qs(R,_,!1,!1);B.isHidden()||(this.opacities[M]=B,m=m||R.text.placed||R.icon.placed)}}for(const M in C)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=C[M]);for(const M in I)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=I[M]);m?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:r)}updateLayerOpacities(r,c){const m={};for(const _ of c){const b=_.getBucket(r);b&&_.latestFeatureIndex&&r.id===b.layerIds[0]&&this.updateBucketOpacities(b,m,_.collisionBoxArray)}}updateBucketOpacities(r,c,m){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const _=r.layers[0].layout,b=!!r.layers[0].dynamicFilter(),C=new qs(null,0,!1,!1,!0),I=_.get("text-allow-overlap"),M=_.get("icon-allow-overlap"),R=_.get("text-variable-anchor"),B=_.get("text-rotation-alignment")==="map",U=_.get("text-pitch-alignment")==="map",W=_.get("icon-text-fit")!=="none",Q=new qs(null,0,I&&(M||!r.hasIconData()||_.get("icon-optional")),M&&(I||!r.hasTextData()||_.get("text-optional")),!0);!r.collisionArrays&&m&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(m);const J=(te,Z,ce)=>{for(let ae=0;ae<Z/4;ae++)te.opacityVertexArray.emplaceBack(ce)};let ee=0;for(let te=0;te<r.symbolInstances.length;te++){const Z=r.symbolInstances.get(te),{numHorizontalGlyphVertices:ce,numVerticalGlyphVertices:ae,crossTileID:fe,numIconVertices:Ce}=Z;let we=this.opacities[fe];c[fe]?we=C:we||(we=Q,this.opacities[fe]=we),c[fe]=!0;const Ae=ce>0||ae>0,Be=Ce>0,Ne=this.placedOrientations[fe],Ge=Ne===o.WritingMode.vertical,bt=Ne===o.WritingMode.horizontal||Ne===o.WritingMode.horizontalOnly;if(!Ae&&!Be||we.isHidden()||ee++,Ae){const Fe=Uc(we.text);J(r.text,ce,Ge?Ea:Fe),J(r.text,ae,bt?Ea:Fe);const rt=we.text.isHidden(),{leftJustifiedTextSymbolIndex:He,centerJustifiedTextSymbolIndex:ht,rightJustifiedTextSymbolIndex:Ue,verticalPlacedTextSymbolIndex:Le}=Z,Ze=r.text.placedSymbolArray,lt=rt||Ge?1:0;He>=0&&(Ze.get(He).hidden=lt),ht>=0&&(Ze.get(ht).hidden=lt),Ue>=0&&(Ze.get(Ue).hidden=lt),Le>=0&&(Ze.get(Le).hidden=rt||bt?1:0);const mt=this.variableOffsets[fe];mt&&this.markUsedJustification(r,mt.anchor,Z,Ne);const Wt=this.placedOrientations[fe];Wt&&(this.markUsedJustification(r,"left",Z,Wt),this.markUsedOrientation(r,Wt,Z))}if(Be){const Fe=Uc(we.icon),{placedIconSymbolIndex:rt,verticalPlacedIconSymbolIndex:He}=Z,ht=r.icon.placedSymbolArray,Ue=we.icon.isHidden()?1:0;rt>=0&&(J(r.icon,Ce,Ge?Ea:Fe),ht.get(rt).hidden=Ue),He>=0&&(J(r.icon,Z.numVerticalIconVertices,bt?Ea:Fe),ht.get(He).hidden=Ue)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Fe=r.collisionArrays[te];if(Fe){let rt=new o.pointGeometry(0,0),He=!0;if(Fe.textBox||Fe.verticalTextBox){if(R){const Ue=this.variableOffsets[fe];Ue?(rt=$c(Ue.anchor,Ue.width,Ue.height,Ue.textOffset,Ue.textScale),B&&rt._rotate(U?this.transform.angle:-this.transform.angle)):He=!1}b&&(He=!we.clipped),Fe.textBox&&Cr(r.textCollisionBox.collisionVertexArray,we.text.placed,!He||Ge,rt.x,rt.y),Fe.verticalTextBox&&Cr(r.textCollisionBox.collisionVertexArray,we.text.placed,!He||bt,rt.x,rt.y)}const ht=He&&Boolean(!bt&&Fe.verticalIconBox);Fe.iconBox&&Cr(r.iconCollisionBox.collisionVertexArray,we.icon.placed,ht,W?rt.x:0,W?rt.y:0),Fe.verticalIconBox&&Cr(r.iconCollisionBox.collisionVertexArray,we.icon.placed,!ht,W?rt.x:0,W?rt.y:0)}}}if(r.fullyClipped=ee===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const te=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=te.invProjMatrix,r.placementViewportMatrix=te.viewportMatrix,r.collisionCircleArray=te.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,c){const m=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*m>r}setStale(){this.stale=!0}}function Cr(f,r,c,m,_){f.emplaceBack(r?1:0,c?1:0,m||0,_||0),f.emplaceBack(r?1:0,c?1:0,m||0,_||0),f.emplaceBack(r?1:0,c?1:0,m||0,_||0),f.emplaceBack(r?1:0,c?1:0,m||0,_||0)}const jf=Math.pow(2,25),Nc=Math.pow(2,24),qi=Math.pow(2,17),yl=Math.pow(2,16),xh=Math.pow(2,9),xl=Math.pow(2,8),ar=Math.pow(2,1);function Uc(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const r=f.placed?1:0,c=Math.floor(127*f.opacity);return c*jf+r*Nc+c*qi+r*yl+c*xh+r*xl+c*ar+r}const Ea=0;class Fo{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,c,m,_,b){const C=this._bucketParts;for(;this._currentTileIndex<r.length;)if(c.getBucketParts(C,_,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,C.sort((I,M)=>I.sortKey-M.sortKey));this._currentPartIndex<C.length;){const I=C[this._currentPartIndex];if(c.placeLayerBucketPart(I,this._seenCrossTileIDs,m,I.symbolInstanceStart===0),this._currentPartIndex++,b())return!0}return!1}}class bl{constructor(r,c,m,_,b,C,I,M){this.placement=new Lr(r,b,C,I,M),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(r,c,m){const _=o.exported.now(),b=()=>{const C=o.exported.now()-_;return!this._forceFullPlacement&&C>2};for(;this._currentPlacementIndex>=0;){const C=c[r[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(C.type==="symbol"&&(!C.minzoom||C.minzoom<=I)&&(!C.maxzoom||C.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Fo(C)),this._inProgressLayer.continuePlacement(m[C.source],this.placement,this._showCollisionBoxes,C,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const jc=512/o.EXTENT/2;class Bg{constructor(r,c,m){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=m;for(let _=0;_<c.length;_++){const b=c.get(_),C=b.key;this.indexedSymbolInstances[C]||(this.indexedSymbolInstances[C]=[]),this.indexedSymbolInstances[C].push({crossTileID:b.crossTileID,coord:this.getScaledCoordinates(b,r)})}}getScaledCoordinates(r,c){const m=jc/Math.pow(2,c.canonical.z-this.tileID.canonical.z);return{x:Math.floor((c.canonical.x*o.EXTENT+r.tileAnchorX)*m),y:Math.floor((c.canonical.y*o.EXTENT+r.tileAnchorY)*m)}}findMatches(r,c,m){const _=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let b=0;b<r.length;b++){const C=r.get(b);if(C.crossTileID)continue;const I=this.indexedSymbolInstances[C.key];if(!I)continue;const M=this.getScaledCoordinates(C,c);for(const R of I)if(Math.abs(R.coord.x-M.x)<=_&&Math.abs(R.coord.y-M.y)<=_&&!m[R.crossTileID]){m[R.crossTileID]=!0,C.crossTileID=R.crossTileID;break}}}}class bh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ca{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const c=Math.round((r-this.lng)/360);if(c!==0)for(const m in this.indexes){const _=this.indexes[m],b={};for(const C in _){const I=_[C];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+c),b[I.tileID.key]=I}this.indexes[m]=b}this.lng=r}addBucket(r,c,m){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let b=0;b<c.symbolInstances.length;b++)c.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const _=this.usedCrossTileIDs[r.overscaledZ];for(const b in this.indexes){const C=this.indexes[b];if(Number(b)>r.overscaledZ)for(const I in C){const M=C[I];M.tileID.isChildOf(r)&&M.findMatches(c.symbolInstances,r,_)}else{const I=C[r.scaledTo(Number(b)).key];I&&I.findMatches(c.symbolInstances,r,_)}}for(let b=0;b<c.symbolInstances.length;b++){const C=c.symbolInstances.get(b);C.crossTileID||(C.crossTileID=m.generate(),_[C.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Bg(r,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(r,c){for(const m in c.indexedSymbolInstances)for(const _ of c.indexedSymbolInstances[m])delete this.usedCrossTileIDs[r][_.crossTileID]}removeStaleBuckets(r){let c=!1;for(const m in this.indexes){const _=this.indexes[m];for(const b in _)r[_[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,_[b]),delete _[b],c=!0)}return c}}class Gf{constructor(){this.layerIndexes={},this.crossTileIDs=new bh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,c,m,_){let b=this.layerIndexes[r.id];b===void 0&&(b=this.layerIndexes[r.id]=new Ca);let C=!1;const I={};_.name!=="globe"&&b.handleWrapJump(m);for(const M of c){const R=M.getBucket(r);R&&r.id===R.layerIds[0]&&(R.bucketInstanceId||(R.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(M.tileID,R,this.crossTileIDs)&&(C=!0),I[R.bucketInstanceId]=!0)}return b.removeStaleBuckets(I)&&(C=!0),C}pruneUnusedLayers(r){const c={};r.forEach(m=>{c[m]=!0});for(const m in this.layerIndexes)c[m]||delete this.layerIndexes[m]}}const wl=(f,r)=>o.emitValidationErrors(f,r&&r.filter(c=>c.identifier!=="source.canvas")),Ia=o.pick(on,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),us=o.pick(on,["setCenter","setZoom","setBearing","setPitch"]),Gc={version:8,layers:[],sources:{}},hs={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Wr extends o.Evented{constructor(r,c={}){super(),this.map=r,this.dispatcher=new zn(cn(),this),this.imageManager=new De,this.imageManager.setEventedParent(this),this.glyphManager=new o.GlyphManager(r._requestManager,c.localFontFamily?o.LocalGlyphMode.all:c.localIdeographFontFamily?o.LocalGlyphMode.ideographs:o.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.crossTileSymbolIndex=new Gf,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const m=this;this._rtlTextPluginCallback=Wr.registerForPluginStateChange(_=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(b,C)=>{if(o.triggerPluginCompletionEvent(b),C&&C.every(I=>I))for(const I in m._sourceCaches){const M=m._sourceCaches[I],R=M.getSource().type;R!=="vector"&&R!=="geojson"||M.reload()}})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const b=this.getSource(_.sourceId);if(b&&b.vectorLayerIds)for(const C in this._layers){const I=this._layers[C];I.source===b.id&&this._validateLayer(I)}})}loadURL(r,c={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const m=typeof c.validate=="boolean"?c.validate:!o.isMapboxURL(r);r=this.map._requestManager.normalizeStyleURL(r,c.accessToken);const _=this.map._requestManager.transformRequest(r,o.ResourceType.Style);this._request=o.getJSON(_,(b,C)=>{this._request=null,b?this.fire(new o.ErrorEvent(b)):C&&this._load(C,m)})}loadJSON(r,c={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(r,c.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Gc,!1)}_updateLayerCount(r,c){const m=c?1:-1;r.is3D()&&(this._num3DLayers+=m),r.type==="circle"&&(this._numCircleLayers+=m),r.type==="symbol"&&(this._numSymbolLayers+=m)}_load(r,c){if(c&&wl(this,o.validateStyle(r)))return;this._loaded=!0,this.stylesheet=o.clone$1(r),this._updateMapProjection();for(const _ in r.sources)this.addSource(_,r.sources[_],{validate:!1});this._changed=!1,r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(r.glyphs);const m=Gn(this.stylesheet.layers);this._order=m.map(_=>_.id),this._layers={},this._serializedLayers={};for(let _ of m)_=o.createStyleLayer(_),_.setEventedParent(this,{layer:{id:_.id}}),this._layers[_.id]=_,this._serializedLayers[_.id]=_.serialize(),this._updateLayerCount(_,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ct(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(r){this._spriteRequest=function(c,m,_){let b,C,I;const M=o.exported.devicePixelRatio>1?"@2x":"";let R=o.getJSON(m.transformRequest(m.normalizeSpriteURL(c,M,".json"),o.ResourceType.SpriteJSON),(W,Q)=>{R=null,I||(I=W,b=Q,U())}),B=o.getImage(m.transformRequest(m.normalizeSpriteURL(c,M,".png"),o.ResourceType.SpriteImage),(W,Q)=>{B=null,I||(I=W,C=Q,U())});function U(){if(I)_(I);else if(b&&C){const W=o.exported.getImageData(C),Q={};for(const J in b){const{width:ee,height:te,x:Z,y:ce,sdf:ae,pixelRatio:fe,stretchX:Ce,stretchY:we,content:Ae}=b[J],Be=new o.RGBAImage({width:ee,height:te});o.RGBAImage.copy(W,Be,{x:Z,y:ce},{x:0,y:0},{width:ee,height:te}),Q[J]={data:Be,pixelRatio:fe,sdf:ae,stretchX:Ce,stretchY:we,content:Ae}}_(null,Q)}}return{cancel(){R&&(R.cancel(),R=null),B&&(B.cancel(),B=null)}}}(r,this.map._requestManager,(c,m)=>{if(this._spriteRequest=null,c)this.fire(new o.ErrorEvent(c));else if(m)for(const _ in m)this.imageManager.addImage(_,m[_]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(r){const c=this.getSource(r.source);if(!c)return;const m=r.sourceLayer;m&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(m)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${m}" does not exist on source "${c.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const c=[];for(const m of r){const _=this._layers[m];_.type!=="custom"&&c.push(_.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(r){return!!this.terrain&&(typeof r.isLayerDraped=="function"?r.isLayerDraped():hs[r.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(r){if(!this._loaded)return;const c=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(_.length||b.length)&&this._updateWorkerLayers(_,b);for(const C in this._updatedSources){const I=this._updatedSources[C];I==="reload"?this._reloadSource(C):I==="clear"&&this._clearSource(C)}this._updateTilesForChangedImages();for(const C in this._updatedPaintProps)this._layers[C].updateTransitions(r);this.light.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._resetUpdates()}const m={};for(const _ in this._sourceCaches){const b=this._sourceCaches[_];m[_]=b.used,b.used=!1}for(const _ of this._order){const b=this._layers[_];if(b.recalculate(r,this._availableImages),!b.isHidden(r.zoom)){const I=this._getLayerSourceCache(b);I&&(I.used=!0)}const C=this.map.painter;if(C){const I=b.getProgramIds();if(!I)continue;const M=b.getProgramConfiguration(r.zoom);for(const R of I)C.useProgram(R,M)}}for(const _ in m){const b=this._sourceCaches[_];m[_]!==b.used&&b.getSource().fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:b.getSource().id}))}this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(r){if(this._checkLoaded(),wl(this,o.validateStyle(r)))return!1;(r=o.clone$1(r)).layers=Gn(r.layers);const c=function(_,b){if(!_)return[{command:on.setStyle,args:[b]}];let C=[];try{if(!w(_.version,b.version))return[{command:on.setStyle,args:[b]}];w(_.center,b.center)||C.push({command:on.setCenter,args:[b.center]}),w(_.zoom,b.zoom)||C.push({command:on.setZoom,args:[b.zoom]}),w(_.bearing,b.bearing)||C.push({command:on.setBearing,args:[b.bearing]}),w(_.pitch,b.pitch)||C.push({command:on.setPitch,args:[b.pitch]}),w(_.sprite,b.sprite)||C.push({command:on.setSprite,args:[b.sprite]}),w(_.glyphs,b.glyphs)||C.push({command:on.setGlyphs,args:[b.glyphs]}),w(_.transition,b.transition)||C.push({command:on.setTransition,args:[b.transition]}),w(_.light,b.light)||C.push({command:on.setLight,args:[b.light]}),w(_.fog,b.fog)||C.push({command:on.setFog,args:[b.fog]}),w(_.projection,b.projection)||C.push({command:on.setProjection,args:[b.projection]});const I={},M=[];(function(U,W,Q,J){let ee;for(ee in W=W||{},U=U||{})U.hasOwnProperty(ee)&&(W.hasOwnProperty(ee)||Qn(ee,Q,J));for(ee in W)W.hasOwnProperty(ee)&&(U.hasOwnProperty(ee)?w(U[ee],W[ee])||(U[ee].type==="geojson"&&W[ee].type==="geojson"&&Bo(U,W,ee)?Q.push({command:on.setGeoJSONSourceData,args:[ee,W[ee].data]}):ls(ee,W,Q,J)):Jn(ee,W,Q))})(_.sources,b.sources,M,I);const R=[];_.layers&&_.layers.forEach(U=>{U.source&&I[U.source]?C.push({command:on.removeLayer,args:[U.id]}):R.push(U)});let B=_.terrain;B&&I[B.source]&&(C.push({command:on.setTerrain,args:[void 0]}),B=void 0),C=C.concat(M),w(B,b.terrain)||C.push({command:on.setTerrain,args:[b.terrain]}),function(U,W,Q){W=W||[];const J=(U=U||[]).map(Oo),ee=W.map(Oo),te=U.reduce(Bi,{}),Z=W.reduce(Bi,{}),ce=J.slice(),ae=Object.create(null);let fe,Ce,we,Ae,Be,Ne,Ge;for(fe=0,Ce=0;fe<J.length;fe++)we=J[fe],Z.hasOwnProperty(we)?Ce++:(Q.push({command:on.removeLayer,args:[we]}),ce.splice(ce.indexOf(we,Ce),1));for(fe=0,Ce=0;fe<ee.length;fe++)we=ee[ee.length-1-fe],ce[ce.length-1-fe]!==we&&(te.hasOwnProperty(we)?(Q.push({command:on.removeLayer,args:[we]}),ce.splice(ce.lastIndexOf(we,ce.length-Ce),1)):Ce++,Ne=ce[ce.length-fe],Q.push({command:on.addLayer,args:[Z[we],Ne]}),ce.splice(ce.length-fe,0,we),ae[we]=!0);for(fe=0;fe<ee.length;fe++)if(we=ee[fe],Ae=te[we],Be=Z[we],!ae[we]&&!w(Ae,Be))if(w(Ae.source,Be.source)&&w(Ae["source-layer"],Be["source-layer"])&&w(Ae.type,Be.type)){for(Ge in et(Ae.layout,Be.layout,Q,we,null,on.setLayoutProperty),et(Ae.paint,Be.paint,Q,we,null,on.setPaintProperty),w(Ae.filter,Be.filter)||Q.push({command:on.setFilter,args:[we,Be.filter]}),w(Ae.minzoom,Be.minzoom)&&w(Ae.maxzoom,Be.maxzoom)||Q.push({command:on.setLayerZoomRange,args:[we,Be.minzoom,Be.maxzoom]}),Ae)Ae.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?et(Ae[Ge],Be[Ge],Q,we,Ge.slice(6),on.setPaintProperty):w(Ae[Ge],Be[Ge])||Q.push({command:on.setLayerProperty,args:[we,Ge,Be[Ge]]}));for(Ge in Be)Be.hasOwnProperty(Ge)&&!Ae.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?et(Ae[Ge],Be[Ge],Q,we,Ge.slice(6),on.setPaintProperty):w(Ae[Ge],Be[Ge])||Q.push({command:on.setLayerProperty,args:[we,Ge,Be[Ge]]}))}else Q.push({command:on.removeLayer,args:[we]}),Ne=ce[ce.lastIndexOf(we)+1],Q.push({command:on.addLayer,args:[Be,Ne]})}(R,b.layers,C)}catch(I){console.warn("Unable to compute style diff:",I),C=[{command:on.setStyle,args:[b]}]}return C}(this.serialize(),r).filter(_=>!(_.command in us));if(c.length===0)return!1;const m=c.filter(_=>!(_.command in Ia));if(m.length>0)throw new Error(`Unimplemented: ${m.map(_=>_.command).join(", ")}.`);return c.forEach(_=>{_.command!=="setTransition"&&_.command!=="setProjection"&&this[_.command].apply(this,_.args)}),this.stylesheet=r,this._updateMapProjection(),!0}addImage(r,c){return this.getImage(r)?this.fire(new o.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,c),this._afterImageUpdated(r),this)}updateImage(r,c){this.imageManager.updateImage(r,c)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r),this._afterImageUpdated(r),this):this.fire(new o.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(r,c,m={}){if(this._checkLoaded(),this.getSource(r)!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(o.validateSource,`sources.${r}`,c,null,m))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const _=Re(r,c,this.dispatcher,this);_.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(r),source:_.serialize(),sourceId:r}));const b=C=>{const I=(C?"symbol:":"other:")+r,M=this._sourceCaches[I]=new o.SourceCache(I,_,C);(C?this._symbolSourceCaches:this._otherSourceCaches)[r]=M,M.style=this,M.onAdd(this.map)};b(!1),c.type!=="vector"&&c.type!=="geojson"||b(!0),_.onAdd&&_.onAdd(this.map),this._changed=!0}removeSource(r){this._checkLoaded();const c=this.getSource(r);if(!c)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===r)return this.fire(new o.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.get().source===r)return this.fire(new o.ErrorEvent(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const m=this._getSourceCaches(r);for(const _ of m)delete this._sourceCaches[_.id],delete this._updatedSources[_.id],_.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles();return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(r,c){this._checkLoaded(),this.getSource(r).setData(c),this._changed=!0}getSource(r){const c=this._getSourceCache(r);return c&&c.getSource()}_getSources(){const r=[];for(const c in this._otherSourceCaches){const m=this._getSourceCache(c);m&&r.push(m.getSource())}return r}addLayer(r,c,m={}){this._checkLoaded();const _=r.id;if(this.getLayer(_))return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${_}" already exists on this map`)));let b;if(r.type==="custom"){if(wl(this,o.validateCustomStyleLayer(r)))return;b=o.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(_,r.source),r=o.clone$1(r),r=o.extend(r,{source:_})),this._validate(o.validateLayer,`layers.${_}`,r,{arrayIndex:-1},m))return;b=o.createStyleLayer(r),this._validateLayer(b),b.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}const C=c?this._order.indexOf(c):this._order.length;if(c&&C===-1)return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(C,0,_),this._layerOrderChanged=!0,this._layers[_]=b;const I=this._getLayerSourceCache(b);if(this._removedLayers[_]&&b.source&&I&&b.type!=="custom"){const M=this._removedLayers[_];delete this._removedLayers[_],M.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",I.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(r,c){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===c)return;const m=this._order.indexOf(r);this._order.splice(m,1);const _=c?this._order.indexOf(c):this._order.length;c&&_===-1?this.fire(new o.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(_,0,r),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(r){this._checkLoaded();const c=this._layers[r];if(!c)return void this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const m=this._order.indexOf(r);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=c,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}hasLayerType(r){for(const c in this._layers)if(this._layers[c].type===r)return!0;return!1}setLayerZoomRange(r,c,m){this._checkLoaded();const _=this.getLayer(r);_?_.minzoom===c&&_.maxzoom===m||(c!=null&&(_.minzoom=c),m!=null&&(_.maxzoom=m),this._updateLayer(_)):this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(r,c,m={}){this._checkLoaded();const _=this.getLayer(r);if(_){if(!w(_.filter,c))return c==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(o.validateFilter,`layers.${_.id}.filter`,c,{layerType:_.type},m)||(_.filter=o.clone$1(c),this._updateLayer(_)))}else this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be filtered.`)))}getFilter(r){const c=this.getLayer(r);return c&&o.clone$1(c.filter)}setLayoutProperty(r,c,m,_={}){this._checkLoaded();const b=this.getLayer(r);b?w(b.getLayoutProperty(c),m)||(b.setLayoutProperty(c,m,_),this._updateLayer(b)):this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(r,c){const m=this.getLayer(r);if(m)return m.getLayoutProperty(c);this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style.`)))}setPaintProperty(r,c,m,_={}){this._checkLoaded();const b=this.getLayer(r);b?w(b.getPaintProperty(c),m)||(b.setPaintProperty(c,m,_)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(r,c){const m=this.getLayer(r);return m&&m.getPaintProperty(c)}setFeatureState(r,c){this._checkLoaded();const m=r.source,_=r.sourceLayer,b=this.getSource(m);if(!b)return void this.fire(new o.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const C=b.type;if(C==="geojson"&&_)return void this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(C==="vector"&&!_)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided.")));const I=this._getSourceCaches(m);for(const M of I)M.setFeatureState(_,r.id,c)}removeFeatureState(r,c){this._checkLoaded();const m=r.source,_=this.getSource(m);if(!_)return void this.fire(new o.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const b=_.type,C=b==="vector"?r.sourceLayer:void 0;if(b==="vector"&&!C)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const I=this._getSourceCaches(m);for(const M of I)M.removeFeatureState(C,r.id,c)}getFeatureState(r){this._checkLoaded();const c=r.source,m=r.sourceLayer,_=this.getSource(c);if(_){if(_.type!=="vector"||m)return r.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(m,r.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const r={};for(const c in this._sourceCaches){const m=this._sourceCaches[c].getSource();r[m.id]||(r[m.id]=m.serialize())}return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:r,layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0;const c=this._getLayerSourceCache(r);r.source&&!this._updatedSources[r.source]&&c&&c.getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",c.pause()),this._changed=!0,r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const c=C=>this._layers[C].type==="fill-extrusion",m={},_=[];for(let C=this._order.length-1;C>=0;C--){const I=this._order[C];if(c(I)){m[I]=C;for(const M of r){const R=M[I];if(R)for(const B of R)_.push(B)}}}_.sort((C,I)=>I.intersectionZ-C.intersectionZ);const b=[];for(let C=this._order.length-1;C>=0;C--){const I=this._order[C];if(c(I))for(let M=_.length-1;M>=0;M--){const R=_[M].feature;if(m[R.layer.id]<C)break;b.push(R),_.pop()}else for(const M of r){const R=M[I];if(R)for(const B of R)b.push(B.feature)}}return b}queryRenderedFeatures(r,c,m){c&&c.filter&&this._validate(o.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const _={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const M of c.layers){const R=this._layers[M];if(!R)return this.fire(new o.ErrorEvent(new Error(`The layer '${M}' does not exist in the map's style and cannot be queried for features.`))),[];_[R.source]=!0}}const b=[];c.availableImages=this._availableImages;const C=c&&c.layers?c.layers.some(M=>{const R=this.getLayer(M);return R&&R.is3D()}):this.has3DLayers(),I=Qe.createFromScreenPoints(r,m);for(const M in this._sourceCaches){const R=this._sourceCaches[M].getSource().id;c.layers&&!_[R]||b.push(Ve(this._sourceCaches[M],this._layers,this._serializedLayers,I,c,m,C,!!this.map._showQueryGeometry))}return this.placement&&b.push(function(M,R,B,U,W,Q,J){const ee={},te=Q.queryRenderedSymbols(U),Z=[];for(const ce of Object.keys(te).map(Number))Z.push(J[ce]);Z.sort(Rt);for(const ce of Z){const ae=ce.featureIndex.lookupSymbolFeatures(te[ce.bucketInstanceId],R,ce.bucketIndex,ce.sourceLayerIndex,W.filter,W.layers,W.availableImages,M);for(const fe in ae){const Ce=ee[fe]=ee[fe]||[],we=ae[fe];we.sort((Ae,Be)=>{const Ne=ce.featureSortOrder;if(Ne){const Ge=Ne.indexOf(Ae.featureIndex);return Ne.indexOf(Be.featureIndex)-Ge}return Be.featureIndex-Ae.featureIndex});for(const Ae of we)Ce.push(Ae)}}for(const ce in ee)ee[ce].forEach(ae=>{const fe=ae.feature,Ce=B(M[ce]).getFeatureState(fe.layer["source-layer"],fe.id);fe.source=fe.layer.source,fe.layer["source-layer"]&&(fe.sourceLayer=fe.layer["source-layer"]),fe.state=Ce});return ee}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),I.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(r,c){c&&c.filter&&this._validate(o.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const m=this._getSourceCaches(r);let _=[];for(const b of m)_=_.concat(ut(b,c));return _}addSourceType(r,c,m){return Wr.getSourceType(r)?m(new Error(`A source type called "${r}" already exists.`)):(Wr.setSourceType(r,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:c.workerSourceURL},m):m(null,null))}getLight(){return this.light.getLight()}setLight(r,c={}){this._checkLoaded();const m=this.light.getLight();let _=!1;for(const C in r)if(!w(r[C],m[C])){_=!0;break}if(!_)return;const b=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(r,c),this.light.updateTransitions(b)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(r,c=1){if(this._checkLoaded(),!r)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(c===1){if(typeof r.source=="object"){const m="terrain-dem-src";this.addSource(m,r.source),r=o.clone$1(r),r=o.extend(r,{source:m})}if(this._validate(o.validateTerrain,"terrain",r))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode)this._createTerrain(r,c);else{const m=this.terrain,_=m.get();for(const b of Object.keys(o.spec.terrain))!r.hasOwnProperty(b)&&o.spec.terrain[b].default&&(r[b]=o.spec.terrain[b].default);for(const b in r)if(!w(r[b],_[b])){m.set(r),this.stylesheet.terrain=r;const C=this._setTransitionParameters({duration:0});m.updateTransitions(C);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const c=this.fog=new Gt(r,this.map.transform);this.stylesheet.fog=r;const m=this._setTransitionParameters({duration:0});c.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,m=c.get();Object.keys(r).length===0&&c.set(r);for(const _ in r)if(!w(r[_],m[_])){c.set(r),this.stylesheet.fog=r;const b=this._setTransitionParameters({duration:0});c.updateTransitions(b);break}}else this._createFog(r);this._markersNeedUpdate=!0}_setTransitionParameters(r){return{now:o.exported.now(),transition:o.extend(r,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const r=this._order.filter(m=>this.isLayerDraped(this._layers[m])),c=this._order.filter(m=>!this.isLayerDraped(this._layers[m]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...c)}_createTerrain(r,c){const m=this.terrain=new Pe(r,c);this.stylesheet.terrain=r,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const _=this._setTransitionParameters({duration:0});m.updateTransitions(_)}_force3DLayerUpdate(){for(const r in this._layers){const c=this._layers[r];c.type==="fill-extrusion"&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const c=this._layers[r];c.type==="symbol"&&this._updateLayer(c)}}_validate(r,c,m,_,b={}){return(!b||b.validate!==!1)&&wl(this,r.call(o.validateStyle,o.extend({key:c,style:this.serialize(),value:m,styleSpec:o.spec},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this._sourceCaches)this._sourceCaches[r].clearTiles(),this._sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){const c=this._getSourceCaches(r);for(const m of c)m.clearTiles()}_reloadSource(r){const c=this._getSourceCaches(r);for(const m of c)m.resume(),m.reload()}_reloadSources(){for(const r of this._getSources())r.reload&&r.reload()}_updateSources(r){for(const c in this._sourceCaches)this._sourceCaches[c].update(r)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const c=this._sourceCaches[r];c.resume(),c.reload()}}_updatePlacement(r,c,m,_,b=!1){let C=!1,I=!1;const M={};for(const R of this._order){const B=this._layers[R];if(B.type!=="symbol")continue;if(!M[B.source]){const W=this._getLayerSourceCache(B);if(!W)continue;M[B.source]=W.getRenderableIds(!0).map(Q=>W.getTileByID(Q)).sort((Q,J)=>J.tileID.overscaledZ-Q.tileID.overscaledZ||(Q.tileID.isLessThan(J.tileID)?-1:1))}const U=this.crossTileSymbolIndex.addLayer(B,M[B.source],r.center.lng,r.projection);C=C||U}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),b=b||this._layerOrderChanged||m===0,this._layerOrderChanged&&this.fire(new o.Event("neworder")),(b||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),r.zoom))&&(this.pauseablePlacement=new bl(r,this._order,b,c,m,_,this.placement,this.fog&&r.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),I=!0),C&&this.pauseablePlacement.placement.setStale()),I||C)for(const R of this._order){const B=this._layers[R];B.type==="symbol"&&this.placement.updateLayerOpacities(B,M[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,c,m){this.imageManager.getImages(c.icons,m),this._updateTilesForChangedImages();const _=b=>{b&&b.setDependencies(c.tileID.key,c.type,c.icons)};_(this._otherSourceCaches[c.source]),_(this._symbolSourceCaches[c.source])}getGlyphs(r,c,m){this.glyphManager.getGlyphs(c.stacks,m)}getResource(r,c,m){return o.makeRequest(c,m)}_getSourceCache(r){return this._otherSourceCaches[r]}_getLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}_getSourceCaches(r){const c=[];return this._otherSourceCaches[r]&&c.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&c.push(this._symbolSourceCaches[r]),c}_isSourceCacheLoaded(r){const c=this._getSourceCaches(r);return c.length===0?(this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${r}'`))),!1):c.every(m=>m.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Wr.getSourceType=function(f){return Oe[f]},Wr.setSourceType=function(f,r){Oe[f]=r},Wr.registerForPluginStateChange=o.registerForPluginStateChange;var Sl=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,qf="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Zf=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,qc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Wf=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let wh={},Sh={};const Aa=[];Zs(Sl,Aa),Zs(Zf,Aa),Zs(qc,Aa),Zs(Wf,Aa),wh=qn("",Zf),Sh=qn(Wf,qc);const Hf=qn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Zc=Sl,Wc=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Th={background:qn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:qn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:qn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:qn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:qn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:qn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:qn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:qn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:qn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:qn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:qn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:qn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:qn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:qn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:qn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:qn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:qn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:qn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:qn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:qn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:qn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:qn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:qn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:qn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:qn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:qn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,qf),skyboxGradient:qn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,qf),skyboxCapture:qn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:qn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:qn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Zs(f,r){const c=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let m of c)if(m=m.trim(),m[0]==="#"&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const _=m.split(" ");for(const b of _)r.includes(b)||r.push(b)}}function qn(f,r){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=r.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),_={},b=[...Aa];return Zs(f,b),Zs(r,b),{fragmentSource:f=f.replace(c,(C,I,M,R,B)=>(_[B]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${B}
varying ${M} ${R} ${B};
#else
uniform ${M} ${R} u_${B};
#endif
`:`
#ifdef HAS_UNIFORM_u_${B}
    ${M} ${R} ${B} = u_${B};
#endif
`)),vertexSource:r=r.replace(c,(C,I,M,R,B)=>{const U=R==="float"?"vec2":"vec4",W=B.match(/color/)?"color":U;return _[B]?I==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
attribute ${M} ${U} a_${B};
varying ${M} ${R} ${B};
#else
uniform ${M} ${R} u_${B};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = a_${B};
#else
    ${M} ${R} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = unpack_mix_${W}(a_${B}, u_${B}_t);
#else
    ${M} ${R} ${B} = u_${B};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
attribute ${M} ${U} a_${B};
#else
uniform ${M} ${R} u_${B};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${M} ${R} ${B} = a_${B};
#else
    ${M} ${R} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${M} ${R} ${B} = unpack_mix_${W}(a_${B}, u_${B}_t);
#else
    ${M} ${R} ${B} = u_${B};
#endif
`}),staticAttributes:m,usedDefines:b}}class Tl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,c,m,_,b,C,I){this.context=r;let M=this.boundPaintVertexBuffers.length!==_.length;for(let B=0;!M&&B<_.length;B++)this.boundPaintVertexBuffers[B]!==_[B]&&(M=!0);let R=this.boundDynamicVertexBuffers.length!==I.length;for(let B=0;!R&&B<I.length;B++)this.boundDynamicVertexBuffers[B]!==I[B]&&(R=!0);if(!r.extVertexArrayObject||!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==m||M||R||this.boundIndexBuffer!==b||this.boundVertexOffset!==C)this.freshBind(c,m,_,b,C,I);else{r.bindVertexArrayOES.set(this.vao);for(const B of I)B&&B.bind();b&&b.dynamicDraw&&b.bind()}}freshBind(r,c,m,_,b,C){let I;const M=r.numAttributes,R=this.context,B=R.gl;if(R.extVertexArrayObject)this.vao&&this.destroy(),this.vao=R.extVertexArrayObject.createVertexArrayOES(),R.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=r,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=_,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=C;else{I=R.currentNumAttributes||0;for(let U=M;U<I;U++)B.disableVertexAttribArray(U)}c.enableAttributes(B,r),c.bind(),c.setVertexAttribPointers(B,r,b);for(const U of m)U.enableAttributes(B,r),U.bind(),U.setVertexAttribPointers(B,r,b);for(const U of C)U&&(U.enableAttributes(B,r),U.bind(),U.setVertexAttribPointers(B,r,b));_&&_.bind(),R.currentNumAttributes=M}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Eh(f,r){const c=Math.pow(2,r.canonical.z),m=r.canonical.y;return[new o.MercatorCoordinate(0,m/c).toLngLat().lat,new o.MercatorCoordinate(0,(m+1)/c).toLngLat().lat]}function El(f,r,c,m,_,b,C){const I=f.context,M=I.gl,R=c.fbo;if(!R)return;f.prepareDrawTile();const B=f.useProgram("hillshade");I.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,R.colorAttachment.get());const U=((ee,te,Z,ce)=>{const ae=Z.paint.get("hillshade-shadow-color"),fe=Z.paint.get("hillshade-highlight-color"),Ce=Z.paint.get("hillshade-accent-color");let we=Z.paint.get("hillshade-illumination-direction")*(Math.PI/180);Z.paint.get("hillshade-illumination-anchor")==="viewport"&&(we-=ee.transform.angle);const Ae=!ee.options.moving;return{u_matrix:ce||ee.transform.calculateProjMatrix(te.tileID.toUnwrapped(),Ae),u_image:0,u_latrange:Eh(0,te.tileID),u_light:[Z.paint.get("hillshade-exaggeration"),we],u_shadow:ae,u_highlight:fe,u_accent:Ce}})(f,c,m,f.terrain?r.projMatrix:null);f.prepareDrawProgram(I,B,r.toUnwrapped());const{tileBoundsBuffer:W,tileBoundsIndexBuffer:Q,tileBoundsSegments:J}=f.getTileBoundsBuffers(c);B.draw(I,M.TRIANGLES,_,b,C,o.CullFaceMode.disabled,U,m.id,W,Q,J)}function Cl(f,r,c){if(!r.needsDEMTextureUpload)return;const m=f.context,_=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||f.getTileTexture(c.stride);const b=c.getPixels();r.demTexture?r.demTexture.update(b,{premultiply:!1}):r.demTexture=new o.Texture(m,b,_.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}function Hc(f,r,c,m,_,b){const C=f.context,I=C.gl;if(!r.dem)return;const M=r.dem;if(C.activeTexture.set(I.TEXTURE1),Cl(f,r,M),!r.demTexture)return;r.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const R=M.dim;C.activeTexture.set(I.TEXTURE0);let B=r.fbo;if(!B){const J=new o.Texture(C,{width:R,height:R,data:null},I.RGBA);J.bind(I.LINEAR,I.CLAMP_TO_EDGE),B=r.fbo=C.createFramebuffer(R,R,!0),B.colorAttachment.set(J.texture)}C.bindFramebuffer.set(B.framebuffer),C.viewport.set([0,0,R,R]);const{tileBoundsBuffer:U,tileBoundsIndexBuffer:W,tileBoundsSegments:Q}=f.getMercatorTileBoundsBuffers();f.useProgram("hillshadePrepare").draw(C,I.TRIANGLES,m,_,b,o.CullFaceMode.disabled,((J,ee)=>{const te=ee.stride,Z=o.create();return o.ortho(Z,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(Z,Z,[0,-o.EXTENT,0]),{u_matrix:Z,u_image:1,u_dimension:[te,te],u_zoom:J.overscaledZ,u_unpack:ee.unpackVector}})(r.tileID,M),c.id,U,W,Q),r.needsHillshadePrepare=!1}const Xc=f=>({u_matrix:new o.UniformMatrix4f(f),u_image0:new o.Uniform1i(f),u_skirt_height:new o.Uniform1f(f)}),Ch=(f,r)=>({u_matrix:f,u_image0:0,u_skirt_height:r}),Yc=(f,r,c,m,_,b,C,I,M,R,B,U,W,Q,J)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:c,u_zoom_transition:_,u_merc_center:b,u_image0:0,u_frustum_tl:C,u_frustum_tr:I,u_frustum_br:M,u_frustum_bl:R,u_globe_pos:B,u_globe_radius:U,u_viewport:W,u_grid_matrix:J?Float32Array.from(J):new Float32Array(9),u_skirt_height:Q});function Ih(f,r){return f!=null&&r!=null&&!(!f.hasData()||!r.hasData())&&f.demTexture!=null&&r.demTexture!=null&&f.tileID.key!==r.tileID.key}const ds=new class{constructor(){this.operations={}}newMorphing(f,r,c,m,_){if(f in this.operations){const b=this.operations[f];b.to.tileID.key!==c.tileID.key&&(b.queued=c)}else this.operations[f]={startTime:m,phase:0,duration:_,from:r,to:c,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const r=this.operations[f];return{from:r.from,to:r.to,phase:r.phase}}update(f){for(const r in this.operations){const c=this.operations[r];for(c.phase=(f-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,f)){delete this.operations[r];break}}}_nextOp(f,r){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=r,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},Ws={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Kc(f){return 6*Math.pow(1.5,22-f)}function Ah(f,r){const c=1<<f.z;return!r&&(f.x===0||f.x===c-1)||f.y===0||f.y===c-1}const Fn=f=>({u_matrix:f});function Il(f,r,c,m,_){if(_>0){const b=o.exported.now(),C=(b-f.timeAdded)/_,I=r?(b-r.timeAdded)/_:-1,M=c.getSource(),R=m.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),B=!r||Math.abs(r.tileID.overscaledZ-R)>Math.abs(f.tileID.overscaledZ-R),U=B&&f.refreshedUponExpiration?1:o.clamp(B?C:1-I,0,1);return f.refreshedUponExpiration&&C>=1&&(f.refreshedUponExpiration=!1),r?{opacity:1,mix:1-U}:{opacity:U,mix:0}}return{opacity:1,mix:0}}class Xf extends o.SourceCache{constructor(r){const c={type:"raster-dem",maxzoom:r.transform.maxZoom},m=new zn(cn(),null),_=Re("mock-dem",c,m,r.style);super("mock-dem",_,!1),_.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,c){r.state="loaded",c(null)}}class Yf extends o.SourceCache{constructor(r){const c=Re("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new zn(cn(),null),r.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,c,m){if(r.freezeTileCoverage)return;this.transform=r;const _=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,C)=>{if(b[C.key]="",!this._tiles[C.key]){const I=new o.Tile(C,this._source.tileSize*C.overscaleFactor(),r.tileZoom);I.state="loaded",this._tiles[C.key]=I}return b},{});for(const b in this._tiles)b in _||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(r){const c=this.proxyCachedFBO[r];if(c!==void 0){const m=Object.values(c);this.renderCachePool.push(...m),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class kh extends o.OverscaledTileID{constructor(r,c,m){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=c,this.projMatrix=m}}class Mh extends o.Elevation{constructor(r,c){super(),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,_,b]=function(M){const R=new o.StructArrayLayout2i4,B=new o.StructArrayLayout3ui6,U=131;R.reserve(17161),B.reserve(33800);const W=o.EXTENT/128,Q=o.EXTENT+W/2,J=Q+W;for(let te=-W;te<J;te+=W)for(let Z=-W;Z<J;Z+=W){const ce=Z<0||Z>Q||te<0||te>Q?24575:0,ae=o.clamp(Math.round(Z),0,o.EXTENT),fe=o.clamp(Math.round(te),0,o.EXTENT);R.emplaceBack(ae+ce,fe)}const ee=(te,Z)=>{const ce=Z*U+te;B.emplaceBack(ce+1,ce,ce+U),B.emplaceBack(ce+U,ce+U+1,ce+1)};for(let te=1;te<129;te++)for(let Z=1;Z<129;Z++)ee(Z,te);return[0,129].forEach(te=>{for(let Z=0;Z<130;Z++)ee(Z,te),ee(te,Z)}),[R,B,32768]}(),C=r.context;this.gridBuffer=C.createVertexBuffer(m,o.posAttributes.members),this.gridIndexBuffer=C.createIndexBuffer(_),this.gridSegments=o.SegmentVector.simpleSegment(0,0,m.length,_.length),this.gridNoSkirtSegments=o.SegmentVector.simpleSegment(0,0,m.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Yf(c.map),this.orthoMatrix=o.create(),o.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.EXTENT,0,o.EXTENT,0,1);const I=C.gl;this._overlapStencilMode=new o.StencilMode({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Xf(c.map)}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),r.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=r,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,c,m){if(r&&r.terrain){this._style!==r&&(this.style=r),this.enabled=!0;const _=r.terrain.properties;this.sourceCache=r.terrain.drapeRenderMode===0?this._mockSourceCache:r._getSourceCache(_.get("source")),this._exaggeration=_.get("exaggeration");const b=()=>{this.sourceCache.used&&o.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const C=this.getScaledDemTileSize();this.sourceCache.update(c,C,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,b(),this._initializing=!0),b(),c.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const r=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||r.efficiency!==100&&o.warnOnce(`Terrain render cache efficiency is not optimal (${r.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${r.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._sourceCaches)this._style._sourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const _=this.proxyCoords=c.getIds().map(M=>{const R=c.getTileByID(M).tileID;return R.projMatrix=m.calculateProjMatrix(R.toUnwrapped()),R});(function(M,R){const B=R.transform.pointCoordinate(R.transform.getCameraPoint()),U=new o.pointGeometry(B.x,B.y);M.sort((W,Q)=>{if(Q.overscaledZ-W.overscaledZ)return Q.overscaledZ-W.overscaledZ;const J=new o.pointGeometry(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),ee=new o.pointGeometry(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),te=U.mult(1<<W.canonical.z);return te.x-=.5,te.y-=.5,te.distSqr(J)-te.distSqr(ee)})})(_,this.painter),this._previousZoom=m.zoom;const b=this.proxyToSource||{};this.proxyToSource={},_.forEach(M=>{this.proxyToSource[M.key]={}}),this.terrainTileForTile={};const C=this._style._sourceCaches;for(const M in C){const R=C[M];if(!R.used||(R!==this.sourceCache&&this.resetTileLookupCache(R.id),this._setupProxiedCoordsForOrtho(R,r[M],b),R.usedForTerrain))continue;const B=r[M];R.getSource().reparseOverscaled&&this._assignTerrainTiles(B)}this.proxiedCoords[c.id]=_.map(M=>new kh(M,M.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1,this._updateTimestamp=o.exported.now();const I={};this._visibleDemTiles=[];for(const M of this.proxyCoords){const R=this.terrainTileForTile[M.key];if(!R)continue;const B=R.tileID.key;B in I||(this._visibleDemTiles.push(R),I[B]=B)}}_assignTerrainTiles(r){this._initializing||r.forEach(c=>{if(this.terrainTileForTile[c.key])return;const m=this._findTileCoveringTileID(c,this.sourceCache);m&&(this.terrainTileForTile[c.key]=m)})}_prepareDEMTextures(){const r=this.painter.context,c=r.gl;for(const m in this.terrainTileForTile){const _=this.terrainTileForTile[m],b=_.dem;!b||_.demTexture&&!_.needsDEMTextureUpload||(r.activeTexture.set(c.TEXTURE1),Cl(this.painter,_,b))}}_prepareDemTileUniforms(r,c,m,_){if(!c||c.demTexture==null)return!1;const b=r.tileID.canonical,C=Math.pow(2,c.tileID.canonical.z-b.z),I=_||"";return m[`u_dem_tl${I}`]=[b.x*C%1,b.y*C%1],m[`u_dem_scale${I}`]=C,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const r=this.painter.context,c=r.gl;if(!this._emptyDepthBufferTexture){const m=new o.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new o.Texture(r,m,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let r=0;const c=this._visibleDemTiles.reduce((m,_)=>{if(!_.dem)return m;const b=_.dem.tree.minimums[0];return b>0&&r++,m+b},0);return r?c/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,c=r.gl;r.activeTexture.set(c.TEXTURE2);const m=this._getLoadedAreaMinimum(),_=new o.RGBAImage({width:1,height:1},new Uint8Array(o.DEMData.pack(m,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(_,{premultiply:!1}):b=this._emptyDEMTexture=new o.Texture(r,_,c.RGBA,{premultiply:!1}),b}setupElevationDraw(r,c,m){const _=this.painter.context,b=_.gl,C=(I=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:o.DEMData.getUnpackVector(I),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var I;C.u_dem_size=this.sourceCache.getSource().tileSize,C.u_exaggeration=this.exaggeration();let M=null,R=null,B=1;if(m&&m.morphing&&this._useVertexMorphing){const U=m.morphing.srcDemTile,W=m.morphing.dstDemTile;B=m.morphing.phase,U&&W&&(this._prepareDemTileUniforms(r,U,C,"_prev")&&(R=U),this._prepareDemTileUniforms(r,W,C)&&(M=W))}if(R&&M?(_.activeTexture.set(b.TEXTURE2),M.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),_.activeTexture.set(b.TEXTURE4),R.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),C.u_dem_lerp=B):(M=this.terrainTileForTile[r.tileID.key],_.activeTexture.set(b.TEXTURE2),(this._prepareDemTileUniforms(r,M,C)?M.demTexture:this.emptyDEMTexture).bind(b.NEAREST,b.CLAMP_TO_EDGE)),_.activeTexture.set(b.TEXTURE3),m&&m.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),this._depthFBO&&(C.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),C.u_depth_size_inv=[1,1]),m&&m.useMeterToDem&&M){const U=(1<<M.tileID.canonical.z)*o.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;C.u_meter_to_dem=U}if(m&&m.labelPlaneMatrixInv&&(C.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),c.setTerrainUniformValues(_,C),this.painter.transform.projection.name==="globe"){const U=this.globeUniformValues(this.painter.transform,r.tileID.canonical,m&&m.useDenormalizedUpVectorScale);c.setGlobeUniformValues(_,U)}}globeUniformValues(r,c,m){const _=r.projection;return{u_tile_tl_up:_.upVector(c,0,0),u_tile_tr_up:_.upVector(c,o.EXTENT,0),u_tile_br_up:_.upVector(c,o.EXTENT,o.EXTENT),u_tile_bl_up:_.upVector(c,0,o.EXTENT),u_tile_up_scale:m?o.globeMetersToEcef(1):_.upVectorScale(c,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const c=this.painter,m=this.painter.context;r.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(_,b,C,I,M){if(_.transform.projection.name==="globe")(function(R,B,U,W,Q){const J=R.context,ee=J.gl;let te,Z;const ce=R.options.showTerrainWireframe?2:0,ae=R.transform,fe=o.globeUseCustomAntiAliasing(R,J,ae),Ce=(ht,Ue)=>{if(Z===ht)return;const Le=[Ws[ht],"PROJECTION_GLOBE_VIEW"];fe&&Le.push("CUSTOM_ANTIALIASING"),Ue&&Le.push(Ws[ce]),te=R.useProgram("globeRaster",null,Le),Z=ht},we=R.colorModeForRenderPass(),Ae=new o.DepthMode(ee.LEQUAL,o.DepthMode.ReadWrite,R.depthRangeFor3D);ds.update(Q);const Be=o.calculateGlobeMercatorMatrix(ae),Ne=[o.mercatorXfromLng(ae.center.lng),o.mercatorYfromLat(ae.center.lat)],Ge=ce?[!1,!0]:[!1],bt=R.globeSharedBuffers,Fe=[ae.width*o.exported.devicePixelRatio,ae.height*o.exported.devicePixelRatio],rt=Float32Array.from(ae.globeMatrix),He={useDenormalizedUpVectorScale:!0};if(Ge.forEach(ht=>{const Ue=R.transform,Le=Kc(Ue.zoom)*B.exaggeration();Z=-1;const Ze=ht?ee.LINES:ee.TRIANGLES;for(const lt of W){const mt=U.getTile(lt),Wt=o.StencilMode.disabled,mn=B.prevTerrainTileForTile[lt.key],Ut=B.terrainTileForTile[lt.key];Ih(mn,Ut)&&ds.newMorphing(lt.key,mn,Ut,Q,250),J.activeTexture.set(ee.TEXTURE0),mt.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const Ft=ds.getMorphValuesForProxy(lt.key),Ht=Ft?1:0;Ft&&o.extend$1(He,{morphing:{srcDemTile:Ft.from,dstDemTile:Ft.to,phase:o.easeCubicInOut(Ft.phase)}});const En=o.tileCornersToBounds(lt.canonical),Qt=o.getLatitudinalLod(En.getCenter().lat),Zn=o.getGridMatrix(lt.canonical,En,Qt,Ue.worldSize/Ue._pixelsPerMercatorPixel),ei=o.globeNormalizeECEF(o.globeTileBounds(lt.canonical)),ai=Yc(Ue.projMatrix,rt,Be,ei,o.globeToMercatorTransition(Ue.zoom),Ne,Ue.frustumCorners.TL,Ue.frustumCorners.TR,Ue.frustumCorners.BR,Ue.frustumCorners.BL,Ue.globeCenterInViewSpace,Ue.globeRadius,Fe,Le,Zn);if(Ce(Ht,ht),B.setupElevationDraw(mt,te,He),R.prepareDrawProgram(J,te,lt.toUnwrapped()),bt){const[ii,Oi,Dr]=ht?bt.getWirefameBuffers(R.context,Qt):bt.getGridBuffers(Qt,Le!==0);te.draw(J,Ze,Ae,Wt,we,o.CullFaceMode.backCCW,ai,"globe_raster",ii,Oi,Dr)}}}),bt){const ht=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];fe&&ht.push("CUSTOM_ANTIALIASING"),te=R.useProgram("globeRaster",null,ht);for(const Ue of W){const{x:Le,y:Ze,z:lt}=Ue.canonical,mt=Ze===0,Wt=Ze===(1<<lt)-1,[mn,Ut,Ft,Ht]=bt.getPoleBuffers(lt);if(Ht&&(mt||Wt)){const En=U.getTile(Ue);J.activeTexture.set(ee.TEXTURE0),En.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);let Qt=o.globePoleMatrixForTile(lt,Le,ae);const Zn=o.globeNormalizeECEF(o.globeTileBounds(Ue.canonical)),ei=(ai,ii)=>ai.draw(J,ee.TRIANGLES,Ae,o.StencilMode.disabled,we,o.CullFaceMode.disabled,Yc(ae.projMatrix,Qt,Qt,Zn,0,Ne,ae.frustumCorners.TL,ae.frustumCorners.TR,ae.frustumCorners.BR,ae.frustumCorners.BL,ae.globeCenterInViewSpace,ae.globeRadius,Fe,0),"globe_pole_raster",ii,Ft,Ht);B.setupElevationDraw(En,te,He),R.prepareDrawProgram(J,te,Ue.toUnwrapped()),mt&&ei(te,mn),Wt&&(Qt=o.scale(o.create(),Qt,[1,-1,1]),ei(te,Ut))}}}})(_,b,C,I,M);else{const R=_.context,B=R.gl;let U,W;const Q=_.options.showTerrainWireframe?2:0,J=(ae,fe)=>{if(W===ae)return;const Ce=[Ws[ae]];fe&&Ce.push(Ws[Q]),U=_.useProgram("terrainRaster",null,Ce),W=ae},ee=_.colorModeForRenderPass(),te=new o.DepthMode(B.LEQUAL,o.DepthMode.ReadWrite,_.depthRangeFor3D);ds.update(M);const Z=_.transform,ce=Kc(Z.zoom)*b.exaggeration();(Q?[!1,!0]:[!1]).forEach(ae=>{W=-1;const fe=ae?B.LINES:B.TRIANGLES,[Ce,we]=ae?b.getWirefameBuffer():[b.gridIndexBuffer,b.gridSegments];for(const Ae of I){const Be=C.getTile(Ae),Ne=o.StencilMode.disabled,Ge=b.prevTerrainTileForTile[Ae.key],bt=b.terrainTileForTile[Ae.key];Ih(Ge,bt)&&ds.newMorphing(Ae.key,Ge,bt,M,250),R.activeTexture.set(B.TEXTURE0),Be.texture.bind(B.LINEAR,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST);const Fe=ds.getMorphValuesForProxy(Ae.key),rt=Fe?1:0;let He;Fe&&(He={morphing:{srcDemTile:Fe.from,dstDemTile:Fe.to,phase:o.easeCubicInOut(Fe.phase)}});const ht=Ch(Ae.projMatrix,Ah(Ae.canonical,Z.renderWorldCopies)?ce/10:ce);J(rt,ae),b.setupElevationDraw(Be,U,He),_.prepareDrawProgram(R,U,Ae.toUnwrapped()),U.draw(R,fe,te,Ne,ee,o.CullFaceMode.backCCW,ht,"terrain_raster",b.gridBuffer,Ce,we)}})}}(c,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const c=this.painter,m=this.painter.context,_=this.proxySourceCache,b=this.proxiedCoords[_.id],C=this._drapedRenderBatches.shift(),I=[],M=c.style.order;let R=0;for(const B of b){const U=_.getTileByID(B.proxyTileKey),W=_.proxyCachedFBO[B.key]?_.proxyCachedFBO[B.key][r]:void 0,Q=W!==void 0?_.renderCache[W]:this.pool[R++],J=W!==void 0;if(U.texture=Q.tex,J&&!Q.dirty){I.push(U.tileID);continue}let ee;m.bindFramebuffer.set(Q.fb.framebuffer),this.renderedToTile=!1,Q.dirty&&(m.clear({color:o.Color.transparent,stencil:0}),Q.dirty=!1);for(let te=C.start;te<=C.end;++te){const Z=c.style._layers[M[te]];if(Z.isHidden(c.transform.zoom))continue;const ce=c.style._getLayerSourceCache(Z),ae=ce?this.proxyToSource[B.key][ce.id]:[B];if(!ae)continue;const fe=ae;m.viewport.set([0,0,Q.fb.width,Q.fb.height]),ee!==(ce?ce.id:null)&&(this._setupStencil(Q,ae,Z,ce),ee=ce?ce.id:null),c.renderLayer(c,ce,Z,fe)}this.renderedToTile?(Q.dirty=!0,I.push(U.tileID)):J||--R,R===5&&(R=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,c.width,c.height]),C.end+1}postRender(){}renderCacheEfficiency(r){const c=r.order.length;if(c===0)return{efficiency:100};let m,_=0,b=0,C=!1;for(let I=0;I<c;++I){const M=r._layers[r.order[I]];this._style.isLayerDraped(M)?(C&&++_,++b):C||(C=!0,m=M.id)}return b===0?{efficiency:100}:{efficiency:100*(1-_/b),firstUndrapedLayer:m}}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{r=Math.min(r,c.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,c,m){if(!this._visibleDemTiles)return null;const _=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const C=b.tileID,I=1<<C.overscaledZ,{x:M,y:R}=C.canonical,B=M/I,U=(M+1)/I,W=R/I,Q=(R+1)/I;return{minx:B,miny:W,maxx:U,maxy:Q,t:b.dem.tree.raycastRoot(B,W,U,Q,r,c,m),tile:b}});_.sort((b,C)=>(b.t!==null?b.t:Number.MAX_VALUE)-(C.t!==null?C.t:Number.MAX_VALUE));for(const b of _){if(b.t==null)return null;const C=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,r,c,m);if(C!=null)return C}return null}_createFBO(){const r=this.painter.context,c=r.gl,m=this.drapeBufferSize;r.activeTexture.set(c.TEXTURE0);const _=new o.Texture(r,{width:m[0],height:m[1],data:null},c.RGBA);_.bind(c.LINEAR,c.CLAMP_TO_EDGE);const b=r.createFramebuffer(m[0],m[1],!1);return b.colorAttachment.set(_.texture),b.depthAttachment=new Fc(r,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&!r.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:b,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const r in this._style._sourceCaches)if(this._style._sourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const c=this._style._layers[r],m=c.isHidden(this.painter.transform.zoom);return c.type==="custom"?!m&&c.shouldRedrape():!m&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const m of this._style._getSources())if(m instanceof N){r=!0;break}if(!r)return;const c={};for(let m=0;m<this._style.order.length;++m){const _=this._style._layers[this._style.order[m]],b=this._style._getLayerSourceCache(_);if(b&&!c[b.id]&&!_.isHidden(this.painter.transform.zoom)&&_.type==="line"&&_.widthExpression()instanceof o.ZoomDependentExpression){c[b.id]=!0;for(const C of this.proxyCoords){const I=this.proxyToSource[C.key][b.id];if(I)for(const M of I)this._clearRenderCacheForTile(b.id,M)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const m in this._style._sourceCaches)if(this._style._sourceCaches[m]._source instanceof q){r=!0;break}if(!r)return;const c={};for(let m=0;m<this._style.order.length;++m){const _=this._style._layers[this._style.order[m]],b=this._style._getLayerSourceCache(_);if(!b||c[b.id]||_.isHidden(this.painter.transform.zoom)||_.type!=="raster")continue;const C=_.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const M=this.proxyToSource[I.key][b.id];if(M)for(const R of M){const B=Il(b.getTile(R),b.findLoadedParent(R,0),b,this.painter.transform,C);(B.opacity!==1||B.mix!==0)&&this._clearRenderCacheForTile(b.id,R)}}}}_setupDrapedRenderBatches(){const r=this._style.order,c=r.length;if(c===0)return;const m=[];let _,b=0,C=this._style._layers[r[b]];for(;!this._style.isLayerDraped(C)&&C.isHidden(this.painter.transform.zoom)&&++b<c;)C=this._style._layers[r[b]];for(;b<c;++b){const I=this._style._layers[r[b]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?_===void 0&&(_=b):_!==void 0&&(m.push({start:_,end:b-1}),_=void 0))}_!==void 0&&m.push({start:_,end:b-1}),this._drapedRenderBatches=m}_setupRenderCache(r){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const C=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let I=0;I<C.length;++I){const M=Object.values(C[I]);c.renderCachePool.push(...M)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,_=this._tilesDirty;for(let C=m.length-1;C>=0;C--){const I=m[C];if(c.getTileByID(I.key),c.proxyCachedFBO[I.key]!==void 0){const M=r[I.key],R=this.proxyToSource[I.key];let B=0;for(const U in R){const W=R[U],Q=M[U];if(!Q||Q.length!==W.length||W.some((J,ee)=>J!==Q[ee]||_[U]&&_[U].hasOwnProperty(J.key))){B=-1;break}++B}for(const U in c.proxyCachedFBO[I.key])c.renderCache[c.proxyCachedFBO[I.key][U]].dirty=B<0||B!==Object.values(M).length}}const b=[...this._drapedRenderBatches];b.sort((C,I)=>I.end-I.start-(C.end-C.start));for(const C of b)for(const I of m){if(c.proxyCachedFBO[I.key])continue;let M=c.renderCachePool.pop();M===void 0&&c.renderCache.length<50&&(M=c.renderCache.length,c.renderCache.push(this._createFBO())),M!==void 0&&(c.proxyCachedFBO[I.key]={},c.proxyCachedFBO[I.key][C.start]=M,c.renderCache[M].dirty=!0)}this._tilesDirty={}}_setupStencil(r,c,m,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,C=b.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let I;if(m.isTileClipped())I=c.length,this._overlapStencilMode.test={func:C.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:C.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):o.StencilMode.disabled}_renderTileClippingMasks(r,c){const m=this.painter,_=this.painter.context,b=_.gl;m._tileClippingMaskIDs={},_.setColorMode(o.ColorMode.disabled),_.setDepthMode(o.DepthMode.disabled);const C=m.useProgram("clippingMask");for(const I of r){const M=m._tileClippingMaskIDs[I.key]=--c;C.draw(_,b.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:b.ALWAYS,mask:0},M,255,b.KEEP,b.KEEP,b.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Fn(I.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(r){const c=this.painter.transform;if(r.x<0||r.x>c.width||r.y<0||r.y>c.height)return null;const m=[r.x,r.y,1,1];o.transformMat4$1(m,m,c.pixelMatrixInverse),o.scale$1(m,m,1/m[3]),m[0]/=c.worldSize,m[1]/=c.worldSize;const _=c._camera.position,b=o.mercatorZfromAltitude(1,c.center.lat),C=[_[0],_[1],_[2]/b,0],I=o.subtract([],m.slice(0,3),C);o.normalize(I,I);const M=this.raycast(C,I,this._exaggeration);return M!==null&&M?(o.scaleAndAdd(C,C,I,M),C[3]=C[2],C[2]*=b,C):null}drawDepth(){const r=this.painter,c=r.context,m=this.proxySourceCache,_=Math.ceil(r.width),b=Math.ceil(r.height);if(!this._depthFBO||this._depthFBO.width===_&&this._depthFBO.height===b||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const C=c.gl,I=c.createFramebuffer(_,b,!0);c.activeTexture.set(C.TEXTURE0);const M=new o.Texture(c,{width:_,height:b,data:null},C.RGBA);M.bind(C.NEAREST,C.CLAMP_TO_EDGE),I.colorAttachment.set(M.texture);const R=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,_,b);I.depthAttachment.set(R),this._depthFBO=I,this._depthTexture=M}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,_,b]),function(C,I,M,R){if(C.transform.projection.name==="globe")return;const B=C.context,U=B.gl;B.clear({depth:1});const W=C.useProgram("terrainDepth"),Q=new o.DepthMode(U.LESS,o.DepthMode.ReadWrite,C.depthRangeFor3D);for(const J of R){const ee=M.getTile(J),te=Ch(J.projMatrix,0);I.setupElevationDraw(ee,W),W.draw(B,U.TRIANGLES,Q,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.backCCW,te,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}}(r,this,m,this.proxyCoords)}_setupProxiedCoordsForOrtho(r,c,m){if(r.getSource()instanceof Ie)return this._setupProxiedCoordsForImageSource(r,c,m);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const _=this.proxiedCoords[r.id]=[],b=this.proxyCoords;for(let I=0;I<b.length;I++){const M=b[I],R=this._findTileCoveringTileID(M,r);if(R){const B=this._createProxiedId(M,R,m[M.key]&&m[M.key][r.id]);_.push(B),this.proxyToSource[M.key][r.id]=[B]}}let C=!1;for(let I=0;I<c.length;I++){const M=r.getTile(c[I]);if(!M||!M.hasData())continue;const R=this._findTileCoveringTileID(M.tileID,this.proxySourceCache);if(R&&R.tileID.canonical.z!==M.tileID.canonical.z){const B=this.proxyToSource[R.tileID.key][r.id],U=this._createProxiedId(R.tileID,M,m[R.tileID.key]&&m[R.tileID.key][r.id]);B?B.splice(B.length-1,0,U):this.proxyToSource[R.tileID.key][r.id]=[U],_.push(U),C=!0}}this._sourceTilesOverlap[r.id]=C}_setupProxiedCoordsForImageSource(r,c,m){if(!r.getSource().loaded())return;const _=this.proxiedCoords[r.id]=[],b=this.proxyCoords,C=r.getSource(),I=new o.pointGeometry(C.tileID.x,C.tileID.y)._div(1<<C.tileID.z),M=C.coordinates.map(o.MercatorCoordinate.fromLngLat).reduce((B,U)=>(B.min.x=Math.min(B.min.x,U.x-I.x),B.min.y=Math.min(B.min.y,U.y-I.y),B.max.x=Math.max(B.max.x,U.x-I.x),B.max.y=Math.max(B.max.y,U.y-I.y),B),{min:new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),R=(B,U)=>{const W=B.wrap+B.canonical.x/(1<<B.canonical.z),Q=B.canonical.y/(1<<B.canonical.z),J=o.EXTENT/(1<<B.canonical.z),ee=U.wrap+U.canonical.x/(1<<U.canonical.z),te=U.canonical.y/(1<<U.canonical.z);return W+J<ee+M.min.x||W>ee+M.max.x||Q+J<te+M.min.y||Q>te+M.max.y};for(let B=0;B<b.length;B++){const U=b[B];for(let W=0;W<c.length;W++){const Q=r.getTile(c[W]);if(!Q||!Q.hasData()||R(U,Q.tileID))continue;const J=this._createProxiedId(U,Q,m[U.key]&&m[U.key][r.id]),ee=this.proxyToSource[U.key][r.id];ee?ee.push(J):this.proxyToSource[U.key][r.id]=[J],_.push(J)}}}_createProxiedId(r,c,m){let _=this.orthoMatrix;if(m){const b=m.find(C=>C.key===c.tileID.key);if(b)return b}if(c.tileID.key!==r.key){const b=r.canonical.z-c.tileID.canonical.z;let C,I,M;_=o.create();const R=c.tileID.wrap-r.wrap<<r.overscaledZ;b>0?(C=o.EXTENT>>b,I=C*((c.tileID.canonical.x<<b)-r.canonical.x+R),M=C*((c.tileID.canonical.y<<b)-r.canonical.y)):(C=o.EXTENT<<-b,I=o.EXTENT*(c.tileID.canonical.x-(r.canonical.x+R<<-b)),M=o.EXTENT*(c.tileID.canonical.y-(r.canonical.y<<-b))),o.ortho(_,0,C,0,C,0,1),o.translate(_,_,[I,M,0])}return new kh(c.tileID,r.key,_)}_findTileCoveringTileID(r,c){let m=c.getTile(r);if(m&&m.hasData())return m;const _=this._findCoveringTileCache[c.id],b=_[r.key];if(m=b?c.getTileByID(b):null,m&&m.hasData()||b===null)return m;let C=m?m.tileID:r,I=C.overscaledZ;const M=c.getSource().minzoom,R=[];if(!b){const U=c.getSource().maxzoom;if(r.canonical.z>=U){const W=r.canonical.z-U;c.getSource().reparseOverscaled?(I=Math.max(r.canonical.z+2,c.transform.tileZoom),C=new o.OverscaledTileID(I,r.wrap,U,r.canonical.x>>W,r.canonical.y>>W)):W!==0&&(I=U,C=new o.OverscaledTileID(I,r.wrap,U,r.canonical.x>>W,r.canonical.y>>W))}C.key!==r.key&&(R.push(C.key),m=c.getTile(C))}const B=U=>{R.forEach(W=>{_[W]=U}),R.length=0};for(I-=1;I>=M&&(!m||!m.hasData());I--){m&&B(m.tileID.key);const U=C.calculateScaledKey(I);if(m=c.getTileByID(U),m&&m.hasData())break;const W=_[U];if(W===null)break;W===void 0?R.push(U):m=c.getTileByID(W)}return B(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,c){let m=this._tilesDirty[r];m||(m=this._tilesDirty[r]={}),m[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const r=function(c){let m=0;const _=new o.StructArrayLayout2ui4,b=131;for(let C=1;C<129;C++){for(let I=1;I<129;I++)m=C*b+I,_.emplaceBack(m,m+1),_.emplaceBack(m,m+b),_.emplaceBack(m+1,m+b),C===128&&_.emplaceBack(m+b,m+b+1);_.emplaceBack(m+1,m+1+b)}return _}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(r),this.wireframeSegments=o.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,r.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Ph{static cacheKey(r,c,m,_){let b=`${c}${_?_.cacheKey:""}`;for(const C of m)r.usedDefines.includes(C)&&(b+=`/${C}`);return b}constructor(r,c,m,_,b,C){const I=r.gl;this.program=I.createProgram();const M=function(Z){const ce=[];for(let ae=0;ae<Z.length;ae++){if(Z[ae]===null)continue;const fe=Z[ae].split(" ");ce.push(fe.pop())}return ce}(m.staticAttributes),R=_?_.getBinderAttributes():[],B=M.concat(R);let U=_?_.defines():[];U=U.concat(C.map(Z=>`#define ${Z}`));const W=r.isWebGL2?`#version 300 es
`:"",Q=W+U.concat(r.extStandardDerivatives&&W.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Wc):Wc,Wc,Zc,Hf.fragmentSource,Sh.fragmentSource,m.fragmentSource).join(`
`),J=W+U.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Zc,Hf.vertexSource,Sh.vertexSource,wh.vertexSource,m.vertexSource).join(`
`),ee=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(ee,Q),I.compileShader(ee),I.attachShader(this.program,ee);const te=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(te,J),I.compileShader(te),I.attachShader(this.program,te),this.attributes={},this.numAttributes=B.length;for(let Z=0;Z<this.numAttributes;Z++)B[Z]&&(I.bindAttribLocation(this.program,Z,B[Z]),this.attributes[B[Z]]=Z);I.linkProgram(this.program),I.deleteShader(te),I.deleteShader(ee),this.fixedUniforms=b(r),this.binderUniforms=_?_.getUniforms(r):[],C.includes("TERRAIN")&&(this.terrainUniforms=(Z=>({u_dem:new o.Uniform1i(Z),u_dem_prev:new o.Uniform1i(Z),u_dem_unpack:new o.Uniform4f(Z),u_dem_tl:new o.Uniform2f(Z),u_dem_scale:new o.Uniform1f(Z),u_dem_tl_prev:new o.Uniform2f(Z),u_dem_scale_prev:new o.Uniform1f(Z),u_dem_size:new o.Uniform1f(Z),u_dem_lerp:new o.Uniform1f(Z),u_exaggeration:new o.Uniform1f(Z),u_depth:new o.Uniform1i(Z),u_depth_size_inv:new o.Uniform2f(Z),u_meter_to_dem:new o.Uniform1f(Z),u_label_plane_matrix_inv:new o.UniformMatrix4f(Z)}))(r)),C.includes("GLOBE")&&(this.globeUniforms=(Z=>({u_tile_tl_up:new o.Uniform3f(Z),u_tile_tr_up:new o.Uniform3f(Z),u_tile_br_up:new o.Uniform3f(Z),u_tile_bl_up:new o.Uniform3f(Z),u_tile_up_scale:new o.Uniform1f(Z)}))(r)),C.includes("FOG")&&(this.fogUniforms=(Z=>({u_fog_matrix:new o.UniformMatrix4f(Z),u_fog_range:new o.Uniform2f(Z),u_fog_color:new o.Uniform4f(Z),u_fog_horizon_blend:new o.Uniform1f(Z),u_fog_temporal_offset:new o.Uniform1f(Z),u_frustum_tl:new o.Uniform3f(Z),u_frustum_tr:new o.Uniform3f(Z),u_frustum_br:new o.Uniform3f(Z),u_frustum_bl:new o.Uniform3f(Z),u_globe_pos:new o.Uniform3f(Z),u_globe_radius:new o.Uniform1f(Z),u_globe_transition:new o.Uniform1f(Z),u_is_globe:new o.Uniform1i(Z),u_viewport:new o.Uniform2f(Z)}))(r))}}setTerrainUniformValues(r,c){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const _ in c)m[_]&&m[_].set(this.program,_,c[_])}}setGlobeUniformValues(r,c){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const _ in c)m[_]&&m[_].set(this.program,_,c[_])}}setFogUniformValues(r,c){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const _ in c)m[_].set(this.program,_,c[_])}}draw(r,c,m,_,b,C,I,M,R,B,U,W,Q,J,ee){const te=r.gl;if(this.failedToCreate)return;r.program.set(this.program),r.setDepthMode(m),r.setStencilMode(_),r.setColorMode(b),r.setCullFace(C);for(const ce of Object.keys(this.fixedUniforms))this.fixedUniforms[ce].set(this.program,ce,I[ce]);J&&J.setUniforms(this.program,r,this.binderUniforms,W,{zoom:Q});const Z={[te.LINES]:2,[te.TRIANGLES]:3,[te.LINE_STRIP]:1}[c];for(const ce of U.get()){const ae=ce.vaos||(ce.vaos={});(ae[M]||(ae[M]=new Tl)).bind(r,this,R,J?J.getPaintVertexBuffers():[],B,ce.vertexOffset,ee||[]),te.drawElements(c,ce.primitiveLength*Z,te.UNSIGNED_SHORT,ce.primitiveOffset*Z*2)}}}function Kf(f,r){const c=Math.pow(2,r.tileID.overscaledZ),m=r.tileSize*Math.pow(2,f.transform.tileZoom)/c,_=m*(r.tileID.canonical.x+r.tileID.wrap*c),b=m*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_tile_units_to_pixels:1/At(r,1,f.transform.tileZoom),u_pixel_coord_upper:[_>>16,b>>16],u_pixel_coord_lower:[65535&_,65535&b]}}const Og=o.create(),Jc=(f,r,c,m,_,b,C,I,M,R,B)=>{const U=r.style.light,W=U.properties.get("position"),Q=[W.x,W.y,W.z],J=o.create$1();U.properties.get("anchor")==="viewport"&&(o.fromRotation(J,-r.transform.angle),o.transformMat3(Q,Q,J));const ee=U.properties.get("color"),te=r.transform,Z={u_matrix:f,u_lightpos:Q,u_lightintensity:U.properties.get("intensity"),u_lightcolor:[ee.r,ee.g,ee.b],u_vertical_gradient:+c,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Og,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:_,u_edge_radius:b};return te.projection.name==="globe"&&(Z.u_tile_id=[C.canonical.x,C.canonical.y,1<<C.canonical.z],Z.u_zoom_transition=M,Z.u_inv_rot_matrix=B,Z.u_merc_center=R,Z.u_up_dir=te.projection.upVector(new o.CanonicalTileID(0,0,0),R[0]*o.EXTENT,R[1]*o.EXTENT),Z.u_height_lift=I),Z},zh=(f,r,c,m,_,b,C,I,M,R,B,U)=>{const W=Jc(f,r,c,m,_,b,C,M,R,B,U),Q={u_height_factor:-Math.pow(2,C.overscaledZ)/I.tileSize/8};return o.extend(W,Kf(r,I),Q)},Qc=f=>({u_matrix:f}),eu=(f,r,c)=>o.extend(Qc(f),Kf(r,c)),Jf=(f,r)=>({u_matrix:f,u_world:r}),Qf=(f,r,c,m)=>o.extend(eu(f,r,c),{u_world:m}),Fg=o.create(),Al=(f,r,c,m,_,b)=>{const C=f.transform,I=C.projection.name==="globe";let M;if(b.paint.get("circle-pitch-alignment")==="map")if(I){const B=o.globePixelsToTileUnits(C.zoom,r.canonical)*C._pixelsPerMercatorPixel;M=Float32Array.from([B,0,0,B])}else M=C.calculatePixelsToTileUnitsMatrix(c);else M=new Float32Array([C.pixelsToGLUnits[0],0,0,C.pixelsToGLUnits[1]]);const R={u_camera_to_center_distance:C.cameraToCenterDistance,u_matrix:f.translatePosMatrix(r.projMatrix,c,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_device_pixel_ratio:o.exported.devicePixelRatio,u_extrude_scale:M,u_inv_rot_matrix:Fg,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){R.u_inv_rot_matrix=m,R.u_merc_center=_,R.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],R.u_zoom_transition=o.globeToMercatorTransition(C.zoom);const B=_[0]*o.EXTENT,U=_[1]*o.EXTENT;R.u_up_dir=C.projection.upVector(new o.CanonicalTileID(0,0,0),B,U)}return R},kl=f=>{const r=[];return f.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),f.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r},ep=(f,r,c,m)=>{const _=o.EXTENT/c.tileSize;return{u_matrix:f,u_camera_to_center_distance:r.getCameraToCenterDistance(m),u_extrude_scale:[r.pixelsToGLUnits[0]/_,r.pixelsToGLUnits[1]/_]}},Ml=(f,r,c=1)=>({u_matrix:f,u_color:r,u_overlay:0,u_overlay_scale:c}),Lh=o.create(),vo=(f,r,c,m,_,b,C)=>{const I=f.transform,M=I.projection.name==="globe",R=M?o.globePixelsToTileUnits(I.zoom,r.canonical)*I._pixelsPerMercatorPixel:At(c,1,b),B={u_matrix:r.projMatrix,u_extrude_scale:R,u_intensity:C,u_inv_rot_matrix:Lh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(M){B.u_inv_rot_matrix=m,B.u_merc_center=_,B.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],B.u_zoom_transition=o.globeToMercatorTransition(I.zoom);const U=_[0]*o.EXTENT,W=_[1]*o.EXTENT;B.u_up_dir=I.projection.upVector(new o.CanonicalTileID(0,0,0),U,W)}return B},Dh=(f,r,c,m,_,b,C)=>{const I=f.transform,M=I.calculatePixelsToTileUnitsMatrix(r);return{u_matrix:Rh(f,r,c,m),u_pixels_to_tile_units:M,u_device_pixel_ratio:b,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:nu(c)?r.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:tu(r,f.transform),u_alpha_discard_threshold:0,u_trim_offset:C}},tp=(f,r,c,m,_)=>{const b=f.transform;return{u_matrix:Rh(f,r,c,m),u_texsize:r.imageAtlasTexture.size,u_pixels_to_tile_units:b.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:_,u_image:0,u_tile_units_to_pixels:tu(r,b),u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function tu(f,r){return 1/At(f,1,r.tileZoom)}function Rh(f,r,c,m){return f.translatePosMatrix(m||r.tileID.projMatrix,r,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function nu(f){const r=f.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}const Vg=(f,r,c,m,_,b)=>{return{u_matrix:f,u_tl_parent:r,u_scale_parent:c,u_fade_t:m.mix,u_opacity:m.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(I=_.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(C=_.paint.get("raster-contrast"),C>0?1/(1-C):1+C),u_spin_weights:Bh(_.paint.get("raster-hue-rotate")),u_perspective_transform:b};var C,I};function Bh(f){f*=Math.PI/180;const r=Math.sin(f),c=Math.cos(f);return[(2*c+1)/3,(-Math.sqrt(3)*r-c+1)/3,(Math.sqrt(3)*r-c+1)/3]}const np=o.create(),Pl=(f,r,c,m,_,b,C,I,M,R,B,U,W,Q,J,ee)=>{const te=_.transform,Z={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:te.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:te.width/te.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:C,u_coord_matrix:I,u_is_text:+M,u_pitch_with_map:+m,u_texsize:R,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:np,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:np,u_up_vector:[0,-1,0]};return ee.name==="globe"&&(Z.u_tile_id=[B.canonical.x,B.canonical.y,1<<B.canonical.z],Z.u_zoom_transition=U,Z.u_inv_rot_matrix=Q,Z.u_merc_center=W,Z.u_camera_forward=te._camera.forward(),Z.u_ecef_origin=o.globeECEFOrigin(te.globeMatrix,B.toUnwrapped()),Z.u_tile_matrix=Float32Array.from(te.globeMatrix),Z.u_up_vector=J),Z},ip=(f,r,c,m,_,b,C,I,M,R,B,U,W,Q,J,ee,te)=>o.extend(Pl(f,r,c,m,_,b,C,I,M,R,U,W,Q,J,ee,te),{u_gamma_scale:m?_.transform.cameraToCenterDistance*Math.cos(_.terrain?0:_.transform._pitch):1,u_device_pixel_ratio:o.exported.devicePixelRatio,u_is_halo:+B}),Oh=(f,r,c,m,_,b,C,I,M,R,B,U,W,Q,J,ee)=>o.extend(ip(f,r,c,m,_,b,C,I,!0,M,!0,B,U,W,Q,J,ee),{u_texsize_icon:R,u_texture_icon:1}),$g=(f,r,c)=>({u_matrix:f,u_opacity:r,u_color:c}),Fh=(f,r,c,m,_)=>o.extend(function(b,C,I){const M=C.imageManager.getPattern(b.toString()),{width:R,height:B}=C.imageManager.getPixelSize(),U=Math.pow(2,I.tileID.overscaledZ),W=I.tileSize*Math.pow(2,C.transform.tileZoom)/U,Q=W*(I.tileID.canonical.x+I.tileID.wrap*U),J=W*I.tileID.canonical.y;return{u_image:0,u_pattern_tl:M.tl,u_pattern_br:M.br,u_texsize:[R,B],u_pattern_size:M.displaySize,u_tile_units_to_pixels:1/At(I,1,C.transform.tileZoom),u_pixel_coord_upper:[Q>>16,J>>16],u_pixel_coord_lower:[65535&Q,65535&J]}}(m,c,_),{u_matrix:f,u_opacity:r}),Ng={fillExtrusion:f=>({u_matrix:new o.UniformMatrix4f(f),u_lightpos:new o.Uniform3f(f),u_lightintensity:new o.Uniform1f(f),u_lightcolor:new o.Uniform3f(f),u_vertical_gradient:new o.Uniform1f(f),u_opacity:new o.Uniform1f(f),u_edge_radius:new o.Uniform1f(f),u_ao:new o.Uniform2f(f),u_tile_id:new o.Uniform3f(f),u_zoom_transition:new o.Uniform1f(f),u_inv_rot_matrix:new o.UniformMatrix4f(f),u_merc_center:new o.Uniform2f(f),u_up_dir:new o.Uniform3f(f),u_height_lift:new o.Uniform1f(f)}),fillExtrusionPattern:f=>({u_matrix:new o.UniformMatrix4f(f),u_lightpos:new o.Uniform3f(f),u_lightintensity:new o.Uniform1f(f),u_lightcolor:new o.Uniform3f(f),u_vertical_gradient:new o.Uniform1f(f),u_height_factor:new o.Uniform1f(f),u_edge_radius:new o.Uniform1f(f),u_ao:new o.Uniform2f(f),u_tile_id:new o.Uniform3f(f),u_zoom_transition:new o.Uniform1f(f),u_inv_rot_matrix:new o.UniformMatrix4f(f),u_merc_center:new o.Uniform2f(f),u_up_dir:new o.Uniform3f(f),u_height_lift:new o.Uniform1f(f),u_image:new o.Uniform1i(f),u_texsize:new o.Uniform2f(f),u_pixel_coord_upper:new o.Uniform2f(f),u_pixel_coord_lower:new o.Uniform2f(f),u_tile_units_to_pixels:new o.Uniform1f(f),u_opacity:new o.Uniform1f(f)}),fill:f=>({u_matrix:new o.UniformMatrix4f(f)}),fillPattern:f=>({u_matrix:new o.UniformMatrix4f(f),u_image:new o.Uniform1i(f),u_texsize:new o.Uniform2f(f),u_pixel_coord_upper:new o.Uniform2f(f),u_pixel_coord_lower:new o.Uniform2f(f),u_tile_units_to_pixels:new o.Uniform1f(f)}),fillOutline:f=>({u_matrix:new o.UniformMatrix4f(f),u_world:new o.Uniform2f(f)}),fillOutlinePattern:f=>({u_matrix:new o.UniformMatrix4f(f),u_world:new o.Uniform2f(f),u_image:new o.Uniform1i(f),u_texsize:new o.Uniform2f(f),u_pixel_coord_upper:new o.Uniform2f(f),u_pixel_coord_lower:new o.Uniform2f(f),u_tile_units_to_pixels:new o.Uniform1f(f)}),circle:f=>({u_camera_to_center_distance:new o.Uniform1f(f),u_extrude_scale:new o.UniformMatrix2f(f),u_device_pixel_ratio:new o.Uniform1f(f),u_matrix:new o.UniformMatrix4f(f),u_inv_rot_matrix:new o.UniformMatrix4f(f),u_merc_center:new o.Uniform2f(f),u_tile_id:new o.Uniform3f(f),u_zoom_transition:new o.Uniform1f(f),u_up_dir:new o.Uniform3f(f)}),collisionBox:f=>({u_matrix:new o.UniformMatrix4f(f),u_camera_to_center_distance:new o.Uniform1f(f),u_extrude_scale:new o.Uniform2f(f)}),collisionCircle:f=>({u_matrix:new o.UniformMatrix4f(f),u_inv_matrix:new o.UniformMatrix4f(f),u_camera_to_center_distance:new o.Uniform1f(f),u_viewport_size:new o.Uniform2f(f)}),debug:f=>({u_color:new o.UniformColor(f),u_matrix:new o.UniformMatrix4f(f),u_overlay:new o.Uniform1i(f),u_overlay_scale:new o.Uniform1f(f)}),clippingMask:f=>({u_matrix:new o.UniformMatrix4f(f)}),heatmap:f=>({u_extrude_scale:new o.Uniform1f(f),u_intensity:new o.Uniform1f(f),u_matrix:new o.UniformMatrix4f(f),u_inv_rot_matrix:new o.UniformMatrix4f(f),u_merc_center:new o.Uniform2f(f),u_tile_id:new o.Uniform3f(f),u_zoom_transition:new o.Uniform1f(f),u_up_dir:new o.Uniform3f(f)}),heatmapTexture:f=>({u_image:new o.Uniform1i(f),u_color_ramp:new o.Uniform1i(f),u_opacity:new o.Uniform1f(f)}),hillshade:f=>({u_matrix:new o.UniformMatrix4f(f),u_image:new o.Uniform1i(f),u_latrange:new o.Uniform2f(f),u_light:new o.Uniform2f(f),u_shadow:new o.UniformColor(f),u_highlight:new o.UniformColor(f),u_accent:new o.UniformColor(f)}),hillshadePrepare:f=>({u_matrix:new o.UniformMatrix4f(f),u_image:new o.Uniform1i(f),u_dimension:new o.Uniform2f(f),u_zoom:new o.Uniform1f(f),u_unpack:new o.Uniform4f(f)}),line:f=>({u_matrix:new o.UniformMatrix4f(f),u_pixels_to_tile_units:new o.UniformMatrix2f(f),u_device_pixel_ratio:new o.Uniform1f(f),u_units_to_pixels:new o.Uniform2f(f),u_dash_image:new o.Uniform1i(f),u_gradient_image:new o.Uniform1i(f),u_image_height:new o.Uniform1f(f),u_texsize:new o.Uniform2f(f),u_tile_units_to_pixels:new o.Uniform1f(f),u_alpha_discard_threshold:new o.Uniform1f(f),u_trim_offset:new o.Uniform2f(f)}),linePattern:f=>({u_matrix:new o.UniformMatrix4f(f),u_texsize:new o.Uniform2f(f),u_pixels_to_tile_units:new o.UniformMatrix2f(f),u_device_pixel_ratio:new o.Uniform1f(f),u_image:new o.Uniform1i(f),u_units_to_pixels:new o.Uniform2f(f),u_tile_units_to_pixels:new o.Uniform1f(f),u_alpha_discard_threshold:new o.Uniform1f(f)}),raster:f=>({u_matrix:new o.UniformMatrix4f(f),u_tl_parent:new o.Uniform2f(f),u_scale_parent:new o.Uniform1f(f),u_fade_t:new o.Uniform1f(f),u_opacity:new o.Uniform1f(f),u_image0:new o.Uniform1i(f),u_image1:new o.Uniform1i(f),u_brightness_low:new o.Uniform1f(f),u_brightness_high:new o.Uniform1f(f),u_saturation_factor:new o.Uniform1f(f),u_contrast_factor:new o.Uniform1f(f),u_spin_weights:new o.Uniform3f(f),u_perspective_transform:new o.Uniform2f(f)}),symbolIcon:f=>({u_is_size_zoom_constant:new o.Uniform1i(f),u_is_size_feature_constant:new o.Uniform1i(f),u_size_t:new o.Uniform1f(f),u_size:new o.Uniform1f(f),u_camera_to_center_distance:new o.Uniform1f(f),u_rotate_symbol:new o.Uniform1i(f),u_aspect_ratio:new o.Uniform1f(f),u_fade_change:new o.Uniform1f(f),u_matrix:new o.UniformMatrix4f(f),u_label_plane_matrix:new o.UniformMatrix4f(f),u_coord_matrix:new o.UniformMatrix4f(f),u_is_text:new o.Uniform1i(f),u_pitch_with_map:new o.Uniform1i(f),u_texsize:new o.Uniform2f(f),u_tile_id:new o.Uniform3f(f),u_zoom_transition:new o.Uniform1f(f),u_inv_rot_matrix:new o.UniformMatrix4f(f),u_merc_center:new o.Uniform2f(f),u_camera_forward:new o.Uniform3f(f),u_tile_matrix:new o.UniformMatrix4f(f),u_up_vector:new o.Uniform3f(f),u_ecef_origin:new o.Uniform3f(f),u_texture:new o.Uniform1i(f)}),symbolSDF:f=>({u_is_size_zoom_constant:new o.Uniform1i(f),u_is_size_feature_constant:new o.Uniform1i(f),u_size_t:new o.Uniform1f(f),u_size:new o.Uniform1f(f),u_camera_to_center_distance:new o.Uniform1f(f),u_rotate_symbol:new o.Uniform1i(f),u_aspect_ratio:new o.Uniform1f(f),u_fade_change:new o.Uniform1f(f),u_matrix:new o.UniformMatrix4f(f),u_label_plane_matrix:new o.UniformMatrix4f(f),u_coord_matrix:new o.UniformMatrix4f(f),u_is_text:new o.Uniform1i(f),u_pitch_with_map:new o.Uniform1i(f),u_texsize:new o.Uniform2f(f),u_texture:new o.Uniform1i(f),u_gamma_scale:new o.Uniform1f(f),u_device_pixel_ratio:new o.Uniform1f(f),u_tile_id:new o.Uniform3f(f),u_zoom_transition:new o.Uniform1f(f),u_inv_rot_matrix:new o.UniformMatrix4f(f),u_merc_center:new o.Uniform2f(f),u_camera_forward:new o.Uniform3f(f),u_tile_matrix:new o.UniformMatrix4f(f),u_up_vector:new o.Uniform3f(f),u_ecef_origin:new o.Uniform3f(f),u_is_halo:new o.Uniform1i(f)}),symbolTextAndIcon:f=>({u_is_size_zoom_constant:new o.Uniform1i(f),u_is_size_feature_constant:new o.Uniform1i(f),u_size_t:new o.Uniform1f(f),u_size:new o.Uniform1f(f),u_camera_to_center_distance:new o.Uniform1f(f),u_rotate_symbol:new o.Uniform1i(f),u_aspect_ratio:new o.Uniform1f(f),u_fade_change:new o.Uniform1f(f),u_matrix:new o.UniformMatrix4f(f),u_label_plane_matrix:new o.UniformMatrix4f(f),u_coord_matrix:new o.UniformMatrix4f(f),u_is_text:new o.Uniform1i(f),u_pitch_with_map:new o.Uniform1i(f),u_texsize:new o.Uniform2f(f),u_texsize_icon:new o.Uniform2f(f),u_texture:new o.Uniform1i(f),u_texture_icon:new o.Uniform1i(f),u_gamma_scale:new o.Uniform1f(f),u_device_pixel_ratio:new o.Uniform1f(f),u_is_halo:new o.Uniform1i(f)}),background:f=>({u_matrix:new o.UniformMatrix4f(f),u_opacity:new o.Uniform1f(f),u_color:new o.UniformColor(f)}),backgroundPattern:f=>({u_matrix:new o.UniformMatrix4f(f),u_opacity:new o.Uniform1f(f),u_image:new o.Uniform1i(f),u_pattern_tl:new o.Uniform2f(f),u_pattern_br:new o.Uniform2f(f),u_texsize:new o.Uniform2f(f),u_pattern_size:new o.Uniform2f(f),u_pixel_coord_upper:new o.Uniform2f(f),u_pixel_coord_lower:new o.Uniform2f(f),u_tile_units_to_pixels:new o.Uniform1f(f)}),terrainRaster:Xc,terrainDepth:Xc,skybox:f=>({u_matrix:new o.UniformMatrix4f(f),u_sun_direction:new o.Uniform3f(f),u_cubemap:new o.Uniform1i(f),u_opacity:new o.Uniform1f(f),u_temporal_offset:new o.Uniform1f(f)}),skyboxGradient:f=>({u_matrix:new o.UniformMatrix4f(f),u_color_ramp:new o.Uniform1i(f),u_center_direction:new o.Uniform3f(f),u_radius:new o.Uniform1f(f),u_opacity:new o.Uniform1f(f),u_temporal_offset:new o.Uniform1f(f)}),skyboxCapture:f=>({u_matrix_3f:new o.UniformMatrix3f(f),u_sun_direction:new o.Uniform3f(f),u_sun_intensity:new o.Uniform1f(f),u_color_tint_r:new o.Uniform4f(f),u_color_tint_m:new o.Uniform4f(f),u_luminance:new o.Uniform1f(f)}),globeRaster:f=>({u_proj_matrix:new o.UniformMatrix4f(f),u_globe_matrix:new o.UniformMatrix4f(f),u_normalize_matrix:new o.UniformMatrix4f(f),u_merc_matrix:new o.UniformMatrix4f(f),u_zoom_transition:new o.Uniform1f(f),u_merc_center:new o.Uniform2f(f),u_image0:new o.Uniform1i(f),u_grid_matrix:new o.UniformMatrix3f(f),u_skirt_height:new o.Uniform1f(f),u_frustum_tl:new o.Uniform3f(f),u_frustum_tr:new o.Uniform3f(f),u_frustum_br:new o.Uniform3f(f),u_frustum_bl:new o.Uniform3f(f),u_globe_pos:new o.Uniform3f(f),u_globe_radius:new o.Uniform1f(f),u_viewport:new o.Uniform2f(f)}),globeAtmosphere:f=>({u_frustum_tl:new o.Uniform3f(f),u_frustum_tr:new o.Uniform3f(f),u_frustum_br:new o.Uniform3f(f),u_frustum_bl:new o.Uniform3f(f),u_horizon:new o.Uniform1f(f),u_transition:new o.Uniform1f(f),u_fadeout_range:new o.Uniform1f(f),u_color:new o.Uniform4f(f),u_high_color:new o.Uniform4f(f),u_space_color:new o.Uniform4f(f),u_star_intensity:new o.Uniform1f(f),u_star_density:new o.Uniform1f(f),u_star_size:new o.Uniform1f(f),u_temporal_offset:new o.Uniform1f(f),u_horizon_angle:new o.Uniform1f(f),u_rotation_matrix:new o.UniformMatrix4f(f)})};let Hs;function rp(f,r,c,m,_,b,C){const I=f.context,M=I.gl,R=f.transform,B=f.useProgram("collisionBox"),U=[];let W=0,Q=0;for(let fe=0;fe<m.length;fe++){const Ce=m[fe],we=r.getTile(Ce),Ae=we.getBucket(c);if(!Ae)continue;const Be=_h(Ce,Ae,R);let Ne=Be;_[0]===0&&_[1]===0||(Ne=f.translatePosMatrix(Be,we,_,b));const Ge=C?Ae.textCollisionBox:Ae.iconCollisionBox,bt=Ae.collisionCircleArray;if(bt.length>0){const Fe=o.create(),rt=Ne;o.mul(Fe,Ae.placementInvProjMatrix,R.glCoordMatrix),o.mul(Fe,Fe,Ae.placementViewportMatrix),U.push({circleArray:bt,circleOffset:Q,transform:rt,invTransform:Fe,projection:Ae.getProjection()}),W+=bt.length/4,Q=W}Ge&&(f.terrain&&f.terrain.setupElevationDraw(we,B),B.draw(I,M.LINES,o.DepthMode.disabled,o.StencilMode.disabled,f.colorModeForRenderPass(),o.CullFaceMode.disabled,ep(Ne,R,we,Ae.getProjection()),c.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,null,R.zoom,null,[Ge.collisionVertexBuffer,Ge.collisionVertexBufferExt]))}if(!C||!U.length)return;const J=f.useProgram("collisionCircle"),ee=new o.StructArrayLayout2f1f2i16;ee.resize(4*W),ee._trim();let te=0;for(const fe of U)for(let Ce=0;Ce<fe.circleArray.length/4;Ce++){const we=4*Ce,Ae=fe.circleArray[we+0],Be=fe.circleArray[we+1],Ne=fe.circleArray[we+2],Ge=fe.circleArray[we+3];ee.emplace(te++,Ae,Be,Ne,Ge,0),ee.emplace(te++,Ae,Be,Ne,Ge,1),ee.emplace(te++,Ae,Be,Ne,Ge,2),ee.emplace(te++,Ae,Be,Ne,Ge,3)}(!Hs||Hs.length<2*W)&&(Hs=function(fe){const Ce=2*fe,we=new o.StructArrayLayout3ui6;we.resize(Ce),we._trim();for(let Ae=0;Ae<Ce;Ae++){const Be=6*Ae;we.uint16[Be+0]=4*Ae+0,we.uint16[Be+1]=4*Ae+1,we.uint16[Be+2]=4*Ae+2,we.uint16[Be+3]=4*Ae+2,we.uint16[Be+4]=4*Ae+3,we.uint16[Be+5]=4*Ae+0}return we}(W));const Z=I.createIndexBuffer(Hs,!0),ce=I.createVertexBuffer(ee,o.collisionCircleLayout.members,!0);for(const fe of U){const Ce={u_matrix:fe.transform,u_inv_matrix:fe.invTransform,u_camera_to_center_distance:(ae=R).getCameraToCenterDistance(fe.projection),u_viewport_size:[ae.width,ae.height]};J.draw(I,M.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,f.colorModeForRenderPass(),o.CullFaceMode.disabled,Ce,c.id,ce,Z,o.SegmentVector.simpleSegment(0,2*fe.circleOffset,fe.circleArray.length,fe.circleArray.length/2),null,R.zoom)}var ae;ce.destroy(),Z.destroy()}const Vh=o.create();function op({width:f,height:r,anchor:c,textOffset:m,textScale:_},b){const{horizontalAlign:C,verticalAlign:I}=o.getAnchorAlignment(c),M=-(C-.5)*f,R=-(I-.5)*r,B=o.evaluateVariableOffset(c,m);return new o.pointGeometry((M/_+B[0])*b,(R/_+B[1])*b)}function ka(f,r,c,m,_,b,C,I,M,R,B){const U=f.text.placedSymbolArray,W=f.text.dynamicLayoutVertexArray,Q=f.icon.dynamicLayoutVertexArray,J={},ee=f.getProjection(),te=Vc(I,ee,b),Z=b.elevation,ce=ee.upVectorScale(I.canonical,b.center.lat,b.worldSize).metersToTile;W.clear();for(let ae=0;ae<U.length;ae++){const fe=U.get(ae),{tileAnchorX:Ce,tileAnchorY:we,numGlyphs:Ae}=fe,Be=f.allowVerticalPlacement&&!fe.placedOrientation,Ne=fe.hidden||!fe.crossTileID||Be?null:m[fe.crossTileID];if(Ne){let Ge=0,bt=0,Fe=0;if(Z){const Wt=Z?Z.getAtTileOffset(I,Ce,we):0,[mn,Ut,Ft]=ee.upVector(I.canonical,Ce,we);Ge=Wt*mn*ce,bt=Wt*Ut*ce,Fe=Wt*Ft*ce}let[rt,He,ht,Ue]=Et(fe.projectedAnchorX+Ge,fe.projectedAnchorY+bt,fe.projectedAnchorZ+Fe,c?te:C);const Le=Pn(b.getCameraToCenterDistance(ee),Ue);let Ze=_.evaluateSizeForFeature(f.textSizeData,R,fe)*Le/o.ONE_EM;c&&(Ze*=f.tilePixelRatio/M);const lt=op(Ne,Ze);c?({x:rt,y:He,z:ht}=ee.projectTilePoint(Ce+lt.x,we+lt.y,I.canonical),[rt,He,ht]=Et(rt+Ge,He+bt,ht+Fe,C)):(r&&lt._rotate(-b.angle),rt+=lt.x,He+=lt.y,ht=0);const mt=f.allowVerticalPlacement&&fe.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let Wt=0;Wt<Ae;Wt++)o.addDynamicAttributes(W,rt,He,ht,mt);B&&fe.associatedIconIndex>=0&&(J[fe.associatedIconIndex]={x:rt,y:He,z:ht,angle:mt})}else si(Ae,W)}if(B){Q.clear();const ae=f.icon.placedSymbolArray;for(let fe=0;fe<ae.length;fe++){const Ce=ae.get(fe),{numGlyphs:we}=Ce,Ae=J[fe];if(Ce.hidden||!Ae)si(we,Q);else{const{x:Be,y:Ne,z:Ge,angle:bt}=Ae;for(let Fe=0;Fe<we;Fe++)o.addDynamicAttributes(Q,Be,Ne,Ge,bt)}}f.icon.dynamicLayoutVertexBuffer.updateData(Q)}f.text.dynamicLayoutVertexBuffer.updateData(W)}function Ug(f,r,c){return c.iconsInText&&r?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function sp(f,r,c,m,_,b,C,I,M,R,B,U){const W=f.context,Q=W.gl,J=f.transform,ee=I==="map",te=M==="map",Z=ee&&c.layout.get("symbol-placement")!=="point",ce=ee&&!te&&!Z,ae=c.layout.get("symbol-sort-key").constantOr(1)!==void 0;let fe=!1;const Ce=f.depthModeForSublayer(0,o.DepthMode.ReadOnly),we=[o.mercatorXfromLng(J.center.lng),o.mercatorYfromLat(J.center.lat)],Ae=c.layout.get("text-variable-anchor"),Be=J.projection.name==="globe",Ne=[],Ge=[0,-1,0];let bt=Ge;!Be&&!J.mercatorFromTransition||ee||(bt=function(Fe){const rt=Fe._camera.getWorldToCamera(Fe.worldSize,1),He=o.multiply([],rt,Fe.globeMatrix);o.invert(He,He);const ht=[0,0,0],Ue=[0,1,0,0];return o.transformMat4$1(Ue,Ue,He),ht[0]=Ue[0],ht[1]=Ue[1],ht[2]=Ue[2],o.normalize(ht,ht),ht}(J));for(const Fe of m){const rt=r.getTile(Fe),He=rt.getBucket(c);if(!He||He.projection.name==="mercator"&&Be)continue;const ht=_?He.text:He.icon;if(!ht||He.fullyClipped||!ht.segments.get().length)continue;const Ue=ht.programConfigurations.get(c.id),Le=_||He.sdfIcons,Ze=_?He.textSizeData:He.iconSizeData,lt=te||J.pitch!==0,mt=o.evaluateSizeForZoom(Ze,J.zoom);let Wt,mn,Ut,Ft,Ht=[0,0],En=null;if(_){if(mn=rt.glyphAtlasTexture,Ut=Q.LINEAR,Wt=rt.glyphAtlasTexture.size,He.iconsInText){Ht=rt.imageAtlasTexture.size,En=rt.imageAtlasTexture;const Gr=Ze.kind==="composite"||Ze.kind==="camera";Ft=lt||f.options.rotating||f.options.zooming||Gr?Q.LINEAR:Q.NEAREST}}else{const Gr=c.layout.get("icon-size").constantOr(0)!==1||He.iconsNeedLinear;mn=rt.imageAtlasTexture,Ut=Le||f.options.rotating||f.options.zooming||Gr||lt?Q.LINEAR:Q.NEAREST,Wt=rt.imageAtlasTexture.size}const Qt=He.projection.name==="globe",Zn=Qt?bt:Ge,ei=Qt?o.globeToMercatorTransition(J.zoom):0,ai=Vc(Fe,He.getProjection(),J),ii=J.calculatePixelsToTileUnitsMatrix(rt),Oi=xa(ai,rt.tileID.canonical,te,ee,J,He.getProjection(),ii),Dr=f.terrain&&te&&Z?o.invert(o.create(),Oi):Vh,ro=ba(ai,rt.tileID.canonical,te,ee,J,He.getProjection(),ii),No=Ae&&He.hasTextData(),pi=c.layout.get("icon-text-fit")!=="none"&&No&&He.hasIconData();if(Z){const Gr=J.elevation,Xr=Gr?Gr.getAtTileOffsetFunc(Fe,J.center.lat,J.worldSize,He.getProjection()):null,Uo=Nf(ai,rt.tileID.canonical,te,ee,J,He.getProjection(),ii);go(He,ai,f,_,Uo,ro,te,R,Xr,Fe)}const ri=Z||_&&Ae||pi,$n=f.translatePosMatrix(ai,rt,b,C),Ci=ri?Vh:Oi,vr=f.translatePosMatrix(ro,rt,b,C,!0),ui=He.getProjection().createInversionMatrix(J,Fe.canonical),_r=[];f.terrainRenderModeElevated()&&te&&_r.push("PITCH_WITH_MAP_TERRAIN"),Qt&&_r.push("PROJECTION_GLOBE_VIEW"),ri&&_r.push("PROJECTED_POS_ON_VIEWPORT");const yr=Le&&c.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ps;ps=Le?He.iconsInText?Oh(Ze.kind,mt,ce,te,f,$n,Ci,vr,Wt,Ht,Fe,ei,we,ui,Zn,He.getProjection()):ip(Ze.kind,mt,ce,te,f,$n,Ci,vr,_,Wt,!0,Fe,ei,we,ui,Zn,He.getProjection()):Pl(Ze.kind,mt,ce,te,f,$n,Ci,vr,_,Wt,Fe,ei,we,ui,Zn,He.getProjection());const $a={program:f.useProgram(Ug(Le,_,He),Ue,_r),buffers:ht,uniformValues:ps,atlasTexture:mn,atlasTextureIcon:En,atlasInterpolation:Ut,atlasInterpolationIcon:Ft,isSDF:Le,hasHalo:yr,tile:rt,labelPlaneMatrixInv:Dr};if(ae&&He.canOverlap){fe=!0;const Gr=ht.segments.get();for(const Xr of Gr)Ne.push({segments:new o.SegmentVector([Xr]),sortKey:Xr.sortKey,state:$a})}else Ne.push({segments:ht.segments,sortKey:0,state:$a})}fe&&Ne.sort((Fe,rt)=>Fe.sortKey-rt.sortKey);for(const Fe of Ne){const rt=Fe.state;if(f.terrain&&f.terrain.setupElevationDraw(rt.tile,rt.program,{useDepthForOcclusion:!Be,labelPlaneMatrixInv:rt.labelPlaneMatrixInv}),W.activeTexture.set(Q.TEXTURE0),rt.atlasTexture.bind(rt.atlasInterpolation,Q.CLAMP_TO_EDGE),rt.atlasTextureIcon&&(W.activeTexture.set(Q.TEXTURE1),rt.atlasTextureIcon&&rt.atlasTextureIcon.bind(rt.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),rt.isSDF){const He=rt.uniformValues;rt.hasHalo&&(He.u_is_halo=1,ap(rt.buffers,Fe.segments,c,f,rt.program,Ce,B,U,He)),He.u_is_halo=0}ap(rt.buffers,Fe.segments,c,f,rt.program,Ce,B,U,rt.uniformValues)}}function ap(f,r,c,m,_,b,C,I,M){const R=m.context,B=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.globeExtVertexBuffer];_.draw(R,R.gl.TRIANGLES,b,C,I,o.CullFaceMode.disabled,M,c.id,f.layoutVertexBuffer,f.indexBuffer,r,c.paint,m.transform.zoom,f.programConfigurations.get(c.id),B)}function lp(f,r,c,m,_,b,C){const I=f.context.gl,M=c.paint.get("fill-pattern"),R=M&&M.constantOr(1);let B,U,W,Q,J;C?(U=R&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",B=I.LINES):(U=R?"fillPattern":"fill",B=I.TRIANGLES);for(const ee of m){const te=r.getTile(ee);if(R&&!te.patternsLoaded())continue;const Z=te.getBucket(c);if(!Z)continue;f.prepareDrawTile();const ce=Z.programConfigurations.get(c.id),ae=f.useProgram(U,ce);R&&(f.context.activeTexture.set(I.TEXTURE0),te.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ce.updatePaintBuffers());const fe=M.constantOr(null);if(fe&&te.imageAtlas){const we=te.imageAtlas.patternPositions[fe.toString()];we&&ce.setConstantPatternPositions(we)}const Ce=f.translatePosMatrix(ee.projMatrix,te,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(C){Q=Z.indexBuffer2,J=Z.segments2;const we=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];W=U==="fillOutlinePattern"&&R?Qf(Ce,f,te,we):Jf(Ce,we)}else Q=Z.indexBuffer,J=Z.segments,W=R?eu(Ce,f,te):Qc(Ce);f.prepareDrawProgram(f.context,ae,ee.toUnwrapped()),ae.draw(f.context,B,_,f.stencilModeForClipping(ee),b,o.CullFaceMode.disabled,W,c.id,Z.layoutVertexBuffer,Q,J,c.paint,f.transform.zoom,ce)}}function $h(f,r,c,m,_,b,C){const I=f.context,M=I.gl,R=f.transform,B=c.paint.get("fill-extrusion-pattern"),U=B.constantOr(1),W=c.paint.get("fill-extrusion-opacity"),Q=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),c.paint.get("fill-extrusion-ambient-occlusion-radius")],J=c.layout.get("fill-extrusion-edge-radius"),ee=R.projection.name==="globe"?o.fillExtrusionHeightLift():0,te=R.projection.name==="globe",Z=te?o.globeToMercatorTransition(R.zoom):0,ce=[o.mercatorXfromLng(R.center.lng),o.mercatorYfromLat(R.center.lat)],ae=[];te&&ae.push("PROJECTION_GLOBE_VIEW"),Q[0]>0&&ae.push("FAUX_AO");for(const fe of m){const Ce=r.getTile(fe),we=Ce.getBucket(c);if(!we||we.projection.name!==R.projection.name)continue;const Ae=we.programConfigurations.get(c.id),Be=f.useProgram(U?"fillExtrusionPattern":"fillExtrusion",Ae,ae);if(f.terrain){const ht=f.terrain;if(f.style.terrainSetForDrapingOnly())ht.setupElevationDraw(Ce,Be,{useMeterToDem:!0});else{if(!we.enableTerrain)continue;if(ht.setupElevationDraw(Ce,Be,{useMeterToDem:!0}),jg(I,r,fe,we,c,ht),!we.centroidVertexBuffer){const Ue=Be.attributes.a_centroid_pos;Ue!==void 0&&M.vertexAttrib2f(Ue,0,0)}}}U&&(f.context.activeTexture.set(M.TEXTURE0),Ce.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),Ae.updatePaintBuffers());const Ne=B.constantOr(null);if(Ne&&Ce.imageAtlas){const ht=Ce.imageAtlas.patternPositions[Ne.toString()];ht&&Ae.setConstantPatternPositions(ht)}const Ge=f.translatePosMatrix(fe.projMatrix,Ce,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),bt=R.projection.createInversionMatrix(R,fe.canonical),Fe=c.paint.get("fill-extrusion-vertical-gradient"),rt=U?zh(Ge,f,Fe,W,Q,J,fe,Ce,ee,Z,ce,bt):Jc(Ge,f,Fe,W,Q,J,fe,ee,Z,ce,bt);f.prepareDrawProgram(I,Be,fe.toUnwrapped());const He=[];f.terrain&&He.push(we.centroidVertexBuffer),te&&He.push(we.layoutVertexExtBuffer),Be.draw(I,I.gl.TRIANGLES,_,b,C,o.CullFaceMode.backCCW,rt,c.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,c.paint,f.transform.zoom,Ae,He)}}function jg(f,r,c,m,_,b){const C=[Z=>{let ce=Z.canonical.x-1,ae=Z.wrap;return ce<0&&(ce=(1<<Z.canonical.z)-1,ae--),new o.OverscaledTileID(Z.overscaledZ,ae,Z.canonical.z,ce,Z.canonical.y)},Z=>{let ce=Z.canonical.x+1,ae=Z.wrap;return ce===1<<Z.canonical.z&&(ce=0,ae++),new o.OverscaledTileID(Z.overscaledZ,ae,Z.canonical.z,ce,Z.canonical.y)},Z=>new o.OverscaledTileID(Z.overscaledZ,Z.wrap,Z.canonical.z,Z.canonical.x,(Z.canonical.y===0?1<<Z.canonical.z:Z.canonical.y)-1),Z=>new o.OverscaledTileID(Z.overscaledZ,Z.wrap,Z.canonical.z,Z.canonical.x,Z.canonical.y===(1<<Z.canonical.z)-1?0:Z.canonical.y+1)],I=Z=>{const ce=r.getSource().minzoom,ae=Ce=>{const we=r.getTileByID(Ce);if(we&&we.hasData())return we.getBucket(_)},fe=[0,-1,1];for(const Ce of fe){if(Z.overscaledZ+Ce<ce)continue;const we=ae(Z.calculateScaledKey(Z.overscaledZ+Ce));if(we)return we}},M=[0,0,0],R=(Z,ce)=>(M[0]=Math.min(Z.min.y,ce.min.y),M[1]=Math.max(Z.max.y,ce.max.y),M[2]=o.EXTENT-ce.min.x>Z.max.x?ce.min.x-o.EXTENT:Z.max.x,M),B=(Z,ce)=>(M[0]=Math.min(Z.min.x,ce.min.x),M[1]=Math.max(Z.max.x,ce.max.x),M[2]=o.EXTENT-ce.min.y>Z.max.y?ce.min.y-o.EXTENT:Z.max.y,M),U=[(Z,ce)=>R(Z,ce),(Z,ce)=>R(ce,Z),(Z,ce)=>B(Z,ce),(Z,ce)=>B(ce,Z)],W=new o.pointGeometry(0,0);let Q,J,ee;const te=(Z,ce,ae,fe,Ce)=>{const we=[[fe?ae:Z,fe?Z:ae,0],[fe?ae:ce,fe?ce:ae,0]],Ae=Ce<0?o.EXTENT+Ce:Ce,Be=[fe?Ae:(Z+ce)/2,fe?(Z+ce)/2:Ae,0];return ae===0&&Ce<0||ae!==0&&Ce>0?b.getForTilePoints(ee,[Be],!0,J):we.push(Be),b.getForTilePoints(c,we,!0,Q),Math.max(we[0][2],we[1][2],Be[2])/b.exaggeration()};for(let Z=0;Z<4;Z++){const ce=(Z<2?1:5)-Z,ae=m.borders[Z];if(ae.length===0)continue;const fe=ee=C[Z](c),Ce=I(fe);if(!(Ce&&Ce instanceof o.FillExtrusionBucket&&Ce.enableTerrain)||m.borderDoneWithNeighborZ[Z]===Ce.canonical.z&&Ce.borderDoneWithNeighborZ[ce]===m.canonical.z||(J=b.findDEMTileFor(fe),!J||!J.dem))continue;if(!Q){const Ne=b.findDEMTileFor(c);if(!Ne||!Ne.dem)return;Q=Ne}const we=Ce.borders[ce];let Ae=0;const Be=Ce.borderDoneWithNeighborZ[ce]!==m.canonical.z;if(m.canonical.z===Ce.canonical.z){for(let Ne=0;Ne<ae.length;Ne++){const Ge=m.featuresOnBorder[ae[Ne]],bt=Ge.borders[Z];let Fe;for(;Ae<we.length&&(Fe=Ce.featuresOnBorder[we[Ae]],!(Fe.borders[ce][1]>bt[0]+3));)Be&&Ce.encodeCentroid(void 0,Fe,!1),Ae++;if(Fe&&Ae<we.length){const rt=Ae;let He=0;for(;!(Fe.borders[ce][0]>bt[1]-3)&&(He++,++Ae!==we.length);)Fe=Ce.featuresOnBorder[we[Ae]];if(Fe=Ce.featuresOnBorder[we[rt]],Ge.intersectsCount()>1||Fe.intersectsCount()>1||He!==1){He!==1&&(Ae=rt),m.encodeCentroid(void 0,Ge,!1),Be&&Ce.encodeCentroid(void 0,Fe,!1);continue}const ht=U[Z](Ge,Fe),Ue=Z%2?o.EXTENT-1:0;W.x=te(ht[0],Math.min(o.EXTENT-1,ht[1]),Ue,Z<2,ht[2]),W.y=0,m.encodeCentroid(W,Ge,!1),Be&&Ce.encodeCentroid(W,Fe,!1)}else m.encodeCentroid(void 0,Ge,!1)}m.borderDoneWithNeighborZ[Z]=Ce.canonical.z,m.needsCentroidUpdate=!0,Be&&(Ce.borderDoneWithNeighborZ[ce]=m.canonical.z,Ce.needsCentroidUpdate=!0)}else{for(const Ne of ae)m.encodeCentroid(void 0,m.featuresOnBorder[Ne],!1);if(Be){for(const Ne of we)Ce.encodeCentroid(void 0,Ce.featuresOnBorder[Ne],!1);Ce.borderDoneWithNeighborZ[ce]=m.canonical.z,Ce.needsCentroidUpdate=!0}m.borderDoneWithNeighborZ[Z]=Ce.canonical.z,m.needsCentroidUpdate=!0}}(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(f)}const Nh=new o.Color(1,0,0,1),Uh=new o.Color(0,1,0,1),cp=new o.Color(0,0,1,1),up=new o.Color(1,0,1,1),hp=new o.Color(0,1,1,1);function jh(f,r,c){const m=f.context,_=f.transform,b=m.gl,C=_.projection.name==="globe",I=C?["PROJECTION_GLOBE_VIEW"]:null;let M=c.projMatrix;if(C&&o.globeToMercatorTransition(_.zoom)>0){const Ge=o.transitionTileAABBinECEF(c.canonical,_),bt=o.globeDenormalizeECEF(Ge);M=o.multiply(new Float32Array(16),_.globeMatrix,bt),o.multiply(M,_.projMatrix,M)}const R=f.useProgram("debug",null,I),B=r.getTileByID(c.key);f.terrain&&f.terrain.setupElevationDraw(B,R);const U=o.DepthMode.disabled,W=o.StencilMode.disabled,Q=f.colorModeForRenderPass(),J="$debug";m.activeTexture.set(b.TEXTURE0),f.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),C?B._makeGlobeTileDebugBuffers(f.context,_):B._makeDebugTileBoundsBuffers(f.context,_.projection);const ee=B._tileDebugBuffer||f.debugBuffer,te=B._tileDebugIndexBuffer||f.debugIndexBuffer,Z=B._tileDebugSegments||f.debugSegments;R.draw(m,b.LINE_STRIP,U,W,Q,o.CullFaceMode.disabled,Ml(M,o.Color.red),J,ee,te,Z,null,null,null,[B._globeTileDebugBorderBuffer]);const ce=B.latestRawTileData,ae=Math.floor((ce&&ce.byteLength||0)/1024),fe=r.getTile(c).tileSize,Ce=512/Math.min(fe,512)*(c.overscaledZ/_.zoom)*.5;let we=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(we+=` => ${c.overscaledZ}`),we+=` ${ae}kb`,function(Ge,bt){Ge.initDebugOverlayCanvas();const Fe=Ge.debugOverlayCanvas,rt=Ge.context.gl,He=Ge.debugOverlayCanvas.getContext("2d");He.clearRect(0,0,Fe.width,Fe.height),He.shadowColor="white",He.shadowBlur=2,He.lineWidth=1.5,He.strokeStyle="white",He.textBaseline="top",He.font="bold 36px Open Sans, sans-serif",He.fillText(bt,5,5),He.strokeText(bt,5,5),Ge.debugOverlayTexture.update(Fe),Ge.debugOverlayTexture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE)}(f,we);const Ae=B._tileDebugTextBuffer||f.debugBuffer,Be=B._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,Ne=B._tileDebugTextSegments||f.debugSegments;R.draw(m,b.TRIANGLES,U,W,o.ColorMode.alphaBlended,o.CullFaceMode.disabled,Ml(M,o.Color.transparent,Ce),J,Ae,Be,Ne,null,null,null,[B._globeTileDebugTextBuffer])}function fs(f,r,c,m){zl(f,0,r+c/2,f.transform.width,c,m)}function Ma(f,r,c,m){zl(f,r-c/2,0,c,f.transform.height,m)}function zl(f,r,c,m,_,b){const C=f.context,I=C.gl;I.enable(I.SCISSOR_TEST),I.scissor(r*o.exported.devicePixelRatio,c*o.exported.devicePixelRatio,m*o.exported.devicePixelRatio,_*o.exported.devicePixelRatio),C.clear({color:b}),I.disable(I.SCISSOR_TEST)}const Pa=o.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:za}=Pa;function Vo(f,r,c,m){f.emplaceBack(r,c,m)}class iu{constructor(r){this.vertexArray=new o.StructArrayLayout3f12,this.indices=new o.StructArrayLayout3ui6,Vo(this.vertexArray,-1,-1,1),Vo(this.vertexArray,1,-1,1),Vo(this.vertexArray,-1,1,1),Vo(this.vertexArray,1,1,1),Vo(this.vertexArray,-1,-1,-1),Vo(this.vertexArray,1,-1,-1),Vo(this.vertexArray,-1,1,-1),Vo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,za),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=o.SegmentVector.simpleSegment(0,0,36,12)}}function Rn(f,r,c,m,_,b){const C=f.gl,I=r.paint.get("sky-atmosphere-color"),M=r.paint.get("sky-atmosphere-halo-color"),R=r.paint.get("sky-atmosphere-sun-intensity"),B=((U,W,Q,J,ee)=>({u_matrix_3f:U,u_sun_direction:W,u_sun_intensity:Q,u_color_tint_r:[J.r,J.g,J.b,J.a],u_color_tint_m:[ee.r,ee.g,ee.b,ee.a],u_luminance:5e-5}))(o.fromMat4(o.create$1(),m),_,R,I,M);C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+b,r.skyboxTexture,0),c.draw(f,C.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.frontCW,B,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const ru=o.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Gg{constructor(r){const c=new o.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const m=new o.StructArrayLayout3ui6;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(c,ru.members),this.indexBuffer=r.createIndexBuffer(m),this.segments=o.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Gh={symbol:function(f,r,c,m,_){if(f.renderPass!=="translucent")return;const b=o.StencilMode.disabled,C=f.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(I,M,R,B,U,W,Q){const J=M.transform,ee=U==="map",te=W==="map";for(const Z of I){const ce=B.getTile(Z),ae=ce.getBucket(R);if(!ae||!ae.text||!ae.text.segments.get().length)continue;const fe=o.evaluateSizeForZoom(ae.textSizeData,J.zoom),Ce=Vc(Z,ae.getProjection(),J),we=J.calculatePixelsToTileUnitsMatrix(ce),Ae=xa(Ce,ce.tileID.canonical,te,ee,J,ae.getProjection(),we),Be=R.layout.get("icon-text-fit")!=="none"&&ae.hasIconData();if(fe){const Ne=Math.pow(2,J.zoom-ce.tileID.overscaledZ);ka(ae,ee,te,Q,o.symbolSize,J,Ae,Z,Ne,fe,Be)}}}(m,f,c,r,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),_),c.paint.get("icon-opacity").constantOr(1)!==0&&sp(f,r,c,m,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),b,C),c.paint.get("text-opacity").constantOr(1)!==0&&sp(f,r,c,m,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),b,C),r.map.showCollisionBoxes&&(rp(f,r,c,m,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),rp(f,r,c,m,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(f,r,c,m){if(f.renderPass!=="translucent")return;const _=c.paint.get("circle-opacity"),b=c.paint.get("circle-stroke-width"),C=c.paint.get("circle-stroke-opacity"),I=c.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)===0&&(b.constantOr(1)===0||C.constantOr(1)===0))return;const M=f.context,R=M.gl,B=f.transform,U=f.depthModeForSublayer(0,o.DepthMode.ReadOnly),W=o.StencilMode.disabled,Q=f.colorModeForRenderPass(),J=B.projection.name==="globe",ee=[o.mercatorXfromLng(B.center.lng),o.mercatorYfromLat(B.center.lat)],te=[];for(let ce=0;ce<m.length;ce++){const ae=m[ce],fe=r.getTile(ae),Ce=fe.getBucket(c);if(!Ce||Ce.projection.name!==B.projection.name)continue;const we=Ce.programConfigurations.get(c.id),Ae=kl(c);J&&Ae.push("PROJECTION_GLOBE_VIEW");const Be=f.useProgram("circle",we,Ae),Ne=Ce.layoutVertexBuffer,Ge=Ce.globeExtVertexBuffer,bt=Ce.indexBuffer,Fe=B.projection.createInversionMatrix(B,ae.canonical),rt={programConfiguration:we,program:Be,layoutVertexBuffer:Ne,globeExtVertexBuffer:Ge,indexBuffer:bt,uniformValues:Al(f,ae,fe,Fe,ee,c),tile:fe};if(I){const He=Ce.segments.get();for(const ht of He)te.push({segments:new o.SegmentVector([ht]),sortKey:ht.sortKey,state:rt})}else te.push({segments:Ce.segments,sortKey:0,state:rt})}I&&te.sort((ce,ae)=>ce.sortKey-ae.sortKey);const Z={useDepthForOcclusion:!J};for(const ce of te){const{programConfiguration:ae,program:fe,layoutVertexBuffer:Ce,globeExtVertexBuffer:we,indexBuffer:Ae,uniformValues:Be,tile:Ne}=ce.state,Ge=ce.segments;f.terrain&&f.terrain.setupElevationDraw(Ne,fe,Z),f.prepareDrawProgram(M,fe,Ne.tileID.toUnwrapped()),fe.draw(M,R.TRIANGLES,U,W,Q,o.CullFaceMode.disabled,Be,c.id,Ce,Ae,Ge,c.paint,B.zoom,ae,[we])}},heatmap:function(f,r,c,m){if(c.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const _=f.context,b=_.gl,C=o.StencilMode.disabled,I=new o.ColorMode([b.ONE,b.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(Q,J,ee,te){const Z=Q.gl,ce=J.width*te,ae=J.height*te;Q.activeTexture.set(Z.TEXTURE1),Q.viewport.set([0,0,ce,ae]);let fe=ee.heatmapFbo;if(!fe||fe&&(fe.width!==ce||fe.height!==ae)){fe&&fe.destroy();const Ce=Z.createTexture();Z.bindTexture(Z.TEXTURE_2D,Ce),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_S,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_T,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MAG_FILTER,Z.LINEAR),fe=ee.heatmapFbo=Q.createFramebuffer(ce,ae,!1),function(we,Ae,Be,Ne,Ge,bt){const Fe=we.gl;Fe.texImage2D(Fe.TEXTURE_2D,0,we.isWebGL2&&we.extRenderToTextureHalfFloat?Fe.RGBA16F:Fe.RGBA,Ge,bt,0,Fe.RGBA,we.extRenderToTextureHalfFloat?we.isWebGL2?Fe.HALF_FLOAT:we.extTextureHalfFloat.HALF_FLOAT_OES:Fe.UNSIGNED_BYTE,null),Ne.colorAttachment.set(Be)}(Q,0,Ce,fe,ce,ae)}else Z.bindTexture(Z.TEXTURE_2D,fe.colorAttachment.get()),Q.bindFramebuffer.set(fe.framebuffer)})(_,f,c,f.transform.projection.name==="globe"?.5:.25),_.clear({color:o.Color.transparent});const M=f.transform,R=M.projection.name==="globe",B=R?["PROJECTION_GLOBE_VIEW"]:null,U=R?o.CullFaceMode.frontCCW:o.CullFaceMode.disabled,W=[o.mercatorXfromLng(M.center.lng),o.mercatorYfromLat(M.center.lat)];for(let Q=0;Q<m.length;Q++){const J=m[Q];if(r.hasRenderableParent(J))continue;const ee=r.getTile(J),te=ee.getBucket(c);if(!te||te.projection.name!==M.projection.name)continue;const Z=te.programConfigurations.get(c.id),ce=f.useProgram("heatmap",Z,B),{zoom:ae}=f.transform;f.terrain&&f.terrain.setupElevationDraw(ee,ce),f.prepareDrawProgram(_,ce,J.toUnwrapped());const fe=M.projection.createInversionMatrix(M,J.canonical);ce.draw(_,b.TRIANGLES,o.DepthMode.disabled,C,I,U,vo(f,J,ee,fe,W,ae,c.paint.get("heatmap-intensity")),c.id,te.layoutVertexBuffer,te.indexBuffer,te.segments,c.paint,f.transform.zoom,Z,R?[te.globeExtVertexBuffer]:null)}_.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(_,b){const C=_.context,I=C.gl,M=b.heatmapFbo;if(!M)return;C.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,M.colorAttachment.get()),C.activeTexture.set(I.TEXTURE1);let R=b.colorRampTexture;R||(R=b.colorRampTexture=new o.Texture(C,b.colorRamp,I.RGBA)),R.bind(I.LINEAR,I.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(C,I.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,_.colorModeForRenderPass(),o.CullFaceMode.disabled,((B,U,W,Q)=>({u_image:0,u_color_ramp:1,u_opacity:U.paint.get("heatmap-opacity")}))(0,b),b.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,b.paint,_.transform.zoom)}(f,c))},line:function(f,r,c,m){if(f.renderPass!=="translucent")return;const _=c.paint.get("line-opacity"),b=c.paint.get("line-width");if(_.constantOr(1)===0||b.constantOr(1)===0)return;const C=f.depthModeForSublayer(0,o.DepthMode.ReadOnly),I=f.colorModeForRenderPass(),M=f.terrain&&f.terrain.renderingToTexture?1:o.exported.devicePixelRatio,R=c.paint.get("line-dasharray"),B=R.constantOr(1),U=c.layout.get("line-cap"),W=c.paint.get("line-pattern"),Q=W.constantOr(1),J=c.paint.get("line-gradient"),ee=Q?"linePattern":"line",te=f.context,Z=te.gl,ce=(fe=>{const Ce=[];nu(fe)&&Ce.push("RENDER_LINE_DASH"),fe.paint.get("line-gradient")&&Ce.push("RENDER_LINE_GRADIENT");const we=fe.paint.get("line-trim-offset");we[0]===0&&we[1]===0||Ce.push("RENDER_LINE_TRIM_OFFSET");const Ae=fe.paint.get("line-pattern").constantOr(1),Be=fe.paint.get("line-opacity").constantOr(1)!==1;return!Ae&&Be&&Ce.push("RENDER_LINE_ALPHA_DISCARD"),Ce})(c);let ae=ce.includes("RENDER_LINE_ALPHA_DISCARD");f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(ae=!1);for(const fe of m){const Ce=r.getTile(fe);if(Q&&!Ce.patternsLoaded())continue;const we=Ce.getBucket(c);if(!we)continue;f.prepareDrawTile();const Ae=we.programConfigurations.get(c.id),Be=f.useProgram(ee,Ae,ce),Ne=W.constantOr(null);if(Ne&&Ce.imageAtlas){const Le=Ce.imageAtlas.patternPositions[Ne.toString()];Le&&Ae.setConstantPatternPositions(Le)}const Ge=R.constantOr(null),bt=U.constantOr(null);if(!Q&&Ge&&bt&&Ce.lineAtlas){const Le=Ce.lineAtlas.getDash(Ge,bt);Le&&Ae.setConstantPatternPositions(Le)}let[Fe,rt]=c.paint.get("line-trim-offset");(bt==="round"||bt==="square")&&Fe!==rt&&(Fe===0&&(Fe-=1),rt===1&&(rt+=1));const He=f.terrain?fe.projMatrix:null,ht=Q?tp(f,Ce,c,He,M):Dh(f,Ce,c,He,we.lineClipsArray.length,M,[Fe,rt]);if(J){const Le=we.gradients[c.id];let Ze=Le.texture;if(c.gradientVersion!==Le.version){let lt=256;if(c.stepInterpolant){const mt=r.getSource().maxzoom,Wt=fe.canonical.z===mt?Math.ceil(1<<f.transform.maxZoom-fe.canonical.z):1;lt=o.clamp(o.nextPowerOfTwo(we.maxLineLength/o.EXTENT*1024*Wt),256,te.maxTextureSize)}Le.gradient=o.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:lt,image:Le.gradient||void 0,clips:we.lineClipsArray}),Le.texture?Le.texture.update(Le.gradient):Le.texture=new o.Texture(te,Le.gradient,Z.RGBA),Le.version=c.gradientVersion,Ze=Le.texture}te.activeTexture.set(Z.TEXTURE1),Ze.bind(c.stepInterpolant?Z.NEAREST:Z.LINEAR,Z.CLAMP_TO_EDGE)}B&&(te.activeTexture.set(Z.TEXTURE0),Ce.lineAtlasTexture.bind(Z.LINEAR,Z.REPEAT),Ae.updatePaintBuffers()),Q&&(te.activeTexture.set(Z.TEXTURE0),Ce.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Ae.updatePaintBuffers()),f.prepareDrawProgram(te,Be,fe.toUnwrapped());const Ue=Le=>{Be.draw(te,Z.TRIANGLES,C,Le,I,o.CullFaceMode.disabled,ht,c.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,c.paint,f.transform.zoom,Ae,[we.layoutVertexBuffer2])};if(ae){const Le=f.stencilModeForClipping(fe).ref;Le===0&&f.terrain&&te.clear({stencil:0});const Ze={func:Z.EQUAL,mask:255};ht.u_alpha_discard_threshold=.8,Ue(new o.StencilMode(Ze,Le,255,Z.KEEP,Z.KEEP,Z.INVERT)),ht.u_alpha_discard_threshold=0,Ue(new o.StencilMode(Ze,Le,255,Z.KEEP,Z.KEEP,Z.KEEP))}else Ue(f.stencilModeForClipping(fe))}ae&&(f.resetStencilClippingMasks(),f.terrain&&te.clear({stencil:0}))},fill:function(f,r,c,m){const _=c.paint.get("fill-color"),b=c.paint.get("fill-opacity");if(b.constantOr(1)===0)return;const C=f.colorModeForRenderPass(),I=c.paint.get("fill-pattern"),M=f.opaquePassEnabledForLayer()&&!I.constantOr(1)&&_.constantOr(o.Color.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===M){const R=f.depthModeForSublayer(1,f.renderPass==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly);lp(f,r,c,m,R,C,!1)}if(f.renderPass==="translucent"&&c.paint.get("fill-antialias")){const R=f.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,o.DepthMode.ReadOnly);lp(f,r,c,m,R,C,!0)}},"fill-extrusion":function(f,r,c,m){const _=c.paint.get("fill-extrusion-opacity");if(_!==0&&f.renderPass==="translucent"){const b=new o.DepthMode(f.context.gl.LEQUAL,o.DepthMode.ReadWrite,f.depthRangeFor3D);if(_!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))$h(f,r,c,m,b,o.StencilMode.disabled,o.ColorMode.disabled),$h(f,r,c,m,b,f.stencilModeFor3D(),f.colorModeForRenderPass()),f.resetStencilClippingMasks();else{const C=f.colorModeForRenderPass();$h(f,r,c,m,b,o.StencilMode.disabled,C)}}},hillshade:function(f,r,c,m){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent")return;const _=f.context,b=f.depthModeForSublayer(0,o.DepthMode.ReadOnly),C=f.colorModeForRenderPass(),I=f.terrain&&f.terrain.renderingToTexture,[M,R]=f.renderPass!=="translucent"||I?[{},m]:f.stencilConfigForOverlap(m);for(const B of R){const U=r.getTile(B);if(U.needsHillshadePrepare&&f.renderPass==="offscreen")Hc(f,U,c,b,o.StencilMode.disabled,C);else if(f.renderPass==="translucent"){const W=I&&f.terrain?f.terrain.stencilModeForRTTOverlap(B):M[B.overscaledZ];El(f,B,U,c,b,W,C)}}_.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,r,c,m,_,b){if(f.renderPass!=="translucent"||c.paint.get("raster-opacity")===0||!m.length)return;const C=f.context,I=C.gl,M=r.getSource(),R=f.useProgram("raster"),B=f.colorModeForRenderPass(),U=f.terrain&&f.terrain.renderingToTexture,[W,Q]=M instanceof Ie||U?[{},m]:f.stencilConfigForOverlap(m),J=Q[Q.length-1].overscaledZ,ee=!f.options.moving;for(const te of Q){const Z=U?o.DepthMode.disabled:f.depthModeForSublayer(te.overscaledZ-J,c.paint.get("raster-opacity")===1?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly,I.LESS),ce=te.toUnwrapped(),ae=r.getTile(te);if(U&&(!ae||!ae.hasData()))continue;const fe=U?te.projMatrix:f.transform.calculateProjMatrix(ce,ee),Ce=f.terrain&&U?f.terrain.stencilModeForRTTOverlap(te):W[te.overscaledZ],we=b?0:c.paint.get("raster-fade-duration");ae.registerFadeDuration(we);const Ae=r.findLoadedParent(te,0),Be=Il(ae,Ae,r,f.transform,we);let Ne,Ge;f.terrain&&f.terrain.prepareDrawTile();const bt=c.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;C.activeTexture.set(I.TEXTURE0),ae.texture.bind(bt,I.CLAMP_TO_EDGE),C.activeTexture.set(I.TEXTURE1),Ae?(Ae.texture.bind(bt,I.CLAMP_TO_EDGE),Ne=Math.pow(2,Ae.tileID.overscaledZ-ae.tileID.overscaledZ),Ge=[ae.tileID.canonical.x*Ne%1,ae.tileID.canonical.y*Ne%1]):ae.texture.bind(bt,I.CLAMP_TO_EDGE);const Fe=Vg(fe,Ge||[0,0],Ne||1,Be,c,M instanceof Ie?M.perspectiveTransform:[0,0]);if(f.prepareDrawProgram(C,R,ce),M instanceof Ie)M.boundsBuffer&&M.boundsSegments&&R.draw(C,I.TRIANGLES,Z,o.StencilMode.disabled,B,o.CullFaceMode.disabled,Fe,c.id,M.boundsBuffer,f.quadTriangleIndexBuffer,M.boundsSegments);else{const{tileBoundsBuffer:rt,tileBoundsIndexBuffer:He,tileBoundsSegments:ht}=f.getTileBoundsBuffers(ae);R.draw(C,I.TRIANGLES,Z,Ce,B,o.CullFaceMode.disabled,Fe,c.id,rt,He,ht)}}f.resetStencilClippingMasks()},background:function(f,r,c,m){const _=c.paint.get("background-color"),b=c.paint.get("background-opacity");if(b===0)return;const C=f.context,I=C.gl,M=f.transform,R=M.tileSize,B=c.paint.get("background-pattern");if(f.isPatternMissing(B))return;const U=!B&&_.a===1&&b===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==U)return;const W=o.StencilMode.disabled,Q=f.depthModeForSublayer(0,U==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly),J=f.colorModeForRenderPass(),ee=f.useProgram(B?"backgroundPattern":"background");let te,Z=m;Z||(te=f.getBackgroundTiles(),Z=Object.values(te).map(ce=>ce.tileID)),B&&(C.activeTexture.set(I.TEXTURE0),f.imageManager.bind(f.context));for(const ce of Z){const ae=ce.toUnwrapped(),fe=m?ce.projMatrix:f.transform.calculateProjMatrix(ae);f.prepareDrawTile();const Ce=r?r.getTile(ce):te?te[ce.key]:new o.Tile(ce,R,M.zoom,f),we=B?Fh(fe,b,f,B,{tileID:ce,tileSize:R}):$g(fe,b,_);f.prepareDrawProgram(C,ee,ae);const{tileBoundsBuffer:Ae,tileBoundsIndexBuffer:Be,tileBoundsSegments:Ne}=f.getTileBoundsBuffers(Ce);ee.draw(C,I.TRIANGLES,Q,W,J,o.CullFaceMode.disabled,we,c.id,Ae,Be,Ne)}},sky:function(f,r,c){const m=f.transform,_=m.projection.name==="mercator"||m.projection.name==="globe"?1:o.smoothstep(7,8,m.zoom),b=c.paint.get("sky-opacity")*_;if(b===0)return;const C=f.context,I=c.paint.get("sky-type"),M=new o.DepthMode(C.gl.LEQUAL,o.DepthMode.ReadOnly,[0,1]),R=f.frameCounter/1e3%1;I==="atmosphere"?f.renderPass==="offscreen"?c.needsSkyboxCapture(f)&&(function(B,U,W,Q){const J=B.context,ee=J.gl;let te=U.skyboxFbo;if(!te){te=U.skyboxFbo=J.createFramebuffer(32,32,!1),U.skyboxGeometry=new iu(J),U.skyboxTexture=J.gl.createTexture(),ee.bindTexture(ee.TEXTURE_CUBE_MAP,U.skyboxTexture),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MAG_FILTER,ee.LINEAR);for(let fe=0;fe<6;++fe)ee.texImage2D(ee.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,ee.RGBA,32,32,0,ee.RGBA,ee.UNSIGNED_BYTE,null)}J.bindFramebuffer.set(te.framebuffer),J.viewport.set([0,0,32,32]);const Z=U.getCenter(B,!0),ce=B.useProgram("skyboxCapture"),ae=new Float64Array(16);o.identity(ae),o.rotateY(ae,ae,.5*-Math.PI),Rn(J,U,ce,ae,Z,0),o.identity(ae),o.rotateY(ae,ae,.5*Math.PI),Rn(J,U,ce,ae,Z,1),o.identity(ae),o.rotateX(ae,ae,.5*-Math.PI),Rn(J,U,ce,ae,Z,2),o.identity(ae),o.rotateX(ae,ae,.5*Math.PI),Rn(J,U,ce,ae,Z,3),o.identity(ae),Rn(J,U,ce,ae,Z,4),o.identity(ae),o.rotateY(ae,ae,Math.PI),Rn(J,U,ce,ae,Z,5),J.viewport.set([0,0,B.width,B.height])}(f,c),c.markSkyboxValid(f)):f.renderPass==="sky"&&function(B,U,W,Q,J){const ee=B.context,te=ee.gl,Z=B.transform,ce=B.useProgram("skybox");ee.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_CUBE_MAP,U.skyboxTexture);const ae=((fe,Ce,we,Ae,Be)=>({u_matrix:fe,u_sun_direction:Ce,u_cubemap:0,u_opacity:Ae,u_temporal_offset:Be}))(Z.skyboxMatrix,U.getCenter(B,!1),0,Q,J);B.prepareDrawProgram(ee,ce),ce.draw(ee,te.TRIANGLES,W,o.StencilMode.disabled,B.colorModeForRenderPass(),o.CullFaceMode.backCW,ae,"skybox",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)}(f,c,M,b,R):I==="gradient"&&f.renderPass==="sky"&&function(B,U,W,Q,J){const ee=B.context,te=ee.gl,Z=B.transform,ce=B.useProgram("skyboxGradient");U.skyboxGeometry||(U.skyboxGeometry=new iu(ee)),ee.activeTexture.set(te.TEXTURE0);let ae=U.colorRampTexture;ae||(ae=U.colorRampTexture=new o.Texture(ee,U.colorRamp,te.RGBA)),ae.bind(te.LINEAR,te.CLAMP_TO_EDGE);const fe=((Ce,we,Ae,Be,Ne)=>({u_matrix:Ce,u_color_ramp:0,u_center_direction:we,u_radius:o.degToRad(Ae),u_opacity:Be,u_temporal_offset:Ne}))(Z.skyboxMatrix,U.getCenter(B,!1),U.paint.get("sky-gradient-radius"),Q,J);B.prepareDrawProgram(ee,ce),ce.draw(ee,te.TRIANGLES,W,o.StencilMode.disabled,B.colorModeForRenderPass(),o.CullFaceMode.backCW,fe,"skyboxGradient",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)}(f,c,M,b,R)},debug:function(f,r,c){for(let m=0;m<c.length;m++)jh(f,r,c[m])},custom:function(f,r,c,m){const _=f.context,b=c.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&c.isLayerDraped()){if(f.renderPass==="offscreen"){const C=b.prerender;if(C){if(f.setCustomLayerDefaults(),_.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const I=f.transform.pointMerc;C.call(b,_.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(f.transform.zoom),[I.x,I.y],f.transform.pixelsPerMeterRatio)}else C.call(b,_.gl,f.transform.customLayerMatrix());_.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const I=b.renderToTile;if(I){const M=m[0].canonical,R=new o.MercatorCoordinate(M.x+m[0].wrap*(1<<M.z),M.y,M.z);_.setDepthMode(o.DepthMode.disabled),_.setStencilMode(o.StencilMode.disabled),_.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),I.call(b,_.gl,R),_.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),_.setColorMode(f.colorModeForRenderPass()),_.setStencilMode(o.StencilMode.disabled);const C=b.renderingMode==="3d"?new o.DepthMode(f.context.gl.LEQUAL,o.DepthMode.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,o.DepthMode.ReadOnly);if(_.setDepthMode(C),f.transform.projection.name==="globe"){const I=f.transform.pointMerc;b.render(_.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(f.transform.zoom),[I.x,I.y],f.transform.pixelsPerMeterRatio)}else b.render(_.gl,f.transform.customLayerMatrix());_.setDirty(),f.setBaseState(),_.bindFramebuffer.set(null)}}else o.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Ll{constructor(r,c,m=!1){this.context=new oe(r,m),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=o.SourceCache.maxUnderzooming+o.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Gf,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(r,c){const m=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Mh(this,r));const _=this._terrain;this.transform.elevation=m?_:null,_.update(r,this.transform,c)}_updateFog(r){const c=r.fog;if(!c||this.transform.projection.name==="globe"||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,_]=c.getFovAdjustedRange(this.transform._fov);if(m>_)return void(this.transform.fogCullDistSq=null);const b=m+.78*(_-m);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(r,c){if(this.width=r*o.exported.devicePixelRatio,this.height=c*o.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._layers[m].resize()}setup(){const r=this.context,c=new o.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(o.EXTENT,0),c.emplaceBack(0,o.EXTENT),c.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(c,o.posAttributes.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const m=new o.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(o.EXTENT,0),m.emplaceBack(0,o.EXTENT),m.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=r.createVertexBuffer(m,o.posAttributes.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const _=new o.StructArrayLayout2i4;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(_,o.posAttributes.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const b=new o.StructArrayLayout4i8;b.emplaceBack(0,0,0,0),b.emplaceBack(o.EXTENT,0,o.EXTENT,0),b.emplaceBack(0,o.EXTENT,0,o.EXTENT),b.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.mercatorBoundsBuffer=r.createVertexBuffer(b,o.boundsAttributes.members),this.mercatorBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const C=new o.StructArrayLayout3ui6;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(C);const I=new o.StructArrayLayout1ui2;for(const R of[0,1,3,2,0])I.emplaceBack(R);this.debugIndexBuffer=r.createIndexBuffer(I),this.emptyTexture=new o.Texture(r,new o.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA),this.identityMat=o.create();const M=this.context.gl;this.stencilClearMode=new o.StencilMode({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO),this.loadTimeStamps.push(o.window.performance.now()),this.atmosphereBuffer=new Gg(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context,c=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(r,c.TRIANGLES,o.DepthMode.disabled,this.stencilClearMode,o.ColorMode.disabled,o.CullFaceMode.disabled,Fn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,c,m){if(!c||this.currentStencilSource===c.id||!r.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const M of m)if(this._tileClippingMaskIDs[M.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=c.id;const _=this.context,b=_.gl;this.nextStencilID+m.length>256&&this.clearStencil(),_.setColorMode(o.ColorMode.disabled),_.setDepthMode(o.DepthMode.disabled);const C=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of m){const M=c.getTile(I),R=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:B,tileBoundsIndexBuffer:U,tileBoundsSegments:W}=this.getTileBoundsBuffers(M);C.draw(_,b.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:b.ALWAYS,mask:0},R,255,b.KEEP,b.KEEP,b.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Fn(I.projMatrix),"$clipping",B,U,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,c=this.context.gl;return new o.StencilMode({func:c.NOTEQUAL,mask:255},r,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const c=this.context.gl;return new o.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(r){const c=this.context.gl,m=r.sort((C,I)=>I.overscaledZ-C.overscaledZ),_=m[m.length-1].overscaledZ,b=m[0].overscaledZ-_+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const C={};for(let I=0;I<b;I++)C[I+_]=new o.StencilMode({func:c.GEQUAL,mask:255},I+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=b,[C,m]}return[{[_]:o.StencilMode.disabled},m]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new o.ColorMode([r.CONSTANT_COLOR,r.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?o.ColorMode.unblended:o.ColorMode.alphaBlended}depthModeForSublayer(r,c,m){if(!this.opaquePassEnabledForLayer())return o.DepthMode.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new o.DepthMode(m||this.context.gl.LEQUAL,c,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,c){this.style=r,this.options=c,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const m=this.style.order,_=this.style._sourceCaches;for(const M in _){const R=_[M];R.used&&R.prepare(this.context)}const b={},C={},I={};for(const M in _){const R=_[M];b[M]=R.getVisibleCoordinates(),C[M]=b[M].slice().reverse(),I[M]=R.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<m.length;M++)if(this.style._layers[m[M]].is3D()){this.opaquePassCutoff=M;break}if(this.terrain&&(this.terrain.updateTileBinding(I),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.GlobeSharedBuffers(this.context)),o.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const M of m){const R=this.style._layers[M],B=r._getLayerSourceCache(R);if(!R.hasOffscreenPass()||R.isHidden(this.transform.zoom))continue;const U=B?C[B.id]:void 0;(R.type==="custom"||R.isSky()||U&&U.length)&&this.renderLayer(this,B,R,U)}if(this.depthRangeFor3D=[0,1-(r.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[m[this.currentLayer]],R=r._getLayerSourceCache(M);if(M.isSky())continue;const B=R?C[R.id]:void 0;this._renderTileClippingMasks(M,R,B),this.renderLayer(this,R,M,B)}if(this.style.fog&&this.transform.projection.supportsFog&&function(M,R){const B=M.context,U=B.gl,W=M.transform,Q=new o.DepthMode(U.LEQUAL,o.DepthMode.ReadOnly,[0,1]),J=M.useProgram("globeAtmosphere",null,W.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ee=o.globeToMercatorTransition(W.zoom),te=R.properties.get("color").toArray01(),Z=R.properties.get("high-color").toArray01(),ce=R.properties.get("space-color").toArray01PremultipliedAlpha(),ae=o.identity$1([]);o.rotateY$1(ae,ae,-o.degToRad(W._center.lng)),o.rotateX$1(ae,ae,o.degToRad(W._center.lat)),o.rotateZ$1(ae,ae,W.angle),o.rotateX$1(ae,ae,-W._pitch);const fe=o.fromQuat(new Float32Array(16),ae),Ce=o.mapValue(R.properties.get("star-intensity"),0,1,0,.25),we=5e-4,Ae=o.mapValue(R.properties.get("horizon-blend"),0,1,we,.25),Be=o.globeUseCustomAntiAliasing(M,B,W)&&Ae===we?W.worldSize/(2*Math.PI*1.025)-1:W.globeRadius,Ne=M.frameCounter/1e3%1,Ge=o.length(W.globeCenterInViewSpace),bt=Math.sqrt(Math.pow(Ge,2)-Math.pow(Be,2)),Fe=Math.acos(bt/Ge),rt=((ht,Ue,Le,Ze,lt,mt,Wt,mn,Ut,Ft,Ht,En,Qt,Zn)=>({u_frustum_tl:ht,u_frustum_tr:Ue,u_frustum_br:Le,u_frustum_bl:Ze,u_horizon:lt,u_transition:mt,u_fadeout_range:Wt,u_color:mn,u_high_color:Ut,u_space_color:Ft,u_star_intensity:Ht,u_star_size:5*o.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:En,u_horizon_angle:Qt,u_rotation_matrix:Zn}))(W.frustumCorners.TL,W.frustumCorners.TR,W.frustumCorners.BR,W.frustumCorners.BL,W.frustumCorners.horizon,ee,Ae,te,Z,ce,Ce,Ne,Fe,fe);M.prepareDrawProgram(B,J);const He=M.atmosphereBuffer;He&&J.draw(B,U.TRIANGLES,Q,o.StencilMode.disabled,o.ColorMode.alphaBlended,o.CullFaceMode.backCW,rt,"skybox",He.vertexBuffer,He.indexBuffer,He.segments)}(this,this.style.fog),this.renderPass="sky",(o.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const M=this.style._layers[m[this.currentLayer]],R=r._getLayerSourceCache(M);M.isSky()&&this.renderLayer(this,R,M,R?C[R.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;){const M=this.style._layers[m[this.currentLayer]],R=r._getLayerSourceCache(M);if(M.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(M)){if(M.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const B=R?(M.type==="symbol"?I:C)[R.id]:void 0;this._renderTileClippingMasks(M,R,R?b[R.id]:void 0),this.renderLayer(this,R,M,B),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let M=null;o.values(this.style._layers).forEach(R=>{const B=r._getLayerSourceCache(R);B&&!R.isHidden(this.transform.zoom)&&(!M||M.getSource().maxzoom<B.getSource().maxzoom)&&(M=B)}),M&&this.options.showTileBoundaries&&Gh.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const R=M.transform.padding;fs(M,M.transform.height-(R.top||0),3,Nh),fs(M,R.bottom||0,3,Uh),Ma(M,R.left||0,3,cp),Ma(M,M.transform.width-(R.right||0),3,up);const B=M.transform.centerPoint;(function(U,W,Q,J){zl(U,W-1,Q-10,2,20,J),zl(U,W-10,Q-1,20,2,J)})(M,B.x,M.transform.height-B.y,hp)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(o.window.performance.now()),this.saveCanvasCopy())}}renderLayer(r,c,m,_){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||_&&_.length)&&(this.id=m.id,this.gpuTimingStart(m),(!r.transform.projection.unsupportedLayers||!r.transform.projection.unsupportedLayers.includes(m.type)||r.terrain&&m.type==="custom")&&Gh[m.type](r,c,m,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let m=this.gpuTimers[r.id];m||(m=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),m.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,m.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,c=r.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),r.beginQueryEXT(r.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const c={};for(const m in r){const _=r[m],b=this.context.extTimerQuery,C=b.getQueryObjectEXT(_.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(_.query),c[m]=C}return c}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let m=0;for(const _ of r)m+=c.getQueryObjectEXT(_,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(_);return m}translatePosMatrix(r,c,m,_,b){if(!m[0]&&!m[1])return r;const C=b?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(C){const R=Math.sin(C),B=Math.cos(C);m=[m[0]*B-m[1]*R,m[0]*R+m[1]*B]}const I=[b?m[0]:At(c,m[0],this.transform.zoom),b?m[1]:At(c,m[1],this.transform.zoom),0],M=new Float32Array(16);return o.translate(M,r,I),M}saveTileTexture(r){const c=this._tileTextures[r.size[0]];c?c.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const c=this._tileTextures[r];return c&&c.length>0?c.pop():null}isPatternMissing(r){return r===null||r!==void 0&&!this.imageManager.getPattern(r.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const r=this.terrain&&this.terrain.renderingToTexture,c=this.terrain&&this.terrain.exaggeration()===0,m=this.style&&this.style.fog,_=[];return this.terrainRenderModeElevated()&&_.push("TERRAIN"),this.transform.projection.name==="globe"&&_.push("GLOBE"),c&&_.push("ZERO_EXAGGERATION"),m&&!r&&m.getOpacity(this.transform.pitch)!==0&&_.push("FOG"),r&&_.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&_.push("OVERDRAW_INSPECTOR"),_}useProgram(r,c,m){this.cache=this.cache||{};const _=m||[],b=this.currentGlobalDefines().concat(_),C=Ph.cacheKey(Th[r],r,b,c);return this.cache[C]||(this.cache[C]=new Ph(this.context,r,Th[r],c,Ng[r],b)),this.cache[C]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(r,c,m){if(this.terrain&&this.terrain.renderingToTexture)return;const _=this.style.fog;if(_){const b=_.getOpacity(this.transform.pitch),C=((I,M,R,B,U,W,Q,J,ee,te,Z)=>{const ce=I.transform,ae=M.properties.get("color").toArray01();ae[3]=B;const fe=I.frameCounter/1e3%1;return{u_fog_matrix:R?ce.calculateFogTileMatrix(R):I.identityMat,u_fog_range:M.getFovAdjustedRange(ce._fov),u_fog_color:ae,u_fog_horizon_blend:M.properties.get("horizon-blend"),u_fog_temporal_offset:fe,u_frustum_tl:U,u_frustum_tr:W,u_frustum_br:Q,u_frustum_bl:J,u_globe_pos:ee,u_globe_radius:te,u_viewport:Z,u_globe_transition:o.globeToMercatorTransition(ce.zoom),u_is_globe:+(ce.projection.name==="globe")}})(this,_,m,b,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.exported.devicePixelRatio,this.transform.height*o.exported.devicePixelRatio]);c.setFogUniformValues(r,C)}}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,c=r.createTexture();return r.bindTexture(r.TEXTURE_2D,c),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,c=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const _ of m)c[_.key]=r[_.key]||new o.Tile(_,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class qh{constructor(r=0,c=0,m=0,_=0){if(isNaN(r)||r<0||isNaN(c)||c<0||isNaN(m)||m<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=c,this.left=m,this.right=_}interpolate(r,c,m){return c.top!=null&&r.top!=null&&(this.top=o.number(r.top,c.top,m)),c.bottom!=null&&r.bottom!=null&&(this.bottom=o.number(r.bottom,c.bottom,m)),c.left!=null&&r.left!=null&&(this.left=o.number(r.left,c.left,m)),c.right!=null&&r.right!=null&&(this.right=o.number(r.right,c.right,m)),this}getCenter(r,c){const m=o.clamp((this.left+r-this.right)/2,0,r),_=o.clamp((this.top+c-this.bottom)/2,0,c);return new o.pointGeometry(m,_)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new qh(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function dp(f,r){const c=o.getColumn(f,3);o.fromQuat(f,r),o.setColumn(f,3,c)}function ou(f,r){const c=o.identity$1([]);return o.rotateZ$1(c,c,-r),o.rotateX$1(c,c,-f),c}function fp(f,r){const c=[f[0],f[1],0],m=[r[0],r[1],0];if(o.length(c)>=1e-15){const C=o.normalize([],c);o.scale$2(m,C,o.dot(m,C)),r[0]=m[0],r[1]=m[1]}const _=o.cross([],r,f);if(o.len(_)<1e-15)return null;const b=Math.atan2(-_[1],_[0]);return ou(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),b)}class su{constructor(r,c){this.position=r,this.orientation=c}get position(){return this._position}set position(r){if(r){const c=r instanceof o.MercatorCoordinate?r:new o.MercatorCoordinate(r[0],r[1],r[2]);this._renderWorldCopies&&(c.x=o.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(r,c){if(this.orientation=null,!this.position)return;const m=this._elevation?this._elevation.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(r)):0,_=this.position,b=o.MercatorCoordinate.fromLngLat(r,m),C=[b.x-_.x,b.y-_.y,b.z-_.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=fp(C,c)}setPitchBearing(r,c){this.orientation=ou(o.degToRad(r),o.degToRad(-c))}}class La{constructor(r,c){this._transform=o.identity([]),this.orientation=c,this.position=r}get mercatorPosition(){const r=this.position;return new o.MercatorCoordinate(r[0],r[1],r[2])}get position(){const r=o.getColumn(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var c;r&&o.setColumn(this._transform,3,[(c=r)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||o.identity$1([]),r&&dp(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,c){this._orientation=ou(r,c),dp(this._transform,this._orientation)}forward(){const r=o.getColumn(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=o.getColumn(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=o.getColumn(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,c){const m=new Float64Array(16);return o.invert(m,this.getWorldToCamera(r,c)),m}getWorldToCameraPosition(r,c,m){const _=this.position;o.scale$2(_,_,-r);const b=new Float64Array(16);return o.fromScaling(b,[m,m,m]),o.translate(b,b,_),b[10]*=c,b}getWorldToCamera(r,c){const m=new Float64Array(16),_=new Float64Array(4),b=this.position;return o.conjugate(_,this._orientation),o.scale$2(b,b,-r),o.fromQuat(m,_),o.translate(m,m,b),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=c,m[9]*=c,m[10]*=c,m[11]*=c,m}getCameraToClipPerspective(r,c,m,_){const b=new Float64Array(16);return o.perspective(b,r,c,m,_),b}getDistanceToElevation(r,c=!1){const m=r===0?0:o.mercatorZfromAltitude(r,c?o.latFromMercatorY(this.position[1]):this.position[1]),_=this.forward();return(m-this.position[2])/_[2]}clone(){return new La([...this.position],[...this.orientation])}}function Da(f,r){const c=Xs(f.projection,f.zoom,f.width,f.height),m=function(b,C,I,M,R){const B=new o.LngLat(I.lng-180*Ys,I.lat),U=new o.LngLat(I.lng+180*Ys,I.lat),W=b.project(B.lng,B.lat),Q=b.project(U.lng,U.lat),J=-Math.atan2(Q.y-W.y,Q.x-W.x),ee=o.MercatorCoordinate.fromLngLat(I);ee.y=o.clamp(ee.y,-.999975,.999975);const te=ee.toLngLat(),Z=b.project(te.lng,te.lat),ce=o.MercatorCoordinate.fromLngLat(te);ce.x+=Ys;const ae=ce.toLngLat(),fe=b.project(ae.lng,ae.lat),Ce=Rl(fe.x-Z.x,fe.y-Z.y,J),we=o.MercatorCoordinate.fromLngLat(te);we.y+=Ys;const Ae=we.toLngLat(),Be=b.project(Ae.lng,Ae.lat),Ne=Rl(Be.x-Z.x,Be.y-Z.y,J),Ge=Math.abs(Ce.x)/Math.abs(Ne.y),bt=o.identity([]);o.rotateZ(bt,bt,-J*(1-(R?0:M)));const Fe=o.identity([]);return o.scale(Fe,Fe,[1,1-(1-Ge)*M,1]),Fe[4]=-Ne.x/Ne.y*M,o.rotateZ(Fe,Fe,J),o.multiply(Fe,bt,Fe),Fe}(f.projection,0,f.center,c,r),_=au(f);return o.scale(m,m,[_,_,1]),m}function au(f){const r=f.projection,c=Xs(f.projection,f.zoom,f.width,f.height),m=Dl(r,f.center),_=Dl(r,o.LngLat.convert(r.center));return Math.pow(2,m*c+(1-c)*_)}function Xs(f,r,c,m,_=1/0){const b=f.range;if(!b)return 0;const C=Math.min(_,Math.max(c,m)),I=Math.log(C/1024)/Math.LN2;return o.smoothstep(b[0]+I,b[1]+I,r)}const Ys=1/4e4;function Dl(f,r){const c=o.clamp(r.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),m=new o.LngLat(r.lng-180*Ys,c),_=new o.LngLat(r.lng+180*Ys,c),b=f.project(m.lng,c),C=f.project(_.lng,c),I=o.MercatorCoordinate.fromLngLat(m),M=o.MercatorCoordinate.fromLngLat(_),R=C.x-b.x,B=C.y-b.y,U=M.x-I.x,W=M.y-I.y,Q=Math.sqrt((U*U+W*W)/(R*R+B*B));return Math.log(Q)/Math.LN2}function Rl(f,r,c){const m=Math.cos(c),_=Math.sin(c);return{x:f*m-r*_,y:f*_+r*m}}class Bt{constructor(r,c,m,_,b,C,I){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=r||0,this._maxZoom=c||22,this._minPitch=m==null?0:m,this._maxPitch=_==null?60:_,this.setProjection(C),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new qh,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new La,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const r=new Bt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(r,c=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(r||m)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return o.pick(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=o.getProjection(this.projectionOptions);const m=!w(c,this.getProjection());return m&&this._calcMatrices(),this.mercatorFromTransition=!1,m}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.getProjection({name:"mercator"});const c=r!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return o.wrap(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const c=-r*Math.PI/180;var m;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(m=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m),function(_,b,C){var I=b[0],M=b[1],R=b[2],B=b[3],U=Math.sin(C),W=Math.cos(C);_[0]=I*W+R*U,_[1]=M*W+B*U,_[2]=I*-U+R*W,_[3]=M*-U+B*W}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const c=o.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=o.degToRad(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const c=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const r=this._elevation;this._centerAltitude=r.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=r.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let _=0,b=0;for(let C=0;C<c.length;C++){const I=new o.pointGeometry(c[C][0]*this.width,m+c[C][1]*(this.height-m)),M=r.pointCoordinate(I);if(!M)continue;const R=1/Math.hypot(M[0]-this._camera.position[0],M[1]-this._camera.position[1]);_+=M[3]*R,b+=R}return b===0?NaN:_/b}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*c,_=this._mercatorZfromZoom(r),b=this._mercatorZfromZoom(this._maxZoom),C=Math.max(_-m,b);this._setZoom(this._zoomFromMercatorZ(C))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let m;m=r.z<this._camera.position[2]?[c.x,c.y,c.z]:[r.x,r.y,r.z];const _=o.length(o.sub([],this._camera.position,m));return o.clamp(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let c=!1;if(r.orientation&&!o.exactEquals(r.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(r.orientation)),r.position){const m=[r.position.x,r.position.y,r.position.z];o.exactEquals$1(m,this._camera.position)||(this._setCameraPosition(m),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,c=new su;return c.position=new o.MercatorCoordinate(r[0],r[1],r[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(r){if(!o.length$1(r))return!1;o.normalize$1(r,r);const c=o.transformQuat([],[0,0,-1],r),m=o.transformQuat([],[0,-1,0],r);if(m[2]<0)return!1;const _=fp(c,m);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(r){const c=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;r[2]=o.clamp(r[2],_/m,_/c),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,c,m){this._unmodified=!1,this._edgeInsets.interpolate(r,c,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const c=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(r){const c=[new o.UnwrappedTileID(0,r)];if(this.renderWorldCopies){const m=this.pointCoordinate(new o.pointGeometry(0,0)),_=this.pointCoordinate(new o.pointGeometry(this.width,0)),b=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),C=this.pointCoordinate(new o.pointGeometry(0,this.height)),I=Math.floor(Math.min(m.x,_.x,b.x,C.x)),M=Math.floor(Math.max(m.x,_.x,b.x,C.x)),R=1;for(let B=I-R;B<=M+R;B++)B!==0&&c.push(new o.UnwrappedTileID(B,r))}return c}coveringTiles(r){let c=this.coveringZoomLevel(r);const m=c,_=this.elevation&&!r.isTerrainDEM,b=this.projection.name==="mercator";if(r.minzoom!==void 0&&c<r.minzoom)return[];r.maxzoom!==void 0&&c>r.maxzoom&&(c=r.maxzoom);const C=this.locationCoordinate(this.center),I=this.center.lat,M=1<<c,R=[M*C.x,M*C.y,0],B=this.projection.name==="globe",U=!B,W=o.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,U),Q=B?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),J=M*o.mercatorZfromAltitude(1,this.center.lat),ee=this._camera.position[2]/o.mercatorZfromAltitude(1,this.center.lat),te=[M*Q.x,M*Q.y,ee*(U?1:J)],Z=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),ce=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,ae=r.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,fe=r.isTerrainDEM?-ae:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ce=this.projection.isReprojectedInTileSpace?au(this):1,we=Ue=>{const Ze=new o.MercatorCoordinate(Ue.x+25e-6,Ue.y,Ue.z),lt=new o.MercatorCoordinate(Ue.x,Ue.y+25e-6,Ue.z),mt=Ue.toLngLat(),Wt=Ze.toLngLat(),mn=lt.toLngLat(),Ut=this.locationCoordinate(mt),Ft=this.locationCoordinate(Wt),Ht=this.locationCoordinate(mn),En=Math.hypot(Ft.x-Ut.x,Ft.y-Ut.y),Qt=Math.hypot(Ht.x-Ut.x,Ht.y-Ut.y);return Math.sqrt(En*Qt)*Ce/25e-6},Ae=Ue=>{const Le=ae,Ze=fe;return{aabb:o.tileAABB(this,M,0,0,0,Ue,Ze,Le,this.projection),zoom:0,x:0,y:0,minZ:Ze,maxZ:Le,wrap:Ue,fullyVisible:!1}},Be=[];let Ne=[];const Ge=c,bt=r.reparseOverscaled?m:c,Fe=Ue=>Ue*Ue,rt=Fe((ee-this._centerAltitude)*J),He=Ue=>{if(!this._elevation||!Ue.tileID||!b)return;const Le=this._elevation.getMinMaxForTile(Ue.tileID),Ze=Ue.aabb;Le?(Ze.min[2]=Le.min,Ze.max[2]=Le.max,Ze.center[2]=(Ze.min[2]+Ze.max[2])/2):(Ue.shouldSplit=ht(Ue),Ue.shouldSplit||(Ze.min[2]=Ze.max[2]=Ze.center[2]=this._centerAltitude))},ht=Ue=>{if(Ue.zoom<ce)return!0;if(Ue.zoom===Ge)return!1;if(Ue.shouldSplit!=null)return Ue.shouldSplit;const Le=Ue.aabb.distanceX(te),Ze=Ue.aabb.distanceY(te);let lt=rt,mt=1;if(B){lt=Fe(Ue.aabb.distanceZ(te));const Ut=Math.pow(2,Ue.zoom),Ft=o.latFromMercatorY((Ue.y+1)/Ut),Ht=o.latFromMercatorY(Ue.y/Ut),En=Math.min(Math.max(I,Ft),Ht),Qt=o.circumferenceAtLatitude(En)/o.circumferenceAtLatitude(I);if(mt=En===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Qt/this._mercatorScaleRatio),this.zoom<=o.GLOBE_ZOOM_THRESHOLD_MIN&&Ue.zoom===Ge-1&&Qt>=.9)return!0}else if(_&&(lt=Fe(Ue.aabb.distanceZ(te)*J)),this.projection.isReprojectedInTileSpace&&m<=5){const Ut=Math.pow(2,Ue.zoom),Ft=we(new o.MercatorCoordinate((Ue.x+.5)/Ut,(Ue.y+.5)/Ut));mt=Ft>.85?1:Ft}const Wt=Le*Le+Ze*Ze+lt,mn=Fe((1<<Ge-Ue.zoom)*Z*mt*((Ut,Ft)=>{if(Ft*Fe(.707)<Ut)return 1;const Ht=Math.sqrt(Ft/Ut);return Ht/(1.4144271570014144+(Math.pow(1.1,Ht-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(lt,rt),Wt));return Wt<mn};if(this.renderWorldCopies)for(let Ue=1;Ue<=3;Ue++)Be.push(Ae(-Ue)),Be.push(Ae(Ue));for(Be.push(Ae(0));Be.length>0;){const Ue=Be.pop(),Le=Ue.x,Ze=Ue.y;let lt=Ue.fullyVisible;if(!lt){const mt=Ue.aabb.intersects(W);if(mt===0)continue;lt=mt===2}if(Ue.zoom!==Ge&&ht(Ue))for(let mt=0;mt<4;mt++){const Wt=(Le<<1)+mt%2,mn=(Ze<<1)+(mt>>1),Ut={aabb:b?Ue.aabb.quadrant(mt):o.tileAABB(this,M,Ue.zoom+1,Wt,mn,Ue.wrap,Ue.minZ,Ue.maxZ,this.projection),zoom:Ue.zoom+1,x:Wt,y:mn,wrap:Ue.wrap,fullyVisible:lt,tileID:void 0,shouldSplit:void 0,minZ:Ue.minZ,maxZ:Ue.maxZ};_&&!B&&(Ut.tileID=new o.OverscaledTileID(Ue.zoom+1===Ge?bt:Ue.zoom+1,Ue.wrap,Ue.zoom+1,Wt,mn),He(Ut)),Be.push(Ut)}else{const mt=Ue.zoom===Ge?bt:Ue.zoom;if(r.minzoom&&r.minzoom>mt)continue;const Wt=R[0]-(.5+Le+(Ue.wrap<<Ue.zoom))*(1<<c-Ue.zoom),mn=R[1]-.5-Ze,Ut=Ue.tileID?Ue.tileID:new o.OverscaledTileID(mt,Ue.wrap,Ue.zoom,Le,Ze);Ne.push({tileID:Ut,distanceSq:Wt*Wt+mn*mn})}}if(this.fogCullDistSq){const Ue=this.fogCullDistSq,Le=this.horizonLineFromTop();Ne=Ne.filter(Ze=>{const lt=[0,0,0,1],mt=[o.EXTENT,o.EXTENT,0,1],Wt=this.calculateFogTileMatrix(Ze.tileID.toUnwrapped());o.transformMat4$1(lt,lt,Wt),o.transformMat4$1(mt,mt,Wt);const mn=o.getAABBPointSquareDist(lt,mt);if(mn===0)return!0;let Ut=!1;const Ft=this._elevation;if(Ft&&mn>Ue&&Le!==0){const Ht=this.calculateProjMatrix(Ze.tileID.toUnwrapped());let En;r.isTerrainDEM||(En=Ft.getMinMaxForTile(Ze.tileID)),En||(En={min:fe,max:ae});const Qt=o.furthestTileCorner(this.rotation),Zn=[Qt[0]*o.EXTENT,Qt[1]*o.EXTENT,En.max];o.transformMat4(Zn,Zn,Ht),Ut=(1-Zn[1])*this.height*.5<Le}return mn<Ue||Ut})}return Ne.sort((Ue,Le)=>Ue.distanceSq-Le.distanceSq).map(Ue=>Ue.tileID)}resize(r,c){this.width=r,this.height=c,this.pixelsToGLUnits=[2/r,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const c=o.clamp(r.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),m=this.projection.project(r.lng,c);return new o.pointGeometry(m.x*this.worldSize,m.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,c){let m,_;const b=this.centerPoint;if(this.projection.name==="globe"){const I=this.worldSize;m=(c.x-b.x)/I,_=(c.y-b.y)/I}else{const I=this.pointCoordinate(c),M=this.pointCoordinate(b);m=I.x-M.x,_=I.y-M.y}const C=this.locationCoordinate(r);this.setLocation(new o.MercatorCoordinate(C.x-m,C.y-_))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,c){const m=c?o.mercatorZfromAltitude(c,r.lat):void 0,_=this.projection.project(r.lng,r.lat);return new o.MercatorCoordinate(_.x,_.y,m)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,c){const m=c!=null?c:this._centerAltitude,_=[r.x,r.y,0,1],b=[r.x,r.y,1,1];o.transformMat4$1(_,_,this.pixelMatrixInverse),o.transformMat4$1(b,b,this.pixelMatrixInverse);const C=b[3];o.scale$1(_,_,1/_[3]),o.scale$1(b,b,1/C);const I=_[2],M=b[2];return{p0:_,p1:b,t:I===M?0:(m-I)/(M-I)}}screenPointToMercatorRay(r){const c=[r.x,r.y,0,1],m=[r.x,r.y,1,1];return o.transformMat4$1(c,c,this.pixelMatrixInverse),o.transformMat4$1(m,m,this.pixelMatrixInverse),o.scale$1(c,c,1/c[3]),o.scale$1(m,m,1/m[3]),c[2]=o.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,m[2]=o.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,o.scale$1(c,c,1/this.worldSize),o.scale$1(m,m,1/this.worldSize),new o.Ray([c[0],c[1],c[2]],o.normalize([],o.sub([],m,c)))}rayIntersectionCoordinate(r){const{p0:c,p1:m,t:_}=r,b=o.mercatorZfromAltitude(c[2],this._center.lat),C=o.mercatorZfromAltitude(m[2],this._center.lat);return new o.MercatorCoordinate(o.number(c[0],m[0],_)/this.worldSize,o.number(c[1],m[1],_)/this.worldSize,o.number(b,C,_))}pointCoordinate(r,c=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,c)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let c=this.projection.pointCoordinate3D(this,r.x,r.y);if(c)return new o.MercatorCoordinate(c[0],c[1],c[2]);let m=0,_=this.horizonLineFromTop();if(r.y>_)return this.pointCoordinate(r);const b=.02*_,C=r.clone();for(let I=0;I<10&&_-m>b;I++){C.y=o.number(m,_,.66);const M=this.projection.pointCoordinate3D(this,C.x,C.y);M?(_=C.y,c=M):m=C.y}return c?new o.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}_coordinatePoint(r,c){const m=c&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,_=[r.x*this.worldSize,r.y*this.worldSize,m+r.toAltitude(),1];return o.transformMat4$1(_,_,this.pixelMatrix),_[3]>0?new o.pointGeometry(_[0]/_[3],_[1]/_[3]):new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:c}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,_=this.width-this._edgeInsets.right,b=this.pointLocation3D(new o.pointGeometry(c,r)),C=this.pointLocation3D(new o.pointGeometry(_,r)),I=this.pointLocation3D(new o.pointGeometry(_,m)),M=this.pointLocation3D(new o.pointGeometry(c,m));let R=Math.min(b.lng,C.lng,I.lng,M.lng),B=Math.max(b.lng,C.lng,I.lng,M.lng),U=Math.min(b.lat,C.lat,I.lat,M.lat),W=Math.max(b.lat,C.lat,I.lat,M.lat);const Q=Math.pow(2,-this.zoom)/16*270,J=this.projection.name==="globe"?1:4,ee=(te,Z,ce,ae,fe)=>{const Ce=(te+ce)/2,we=(Z+ae)/2,Ae=new o.pointGeometry(Ce,we),{lng:Be,lat:Ne}=this.pointLocation3D(Ae),Ge=Math.max(0,R-Be,U-Ne,Be-B,Ne-W);R=Math.min(R,Be),B=Math.max(B,Be),U=Math.min(U,Ne),W=Math.max(W,Ne),(fe<J||Ge>Q)&&(ee(te,Z,Ce,we,fe+1),ee(Ce,we,ce,ae,fe+1))};if(ee(c,r,_,r,1),ee(_,r,_,m,1),ee(_,m,c,m,1),ee(c,m,c,r,1),this.projection.name==="globe"){const[te,Z]=o.polesInViewport(this);te?(W=90,B=180,R=-180):Z&&(U=-90,B=180,R=-180)}return new o.LngLatBounds(new o.LngLat(R,U),new o.LngLat(B,W))}_getBoundsRectangular(r,c){const{top:m,left:_}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,I=new o.pointGeometry(_,m),M=new o.pointGeometry(C,m),R=new o.pointGeometry(C,b),B=new o.pointGeometry(_,b);let U=this.pointCoordinate(I,r),W=this.pointCoordinate(M,r);const Q=this.pointCoordinate(R,c),J=this.pointCoordinate(B,c),ee=(te,Z)=>(Z.y-te.y)/(Z.x-te.x);return U.y>1&&W.y>=0?U=new o.MercatorCoordinate((1-J.y)/ee(J,U)+J.x,1):U.y<0&&W.y<=1&&(U=new o.MercatorCoordinate(-J.y/ee(J,U)+J.x,0)),W.y>1&&U.y>=0?W=new o.MercatorCoordinate((1-Q.y)/ee(Q,W)+Q.x,1):W.y<0&&U.y<=1&&(W=new o.MercatorCoordinate(-Q.y/ee(Q,W)+Q.x,0)),new o.LngLatBounds().extend(this.coordinateLocation(U)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(J)).extend(this.coordinateLocation(Q))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=r.visibleDemTiles.reduce((m,_)=>{if(_.dem){const b=_.dem.tree;m.min=Math.min(m.min,b.minimums[0]),m.max=Math.max(m.max,b.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*r.exaggeration(),c.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,m=this.height/2-c*(1-this._horizonShift);return r?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-o.MAX_MERCATOR_LATITUDE,this.maxLat=o.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=o.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=o.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=o.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,c){return this.projection.createTileMatrix(this,c,r)}calculateDistanceTileData(r){const c=r.key,m=this._distanceTileDataCache;if(m[c])return m[c];const _=r.canonical,b=1/this.height,C=this.cameraWorldSize,I=C/this.zoomScale(_.z),M=(_.x+Math.pow(2,_.z)*r.wrap)*I,R=_.y*I,B=this.point;B.x*=C/this.worldSize,B.y*=C/this.worldSize;const U=this.angle,W=Math.sin(-U),Q=-Math.cos(-U);return m[c]={bearing:[W,Q],center:[(B.x-M)*b,(B.y-R)*b],scale:I/o.EXTENT*b},m[c]}calculateFogTileMatrix(r){const c=r.key,m=this._fogTileMatrixCache;if(m[c])return m[c];const _=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return o.multiply(_,this.worldToFogMatrix,_),m[c]=new Float32Array(_),m[c]}calculateProjMatrix(r,c=!1){const m=r.key,_=c?this._alignedProjMatrixCache:this._projMatrixCache;if(_[m])return _[m];const b=this.calculatePosMatrix(r,this.worldSize);return o.multiply(b,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,b),_[m]=new Float32Array(b),_[m]}calculatePixelsToTileUnitsMatrix(r){const c=r.tileID.key,m=this._pixelsToTileUnitsCache;if(m[c])return m[c];const _=function(b,C){const{scale:I}=b.tileTransform,M=I*o.EXTENT/(b.tileSize*Math.pow(2,C.zoom-b.tileID.overscaledZ+b.tileID.canonical.z));return R=new Float32Array(4),W=(B=C.inverseAdjustmentMatrix)[1],Q=B[2],J=B[3],te=(U=[M,M])[1],R[0]=B[0]*(ee=U[0]),R[1]=W*ee,R[2]=Q*te,R[3]=J*te,R;var R,B,U,W,Q,J,ee,te}(r,this);return m[c]=_,m[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,c=o.fromScaling([],[r,r,r]);return o.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const c=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(c),_=this._camera.forward(),b=o.mercatorZfromAltitude(1,this._center.lat);m[2]/=b,_[2]/=b,o.normalize(_,_);const C=r.raycast(m,_,r.exaggeration());if(C){const I=o.scaleAndAdd([],m,_,C),M=new o.MercatorCoordinate(I[0],I[1],o.mercatorZfromAltitude(I[2],o.latFromMercatorY(I[1]))),R=(M.z+o.length([M.x-m[0],M.y-m[1],M.z-m[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(R),this._centerAltitude=M.toAltitude(),this._center=this.coordinateLocation(M),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const c=this._elevation,m=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(m),b=c.getAtPointOrZero(new o.MercatorCoordinate(..._)),C=this.pixelsPerMeter/this.worldSize*b,I=this._minimumHeightOverTerrain(),M=_[2]-C;if(M<=I)if(M<0||r){const R=this.locationCoordinate(this._center,this._centerAltitude),B=[_[0],_[1],R.z-_[2]],U=o.length(B);B[2]-=(I-M)/this._pixelsPerMercatorPixel;const W=o.length(B);if(W===0)return;o.scale$2(B,B,U/W*this._pixelsPerMercatorPixel),this._camera.position=[_[0],_[1],R.z*this._pixelsPerMercatorPixel-B[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const W=this.center;return W.lat=o.clamp(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(W.lng=o.clamp(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const c=this._unmodified,{x:m,y:_}=this.point;let b=0,C=m,I=_;const M=this.width/2,R=this.height/2,B=this.worldMinY*this.scale,U=this.worldMaxY*this.scale;if(_-R<B&&(I=B+R),_+R>U&&(I=U-R),U-B<this.height&&(b=Math.max(b,this.height/(U-B)),I=(U+B)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,Q=this.worldMaxX*this.scale,J=this.worldSize/2-(W+Q)/2;C=(m+J+this.worldSize)%this.worldSize-J,C-M<W&&(C=W+M),C+M>Q&&(C=Q-M),Q-W<this.width&&(b=Math.max(b,this.width/(Q-W)),C=(Q+W)/2)}C===m&&I===_||(this.center=this.unproject(new o.pointGeometry(C,I))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,c=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.mercatorZfromAltitude(1,this.center.lat)/o.mercatorZfromAltitude(1,o.GLOBE_SCALE_MATCH_LATITUDE));const m=Xs(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,m),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const _=this.projection.zAxisUnit==="meters"?c:1,b=this._camera.getWorldToCamera(this.worldSize,_),C=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);C[8]=2*-r.x/this.width,C[9]=2*r.y/this.height;let I=o.mul([],C,b);if(this.projection.isReprojectedInTileSpace){const we=this.locationCoordinate(this.center),Ae=o.identity([]);o.translate(Ae,Ae,[we.x*this.worldSize,we.y*this.worldSize,0]),o.multiply(Ae,Ae,Da(this)),o.translate(Ae,Ae,[-we.x*this.worldSize,-we.y*this.worldSize,0]),o.multiply(I,I,Ae),this.inverseAdjustmentMatrix=function(Be){const Ne=Da(Be,!0);return Se([],[Ne[0],Ne[1],Ne[4],Ne[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=o.scale([],I,[this.worldSize,this.worldSize,this.worldSize/_,1]),this.projMatrix=I,this.invProjMatrix=o.invert(new Float64Array(16),this.projMatrix);const M=o.invert([],C);this.frustumCorners=o.FrustumCorners.fromInvProjectionMatrix(M,this.horizonLineFromTop(),this.height);const R=new Float32Array(16);o.identity(R),o.scale(R,R,[1,-1,1]),o.rotateX(R,R,this._pitch),o.rotateZ(R,R,this.angle);const B=o.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),U=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;B[8]=2*-r.x/this.width,B[9]=2*(r.y+U)/this.height,this.skyboxMatrix=o.multiply(R,B,R);const W=this.point,Q=W.x,J=W.y,ee=this.width%2/2,te=this.height%2/2,Z=Math.cos(this.angle),ce=Math.sin(this.angle),ae=Q-Math.round(Q)+Z*ee+ce*te,fe=J-Math.round(J)+Z*te+ce*ee,Ce=new Float64Array(I);if(o.translate(Ce,Ce,[ae>.5?ae-1:ae,fe>.5?fe-1:fe,0]),this.alignedProjMatrix=Ce,I=o.create(),o.scale(I,I,[this.width/2,-this.height/2,1]),o.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=o.create(),o.scale(I,I,[1,-1,1]),o.translate(I,I,[-1,-1,0]),o.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=o.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=I,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.calculateGlobeMatrix(this);const we=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.transformMat4(we,we,b),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=I;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,m=this._camera.position,_=1/this.height/this._pixelsPerMercatorPixel,b=[r,r,c];o.scale$2(b,b,_),o.scale$2(m,m,-1),o.multiply$2(m,m,b);const C=o.create();o.translate(C,C,m),o.scale(C,C,b),this.mercatorFogMatrix=C,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,c,_)}_computeCameraPosition(r){const c=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),_=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-r/this.worldSize*this._centerAltitude;return[_.x/this.worldSize-m[0]*b,_.y/this.worldSize-m[1]*b,r/this.worldSize*this._centerAltitude-m[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],_=r[2];let b=1;this.projection.wrap&&(this.center=this.center.wrap()),_>0&&(b=Math.min((c-m)/_,1)),this._camera.position=o.scaleAndAdd([],this._camera.position,r,b),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,c=this._camera.forward(),{pitch:m,bearing:_}=this._camera.getPitchBearing(),b=o.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,C=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.degToRad(this._maxPitch)),I=Math.max((r[2]-b)/Math.cos(m),C),M=this._zoomFromMercatorZ(I);o.scaleAndAdd(r,r,c,I),this._pitch=o.clamp(m,o.degToRad(this.minPitch),o.degToRad(this.maxPitch)),this.angle=o.wrap(_,-Math.PI,Math.PI),this._setZoom(o.clamp(M,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.MercatorCoordinate(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let c=0,m=o.GLOBE_ZOOM_THRESHOLD_MAX,_=0,b=1/0;for(;m-c>1e-6&&m>c;){const C=c+.5*(m-c),I=this.tileSize*Math.pow(2,C),M=this.getCameraToCenterDistance(this.projection,C,I),R=this.scaleZoom(M/(r*this.tileSize)),B=Math.abs(C-R);B<b&&(b=B,_=C),C<R?c=C:m=C}return _}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,c){const m=Math.min(r.x,c.x),_=Math.max(r.x,c.x),b=Math.min(r.y,c.y),C=Math.max(r.y,c.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const I=[new o.pointGeometry(m,b),new o.pointGeometry(_,C),new o.pointGeometry(m,C),new o.pointGeometry(_,b)],M=this.renderWorldCopies?-3:0,R=this.renderWorldCopies?4:1;for(const B of I){const U=this.pointRayIntersection(B);if(U.t<0)return!0;const W=this.rayIntersectionCoordinate(U);if(W.x<M||W.y<0||W.x>R||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.pointGeometry(0,0),new o.pointGeometry(this.width,this.height))}zoomDeltaToMovement(r,c){const m=o.length(o.sub([],this._camera.position,r)),_=this._zoomFromMercatorZ(m)+c;return m-this._mercatorZfromZoom(_)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([c,m,_],b){const C=[c,m,_,1];o.transformMat4$1(C,C,b);const I=C[3]=Math.max(C[3],1e-6);return C[0]/=I,C[1]/=I,C[2]/=I,C}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.pointGeometry(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,r))}}getCameraToCenterDistance(r,c=this.zoom,m=this.worldSize){const _=Xs(r,c,this.width,this.height,1024),b=r.pixelSpaceConversion(this.center.lat,m,_);return .5/Math.tan(.5*this._fov)*this.height*b}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.multiply(r,r,this.globeMatrix),r}}function Hr(f,r){let c=!1,m=null;const _=()=>{m=null,c&&(f(),m=setTimeout(_,r),c=!1)};return()=>(c=!0,m||_(),m)}class pp{constructor(r){this._hashName=r&&encodeURIComponent(r),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Hr(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,o.window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),o.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const c=Zh(r);if(this._hashName){const m=this._hashName;let _=!1;const b=o.window.location.hash.slice(1).split("&").map(C=>{const I=C.split("=")[0];return I===m?(_=!0,`${I}=${c}`):C}).filter(C=>C);return _||b.push(`${m}=${c}`),`#${b.join("&")}`}return`#${c}`}_getCurrentHash(){const r=o.window.location.hash.replace("#","");if(this._hashName){let c;return r.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(c=m)}),(c&&c[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(m=>isNaN(m))){const m=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(c[3]||0):r.getBearing();return r.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:m,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=o.window.location.href.replace(/(#.+)?$/,this.getHashString());o.window.history.replaceState(o.window.history.state,null,r)}}function Zh(f,r){const c=f.getCenter(),m=Math.round(100*f.getZoom())/100,_=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,_),C=Math.round(c.lng*b)/b,I=Math.round(c.lat*b)/b,M=f.getBearing(),R=f.getPitch();let B=r?`/${C}/${I}/${m}`:`${m}/${I}/${C}`;return(M||R)&&(B+="/"+Math.round(10*M)/10),R&&(B+=`/${Math.round(R)}`),B}const Bl={linearity:.3,easing:o.bezier(0,0,.3,1)},Ra=o.extend({deceleration:2500,maxSpeed:1400},Bl),mp=o.extend({deceleration:20,maxSpeed:1400},Bl),lu=o.extend({deceleration:1e3,maxSpeed:360},Bl),Wh=o.extend({deceleration:1e3,maxSpeed:90},Bl);class cu{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,c=o.exported.now();for(;r.length>0&&c-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)c.zoom+=b.zoomDelta||0,c.bearing+=b.bearingDelta||0,c.pitch+=b.pitchDelta||0,b.panDelta&&c.pan._add(b.panDelta),b.around&&(c.around=b.around),b.pinchAround&&(c.pinchAround=b.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(c.pan.mag()){const b=Fl(c.pan.mag(),m,o.extend({},Ra,r||{}));_.offset=c.pan.mult(b.amount/c.pan.mag()),_.center=this._map.transform.center,Ol(_,b)}if(c.zoom){const b=Fl(c.zoom,m,mp);_.zoom=this._map.transform.zoom+b.amount,Ol(_,b)}if(c.bearing){const b=Fl(c.bearing,m,lu);_.bearing=this._map.transform.bearing+o.clamp(b.amount,-179,179),Ol(_,b)}if(c.pitch){const b=Fl(c.pitch,m,Wh);_.pitch=this._map.transform.pitch+b.amount,Ol(_,b)}if(_.zoom||_.bearing){const b=c.pinchAround===void 0?c.around:c.pinchAround;_.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),_.noMoveStart=!0,_}}function Ol(f,r){(!f.duration||f.duration<r.duration)&&(f.duration=r.duration,f.easing=r.easing)}function Fl(f,r,c){const{maxSpeed:m,linearity:_,deceleration:b}=c,C=o.clamp(f*_/(r/1e3),-m,m),I=Math.abs(C)/(b*_);return{easing:c.easing,duration:1e3*I,amount:C*(I/2)}}class nr extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,m,_={}){const b=Y(c.getCanvasContainer(),m),C=c.unproject(b);super(r,o.extend({point:b,lngLat:C,originalEvent:m},_)),this._defaultPrevented=!1,this.target=c}}class uu extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,m){const _=r==="touchend"?m.changedTouches:m.touches,b=_e(c.getCanvasContainer(),_),C=b.map(M=>c.unproject(M)),I=b.reduce((M,R,B,U)=>M.add(R.div(U.length)),new o.pointGeometry(0,0));super(r,{points:b,point:I,lngLats:C,lngLat:c.unproject(I),originalEvent:m}),this._defaultPrevented=!1}}class qg extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,m){super(r,{originalEvent:m}),this._defaultPrevented=!1}}class gp{constructor(r,c){this._map=r,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new qg(r.type,this._map,r))}mousedown(r,c){return this._mousedownPos=c,this._firePreventable(new nr(r.type,this._map,r))}mouseup(r){this._map.fire(new nr(r.type,this._map,r))}preclick(r){const c=o.extend({},r);c.type="preclick",this._map.fire(new nr(c.type,this._map,c))}click(r,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(r),this._map.fire(new nr(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new nr(r.type,this._map,r))}mouseover(r){this._map.fire(new nr(r.type,this._map,r))}mouseout(r){this._map.fire(new nr(r.type,this._map,r))}touchstart(r){return this._firePreventable(new uu(r.type,this._map,r))}touchmove(r){this._map.fire(new uu(r.type,this._map,r))}touchend(r){this._map.fire(new uu(r.type,this._map,r))}touchcancel(r){this._map.fire(new uu(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class hu{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new nr(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new nr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new nr(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hh{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,c){this.isEnabled()&&r.shiftKey&&r.button===0&&(se(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(r,c){if(!this._active)return;const m=c,_=this._startPos,b=this._lastPos;if(!_||!b||b.equals(m)||!this._box&&m.dist(_)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=L("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const C=Math.min(_.x,m.x),I=Math.max(_.x,m.x),M=Math.min(_.y,m.y),R=Math.max(_.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${C}px,${M}px)`,this._box.style.width=I-C+"px",this._box.style.height=R-M+"px")})}mouseupWindow(r,c){if(!this._active)return;const m=this._startPos,_=c;if(m&&r.button===0){if(this.reset(),Te(),m.x!==_.x||m.y!==_.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:b=>b.fitScreenCoordinates(m,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),he(),delete this._startPos,delete this._lastPos}_fireEvent(r,c){return this._map.fire(new o.Event(r,{originalEvent:c}))}}function du(f,r){const c={};for(let m=0;m<f.length;m++)c[f[m].identifier]=r[m];return c}class vp{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,c,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),m.length===this.numTouches&&(this.centroid=function(_){const b=new o.pointGeometry(0,0);for(const C of _)b._add(C);return b.div(_.length)}(c),this.touches=du(m,c)))}touchmove(r,c,m){if(this.aborted||!this.centroid)return;const _=du(m,c);for(const b in this.touches){const C=this.touches[b],I=_[b];(!I||I.dist(C)>30)&&(this.aborted=!0)}}touchend(r,c,m){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Ba{constructor(r){this.singleTap=new vp(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,c,m){this.singleTap.touchstart(r,c,m)}touchmove(r,c,m){this.singleTap.touchmove(r,c,m)}touchend(r,c,m){const _=this.singleTap.touchend(r,c,m);if(_){const b=r.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(_)<30;if(b&&C||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class Xh{constructor(){this._zoomIn=new Ba({numTouches:1,numTaps:2}),this._zoomOut=new Ba({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,c,m){this._zoomIn.touchstart(r,c,m),this._zoomOut.touchstart(r,c,m)}touchmove(r,c,m){this._zoomIn.touchmove(r,c,m),this._zoomOut.touchmove(r,c,m)}touchend(r,c,m){const _=this._zoomIn.touchend(r,c,m),b=this._zoomOut.touchend(r,c,m);return _?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()+1,around:C.unproject(_)},{originalEvent:r})}):b?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()-1,around:C.unproject(b)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const _p={0:1,2:2};class fu{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,c){return!1}_move(r,c){return{}}mousedown(r,c){if(this._lastPoint)return;const m=de(r);this._correctButton(r,m)&&(this._lastPoint=c,this._eventButton=m)}mousemoveWindow(r,c){const m=this._lastPoint;if(m){if(r.preventDefault(),this._eventButton!=null&&function(_,b){const C=_p[b];return _.buttons===void 0||(_.buttons&C)!==C}(r,this._eventButton))this.reset();else if(this._moved||!(c.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(m,c)}}mouseupWindow(r){this._lastPoint&&de(r)===this._eventButton&&(this._moved&&Te(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yp extends fu{mousedown(r,c){super.mousedown(r,c),this._lastPoint&&(this._active=!0)}_correctButton(r,c){return c===0&&!r.ctrlKey}_move(r,c){return{around:c,panDelta:c.sub(r)}}}class Yh extends fu{_correctButton(r,c){return c===0&&r.ctrlKey||c===2}_move(r,c){const m=.8*(c.x-r.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(r){r.preventDefault()}}class Kh extends fu{_correctButton(r,c){return c===0&&r.ctrlKey||c===2}_move(r,c){const m=-.5*(c.y-r.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(r){r.preventDefault()}}class Oa{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),o.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0)}touchstart(r,c,m){return this._calculateTransform(r,c,m)}touchmove(r,c,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!o.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,c,m)}}touchend(r,c,m){this._calculateTransform(r,c,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,c,m){m.length>0&&(this._active=!0);const _=du(m,c),b=new o.pointGeometry(0,0),C=new o.pointGeometry(0,0);let I=0;for(const R in _){const B=_[R],U=this._touches[R];U&&(b._add(B),C._add(B.sub(U)),I++,_[R]=B)}if(this._touches=_,I<this._minTouches||!C.mag())return;const M=C.div(I);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(I),panDelta:M}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class pu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,c,m){return{}}touchstart(r,c,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([c[0],c[1]]))}touchmove(r,c,m){const _=this._firstTwoTouches;if(!_)return;r.preventDefault();const[b,C]=_,I=Vl(m,c,b),M=Vl(m,c,C);if(!I||!M)return;const R=this._aroundCenter?null:I.add(M).div(2);return this._move([I,M],R,r)}touchend(r,c,m){if(!this._firstTwoTouches)return;const[_,b]=this._firstTwoTouches,C=Vl(m,c,_),I=Vl(m,c,b);C&&I||(this._active&&Te(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Vl(f,r,c){for(let m=0;m<f.length;m++)if(f[m].identifier===c)return r[m]}function xp(f,r){return Math.log(f/r)/Math.LN2}class bp extends pu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,c){const m=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(xp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:xp(this._distance,m),pinchAround:c}}}function Jh(f,r){return 180*f.angleWith(r)/Math.PI}class wp extends pu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,c){const m=this._vector;if(this._vector=r[0].sub(r[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Jh(this._vector,m),pinchAround:c}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const c=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const _=Jh(r,m);return Math.abs(_)<c}}function mu(f){return Math.abs(f.y)>Math.abs(f.x)}class gr extends pu{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,mu(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,c,m){const _=this._lastPoints;if(!_)return;const b=r[0].sub(_[0]),C=r[1].sub(_[1]);return this._map._cooperativeGestures&&!o.isFullscreen()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(b,C,m.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(b.y+C.y)/2*-.5})}gestureBeginsVertically(r,c,m){if(this._valid!==void 0)return this._valid;const _=r.mag()>=2,b=c.mag()>=2;if(!_&&!b)return;if(!_||!b)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const C=r.y>0==c.y>0;return mu(r)&&mu(c)&&C}}const Zg={panStep:100,bearingStep:15,pitchStep:10};class Sp{constructor(){const r=Zg;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let c=0,m=0,_=0,b=0,C=0;switch(r.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:r.shiftKey?m=-1:(r.preventDefault(),b=-1);break;case 39:r.shiftKey?m=1:(r.preventDefault(),b=1);break;case 38:r.shiftKey?_=1:(r.preventDefault(),C=-1);break;case 40:r.shiftKey?_=-1:(r.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(m=0,_=0),{cameraAnimation:I=>{const M=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:Wg,zoom:c?Math.round(M)+c*(r.shiftKey?2:1):M,bearing:I.getBearing()+m*this._bearingStep,pitch:I.getPitch()+_*this._pitchStep,offset:[-b*this._panStep,-C*this._panStep],center:I.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Wg(f){return f*(2-f)}const Tp=4.000244140625;class $o{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||o.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=r.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const m=o.exported.now(),_=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,c!==0&&c%Tp==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(_*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),r.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=r,this._delta-=c,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=Y(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const M=this._type==="wheel"&&Math.abs(this._delta)>Tp?this._wheelZoomRate:this._defaultZoomRate;let R=2/(1+Math.exp(-Math.abs(this._delta*M)));this._delta<0&&R!==0&&(R=1/R);const B=c(),U=Math.pow(2,B),W=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):U;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(W*R))),this._type==="wheel"&&(this._startZoom=B,this._easing=this._smoothOutEasing(200)),this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:c(),_=this._startZoom,b=this._easing;let C,I=!1;if(this._type==="wheel"&&_&&b){const M=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),R=b(M);C=o.number(_,m,R),M<1?this._frameId||(this._frameId=!0):I=!0}else C=m,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:C-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let c=o.ease;if(this._prevEase){const m=this._prevEase,_=(o.exported.now()-m.start)/m.duration,b=m.easing(_+.01)-m.easing(_),C=.27/Math.sqrt(b*b+1e-4)*.01,I=Math.sqrt(.0729-C*C);c=o.bezier(C,I,.25,1)}return this._prevEase={start:o.exported.now(),duration:r,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(o.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Ep{constructor(r,c){this._clickZoom=r,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Fa{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,c){return r.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(r.shiftKey?-1:1),around:m.unproject(c)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _o{constructor(){this._tap=new Ba({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,c,m){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=c[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(r,c,m))}touchmove(r,c,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const _=c[0],b=_.y-this._swipePoint.y;return this._swipePoint=_,r.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(r,c,m)}touchend(r,c,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(r,c,m)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gu{constructor(r,c,m){this._el=r,this._mousePan=c,this._touchPan=m}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class $t{constructor(r,c,m){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=c,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Cp{constructor(r,c,m,_){this._el=r,this._touchZoom=c,this._touchRotate=m,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const $l=f=>f.zoom||f.drag||f.pitch||f.rotate;class Nl extends o.Event{}class Ul{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,c){const m=o.sub([],c,r);this.radius=o.length(m[2]<0?o.div([],m,this.constants):[m[0],m[1],0])}projectRay(r){o.div(r,r,this.constants),o.normalize(r,r),o.mul$1(r,r,this.constants);const c=o.scale$2([],r,this.radius);if(c[2]>0){const m=o.scale$2([],[0,0,1],o.dot(c,[0,0,1])),_=o.scale$2([],o.normalize([],[c[0],c[1],0]),this.radius),b=o.add([],c,o.scale$2([],o.sub([],o.add([],_,m),c),2));c[0]=b[0],c[1]=b[1]}return c}}function jl(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class Ip{constructor(r,c){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new cu(r),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ul,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),o.bindAll(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[o.window,"blur",void 0]];for(const[_,b,C]of this._listeners)_.addEventListener(b,_===o.window.document?this.handleWindowEvent:this.handleEvent,C)}destroy(){for(const[r,c,m]of this._listeners)r.removeEventListener(c,r===o.window.document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(r){const c=this._map,m=c.getCanvasContainer();this._add("mapEvent",new gp(c,r));const _=c.boxZoom=new Hh(c,r);this._add("boxZoom",_);const b=new Xh,C=new Fa;c.doubleClickZoom=new Ep(C,b),this._add("tapZoom",b),this._add("clickZoom",C);const I=new _o;this._add("tapDragZoom",I);const M=c.touchPitch=new gr(c);this._add("touchPitch",M);const R=new Yh(r),B=new Kh(r);c.dragRotate=new $t(r,R,B),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]);const U=new yp(r),W=new Oa(c,r);c.dragPan=new gu(m,U,W),this._add("mousePan",U),this._add("touchPan",W,["touchZoom","touchRotate"]);const Q=new wp,J=new bp;c.touchZoomRotate=new Cp(m,J,Q,I),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",J,["touchPan","touchRotate"]),this._add("blockableMapEvent",new hu(c));const ee=c.scrollZoom=new $o(c,this);this._add("scrollZoom",ee,["mousePan"]);const te=c.keyboard=new Sp;this._add("keyboard",te);for(const Z of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[Z]&&c[Z].enable(r[Z])}_add(r,c,m){this._handlers.push({handlerName:r,handler:c,allowed:m}),this._handlersById[r]=c}stop(r){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!$l(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,c,m){for(const _ in r)if(_!==m&&(!c||c.indexOf(_)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const c=[];for(const m of r)this._el.contains(m.target)&&c.push(m);return c}handleEvent(r,c){this._updatingCamera=!0;const m=r.type==="renderFrame",_=m?void 0:r,b={needsRenderFrame:!1},C={},I={},M=r.touches?this._getMapTouches(r.touches):void 0,R=M?_e(this._el,M):m?void 0:Y(this._el,r);for(const{handlerName:W,handler:Q,allowed:J}of this._handlers){if(!Q.isEnabled())continue;let ee;this._blockedByActive(I,J,W)?Q.reset():Q[c||r.type]&&(ee=Q[c||r.type](r,R,M),this.mergeHandlerResult(b,C,ee,W,_),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()),(ee||Q.isActive())&&(I[W]=Q)}const B={};for(const W in this._previousActiveHandlers)I[W]||(B[W]=_);this._previousActiveHandlers=I,(Object.keys(B).length||jl(b))&&(this._changes.push([b,C,B]),this._triggerRenderFrame()),(Object.keys(I).length||jl(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:U}=b;U&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],U(this._map))}mergeHandlerResult(r,c,m,_,b){if(!m)return;o.extend(r,m);const C={handlerName:_,originalEvent:m.originalEvent||b};m.zoomDelta!==void 0&&(c.zoom=C),m.panDelta!==void 0&&(c.drag=C),m.pitchDelta!==void 0&&(c.pitch=C),m.bearingDelta!==void 0&&(c.rotate=C)}_applyChanges(){const r={},c={},m={};for(const[_,b,C]of this._changes)_.panDelta&&(r.panDelta=(r.panDelta||new o.pointGeometry(0,0))._add(_.panDelta)),_.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(r.around=_.around),_.aroundCoord!==void 0&&(r.aroundCoord=_.aroundCoord),_.pinchAround!==void 0&&(r.pinchAround=_.pinchAround),_.noInertia&&(r.noInertia=_.noInertia),o.extend(c,b),o.extend(m,C);this._updateMapTransform(r,c,m),this._changes=[]}_updateMapTransform(r,c,m){const _=this._map,b=_.transform,C=ce=>[ce.x,ce.y,ce.z];if((ce=>{const ae=this._eventsInProgress.drag;return ae&&!this._handlersById[ae.handlerName].isActive()})()&&!jl(r)){const ce=b.zoom;b.cameraElevationReference="sea",b.recenterOnTerrain(),b.cameraElevationReference="ground",ce!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&_._stop(!0),!jl(r))return void this._fireEvents(c,m,!0);let{panDelta:I,zoomDelta:M,bearingDelta:R,pitchDelta:B,around:U,aroundCoord:W,pinchAround:Q}=r;b._isCameraConstrained&&(M>0&&(M=0),b._isCameraConstrained=!1),Q!==void 0&&(U=Q),(M||(ce=>c.drag&&!this._eventsInProgress.drag)())&&U&&(this._dragOrigin=C(b.pointCoordinate3D(U)),this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",_._stop(!0),U=U||_.transform.centerPoint,R&&(b.bearing+=R),B&&(b.pitch+=B),b._updateCameraState();const J=[0,0,0];if(I)if(b.projection.name==="mercator"){const ce=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(U).dir),ae=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(U.sub(I)).dir);J[0]=ae[0]-ce[0],J[1]=ae[1]-ce[1]}else{const ce=b.pointCoordinate(U);if(b.projection.name==="globe"){I=I.rotate(-b.angle);const ae=b._pixelsPerMercatorPixel/b.worldSize;J[0]=-I.x*o.mercatorScale(o.latFromMercatorY(ce.y))*ae,J[1]=-I.y*o.mercatorScale(b.center.lat)*ae}else{const ae=b.pointCoordinate(U.sub(I));ce&&ae&&(J[0]=ae.x-ce.x,J[1]=ae.y-ce.y)}}const ee=b.zoom,te=[0,0,0];if(M){const ce=C(W||b.pointCoordinate3D(U)),ae={dir:o.normalize([],o.sub([],ce,b._camera.position))};if(ae.dir[2]<0){const fe=b.zoomDeltaToMovement(ce,M);o.scale$2(te,ae.dir,fe)}}const Z=o.add(J,J,te);b._translateCameraConstrained(Z),M&&Math.abs(b.zoom-ee)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(c,m,!0)}_fireEvents(r,c,m){const _=$l(this._eventsInProgress),b=$l(r),C={};for(const B in r){const{originalEvent:U}=r[B];this._eventsInProgress[B]||(C[`${B}start`]=U),this._eventsInProgress[B]=r[B]}!_&&b&&this._fireEvent("movestart",b.originalEvent);for(const B in C)this._fireEvent(B,C[B]);b&&this._fireEvent("move",b.originalEvent);for(const B in r){const{originalEvent:U}=r[B];this._fireEvent(B,U)}const I={};let M;for(const B in this._eventsInProgress){const{handlerName:U,originalEvent:W}=this._eventsInProgress[B];this._handlersById[U].isActive()||(delete this._eventsInProgress[B],M=c[U]||W,I[`${B}end`]=M)}for(const B in I)this._fireEvent(B,I[B]);const R=$l(this._eventsInProgress);if(m&&(_||b)&&!R){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),U=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;B?(U(B.bearing||this._map.getBearing())&&(B.bearing=0),this._map.easeTo(B,{originalEvent:M})):(this._map.fire(new o.Event("moveend",{originalEvent:M})),U(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,c){this._map.fire(new o.Event(r,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new Nl("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Qh="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ap extends o.Evented{constructor(r,c){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=c.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,c){return this.jumpTo({center:r},c)}panBy(r,c,m){return r=o.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,o.extend({offset:r},c),m)}panTo(r,c,m){return this.easeTo(o.extend({center:r},c),m)}getZoom(){return this.transform.zoom}setZoom(r,c){return this.jumpTo({zoom:r},c),this}zoomTo(r,c,m){return this.easeTo(o.extend({zoom:r},c),m)}zoomIn(r,c){return this.zoomTo(this.getZoom()+1,r,c),this}zoomOut(r,c){return this.zoomTo(this.getZoom()-1,r,c),this}getBearing(){return this.transform.bearing}setBearing(r,c){return this.jumpTo({bearing:r},c),this}getPadding(){return this.transform.padding}setPadding(r,c){return this.jumpTo({padding:r},c),this}rotateTo(r,c,m){return this.easeTo(o.extend({bearing:r},c),m)}resetNorth(r,c){return this.rotateTo(0,o.extend({duration:1e3},r),c),this}resetNorthPitch(r,c){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},r),c),this}snapToNorth(r,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,c):this}getPitch(){return this.transform.pitch}setPitch(r,c){return this.jumpTo({pitch:r},c),this}cameraForBounds(r,c){r=o.LngLatBounds.convert(r);const m=c&&c.bearing||0,_=c&&c.pitch||0,b=r.getNorthWest(),C=r.getSouthEast();return this._cameraForBounds(this.transform,b,C,m,_,c)}_extendCameraOptions(r){const c={top:0,bottom:0,right:0,left:0};if(typeof(r=o.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=="number"){const m=r.padding;r.padding={top:m,bottom:m,right:m,left:m}}return r.padding=o.extend(c,r.padding),r}_minimumAABBFrustumDistance(r,c){const m=c.max[0]-c.min[0],_=c.max[1]-c.min[1];return m/_>r.aspect?m/(2*Math.tan(.5*r.fovX)*r.aspect):_/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,c,m,_,b,C){const I=r.clone(),M=this._extendCameraOptions(C);I.bearing=_,I.pitch=b;const R=o.LngLat.convert(c),B=o.LngLat.convert(m),U=.5*(R.lat+B.lat),W=.5*(R.lng+B.lng),Q=o.latLngToECEF(U,W),J=o.normalize([],Q),ee=o.normalize([],o.cross([],J,[0,1,0])),te=o.cross([],ee,J),Z=[ee[0],ee[1],ee[2],0,te[0],te[1],te[2],0,J[0],J[1],J[2],0,0,0,0,1],ce=[Q,o.latLngToECEF(R.lat,R.lng),o.latLngToECEF(B.lat,R.lng),o.latLngToECEF(B.lat,B.lng),o.latLngToECEF(R.lat,B.lng),o.latLngToECEF(U,R.lng),o.latLngToECEF(U,B.lng),o.latLngToECEF(R.lat,W),o.latLngToECEF(B.lat,W)];let ae=o.Aabb.fromPoints(ce.map(lt=>[o.dot(ee,lt),o.dot(te,lt),o.dot(J,lt)]));const fe=o.transformMat4([],ae.center,Z);o.squaredLength(fe)===0&&o.set(fe,0,0,1),o.normalize(fe,fe),o.scale$2(fe,fe,o.GLOBE_RADIUS),I.center=o.ecefToLatLng(fe);const Ce=I.getWorldToCameraMatrix(),we=o.invert(new Float64Array(16),Ce);ae=o.Aabb.applyTransform(ae,o.multiply([],Ce,Z)),o.transformMat4(fe,fe,Ce);const Ae=.5*(ae.max[2]-ae.min[2]),Be=this._minimumAABBFrustumDistance(I,ae),Ne=o.scale$2([],[0,0,1],Ae),Ge=o.add(Ne,fe,Ne),bt=Be+(I.pitch===0?0:o.distance(fe,Ge)),Fe=I.globeCenterInViewSpace,rt=o.sub([],fe,[Fe[0],Fe[1],Fe[2]]);o.normalize(rt,rt),o.scale$2(rt,rt,bt);const He=o.add([],fe,rt);o.transformMat4(He,He,we);const ht=o.earthRadius/o.GLOBE_RADIUS,Ue=o.length(He),Le=o.mercatorZfromAltitude(Math.max(Ue*ht-o.earthRadius,Number.EPSILON),0),Ze=Math.min(I.zoomFromMercatorZAdjusted(Le),M.maxZoom);return Ze>.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"mercator"}),I.zoom=Ze,this._cameraForBounds(I,c,m,_,b,C)):{center:I.center,zoom:Ze,bearing:_,pitch:b}}queryTerrainElevation(r,c){const m=this.transform.elevation;return m?(c=o.extend({},{exaggerated:!0},c),m.getAtPoint(o.MercatorCoordinate.fromLngLat(r),null,c.exaggerated)):null}_cameraForBounds(r,c,m,_,b,C){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,c,m,_,b,C);const I=r.clone(),M=this._extendCameraOptions(C),R=I.padding;I.bearing=_,I.pitch=b;const B=o.LngLat.convert(c),U=o.LngLat.convert(m),W=new o.LngLat(B.lng,U.lat),Q=new o.LngLat(U.lng,B.lat),J=I.project(B),ee=I.project(U),te=this.queryTerrainElevation(B),Z=this.queryTerrainElevation(U),ce=this.queryTerrainElevation(W),ae=this.queryTerrainElevation(Q),fe=[[J.x,J.y,Math.min(te||0,Z||0,ce||0,ae||0)],[ee.x,ee.y,Math.max(te||0,Z||0,ce||0,ae||0)]];let Ce=o.Aabb.fromPoints(fe);const we=I.getWorldToCameraMatrix(),Ae=o.invert(new Float64Array(16),we);Ce=o.Aabb.applyTransform(Ce,we);const Be=o.sub([],Ce.max,Ce.min),Ne=R.left||0,Ge=R.right||0,bt=R.bottom||0,Fe=R.top||0,{left:rt,right:He,top:ht,bottom:Ue}=M.padding,Le=.5*(Ne+Ge),Ze=.5*(Fe+bt),lt=Math.min(I.scaleZoom(I.scale*Math.min((I.width-(Ne+Ge+rt+He))/Be[0],(I.height-(bt+Fe+Ue+ht))/Be[1])),M.maxZoom),mt=I.scale/I.zoomScale(lt);Ce=new o.Aabb([Ce.min[0]-(rt+Le)*mt,Ce.min[1]-(Ue+Ze)*mt,Ce.min[2]],[Ce.max[0]+(He+Le)*mt,Ce.max[1]+(ht+Ze)*mt,Ce.max[2]]);const Wt=.5*Be[2],mn=this._minimumAABBFrustumDistance(I,Ce),Ut=[0,0,1,0];o.transformMat4$1(Ut,Ut,we),o.normalize$2(Ut,Ut);const Ft=o.scale$2([],Ut,mn+Wt),Ht=o.add([],Ce.center,Ft),En=(typeof M.offset.x=="number"&&typeof M.offset.y=="number"?new o.pointGeometry(M.offset.x,M.offset.y):o.pointGeometry.convert(M.offset)).rotate(-o.degToRad(_));Ce.center[0]-=En.x*mt,Ce.center[1]+=En.y*mt,o.transformMat4(Ce.center,Ce.center,Ae),o.transformMat4(Ht,Ht,Ae);const Qt=[Ce.center[0],Ce.center[1],Ht[2]*I.pixelsPerMeter];o.scale$2(Qt,Qt,1/I.worldSize);const Zn=o.lngFromMercatorX(Qt[0]),ei=o.latFromMercatorY(Qt[1]),ai=Math.min(I._zoomFromMercatorZ(Qt[2]),M.maxZoom),ii=new o.LngLat(Zn,ei);return I.mercatorFromTransition&&ai<.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"globe"}),I.zoom=ai,this._cameraForBounds(I,c,m,_,b,C)):{center:ii,zoom:ai,bearing:_,pitch:b}}fitBounds(r,c,m){const _=this.cameraForBounds(r,c);return this._fitInternal(_,c,m)}fitScreenCoordinates(r,c,m,_,b){const C=o.pointGeometry.convert(r),I=o.pointGeometry.convert(c),M=new o.pointGeometry(Math.min(C.x,I.x),Math.min(C.y,I.y)),R=new o.pointGeometry(Math.max(C.x,I.x),Math.max(C.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(C,I))return this;const B=this.transform.pointLocation3D(M),U=this.transform.pointLocation3D(R),W=this.transform.pointLocation3D(new o.pointGeometry(M.x,R.y)),Q=this.transform.pointLocation3D(new o.pointGeometry(R.x,M.y)),J=[Math.min(B.lng,U.lng,W.lng,Q.lng),Math.min(B.lat,U.lat,W.lat,Q.lat)],ee=[Math.max(B.lng,U.lng,W.lng,Q.lng),Math.max(B.lat,U.lat,W.lat,Q.lat)],te=_&&_.pitch?_.pitch:this.getPitch(),Z=this._cameraForBounds(this.transform,J,ee,m,te,_);return this._fitInternal(Z,_,b)}_fitInternal(r,c,m){return r?(delete(c=o.extend(r,c)).padding,c.linear?this.easeTo(c,m):this.flyTo(c,m)):this}jumpTo(r,c){this.stop();const m=r.preloadOnly?this.transform.clone():this.transform;let _=!1,b=!1,C=!1;return"zoom"in r&&m.zoom!==+r.zoom&&(_=!0,m.zoom=+r.zoom),r.center!==void 0&&(m.center=o.LngLat.convert(r.center)),"bearing"in r&&m.bearing!==+r.bearing&&(b=!0,m.bearing=+r.bearing),"pitch"in r&&m.pitch!==+r.pitch&&(C=!0,m.pitch=+r.pitch),r.padding==null||m.isPaddingEqual(r.padding)||(m.padding=r.padding),r.preloadOnly?(this._preloadTiles(m),this):(this.fire(new o.Event("movestart",c)).fire(new o.Event("move",c)),_&&this.fire(new o.Event("zoomstart",c)).fire(new o.Event("zoom",c)).fire(new o.Event("zoomend",c)),b&&this.fire(new o.Event("rotatestart",c)).fire(new o.Event("rotate",c)).fire(new o.Event("rotateend",c)),C&&this.fire(new o.Event("pitchstart",c)).fire(new o.Event("pitch",c)).fire(new o.Event("pitchend",c)),this.fire(new o.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.warnOnce(Qh),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,c){const m=this.transform;if(!m.projection.supportsFreeCamera)return o.warnOnce(Qh),this;this.stop();const _=m.zoom,b=m.pitch,C=m.bearing;m.setFreeCameraOptions(r);const I=_!==m.zoom,M=b!==m.pitch,R=C!==m.bearing;return this.fire(new o.Event("movestart",c)).fire(new o.Event("move",c)),I&&this.fire(new o.Event("zoomstart",c)).fire(new o.Event("zoom",c)).fire(new o.Event("zoomend",c)),R&&this.fire(new o.Event("rotatestart",c)).fire(new o.Event("rotate",c)).fire(new o.Event("rotateend",c)),M&&this.fire(new o.Event("pitchstart",c)).fire(new o.Event("pitch",c)).fire(new o.Event("pitchend",c)),this.fire(new o.Event("moveend",c)),this}easeTo(r,c){this._stop(!1,r.easeId),((r=o.extend({offset:[0,0],duration:500,easing:o.ease},r)).animate===!1||!r.essential&&o.exported.prefersReducedMotion)&&(r.duration=0);const m=this.transform,_=this.getZoom(),b=this.getBearing(),C=this.getPitch(),I=this.getPadding(),M="zoom"in r?+r.zoom:_,R="bearing"in r?this._normalizeBearing(r.bearing,b):b,B="pitch"in r?+r.pitch:C,U="padding"in r?r.padding:m.padding,W=o.pointGeometry.convert(r.offset);let Q,J,ee;if(m.projection.name==="globe"){const Ne=o.MercatorCoordinate.fromLngLat(m.center),Ge=W.rotate(-m.angle);Ne.x+=Ge.x/m.worldSize,Ne.y+=Ge.y/m.worldSize;const bt=Ne.toLngLat(),Fe=o.LngLat.convert(r.center||bt);this._normalizeCenter(Fe),Q=m.centerPoint.add(Ge),J=new o.pointGeometry(Ne.x,Ne.y).mult(m.worldSize),ee=new o.pointGeometry(o.mercatorXfromLng(Fe.lng),o.mercatorYfromLat(Fe.lat)).mult(m.worldSize).sub(J)}else{Q=m.centerPoint.add(W);const Ne=m.pointLocation(Q),Ge=o.LngLat.convert(r.center||Ne);this._normalizeCenter(Ge),J=m.project(Ne),ee=m.project(Ge).sub(J)}const te=m.zoomScale(M-_);let Z,ce;r.around&&(Z=o.LngLat.convert(r.around),ce=m.locationPoint(Z));const ae=this._zooming||M!==_,fe=this._rotating||b!==R,Ce=this._pitching||B!==C,we=!m.isPaddingEqual(U),Ae=Ne=>Ge=>{if(ae&&(Ne.zoom=o.number(_,M,Ge)),fe&&(Ne.bearing=o.number(b,R,Ge)),Ce&&(Ne.pitch=o.number(C,B,Ge)),we&&(Ne.interpolatePadding(I,U,Ge),Q=Ne.centerPoint.add(W)),Z)Ne.setLocationAtPoint(Z,ce);else{const bt=Ne.zoomScale(Ne.zoom-_),Fe=M>_?Math.min(2,te):Math.max(.5,te),rt=Math.pow(Fe,1-Ge),He=Ne.unproject(J.add(ee.mult(Ge*rt)).mult(bt));Ne.setLocationAtPoint(Ne.renderWorldCopies?He.wrap():He,Q)}return r.preloadOnly||this._fireMoveEvents(c),Ne};if(r.preloadOnly){const Ne=this._emulate(Ae,r.duration,m);return this._preloadTiles(Ne),this}const Be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ae,this._rotating=fe,this._pitching=Ce,this._padding=we,this._easeId=r.easeId,this._prepareEase(c,r.noMoveStart,Be),this._ease(Ae(m),Ne=>{m.recenterOnTerrain(),this._afterEase(c,Ne)},r),this}_prepareEase(r,c,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||m.moving||this.fire(new o.Event("movestart",r)),this._zooming&&!m.zooming&&this.fire(new o.Event("zoomstart",r)),this._rotating&&!m.rotating&&this.fire(new o.Event("rotatestart",r)),this._pitching&&!m.pitching&&this.fire(new o.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new o.Event("move",r)),this._zooming&&this.fire(new o.Event("zoom",r)),this._rotating&&this.fire(new o.Event("rotate",r)),this._pitching&&this.fire(new o.Event("pitch",r))}_afterEase(r,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,_=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new o.Event("zoomend",r)),_&&this.fire(new o.Event("rotateend",r)),b&&this.fire(new o.Event("pitchend",r)),this.fire(new o.Event("moveend",r))}flyTo(r,c){if(!r.essential&&o.exported.prefersReducedMotion){const lt=o.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(lt,c)}this.stop(),r=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},r);const m=this.transform,_=this.getZoom(),b=this.getBearing(),C=this.getPitch(),I=this.getPadding(),M="zoom"in r?o.clamp(+r.zoom,m.minZoom,m.maxZoom):_,R="bearing"in r?this._normalizeBearing(r.bearing,b):b,B="pitch"in r?+r.pitch:C,U="padding"in r?r.padding:m.padding,W=m.zoomScale(M-_),Q=o.pointGeometry.convert(r.offset);let J=m.centerPoint.add(Q);const ee=m.pointLocation(J),te=o.LngLat.convert(r.center||ee);this._normalizeCenter(te);const Z=m.project(ee),ce=m.project(te).sub(Z);let ae=r.curve;const fe=Math.max(m.width,m.height),Ce=fe/W,we=ce.mag();if("minZoom"in r){const lt=o.clamp(Math.min(r.minZoom,_,M),m.minZoom,m.maxZoom),mt=fe/m.zoomScale(lt-_);ae=Math.sqrt(mt/we*2)}const Ae=ae*ae;function Be(lt){const mt=(Ce*Ce-fe*fe+(lt?-1:1)*Ae*Ae*we*we)/(2*(lt?Ce:fe)*Ae*we);return Math.log(Math.sqrt(mt*mt+1)-mt)}function Ne(lt){return(Math.exp(lt)-Math.exp(-lt))/2}function Ge(lt){return(Math.exp(lt)+Math.exp(-lt))/2}const bt=Be(0);let Fe=function(lt){return Ge(bt)/Ge(bt+ae*lt)},rt=function(lt){return fe*((Ge(bt)*(Ne(mt=bt+ae*lt)/Ge(mt))-Ne(bt))/Ae)/we;var mt},He=(Be(1)-bt)/ae;if(Math.abs(we)<1e-6||!isFinite(He)){if(Math.abs(fe-Ce)<1e-6)return this.easeTo(r,c);const lt=Ce<fe?-1:1;He=Math.abs(Math.log(Ce/fe))/ae,rt=function(){return 0},Fe=function(mt){return Math.exp(lt*ae*mt)}}r.duration="duration"in r?+r.duration:1e3*He/("screenSpeed"in r?+r.screenSpeed/ae:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const ht=b!==R,Ue=B!==C,Le=!m.isPaddingEqual(U),Ze=lt=>mt=>{const Wt=mt*He,mn=1/Fe(Wt);lt.zoom=mt===1?M:_+lt.scaleZoom(mn),ht&&(lt.bearing=o.number(b,R,mt)),Ue&&(lt.pitch=o.number(C,B,mt)),Le&&(lt.interpolatePadding(I,U,mt),J=lt.centerPoint.add(Q));const Ut=mt===1?te:lt.unproject(Z.add(ce.mult(rt(Wt))).mult(mn));return lt.setLocationAtPoint(lt.renderWorldCopies?Ut.wrap():Ut,J),lt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(c),lt};if(r.preloadOnly){const lt=this._emulate(Ze,r.duration,m);return this._preloadTiles(lt),this}return this._zooming=!0,this._rotating=ht,this._pitching=Ue,this._padding=Le,this._prepareEase(c,!1),this._ease(Ze(m),()=>this._afterEase(c),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,c)}if(!r){const m=this.handlers;m&&m.stop(!1)}return this}_ease(r,c,m){m.animate===!1||m.duration===0?(r(1),c()):(this._easeStart=o.exported.now(),this._easeOptions=m,this._onEaseFrame=r,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,c){r=o.wrap(r,-180,180);const m=Math.abs(r-c);return Math.abs(r-360-c)<m&&(r-=360),Math.abs(r+360-c)<m&&(r+=360),r}_normalizeCenter(r){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const m=r.lng-c.center.lng;r.lng+=m>180?-360:m<-180?360:0}_emulate(r,c,m){const _=Math.ceil(15*c/1e3),b=[],C=r(m.clone());for(let I=0;I<=_;I++){const M=C(I/_);b.push(M.clone())}return b}}class ed{constructor(r={}){this.options=r,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const c=this.options&&this.options.compact;return this._map=r,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L("button","mapboxgl-ctrl-attrib-button",this._container),L("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(r,c){const m=this._map._getUIString(`AttributionControl.${c}`);r.setAttribute("aria-label",m),r.removeAttribute("title"),r.firstElementChild&&r.firstElementChild.setAttribute("title",m)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(r){const m=c.reduce((_,b,C)=>(b.value&&(_+=`${b.key}=${b.value}${C<c.length-1?"&":""}`),_),"?");r.href=`${o.config.FEEDBACK_URL}/${m}#${Zh(this._map,!0)}`,r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const c=this._map.style._sourceCaches;for(const _ in c){const b=c[_];if(b.used){const C=b.getSource();C.attribution&&r.indexOf(C.attribution)<0&&r.push(C.attribution)}}r.sort((_,b)=>_.length-b.length),r=r.filter((_,b)=>{for(let C=b+1;C<r.length;C++)if(r[C].indexOf(_)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const m=r.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,r.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class td{constructor(){o.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=L("div","mapboxgl-ctrl");const c=L("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const c in r){const m=r[c].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const c=r[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class Gl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const c=++this._id;return this._queue.push({callback:r,id:c,cancelled:!1}),c}remove(r){const c=this._currentlyRunning,m=c?this._queue.concat(c):this._queue;for(const _ of m)if(_.id===r)return void(_.cancelled=!0)}run(r=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const m of c)if(!m.cancelled&&(m.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function vu(f,r,c){if(f=new o.LngLat(f.lng,f.lat),r){const m=new o.LngLat(f.lng-360,f.lat),_=new o.LngLat(f.lng+360,f.lat),b=360*Math.ceil(Math.abs(f.lng-c.center.lng)/360),C=c.locationPoint(f).distSqr(r),I=r.x<0||r.y<0||r.x>c.width||r.y>c.height;c.locationPoint(m).distSqr(r)<C&&(I||Math.abs(m.lng-c.center.lng)<b)?f=m:c.locationPoint(_).distSqr(r)<C&&(I||Math.abs(_.lng-c.center.lng)<b)&&(f=_)}for(;Math.abs(f.lng-c.center.lng)>180;){const m=c.locationPoint(f);if(m.x>=0&&m.y>=0&&m.x<=c.width&&m.y<=c.height)break;f.lng>c.center.lng?f.lng-=360:f.lng+=360}return f}const Va={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class _u extends o.Evented{constructor(r,c){if(super(),(r instanceof o.window.HTMLElement||c)&&(r=o.extend({element:r},c)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=o.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=L("div");const _=41,b=27,C=O("svg",{display:"block",height:_*this._scale+"px",width:b*this._scale+"px",viewBox:`0 0 ${b} ${_}`},this._element),I=O("radialGradient",{id:"shadowGradient"},O("defs",{},C));O("stop",{offset:"10%","stop-opacity":.4},I),O("stop",{offset:"100%","stop-opacity":.05},I),O("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},C),O("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},C),O("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},C),O("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},C),this._offset=o.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",_=>{_.preventDefault()}),this._element.addEventListener("mousedown",_=>{_.preventDefault()});const m=this._element.classList;for(const _ in Va)m.remove(`mapboxgl-marker-anchor-${_}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=o.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const c=r.code,m=r.charCode||r.keyCode;c!=="Space"&&c!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(r){const c=r.originalEvent.target,m=this._element;this._popup&&(c===m||m.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,c=this._pos;if(!r||!c)return!1;const m=r.unproject(c),_=r.getFreeCameraOptions();if(!_.position)return!1;const b=_.position.toLngLat();return b.distanceTo(m)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const c=this._pos;if(!c||c.x<0||c.x>r.transform.width||c.y<0||c.y>r.transform.height)return void this._clearFadeTimer();const m=r.unproject(c);let _;r._showingGlobe()&&o.isLngLatBehindGlobe(r.transform,this._lngLat)?_=0:(_=1-r._queryFogOpacity(m),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(_*=this._occludedOpacity)),this._element.style.opacity=`${_}`,this._element.style.pointerEvents=_>0?"auto":"none",this._popup&&this._popup._setOpacity(_),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${Va[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${c.x}px,${c.y}px)
        `}_calculateXYTransform(){const r=this._pos,c=this._map,m=this.getPitchAlignment();if(!c||!r||m!=="map")return"";if(!c._showingGlobe()){const M=c.getPitch();return M?`rotateX(${M}deg)`:""}const _=o.radToDeg(o.globeTiltAtLngLat(c.transform,this._lngLat)),b=r.sub(o.globeCenterToScreenPoint(c.transform)),C=Math.abs(b.x)+Math.abs(b.y);if(C===0)return"";const I=_/C;return`rotateX(${-b.y*I}deg) rotateY(${b.x*I}deg)`}_calculateZTransform(){const r=this._pos,c=this._map;if(!c||!r)return"";let m=0;const _=this.getRotationAlignment();if(_==="map")if(c._showingGlobe()){const b=c.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),C=c.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);m=o.radToDeg(Math.atan2(C.y,C.x))-90}else m=-c.getBearing();else if(_==="horizon"){const b=o.smoothstep(4,6,c.getZoom()),C=o.globeCenterToScreenPoint(c.transform);C.y+=b*c.transform.height;const I=r.sub(C),M=o.radToDeg(Math.atan2(I.y,I.x));m=(M>90?M-270:M+90)*(1-b)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(r){o.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=vu(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),r===!0?this._updateFrameId=o.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=o.pointGeometry.convert(r),this._update(),this}_onMove(r){const c=this._map;if(!c)return;const m=this._pointerdownPos,_=this._positionDelta;if(m&&_){if(!this._isDragging){const b=this._clickTolerance||c._clickTolerance;if(r.point.dist(m)<b)return;this._isDragging=!0}this._pos=r.point.sub(_),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(r){const c=this._map,m=this._pos;c&&m&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(m),this._pointerdownPos=r.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const c=this._map;return c&&(r?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const kp={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Mp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function nd(f=new o.pointGeometry(0,0),r="bottom"){if(typeof f=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(r){case"top":return new o.pointGeometry(0,f);case"top-left":return new o.pointGeometry(c,c);case"top-right":return new o.pointGeometry(-c,c);case"bottom":return new o.pointGeometry(0,-f);case"bottom-left":return new o.pointGeometry(c,-c);case"bottom-right":return new o.pointGeometry(-c,-c);case"left":return new o.pointGeometry(f,0);case"right":return new o.pointGeometry(-f,0)}return new o.pointGeometry(0,0)}return f instanceof o.pointGeometry||Array.isArray(f)?o.pointGeometry.convert(f):o.pointGeometry.convert(f[r]||[0,0])}class Pp{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const c=o.easeCubicInOut((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,c,m){this._start=this.getValue(c),this._end=r,this._startTime=c,this._endTime=c+m}}const zp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Lp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},id={showCompass:!0,showZoom:!0,visualizePitch:!1};class Dp{constructor(r,c,m=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Yh({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,m&&(this.mousePitch=new Kh({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(r,c){this.mouseRotate.mousedown(r,c),this.mousePitch&&this.mousePitch.mousedown(r,c),se()}move(r,c){const m=this.map,_=this.mouseRotate.mousemoveWindow(r,c),b=_&&_.bearingDelta;if(b&&m.setBearing(m.getBearing()+b),this.mousePitch){const C=this.mousePitch.mousemoveWindow(r,c),I=C&&C.pitchDelta;I&&m.setPitch(m.getPitch()+I)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){he(),o.window.removeEventListener("mousemove",this.mousemove),o.window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(o.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),Y(this.element,r)),o.window.addEventListener("mousemove",this.mousemove),o.window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,Y(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=_e(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=_e(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Rp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Bp={maxWidth:100,unit:"metric"};function Op(f,r,c){const m=yu(r),_=m/r,b={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[c];this._map._requestDomTask(()=>{this._container.style.width=f*_+"px",this._container.innerHTML=`${m}&nbsp;${b}`})}function yu(f){const r=Math.pow(10,`${Math.floor(f)}`.length-1);let c=f/r;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:c>=1?1:function(m){const _=Math.pow(10,Math.ceil(-Math.log(m)/Math.LN10));return Math.round(m*_)/_}(c),r*c}const ql={version:o.version,supported:E,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends Ap{constructor(f){if(o.LivePerformanceUtils.mark(o.PerformanceMarkers.create),(f=o.extend({},Lp,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&o.isSafariWithAntialiasingBug(o.window)&&(f.antialias=!1,o.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Bt(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._useWebGL2=f.useWebGL2,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._optimizeForTerrain=f.optimizeForTerrain,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new Gl,this._domRenderTaskQueue=new Gl,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.uniqueId(),this._locale=o.extend({},zp,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Pp(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new o.RequestManager(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,typeof f.container=="string"){if(this._container=o.window.document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof o.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&o.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1),o.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Ip(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,f.style&&this.setStyle(f.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this._hash=f.hash&&new pp(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,o.extend({},f.fitBoundsOptions,{duration:0})))),this.resize(),f.attributionControl&&this.addControl(new ed({customAttribution:f.customAttribution})),this._logoControl=new td,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new o.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new o.Event(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(f,r){if(r===void 0&&(r=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=f.onAdd(this);this._controls.push(f);const m=this._controlPositions[r];return r.indexOf("bottom")!==-1?m.insertBefore(c,m.firstChild):m.appendChild(c),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(f);return r>-1&&this._controls.splice(r,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new o.Event("movestart",f)).fire(new o.Event("move",f)),this.fire(new o.Event("resize",f)),r&&this.fire(new o.Event("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(o.LngLatBounds.convert(f)),this._update()}setMinZoom(f){if((f=f==null?-2:f)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f==null?22:f)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f==null?0:f)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f==null?85:f)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?o.window.navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(r=>r==="auto"?o.window.navigator.language:r):f}setLanguage(f){const r=this._parseLanguage(f);if(!this.style||r===this._language)return this;this._language=r,this.style._reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,r=f.projection.name;let c;r==="globe"&&f.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?(f.setMercatorFromTransition(),c=!0):r==="mercator"&&f.zoom<o.GLOBE_ZOOM_THRESHOLD_MAX&&(f.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,r){return this._updateProjection(f||r||{name:"mercator"})}_updateProjection(f){let r;if(r=f.name==="globe"&&this.transform.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),r){this.painter.clearBackgroundTiles();for(const c in this.style._sourceCaches)this.style._sourceCaches[c].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(f){return this.transform.locationPoint3D(o.LngLat.convert(f))}unproject(f){return this.transform.pointLocation3D(o.pointGeometry.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,r,c){if(f==="mouseenter"||f==="mouseover"){let m=!1;const _=C=>{const I=r.filter(R=>this.getLayer(R)),M=I.length?this.queryRenderedFeatures(C.point,{layers:I}):[];M.length?m||(m=!0,c.call(this,new nr(f,this,C.originalEvent,{features:M}))):m=!1},b=()=>{m=!1};return{layers:new Set(r),listener:c,delegates:{mousemove:_,mouseout:b}}}if(f==="mouseleave"||f==="mouseout"){let m=!1;const _=C=>{const I=r.filter(M=>this.getLayer(M));(I.length?this.queryRenderedFeatures(C.point,{layers:I}):[]).length?m=!0:m&&(m=!1,c.call(this,new nr(f,this,C.originalEvent)))},b=C=>{m&&(m=!1,c.call(this,new nr(f,this,C.originalEvent)))};return{layers:new Set(r),listener:c,delegates:{mousemove:_,mouseout:b}}}{const m=_=>{const b=r.filter(I=>this.getLayer(I)),C=b.length?this.queryRenderedFeatures(_.point,{layers:b}):[];C.length&&(_.features=C,c.call(this,_),delete _.features)};return{layers:new Set(r),listener:c,delegates:{[f]:m}}}}on(f,r,c){if(c===void 0)return super.on(f,r);Array.isArray(r)||(r=[r]);const m=this._createDelegatedListener(f,r,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(m);for(const _ in m.delegates)this.on(_,m.delegates[_]);return this}once(f,r,c){if(c===void 0)return super.once(f,r);Array.isArray(r)||(r=[r]);const m=this._createDelegatedListener(f,r,c);for(const _ in m.delegates)this.once(_,m.delegates[_]);return this}off(f,r,c){if(c===void 0)return super.off(f,r);r=new Set(Array.isArray(r)?r:[r]);const m=(b,C)=>{if(b.size!==C.size)return!1;for(const I of b)if(!C.has(I))return!1;return!0},_=this._delegatedListeners?this._delegatedListeners[f]:void 0;return _&&(b=>{for(let C=0;C<b.length;C++){const I=b[C];if(I.listener===c&&m(I.layers,r)){for(const M in I.delegates)this.off(M,I.delegates[M]);return b.splice(C,1),this}}})(_),this}queryRenderedFeatures(f,r){return this.style?(r!==void 0||f===void 0||f instanceof o.pointGeometry||Array.isArray(f)||(r=f,f=void 0),this.style.queryRenderedFeatures(f=f||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}querySourceFeatures(f,r){return this.style.querySourceFeatures(f,r)}setStyle(f,r){return(r=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&f?(this._diffStyle(f,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(f,r))}_getUIString(f){const r=this._locale[f];if(r==null)throw new Error(`Missing UI string '${f}'`);return r}_updateStyle(f,r){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f&&(this.style=new Wr(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f):this.style.loadJSON(f)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Wr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,r){if(typeof f=="string"){const c=this._requestManager.normalizeStyleURL(f),m=this._requestManager.transformRequest(c,o.ResourceType.Style);o.getJSON(m,(_,b)=>{_?this.fire(new o.ErrorEvent(_)):b&&this._updateDiff(b,r)})}else typeof f=="object"&&this._updateDiff(f,r)}_updateDiff(f,r){try{this.style.setState(f)&&this._update(!0)}catch(c){o.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(f,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.warnOnce("There is no style added to the map."),!1)}addSource(f,r){return this._lazyInitEmptyStyle(),this.style.addSource(f,r),this._update(!0)}isSourceLoaded(f){return!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){const f=this.style&&this.style._sourceCaches;for(const r in f){const c=f[r]._tiles;for(const m in c){const _=c[m];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}addSourceType(f,r,c){this._lazyInitEmptyStyle(),this.style.addSourceType(f,r,c)}removeSource(f){return this.style.removeSource(f),this._updateTerrain(),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,r,{pixelRatio:c=1,sdf:m=!1,stretchX:_,stretchY:b,content:C}={}){if(this._lazyInitEmptyStyle(),r instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&r instanceof o.window.ImageBitmap){const{width:I,height:M,data:R}=o.exported.getImageData(r);this.style.addImage(f,{data:new o.RGBAImage({width:I,height:M},R),pixelRatio:c,stretchX:_,stretchY:b,content:C,sdf:m,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:M}=r,R=r;this.style.addImage(f,{data:new o.RGBAImage({width:I,height:M},new Uint8Array(R.data)),pixelRatio:c,stretchX:_,stretchY:b,content:C,sdf:m,version:0,userImage:R}),R.onAdd&&R.onAdd(this,f)}}updateImage(f,r){const c=this.style.getImage(f);if(!c)return void this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=r instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&r instanceof o.window.ImageBitmap?o.exported.getImageData(r):r,{width:_,height:b}=m;_!==void 0&&b!==void 0?_===c.data.width&&b===c.data.height?(c.data.replace(m.data,!(r instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&r instanceof o.window.ImageBitmap)),this.style.updateImage(f,c)):this.fire(new o.ErrorEvent(new Error(`The width and height of the updated image (${_}, ${b})
                must be that same as the previous version of the image
                (${c.data.width}, ${c.data.height})`))):this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,r){o.getImage(this._requestManager.transformRequest(f,o.ResourceType.Image),(c,m)=>{r(c,m instanceof o.window.HTMLImageElement?o.exported.getImageData(m):m)})}listImages(){return this.style.listImages()}addLayer(f,r){return this._lazyInitEmptyStyle(),this.style.addLayer(f,r),this._update(!0)}moveLayer(f,r){return this.style.moveLayer(f,r),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}setLayerZoomRange(f,r,c){return this.style.setLayerZoomRange(f,r,c),this._update(!0)}setFilter(f,r,c={}){return this.style.setFilter(f,r,c),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,r,c,m={}){return this.style.setPaintProperty(f,r,c,m),this._update(!0)}getPaintProperty(f,r){return this.style.getPaintProperty(f,r)}setLayoutProperty(f,r,c,m={}){return this.style.setLayoutProperty(f,r,c,m),this._update(!0)}getLayoutProperty(f,r){return this.style.getLayoutProperty(f,r)}setLight(f,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,r),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.LngLat.convert(f),this.transform):0}setFeatureState(f,r){return this.style.setFeatureState(f,r),this._update()}removeFeatureState(f,r){return this.style.removeFeatureState(f,r),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let c,m,_,b=this._container;for(;b&&(!m||!_);){const C=o.window.getComputedStyle(b).transform;C&&C!=="none"&&(c=C.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&c[0]!=="0"&&c[0]!=="1"&&(m=c[0]),c[3]&&c[3]!=="0"&&c[3]!=="1"&&(_=c[3])),b=b.parentElement}this._containerWidth=m?Math.abs(f/m):f,this._containerHeight=_?Math.abs(r/_):r}_detectMissingCSS(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=L("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=L("div","mapboxgl-canvas-container",f);this._interactive&&r.classList.add("mapboxgl-interactive"),this._canvas=L("canvas","mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=L("div","mapboxgl-control-container",f),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{m[_]=L("div",`mapboxgl-ctrl-${_}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,r){const c=o.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(f),this._canvas.height=c*Math.ceil(r),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${r}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const r=this._markers.indexOf(f);r!==-1&&this._markers.splice(r,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const r=this._popups.indexOf(f);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const f=o.extend({},E.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._useWebGL2&&this._canvas.getContext("webgl2",f),c=r||this._canvas.getContext("webgl",f)||this._canvas.getContext("experimental-webgl",f);c?(this._useWebGL2&&!r&&o.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),o.storeAuthState(c,!0),this.painter=new Ll(c,this.transform,!!r),this.on("data",m=>{m.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.exported$1.testSupport(c)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let r;const c=this.painter.context.extTimerQuery,m=o.exported.now();if(this.listens("gpu-timing-frame")&&(r=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],o.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],o.window.performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const _=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,M=this.transform.pitch,R=o.exported.now(),B=new o.EvaluationParameters(I,{now:R,fadeDuration:_,pitch:M,transition:this.style.getTransition()});this.style.update(B)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let b=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),b=this._updateAverageElevation(m),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):b=this._updateAverageElevation(m),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,_,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:_,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const I=o.exported.now()-m;c.endQueryEXT(c.TIME_ELAPSED_EXT,r),setTimeout(()=>{const M=c.getQueryObjectEXT(r,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(r),this.fire(new o.Event("gpu-timing-frame",{cpuTime:I,gpuTime:M})),o.window.performance.mark("frame-gpu",{startTime:m,detail:{gpuTime:M}})},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const M=this.painter.queryGpuTimers(I);this.fire(new o.Event("gpu-timing-layer",{layerTimes:M}))},50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const M=this.painter.queryGpuTimeDeferredRender(I);this.fire(new o.Event("gpu-timing-deferred-render",{gpuTime:M}))},50)}const C=this._sourcesDirty||this._styleDirty||this._placementDirty||b;if(C||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(b=this._updateAverageElevation(m,!0)),b)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new o.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const M=this._calculateSpeedIndex();this.fire(new o.Event("speedindexcompleted",{speedIndex:M})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||C||(this._fullyLoaded=!0,o.LivePerformanceUtils.mark(o.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&o.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const r of this._markers)f&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!f||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(f,r=!1){const c=m=>(this.transform.averageElevation=m,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);if((r||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const m=this.transform.averageElevation;let _=this.transform.sampleAverageElevation(),b=!1;this.transform.elevation&&(b=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(_)?_=0:this._averageElevationLastSampledAt=f;const C=Math.abs(m-_);if(C>1){if(this._isInitialLoad||b)return this._averageElevation.jumpTo(_),c(_);this._averageElevation.easeTo(_,f,300)}else if(C>1e-4)return this._averageElevation.jumpTo(_),c(_)}return!!this._averageElevation.isEasing(f)&&c(this._averageElevation.getValue(f))}_authenticate(){o.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===o.AUTH_ERR_MSG||f.status===401)){const r=this.painter.context.gl;o.storeAuthState(r,!1),this._logoControl instanceof td&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),o.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const c=this.painter.context.gl,m=c.createFramebuffer();function _(b){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,b,0);const C=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,C),C}return c.bindFramebuffer(c.FRAMEBUFFER,m),this._canvasPixelComparison(_(f),r.canvasCopies.map(_),r.timeStamps)}_canvasPixelComparison(f,r,c){let m=c[1]-c[0];const _=f.length/4;for(let b=0;b<r.length;b++){const C=r[b];let I=0;for(let M=0;M<C.length;M+=4)C[M]===f[M]&&C[M+1]===f[M+1]&&C[M+2]===f[M+2]&&C[M+3]===f[M+3]&&(I+=1);m+=(c[b+2]-c[b+1])*(1-I/_)}return m}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1),o.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),o.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=o.exported.frame(r=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(r)}))}_preloadTiles(f){const r=this.style?Object.values(this.style._sourceCaches):[];return o.asyncAll(r,(c,m)=>c._preloadTiles(f,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){o.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,f&&this._update())}_setCacheLimits(f,r){o.setCacheLimits(f,r)}get version(){return o.version}},NavigationControl:class{constructor(f){this.options=o.extend({},id,f),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),L("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),L("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:r}):c.resetNorth({},{originalEvent:r}))}),this._compassIcon=L("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const r=f.getZoom(),c=r===f.getMaxZoom(),m=r===f.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Dp(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,r){const c=L("button",f,this._container);return c.type="button",c.addEventListener("click",r),c}_setButtonTitle(f,r){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${r}`);f.setAttribute("aria-label",c),f.firstElementChild&&f.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends o.Evented{constructor(f){super(),this.options=o.extend({geolocation:o.window.navigator.geolocation},Rp,f),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Hr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const r=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,f(c)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(c=>r(c.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(f){const r=this._map.getMaxBounds(),c=f.coords;return!!r&&(c.longitude<r.getWest()||c.longitude>r.getEast()||c.latitude<r.getSouth()||c.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",f)),this._finish()}}_updateCamera(f){const r=new o.LngLat(f.coords.longitude,f.coords.latitude),c=f.coords.accuracy,m=this._map.getBearing(),_=o.extend({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(c),_,{geolocateSource:!0})}_updateMarker(f){if(f){const r=new o.LngLat(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,r=o.mercatorZfromAltitude(1,f._center.lat)*f.worldSize,c=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=L("button","mapboxgl-ctrl-geolocate",this._container),L("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L("div","mapboxgl-user-location"),this._dotElement.appendChild(L("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(L("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new _u({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=L("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new _u({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{o.window.addEventListener("ondeviceorientationabsolute"in o.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};o.window.DeviceMotionEvent!==void 0&&typeof o.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),o.window.removeEventListener("deviceorientation",this._onDeviceOrientation),o.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:ed,ScaleControl:class{constructor(f){this.options=o.extend({},Bp,f),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Op.bind(this)),o.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,r=this._map,c=r._containerHeight/2,m=r._containerWidth/2-f/2,_=r.unproject([m,c]),b=r.unproject([m+f,c]),C=_.distanceTo(b);if(this.options.unit==="imperial"){const I=3.2808*C;I>5280?this._setScale(f,I/5280,"mile"):this._setScale(f,I,"foot")}else this.options.unit==="nautical"?this._setScale(f,C/1852,"nautical-mile"):C>=1e3?this._setScale(f,C/1e3,"kilometer"):this._setScale(f,C,"meter")}_setScale(f,r,c){const m=yu(r),_=m/r;this._map._requestDomTask(()=>{this._container.style.width=f*_+"px",this._container.innerHTML=c!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:c}).format(m):`${m}&nbsp;nm`})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f){this._fullscreen=!1,f&&f.container&&(f.container instanceof o.window.HTMLElement?this._container=f.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in o.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!o.window.document.fullscreenEnabled&&!o.window.document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=L("button","mapboxgl-ctrl-fullscreen",this._controlContainer);L("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(o.window.document.fullscreenElement||o.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.Evented{constructor(f){super(),this.options=o.extend(Object.create(kp),f),o.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=o.LngLat.convert(f),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(o.window.document.createTextNode(f))}setHTML(f){const r=o.window.document.createDocumentFragment(),c=o.window.document.createElement("body");let m;for(c.innerHTML=f;m=c.firstChild,m;)r.appendChild(m);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=L("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(f),this.options.closeButton){const c=this._closeButton=L("button","mapboxgl-popup-close-button",r);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let r;return this._classList.delete(f)?r=!1:(this._classList.add(f),r=!0),this._updateClassList(),r}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const r=this._map,c=this._container,m=this._pos;if(!r||!c||!m)return"bottom";const _=c.offsetWidth,b=c.offsetHeight,C=m.x<_/2,I=m.x>r.transform.width-_/2;if(m.y+f<b)return C?"top-left":I?"top-right":"top";if(m.y>r.transform.height-b){if(C)return"bottom-left";if(I)return"bottom-right"}return C?"left":I?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),f.className=r.join(" ")}_update(f){const r=this._map,c=this._content;if(!r||!this._lngLat&&!this._trackPointer||!c)return;let m=this._container;if(m||(m=this._container=L("div","mapboxgl-popup",r.getContainer()),this._tip=L("div","mapboxgl-popup-tip",m),m.appendChild(c)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=vu(this._lngLat,this._pos,r.transform)),!this._trackPointer||f){const _=this._pos=this._trackPointer&&f?f:r.project(this._lngLat),b=nd(this.options.offset),C=this._anchor=this._getAnchor(b.y),I=nd(this.options.offset,C),M=_.add(I).round();r._requestDomTask(()=>{this._container&&C&&(this._container.style.transform=`${Va[C]} translate(${M.x}px,${M.y}px)`)})}if(!this._marker&&r._showingGlobe()){const _=o.isLngLatBehindGlobe(r.transform,this._lngLat)?0:1;this._setOpacity(_)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Mp);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:_u,Style:Wr,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,FreeCameraOptions:su,Evented:o.Evented,config:o.config,prewarm:function(){cn().acquire(en)},clearPrewarmedResources:function(){const f=Yt;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(en),Yt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(f){o.config.ACCESS_TOKEN=f},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(f){o.config.API_URL=f},get workerCount(){return Jt.workerCount},set workerCount(f){Jt.workerCount=f},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){o.config.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){o.clearTileCache(f)},workerUrl:"",workerClass:null,setNow:o.exported.setNow,restoreNow:o.exported.restoreNow};return ql});var x=d;return x})})(s0);const ul=s0.exports,lD=rA({__proto__:null,default:ul},[s0.exports]),Ei=Symbol(),cD=Ln({__name:"Map",props:{accessToken:null,options:null},emits:["loaded"],setup(e,{expose:s,emit:a}){const u=e;ul.accessToken=u.accessToken;const d=Si(),g=Si(),x=Ke(!1),o=ne(()=>g.value);return s({map:o}),Ni(Ei,o),Ye(()=>{var w;return(w=u.options)==null?void 0:w.center},w=>{!g.value||!w||g.value.flyTo({center:w})}),Ye(()=>{var w;return(w=u.options)==null?void 0:w.zoom},w=>{!g.value||w===void 0||g.value.flyTo({zoom:w})}),Ye(()=>{var w;return(w=u.options)==null?void 0:w.pitch},w=>{!g.value||w===void 0||g.value.flyTo({pitch:w})}),Ye(()=>{var w;return(w=u.options)==null?void 0:w.bearing},w=>{!g.value||w===void 0||g.value.flyTo({bearing:w})}),Ye(()=>{var w;return(w=u.options)==null?void 0:w.bounds},w=>{!g.value||!w||g.value.fitBounds(w)}),Ye(()=>{var w;return(w=u.options)==null?void 0:w.maxZoom},w=>{!g.value||w===void 0||g.value.setMaxZoom(w)}),Ye(()=>{var w;return(w=u.options)==null?void 0:w.minZoom},w=>{!g.value||w===void 0||g.value.setMinZoom(w)}),Ye(()=>{var w;return(w=u.options)==null?void 0:w.maxBounds},w=>{!g.value||!w||g.value.setMaxBounds(w)}),Ye(()=>{var w;return(w=u.options)==null?void 0:w.maxPitch},w=>{!g.value||w===void 0||g.value.setMaxPitch(w)}),Ye(()=>{var w;return(w=u.options)==null?void 0:w.minPitch},w=>{!g.value||w===void 0||g.value.setMinPitch(w)}),Ye(()=>{var w;return(w=u.options)==null?void 0:w.style},w=>{var E;!g.value||!w||(w instanceof Object?(E=g.value)==null||E.setStyle(w,{diff:!0}):g.value.setStyle(w))}),Ye(()=>{var w;return(w=u.options)==null?void 0:w.projection},w=>{!g.value||g.value.setProjection(w)}),kn(()=>{d.value&&(g.value=new ul.Map({container:d.value,style:"mapbox://styles/mapbox/streets-v11",center:[120,30],zoom:2,...u.options}),g.value.on("load",()=>{a("loaded"),x.value=!0}))}),pr(()=>{g.value&&g.value.remove()}),(w,E)=>(Xi(),es(On,null,[Sc("div",{ref_key:"mapRef",ref:d,style:{position:"absolute",height:"100%",width:"100%"}},null,512),x.value?Af(w.$slots,"default",{key:0}):Zk("",!0)],64))}}),uD=Ln({__name:"Sprite",props:{name:null,url:null},setup(e){const s=e,a=ln(Ei,void 0),u=()=>{if(!a)return;const d=a.value.hasImage(s.name);typeof s.url=="string"?a.value.loadImage(s.url,(g,x)=>{g||!x||(d?a.value.updateImage(s.name,x):a.value.addImage(s.name,x))}):d?a.value.updateImage(s.name,s.url):a.value.addImage(s.name,s.url)};return Ye(()=>s.url,u),kn(u),pr(()=>{a&&a.value.hasImage(s.name)&&a.value.removeImage(s.name)}),(d,g)=>null}});function Pm(e,s,a){const u=()=>{e.value&&e.value.removeEventListener(s,a)};Ye(e,d=>{u(),d&&d.addEventListener(s,a)}),Ti(()=>{u()})}function oi(e,s,a,u){kn(()=>{e.on(s,a,u)}),Ti(()=>{e.off(s,a,u)})}function T2(e,s,a){let u;const d=()=>{!u||u.disconnect()};Ye(e,g=>{d(),g&&(u=new MutationObserver(a),u.observe(g,s))}),pr(()=>{d()})}const hD=Ln({__name:"Marker",props:{center:null,options:null},emits:["click","mouseenter","mousemove","mouseleave","update:center"],setup(e,{emit:s}){const a=e,u=Si(),d=ln(Ei,void 0),g=Ke(),x=()=>{if(!d||!a.center)return;const E=a.options||{};g.value.innerHTML&&(E.element=g.value),u.value=new ul.Marker(E).setLngLat(a.center),u.value.addTo(d.value),u.value.on("dragend",w)},o=()=>{!d||!u.value||(u.value.off("dragend",w),u.value.remove(),u.value=void 0)},w=()=>{if(!u.value)return;const{lng:E,lat:k}=u.value.getLngLat();s("update:center",[E,k])};return T2(g.value,{attributes:!0,childList:!0,subtree:!0},()=>{x()}),Pm(ne(()=>{var E;return(E=u.value)==null?void 0:E.getElement()}),"click",E=>{s("click",E)}),Pm(ne(()=>{var E;return(E=u.value)==null?void 0:E.getElement()}),"mouseenter",E=>{s("mouseenter",E)}),Pm(ne(()=>{var E;return(E=u.value)==null?void 0:E.getElement()}),"mousemove",E=>{s("mousemove",E)}),Pm(ne(()=>{var E;return(E=u.value)==null?void 0:E.getElement()}),"mouseleave",E=>{s("mouseleave",E)}),Ye(()=>a.center,()=>{a.center?u.value?u.value.setLngLat(a.center):x():o()}),Ye(()=>{var E;return(E=a.options)==null?void 0:E.offset},E=>{!u.value||!E||u.value.setOffset(E)}),Ye(()=>{var E;return(E=a.options)==null?void 0:E.draggable},E=>{!u.value||E===void 0||u.value.setDraggable(E)}),Ye(()=>{var E;return(E=a.options)==null?void 0:E.scale},()=>{!u.value||(o(),x())}),Ye(()=>{var E;return(E=a.options)==null?void 0:E.rotation},E=>{!u.value||E===void 0||u.value.setRotation(E)}),Ye(()=>{var E;return(E=a.options)==null?void 0:E.color},()=>{!u.value||(o(),x())}),Ye(()=>{var E;return(E=a.options)==null?void 0:E.anchor},()=>{!u.value||(o(),x())}),Ye(()=>{var E;return(E=a.options)==null?void 0:E.rotationAlignment},E=>{!u.value||!E||u.value.setRotationAlignment(E)}),Ye(()=>{var E;return(E=a.options)==null?void 0:E.pitchAlignment},E=>{var k;E&&((k=u.value)==null||k.setPitchAlignment(E))}),kn(()=>{x()}),pr(()=>{o()}),(E,k)=>(Xi(),es("div",{ref_key:"elRef",ref:g},[Af(E.$slots,"default")],512))}}),dD=Ln({__name:"Popup",props:{visible:{type:Boolean},center:null,options:null},emits:["update:visible"],setup(e,{emit:s}){const a=e,u=ln(Ei,void 0),d=Si(),g=Ke();T2(ne(()=>g.value),{attributes:!0,childList:!0,subtree:!0,characterData:!0},()=>{a.visible&&d.value&&g.value&&d.value.setHTML(g.value.innerHTML)});const x=()=>{!u||!a.center||!a.visible||!g.value||(d.value=new ul.Popup(a.options||{}).setLngLat(a.center).setHTML(g.value.innerHTML).addTo(u.value),d.value.on("close",w))},o=()=>{d.value&&(d.value.off("close",w),d.value.remove())};Ye(()=>a.visible,()=>{o(),a.visible&&x()}),Ye(()=>a.center,()=>{!u||!d.value||!a.visible||(a.center?d.value.setLngLat(a.center).addTo(u.value):o())}),Ye(()=>{var E;return(E=a.options)==null?void 0:E.anchor},E=>{!d.value||!a.visible||E&&(o(),x())}),Ye(()=>{var E;return(E=a.options)==null?void 0:E.offset},E=>{!d.value||!a.visible||E&&d.value.setOffset(E)}),Ye(()=>{var E;return(E=a.options)==null?void 0:E.maxWidth},E=>{!d.value||!a.visible||E&&d.value.setMaxWidth(E)});const w=()=>{s("update:visible",!1)};return kn(()=>{x()}),pr(()=>{o()}),(E,k)=>(Xi(),es("div",{style:{display:"none"},ref_key:"popupRef",ref:g},[Af(E.$slots,"default")],512))}}),fD=Ln({__name:"Fog",props:{color:null,range:null},setup(e){const s=e,a=ln(Ei,void 0),u=()=>{if(!a)return;const d={};Object.keys(s).forEach(g=>{s[g]!==void 0&&(d[g]=s[g])}),a.value.setFog(d)};return Ye(()=>s.color,()=>u()),Ye(()=>s["horizon-blend"],()=>u()),Ye(()=>s["high-color"],()=>u()),Ye(()=>s["space-color"],()=>u()),Ye(()=>s["star-intensity"],()=>u()),Ye(()=>s.range,()=>u()),kn(()=>{u()}),pr(()=>{!a||a.value.setFog()}),(d,g)=>null}}),pD=Ln({__name:"FeatureState",props:{feature:null,state:null},setup(e){const s=e,a=ln(Ei,void 0),u=(g,x)=>{!a||!g.id||a.value.setFeatureState(g,x)},d=g=>{!a||!g.id||a.value.removeFeatureState(g)};return Ye(()=>s.feature,(g,x)=>{d(x),u(g,s.state)}),Ye(()=>s.state,g=>{u(s.feature,g)}),kn(()=>{u(s.feature,s.state)}),pr(()=>{d(s.feature)}),(g,x)=>null}}),mD=Ln({__name:"AttributionControl",props:{compact:{type:Boolean},customAttribution:null,position:null},setup(e){const s=e,a=Si(),u=ln(Ei,void 0);return kn(()=>{!u||(a.value=new ul.AttributionControl({compact:s.compact||!1,customAttribution:s.customAttribution}),u.value.addControl(a.value,s.position||"bottom-right"))}),pr(()=>{!u||!a.value||u.value.removeControl(a.value)}),(d,g)=>null}}),gD=Ln({__name:"NavigationControl",props:{showCompass:{type:Boolean},showZoom:{type:Boolean},visualizePitch:{type:Boolean},position:null},setup(e){const s=e,a=Si(),u=ln(Ei,void 0);return kn(()=>{!u||(a.value=new ul.NavigationControl({showCompass:s.showCompass||!0,showZoom:s.showZoom||!0,visualizePitch:s.visualizePitch||!1}),u.value.addControl(a.value,s.position||"top-left"))}),pr(()=>{!u||!a.value||u.value.removeControl(a.value)}),(d,g)=>null}}),vD=Ln({__name:"ScaleControl",props:{maxWidth:null,unit:null,position:null},setup(e){const s=e,a=Si(),u=ln(Ei,void 0);return Ye(()=>s.unit,()=>{s.unit&&a.value.setUnit(s.unit)}),kn(()=>{var d;!u||(a.value=new ul.ScaleControl({maxWidth:(d=s.maxWidth)!=null?d:100,unit:s.unit||"metric"}),u.value.addControl(a.value,s.position||"top-right"))}),pr(()=>{!u||!a.value||u.value.removeControl(a.value)}),(d,g)=>null}});function rr(e,s,a){for(const u in e)u in s&&e[u]===s[u]||a(u,e[u]);for(const u in s)u in e||a(u,void 0)}const _D=Ln({__name:"BackgroundLayer",props:{id:null,sourceLayer:null,paint:null,layout:null},setup(e){const s=e,a=Si(),u=ln(Ei,void 0),d=(x,o)=>{!u||u.value.setPaintProperty(s.id,x,o)},g=(x,o)=>{!u||u.value.setLayoutProperty(s.id,x,o)};return Ye(()=>({...s.paint}),(x,o)=>{rr(x,o,d)},{deep:!1}),Ye(()=>({...s.layout}),(x,o)=>{rr(x,o,g)},{deep:!1}),kn(()=>{!u||(u.value.addLayer({id:s.id,type:"background",paint:s.paint||{},layout:s.layout||{}},s.sourceLayer),a.value=u.value.getLayer(s.id))}),Ti(()=>{!u||!a.value||u.value.removeLayer(s.id)}),(x,o)=>null}}),yD=Ln({__name:"CircleLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:s}){const a=e,u=Si(),d=ln(Ei,void 0);d!=null&&d.value&&(oi(d.value,"click",a.id,w=>{s("click",w)}),oi(d.value,"mouseenter",a.id,w=>{s("mouseenter",w)}),oi(d.value,"mousemove",a.id,w=>{s("mousemove",w)}),oi(d.value,"mouseleave",a.id,w=>{s("mouseleave",w)}));const g=(w,E)=>{!d||!u.value||d.value.setPaintProperty(a.id,w,E)},x=(w,E)=>{!d||!u.value||d.value.setLayoutProperty(a.id,w,E)},o=()=>{var w,E;!d||!u.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ye(()=>({...a.paint}),(w,E)=>{rr(w,E,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,E)=>{rr(w,E,x)},{deep:!1}),Ye(()=>a.minzoom,o),Ye(()=>a.maxzoom,o),Ye(()=>a.filter,()=>{!d||!u.value||d.value.setFilter(a.id,a.filter)}),kn(()=>{var w,E;if(!d)return;const k={type:"circle",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(k.filter=a.filter),a.sourceLayer&&(k["source-layer"]=a.sourceLayer),d.value.addLayer(k),u.value=d.value.getLayer(a.id)}),Ti(()=>{!d||!u.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),xD=Ln({__name:"FillExtrusionLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:s}){const a=e,u=Si(),d=ln(Ei,void 0);d&&(oi(d.value,"click",a.id,w=>{s("click",w)}),oi(d.value,"mouseenter",a.id,w=>{s("mouseenter",w)}),oi(d.value,"mousemove",a.id,w=>{s("mousemove",w)}),oi(d.value,"mouseleave",a.id,w=>{s("mouseleave",w)}));const g=(w,E)=>{!d||!u.value||d.value.setPaintProperty(a.id,w,E)},x=(w,E)=>{!d||!u.value||d.value.setLayoutProperty(a.id,w,E)},o=()=>{var w,E;!d||!u.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ye(()=>({...a.paint}),(w,E)=>{rr(w,E,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,E)=>{rr(w,E,x)},{deep:!1}),Ye(()=>a.minzoom,o),Ye(()=>a.maxzoom,o),Ye(()=>a.filter,()=>{!d||!u.value||d.value.setFilter(a.id,a.filter)}),kn(()=>{var w,E;if(!d)return;const k={type:"fill-extrusion",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(k.filter=a.filter),a.sourceLayer&&(k["source-layer"]=a.sourceLayer),d.value.addLayer(k),u.value=d.value.getLayer(a.id)}),Ti(()=>{!d||!u.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),bD=Ln({__name:"FillLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:s}){const a=e,u=Si(),d=ln(Ei,void 0);d&&(oi(d.value,"click",a.id,w=>{s("click",w)}),oi(d.value,"mouseenter",a.id,w=>{s("mouseenter",w)}),oi(d.value,"mousemove",a.id,w=>{s("mousemove",w)}),oi(d.value,"mouseleave",a.id,w=>{s("mouseleave",w)}));const g=(w,E)=>{!d||!u.value||d.value.setPaintProperty(a.id,w,E)},x=(w,E)=>{!d||!u.value||d.value.setLayoutProperty(a.id,w,E)},o=()=>{var w,E;!d||!u.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ye(()=>({...a.paint}),(w,E)=>{rr(w,E,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,E)=>{rr(w,E,x)},{deep:!1}),Ye(()=>a.minzoom,o),Ye(()=>a.maxzoom,o),Ye(()=>a.filter,()=>{!d||!u.value||d.value.setFilter(a.id,a.filter)}),kn(()=>{var w,E;if(!d)return;const k={type:"fill",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(k.filter=a.filter),a.sourceLayer&&(k["source-layer"]=a.sourceLayer),d.value.addLayer(k),u.value=d.value.getLayer(a.id)}),Ti(()=>{!d||!u.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),wD=Ln({__name:"HeatmapLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:s}){const a=e,u=Si(),d=ln(Ei,void 0);d&&(oi(d.value,"click",a.id,w=>{s("click",w)}),oi(d.value,"mouseenter",a.id,w=>{s("mouseenter",w)}),oi(d.value,"mousemove",a.id,w=>{s("mousemove",w)}),oi(d.value,"mouseleave",a.id,w=>{s("mouseleave",w)}));const g=(w,E)=>{!d||!u.value||d.value.setPaintProperty(a.id,w,E)},x=(w,E)=>{!d||!u.value||d.value.setLayoutProperty(a.id,w,E)},o=()=>{var w,E;!d||!u.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ye(()=>({...a.paint}),(w,E)=>{rr(w,E,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,E)=>{rr(w,E,x)},{deep:!1}),Ye(()=>a.minzoom,o),Ye(()=>a.maxzoom,o),Ye(()=>a.filter,()=>{!d||!u.value||d.value.setFilter(a.id,a.filter)}),kn(()=>{var w,E;if(!d)return;const k={type:"heatmap",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(k.filter=a.filter),a.sourceLayer&&(k["source-layer"]=a.sourceLayer),d.value.addLayer(k),u.value=d.value.getLayer(a.id)}),Ti(()=>{!d||!u.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),SD=Ln({__name:"HillshadeLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:s}){const a=e,u=Si(),d=ln(Ei,void 0);d&&(oi(d.value,"click",a.id,w=>{s("click",w)}),oi(d.value,"mouseenter",a.id,w=>{s("mouseenter",w)}),oi(d.value,"mousemove",a.id,w=>{s("mousemove",w)}),oi(d.value,"mouseleave",a.id,w=>{s("mouseleave",w)}));const g=(w,E)=>{!d||!u.value||d.value.setPaintProperty(a.id,w,E)},x=(w,E)=>{!d||!u.value||d.value.setLayoutProperty(a.id,w,E)},o=()=>{var w,E;!d||!u.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ye(()=>({...a.paint}),(w,E)=>{rr(w,E,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,E)=>{rr(w,E,x)},{deep:!1}),Ye(()=>a.minzoom,o),Ye(()=>a.maxzoom,o),Ye(()=>a.filter,()=>{!d||!u.value||d.value.setFilter(a.id,a.filter)}),kn(()=>{var w,E;if(!d)return;const k={type:"hillshade",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(k.filter=a.filter),a.sourceLayer&&(k["source-layer"]=a.sourceLayer),d.value.addLayer(k),u.value=d.value.getLayer(a.id)}),Ti(()=>{!d||!u.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),TD=Ln({__name:"LineLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:s}){const a=e,u=Si(),d=ln(Ei,void 0);d&&(oi(d.value,"click",a.id,w=>{s("click",w)}),oi(d.value,"mouseenter",a.id,w=>{s("mouseenter",w)}),oi(d.value,"mousemove",a.id,w=>{s("mousemove",w)}),oi(d.value,"mouseleave",a.id,w=>{s("mouseleave",w)}));const g=(w,E)=>{!d||!u.value||d.value.setPaintProperty(a.id,w,E)},x=(w,E)=>{!d||!u.value||d.value.setLayoutProperty(a.id,w,E)},o=()=>{var w,E;!d||!u.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ye(()=>({...a.paint}),(w,E)=>{rr(w,E,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,E)=>{rr(w,E,x)},{deep:!1}),Ye(()=>a.minzoom,o),Ye(()=>a.maxzoom,o),Ye(()=>a.filter,()=>{!d||!u.value||d.value.setFilter(a.id,a.filter)}),kn(()=>{var w,E;if(!d)return;const k={type:"line",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(k.filter=a.filter),a.sourceLayer&&(k["source-layer"]=a.sourceLayer),d.value.addLayer(k),u.value=d.value.getLayer(a.id)}),Ti(()=>{d&&u.value&&d.value.removeLayer(a.id)}),(w,E)=>null}}),ED=Ln({__name:"RasterLayer",props:{id:null,source:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:s}){const a=e,u=Si(),d=ln(Ei,void 0);d&&(oi(d.value,"click",a.id,w=>{s("click",w)}),oi(d.value,"mouseenter",a.id,w=>{s("mouseenter",w)}),oi(d.value,"mousemove",a.id,w=>{s("mousemove",w)}),oi(d.value,"mouseleave",a.id,w=>{s("mouseleave",w)}));const g=(w,E)=>{!d||!u.value||d.value.setPaintProperty(a.id,w,E)},x=(w,E)=>{!d||!u.value||d.value.setLayoutProperty(a.id,w,E)},o=()=>{var w,E;!d||!u.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ye(()=>({...a.paint}),(w,E)=>{rr(w,E,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,E)=>{rr(w,E,x)},{deep:!1}),Ye(()=>a.minzoom,o),Ye(()=>a.maxzoom,o),Ye(()=>a.filter,()=>{!d||!u.value||d.value.setFilter(a.id,a.filter)}),kn(()=>{var w,E;if(!d)return;const k={type:"raster",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(k.filter=a.filter),d.value.addLayer(k),u.value=d.value.getLayer(a.id)}),Ti(()=>{!d||!u.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),CD=Ln({__name:"SymbolLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:s}){const a=e,u=Si(),d=ln(Ei,void 0);d&&(oi(d.value,"click",a.id,w=>{s("click",w)}),oi(d.value,"mouseenter",a.id,w=>{s("mouseenter",w)}),oi(d.value,"mousemove",a.id,w=>{s("mousemove",w)}),oi(d.value,"mouseleave",a.id,w=>{s("mouseleave",w)}));const g=(w,E)=>{!d||!u.value||d.value.setPaintProperty(a.id,w,E)},x=(w,E)=>{!d||!u.value||d.value.setLayoutProperty(a.id,w,E)},o=()=>{var w,E;!d||!u.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(E=a.maxzoom)!=null?E:24)};return Ye(()=>({...a.paint}),(w,E)=>{rr(w,E,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,E)=>{rr(w,E,x)},{deep:!1}),Ye(()=>a.minzoom,o),Ye(()=>a.maxzoom,o),Ye(()=>a.filter,()=>{!d||!u.value||d.value.setFilter(a.id,a.filter)}),kn(()=>{var w,E;if(!d)return;const k={type:"symbol",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(E=a.maxzoom)!=null?E:24};a.filter&&(k.filter=a.filter),a.sourceLayer&&(k["source-layer"]=a.sourceLayer),d.value.addLayer(k),u.value=d.value.getLayer(a.id)}),Ti(()=>{!d||!u.value||d.value.removeLayer(a.id)}),(w,E)=>null}}),ID=Ln({__name:"SkyLayer",props:{id:null,paint:null,layout:null},setup(e){const s=e,a=Si(),u=ln(Ei,void 0),d=(x,o)=>{!u||u.value.setPaintProperty(s.id,x,o)},g=(x,o)=>{!u||u.value.setLayoutProperty(s.id,x,o)};return Ye(()=>({...s.paint}),(x,o)=>{rr(x,o,d)},{deep:!1}),Ye(()=>({...s.layout}),(x,o)=>{rr(x,o,g)},{deep:!1}),kn(()=>{!u||(u.value.addLayer({id:s.id,type:"sky",paint:s.paint||{},layout:s.layout||{}}),a.value=u.value.getLayer(s.id))}),Ti(()=>{!u||!a.value||u.value.removeLayer(s.id)}),(x,o)=>null}}),AD=Ln({__name:"GeoSource",props:{id:null,data:null,attribution:null,buffer:null,cluster:{type:Boolean},clusterMaxZoom:null,clusterMinPoints:null,clusterProperties:null,clusterRadius:null,filter:{type:[Boolean,Array,null]},generateId:{type:Boolean},lineMetrics:{type:Boolean},maxzoom:null,protomteId:null,tolerance:null},setup(e){const s=e,a=Si(),u=ln(Ei,void 0);return Ye(()=>s.data,d=>{!u||!d||!a.value||a.value.setData(d)},{deep:!0}),kn(()=>{if(!u)return;const d={type:"geojson",data:s.data};s.buffer!==void 0&&(d.buffer=s.buffer),s.generateId&&(d.generateId=s.generateId),s.lineMetrics&&(d.lineMetrics=s.lineMetrics),s.maxzoom!==void 0&&(d.maxzoom=s.maxzoom),s.tolerance!==void 0&&(d.tolerance=s.tolerance),s.filter&&(d.filter=s.filter),s.attribution&&(d.attribution=s.attribution),s.protomteId&&(d.promoteId=s.protomteId),s.cluster&&(d.cluster=s.cluster,s.clusterMaxZoom&&(d.clusterMaxZoom=s.clusterMaxZoom),s.clusterMinPoints&&(d.clusterMinPoints=s.clusterMinPoints),s.clusterProperties&&(d.clusterProperties=s.clusterProperties),s.clusterRadius&&(d.clusterRadius=s.clusterRadius)),u.value.addSource(s.id,d),a.value=u.value.getSource(s.id)}),pr(()=>{!u||!a.value||u.value.removeSource(s.id)}),(d,g)=>null}}),kD=Ln({__name:"RasterSource",props:{id:null,url:null,tiles:null,tileSize:null,scheme:null,attribution:null,bounds:null,minzoom:null,maxzoom:null},setup(e){const s=e,a=Si(),u=ln(Ei,void 0),d=()=>{!u||(u.value.style._sourceCaches[`other:${s.id}`].clearTiles(),u.value.style._sourceCaches[`other:${s.id}`].update(u.value.transform),u.value.triggerRepaint())};return Ye(()=>s.url,g=>{!g||!a.value||(a.value.url=g,d())}),Ye(()=>s.tiles,g=>{s.url||!g||!a.value||(a.value.tiles=g,d())}),kn(()=>{if(!u)return;const g={id:s.id,type:"raster",scheme:s.scheme||"xyz",tileSize:s.tileSize||256,attribution:s.attribution||"",bounds:s.bounds||[-180,-85.051129,180,85.051129],minzoom:s.minzoom||0,maxzoom:s.maxzoom||22};s.tiles&&(g.tiles=s.tiles),s.url&&(delete g.tiles,g.url=s.url),(g.url||g.tiles)&&(u.value.addSource(s.id,g),a.value=u.value.getSource(s.id))}),pr(()=>{!u||!a.value||u.value.removeSource(s.id)}),(g,x)=>null}}),MD=Ln({__name:"RasterDemSource",props:{id:null,url:null,tiles:null,tileSize:null,attribution:null,bounds:null,minzoom:null,maxzoom:null,exaggeration:null,encoding:null,volatile:{type:Boolean}},setup(e){const s=e,a=Si(),u=ln(Ei,void 0);return kn(()=>{if(!u)return;const d={id:s.id,type:"raster-dem",tileSize:s.tileSize||256,attribution:s.attribution||"",bounds:s.bounds||[-180,-85.051129,180,85.051129],minzoom:s.minzoom||0,maxzoom:s.maxzoom||22};s.tiles&&(d.tiles=s.tiles),s.url&&(delete d.tiles,d.url=s.url),(d.url||d.tiles)&&(u.value.addSource(s.id,d),a.value=u.value.getSource(s.id),u.value.setTerrain({source:s.id,exaggeration:s.exaggeration||1}))}),pr(()=>{!u||!a.value||(u.value.setTerrain(),u.value.removeSource(s.id))}),(d,g)=>null}}),PD=Ln({__name:"VectorSource",props:{id:null,url:null,tiles:null,promoteId:null,scheme:null,attribution:null,bounds:null,minzoom:null,maxzoom:null,volatile:{type:Boolean}},setup(e){const s=e,a=Si(),u=ln(Ei,void 0);return Ye(()=>s.url,d=>{d&&a.value.setUrl(d)}),Ye(()=>s.tiles,d=>{d&&!s.url&&a.value.setTiles(d)}),kn(()=>{if(!u)return;const d={id:s.id,type:"vector",scheme:s.scheme||"xyz",attribution:s.attribution||"",bounds:s.bounds||[-180,-85.051129,180,85.051129],minzoom:s.minzoom||0,maxzoom:s.maxzoom||22};s.promoteId&&(d.promoteId=s.promoteId),s.tiles&&(d.tiles=s.tiles),s.url&&(delete d.tiles,d.url=s.url),(d.url||d.tiles)&&(u.value.addSource(s.id,d),a.value=u.value.getSource(s.id))}),pr(()=>{!u||!a.value||u.value.removeSource(s.id)}),(d,g)=>null}}),zD=Ln({__name:"ImageSource",props:{id:null,url:null,coordinates:null},setup(e){const s=e,a=Si(),u=ln(Ei,void 0),d=()=>{!a.value||a.value.updateImage({url:s.url,coordinates:s.coordinates})};return Ye(()=>s.url,d),Ye(()=>s.coordinates,d),kn(()=>{!u||(u.value.addSource(s.id,{type:"image",url:s.url,coordinates:s.coordinates}),a.value=u.value.getSource(s.id))}),pr(()=>{!u||!a.value||u.value.removeSource(s.id)}),(g,x)=>null}}),LD=Ln({__name:"VideoSource",props:{id:null,urls:null,coordinates:null,playing:{type:Boolean}},setup(e){const s=e,a=Si(),u=ln(Ei,void 0),d=()=>{!u||!a.value||a.value.setCoordinates(s.coordinates)},g=()=>{s.playing?a.value.play():a.value.pause()};return Ye(()=>s.coordinates,d),Ye(()=>s.playing,g),kn(()=>{!u||(u.value.addSource(s.id,{type:"video",urls:s.urls,coordinates:s.coordinates}),a.value=u.value.getSource(s.id),g())}),pr(()=>{!u||!a.value||u.value.removeSource(s.id)}),(x,o)=>null}}),DD=Ln({__name:"CanvasSource",props:{id:null,animate:{type:Boolean},coordinates:null},setup(e,{expose:s}){const a=e,u=Ke(),d=Si(),g=ln(Ei,void 0);return s({canvas:u}),Ye(()=>a.coordinates,x=>{d.value.setCoordinates(x)}),Ye(()=>a.animate,()=>{a.animate?d.value.play():d.value.pause()}),kn(()=>{g&&(g.value.addSource(a.id,{type:"canvas",canvas:u.value,animate:a.animate||!1,coordinates:a.coordinates}),d.value=g.value.getSource(a.id))}),pr(()=>{g&&d.value&&g.value.removeSource(a.id)}),(x,o)=>(Xi(),es("canvas",{style:{display:"none"},ref_key:"canvasRef",ref:u,height:"400",width:"400"},null,512))}}),RD={install:e=>{e.component("v-map",cD),e.component("v-sprite",uD),e.component("v-marker",hD),e.component("v-popup",dD),e.component("v-fog",fD),e.component("v-feature-state",pD),e.component("v-attribution-control",mD),e.component("v-navigation-control",gD),e.component("v-scale-control",vD),e.component("v-background-layer",_D),e.component("v-circle-layer",yD),e.component("v-fillextrusion-layer",xD),e.component("v-fill-layer",bD),e.component("v-heatmap-layer",wD),e.component("v-hillshade-layer",SD),e.component("v-line-layer",TD),e.component("v-raster-layer",ED),e.component("v-symbol-layer",CD),e.component("v-sky-layer",ID),e.component("v-geo-source",AD),e.component("v-vector-source",PD),e.component("v-raster-source",kD),e.component("v-rasterdem-source",MD),e.component("v-image-source",zD),e.component("v-video-source",LD),e.component("v-canvas-source",DD)}};function E2(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:s,...a}=e,u=da(s,a),{aliases:d={},components:g={},directives:x={}}=u,o=pP(u.defaults),w=AL(u.display,u.ssr),E=RP(u.theme),k=XP(u.icons),z=lz(u.locale);return{install:O=>{for(const G in x)O.directive(G,x[G]);for(const G in g)O.component(G,g[G]);for(const G in d)O.component(G,Pt({...d[G],name:G,aliasName:d[G].name}));if(E.install(O),O.provide(gf,o),O.provide(X_,w),O.provide(vf,E),O.provide(j_,k),O.provide(th,z),Mi&&u.ssr){const{mount:G}=O;O.mount=function(){const H=G(...arguments);return Ui(()=>w.update()),O.mount=G,H}}Nr.reset(),O.mixin({computed:{$vuetify(){return Qi({defaults:Ud.call(this,gf),display:Ud.call(this,X_),theme:Ud.call(this,vf),icons:Ud.call(this,j_),locale:Ud.call(this,th)})}}})},defaults:o,display:w,theme:E,icons:k,locale:z}}const BD="3.0.0";E2.version=BD;function Ud(e){var g;var s,a;const u=this.$,d=(g=(s=u.parent)==null?void 0:s.provides)!=null?g:(a=u.vnode.appContext)==null?void 0:a.provides;if(d&&e in d)return d[e]}const OD={collapse:"fas fa-chevron-up",complete:"fas fa-check",cancel:"fas fa-times-circle",close:"fas fa-times",delete:"fas fa-times-circle",clear:"fas fa-times-circle",success:"fas fa-check-circle",info:"fas fa-info-circle",warning:"fas fa-exclamation",error:"fas fa-exclamation-triangle",prev:"fas fa-chevron-left",next:"fas fa-chevron-right",checkboxOn:"fas fa-check-square",checkboxOff:"far fa-square",checkboxIndeterminate:"fas fa-minus-square",delimiter:"fas fa-circle",sort:"fas fa-sort-up",expand:"fas fa-chevron-down",menu:"fas fa-bars",subgroup:"fas fa-caret-down",dropdown:"fas fa-caret-down",radioOn:"far fa-dot-circle",radioOff:"far fa-circle",edit:"fas fa-edit",ratingEmpty:"far fa-star",ratingFull:"fas fa-star",ratingHalf:"fas fa-star-half",loading:"fas fa-sync",first:"fas fa-step-backward",last:"fas fa-step-forward",unfold:"fas fa-arrows-alt-v",file:"fas fa-paperclip",plus:"fas fa-plus",minus:"fas fa-minus"},FD={component:Sg},VD={defaults:{VAppBar:{flat:!0},VAutocomplete:{variant:"filled"},VBanner:{color:"primary"},VBtn:{color:"primary",rounded:"xl"},VCard:{rounded:"lg"},VCheckbox:{color:"secondary"},VChip:{rounded:"sm"},VCombobox:{variant:"filled"},VNavigationDrawer:{},VSelect:{variant:"filled"},VSlider:{color:"primary"},VTabs:{color:"primary"},VTextarea:{variant:"filled"},VTextField:{variant:"filled"}},icons:{defaultSet:"mdi",sets:{mdi:zT}},theme:{themes:{light:{colors:{primary:"#6750a4",secondary:"#b4b0bb",tertiary:"#7d5260",error:"#b3261e",surface:"#fffbfe"}}}}};const C2=Po("v-alert-title"),$D=["success","info","warning","error"],ND=Pt({name:"VAlert",props:{border:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:pn,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>$D.includes(e)},...mr(),...ns(),...or(),...Lc(),...hh(),...zi(),...wn(),...Xn(),...Lo({variant:"flat"})},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=bn(e,"modelValue"),d=ne(()=>{var Te;if(e.icon!==!1)return e.type?(Te=e.icon)!=null?Te:`$${e.type}`:e.icon}),g=ne(()=>{var Te;return{color:(Te=e.color)!=null?Te:e.type,variant:e.variant}}),{themeClasses:x}=vi(e),{colorClasses:o,colorStyles:w,variantClasses:E}=Mc(g),{densityClasses:k}=Ur(e),{dimensionStyles:z}=is(e),{elevationClasses:L}=kr(e),{locationStyles:O}=Dc(e),{positionClasses:G}=dh(e),{roundedClasses:H}=Yi(e),{textColorClasses:pe,textColorStyles:se}=no(St(e,"borderColor")),{t:he}=rs(),K=ne(()=>({"aria-label":he(e.closeLabel),onClick(Te){u.value=!1}}));return()=>{var Te,Y;const _e=!!(a.prepend||d.value),de=!!(a.title||e.title),ve=!!(e.text||a.text),Se=!!(a.close||e.closable);return u.value&&F(e.tag,{class:["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${e.border===!0?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},x.value,o.value,k.value,L.value,G.value,H.value,E.value],style:[w.value,z.value,O.value],role:"alert"},{default:()=>[kc(!1,"v-alert"),e.border&&F("div",{key:"border",class:["v-alert__border",pe.value],style:se.value},null),_e&&F(wi,{key:"prepend",defaults:{VIcon:{density:e.density,icon:d.value,size:e.prominent?44:28}}},{default:()=>[F("div",{class:"v-alert__prepend"},[a.prepend?a.prepend():d.value&&F(er,null,null)])]}),F("div",{class:"v-alert__content"},[de&&F(C2,{key:"title"},{default:()=>[a.title?a.title():e.title]}),ve&&(a.text?a.text():e.text),(Te=a.default)==null?void 0:Te.call(a)]),a.append&&F("div",{key:"append",class:"v-alert__append"},[a.append()]),Se&&F(wi,{key:"close",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var be;return[F("div",{class:"v-alert__close"},[(be=(Y=a.close)==null?void 0:Y.call(a,{props:K.value}))!=null?be:F(bi,K.value,null)])]}})]})}}});const I2=Pt({name:"VMessages",props:{active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},...ma({transition:{component:qy,leaveAbsolute:!0,group:!0}})},setup(e,s){let{slots:a}=s;const u=ne(()=>Ao(e.messages)),{textColorClasses:d,textColorStyles:g}=no(ne(()=>e.color));return kt(()=>F(Ps,{transition:e.transition,tag:"div",class:["v-messages",d.value],style:g.value},{default:()=>[e.active&&u.value.map((x,o)=>F("div",{class:"v-messages__message",key:`${o}-${u.value}`},[a.message?a.message({message:x}):x]))]})),{}}}),A2=Symbol.for("vuetify:form"),UD=Mn({disabled:Boolean,fastFail:Boolean,lazyValidation:Boolean,readonly:Boolean,modelValue:{type:Boolean,default:null},validateOn:{type:String,default:"input"}},"form");function jD(e){const s=bn(e,"modelValue"),a=ne(()=>e.disabled),u=ne(()=>e.readonly),d=Ke(!1),g=Ke([]),x=Ke([]);async function o(){const k=[];let z=!0;x.value=[],d.value=!0;for(const L of g.value){const O=await L.validate();if(O.length>0&&(z=!1,k.push({id:L.id,errorMessages:O})),!z&&e.fastFail)break}return x.value=k,d.value=!1,{valid:z,errors:x.value}}function w(){g.value.forEach(k=>k.reset()),s.value=null}function E(){g.value.forEach(k=>k.resetValidation()),x.value=[],s.value=null}return Ye(g,()=>{let k=0,z=0;const L=[];for(const O of g.value)O.isValid===!1?(z++,L.push({id:O.id,errorMessages:O.errorMessages})):O.isValid===!0&&k++;x.value=L,s.value=z>0?!1:k===g.value.length?!0:null},{deep:!0}),Ni(A2,{register:k=>{let{id:z,validate:L,reset:O,resetValidation:G}=k;g.value.some(H=>H.id===z)&&wc(`Duplicate input name "${z}"`),g.value.push({id:z,validate:L,reset:O,resetValidation:G,isValid:null,errorMessages:[]})},unregister:k=>{g.value=g.value.filter(z=>z.id!==k)},update:(k,z,L)=>{const O=g.value.find(G=>G.id===k);!O||(O.isValid=z,O.errorMessages=L)},isDisabled:a,isReadonly:u,isValidating:d,items:g,validateOn:St(e,"validateOn")}),{errors:x,isDisabled:a,isReadonly:u,isValidating:d,items:g,validate:o,reset:w,resetValidation:E}}function GD(){return ln(A2,null)}const Ag=Mn({focused:Boolean},"focus");function Rc(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pa();const a=bn(e,"focused"),u=ne(()=>({[`${s}--focused`]:a.value}));function d(){a.value=!0}function g(){a.value=!1}return{focusClasses:u,isFocused:a,focus:d,blur:g}}const k2=Mn({disabled:Boolean,error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:Boolean,rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...Ag()},"validation");function M2(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pa(),a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Nr();const u=bn(e,"modelValue"),d=ne(()=>e.validationValue===void 0?u.value:e.validationValue),g=GD(),x=Ke([]),o=Ke(!0),w=ne(()=>!!(Ao(u.value===""?null:u.value).length||Ao(d.value===""?null:d.value).length)),E=ne(()=>!!(e.disabled||g!=null&&g.isDisabled.value)),k=ne(()=>!!(e.readonly||g!=null&&g.isReadonly.value)),z=ne(()=>e.errorMessages.length?Ao(e.errorMessages):x.value),L=ne(()=>e.error||z.value.length?!1:e.rules.length&&o.value?null:!0),O=Ke(!1),G=ne(()=>({[`${s}--error`]:L.value===!1,[`${s}--dirty`]:w.value,[`${s}--disabled`]:E.value,[`${s}--readonly`]:k.value})),H=ne(()=>{var Te;return(Te=e.name)!=null?Te:Ai(a)});pg(()=>{g==null||g.register({id:H.value,validate:K,reset:se,resetValidation:he})}),Ti(()=>{g==null||g.unregister(H.value)});const pe=ne(()=>e.validateOn||(g==null?void 0:g.validateOn.value)||"input");kn(()=>g==null?void 0:g.update(H.value,L.value,z.value)),_f(()=>pe.value==="input",()=>{Ye(d,()=>{if(d.value!=null)K();else if(e.focused){const Te=Ye(()=>e.focused,Y=>{Y||K(),Te()})}})}),_f(()=>pe.value==="blur",()=>{Ye(()=>e.focused,Te=>{Te||K()})}),Ye(L,()=>{g==null||g.update(H.value,L.value,z.value)});function se(){he(),u.value=null}function he(){o.value=!0,x.value=[]}async function K(){const Te=[];O.value=!0;for(const Y of e.rules){if(Te.length>=(e.maxErrors||1))break;const de=await(typeof Y=="function"?Y:()=>Y)(d.value);if(de!==!0){if(typeof de!="string"){console.warn(`${de} is not a valid value. Rule functions must return boolean true or a string.`);continue}Te.push(de)}}return x.value=Te,O.value=!1,o.value=!1,x.value}return{errorMessages:z,isDirty:w,isDisabled:E,isReadonly:k,isPristine:o,isValid:L,isValidating:O,reset:se,resetValidation:he,validate:K,validationClasses:G}}function P2(e){const{t:s}=rs();function a(u){var w;let{name:d}=u;const g={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[d],x=e[`onClick:${d}`],o=x&&g?s(`$vuetify.input.${g}`,(w=e.label)!=null?w:""):void 0;return F(er,{icon:e[`${d}Icon`],"aria-label":o,onClick:x},null)}return{InputIcon:a}}const _a=Mn({id:String,appendIcon:pn,prependIcon:pn,hideDetails:[Boolean,String],messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:e=>["horizontal","vertical"].includes(e)},"onClick:prepend":Qd,"onClick:append":Qd,...mr(),...k2()},"VInput"),Os=Pi()({name:"VInput",props:{..._a()},emits:{"update:modelValue":e=>!0},setup(e,s){let{attrs:a,slots:u,emit:d}=s;const{densityClasses:g}=Ur(e),{InputIcon:x}=P2(e),o=Nr(),w=ne(()=>e.id||`input-${o}`),{errorMessages:E,isDirty:k,isDisabled:z,isReadonly:L,isPristine:O,isValid:G,isValidating:H,reset:pe,resetValidation:se,validate:he,validationClasses:K}=M2(e,"v-input",w),Te=ne(()=>({id:w,isDirty:k,isDisabled:z,isReadonly:L,isPristine:O,isValid:G,isValidating:H,reset:pe,resetValidation:se,validate:he}));return kt(()=>{var Y,_e,de,ve,Se;const be=!!(u.prepend||e.prependIcon),De=!!(u.append||e.appendIcon),ze=!!((Y=e.messages)!=null&&Y.length||E.value.length),Je=!e.hideDetails||e.hideDetails==="auto"&&(ze||!!u.details);return F("div",{class:["v-input",`v-input--${e.direction}`,g.value,K.value]},[be&&F("div",{key:"prepend",class:"v-input__prepend"},[(_e=u.prepend)==null?void 0:_e.call(u,Te.value),e.prependIcon&&F(x,{key:"prepend-icon",name:"prepend"},null)]),u.default&&F("div",{class:"v-input__control"},[(de=u.default)==null?void 0:de.call(u,Te.value)]),De&&F("div",{key:"append",class:"v-input__append"},[e.appendIcon&&F(x,{key:"append-icon",name:"append"},null),(ve=u.append)==null?void 0:ve.call(u,Te.value)]),Je&&F("div",{class:"v-input__details"},[F(I2,{active:ze,messages:E.value.length>0?E.value:e.messages},{message:u.message}),(Se=u.details)==null?void 0:Se.call(u,Te.value)])])}),{reset:pe,resetValidation:se,validate:he}}});function pl(e){const s=Object.keys(Os.props).filter(a=>!iT(a));return Mo(e,s)}const ph=Pt({name:"VLabel",props:{text:String,clickable:Boolean,...Xn()},setup(e,s){let{slots:a}=s;return kt(()=>{var u;return F("label",{class:["v-label",{"v-label--clickable":e.clickable}]},[e.text,(u=a.default)==null?void 0:u.call(a)])}),{}}});const z2=Symbol.for("vuetify:selection-control-group"),a0=Mn({color:String,disabled:Boolean,error:Boolean,id:String,inline:Boolean,falseIcon:pn,trueIcon:pn,ripple:{type:Boolean,default:!0},multiple:{type:Boolean,default:null},name:String,readonly:Boolean,modelValue:null,type:String,valueComparator:{type:Function,default:kf},...Xn(),...mr()},"VSelectionControlGroup"),L2=Pt({name:"VSelectionControlGroup",props:{defaultsTarget:{type:String,default:"VSelectionControl"},...a0()},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=bn(e,"modelValue"),d=Nr(),g=ne(()=>e.id||`v-selection-control-group-${d}`),x=ne(()=>e.name||g.value);return Ni(z2,{modelValue:u}),ir({[e.defaultsTarget]:{color:St(e,"color"),disabled:St(e,"disabled"),density:St(e,"density"),error:St(e,"error"),inline:St(e,"inline"),modelValue:u,multiple:ne(()=>!!e.multiple||e.multiple==null&&Array.isArray(u.value)),name:x,falseIcon:St(e,"falseIcon"),trueIcon:St(e,"trueIcon"),readonly:St(e,"readonly"),ripple:St(e,"ripple"),type:St(e,"type"),valueComparator:St(e,"valueComparator")}}),kt(()=>{var o;return F("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":e.inline}],"aria-labelled-by":e.type==="radio"?g.value:void 0,role:e.type==="radio"?"radiogroup":void 0},[(o=a.default)==null?void 0:o.call(a)])}),{}}}),kg=Mn({label:String,trueValue:null,falseValue:null,value:null,...a0()},"VSelectionControl");function qD(e){const s=ln(z2,void 0),{densityClasses:a}=Ur(e),u=bn(e,"modelValue"),d=ne(()=>e.trueValue!==void 0?e.trueValue:e.value!==void 0?e.value:!0),g=ne(()=>e.falseValue!==void 0?e.falseValue:!1),x=ne(()=>!!e.multiple||e.multiple==null&&Array.isArray(u.value)),o=ne({get(){const z=s?s.modelValue.value:u.value;return x.value?z.some(L=>e.valueComparator(L,d.value)):e.valueComparator(z,d.value)},set(z){if(e.readonly)return;const L=z?d.value:g.value;let O=L;x.value&&(O=z?[...Ao(u.value),L]:Ao(u.value).filter(G=>!e.valueComparator(G,d.value))),s?s.modelValue.value=O:u.value=O}}),{textColorClasses:w,textColorStyles:E}=no(ne(()=>o.value&&!e.error&&!e.disabled?e.color:void 0)),k=ne(()=>o.value?e.trueIcon:e.falseIcon);return{group:s,densityClasses:a,trueValue:d,falseValue:g,model:o,textColorClasses:w,textColorStyles:E,icon:k}}const Df=Pi()({name:"VSelectionControl",directives:{Ripple:fl},inheritAttrs:!1,props:kg(),emits:{"update:modelValue":e=>!0},setup(e,s){let{attrs:a,slots:u}=s;const{densityClasses:d,icon:g,model:x,textColorClasses:o,textColorStyles:w,trueValue:E}=qD(e),k=Nr(),z=ne(()=>e.id||`input-${k}`),L=Ke(!1),O=Ke(!1),G=Ke();function H(he){L.value=!0,(!N_||N_&&he.target.matches(":focus-visible"))&&(O.value=!0)}function pe(){L.value=!1,O.value=!1}function se(he){x.value=he.target.checked}return kt(()=>{var he,K;const Te=u.label?u.label({label:e.label,props:{for:z.value}}):e.label,[Y,_e]=Ac(a);return F("div",tn({class:["v-selection-control",{"v-selection-control--dirty":x.value,"v-selection-control--disabled":e.disabled,"v-selection-control--error":e.error,"v-selection-control--focused":L.value,"v-selection-control--focus-visible":O.value,"v-selection-control--inline":e.inline},d.value]},Y),[F("div",{class:["v-selection-control__wrapper",o.value],style:w.value},[(he=u.default)==null?void 0:he.call(u),ji(F("div",{class:["v-selection-control__input"]},[g.value&&F(er,{key:"icon",icon:g.value},null),F("input",tn({ref:G,checked:x.value,disabled:e.disabled,id:z.value,onBlur:pe,onFocus:H,onInput:se,"aria-readonly":e.readonly,type:e.type,value:E.value,name:e.name,"aria-checked":e.type==="checkbox"?x.value:void 0},_e),null),(K=u.input)==null?void 0:K.call(u,{model:x,textColorClasses:o,textColorStyles:w,props:{onFocus:H,onBlur:pe,id:z.value}})]),[[uo("ripple"),e.ripple&&[!e.disabled&&!e.readonly,null,["center","circle"]]]])]),Te&&F(ph,{for:z.value,clickable:!0},{default:()=>[Te]})])}),{isFocused:L,input:G}}});function D2(e){return Mo(e,Object.keys(Df.props))}const R2=Mn({indeterminate:Boolean,indeterminateIcon:{type:pn,default:"$checkboxIndeterminate"},...kg({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),mh=Pt({name:"VCheckboxBtn",props:R2(),emits:{"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,s){let{slots:a}=s;const u=bn(e,"indeterminate"),d=bn(e,"modelValue");function g(w){u.value&&(u.value=!1)}const x=ne(()=>e.indeterminate?e.indeterminateIcon:e.falseIcon),o=ne(()=>e.indeterminate?e.indeterminateIcon:e.trueIcon);return kt(()=>F(Df,tn(e,{modelValue:d.value,"onUpdate:modelValue":[w=>d.value=w,g],class:"v-checkbox-btn",type:"checkbox",inline:!0,falseIcon:x.value,trueIcon:o.value,"aria-checked":e.indeterminate?"mixed":void 0}),a)),{}}});function ZD(e){return Mo(e,Object.keys(mh.props))}const WD=Pt({name:"VCheckbox",inheritAttrs:!1,props:{..._a(),...R2()},emits:{"update:focused":e=>!0},setup(e,s){let{attrs:a,slots:u}=s;const{isFocused:d,focus:g,blur:x}=Rc(e),o=Nr(),w=ne(()=>e.id||`checkbox-${o}`);return kt(()=>{const[E,k]=Ac(a),[z,L]=pl(e),[O,G]=ZD(e);return F(Os,tn({class:"v-checkbox"},E,z,{id:w.value,focused:d.value}),{...u,default:H=>{let{id:pe,isDisabled:se,isReadonly:he}=H;return F(mh,tn(O,{id:pe.value,disabled:se.value,readonly:he.value},k,{onFocus:g,onBlur:x}),u)}})}),{}}});const B2=Symbol.for("vuetify:v-chip-group"),HD=Pt({name:"VChipGroup",props:{column:Boolean,filter:Boolean,valueComparator:{type:Function,default:kf},...lh({selectedClass:"v-chip--selected"}),...wn(),...Xn(),...Lo({variant:"tonal"})},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const{themeClasses:u}=vi(e),{isSelected:d,select:g,next:x,prev:o,selected:w}=zc(e,B2);return ir({VChip:{color:St(e,"color"),filter:St(e,"filter"),variant:St(e,"variant")}}),kt(()=>{var E;return F(e.tag,{class:["v-chip-group",{"v-chip-group--column":e.column},u.value]},{default:()=>[(E=a.default)==null?void 0:E.call(a,{isSelected:d,select:g,next:x,prev:o,selected:w.value})]})}),{}}}),Rf=Pt({name:"VChip",directives:{Ripple:fl},props:{activeClass:String,appendAvatar:String,appendIcon:pn,closable:Boolean,closeIcon:{type:pn,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:Boolean,pill:Boolean,prependAvatar:String,prependIcon:pn,ripple:{type:Boolean,default:!0},text:String,modelValue:{type:Boolean,default:!0},...fo(),...mr(),...or(),...Pc(),...zi(),...fh(),...ga(),...wn({tag:"span"}),...Xn(),...Lo({variant:"tonal"})},emits:{"click:close":e=>!0,"update:active":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0},setup(e,s){let{attrs:a,emit:u,slots:d}=s;const{borderClasses:g}=zo(e),{colorClasses:x,colorStyles:o,variantClasses:w}=Mc(e),{densityClasses:E}=Ur(e),{elevationClasses:k}=kr(e),{roundedClasses:z}=Yi(e),{sizeClasses:L}=uh(e),{themeClasses:O}=vi(e),G=bn(e,"modelValue"),H=ch(e,B2,!1),pe=Pf(e,a);function se(he){G.value=!1,u("click:close",he)}return()=>{var he;const K=pe.isLink.value?"a":e.tag,Te=!!(d.append||e.appendIcon||e.appendAvatar),Y=!!(d.close||e.closable),_e=!!(d.filter||e.filter)&&H,de=!!(d.prepend||e.prependIcon||e.prependAvatar),ve=!H||H.isSelected.value,Se=!e.disabled&&(!!H||pe.isClickable.value||e.link),be=e.link?e.link:H==null?void 0:H.toggle;return G.value&&ji(F(K,{class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":Se,"v-chip--filter":_e,"v-chip--pill":e.pill},O.value,g.value,ve?x.value:void 0,E.value,k.value,z.value,L.value,w.value,H==null?void 0:H.selectedClass.value],style:[ve?o.value:void 0],disabled:e.disabled||void 0,draggable:e.draggable,href:pe.href.value,onClick:Se&&be},{default:()=>{var De;return[kc(Se,"v-chip"),_e&&F(wi,{key:"filter",defaults:{VIcon:{icon:e.filterIcon}}},{default:()=>[F(Zy,null,{default:()=>[ji(F("div",{class:"v-chip__filter"},[d.filter?d.filter():F(er,null,null)]),[[Rs,H.isSelected.value]])]})]}),de&&F(wi,{key:"prepend",defaults:{VAvatar:{image:e.prependAvatar},VIcon:{icon:e.prependIcon}}},{default:()=>[d.prepend?F("div",{class:"v-chip__prepend"},[d.prepend()]):e.prependAvatar?F(cl,{start:!0},null):e.prependIcon?F(er,{start:!0},null):void 0]}),(De=(he=d.default)==null?void 0:he.call(d,{isSelected:H==null?void 0:H.isSelected.value,selectedClass:H==null?void 0:H.selectedClass.value,select:H==null?void 0:H.select,toggle:H==null?void 0:H.toggle,value:H==null?void 0:H.value.value,disabled:e.disabled}))!=null?De:e.text,Te&&F(wi,{key:"append",defaults:{VAvatar:{image:e.appendAvatar},VIcon:{icon:e.appendIcon}}},{default:()=>[d.append?F("div",{class:"v-chip__append"},[d.append()]):e.appendAvatar?F(cl,{end:!0},null):e.appendIcon?F(er,{end:!0},null):void 0]}),Y&&F(wi,{key:"close",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},{default:()=>[F("div",{class:"v-chip__close",onClick:se},[d.close?d.close():F(er,null,null)])]})]}}),[[uo("ripple"),Se&&e.ripple,null]])}}});const O2=Mn({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function F2(e,s){const a={},u=d=>()=>{if(!Mi)return Promise.resolve(!0);const g=d==="openDelay";return a.closeDelay&&window.clearTimeout(a.closeDelay),delete a.closeDelay,a.openDelay&&window.clearTimeout(a.openDelay),delete a.openDelay,new Promise(x=>{var w;const o=parseInt((w=e[d])!=null?w:0,10);a[d]=window.setTimeout(()=>{s==null||s(g),x(g)},o)})};return{runCloseDelay:u("closeDelay"),runOpenDelay:u("openDelay")}}const K_=Symbol.for("vuetify:v-menu"),XD=Mn({activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...O2()},"VOverlay/useActivator");function YD(e,s){let{isActive:a,isTop:u}=s;const d=Ke();let g=!1,x=!1,o=!0;const w=ne(()=>e.openOnFocus||e.openOnFocus==null&&e.openOnHover),E=ne(()=>e.openOnClick||e.openOnClick==null&&!e.openOnHover&&!w.value),{runOpenDelay:k,runCloseDelay:z}=F2(e,K=>{K===(e.openOnHover&&g||w.value&&x)&&!(e.openOnHover&&a.value&&!u.value)&&(a.value!==K&&(o=!0),a.value=K)}),L={click:K=>{K.stopPropagation(),d.value=K.currentTarget||K.target,a.value=!a.value},mouseenter:K=>{g=!0,d.value=K.currentTarget||K.target,k()},mouseleave:K=>{g=!1,z()},focus:K=>{N_&&!K.target.matches(":focus-visible")||(x=!0,K.stopPropagation(),d.value=K.currentTarget||K.target,k())},blur:K=>{x=!1,K.stopPropagation(),z()}},O=ne(()=>{const K={};return E.value&&(K.click=L.click),e.openOnHover&&(K.mouseenter=L.mouseenter,K.mouseleave=L.mouseleave),w.value&&(K.focus=L.focus,K.blur=L.blur),K}),G=ne(()=>{const K={};if(e.openOnHover&&(K.mouseenter=()=>{g=!0,k()},K.mouseleave=()=>{g=!1,z()}),e.closeOnContentClick){const Te=ln(K_,null);K.click=()=>{a.value=!1,Te==null||Te.closeParents()}}return K}),H=ne(()=>{const K={};return e.openOnHover&&(K.mouseenter=()=>{o&&(g=!0,o=!1,k())},K.mouseleave=()=>{g=!1,z()}),K});Ye(u,K=>{K&&(e.openOnHover&&!g&&(!w.value||!x)||w.value&&!x&&(!e.openOnHover||!g))&&(a.value=!1)});const pe=Ke();Ls(()=>{!pe.value||Ui(()=>{const K=pe.value;d.value=VM(K)?K.$el:K})});const se=Ar("useActivator");let he;return Ye(()=>!!e.activator,K=>{K&&Mi?(he=Cf(),he.run(()=>{KD(e,se,{activatorEl:d,activatorEvents:O})})):he&&he.stop()},{flush:"post",immediate:!0}),{activatorEl:d,activatorRef:pe,activatorEvents:O,contentEvents:G,scrimEvents:H}}function KD(e,s,a){let{activatorEl:u,activatorEvents:d}=a;Ye(()=>e.activator,(w,E)=>{if(E&&w!==E){const k=o(E);k&&x(k)}w&&Ui(()=>g())},{immediate:!0}),Ye(()=>e.activatorProps,()=>{g()}),Ec(()=>{x()});function g(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;!w||(Object.entries(d.value).forEach(k=>{let[z,L]=k;w.addEventListener(z,L)}),Object.keys(E).forEach(k=>{E[k]==null?w.removeAttribute(k):w.setAttribute(k,E[k])}))}function x(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;!w||(Object.entries(d.value).forEach(k=>{let[z,L]=k;w.removeEventListener(z,L)}),Object.keys(E).forEach(k=>{w.removeAttribute(k)}))}function o(){var w;let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.activator,k;if(E)if(E==="parent"){var z,L;let O=s==null||(z=s.proxy)==null||(L=z.$el)==null?void 0:L.parentNode;for(;O.hasAttribute("data-no-activator");)O=O.parentNode;k=O}else typeof E=="string"?k=document.querySelector(E):"$el"in E?k=E.$el:k=E;return u.value=((w=k)==null?void 0:w.nodeType)===Node.ELEMENT_NODE?k:null,u.value}}const Mg=Mn({eager:Boolean},"lazy");function l0(e,s){const a=Ke(!1),u=ne(()=>a.value||e.eager||s.value);Ye(s,()=>a.value=!0);function d(){e.eager||(a.value=!1)}return{isBooted:a,hasContent:u,onAfterLeave:d}}function g_(e,s){return{x:e.x+s.x,y:e.y+s.y}}function JD(e,s){return{x:e.x-s.x,y:e.y-s.y}}function xw(e,s){if(e.side==="top"||e.side==="bottom"){const{side:a,align:u}=e,d=u==="left"?0:u==="center"?s.width/2:u==="right"?s.width:u,g=a==="top"?0:a==="bottom"?s.height:a;return g_({x:d,y:g},s)}else if(e.side==="left"||e.side==="right"){const{side:a,align:u}=e,d=a==="left"?0:a==="right"?s.width:a,g=u==="top"?0:u==="center"?s.height/2:u==="bottom"?s.height:u;return g_({x:d,y:g},s)}return g_({x:s.width/2,y:s.height/2},s)}const V2={static:tR,connected:iR},QD=Mn({locationStrategy:{type:[String,Function],default:"static",validator:e=>typeof e=="function"||e in V2},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay/locationStrategies");function eR(e,s){const a=Ke({}),u=Ke();let d;Ls(async()=>{var x;(x=d)==null||x.stop(),u.value=void 0,Mi&&s.isActive.value&&e.locationStrategy&&(d=Cf(),await Ui(),d.run(()=>{if(typeof e.locationStrategy=="function"){var o;u.value=(o=e.locationStrategy(s,e,a))==null?void 0:o.updateLocation}else{var w;u.value=(w=V2[e.locationStrategy](s,e,a))==null?void 0:w.updateLocation}}))}),Mi&&window.addEventListener("resize",g,{passive:!0}),Ec(()=>{var x;Mi&&window.removeEventListener("resize",g),u.value=void 0,(x=d)==null||x.stop()});function g(x){var o;(o=u.value)==null||o.call(u,x)}return{contentStyles:a,updateLocation:u}}function tR(){}function nR(e){const s=$y(e);return s.x-=parseFloat(e.style.left||0),s.y-=parseFloat(e.style.top||0),s}function iR(e,s,a){const u=fP(e.activatorEl.value);u&&Object.assign(a.value,{position:"fixed"});const{preferredAnchor:d,preferredOrigin:g}=Vy(()=>{const O=O_(s.location,e.isRtl.value),G=s.origin==="overlap"?O:s.origin==="auto"?a_(O):O_(s.origin,e.isRtl.value);return O.side===G.side&&O.align===l_(G).align?{preferredAnchor:Lb(O),preferredOrigin:Lb(G)}:{preferredAnchor:O,preferredOrigin:G}}),[x,o,w,E]=["minWidth","minHeight","maxWidth","maxHeight"].map(O=>ne(()=>{const G=parseFloat(s[O]);return isNaN(G)?1/0:G})),k=ne(()=>{if(Array.isArray(s.offset))return s.offset;if(typeof s.offset=="string"){const O=s.offset.split(" ").map(parseFloat);return O.length<2&&O.push(0),O}return typeof s.offset=="number"?[s.offset,0]:[0,0]});let z=!1;if(Mi){const O=new ResizeObserver(()=>{z&&L()});Ye([e.activatorEl,e.contentEl],(G,H)=>{let[pe,se]=G,[he,K]=H;he&&O.unobserve(he),pe&&O.observe(pe),K&&O.unobserve(K),se&&O.observe(se)},{immediate:!0}),Ec(()=>{O.disconnect()})}function L(){if(z=!1,requestAnimationFrame(()=>{requestAnimationFrame(()=>z=!0)}),!e.activatorEl.value||!e.contentEl.value)return;const O=e.activatorEl.value.getBoundingClientRect(),G=nR(e.contentEl.value),H=Xm(e.contentEl.value),pe=12;H.length||(H.push(document.documentElement),e.contentEl.value.style.top&&e.contentEl.value.style.left||(G.x+=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),G.y+=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const se=H.reduce((be,De)=>{const ze=De.getBoundingClientRect(),Je=new Ju({x:De===document.documentElement?0:ze.x,y:De===document.documentElement?0:ze.y,width:De.clientWidth,height:De.clientHeight});return be?new Ju({x:Math.max(be.left,Je.left),y:Math.max(be.top,Je.top),width:Math.min(be.right,Je.right)-Math.max(be.left,Je.left),height:Math.min(be.bottom,Je.bottom)-Math.max(be.top,Je.top)}):Je},void 0);se.x+=pe,se.y+=pe,se.width-=pe*2,se.height-=pe*2;let he={anchor:d.value,origin:g.value};function K(be){const De=new Ju(G),ze=xw(be.anchor,O),Je=xw(be.origin,De);let{x:ct,y:nt}=JD(ze,Je);switch(be.anchor.side){case"top":nt-=k.value[0];break;case"bottom":nt+=k.value[0];break;case"left":ct-=k.value[0];break;case"right":ct+=k.value[0];break}switch(be.anchor.align){case"top":nt-=k.value[1];break;case"bottom":nt+=k.value[1];break;case"left":ct-=k.value[1];break;case"right":ct+=k.value[1];break}return De.x+=ct,De.y+=nt,De.width=Math.min(De.width,w.value),De.height=Math.min(De.height,E.value),{overflows:Rb(De,se),x:ct,y:nt}}let Te=0,Y=0;const _e={x:0,y:0},de={x:!1,y:!1};let ve=-1;for(;;){if(ve++>10){V_("Infinite loop detected in connectedLocationStrategy");break}const{x:be,y:De,overflows:ze}=K(he);Te+=be,Y+=De,G.x+=be,G.y+=De;{const Je=Db(he.anchor),ct=ze.x.before||ze.x.after,nt=ze.y.before||ze.y.after;let ft=!1;if(["x","y"].forEach(Pe=>{if(Pe==="x"&&ct&&!de.x||Pe==="y"&&nt&&!de.y){const at={anchor:{...he.anchor},origin:{...he.origin}},jt=Pe==="x"?Je==="y"?l_:a_:Je==="y"?a_:l_;at.anchor=jt(at.anchor),at.origin=jt(at.origin);const{overflows:pt}=K(at);(pt[Pe].before<=ze[Pe].before&&pt[Pe].after<=ze[Pe].after||pt[Pe].before+pt[Pe].after<(ze[Pe].before+ze[Pe].after)/2)&&(he=at,ft=de[Pe]=!0)}}),ft)continue}ze.x.before&&(Te+=ze.x.before,G.x+=ze.x.before),ze.x.after&&(Te-=ze.x.after,G.x-=ze.x.after),ze.y.before&&(Y+=ze.y.before,G.y+=ze.y.before),ze.y.after&&(Y-=ze.y.after,G.y-=ze.y.after);{const Je=Rb(G,se);_e.x=se.width-Je.x.before-Je.x.after,_e.y=se.height-Je.y.before-Je.y.after,Te+=Je.x.before,G.x+=Je.x.before,Y+=Je.y.before,G.y+=Je.y.before}break}const Se=Db(he.anchor);Object.assign(a.value,{"--v-overlay-anchor-origin":`${he.anchor.side} ${he.anchor.align}`,transformOrigin:`${he.origin.side} ${he.origin.align}`,top:Xt(bw(Y)),left:Xt(bw(Te)),minWidth:Xt(Se==="y"?Math.min(x.value,O.width):x.value),maxWidth:Xt(ww(Eo(_e.x,x.value===1/0?0:x.value,w.value))),maxHeight:Xt(ww(Eo(_e.y,o.value===1/0?0:o.value,E.value)))})}return Ye(()=>[d.value,g.value,s.offset,s.minWidth,s.minHeight,s.maxWidth,s.maxHeight],()=>L(),{immediate:!u}),u&&Ui(()=>L()),requestAnimationFrame(()=>{a.value.maxHeight&&L()}),{updateLocation:L}}function bw(e){return Math.round(e*devicePixelRatio)/devicePixelRatio}function ww(e){return Math.ceil(e*devicePixelRatio)/devicePixelRatio}let J_=!0;const tg=[];function rR(e){!J_||tg.length?(tg.push(e),Q_()):(J_=!1,e(),Q_())}let Sw=-1;function Q_(){cancelAnimationFrame(Sw),Sw=requestAnimationFrame(()=>{const e=tg.shift();e&&e(),tg.length?Q_():J_=!0})}const ey={none:null,close:aR,block:lR,reposition:cR},oR=Mn({scrollStrategy:{type:[String,Function],default:"block",validator:e=>typeof e=="function"||e in ey}},"VOverlay/scrollStrategies");function sR(e,s){if(!Mi)return;let a;Ls(async()=>{var u;(u=a)==null||u.stop(),s.isActive.value&&e.scrollStrategy&&(a=Cf(),await Ui(),a.run(()=>{if(typeof e.scrollStrategy=="function")e.scrollStrategy(s,e);else{var d;(d=ey[e.scrollStrategy])==null||d.call(ey,s,e)}}))})}function aR(e){var a;function s(u){e.isActive.value=!1}$2((a=e.activatorEl.value)!=null?a:e.contentEl.value,s)}function lR(e,s){var a;const u=(a=e.root.value)==null?void 0:a.offsetParent,d=[...new Set([...Xm(e.activatorEl.value,s.contained?u:void 0),...Xm(e.contentEl.value,s.contained?u:void 0)])].filter(o=>!o.classList.contains("v-overlay-scroll-blocked")),g=window.innerWidth-document.documentElement.offsetWidth,x=(o=>jy(o)&&o)(u||document.documentElement);x&&e.root.value.classList.add("v-overlay--scroll-blocked"),d.forEach((o,w)=>{o.style.setProperty("--v-body-scroll-x",Xt(-o.scrollLeft)),o.style.setProperty("--v-body-scroll-y",Xt(-o.scrollTop)),o.style.setProperty("--v-scrollbar-offset",Xt(g)),o.classList.add("v-overlay-scroll-blocked")}),Ec(()=>{d.forEach((o,w)=>{const E=parseFloat(o.style.getPropertyValue("--v-body-scroll-x")),k=parseFloat(o.style.getPropertyValue("--v-body-scroll-y"));o.style.removeProperty("--v-body-scroll-x"),o.style.removeProperty("--v-body-scroll-y"),o.style.removeProperty("--v-scrollbar-offset"),o.classList.remove("v-overlay-scroll-blocked"),o.scrollLeft=-E,o.scrollTop=-k}),x&&e.root.value.classList.remove("v-overlay--scroll-blocked")})}function cR(e){var d;let s=!1,a=-1;function u(g){rR(()=>{var x,o;const w=performance.now();(x=(o=e.updateLocation).value)==null||x.call(o,g),s=(performance.now()-w)/(1e3/60)>2})}$2((d=e.activatorEl.value)!=null?d:e.contentEl.value,g=>{s?(cancelAnimationFrame(a),a=requestAnimationFrame(()=>{a=requestAnimationFrame(()=>{u(g)})})):u(g)})}function $2(e,s){const a=[document,...Xm(e)];a.forEach(u=>{u.addEventListener("scroll",s,{passive:!0})}),Ec(()=>{a.forEach(u=>{u.removeEventListener("scroll",s)})})}const Tw=Symbol.for("vuetify:stack"),jd=Qi([]);function uR(e,s){const a=Ar("useStack"),u=ln(Tw,void 0),d=Qi({activeChildren:new Set});Ni(Tw,d);const g=Ke(+s.value);_f(e,()=>{var w;const E=(w=jd.at(-1))==null?void 0:w[1];g.value=E?E+10:+s.value,jd.push([a.uid,g.value]),u==null||u.activeChildren.add(a.uid),Ec(()=>{const k=jd.findIndex(z=>z[0]===a.uid);jd.splice(k,1),u==null||u.activeChildren.delete(a.uid)})});const x=Ke(!0);Ls(()=>{var w;const E=((w=jd.at(-1))==null?void 0:w[0])===a.uid;setTimeout(()=>x.value=E)});const o=ne(()=>!d.activeChildren.size);return{globalTop:If(x),localTop:o,stackStyles:ne(()=>({zIndex:g.value}))}}function of(e){return{teleportTarget:ne(()=>{const a=e.value;if(a===!0||!Mi)return;const u=a===!1?document.body:typeof a=="string"?document.querySelector(a):a;if(u==null){KA(`Unable to locate target ${a}`);return}if(!of.cache.has(u)){const d=document.createElement("div");d.className="v-overlay-container",u.appendChild(d),of.cache.set(u,d)}return of.cache.get(u)})}}of.cache=new WeakMap;function hR(){return!0}function N2(e,s,a){if(!e||U2(e,a)===!1)return!1;const u=gT(s);if(typeof ShadowRoot<"u"&&u instanceof ShadowRoot&&u.host===e.target)return!1;const d=(typeof a.value=="object"&&a.value.include||(()=>[]))();return d.push(s),!d.some(g=>g==null?void 0:g.contains(e.target))}function U2(e,s){return(typeof s.value=="object"&&s.value.closeConditional||hR)(e)}function dR(e,s,a){const u=typeof a.value=="function"?a.value:a.value.handler;s._clickOutside.lastMousedownWasOutside&&N2(e,s,a)&&setTimeout(()=>{U2(e,a)&&u&&u(e)},0)}function Ew(e,s){const a=gT(e);s(document),typeof ShadowRoot<"u"&&a instanceof ShadowRoot&&s(a)}const j2={mounted(e,s){const a=d=>dR(d,e,s),u=d=>{e._clickOutside.lastMousedownWasOutside=N2(d,e,s)};Ew(e,d=>{d.addEventListener("click",a,!0),d.addEventListener("mousedown",u,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!0}),e._clickOutside[s.instance.$.uid]={onClick:a,onMousedown:u}},unmounted(e,s){!e._clickOutside||(Ew(e,a=>{var u;if(!a||!((u=e._clickOutside)!=null&&u[s.instance.$.uid]))return;const{onClick:d,onMousedown:g}=e._clickOutside[s.instance.$.uid];a.removeEventListener("click",d,!0),a.removeEventListener("mousedown",g,!0)}),delete e._clickOutside[s.instance.$.uid])}};function fR(e){const{modelValue:s,color:a,...u}=e;return F(zs,{name:"fade-transition",appear:!0},{default:()=>[e.modelValue&&F("div",tn({class:["v-overlay__scrim",e.color.backgroundColorClasses.value],style:e.color.backgroundColorStyles.value},u),null)]})}const Bf=Mn({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[String,Boolean],default:!0},zIndex:{type:[Number,String],default:2e3},...XD(),...ns(),...Mg(),...QD(),...oR(),...Xn(),...ma()},"v-overlay"),gh=Pi()({name:"VOverlay",directives:{ClickOutside:j2},inheritAttrs:!1,props:Bf(),emits:{"click:outside":e=>!0,"update:modelValue":e=>!0,afterLeave:()=>!0},setup(e,s){let{slots:a,attrs:u,emit:d}=s;const g=bn(e,"modelValue"),x=ne({get:()=>g.value,set:Pe=>{Pe&&e.disabled||(g.value=Pe)}}),{teleportTarget:o}=of(ne(()=>e.attach||e.contained)),{themeClasses:w}=vi(e),{rtlClasses:E,isRtl:k}=va(),{hasContent:z,onAfterLeave:L}=l0(e,x),O=Hi(ne(()=>typeof e.scrim=="string"?e.scrim:null)),{globalTop:G,localTop:H,stackStyles:pe}=uR(x,St(e,"zIndex")),{activatorEl:se,activatorRef:he,activatorEvents:K,contentEvents:Te,scrimEvents:Y}=YD(e,{isActive:x,isTop:H}),{dimensionStyles:_e}=is(e);Ye(()=>e.disabled,Pe=>{Pe&&(x.value=!1)});const de=Ke(),ve=Ke(),{contentStyles:Se,updateLocation:be}=eR(e,{isRtl:k,contentEl:ve,activatorEl:se,isActive:x});sR(e,{root:de,contentEl:ve,activatorEl:se,isActive:x,updateLocation:be});function De(Pe){d("click:outside",Pe),e.persistent?ft():x.value=!1}function ze(){return x.value&&G.value}Mi&&Ye(x,Pe=>{Pe?window.addEventListener("keydown",Je):window.removeEventListener("keydown",Je)},{immediate:!0});function Je(Pe){Pe.key==="Escape"&&G.value&&(e.persistent?ft():x.value=!1)}const ct=ZT();_f(()=>e.closeOnBack,()=>{fz(ct,Pe=>{G.value&&x.value?(Pe(!1),e.persistent?ft():x.value=!1):Pe()})});const nt=Ke();Ye(()=>x.value&&(e.absolute||e.contained)&&o.value==null,Pe=>{if(Pe){const at=vT(de.value);at&&at!==document.scrollingElement&&(nt.value=at.scrollTop)}});function ft(){e.noClickAnimation||ve.value&&vc(ve.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:mf})}return kt(()=>{var Pe,at;return F(On,null,[(Pe=a.activator)==null?void 0:Pe.call(a,{isActive:x.value,props:tn({ref:he},t_(K.value),e.activatorProps)}),Mi&&F(Uk,{disabled:!o.value,to:o.value},{default:()=>[z.value&&F("div",tn({class:["v-overlay",{"v-overlay--absolute":e.absolute||e.contained,"v-overlay--active":x.value,"v-overlay--contained":e.contained},w.value,E.value],style:[pe.value,{top:Xt(nt.value)}],ref:de},u),[F(fR,tn({color:O,modelValue:x.value&&!!e.scrim},t_(Y.value)),null),F(Ps,{appear:!0,persisted:!0,transition:e.transition,target:se.value,onAfterLeave:()=>{L(),d("afterLeave")}},{default:()=>[ji(F("div",tn({ref:ve,class:["v-overlay__content",e.contentClass],style:[_e.value,Se.value]},t_(Te.value),e.contentProps),[(at=a.default)==null?void 0:at.call(a,{isActive:x})]),[[Rs,x.value],[uo("click-outside"),{handler:De,closeConditional:ze,include:()=>[se.value]}]])]})])]})])}),{activatorEl:se,animateClick:ft,contentEl:ve,globalTop:G,localTop:H,updateLocation:be}}});function Pg(e){return Mo(e,Object.keys(gh.props))}const v_=Symbol("Forwarded refs");function os(e){for(var s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];return e[v_]=a,new Proxy(e,{get(d,g){if(Reflect.has(d,g))return Reflect.get(d,g);for(const x of a)if(x.value&&Reflect.has(x.value,g)){const o=Reflect.get(x.value,g);return typeof o=="function"?o.bind(x.value):o}},getOwnPropertyDescriptor(d,g){const x=Reflect.getOwnPropertyDescriptor(d,g);if(x)return x;if(!(typeof g=="symbol"||g.startsWith("__"))){for(const o of a){if(!o.value)continue;const w=Reflect.getOwnPropertyDescriptor(o.value,g);if(w)return w;if("_"in o.value&&"setupState"in o.value._){const E=Reflect.getOwnPropertyDescriptor(o.value._.setupState,g);if(E)return E}}for(const o of a){let w=o.value&&Object.getPrototypeOf(o.value);for(;w;){const E=Reflect.getOwnPropertyDescriptor(w,g);if(E)return E;w=Object.getPrototypeOf(w)}}for(const o of a){const w=o.value&&o.value[v_];if(!w)continue;const E=w.slice();for(;E.length;){const k=E.shift(),z=Reflect.getOwnPropertyDescriptor(k.value,g);if(z)return z;const L=k.value&&k.value[v_];L&&E.push(...L)}}}}})}function zg(){const s=Ar("useScopeId").vnode.scopeId;return{scopeId:s?{[s]:""}:void 0}}const Of=Pi()({name:"VMenu",props:{id:String,..._g(Bf({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:xg}}),["absolute"])},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=bn(e,"modelValue"),{scopeId:d}=zg(),g=Nr(),x=ne(()=>e.id||`v-menu-${g}`),o=Ke(),w=ln(K_,null);let E=0;Ni(K_,{register(){++E},unregister(){--E},closeParents(){setTimeout(()=>{E||(u.value=!1,w==null||w.closeParents())},40)}}),Ye(u,z=>{z?w==null||w.register():w==null||w.unregister()});function k(){w==null||w.closeParents()}return kt(()=>{const[z]=Pg(e);return F(gh,tn({ref:o,class:["v-menu"]},z,{modelValue:u.value,"onUpdate:modelValue":L=>u.value=L,absolute:!0,activatorProps:tn({"aria-haspopup":"menu","aria-expanded":String(u.value),"aria-owns":x.value},e.activatorProps),"onClick:outside":k},d),{activator:a.activator,default:function(){for(var L,O=arguments.length,G=new Array(O),H=0;H<O;H++)G[H]=arguments[H];return F(wi,{root:!0},{default:()=>[(L=a.default)==null?void 0:L.call(a,...G)]})}})}),os({id:x},o)}});const Zd=Pt({name:"VFieldLabel",props:{floating:Boolean},setup(e,s){let{slots:a}=s;return kt(()=>F(ph,{class:["v-field-label",{"v-field-label--floating":e.floating}],"aria-hidden":e.floating||void 0},a)),{}}}),pR=["underlined","outlined","filled","solo","plain"],Lg=Mn({appendInnerIcon:pn,bgColor:String,clearable:Boolean,clearIcon:{type:pn,default:"$clear"},active:Boolean,color:String,dirty:Boolean,disabled:Boolean,error:Boolean,label:String,persistentClear:Boolean,prependInnerIcon:pn,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:e=>pR.includes(e)},"onClick:clear":Qd,"onClick:appendInner":Qd,"onClick:prependInner":Qd,...Xn(),...Jy()},"v-field"),Ff=Pi()({name:"VField",inheritAttrs:!1,props:{id:String,...Ag(),...Lg()},emits:{"click:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,s){let{attrs:a,emit:u,slots:d}=s;const{themeClasses:g}=vi(e),{loaderClasses:x}=Tg(e),{focusClasses:o,isFocused:w,focus:E,blur:k}=Rc(e),{InputIcon:z}=P2(e),L=ne(()=>e.dirty||e.active),O=ne(()=>!e.singleLine&&!!(e.label||d.label)),G=Nr(),H=ne(()=>e.id||`input-${G}`),pe=Ke(),se=Ke(),he=Ke(),{backgroundColorClasses:K,backgroundColorStyles:Te}=Hi(St(e,"bgColor")),{textColorClasses:Y,textColorStyles:_e}=no(ne(()=>L.value&&w.value&&!e.error&&!e.disabled?e.color:void 0));Ye(L,Se=>{if(O.value){const be=pe.value.$el,De=se.value.$el,ze=$y(be),Je=De.getBoundingClientRect(),ct=Je.x-ze.x,nt=Je.y-ze.y-(ze.height/2-Je.height/2),ft=Je.width/.75,Pe=Math.abs(ft-ze.width)>1?{maxWidth:Xt(ft)}:void 0,at=getComputedStyle(be),jt=getComputedStyle(De),pt=parseFloat(at.transitionDuration)*1e3||150,zt=parseFloat(jt.getPropertyValue("--v-field-label-scale")),Gt=jt.getPropertyValue("color");be.style.visibility="visible",De.style.visibility="hidden",vc(be,{transform:`translate(${ct}px, ${nt}px) scale(${zt})`,color:Gt,...Pe},{duration:pt,easing:mf,direction:Se?"normal":"reverse"}).finished.then(()=>{be.style.removeProperty("visibility"),De.style.removeProperty("visibility")})}},{flush:"post"});const de=ne(()=>({isActive:L,isFocused:w,controlRef:he,blur:k,focus:E}));function ve(Se){Se.target!==document.activeElement&&Se.preventDefault(),u("click:control",Se)}return kt(()=>{var Se,be,De;const ze=e.variant==="outlined",Je=d["prepend-inner"]||e.prependInnerIcon,ct=!!(e.clearable||d.clear),nt=!!(d["append-inner"]||e.appendInnerIcon||ct),ft=d.label?d.label({label:e.label,props:{for:H.value}}):e.label;return F("div",tn({class:["v-field",{"v-field--active":L.value,"v-field--appended":nt,"v-field--disabled":e.disabled,"v-field--dirty":e.dirty,"v-field--error":e.error,"v-field--has-background":!!e.bgColor,"v-field--persistent-clear":e.persistentClear,"v-field--prepended":Je,"v-field--reverse":e.reverse,"v-field--single-line":e.singleLine,"v-field--no-label":!ft,[`v-field--variant-${e.variant}`]:!0},g.value,K.value,o.value,x.value],style:[Te.value,_e.value],onClick:ve},a),[F("div",{class:"v-field__overlay"},null),F(Qy,{name:"v-field",active:e.loading,color:e.error?"error":e.color},{default:d.loader}),Je&&F("div",{key:"prepend",class:"v-field__prepend-inner"},[e.prependInnerIcon&&F(z,{key:"prepend-icon",name:"prependInner"},null),(Se=d["prepend-inner"])==null?void 0:Se.call(d,de.value)]),F("div",{class:"v-field__field","data-no-activator":""},[["solo","filled"].includes(e.variant)&&O.value&&F(Zd,{key:"floating-label",ref:se,class:[Y.value],floating:!0,for:H.value},{default:()=>[ft]}),F(Zd,{ref:pe,for:H.value},{default:()=>[ft]}),(be=d.default)==null?void 0:be.call(d,{...de.value,props:{id:H.value,class:"v-field__input"},focus:E,blur:k})]),ct&&F(Zy,{key:"clear"},{default:()=>[ji(F("div",{class:"v-field__clearable"},[d.clear?d.clear():F(z,{name:"clear"},null)]),[[Rs,e.dirty]])]}),nt&&F("div",{key:"append",class:"v-field__append-inner"},[(De=d["append-inner"])==null?void 0:De.call(d,de.value),e.appendInnerIcon&&F(z,{key:"append-icon",name:"appendInner"},null)]),F("div",{class:["v-field__outline",Y.value]},[ze&&F(On,null,[F("div",{class:"v-field__outline__start"},null),O.value&&F("div",{class:"v-field__outline__notch"},[F(Zd,{ref:se,floating:!0,for:H.value},{default:()=>[ft]})]),F("div",{class:"v-field__outline__end"},null)]),["plain","underlined"].includes(e.variant)&&O.value&&F(Zd,{ref:se,floating:!0,for:H.value},{default:()=>[ft]})])])}),{controlRef:he}}});function c0(e){const s=Object.keys(Ff.props).filter(a=>!iT(a));return Mo(e,s)}const Dg=Pt({name:"VCounter",functional:!0,props:{active:Boolean,max:[Number,String],value:{type:[Number,String],default:0},...ma({transition:{component:qy}})},setup(e,s){let{slots:a}=s;const u=ne(()=>e.max?`${e.value} / ${e.max}`:String(e.value));return kt(()=>F(Ps,{transition:e.transition},{default:()=>[ji(F("div",{class:"v-counter"},[a.default?a.default({counter:u.value,max:e.max,value:e.value}):u.value]),[[Rs,e.active]])]})),{}}}),mR=["color","file","time","date","datetime-local","week","month"],Rg=Pi()({name:"VTextField",directives:{Intersect:Mf},inheritAttrs:!1,props:{autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,hint:String,persistentHint:Boolean,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,type:{type:String,default:"text"},..._a(),...Lg()},emits:{"click:control":e=>!0,"click:input":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,s){let{attrs:a,emit:u,slots:d}=s;const g=bn(e,"modelValue"),{isFocused:x,focus:o,blur:w}=Rc(e),E=ne(()=>{var Y;return typeof e.counterValue=="function"?e.counterValue(g.value):((Y=g.value)!=null?Y:"").toString().length}),k=ne(()=>{if(a.maxlength)return a.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function z(Y,_e){var de,ve;!e.autofocus||!Y||(de=_e[0].target)==null||(ve=de.focus)==null||ve.call(de)}const L=Ke(),O=Ke(),G=Ke(),H=ne(()=>mR.includes(e.type)||e.persistentPlaceholder||x.value),pe=ne(()=>e.messages.length?e.messages:x.value||e.persistentHint?e.hint:"");function se(){if(G.value!==document.activeElement){var Y;(Y=G.value)==null||Y.focus()}x.value||o()}function he(Y){se(),u("click:control",Y)}function K(Y){Y.stopPropagation(),se(),Ui(()=>{g.value=null,Zm(e["onClick:clear"],Y)})}function Te(Y){g.value=Y.target.value}return kt(()=>{const Y=!!(d.counter||e.counter||e.counterValue),_e=!!(Y||d.details),[de,ve]=Ac(a),[{modelValue:Se,...be}]=pl(e),[De]=c0(e);return F(Os,tn({ref:L,modelValue:g.value,"onUpdate:modelValue":ze=>g.value=ze,class:["v-text-field",{"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-text-field--flush-details":["plain","underlined"].includes(e.variant)}],"onClick:prepend":e["onClick:prepend"],"onClick:append":e["onClick:append"]},de,be,{focused:x.value,messages:pe.value}),{...d,default:ze=>{let{id:Je,isDisabled:ct,isDirty:nt,isReadonly:ft,isValid:Pe}=ze;return F(Ff,tn({ref:O,onMousedown:at=>{at.target!==G.value&&at.preventDefault()},"onClick:control":he,"onClick:clear":K,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},De,{id:Je.value,active:H.value||nt.value,dirty:nt.value||e.dirty,focused:x.value,error:Pe.value===!1}),{...d,default:at=>{let{props:{class:jt,...pt}}=at;const zt=ji(F("input",tn({ref:G,value:g.value,onInput:Te,autofocus:e.autofocus,readonly:ft.value,disabled:ct.value,name:e.name,placeholder:e.placeholder,size:1,type:e.type,onFocus:se,onBlur:w},pt,ve),null),[[uo("intersect"),{handler:z},null,{once:!0}]]);return F(On,null,[e.prefix&&F("span",{class:"v-text-field__prefix"},[e.prefix]),d.default?F("div",{class:jt,onClick:Gt=>u("click:input",Gt),"data-no-activator":""},[d.default(),zt]):ha(zt,{class:jt}),e.suffix&&F("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:_e?ze=>{var Je;return F(On,null,[(Je=d.details)==null?void 0:Je.call(d,ze),Y&&F(On,null,[F("span",null,null),F(Dg,{active:e.persistentCounter||x.value,value:E.value,max:k.value},d.counter)])])}:void 0})}),os({},L,O,G)}}),u0=Mn({chips:Boolean,closableChips:Boolean,eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,menu:Boolean,menuIcon:{type:pn,default:"$dropdown"},menuProps:{type:Object},modelValue:null,multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,readonly:Boolean,...p2({itemChildren:!1})},"select"),gR=Pi()({name:"VSelect",props:{...u0(),...ma({transition:{component:xg}})},emits:{"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,s){let{slots:a}=s;const{t:u}=rs(),d=Ke(),g=bn(e,"menu"),{items:x,transformIn:o,transformOut:w}=r0(e),E=bn(e,"modelValue",[],K=>o(Ao(K)),K=>{var Y;const Te=w(K);return e.multiple?Te:(Y=Te[0])!=null?Y:null}),k=ne(()=>E.value.map(K=>x.value.find(Te=>Te.value===K.value)||K)),z=ne(()=>k.value.map(K=>K.props.value)),L=Ke();function O(K){E.value=[],e.openOnClear&&(g.value=!0)}function G(){e.hideNoData&&!x.value.length||e.readonly||(g.value=!g.value)}function H(K){if(!e.readonly){if(["Enter","ArrowDown"," "].includes(K.key)&&(g.value=!0),["Escape","Tab"].includes(K.key)&&(g.value=!1),K.key==="ArrowDown"){var Te;(Te=L.value)==null||Te.focus("next")}else if(K.key==="ArrowUp"){var Y;(Y=L.value)==null||Y.focus("prev")}else if(K.key==="Home"){var _e;(_e=L.value)==null||_e.focus("first")}else if(K.key==="End"){var de;(de=L.value)==null||de.focus("last")}}}function pe(K){if(e.multiple){const Te=z.value.findIndex(Y=>Y===K.value);if(Te===-1)E.value=[...E.value,K];else{const Y=[...E.value];Y.splice(Te,1),E.value=Y}}else E.value=[K],g.value=!1}function se(K){var Te;(Te=L.value)!=null&&Te.$el.contains(K.relatedTarget)||(g.value=!1)}function he(K){if(K.relatedTarget==null){var Te;(Te=d.value)==null||Te.focus()}}return kt(()=>{const K=!!(e.chips||a.chip);return F(Rg,{ref:d,modelValue:E.value.map(Te=>Te.props.value).join(", "),"onUpdate:modelValue":Te=>{Te==null&&(E.value=[])},validationValue:E.externalValue,dirty:E.value.length>0,class:["v-select",{"v-select--active-menu":g.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":E.value.length}],appendInnerIcon:e.menuIcon,readonly:!0,"onClick:clear":O,"onClick:control":G,onBlur:se,onKeydown:H},{...a,default:()=>{var Te,Y,_e;return F(On,null,[F(Of,tn({modelValue:g.value,"onUpdate:modelValue":de=>g.value=de,activator:"parent",contentClass:"v-select__content",eager:e.eager,openOnClick:!1,closeOnContentClick:!1,transition:e.transition},e.menuProps),{default:()=>[F(zf,{ref:L,selected:z.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:de=>de.preventDefault(),onFocusout:he},{default:()=>{var de;return[!x.value.length&&!e.hideNoData&&((de=(Te=a["no-data"])==null?void 0:Te.call(a))!=null?de:F(dr,{title:u(e.noDataText)},null)),(Y=a["prepend-item"])==null?void 0:Y.call(a),x.value.map((ve,Se)=>{var De;var be;return(De=(be=a.item)==null?void 0:be.call(a,{item:ve,index:Se,props:tn(ve.props,{onClick:()=>pe(ve)})}))!=null?De:F(dr,tn({key:Se},ve.props,{onClick:()=>pe(ve)}),{prepend:ze=>{let{isSelected:Je}=ze;return e.multiple&&!e.hideSelected?F(mh,{modelValue:Je,ripple:!1},null):void 0}})}),(_e=a["append-item"])==null?void 0:_e.call(a)]}})]}),k.value.map((de,ve)=>{function Se(De){De.stopPropagation(),De.preventDefault(),pe(de)}const be={"onClick:close":Se,modelValue:!0,"onUpdate:modelValue":void 0};return F("div",{key:de.value,class:"v-select__selection"},[K?F(wi,{defaults:{VChip:{closable:e.closableChips,size:"small",text:de.title}}},{default:()=>[a.chip?a.chip({item:de,index:ve,props:be}):F(Rf,be,null)]}):a.selection?a.selection({item:de,index:ve}):F("span",{class:"v-select__selection-text"},[de.title,e.multiple&&ve<k.value.length-1&&F("span",{class:"v-select__selection-comma"},[al(",")])])])})])}})}),os({menu:g,select:pe},d)}}),vR=(e,s,a)=>e==null||s==null?-1:e.toString().toLocaleLowerCase().indexOf(s.toString().toLocaleLowerCase()),G2=Mn({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function _R(e,s,a){var w,E;const u=[],d=(w=a==null?void 0:a.default)!=null?w:vR,g=a!=null&&a.filterKeys?Ao(a.filterKeys):!1,x=Object.keys((E=a==null?void 0:a.customKeyFilter)!=null?E:{}).length;if(!(e!=null&&e.length))return u;e:for(let k=0;k<e.length;k++){const z=e[k],L={},O={};let G=-1;if(s&&!(a!=null&&a.noFilter)){if(typeof z=="object"){const se=g||Object.keys(z);for(const he of se){var o;const K=Ms(z,he,z),Te=a==null||(o=a.customKeyFilter)==null?void 0:o[he];if(G=Te?Te(K,s,z):d(K,s,z),G!==-1&&G!==!1)Te?L[he]=G:O[he]=G;else if((a==null?void 0:a.filterMode)==="every")continue e}}else G=d(z,s,z),G!==-1&&G!==!1&&(O.title=G);const H=Object.keys(O).length,pe=Object.keys(L).length;if(!H&&!pe||(a==null?void 0:a.filterMode)==="union"&&pe!==x&&!H||(a==null?void 0:a.filterMode)==="intersection"&&(pe!==x||!H))continue}u.push({index:k,matches:{...O,...L}})}return u}function q2(e,s,a){const u=ne(()=>typeof(a==null?void 0:a.value)!="string"&&typeof(a==null?void 0:a.value)!="number"?"":String(a.value));return{filteredItems:ne(()=>{const g=Ai(s);return _R(g,u.value,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}).map(o=>{let{index:w,matches:E}=o;return{item:g[w],matches:E}})})}}function yR(e,s,a){if(Array.isArray(s))throw new Error("Multiple matches is not implemented");return typeof s=="number"&&~s?F(On,null,[F("span",{class:"v-autocomplete__unmask"},[e.substr(0,s)]),F("span",{class:"v-autocomplete__mask"},[e.substr(s,a)]),F("span",{class:"v-autocomplete__unmask"},[e.substr(s+a)])]):e}const xR=Pi()({name:"VAutocomplete",props:{search:String,...G2({filterKeys:["title"]}),...u0(),...ma({transition:!1})},emits:{"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,s){let{slots:a}=s;const{t:u}=rs(),d=Ke(),g=Ke(!1),x=Ke(!0),o=bn(e,"menu"),{items:w,transformIn:E,transformOut:k}=r0(e),z=bn(e,"search",""),L=bn(e,"modelValue",[],be=>E(Ao(be)),be=>{var ze;const De=k(be);return e.multiple?De:(ze=De[0])!=null?ze:null}),{filteredItems:O}=q2(e,w,ne(()=>x.value?void 0:z.value)),G=ne(()=>L.value.map(be=>w.value.find(De=>De.value===be.value)||be)),H=ne(()=>G.value.map(be=>be.props.value)),pe=Ke();function se(be){L.value=[],e.openOnClear&&(o.value=!0),z.value=""}function he(){e.hideNoData&&!w.value.length||e.readonly||(o.value=!0)}function K(be){if(!e.readonly){if(["Enter","ArrowDown"].includes(be.key)&&(o.value=!0),["Escape"].includes(be.key)&&(o.value=!1),["Enter","Escape","Tab"].includes(be.key)&&(x.value=!0),be.key==="ArrowDown"){var De;(De=pe.value)==null||De.focus("next")}else if(be.key==="ArrowUp"){var ze;(ze=pe.value)==null||ze.focus("prev")}}}function Te(be){z.value=be.target.value}function Y(){g.value&&(x.value=!0)}function _e(be){g.value=!0}function de(be){if(be.relatedTarget==null){var De;(De=d.value)==null||De.focus()}}const ve=Ke(!1);function Se(be){if(e.multiple){const De=H.value.findIndex(ze=>ze===be.value);if(De===-1)L.value=[...L.value,be],z.value="";else{const ze=[...L.value];ze.splice(De,1),L.value=ze}}else L.value=[be],ve.value=!0,a.selection||(z.value=be.title),o.value=!1,x.value=!0,Ui(()=>ve.value=!1)}return Ye(g,be=>{var ze;if(be){var De;ve.value=!0,z.value=e.multiple||!!a.selection?"":String((ze=(De=G.value.at(-1))==null?void 0:De.props.title)!=null?ze:""),x.value=!0,Ui(()=>ve.value=!1)}else o.value=!1,z.value=""}),Ye(z,be=>{!g.value||ve.value||(be&&(o.value=!0),x.value=!be)}),kt(()=>{const be=!!(e.chips||a.chip);return F(Rg,{ref:d,modelValue:z.value,"onUpdate:modelValue":De=>{De==null&&(L.value=[])},validationValue:L.externalValue,dirty:L.value.length>0,onInput:Te,class:["v-autocomplete",{"v-autocomplete--active-menu":o.value,"v-autocomplete--chips":!!e.chips,[`v-autocomplete--${e.multiple?"multiple":"single"}`]:!0,"v-autocomplete--selection-slot":!!a.selection}],appendInnerIcon:e.menuIcon,readonly:e.readonly,"onClick:clear":se,"onClick:control":he,"onClick:input":he,onFocus:()=>g.value=!0,onBlur:()=>g.value=!1,onKeydown:K},{...a,default:()=>{var De,ze,Je;return F(On,null,[F(Of,tn({modelValue:o.value,"onUpdate:modelValue":ct=>o.value=ct,activator:"parent",contentClass:"v-autocomplete__content",eager:e.eager,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:Y},e.menuProps),{default:()=>[F(zf,{ref:pe,selected:H.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:ct=>ct.preventDefault(),onFocusin:_e,onFocusout:de},{default:()=>{var ct;return[!O.value.length&&!e.hideNoData&&((ct=(De=a["no-data"])==null?void 0:De.call(a))!=null?ct:F(dr,{title:u(e.noDataText)},null)),(ze=a["prepend-item"])==null?void 0:ze.call(a),O.value.map((nt,ft)=>{var pt;var Pe;let{item:at,matches:jt}=nt;return(pt=(Pe=a.item)==null?void 0:Pe.call(a,{item:at,index:ft,props:tn(at.props,{onClick:()=>Se(at)})}))!=null?pt:F(dr,tn({key:ft},at.props,{onClick:()=>Se(at)}),{prepend:zt=>{let{isSelected:Gt}=zt;return e.multiple&&!e.hideSelected?F(mh,{modelValue:Gt,ripple:!1},null):void 0},title:()=>{var Gt;var zt;return x.value?at.title:yR(at.title,jt.title,(Gt=(zt=z.value)==null?void 0:zt.length)!=null?Gt:0)}})}),(Je=a["append-item"])==null?void 0:Je.call(a)]}})]}),G.value.map((ct,nt)=>{function ft(at){at.stopPropagation(),at.preventDefault(),Se(ct)}const Pe={"onClick:close":ft,modelValue:!0,"onUpdate:modelValue":void 0};return F("div",{key:ct.value,class:"v-autocomplete__selection"},[be?F(wi,{defaults:{VChip:{closable:e.closableChips,size:"small",text:ct.title}}},{default:()=>[a.chip?a.chip({item:ct,index:nt,props:Pe}):F(Rf,Pe,null)]}):a.selection?a.selection({item:ct,index:nt}):F("span",{class:"v-autocomplete__selection-text"},[ct.title,e.multiple&&nt<G.value.length-1&&F("span",{class:"v-autocomplete__selection-comma"},[al(",")])])])})])}})}),os({isFocused:g,isPristine:x,menu:o,search:z,filteredItems:O,select:Se},d)}});const bR=Pt({name:"VBadge",inheritAttrs:!1,props:{bordered:Boolean,color:String,content:[Number,String],dot:Boolean,floating:Boolean,icon:pn,inline:Boolean,label:{type:String,default:"$vuetify.badge"},max:[Number,String],modelValue:{type:Boolean,default:!0},offsetX:[Number,String],offsetY:[Number,String],textColor:String,...Lc({location:"top end"}),...zi(),...wn(),...Xn(),...ma({transition:"scale-rotate-transition"})},setup(e,s){const{backgroundColorClasses:a,backgroundColorStyles:u}=Hi(St(e,"color")),{roundedClasses:d}=Yi(e),{t:g}=rs(),{textColorClasses:x,textColorStyles:o}=no(St(e,"textColor")),{themeClasses:w}=TT(),{locationStyles:E}=Dc(e,!0,k=>{var L,O;return(e.floating?e.dot?2:4:e.dot?8:12)+(["top","bottom"].includes(k)?+((L=e.offsetY)!=null?L:0):["left","right"].includes(k)?+((O=e.offsetX)!=null?O:0):0)});return kt(()=>{var k,z,L,O;const G=Number(e.content),H=!e.max||isNaN(G)?e.content:G<=e.max?G:`${e.max}+`,[pe,se]=Mo(s.attrs,["aria-atomic","aria-label","aria-live","role","title"]);return F(e.tag,tn({class:["v-badge",{"v-badge--bordered":e.bordered,"v-badge--dot":e.dot,"v-badge--floating":e.floating,"v-badge--inline":e.inline}]},se),{default:()=>[F("div",{class:"v-badge__wrapper"},[(k=(z=s.slots).default)==null?void 0:k.call(z),F(Ps,{transition:e.transition},{default:()=>[ji(F("span",tn({class:["v-badge__badge",w.value,a.value,d.value,x.value],style:[u.value,o.value,e.inline?{}:E.value],"aria-atomic":"true","aria-label":g(e.label,G),"aria-live":"polite",role:"status"},pe),[e.dot?void 0:s.slots.badge?(L=(O=s.slots).badge)==null?void 0:L.call(O):e.icon?F(er,{icon:e.icon},null):H]),[[Rs,e.modelValue]])]})])]})}),{}}});const Z2=Pt({name:"VBannerActions",props:{color:String,density:String},setup(e,s){let{slots:a}=s;return ir({VBtn:{color:e.color,density:e.density,variant:"text"}}),kt(()=>{var u;return F("div",{class:"v-banner-actions"},[(u=a.default)==null?void 0:u.call(a)])}),{}}}),W2=Po("v-banner-text"),wR=Pt({name:"VBanner",props:{avatar:String,color:String,icon:pn,lines:String,stacked:Boolean,sticky:Boolean,text:String,...fo(),...mr(),...ns(),...or(),...Lc(),...hh(),...zi(),...wn(),...Xn()},setup(e,s){let{slots:a}=s;const{borderClasses:u}=zo(e),{densityClasses:d}=Ur(e),{mobile:g}=Ig(),{dimensionStyles:x}=is(e),{elevationClasses:o}=kr(e),{locationStyles:w}=Dc(e),{positionClasses:E}=dh(e),{roundedClasses:k}=Yi(e),{themeClasses:z}=vi(e),L=St(e,"color"),O=St(e,"density");ir({VBannerActions:{color:L,density:O}}),kt(()=>{var G;const H=!!(e.text||a.text),pe=!!(a.prepend||e.avatar||e.icon);return F(e.tag,{class:["v-banner",{"v-banner--stacked":e.stacked||g.value,"v-banner--sticky":e.sticky,[`v-banner--${e.lines}-line`]:!!e.lines},u.value,d.value,o.value,E.value,k.value,z.value],style:[x.value,w.value],role:"banner"},{default:()=>[pe&&F(wi,{key:"prepend",defaults:{VAvatar:{color:L.value,density:O.value,icon:e.icon,image:e.avatar}}},{default:()=>[F("div",{class:"v-banner__prepend"},[a.prepend?a.prepend():(e.avatar||e.icon)&&F(cl,null,null)])]}),F("div",{class:"v-banner__content"},[H&&F(W2,{key:"text"},{default:()=>[a.text?a.text():e.text]}),(G=a.default)==null?void 0:G.call(a)]),a.actions&&F(Z2,null,{default:()=>[a.actions()]})]})})}});const SR=Pt({name:"VBottomNavigation",props:{bgColor:String,color:String,grow:Boolean,mode:{type:String,validator:e=>!e||["horizontal","shift"].includes(e)},height:{type:[Number,String],default:56},...fo(),...mr(),...or(),...zi(),...sh({name:"bottom-navigation"}),...wn({tag:"header"}),...lh({modelValue:!0,selectedClass:"v-btn--selected"}),...Xn()},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const{themeClasses:u}=TT(),{borderClasses:d}=zo(e),{backgroundColorClasses:g,backgroundColorStyles:x}=Hi(St(e,"bgColor")),{densityClasses:o}=Ur(e),{elevationClasses:w}=kr(e),{roundedClasses:E}=Yi(e),k=ne(()=>Number(e.height)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0)),z=bn(e,"modelValue"),{layoutItemStyles:L}=ah({id:e.name,order:ne(()=>parseInt(e.order,10)),position:ne(()=>"bottom"),layoutSize:ne(()=>z.value?k.value:0),elementSize:k,active:z,absolute:St(e,"absolute")});return zc(e,Hy),ir({VBtn:{color:St(e,"color"),density:St(e,"density"),stacked:ne(()=>e.mode!=="horizontal"),variant:"text"}},{scoped:!0}),kt(()=>F(e.tag,{class:["v-bottom-navigation",{"v-bottom-navigation--active":z.value,"v-bottom-navigation--grow":e.grow,"v-bottom-navigation--shift":e.mode==="shift"},u.value,g.value,d.value,o.value,w.value,E.value],style:[x.value,L.value,{height:Xt(k.value),transform:`translateY(${Xt(z.value?0:100,"%")})`}]},{default:()=>[a.default&&F("div",{class:"v-bottom-navigation__content"},[a.default()])]})),{}}});const H2=Po("v-breadcrumbs-divider","li"),X2=Pt({name:"VBreadcrumbsItem",props:{active:Boolean,activeClass:String,activeColor:String,color:String,disabled:Boolean,title:String,...fh(),...wn({tag:"li"})},setup(e,s){let{slots:a,attrs:u}=s;const d=Pf(e,u),g=ne(()=>{var E;return e.active||((E=d.isActive)==null?void 0:E.value)}),x=ne(()=>g.value?e.activeColor:e.color),{textColorClasses:o,textColorStyles:w}=no(x);return kt(()=>{var E;const k=d.isLink.value?"a":e.tag;return F(k,{class:["v-breadcrumbs-item",{"v-breadcrumbs-item--active":g.value,"v-breadcrumbs-item--disabled":e.disabled,"v-breadcrumbs-item--link":d.isLink.value,[`${e.activeClass}`]:g.value&&e.activeClass},o.value],style:[w.value],href:d.href.value,"aria-current":g.value?"page":void 0,onClick:d.navigate},{default:()=>{var z;return[(z=(E=a.default)==null?void 0:E.call(a))!=null?z:e.title]}})}),{}}}),TR=Pi()({name:"VBreadcrumbs",props:{activeClass:String,activeColor:String,bgColor:String,color:String,disabled:Boolean,divider:{type:String,default:"/"},icon:pn,items:{type:Array,default:()=>[]},...mr(),...zi(),...wn({tag:"ul"})},setup(e,s){let{slots:a}=s;const{backgroundColorClasses:u,backgroundColorStyles:d}=Hi(St(e,"bgColor")),{densityClasses:g}=Ur(e),{roundedClasses:x}=Yi(e);return ir({VBreadcrumbsItem:{activeClass:St(e,"activeClass"),activeColor:St(e,"activeColor"),color:St(e,"color"),disabled:St(e,"disabled")}}),kt(()=>{var o;const w=!!(a.prepend||e.icon);return F(e.tag,{class:["v-breadcrumbs",u.value,g.value,x.value],style:d.value},{default:()=>[w&&F(wi,{key:"prepend",defaults:{VIcon:{icon:e.icon,start:!0}}},{default:()=>[F("div",{class:"v-breadcrumbs__prepend"},[a.prepend?a.prepend():e.icon&&F(er,null,null)])]}),e.items.map((E,k,z)=>{var L;return F(On,null,[F(X2,tn({key:k,disabled:k>=z.length-1},typeof E=="string"?{title:E}:E),{default:a.title?()=>{var O;return(O=a.title)==null?void 0:O.call(a,{item:E,index:k})}:void 0}),k<z.length-1&&F(H2,null,{default:()=>{var O;return[(O=(L=a.divider)==null?void 0:L.call(a,{item:E,index:k}))!=null?O:e.divider]}})])}),(o=a.default)==null?void 0:o.call(a)]})}),{}}});const ER=e=>{const{touchstartX:s,touchendX:a,touchstartY:u,touchendY:d}=e,g=.5,x=16;e.offsetX=a-s,e.offsetY=d-u,Math.abs(e.offsetY)<g*Math.abs(e.offsetX)&&(e.left&&a<s-x&&e.left(e),e.right&&a>s+x&&e.right(e)),Math.abs(e.offsetX)<g*Math.abs(e.offsetY)&&(e.up&&d<u-x&&e.up(e),e.down&&d>u+x&&e.down(e))};function CR(e,s){var a;const u=e.changedTouches[0];s.touchstartX=u.clientX,s.touchstartY=u.clientY,(a=s.start)==null||a.call(s,{originalEvent:e,...s})}function IR(e,s){var a;const u=e.changedTouches[0];s.touchendX=u.clientX,s.touchendY=u.clientY,(a=s.end)==null||a.call(s,{originalEvent:e,...s}),ER(s)}function AR(e,s){var a;const u=e.changedTouches[0];s.touchmoveX=u.clientX,s.touchmoveY=u.clientY,(a=s.move)==null||a.call(s,{originalEvent:e,...s})}function kR(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:a=>CR(a,s),touchend:a=>IR(a,s),touchmove:a=>AR(a,s)}}function MR(e,s){var w,E;var a;const u=s.value,d=u!=null&&u.parent?e.parentElement:e,g=(w=u==null?void 0:u.options)!=null?w:{passive:!0},x=(a=s.instance)==null?void 0:a.$.uid;if(!d||!x)return;const o=kR(s.value);d._touchHandlers=(E=d._touchHandlers)!=null?E:Object.create(null),d._touchHandlers[x]=o,tT(o).forEach(k=>{d.addEventListener(k,o[k],g)})}function PR(e,s){var a,u;const d=(a=s.value)!=null&&a.parent?e.parentElement:e,g=(u=s.instance)==null?void 0:u.$.uid;if(!(d!=null&&d._touchHandlers)||!g)return;const x=d._touchHandlers[g];tT(x).forEach(o=>{d.removeEventListener(o,x[o])}),delete d._touchHandlers[g]}const h0={mounted:MR,unmounted:PR},Y2=Symbol.for("vuetify:v-window"),K2=Symbol.for("vuetify:v-window-group"),J2=Pi()({name:"VWindow",directives:{Touch:h0},props:{continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{default:"force"},...wn(),...Xn()},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const{themeClasses:u}=vi(e),{isRtl:d}=va(),{t:g}=rs(),x=zc(e,K2),o=Ke(),w=ne(()=>d.value?!e.reverse:e.reverse),E=Ke(!1),k=ne(()=>{const Te=e.direction==="vertical"?"y":"x",_e=(w.value?!E.value:E.value)?"-reverse":"";return`v-window-${Te}${_e}-transition`}),z=Ke(0),L=Ke(void 0),O=ne(()=>x.items.value.findIndex(Te=>x.selected.value.includes(Te.id)));Ye(O,(Te,Y)=>{const _e=x.items.value.length,de=_e-1;_e<=2?E.value=Te<Y:Te===de&&Y===0?E.value=!0:Te===0&&Y===de?E.value=!1:E.value=Te<Y}),Ni(Y2,{transition:k,isReversed:E,transitionCount:z,transitionHeight:L,rootRef:o});const G=ne(()=>e.continuous||O.value!==0),H=ne(()=>e.continuous||O.value!==x.items.value.length-1);function pe(){G.value&&x.prev()}function se(){H.value&&x.next()}const he=ne(()=>{const Te=[],Y={icon:d.value?e.nextIcon:e.prevIcon,class:`v-window__${w.value?"right":"left"}`,onClick:x.prev,ariaLabel:g("$vuetify.carousel.prev")};Te.push(G.value?a.prev?a.prev({props:Y}):F(bi,Y,null):F("div",null,null));const _e={icon:d.value?e.prevIcon:e.nextIcon,class:`v-window__${w.value?"left":"right"}`,onClick:x.next,ariaLabel:g("$vuetify.carousel.next")};return Te.push(H.value?a.next?a.next({props:_e}):F(bi,_e,null):F("div",null,null)),Te}),K=ne(()=>e.touch===!1?e.touch:{...{left:()=>{w.value?pe():se()},right:()=>{w.value?se():pe()},start:Y=>{let{originalEvent:_e}=Y;_e.stopPropagation()}},...e.touch===!0?{}:e.touch});return kt(()=>{var Te,Y;return ji(F(e.tag,{ref:o,class:["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover"},u.value]},{default:()=>[F("div",{class:"v-window__container",style:{height:L.value}},[(Te=a.default)==null?void 0:Te.call(a,{group:x}),e.showArrows!==!1&&F("div",{class:"v-window__controls"},[he.value])]),(Y=a.additional)==null?void 0:Y.call(a,{group:x})]}),[[uo("touch"),K.value]])}),{group:x}}}),Q2=Pt({name:"VWindowItem",directives:{Touch:h0},props:{reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Pc(),...Mg()},emits:{"group:selected":e=>!0},setup(e,s){let{slots:a}=s;const u=ln(Y2),d=ch(e,K2),{isBooted:g}=t0();if(!u||!d)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const x=Ke(!1),o=ne(()=>u.isReversed.value?e.reverseTransition!==!1:e.transition!==!1);function w(){!x.value||!u||(x.value=!1,u.transitionCount.value>0&&(u.transitionCount.value-=1,u.transitionCount.value===0&&(u.transitionHeight.value=void 0)))}function E(){if(!(x.value||!u)){if(x.value=!0,u.transitionCount.value===0){var G;u.transitionHeight.value=Xt((G=u.rootRef.value)==null?void 0:G.clientHeight)}u.transitionCount.value+=1}}function k(){w()}function z(G){!x.value||Ui(()=>{!o.value||!x.value||!u||(u.transitionHeight.value=Xt(G.clientHeight))})}const L=ne(()=>{const G=u.isReversed.value?e.reverseTransition:e.transition;return o.value?{name:typeof G!="string"?u.transition.value:G,onBeforeEnter:E,onAfterEnter:w,onEnterCancelled:k,onBeforeLeave:E,onAfterLeave:w,onLeaveCancelled:k,onEnter:z}:!1}),{hasContent:O}=l0(e,d.isSelected);return kt(()=>{var G;return F(Ps,{transition:g.value&&L.value},{default:()=>[ji(F("div",{class:["v-window-item",d.selectedClass.value]},[O.value&&((G=a.default)==null?void 0:G.call(a))]),[[Rs,d.isSelected.value]])]})}),{}}}),zR=Pt({name:"VCarousel",props:{color:String,cycle:Boolean,delimiterIcon:{type:pn,default:"$delimiter"},height:{type:[Number,String],default:500},hideDelimiters:Boolean,hideDelimiterBackground:Boolean,interval:{type:[Number,String],default:6e3,validator:e=>e>0},modelValue:null,progress:[Boolean,String],showArrows:{type:[Boolean,String],default:!0,validator:e=>typeof e=="boolean"||e==="hover"},verticalDelimiters:[Boolean,String]},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=bn(e,"modelValue"),{t:d}=rs(),g=Ke();let x=-1;Ye(u,w),Ye(()=>e.interval,w),Ye(()=>e.cycle,E=>{E?w():window.clearTimeout(x)}),kn(o);function o(){!e.cycle||!g.value||(x=window.setTimeout(g.value.group.next,+e.interval>0?+e.interval:6e3))}function w(){window.clearTimeout(x),window.requestAnimationFrame(o)}return kt(()=>F(J2,{ref:g,modelValue:u.value,"onUpdate:modelValue":E=>u.value=E,class:["v-carousel",{"v-carousel--hide-delimiter-background":e.hideDelimiterBackground,"v-carousel--vertical-delimiters":e.verticalDelimiters}],style:{height:Xt(e.height)},continuous:!0,mandatory:"force",showArrows:e.showArrows},{default:a.default,additional:E=>{let{group:k}=E;return F(On,null,[!e.hideDelimiters&&F("div",{class:"v-carousel__controls",style:{left:e.verticalDelimiters==="left"&&e.verticalDelimiters?0:"auto",right:e.verticalDelimiters==="right"?0:"auto"}},[k.items.value.length>0&&F(wi,{defaults:{VBtn:{color:e.color,icon:e.delimiterIcon,size:"x-small",variant:"text"}},scoped:!0},{default:()=>[k.items.value.map((z,L)=>{const O={"aria-label":d("$vuetify.carousel.ariaLabel.delimiter",L+1,k.items.value.length),class:[k.isSelected(z.id)&&"v-btn--active"],onClick:()=>k.select(z.id,!0)};return a.item?a.item({props:O,item:z}):F(bi,tn(z,O),null)})]})]),e.progress&&F(Ky,{class:"v-carousel__progress",color:typeof e.progress=="string"?e.progress:void 0,modelValue:(k.getItemIndex(u.value)+1)/k.items.value.length*100},null)])},prev:a.prev,next:a.next})),{}}}),LR=Pt({name:"VCarouselItem",inheritAttrs:!1,props:{value:null},setup(e,s){let{slots:a,attrs:u}=s;kt(()=>F(Q2,{class:"v-carousel-item",value:e.value},{default:()=>[F(oh,u,a)]}))}});const DR=Po("v-code");const RR=Pt({name:"VColorPickerCanvas",props:{color:{type:Object},disabled:Boolean,dotSize:{type:[Number,String],default:10},height:{type:[Number,String],default:150},width:{type:[Number,String],default:300}},emits:{"update:color":e=>!0,"update:position":e=>!0},setup(e,s){let{emit:a}=s;const u=Ke(!1),d=Ke(!1),g=Ke({x:0,y:0}),x=ne(()=>{const{x:G,y:H}=g.value,pe=parseInt(e.dotSize,10)/2;return{width:Xt(e.dotSize),height:Xt(e.dotSize),transform:`translate(${Xt(G-pe)}, ${Xt(H-pe)})`}}),o=Ke();function w(G,H,pe){const{left:se,top:he,width:K,height:Te}=pe;g.value={x:Eo(G-se,0,K),y:Eo(H-he,0,Te)}}function E(G){e.disabled||!o.value||w(G.clientX,G.clientY,o.value.getBoundingClientRect())}function k(G){G.preventDefault(),!e.disabled&&(u.value=!0,window.addEventListener("mousemove",z),window.addEventListener("mouseup",L),window.addEventListener("touchmove",z),window.addEventListener("touchend",L))}function z(G){if(e.disabled||!o.value)return;u.value=!0;const H=UM(G);w(H.clientX,H.clientY,o.value.getBoundingClientRect())}function L(){window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",L),window.removeEventListener("touchmove",z),window.removeEventListener("touchend",L)}Ye(g,()=>{var Te,Y;var G,H;if(d.value){d.value=!1;return}if(!o.value)return;const{width:pe,height:se}=o.value.getBoundingClientRect(),{x:he,y:K}=g.value;a("update:color",{h:(Te=(G=e.color)==null?void 0:G.h)!=null?Te:0,s:Eo(he,0,pe)/pe,v:1-Eo(K,0,se)/se,a:(Y=(H=e.color)==null?void 0:H.a)!=null?Y:1})});function O(){var K;var G;if(!o.value)return;const H=o.value,pe=H.getContext("2d");if(!pe)return;const se=pe.createLinearGradient(0,0,H.width,0);se.addColorStop(0,"hsla(0, 0%, 100%, 1)"),se.addColorStop(1,`hsla(${(K=(G=e.color)==null?void 0:G.h)!=null?K:0}, 100%, 50%, 1)`),pe.fillStyle=se,pe.fillRect(0,0,H.width,H.height);const he=pe.createLinearGradient(0,0,0,H.height);he.addColorStop(0,"hsla(0, 0%, 100%, 0)"),he.addColorStop(1,"hsla(0, 0%, 0%, 1)"),pe.fillStyle=he,pe.fillRect(0,0,H.width,H.height)}return Ye(()=>{var G;return(G=e.color)==null?void 0:G.h},O,{immediate:!0}),Ye(()=>e.color,()=>{if(u.value){u.value=!1;return}!e.color||(d.value=!0,g.value={x:e.color.s*parseInt(e.width,10),y:(1-e.color.v)*parseInt(e.height,10)})},{deep:!0,immediate:!0}),kn(()=>O()),kt(()=>F("div",{class:"v-color-picker-canvas",style:{width:Xt(e.width),height:Xt(e.height)},onClick:E,onMousedown:k,onTouchstart:k},[F("canvas",{ref:o,width:e.width,height:e.height},null),F("div",{class:["v-color-picker-canvas__dot",{"v-color-picker-canvas__dot--disabled":e.disabled}],style:x.value},null)])),{}}});var Cw;function _c(e,s){return s.every(a=>e.hasOwnProperty(a))}function eE(e){var a;if(!e)return null;let s=null;if(typeof e=="string"){const u=rP(e);s=dT(u)}return typeof e=="object"&&(_c(e,["r","g","b"])?s=Uy(e):_c(e,["h","s","l"])?s=uT(e):_c(e,["h","s","v"])&&(s=e)),s!=null?{...s,a:(a=s.a)!=null?a:1}:null}function BR(e,s){if(s){const{a,...u}=e;return u}return e}function OR(e,s){if(s==null||typeof s=="string"){const a=fT(e);return e.a===1?a.slice(0,7):a}if(typeof s=="object"){let a;return _c(s,["r","g","b"])?a=yg(e):_c(s,["h","s","l"])?a=cT(e):_c(s,["h","s","v"])&&(a=e),BR(a,!_c(s,["a"]))}return e}const Om={h:0,s:0,v:1,a:1},ty={inputProps:{type:"number",min:0},inputs:[{label:"R",max:255,step:1,getValue:e=>Math.round(e.r),getColor:(e,s)=>({...e,r:Number(s)})},{label:"G",max:255,step:1,getValue:e=>Math.round(e.g),getColor:(e,s)=>({...e,g:Number(s)})},{label:"B",max:255,step:1,getValue:e=>Math.round(e.b),getColor:(e,s)=>({...e,b:Number(s)})},{label:"A",max:1,step:.01,getValue:e=>Math.round(e.a*100)/100,getColor:(e,s)=>({...e,a:Number(s)})}],to:yg,from:Uy},FR={...ty,inputs:(Cw=ty.inputs)==null?void 0:Cw.slice(0,3)},ny={inputProps:{type:"number",min:0},inputs:[{label:"H",max:360,step:1,getValue:e=>Math.round(e.h),getColor:(e,s)=>({...e,h:Number(s)})},{label:"S",max:1,step:.01,getValue:e=>Math.round(e.s*100)/100,getColor:(e,s)=>({...e,s:Number(s)})},{label:"L",max:1,step:.01,getValue:e=>Math.round(e.l*100)/100,getColor:(e,s)=>({...e,l:Number(s)})},{label:"A",max:1,step:.01,getValue:e=>Math.round(e.a*100)/100,getColor:(e,s)=>({...e,a:Number(s)})}],to:cT,from:uT},VR={...ny,inputs:ny.inputs.slice(0,3)},tE={inputProps:{type:"text"},inputs:[{label:"HEXA",getValue:e=>e,getColor:(e,s)=>s}],to:fT,from:dT},$R={...tE,inputs:[{label:"HEX",getValue:e=>e.slice(0,7),getColor:(e,s)=>s}]},yc={rgb:FR,rgba:ty,hsl:VR,hsla:ny,hex:$R,hexa:tE},NR=e=>{let{label:s,...a}=e;return F("div",{class:"v-color-picker-edit__input"},[F("input",a,null),F("span",null,[s])])},UR=Pt({name:"VColorPickerEdit",props:{color:Object,disabled:Boolean,mode:{type:String,default:"rgba",validator:e=>Object.keys(yc).includes(e)},modes:{type:Array,default:()=>Object.keys(yc),validator:e=>Array.isArray(e)&&e.every(s=>Object.keys(yc).includes(s))}},emits:{"update:color":e=>!0,"update:mode":e=>!0},setup(e,s){let{emit:a}=s;const u=ne(()=>e.modes.map(g=>({...yc[g],name:g}))),d=ne(()=>{var g;const x=u.value.find(w=>w.name===e.mode);if(!x)return[];const o=e.color?x.to(e.color):{};return(g=x.inputs)==null?void 0:g.map(w=>{let{getValue:E,getColor:k,...z}=w;return{...x.inputProps,...z,disabled:e.disabled,value:E(o),onChange:L=>{const O=L.target;!O||a("update:color",x.from(k(o,O.value)))}}})});return kt(()=>{var g;return F("div",{class:"v-color-picker-edit"},[(g=d.value)==null?void 0:g.map(x=>F(NR,x,null)),u.value.length>1&&F(bi,{icon:"$unfold",size:"x-small",variant:"plain",onClick:()=>{const x=u.value.findIndex(o=>o.name===e.mode);a("update:mode",u.value[(x+1)%u.value.length].name)}},null)])}),{}}});const d0=Symbol.for("vuetify:v-slider");function iy(e,s,a){const u=a==="vertical",d=s.getBoundingClientRect(),g="touches"in e?e.touches[0]:e;return u?g.clientY-(d.top+d.height/2):g.clientX-(d.left+d.width/2)}function jR(e,s){return"touches"in e&&e.touches.length?e.touches[0][s]:"changedTouches"in e&&e.changedTouches.length?e.changedTouches[0][s]:e[s]}const nE=Mn({disabled:Boolean,error:Boolean,readonly:Boolean,max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:0},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:e=>typeof e=="boolean"||e==="always"},thumbSize:{type:[Number,String],default:20},showTicks:{type:[Boolean,String],default:!1,validator:e=>typeof e=="boolean"||e==="always"},ticks:{type:[Array,Object]},tickSize:{type:[Number,String],default:2},color:String,trackColor:String,trackFillColor:String,trackSize:{type:[Number,String],default:4},direction:{type:String,default:"horizontal",validator:e=>["vertical","horizontal"].includes(e)},reverse:Boolean,...zi(),...or({elevation:2})},"slider"),iE=e=>{let{props:s,handleSliderMouseUp:a,handleMouseMove:u,getActiveThumb:d}=e;const{isRtl:g}=va(),x=ne(()=>g.value!==s.reverse),o=ne(()=>{let At=g.value?"rtl":"ltr";return s.reverse&&(At=At==="rtl"?"ltr":"rtl"),At}),w=ne(()=>parseFloat(s.min)),E=ne(()=>parseFloat(s.max)),k=ne(()=>s.step>0?parseFloat(s.step):0),z=ne(()=>{const At=k.value.toString().trim();return At.includes(".")?At.length-At.indexOf(".")-1:0}),L=ne(()=>parseInt(s.thumbSize,10)),O=ne(()=>parseInt(s.tickSize,10)),G=ne(()=>parseInt(s.trackSize,10)),H=ne(()=>(E.value-w.value)/k.value),pe=St(s,"disabled"),se=ne(()=>s.direction==="vertical"),he=ne(()=>{var At;return s.error||s.disabled?void 0:(At=s.thumbColor)!=null?At:s.color}),K=ne(()=>{var At;return s.error||s.disabled?void 0:(At=s.trackColor)!=null?At:s.color}),Te=ne(()=>{var At;return s.error||s.disabled?void 0:(At=s.trackFillColor)!=null?At:s.color}),Y=Ke(!1),_e=Ke(0),de=Ke(),ve=Ke();function Se(At){if(k.value<=0)return At;const Qe=Eo(At,w.value,E.value),xt=w.value%k.value,Tt=Math.round((Qe-xt)/k.value)*k.value+xt;return parseFloat(Math.min(Tt,E.value).toFixed(z.value))}function be(At){var Qe;const xt=s.direction==="vertical",Tt=xt?"top":"left",Nt=xt?"height":"width",fn=xt?"clientY":"clientX",{[Tt]:Dn,[Nt]:gn}=(Qe=de.value)==null?void 0:Qe.$el.getBoundingClientRect(),ue=jR(At,fn);let Me=Math.min(Math.max((ue-Dn-_e.value)/gn,0),1)||0;return(xt||x.value)&&(Me=1-Me),Se(w.value+Me*(E.value-w.value))}let De=!1;const ze=At=>{De||(_e.value=0,a(be(At))),Y.value=!1,De=!1,_e.value=0},Je=At=>{ve.value=d(At),ve.value&&(ve.value.focus(),Y.value=!0,ve.value.contains(At.target)?(De=!0,_e.value=iy(At,ve.value,s.direction)):(_e.value=0,u(be(At))))},ct={passive:!0,capture:!0};function nt(At){De=!0,u(be(At))}function ft(At){At.stopPropagation(),At.preventDefault(),ze(At),window.removeEventListener("mousemove",nt,ct),window.removeEventListener("mouseup",ft)}function Pe(At){var Qe;ze(At),window.removeEventListener("touchmove",nt,ct),(Qe=At.target)==null||Qe.removeEventListener("touchend",Pe)}function at(At){var Qe;Je(At),window.addEventListener("touchmove",nt,ct),(Qe=At.target)==null||Qe.addEventListener("touchend",Pe,{passive:!1})}function jt(At){At.preventDefault(),Je(At),window.addEventListener("mousemove",nt,ct),window.addEventListener("mouseup",ft,{passive:!1})}const pt=At=>{const Qe=(At-w.value)/(E.value-w.value)*100;return Eo(isNaN(Qe)?0:Qe,0,100)},zt=ne(()=>s.ticks?Array.isArray(s.ticks)?s.ticks.map(At=>({value:At,position:pt(At),label:At.toString()})):Object.keys(s.ticks).map(At=>({value:parseFloat(At),position:pt(parseFloat(At)),label:s.ticks[At]})):H.value!==1/0?gc(H.value+1).map(At=>{const Qe=w.value+At*k.value;return{value:Qe,position:pt(Qe)}}):[]),Gt=ne(()=>zt.value.some(At=>{let{label:Qe}=At;return!!Qe})),zn={activeThumbRef:ve,color:St(s,"color"),decimals:z,disabled:pe,direction:St(s,"direction"),elevation:St(s,"elevation"),hasLabels:Gt,horizontalDirection:o,isReversed:x,min:w,max:E,mousePressed:Y,numTicks:H,onSliderMousedown:jt,onSliderTouchstart:at,parsedTicks:zt,parseMouseMove:be,position:pt,readonly:St(s,"readonly"),rounded:St(s,"rounded"),roundValue:Se,showTicks:St(s,"showTicks"),startOffset:_e,step:k,thumbSize:L,thumbColor:he,thumbLabel:St(s,"thumbLabel"),ticks:St(s,"ticks"),tickSize:O,trackColor:K,trackContainerRef:de,trackFillColor:Te,trackSize:G,vertical:se};return Ni(d0,zn),zn},ry=Pt({name:"VSliderThumb",directives:{Ripple:fl},props:{focused:Boolean,max:{type:Number,required:!0},min:{type:Number,required:!0},modelValue:{type:Number,required:!0},position:{type:Number,required:!0}},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a,emit:u}=s;const d=ln(d0);if(!d)throw new Error("[Vuetify] v-slider-thumb must be used inside v-slider or v-range-slider");const{thumbColor:g,step:x,vertical:o,disabled:w,thumbSize:E,thumbLabel:k,direction:z,readonly:L,elevation:O,isReversed:G,horizontalDirection:H,mousePressed:pe,decimals:se}=d,{textColorClasses:he,textColorStyles:K}=no(g),{pageup:Te,pagedown:Y,end:_e,home:de,left:ve,right:Se,down:be,up:De}=B_,ze=[Te,Y,_e,de,ve,Se,be,De],Je=ne(()=>x.value?[1,2,3]:[1,5,10]);function ct(ft,Pe){if(!ze.includes(ft.key))return;ft.preventDefault();const at=x.value||.1,jt=(e.max-e.min)/at;if([ve,Se,be,De].includes(ft.key)){const zt=(G.value?[ve,De]:[Se,De]).includes(ft.key)?1:-1,Gt=ft.shiftKey?2:ft.ctrlKey?1:0;Pe=Pe+zt*at*Je.value[Gt]}else if(ft.key===de)Pe=e.min;else if(ft.key===_e)Pe=e.max;else{const pt=ft.key===Y?1:-1;Pe=Pe-pt*at*(jt>100?jt/10:10)}return Math.max(e.min,Math.min(e.max,Pe))}function nt(ft){const Pe=ct(ft,e.modelValue);Pe!=null&&u("update:modelValue",Pe)}return kt(()=>{var ft;const Pe=Xt(o.value?100-e.position:e.position,"%"),at=o.value?"block":"inline",{elevationClasses:jt}=kr(ne(()=>w.value?void 0:O.value));return F("div",{class:["v-slider-thumb",{"v-slider-thumb--focused":e.focused,"v-slider-thumb--pressed":e.focused&&pe.value}],style:{[`inset-${at}-start`]:`calc(${Pe} - var(--v-slider-thumb-size) / 2)`,"--v-slider-thumb-size":Xt(E.value),direction:o.value?void 0:H.value},role:"slider",tabindex:w.value?-1:0,"aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.modelValue,"aria-readonly":L.value,"aria-orientation":z.value,onKeydown:L.value?void 0:nt},[F("div",{class:["v-slider-thumb__surface",he.value,jt.value],style:{...K.value}},null),ji(F("div",{class:["v-slider-thumb__ripple",he.value],style:K.value},null),[[uo("ripple"),!0,null,{circle:!0,center:!0}]]),F(bT,{origin:"bottom center"},{default:()=>{var pt;return[ji(F("div",{class:"v-slider-thumb__label-container"},[F("div",{class:["v-slider-thumb__label"]},[F("div",null,[(pt=(ft=a["thumb-label"])==null?void 0:ft.call(a,{modelValue:e.modelValue}))!=null?pt:e.modelValue.toFixed(x.value?se.value:1)])])]),[[Rs,k.value&&e.focused||k.value==="always"]])]}})])}),{}}});const rE=Pt({name:"VSliderTrack",props:{start:{type:Number,required:!0},stop:{type:Number,required:!0}},emits:{},setup(e,s){let{slots:a}=s;const u=ln(d0);if(!u)throw new Error("[Vuetify] v-slider-track must be inside v-slider or v-range-slider");const{color:d,horizontalDirection:g,parsedTicks:x,rounded:o,showTicks:w,tickSize:E,trackColor:k,trackFillColor:z,trackSize:L,vertical:O,min:G,max:H}=u,{roundedClasses:pe}=Yi(o),{backgroundColorClasses:se,backgroundColorStyles:he}=Hi(z),{backgroundColorClasses:K,backgroundColorStyles:Te}=Hi(k),Y=ne(()=>`inset-${O.value?"block-end":"inline-start"}`),_e=ne(()=>O.value?"height":"width"),de=ne(()=>({[Y.value]:"0%",[_e.value]:"100%"})),ve=ne(()=>e.stop-e.start),Se=ne(()=>({[Y.value]:Xt(e.start,"%"),[_e.value]:Xt(ve.value,"%")})),be=ne(()=>(O.value?x.value.slice().reverse():x.value).map((ze,Je)=>{var Pe;var ct;const nt=O.value?"bottom":"margin-inline-start",ft=ze.value!==G.value&&ze.value!==H.value?Xt(ze.position,"%"):void 0;return F("div",{key:ze.value,class:["v-slider-track__tick",{"v-slider-track__tick--filled":ze.position>=e.start&&ze.position<=e.stop,"v-slider-track__tick--first":ze.value===G.value,"v-slider-track__tick--last":ze.value===H.value}],style:{[nt]:ft}},[(ze.label||a["tick-label"])&&F("div",{class:"v-slider-track__tick-label"},[(Pe=(ct=a["tick-label"])==null?void 0:ct.call(a,{tick:ze,index:Je}))!=null?Pe:ze.label])])}));return kt(()=>F("div",{class:["v-slider-track",pe.value],style:{"--v-slider-track-size":Xt(L.value),"--v-slider-tick-size":Xt(E.value),direction:O.value?void 0:g.value}},[F("div",{class:["v-slider-track__background",K.value,{"v-slider-track__background--opacity":!!d.value||!z.value}],style:{...de.value,...Te.value}},null),F("div",{class:["v-slider-track__fill",se.value],style:{...Se.value,...he.value}},null),w.value&&F("div",{class:["v-slider-track__ticks",{"v-slider-track__ticks--always-show":w.value==="always"}]},[be.value])])),{}}}),ng=Pt({name:"VSlider",props:{...Ag(),...nE(),..._a(),modelValue:{type:[Number,String],default:0}},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=Ke(),{min:d,max:g,mousePressed:x,roundValue:o,onSliderMousedown:w,onSliderTouchstart:E,trackContainerRef:k,position:z,hasLabels:L,readonly:O}=iE({props:e,handleSliderMouseUp:K=>G.value=o(K),handleMouseMove:K=>G.value=o(K),getActiveThumb:()=>{var K;return(K=u.value)==null?void 0:K.$el}}),G=bn(e,"modelValue",void 0,K=>{const Te=typeof K=="string"?parseFloat(K):K==null?d.value:K;return o(Te)}),{isFocused:H,focus:pe,blur:se}=Rc(e),he=ne(()=>z(G.value));return kt(()=>{const[K,Te]=pl(e),Y=!!(e.label||a.label||a.prepend);return F(Os,tn({class:["v-slider",{"v-slider--has-labels":!!a["tick-label"]||L.value,"v-slider--focused":H.value,"v-slider--pressed":x.value,"v-slider--disabled":e.disabled}]},K,{focused:H.value}),{...a,prepend:Y?_e=>{var Se;var de,ve;return F(On,null,[((Se=(de=a.label)==null?void 0:de.call(a,_e))!=null?Se:e.label)?F(ph,{class:"v-slider__label",text:e.label},null):void 0,(ve=a.prepend)==null?void 0:ve.call(a,_e)])}:void 0,default:_e=>{let{id:de}=_e;return F("div",{class:"v-slider__container",onMousedown:O.value?void 0:w,onTouchstartPassive:O.value?void 0:E},[F("input",{id:de.value,name:e.name||de.value,disabled:e.disabled,readonly:e.readonly,tabindex:"-1",value:G.value},null),F(rE,{ref:k,start:0,stop:he.value},{"tick-label":a["tick-label"]}),F(ry,{ref:u,focused:H.value,min:d.value,max:g.value,modelValue:G.value,"onUpdate:modelValue":ve=>G.value=ve,position:he.value,elevation:e.elevation,onFocus:pe,onBlur:se},{"thumb-label":a["thumb-label"]})])}})}),{}}}),GR=Pt({name:"VColorPickerPreview",props:{color:{type:Object},disabled:Boolean,hideAlpha:Boolean},emits:{"update:color":e=>!0},setup(e,s){let{emit:a}=s;return kt(()=>{var g;var u,d;return F("div",{class:["v-color-picker-preview",{"v-color-picker-preview--hide-alpha":e.hideAlpha}]},[F("div",{class:"v-color-picker-preview__dot"},[F("div",{style:{background:hT((g=e.color)!=null?g:Om)}},null)]),F("div",{class:"v-color-picker-preview__sliders"},[F(ng,{class:"v-color-picker-preview__track v-color-picker-preview__hue",modelValue:(u=e.color)==null?void 0:u.h,"onUpdate:modelValue":x=>{var o;return a("update:color",{...(o=e.color)!=null?o:Om,h:x})},step:0,min:0,max:360,disabled:e.disabled,thumbSize:14,trackSize:8,trackFillColor:"white",hideDetails:!0},null),!e.hideAlpha&&F(ng,{class:"v-color-picker-preview__track v-color-picker-preview__alpha",modelValue:(d=e.color)==null?void 0:d.a,"onUpdate:modelValue":x=>{var o;return a("update:color",{...(o=e.color)!=null?o:Om,a:x})},step:0,min:0,max:1,disabled:e.disabled,thumbSize:14,trackSize:8,trackFillColor:"white",hideDetails:!0},null)])])}),{}}});const qR=Object.freeze({base:"#f44336",lighten5:"#ffebee",lighten4:"#ffcdd2",lighten3:"#ef9a9a",lighten2:"#e57373",lighten1:"#ef5350",darken1:"#e53935",darken2:"#d32f2f",darken3:"#c62828",darken4:"#b71c1c",accent1:"#ff8a80",accent2:"#ff5252",accent3:"#ff1744",accent4:"#d50000"}),ZR=Object.freeze({base:"#e91e63",lighten5:"#fce4ec",lighten4:"#f8bbd0",lighten3:"#f48fb1",lighten2:"#f06292",lighten1:"#ec407a",darken1:"#d81b60",darken2:"#c2185b",darken3:"#ad1457",darken4:"#880e4f",accent1:"#ff80ab",accent2:"#ff4081",accent3:"#f50057",accent4:"#c51162"}),WR=Object.freeze({base:"#9c27b0",lighten5:"#f3e5f5",lighten4:"#e1bee7",lighten3:"#ce93d8",lighten2:"#ba68c8",lighten1:"#ab47bc",darken1:"#8e24aa",darken2:"#7b1fa2",darken3:"#6a1b9a",darken4:"#4a148c",accent1:"#ea80fc",accent2:"#e040fb",accent3:"#d500f9",accent4:"#aa00ff"}),HR=Object.freeze({base:"#673ab7",lighten5:"#ede7f6",lighten4:"#d1c4e9",lighten3:"#b39ddb",lighten2:"#9575cd",lighten1:"#7e57c2",darken1:"#5e35b1",darken2:"#512da8",darken3:"#4527a0",darken4:"#311b92",accent1:"#b388ff",accent2:"#7c4dff",accent3:"#651fff",accent4:"#6200ea"}),XR=Object.freeze({base:"#3f51b5",lighten5:"#e8eaf6",lighten4:"#c5cae9",lighten3:"#9fa8da",lighten2:"#7986cb",lighten1:"#5c6bc0",darken1:"#3949ab",darken2:"#303f9f",darken3:"#283593",darken4:"#1a237e",accent1:"#8c9eff",accent2:"#536dfe",accent3:"#3d5afe",accent4:"#304ffe"}),YR=Object.freeze({base:"#2196f3",lighten5:"#e3f2fd",lighten4:"#bbdefb",lighten3:"#90caf9",lighten2:"#64b5f6",lighten1:"#42a5f5",darken1:"#1e88e5",darken2:"#1976d2",darken3:"#1565c0",darken4:"#0d47a1",accent1:"#82b1ff",accent2:"#448aff",accent3:"#2979ff",accent4:"#2962ff"}),KR=Object.freeze({base:"#03a9f4",lighten5:"#e1f5fe",lighten4:"#b3e5fc",lighten3:"#81d4fa",lighten2:"#4fc3f7",lighten1:"#29b6f6",darken1:"#039be5",darken2:"#0288d1",darken3:"#0277bd",darken4:"#01579b",accent1:"#80d8ff",accent2:"#40c4ff",accent3:"#00b0ff",accent4:"#0091ea"}),JR=Object.freeze({base:"#00bcd4",lighten5:"#e0f7fa",lighten4:"#b2ebf2",lighten3:"#80deea",lighten2:"#4dd0e1",lighten1:"#26c6da",darken1:"#00acc1",darken2:"#0097a7",darken3:"#00838f",darken4:"#006064",accent1:"#84ffff",accent2:"#18ffff",accent3:"#00e5ff",accent4:"#00b8d4"}),QR=Object.freeze({base:"#009688",lighten5:"#e0f2f1",lighten4:"#b2dfdb",lighten3:"#80cbc4",lighten2:"#4db6ac",lighten1:"#26a69a",darken1:"#00897b",darken2:"#00796b",darken3:"#00695c",darken4:"#004d40",accent1:"#a7ffeb",accent2:"#64ffda",accent3:"#1de9b6",accent4:"#00bfa5"}),eB=Object.freeze({base:"#4caf50",lighten5:"#e8f5e9",lighten4:"#c8e6c9",lighten3:"#a5d6a7",lighten2:"#81c784",lighten1:"#66bb6a",darken1:"#43a047",darken2:"#388e3c",darken3:"#2e7d32",darken4:"#1b5e20",accent1:"#b9f6ca",accent2:"#69f0ae",accent3:"#00e676",accent4:"#00c853"}),tB=Object.freeze({base:"#8bc34a",lighten5:"#f1f8e9",lighten4:"#dcedc8",lighten3:"#c5e1a5",lighten2:"#aed581",lighten1:"#9ccc65",darken1:"#7cb342",darken2:"#689f38",darken3:"#558b2f",darken4:"#33691e",accent1:"#ccff90",accent2:"#b2ff59",accent3:"#76ff03",accent4:"#64dd17"}),nB=Object.freeze({base:"#cddc39",lighten5:"#f9fbe7",lighten4:"#f0f4c3",lighten3:"#e6ee9c",lighten2:"#dce775",lighten1:"#d4e157",darken1:"#c0ca33",darken2:"#afb42b",darken3:"#9e9d24",darken4:"#827717",accent1:"#f4ff81",accent2:"#eeff41",accent3:"#c6ff00",accent4:"#aeea00"}),iB=Object.freeze({base:"#ffeb3b",lighten5:"#fffde7",lighten4:"#fff9c4",lighten3:"#fff59d",lighten2:"#fff176",lighten1:"#ffee58",darken1:"#fdd835",darken2:"#fbc02d",darken3:"#f9a825",darken4:"#f57f17",accent1:"#ffff8d",accent2:"#ffff00",accent3:"#ffea00",accent4:"#ffd600"}),rB=Object.freeze({base:"#ffc107",lighten5:"#fff8e1",lighten4:"#ffecb3",lighten3:"#ffe082",lighten2:"#ffd54f",lighten1:"#ffca28",darken1:"#ffb300",darken2:"#ffa000",darken3:"#ff8f00",darken4:"#ff6f00",accent1:"#ffe57f",accent2:"#ffd740",accent3:"#ffc400",accent4:"#ffab00"}),oB=Object.freeze({base:"#ff9800",lighten5:"#fff3e0",lighten4:"#ffe0b2",lighten3:"#ffcc80",lighten2:"#ffb74d",lighten1:"#ffa726",darken1:"#fb8c00",darken2:"#f57c00",darken3:"#ef6c00",darken4:"#e65100",accent1:"#ffd180",accent2:"#ffab40",accent3:"#ff9100",accent4:"#ff6d00"}),sB=Object.freeze({base:"#ff5722",lighten5:"#fbe9e7",lighten4:"#ffccbc",lighten3:"#ffab91",lighten2:"#ff8a65",lighten1:"#ff7043",darken1:"#f4511e",darken2:"#e64a19",darken3:"#d84315",darken4:"#bf360c",accent1:"#ff9e80",accent2:"#ff6e40",accent3:"#ff3d00",accent4:"#dd2c00"}),aB=Object.freeze({base:"#795548",lighten5:"#efebe9",lighten4:"#d7ccc8",lighten3:"#bcaaa4",lighten2:"#a1887f",lighten1:"#8d6e63",darken1:"#6d4c41",darken2:"#5d4037",darken3:"#4e342e",darken4:"#3e2723"}),lB=Object.freeze({base:"#607d8b",lighten5:"#eceff1",lighten4:"#cfd8dc",lighten3:"#b0bec5",lighten2:"#90a4ae",lighten1:"#78909c",darken1:"#546e7a",darken2:"#455a64",darken3:"#37474f",darken4:"#263238"}),cB=Object.freeze({base:"#9e9e9e",lighten5:"#fafafa",lighten4:"#f5f5f5",lighten3:"#eeeeee",lighten2:"#e0e0e0",lighten1:"#bdbdbd",darken1:"#757575",darken2:"#616161",darken3:"#424242",darken4:"#212121"}),uB=Object.freeze({black:"#000000",white:"#ffffff",transparent:"#ffffff00"}),hB=Object.freeze({red:qR,pink:ZR,purple:WR,deepPurple:HR,indigo:XR,blue:YR,lightBlue:KR,cyan:JR,teal:QR,green:eB,lightGreen:tB,lime:nB,yellow:iB,amber:rB,orange:oB,deepOrange:sB,brown:aB,blueGrey:lB,grey:cB,shades:uB});function dB(e){return Object.keys(e).map(s=>{const a=e[s];return a.base?[a.base,a.darken4,a.darken3,a.darken2,a.darken1,a.lighten1,a.lighten2,a.lighten3,a.lighten4,a.lighten5]:[a.black,a.white,a.transparent]})}const fB=Pt({name:"VColorPickerSwatches",props:{swatches:{type:Array,default:()=>dB(hB)},disabled:Boolean,color:Object,maxHeight:[Number,String]},emits:{"update:color":e=>!0},setup(e,s){let{emit:a}=s;return kt(()=>F("div",{class:"v-color-picker-swatches",style:{maxHeight:Xt(e.maxHeight)}},[F("div",null,[e.swatches.map(u=>F("div",{class:"v-color-picker-swatches__swatch"},[u.map(d=>{const g=eE(d);return F("div",{class:"v-color-picker-swatches__color",onClick:()=>g&&a("update:color",g)},[F("div",{style:{background:d}},[e.color&&kf(e.color,g)?F(er,{size:"x-small",icon:"$success",color:aP(d,"#FFFFFF")>2?"white":"black"},null):void 0])])})]))])])),{}}});const oE=Pt({name:"VSheet",props:{color:String,...fo(),...ns(),...or(),...Lc(),...hh(),...zi(),...wn(),...Xn()},setup(e,s){let{slots:a}=s;const{themeClasses:u}=vi(e),{backgroundColorClasses:d,backgroundColorStyles:g}=Hi(St(e,"color")),{borderClasses:x}=zo(e),{dimensionStyles:o}=is(e),{elevationClasses:w}=kr(e),{locationStyles:E}=Dc(e),{positionClasses:k}=dh(e),{roundedClasses:z}=Yi(e);return()=>F(e.tag,{class:["v-sheet",u.value,d.value,x.value,w.value,k.value,z.value],style:[g.value,o.value,E.value]},a)}}),pB=Pt({name:"VColorPicker",inheritAttrs:!1,props:{canvasHeight:{type:[String,Number],default:150},disabled:Boolean,dotSize:{type:[Number,String],default:10},hideCanvas:Boolean,hideSliders:Boolean,hideInputs:Boolean,mode:{type:String,default:"rgba",validator:e=>Object.keys(yc).includes(e)},modes:{type:Array,default:()=>Object.keys(yc),validator:e=>Array.isArray(e)&&e.every(s=>Object.keys(yc).includes(s))},showSwatches:Boolean,swatches:Array,swatchesMaxHeight:{type:[Number,String],default:150},modelValue:{type:[Object,String]},width:{type:[Number,String],default:300},...or(),...zi(),...Xn()},emits:{"update:modelValue":e=>!0,"update:mode":e=>!0},setup(e){const s=bn(e,"mode"),a=Ke(null),u=bn(e,"modelValue",void 0,g=>{let x=eE(g);return x?(a.value&&(x={...x,h:a.value.h},a.value=null),x):null},g=>g?OR(g,e.modelValue):null),d=g=>{u.value=g,a.value=g};return kn(()=>{e.modes.includes(s.value)||(s.value=e.modes[0])}),kt(()=>{var g;return F(oE,{rounded:e.rounded,elevation:e.elevation,theme:e.theme,class:["v-color-picker"],style:{"--v-color-picker-color-hsv":hT({...(g=u.value)!=null?g:Om,a:1})},maxWidth:e.width},{default:()=>[!e.hideCanvas&&F(RR,{key:"canvas",color:u.value,"onUpdate:color":d,disabled:e.disabled,dotSize:e.dotSize,width:e.width,height:e.canvasHeight},null),(!e.hideSliders||!e.hideInputs)&&F("div",{key:"controls",class:"v-color-picker__controls"},[!e.hideSliders&&F(GR,{key:"preview",color:u.value,"onUpdate:color":d,hideAlpha:!s.value.endsWith("a"),disabled:e.disabled},null),!e.hideInputs&&F(UR,{key:"edit",modes:e.modes,mode:s.value,"onUpdate:mode":x=>s.value=x,color:u.value,"onUpdate:color":d,disabled:e.disabled},null)]),e.showSwatches&&F(fB,{key:"swatches",color:u.value,"onUpdate:color":d,maxHeight:e.swatchesMaxHeight,swatches:e.swatches,disabled:e.disabled},null)]})}),{}}});function mB(e,s,a){if(Array.isArray(s))throw new Error("Multiple matches is not implemented");return typeof s=="number"&&~s?F(On,null,[F("span",{class:"v-combobox__unmask"},[e.substr(0,s)]),F("span",{class:"v-combobox__mask"},[e.substr(s,a)]),F("span",{class:"v-combobox__unmask"},[e.substr(s+a)])]):e}const gB=Pi()({name:"VCombobox",props:{delimiters:Array,...G2({filterKeys:["title"]}),...u0({hideNoData:!0,returnObject:!0}),...ma({transition:!1})},emits:{"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,s){var ft;var a;let{emit:u,slots:d}=s;const{t:g}=rs(),x=Ke(),o=Ke(!1),w=Ke(!0),E=bn(e,"menu"),k=Ke(-1),z=ne(()=>{var Pe;return(Pe=x.value)==null?void 0:Pe.color}),{items:L,transformIn:O,transformOut:G}=r0(e),{textColorClasses:H,textColorStyles:pe}=no(z),se=bn(e,"modelValue",[],Pe=>O(Ao(Pe||[])),Pe=>{var jt;const at=G(Pe);return e.multiple?at:(jt=at[0])!=null?jt:null}),he=Ke(e.multiple?"":(ft=(a=se.value[0])==null?void 0:a.title)!=null?ft:""),K=ne({get:()=>he.value,set:Pe=>{var at;if(he.value=Pe,e.multiple||(se.value=[Hu(e,Pe)]),Pe&&e.multiple&&(at=e.delimiters)!=null&&at.length){const jt=Pe.split(new RegExp(`(?:${e.delimiters.join("|")})+`));jt.length>1&&(jt.forEach(pt=>{pt=pt.trim(),pt&&Je(Hu(e,pt))}),he.value="")}Pe||(k.value=-1),o.value&&(E.value=!0),w.value=!Pe}});Ye(he,Pe=>{u("update:search",Pe)}),Ye(se,Pe=>{var jt;if(!e.multiple){var at;he.value=(jt=(at=Pe[0])==null?void 0:at.title)!=null?jt:""}});const{filteredItems:Te}=q2(e,L,ne(()=>w.value?void 0:K.value)),Y=ne(()=>se.value.map(Pe=>L.value.find(at=>at.value===Pe.value)||Pe)),_e=ne(()=>Y.value.map(Pe=>Pe.props.value)),de=ne(()=>Y.value[k.value]),ve=Ke();function Se(Pe){se.value=[],e.openOnClear&&(E.value=!0)}function be(){e.hideNoData&&!L.value.length||e.readonly||(E.value=!0)}function De(Pe){if(e.readonly)return;const at=x.value.selectionStart,jt=_e.value.length;if(k.value>-1&&Pe.preventDefault(),["Enter","ArrowDown"].includes(Pe.key)&&(E.value=!0),["Escape"].includes(Pe.key)&&(E.value=!1),["Enter","Escape","Tab"].includes(Pe.key)&&(w.value=!0),Pe.key==="ArrowDown"){var pt;(pt=ve.value)==null||pt.focus("next")}else if(Pe.key==="ArrowUp"){var zt;(zt=ve.value)==null||zt.focus("prev")}if(!!e.multiple){if(["Backspace","Delete"].includes(Pe.key)){if(k.value<0){Pe.key==="Backspace"&&!K.value&&(k.value=jt-1);return}Je(de.value),Ui(()=>!de.value&&(k.value=jt-2))}if(Pe.key==="ArrowLeft"){if(k.value<0&&at>0)return;const Gt=k.value>-1?k.value-1:jt-1;Y.value[Gt]?k.value=Gt:(k.value=-1,x.value.setSelectionRange(K.value.length,K.value.length))}if(Pe.key==="ArrowRight"){if(k.value<0)return;const Gt=k.value+1;Y.value[Gt]?k.value=Gt:(k.value=-1,x.value.setSelectionRange(0,0))}Pe.key==="Enter"&&(Je(Hu(e,K.value)),K.value="")}}function ze(){o.value&&(w.value=!0)}function Je(Pe){if(e.multiple){const at=_e.value.findIndex(jt=>jt===Pe.value);if(at===-1)se.value=[...se.value,Pe];else{const jt=[...se.value];jt.splice(at,1),se.value=jt}K.value=""}else se.value=[Pe],he.value=Pe.title,Ui(()=>{E.value=!1,w.value=!0})}function ct(Pe){o.value=!0}function nt(Pe){if(Pe.relatedTarget==null){var at;(at=x.value)==null||at.focus()}}return Ye(Te,Pe=>{!Pe.length&&e.hideNoData&&(E.value=!1)}),Ye(o,Pe=>{if(Pe)k.value=-1;else{if(E.value=!1,!e.multiple||!K.value)return;se.value=[...se.value,Hu(e,K.value)],K.value=""}}),kt(()=>{const Pe=!!(e.chips||d.chip);return F(Rg,{ref:x,modelValue:K.value,"onUpdate:modelValue":[at=>K.value=at,at=>{at==null&&(se.value=[])}],validationValue:se.externalValue,dirty:se.value.length>0,class:["v-combobox",{"v-combobox--active-menu":E.value,"v-combobox--chips":!!e.chips,"v-combobox--selecting-index":k.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0}],appendInnerIcon:e.items.length?e.menuIcon:void 0,readonly:e.readonly,"onClick:clear":Se,"onClick:control":be,"onClick:input":be,onFocus:()=>o.value=!0,onBlur:()=>o.value=!1,onKeydown:De},{...d,default:()=>{var at,jt,pt;return F(On,null,[F(Of,tn({modelValue:E.value,"onUpdate:modelValue":zt=>E.value=zt,activator:"parent",contentClass:"v-combobox__content",eager:e.eager,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ze},e.menuProps),{default:()=>[F(zf,{ref:ve,selected:_e.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:zt=>zt.preventDefault(),onFocusin:ct,onFocusout:nt},{default:()=>{var zt;return[!Te.value.length&&!e.hideNoData&&((zt=(at=d["no-data"])==null?void 0:at.call(d))!=null?zt:F(dr,{title:g(e.noDataText)},null)),(jt=d["prepend-item"])==null?void 0:jt.call(d),Te.value.map((Gt,zn)=>{var Tt;var At;let{item:Qe,matches:xt}=Gt;return(Tt=(At=d.item)==null?void 0:At.call(d,{item:Qe,index:zn,props:tn(Qe.props,{onClick:()=>Je(Qe)})}))!=null?Tt:F(dr,tn({key:zn},Qe.props,{onClick:()=>Je(Qe)}),{prepend:Nt=>{let{isSelected:fn}=Nt;return e.multiple&&!e.hideSelected?F(mh,{modelValue:fn,ripple:!1},null):void 0},title:()=>{var fn;var Nt;return w.value?Qe.title:mB(Qe.title,xt.title,(fn=(Nt=K.value)==null?void 0:Nt.length)!=null?fn:0)}})}),(pt=d["append-item"])==null?void 0:pt.call(d)]}})]}),Y.value.map((zt,Gt)=>{function zn(Qe){Qe.stopPropagation(),Qe.preventDefault(),Je(zt)}const At={"onClick:close":zn,modelValue:!0,"onUpdate:modelValue":void 0};return F("div",{key:zt.value,class:["v-combobox__selection",Gt===k.value&&["v-combobox__selection--selected",H.value]],style:Gt===k.value?pe.value:{}},[Pe?F(wi,{defaults:{VChip:{closable:e.closableChips,size:"small",text:zt.title}}},{default:()=>[d.chip?d.chip({item:zt,index:Gt,props:At}):F(Rf,At,null)]}):d.selection?d.selection({item:zt,index:Gt}):F("span",{class:"v-combobox__selection-text"},[zt.title,e.multiple&&Gt<Y.value.length-1&&F("span",{class:"v-combobox__selection-comma"},[al(",")])])])})])}})}),os({isFocused:o,isPristine:w,menu:E,search:K,selectionIndex:k,filteredItems:Te,select:Je},x)}});const vB=Pi()({name:"VDialog",props:{fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...Bf({origin:"center center",scrollStrategy:"block",transition:{component:xg},zIndex:2400})},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=bn(e,"modelValue"),{scopeId:d}=zg(),g=Ke();function x(o){var w,E;const k=o.relatedTarget,z=o.target;if(k!==z&&(w=g.value)!=null&&w.contentEl&&(E=g.value)!=null&&E.globalTop&&![document,g.value.contentEl].includes(z)&&!g.value.contentEl.contains(z)){const L=[...g.value.contentEl.querySelectorAll('button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])')].filter(H=>!H.hasAttribute("disabled")&&!H.matches('[tabindex="-1"]'));if(!L.length)return;const O=L[0],G=L[L.length-1];k===O?G.focus():O.focus()}}return Mi&&Ye(()=>u.value&&e.retainFocus,o=>{o?document.addEventListener("focusin",x):document.removeEventListener("focusin",x)},{immediate:!0}),Ye(u,async o=>{if(await Ui(),o){var w;(w=g.value.contentEl)==null||w.focus({preventScroll:!0})}else{var E;(E=g.value.activatorEl)==null||E.focus({preventScroll:!0})}}),kt(()=>{const[o]=Pg(e);return F(gh,tn({ref:g,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable}]},o,{modelValue:u.value,"onUpdate:modelValue":w=>u.value=w,"aria-role":"dialog","aria-modal":"true",activatorProps:tn({"aria-haspopup":"dialog","aria-expanded":String(u.value)},e.activatorProps)},d),{activator:a.activator,default:function(){for(var w,E=arguments.length,k=new Array(E),z=0;z<E;z++)k[z]=arguments[z];return F(wi,{root:!0},{default:()=>[(w=a.default)==null?void 0:w.call(a,...k)]})}})}),os({},g)}});const Sf=Symbol.for("vuetify:v-expansion-panel"),_B=["default","accordion","inset","popout"],yB=Pt({name:"VExpansionPanels",props:{color:String,variant:{type:String,default:"default",validator:e=>_B.includes(e)},readonly:Boolean,...lh(),...wn(),...Xn()},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;zc(e,Sf);const{themeClasses:u}=vi(e),d=ne(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return ir({VExpansionPanel:{color:St(e,"color")},VExpansionPanelTitle:{readonly:St(e,"readonly")}}),kt(()=>F(e.tag,{class:["v-expansion-panels",u.value,d.value]},a)),{}}}),sE=Mn({color:String,expandIcon:{type:pn,default:"$expand"},collapseIcon:{type:pn,default:"$collapse"},hideActions:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean},"VExpansionPanelTitle"),aE=Pt({name:"VExpansionPanelTitle",directives:{Ripple:fl},props:{...sE()},setup(e,s){let{slots:a}=s;const u=ln(Sf);if(!u)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:d,backgroundColorStyles:g}=Hi(e,"color"),x=ne(()=>({collapseIcon:e.collapseIcon,disabled:u.disabled.value,expanded:u.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return kt(()=>{var o;return ji(F("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":u.isSelected.value},d.value],style:g.value,type:"button",tabindex:u.disabled.value?-1:void 0,disabled:u.disabled.value,"aria-expanded":u.isSelected.value,onClick:e.readonly?void 0:u.toggle},[F("span",{class:"v-expansion-panel-title__overlay"},null),(o=a.default)==null?void 0:o.call(a,x.value),!e.hideActions&&F("span",{class:"v-expansion-panel-title__icon"},[a.actions?a.actions(x.value):F(er,{icon:u.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[uo("ripple"),e.ripple]])}),{}}}),lE=Pt({name:"VExpansionPanelText",props:{...Mg()},setup(e,s){let{slots:a}=s;const u=ln(Sf);if(!u)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:d,onAfterLeave:g}=l0(e,u.isSelected);return kt(()=>{var x;return F(bg,{onAfterLeave:g},{default:()=>[ji(F("div",{class:"v-expansion-panel-text"},[a.default&&d.value&&F("div",{class:"v-expansion-panel-text__wrapper"},[(x=a.default)==null?void 0:x.call(a)])]),[[Rs,u.isSelected.value]])]})}),{}}}),xB=Pt({name:"VExpansionPanel",props:{title:String,text:String,bgColor:String,...or(),...Pc(),...Mg(),...zi(),...wn(),...sE()},emits:{"group:selected":e=>!0},setup(e,s){let{slots:a}=s;const u=ch(e,Sf),{backgroundColorClasses:d,backgroundColorStyles:g}=Hi(e,"bgColor"),{elevationClasses:x}=kr(e),{roundedClasses:o}=Yi(e),w=ne(()=>(u==null?void 0:u.disabled.value)||e.disabled),E=ne(()=>u.group.items.value.reduce((L,O,G)=>(u.group.selected.value.includes(O.id)&&L.push(G),L),[])),k=ne(()=>{const L=u.group.items.value.findIndex(O=>O.id===u.id);return!u.isSelected.value&&E.value.some(O=>O-L===1)}),z=ne(()=>{const L=u.group.items.value.findIndex(O=>O.id===u.id);return!u.isSelected.value&&E.value.some(O=>O-L===-1)});return Ni(Sf,u),kt(()=>{var L;const O=!!(a.text||e.text),G=!!(a.title||e.title);return F(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":u.isSelected.value,"v-expansion-panel--before-active":k.value,"v-expansion-panel--after-active":z.value,"v-expansion-panel--disabled":w.value},o.value,d.value],style:g.value,"aria-expanded":u.isSelected.value},{default:()=>[F("div",{class:["v-expansion-panel__shadow",...x.value]},null),G&&F(aE,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[a.title?a.title():e.title]}),O&&F(lE,{key:"text",eager:e.eager},{default:()=>[a.text?a.text():e.text]}),(L=a.default)==null?void 0:L.call(a)]})}),{}}});const bB=Pt({name:"VFileInput",inheritAttrs:!1,props:{chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,hint:String,persistentHint:Boolean,placeholder:String,showSize:{type:[Boolean,Number],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(e)},..._a({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>Ao(e).every(s=>s!=null&&typeof s=="object")},...Lg({clearable:!0})},emits:{"click:control":e=>!0,"update:modelValue":e=>!0},setup(e,s){let{attrs:a,emit:u,slots:d}=s;const{t:g}=rs(),x=bn(e,"modelValue"),o=ne(()=>typeof e.showSize!="boolean"?e.showSize:void 0),w=ne(()=>{var Y;return((Y=x.value)!=null?Y:[]).reduce((_e,de)=>{let{size:ve=0}=de;return _e+ve},0)}),E=ne(()=>zb(w.value,o.value)),k=ne(()=>{var Y;return((Y=x.value)!=null?Y:[]).map(_e=>{const{name:de="",size:ve=0}=_e;return e.showSize?`${de} (${zb(ve,o.value)})`:de})}),z=ne(()=>{var de;var Y;const _e=(de=(Y=x.value)==null?void 0:Y.length)!=null?de:0;return e.showSize?g(e.counterSizeString,_e,E.value):g(e.counterString,_e)}),L=Ke(),O=Ke(),G=Ke(!1),H=Ke(),pe=ne(()=>e.messages.length?e.messages:e.persistentHint?e.hint:"");function se(){if(H.value!==document.activeElement){var Y;(Y=H.value)==null||Y.focus()}G.value||(G.value=!0)}function he(Y){Zm(e["onClick:prepend"],Y),K(Y)}function K(Y){var _e;(_e=H.value)==null||_e.click(),u("click:control",Y)}function Te(Y){Y.stopPropagation(),se(),Ui(()=>{x.value=[],H!=null&&H.value&&(H.value.value=""),Zm(e["onClick:clear"],Y)})}return kt(()=>{const Y=!!(d.counter||e.counter),_e=!!(Y||d.details),[de,ve]=Ac(a),[{modelValue:Se,...be}]=pl(e),[De]=c0(e);return F(Os,tn({ref:L,modelValue:x.value,"onUpdate:modelValue":ze=>x.value=ze,class:"v-file-input","onClick:prepend":he,"onClick:append":e["onClick:append"]},de,be,{focused:G.value,messages:pe.value}),{...d,default:ze=>{let{isDisabled:Je,isDirty:ct,isReadonly:nt,isValid:ft}=ze;return F(Ff,tn({ref:O,"prepend-icon":e.prependIcon,"onClick:control":K,"onClick:clear":Te,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},De,{active:ct.value||G.value,dirty:ct.value,focused:G.value,error:ft.value===!1}),{...d,default:Pe=>{let{props:{class:at,...jt}}=Pe;return F(On,null,[F("input",tn({ref:H,type:"file",readonly:nt.value,disabled:Je.value,multiple:e.multiple,name:e.name,onClick:pt=>{pt.stopPropagation(),se()},onChange:pt=>{var Gt;if(!pt.target)return;const zt=pt.target;x.value=[...(Gt=zt.files)!=null?Gt:[]]},onFocus:se,onBlur:()=>G.value=!1},jt,ve),null),F("div",{class:at},[x.value.length>0&&(d.selection?d.selection({fileNames:k.value,totalBytes:w.value,totalBytesReadable:E.value}):e.chips?k.value.map(pt=>F(Rf,{key:pt,size:"small",color:e.color},{default:()=>[pt]})):k.value.join(", "))])])}})},details:_e?ze=>{var Je;return F(On,null,[(Je=d.details)==null?void 0:Je.call(d,ze),Y&&F(On,null,[F("span",null,null),F(Dg,{active:!!x.value.length,value:z.value},d.counter)])])}:void 0})}),os({},L,O,H)}});const wB=Pt({name:"VFooter",props:{app:Boolean,color:String,height:{type:[Number,String],default:"auto"},...fo(),...or(),...sh(),...zi(),...wn({tag:"footer"}),...Xn()},setup(e,s){let{slots:a}=s;const{themeClasses:u}=vi(e),{backgroundColorClasses:d,backgroundColorStyles:g}=Hi(St(e,"color")),{borderClasses:x}=zo(e),{elevationClasses:o}=kr(e),{roundedClasses:w}=Yi(e),E=Ke(32),{resizeRef:k}=Tc(O=>{!O.length||(E.value=O[0].target.clientHeight)}),z=ne(()=>e.height==="auto"?E.value:parseInt(e.height,10)),{layoutItemStyles:L}=ah({id:e.name,order:ne(()=>parseInt(e.order,10)),position:ne(()=>"bottom"),layoutSize:z,elementSize:ne(()=>e.height==="auto"?void 0:z.value),active:ne(()=>e.app),absolute:St(e,"absolute")});return kt(()=>F(e.tag,{ref:k,class:["v-footer",u.value,d.value,x.value,o.value,w.value],style:[g,e.app?L.value:void 0]},a)),{}}}),SB=Pt({name:"VForm",props:{...UD()},emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,s){let{slots:a,emit:u}=s;const d=jD(e),g=Ke();function x(w){w.preventDefault(),d.reset()}function o(w){const E=w,k=d.validate();E.then=k.then.bind(k),E.catch=k.catch.bind(k),E.finally=k.finally.bind(k),u("submit",E),E.defaultPrevented||k.then(z=>{let{valid:L}=z;if(L){var O;(O=g.value)==null||O.submit()}}),E.preventDefault()}return kt(()=>{var w;return F("form",{ref:g,class:"v-form",novalidate:!0,onReset:x,onSubmit:o},[(w=a.default)==null?void 0:w.call(a,d)])}),os(d,g)}});const TB=Pt({name:"VContainer",props:{fluid:{type:Boolean,default:!1},...wn()},setup(e,s){let{slots:a}=s;return kt(()=>F(e.tag,{class:["v-container",{"v-container--fluid":e.fluid}]},a)),{}}}),f0=["sm","md","lg","xl","xxl"],cE=(()=>f0.reduce((e,s)=>(e[s]={type:[Boolean,String,Number],default:!1},e),{}))(),uE=(()=>f0.reduce((e,s)=>(e["offset"+dl(s)]={type:[String,Number],default:null},e),{}))(),hE=(()=>f0.reduce((e,s)=>(e["order"+dl(s)]={type:[String,Number],default:null},e),{}))(),Iw={col:Object.keys(cE),offset:Object.keys(uE),order:Object.keys(hE)};function EB(e,s,a){let u=e;if(!(a==null||a===!1)){if(s){const d=s.replace(e,"");u+=`-${d}`}return e==="col"&&(u="v-"+u),e==="col"&&(a===""||a===!0)||(u+=`-${a}`),u.toLowerCase()}}const CB=["auto","start","end","center","baseline","stretch"],ig=Pt({name:"VCol",props:{cols:{type:[Boolean,String,Number],default:!1},...cE,offset:{type:[String,Number],default:null},...uE,order:{type:[String,Number],default:null},...hE,alignSelf:{type:String,default:null,validator:e=>CB.includes(e)},...wn()},setup(e,s){let{slots:a}=s;const u=ne(()=>{const d=[];let g;for(g in Iw)Iw[g].forEach(o=>{const w=e[o],E=EB(g,o,w);E&&d.push(E)});const x=d.some(o=>o.startsWith("v-col-"));return d.push({"v-col":!x||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),d});return()=>{var d;return Ds(e.tag,{class:u.value},(d=a.default)==null?void 0:d.call(a))}}}),IB=["sm","md","lg","xl","xxl"],p0=["start","end","center"],dE=["space-between","space-around","space-evenly"];function m0(e,s){return IB.reduce((a,u)=>(a[e+dl(u)]=s(),a),{})}const AB=[...p0,"baseline","stretch"],fE=e=>AB.includes(e),pE=m0("align",()=>({type:String,default:null,validator:fE})),kB=[...p0,...dE],mE=e=>kB.includes(e),gE=m0("justify",()=>({type:String,default:null,validator:mE})),MB=[...p0,...dE,"stretch"],vE=e=>MB.includes(e),_E=m0("alignContent",()=>({type:String,default:null,validator:vE})),Aw={align:Object.keys(pE),justify:Object.keys(gE),alignContent:Object.keys(_E)},PB={align:"align",justify:"justify",alignContent:"align-content"};function zB(e,s,a){let u=PB[e];if(a!=null){if(s){const d=s.replace(e,"");u+=`-${d}`}return u+=`-${a}`,u.toLowerCase()}}const yE=Pt({name:"VRow",props:{dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:fE},...pE,justify:{type:String,default:null,validator:mE},...gE,alignContent:{type:String,default:null,validator:vE},..._E,...wn()},setup(e,s){let{slots:a}=s;const u=ne(()=>{const d=[];let g;for(g in Aw)Aw[g].forEach(x=>{const o=e[x],w=zB(g,x,o);w&&d.push(w)});return d.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),d});return()=>{var d;return Ds(e.tag,{class:["v-row",u.value]},(d=a.default)==null?void 0:d.call(a))}}}),LB=Po("flex-grow-1","div","VSpacer"),DB=Pt({name:"VHover",props:{disabled:Boolean,modelValue:{type:Boolean,default:void 0},...O2()},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=bn(e,"modelValue"),{runOpenDelay:d,runCloseDelay:g}=F2(e,x=>!e.disabled&&(u.value=x));return()=>{var x;return(x=a.default)==null?void 0:x.call(a,{isHovering:u.value,props:{onMouseenter:d,onMouseleave:g}})}}});const xE=Symbol.for("vuetify:v-item-group"),RB=Pt({name:"VItemGroup",props:{...lh({selectedClass:"v-item--selected"}),...wn(),...Xn()},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const{themeClasses:u}=vi(e),{isSelected:d,select:g,next:x,prev:o,selected:w}=zc(e,xE);return()=>{var E;return F(e.tag,{class:["v-item-group",u.value]},{default:()=>[(E=a.default)==null?void 0:E.call(a,{isSelected:d,select:g,next:x,prev:o,selected:w.value})]})}}}),BB=Pi()({name:"VItem",props:Pc(),emits:{"group:selected":e=>!0},setup(e,s){let{slots:a}=s;const{isSelected:u,select:d,toggle:g,selectedClass:x,value:o,disabled:w}=ch(e,xE);return()=>{var E;return(E=a.default)==null?void 0:E.call(a,{isSelected:u.value,selectedClass:x.value,select:d,toggle:g,value:o.value,disabled:w.value})}}});const OB=Po("v-kbd");const FB=Pt({name:"VLayout",props:IT(),setup(e,s){let{slots:a}=s;const{layoutClasses:u,layoutStyles:d,getLayoutItem:g,items:x,layoutRef:o}=AT(e);return kt(()=>{var w;return F("div",{ref:o,class:u.value,style:d.value},[(w=a.default)==null?void 0:w.call(a)])}),{getLayoutItem:g,items:x}}});const VB=Pt({name:"VLayoutItem",props:{position:{type:String,required:!0},size:{type:[Number,String],default:300},modelValue:Boolean,...sh()},setup(e,s){let{slots:a}=s;const{layoutItemStyles:u}=ah({id:e.name,order:ne(()=>parseInt(e.order,10)),position:St(e,"position"),elementSize:St(e,"size"),layoutSize:St(e,"size"),active:St(e,"modelValue"),absolute:St(e,"absolute")});return()=>{var d;return F("div",{class:["v-layout-item"],style:u.value},[(d=a.default)==null?void 0:d.call(a)])}}}),$B=Pt({name:"VLazy",directives:{intersect:Mf},props:{modelValue:Boolean,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},...ns(),...wn(),...ma({transition:"fade-transition"})},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const{dimensionStyles:u}=is(e),d=bn(e,"modelValue");function g(x){d.value||(d.value=x)}return kt(()=>{var x;return ji(F(e.tag,{class:"v-lazy",style:u.value},{default:()=>[d.value&&F(Ps,{transition:e.transition},{default:()=>[(x=a.default)==null?void 0:x.call(a)]})]}),[[uo("intersect"),g,e.options]])}),{}}});const NB=Pt({name:"VLocaleProvider",props:{locale:String,fallbackLocale:String,messages:Object,rtl:{type:Boolean,default:void 0}},setup(e,s){let{slots:a}=s;const{rtlClasses:u}=cz(e);return kt(()=>{var d;return F("div",{class:["v-locale-provider",u.value]},[(d=a.default)==null?void 0:d.call(a)])}),{}}});function UB(e){var s,a,u;if(!Mi)return;const d=Ar("useHydration"),g=d==null||(s=d.root)==null||(a=s.appContext)==null||(u=a.app)==null?void 0:u._container;return g!=null&&g.__vue_app__?e():kn(e)}const jB=Pt({name:"VNoSsr",setup(e,s){let{slots:a}=s;const u=Ke(!1);return UB(()=>u.value=!0),()=>{var d;return u.value&&((d=a.default)==null?void 0:d.call(a))}}});function GB(){const e=Ke([]);MS(()=>e.value=[]);function s(a,u){e.value[u]=a}return{refs:e,updateRef:s}}const qB=Pt({name:"VPagination",props:{activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:pn,default:"$first"},prevIcon:{type:pn,default:"$prev"},nextIcon:{type:pn,default:"$next"},lastIcon:{type:pn,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...fo(),...mr(),...or(),...zi(),...ga(),...wn({tag:"nav"}),...Xn(),...Lo({variant:"text"})},emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,s){let{slots:a,emit:u}=s;const d=bn(e,"modelValue"),{t:g,n:x}=rs(),{isRtl:o}=va(),{themeClasses:w}=vi(e),E=Ke(-1);ir(void 0,{scoped:!0});const{resizeRef:k}=Tc(_e=>{if(!_e.length)return;const{target:de,contentRect:ve}=_e[0],Se=de.querySelector(".v-pagination__list > *");if(!Se)return;const be=ve.width,De=Se.offsetWidth+parseFloat(getComputedStyle(Se).marginRight)*2,ze=e.showFirstLastPage?5:3;E.value=Math.max(0,Math.floor(+((be-De*ze)/De).toFixed(2)))}),z=ne(()=>parseInt(e.length,10)),L=ne(()=>parseInt(e.start,10)),O=ne(()=>e.totalVisible?parseInt(e.totalVisible,10):E.value>=0?E.value:z.value),G=ne(()=>{if(z.value<=0||isNaN(z.value)||z.value>Number.MAX_SAFE_INTEGER)return[];if(O.value<=1)return[d.value];if(z.value<=O.value)return gc(z.value,L.value);const _e=O.value%2===0,de=_e?O.value/2:Math.floor(O.value/2),ve=_e?de:de+1,Se=z.value-de;if(ve-d.value>=0)return[...gc(Math.max(1,O.value-1),L.value),e.ellipsis,z.value];if(d.value-Se>=(_e?1:0)){const be=O.value-1,De=z.value-be+L.value;return[L.value,e.ellipsis,...gc(be,De)]}else{const be=Math.max(1,O.value-3),De=be===1?d.value:d.value-Math.ceil(be/2)+L.value;return[L.value,e.ellipsis,...gc(be,De),e.ellipsis,z.value]}});function H(_e,de,ve){_e.preventDefault(),d.value=de,ve&&u(ve,de)}const{refs:pe,updateRef:se}=GB();ir({VPaginationBtn:{color:St(e,"color"),border:St(e,"border"),density:St(e,"density"),size:St(e,"size"),variant:St(e,"variant"),rounded:St(e,"rounded"),elevation:St(e,"elevation")}});const he=ne(()=>G.value.map((_e,de)=>{const ve=Se=>se(Se,de);if(typeof _e=="string")return{isActive:!1,key:`ellipsis-${de}`,page:_e,props:{ref:ve,ellipsis:!0,icon:!0,disabled:!0}};{const Se=_e===d.value;return{isActive:Se,key:_e,page:x(_e),props:{ref:ve,ellipsis:!1,icon:!0,disabled:!!e.disabled||e.length<2,color:Se?e.activeColor:e.color,ariaCurrent:Se,ariaLabel:g(Se?e.currentPageAriaLabel:e.pageAriaLabel,de+1),onClick:be=>H(be,_e)}}}})),K=ne(()=>{const _e=!!e.disabled||d.value<=L.value,de=!!e.disabled||d.value>=L.value+z.value-1;return{first:e.showFirstLastPage?{icon:o.value?e.lastIcon:e.firstIcon,onClick:ve=>H(ve,L.value,"first"),disabled:_e,ariaLabel:g(e.firstAriaLabel),ariaDisabled:_e}:void 0,prev:{icon:o.value?e.nextIcon:e.prevIcon,onClick:ve=>H(ve,d.value-1,"prev"),disabled:_e,ariaLabel:g(e.previousAriaLabel),ariaDisabled:_e},next:{icon:o.value?e.prevIcon:e.nextIcon,onClick:ve=>H(ve,d.value+1,"next"),disabled:de,ariaLabel:g(e.nextAriaLabel),ariaDisabled:de},last:e.showFirstLastPage?{icon:o.value?e.firstIcon:e.lastIcon,onClick:ve=>H(ve,L.value+z.value-1,"last"),disabled:de,ariaLabel:g(e.lastAriaLabel),ariaDisabled:de}:void 0}});function Te(){var _e;const de=d.value-L.value;(_e=pe.value[de])==null||_e.$el.focus()}function Y(_e){_e.key===B_.left&&!e.disabled&&d.value>e.start?(d.value=d.value-1,Ui(Te)):_e.key===B_.right&&!e.disabled&&d.value<L.value+z.value-1&&(d.value=d.value+1,Ui(Te))}return kt(()=>F(e.tag,{ref:k,class:["v-pagination",w.value],role:"navigation","aria-label":g(e.ariaLabel),onKeydown:Y,"data-test":"v-pagination-root"},{default:()=>[F("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&F("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[a.first?a.first(K.value.first):F(bi,tn({_as:"VPaginationBtn"},K.value.first),null)]),F("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[a.prev?a.prev(K.value.prev):F(bi,tn({_as:"VPaginationBtn"},K.value.prev),null)]),he.value.map((_e,de)=>F("li",{key:_e.key,class:["v-pagination__item",{"v-pagination__item--is-active":_e.isActive}],"data-test":"v-pagination-item"},[a.item?a.item(_e):F(bi,tn({_as:"VPaginationBtn"},_e.props),{default:()=>[_e.page]})])),F("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[a.next?a.next(K.value.next):F(bi,tn({_as:"VPaginationBtn"},K.value.next),null)]),e.showFirstLastPage&&F("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[a.last?a.last(K.value.last):F(bi,tn({_as:"VPaginationBtn"},K.value.last),null)])])]})),{}}});function ZB(e){return Math.floor(Math.abs(e))*Math.sign(e)}const WB=Pt({name:"VParallax",props:{scale:{type:[Number,String],default:.5}},setup(e,s){let{slots:a}=s;const{intersectionRef:u,isIntersecting:d}=Xy(),{resizeRef:g,contentRect:x}=Tc(),{height:o}=Ig(),w=Ke();Ls(()=>{var O;u.value=g.value=(O=w.value)==null?void 0:O.$el});let E;Ye(d,O=>{O?(E=vT(u.value),E=E===document.scrollingElement?document:E,E.addEventListener("scroll",L,{passive:!0}),L()):E.removeEventListener("scroll",L)}),Ti(()=>{var O;(O=E)==null||O.removeEventListener("scroll",L)}),Ye(o,L),Ye(()=>{var O;return(O=x.value)==null?void 0:O.height},L);const k=ne(()=>1-Eo(+e.scale));let z=-1;function L(){!d.value||(cancelAnimationFrame(z),z=requestAnimationFrame(()=>{var _e,de;var O;const G=((O=w.value)==null?void 0:O.$el).querySelector(".v-img__img");if(!G)return;const H=(_e=E.clientHeight)!=null?_e:document.documentElement.clientHeight,pe=(de=E.scrollTop)!=null?de:window.scrollY,se=u.value.offsetTop,he=x.value.height,K=se+(he-H)/2,Te=ZB((pe-K)*k.value),Y=Math.max(1,(k.value*(H-he)+he)/he);G.style.setProperty("transform",`translateY(${Te}px) scale(${Y})`)}))}return kt(()=>F(oh,{class:["v-parallax",{"v-parallax--active":d.value}],ref:w,cover:!0,onLoadstart:L,onLoad:L},a)),{}}}),HB=Pt({name:"VRadio",props:{...kg({falseIcon:"$radioOff",trueIcon:"$radioOn"})},setup(e,s){let{slots:a}=s;return kt(()=>F(Df,tn(e,{class:"v-radio",type:"radio"}),a)),{}}});const XB=Pt({name:"VRadioGroup",inheritAttrs:!1,props:{height:{type:[Number,String],default:"auto"},..._a(),..._g(a0(),["multiple"]),trueIcon:{type:pn,default:"$radioOn"},falseIcon:{type:pn,default:"$radioOff"},type:{type:String,default:"radio"}},emits:{"update:modelValue":e=>!0},setup(e,s){let{attrs:a,slots:u}=s;const d=Nr(),g=ne(()=>e.id||`radio-group-${d}`),x=bn(e,"modelValue");return kt(()=>{const[o,w]=Ac(a),[E,k]=pl(e),[z,L]=D2({...e,multiple:!1}),O=u.label?u.label({label:e.label,props:{for:g.value}}):e.label;return F(Os,tn({class:"v-radio-group"},o,E,{modelValue:x.value,"onUpdate:modelValue":G=>x.value=G,id:g.value}),{...u,default:G=>{let{id:H,isDisabled:pe,isReadonly:se}=G;return F(On,null,[O&&F(ph,{for:H.value,clickable:!0},{default:()=>[O]}),F(L2,tn(z,{id:H.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:pe.value,readonly:se.value},w,{modelValue:x.value,"onUpdate:modelValue":he=>x.value=he}),u)])}})}),{}}}),YB=Pt({name:"VRangeSlider",props:{...Ag(),..._a(),...nE(),strict:Boolean,modelValue:{type:Array,default:()=>[0,0]}},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=Ke(),d=Ke(),g=Ke();function x(de){if(!u.value||!d.value)return;const ve=iy(de,u.value.$el,e.direction),Se=iy(de,d.value.$el,e.direction),be=Math.abs(ve),De=Math.abs(Se);return be<De||be===De&&ve<0?u.value.$el:d.value.$el}const{activeThumbRef:o,hasLabels:w,max:E,min:k,mousePressed:z,onSliderMousedown:L,onSliderTouchstart:O,position:G,roundValue:H,trackContainerRef:pe}=iE({props:e,handleSliderMouseUp:de=>{var ve;se.value=o.value===((ve=u.value)==null?void 0:ve.$el)?[de,se.value[1]]:[se.value[0],de]},handleMouseMove:de=>{var ve;const[Se,be]=se.value;if(!e.strict&&Se===be&&Se!==k.value){var De,ze,Je;o.value=de>Se?(De=d.value)==null?void 0:De.$el:(ze=u.value)==null?void 0:ze.$el,(Je=o.value)==null||Je.focus()}o.value===((ve=u.value)==null?void 0:ve.$el)?se.value=[Math.min(de,be),be]:se.value=[Se,Math.max(Se,de)]},getActiveThumb:x}),se=bn(e,"modelValue",void 0,de=>!de||!de.length?[0,0]:de.map(ve=>H(ve))),{isFocused:he,focus:K,blur:Te}=Rc(e),Y=ne(()=>G(se.value[0])),_e=ne(()=>G(se.value[1]));return kt(()=>{const[de,ve]=pl(e),Se=!!(e.label||a.label||a.prepend);return F(Os,tn({class:["v-slider","v-range-slider",{"v-slider--has-labels":!!a["tick-label"]||w.value,"v-slider--focused":he.value,"v-slider--pressed":z.value,"v-slider--disabled":e.disabled}],ref:g},de,{focused:he.value}),{...a,prepend:Se?be=>{var Je;var De,ze;return F(On,null,[((Je=(De=a.label)==null?void 0:De.call(a,be))!=null?Je:e.label)?F(ph,{class:"v-slider__label",text:e.label},null):void 0,(ze=a.prepend)==null?void 0:ze.call(a,be)])}:void 0,default:be=>{var De,ze;let{id:Je}=be;return F("div",{class:"v-slider__container",onMousedown:L,onTouchstartPassive:O},[F("input",{id:`${Je.value}_start`,name:e.name||Je.value,disabled:e.disabled,readonly:e.readonly,tabindex:"-1",value:se.value[0]},null),F("input",{id:`${Je.value}_stop`,name:e.name||Je.value,disabled:e.disabled,readonly:e.readonly,tabindex:"-1",value:se.value[1]},null),F(rE,{ref:pe,start:Y.value,stop:_e.value},{"tick-label":a["tick-label"]}),F(ry,{ref:u,focused:he&&o.value===((De=u.value)==null?void 0:De.$el),modelValue:se.value[0],"onUpdate:modelValue":ct=>se.value=[ct,se.value[1]],onFocus:ct=>{var nt,ft;if(K(),o.value=(nt=u.value)==null?void 0:nt.$el,se.value[0]===se.value[1]&&se.value[1]===k.value&&ct.relatedTarget!==((ft=d.value)==null?void 0:ft.$el)){var Pe,at;(Pe=u.value)==null||Pe.$el.blur(),(at=d.value)==null||at.$el.focus()}},onBlur:()=>{Te(),o.value=void 0},min:k.value,max:se.value[1],position:Y.value},{"thumb-label":a["thumb-label"]}),F(ry,{ref:d,focused:he&&o.value===((ze=d.value)==null?void 0:ze.$el),modelValue:se.value[1],"onUpdate:modelValue":ct=>se.value=[se.value[0],ct],onFocus:ct=>{var nt,ft;if(K(),o.value=(nt=d.value)==null?void 0:nt.$el,se.value[0]===se.value[1]&&se.value[0]===E.value&&ct.relatedTarget!==((ft=u.value)==null?void 0:ft.$el)){var Pe,at;(Pe=d.value)==null||Pe.$el.blur(),(at=u.value)==null||at.$el.focus()}},onBlur:()=>{Te(),o.value=void 0},min:se.value[0],max:E.value,position:_e.value},{"thumb-label":a["thumb-label"]})])}})}),{}}});const KB=Pi()({name:"VRating",props:{name:String,itemAriaLabel:{type:String,default:"$vuetify.rating.ariaLabel.item"},activeColor:String,color:String,clearable:Boolean,disabled:Boolean,emptyIcon:{type:pn,default:"$ratingEmpty"},fullIcon:{type:pn,default:"$ratingFull"},halfIncrements:Boolean,hover:Boolean,length:{type:[Number,String],default:5},readonly:Boolean,modelValue:{type:Number,default:0},itemLabels:Array,itemLabelPosition:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},ripple:Boolean,...mr(),...ga(),...wn(),...Xn()},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const{t:u}=rs(),{themeClasses:d}=vi(e),g=bn(e,"modelValue"),x=ne(()=>gc(Number(e.length),1)),o=ne(()=>x.value.flatMap(K=>e.halfIncrements?[K-.5,K]:[K])),w=Ke(-1),E=Ke(-1),k=Ke();let z=!1;const L=ne(()=>o.value.map(K=>{var De;const Te=e.hover&&w.value>-1,Y=g.value>=K,_e=w.value>=K,ve=(Te?_e:Y)?e.fullIcon:e.emptyIcon,Se=(De=e.activeColor)!=null?De:e.color,be=Y||_e?Se:e.color;return{isFilled:Y,isHovered:_e,icon:ve,color:be}})),O=ne(()=>[0,...o.value].map(K=>{function Te(){w.value=K}function Y(){w.value=-1}function _e(){if(K===0&&g.value===0){var Se;(Se=k.value)==null||Se.focus()}else E.value=K}function de(){z||(E.value=-1)}function ve(){e.disabled||e.readonly||(g.value=g.value===K&&e.clearable?0:K)}return{onMouseenter:e.hover?Te:void 0,onMouseleave:e.hover?Y:void 0,onFocus:_e,onBlur:de,onClick:ve}}));function G(){z=!0}function H(){z=!1}const pe=ne(()=>{var K;return(K=e.name)!=null?K:`v-rating-${Nr()}`});function se(K){var Te,Y;let{value:_e,index:de,showStar:ve=!0}=K;const{onMouseenter:Se,onMouseleave:be,onFocus:De,onBlur:ze,onClick:Je}=O.value[de+1],ct=`${pe.value}-${String(_e).replace(".","-")}`,nt={color:(Te=L.value[de])==null?void 0:Te.color,density:e.density,disabled:e.disabled,icon:(Y=L.value[de])==null?void 0:Y.icon,ripple:e.ripple,size:e.size,tag:"span",variant:"plain"};return F(On,null,[F("label",{for:ct,class:{"v-rating__item--half":e.halfIncrements&&_e%1>0,"v-rating__item--full":e.halfIncrements&&_e%1===0},onMousedown:G,onMouseup:H,onMouseenter:Se,onMouseleave:be},[F("span",{class:"v-rating__hidden"},[u(e.itemAriaLabel,_e,e.length)]),ve?a.item?a.item({...L.value[de],props:nt,value:_e,index:de}):F(bi,nt,null):void 0]),F("input",{class:"v-rating__hidden",name:pe.value,id:ct,type:"radio",value:_e,checked:g.value===_e,onClick:Je,onFocus:De,onBlur:ze,ref:de===0?k:void 0,readonly:e.readonly,disabled:e.disabled},null)])}function he(K){return a["item-label"]?a["item-label"](K):K.label?F("span",null,[K.label]):F("span",null,[al("\xA0")])}return kt(()=>{var K;const Te=!!((K=e.itemLabels)!=null&&K.length)||a["item-label"];return F(e.tag,{class:["v-rating",{"v-rating--hover":e.hover,"v-rating--readonly":e.readonly},d.value]},{default:()=>[F(se,{value:0,index:-1,showStar:!1},null),x.value.map((Y,_e)=>{var de,ve;return F("div",{class:"v-rating__wrapper"},[Te&&e.itemLabelPosition==="top"?he({value:Y,index:_e,label:(de=e.itemLabels)==null?void 0:de[_e]}):void 0,F("div",{class:["v-rating__item",{"v-rating__item--focused":Math.ceil(E.value)===Y}]},[e.halfIncrements?F(On,null,[F(se,{value:Y-.5,index:_e*2},null),F(se,{value:Y,index:_e*2+1},null)]):F(se,{value:Y,index:_e},null)]),Te&&e.itemLabelPosition==="bottom"?he({value:Y,index:_e,label:(ve=e.itemLabels)==null?void 0:ve[_e]}):void 0])})]})}),{}}});function kw(e){const a=Math.abs(e);return Math.sign(e)*(a/((1/.501-2)*(1-a)+1))}function Mw(e){let{selectedElement:s,containerSize:a,contentSize:u,isRtl:d,currentScrollOffset:g,isHorizontal:x}=e;const o=x?s.clientWidth:s.clientHeight,w=x?s.offsetLeft:s.offsetTop,E=d&&x?u-w-o:w,k=a+g,z=o+E,L=o*.4;return E<=g?g=Math.max(E-L,0):k<=z&&(g=Math.min(g-(k-z-L),u-a)),g}function JB(e){let{selectedElement:s,containerSize:a,contentSize:u,isRtl:d,isHorizontal:g}=e;const x=g?s.clientWidth:s.clientHeight,o=g?s.offsetLeft:s.offsetTop,w=d&&g?u-o-x/2-a/2:o+x/2-a/2;return Math.min(u-a,Math.max(0,w))}const bE=Symbol.for("vuetify:v-slide-group"),wE=Pi()({name:"VSlideGroup",props:{centerActive:Boolean,direction:{type:String,default:"horizontal"},symbol:{type:null,default:bE},nextIcon:{type:pn,default:"$next"},prevIcon:{type:pn,default:"$prev"},showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["always","desktop","mobile"].includes(e)},...wn(),...lh({selectedClass:"v-slide-group-item--active"})},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const{isRtl:u}=va(),{mobile:d}=Ig(),g=zc(e,e.symbol),x=Ke(!1),o=Ke(0),w=Ke(0),E=Ke(0),k=ne(()=>e.direction==="horizontal"),{resizeRef:z,contentRect:L}=Tc(),{resizeRef:O,contentRect:G}=Tc(),H=ne(()=>g.selected.value.length?g.items.value.findIndex(pt=>pt.id===g.selected.value[0]):-1),pe=ne(()=>g.selected.value.length?g.items.value.findIndex(pt=>pt.id===g.selected.value[g.selected.value.length-1]):-1);if(Mi){let pt=-1;Ye(()=>[g.selected.value,L.value,G.value,k.value],()=>{cancelAnimationFrame(pt),pt=requestAnimationFrame(()=>{if(L.value&&G.value){const zt=k.value?"width":"height";w.value=L.value[zt],E.value=G.value[zt],x.value=w.value+1<E.value}if(H.value>=0&&O.value){const zt=O.value.children[pe.value];H.value===0||!x.value?o.value=0:e.centerActive?o.value=JB({selectedElement:zt,containerSize:w.value,contentSize:E.value,isRtl:u.value,isHorizontal:k.value}):x.value&&(o.value=Mw({selectedElement:zt,containerSize:w.value,contentSize:E.value,isRtl:u.value,currentScrollOffset:o.value,isHorizontal:k.value}))}})})}const se=Ke(!1);let he=0,K=0;function Te(pt){const zt=k.value?"clientX":"clientY";K=(u.value&&k.value?-1:1)*o.value,he=pt.touches[0][zt],se.value=!0}function Y(pt){if(!x.value)return;const zt=k.value?"clientX":"clientY",Gt=u.value&&k.value?-1:1;o.value=Gt*(K+he-pt.touches[0][zt])}function _e(pt){const zt=E.value-w.value;o.value<0||!x.value?o.value=0:o.value>=zt&&(o.value=zt),se.value=!1}function de(){!z.value||(z.value[k.value?"scrollLeft":"scrollTop"]=0)}const ve=Ke(!1);function Se(pt){if(ve.value=!0,!(!x.value||!O.value)){for(const zt of pt.composedPath())for(const Gt of O.value.children)if(Gt===zt){o.value=Mw({selectedElement:Gt,containerSize:w.value,contentSize:E.value,isRtl:u.value,currentScrollOffset:o.value,isHorizontal:k.value});return}}}function be(pt){ve.value=!1}function De(pt){var zt;!ve.value&&!(pt.relatedTarget&&(zt=O.value)!=null&&zt.contains(pt.relatedTarget))&&Je()}function ze(pt){!O.value||(k.value?pt.key==="ArrowRight"?Je(u.value?"prev":"next"):pt.key==="ArrowLeft"&&Je(u.value?"next":"prev"):pt.key==="ArrowDown"?Je("next"):pt.key==="ArrowUp"&&Je("prev"),pt.key==="Home"?Je("first"):pt.key==="End"&&Je("last"))}function Je(pt){if(!!O.value)if(pt){if(pt==="next"){var Gt;const xt=(Gt=O.value.querySelector(":focus"))==null?void 0:Gt.nextElementSibling;xt?xt.focus():Je("first")}else if(pt==="prev"){var zn;const xt=(zn=O.value.querySelector(":focus"))==null?void 0:zn.previousElementSibling;xt?xt.focus():Je("last")}else if(pt==="first"){var At;(At=O.value.firstElementChild)==null||At.focus()}else if(pt==="last"){var Qe;(Qe=O.value.lastElementChild)==null||Qe.focus()}}else{var zt;(zt=[...O.value.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')].filter(Tt=>!Tt.hasAttribute("disabled"))[0])==null||zt.focus()}}function ct(pt){const zt=o.value+(pt==="prev"?-1:1)*w.value;o.value=Eo(zt,0,E.value-w.value)}const nt=ne(()=>{let pt=o.value>E.value-w.value?-(E.value-w.value)+kw(E.value-w.value-o.value):-o.value;o.value<=0&&(pt=kw(-o.value));const zt=u.value&&k.value?-1:1;return{transform:`translate${k.value?"X":"Y"}(${zt*pt}px)`,transition:se.value?"none":"",willChange:se.value?"transform":""}}),ft=ne(()=>({next:g.next,prev:g.prev,select:g.select,isSelected:g.isSelected})),Pe=ne(()=>{switch(e.showArrows){case"always":return!0;case"desktop":return!d.value;case!0:return x.value||Math.abs(o.value)>0;case"mobile":return d.value||x.value||Math.abs(o.value)>0;default:return!d.value&&(x.value||Math.abs(o.value)>0)}}),at=ne(()=>Math.abs(o.value)>0),jt=ne(()=>E.value>Math.abs(o.value)+w.value);return kt(()=>{var pt,zt,Gt;return F(e.tag,{class:["v-slide-group",{"v-slide-group--vertical":!k.value,"v-slide-group--has-affixes":Pe.value,"v-slide-group--is-overflowing":x.value}],tabindex:ve.value||g.selected.value.length?-1:0,onFocus:De},{default:()=>{var zn,At;return[Pe.value&&F("div",{key:"prev",class:["v-slide-group__prev",{"v-slide-group__prev--disabled":!at.value}],onClick:()=>ct("prev")},[(zn=(pt=a.prev)==null?void 0:pt.call(a,ft.value))!=null?zn:F(U_,null,{default:()=>[F(er,{icon:u.value?e.nextIcon:e.prevIcon},null)]})]),F("div",{key:"container",ref:z,class:"v-slide-group__container",onScroll:de},[F("div",{ref:O,class:"v-slide-group__content",style:nt.value,onTouchstartPassive:Te,onTouchmovePassive:Y,onTouchendPassive:_e,onFocusin:Se,onFocusout:be,onKeydown:ze},[(zt=a.default)==null?void 0:zt.call(a,ft.value)])]),Pe.value&&F("div",{key:"next",class:["v-slide-group__next",{"v-slide-group__next--disabled":!jt.value}],onClick:()=>ct("next")},[(At=(Gt=a.next)==null?void 0:Gt.call(a,ft.value))!=null?At:F(U_,null,{default:()=>[F(er,{icon:u.value?e.prevIcon:e.nextIcon},null)]})])]}})}),{selected:g.selected,scrollTo:ct,scrollOffset:o,focus:Je}}}),QB=Pi()({name:"VSlideGroupItem",props:{...Pc()},emits:{"group:selected":e=>!0},setup(e,s){let{slots:a}=s;const u=ch(e,bE);return()=>{var d;return(d=a.default)==null?void 0:d.call(a,{isSelected:u.isSelected.value,select:u.select,toggle:u.toggle,selectedClass:u.selectedClass.value})}}});const e3=Pi()({name:"VSnackbar",props:{multiLine:Boolean,timeout:{type:[Number,String],default:5e3},vertical:Boolean,...Lc({location:"bottom"}),...hh(),...zi(),...Lo(),..._g(Bf({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=bn(e,"modelValue"),{locationStyles:d}=Dc(e),{positionClasses:g}=dh(e),{scopeId:x}=zg(),{colorClasses:o,colorStyles:w,variantClasses:E}=Mc(e),{roundedClasses:k}=Yi(e),z=Ke();Ye(u,O),Ye(()=>e.timeout,O),kn(()=>{u.value&&O()});let L=-1;function O(){window.clearTimeout(L);const H=Number(e.timeout);!u.value||H===-1||(L=window.setTimeout(()=>{u.value=!1},H))}function G(){window.clearTimeout(L)}return kt(()=>{const[H]=Pg(e);return F(gh,tn({ref:z,class:["v-snackbar",{"v-snackbar--active":u.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--vertical":e.vertical},g.value]},H,{modelValue:u.value,"onUpdate:modelValue":pe=>u.value=pe,contentProps:tn({style:d.value},H.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none"},x),{default:()=>[F("div",{class:["v-snackbar__wrapper",o.value,k.value,E.value],style:[w.value],onPointerenter:G,onPointerleave:O},[kc(!1,"v-snackbar"),a.default&&F("div",{class:"v-snackbar__content",role:"status","aria-live":"polite"},[a.default()]),a.actions&&F(wi,{defaults:{VBtn:{variant:"text",ripple:!1}}},{default:()=>[F("div",{class:"v-snackbar__actions"},[a.actions()])]})])],activator:a.activator})}),os({},z)}});const t3=Pt({name:"VSwitch",inheritAttrs:!1,props:{indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},..._a(),...kg()},emits:{"update:focused":e=>!0,"update:modelValue":()=>!0,"update:indeterminate":e=>!0},setup(e,s){let{attrs:a,slots:u}=s;const d=bn(e,"indeterminate"),g=bn(e,"modelValue"),{loaderClasses:x}=Tg(e),{isFocused:o,focus:w,blur:E}=Rc(e),k=ne(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),z=Nr(),L=ne(()=>e.id||`switch-${z}`);function O(){d.value&&(d.value=!1)}return kt(()=>{const[G,H]=Ac(a),[pe,se]=pl(e),[he,K]=D2(e),Te=Ke();function Y(){var _e,de;(_e=Te.value)==null||(de=_e.input)==null||de.click()}return F(Os,tn({class:["v-switch",{"v-switch--inset":e.inset},{"v-switch--indeterminate":d.value},x.value]},G,pe,{id:L.value,focused:o.value}),{...u,default:_e=>{let{id:de,isDisabled:ve,isReadonly:Se,isValid:be}=_e;return F(Df,tn({ref:Te},he,{modelValue:g.value,"onUpdate:modelValue":[De=>g.value=De,O],id:de.value,type:"checkbox","aria-checked":d.value?"mixed":void 0,disabled:ve.value,readonly:Se.value,onFocus:w,onBlur:E},H),{...u,default:()=>F("div",{class:"v-switch__track",onClick:Y},null),input:De=>{let{textColorClasses:ze,textColorStyles:Je}=De;return F("div",{class:["v-switch__thumb",ze.value],style:Je.value},[e.loading&&F(Qy,{name:"v-switch",active:!0,color:be.value===!1?void 0:k.value},{default:ct=>u.loader?u.loader(ct):F(Yy,{active:ct.isActive,color:ct.color,indeterminate:!0,size:"16",width:"2"},null)})])}})}})}),{}}});const n3=Pt({name:"VSystemBar",props:{color:String,height:[Number,String],window:Boolean,...or(),...sh(),...zi(),...wn(),...Xn()},setup(e,s){let{slots:a}=s;const{themeClasses:u}=vi(e),{backgroundColorClasses:d,backgroundColorStyles:g}=Hi(St(e,"color")),{elevationClasses:x}=kr(e),{roundedClasses:o}=Yi(e),w=ne(()=>{var k;return(k=e.height)!=null?k:e.window?32:24}),{layoutItemStyles:E}=ah({id:e.name,order:ne(()=>parseInt(e.order,10)),position:Ke("top"),layoutSize:w,elementSize:w,active:ne(()=>!0),absolute:St(e,"absolute")});return kt(()=>F(e.tag,{class:["v-system-bar",{"v-system-bar--window":e.window},u.value,d.value,x.value,o.value],style:[g.value,E.value]},a)),{}}});const SE=Symbol.for("vuetify:v-tabs"),TE=Pt({name:"VTab",props:{fixed:Boolean,icon:[Boolean,String,Function,Object],prependIcon:pn,appendIcon:pn,stacked:Boolean,title:String,ripple:{type:Boolean,default:!0},color:String,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...wn(),...fh(),...Pc({selectedClass:"v-tab--selected"}),...Xn()},setup(e,s){let{slots:a,attrs:u}=s;const{textColorClasses:d,textColorStyles:g}=no(e,"sliderColor"),x=ne(()=>e.direction==="horizontal"),o=Ke(!1),w=Ke(),E=Ke();function k(z){let{value:L}=z;if(o.value=L,L){var O,G;const H=(O=w.value)==null||(G=O.$el.parentElement)==null?void 0:G.querySelector(".v-tab--selected .v-tab__slider"),pe=E.value;if(!H||!pe)return;const se=getComputedStyle(H).color,he=H.getBoundingClientRect(),K=pe.getBoundingClientRect(),Te=x.value?"x":"y",Y=x.value?"X":"Y",_e=x.value?"right":"bottom",de=x.value?"width":"height",ve=he[Te],Se=K[Te],be=ve>Se?he[_e]-K[_e]:he[Te]-K[Te],De=Math.sign(be)>0?x.value?"right":"bottom":Math.sign(be)<0?x.value?"left":"top":"center",Je=(Math.abs(be)+(Math.sign(be)<0?he[de]:K[de]))/Math.max(he[de],K[de]),ct=he[de]/K[de],nt=1.5;vc(pe,{backgroundColor:[se,""],transform:[`translate${Y}(${be}px) scale${Y}(${ct})`,`translate${Y}(${be/nt}px) scale${Y}(${(Je-1)/nt+1})`,""],transformOrigin:Array(3).fill(De)},{duration:225,easing:mf})}}return kt(()=>{const[z]=Mo(e,["href","to","replace","icon","stacked","prependIcon","appendIcon","ripple","theme","disabled","selectedClass","value","color"]);return F(bi,tn({_as:"VTab",symbol:SE,ref:w,class:["v-tab"],tabindex:o.value?0:-1,role:"tab","aria-selected":String(o.value),active:!1,block:e.fixed,maxWidth:e.fixed?300:void 0,variant:"text",rounded:0},z,u,{"onGroup:selected":k}),{default:()=>[a.default?a.default():e.title,!e.hideSlider&&F("div",{ref:E,class:["v-tab__slider",d.value],style:g.value},null)]})}),{}}});function i3(e){return e?e.map(s=>typeof s=="string"?{title:s,value:s}:s):[]}const r3=Pt({name:"VTabs",props:{alignTabs:{type:String,default:"start"},color:String,direction:{type:String,default:"horizontal"},fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,modelValue:null,mandatory:{type:[Boolean,String],default:"force"},...mr(),...wn()},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=bn(e,"modelValue"),d=ne(()=>i3(e.items)),{densityClasses:g}=Ur(e),{backgroundColorClasses:x,backgroundColorStyles:o}=Hi(St(e,"bgColor"));return ir({VTab:{color:St(e,"color"),direction:St(e,"direction"),stacked:St(e,"stacked"),fixed:St(e,"fixedTabs"),sliderColor:St(e,"sliderColor"),hideSlider:St(e,"hideSlider")}}),kt(()=>F(wE,{modelValue:u.value,"onUpdate:modelValue":w=>u.value=w,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},g.value,x.value],style:[{"--v-tabs-height":Xt(e.height)},o.value],role:"tablist",symbol:SE,mandatory:e.mandatory,direction:e.direction},{default:()=>[a.default?a.default():d.value.map(w=>F(TE,tn(w,{key:w.title}),null))]})),{}}});const o3=Pt({name:"VTable",props:{fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...mr(),...wn(),...Xn()},setup(e,s){let{slots:a}=s;const{themeClasses:u}=vi(e),{densityClasses:d}=Ur(e);return kt(()=>{var g,x;return F(e.tag,{class:["v-table",{"v-table--fixed-height":!!e.height,"v-table--fixed-header":e.fixedHeader,"v-table--fixed-footer":e.fixedFooter,"v-table--has-top":!!a.top,"v-table--has-bottom":!!a.bottom,"v-table--hover":e.hover},u.value,d.value]},{default:()=>[(g=a.top)==null?void 0:g.call(a),a.default&&F("div",{class:"v-table__wrapper",style:{height:Xt(e.height)}},[F("table",null,[a.default()])]),(x=a.bottom)==null?void 0:x.call(a)]})}),{}}});const s3=Pt({name:"VTextarea",directives:{Intersect:Mf},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,hint:String,persistentHint:Boolean,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,..._a(),...Lg()},emits:{"click:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,s){let{attrs:a,emit:u,slots:d}=s;const g=bn(e,"modelValue"),{isFocused:x,focus:o,blur:w}=Rc(e),E=ne(()=>typeof e.counterValue=="function"?e.counterValue(g.value):(g.value||"").toString().length),k=ne(()=>{if(a.maxlength)return a.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function z(Se,be){var De,ze;!e.autofocus||!Se||(De=be[0].target)==null||(ze=De.focus)==null||ze.call(De)}const L=Ke(),O=Ke(),G=Ke(""),H=Ke(),pe=ne(()=>x.value||e.persistentPlaceholder),se=ne(()=>e.messages.length?e.messages:pe.value||e.persistentHint?e.hint:"");function he(){if(H.value!==document.activeElement){var Se;(Se=H.value)==null||Se.focus()}x.value||o()}function K(Se){he(),u("click:control",Se)}function Te(Se){Se.stopPropagation(),he(),Ui(()=>{g.value="",Zm(e["onClick:clear"],Se)})}function Y(Se){g.value=Se.target.value}const _e=Ke();function de(){!e.autoGrow||Ui(()=>{if(!_e.value||!O.value)return;const Se=getComputedStyle(_e.value),be=getComputedStyle(O.value.$el),De=parseFloat(Se.getPropertyValue("--v-field-padding-top"))+parseFloat(Se.getPropertyValue("--v-input-padding-top"))+parseFloat(Se.getPropertyValue("--v-field-padding-bottom")),ze=_e.value.scrollHeight,Je=parseFloat(Se.lineHeight),ct=Math.max(parseFloat(e.rows)*Je+De,parseFloat(be.getPropertyValue("--v-input-control-height"))),nt=parseFloat(e.maxRows)*Je+De||1/0;G.value=Xt(Eo(ze!=null?ze:0,ct,nt))})}kn(de),Ye(g,de),Ye(()=>e.rows,de),Ye(()=>e.maxRows,de),Ye(()=>e.density,de);let ve;return Ye(_e,Se=>{if(Se)ve=new ResizeObserver(de),ve.observe(_e.value);else{var be;(be=ve)==null||be.disconnect()}}),Ti(()=>{var Se;(Se=ve)==null||Se.disconnect()}),kt(()=>{const Se=!!(d.counter||e.counter||e.counterValue),be=!!(Se||d.details),[De,ze]=Ac(a),[{modelValue:Je,...ct}]=pl(e),[nt]=c0(e);return F(Os,tn({ref:L,modelValue:g.value,"onUpdate:modelValue":ft=>g.value=ft,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(e.variant)}],"onClick:prepend":e["onClick:prepend"],"onClick:append":e["onClick:append"]},De,ct,{focused:x.value,messages:se.value}),{...d,default:ft=>{let{isDisabled:Pe,isDirty:at,isReadonly:jt,isValid:pt}=ft;return F(Ff,tn({ref:O,style:{"--v-textarea-control-height":G.value},"onClick:control":K,"onClick:clear":Te,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},nt,{active:pe.value||at.value,dirty:at.value||e.dirty,focused:x.value,error:pt.value===!1}),{...d,default:zt=>{let{props:{class:Gt,...zn}}=zt;return F(On,null,[e.prefix&&F("span",{class:"v-text-field__prefix"},[e.prefix]),ji(F("textarea",tn({ref:H,class:Gt,value:g.value,onInput:Y,autofocus:e.autofocus,readonly:jt.value,disabled:Pe.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:he,onBlur:w},zn,ze),null),[[uo("intersect"),{handler:z},null,{once:!0}]]),e.autoGrow&&ji(F("textarea",{class:[Gt,"v-textarea__sizer"],"onUpdate:modelValue":At=>g.value=At,ref:_e,readonly:!0,"aria-hidden":"true"},null),[[MM,g.value]]),e.suffix&&F("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:be?ft=>{var Pe;return F(On,null,[(Pe=d.details)==null?void 0:Pe.call(d,ft),Se&&F(On,null,[F("span",null,null),F(Dg,{active:e.persistentCounter||x.value,value:E.value,max:k.value},d.counter)])])}:void 0})}),os({},L,O,H)}});const a3=Pt({name:"VThemeProvider",props:{withBackground:Boolean,...Xn(),...wn()},setup(e,s){let{slots:a}=s;const{themeClasses:u}=vi(e);return()=>{var d,g;return e.withBackground?F(e.tag,{class:["v-theme-provider",u.value]},{default:()=>[(g=a.default)==null?void 0:g.call(a)]}):(d=a.default)==null?void 0:d.call(a)}}});const l3=Pt({name:"VTimeline",props:{align:{type:String,default:"center",validator:e=>["center","start"].includes(e)},direction:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},justify:{type:String,default:"auto",validator:e=>["auto","center"].includes(e)},side:{type:String,validator:e=>e==null||["start","end"].includes(e)},lineInset:{type:[String,Number],default:0},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:e=>["start","end","both"].includes(e)},...mr(),...wn(),...Xn()},setup(e,s){let{slots:a}=s;const{themeClasses:u}=vi(e),{densityClasses:d}=Ur(e);ir({VTimelineDivider:{lineColor:St(e,"lineColor")},VTimelineItem:{density:St(e,"density"),lineInset:St(e,"lineInset")}});const g=ne(()=>{const o=e.side?e.side:e.density!=="default"?"end":null;return o&&`v-timeline--side-${o}`}),x=ne(()=>{const o=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(e.truncateLine){case"both":return o;case"start":return o[0];case"end":return o[1];default:return null}});return kt(()=>F(e.tag,{class:["v-timeline",`v-timeline--${e.direction}`,`v-timeline--align-${e.align}`,`v-timeline--justify-${e.justify}`,x.value,{"v-timeline--inset-line":!!e.lineInset},u.value,d.value,g.value],style:{"--v-timeline-line-thickness":Xt(e.lineThickness)}},a)),{}}}),c3=Pt({name:"VTimelineDivider",props:{dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:pn,iconColor:String,lineColor:String,...zi(),...ga(),...or()},setup(e,s){let{slots:a}=s;const{sizeClasses:u,sizeStyles:d}=uh(e,"v-timeline-divider__dot"),{backgroundColorStyles:g,backgroundColorClasses:x}=Hi(St(e,"dotColor")),{roundedClasses:o}=Yi(e,"v-timeline-divider__dot"),{elevationClasses:w}=kr(e),{backgroundColorClasses:E,backgroundColorStyles:k}=Hi(St(e,"lineColor"));return ir({VIcon:{color:St(e,"iconColor"),icon:St(e,"icon"),size:St(e,"size")}}),kt(()=>{var L;var z;return F("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":e.fillDot}]},[F("div",{class:["v-timeline-divider__before",E.value],style:k.value},null),!e.hideDot&&F("div",{key:"dot",class:["v-timeline-divider__dot",w.value,o.value,u.value],style:d.value},[F("div",{class:["v-timeline-divider__inner-dot",x.value,o.value],style:g.value},[(L=(z=a.default)==null?void 0:z.call(a))!=null?L:e.icon?F(er,null,null):void 0])]),F("div",{class:["v-timeline-divider__after",E.value],style:k.value},null)])}),{}}}),u3=Pt({name:"VTimelineItem",props:{density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:pn,iconColor:String,lineInset:[Number,String],...zi(),...or(),...ga(),...wn(),...ns()},setup(e,s){let{slots:a}=s;const{dimensionStyles:u}=is(e),d=Ke(0),g=Ke();return Ye(g,x=>{var w;var o;!x||(d.value=(w=(o=x.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:o.getBoundingClientRect().width)!=null?w:0)},{flush:"post"}),kt(()=>{var x,o;return F("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":e.fillDot}],style:{"--v-timeline-dot-size":Xt(d.value),"--v-timeline-line-inset":e.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${Xt(e.lineInset)})`:Xt(0)}},[F("div",{class:"v-timeline-item__body",style:u.value},[(x=a.default)==null?void 0:x.call(a)]),F(c3,{ref:g,hideDot:e.hideDot,icon:e.icon,iconColor:e.iconColor,size:e.size,elevation:e.elevation,dotColor:e.dotColor,fillDot:e.fillDot,rounded:e.rounded},{default:a.icon}),e.density!=="compact"&&F("div",{class:"v-timeline-item__opposite"},[!e.hideOpposite&&((o=a.opposite)==null?void 0:o.call(a))])])}),{}}});const h3=Pi()({name:"VTooltip",props:{id:String,text:String,..._g(Bf({closeOnBack:!1,location:"end",locationStrategy:"connected",minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent","eager"])},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=bn(e,"modelValue"),{scopeId:d}=zg(),g=Nr(),x=ne(()=>e.id||`v-tooltip-${g}`),o=Ke(),w=ne(()=>e.location.split(" ").length>1?e.location:e.location+" center"),E=ne(()=>e.origin==="auto"||e.origin==="overlap"||e.origin.split(" ").length>1||e.location.split(" ").length>1?e.origin:e.origin+" center"),k=ne(()=>e.transition?e.transition:u.value?"scale-transition":"fade-transition");return kt(()=>{const[z]=Pg(e);return F(gh,tn({ref:o,class:["v-tooltip"],id:x.value},z,{modelValue:u.value,"onUpdate:modelValue":L=>u.value=L,transition:k.value,absolute:!0,location:w.value,origin:E.value,persistent:!0,role:"tooltip",eager:!0,activatorProps:tn({"aria-describedby":x.value},e.activatorProps)},d),{activator:a.activator,default:function(){var pe;for(var L,O=arguments.length,G=new Array(O),H=0;H<O;H++)G[H]=arguments[H];return(pe=(L=a.default)==null?void 0:L.call(a,...G))!=null?pe:e.text}})}),os({},o)}}),d3=Pt({name:"VValidation",props:{...k2()},emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=M2(e,"validation");return()=>{var d;return(d=a.default)==null?void 0:d.call(a,u)}}}),f3=Object.freeze(Object.defineProperty({__proto__:null,VApp:v2,VAppBar:kT,VAppBarNavIcon:mz,VAppBarTitle:vz,VAlert:ND,VAlertTitle:C2,VAutocomplete:xR,VAvatar:cl,VBadge:bR,VBanner:wR,VBannerActions:Z2,VBannerText:W2,VBottomNavigation:SR,VBreadcrumbs:TR,VBreadcrumbsItem:X2,VBreadcrumbsDivider:H2,VBtn:bi,VBtnGroup:MT,VBtnToggle:qP,VCard:Lf,VCardActions:_2,VCardItem:b2,VCardSubtitle:y2,VCardText:o0,VCardTitle:x2,VCarousel:zR,VCarouselItem:LR,VCheckbox:WD,VCheckboxBtn:mh,VChip:Rf,VChipGroup:HD,VCode:DR,VColorPicker:pB,VCombobox:gB,VCounter:Dg,VDefaultsProvider:wi,VDialog:vB,VDivider:nf,VExpansionPanels:yB,VExpansionPanel:xB,VExpansionPanelText:lE,VExpansionPanelTitle:aE,VField:Ff,VFieldLabel:Zd,VFileInput:bB,VFooter:wB,VForm:SB,VContainer:TB,VCol:ig,VRow:yE,VSpacer:LB,VHover:DB,VIcon:er,VComponentIcon:LT,VSvgIcon:DT,VLigatureIcon:WP,VClassIcon:Sg,VImg:oh,VInput:Os,VItemGroup:RB,VItem:BB,VKbd:OB,VLabel:ph,VLayout:FB,VLayoutItem:VB,VLazy:$B,VList:zf,VListGroup:i0,VListImg:QL,VListItem:dr,VListItemAction:eD,VListItemMedia:tD,VListItemSubtitle:h2,VListItemTitle:d2,VListSubheader:rf,VLocaleProvider:NB,VMain:w2,VMenu:Of,VMessages:I2,VNavigationDrawer:r2,VNoSsr:jB,VOverlay:gh,VPagination:qB,VParallax:WB,VProgressCircular:Yy,VProgressLinear:Ky,VRadio:HB,VRadioGroup:XB,VRangeSlider:YB,VRating:KB,VResponsive:wT,VSelect:gR,VSelectionControl:Df,VSelectionControlGroup:L2,VSheet:oE,VSlideGroup:wE,VSlideGroupItem:QB,VSlider:ng,VSnackbar:e3,VSwitch:t3,VSystemBar:n3,VTabs:r3,VTab:TE,VTable:o3,VTextarea:s3,VTextField:Rg,VThemeProvider:a3,VTimeline:l3,VTimelineItem:u3,VToolbar:Km,VToolbarTitle:Ym,VToolbarItems:gz,VTooltip:h3,VValidation:d3,VWindow:J2,VWindowItem:Q2,VDialogTransition:xg,VFabTransition:mP,VDialogBottomTransition:gP,VDialogTopTransition:vP,VFadeTransition:U_,VScaleTransition:bT,VScrollXTransition:_P,VScrollXReverseTransition:yP,VScrollYTransition:xP,VScrollYReverseTransition:bP,VSlideXTransition:wP,VSlideXReverseTransition:SP,VSlideYTransition:qy,VSlideYReverseTransition:TP,VExpandTransition:bg,VExpandXTransition:Zy},Symbol.toStringTag,{value:"Module"}));function p3(e,s){var z,L,O,G;const a=s.modifiers||{},u=s.value,{once:d,immediate:g,...x}=a,o=!Object.keys(x).length,{handler:w,options:E}=typeof u=="object"?u:{handler:u,options:{attributes:(z=x==null?void 0:x.attr)!=null?z:o,characterData:(L=x==null?void 0:x.char)!=null?L:o,childList:(O=x==null?void 0:x.child)!=null?O:o,subtree:(G=x==null?void 0:x.sub)!=null?G:o}},k=new MutationObserver(function(){let H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],pe=arguments.length>1?arguments[1]:void 0;w==null||w(H,pe),d&&EE(e,s)});g&&(w==null||w([],k)),e._mutate=Object(e._mutate),e._mutate[s.instance.$.uid]={observer:k},k.observe(e,E)}function EE(e,s){var a;!((a=e._mutate)!=null&&a[s.instance.$.uid])||(e._mutate[s.instance.$.uid].observer.disconnect(),delete e._mutate[s.instance.$.uid])}const m3={mounted:p3,unmounted:EE};function g3(e,s){var a,u;const d=s.value,g={passive:!((a=s.modifiers)!=null&&a.active)};window.addEventListener("resize",d,g),e._onResize=Object(e._onResize),e._onResize[s.instance.$.uid]={handler:d,options:g},(u=s.modifiers)!=null&&u.quiet||d()}function v3(e,s){var a;if(!((a=e._onResize)!=null&&a[s.instance.$.uid]))return;const{handler:u,options:d}=e._onResize[s.instance.$.uid];window.removeEventListener("resize",u,d),delete e._onResize[s.instance.$.uid]}const _3={mounted:g3,unmounted:v3};function CE(e,s){var o;const{self:a=!1}=(o=s.modifiers)!=null?o:{},u=s.value,d=typeof u=="object"&&u.options||{passive:!0},g=typeof u=="function"||"handleEvent"in u?u:u.handler,x=a?e:s.arg?document.querySelector(s.arg):window;!x||(x.addEventListener("scroll",g,d),e._onScroll=Object(e._onScroll),e._onScroll[s.instance.$.uid]={handler:g,options:d,target:a?void 0:x})}function IE(e,s){var a;if(!((a=e._onScroll)!=null&&a[s.instance.$.uid]))return;const{handler:u,options:d,target:g=e}=e._onScroll[s.instance.$.uid];g.removeEventListener("scroll",u,d),delete e._onScroll[s.instance.$.uid]}function y3(e,s){s.value!==s.oldValue&&(IE(e,s),CE(e,s))}const x3={mounted:CE,unmounted:IE,updated:y3},b3=Object.freeze(Object.defineProperty({__proto__:null,ClickOutside:j2,Intersect:Mf,Mutate:m3,Resize:_3,Ripple:fl,Scroll:x3,Touch:h0},Symbol.toStringTag,{value:"Module"})),w3=E2({icons:{defaultSet:"fa",aliases:OD,sets:{fa:FD}},blueprint:VD,components:f3,directives:b3}),uc={},AE="pk.eyJ1Ijoia29pZ29rb3JvIiwiYSI6ImNsOXAxZDIzZDA0OHQ0MW1wMHd2Y3Rxa3IifQ.X9ACqkqRQ_m3IvwqsGYy0w",S3={class:"scale-button d-flex flex-column justify-center align-center"},T3=Ln({__name:"MapLand",setup(e){const s=Qi({projection:"mercator"}),a=Ke();a.value;function u(){s.zoom++}function d(){s.zoom--}return kn(()=>{console.log(a.value.map)}),(g,x)=>{const o=ua("v-map");return Xi(),ts(o,{ref_key:"mapRef",ref:a,accessToken:Ai(AE),options:s,class:"pa-3"},{default:xi(()=>[Sc("div",S3,[F(bi,{width:"36",height:"36",onClick:u,icon:"mdi-plus"}),F(bi,{width:"36",height:"36",onClick:d,icon:"mdi-reduce"})])]),_:1},8,["accessToken","options"])}}});const __=Bs(T3,[["__scopeId","data-v-c78dea8f"]]),E3={};function C3(e,s){const a=ua("v-scale-control");return Xi(),ts(Lf,{color:"blue"},{default:xi(()=>[F(a,{class:"scale-control",position:"bottom-right"})]),_:1})}const I3=Bs(E3,[["render",C3]]),A3=Ln({__name:"SwitchBgMap",emits:["switch-core"],setup(e,{emit:s}){const a=Ke("core://styles/core/light-v11"),u=Qi({mapbox:"core://styles/core/light-v11",earth:"core://styles/core/satellite-streets-v11"});function d(g){g==="mapbox"?a.value=u.mapbox:g==="earth"&&(a.value=u.earth),s("switch-core",a.value)}return(g,x)=>(Xi(),ts(Of,{location:"start",class:"switch-map"},{activator:xi(({props:o})=>[F(bi,tn({width:"36",height:"36",class:"switch-map",elevation:"4",icon:"mdi-switch",color:"primary"},o),null,16)]),default:xi(()=>[F(yE,null,{default:xi(()=>[F(ig,null,{default:xi(()=>[F(bi,{width:"36",height:"36",onClick:x[0]||(x[0]=o=>d("mapbox")),icon:"mdi-earth"})]),_:1}),F(ig,null,{default:xi(()=>[F(bi,{width:"36",height:"36",onClick:x[1]||(x[1]=o=>d("earth")),icon:"mdi-mapbox"})]),_:1})]),_:1})]),_:1}))}});const k3=Bs(A3,[["__scopeId","data-v-88145efd"]]),M3={class:"scale-button d-flex flex-column justify-center align-center"},P3=Ln({__name:"MapMain",setup(e){const s=Qi({center:[120,30],zoom:5,style:"mapbox://styles/mapbox/light-v11",projection:"mercator"}),a=Ke();function u(){s.zoom++}function d(){s.zoom--}function g(x){s.style=x}return(x,o)=>{const w=ua("v-map");return Xi(),ts(w,{ref_key:"mapRef",ref:a,accessToken:Ai(AE),options:s},{default:xi(()=>[Af(x.$slots,"default",{},void 0,!0),F(I3),F(k3,{onReceiveChild:g}),Sc("div",M3,[F(bi,{width:"36",height:"36",class:"mb-2",onClick:u,icon:"mdi-plus"}),F(bi,{width:"36",height:"36",onClick:d,icon:"mdi-minus"})])]),_:3},8,["accessToken","options"])}}});const Vf=Bs(P3,[["__scopeId","data-v-94ecfdc9"]]);const z3={},L3={class:"function-card"};function D3(e,s){return Xi(),es("div",L3,[F(Lf,{class:"rounded-pill d-flex justify-center align-center",color:"white",width:"36",height:"300"},{default:xi(()=>[F(ig,{class:"pa-0"},{default:xi(()=>[F(bi,{height:"36",variant:"plain",icon:"mdi-weather-hurricane"}),F(bi,{height:"36",variant:"plain",icon:"mdi-weather-cloudy"}),F(bi,{height:"36",variant:"plain",icon:"mdi-temperature-celsius"})]),_:1})]),_:1})])}const R3=Bs(z3,[["render",D3],["__scopeId","data-v-a8a80643"]]),B3=Ln({__name:"MapElevation",setup(e){return(s,a)=>{const u=ua("v-raster-source"),d=ua("v-raster-layer");return Xi(),es("div",null,[F(Vf,null,{default:xi(()=>[F(u,{id:"tiles",tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.jpg"]},null,8,["tiles"]),F(d,{id:"tiles",source:"tiles"})]),_:1}),F(R3)])}}});var eo=63710088e-1,O3={centimeters:eo*100,centimetres:eo*100,degrees:eo/111325,feet:eo*3.28084,inches:eo*39.37,kilometers:eo/1e3,kilometres:eo/1e3,meters:eo,metres:eo,miles:eo/1609.344,millimeters:eo*1e3,millimetres:eo*1e3,nauticalmiles:eo/1852,radians:1,yards:eo*1.0936};function Tf(e,s,a){a===void 0&&(a={});var u={type:"Feature"};return(a.id===0||a.id)&&(u.id=a.id),a.bbox&&(u.bbox=a.bbox),u.properties=s||{},u.geometry=e,u}function F3(e,s,a){if(a===void 0&&(a={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Lw(e[0])||!Lw(e[1]))throw new Error("coordinates must contain numbers");var u={type:"Point",coordinates:e};return Tf(u,s,a)}function oy(e,s,a){a===void 0&&(a={});for(var u=0,d=e;u<d.length;u++){var g=d[u];if(g.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var x=0;x<g[g.length-1].length;x++)if(g[g.length-1][x]!==g[0][x])throw new Error("First and last Position are not equivalent.")}var o={type:"Polygon",coordinates:e};return Tf(o,s,a)}function g0(e,s){s===void 0&&(s={});var a={type:"FeatureCollection"};return s.id&&(a.id=s.id),s.bbox&&(a.bbox=s.bbox),a.features=e,a}function Pw(e,s,a){a===void 0&&(a={});var u={type:"MultiPolygon",coordinates:e};return Tf(u,s,a)}function V3(e,s){s===void 0&&(s="kilometers");var a=O3[s];if(!a)throw new Error(s+" units is invalid");return e/a}function zw(e){var s=e%(2*Math.PI);return s*180/Math.PI}function y_(e){var s=e%360;return s*Math.PI/180}function Lw(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function $3(e){return!!e&&e.constructor===Object}function N3(e,s){if(e.type==="Feature")s(e,0);else if(e.type==="FeatureCollection")for(var a=0;a<e.features.length&&s(e.features[a],a)!==!1;a++);}function U3(e,s){var a,u,d,g,x,o,w,E,k,z,L=0,O=e.type==="FeatureCollection",G=e.type==="Feature",H=O?e.features.length:1;for(a=0;a<H;a++){for(o=O?e.features[a].geometry:G?e.geometry:e,E=O?e.features[a].properties:G?e.properties:{},k=O?e.features[a].bbox:G?e.bbox:void 0,z=O?e.features[a].id:G?e.id:void 0,w=o?o.type==="GeometryCollection":!1,x=w?o.geometries.length:1,d=0;d<x;d++){if(g=w?o.geometries[d]:o,g===null){if(s(null,L,E,k,z)===!1)return!1;continue}switch(g.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(s(g,L,E,k,z)===!1)return!1;break}case"GeometryCollection":{for(u=0;u<g.geometries.length;u++)if(s(g.geometries[u],L,E,k,z)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}L++}}function j3(e,s){U3(e,function(a,u,d,g,x){var o=a===null?null:a.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return s(Tf(a,d,{bbox:g,id:x}),u,0)===!1?!1:void 0}var w;switch(o){case"MultiPoint":w="Point";break;case"MultiLineString":w="LineString";break;case"MultiPolygon":w="Polygon";break}for(var E=0;E<a.coordinates.length;E++){var k=a.coordinates[E],z={type:w,coordinates:k};if(s(Tf(z,d),u,E)===!1)return!1}})}function G3(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function q3(e,s,a){if(!e)throw new Error("No featureCollection passed");if(!a)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+a+", FeatureCollection required");for(var u=0,d=e.features;u<d.length;u++){var g=d[u];if(!g||g.type!=="Feature"||!g.geometry)throw new Error("Invalid input to "+a+", Feature with geometry required");if(!g.geometry||g.geometry.type!==s)throw new Error("Invalid input to "+a+": must be a "+s+", given "+g.geometry.type)}}function Z3(e,s,a,u){u===void 0&&(u={});var d=G3(e),g=y_(d[0]),x=y_(d[1]),o=y_(a),w=V3(s,u.units),E=Math.asin(Math.sin(x)*Math.cos(w)+Math.cos(x)*Math.sin(w)*Math.cos(o)),k=g+Math.atan2(Math.sin(o)*Math.sin(w)*Math.cos(x),Math.cos(w)-Math.sin(x)*Math.sin(E)),z=zw(k),L=zw(E);return F3([z,L],u.properties)}function Dw(e,s,a){a===void 0&&(a={});for(var u=a.steps||64,d=a.properties?a.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},g=[],x=0;x<u;x++)g.push(Z3(e,s,x*-360/u,a).geometry.coordinates);return g.push(g[0]),oy([g],d)}function Rw(e){if(!e)throw new Error("geojson is required");var s=[];return j3(e,function(a){s.push(a)}),g0(s)}/**
 * splaytree v3.1.1
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function W3(e,s){var a={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},u,d,g,x;return x={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function o(E){return function(k){return w([E,k])}}function w(E){if(u)throw new TypeError("Generator is already executing.");for(;a;)try{if(u=1,d&&(g=E[0]&2?d.return:E[0]?d.throw||((g=d.return)&&g.call(d),0):d.next)&&!(g=g.call(d,E[1])).done)return g;switch(d=0,g&&(E=[E[0]&2,g.value]),E[0]){case 0:case 1:g=E;break;case 4:return a.label++,{value:E[1],done:!1};case 5:a.label++,d=E[1],E=[0];continue;case 7:E=a.ops.pop(),a.trys.pop();continue;default:if(g=a.trys,!(g=g.length>0&&g[g.length-1])&&(E[0]===6||E[0]===2)){a=0;continue}if(E[0]===3&&(!g||E[1]>g[0]&&E[1]<g[3])){a.label=E[1];break}if(E[0]===6&&a.label<g[1]){a.label=g[1],g=E;break}if(g&&a.label<g[2]){a.label=g[2],a.ops.push(E);break}g[2]&&a.ops.pop(),a.trys.pop();continue}E=s.call(e,a)}catch(k){E=[6,k],d=0}finally{u=g=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}}var hl=function(){function e(s,a){this.next=null,this.key=s,this.data=a,this.left=null,this.right=null}return e}();function H3(e,s){return e>s?1:e<s?-1:0}function rl(e,s,a){for(var u=new hl(null,null),d=u,g=u;;){var x=a(e,s.key);if(x<0){if(s.left===null)break;if(a(e,s.left.key)<0){var o=s.left;if(s.left=o.right,o.right=s,s=o,s.left===null)break}g.left=s,g=s,s=s.left}else if(x>0){if(s.right===null)break;if(a(e,s.right.key)>0){var o=s.right;if(s.right=o.left,o.left=s,s=o,s.right===null)break}d.right=s,d=s,s=s.right}else break}return d.right=s.left,g.left=s.right,s.left=u.right,s.right=u.left,s}function x_(e,s,a,u){var d=new hl(e,s);if(a===null)return d.left=d.right=null,d;a=rl(e,a,u);var g=u(e,a.key);return g<0?(d.left=a.left,d.right=a,a.left=null):g>=0&&(d.right=a.right,d.left=a,a.right=null),d}function Bw(e,s,a){var u=null,d=null;if(s){s=rl(e,s,a);var g=a(s.key,e);g===0?(u=s.left,d=s.right):g<0?(d=s.right,s.right=null,u=s):(u=s.left,s.left=null,d=s)}return{left:u,right:d}}function X3(e,s,a){return s===null?e:(e===null||(s=rl(e.key,s,a),s.left=e),s)}function sy(e,s,a,u,d){if(e){u(""+s+(a?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+d(e)+`
`);var g=s+(a?"    ":"\u2502   ");e.left&&sy(e.left,g,!1,u,d),e.right&&sy(e.right,g,!0,u,d)}}var v0=function(){function e(s){s===void 0&&(s=H3),this._root=null,this._size=0,this._comparator=s}return e.prototype.insert=function(s,a){return this._size++,this._root=x_(s,a,this._root,this._comparator)},e.prototype.add=function(s,a){var u=new hl(s,a);this._root===null&&(u.left=u.right=null,this._size++,this._root=u);var d=this._comparator,g=rl(s,this._root,d),x=d(s,g.key);return x===0?this._root=g:(x<0?(u.left=g.left,u.right=g,g.left=null):x>0&&(u.right=g.right,u.left=g,g.right=null),this._size++,this._root=u),this._root},e.prototype.remove=function(s){this._root=this._remove(s,this._root,this._comparator)},e.prototype._remove=function(s,a,u){var d;if(a===null)return null;a=rl(s,a,u);var g=u(s,a.key);return g===0?(a.left===null?d=a.right:(d=rl(s,a.left,u),d.right=a.right),this._size--,d):a},e.prototype.pop=function(){var s=this._root;if(s){for(;s.left;)s=s.left;return this._root=rl(s.key,this._root,this._comparator),this._root=this._remove(s.key,this._root,this._comparator),{key:s.key,data:s.data}}return null},e.prototype.findStatic=function(s){for(var a=this._root,u=this._comparator;a;){var d=u(s,a.key);if(d===0)return a;d<0?a=a.left:a=a.right}return null},e.prototype.find=function(s){return this._root&&(this._root=rl(s,this._root,this._comparator),this._comparator(s,this._root.key)!==0)?null:this._root},e.prototype.contains=function(s){for(var a=this._root,u=this._comparator;a;){var d=u(s,a.key);if(d===0)return!0;d<0?a=a.left:a=a.right}return!1},e.prototype.forEach=function(s,a){for(var u=this._root,d=[],g=!1;!g;)u!==null?(d.push(u),u=u.left):d.length!==0?(u=d.pop(),s.call(a,u),u=u.right):g=!0;return this},e.prototype.range=function(s,a,u,d){for(var g=[],x=this._comparator,o=this._root,w;g.length!==0||o;)if(o)g.push(o),o=o.left;else{if(o=g.pop(),w=x(o.key,a),w>0)break;if(x(o.key,s)>=0&&u.call(d,o))return this;o=o.right}return this},e.prototype.keys=function(){var s=[];return this.forEach(function(a){var u=a.key;return s.push(u)}),s},e.prototype.values=function(){var s=[];return this.forEach(function(a){var u=a.data;return s.push(u)}),s},e.prototype.min=function(){return this._root?this.minNode(this._root).key:null},e.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},e.prototype.minNode=function(s){if(s===void 0&&(s=this._root),s)for(;s.left;)s=s.left;return s},e.prototype.maxNode=function(s){if(s===void 0&&(s=this._root),s)for(;s.right;)s=s.right;return s},e.prototype.at=function(s){for(var a=this._root,u=!1,d=0,g=[];!u;)if(a)g.push(a),a=a.left;else if(g.length>0){if(a=g.pop(),d===s)return a;d++,a=a.right}else u=!0;return null},e.prototype.next=function(s){var a=this._root,u=null;if(s.right){for(u=s.right;u.left;)u=u.left;return u}for(var d=this._comparator;a;){var g=d(s.key,a.key);if(g===0)break;g<0?(u=a,a=a.left):a=a.right}return u},e.prototype.prev=function(s){var a=this._root,u=null;if(s.left!==null){for(u=s.left;u.right;)u=u.right;return u}for(var d=this._comparator;a;){var g=d(s.key,a.key);if(g===0)break;g<0?a=a.left:(u=a,a=a.right)}return u},e.prototype.clear=function(){return this._root=null,this._size=0,this},e.prototype.toList=function(){return K3(this._root)},e.prototype.load=function(s,a,u){a===void 0&&(a=[]),u===void 0&&(u=!1);var d=s.length,g=this._comparator;if(u&&cy(s,a,0,d-1,g),this._root===null)this._root=ay(s,a,0,d),this._size=d;else{var x=J3(this.toList(),Y3(s,a),g);d=this._size+d,this._root=ly({head:x},0,d)}return this},e.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.toString=function(s){s===void 0&&(s=function(u){return String(u.key)});var a=[];return sy(this._root,"",!0,function(u){return a.push(u)},s),a.join("")},e.prototype.update=function(s,a,u){var d=this._comparator,g=Bw(s,this._root,d),x=g.left,o=g.right;d(s,a)<0?o=x_(a,u,o,d):x=x_(a,u,x,d),this._root=X3(x,o,d)},e.prototype.split=function(s){return Bw(s,this._root,this._comparator)},e.prototype[Symbol.iterator]=function(){var s;return W3(this,function(a){switch(a.label){case 0:s=this.minNode(),a.label=1;case 1:return s?[4,s]:[3,3];case 2:return a.sent(),s=this.next(s),[3,1];case 3:return[2]}})},e}();function ay(e,s,a,u){var d=u-a;if(d>0){var g=a+Math.floor(d/2),x=e[g],o=s[g],w=new hl(x,o);return w.left=ay(e,s,a,g),w.right=ay(e,s,g+1,u),w}return null}function Y3(e,s){for(var a=new hl(null,null),u=a,d=0;d<e.length;d++)u=u.next=new hl(e[d],s[d]);return u.next=null,a.next}function K3(e){for(var s=e,a=[],u=!1,d=new hl(null,null),g=d;!u;)s?(a.push(s),s=s.left):a.length>0?(s=g=g.next=a.pop(),s=s.right):u=!0;return g.next=null,d.next}function ly(e,s,a){var u=a-s;if(u>0){var d=s+Math.floor(u/2),g=ly(e,s,d),x=e.head;return x.left=g,e.head=e.head.next,x.right=ly(e,d+1,a),x}return null}function J3(e,s,a){for(var u=new hl(null,null),d=u,g=e,x=s;g!==null&&x!==null;)a(g.key,x.key)<0?(d.next=g,g=g.next):(d.next=x,x=x.next),d=d.next;return g!==null?d.next=g:x!==null&&(d.next=x),u.next}function cy(e,s,a,u,d){if(!(a>=u)){for(var g=e[a+u>>1],x=a-1,o=u+1;;){do x++;while(d(e[x],g)<0);do o--;while(d(e[o],g)>0);if(x>=o)break;var w=e[x];e[x]=e[o],e[o]=w,w=s[x],s[x]=s[o],s[o]=w}cy(e,s,a,o,d),cy(e,s,o+1,u,d)}}function Do(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}function Ow(e,s){for(var a=0;a<s.length;a++){var u=s[a];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}function Zr(e,s,a){return s&&Ow(e.prototype,s),a&&Ow(e,a),e}var Gd=function(s,a){return s.ll.x<=a.x&&a.x<=s.ur.x&&s.ll.y<=a.y&&a.y<=s.ur.y},uy=function(s,a){if(a.ur.x<s.ll.x||s.ur.x<a.ll.x||a.ur.y<s.ll.y||s.ur.y<a.ll.y)return null;var u=s.ll.x<a.ll.x?a.ll.x:s.ll.x,d=s.ur.x<a.ur.x?s.ur.x:a.ur.x,g=s.ll.y<a.ll.y?a.ll.y:s.ll.y,x=s.ur.y<a.ur.y?s.ur.y:a.ur.y;return{ll:{x:u,y:g},ur:{x:d,y:x}}},ol=Number.EPSILON;ol===void 0&&(ol=Math.pow(2,-52));var Q3=ol*ol,hy=function(s,a){if(-ol<s&&s<ol&&-ol<a&&a<ol)return 0;var u=s-a;return u*u<Q3*s*a?0:s<a?-1:1},eO=function(){function e(){Do(this,e),this.reset()}return Zr(e,[{key:"reset",value:function(){this.xRounder=new Fw,this.yRounder=new Fw}},{key:"round",value:function(a,u){return{x:this.xRounder.round(a),y:this.yRounder.round(u)}}}]),e}(),Fw=function(){function e(){Do(this,e),this.tree=new v0,this.round(0)}return Zr(e,[{key:"round",value:function(a){var u=this.tree.add(a),d=this.tree.prev(u);if(d!==null&&hy(u.key,d.key)===0)return this.tree.remove(a),d.key;var g=this.tree.next(u);return g!==null&&hy(u.key,g.key)===0?(this.tree.remove(a),g.key):a}}]),e}(),Ef=new eO,sf=function(s,a){return s.x*a.y-s.y*a.x},kE=function(s,a){return s.x*a.x+s.y*a.y},Vw=function(s,a,u){var d={x:a.x-s.x,y:a.y-s.y},g={x:u.x-s.x,y:u.y-s.y},x=sf(d,g);return hy(x,0)},rg=function(s){return Math.sqrt(kE(s,s))},tO=function(s,a,u){var d={x:a.x-s.x,y:a.y-s.y},g={x:u.x-s.x,y:u.y-s.y};return sf(g,d)/rg(g)/rg(d)},nO=function(s,a,u){var d={x:a.x-s.x,y:a.y-s.y},g={x:u.x-s.x,y:u.y-s.y};return kE(g,d)/rg(g)/rg(d)},$w=function(s,a,u){return a.y===0?null:{x:s.x+a.x/a.y*(u-s.y),y:u}},Nw=function(s,a,u){return a.x===0?null:{x:u,y:s.y+a.y/a.x*(u-s.x)}},iO=function(s,a,u,d){if(a.x===0)return Nw(u,d,s.x);if(d.x===0)return Nw(s,a,u.x);if(a.y===0)return $w(u,d,s.y);if(d.y===0)return $w(s,a,u.y);var g=sf(a,d);if(g==0)return null;var x={x:u.x-s.x,y:u.y-s.y},o=sf(x,a)/g,w=sf(x,d)/g,E=s.x+w*a.x,k=u.x+o*d.x,z=s.y+w*a.y,L=u.y+o*d.y,O=(E+k)/2,G=(z+L)/2;return{x:O,y:G}},Is=function(){Zr(e,null,[{key:"compare",value:function(a,u){var d=e.comparePoints(a.point,u.point);return d!==0?d:(a.point!==u.point&&a.link(u),a.isLeft!==u.isLeft?a.isLeft?1:-1:og.compare(a.segment,u.segment))}},{key:"comparePoints",value:function(a,u){return a.x<u.x?-1:a.x>u.x?1:a.y<u.y?-1:a.y>u.y?1:0}}]);function e(s,a){Do(this,e),s.events===void 0?s.events=[this]:s.events.push(this),this.point=s,this.isLeft=a}return Zr(e,[{key:"link",value:function(a){if(a.point===this.point)throw new Error("Tried to link already linked events");for(var u=a.point.events,d=0,g=u.length;d<g;d++){var x=u[d];this.point.events.push(x),x.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var a=this.point.events.length,u=0;u<a;u++){var d=this.point.events[u];if(d.segment.consumedBy===void 0)for(var g=u+1;g<a;g++){var x=this.point.events[g];x.consumedBy===void 0&&d.otherSE.point.events===x.otherSE.point.events&&d.segment.consume(x.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var a=[],u=0,d=this.point.events.length;u<d;u++){var g=this.point.events[u];g!==this&&!g.segment.ringOut&&g.segment.isInResult()&&a.push(g)}return a}},{key:"getLeftmostComparator",value:function(a){var u=this,d=new Map,g=function(o){var w=o.otherSE;d.set(o,{sine:tO(u.point,a.point,w.point),cosine:nO(u.point,a.point,w.point)})};return function(x,o){d.has(x)||g(x),d.has(o)||g(o);var w=d.get(x),E=w.sine,k=w.cosine,z=d.get(o),L=z.sine,O=z.cosine;return E>=0&&L>=0?k<O?1:k>O?-1:0:E<0&&L<0?k<O?-1:k>O?1:0:L<E?-1:L>E?1:0}}}]),e}(),rO=0,og=function(){Zr(e,null,[{key:"compare",value:function(a,u){var d=a.leftSE.point.x,g=u.leftSE.point.x,x=a.rightSE.point.x,o=u.rightSE.point.x;if(o<d)return 1;if(x<g)return-1;var w=a.leftSE.point.y,E=u.leftSE.point.y,k=a.rightSE.point.y,z=u.rightSE.point.y;if(d<g){if(E<w&&E<k)return 1;if(E>w&&E>k)return-1;var L=a.comparePoint(u.leftSE.point);if(L<0)return 1;if(L>0)return-1;var O=u.comparePoint(a.rightSE.point);return O!==0?O:-1}if(d>g){if(w<E&&w<z)return-1;if(w>E&&w>z)return 1;var G=u.comparePoint(a.leftSE.point);if(G!==0)return G;var H=a.comparePoint(u.rightSE.point);return H<0?1:H>0?-1:1}if(w<E)return-1;if(w>E)return 1;if(x<o){var pe=u.comparePoint(a.rightSE.point);if(pe!==0)return pe}if(x>o){var se=a.comparePoint(u.rightSE.point);if(se<0)return 1;if(se>0)return-1}if(x!==o){var he=k-w,K=x-d,Te=z-E,Y=o-g;if(he>K&&Te<Y)return 1;if(he<K&&Te>Y)return-1}return x>o?1:x<o||k<z?-1:k>z?1:a.id<u.id?-1:a.id>u.id?1:0}}]);function e(s,a,u,d){Do(this,e),this.id=++rO,this.leftSE=s,s.segment=this,s.otherSE=a,this.rightSE=a,a.segment=this,a.otherSE=s,this.rings=u,this.windings=d}return Zr(e,[{key:"replaceRightSE",value:function(a){this.rightSE=a,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var a=this.leftSE.point.y,u=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:a<u?a:u},ur:{x:this.rightSE.point.x,y:a>u?a:u}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(a){return a.x===this.leftSE.point.x&&a.y===this.leftSE.point.y||a.x===this.rightSE.point.x&&a.y===this.rightSE.point.y}},{key:"comparePoint",value:function(a){if(this.isAnEndpoint(a))return 0;var u=this.leftSE.point,d=this.rightSE.point,g=this.vector();if(u.x===d.x)return a.x===u.x?0:a.x<u.x?1:-1;var x=(a.y-u.y)/g.y,o=u.x+x*g.x;if(a.x===o)return 0;var w=(a.x-u.x)/g.x,E=u.y+w*g.y;return a.y===E?0:a.y<E?-1:1}},{key:"getIntersection",value:function(a){var u=this.bbox(),d=a.bbox(),g=uy(u,d);if(g===null)return null;var x=this.leftSE.point,o=this.rightSE.point,w=a.leftSE.point,E=a.rightSE.point,k=Gd(u,w)&&this.comparePoint(w)===0,z=Gd(d,x)&&a.comparePoint(x)===0,L=Gd(u,E)&&this.comparePoint(E)===0,O=Gd(d,o)&&a.comparePoint(o)===0;if(z&&k)return O&&!L?o:!O&&L?E:null;if(z)return L&&x.x===E.x&&x.y===E.y?null:x;if(k)return O&&o.x===w.x&&o.y===w.y?null:w;if(O&&L)return null;if(O)return o;if(L)return E;var G=iO(x,this.vector(),w,a.vector());return G===null||!Gd(g,G)?null:Ef.round(G.x,G.y)}},{key:"split",value:function(a){var u=[],d=a.events!==void 0,g=new Is(a,!0),x=new Is(a,!1),o=this.rightSE;this.replaceRightSE(x),u.push(x),u.push(g);var w=new e(g,o,this.rings.slice(),this.windings.slice());return Is.comparePoints(w.leftSE.point,w.rightSE.point)>0&&w.swapEvents(),Is.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),d&&(g.checkForConsuming(),x.checkForConsuming()),u}},{key:"swapEvents",value:function(){var a=this.rightSE;this.rightSE=this.leftSE,this.leftSE=a,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var u=0,d=this.windings.length;u<d;u++)this.windings[u]*=-1}},{key:"consume",value:function(a){for(var u=this,d=a;u.consumedBy;)u=u.consumedBy;for(;d.consumedBy;)d=d.consumedBy;var g=e.compare(u,d);if(g!==0){if(g>0){var x=u;u=d,d=x}if(u.prev===d){var o=u;u=d,d=o}for(var w=0,E=d.rings.length;w<E;w++){var k=d.rings[w],z=d.windings[w],L=u.rings.indexOf(k);L===-1?(u.rings.push(k),u.windings.push(z)):u.windings[L]+=z}d.rings=null,d.windings=null,d.consumedBy=u,d.leftSE.consumedBy=u.leftSE,d.rightSE.consumedBy=u.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var a=this.prev.consumedBy||this.prev;this._beforeState=a.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var a=this.beforeState();this._afterState={rings:a.rings.slice(0),windings:a.windings.slice(0),multiPolys:[]};for(var u=this._afterState.rings,d=this._afterState.windings,g=this._afterState.multiPolys,x=0,o=this.rings.length;x<o;x++){var w=this.rings[x],E=this.windings[x],k=u.indexOf(w);k===-1?(u.push(w),d.push(E)):d[k]+=E}for(var z=[],L=[],O=0,G=u.length;O<G;O++)if(d[O]!==0){var H=u[O],pe=H.poly;if(L.indexOf(pe)===-1)if(H.isExterior)z.push(pe);else{L.indexOf(pe)===-1&&L.push(pe);var se=z.indexOf(H.poly);se!==-1&&z.splice(se,1)}}for(var he=0,K=z.length;he<K;he++){var Te=z[he].multiPoly;g.indexOf(Te)===-1&&g.push(Te)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var a=this.beforeState().multiPolys,u=this.afterState().multiPolys;switch(Ko.type){case"union":{var d=a.length===0,g=u.length===0;this._isInResult=d!==g;break}case"intersection":{var x,o;a.length<u.length?(x=a.length,o=u.length):(x=u.length,o=a.length),this._isInResult=o===Ko.numMultiPolys&&x<o;break}case"xor":{var w=Math.abs(a.length-u.length);this._isInResult=w%2===1;break}case"difference":{var E=function(z){return z.length===1&&z[0].isSubject};this._isInResult=E(a)!==E(u);break}default:throw new Error("Unrecognized operation type found ".concat(Ko.type))}return this._isInResult}}],[{key:"fromRing",value:function(a,u,d){var g,x,o,w=Is.comparePoints(a,u);if(w<0)g=a,x=u,o=1;else if(w>0)g=u,x=a,o=-1;else throw new Error("Tried to create degenerate segment at [".concat(a.x,", ").concat(a.y,"]"));var E=new Is(g,!0),k=new Is(x,!1);return new e(E,k,[d],[o])}}]),e}(),Uw=function(){function e(s,a,u){if(Do(this,e),!Array.isArray(s)||s.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=a,this.isExterior=u,this.segments=[],typeof s[0][0]!="number"||typeof s[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var d=Ef.round(s[0][0],s[0][1]);this.bbox={ll:{x:d.x,y:d.y},ur:{x:d.x,y:d.y}};for(var g=d,x=1,o=s.length;x<o;x++){if(typeof s[x][0]!="number"||typeof s[x][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var w=Ef.round(s[x][0],s[x][1]);w.x===g.x&&w.y===g.y||(this.segments.push(og.fromRing(g,w,this)),w.x<this.bbox.ll.x&&(this.bbox.ll.x=w.x),w.y<this.bbox.ll.y&&(this.bbox.ll.y=w.y),w.x>this.bbox.ur.x&&(this.bbox.ur.x=w.x),w.y>this.bbox.ur.y&&(this.bbox.ur.y=w.y),g=w)}(d.x!==g.x||d.y!==g.y)&&this.segments.push(og.fromRing(g,d,this))}return Zr(e,[{key:"getSweepEvents",value:function(){for(var a=[],u=0,d=this.segments.length;u<d;u++){var g=this.segments[u];a.push(g.leftSE),a.push(g.rightSE)}return a}}]),e}(),oO=function(){function e(s,a){if(Do(this,e),!Array.isArray(s))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Uw(s[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var u=1,d=s.length;u<d;u++){var g=new Uw(s[u],this,!1);g.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=g.bbox.ll.x),g.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=g.bbox.ll.y),g.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=g.bbox.ur.x),g.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=g.bbox.ur.y),this.interiorRings.push(g)}this.multiPoly=a}return Zr(e,[{key:"getSweepEvents",value:function(){for(var a=this.exteriorRing.getSweepEvents(),u=0,d=this.interiorRings.length;u<d;u++)for(var g=this.interiorRings[u].getSweepEvents(),x=0,o=g.length;x<o;x++)a.push(g[x]);return a}}]),e}(),jw=function(){function e(s,a){if(Do(this,e),!Array.isArray(s))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof s[0][0][0]=="number"&&(s=[s])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var u=0,d=s.length;u<d;u++){var g=new oO(s[u],this);g.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=g.bbox.ll.x),g.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=g.bbox.ll.y),g.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=g.bbox.ur.x),g.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=g.bbox.ur.y),this.polys.push(g)}this.isSubject=a}return Zr(e,[{key:"getSweepEvents",value:function(){for(var a=[],u=0,d=this.polys.length;u<d;u++)for(var g=this.polys[u].getSweepEvents(),x=0,o=g.length;x<o;x++)a.push(g[x]);return a}}]),e}(),sO=function(){Zr(e,null,[{key:"factory",value:function(a){for(var u=[],d=0,g=a.length;d<g;d++){var x=a[d];if(!(!x.isInResult()||x.ringOut)){for(var o=null,w=x.leftSE,E=x.rightSE,k=[w],z=w.point,L=[];o=w,w=E,k.push(w),w.point!==z;)for(;;){var O=w.getAvailableLinkedEvents();if(O.length===0){var G=k[0].point,H=k[k.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(G.x,",")+" ".concat(G.y,"]. Last matching segment found ends at")+" [".concat(H.x,", ").concat(H.y,"]."))}if(O.length===1){E=O[0].otherSE;break}for(var pe=null,se=0,he=L.length;se<he;se++)if(L[se].point===w.point){pe=se;break}if(pe!==null){var K=L.splice(pe)[0],Te=k.splice(K.index);Te.unshift(Te[0].otherSE),u.push(new e(Te.reverse()));continue}L.push({index:k.length,point:w.point});var Y=w.getLeftmostComparator(o);E=O.sort(Y)[0].otherSE;break}u.push(new e(k))}}return u}}]);function e(s){Do(this,e),this.events=s;for(var a=0,u=s.length;a<u;a++)s[a].segment.ringOut=this;this.poly=null}return Zr(e,[{key:"getGeom",value:function(){for(var a=this.events[0].point,u=[a],d=1,g=this.events.length-1;d<g;d++){var x=this.events[d].point,o=this.events[d+1].point;Vw(x,a,o)!==0&&(u.push(x),a=x)}if(u.length===1)return null;var w=u[0],E=u[1];Vw(w,a,E)===0&&u.shift(),u.push(u[0]);for(var k=this.isExteriorRing()?1:-1,z=this.isExteriorRing()?0:u.length-1,L=this.isExteriorRing()?u.length:-1,O=[],G=z;G!=L;G+=k)O.push([u[G].x,u[G].y]);return O}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var a=this.enclosingRing();this._isExteriorRing=a?!a.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var a=this.events[0],u=1,d=this.events.length;u<d;u++){var g=this.events[u];Is.compare(a,g)>0&&(a=g)}for(var x=a.segment.prevInResult(),o=x?x.prevInResult():null;;){if(!x)return null;if(!o)return x.ringOut;if(o.ringOut!==x.ringOut)return o.ringOut.enclosingRing()!==x.ringOut?x.ringOut:x.ringOut.enclosingRing();x=o.prevInResult(),o=x?x.prevInResult():null}}}]),e}(),Gw=function(){function e(s){Do(this,e),this.exteriorRing=s,s.poly=this,this.interiorRings=[]}return Zr(e,[{key:"addInterior",value:function(a){this.interiorRings.push(a),a.poly=this}},{key:"getGeom",value:function(){var a=[this.exteriorRing.getGeom()];if(a[0]===null)return null;for(var u=0,d=this.interiorRings.length;u<d;u++){var g=this.interiorRings[u].getGeom();g!==null&&a.push(g)}return a}}]),e}(),aO=function(){function e(s){Do(this,e),this.rings=s,this.polys=this._composePolys(s)}return Zr(e,[{key:"getGeom",value:function(){for(var a=[],u=0,d=this.polys.length;u<d;u++){var g=this.polys[u].getGeom();g!==null&&a.push(g)}return a}},{key:"_composePolys",value:function(a){for(var u=[],d=0,g=a.length;d<g;d++){var x=a[d];if(!x.poly)if(x.isExteriorRing())u.push(new Gw(x));else{var o=x.enclosingRing();o.poly||u.push(new Gw(o)),o.poly.addInterior(x)}}return u}}]),e}(),lO=function(){function e(s){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:og.compare;Do(this,e),this.queue=s,this.tree=new v0(a),this.segments=[]}return Zr(e,[{key:"process",value:function(a){var u=a.segment,d=[];if(a.consumedBy)return a.isLeft?this.queue.remove(a.otherSE):this.tree.remove(u),d;var g=a.isLeft?this.tree.insert(u):this.tree.find(u);if(!g)throw new Error("Unable to find segment #".concat(u.id," ")+"[".concat(u.leftSE.point.x,", ").concat(u.leftSE.point.y,"] -> ")+"[".concat(u.rightSE.point.x,", ").concat(u.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var x=g,o=g,w=void 0,E=void 0;w===void 0;)x=this.tree.prev(x),x===null?w=null:x.key.consumedBy===void 0&&(w=x.key);for(;E===void 0;)o=this.tree.next(o),o===null?E=null:o.key.consumedBy===void 0&&(E=o.key);if(a.isLeft){var k=null;if(w){var z=w.getIntersection(u);if(z!==null&&(u.isAnEndpoint(z)||(k=z),!w.isAnEndpoint(z)))for(var L=this._splitSafely(w,z),O=0,G=L.length;O<G;O++)d.push(L[O])}var H=null;if(E){var pe=E.getIntersection(u);if(pe!==null&&(u.isAnEndpoint(pe)||(H=pe),!E.isAnEndpoint(pe)))for(var se=this._splitSafely(E,pe),he=0,K=se.length;he<K;he++)d.push(se[he])}if(k!==null||H!==null){var Te=null;if(k===null)Te=H;else if(H===null)Te=k;else{var Y=Is.comparePoints(k,H);Te=Y<=0?k:H}this.queue.remove(u.rightSE),d.push(u.rightSE);for(var _e=u.split(Te),de=0,ve=_e.length;de<ve;de++)d.push(_e[de])}d.length>0?(this.tree.remove(u),d.push(a)):(this.segments.push(u),u.prev=w)}else{if(w&&E){var Se=w.getIntersection(E);if(Se!==null){if(!w.isAnEndpoint(Se))for(var be=this._splitSafely(w,Se),De=0,ze=be.length;De<ze;De++)d.push(be[De]);if(!E.isAnEndpoint(Se))for(var Je=this._splitSafely(E,Se),ct=0,nt=Je.length;ct<nt;ct++)d.push(Je[ct])}}this.tree.remove(u)}return d}},{key:"_splitSafely",value:function(a,u){this.tree.remove(a);var d=a.rightSE;this.queue.remove(d);var g=a.split(u);return g.push(d),a.consumedBy===void 0&&this.tree.insert(a),g}}]),e}(),qw=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,cO=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,uO=function(){function e(){Do(this,e)}return Zr(e,[{key:"run",value:function(a,u,d){Ko.type=a,Ef.reset();for(var g=[new jw(u,!0)],x=0,o=d.length;x<o;x++)g.push(new jw(d[x],!1));if(Ko.numMultiPolys=g.length,Ko.type==="difference")for(var w=g[0],E=1;E<g.length;)uy(g[E].bbox,w.bbox)!==null?E++:g.splice(E,1);if(Ko.type==="intersection"){for(var k=0,z=g.length;k<z;k++)for(var L=g[k],O=k+1,G=g.length;O<G;O++)if(uy(L.bbox,g[O].bbox)===null)return[]}for(var H=new v0(Is.compare),pe=0,se=g.length;pe<se;pe++)for(var he=g[pe].getSweepEvents(),K=0,Te=he.length;K<Te;K++)if(H.insert(he[K]),H.size>qw)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var Y=new lO(H),_e=H.size,de=H.pop();de;){var ve=de.key;if(H.size===_e){var Se=ve.segment;throw new Error("Unable to pop() ".concat(ve.isLeft?"left":"right"," SweepEvent ")+"[".concat(ve.point.x,", ").concat(ve.point.y,"] from segment #").concat(Se.id," ")+"[".concat(Se.leftSE.point.x,", ").concat(Se.leftSE.point.y,"] -> ")+"[".concat(Se.rightSE.point.x,", ").concat(Se.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(H.size>qw)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(Y.segments.length>cO)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var be=Y.process(ve),De=0,ze=be.length;De<ze;De++){var Je=be[De];Je.consumedBy===void 0&&H.insert(Je)}_e=H.size,de=H.pop()}Ef.reset();var ct=sO.factory(Y.segments),nt=new aO(ct);return nt.getGeom()}}]),e}(),Ko=new uO,hO=function(s){for(var a=arguments.length,u=new Array(a>1?a-1:0),d=1;d<a;d++)u[d-1]=arguments[d];return Ko.run("union",s,u)},dO=function(s){for(var a=arguments.length,u=new Array(a>1?a-1:0),d=1;d<a;d++)u[d-1]=arguments[d];return Ko.run("intersection",s,u)},fO=function(s){for(var a=arguments.length,u=new Array(a>1?a-1:0),d=1;d<a;d++)u[d-1]=arguments[d];return Ko.run("xor",s,u)},pO=function(s){for(var a=arguments.length,u=new Array(a>1?a-1:0),d=1;d<a;d++)u[d-1]=arguments[d];return Ko.run("difference",s,u)},Zw={union:hO,intersection:dO,xor:fO,difference:pO};function mO(e,s){if(s=s||{},!$3(s))throw new Error("options is invalid");var a=s.propertyName;q3(e,"Polygon","dissolve");var u=[];if(s.propertyName){var d={};N3(e,function(w){Object.prototype.hasOwnProperty.call(d,w.properties[a])||(d[w.properties[a]]=[]),d[w.properties[a]].push(w)});for(var g=Object.keys(d),x=0;x<g.length;x++){var o=Pw(Zw.union.apply(null,d[g[x]].map(function(w){return w.geometry.coordinates})));o.properties[a]=g[x],u.push(o)}}else return Rw(Pw(Zw.union.apply(null,e.features.map(function(w){return w.geometry.coordinates}))));return Rw(g0(u))}const gO={class:"container"},vO=Ln({__name:"MapSPF",setup(e){let s=Ke(50),a=Ke();function u(){s.value++}function d(){s.value--}const g=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[4,0,2,4,8,5,4,6,5,9,1,3,2,4,4,6],[3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],[4,0,2,4,8,6,5,6,5,8,1,3,2,4,4,6],[5,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[6,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,1,5,9,2,3,2,4,3,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,8,2,5,9,1,3,2,4,4,6],[5,0,2,4,8,6,4,6,5,9,1,3,2,8,4,6],[1,0,2,4,8,6,4,6,4,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,2,2,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,5,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,3,9,1,3,2,4,4,6],[1,0,6,4,8,6,4,6,5,9,1,3,2,4,4,5],[1,2,2,4,1,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,3,4,6,5,9,2,3,2,4,4,6],[8,0,2,4,8,6,4,6,7,9,1,3,2,4,4,6],[1,2,6,4,8,6,4,6,3,9,1,3,2,4,4,6],[1,6,2,4,8,6,4,6,5,9,1,3,2,5,4,6],[1,8,2,4,8,6,4,6,5,9,1,3,2,4,4,7],[1,0,2,4,8,6,4,6,3,9,1,3,2,4,4,6],[1,0,5,4,8,6,4,6,5,9,1,3,2,4,4,6]],x=["#FFEBEE","#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828","#B71C1C"];Ke(0);function o(L){return L===0?"black":x[L]}const w=g0([]),E=30,k=[120,30];let z;for(let L=0;L<E;L++){let O=Dw(k,L+1,{steps:64,units:"kilometers"});const G=g[L];for(let H=0;H<16;H++)G[H]!==0&&(L===0?w.features.push(oy([[k,...O.geometry.coordinates[0].slice(4*H,4*(H+1)+1),k]],{color:o(G[H])})):(z=Dw(k,L,{steps:64,units:"kilometers"}),w.features.push(oy([[...z.geometry.coordinates[0].slice(4*H,4*(H+1)+1),...O.geometry.coordinates[0].slice(4*H,4*(H+1)+1).reverse(),z.geometry.coordinates[0][4*H]]],{color:o(G[H])}))));a=mO(w,{propertyName:"color"})}return(L,O)=>{const G=ua("v-geo-source"),H=ua("v-fill-layer");return Xi(),es("div",gO,[F(Vf,null,{default:xi(()=>[F(G,{id:"spf",data:Ai(a)},null,8,["data"]),F(H,{ref:"fillLayerRef",id:"spf",source:"spf",paint:{"fill-color":["get","color"],"fill-opacity":Ai(s)/100}},null,8,["paint"])]),_:1}),F(Lf,{class:"slide-opacity mx-auto",width:"400",color:"primary",height:"74"},{default:xi(()=>[F(o0,null,{default:xi(()=>[F(ng,{modelValue:Ai(s),"onUpdate:modelValue":O[0]||(O[0]=pe=>ki(s)?s.value=pe:s=pe),color:"black","track-color":"grey",min:"0",max:"100",step:1},{prepend:xi(()=>[F(bi,{size:"small",variant:"text",icon:"mdi-minus",color:"black",onClick:d})]),append:xi(()=>[F(bi,{size:"small",variant:"text",icon:"mdi-plus",color:"black",onClick:u})]),_:1},8,["modelValue"])]),_:1})]),_:1})])}}});const _O=Bs(vO,[["__scopeId","data-v-a81c186e"]]),yO=Ln({__name:"MapPopulation",setup(e){return(s,a)=>(Xi(),es("div",null,[F(Vf)]))}}),xO={},bO=Ln({__name:"MapTyphoon",setup(e){return(s,a)=>(Xi(),es("div",null,[F(Vf)]))}}),wO="modulepreload",SO=function(e,s){return new URL(e,s).href},Ww={},Hw=function(s,a,u){if(!a||a.length===0)return s();const d=document.getElementsByTagName("link");return Promise.all(a.map(g=>{if(g=SO(g,u),g in Ww)return;Ww[g]=!0;const x=g.endsWith(".css"),o=x?'[rel="stylesheet"]':"";if(!!u)for(let k=d.length-1;k>=0;k--){const z=d[k];if(z.href===g&&(!x||z.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${g}"]${o}`))return;const E=document.createElement("link");if(E.rel=x?"stylesheet":wO,x||(E.as="script",E.crossOrigin=""),E.href=g,document.head.appendChild(E),x)return new Promise((k,z)=>{E.addEventListener("load",k),E.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${g}`)))})})).then(()=>s())};const TO={class:"demo-content"},EO={__name:"MapInversion",setup(e){const s=Ke(null),a=Ke(null),u=async(d,g)=>{const x=await Hw(()=>Promise.resolve().then(()=>lD),void 0,import.meta.url).then(z=>z.default),{WindLayer:o,ScalarFill:w}=await Hw(()=>import("./mapbox-wind.esm.e915b542.js"),[],import.meta.url);x.accessToken="pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA";const E=new x.Map({container:d,style:{version:8,sources:{carto:{type:"raster",tiles:["//a.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","//b.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","//c.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","//d.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"carto",type:"raster",source:"carto",paint:{"raster-resampling":"nearest","raster-fade-duration":0}},{id:"background",type:"background",layout:{visibility:"none"}}]},center:[113.53450137499999,34.44104525],zoom:4}),k={temp:[[203,[115,70,105,255]],[218,[202,172,195,255]],[233,[162,70,145,255]],[248,[143,89,169,255]],[258,[157,219,217,255]],[265,[106,191,181,255]],[269,[100,166,189,255]],[273.15,[93,133,198,255]],[274,[68,125,99,255]],[283,[128,147,24,255]],[294,[243,183,4,255]],[303,[232,83,25,255]],[320,[71,14,0,255]]],wind:[[0,[98,113,183,255]],[1,[57,97,159,255]],[3,[74,148,169,255]],[5,[77,141,123,255]],[7,[83,165,83,255]],[9,[53,159,53,255]],[11,[167,157,81,255]],[13,[159,127,58,255]],[15,[161,108,92,255]],[17,[129,58,78,255]],[19,[175,80,136,255]],[21,[117,74,147,255]],[24,[109,97,163,255]],[27,[68,105,141,255]],[29,[92,144,152,255]],[36,[125,68,165,255]],[46,[231,215,215,255]],[51,[219,212,135,255]],[77,[205,202,112,255]],[104,[128,128,128,255]]]};E.on("load",()=>{fetch("https://sakitam.oss-cn-beijing.aliyuncs.com/codepen/wind-layer/json/wind.json").then(z=>z.json()).then(z=>{console.log(z);const L=k.wind.reduce((G,H,pe)=>G.concat(H[0],"rgba("+H[1].join(",")+")"),[]),O=new w("wind-fill",{type:"image",url:"https://sakitam.oss-cn-beijing.aliyuncs.com/codepen/wind-layer/image/var_ugrd-var_vgrd.png",extent:[[-180,85.051129],[-180,-85.051129],[180,85.051129],[180,-85.051129]]},{styleSpec:{"fill-color":["interpolate",["linear"],["get","value"],...L],opacity:["interpolate",["exponential",.5],["zoom"],5,1,8,1]},renderForm:"rg",widthSegments:720,heightSegments:360,displayRange:[0,150],mappingRange:[0,1e5]});E.addLayer(O),window.windLayer=new o("wind",z,{windOptions:{frameRate:16,maxAge:60,globalAlpha:.9,velocityScale:.01,paths:3782}}),console.log(E,window.windLayer),window.windLayer.addTo(E)})})};return kn(()=>{u(s.value,a.value)}),(d,g)=>(Xi(),es("div",TO,[Sc("div",{class:"demo-content-datgui",ref_key:"gui",ref:a},null,512),Sc("div",{class:"map-warp",ref_key:"map",ref:s},null,512)]))}},b_=Ln({__name:"MapDose",setup(e){return(s,a)=>(Xi(),es("div",null,[F(Vf)]))}}),CO=[{path:"/",components:{left_draw:Wu,main_view:uc}},{path:"/map",name:"index",components:{left_draw:Wu,main_view:uc}},{path:"/finance",name:"finance",components:{main_view:uc}},{path:"/meteorology",name:"meteorology",components:{main_view:uc}},{path:"/evaluation",name:"nuclear",components:{main_view:uc}},{path:"/evacuate",name:"evacuate",components:{main_view:_O}},{path:"/map/map",name:"sub_index",components:{left_draw:Wu,main_view:uc}},{path:"/map/land",name:"land",components:{left_draw:Wu,main_view:__}},{path:"/map/elevation",name:"elevation",components:{left_draw:Wu,main_view:B3}},{path:"/finance/gdp",name:"gdp",components:{main_view:uc}},{path:"/finance/density",name:"density",components:{main_view:yO}},{path:"/meteorology/weather",name:"weather",components:{main_view:xO}},{path:"/meteorology/typhoon",name:"typhoon",components:{main_view:bO}},{path:"/meteorology/inversion",name:"inversion",components:{main_view:EO}},{path:"/evaluation/single",name:"single",components:{main_view:b_}},{path:"/evaluation/multiple",name:"multiple",components:{main_view:b_}},{path:"/evaluation/single",name:"single",components:{main_view:b_}},{path:"/evacuate/success",name:"success",components:{main_view:__}},{path:"/evacuate/failure",name:"failure",components:{main_view:__}}],IO=SL({history:Vz(),routes:CO});LM(sD).use(IO).use(w3).use(RD).mount("#app");export{s0 as m};
