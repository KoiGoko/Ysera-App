(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))d(m);new MutationObserver(m=>{for(const v of m)if(v.type==="childList")for(const b of v.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&d(b)}).observe(document,{childList:!0,subtree:!0});function l(m){const v={};return m.integrity&&(v.integrity=m.integrity),m.referrerpolicy&&(v.referrerPolicy=m.referrerpolicy),m.crossorigin==="use-credentials"?v.credentials="include":m.crossorigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function d(m){if(m.ep)return;m.ep=!0;const v=l(m);fetch(m.href,v)}})();function Hv(t,a){const l=Object.create(null),d=t.split(",");for(let m=0;m<d.length;m++)l[d[m]]=!0;return a?m=>!!l[m.toLowerCase()]:m=>!!l[m]}const II="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",AI=Hv(II);function pw(t){return!!t||t===""}function Xv(t){if(xn(t)){const a={};for(let l=0;l<t.length;l++){const d=t[l],m=ir(d)?PI(d):Xv(d);if(m)for(const v in m)a[v]=m[v]}return a}else{if(ir(t))return t;if(Ri(t))return t}}const kI=/;(?![^(]*\))/g,MI=/:(.+)/;function PI(t){const a={};return t.split(kI).forEach(l=>{if(l){const d=l.split(MI);d.length>1&&(a[d[0].trim()]=d[1].trim())}}),a}function Yv(t){let a="";if(ir(t))a=t;else if(xn(t))for(let l=0;l<t.length;l++){const d=Yv(t[l]);d&&(a+=d+" ")}else if(Ri(t))for(const l in t)t[l]&&(a+=l+" ");return a.trim()}const zI=t=>ir(t)?t:t==null?"":xn(t)||Ri(t)&&(t.toString===vw||!Ln(t.toString))?JSON.stringify(t,mw,2):String(t),mw=(t,a)=>a&&a.__v_isRef?mw(t,a.value):ju(a)?{[`Map(${a.size})`]:[...a.entries()].reduce((l,[d,m])=>(l[`${d} =>`]=m,l),{})}:gw(a)?{[`Set(${a.size})`]:[...a.values()]}:Ri(a)&&!xn(a)&&!yw(a)?String(a):a,bi={},Uu=[],Jo=()=>{},LI=()=>!1,DI=/^on[^a-z]/,jm=t=>DI.test(t),Kv=t=>t.startsWith("onUpdate:"),Er=Object.assign,Jv=(t,a)=>{const l=t.indexOf(a);l>-1&&t.splice(l,1)},BI=Object.prototype.hasOwnProperty,Wn=(t,a)=>BI.call(t,a),xn=Array.isArray,ju=t=>Gm(t)==="[object Map]",gw=t=>Gm(t)==="[object Set]",Ln=t=>typeof t=="function",ir=t=>typeof t=="string",Qv=t=>typeof t=="symbol",Ri=t=>t!==null&&typeof t=="object",_w=t=>Ri(t)&&Ln(t.then)&&Ln(t.catch),vw=Object.prototype.toString,Gm=t=>vw.call(t),RI=t=>Gm(t).slice(8,-1),yw=t=>Gm(t)==="[object Object]",ey=t=>ir(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ym=Hv(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),qm=t=>{const a=Object.create(null);return l=>a[l]||(a[l]=t(l))},OI=/-(\w)/g,Mo=qm(t=>t.replace(OI,(a,l)=>l?l.toUpperCase():"")),FI=/\B([A-Z])/g,Ju=qm(t=>t.replace(FI,"-$1").toLowerCase()),ol=qm(t=>t.charAt(0).toUpperCase()+t.slice(1)),xm=qm(t=>t?`on${ol(t)}`:""),Qh=(t,a)=>!Object.is(t,a),bm=(t,a)=>{for(let l=0;l<t.length;l++)t[l](a)},Em=(t,a,l)=>{Object.defineProperty(t,a,{configurable:!0,enumerable:!1,value:l})},Cm=t=>{const a=parseFloat(t);return isNaN(a)?t:a};let A1;const VI=()=>A1||(A1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Eo;class xw{constructor(a=!1){this.detached=a,this.active=!0,this.effects=[],this.cleanups=[],this.parent=Eo,!a&&Eo&&(this.index=(Eo.scopes||(Eo.scopes=[])).push(this)-1)}run(a){if(this.active){const l=Eo;try{return Eo=this,a()}finally{Eo=l}}}on(){Eo=this}off(){Eo=this.parent}stop(a){if(this.active){let l,d;for(l=0,d=this.effects.length;l<d;l++)this.effects[l].stop();for(l=0,d=this.cleanups.length;l<d;l++)this.cleanups[l]();if(this.scopes)for(l=0,d=this.scopes.length;l<d;l++)this.scopes[l].stop(!0);if(!this.detached&&this.parent&&!a){const m=this.parent.scopes.pop();m&&m!==this&&(this.parent.scopes[this.index]=m,m.index=this.index)}this.parent=void 0,this.active=!1}}}function _f(t){return new xw(t)}function $I(t,a=Eo){a&&a.active&&a.effects.push(t)}function vc(t){Eo&&Eo.cleanups.push(t)}const ty=t=>{const a=new Set(t);return a.w=0,a.n=0,a},bw=t=>(t.w&il)>0,ww=t=>(t.n&il)>0,NI=({deps:t})=>{if(t.length)for(let a=0;a<t.length;a++)t[a].w|=il},UI=t=>{const{deps:a}=t;if(a.length){let l=0;for(let d=0;d<a.length;d++){const m=a[d];bw(m)&&!ww(m)?m.delete(t):a[l++]=m,m.w&=~il,m.n&=~il}a.length=l}},lv=new WeakMap;let Uh=0,il=1;const cv=30;let Xo;const fc=Symbol(""),uv=Symbol("");class ny{constructor(a,l=null,d){this.fn=a,this.scheduler=l,this.active=!0,this.deps=[],this.parent=void 0,$I(this,d)}run(){if(!this.active)return this.fn();let a=Xo,l=nl;for(;a;){if(a===this)return;a=a.parent}try{return this.parent=Xo,Xo=this,nl=!0,il=1<<++Uh,Uh<=cv?NI(this):k1(this),this.fn()}finally{Uh<=cv&&UI(this),il=1<<--Uh,Xo=this.parent,nl=l,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Xo===this?this.deferStop=!0:this.active&&(k1(this),this.onStop&&this.onStop(),this.active=!1)}}function k1(t){const{deps:a}=t;if(a.length){for(let l=0;l<a.length;l++)a[l].delete(t);a.length=0}}let nl=!0;const Tw=[];function yc(){Tw.push(nl),nl=!1}function xc(){const t=Tw.pop();nl=t===void 0?!0:t}function co(t,a,l){if(nl&&Xo){let d=lv.get(t);d||lv.set(t,d=new Map);let m=d.get(l);m||d.set(l,m=ty()),Sw(m)}}function Sw(t,a){let l=!1;Uh<=cv?ww(t)||(t.n|=il,l=!bw(t)):l=!t.has(Xo),l&&(t.add(Xo),Xo.deps.push(t))}function sa(t,a,l,d,m,v){const b=lv.get(t);if(!b)return;let o=[];if(a==="clear")o=[...b.values()];else if(l==="length"&&xn(t))b.forEach((w,C)=>{(C==="length"||C>=d)&&o.push(w)});else switch(l!==void 0&&o.push(b.get(l)),a){case"add":xn(t)?ey(l)&&o.push(b.get("length")):(o.push(b.get(fc)),ju(t)&&o.push(b.get(uv)));break;case"delete":xn(t)||(o.push(b.get(fc)),ju(t)&&o.push(b.get(uv)));break;case"set":ju(t)&&o.push(b.get(fc));break}if(o.length===1)o[0]&&dv(o[0]);else{const w=[];for(const C of o)C&&w.push(...C);dv(ty(w))}}function dv(t,a){const l=xn(t)?t:[...t];for(const d of l)d.computed&&M1(d);for(const d of l)d.computed||M1(d)}function M1(t,a){(t!==Xo||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const jI=Hv("__proto__,__v_isRef,__isVue"),Ew=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Qv)),GI=iy(),qI=iy(!1,!0),ZI=iy(!0),P1=WI();function WI(){const t={};return["includes","indexOf","lastIndexOf"].forEach(a=>{t[a]=function(...l){const d=Hn(this);for(let v=0,b=this.length;v<b;v++)co(d,"get",v+"");const m=d[a](...l);return m===-1||m===!1?d[a](...l.map(Hn)):m}}),["push","pop","shift","unshift","splice"].forEach(a=>{t[a]=function(...l){yc();const d=Hn(this)[a].apply(this,l);return xc(),d}}),t}function iy(t=!1,a=!1){return function(d,m,v){if(m==="__v_isReactive")return!t;if(m==="__v_isReadonly")return t;if(m==="__v_isShallow")return a;if(m==="__v_raw"&&v===(t?a?cA:Mw:a?kw:Aw).get(d))return d;const b=xn(d);if(!t&&b&&Wn(P1,m))return Reflect.get(P1,m,v);const o=Reflect.get(d,m,v);return(Qv(m)?Ew.has(m):jI(m))||(t||co(d,"get",m),a)?o:Bi(o)?b&&ey(m)?o:o.value:Ri(o)?t?vf(o):pi(o):o}}const HI=Cw(),XI=Cw(!0);function Cw(t=!1){return function(l,d,m,v){let b=l[d];if(Wu(b)&&Bi(b)&&!Bi(m))return!1;if(!t&&(!Im(m)&&!Wu(m)&&(b=Hn(b),m=Hn(m)),!xn(l)&&Bi(b)&&!Bi(m)))return b.value=m,!0;const o=xn(l)&&ey(d)?Number(d)<l.length:Wn(l,d),w=Reflect.set(l,d,m,v);return l===Hn(v)&&(o?Qh(m,b)&&sa(l,"set",d,m):sa(l,"add",d,m)),w}}function YI(t,a){const l=Wn(t,a);t[a];const d=Reflect.deleteProperty(t,a);return d&&l&&sa(t,"delete",a,void 0),d}function KI(t,a){const l=Reflect.has(t,a);return(!Qv(a)||!Ew.has(a))&&co(t,"has",a),l}function JI(t){return co(t,"iterate",xn(t)?"length":fc),Reflect.ownKeys(t)}const Iw={get:GI,set:HI,deleteProperty:YI,has:KI,ownKeys:JI},QI={get:ZI,set(t,a){return!0},deleteProperty(t,a){return!0}},eA=Er({},Iw,{get:qI,set:XI}),ry=t=>t,Zm=t=>Reflect.getPrototypeOf(t);function am(t,a,l=!1,d=!1){t=t.__v_raw;const m=Hn(t),v=Hn(a);l||(a!==v&&co(m,"get",a),co(m,"get",v));const{has:b}=Zm(m),o=d?ry:l?ay:ef;if(b.call(m,a))return o(t.get(a));if(b.call(m,v))return o(t.get(v));t!==m&&t.get(a)}function lm(t,a=!1){const l=this.__v_raw,d=Hn(l),m=Hn(t);return a||(t!==m&&co(d,"has",t),co(d,"has",m)),t===m?l.has(t):l.has(t)||l.has(m)}function cm(t,a=!1){return t=t.__v_raw,!a&&co(Hn(t),"iterate",fc),Reflect.get(t,"size",t)}function z1(t){t=Hn(t);const a=Hn(this);return Zm(a).has.call(a,t)||(a.add(t),sa(a,"add",t,t)),this}function L1(t,a){a=Hn(a);const l=Hn(this),{has:d,get:m}=Zm(l);let v=d.call(l,t);v||(t=Hn(t),v=d.call(l,t));const b=m.call(l,t);return l.set(t,a),v?Qh(a,b)&&sa(l,"set",t,a):sa(l,"add",t,a),this}function D1(t){const a=Hn(this),{has:l,get:d}=Zm(a);let m=l.call(a,t);m||(t=Hn(t),m=l.call(a,t)),d&&d.call(a,t);const v=a.delete(t);return m&&sa(a,"delete",t,void 0),v}function B1(){const t=Hn(this),a=t.size!==0,l=t.clear();return a&&sa(t,"clear",void 0,void 0),l}function um(t,a){return function(d,m){const v=this,b=v.__v_raw,o=Hn(b),w=a?ry:t?ay:ef;return!t&&co(o,"iterate",fc),b.forEach((C,M)=>d.call(m,w(C),w(M),v))}}function dm(t,a,l){return function(...d){const m=this.__v_raw,v=Hn(m),b=ju(v),o=t==="entries"||t===Symbol.iterator&&b,w=t==="keys"&&b,C=m[t](...d),M=l?ry:a?ay:ef;return!a&&co(v,"iterate",w?uv:fc),{next(){const{value:L,done:D}=C.next();return D?{value:L,done:D}:{value:o?[M(L[0]),M(L[1])]:M(L),done:D}},[Symbol.iterator](){return this}}}}function Ya(t){return function(...a){return t==="delete"?!1:this}}function tA(){const t={get(v){return am(this,v)},get size(){return cm(this)},has:lm,add:z1,set:L1,delete:D1,clear:B1,forEach:um(!1,!1)},a={get(v){return am(this,v,!1,!0)},get size(){return cm(this)},has:lm,add:z1,set:L1,delete:D1,clear:B1,forEach:um(!1,!0)},l={get(v){return am(this,v,!0)},get size(){return cm(this,!0)},has(v){return lm.call(this,v,!0)},add:Ya("add"),set:Ya("set"),delete:Ya("delete"),clear:Ya("clear"),forEach:um(!0,!1)},d={get(v){return am(this,v,!0,!0)},get size(){return cm(this,!0)},has(v){return lm.call(this,v,!0)},add:Ya("add"),set:Ya("set"),delete:Ya("delete"),clear:Ya("clear"),forEach:um(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(v=>{t[v]=dm(v,!1,!1),l[v]=dm(v,!0,!1),a[v]=dm(v,!1,!0),d[v]=dm(v,!0,!0)}),[t,l,a,d]}const[nA,iA,rA,oA]=tA();function oy(t,a){const l=a?t?oA:rA:t?iA:nA;return(d,m,v)=>m==="__v_isReactive"?!t:m==="__v_isReadonly"?t:m==="__v_raw"?d:Reflect.get(Wn(l,m)&&m in d?l:d,m,v)}const sA={get:oy(!1,!1)},aA={get:oy(!1,!0)},lA={get:oy(!0,!1)},Aw=new WeakMap,kw=new WeakMap,Mw=new WeakMap,cA=new WeakMap;function uA(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function dA(t){return t.__v_skip||!Object.isExtensible(t)?0:uA(RI(t))}function pi(t){return Wu(t)?t:sy(t,!1,Iw,sA,Aw)}function Pw(t){return sy(t,!1,eA,aA,kw)}function vf(t){return sy(t,!0,QI,lA,Mw)}function sy(t,a,l,d,m){if(!Ri(t)||t.__v_raw&&!(a&&t.__v_isReactive))return t;const v=m.get(t);if(v)return v;const b=dA(t);if(b===0)return t;const o=new Proxy(t,b===2?d:l);return m.set(t,o),o}function Gu(t){return Wu(t)?Gu(t.__v_raw):!!(t&&t.__v_isReactive)}function Wu(t){return!!(t&&t.__v_isReadonly)}function Im(t){return!!(t&&t.__v_isShallow)}function zw(t){return Gu(t)||Wu(t)}function Hn(t){const a=t&&t.__v_raw;return a?Hn(a):t}function Lw(t){return Em(t,"__v_skip",!0),t}const ef=t=>Ri(t)?pi(t):t,ay=t=>Ri(t)?vf(t):t;function Dw(t){nl&&Xo&&(t=Hn(t),Sw(t.dep||(t.dep=ty())))}function Bw(t,a){t=Hn(t),t.dep&&dv(t.dep)}function Bi(t){return!!(t&&t.__v_isRef===!0)}function Je(t){return Rw(t,!1)}function Si(t){return Rw(t,!0)}function Rw(t,a){return Bi(t)?t:new hA(t,a)}class hA{constructor(a,l){this.__v_isShallow=l,this.dep=void 0,this.__v_isRef=!0,this._rawValue=l?a:Hn(a),this._value=l?a:ef(a)}get value(){return Dw(this),this._value}set value(a){const l=this.__v_isShallow||Im(a)||Wu(a);a=l?a:Hn(a),Qh(a,this._rawValue)&&(this._rawValue=a,this._value=l?a:ef(a),Bw(this))}}function Ui(t){return Bi(t)?t.value:t}const fA={get:(t,a,l)=>Ui(Reflect.get(t,a,l)),set:(t,a,l,d)=>{const m=t[a];return Bi(m)&&!Bi(l)?(m.value=l,!0):Reflect.set(t,a,l,d)}};function Ow(t){return Gu(t)?t:new Proxy(t,fA)}function ly(t){const a=xn(t)?new Array(t.length):{};for(const l in t)a[l]=Tt(t,l);return a}class pA{constructor(a,l,d){this._object=a,this._key=l,this._defaultValue=d,this.__v_isRef=!0}get value(){const a=this._object[this._key];return a===void 0?this._defaultValue:a}set value(a){this._object[this._key]=a}}function Tt(t,a,l){const d=t[a];return Bi(d)?d:new pA(t,a,l)}var Fw;class mA{constructor(a,l,d,m){this._setter=l,this.dep=void 0,this.__v_isRef=!0,this[Fw]=!1,this._dirty=!0,this.effect=new ny(a,()=>{this._dirty||(this._dirty=!0,Bw(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!m,this.__v_isReadonly=d}get value(){const a=Hn(this);return Dw(a),(a._dirty||!a._cacheable)&&(a._dirty=!1,a._value=a.effect.run()),a._value}set value(a){this._setter(a)}}Fw="__v_isReadonly";function gA(t,a,l=!1){let d,m;const v=Ln(t);return v?(d=t,m=Jo):(d=t.get,m=t.set),new mA(d,m,v||!m,l)}const Gh=[];function _A(t,...a){yc();const l=Gh.length?Gh[Gh.length-1].component:null,d=l&&l.appContext.config.warnHandler,m=vA();if(d)oa(d,l,11,[t+a.join(""),l&&l.proxy,m.map(({vnode:v})=>`at <${mT(l,v.type)}>`).join(`
`),m]);else{const v=[`[Vue warn]: ${t}`,...a];m.length&&v.push(`
`,...yA(m)),console.warn(...v)}xc()}function vA(){let t=Gh[Gh.length-1];if(!t)return[];const a=[];for(;t;){const l=a[0];l&&l.vnode===t?l.recurseCount++:a.push({vnode:t,recurseCount:0});const d=t.component&&t.component.parent;t=d&&d.vnode}return a}function yA(t){const a=[];return t.forEach((l,d)=>{a.push(...d===0?[]:[`
`],...xA(l))}),a}function xA({vnode:t,recurseCount:a}){const l=a>0?`... (${a} recursive calls)`:"",d=t.component?t.component.parent==null:!1,m=` at <${mT(t.component,t.type,d)}`,v=">"+l;return t.props?[m,...bA(t.props),v]:[m+v]}function bA(t){const a=[],l=Object.keys(t);return l.slice(0,3).forEach(d=>{a.push(...Vw(d,t[d]))}),l.length>3&&a.push(" ..."),a}function Vw(t,a,l){return ir(a)?(a=JSON.stringify(a),l?a:[`${t}=${a}`]):typeof a=="number"||typeof a=="boolean"||a==null?l?a:[`${t}=${a}`]:Bi(a)?(a=Vw(t,Hn(a.value),!0),l?a:[`${t}=Ref<`,a,">"]):Ln(a)?[`${t}=fn${a.name?`<${a.name}>`:""}`]:(a=Hn(a),l?a:[`${t}=`,a])}function oa(t,a,l,d){let m;try{m=d?t(...d):t()}catch(v){Wm(v,a,l)}return m}function Io(t,a,l,d){if(Ln(t)){const v=oa(t,a,l,d);return v&&_w(v)&&v.catch(b=>{Wm(b,a,l)}),v}const m=[];for(let v=0;v<t.length;v++)m.push(Io(t[v],a,l,d));return m}function Wm(t,a,l,d=!0){const m=a?a.vnode:null;if(a){let v=a.parent;const b=a.proxy,o=l;for(;v;){const C=v.ec;if(C){for(let M=0;M<C.length;M++)if(C[M](t,b,o)===!1)return}v=v.parent}const w=a.appContext.config.errorHandler;if(w){oa(w,null,10,[t,b,o]);return}}wA(t,l,m,d)}function wA(t,a,l,d=!0){console.error(t)}let tf=!1,hv=!1;const $r=[];let Cs=0;const qu=[];let ra=null,oc=0;const $w=Promise.resolve();let cy=null;function Gi(t){const a=cy||$w;return t?a.then(this?t.bind(this):t):a}function TA(t){let a=Cs+1,l=$r.length;for(;a<l;){const d=a+l>>>1;nf($r[d])<t?a=d+1:l=d}return a}function uy(t){(!$r.length||!$r.includes(t,tf&&t.allowRecurse?Cs+1:Cs))&&(t.id==null?$r.push(t):$r.splice(TA(t.id),0,t),Nw())}function Nw(){!tf&&!hv&&(hv=!0,cy=$w.then(jw))}function SA(t){const a=$r.indexOf(t);a>Cs&&$r.splice(a,1)}function EA(t){xn(t)?qu.push(...t):(!ra||!ra.includes(t,t.allowRecurse?oc+1:oc))&&qu.push(t),Nw()}function R1(t,a=tf?Cs+1:0){for(;a<$r.length;a++){const l=$r[a];l&&l.pre&&($r.splice(a,1),a--,l())}}function Uw(t){if(qu.length){const a=[...new Set(qu)];if(qu.length=0,ra){ra.push(...a);return}for(ra=a,ra.sort((l,d)=>nf(l)-nf(d)),oc=0;oc<ra.length;oc++)ra[oc]();ra=null,oc=0}}const nf=t=>t.id==null?1/0:t.id,CA=(t,a)=>{const l=nf(t)-nf(a);if(l===0){if(t.pre&&!a.pre)return-1;if(a.pre&&!t.pre)return 1}return l};function jw(t){hv=!1,tf=!0,$r.sort(CA);const a=Jo;try{for(Cs=0;Cs<$r.length;Cs++){const l=$r[Cs];l&&l.active!==!1&&oa(l,null,14)}}finally{Cs=0,$r.length=0,Uw(),tf=!1,cy=null,($r.length||qu.length)&&jw()}}function IA(t,a,...l){if(t.isUnmounted)return;const d=t.vnode.props||bi;let m=l;const v=a.startsWith("update:"),b=v&&a.slice(7);if(b&&b in d){const M=`${b==="modelValue"?"model":b}Modifiers`,{number:L,trim:D}=d[M]||bi;D&&(m=l.map(V=>V.trim())),L&&(m=l.map(Cm))}let o,w=d[o=xm(a)]||d[o=xm(Mo(a))];!w&&v&&(w=d[o=xm(Ju(a))]),w&&Io(w,t,6,m);const C=d[o+"Once"];if(C){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,Io(C,t,6,m)}}function Gw(t,a,l=!1){const d=a.emitsCache,m=d.get(t);if(m!==void 0)return m;const v=t.emits;let b={},o=!1;if(!Ln(t)){const w=C=>{const M=Gw(C,a,!0);M&&(o=!0,Er(b,M))};!l&&a.mixins.length&&a.mixins.forEach(w),t.extends&&w(t.extends),t.mixins&&t.mixins.forEach(w)}return!v&&!o?(Ri(t)&&d.set(t,null),null):(xn(v)?v.forEach(w=>b[w]=null):Er(b,v),Ri(t)&&d.set(t,b),b)}function Hm(t,a){return!t||!jm(a)?!1:(a=a.slice(2).replace(/Once$/,""),Wn(t,a[0].toLowerCase()+a.slice(1))||Wn(t,Ju(a))||Wn(t,a))}let Nr=null,qw=null;function Am(t){const a=Nr;return Nr=t,qw=t&&t.type.__scopeId||null,a}function ii(t,a=Nr,l){if(!a||t._n)return t;const d=(...m)=>{d._d&&H1(-1);const v=Am(a);let b;try{b=t(...m)}finally{Am(v),d._d&&H1(1)}return b};return d._n=!0,d._c=!0,d._d=!0,d}function O_(t){const{type:a,vnode:l,proxy:d,withProxy:m,props:v,propsOptions:[b],slots:o,attrs:w,emit:C,render:M,renderCache:L,data:D,setupState:V,ctx:q,inheritAttrs:X}=t;let xe,ce;const me=Am(t);try{if(l.shapeFlag&4){const Ie=m||d;xe=Es(M.call(Ie,Ie,L,v,V,D,q)),ce=w}else{const Ie=a;xe=Es(Ie.length>1?Ie(v,{attrs:w,slots:o,emit:C}):Ie(v,null)),ce=a.props?w:AA(w)}}catch(Ie){Wh.length=0,Wm(Ie,t,1),xe=O(Ao)}let ee=xe;if(ce&&X!==!1){const Ie=Object.keys(ce),{shapeFlag:Y}=ee;Ie.length&&Y&7&&(b&&Ie.some(Kv)&&(ce=kA(ce,b)),ee=aa(ee,ce))}return l.dirs&&(ee=aa(ee),ee.dirs=ee.dirs?ee.dirs.concat(l.dirs):l.dirs),l.transition&&(ee.transition=l.transition),xe=ee,Am(me),xe}const AA=t=>{let a;for(const l in t)(l==="class"||l==="style"||jm(l))&&((a||(a={}))[l]=t[l]);return a},kA=(t,a)=>{const l={};for(const d in t)(!Kv(d)||!(d.slice(9)in a))&&(l[d]=t[d]);return l};function MA(t,a,l){const{props:d,children:m,component:v}=t,{props:b,children:o,patchFlag:w}=a,C=v.emitsOptions;if(a.dirs||a.transition)return!0;if(l&&w>=0){if(w&1024)return!0;if(w&16)return d?O1(d,b,C):!!b;if(w&8){const M=a.dynamicProps;for(let L=0;L<M.length;L++){const D=M[L];if(b[D]!==d[D]&&!Hm(C,D))return!0}}}else return(m||o)&&(!o||!o.$stable)?!0:d===b?!1:d?b?O1(d,b,C):!0:!!b;return!1}function O1(t,a,l){const d=Object.keys(a);if(d.length!==Object.keys(t).length)return!0;for(let m=0;m<d.length;m++){const v=d[m];if(a[v]!==t[v]&&!Hm(l,v))return!0}return!1}function PA({vnode:t,parent:a},l){for(;a&&a.subTree===t;)(t=a.vnode).el=l,a=a.parent}const zA=t=>t.__isSuspense;function LA(t,a){a&&a.pendingBranch?xn(t)?a.effects.push(...t):a.effects.push(t):EA(t)}function ji(t,a){if(Sr){let l=Sr.provides;const d=Sr.parent&&Sr.parent.provides;d===l&&(l=Sr.provides=Object.create(d)),l[t]=a}}function ln(t,a,l=!1){const d=Sr||Nr;if(d){const m=d.parent==null?d.vnode.appContext&&d.vnode.appContext.provides:d.parent.provides;if(m&&t in m)return m[t];if(arguments.length>1)return l&&Ln(a)?a.call(d.proxy):a}}function Ms(t,a){return dy(t,null,a)}const F1={};function Ye(t,a,l){return dy(t,a,l)}function dy(t,a,{immediate:l,deep:d,flush:m,onTrack:v,onTrigger:b}=bi){const o=Sr;let w,C=!1,M=!1;if(Bi(t)?(w=()=>t.value,C=Im(t)):Gu(t)?(w=()=>t,d=!0):xn(t)?(M=!0,C=t.some(ce=>Gu(ce)||Im(ce)),w=()=>t.map(ce=>{if(Bi(ce))return ce.value;if(Gu(ce))return lc(ce);if(Ln(ce))return oa(ce,o,2)})):Ln(t)?a?w=()=>oa(t,o,2):w=()=>{if(!(o&&o.isUnmounted))return L&&L(),Io(t,o,3,[D])}:w=Jo,a&&d){const ce=w;w=()=>lc(ce())}let L,D=ce=>{L=xe.onStop=()=>{oa(ce,o,4)}};if(af)return D=Jo,a?l&&Io(a,o,3,[w(),M?[]:void 0,D]):w(),Jo;let V=M?[]:F1;const q=()=>{if(!!xe.active)if(a){const ce=xe.run();(d||C||(M?ce.some((me,ee)=>Qh(me,V[ee])):Qh(ce,V)))&&(L&&L(),Io(a,o,3,[ce,V===F1?void 0:V,D]),V=ce)}else xe.run()};q.allowRecurse=!!a;let X;m==="sync"?X=q:m==="post"?X=()=>to(q,o&&o.suspense):(q.pre=!0,o&&(q.id=o.uid),X=()=>uy(q));const xe=new ny(w,X);return a?l?q():V=xe.run():m==="post"?to(xe.run.bind(xe),o&&o.suspense):xe.run(),()=>{xe.stop(),o&&o.scope&&Jv(o.scope.effects,xe)}}function DA(t,a,l){const d=this.proxy,m=ir(t)?t.includes(".")?Zw(d,t):()=>d[t]:t.bind(d,d);let v;Ln(a)?v=a:(v=a.handler,l=a);const b=Sr;Hu(this);const o=dy(m,v.bind(d),l);return b?Hu(b):pc(),o}function Zw(t,a){const l=a.split(".");return()=>{let d=t;for(let m=0;m<l.length&&d;m++)d=d[l[m]];return d}}function lc(t,a){if(!Ri(t)||t.__v_skip||(a=a||new Set,a.has(t)))return t;if(a.add(t),Bi(t))lc(t.value,a);else if(xn(t))for(let l=0;l<t.length;l++)lc(t[l],a);else if(gw(t)||ju(t))t.forEach(l=>{lc(l,a)});else if(yw(t))for(const l in t)lc(t[l],a);return t}function Ww(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return On(()=>{t.isMounted=!0}),Ei(()=>{t.isUnmounting=!0}),t}const So=[Function,Array],BA={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:So,onEnter:So,onAfterEnter:So,onEnterCancelled:So,onBeforeLeave:So,onLeave:So,onAfterLeave:So,onLeaveCancelled:So,onBeforeAppear:So,onAppear:So,onAfterAppear:So,onAppearCancelled:So},setup(t,{slots:a}){const l=Qm(),d=Ww();let m;return()=>{const v=a.default&&hy(a.default(),!0);if(!v||!v.length)return;let b=v[0];if(v.length>1){for(const X of v)if(X.type!==Ao){b=X;break}}const o=Hn(t),{mode:w}=o;if(d.isLeaving)return F_(b);const C=V1(b);if(!C)return F_(b);const M=rf(C,o,d,l);of(C,M);const L=l.subTree,D=L&&V1(L);let V=!1;const{getTransitionKey:q}=C.type;if(q){const X=q();m===void 0?m=X:X!==m&&(m=X,V=!0)}if(D&&D.type!==Ao&&(!sc(C,D)||V)){const X=rf(D,o,d,l);if(of(D,X),w==="out-in")return d.isLeaving=!0,X.afterLeave=()=>{d.isLeaving=!1,l.update()},F_(b);w==="in-out"&&C.type!==Ao&&(X.delayLeave=(xe,ce,me)=>{const ee=Xw(d,D);ee[String(D.key)]=D,xe._leaveCb=()=>{ce(),xe._leaveCb=void 0,delete M.delayedLeave},M.delayedLeave=me})}return b}}},Hw=BA;function Xw(t,a){const{leavingVNodes:l}=t;let d=l.get(a.type);return d||(d=Object.create(null),l.set(a.type,d)),d}function rf(t,a,l,d){const{appear:m,mode:v,persisted:b=!1,onBeforeEnter:o,onEnter:w,onAfterEnter:C,onEnterCancelled:M,onBeforeLeave:L,onLeave:D,onAfterLeave:V,onLeaveCancelled:q,onBeforeAppear:X,onAppear:xe,onAfterAppear:ce,onAppearCancelled:me}=a,ee=String(t.key),Ie=Xw(l,t),Y=(ge,Ee)=>{ge&&Io(ge,d,9,Ee)},ve=(ge,Ee)=>{const we=Ee[1];Y(ge,Ee),xn(ge)?ge.every(Oe=>Oe.length<=1)&&we():ge.length<=1&&we()},fe={mode:v,persisted:b,beforeEnter(ge){let Ee=o;if(!l.isMounted)if(m)Ee=X||o;else return;ge._leaveCb&&ge._leaveCb(!0);const we=Ie[ee];we&&sc(t,we)&&we.el._leaveCb&&we.el._leaveCb(),Y(Ee,[ge])},enter(ge){let Ee=w,we=C,Oe=M;if(!l.isMounted)if(m)Ee=xe||w,we=ce||C,Oe=me||M;else return;let ze=!1;const Qe=ge._enterCb=ht=>{ze||(ze=!0,ht?Y(Oe,[ge]):Y(we,[ge]),fe.delayedLeave&&fe.delayedLeave(),ge._enterCb=void 0)};Ee?ve(Ee,[ge,Qe]):Qe()},leave(ge,Ee){const we=String(t.key);if(ge._enterCb&&ge._enterCb(!0),l.isUnmounting)return Ee();Y(L,[ge]);let Oe=!1;const ze=ge._leaveCb=Qe=>{Oe||(Oe=!0,Ee(),Qe?Y(q,[ge]):Y(V,[ge]),ge._leaveCb=void 0,Ie[we]===t&&delete Ie[we])};Ie[we]=t,D?ve(D,[ge,ze]):ze()},clone(ge){return rf(ge,a,l,d)}};return fe}function F_(t){if(Xm(t))return t=aa(t),t.children=null,t}function V1(t){return Xm(t)?t.children?t.children[0]:void 0:t}function of(t,a){t.shapeFlag&6&&t.component?of(t.component.subTree,a):t.shapeFlag&128?(t.ssContent.transition=a.clone(t.ssContent),t.ssFallback.transition=a.clone(t.ssFallback)):t.transition=a}function hy(t,a=!1,l){let d=[],m=0;for(let v=0;v<t.length;v++){let b=t[v];const o=l==null?b.key:String(l)+String(b.key!=null?b.key:v);b.type===Rn?(b.patchFlag&128&&m++,d=d.concat(hy(b.children,a,o))):(a||b.type!==Ao)&&d.push(o!=null?aa(b,{key:o}):b)}if(m>1)for(let v=0;v<d.length;v++)d[v].patchFlag=-2;return d}function vn(t){return Ln(t)?{setup:t,name:t.name}:t}const qh=t=>!!t.type.__asyncLoader,Xm=t=>t.type.__isKeepAlive;function Yw(t,a){Jw(t,"a",a)}function Kw(t,a){Jw(t,"da",a)}function Jw(t,a,l=Sr){const d=t.__wdc||(t.__wdc=()=>{let m=l;for(;m;){if(m.isDeactivated)return;m=m.parent}return t()});if(Ym(a,d,l),l){let m=l.parent;for(;m&&m.parent;)Xm(m.parent.vnode)&&RA(d,a,l,m),m=m.parent}}function RA(t,a,l,d){const m=Ym(a,t,d,!0);mr(()=>{Jv(d[a],m)},l)}function Ym(t,a,l=Sr,d=!1){if(l){const m=l[t]||(l[t]=[]),v=a.__weh||(a.__weh=(...b)=>{if(l.isUnmounted)return;yc(),Hu(l);const o=Io(a,l,t,b);return pc(),xc(),o});return d?m.unshift(v):m.push(v),v}}const ca=t=>(a,l=Sr)=>(!af||t==="sp")&&Ym(t,(...d)=>a(...d),l),Km=ca("bm"),On=ca("m"),Qw=ca("bu"),eT=ca("u"),Ei=ca("bum"),mr=ca("um"),OA=ca("sp"),FA=ca("rtg"),VA=ca("rtc");function $A(t,a=Sr){Ym("ec",t,a)}function qi(t,a){const l=Nr;if(l===null)return t;const d=eg(l)||l.proxy,m=t.dirs||(t.dirs=[]);for(let v=0;v<a.length;v++){let[b,o,w,C=bi]=a[v];Ln(b)&&(b={mounted:b,updated:b}),b.deep&&lc(o),m.push({dir:b,instance:d,value:o,oldValue:void 0,arg:w,modifiers:C})}return t}function Ql(t,a,l,d){const m=t.dirs,v=a&&a.dirs;for(let b=0;b<m.length;b++){const o=m[b];v&&(o.oldValue=v[b].value);let w=o.dir[d];w&&(yc(),Io(w,l,8,[t.el,o,t,a]),xc())}}const fy="components",NA="directives";function fr(t,a){return py(fy,t,!0,a)||t}const tT=Symbol();function UA(t){return ir(t)?py(fy,t,!1)||t:t||tT}function uo(t){return py(NA,t)}function py(t,a,l=!0,d=!1){const m=Nr||Sr;if(m){const v=m.type;if(t===fy){const o=pT(v,!1);if(o&&(o===a||o===Mo(a)||o===ol(Mo(a))))return v}const b=$1(m[t]||v[t],a)||$1(m.appContext[t],a);return!b&&d?v:b}}function $1(t,a){return t&&(t[a]||t[Mo(a)]||t[ol(Mo(a))])}function my(t,a,l={},d,m){if(Nr.isCE||Nr.parent&&qh(Nr.parent)&&Nr.parent.isCE)return O("slot",a==="default"?null:{name:a},d&&d());let v=t[a];v&&v._c&&(v._d=!1),Zi();const b=v&&nT(v(l)),o=Ps(Rn,{key:l.key||b&&b.key||`_${a}`},b||(d?d():[]),b&&t._===1?64:-2);return!m&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),v&&v._c&&(v._d=!0),o}function nT(t){return t.some(a=>Pm(a)?!(a.type===Ao||a.type===Rn&&!nT(a.children)):!0)?t:null}function V_(t,a){const l={};for(const d in t)l[a&&/[A-Z]/.test(d)?`on:${d}`:xm(d)]=t[d];return l}const fv=t=>t?hT(t)?eg(t)||t.proxy:fv(t.parent):null,km=Er(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>fv(t.parent),$root:t=>fv(t.root),$emit:t=>t.emit,$options:t=>gy(t),$forceUpdate:t=>t.f||(t.f=()=>uy(t.update)),$nextTick:t=>t.n||(t.n=Gi.bind(t.proxy)),$watch:t=>DA.bind(t)}),jA={get({_:t},a){const{ctx:l,setupState:d,data:m,props:v,accessCache:b,type:o,appContext:w}=t;let C;if(a[0]!=="$"){const V=b[a];if(V!==void 0)switch(V){case 1:return d[a];case 2:return m[a];case 4:return l[a];case 3:return v[a]}else{if(d!==bi&&Wn(d,a))return b[a]=1,d[a];if(m!==bi&&Wn(m,a))return b[a]=2,m[a];if((C=t.propsOptions[0])&&Wn(C,a))return b[a]=3,v[a];if(l!==bi&&Wn(l,a))return b[a]=4,l[a];pv&&(b[a]=0)}}const M=km[a];let L,D;if(M)return a==="$attrs"&&co(t,"get",a),M(t);if((L=o.__cssModules)&&(L=L[a]))return L;if(l!==bi&&Wn(l,a))return b[a]=4,l[a];if(D=w.config.globalProperties,Wn(D,a))return D[a]},set({_:t},a,l){const{data:d,setupState:m,ctx:v}=t;return m!==bi&&Wn(m,a)?(m[a]=l,!0):d!==bi&&Wn(d,a)?(d[a]=l,!0):Wn(t.props,a)||a[0]==="$"&&a.slice(1)in t?!1:(v[a]=l,!0)},has({_:{data:t,setupState:a,accessCache:l,ctx:d,appContext:m,propsOptions:v}},b){let o;return!!l[b]||t!==bi&&Wn(t,b)||a!==bi&&Wn(a,b)||(o=v[0])&&Wn(o,b)||Wn(d,b)||Wn(km,b)||Wn(m.config.globalProperties,b)},defineProperty(t,a,l){return l.get!=null?t._.accessCache[a]=0:Wn(l,"value")&&this.set(t,a,l.value,null),Reflect.defineProperty(t,a,l)}};let pv=!0;function GA(t){const a=gy(t),l=t.proxy,d=t.ctx;pv=!1,a.beforeCreate&&N1(a.beforeCreate,t,"bc");const{data:m,computed:v,methods:b,watch:o,provide:w,inject:C,created:M,beforeMount:L,mounted:D,beforeUpdate:V,updated:q,activated:X,deactivated:xe,beforeDestroy:ce,beforeUnmount:me,destroyed:ee,unmounted:Ie,render:Y,renderTracked:ve,renderTriggered:fe,errorCaptured:ge,serverPrefetch:Ee,expose:we,inheritAttrs:Oe,components:ze,directives:Qe,filters:ht}=a;if(C&&qA(C,d,null,t.appContext.config.unwrapInjectedRef),b)for(const Pe in b){const at=b[Pe];Ln(at)&&(d[Pe]=at.bind(l))}if(m){const Pe=m.call(l,l);Ri(Pe)&&(t.data=pi(Pe))}if(pv=!0,v)for(const Pe in v){const at=v[Pe],jt=Ln(at)?at.bind(l,l):Ln(at.get)?at.get.bind(l,l):Jo,pt=!Ln(at)&&Ln(at.set)?at.set.bind(l):Jo,zt=ne({get:jt,set:pt});Object.defineProperty(d,Pe,{enumerable:!0,configurable:!0,get:()=>zt.value,set:Gt=>zt.value=Gt})}if(o)for(const Pe in o)iT(o[Pe],d,l,Pe);if(w){const Pe=Ln(w)?w.call(l):w;Reflect.ownKeys(Pe).forEach(at=>{ji(at,Pe[at])})}M&&N1(M,t,"c");function ft(Pe,at){xn(at)?at.forEach(jt=>Pe(jt.bind(l))):at&&Pe(at.bind(l))}if(ft(Km,L),ft(On,D),ft(Qw,V),ft(eT,q),ft(Yw,X),ft(Kw,xe),ft($A,ge),ft(VA,ve),ft(FA,fe),ft(Ei,me),ft(mr,Ie),ft(OA,Ee),xn(we))if(we.length){const Pe=t.exposed||(t.exposed={});we.forEach(at=>{Object.defineProperty(Pe,at,{get:()=>l[at],set:jt=>l[at]=jt})})}else t.exposed||(t.exposed={});Y&&t.render===Jo&&(t.render=Y),Oe!=null&&(t.inheritAttrs=Oe),ze&&(t.components=ze),Qe&&(t.directives=Qe)}function qA(t,a,l=Jo,d=!1){xn(t)&&(t=mv(t));for(const m in t){const v=t[m];let b;Ri(v)?"default"in v?b=ln(v.from||m,v.default,!0):b=ln(v.from||m):b=ln(v),Bi(b)&&d?Object.defineProperty(a,m,{enumerable:!0,configurable:!0,get:()=>b.value,set:o=>b.value=o}):a[m]=b}}function N1(t,a,l){Io(xn(t)?t.map(d=>d.bind(a.proxy)):t.bind(a.proxy),a,l)}function iT(t,a,l,d){const m=d.includes(".")?Zw(l,d):()=>l[d];if(ir(t)){const v=a[t];Ln(v)&&Ye(m,v)}else if(Ln(t))Ye(m,t.bind(l));else if(Ri(t))if(xn(t))t.forEach(v=>iT(v,a,l,d));else{const v=Ln(t.handler)?t.handler.bind(l):a[t.handler];Ln(v)&&Ye(m,v,t)}}function gy(t){const a=t.type,{mixins:l,extends:d}=a,{mixins:m,optionsCache:v,config:{optionMergeStrategies:b}}=t.appContext,o=v.get(a);let w;return o?w=o:!m.length&&!l&&!d?w=a:(w={},m.length&&m.forEach(C=>Mm(w,C,b,!0)),Mm(w,a,b)),Ri(a)&&v.set(a,w),w}function Mm(t,a,l,d=!1){const{mixins:m,extends:v}=a;v&&Mm(t,v,l,!0),m&&m.forEach(b=>Mm(t,b,l,!0));for(const b in a)if(!(d&&b==="expose")){const o=ZA[b]||l&&l[b];t[b]=o?o(t[b],a[b]):a[b]}return t}const ZA={data:U1,props:rc,emits:rc,methods:rc,computed:rc,beforeCreate:Zr,created:Zr,beforeMount:Zr,mounted:Zr,beforeUpdate:Zr,updated:Zr,beforeDestroy:Zr,beforeUnmount:Zr,destroyed:Zr,unmounted:Zr,activated:Zr,deactivated:Zr,errorCaptured:Zr,serverPrefetch:Zr,components:rc,directives:rc,watch:HA,provide:U1,inject:WA};function U1(t,a){return a?t?function(){return Er(Ln(t)?t.call(this,this):t,Ln(a)?a.call(this,this):a)}:a:t}function WA(t,a){return rc(mv(t),mv(a))}function mv(t){if(xn(t)){const a={};for(let l=0;l<t.length;l++)a[t[l]]=t[l];return a}return t}function Zr(t,a){return t?[...new Set([].concat(t,a))]:a}function rc(t,a){return t?Er(Er(Object.create(null),t),a):a}function HA(t,a){if(!t)return a;if(!a)return t;const l=Er(Object.create(null),t);for(const d in a)l[d]=Zr(t[d],a[d]);return l}function XA(t,a,l,d=!1){const m={},v={};Em(v,Jm,1),t.propsDefaults=Object.create(null),rT(t,a,m,v);for(const b in t.propsOptions[0])b in m||(m[b]=void 0);l?t.props=d?m:Pw(m):t.type.props?t.props=m:t.props=v,t.attrs=v}function YA(t,a,l,d){const{props:m,attrs:v,vnode:{patchFlag:b}}=t,o=Hn(m),[w]=t.propsOptions;let C=!1;if((d||b>0)&&!(b&16)){if(b&8){const M=t.vnode.dynamicProps;for(let L=0;L<M.length;L++){let D=M[L];if(Hm(t.emitsOptions,D))continue;const V=a[D];if(w)if(Wn(v,D))V!==v[D]&&(v[D]=V,C=!0);else{const q=Mo(D);m[q]=gv(w,o,q,V,t,!1)}else V!==v[D]&&(v[D]=V,C=!0)}}}else{rT(t,a,m,v)&&(C=!0);let M;for(const L in o)(!a||!Wn(a,L)&&((M=Ju(L))===L||!Wn(a,M)))&&(w?l&&(l[L]!==void 0||l[M]!==void 0)&&(m[L]=gv(w,o,L,void 0,t,!0)):delete m[L]);if(v!==o)for(const L in v)(!a||!Wn(a,L)&&!0)&&(delete v[L],C=!0)}C&&sa(t,"set","$attrs")}function rT(t,a,l,d){const[m,v]=t.propsOptions;let b=!1,o;if(a)for(let w in a){if(ym(w))continue;const C=a[w];let M;m&&Wn(m,M=Mo(w))?!v||!v.includes(M)?l[M]=C:(o||(o={}))[M]=C:Hm(t.emitsOptions,w)||(!(w in d)||C!==d[w])&&(d[w]=C,b=!0)}if(v){const w=Hn(l),C=o||bi;for(let M=0;M<v.length;M++){const L=v[M];l[L]=gv(m,w,L,C[L],t,!Wn(C,L))}}return b}function gv(t,a,l,d,m,v){const b=t[l];if(b!=null){const o=Wn(b,"default");if(o&&d===void 0){const w=b.default;if(b.type!==Function&&Ln(w)){const{propsDefaults:C}=m;l in C?d=C[l]:(Hu(m),d=C[l]=w.call(null,a),pc())}else d=w}b[0]&&(v&&!o?d=!1:b[1]&&(d===""||d===Ju(l))&&(d=!0))}return d}function oT(t,a,l=!1){const d=a.propsCache,m=d.get(t);if(m)return m;const v=t.props,b={},o=[];let w=!1;if(!Ln(t)){const M=L=>{w=!0;const[D,V]=oT(L,a,!0);Er(b,D),V&&o.push(...V)};!l&&a.mixins.length&&a.mixins.forEach(M),t.extends&&M(t.extends),t.mixins&&t.mixins.forEach(M)}if(!v&&!w)return Ri(t)&&d.set(t,Uu),Uu;if(xn(v))for(let M=0;M<v.length;M++){const L=Mo(v[M]);j1(L)&&(b[L]=bi)}else if(v)for(const M in v){const L=Mo(M);if(j1(L)){const D=v[M],V=b[L]=xn(D)||Ln(D)?{type:D}:D;if(V){const q=Z1(Boolean,V.type),X=Z1(String,V.type);V[0]=q>-1,V[1]=X<0||q<X,(q>-1||Wn(V,"default"))&&o.push(L)}}}const C=[b,o];return Ri(t)&&d.set(t,C),C}function j1(t){return t[0]!=="$"}function G1(t){const a=t&&t.toString().match(/^\s*function (\w+)/);return a?a[1]:t===null?"null":""}function q1(t,a){return G1(t)===G1(a)}function Z1(t,a){return xn(a)?a.findIndex(l=>q1(l,t)):Ln(a)&&q1(a,t)?0:-1}const sT=t=>t[0]==="_"||t==="$stable",_y=t=>xn(t)?t.map(Es):[Es(t)],KA=(t,a,l)=>{if(a._n)return a;const d=ii((...m)=>_y(a(...m)),l);return d._c=!1,d},aT=(t,a,l)=>{const d=t._ctx;for(const m in t){if(sT(m))continue;const v=t[m];if(Ln(v))a[m]=KA(m,v,d);else if(v!=null){const b=_y(v);a[m]=()=>b}}},lT=(t,a)=>{const l=_y(a);t.slots.default=()=>l},JA=(t,a)=>{if(t.vnode.shapeFlag&32){const l=a._;l?(t.slots=Hn(a),Em(a,"_",l)):aT(a,t.slots={})}else t.slots={},a&&lT(t,a);Em(t.slots,Jm,1)},QA=(t,a,l)=>{const{vnode:d,slots:m}=t;let v=!0,b=bi;if(d.shapeFlag&32){const o=a._;o?l&&o===1?v=!1:(Er(m,a),!l&&o===1&&delete m._):(v=!a.$stable,aT(a,m)),b=a}else a&&(lT(t,a),b={default:1});if(v)for(const o in m)!sT(o)&&!(o in b)&&delete m[o]};function cT(){return{app:null,config:{isNativeTag:LI,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ek=0;function tk(t,a){return function(d,m=null){Ln(d)||(d=Object.assign({},d)),m!=null&&!Ri(m)&&(m=null);const v=cT(),b=new Set;let o=!1;const w=v.app={_uid:ek++,_component:d,_props:m,_container:null,_context:v,_instance:null,version:Tk,get config(){return v.config},set config(C){},use(C,...M){return b.has(C)||(C&&Ln(C.install)?(b.add(C),C.install(w,...M)):Ln(C)&&(b.add(C),C(w,...M))),w},mixin(C){return v.mixins.includes(C)||v.mixins.push(C),w},component(C,M){return M?(v.components[C]=M,w):v.components[C]},directive(C,M){return M?(v.directives[C]=M,w):v.directives[C]},mount(C,M,L){if(!o){const D=O(d,m);return D.appContext=v,M&&a?a(D,C):t(D,C,L),o=!0,w._container=C,C.__vue_app__=w,eg(D.component)||D.component.proxy}},unmount(){o&&(t(null,w._container),delete w._container.__vue_app__)},provide(C,M){return v.provides[C]=M,w}};return w}}function _v(t,a,l,d,m=!1){if(xn(t)){t.forEach((D,V)=>_v(D,a&&(xn(a)?a[V]:a),l,d,m));return}if(qh(d)&&!m)return;const v=d.shapeFlag&4?eg(d.component)||d.component.proxy:d.el,b=m?null:v,{i:o,r:w}=t,C=a&&a.r,M=o.refs===bi?o.refs={}:o.refs,L=o.setupState;if(C!=null&&C!==w&&(ir(C)?(M[C]=null,Wn(L,C)&&(L[C]=null)):Bi(C)&&(C.value=null)),Ln(w))oa(w,o,12,[b,M]);else{const D=ir(w),V=Bi(w);if(D||V){const q=()=>{if(t.f){const X=D?Wn(L,w)?L[w]:M[w]:w.value;m?xn(X)&&Jv(X,v):xn(X)?X.includes(v)||X.push(v):D?(M[w]=[v],Wn(L,w)&&(L[w]=M[w])):(w.value=[v],t.k&&(M[t.k]=w.value))}else D?(M[w]=b,Wn(L,w)&&(L[w]=b)):V&&(w.value=b,t.k&&(M[t.k]=b))};b?(q.id=-1,to(q,l)):q()}}}const to=LA;function nk(t){return ik(t)}function ik(t,a){const l=VI();l.__VUE__=!0;const{insert:d,remove:m,patchProp:v,createElement:b,createText:o,createComment:w,setText:C,setElementText:M,parentNode:L,nextSibling:D,setScopeId:V=Jo,insertStaticContent:q}=t,X=(ue,Me,qe,st=null,yt=null,Lt=null,Vt=!1,Mt=null,Ot=!!Me.dynamicChildren)=>{if(ue===Me)return;ue&&!sc(ue,Me)&&(st=St(ue),Gt(ue,yt,Lt,!0),ue=null),Me.patchFlag===-2&&(Ot=!1,Me.dynamicChildren=null);const{type:wt,ref:Kt,shapeFlag:Zt}=Me;switch(wt){case yy:xe(ue,Me,qe,st);break;case Ao:ce(ue,Me,qe,st);break;case $_:ue==null&&me(Me,qe,st,Vt);break;case Rn:ze(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot);break;default:Zt&1?Y(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot):Zt&6?Qe(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot):(Zt&64||Zt&128)&&wt.process(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot,fn)}Kt!=null&&yt&&_v(Kt,ue&&ue.ref,Lt,Me||ue,!Me)},xe=(ue,Me,qe,st)=>{if(ue==null)d(Me.el=o(Me.children),qe,st);else{const yt=Me.el=ue.el;Me.children!==ue.children&&C(yt,Me.children)}},ce=(ue,Me,qe,st)=>{ue==null?d(Me.el=w(Me.children||""),qe,st):Me.el=ue.el},me=(ue,Me,qe,st)=>{[ue.el,ue.anchor]=q(ue.children,Me,qe,st,ue.el,ue.anchor)},ee=({el:ue,anchor:Me},qe,st)=>{let yt;for(;ue&&ue!==Me;)yt=D(ue),d(ue,qe,st),ue=yt;d(Me,qe,st)},Ie=({el:ue,anchor:Me})=>{let qe;for(;ue&&ue!==Me;)qe=D(ue),m(ue),ue=qe;m(Me)},Y=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot)=>{Vt=Vt||Me.type==="svg",ue==null?ve(Me,qe,st,yt,Lt,Vt,Mt,Ot):Ee(ue,Me,yt,Lt,Vt,Mt,Ot)},ve=(ue,Me,qe,st,yt,Lt,Vt,Mt)=>{let Ot,wt;const{type:Kt,props:Zt,shapeFlag:rn,transition:hn,dirs:En}=ue;if(Ot=ue.el=b(ue.type,Lt,Zt&&Zt.is,Zt),rn&8?M(Ot,ue.children):rn&16&&ge(ue.children,Ot,null,st,yt,Lt&&Kt!=="foreignObject",Vt,Mt),En&&Ql(ue,null,st,"created"),Zt){for(const jn in Zt)jn!=="value"&&!ym(jn)&&v(Ot,jn,null,Zt[jn],Lt,ue.children,st,yt,xt);"value"in Zt&&v(Ot,"value",null,Zt.value),(wt=Zt.onVnodeBeforeMount)&&Ss(wt,st,ue)}fe(Ot,ue,ue.scopeId,Vt,st),En&&Ql(ue,null,st,"beforeMount");const Un=(!yt||yt&&!yt.pendingBranch)&&hn&&!hn.persisted;Un&&hn.beforeEnter(Ot),d(Ot,Me,qe),((wt=Zt&&Zt.onVnodeMounted)||Un||En)&&to(()=>{wt&&Ss(wt,st,ue),Un&&hn.enter(Ot),En&&Ql(ue,null,st,"mounted")},yt)},fe=(ue,Me,qe,st,yt)=>{if(qe&&V(ue,qe),st)for(let Lt=0;Lt<st.length;Lt++)V(ue,st[Lt]);if(yt){let Lt=yt.subTree;if(Me===Lt){const Vt=yt.vnode;fe(ue,Vt,Vt.scopeId,Vt.slotScopeIds,yt.parent)}}},ge=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot=0)=>{for(let wt=Ot;wt<ue.length;wt++){const Kt=ue[wt]=Mt?el(ue[wt]):Es(ue[wt]);X(null,Kt,Me,qe,st,yt,Lt,Vt,Mt)}},Ee=(ue,Me,qe,st,yt,Lt,Vt)=>{const Mt=Me.el=ue.el;let{patchFlag:Ot,dynamicChildren:wt,dirs:Kt}=Me;Ot|=ue.patchFlag&16;const Zt=ue.props||bi,rn=Me.props||bi;let hn;qe&&ec(qe,!1),(hn=rn.onVnodeBeforeUpdate)&&Ss(hn,qe,Me,ue),Kt&&Ql(Me,ue,qe,"beforeUpdate"),qe&&ec(qe,!0);const En=yt&&Me.type!=="foreignObject";if(wt?we(ue.dynamicChildren,wt,Mt,qe,st,En,Lt):Vt||at(ue,Me,Mt,null,qe,st,En,Lt,!1),Ot>0){if(Ot&16)Oe(Mt,Me,Zt,rn,qe,st,yt);else if(Ot&2&&Zt.class!==rn.class&&v(Mt,"class",null,rn.class,yt),Ot&4&&v(Mt,"style",Zt.style,rn.style,yt),Ot&8){const Un=Me.dynamicProps;for(let jn=0;jn<Un.length;jn++){const mi=Un[jn],tr=Zt[mi],Wi=rn[mi];(Wi!==tr||mi==="value")&&v(Mt,mi,tr,Wi,yt,ue.children,qe,st,xt)}}Ot&1&&ue.children!==Me.children&&M(Mt,Me.children)}else!Vt&&wt==null&&Oe(Mt,Me,Zt,rn,qe,st,yt);((hn=rn.onVnodeUpdated)||Kt)&&to(()=>{hn&&Ss(hn,qe,Me,ue),Kt&&Ql(Me,ue,qe,"updated")},st)},we=(ue,Me,qe,st,yt,Lt,Vt)=>{for(let Mt=0;Mt<Me.length;Mt++){const Ot=ue[Mt],wt=Me[Mt],Kt=Ot.el&&(Ot.type===Rn||!sc(Ot,wt)||Ot.shapeFlag&70)?L(Ot.el):qe;X(Ot,wt,Kt,null,st,yt,Lt,Vt,!0)}},Oe=(ue,Me,qe,st,yt,Lt,Vt)=>{if(qe!==st){if(qe!==bi)for(const Mt in qe)!ym(Mt)&&!(Mt in st)&&v(ue,Mt,qe[Mt],null,Vt,Me.children,yt,Lt,xt);for(const Mt in st){if(ym(Mt))continue;const Ot=st[Mt],wt=qe[Mt];Ot!==wt&&Mt!=="value"&&v(ue,Mt,wt,Ot,Vt,Me.children,yt,Lt,xt)}"value"in st&&v(ue,"value",qe.value,st.value)}},ze=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot)=>{const wt=Me.el=ue?ue.el:o(""),Kt=Me.anchor=ue?ue.anchor:o("");let{patchFlag:Zt,dynamicChildren:rn,slotScopeIds:hn}=Me;hn&&(Mt=Mt?Mt.concat(hn):hn),ue==null?(d(wt,qe,st),d(Kt,qe,st),ge(Me.children,qe,Kt,yt,Lt,Vt,Mt,Ot)):Zt>0&&Zt&64&&rn&&ue.dynamicChildren?(we(ue.dynamicChildren,rn,qe,yt,Lt,Vt,Mt),(Me.key!=null||yt&&Me===yt.subTree)&&vy(ue,Me,!0)):at(ue,Me,qe,Kt,yt,Lt,Vt,Mt,Ot)},Qe=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot)=>{Me.slotScopeIds=Mt,ue==null?Me.shapeFlag&512?yt.ctx.activate(Me,qe,st,Vt,Ot):ht(Me,qe,st,yt,Lt,Vt,Ot):nt(ue,Me,Ot)},ht=(ue,Me,qe,st,yt,Lt,Vt)=>{const Mt=ue.component=mk(ue,st,yt);if(Xm(ue)&&(Mt.ctx.renderer=fn),gk(Mt),Mt.asyncDep){if(yt&&yt.registerDep(Mt,ft),!ue.el){const Ot=Mt.subTree=O(Ao);ce(null,Ot,Me,qe)}return}ft(Mt,ue,Me,qe,yt,Lt,Vt)},nt=(ue,Me,qe)=>{const st=Me.component=ue.component;if(MA(ue,Me,qe))if(st.asyncDep&&!st.asyncResolved){Pe(st,Me,qe);return}else st.next=Me,SA(st.update),st.update();else Me.el=ue.el,st.vnode=Me},ft=(ue,Me,qe,st,yt,Lt,Vt)=>{const Mt=()=>{if(ue.isMounted){let{next:Kt,bu:Zt,u:rn,parent:hn,vnode:En}=ue,Un=Kt,jn;ec(ue,!1),Kt?(Kt.el=En.el,Pe(ue,Kt,Vt)):Kt=En,Zt&&bm(Zt),(jn=Kt.props&&Kt.props.onVnodeBeforeUpdate)&&Ss(jn,hn,Kt,En),ec(ue,!0);const mi=O_(ue),tr=ue.subTree;ue.subTree=mi,X(tr,mi,L(tr.el),St(tr),ue,yt,Lt),Kt.el=mi.el,Un===null&&PA(ue,mi.el),rn&&to(rn,yt),(jn=Kt.props&&Kt.props.onVnodeUpdated)&&to(()=>Ss(jn,hn,Kt,En),yt)}else{let Kt;const{el:Zt,props:rn}=Me,{bm:hn,m:En,parent:Un}=ue,jn=qh(Me);if(ec(ue,!1),hn&&bm(hn),!jn&&(Kt=rn&&rn.onVnodeBeforeMount)&&Ss(Kt,Un,Me),ec(ue,!0),Zt&&gn){const mi=()=>{ue.subTree=O_(ue),gn(Zt,ue.subTree,ue,yt,null)};jn?Me.type.__asyncLoader().then(()=>!ue.isUnmounted&&mi()):mi()}else{const mi=ue.subTree=O_(ue);X(null,mi,qe,st,ue,yt,Lt),Me.el=mi.el}if(En&&to(En,yt),!jn&&(Kt=rn&&rn.onVnodeMounted)){const mi=Me;to(()=>Ss(Kt,Un,mi),yt)}(Me.shapeFlag&256||Un&&qh(Un.vnode)&&Un.vnode.shapeFlag&256)&&ue.a&&to(ue.a,yt),ue.isMounted=!0,Me=qe=st=null}},Ot=ue.effect=new ny(Mt,()=>uy(wt),ue.scope),wt=ue.update=()=>Ot.run();wt.id=ue.uid,ec(ue,!0),wt()},Pe=(ue,Me,qe)=>{Me.component=ue;const st=ue.vnode.props;ue.vnode=Me,ue.next=null,YA(ue,Me.props,st,qe),QA(ue,Me.children,qe),yc(),R1(),xc()},at=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot=!1)=>{const wt=ue&&ue.children,Kt=ue?ue.shapeFlag:0,Zt=Me.children,{patchFlag:rn,shapeFlag:hn}=Me;if(rn>0){if(rn&128){pt(wt,Zt,qe,st,yt,Lt,Vt,Mt,Ot);return}else if(rn&256){jt(wt,Zt,qe,st,yt,Lt,Vt,Mt,Ot);return}}hn&8?(Kt&16&&xt(wt,yt,Lt),Zt!==wt&&M(qe,Zt)):Kt&16?hn&16?pt(wt,Zt,qe,st,yt,Lt,Vt,Mt,Ot):xt(wt,yt,Lt,!0):(Kt&8&&M(qe,""),hn&16&&ge(Zt,qe,st,yt,Lt,Vt,Mt,Ot))},jt=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot)=>{ue=ue||Uu,Me=Me||Uu;const wt=ue.length,Kt=Me.length,Zt=Math.min(wt,Kt);let rn;for(rn=0;rn<Zt;rn++){const hn=Me[rn]=Ot?el(Me[rn]):Es(Me[rn]);X(ue[rn],hn,qe,null,yt,Lt,Vt,Mt,Ot)}wt>Kt?xt(ue,yt,Lt,!0,!1,Zt):ge(Me,qe,st,yt,Lt,Vt,Mt,Ot,Zt)},pt=(ue,Me,qe,st,yt,Lt,Vt,Mt,Ot)=>{let wt=0;const Kt=Me.length;let Zt=ue.length-1,rn=Kt-1;for(;wt<=Zt&&wt<=rn;){const hn=ue[wt],En=Me[wt]=Ot?el(Me[wt]):Es(Me[wt]);if(sc(hn,En))X(hn,En,qe,null,yt,Lt,Vt,Mt,Ot);else break;wt++}for(;wt<=Zt&&wt<=rn;){const hn=ue[Zt],En=Me[rn]=Ot?el(Me[rn]):Es(Me[rn]);if(sc(hn,En))X(hn,En,qe,null,yt,Lt,Vt,Mt,Ot);else break;Zt--,rn--}if(wt>Zt){if(wt<=rn){const hn=rn+1,En=hn<Kt?Me[hn].el:st;for(;wt<=rn;)X(null,Me[wt]=Ot?el(Me[wt]):Es(Me[wt]),qe,En,yt,Lt,Vt,Mt,Ot),wt++}}else if(wt>rn)for(;wt<=Zt;)Gt(ue[wt],yt,Lt,!0),wt++;else{const hn=wt,En=wt,Un=new Map;for(wt=En;wt<=rn;wt++){const Ji=Me[wt]=Ot?el(Me[wt]):Es(Me[wt]);Ji.key!=null&&Un.set(Ji.key,wt)}let jn,mi=0;const tr=rn-En+1;let Wi=!1,rs=0;const Pr=new Array(tr);for(wt=0;wt<tr;wt++)Pr[wt]=0;for(wt=hn;wt<=Zt;wt++){const Ji=ue[wt];if(mi>=tr){Gt(Ji,yt,Lt,!0);continue}let ar;if(Ji.key!=null)ar=Un.get(Ji.key);else for(jn=En;jn<=rn;jn++)if(Pr[jn-En]===0&&sc(Ji,Me[jn])){ar=jn;break}ar===void 0?Gt(Ji,yt,Lt,!0):(Pr[ar-En]=wt+1,ar>=rs?rs=ar:Wi=!0,X(Ji,Me[ar],qe,null,yt,Lt,Vt,Mt,Ot),mi++)}const mo=Wi?rk(Pr):Uu;for(jn=mo.length-1,wt=tr-1;wt>=0;wt--){const Ji=En+wt,ar=Me[Ji],Bo=Ji+1<Kt?Me[Ji+1].el:st;Pr[wt]===0?X(null,ar,qe,Bo,yt,Lt,Vt,Mt,Ot):Wi&&(jn<0||wt!==mo[jn]?zt(ar,qe,Bo,2):jn--)}}},zt=(ue,Me,qe,st,yt=null)=>{const{el:Lt,type:Vt,transition:Mt,children:Ot,shapeFlag:wt}=ue;if(wt&6){zt(ue.component.subTree,Me,qe,st);return}if(wt&128){ue.suspense.move(Me,qe,st);return}if(wt&64){Vt.move(ue,Me,qe,fn);return}if(Vt===Rn){d(Lt,Me,qe);for(let Zt=0;Zt<Ot.length;Zt++)zt(Ot[Zt],Me,qe,st);d(ue.anchor,Me,qe);return}if(Vt===$_){ee(ue,Me,qe);return}if(st!==2&&wt&1&&Mt)if(st===0)Mt.beforeEnter(Lt),d(Lt,Me,qe),to(()=>Mt.enter(Lt),yt);else{const{leave:Zt,delayLeave:rn,afterLeave:hn}=Mt,En=()=>d(Lt,Me,qe),Un=()=>{Zt(Lt,()=>{En(),hn&&hn()})};rn?rn(Lt,En,Un):Un()}else d(Lt,Me,qe)},Gt=(ue,Me,qe,st=!1,yt=!1)=>{const{type:Lt,props:Vt,ref:Mt,children:Ot,dynamicChildren:wt,shapeFlag:Kt,patchFlag:Zt,dirs:rn}=ue;if(Mt!=null&&_v(Mt,null,qe,ue,!0),Kt&256){Me.ctx.deactivate(ue);return}const hn=Kt&1&&rn,En=!qh(ue);let Un;if(En&&(Un=Vt&&Vt.onVnodeBeforeUnmount)&&Ss(Un,Me,ue),Kt&6)Ke(ue.component,qe,st);else{if(Kt&128){ue.suspense.unmount(qe,st);return}hn&&Ql(ue,null,Me,"beforeUnmount"),Kt&64?ue.type.remove(ue,Me,qe,yt,fn,st):wt&&(Lt!==Rn||Zt>0&&Zt&64)?xt(wt,Me,qe,!1,!0):(Lt===Rn&&Zt&384||!yt&&Kt&16)&&xt(Ot,Me,qe),st&&zn(ue)}(En&&(Un=Vt&&Vt.onVnodeUnmounted)||hn)&&to(()=>{Un&&Ss(Un,Me,ue),hn&&Ql(ue,null,Me,"unmounted")},qe)},zn=ue=>{const{type:Me,el:qe,anchor:st,transition:yt}=ue;if(Me===Rn){At(qe,st);return}if(Me===$_){Ie(ue);return}const Lt=()=>{m(qe),yt&&!yt.persisted&&yt.afterLeave&&yt.afterLeave()};if(ue.shapeFlag&1&&yt&&!yt.persisted){const{leave:Vt,delayLeave:Mt}=yt,Ot=()=>Vt(qe,Lt);Mt?Mt(ue.el,Lt,Ot):Ot()}else Lt()},At=(ue,Me)=>{let qe;for(;ue!==Me;)qe=D(ue),m(ue),ue=qe;m(Me)},Ke=(ue,Me,qe)=>{const{bum:st,scope:yt,update:Lt,subTree:Vt,um:Mt}=ue;st&&bm(st),yt.stop(),Lt&&(Lt.active=!1,Gt(Vt,ue,Me,qe)),Mt&&to(Mt,Me),to(()=>{ue.isUnmounted=!0},Me),Me&&Me.pendingBranch&&!Me.isUnmounted&&ue.asyncDep&&!ue.asyncResolved&&ue.suspenseId===Me.pendingId&&(Me.deps--,Me.deps===0&&Me.resolve())},xt=(ue,Me,qe,st=!1,yt=!1,Lt=0)=>{for(let Vt=Lt;Vt<ue.length;Vt++)Gt(ue[Vt],Me,qe,st,yt)},St=ue=>ue.shapeFlag&6?St(ue.component.subTree):ue.shapeFlag&128?ue.suspense.next():D(ue.anchor||ue.el),Nt=(ue,Me,qe)=>{ue==null?Me._vnode&&Gt(Me._vnode,null,null,!0):X(Me._vnode||null,ue,Me,null,null,null,qe),R1(),Uw(),Me._vnode=ue},fn={p:X,um:Gt,m:zt,r:zn,mt:ht,mc:ge,pc:at,pbc:we,n:St,o:t};let Dn,gn;return a&&([Dn,gn]=a(fn)),{render:Nt,hydrate:Dn,createApp:tk(Nt,Dn)}}function ec({effect:t,update:a},l){t.allowRecurse=a.allowRecurse=l}function vy(t,a,l=!1){const d=t.children,m=a.children;if(xn(d)&&xn(m))for(let v=0;v<d.length;v++){const b=d[v];let o=m[v];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=m[v]=el(m[v]),o.el=b.el),l||vy(b,o))}}function rk(t){const a=t.slice(),l=[0];let d,m,v,b,o;const w=t.length;for(d=0;d<w;d++){const C=t[d];if(C!==0){if(m=l[l.length-1],t[m]<C){a[d]=m,l.push(d);continue}for(v=0,b=l.length-1;v<b;)o=v+b>>1,t[l[o]]<C?v=o+1:b=o;C<t[l[v]]&&(v>0&&(a[d]=l[v-1]),l[v]=d)}}for(v=l.length,b=l[v-1];v-- >0;)l[v]=b,b=a[b];return l}const ok=t=>t.__isTeleport,Zh=t=>t&&(t.disabled||t.disabled===""),W1=t=>typeof SVGElement<"u"&&t instanceof SVGElement,vv=(t,a)=>{const l=t&&t.to;return ir(l)?a?a(l):null:l},sk={__isTeleport:!0,process(t,a,l,d,m,v,b,o,w,C){const{mc:M,pc:L,pbc:D,o:{insert:V,querySelector:q,createText:X,createComment:xe}}=C,ce=Zh(a.props);let{shapeFlag:me,children:ee,dynamicChildren:Ie}=a;if(t==null){const Y=a.el=X(""),ve=a.anchor=X("");V(Y,l,d),V(ve,l,d);const fe=a.target=vv(a.props,q),ge=a.targetAnchor=X("");fe&&(V(ge,fe),b=b||W1(fe));const Ee=(we,Oe)=>{me&16&&M(ee,we,Oe,m,v,b,o,w)};ce?Ee(l,ve):fe&&Ee(fe,ge)}else{a.el=t.el;const Y=a.anchor=t.anchor,ve=a.target=t.target,fe=a.targetAnchor=t.targetAnchor,ge=Zh(t.props),Ee=ge?l:ve,we=ge?Y:fe;if(b=b||W1(ve),Ie?(D(t.dynamicChildren,Ie,Ee,m,v,b,o),vy(t,a,!0)):w||L(t,a,Ee,we,m,v,b,o,!1),ce)ge||hm(a,l,Y,C,1);else if((a.props&&a.props.to)!==(t.props&&t.props.to)){const Oe=a.target=vv(a.props,q);Oe&&hm(a,Oe,null,C,0)}else ge&&hm(a,ve,fe,C,1)}},remove(t,a,l,d,{um:m,o:{remove:v}},b){const{shapeFlag:o,children:w,anchor:C,targetAnchor:M,target:L,props:D}=t;if(L&&v(M),(b||!Zh(D))&&(v(C),o&16))for(let V=0;V<w.length;V++){const q=w[V];m(q,a,l,!0,!!q.dynamicChildren)}},move:hm,hydrate:ak};function hm(t,a,l,{o:{insert:d},m},v=2){v===0&&d(t.targetAnchor,a,l);const{el:b,anchor:o,shapeFlag:w,children:C,props:M}=t,L=v===2;if(L&&d(b,a,l),(!L||Zh(M))&&w&16)for(let D=0;D<C.length;D++)m(C[D],a,l,2);L&&d(o,a,l)}function ak(t,a,l,d,m,v,{o:{nextSibling:b,parentNode:o,querySelector:w}},C){const M=a.target=vv(a.props,w);if(M){const L=M._lpa||M.firstChild;if(a.shapeFlag&16)if(Zh(a.props))a.anchor=C(b(t),a,o(t),l,d,m,v),a.targetAnchor=L;else{a.anchor=b(t);let D=L;for(;D;)if(D=b(D),D&&D.nodeType===8&&D.data==="teleport anchor"){a.targetAnchor=D,M._lpa=a.targetAnchor&&b(a.targetAnchor);break}C(L,a,M,l,d,m,v)}}return a.anchor&&b(a.anchor)}const lk=sk,Rn=Symbol(void 0),yy=Symbol(void 0),Ao=Symbol(void 0),$_=Symbol(void 0),Wh=[];let Ko=null;function Zi(t=!1){Wh.push(Ko=t?null:[])}function ck(){Wh.pop(),Ko=Wh[Wh.length-1]||null}let sf=1;function H1(t){sf+=t}function uT(t){return t.dynamicChildren=sf>0?Ko||Uu:null,ck(),sf>0&&Ko&&Ko.push(t),t}function ho(t,a,l,d,m,v){return uT(xy(t,a,l,d,m,v,!0))}function Ps(t,a,l,d,m){return uT(O(t,a,l,d,m,!0))}function Pm(t){return t?t.__v_isVNode===!0:!1}function sc(t,a){return t.type===a.type&&t.key===a.key}const Jm="__vInternal",dT=({key:t})=>t!=null?t:null,wm=({ref:t,ref_key:a,ref_for:l})=>t!=null?ir(t)||Bi(t)||Ln(t)?{i:Nr,r:t,k:a,f:!!l}:t:null;function xy(t,a=null,l=null,d=0,m=null,v=t===Rn?0:1,b=!1,o=!1){const w={__v_isVNode:!0,__v_skip:!0,type:t,props:a,key:a&&dT(a),ref:a&&wm(a),scopeId:qw,slotScopeIds:null,children:l,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:v,patchFlag:d,dynamicProps:m,dynamicChildren:null,appContext:null};return o?(by(w,l),v&128&&t.normalize(w)):l&&(w.shapeFlag|=ir(l)?8:16),sf>0&&!b&&Ko&&(w.patchFlag>0||v&6)&&w.patchFlag!==32&&Ko.push(w),w}const O=uk;function uk(t,a=null,l=null,d=0,m=null,v=!1){if((!t||t===tT)&&(t=Ao),Pm(t)){const o=aa(t,a,!0);return l&&by(o,l),sf>0&&!v&&Ko&&(o.shapeFlag&6?Ko[Ko.indexOf(t)]=o:Ko.push(o)),o.patchFlag|=-2,o}if(wk(t)&&(t=t.__vccOpts),a){a=dk(a);let{class:o,style:w}=a;o&&!ir(o)&&(a.class=Yv(o)),Ri(w)&&(zw(w)&&!xn(w)&&(w=Er({},w)),a.style=Xv(w))}const b=ir(t)?1:zA(t)?128:ok(t)?64:Ri(t)?4:Ln(t)?2:0;return xy(t,a,l,d,m,b,v,!0)}function dk(t){return t?zw(t)||Jm in t?Er({},t):t:null}function aa(t,a,l=!1){const{props:d,ref:m,patchFlag:v,children:b}=t,o=a?nn(d||{},a):d;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:o,key:o&&dT(o),ref:a&&a.ref?l&&m?xn(m)?m.concat(wm(a)):[m,wm(a)]:wm(a):m,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:b,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:a&&t.type!==Rn?v===-1?16:v|16:v,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&aa(t.ssContent),ssFallback:t.ssFallback&&aa(t.ssFallback),el:t.el,anchor:t.anchor}}function Yo(t=" ",a=0){return O(yy,null,t,a)}function hk(t="",a=!1){return a?(Zi(),Ps(Ao,null,t)):O(Ao,null,t)}function Es(t){return t==null||typeof t=="boolean"?O(Ao):xn(t)?O(Rn,null,t.slice()):typeof t=="object"?el(t):O(yy,null,String(t))}function el(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:aa(t)}function by(t,a){let l=0;const{shapeFlag:d}=t;if(a==null)a=null;else if(xn(a))l=16;else if(typeof a=="object")if(d&65){const m=a.default;m&&(m._c&&(m._d=!1),by(t,m()),m._c&&(m._d=!0));return}else{l=32;const m=a._;!m&&!(Jm in a)?a._ctx=Nr:m===3&&Nr&&(Nr.slots._===1?a._=1:(a._=2,t.patchFlag|=1024))}else Ln(a)?(a={default:a,_ctx:Nr},l=32):(a=String(a),d&64?(l=16,a=[Yo(a)]):l=8);t.children=a,t.shapeFlag|=l}function nn(...t){const a={};for(let l=0;l<t.length;l++){const d=t[l];for(const m in d)if(m==="class")a.class!==d.class&&(a.class=Yv([a.class,d.class]));else if(m==="style")a.style=Xv([a.style,d.style]);else if(jm(m)){const v=a[m],b=d[m];b&&v!==b&&!(xn(v)&&v.includes(b))&&(a[m]=v?[].concat(v,b):b)}else m!==""&&(a[m]=d[m])}return a}function Ss(t,a,l,d=null){Io(t,a,7,[l,d])}const fk=cT();let pk=0;function mk(t,a,l){const d=t.type,m=(a?a.appContext:t.appContext)||fk,v={uid:pk++,vnode:t,type:d,parent:a,appContext:m,root:null,next:null,subTree:null,effect:null,update:null,scope:new xw(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:a?a.provides:Object.create(m.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:oT(d,m),emitsOptions:Gw(d,m),emit:null,emitted:null,propsDefaults:bi,inheritAttrs:d.inheritAttrs,ctx:bi,data:bi,props:bi,attrs:bi,slots:bi,refs:bi,setupState:bi,setupContext:null,suspense:l,suspenseId:l?l.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return v.ctx={_:v},v.root=a?a.root:v,v.emit=IA.bind(null,v),t.ce&&t.ce(v),v}let Sr=null;const Qm=()=>Sr||Nr,Hu=t=>{Sr=t,t.scope.on()},pc=()=>{Sr&&Sr.scope.off(),Sr=null};function hT(t){return t.vnode.shapeFlag&4}let af=!1;function gk(t,a=!1){af=a;const{props:l,children:d}=t.vnode,m=hT(t);XA(t,l,m,a),JA(t,d);const v=m?_k(t,a):void 0;return af=!1,v}function _k(t,a){const l=t.type;t.accessCache=Object.create(null),t.proxy=Lw(new Proxy(t.ctx,jA));const{setup:d}=l;if(d){const m=t.setupContext=d.length>1?yk(t):null;Hu(t),yc();const v=oa(d,t,0,[t.props,m]);if(xc(),pc(),_w(v)){if(v.then(pc,pc),a)return v.then(b=>{X1(t,b,a)}).catch(b=>{Wm(b,t,0)});t.asyncDep=v}else X1(t,v,a)}else fT(t,a)}function X1(t,a,l){Ln(a)?t.type.__ssrInlineRender?t.ssrRender=a:t.render=a:Ri(a)&&(t.setupState=Ow(a)),fT(t,l)}let Y1;function fT(t,a,l){const d=t.type;if(!t.render){if(!a&&Y1&&!d.render){const m=d.template||gy(t).template;if(m){const{isCustomElement:v,compilerOptions:b}=t.appContext.config,{delimiters:o,compilerOptions:w}=d,C=Er(Er({isCustomElement:v,delimiters:o},b),w);d.render=Y1(m,C)}}t.render=d.render||Jo}Hu(t),yc(),GA(t),xc(),pc()}function vk(t){return new Proxy(t.attrs,{get(a,l){return co(t,"get","$attrs"),a[l]}})}function yk(t){const a=d=>{t.exposed=d||{}};let l;return{get attrs(){return l||(l=vk(t))},slots:t.slots,emit:t.emit,expose:a}}function eg(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(Ow(Lw(t.exposed)),{get(a,l){if(l in a)return a[l];if(l in km)return km[l](t)}}))}const xk=/(?:^|[-_])(\w)/g,bk=t=>t.replace(xk,a=>a.toUpperCase()).replace(/[-_]/g,"");function pT(t,a=!0){return Ln(t)?t.displayName||t.name:t.name||a&&t.__name}function mT(t,a,l=!1){let d=pT(a);if(!d&&a.__file){const m=a.__file.match(/([^/\\]+)\.\w+$/);m&&(d=m[1])}if(!d&&t&&t.parent){const m=v=>{for(const b in v)if(v[b]===a)return b};d=m(t.components||t.parent.type.components)||m(t.appContext.components)}return d?bk(d):l?"App":"Anonymous"}function wk(t){return Ln(t)&&"__vccOpts"in t}const ne=(t,a)=>gA(t,a,af);function zs(t,a,l){const d=arguments.length;return d===2?Ri(a)&&!xn(a)?Pm(a)?O(t,null,[a]):O(t,a):O(t,null,a):(d>3?l=Array.prototype.slice.call(arguments,2):d===3&&Pm(l)&&(l=[l]),O(t,a,l))}const Tk="3.2.41",Sk="http://www.w3.org/2000/svg",ac=typeof document<"u"?document:null,K1=ac&&ac.createElement("template"),Ek={insert:(t,a,l)=>{a.insertBefore(t,l||null)},remove:t=>{const a=t.parentNode;a&&a.removeChild(t)},createElement:(t,a,l,d)=>{const m=a?ac.createElementNS(Sk,t):ac.createElement(t,l?{is:l}:void 0);return t==="select"&&d&&d.multiple!=null&&m.setAttribute("multiple",d.multiple),m},createText:t=>ac.createTextNode(t),createComment:t=>ac.createComment(t),setText:(t,a)=>{t.nodeValue=a},setElementText:(t,a)=>{t.textContent=a},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>ac.querySelector(t),setScopeId(t,a){t.setAttribute(a,"")},insertStaticContent(t,a,l,d,m,v){const b=l?l.previousSibling:a.lastChild;if(m&&(m===v||m.nextSibling))for(;a.insertBefore(m.cloneNode(!0),l),!(m===v||!(m=m.nextSibling)););else{K1.innerHTML=d?`<svg>${t}</svg>`:t;const o=K1.content;if(d){const w=o.firstChild;for(;w.firstChild;)o.appendChild(w.firstChild);o.removeChild(w)}a.insertBefore(o,l)}return[b?b.nextSibling:a.firstChild,l?l.previousSibling:a.lastChild]}};function Ck(t,a,l){const d=t._vtc;d&&(a=(a?[a,...d]:[...d]).join(" ")),a==null?t.removeAttribute("class"):l?t.setAttribute("class",a):t.className=a}function Ik(t,a,l){const d=t.style,m=ir(l);if(l&&!m){for(const v in l)yv(d,v,l[v]);if(a&&!ir(a))for(const v in a)l[v]==null&&yv(d,v,"")}else{const v=d.display;m?a!==l&&(d.cssText=l):a&&t.removeAttribute("style"),"_vod"in t&&(d.display=v)}}const J1=/\s*!important$/;function yv(t,a,l){if(xn(l))l.forEach(d=>yv(t,a,d));else if(l==null&&(l=""),a.startsWith("--"))t.setProperty(a,l);else{const d=Ak(t,a);J1.test(l)?t.setProperty(Ju(d),l.replace(J1,""),"important"):t[d]=l}}const Q1=["Webkit","Moz","ms"],N_={};function Ak(t,a){const l=N_[a];if(l)return l;let d=Mo(a);if(d!=="filter"&&d in t)return N_[a]=d;d=ol(d);for(let m=0;m<Q1.length;m++){const v=Q1[m]+d;if(v in t)return N_[a]=v}return a}const eb="http://www.w3.org/1999/xlink";function kk(t,a,l,d,m){if(d&&a.startsWith("xlink:"))l==null?t.removeAttributeNS(eb,a.slice(6,a.length)):t.setAttributeNS(eb,a,l);else{const v=AI(a);l==null||v&&!pw(l)?t.removeAttribute(a):t.setAttribute(a,v?"":l)}}function Mk(t,a,l,d,m,v,b){if(a==="innerHTML"||a==="textContent"){d&&b(d,m,v),t[a]=l==null?"":l;return}if(a==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=l;const w=l==null?"":l;(t.value!==w||t.tagName==="OPTION")&&(t.value=w),l==null&&t.removeAttribute(a);return}let o=!1;if(l===""||l==null){const w=typeof t[a];w==="boolean"?l=pw(l):l==null&&w==="string"?(l="",o=!0):w==="number"&&(l=0,o=!0)}try{t[a]=l}catch{}o&&t.removeAttribute(a)}function Vu(t,a,l,d){t.addEventListener(a,l,d)}function Pk(t,a,l,d){t.removeEventListener(a,l,d)}function zk(t,a,l,d,m=null){const v=t._vei||(t._vei={}),b=v[a];if(d&&b)b.value=d;else{const[o,w]=Lk(a);if(d){const C=v[a]=Rk(d,m);Vu(t,o,C,w)}else b&&(Pk(t,o,b,w),v[a]=void 0)}}const tb=/(?:Once|Passive|Capture)$/;function Lk(t){let a;if(tb.test(t)){a={};let d;for(;d=t.match(tb);)t=t.slice(0,t.length-d[0].length),a[d[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Ju(t.slice(2)),a]}let U_=0;const Dk=Promise.resolve(),Bk=()=>U_||(Dk.then(()=>U_=0),U_=Date.now());function Rk(t,a){const l=d=>{if(!d._vts)d._vts=Date.now();else if(d._vts<=l.attached)return;Io(Ok(d,l.value),a,5,[d])};return l.value=t,l.attached=Bk(),l}function Ok(t,a){if(xn(a)){const l=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{l.call(t),t._stopped=!0},a.map(d=>m=>!m._stopped&&d&&d(m))}else return a}const nb=/^on[a-z]/,Fk=(t,a,l,d,m=!1,v,b,o,w)=>{a==="class"?Ck(t,d,m):a==="style"?Ik(t,l,d):jm(a)?Kv(a)||zk(t,a,l,d,b):(a[0]==="."?(a=a.slice(1),!0):a[0]==="^"?(a=a.slice(1),!1):Vk(t,a,d,m))?Mk(t,a,d,v,b,o,w):(a==="true-value"?t._trueValue=d:a==="false-value"&&(t._falseValue=d),kk(t,a,d,m))};function Vk(t,a,l,d){return d?!!(a==="innerHTML"||a==="textContent"||a in t&&nb.test(a)&&Ln(l)):a==="spellcheck"||a==="draggable"||a==="translate"||a==="form"||a==="list"&&t.tagName==="INPUT"||a==="type"&&t.tagName==="TEXTAREA"||nb.test(a)&&ir(l)?!1:a in t}const Ka="transition",Bh="animation",ks=(t,{slots:a})=>zs(Hw,_T(t),a);ks.displayName="Transition";const gT={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},$k=ks.props=Er({},Hw.props,gT),tc=(t,a=[])=>{xn(t)?t.forEach(l=>l(...a)):t&&t(...a)},ib=t=>t?xn(t)?t.some(a=>a.length>1):t.length>1:!1;function _T(t){const a={};for(const ze in t)ze in gT||(a[ze]=t[ze]);if(t.css===!1)return a;const{name:l="v",type:d,duration:m,enterFromClass:v=`${l}-enter-from`,enterActiveClass:b=`${l}-enter-active`,enterToClass:o=`${l}-enter-to`,appearFromClass:w=v,appearActiveClass:C=b,appearToClass:M=o,leaveFromClass:L=`${l}-leave-from`,leaveActiveClass:D=`${l}-leave-active`,leaveToClass:V=`${l}-leave-to`}=t,q=Nk(m),X=q&&q[0],xe=q&&q[1],{onBeforeEnter:ce,onEnter:me,onEnterCancelled:ee,onLeave:Ie,onLeaveCancelled:Y,onBeforeAppear:ve=ce,onAppear:fe=me,onAppearCancelled:ge=ee}=a,Ee=(ze,Qe,ht)=>{Qa(ze,Qe?M:o),Qa(ze,Qe?C:b),ht&&ht()},we=(ze,Qe)=>{ze._isLeaving=!1,Qa(ze,L),Qa(ze,V),Qa(ze,D),Qe&&Qe()},Oe=ze=>(Qe,ht)=>{const nt=ze?fe:me,ft=()=>Ee(Qe,ze,ht);tc(nt,[Qe,ft]),rb(()=>{Qa(Qe,ze?w:v),ia(Qe,ze?M:o),ib(nt)||ob(Qe,d,X,ft)})};return Er(a,{onBeforeEnter(ze){tc(ce,[ze]),ia(ze,v),ia(ze,b)},onBeforeAppear(ze){tc(ve,[ze]),ia(ze,w),ia(ze,C)},onEnter:Oe(!1),onAppear:Oe(!0),onLeave(ze,Qe){ze._isLeaving=!0;const ht=()=>we(ze,Qe);ia(ze,L),yT(),ia(ze,D),rb(()=>{!ze._isLeaving||(Qa(ze,L),ia(ze,V),ib(Ie)||ob(ze,d,xe,ht))}),tc(Ie,[ze,ht])},onEnterCancelled(ze){Ee(ze,!1),tc(ee,[ze])},onAppearCancelled(ze){Ee(ze,!0),tc(ge,[ze])},onLeaveCancelled(ze){we(ze),tc(Y,[ze])}})}function Nk(t){if(t==null)return null;if(Ri(t))return[j_(t.enter),j_(t.leave)];{const a=j_(t);return[a,a]}}function j_(t){return Cm(t)}function ia(t,a){a.split(/\s+/).forEach(l=>l&&t.classList.add(l)),(t._vtc||(t._vtc=new Set)).add(a)}function Qa(t,a){a.split(/\s+/).forEach(d=>d&&t.classList.remove(d));const{_vtc:l}=t;l&&(l.delete(a),l.size||(t._vtc=void 0))}function rb(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let Uk=0;function ob(t,a,l,d){const m=t._endId=++Uk,v=()=>{m===t._endId&&d()};if(l)return setTimeout(v,l);const{type:b,timeout:o,propCount:w}=vT(t,a);if(!b)return d();const C=b+"end";let M=0;const L=()=>{t.removeEventListener(C,D),v()},D=V=>{V.target===t&&++M>=w&&L()};setTimeout(()=>{M<w&&L()},o+1),t.addEventListener(C,D)}function vT(t,a){const l=window.getComputedStyle(t),d=q=>(l[q]||"").split(", "),m=d(Ka+"Delay"),v=d(Ka+"Duration"),b=sb(m,v),o=d(Bh+"Delay"),w=d(Bh+"Duration"),C=sb(o,w);let M=null,L=0,D=0;a===Ka?b>0&&(M=Ka,L=b,D=v.length):a===Bh?C>0&&(M=Bh,L=C,D=w.length):(L=Math.max(b,C),M=L>0?b>C?Ka:Bh:null,D=M?M===Ka?v.length:w.length:0);const V=M===Ka&&/\b(transform|all)(,|$)/.test(l[Ka+"Property"]);return{type:M,timeout:L,propCount:D,hasTransform:V}}function sb(t,a){for(;t.length<a.length;)t=t.concat(t);return Math.max(...a.map((l,d)=>ab(l)+ab(t[d])))}function ab(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function yT(){return document.body.offsetHeight}const xT=new WeakMap,bT=new WeakMap,jk={name:"TransitionGroup",props:Er({},$k,{tag:String,moveClass:String}),setup(t,{slots:a}){const l=Qm(),d=Ww();let m,v;return eT(()=>{if(!m.length)return;const b=t.moveClass||`${t.name||"v"}-move`;if(!Hk(m[0].el,l.vnode.el,b))return;m.forEach(qk),m.forEach(Zk);const o=m.filter(Wk);yT(),o.forEach(w=>{const C=w.el,M=C.style;ia(C,b),M.transform=M.webkitTransform=M.transitionDuration="";const L=C._moveCb=D=>{D&&D.target!==C||(!D||/transform$/.test(D.propertyName))&&(C.removeEventListener("transitionend",L),C._moveCb=null,Qa(C,b))};C.addEventListener("transitionend",L)})}),()=>{const b=Hn(t),o=_T(b);let w=b.tag||Rn;m=v,v=a.default?hy(a.default()):[];for(let C=0;C<v.length;C++){const M=v[C];M.key!=null&&of(M,rf(M,o,d,l))}if(m)for(let C=0;C<m.length;C++){const M=m[C];of(M,rf(M,o,d,l)),xT.set(M,M.el.getBoundingClientRect())}return O(w,null,v)}}},Gk=jk;function qk(t){const a=t.el;a._moveCb&&a._moveCb(),a._enterCb&&a._enterCb()}function Zk(t){bT.set(t,t.el.getBoundingClientRect())}function Wk(t){const a=xT.get(t),l=bT.get(t),d=a.left-l.left,m=a.top-l.top;if(d||m){const v=t.el.style;return v.transform=v.webkitTransform=`translate(${d}px,${m}px)`,v.transitionDuration="0s",t}}function Hk(t,a,l){const d=t.cloneNode();t._vtc&&t._vtc.forEach(b=>{b.split(/\s+/).forEach(o=>o&&d.classList.remove(o))}),l.split(/\s+/).forEach(b=>b&&d.classList.add(b)),d.style.display="none";const m=a.nodeType===1?a:a.parentNode;m.appendChild(d);const{hasTransform:v}=vT(d);return m.removeChild(d),v}const lb=t=>{const a=t.props["onUpdate:modelValue"]||!1;return xn(a)?l=>bm(a,l):a};function Xk(t){t.target.composing=!0}function cb(t){const a=t.target;a.composing&&(a.composing=!1,a.dispatchEvent(new Event("input")))}const Yk={created(t,{modifiers:{lazy:a,trim:l,number:d}},m){t._assign=lb(m);const v=d||m.props&&m.props.type==="number";Vu(t,a?"change":"input",b=>{if(b.target.composing)return;let o=t.value;l&&(o=o.trim()),v&&(o=Cm(o)),t._assign(o)}),l&&Vu(t,"change",()=>{t.value=t.value.trim()}),a||(Vu(t,"compositionstart",Xk),Vu(t,"compositionend",cb),Vu(t,"change",cb))},mounted(t,{value:a}){t.value=a==null?"":a},beforeUpdate(t,{value:a,modifiers:{lazy:l,trim:d,number:m}},v){if(t._assign=lb(v),t.composing||document.activeElement===t&&t.type!=="range"&&(l||d&&t.value.trim()===a||(m||t.type==="number")&&Cm(t.value)===a))return;const b=a==null?"":a;t.value!==b&&(t.value=b)}},Ls={beforeMount(t,{value:a},{transition:l}){t._vod=t.style.display==="none"?"":t.style.display,l&&a?l.beforeEnter(t):Rh(t,a)},mounted(t,{value:a},{transition:l}){l&&a&&l.enter(t)},updated(t,{value:a,oldValue:l},{transition:d}){!a!=!l&&(d?a?(d.beforeEnter(t),Rh(t,!0),d.enter(t)):d.leave(t,()=>{Rh(t,!1)}):Rh(t,a))},beforeUnmount(t,{value:a}){Rh(t,a)}};function Rh(t,a){t.style.display=a?t._vod:"none"}const Kk=Er({patchProp:Fk},Ek);let ub;function Jk(){return ub||(ub=nk(Kk))}const Qk=(...t)=>{const a=Jk().createApp(...t),{mount:l}=a;return a.mount=d=>{const m=eM(d);if(!m)return;const v=a._component;!Ln(v)&&!v.render&&!v.template&&(v.template=m.innerHTML),m.innerHTML="";const b=l(m,!1,m instanceof SVGElement);return m instanceof Element&&(m.removeAttribute("v-cloak"),m.setAttribute("data-v-app","")),b},a};function eM(t){return ir(t)?document.querySelector(t):t}/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const $u=typeof window<"u";function tM(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const vi=Object.assign;function G_(t,a){const l={};for(const d in a){const m=a[d];l[d]=Qo(m)?m.map(t):t(m)}return l}const Hh=()=>{},Qo=Array.isArray,nM=/\/$/,iM=t=>t.replace(nM,"");function q_(t,a,l="/"){let d,m={},v="",b="";const o=a.indexOf("#");let w=a.indexOf("?");return o<w&&o>=0&&(w=-1),w>-1&&(d=a.slice(0,w),v=a.slice(w+1,o>-1?o:a.length),m=t(v)),o>-1&&(d=d||a.slice(0,o),b=a.slice(o,a.length)),d=aM(d!=null?d:a,l),{fullPath:d+(v&&"?")+v+b,path:d,query:m,hash:b}}function rM(t,a){const l=a.query?t(a.query):"";return a.path+(l&&"?")+l+(a.hash||"")}function db(t,a){return!a||!t.toLowerCase().startsWith(a.toLowerCase())?t:t.slice(a.length)||"/"}function oM(t,a,l){const d=a.matched.length-1,m=l.matched.length-1;return d>-1&&d===m&&Xu(a.matched[d],l.matched[m])&&wT(a.params,l.params)&&t(a.query)===t(l.query)&&a.hash===l.hash}function Xu(t,a){return(t.aliasOf||t)===(a.aliasOf||a)}function wT(t,a){if(Object.keys(t).length!==Object.keys(a).length)return!1;for(const l in t)if(!sM(t[l],a[l]))return!1;return!0}function sM(t,a){return Qo(t)?hb(t,a):Qo(a)?hb(a,t):t===a}function hb(t,a){return Qo(a)?t.length===a.length&&t.every((l,d)=>l===a[d]):t.length===1&&t[0]===a}function aM(t,a){if(t.startsWith("/"))return t;if(!t)return a;const l=a.split("/"),d=t.split("/");let m=l.length-1,v,b;for(v=0;v<d.length;v++)if(b=d[v],b!==".")if(b==="..")m>1&&m--;else break;return l.slice(0,m).join("/")+"/"+d.slice(v-(v===d.length?1:0)).join("/")}var lf;(function(t){t.pop="pop",t.push="push"})(lf||(lf={}));var Xh;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Xh||(Xh={}));function lM(t){if(!t)if($u){const a=document.querySelector("base");t=a&&a.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),iM(t)}const cM=/^[^#]+#/;function uM(t,a){return t.replace(cM,"#")+a}function dM(t,a){const l=document.documentElement.getBoundingClientRect(),d=t.getBoundingClientRect();return{behavior:a.behavior,left:d.left-l.left-(a.left||0),top:d.top-l.top-(a.top||0)}}const tg=()=>({left:window.pageXOffset,top:window.pageYOffset});function hM(t){let a;if("el"in t){const l=t.el,d=typeof l=="string"&&l.startsWith("#"),m=typeof l=="string"?d?document.getElementById(l.slice(1)):document.querySelector(l):l;if(!m)return;a=dM(m,t)}else a=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(a):window.scrollTo(a.left!=null?a.left:window.pageXOffset,a.top!=null?a.top:window.pageYOffset)}function fb(t,a){return(history.state?history.state.position-a:-1)+t}const xv=new Map;function fM(t,a){xv.set(t,a)}function pM(t){const a=xv.get(t);return xv.delete(t),a}let mM=()=>location.protocol+"//"+location.host;function TT(t,a){const{pathname:l,search:d,hash:m}=a,v=t.indexOf("#");if(v>-1){let o=m.includes(t.slice(v))?t.slice(v).length:1,w=m.slice(o);return w[0]!=="/"&&(w="/"+w),db(w,"")}return db(l,t)+d+m}function gM(t,a,l,d){let m=[],v=[],b=null;const o=({state:D})=>{const V=TT(t,location),q=l.value,X=a.value;let xe=0;if(D){if(l.value=V,a.value=D,b&&b===q){b=null;return}xe=X?D.position-X.position:0}else d(V);m.forEach(ce=>{ce(l.value,q,{delta:xe,type:lf.pop,direction:xe?xe>0?Xh.forward:Xh.back:Xh.unknown})})};function w(){b=l.value}function C(D){m.push(D);const V=()=>{const q=m.indexOf(D);q>-1&&m.splice(q,1)};return v.push(V),V}function M(){const{history:D}=window;!D.state||D.replaceState(vi({},D.state,{scroll:tg()}),"")}function L(){for(const D of v)D();v=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",M)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",M),{pauseListeners:w,listen:C,destroy:L}}function pb(t,a,l,d=!1,m=!1){return{back:t,current:a,forward:l,replaced:d,position:window.history.length,scroll:m?tg():null}}function _M(t){const{history:a,location:l}=window,d={value:TT(t,l)},m={value:a.state};m.value||v(d.value,{back:null,current:d.value,forward:null,position:a.length-1,replaced:!0,scroll:null},!0);function v(w,C,M){const L=t.indexOf("#"),D=L>-1?(l.host&&document.querySelector("base")?t:t.slice(L))+w:mM()+t+w;try{a[M?"replaceState":"pushState"](C,"",D),m.value=C}catch(V){console.error(V),l[M?"replace":"assign"](D)}}function b(w,C){const M=vi({},a.state,pb(m.value.back,w,m.value.forward,!0),C,{position:m.value.position});v(w,M,!0),d.value=w}function o(w,C){const M=vi({},m.value,a.state,{forward:w,scroll:tg()});v(M.current,M,!0);const L=vi({},pb(d.value,w,null),{position:M.position+1},C);v(w,L,!1),d.value=w}return{location:d,state:m,push:o,replace:b}}function vM(t){t=lM(t);const a=_M(t),l=gM(t,a.state,a.location,a.replace);function d(v,b=!0){b||l.pauseListeners(),history.go(v)}const m=vi({location:"",base:t,go:d,createHref:uM.bind(null,t)},a,l);return Object.defineProperty(m,"location",{enumerable:!0,get:()=>a.location.value}),Object.defineProperty(m,"state",{enumerable:!0,get:()=>a.state.value}),m}function yM(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),vM(t)}function xM(t){return typeof t=="string"||t&&typeof t=="object"}function ST(t){return typeof t=="string"||typeof t=="symbol"}const Ja={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},ET=Symbol("");var mb;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(mb||(mb={}));function Yu(t,a){return vi(new Error,{type:t,[ET]:!0},a)}function na(t,a){return t instanceof Error&&ET in t&&(a==null||!!(t.type&a))}const gb="[^/]+?",bM={sensitive:!1,strict:!1,start:!0,end:!0},wM=/[.+*?^${}()[\]/\\]/g;function TM(t,a){const l=vi({},bM,a),d=[];let m=l.start?"^":"";const v=[];for(const C of t){const M=C.length?[]:[90];l.strict&&!C.length&&(m+="/");for(let L=0;L<C.length;L++){const D=C[L];let V=40+(l.sensitive?.25:0);if(D.type===0)L||(m+="/"),m+=D.value.replace(wM,"\\$&"),V+=40;else if(D.type===1){const{value:q,repeatable:X,optional:xe,regexp:ce}=D;v.push({name:q,repeatable:X,optional:xe});const me=ce||gb;if(me!==gb){V+=10;try{new RegExp(`(${me})`)}catch(Ie){throw new Error(`Invalid custom RegExp for param "${q}" (${me}): `+Ie.message)}}let ee=X?`((?:${me})(?:/(?:${me}))*)`:`(${me})`;L||(ee=xe&&C.length<2?`(?:/${ee})`:"/"+ee),xe&&(ee+="?"),m+=ee,V+=20,xe&&(V+=-8),X&&(V+=-20),me===".*"&&(V+=-50)}M.push(V)}d.push(M)}if(l.strict&&l.end){const C=d.length-1;d[C][d[C].length-1]+=.7000000000000001}l.strict||(m+="/?"),l.end?m+="$":l.strict&&(m+="(?:/|$)");const b=new RegExp(m,l.sensitive?"":"i");function o(C){const M=C.match(b),L={};if(!M)return null;for(let D=1;D<M.length;D++){const V=M[D]||"",q=v[D-1];L[q.name]=V&&q.repeatable?V.split("/"):V}return L}function w(C){let M="",L=!1;for(const D of t){(!L||!M.endsWith("/"))&&(M+="/"),L=!1;for(const V of D)if(V.type===0)M+=V.value;else if(V.type===1){const{value:q,repeatable:X,optional:xe}=V,ce=q in C?C[q]:"";if(Qo(ce)&&!X)throw new Error(`Provided param "${q}" is an array but it is not repeatable (* or + modifiers)`);const me=Qo(ce)?ce.join("/"):ce;if(!me)if(xe)D.length<2&&(M.endsWith("/")?M=M.slice(0,-1):L=!0);else throw new Error(`Missing required param "${q}"`);M+=me}}return M||"/"}return{re:b,score:d,keys:v,parse:o,stringify:w}}function SM(t,a){let l=0;for(;l<t.length&&l<a.length;){const d=a[l]-t[l];if(d)return d;l++}return t.length<a.length?t.length===1&&t[0]===40+40?-1:1:t.length>a.length?a.length===1&&a[0]===40+40?1:-1:0}function EM(t,a){let l=0;const d=t.score,m=a.score;for(;l<d.length&&l<m.length;){const v=SM(d[l],m[l]);if(v)return v;l++}if(Math.abs(m.length-d.length)===1){if(_b(d))return 1;if(_b(m))return-1}return m.length-d.length}function _b(t){const a=t[t.length-1];return t.length>0&&a[a.length-1]<0}const CM={type:0,value:""},IM=/[a-zA-Z0-9_]/;function AM(t){if(!t)return[[]];if(t==="/")return[[CM]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function a(V){throw new Error(`ERR (${l})/"${C}": ${V}`)}let l=0,d=l;const m=[];let v;function b(){v&&m.push(v),v=[]}let o=0,w,C="",M="";function L(){!C||(l===0?v.push({type:0,value:C}):l===1||l===2||l===3?(v.length>1&&(w==="*"||w==="+")&&a(`A repeatable param (${C}) must be alone in its segment. eg: '/:ids+.`),v.push({type:1,value:C,regexp:M,repeatable:w==="*"||w==="+",optional:w==="*"||w==="?"})):a("Invalid state to consume buffer"),C="")}function D(){C+=w}for(;o<t.length;){if(w=t[o++],w==="\\"&&l!==2){d=l,l=4;continue}switch(l){case 0:w==="/"?(C&&L(),b()):w===":"?(L(),l=1):D();break;case 4:D(),l=d;break;case 1:w==="("?l=2:IM.test(w)?D():(L(),l=0,w!=="*"&&w!=="?"&&w!=="+"&&o--);break;case 2:w===")"?M[M.length-1]=="\\"?M=M.slice(0,-1)+w:l=3:M+=w;break;case 3:L(),l=0,w!=="*"&&w!=="?"&&w!=="+"&&o--,M="";break;default:a("Unknown state");break}}return l===2&&a(`Unfinished custom RegExp for param "${C}"`),L(),b(),m}function kM(t,a,l){const d=TM(AM(t.path),l),m=vi(d,{record:t,parent:a,children:[],alias:[]});return a&&!m.record.aliasOf==!a.record.aliasOf&&a.children.push(m),m}function MM(t,a){const l=[],d=new Map;a=xb({strict:!1,end:!0,sensitive:!1},a);function m(M){return d.get(M)}function v(M,L,D){const V=!D,q=PM(M);q.aliasOf=D&&D.record;const X=xb(a,M),xe=[q];if("alias"in M){const ee=typeof M.alias=="string"?[M.alias]:M.alias;for(const Ie of ee)xe.push(vi({},q,{components:D?D.record.components:q.components,path:Ie,aliasOf:D?D.record:q}))}let ce,me;for(const ee of xe){const{path:Ie}=ee;if(L&&Ie[0]!=="/"){const Y=L.record.path,ve=Y[Y.length-1]==="/"?"":"/";ee.path=L.record.path+(Ie&&ve+Ie)}if(ce=kM(ee,L,X),D?D.alias.push(ce):(me=me||ce,me!==ce&&me.alias.push(ce),V&&M.name&&!yb(ce)&&b(M.name)),q.children){const Y=q.children;for(let ve=0;ve<Y.length;ve++)v(Y[ve],ce,D&&D.children[ve])}D=D||ce,(ce.record.components&&Object.keys(ce.record.components).length||ce.record.name||ce.record.redirect)&&w(ce)}return me?()=>{b(me)}:Hh}function b(M){if(ST(M)){const L=d.get(M);L&&(d.delete(M),l.splice(l.indexOf(L),1),L.children.forEach(b),L.alias.forEach(b))}else{const L=l.indexOf(M);L>-1&&(l.splice(L,1),M.record.name&&d.delete(M.record.name),M.children.forEach(b),M.alias.forEach(b))}}function o(){return l}function w(M){let L=0;for(;L<l.length&&EM(M,l[L])>=0&&(M.record.path!==l[L].record.path||!CT(M,l[L]));)L++;l.splice(L,0,M),M.record.name&&!yb(M)&&d.set(M.record.name,M)}function C(M,L){let D,V={},q,X;if("name"in M&&M.name){if(D=d.get(M.name),!D)throw Yu(1,{location:M});X=D.record.name,V=vi(vb(L.params,D.keys.filter(me=>!me.optional).map(me=>me.name)),M.params&&vb(M.params,D.keys.map(me=>me.name))),q=D.stringify(V)}else if("path"in M)q=M.path,D=l.find(me=>me.re.test(q)),D&&(V=D.parse(q),X=D.record.name);else{if(D=L.name?d.get(L.name):l.find(me=>me.re.test(L.path)),!D)throw Yu(1,{location:M,currentLocation:L});X=D.record.name,V=vi({},L.params,M.params),q=D.stringify(V)}const xe=[];let ce=D;for(;ce;)xe.unshift(ce.record),ce=ce.parent;return{name:X,path:q,params:V,matched:xe,meta:LM(xe)}}return t.forEach(M=>v(M)),{addRoute:v,resolve:C,removeRoute:b,getRoutes:o,getRecordMatcher:m}}function vb(t,a){const l={};for(const d of a)d in t&&(l[d]=t[d]);return l}function PM(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:zM(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function zM(t){const a={},l=t.props||!1;if("component"in t)a.default=l;else for(const d in t.components)a[d]=typeof l=="boolean"?l:l[d];return a}function yb(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function LM(t){return t.reduce((a,l)=>vi(a,l.meta),{})}function xb(t,a){const l={};for(const d in t)l[d]=d in a?a[d]:t[d];return l}function CT(t,a){return a.children.some(l=>l===t||CT(t,l))}const IT=/#/g,DM=/&/g,BM=/\//g,RM=/=/g,OM=/\?/g,AT=/\+/g,FM=/%5B/g,VM=/%5D/g,kT=/%5E/g,$M=/%60/g,MT=/%7B/g,NM=/%7C/g,PT=/%7D/g,UM=/%20/g;function wy(t){return encodeURI(""+t).replace(NM,"|").replace(FM,"[").replace(VM,"]")}function jM(t){return wy(t).replace(MT,"{").replace(PT,"}").replace(kT,"^")}function bv(t){return wy(t).replace(AT,"%2B").replace(UM,"+").replace(IT,"%23").replace(DM,"%26").replace($M,"`").replace(MT,"{").replace(PT,"}").replace(kT,"^")}function GM(t){return bv(t).replace(RM,"%3D")}function qM(t){return wy(t).replace(IT,"%23").replace(OM,"%3F")}function ZM(t){return t==null?"":qM(t).replace(BM,"%2F")}function zm(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function WM(t){const a={};if(t===""||t==="?")return a;const d=(t[0]==="?"?t.slice(1):t).split("&");for(let m=0;m<d.length;++m){const v=d[m].replace(AT," "),b=v.indexOf("="),o=zm(b<0?v:v.slice(0,b)),w=b<0?null:zm(v.slice(b+1));if(o in a){let C=a[o];Qo(C)||(C=a[o]=[C]),C.push(w)}else a[o]=w}return a}function bb(t){let a="";for(let l in t){const d=t[l];if(l=GM(l),d==null){d!==void 0&&(a+=(a.length?"&":"")+l);continue}(Qo(d)?d.map(v=>v&&bv(v)):[d&&bv(d)]).forEach(v=>{v!==void 0&&(a+=(a.length?"&":"")+l,v!=null&&(a+="="+v))})}return a}function HM(t){const a={};for(const l in t){const d=t[l];d!==void 0&&(a[l]=Qo(d)?d.map(m=>m==null?null:""+m):d==null?d:""+d)}return a}const XM=Symbol(""),wb=Symbol(""),ng=Symbol(""),zT=Symbol(""),wv=Symbol("");function Oh(){let t=[];function a(d){return t.push(d),()=>{const m=t.indexOf(d);m>-1&&t.splice(m,1)}}function l(){t=[]}return{add:a,list:()=>t,reset:l}}function tl(t,a,l,d,m){const v=d&&(d.enterCallbacks[m]=d.enterCallbacks[m]||[]);return()=>new Promise((b,o)=>{const w=L=>{L===!1?o(Yu(4,{from:l,to:a})):L instanceof Error?o(L):xM(L)?o(Yu(2,{from:a,to:L})):(v&&d.enterCallbacks[m]===v&&typeof L=="function"&&v.push(L),b())},C=t.call(d&&d.instances[m],a,l,w);let M=Promise.resolve(C);t.length<3&&(M=M.then(w)),M.catch(L=>o(L))})}function Z_(t,a,l,d){const m=[];for(const v of t)for(const b in v.components){let o=v.components[b];if(!(a!=="beforeRouteEnter"&&!v.instances[b]))if(YM(o)){const C=(o.__vccOpts||o)[a];C&&m.push(tl(C,l,d,v,b))}else{let w=o();m.push(()=>w.then(C=>{if(!C)return Promise.reject(new Error(`Couldn't resolve component "${b}" at "${v.path}"`));const M=tM(C)?C.default:C;v.components[b]=M;const D=(M.__vccOpts||M)[a];return D&&tl(D,l,d,v,b)()}))}}return m}function YM(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Tb(t){const a=ln(ng),l=ln(zT),d=ne(()=>a.resolve(Ui(t.to))),m=ne(()=>{const{matched:w}=d.value,{length:C}=w,M=w[C-1],L=l.matched;if(!M||!L.length)return-1;const D=L.findIndex(Xu.bind(null,M));if(D>-1)return D;const V=Sb(w[C-2]);return C>1&&Sb(M)===V&&L[L.length-1].path!==V?L.findIndex(Xu.bind(null,w[C-2])):D}),v=ne(()=>m.value>-1&&eP(l.params,d.value.params)),b=ne(()=>m.value>-1&&m.value===l.matched.length-1&&wT(l.params,d.value.params));function o(w={}){return QM(w)?a[Ui(t.replace)?"replace":"push"](Ui(t.to)).catch(Hh):Promise.resolve()}return{route:d,href:ne(()=>d.value.href),isActive:v,isExactActive:b,navigate:o}}const KM=vn({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Tb,setup(t,{slots:a}){const l=pi(Tb(t)),{options:d}=ln(ng),m=ne(()=>({[Eb(t.activeClass,d.linkActiveClass,"router-link-active")]:l.isActive,[Eb(t.exactActiveClass,d.linkExactActiveClass,"router-link-exact-active")]:l.isExactActive}));return()=>{const v=a.default&&a.default(l);return t.custom?v:zs("a",{"aria-current":l.isExactActive?t.ariaCurrentValue:null,href:l.href,onClick:l.navigate,class:m.value},v)}}}),JM=KM;function QM(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const a=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(a))return}return t.preventDefault&&t.preventDefault(),!0}}function eP(t,a){for(const l in a){const d=a[l],m=t[l];if(typeof d=="string"){if(d!==m)return!1}else if(!Qo(m)||m.length!==d.length||d.some((v,b)=>v!==m[b]))return!1}return!0}function Sb(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Eb=(t,a,l)=>t!=null?t:a!=null?a:l,tP=vn({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:a,slots:l}){const d=ln(wv),m=ne(()=>t.route||d.value),v=ln(wb,0),b=ne(()=>{let C=Ui(v);const{matched:M}=m.value;let L;for(;(L=M[C])&&!L.components;)C++;return C}),o=ne(()=>m.value.matched[b.value]);ji(wb,ne(()=>b.value+1)),ji(XM,o),ji(wv,m);const w=Je();return Ye(()=>[w.value,o.value,t.name],([C,M,L],[D,V,q])=>{M&&(M.instances[L]=C,V&&V!==M&&C&&C===D&&(M.leaveGuards.size||(M.leaveGuards=V.leaveGuards),M.updateGuards.size||(M.updateGuards=V.updateGuards))),C&&M&&(!V||!Xu(M,V)||!D)&&(M.enterCallbacks[L]||[]).forEach(X=>X(C))},{flush:"post"}),()=>{const C=m.value,M=t.name,L=o.value,D=L&&L.components[M];if(!D)return Cb(l.default,{Component:D,route:C});const V=L.props[M],q=V?V===!0?C.params:typeof V=="function"?V(C):V:null,xe=zs(D,vi({},q,a,{onVnodeUnmounted:ce=>{ce.component.isUnmounted&&(L.instances[M]=null)},ref:w}));return Cb(l.default,{Component:xe,route:C})||xe}}});function Cb(t,a){if(!t)return null;const l=t(a);return l.length===1?l[0]:l}const nP=tP;function iP(t){const a=MM(t.routes,t),l=t.parseQuery||WM,d=t.stringifyQuery||bb,m=t.history,v=Oh(),b=Oh(),o=Oh(),w=Si(Ja);let C=Ja;$u&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const M=G_.bind(null,Ke=>""+Ke),L=G_.bind(null,ZM),D=G_.bind(null,zm);function V(Ke,xt){let St,Nt;return ST(Ke)?(St=a.getRecordMatcher(Ke),Nt=xt):Nt=Ke,a.addRoute(Nt,St)}function q(Ke){const xt=a.getRecordMatcher(Ke);xt&&a.removeRoute(xt)}function X(){return a.getRoutes().map(Ke=>Ke.record)}function xe(Ke){return!!a.getRecordMatcher(Ke)}function ce(Ke,xt){if(xt=vi({},xt||w.value),typeof Ke=="string"){const ue=q_(l,Ke,xt.path),Me=a.resolve({path:ue.path},xt),qe=m.createHref(ue.fullPath);return vi(ue,Me,{params:D(Me.params),hash:zm(ue.hash),redirectedFrom:void 0,href:qe})}let St;if("path"in Ke)St=vi({},Ke,{path:q_(l,Ke.path,xt.path).path});else{const ue=vi({},Ke.params);for(const Me in ue)ue[Me]==null&&delete ue[Me];St=vi({},Ke,{params:L(Ke.params)}),xt.params=L(xt.params)}const Nt=a.resolve(St,xt),fn=Ke.hash||"";Nt.params=M(D(Nt.params));const Dn=rM(d,vi({},Ke,{hash:jM(fn),path:Nt.path})),gn=m.createHref(Dn);return vi({fullPath:Dn,hash:fn,query:d===bb?HM(Ke.query):Ke.query||{}},Nt,{redirectedFrom:void 0,href:gn})}function me(Ke){return typeof Ke=="string"?q_(l,Ke,w.value.path):vi({},Ke)}function ee(Ke,xt){if(C!==Ke)return Yu(8,{from:xt,to:Ke})}function Ie(Ke){return fe(Ke)}function Y(Ke){return Ie(vi(me(Ke),{replace:!0}))}function ve(Ke){const xt=Ke.matched[Ke.matched.length-1];if(xt&&xt.redirect){const{redirect:St}=xt;let Nt=typeof St=="function"?St(Ke):St;return typeof Nt=="string"&&(Nt=Nt.includes("?")||Nt.includes("#")?Nt=me(Nt):{path:Nt},Nt.params={}),vi({query:Ke.query,hash:Ke.hash,params:"path"in Nt?{}:Ke.params},Nt)}}function fe(Ke,xt){const St=C=ce(Ke),Nt=w.value,fn=Ke.state,Dn=Ke.force,gn=Ke.replace===!0,ue=ve(St);if(ue)return fe(vi(me(ue),{state:typeof ue=="object"?vi({},fn,ue.state):fn,force:Dn,replace:gn}),xt||St);const Me=St;Me.redirectedFrom=xt;let qe;return!Dn&&oM(d,Nt,St)&&(qe=Yu(16,{to:Me,from:Nt}),pt(Nt,Nt,!0,!1)),(qe?Promise.resolve(qe):Ee(Me,Nt)).catch(st=>na(st)?na(st,2)?st:jt(st):Pe(st,Me,Nt)).then(st=>{if(st){if(na(st,2))return fe(vi({replace:gn},me(st.to),{state:typeof st.to=="object"?vi({},fn,st.to.state):fn,force:Dn}),xt||Me)}else st=Oe(Me,Nt,!0,gn,fn);return we(Me,Nt,st),st})}function ge(Ke,xt){const St=ee(Ke,xt);return St?Promise.reject(St):Promise.resolve()}function Ee(Ke,xt){let St;const[Nt,fn,Dn]=rP(Ke,xt);St=Z_(Nt.reverse(),"beforeRouteLeave",Ke,xt);for(const ue of Nt)ue.leaveGuards.forEach(Me=>{St.push(tl(Me,Ke,xt))});const gn=ge.bind(null,Ke,xt);return St.push(gn),Du(St).then(()=>{St=[];for(const ue of v.list())St.push(tl(ue,Ke,xt));return St.push(gn),Du(St)}).then(()=>{St=Z_(fn,"beforeRouteUpdate",Ke,xt);for(const ue of fn)ue.updateGuards.forEach(Me=>{St.push(tl(Me,Ke,xt))});return St.push(gn),Du(St)}).then(()=>{St=[];for(const ue of Ke.matched)if(ue.beforeEnter&&!xt.matched.includes(ue))if(Qo(ue.beforeEnter))for(const Me of ue.beforeEnter)St.push(tl(Me,Ke,xt));else St.push(tl(ue.beforeEnter,Ke,xt));return St.push(gn),Du(St)}).then(()=>(Ke.matched.forEach(ue=>ue.enterCallbacks={}),St=Z_(Dn,"beforeRouteEnter",Ke,xt),St.push(gn),Du(St))).then(()=>{St=[];for(const ue of b.list())St.push(tl(ue,Ke,xt));return St.push(gn),Du(St)}).catch(ue=>na(ue,8)?ue:Promise.reject(ue))}function we(Ke,xt,St){for(const Nt of o.list())Nt(Ke,xt,St)}function Oe(Ke,xt,St,Nt,fn){const Dn=ee(Ke,xt);if(Dn)return Dn;const gn=xt===Ja,ue=$u?history.state:{};St&&(Nt||gn?m.replace(Ke.fullPath,vi({scroll:gn&&ue&&ue.scroll},fn)):m.push(Ke.fullPath,fn)),w.value=Ke,pt(Ke,xt,St,gn),jt()}let ze;function Qe(){ze||(ze=m.listen((Ke,xt,St)=>{if(!At.listening)return;const Nt=ce(Ke),fn=ve(Nt);if(fn){fe(vi(fn,{replace:!0}),Nt).catch(Hh);return}C=Nt;const Dn=w.value;$u&&fM(fb(Dn.fullPath,St.delta),tg()),Ee(Nt,Dn).catch(gn=>na(gn,12)?gn:na(gn,2)?(fe(gn.to,Nt).then(ue=>{na(ue,20)&&!St.delta&&St.type===lf.pop&&m.go(-1,!1)}).catch(Hh),Promise.reject()):(St.delta&&m.go(-St.delta,!1),Pe(gn,Nt,Dn))).then(gn=>{gn=gn||Oe(Nt,Dn,!1),gn&&(St.delta&&!na(gn,8)?m.go(-St.delta,!1):St.type===lf.pop&&na(gn,20)&&m.go(-1,!1)),we(Nt,Dn,gn)}).catch(Hh)}))}let ht=Oh(),nt=Oh(),ft;function Pe(Ke,xt,St){jt(Ke);const Nt=nt.list();return Nt.length?Nt.forEach(fn=>fn(Ke,xt,St)):console.error(Ke),Promise.reject(Ke)}function at(){return ft&&w.value!==Ja?Promise.resolve():new Promise((Ke,xt)=>{ht.add([Ke,xt])})}function jt(Ke){return ft||(ft=!Ke,Qe(),ht.list().forEach(([xt,St])=>Ke?St(Ke):xt()),ht.reset()),Ke}function pt(Ke,xt,St,Nt){const{scrollBehavior:fn}=t;if(!$u||!fn)return Promise.resolve();const Dn=!St&&pM(fb(Ke.fullPath,0))||(Nt||!St)&&history.state&&history.state.scroll||null;return Gi().then(()=>fn(Ke,xt,Dn)).then(gn=>gn&&hM(gn)).catch(gn=>Pe(gn,Ke,xt))}const zt=Ke=>m.go(Ke);let Gt;const zn=new Set,At={currentRoute:w,listening:!0,addRoute:V,removeRoute:q,hasRoute:xe,getRoutes:X,resolve:ce,options:t,push:Ie,replace:Y,go:zt,back:()=>zt(-1),forward:()=>zt(1),beforeEach:v.add,beforeResolve:b.add,afterEach:o.add,onError:nt.add,isReady:at,install(Ke){const xt=this;Ke.component("RouterLink",JM),Ke.component("RouterView",nP),Ke.config.globalProperties.$router=xt,Object.defineProperty(Ke.config.globalProperties,"$route",{enumerable:!0,get:()=>Ui(w)}),$u&&!Gt&&w.value===Ja&&(Gt=!0,Ie(m.location).catch(fn=>{}));const St={};for(const fn in Ja)St[fn]=ne(()=>w.value[fn]);Ke.provide(ng,xt),Ke.provide(zT,pi(St)),Ke.provide(wv,w);const Nt=Ke.unmount;zn.add(Ke),Ke.unmount=function(){zn.delete(Ke),zn.size<1&&(C=Ja,ze&&ze(),ze=null,w.value=Ja,Gt=!1,ft=!1),Nt()}}};return At}function Du(t){return t.reduce((a,l)=>a.then(()=>l()),Promise.resolve())}function rP(t,a){const l=[],d=[],m=[],v=Math.max(a.matched.length,t.matched.length);for(let b=0;b<v;b++){const o=a.matched[b];o&&(t.matched.find(C=>Xu(C,o))?d.push(o):l.push(o));const w=t.matched[b];w&&(a.matched.find(C=>Xu(C,w))||m.push(w))}return[l,d,m]}function Qu(){return ln(ng)}function Ib(t,a,l){oP(t,a),a.set(t,l)}function oP(t,a){if(a.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sP(t,a,l){var d=LT(t,a,"set");return aP(t,d,l),l}function aP(t,a,l){if(a.set)a.set.call(t,l);else{if(!a.writable)throw new TypeError("attempted to set read only private field");a.value=l}}function nc(t,a){var l=LT(t,a,"get");return lP(t,l)}function LT(t,a,l){if(!a.has(t))throw new TypeError("attempted to "+l+" private field on non-instance");return a.get(t)}function lP(t,a){return a.get?a.get.call(t):a.value}function DT(t,a,l){const d=a.length-1;if(d<0)return t===void 0?l:t;for(let m=0;m<d;m++){if(t==null)return l;t=t[a[m]]}return t==null||t[a[d]]===void 0?l:t[a[d]]}function yf(t,a){if(t===a)return!0;if(t instanceof Date&&a instanceof Date&&t.getTime()!==a.getTime()||t!==Object(t)||a!==Object(a))return!1;const l=Object.keys(t);return l.length!==Object.keys(a).length?!1:l.every(d=>yf(t[d],a[d]))}function Tv(t,a,l){return t==null||!a||typeof a!="string"?l:t[a]!==void 0?t[a]:(a=a.replace(/\[(\w+)\]/g,".$1"),a=a.replace(/^\./,""),DT(t,a.split("."),l))}function Is(t,a,l){if(a==null)return t===void 0?l:t;if(t!==Object(t))return l;if(typeof a=="string")return Tv(t,a,l);if(Array.isArray(a))return DT(t,a,l);if(typeof a!="function")return l;const d=a(t,l);return typeof d>"u"?l:d}function cc(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:t},(l,d)=>a+d)}function Xt(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(!(t==null||t===""))return isNaN(+t)?String(t):isFinite(+t)?`${Number(t)}${a}`:void 0}function Sv(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function cP(t){return t==null?void 0:t.$el}const Ab=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16}),Ev=Object.freeze({enter:"Enter",tab:"Tab",delete:"Delete",esc:"Escape",space:"Space",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",end:"End",home:"Home",del:"Delete",backspace:"Backspace",insert:"Insert",pageup:"PageUp",pagedown:"PageDown",shift:"Shift"});function BT(t){return Object.keys(t)}function Po(t,a){const l=Object.create(null),d=Object.create(null);for(const m in t)a.some(v=>v instanceof RegExp?v.test(m):v===m)?l[m]=t[m]:d[m]=t[m];return[l,d]}function ig(t,a){const l={...t};return a.forEach(d=>delete l[d]),l}function bc(t){return Po(t,["class","style","id",/^data-/])}function ko(t){return t==null?[]:Array.isArray(t)?t:[t]}function Co(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(a,Math.min(l,t))}function W_(t,a){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return t+l.repeat(Math.max(0,a-t.length))}function uP(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const l=[];let d=0;for(;d<t.length;)l.push(t.substr(d,a)),d+=a;return l}function kb(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;if(t<a)return`${t} B`;const l=a===1024?["Ki","Mi","Gi"]:["k","M","G"];let d=-1;for(;Math.abs(t)>=a&&d<l.length-1;)t/=a,++d;return`${t.toFixed(1)} ${l[d]}B`}function la(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0;const d={};for(const m in t)d[m]=t[m];for(const m in a){const v=t[m],b=a[m];if(Sv(v)&&Sv(b)){d[m]=la(v,b,l);continue}if(Array.isArray(v)&&Array.isArray(b)&&l){d[m]=l(v,b);continue}d[m]=b}return d}function RT(t){return t.map(a=>a.type===Rn?RT(a.children):a).flat()}function Ty(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"").replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase()}function Yh(t,a){if(!a||typeof a!="object")return[];if(Array.isArray(a))return a.map(l=>Yh(t,l)).flat(1);if(Array.isArray(a.children))return a.children.map(l=>Yh(t,l)).flat(1);if(a.component){if(Object.getOwnPropertySymbols(a.component.provides).includes(t))return[a.component];if(a.component.subTree)return Yh(t,a.component.subTree).flat(1)}return[]}var fm=new WeakMap,Bu=new WeakMap;class dP{constructor(a){Ib(this,fm,{writable:!0,value:[]}),Ib(this,Bu,{writable:!0,value:0}),this.size=a}push(a){nc(this,fm)[nc(this,Bu)]=a,sP(this,Bu,(nc(this,Bu)+1)%this.size)}values(){return nc(this,fm).slice(nc(this,Bu)).concat(nc(this,fm).slice(0,nc(this,Bu)))}}function hP(t){return"touches"in t?{clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}:{clientX:t.clientX,clientY:t.clientY}}function Sy(t){const a=pi({}),l=ne(t);return Ms(()=>{for(const d in l.value)a[d]=l.value[d]},{flush:"sync"}),ly(a)}function Lm(t,a){return t.includes(a)}const fP=/^on[^a-z]/,OT=t=>fP.test(t),Kh=[Function,Array];function Dm(t){for(var a=arguments.length,l=new Array(a>1?a-1:0),d=1;d<a;d++)l[d-1]=arguments[d];if(Array.isArray(t))for(const m of t)m(...l);else typeof t=="function"&&t(...l)}const FT=["top","bottom"],pP=["start","end","left","right"];function Cv(t,a){let[l,d]=t.split(" ");return d||(d=Lm(FT,l)?"start":Lm(pP,l)?"top":"center"),{side:Iv(l,a),align:Iv(d,a)}}function Iv(t,a){return t==="start"?a?"right":"left":t==="end"?a?"left":"right":t}function H_(t){return{side:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[t.side],align:t.align}}function X_(t){return{side:t.side,align:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[t.align]}}function Mb(t){return{side:t.align,align:t.side}}function Pb(t){return Lm(FT,t.side)?"y":"x"}class Zu{constructor(a){let{x:l,y:d,width:m,height:v}=a;this.x=l,this.y=d,this.width=m,this.height=v}get top(){return this.y}get bottom(){return this.y+this.height}get left(){return this.x}get right(){return this.x+this.width}}function zb(t,a){return{x:{before:Math.max(0,a.left-t.left),after:Math.max(0,t.right-a.right)},y:{before:Math.max(0,a.top-t.top),after:Math.max(0,t.bottom-a.bottom)}}}function Ey(t){const a=t.getBoundingClientRect(),l=getComputedStyle(t),d=l.transform;if(d){let m,v,b,o,w;if(d.startsWith("matrix3d("))m=d.slice(9,-1).split(/, /),v=+m[0],b=+m[5],o=+m[12],w=+m[13];else if(d.startsWith("matrix("))m=d.slice(7,-1).split(/, /),v=+m[0],b=+m[3],o=+m[4],w=+m[5];else return new Zu(a);const C=l.transformOrigin,M=a.x-o-(1-v)*parseFloat(C),L=a.y-w-(1-b)*parseFloat(C.slice(C.indexOf(" ")+1)),D=v?a.width/v:t.offsetWidth+1,V=b?a.height/b:t.offsetHeight+1;return new Zu({x:M,y:L,width:D,height:V})}else return new Zu(a)}function uc(t,a,l){if(typeof t.animate>"u")return{finished:Promise.resolve()};const d=t.animate(a,l);return typeof d.finished>"u"&&(d.finished=new Promise(m=>{d.onfinish=()=>{m(d)}})),d}function VT(t,a,l){if(l&&(a={_isVue:!0,$parent:l,$options:a}),a){if(a.$_alreadyWarned=a.$_alreadyWarned||[],a.$_alreadyWarned.includes(t))return;a.$_alreadyWarned.push(t)}return`[Vuetify] ${t}`+(a?_P(a):"")}function mc(t,a,l){const d=VT(t,a,l);d!=null&&console.warn(d)}function Av(t,a,l){const d=VT(t,a,l);d!=null&&console.error(d)}const mP=/(?:^|[-_])(\w)/g,gP=t=>t.replace(mP,a=>a.toUpperCase()).replace(/[-_]/g,"");function Y_(t,a){if(t.$root===t)return"<Root>";const l=typeof t=="function"&&t.cid!=null?t.options:t._isVue?t.$options||t.constructor.options:t||{};let d=l.name||l._componentTag;const m=l.__file;if(!d&&m){const v=m.match(/([^/\\]+)\.vue$/);d=v==null?void 0:v[1]}return(d?`<${gP(d)}>`:"<Anonymous>")+(m&&a!==!1?` at ${m}`:"")}function _P(t){if(t._isVue&&t.$parent){const a=[];let l=0;for(;t;){if(a.length>0){const d=a[a.length-1];if(d.constructor===t.constructor){l++,t=t.$parent;continue}else l>0&&(a[a.length-1]=[d,l],l=0)}a.push(t),t=t.$parent}return`

found in

`+a.map((d,m)=>`${m===0?"---> ":" ".repeat(5+m*2)}${Array.isArray(d)?`${Y_(d[0])}... (${d[1]} recursive calls)`:Y_(d)}`).join(`
`)}else return`

(found in ${Y_(t)})`}const vP=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],yP=t=>t<=.0031308?t*12.92:1.055*t**(1/2.4)-.055,xP=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],bP=t=>t<=.04045?t/12.92:((t+.055)/1.055)**2.4;function $T(t){const a=Array(3),l=yP,d=vP;for(let m=0;m<3;++m)a[m]=Math.round(Co(l(d[m][0]*t[0]+d[m][1]*t[1]+d[m][2]*t[2]))*255);return(a[0]<<16)+(a[1]<<8)+(a[2]<<0)}function Cy(t){const a=[0,0,0],l=bP,d=xP,m=l((t>>16&255)/255),v=l((t>>8&255)/255),b=l((t>>0&255)/255);for(let o=0;o<3;++o)a[o]=d[o][0]*m+d[o][1]*v+d[o][2]*b;return a}const Bm=.20689655172413793,wP=t=>t>Bm**3?Math.cbrt(t):t/(3*Bm**2)+4/29,TP=t=>t>Bm?t**3:3*Bm**2*(t-4/29);function NT(t){const a=wP,l=a(t[1]);return[116*l-16,500*(a(t[0]/.95047)-l),200*(l-a(t[2]/1.08883))]}function UT(t){const a=TP,l=(t[0]+16)/116;return[a(l+t[1]/500)*.95047,a(l),a(l-t[2]/200)*1.08883]}function Lb(t){return!!t&&/^(#|var\(--|(rgb|hsl)a?\()/.test(t)}function Rm(t){let a;if(typeof t=="number")a=t;else if(typeof t=="string"){let l=t.startsWith("#")?t.substring(1):t;l.length===3&&(l=l.split("").map(d=>d+d).join("")),l.length!==6&&l.length!==8&&mc(`'${t}' is not a valid rgb color`),a=parseInt(l,16)}else throw new TypeError(`Colors can only be numbers or strings, recieved ${t==null?t:t.constructor.name} instead`);return a<0?(mc(`Colors cannot be negative: '${t}'`),a=0):(a>4294967295||isNaN(a))&&(mc(`'${t}' is not a valid rgb color`),a=16777215),a}function SP(t){let a=t.toString(16);return a.length<6&&(a="0".repeat(6-a.length)+a),"#"+a}function rg(t){const{h:a,s:l,v:d,a:m}=t,v=o=>{const w=(o+a/60)%6;return d-d*l*Math.max(Math.min(w,4-w,1),0)},b=[v(5),v(3),v(1)].map(o=>Math.round(o*255));return{r:b[0],g:b[1],b:b[2],a:m}}function Iy(t){if(!t)return{h:0,s:1,v:1,a:1};const a=t.r/255,l=t.g/255,d=t.b/255,m=Math.max(a,l,d),v=Math.min(a,l,d);let b=0;m!==v&&(m===a?b=60*(0+(l-d)/(m-v)):m===l?b=60*(2+(d-a)/(m-v)):m===d&&(b=60*(4+(a-l)/(m-v)))),b<0&&(b=b+360);const o=m===0?0:(m-v)/m,w=[b,o,m];return{h:w[0],s:w[1],v:w[2],a:t.a}}function jT(t){const{h:a,s:l,v:d,a:m}=t,v=d-d*l/2,b=v===1||v===0?0:(d-v)/Math.min(v,1-v);return{h:a,s:b,l:v,a:m}}function GT(t){const{h:a,s:l,l:d,a:m}=t,v=d+l*Math.min(d,1-d),b=v===0?0:2-2*d/v;return{h:a,s:b,v,a:m}}function EP(t){return`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`}function qT(t){return EP(rg(t))}function CP(t){const a=l=>{const d=Math.round(l).toString(16);return("00".substr(0,2-d.length)+d).toUpperCase()};return`#${[a(t.r),a(t.g),a(t.b),a(Math.round(t.a*255))].join("")}`}function IP(t){const a=uP(t.slice(1),2).map(l=>parseInt(l,16));return{r:a[0],g:a[1],b:a[2],a:Math.round(a[3]/255*100)/100}}function ZT(t){const a=IP(t);return Iy(a)}function WT(t){return CP(rg(t))}function AP(t){return t.startsWith("#")&&(t=t.slice(1)),t=t.replace(/([^0-9a-f])/gi,"F"),(t.length===3||t.length===4)&&(t=t.split("").map(a=>a+a).join("")),t.length===6?t=W_(t,8,"F"):t=W_(W_(t,6),8,"F"),`#${t}`.toUpperCase().substr(0,9)}function HT(t){const a=Rm(t);return{r:(a&16711680)>>16,g:(a&65280)>>8,b:a&255}}function kP(t,a){const l=NT(Cy(t));return l[0]=l[0]+a*10,$T(UT(l))}function MP(t,a){const l=NT(Cy(t));return l[0]=l[0]-a*10,$T(UT(l))}function kv(t){const a=Rm(t);return Cy(a)[1]}function PP(t,a){const l=kv(t),d=kv(a),m=Math.max(l,d),v=Math.min(l,d);return(m+.05)/(v+.05)}function kr(t,a){const l=Qm();if(!l)throw new Error(`[Vuetify] ${t} ${a||"must be called from inside a setup function"}`);return l}function ua(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const a=kr(t).type;return Ty((a==null?void 0:a.aliasName)||(a==null?void 0:a.name))}let XT=0,Tm=new WeakMap;function Ur(){const t=kr("getUid");if(Tm.has(t))return Tm.get(t);{const a=XT++;return Tm.set(t,a),a}}Ur.reset=()=>{XT=0,Tm=new WeakMap};function zP(t){const{provides:a}=kr("injectSelf");if(a&&t in a)return a[t]}const cf=Symbol.for("vuetify:defaults");function LP(t){return Je(t!=null?t:{})}function YT(){const t=ln(cf);if(!t)throw new Error("[Vuetify] Could not find defaults instance");return t}function rr(t,a){const l=YT(),d=Je(t),m=ne(()=>{const v=Ui(a==null?void 0:a.scoped),b=Ui(a==null?void 0:a.reset),o=Ui(a==null?void 0:a.root);let w=la(d.value,{prev:l.value});if(v)return w;if(b||o){const C=Number(b||1/0);for(let M=0;M<=C&&w.prev;M++)w=w.prev;return w}return la(w.prev,w)});return ji(cf,m),m}function Mn(t,a){return l=>Object.keys(t).reduce((d,m)=>{const b=typeof t[m]=="object"&&t[m]!=null&&!Array.isArray(t[m])?t[m]:{type:t[m]};return l&&m in l?d[m]={...b,default:l[m]}:d[m]=b,a&&!d[m].source&&(d[m].source=a),d},{})}function DP(t,a){var l,d;return((l=t.props)==null?void 0:l.hasOwnProperty(a))||((d=t.props)==null?void 0:d.hasOwnProperty(Ty(a)))}const Pt=function(a){var l,d;return a._setup=(l=a._setup)!=null?l:a.setup,a.name?(a._setup&&(a.props=(d=a.props)!=null?d:{},a.props=Mn(a.props,a.name)(),a.props._as=String,a.setup=function(v,b){const o=Qm(),w=YT(),C=Si(),M=Pw({...Hn(v)});Ms(()=>{var X,xe,ce;const V=w.value.global,q=w.value[(X=v._as)!=null?X:a.name];if(q){const me=Object.entries(q).filter(ee=>{let[Ie]=ee;return Ie.startsWith("V")});me.length&&(C.value=Object.fromEntries(me))}for(const me of Object.keys(v)){let ee=v[me];DP(o.vnode,me)||(ee=(ce=(xe=q==null?void 0:q[me])!=null?xe:V==null?void 0:V[me])!=null?ce:v[me]),M[me]!==ee&&(M[me]=ee)}});const L=a._setup(M,b);let D;return Ye(C,(V,q)=>{!V&&D?D.stop():V&&!q&&(D=_f(),D.run(()=>{var xe;var X;rr(la((xe=(X=zP(cf))==null?void 0:X.value)!=null?xe:{},V))}))},{immediate:!0}),L}),a):(mc("The component is missing an explicit name, unable to generate default prop value"),a)};function Mi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return a=>(t?Pt:vn)(a)}function zo(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",l=arguments.length>2?arguments[2]:void 0;return Pt({name:l!=null?l:ol(Mo(t.replace(/__/g,"-"))),props:{tag:{type:String,default:a}},setup(d,m){let{slots:v}=m;return()=>{var b;return zs(d.tag,{class:t},(b=v.default)==null?void 0:b.call(v))}}})}function KT(t){if(typeof t.getRootNode!="function"){for(;t.parentNode;)t=t.parentNode;return t!==document?null:document}const a=t.getRootNode();return a!==document&&a.getRootNode({composed:!0})!==document?null:a}const uf="cubic-bezier(0.4, 0, 0.2, 1)",BP="cubic-bezier(0.0, 0, 0.2, 1)",RP="cubic-bezier(0.4, 0, 1, 1)";function JT(t){for(;t;){if(Ay(t))return t;t=t.parentElement}return document.scrollingElement}function Om(t,a){const l=[];if(a&&t&&!a.contains(t))return l;for(;t&&(Ay(t)&&l.push(t),t!==a);)t=t.parentElement;return l}function Ay(t){if(!t||t.nodeType!==Node.ELEMENT_NODE)return!1;const a=window.getComputedStyle(t);return a.overflowY==="scroll"||a.overflowY==="auto"&&t.scrollHeight>t.clientHeight}const ki=typeof window<"u",ky=ki&&"IntersectionObserver"in window,OP=ki&&("ontouchstart"in window||window.navigator.maxTouchPoints>0),Mv=ki&&typeof CSS<"u"&&CSS.supports("selector(:focus-visible)");function FP(t){for(;t;){if(window.getComputedStyle(t).position==="fixed")return!0;t=t.offsetParent}return!1}function kt(t){const a=kr("useRender");a.render=t}const fo=Mn({border:[Boolean,Number,String]},"border");function Lo(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ua();return{borderClasses:ne(()=>{const d=Bi(t)?t.value:t.border,m=[];if(d===!0||d==="")m.push(`${a}--border`);else if(typeof d=="string"||d===0)for(const v of String(d).split(" "))m.push(`border-${v}`);return m})}}const VP=[null,"default","comfortable","compact"],gr=Mn({density:{type:String,default:"default",validator:t=>VP.includes(t)}},"density");function jr(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ua();return{densityClasses:ne(()=>`${a}--density-${t.density}`)}}const sr=Mn({elevation:{type:[Number,String],validator(t){const a=parseInt(t);return!isNaN(a)&&a>=0&&a<=24}}},"elevation");function Mr(t){return{elevationClasses:ne(()=>{const l=Bi(t)?t.value:t.elevation,d=[];return l==null||d.push(`elevation-${l}`),d})}}function df(t,a){let l;Ye(t,d=>{if(d&&!l)l=_f(),l.run(a);else{var m;(m=l)==null||m.stop(),l=void 0}},{immediate:!0})}function Tn(t,a,l){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:L=>L,m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:L=>L;const v=kr("useProxiedModel"),b=Je(t[a]!==void 0?t[a]:l),o=Ty(a),C=ne(o!==a?()=>{var L,D,V,q;return t[a],!!(((L=v.vnode.props)!=null&&L.hasOwnProperty(a)||(D=v.vnode.props)!=null&&D.hasOwnProperty(o))&&((V=v.vnode.props)!=null&&V.hasOwnProperty(`onUpdate:${a}`)||(q=v.vnode.props)!=null&&q.hasOwnProperty(`onUpdate:${o}`)))}:()=>{var L,D;return t[a],!!((L=v.vnode.props)!=null&&L.hasOwnProperty(a)&&(D=v.vnode.props)!=null&&D.hasOwnProperty(`onUpdate:${a}`))});df(()=>!C.value,()=>{Ye(()=>t[a],L=>{b.value=L})});const M=ne({get(){return d(C.value?t[a]:b.value)},set(L){const D=m(L);(C.value?t[a]:b.value)===D||d(C.value?t[a]:b.value)===L||(b.value=D,v==null||v.emit(`update:${a}`,D))}});return Object.defineProperty(M,"externalValue",{get:()=>C.value?t[a]:b.value}),M}const ed=Mn({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),wc=Mn({value:null,disabled:Boolean,selectedClass:String},"group-item");function td(t,a){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const d=kr("useGroupItem");if(!d)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const m=Ur();ji(Symbol.for(`${a.description}:id`),m);const v=ln(a,null);if(!v){if(!l)return v;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${a.description}`)}const b=Tt(t,"value"),o=ne(()=>v.disabled.value||t.disabled);v.register({id:m,value:b,disabled:o},d),Ei(()=>{v.unregister(m)});const w=ne(()=>v.isSelected(m)),C=ne(()=>w.value&&[v.selectedClass.value,t.selectedClass]);return Ye(w,M=>{d.emit("group:selected",{value:M})}),{id:m,isSelected:w,toggle:()=>v.select(m,!w.value),select:M=>v.select(m,M),selectedClass:C,value:b,disabled:o,group:v}}function Tc(t,a){let l=!1;const d=pi([]),m=Tn(t,"modelValue",[],D=>D==null?[]:QT(d,ko(D)),D=>{const V=NP(d,D);return t.multiple?V:V[0]}),v=kr("useGroup");function b(D,V){const q=D,X=Symbol.for(`${a.description}:id`),ce=Yh(X,v==null?void 0:v.vnode).indexOf(V);ce>-1?d.splice(ce,0,q):d.push(q)}function o(D){if(l)return;w();const V=d.findIndex(q=>q.id===D);d.splice(V,1)}function w(){const D=d.find(V=>!V.disabled);D&&t.mandatory==="force"&&!m.value.length&&(m.value=[D.id])}On(()=>{w()}),Ei(()=>{l=!0});function C(D,V){const q=d.find(X=>X.id===D);if(!(V&&q!=null&&q.disabled))if(t.multiple){const X=m.value.slice(),xe=X.findIndex(me=>me===D),ce=~xe;if(V=V!=null?V:!ce,ce&&t.mandatory&&X.length<=1||!ce&&t.max!=null&&X.length+1>t.max)return;xe<0&&V?X.push(D):xe>=0&&!V&&X.splice(xe,1),m.value=X}else{const X=m.value.includes(D);if(t.mandatory&&X)return;m.value=(V!=null?V:!X)?[D]:[]}}function M(D){if(t.multiple&&mc('This method is not supported when using "multiple" prop'),m.value.length){const V=m.value[0],q=d.findIndex(ce=>ce.id===V);let X=(q+D)%d.length,xe=d[X];for(;xe.disabled&&X!==q;)X=(X+D)%d.length,xe=d[X];if(xe.disabled)return;m.value=[d[X].id]}else{const V=d.find(q=>!q.disabled);V&&(m.value=[V.id])}}const L={register:b,unregister:o,selected:m,select:C,disabled:Tt(t,"disabled"),prev:()=>M(d.length-1),next:()=>M(1),isSelected:D=>m.value.includes(D),selectedClass:ne(()=>t.selectedClass),items:ne(()=>d),getItemIndex:D=>$P(d,D)};return ji(a,L),L}function $P(t,a){const l=QT(t,[a]);return l.length?t.findIndex(d=>d.id===l[0]):-1}function QT(t,a){const l=[];for(let d=0;d<t.length;d++){const m=t[d];m.value!=null?a.find(v=>yf(v,m.value))!=null&&l.push(m.id):a.includes(d)&&l.push(m.id)}return l}function NP(t,a){const l=[];for(let d=0;d<t.length;d++){const m=t[d];a.includes(m.id)&&l.push(m.value!=null?m.value:d)}return l}function gc(t){const a=Je(),l=Je();if(ki){const d=new ResizeObserver(m=>{t==null||t(m,d),m.length&&(l.value=m[0].contentRect)});Ei(()=>{d.disconnect()}),Ye(a,(m,v)=>{v&&(d.unobserve(v),l.value=void 0),m&&d.observe(m)},{flush:"post"})}return{resizeRef:a,contentRect:vf(l)}}const Fm=Symbol.for("vuetify:layout"),e2=Symbol.for("vuetify:layout-item"),Db=1e3,t2=Mn({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),nd=Mn({name:{type:String},order:{type:[Number,String],default:0},absolute:Boolean},"layout-item");function UP(){const t=ln(Fm);if(!t)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:t.getLayoutItem,mainRect:t.mainRect,mainStyles:t.mainStyles}}function id(t){var o;const a=ln(Fm);if(!a)throw new Error("[Vuetify] Could not find injected layout");const l=(o=t.id)!=null?o:`layout-item-${Ur()}`,d=kr("useLayoutItem");ji(e2,{id:l});const m=Je(!1);Kw(()=>m.value=!0),Yw(()=>m.value=!1);const{layoutItemStyles:v,layoutItemScrimStyles:b}=a.register(d,{...t,active:ne(()=>m.value?!1:t.active.value),id:l});return Ei(()=>a.unregister(l)),{layoutItemStyles:v,layoutRect:a.layoutRect,layoutItemScrimStyles:b}}const jP=(t,a,l,d)=>{let m={top:0,left:0,right:0,bottom:0};const v=[{id:"",layer:{...m}}];for(const b of t){const o=a.get(b),w=l.get(b),C=d.get(b);if(!o||!w||!C)continue;const M={...m,[o.value]:parseInt(m[o.value],10)+(C.value?parseInt(w.value,10):0)};v.push({id:b,layer:M}),m=M}return v};function n2(t){const a=ln(Fm,null),l=ne(()=>a?a.rootZIndex.value-100:Db),d=Je([]),m=pi(new Map),v=pi(new Map),b=pi(new Map),o=pi(new Map),w=pi(new Map),{resizeRef:C,contentRect:M}=gc(),L=ne(()=>{var ge;const ve=new Map,fe=(ge=t.overlaps)!=null?ge:[];for(const Ee of fe.filter(we=>we.includes(":"))){const[we,Oe]=Ee.split(":");if(!d.value.includes(we)||!d.value.includes(Oe))continue;const ze=m.get(we),Qe=m.get(Oe),ht=v.get(we),nt=v.get(Oe);!ze||!Qe||!ht||!nt||(ve.set(Oe,{position:ze.value,amount:parseInt(ht.value,10)}),ve.set(we,{position:Qe.value,amount:-parseInt(nt.value,10)}))}return ve}),D=ne(()=>{const ve=[...new Set([...b.values()].map(ge=>ge.value))].sort((ge,Ee)=>ge-Ee),fe=[];for(const ge of ve){const Ee=d.value.filter(we=>{var Oe;return((Oe=b.get(we))==null?void 0:Oe.value)===ge});fe.push(...Ee)}return jP(fe,m,v,o)}),V=ne(()=>!Array.from(w.values()).some(ve=>ve.value)),q=ne(()=>D.value[D.value.length-1].layer),X=ne(()=>({"--v-layout-left":Xt(q.value.left),"--v-layout-right":Xt(q.value.right),"--v-layout-top":Xt(q.value.top),"--v-layout-bottom":Xt(q.value.bottom),...V.value?void 0:{transition:"none"}})),xe=ne(()=>D.value.slice(1).map((ve,fe)=>{let{id:ge}=ve;const{layer:Ee}=D.value[fe],we=v.get(ge),Oe=m.get(ge);return{id:ge,...Ee,size:Number(we.value),position:Oe.value}})),ce=ve=>xe.value.find(fe=>fe.id===ve),me=kr("createLayout"),ee=Je(!1);On(()=>{ee.value=!0}),ji(Fm,{register:(ve,fe)=>{let{id:ge,order:Ee,position:we,layoutSize:Oe,elementSize:ze,active:Qe,disableTransitions:ht,absolute:nt}=fe;b.set(ge,Ee),m.set(ge,we),v.set(ge,Oe),o.set(ge,Qe),ht&&w.set(ge,ht);const Pe=Yh(e2,me==null?void 0:me.vnode).indexOf(ve);Pe>-1?d.value.splice(Pe,0,ge):d.value.push(ge);const at=ne(()=>xe.value.findIndex(Gt=>Gt.id===ge)),jt=ne(()=>l.value+D.value.length*2-at.value*2),pt=ne(()=>{const Gt=we.value==="left"||we.value==="right",zn=we.value==="right",At=we.value==="bottom",Ke={[we.value]:0,zIndex:jt.value,transform:`translate${Gt?"X":"Y"}(${(Qe.value?0:-110)*(zn||At?-1:1)}%)`,position:nt.value||l.value!==Db?"absolute":"fixed",...V.value?void 0:{transition:"none"}};if(!ee.value)return Ke;const xt=xe.value[at.value];if(!xt)throw new Error(`[Vuetify] Could not find layout item "${ge}"`);const St=L.value.get(ge);return St&&(xt[St.position]+=St.amount),{...Ke,height:Gt?`calc(100% - ${xt.top}px - ${xt.bottom}px)`:ze.value?`${ze.value}px`:void 0,left:zn?void 0:`${xt.left}px`,right:zn?`${xt.right}px`:void 0,top:we.value!=="bottom"?`${xt.top}px`:void 0,bottom:we.value!=="top"?`${xt.bottom}px`:void 0,width:Gt?ze.value?`${ze.value}px`:void 0:`calc(100% - ${xt.left}px - ${xt.right}px)`}}),zt=ne(()=>({zIndex:jt.value-1}));return{layoutItemStyles:pt,layoutItemScrimStyles:zt,zIndex:jt}},unregister:ve=>{b.delete(ve),m.delete(ve),v.delete(ve),o.delete(ve),w.delete(ve),d.value=d.value.filter(fe=>fe!==ve)},mainRect:q,mainStyles:X,getLayoutItem:ce,items:xe,layoutRect:M,rootZIndex:l});const Ie=ne(()=>["v-layout",{"v-layout--full-height":t.fullHeight}]),Y=ne(()=>({zIndex:l.value,position:a?"relative":void 0,overflow:a?"hidden":void 0}));return{layoutClasses:Ie,layoutStyles:Y,getLayoutItem:ce,items:xe,layoutRect:M,layoutRef:C}}const Pi=Mn({rounded:{type:[Boolean,Number,String],default:void 0}},"rounded");function Ki(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ua();return{roundedClasses:ne(()=>{const d=Bi(t)?t.value:t.rounded,m=[];if(d===!0||d==="")m.push(`${a}--rounded`);else if(typeof d=="string"||d===0)for(const v of String(d).split(" "))m.push(`rounded-${v}`);return m})}}const Sn=Mn({tag:{type:String,default:"div"}},"tag"),Ru=2.4,Bb=.2126729,Rb=.7151522,Ob=.072175,GP=.55,qP=.58,ZP=.57,WP=.62,pm=.03,Fb=1.45,HP=5e-4,XP=1.25,YP=1.25,Vb=.078,$b=12.82051282051282,mm=.06,Nb=.001;function Ub(t,a){const l=((t>>16&255)/255)**Ru,d=((t>>8&255)/255)**Ru,m=((t>>0&255)/255)**Ru,v=((a>>16&255)/255)**Ru,b=((a>>8&255)/255)**Ru,o=((a>>0&255)/255)**Ru;let w=l*Bb+d*Rb+m*Ob,C=v*Bb+b*Rb+o*Ob;if(w<=pm&&(w+=(pm-w)**Fb),C<=pm&&(C+=(pm-C)**Fb),Math.abs(C-w)<HP)return 0;let M;if(C>w){const L=(C**GP-w**qP)*XP;M=L<Nb?0:L<Vb?L-L*$b*mm:L-mm}else{const L=(C**WP-w**ZP)*YP;M=L>-Nb?0:L>-Vb?L-L*$b*mm:L+mm}return M*100}const hf=Symbol.for("vuetify:theme"),Xn=Mn({theme:String},"theme"),Fh={defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#6200EE","primary-darken-1":"#3700B3",secondary:"#03DAC6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-variant":"#BDBDBD","on-surface-variant":"#424242",primary:"#BB86FC","primary-darken-1":"#3700B3",secondary:"#03DAC5","secondary-darken-1":"#03DAC5",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}};function KP(){var m;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fh;if(!t)return{...Fh,isDisabled:!0};const a={};for(const[v,b]of Object.entries((m=t.themes)!=null?m:{})){var l,d;const o=b.dark||v==="dark"?(l=Fh.themes)==null?void 0:l.dark:(d=Fh.themes)==null?void 0:d.light;a[v]=la(o,b)}return la(Fh,{...t,themes:a})}function JP(t){const a=pi(KP(t)),l=Je(a.defaultTheme),d=Je(a.themes),m=ne(()=>{const C={};for(const[M,L]of Object.entries(d.value)){const D=C[M]={...L,colors:{...L.colors}};if(a.variations)for(const V of a.variations.colors){const q=D.colors[V];if(!!q)for(const X of["lighten","darken"]){const xe=X==="lighten"?kP:MP;for(const ce of cc(a.variations[X],1))D.colors[`${V}-${X}-${ce}`]=SP(xe(Rm(q),ce))}}for(const V of Object.keys(D.colors)){if(/^on-[a-z]/.test(V)||D.colors[`on-${V}`])continue;const q=`on-${V}`,X=Rm(D.colors[V]),xe=Math.abs(Ub(0,X)),ce=Math.abs(Ub(16777215,X));D.colors[q]=ce>Math.min(xe,50)?"#fff":"#000"}}return C}),v=ne(()=>m.value[l.value]),b=ne(()=>{const C=[];v.value.dark&&Ou(C,":root",["color-scheme: dark"]);for(const[V,q]of Object.entries(m.value)){const{variables:X,dark:xe}=q;Ou(C,`.v-theme--${V}`,[`color-scheme: ${xe?"dark":"normal"}`,...QP(q),...Object.keys(X).map(ce=>{const me=X[ce],ee=typeof me=="string"&&me.startsWith("#")?HT(me):void 0,Ie=ee?`${ee.r}, ${ee.g}, ${ee.b}`:void 0;return`--v-${ce}: ${Ie!=null?Ie:me}`})])}const M=[],L=[],D=new Set(Object.values(m.value).flatMap(V=>Object.keys(V.colors)));for(const V of D)/^on-[a-z]/.test(V)?Ou(L,`.${V}`,[`color: rgb(var(--v-theme-${V})) !important`]):(Ou(M,`.bg-${V}`,[`--v-theme-overlay-multiplier: var(--v-theme-${V}-overlay-multiplier)`,`background: rgb(var(--v-theme-${V})) !important`,`color: rgb(var(--v-theme-on-${V})) !important`]),Ou(L,`.text-${V}`,[`color: rgb(var(--v-theme-${V})) !important`]),Ou(L,`.border-${V}`,[`--v-border-color: var(--v-theme-${V})`]));return C.push(...M,...L),C.map((V,q)=>q===0?V:`    ${V}`).join("")});function o(C){const M=C._context.provides.usehead;if(M)M.addHeadObjs(ne(()=>{const D={children:b.value,type:"text/css",id:"vuetify-theme-stylesheet"};return a.cspNonce&&(D.nonce=a.cspNonce),{style:[D]}})),ki&&Ms(()=>M.updateDOM());else{let V=function(){if(!a.isDisabled){if(typeof document<"u"&&!D){const q=document.createElement("style");q.type="text/css",q.id="vuetify-theme-stylesheet",a.cspNonce&&q.setAttribute("nonce",a.cspNonce),D=q,document.head.appendChild(D)}D&&(D.innerHTML=b.value)}};var L=V;let D=ki?document.getElementById("vuetify-theme-stylesheet"):null;Ye(b,V,{immediate:!0})}}const w=ne(()=>a.isDisabled?void 0:`v-theme--${l.value}`);return{install:o,isDisabled:a.isDisabled,name:l,themes:d,current:v,computedThemes:m,themeClasses:w,styles:b,global:{name:l,current:v}}}function yi(t){kr("provideTheme");const a=ln(hf,null);if(!a)throw new Error("Could not find Vuetify theme injection");const l=ne(()=>{var v;return(v=t.theme)!=null?v:a==null?void 0:a.name.value}),d=ne(()=>a.isDisabled?void 0:`v-theme--${l.value}`),m={...a,name:l,themeClasses:d};return ji(hf,m),m}function i2(){kr("useTheme");const t=ln(hf,null);if(!t)throw new Error("Could not find Vuetify theme injection");return t}function Ou(t,a,l){t.push(`${a} {
`,...l.map(d=>`  ${d};
`),`}
`)}function QP(t){const a=t.dark?2:1,l=t.dark?1:2,d=[];for(const[m,v]of Object.entries(t.colors)){const b=HT(v);d.push(`--v-theme-${m}: ${b.r},${b.g},${b.b}`),m.startsWith("on-")||d.push(`--v-theme-${m}-overlay-multiplier: ${kv(v)>.18?a:l}`)}return d}function My(t){return Sy(()=>{const a=[],l={};return t.value.background&&(Lb(t.value.background)?l.backgroundColor=t.value.background:a.push(`bg-${t.value.background}`)),t.value.text&&(Lb(t.value.text)?(l.color=t.value.text,l.caretColor=t.value.text):a.push(`text-${t.value.text}`)),{colorClasses:a,colorStyles:l}})}function no(t,a){const l=ne(()=>({text:Bi(t)?t.value:a?t[a]:null})),{colorClasses:d,colorStyles:m}=My(l);return{textColorClasses:d,textColorStyles:m}}function Yi(t,a){const l=ne(()=>({background:Bi(t)?t.value:a?t[a]:null})),{colorClasses:d,colorStyles:m}=My(l);return{backgroundColorClasses:d,backgroundColorStyles:m}}const ez=["elevated","flat","tonal","outlined","text","plain"];function Sc(t,a){return O(Rn,null,[t&&O("span",{key:"overlay",class:`${a}__overlay`},null),O("span",{key:"underlay",class:`${a}__underlay`},null)])}const Do=Mn({color:String,variant:{type:String,default:"elevated",validator:t=>ez.includes(t)}},"variant");function Ec(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ua();const l=ne(()=>{const{variant:v}=Ui(t);return`${a}--variant-${v}`}),{colorClasses:d,colorStyles:m}=My(ne(()=>{const{variant:v,color:b}=Ui(t);return{[["elevated","flat"].includes(v)?"background":"text"]:b}}));return{colorClasses:d,colorStyles:m,variantClasses:l}}const r2=Pt({name:"VBtnGroup",props:{divided:Boolean,...fo(),...gr(),...sr(),...Pi(),...Sn(),...Xn(),...Do()},setup(t,a){let{slots:l}=a;const{themeClasses:d}=yi(t),{densityClasses:m}=jr(t),{borderClasses:v}=Lo(t),{elevationClasses:b}=Mr(t),{roundedClasses:o}=Ki(t);rr({VBtn:{height:"auto",color:Tt(t,"color"),density:Tt(t,"density"),flat:!0,variant:Tt(t,"variant")}}),kt(()=>O(t.tag,{class:["v-btn-group",{"v-btn-group--divided":t.divided},d.value,v.value,m.value,b.value,o.value]},l))}}),Py=Symbol.for("vuetify:v-btn-toggle"),tz=Mi()({name:"VBtnToggle",props:ed(),emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const{isSelected:d,next:m,prev:v,select:b,selected:o}=Tc(t,Py);return kt(()=>{var w;return O(r2,{class:"v-btn-toggle"},{default:()=>[(w=l.default)==null?void 0:w.call(l,{isSelected:d,next:m,prev:v,select:b,selected:o})]})}),{next:m,prev:v,select:b}}}),o2=Pt({name:"VBottomNavigation",props:{bgColor:String,color:String,grow:Boolean,mode:{type:String,validator:t=>!t||["horizontal","shift"].includes(t)},height:{type:[Number,String],default:56},...fo(),...gr(),...sr(),...Pi(),...nd({name:"bottom-navigation"}),...Sn({tag:"header"}),...ed({modelValue:!0,selectedClass:"v-btn--selected"}),...Xn()},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const{themeClasses:d}=i2(),{borderClasses:m}=Lo(t),{backgroundColorClasses:v,backgroundColorStyles:b}=Yi(Tt(t,"bgColor")),{densityClasses:o}=jr(t),{elevationClasses:w}=Mr(t),{roundedClasses:C}=Ki(t),M=ne(()=>Number(t.height)-(t.density==="comfortable"?8:0)-(t.density==="compact"?16:0)),L=Tn(t,"modelValue"),{layoutItemStyles:D}=id({id:t.name,order:ne(()=>parseInt(t.order,10)),position:ne(()=>"bottom"),layoutSize:ne(()=>L.value?M.value:0),elementSize:M,active:L,absolute:Tt(t,"absolute")});return Tc(t,Py),rr({VBtn:{color:Tt(t,"color"),density:Tt(t,"density"),stacked:ne(()=>t.mode!=="horizontal"),variant:"text"}},{scoped:!0}),kt(()=>O(t.tag,{class:["v-bottom-navigation",{"v-bottom-navigation--active":L.value,"v-bottom-navigation--grow":t.grow,"v-bottom-navigation--shift":t.mode==="shift"},d.value,v.value,m.value,o.value,w.value,C.value],style:[b.value,D.value,{height:Xt(M.value),transform:`translateY(${Xt(L.value?0:100,"%")})`}]},{default:()=>[l.default&&O("div",{class:"v-bottom-navigation__content"},[l.default()])]})),{}}});const Ti=vn({name:"VDefaultsProvider",props:{defaults:Object,reset:[Number,String],root:Boolean,scoped:Boolean},setup(t,a){let{slots:l}=a;const{defaults:d,reset:m,root:v,scoped:b}=ly(t);return rr(d,{reset:m,root:v,scoped:b}),()=>{var o;return(o=l.default)==null?void 0:o.call(l)}}});const nz={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sort:"mdi-arrow-up",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus"},iz={component:t=>zs(zy,{...t,class:"mdi"})},pn=[String,Function,Object],Pv=Symbol.for("vuetify:icons"),og=Mn({icon:{type:pn,required:!0},tag:{type:String,required:!0}},"icon"),s2=Pt({name:"VComponentIcon",props:og(),setup(t){return()=>O(t.tag,null,{default:()=>[O(t.icon,null,null)]})}}),a2=Pt({name:"VSvgIcon",inheritAttrs:!1,props:og(),setup(t,a){let{attrs:l}=a;return()=>O(t.tag,nn(l,{style:null}),{default:()=>[O("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[O("path",{d:t.icon},null)])]})}}),rz=Pt({name:"VLigatureIcon",props:og(),setup(t){return()=>O(t.tag,null,{default:()=>[t.icon]})}}),zy=Pt({name:"VClassIcon",props:og(),setup(t){return()=>O(t.tag,{class:t.icon},null)}}),oz={svg:{component:a2},class:{component:zy}};function sz(t){return la({defaultSet:"mdi",sets:{...oz,mdi:iz},aliases:nz},t)}const az=t=>{const a=ln(Pv);if(!a)throw new Error("Missing Vuetify Icons provide!");return{iconData:ne(()=>{const d=Bi(t)?t.value:t.icon;if(!d)throw new Error("Icon value is undefined or null");let m=d;if(typeof d=="string"&&d.includes("$")){var v;m=(v=a.aliases)==null?void 0:v[d.slice(d.indexOf("$")+1)]}if(!m)throw new Error(`Could not find aliased icon "${d}"`);if(typeof m!="string")return{component:s2,icon:m};const b=Object.keys(a.sets).find(C=>typeof m=="string"&&m.startsWith(`${C}:`)),o=b?m.slice(b.length+1):m;return{component:a.sets[b!=null?b:a.defaultSet].component,icon:o}})}},lz=["x-small","small","default","large","x-large"],da=Mn({size:{type:[String,Number],default:"default"}},"size");function rd(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ua();return Sy(()=>{let l,d;return Lm(lz,t.size)?l=`${a}--size-${t.size}`:t.size&&(d={width:Xt(t.size),height:Xt(t.size)}),{sizeClasses:l,sizeStyles:d}})}const cz=Mn({color:String,start:Boolean,end:Boolean,icon:pn,...da(),...Sn({tag:"i"}),...Xn()},"v-icon"),er=Pt({name:"VIcon",props:cz(),setup(t,a){let{attrs:l,slots:d}=a,m;d.default&&(m=ne(()=>{var M,L;const D=(M=d.default)==null?void 0:M.call(d);if(!!D)return(L=RT(D).filter(V=>V.children&&typeof V.children=="string")[0])==null?void 0:L.children}));const{themeClasses:v}=yi(t),{iconData:b}=az(m||t),{sizeClasses:o}=rd(t),{textColorClasses:w,textColorStyles:C}=no(Tt(t,"color"));return kt(()=>O(b.value.component,{tag:t.tag,icon:b.value.icon,class:["v-icon","notranslate",v.value,o.value,w.value,{"v-icon--clickable":!!l.onClick,"v-icon--start":t.start,"v-icon--end":t.end}],style:[o.value?void 0:{fontSize:Xt(t.size),height:Xt(t.size),width:Xt(t.size)},C.value],role:l.onClick?"button":void 0,"aria-hidden":!l.onClick},null)),{}}});function Ly(t){const a=Je(),l=Je(!1);if(ky){const d=new IntersectionObserver(m=>{t==null||t(m,d),l.value=!!m.find(v=>v.isIntersecting)});Ei(()=>{d.disconnect()}),Ye(a,(m,v)=>{v&&(d.unobserve(v),l.value=!1),m&&d.observe(m)},{flush:"post"})}return{intersectionRef:a,isIntersecting:l}}const Dy=Pt({name:"VProgressCircular",props:{bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...da(),...Sn({tag:"div"}),...Xn()},setup(t,a){let{slots:l}=a;const d=20,m=2*Math.PI*d,v=Je(),{themeClasses:b}=yi(t),{sizeClasses:o,sizeStyles:w}=rd(t),{textColorClasses:C,textColorStyles:M}=no(Tt(t,"color")),{textColorClasses:L,textColorStyles:D}=no(Tt(t,"bgColor")),{intersectionRef:V,isIntersecting:q}=Ly(),{resizeRef:X,contentRect:xe}=gc(),ce=ne(()=>Math.max(0,Math.min(100,parseFloat(t.modelValue)))),me=ne(()=>Number(t.width)),ee=ne(()=>w.value?Number(t.size):xe.value?xe.value.width:Math.max(me.value,32)),Ie=ne(()=>d/(1-me.value/ee.value)*2),Y=ne(()=>me.value/ee.value*Ie.value),ve=ne(()=>Xt((100-ce.value)/100*m));return Ms(()=>{V.value=v.value,X.value=v.value}),kt(()=>O(t.tag,{ref:v,class:["v-progress-circular",{"v-progress-circular--indeterminate":!!t.indeterminate,"v-progress-circular--visible":q.value,"v-progress-circular--disable-shrink":t.indeterminate==="disable-shrink"},b.value,o.value,C.value],style:[w.value,M.value],role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":t.indeterminate?void 0:ce.value},{default:()=>[O("svg",{style:{transform:`rotate(calc(-90deg + ${Number(t.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${Ie.value} ${Ie.value}`},[O("circle",{class:["v-progress-circular__underlay",L.value],style:D.value,fill:"transparent",cx:"50%",cy:"50%",r:d,"stroke-width":Y.value,"stroke-dasharray":m,"stroke-dashoffset":0},null),O("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:d,"stroke-width":Y.value,"stroke-dasharray":m,"stroke-dashoffset":ve.value},null)]),l.default&&O("div",{class:"v-progress-circular__content"},[l.default({value:ce.value})])]})),{}}});const zv=Symbol("rippleStop"),uz=80;function jb(t,a){t.style.transform=a,t.style.webkitTransform=a}function K_(t,a){t.style.opacity=`calc(${a} * var(--v-theme-overlay-multiplier))`}function Lv(t){return t.constructor.name==="TouchEvent"}function l2(t){return t.constructor.name==="KeyboardEvent"}const dz=function(t,a){var l;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},m=0,v=0;if(!l2(t)){const D=a.getBoundingClientRect(),V=Lv(t)?t.touches[t.touches.length-1]:t;m=V.clientX-D.left,v=V.clientY-D.top}let b=0,o=.3;(l=a._ripple)!=null&&l.circle?(o=.15,b=a.clientWidth/2,b=d.center?b:b+Math.sqrt((m-b)**2+(v-b)**2)/4):b=Math.sqrt(a.clientWidth**2+a.clientHeight**2)/2;const w=`${(a.clientWidth-b*2)/2}px`,C=`${(a.clientHeight-b*2)/2}px`,M=d.center?w:`${m-b}px`,L=d.center?C:`${v-b}px`;return{radius:b,scale:o,x:M,y:L,centerX:w,centerY:C}},Vm={show(t,a){var l;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(a!=null&&(l=a._ripple)!=null&&l.enabled))return;const m=document.createElement("span"),v=document.createElement("span");m.appendChild(v),m.className="v-ripple__container",d.class&&(m.className+=` ${d.class}`);const{radius:b,scale:o,x:w,y:C,centerX:M,centerY:L}=dz(t,a,d),D=`${b*2}px`;v.className="v-ripple__animation",v.style.width=D,v.style.height=D,a.appendChild(m);const V=window.getComputedStyle(a);V&&V.position==="static"&&(a.style.position="relative",a.dataset.previousPosition="static"),v.classList.add("v-ripple__animation--enter"),v.classList.add("v-ripple__animation--visible"),jb(v,`translate(${w}, ${C}) scale3d(${o},${o},${o})`),K_(v,0),v.dataset.activated=String(performance.now()),setTimeout(()=>{v.classList.remove("v-ripple__animation--enter"),v.classList.add("v-ripple__animation--in"),jb(v,`translate(${M}, ${L}) scale3d(1,1,1)`),K_(v,.08)},0)},hide(t){var a;if(!(t!=null&&(a=t._ripple)!=null&&a.enabled))return;const l=t.getElementsByClassName("v-ripple__animation");if(l.length===0)return;const d=l[l.length-1];if(d.dataset.isHiding)return;d.dataset.isHiding="true";const m=performance.now()-Number(d.dataset.activated),v=Math.max(250-m,0);setTimeout(()=>{d.classList.remove("v-ripple__animation--in"),d.classList.add("v-ripple__animation--out"),K_(d,0),setTimeout(()=>{t.getElementsByClassName("v-ripple__animation").length===1&&t.dataset.previousPosition&&(t.style.position=t.dataset.previousPosition,delete t.dataset.previousPosition),d.parentNode&&t.removeChild(d.parentNode)},300)},v)}};function c2(t){return typeof t>"u"||!!t}function ff(t){const a={},l=t.currentTarget;if(!(!(l!=null&&l._ripple)||l._ripple.touched||t[zv])){if(t[zv]=!0,Lv(t))l._ripple.touched=!0,l._ripple.isTouch=!0;else if(l._ripple.isTouch)return;if(a.center=l._ripple.centered||l2(t),l._ripple.class&&(a.class=l._ripple.class),Lv(t)){if(l._ripple.showTimerCommit)return;l._ripple.showTimerCommit=()=>{Vm.show(t,l,a)},l._ripple.showTimer=window.setTimeout(()=>{var d;l!=null&&(d=l._ripple)!=null&&d.showTimerCommit&&(l._ripple.showTimerCommit(),l._ripple.showTimerCommit=null)},uz)}else Vm.show(t,l,a)}}function Gb(t){t[zv]=!0}function lo(t){const a=t.currentTarget;if(!(!a||!a._ripple)){if(window.clearTimeout(a._ripple.showTimer),t.type==="touchend"&&a._ripple.showTimerCommit){a._ripple.showTimerCommit(),a._ripple.showTimerCommit=null,a._ripple.showTimer=window.setTimeout(()=>{lo(t)});return}window.setTimeout(()=>{a._ripple&&(a._ripple.touched=!1)}),Vm.hide(a)}}function u2(t){const a=t.currentTarget;!a||!a._ripple||(a._ripple.showTimerCommit&&(a._ripple.showTimerCommit=null),window.clearTimeout(a._ripple.showTimer))}let pf=!1;function d2(t){!pf&&(t.keyCode===Ab.enter||t.keyCode===Ab.space)&&(pf=!0,ff(t))}function h2(t){pf=!1,lo(t)}function f2(t){pf&&(pf=!1,lo(t))}function p2(t,a,l){var b;const{value:d,modifiers:m}=a,v=c2(d);if(v||Vm.hide(t),t._ripple=(b=t._ripple)!=null?b:{},t._ripple.enabled=v,t._ripple.centered=m.center,t._ripple.circle=m.circle,Sv(d)&&d.class&&(t._ripple.class=d.class),v&&!l){if(m.stop){t.addEventListener("touchstart",Gb,{passive:!0}),t.addEventListener("mousedown",Gb);return}t.addEventListener("touchstart",ff,{passive:!0}),t.addEventListener("touchend",lo,{passive:!0}),t.addEventListener("touchmove",u2,{passive:!0}),t.addEventListener("touchcancel",lo),t.addEventListener("mousedown",ff),t.addEventListener("mouseup",lo),t.addEventListener("mouseleave",lo),t.addEventListener("keydown",d2),t.addEventListener("keyup",h2),t.addEventListener("blur",f2),t.addEventListener("dragstart",lo,{passive:!0})}else!v&&l&&m2(t)}function m2(t){t.removeEventListener("mousedown",ff),t.removeEventListener("touchstart",ff),t.removeEventListener("touchend",lo),t.removeEventListener("touchmove",u2),t.removeEventListener("touchcancel",lo),t.removeEventListener("mouseup",lo),t.removeEventListener("mouseleave",lo),t.removeEventListener("keydown",d2),t.removeEventListener("keyup",h2),t.removeEventListener("dragstart",lo),t.removeEventListener("blur",f2)}function hz(t,a){p2(t,a,!1)}function fz(t){delete t._ripple,m2(t)}function pz(t,a){if(a.value===a.oldValue)return;const l=c2(a.oldValue);p2(t,a,l)}const sl={mounted:hz,unmounted:fz,updated:pz},es=Mn({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function ts(t){return{dimensionStyles:ne(()=>({height:Xt(t.height),maxHeight:Xt(t.maxHeight),maxWidth:Xt(t.maxWidth),minHeight:Xt(t.minHeight),minWidth:Xt(t.minWidth),width:Xt(t.width)}))}}const mz={badge:"Badge",close:"Close",dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},datePicker:{itemsSelected:"{0} selected",nextMonthAriaLabel:"Next month",nextYearAriaLabel:"Next year",prevMonthAriaLabel:"Previous month",prevYearAriaLabel:"Previous year"},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Goto Page {0}",currentPage:"Page {0}, Current Page",first:"First page",last:"Last page"}},rating:{ariaLabel:{item:"Rating {0} of {1}"}}},qb="$vuetify.",Zb=(t,a)=>t.replace(/\{(\d+)\}/g,(l,d)=>String(a[+d])),g2=(t,a,l)=>function(d){for(var m=arguments.length,v=new Array(m>1?m-1:0),b=1;b<m;b++)v[b-1]=arguments[b];if(!d.startsWith(qb))return Zb(d,v);const o=d.replace(qb,""),w=t.value&&l.value[t.value],C=a.value&&l.value[a.value];let M=Tv(w,o,null);return M||(mc(`Translation key "${d}" not found in "${t.value}", trying fallback locale`),M=Tv(C,o,null)),M||(Av(`Translation key "${d}" not found in fallback`),M=d),typeof M!="string"&&(Av(`Translation key "${d}" has a non-string value`),M=d),Zb(M,v)};function _2(t,a){return(l,d)=>new Intl.NumberFormat([t.value,a.value],d).format(l)}function J_(t,a,l){var m,v;const d=Tn(t,a,(m=t[a])!=null?m:l.value);return d.value=(v=t[a])!=null?v:l.value,Ye(l,b=>{t[a]==null&&(d.value=l.value)}),d}function v2(t){return a=>{const l=J_(a,"locale",t.current),d=J_(a,"fallback",t.fallback),m=J_(a,"messages",t.messages);return{name:"vuetify",current:l,fallback:d,messages:m,t:g2(l,d,m),n:_2(l,d),provide:v2({current:l,fallback:d,messages:m})}}}function gz(t){var m,v;const a=Je((m=t==null?void 0:t.locale)!=null?m:"en"),l=Je((v=t==null?void 0:t.fallback)!=null?v:"en"),d=Je({en:mz,...t==null?void 0:t.messages});return{name:"vuetify",current:a,fallback:l,messages:d,t:g2(a,l,d),n:_2(a,l),provide:v2({current:a,fallback:l,messages:d})}}const _z={af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!1,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1},Ku=Symbol.for("vuetify:locale");function vz(t){return t.name!=null}function yz(t){const a=t!=null&&t.adapter&&vz(t==null?void 0:t.adapter)?t==null?void 0:t.adapter:gz(t),l=bz(a,t);return{...a,...l}}function ns(){const t=ln(Ku);if(!t)throw new Error("[Vuetify] Could not find injected locale instance");return t}function xz(t){const a=ln(Ku);if(!a)throw new Error("[Vuetify] Could not find injected locale instance");const l=a.provide(t),d=wz(l,a.rtl,t),m={...l,...d};return ji(Ku,m),m}function bz(t,a){var m;const l=Je((m=a==null?void 0:a.rtl)!=null?m:_z),d=ne(()=>{var v;return(v=l.value[t.current.value])!=null?v:!1});return{isRtl:d,rtl:l,rtlClasses:ne(()=>`v-locale--is-${d.value?"rtl":"ltr"}`)}}function wz(t,a,l){const d=ne(()=>{var m,v;return(v=(m=l.rtl)!=null?m:a.value[t.current.value])!=null?v:!1});return{isRtl:d,rtl:a,rtlClasses:ne(()=>`v-locale--is-${d.value?"rtl":"ltr"}`)}}function ha(){const t=ln(Ku);if(!t)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:t.isRtl,rtlClasses:t.rtlClasses}}const By=Pt({name:"VProgressLinear",props:{active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,...Pi(),...Sn(),...Xn()},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=Tn(t,"modelValue"),{isRtl:m}=ha(),{themeClasses:v}=yi(t),{textColorClasses:b,textColorStyles:o}=no(t,"color"),{backgroundColorClasses:w,backgroundColorStyles:C}=Yi(ne(()=>t.bgColor||t.color)),{backgroundColorClasses:M,backgroundColorStyles:L}=Yi(t,"color"),{roundedClasses:D}=Ki(t),{intersectionRef:V,isIntersecting:q}=Ly(),X=ne(()=>parseInt(t.max,10)),xe=ne(()=>parseInt(t.height,10)),ce=ne(()=>parseFloat(t.bufferValue)/X.value*100),me=ne(()=>parseFloat(d.value)/X.value*100),ee=ne(()=>m.value!==t.reverse),Ie=ne(()=>t.indeterminate?"fade-transition":"slide-x-transition"),Y=ne(()=>t.bgOpacity==null?t.bgOpacity:parseFloat(t.bgOpacity));function ve(fe){if(!V.value)return;const{left:ge,right:Ee,width:we}=V.value.getBoundingClientRect(),Oe=ee.value?we-fe.clientX+(Ee-we):fe.clientX-ge;d.value=Math.round(Oe/we*X.value)}return kt(()=>O(t.tag,{ref:V,class:["v-progress-linear",{"v-progress-linear--active":t.active&&q.value,"v-progress-linear--reverse":ee.value,"v-progress-linear--rounded":t.rounded,"v-progress-linear--rounded-bar":t.roundedBar,"v-progress-linear--striped":t.striped},D.value,v.value],style:{height:t.active?Xt(xe.value):0,"--v-progress-linear-height":Xt(xe.value)},role:"progressbar","aria-valuemin":"0","aria-valuemax":t.max,"aria-valuenow":t.indeterminate?void 0:me.value,onClick:t.clickable&&ve},{default:()=>[t.stream&&O("div",{key:"stream",class:["v-progress-linear__stream",b.value],style:{...o.value,[ee.value?"left":"right"]:Xt(-xe.value),borderTop:`${Xt(xe.value/2)} dotted`,opacity:Y.value,top:`calc(50% - ${Xt(xe.value/4)})`,width:Xt(100-ce.value,"%"),"--v-progress-linear-stream-to":Xt(xe.value*(ee.value?1:-1))}},null),O("div",{class:["v-progress-linear__background",w.value],style:[C.value,{opacity:Y.value,width:Xt(t.stream?ce.value:100,"%")}]},null),O(ks,{name:Ie.value},{default:()=>[t.indeterminate?O("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(fe=>O("div",{key:fe,class:["v-progress-linear__indeterminate",fe,M.value],style:L.value},null))]):O("div",{class:["v-progress-linear__determinate",M.value],style:[L.value,{width:Xt(me.value,"%")}]},null)]}),l.default&&O("div",{class:"v-progress-linear__content"},[l.default({value:me.value,buffer:ce.value})])]})),{}}}),Ry=Mn({loading:Boolean},"loader");function sg(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ua();return{loaderClasses:ne(()=>({[`${a}--loading`]:t.loading}))}}function Oy(t,a){var l;let{slots:d}=a;return O("div",{class:`${t.name}__loader`},[((l=d.default)==null?void 0:l.call(d,{color:t.color,isActive:t.active}))||O(By,{active:t.active,color:t.color,height:"2",indeterminate:!0},null)])}const Wb={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},Cc=Mn({location:String},"location");function Ic(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2?arguments[2]:void 0;const{isRtl:d}=ha();return{locationStyles:ne(()=>{if(!t.location)return{};const{side:v,align:b}=Cv(t.location.split(" ").length>1?t.location:`${t.location} center`,d.value);function o(C){return l?l(C):0}const w={};return v!=="center"&&(a?w[Wb[v]]=`calc(100% - ${o(v)}px)`:w[v]=0),b!=="center"?a?w[Wb[b]]=`calc(100% - ${o(b)}px)`:w[b]=0:(v==="center"?w.top=w.left="50%":w[{top:"left",bottom:"left",left:"top",right:"top"}[v]]="50%",w.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[v]),w})}}const Tz=["static","relative","fixed","absolute","sticky"],od=Mn({position:{type:String,validator:t=>Tz.includes(t)}},"position");function sd(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ua();return{positionClasses:ne(()=>t.position?`${a}--${t.position}`:void 0)}}function y2(){var t,a;return(t=kr("useRouter"))==null||(a=t.proxy)==null?void 0:a.$router}function xf(t,a){const l=UA("RouterLink"),d=ne(()=>!!(t.href||t.to)),m=ne(()=>(d==null?void 0:d.value)||!!(a.onClick||a.onClickOnce));if(typeof l=="string")return{isLink:d,isClickable:m,href:Tt(t,"href")};const v=t.to?l.useLink(t):void 0;return{isLink:d,isClickable:m,route:v==null?void 0:v.route,navigate:v==null?void 0:v.navigate,isActive:v&&ne(()=>{var b,o;return t.exact?(b=v.isExactActive)==null?void 0:b.value:(o=v.isActive)==null?void 0:o.value}),href:ne(()=>t.to?v==null?void 0:v.route.value.href:t.href)}}const ad=Mn({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let Q_=!1;function Sz(t,a){let l=!1,d,m;ki&&(Gi(()=>{window.addEventListener("popstate",v),d=t==null?void 0:t.beforeEach((b,o,w)=>{Q_?l?a(w):w():setTimeout(()=>l?a(w):w()),Q_=!0}),m=t==null?void 0:t.afterEach(()=>{Q_=!1})}),vc(()=>{var b,o;window.removeEventListener("popstate",v),(b=d)==null||b(),(o=m)==null||o()}));function v(b){var o;(o=b.state)!=null&&o.replaced||(l=!0,setTimeout(()=>l=!1))}}function Ez(t,a){Ye(()=>{var l;return(l=t.isActive)==null?void 0:l.value},l=>{t.isLink.value&&l&&a&&Gi(()=>{a(!0)})},{immediate:!0})}const pr=Pt({name:"VBtn",directives:{Ripple:sl},props:{active:{type:Boolean,default:void 0},symbol:{type:null,default:Py},flat:Boolean,icon:[Boolean,String,Function,Object],prependIcon:pn,appendIcon:pn,block:Boolean,stacked:Boolean,ripple:{type:Boolean,default:!0},...fo(),...Pi(),...gr(),...es(),...sr(),...wc(),...Ry(),...Cc(),...od(),...ad(),...da(),...Sn({tag:"button"}),...Xn(),...Do({variant:"elevated"})},emits:{"group:selected":t=>!0},setup(t,a){let{attrs:l,slots:d}=a;const{themeClasses:m}=yi(t),{borderClasses:v}=Lo(t),{colorClasses:b,colorStyles:o,variantClasses:w}=Ec(t),{densityClasses:C}=jr(t),{dimensionStyles:M}=ts(t),{elevationClasses:L}=Mr(t),{loaderClasses:D}=sg(t),{locationStyles:V}=Ic(t),{positionClasses:q}=sd(t),{roundedClasses:X}=Ki(t),{sizeClasses:xe,sizeStyles:ce}=rd(t),me=td(t,t.symbol,!1),ee=xf(t,l),Ie=ne(()=>{var fe;return t.active!==!1&&(t.active||((fe=ee.isActive)==null?void 0:fe.value)||(me==null?void 0:me.isSelected.value))}),Y=ne(()=>(me==null?void 0:me.disabled.value)||t.disabled),ve=ne(()=>t.variant==="elevated"&&!(t.disabled||t.flat||t.border));return Ez(ee,me==null?void 0:me.select),kt(()=>{var fe,ge,Ee,we;const Oe=ee.isLink.value?"a":t.tag,ze=!me||me.isSelected.value,Qe=!!(t.prependIcon||d.prepend),ht=!!(t.appendIcon||d.append),nt=!!(t.icon&&t.icon!==!0);return qi(O(Oe,{type:Oe==="a"?void 0:"button",class:["v-btn",me==null?void 0:me.selectedClass.value,{"v-btn--active":Ie.value,"v-btn--block":t.block,"v-btn--disabled":Y.value,"v-btn--elevated":ve.value,"v-btn--flat":t.flat,"v-btn--icon":!!t.icon,"v-btn--loading":t.loading,"v-btn--stacked":t.stacked},m.value,v.value,ze?b.value:void 0,C.value,L.value,D.value,q.value,X.value,xe.value,w.value],style:[ze?o.value:void 0,M.value,V.value,ce.value],disabled:Y.value||void 0,href:ee.href.value,onClick:ft=>{var Pe;Y.value||((Pe=ee.navigate)==null||Pe.call(ee,ft),me==null||me.toggle())}},{default:()=>{var ft;return[Sc(!0,"v-btn"),!t.icon&&Qe&&O(Ti,{key:"prepend",defaults:{VIcon:{icon:t.prependIcon}}},{default:()=>{var Pe;return[O("span",{class:"v-btn__prepend"},[(Pe=(fe=d.prepend)==null?void 0:fe.call(d))!=null?Pe:O(er,null,null)])]}}),O("span",{class:"v-btn__content","data-no-activator":""},[O(Ti,{key:"content",defaults:{VIcon:{icon:nt?t.icon:void 0}}},{default:()=>{var Pe;return[(Pe=(ge=d.default)==null?void 0:ge.call(d))!=null?Pe:nt&&O(er,{key:"icon"},null)]}})]),!t.icon&&ht&&O(Ti,{key:"append",defaults:{VIcon:{icon:t.appendIcon}}},{default:()=>{var Pe;return[O("span",{class:"v-btn__append"},[(Pe=(Ee=d.append)==null?void 0:Ee.call(d))!=null?Pe:O(er,null,null)])]}}),!!t.loading&&O("span",{key:"loader",class:"v-btn__loader"},[(ft=(we=d.loader)==null?void 0:we.call(d))!=null?ft:O(Dy,{color:typeof t.loading=="boolean"?void 0:t.loading,indeterminate:!0,size:"23",width:"2"},null)])]}}),[[uo("ripple"),!Y.value&&t.ripple,null]])}),{}}});const Cz=Pt({name:"VContainer",props:{fluid:{type:Boolean,default:!1},...Sn()},setup(t,a){let{slots:l}=a;return kt(()=>O(t.tag,{class:["v-container",{"v-container--fluid":t.fluid}]},l)),{}}}),Fy=["sm","md","lg","xl","xxl"],x2=(()=>Fy.reduce((t,a)=>(t[a]={type:[Boolean,String,Number],default:!1},t),{}))(),b2=(()=>Fy.reduce((t,a)=>(t["offset"+ol(a)]={type:[String,Number],default:null},t),{}))(),w2=(()=>Fy.reduce((t,a)=>(t["order"+ol(a)]={type:[String,Number],default:null},t),{}))(),Hb={col:Object.keys(x2),offset:Object.keys(b2),order:Object.keys(w2)};function Iz(t,a,l){let d=t;if(!(l==null||l===!1)){if(a){const m=a.replace(t,"");d+=`-${m}`}return t==="col"&&(d="v-"+d),t==="col"&&(l===""||l===!0)||(d+=`-${l}`),d.toLowerCase()}}const Az=["auto","start","end","center","baseline","stretch"],kz=Pt({name:"VCol",props:{cols:{type:[Boolean,String,Number],default:!1},...x2,offset:{type:[String,Number],default:null},...b2,order:{type:[String,Number],default:null},...w2,alignSelf:{type:String,default:null,validator:t=>Az.includes(t)},...Sn()},setup(t,a){let{slots:l}=a;const d=ne(()=>{const m=[];let v;for(v in Hb)Hb[v].forEach(o=>{const w=t[o],C=Iz(v,o,w);C&&m.push(C)});const b=m.some(o=>o.startsWith("v-col-"));return m.push({"v-col":!b||!t.cols,[`v-col-${t.cols}`]:t.cols,[`offset-${t.offset}`]:t.offset,[`order-${t.order}`]:t.order,[`align-self-${t.alignSelf}`]:t.alignSelf}),m});return()=>{var m;return zs(t.tag,{class:d.value},(m=l.default)==null?void 0:m.call(l))}}}),Mz=["sm","md","lg","xl","xxl"],Vy=["start","end","center"],T2=["space-between","space-around","space-evenly"];function $y(t,a){return Mz.reduce((l,d)=>(l[t+ol(d)]=a(),l),{})}const Pz=[...Vy,"baseline","stretch"],S2=t=>Pz.includes(t),E2=$y("align",()=>({type:String,default:null,validator:S2})),zz=[...Vy,...T2],C2=t=>zz.includes(t),I2=$y("justify",()=>({type:String,default:null,validator:C2})),Lz=[...Vy,...T2,"stretch"],A2=t=>Lz.includes(t),k2=$y("alignContent",()=>({type:String,default:null,validator:A2})),Xb={align:Object.keys(E2),justify:Object.keys(I2),alignContent:Object.keys(k2)},Dz={align:"align",justify:"justify",alignContent:"align-content"};function Bz(t,a,l){let d=Dz[t];if(l!=null){if(a){const m=a.replace(t,"");d+=`-${m}`}return d+=`-${l}`,d.toLowerCase()}}const Rz=Pt({name:"VRow",props:{dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:S2},...E2,justify:{type:String,default:null,validator:C2},...I2,alignContent:{type:String,default:null,validator:A2},...k2,...Sn()},setup(t,a){let{slots:l}=a;const d=ne(()=>{const m=[];let v;for(v in Xb)Xb[v].forEach(b=>{const o=t[b],w=Bz(v,b,o);w&&m.push(w)});return m.push({"v-row--no-gutters":t.noGutters,"v-row--dense":t.dense,[`align-${t.align}`]:t.align,[`justify-${t.justify}`]:t.justify,[`align-content-${t.alignContent}`]:t.alignContent}),m});return()=>{var m;return zs(t.tag,{class:["v-row",d.value]},(m=l.default)==null?void 0:m.call(l))}}}),Dv=zo("flex-grow-1","div","VSpacer"),Oz=vn({__name:"FooterBottom",setup(t){const a=pi({index:"mdi-map-outline",finance:"mdi-file-document-edit-outline",meteorology:"mdi-cloud-outline",nuclear:"mdi-atom",evacuate:"mdi-run"}),l=pi({index:"mdi-map",finance:"mdi-file-document-edit",meteorology:"mdi-cloud",nuclear:"mdi-atom-variant",evacuate:"mdi-run-fast"});function d(M){M==="index"?(a.index=l.index,a.finance="mdi-file-document-edit-outline",a.meteorology="mdi-cloud-outline",a.nuclear="mdi-atom",a.evacuate="mdi-run"):M==="finance"?(a.index="mdi-map-outline",a.finance=l.finance,a.meteorology="mdi-cloud-outline",a.nuclear="mdi-atom",a.evacuate="mdi-run"):M==="meteorology"?(a.index="mdi-map-outline",a.finance="mdi-file-document-edit-outline",a.meteorology=l.meteorology,a.nuclear="mdi-atom",a.evacuate="mdi-run"):M==="nuclear"?(a.index="mdi-map-outline",a.finance="mdi-file-document-edit-outline",a.meteorology="mdi-cloud-outline",a.nuclear=l.nuclear,a.evacuate="mdi-run"):M==="evacuate"&&(a.index="mdi-map-outline",a.finance="mdi-file-document-edit-outline",a.meteorology="mdi-cloud-outline",a.nuclear="mdi-atom",a.evacuate=l.evacuate)}const m=Qu();function v(){m.push({name:"finance"}),d("finance")}function b(){m.push({name:"index"}),d("index")}function o(){m.push({name:"meteorology"}),d("meteorology")}function w(){m.push({name:"nuclear"}),d("nuclear")}function C(){m.push({name:"evacuate"}),d("evacuate")}return(M,L)=>(Zi(),Ps(o2,{elevation:"0",height:"75","bg-color":"#f6f8fc"},{default:ii(()=>[O(Dv),O(pr,{onClick:b,"prepend-icon":a.index,class:"rounded-xl"},{default:ii(()=>[Yo("\u6838\u7535\u5206\u5E03")]),_:1},8,["prepend-icon"]),O(pr,{onClick:v,"prepend-icon":a.finance,class:"rounded-xl"},{default:ii(()=>[Yo("\u7ECF\u6D4E\u6548\u5E94")]),_:1},8,["prepend-icon"]),O(pr,{onClick:o,"prepend-icon":a.meteorology,class:"rounded-xl"},{default:ii(()=>[Yo("\u6C14\u8C61\u53CD\u6F14")]),_:1},8,["prepend-icon"]),O(pr,{onClick:w,"prepend-icon":a.nuclear,class:"rounded-xl"},{default:ii(()=>[Yo("\u4E8B\u6545\u6A21\u62DF")]),_:1},8,["prepend-icon"]),O(pr,{onClick:C,"prepend-icon":a.evacuate,class:"rounded-xl"},{default:ii(()=>[Yo("\u64A4\u79BB\u4EFF\u771F")]),_:1},8,["prepend-icon"]),O(Dv)]),_:1}))}});const M2=Pt({name:"VLayout",props:t2(),setup(t,a){let{slots:l}=a;const{layoutClasses:d,layoutStyles:m,getLayoutItem:v,items:b,layoutRef:o}=n2(t);return kt(()=>{var w;return O("div",{ref:o,class:d.value,style:m.value},[(w=l.default)==null?void 0:w.call(l)])}),{getLayoutItem:v,items:b}}});const Fz=Pt({name:"VLayoutItem",props:{position:{type:String,required:!0},size:{type:[Number,String],default:300},modelValue:Boolean,...nd()},setup(t,a){let{slots:l}=a;const{layoutItemStyles:d}=id({id:t.name,order:ne(()=>parseInt(t.order,10)),position:Tt(t,"position"),elementSize:Tt(t,"size"),layoutSize:Tt(t,"size"),active:Tt(t,"modelValue"),absolute:Tt(t,"absolute")});return()=>{var m;return O("div",{class:["v-layout-item"],style:d.value},[(m=l.default)==null?void 0:m.call(l)])}}});function Ny(){const t=Je(!1);return On(()=>{window.requestAnimationFrame(()=>{t.value=!0})}),{ssrBootStyles:ne(()=>t.value?void 0:{transition:"none !important"}),isBooted:vf(t)}}const P2=Pt({name:"VMain",props:{scrollable:Boolean,...Sn({tag:"main"})},setup(t,a){let{slots:l}=a;const{mainStyles:d}=UP(),{ssrBootStyles:m}=Ny();return kt(()=>{var v,b;return O(t.tag,{class:["v-main",{"v-main--scrollable":t.scrollable}],style:[d.value,m.value]},{default:()=>[t.scrollable?O("div",{class:"v-main__scroller"},[(v=l.default)==null?void 0:v.call(l)]):(b=l.default)==null?void 0:b.call(l)]})}),{}}}),Vz=vn({__name:"MainLayout",setup(t){return(a,l)=>{const d=fr("router-view");return Zi(),Ps(M2,null,{default:ii(()=>[O(Oz),O(P2,null,{default:ii(()=>[O(d,{name:"main_view"}),O(d,{name:"second"})]),_:1}),O(d,{name:"left_draw"})]),_:1})}}}),$z={components:{MainLayout:Vz}};const Nz=(t,a)=>{const l=t.__vccOpts||t;for(const[d,m]of a)l[d]=m;return l};function Uz(t,a,l,d,m,v){const b=fr("MainLayout");return Zi(),Ps(b)}const jz=Nz($z,[["render",Uz],["__scopeId","data-v-2cc332ae"]]);var Gz=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},z2={exports:{}};(function(t,a){(function(l,d){t.exports=d()})(Gz,function(){var l,d,m;function v(o,w){if(!l)l=w;else if(!d)d=w;else{var C="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+l+")(sharedChunk); ("+d+")(sharedChunk); self.onerror = null;",M={};l(M),m=w(M),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(m.workerUrl=window.URL.createObjectURL(new Blob([C],{type:"text/javascript"})))}}v(["exports"],function(o){var w=typeof self<"u"?self:{},C="2.13.0";let M;const L={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(M==null){const n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{M={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):n}catch{M=n}}return M},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},D={supported:!1,testSupport:function(n){!X&&q&&(xe?ce(n):V=n)}};let V,q,X=!1,xe=!1;function ce(n){const e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,q),n.isContextLost())return;D.supported=!0}catch{}n.deleteTexture(e),X=!0}w.document&&(q=w.document.createElement("img"),q.onload=function(){V&&ce(V),V=null,xe=!0},q.onerror=function(){X=!0,V=null},q.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const me="01";var ee=Ie;function Ie(n,e,i,s){this.cx=3*n,this.bx=3*(i-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=e,this.p2x=i,this.p2y=s}Ie.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,e){if(e===void 0&&(e=1e-6),n<0)return 0;if(n>1)return 1;for(var i=n,s=0;s<8;s++){var u=this.sampleCurveX(i)-n;if(Math.abs(u)<e)return i;var f=this.sampleCurveDerivativeX(i);if(Math.abs(f)<1e-6)break;i-=u/f}var g=0,y=1;for(i=n,s=0;s<20&&(u=this.sampleCurveX(i),!(Math.abs(u-n)<e));s++)n>u?g=i:y=i,i=.5*(y-g)+g;return i},solve:function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))}};var Y=ve;function ve(n,e){this.x=n,this.y=e}ve.prototype={clone:function(){return new ve(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,e){return this.clone()._rotateAround(n,e)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var e=n.x-this.x,i=n.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult:function(n){var e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var e=Math.cos(n),i=Math.sin(n),s=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=s,this},_rotateAround:function(n,e){var i=Math.cos(n),s=Math.sin(n),u=e.y+s*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-s*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ve.convert=function(n){return n instanceof ve?n:Array.isArray(n)?new ve(n[0],n[1]):n};const fe=Math.PI/180,ge=180/Math.PI;function Ee(n){return n*fe}function we(n){return n*ge}const Oe=[[0,0],[1,0],[1,1],[0,1]];function ze(n){if(n<=0)return 0;if(n>=1)return 1;const e=n*n,i=e*n;return 4*(n<.5?i:3*(n-e)+i-.75)}function Qe(n,e,i,s){const u=new ee(n,e,i,s);return function(f){return u.solve(f)}}const ht=Qe(.25,.1,.25,1);function nt(n,e,i){return Math.min(i,Math.max(e,n))}function ft(n,e,i){return(i=nt((i-n)/(e-n),0,1))*i*(3-2*i)}function Pe(n,e,i){const s=i-e,u=((n-e)%s+s)%s+e;return u===e?i:u}function at(n,e,i){if(!n.length)return i(null,[]);let s=n.length;const u=new Array(n.length);let f=null;n.forEach((g,y)=>{e(g,(T,S)=>{T&&(f=T),u[y]=S,--s==0&&i(f,u)})})}function jt(n){const e=[];for(const i in n)e.push(n[i]);return e}function pt(n,...e){for(const i of e)for(const s in i)n[s]=i[s];return n}let zt=1;function Gt(){return zt++}function zn(){return function n(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,n)}()}function At(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Ke(n){return!!n&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)}function xt(n,e){n.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function St(n,e){return n.indexOf(e,n.length-e.length)!==-1}function Nt(n,e,i){const s={};for(const u in n)s[u]=e.call(i||this,n[u],u,n);return s}function fn(n,e,i){const s={};for(const u in n)e.call(i||this,n[u],u,n)&&(s[u]=n[u]);return s}function Dn(n){return Array.isArray(n)?n.map(Dn):typeof n=="object"&&n?Nt(n,Dn):n}const gn={};function ue(n){gn[n]||(typeof console<"u"&&console.warn(n),gn[n]=!0)}function Me(n,e,i){return(i.y-n.y)*(e.x-n.x)>(e.y-n.y)*(i.x-n.x)}function qe(n){let e=0;for(let i,s,u=0,f=n.length,g=f-1;u<f;g=u++)i=n[u],s=n[g],e+=(s.x-i.x)*(i.y+s.y);return e}function st(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function yt(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,s,u,f)=>{const g=u||f;return e[s]=!g||g.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let Lt=null;function Vt(n){if(Lt==null){const e=n.navigator?n.navigator.userAgent:null;Lt=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Lt}function Mt(n){try{const e=w[n];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ot(n,e){return[n[4*e],n[4*e+1],n[4*e+2],n[4*e+3]]}const wt="mapbox-tiles";let Kt,Zt,rn=500,hn=50;function En(){try{return w.caches}catch{}}function Un(){En()&&!Kt&&(Kt=w.caches.open(wt))}function jn(n){const e=n.indexOf("?");if(e<0)return n;const i=function(u){const f=u.indexOf("?");return f>0?u.slice(f+1).split("&"):[]}(n),s=i.filter(u=>{const f=u.split("=");return f[0]==="language"||f[0]==="worldview"});return s.length?`${n.slice(0,e)}?${s.join("&")}`:n.slice(0,e)}let mi=1/0;const tr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(tr);class Wi extends Error{constructor(e,i,s){i===401&&Os(s)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const rs=st()?()=>self.worker&&self.worker.referrer:()=>(w.location.protocol==="blob:"?w.parent:w).location.href,Pr=function(n,e){if(!(/^file:/.test(i=n.url)||/^file:/.test(rs())&&!/^\w+:/.test(i))){if(w.fetch&&w.Request&&w.AbortController&&w.Request.prototype.hasOwnProperty("signal"))return function(s,u){const f=new w.AbortController,g=new w.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:rs(),signal:f.signal});let y=!1,T=!1;const S=(A=g.url).indexOf("sku=")>0&&Os(A);var A;s.type==="json"&&g.headers.set("Accept","application/json");const P=(F,$,j)=>{if(T)return;if(F&&F.message!=="SecurityError"&&ue(F),$&&j)return z($);const H=Date.now();w.fetch(g).then(ae=>{if(ae.ok){const _e=S?ae.clone():null;return z(ae,_e,H)}return u(new Wi(ae.statusText,ae.status,s.url))}).catch(ae=>{ae.name!=="AbortError"&&u(new Error(`${ae.message} ${s.url}`))})},z=(F,$,j)=>{(s.type==="arrayBuffer"?F.arrayBuffer():s.type==="json"?F.json():F.text()).then(H=>{T||($&&j&&function(ae,_e,ie){if(Un(),!Kt)return;const pe={status:_e.status,statusText:_e.statusText,headers:new w.Headers};_e.headers.forEach((je,$e)=>pe.headers.set($e,je));const Te=yt(_e.headers.get("Cache-Control")||"");if(Te["no-store"])return;Te["max-age"]&&pe.headers.set("Expires",new Date(ie+1e3*Te["max-age"]).toUTCString());const ye=pe.headers.get("Expires");ye&&(new Date(ye).getTime()-ie<42e4||function(je,$e){if(Zt===void 0)try{new Response(new ReadableStream),Zt=!0}catch{Zt=!1}Zt?$e(je.body):je.blob().then($e)}(_e,je=>{const $e=new w.Response(je,pe);Un(),Kt&&Kt.then(tt=>tt.put(jn(ae.url),$e)).catch(tt=>ue(tt.message))}))}(g,$,j),y=!0,u(null,H,F.headers.get("Cache-Control"),F.headers.get("Expires")))}).catch(H=>{T||u(new Error(H.message))})};return S?function(F,$){if(Un(),!Kt)return $(null);const j=jn(F.url);Kt.then(H=>{H.match(j).then(ae=>{const _e=function(ie){if(!ie)return!1;const pe=new Date(ie.headers.get("Expires")||0),Te=yt(ie.headers.get("Cache-Control")||"");return pe>Date.now()&&!Te["no-cache"]}(ae);H.delete(j),_e&&H.put(j,ae.clone()),$(null,ae,_e)}).catch($)}).catch($)}(g,P):P(null,null),{cancel:()=>{T=!0,y||f.abort()}}}(n,e);if(st()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e,void 0,!0)}var i;return function(s,u){const f=new w.XMLHttpRequest;f.open(s.method||"GET",s.url,!0),s.type==="arrayBuffer"&&(f.responseType="arraybuffer");for(const g in s.headers)f.setRequestHeader(g,s.headers[g]);return s.type==="json"&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials=s.credentials==="include",f.onerror=()=>{u(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||f.status===0)&&f.response!==null){let g=f.response;if(s.type==="json")try{g=JSON.parse(f.response)}catch(y){return u(y)}u(null,g,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else u(new Wi(f.statusText,f.status,s.url))},f.send(s.body),{cancel:()=>f.abort()}}(n,e)},mo=function(n,e){return Pr(pt(n,{type:"arrayBuffer"}),e)};function Ji(n){const e=w.document.createElement("a");return e.href=n,e.protocol===w.document.location.protocol&&e.host===w.document.location.host}const ar="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Bo,Bs;Bo=[],Bs=0;const ll=function(n,e){if(D.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),Bs>=L.MAX_PARALLEL_IMAGE_REQUESTS){const f={requestParameters:n,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Bo.push(f),f}Bs++;let i=!1;const s=()=>{if(!i)for(i=!0,Bs--;Bo.length&&Bs<L.MAX_PARALLEL_IMAGE_REQUESTS;){const f=Bo.shift(),{requestParameters:g,callback:y,cancelled:T}=f;T||(f.cancel=ll(g,y).cancel)}},u=mo(n,(f,g,y,T)=>{s(),f?e(f):g&&(w.createImageBitmap?function(S,A){const P=new w.Blob([new Uint8Array(S)],{type:"image/png"});w.createImageBitmap(P).then(z=>{A(null,z)}).catch(z=>{A(new Error(`Could not load image because of ${z.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(S,A)=>e(S,A,y,T)):function(S,A){const P=new w.Image,z=w.URL;P.onload=()=>{A(null,P),z.revokeObjectURL(P.src),P.onload=null,w.requestAnimationFrame(()=>{P.src=ar})},P.onerror=()=>A(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const F=new w.Blob([new Uint8Array(S)],{type:"image/png"});P.src=S.byteLength?z.createObjectURL(F):ar}(g,(S,A)=>e(S,A,y,T)))});return{cancel:()=>{u.cancel(),s()}}},Rs="NO_ACCESS_TOKEN";function io(n){return n.indexOf("mapbox:")===0}function Os(n){return L.API_URL_REGEX.test(n)}function Mc(n){return L.API_CDN_URL_REGEX.test(n)}function Pc(n){return L.API_STYLE_REGEX.test(n)&&!_a(n)}function _a(n){return L.API_SPRITE_REGEX.test(n)}const Fs=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Gr(n){const e=n.match(Fs);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function os(n){const e=n.params.length?`?${n.params.join("&")}`:"";return`${n.protocol}://${n.authority}${n.path}${e}`}function zc(n){if(!n)return null;const e=n.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(w.atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Vs{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=zc(L.ACCESS_TOKEN);let s="";return s=i&&i.u?w.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(u,f)=>String.fromCharCode(Number("0x"+f)))):L.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${s}`:`mapbox.eventData:${s}`}fetchEventData(){const e=Mt("localStorage"),i=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{const u=w.localStorage.getItem(i);u&&(this.eventData=JSON.parse(u));const f=w.localStorage.getItem(s);f&&(this.anonId=f)}catch{ue("Unable to read from LocalStorage")}}saveEventData(){const e=Mt("localStorage"),i=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{w.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&w.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{ue("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,s,u){if(!L.EVENTS_URL)return;const f=Gr(L.EVENTS_URL);f.params.push(`access_token=${u||L.ACCESS_TOKEN||""}`);const g={event:this.type,created:new Date(e).toISOString()},y=i?pt(g,i):g,T={url:os(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([y])};this.pendingRequest=function(S,A){return Pr(pt(S,{method:"POST"}),A)}(T,S=>{this.pendingRequest=null,s(S),this.saveEventData(),this.processRequests(u)})}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const oe=new class extends Vs{constructor(n){super("appUserTurnstile"),this._customAccessToken=n}postTurnstileEvent(n,e){L.EVENTS_URL&&L.ACCESS_TOKEN&&Array.isArray(n)&&n.some(i=>io(i)||Os(i))&&this.queueRequest(Date.now(),e)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=zc(L.ACCESS_TOKEN),i=e?e.u:L.ACCESS_TOKEN;let s=i!==this.eventData.tokenU;Ke(this.anonId)||(this.anonId=zn(),s=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const f=new Date(this.eventData.lastSuccess),g=new Date(u),y=(u-this.eventData.lastSuccess)/864e5;s=s||y>=1||y<-1||f.getDate()!==g.getDate()}else s=!0;s?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:me,"enabled.telemetry":!1,userId:this.anonId},f=>{f||(this.eventData.lastSuccess=u,this.eventData.tokenU=i)},n):this.processRequests()}},N=oe.postTurnstileEvent.bind(oe),G=new class extends Vs{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(n,e,i,s){this.skuToken=e,this.errorCb=s,L.EVENTS_URL&&(i||L.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Rs)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),Ke(this.anonId)||(this.anonId=zn()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:me,skuToken:this.skuToken,userId:this.anonId},s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},n))}},re=G.postMapLoadEvent.bind(G),he=new class extends Vs{constructor(){super("gljs.performance")}postPerformanceEvent(n,e){L.EVENTS_URL&&(n||L.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},n)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:i}=this.queue.shift(),s=function(u){const f=w.performance.getEntriesByType("resource"),g=w.performance.getEntriesByType("mark"),y=function(z){const F={};if(z){for(const $ in z)if($!=="other")for(const j of z[$]){const H=`${$}ResolveRangeMin`,ae=`${$}ResolveRangeMax`,_e=`${$}RequestCount`,ie=`${$}RequestCachedCount`;F[H]=Math.min(F[H]||1/0,j.startTime),F[ae]=Math.max(F[ae]||-1/0,j.responseEnd);const pe=Te=>{F[Te]===void 0&&(F[Te]=0),++F[Te]};j.transferSize!==void 0&&j.transferSize===0&&pe(ie),pe(_e)}}return F}(function(z,F){const $={};if(z)for(const j of z){const H=F(j);$[H]===void 0&&($[H]=[]),$[H].push(j)}return $}(f,Bt)),T=w.devicePixelRatio,S=w.navigator.connection||w.navigator.mozConnection||w.navigator.webkitConnection,A={counters:[],metadata:[],attributes:[]},P=(z,F,$)=>{$!=null&&z.push({name:F,value:$.toString()})};for(const z in y)P(A.counters,z,y[z]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(P(A.counters,"interactionRangeMin",u.interactionRange[0]),P(A.counters,"interactionRangeMax",u.interactionRange[1])),g)for(const z of Object.keys(Ve)){const F=Ve[z],$=g.find(j=>j.name===F);$&&P(A.counters,F,$.startTime)}return P(A.counters,"visibilityHidden",u.visibilityHidden),P(A.attributes,"style",function(z){if(z)for(const F of z){const $=F.name.split("?")[0];if(Pc($)){const j=$.split("/").slice(-2);if(j.length===2)return`mapbox://styles/${j[0]}/${j[1]}`}}}(f)),P(A.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),P(A.attributes,"fogEnabled",u.fogEnabled?"true":"false"),P(A.attributes,"projection",u.projection),P(A.attributes,"zoom",u.zoom),P(A.metadata,"devicePixelRatio",T),P(A.metadata,"connectionEffectiveType",S?S.effectiveType:void 0),P(A.metadata,"navigatorUserAgent",w.navigator.userAgent),P(A.metadata,"screenWidth",w.screen.width),P(A.metadata,"screenHeight",w.screen.height),P(A.metadata,"windowWidth",w.innerWidth),P(A.metadata,"windowHeight",w.innerHeight),P(A.metadata,"mapWidth",u.width/T),P(A.metadata,"mapHeight",u.height/T),P(A.metadata,"webglRenderer",u.renderer),P(A.metadata,"webglVendor",u.vendor),P(A.metadata,"sdkVersion",C),P(A.metadata,"sdkIdentifier","mapbox-gl-js"),A}(i);for(const u of s.metadata);for(const u of s.counters);for(const u of s.attributes);this.postEvent(e,s,()=>{},n)}},Ce=he.postPerformanceEvent.bind(he),Re=new class extends Vs{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(n,e,i,s){if(!L.API_URL||!L.SESSION_PATH)return;const u=Gr(L.API_URL+L.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${s||L.ACCESS_TOKEN||""}`);const f={url:os(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(g,y){return Pr(pt(g,{method:"GET"}),y)}(f,g=>{this.pendingRequest=null,i(g),this.saveEventData(),this.processRequests(s)})}getSessionAPI(n,e,i,s){this.skuToken=e,this.errorCb=s,L.SESSION_PATH&&L.API_URL&&(i||L.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Rs)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},n)}},De=Re.getSessionAPI.bind(Re),ke=new Set,Ve={create:"create",load:"load",fullLoad:"fullLoad"},ct={mark(n){w.performance.mark(n)},measure(n,e,i){w.performance.measure(n,e,i)}};function Bt(n){const e=n.name.split("?")[0];return Mc(e)&&e.includes("mapbox-gl.js")?"javascript":Mc(e)&&e.includes("mapbox-gl.css")?"css":function(i){return L.API_FONTS_REGEX.test(i)}(e)?"fontRange":_a(e)?"sprite":Pc(e)?"style":function(i){return L.API_TILEJSON_REGEX.test(i)}(e)?"tilejson":"other"}const gt=w.performance;function en(n){const e=n?n.url.toString():void 0;return gt.getEntriesByName(e)}let Jt,Yt,cn,_n;const Gn={now:()=>cn!==void 0?cn:w.performance.now(),setNow(n){cn=n},restoreNow(){cn=void 0},frame(n){const e=w.requestAnimationFrame(n);return{cancel:()=>w.cancelAnimationFrame(e)}},getImageData(n,e=0){const{width:i,height:s}=n;_n||(_n=w.document.createElement("canvas"));const u=_n.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(i>_n.width||s>_n.height)&&(_n.width=i,_n.height=s),u.clearRect(-e,-e,i+2*e,s+2*e),u.drawImage(n,0,0,i,s),u.getImageData(-e,-e,i+2*e,s+2*e)},resolveURL:n=>(Jt||(Jt=w.document.createElement("a")),Jt.href=n,Jt.href),get devicePixelRatio(){return w.devicePixelRatio},get prefersReducedMotion(){return!!w.matchMedia&&(Yt==null&&(Yt=w.matchMedia("(prefers-reduced-motion: reduce)")),Yt.matches)}};function on(n,e,i){i[n]&&i[n].indexOf(e)!==-1||(i[n]=i[n]||[],i[n].push(e))}function Jn(n,e,i){if(i&&i[n]){const s=i[n].indexOf(e);s!==-1&&i[n].splice(s,1)}}class Qn{constructor(e,i={}){pt(this,i),this.type=e}}class ss extends Qn{constructor(e,i={}){super("error",pt({error:e},i))}}class Ro{on(e,i){return this._listeners=this._listeners||{},on(e,i,this._listeners),this}off(e,i){return Jn(e,i,this._listeners),Jn(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},on(e,i,this._oneTimeListeners),this):new Promise(s=>this.once(e,s))}fire(e,i){typeof e=="string"&&(e=new Qn(e,i||{}));const s=e.type;if(this.listens(s)){e.target=this;const u=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const y of u)y.call(this,e);const f=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const y of f)Jn(s,y,this._oneTimeListeners),y.call(this,e);const g=this._eventedParent;g&&(pt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(e))}else e instanceof ss&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var et=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Oo(n,...e){for(const i of e)for(const s in i)n[s]=i[s];return n}function Oi(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function as(n){if(Array.isArray(n))return n.map(as);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const i in n)e[i]=as(n[i]);return e}return Oi(n)}class Ef extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}var go=Ef;class va{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[s,u]of i)this.bindings[s]=u}concat(e){return new va(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Cf=va;const ya={kind:"null"},Et={kind:"number"},Pn={kind:"string"},Cn={kind:"boolean"},_o={kind:"color"},$s={kind:"object"},bn={kind:"value"},cl={kind:"collator"},xa={kind:"formatted"},ba={kind:"resolvedImage"};function Cr(n,e){return{kind:"array",itemType:n,N:e}}function ai(n){if(n.kind==="array"){const e=ai(n.itemType);return typeof n.N=="number"?`array<${e}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${e}>`}return n.kind}const If=[ya,Et,Pn,Cn,_o,xa,$s,Cr(bn),ba];function zr(n,e){if(e.kind==="error")return null;if(n.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!zr(n.itemType,e.itemType))&&(typeof n.N!="number"||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if(n.kind==="value"){for(const i of If)if(!zr(i,e))return null}}return`Expected ${ai(n)} but found ${ai(e)} instead.`}function pd(n,e){return e.some(i=>i.kind===n.kind)}function Ns(n,e){return e.some(i=>i==="null"?n===null:i==="array"?Array.isArray(n):i==="object"?n&&!Array.isArray(n)&&typeof n=="object":i===typeof n)}var md,Lc={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ul(n){return(n=Math.round(n))<0?0:n>255?255:n}function Us(n){return ul(n[n.length-1]==="%"?parseFloat(n)/100*255:parseInt(n))}function wa(n){return(e=n[n.length-1]==="%"?parseFloat(n)/100:parseFloat(n))<0?0:e>1?1:e;var e}function gd(n,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?n+(e-n)*i*6:2*i<1?e:3*i<2?n+(e-n)*(2/3-i)*6:n}try{md={}.parseCSSColor=function(n){var e,i=n.replace(/ /g,"").toLowerCase();if(i in Lc)return Lc[i].slice();if(i[0]==="#")return i.length===4?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:i.length===7&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var s=i.indexOf("("),u=i.indexOf(")");if(s!==-1&&u+1===i.length){var f=i.substr(0,s),g=i.substr(s+1,u-(s+1)).split(","),y=1;switch(f){case"rgba":if(g.length!==4)return null;y=wa(g.pop());case"rgb":return g.length!==3?null:[Us(g[0]),Us(g[1]),Us(g[2]),y];case"hsla":if(g.length!==4)return null;y=wa(g.pop());case"hsl":if(g.length!==3)return null;var T=(parseFloat(g[0])%360+360)%360/360,S=wa(g[1]),A=wa(g[2]),P=A<=.5?A*(S+1):A+S-A*S,z=2*A-P;return[ul(255*gd(z,P,T+1/3)),ul(255*gd(z,P,T)),ul(255*gd(z,P,T-1/3)),y];default:return null}}return null}}catch{}class Lr{constructor(e,i,s,u=1){this.r=e,this.g=i,this.b=s,this.a=u}static parse(e){if(!e)return;if(e instanceof Lr)return e;if(typeof e!="string")return;const i=md(e);return i?new Lr(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,s,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(s)},${u})`}toArray(){const{r:e,g:i,b:s,a:u}=this;return u===0?[0,0,0,0]:[255*e/u,255*i/u,255*s/u,u]}toArray01(){const{r:e,g:i,b:s,a:u}=this;return u===0?[0,0,0,0]:[e/u,i/u,s/u,u]}toArray01PremultipliedAlpha(){const{r:e,g:i,b:s,a:u}=this;return[e,i,s,u]}}Lr.black=new Lr(0,0,0,1),Lr.white=new Lr(1,1,1,1),Lr.transparent=new Lr(0,0,0,0),Lr.red=new Lr(1,0,0,1),Lr.blue=new Lr(0,0,1,1);var zi=Lr;class Dc{constructor(e,i,s){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class dl{constructor(e,i,s,u,f){this.text=e.normalize?e.normalize():e,this.image=i,this.scale=s,this.fontStack=u,this.textColor=f}}class Dr{constructor(e){this.sections=e}static fromString(e){return new Dr([new dl(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Dr?e:Dr.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.name]);continue}e.push(i.text);const s={};i.fontStack&&(s["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(s["font-scale"]=i.scale),i.textColor&&(s["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(s)}return e}}class Ir{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Ir({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Af(n,e,i,s){return typeof n=="number"&&n>=0&&n<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[n,e,i,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[n,e,i,s]:[n,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Bc(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof zi||n instanceof Dc||n instanceof Dr||n instanceof Ir)return!0;if(Array.isArray(n)){for(const e of n)if(!Bc(e))return!1;return!0}if(typeof n=="object"){for(const e in n)if(!Bc(n[e]))return!1;return!0}return!1}function Hi(n){if(n===null)return ya;if(typeof n=="string")return Pn;if(typeof n=="boolean")return Cn;if(typeof n=="number")return Et;if(n instanceof zi)return _o;if(n instanceof Dc)return cl;if(n instanceof Dr)return xa;if(n instanceof Ir)return ba;if(Array.isArray(n)){const e=n.length;let i;for(const s of n){const u=Hi(s);if(i){if(i===u)continue;i=bn;break}i=u}return Cr(i||bn,e)}return $s}function hl(n){const e=typeof n;return n===null?"":e==="string"||e==="number"||e==="boolean"?String(n):n instanceof zi||n instanceof Dr||n instanceof Ir?n.toString():JSON.stringify(n)}class _d{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Bc(e[1]))return i.error("invalid value");const s=e[1];let u=Hi(s);const f=i.expectedType;return u.kind!=="array"||u.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(u=f),new _d(u,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof zi?["rgba"].concat(this.value.toArray()):this.value instanceof Dr?this.value.serialize():this.value}}var fl=_d,lr=class{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}};const Rc={string:Pn,number:Et,boolean:Cn,object:$s};class Ta{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let s,u=1;const f=e[0];if(f==="array"){let y,T;if(e.length>2){const S=e[1];if(typeof S!="string"||!(S in Rc)||S==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);y=Rc[S],u++}else y=bn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);T=e[2],u++}s=Cr(y,T)}else s=Rc[f];const g=[];for(;u<e.length;u++){const y=i.parse(e[u],u,bn);if(!y)return null;g.push(y)}return new Ta(s,g)}evaluate(e){for(let i=0;i<this.args.length;i++){const s=this.args[i].evaluate(e);if(!zr(this.type,Hi(s)))return s;if(i===this.args.length-1)throw new lr(`Expected value to be of type ${ai(this.type)}, but found ${ai(Hi(s))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if(e.kind==="array"){const s=e.itemType;if(s.kind==="string"||s.kind==="number"||s.kind==="boolean"){i.push(s.kind);const u=e.N;(typeof u=="number"||this.args.length>1)&&i.push(u)}}return i.concat(this.args.map(s=>s.serialize()))}}var Fo=Ta;class pl{constructor(e){this.type=xa,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const s=e[1];if(!Array.isArray(s)&&typeof s=="object")return i.error("First argument must be an image or text section.");const u=[];let f=!1;for(let g=1;g<=e.length-1;++g){const y=e[g];if(f&&typeof y=="object"&&!Array.isArray(y)){f=!1;let T=null;if(y["font-scale"]&&(T=i.parse(y["font-scale"],1,Et),!T))return null;let S=null;if(y["text-font"]&&(S=i.parse(y["text-font"],1,Cr(Pn)),!S))return null;let A=null;if(y["text-color"]&&(A=i.parse(y["text-color"],1,_o),!A))return null;const P=u[u.length-1];P.scale=T,P.font=S,P.textColor=A}else{const T=i.parse(e[g],1,bn);if(!T)return null;const S=T.type.kind;if(S!=="string"&&S!=="value"&&S!=="null"&&S!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:T,scale:null,font:null,textColor:null})}}return new pl(u)}evaluate(e){return new Dr(this.sections.map(i=>{const s=i.content.evaluate(e);return Hi(s)===ba?new dl("",s,null,null,null):new dl(hl(s),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const s={};i.scale&&(s["font-scale"]=i.scale.serialize()),i.font&&(s["text-font"]=i.font.serialize()),i.textColor&&(s["text-color"]=i.textColor.serialize()),e.push(s)}return e}}class Oc{constructor(e){this.type=ba,this.input=e}static parse(e,i){if(e.length!==2)return i.error("Expected two arguments.");const s=i.parse(e[1],1,Pn);return s?new Oc(s):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),s=Ir.fromString(i);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(i)>-1),s}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const xg={"to-boolean":Cn,"to-color":_o,"to-number":Et,"to-string":Pn};class vd{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const s=e[0];if((s==="to-boolean"||s==="to-string")&&e.length!==2)return i.error("Expected one argument.");const u=xg[s],f=[];for(let g=1;g<e.length;g++){const y=i.parse(e[g],g,bn);if(!y)return null;f.push(y)}return new vd(u,f)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let i,s;for(const u of this.args){if(i=u.evaluate(e),s=null,i instanceof zi)return i;if(typeof i=="string"){const f=e.parseColor(i);if(f)return f}else if(Array.isArray(i)&&(s=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Af(i[0],i[1],i[2],i[3]),!s))return new zi(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new lr(s||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const s of this.args){if(i=s.evaluate(e),i===null)return 0;const u=Number(i);if(!isNaN(u))return u}throw new lr(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?Dr.fromString(hl(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Ir.fromString(hl(this.args[0].evaluate(e))):hl(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new pl([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Oc(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Sa=vd;const kf=["Unknown","Point","LineString","Polygon"];var ml=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?kf[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:i,y:s}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*e-n[0])+this.featureDistanceData.bearing[1]*(s*e-n[1])}return 0}parseColor(n){let e=this._parseColorCache[n];return e||(e=this._parseColorCache[n]=zi.parse(n)),e}};class Ea{constructor(e,i,s,u){this.name=e,this.type=i,this._evaluate=s,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const s=e[0],u=Ea.definitions[s];if(!u)return i.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(u)?u[0]:u.type,g=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,y=g.filter(([S])=>!Array.isArray(S)||S.length===e.length-1);let T=null;for(const[S,A]of y){T=new Sd(i.registry,i.path,null,i.scope);const P=[];let z=!1;for(let F=1;F<e.length;F++){const $=e[F],j=Array.isArray(S)?S[F-1]:S.type,H=T.parse($,1+P.length,j);if(!H){z=!0;break}P.push(H)}if(!z)if(Array.isArray(S)&&S.length!==P.length)T.error(`Expected ${S.length} arguments, but found ${P.length} instead.`);else{for(let F=0;F<P.length;F++){const $=Array.isArray(S)?S[F]:S.type,j=P[F];T.concat(F+1).checkSubtype($,j.type)}if(T.errors.length===0)return new Ea(s,f,A,P)}}if(y.length===1)i.errors.push(...T.errors);else{const S=(y.length?y:g).map(([P])=>{return z=P,Array.isArray(z)?`(${z.map(ai).join(", ")})`:`(${ai(z.type)}...)`;var z}).join(" | "),A=[];for(let P=1;P<e.length;P++){const z=i.parse(e[P],1+A.length);if(!z)return null;A.push(ai(z.type))}i.error(`Expected arguments of type ${S}, but found (${A.join(", ")}) instead.`)}return null}static register(e,i){Ea.definitions=i;for(const s in i)e[s]=Ea}}var ls=Ea;class Fc{constructor(e,i,s){this.type=cl,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const s=e[1];if(typeof s!="object"||Array.isArray(s))return i.error("Collator options argument must be an object.");const u=i.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,Cn);if(!u)return null;const f=i.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,Cn);if(!f)return null;let g=null;return s.locale&&(g=i.parse(s.locale,1,Pn),!g)?null:new Fc(u,f,g)}evaluate(e){return new Dc(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const cs=8192;function Wr(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function gl(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function Mf(n,e){const i=(180+n[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(i*u*cs),Math.round(s*u*cs)]}function Pf(n,e,i){const s=n[0]-e[0],u=n[1]-e[1],f=n[0]-i[0],g=n[1]-i[1];return s*g-f*u==0&&s*f<=0&&u*g<=0}function Vc(n,e){let i=!1;for(let g=0,y=e.length;g<y;g++){const T=e[g];for(let S=0,A=T.length;S<A-1;S++){if(Pf(n,T[S],T[S+1]))return!1;(u=T[S])[1]>(s=n)[1]!=(f=T[S+1])[1]>s[1]&&s[0]<(f[0]-u[0])*(s[1]-u[1])/(f[1]-u[1])+u[0]&&(i=!i)}}var s,u,f;return i}function zf(n,e){for(let i=0;i<e.length;i++)if(Vc(n,e[i]))return!0;return!1}function yd(n,e,i,s){const u=s[0]-i[0],f=s[1]-i[1],g=(n[0]-i[0])*f-u*(n[1]-i[1]),y=(e[0]-i[0])*f-u*(e[1]-i[1]);return g>0&&y<0||g<0&&y>0}function xd(n,e,i){for(const S of i)for(let A=0;A<S.length-1;++A)if((y=[(g=S[A+1])[0]-(f=S[A])[0],g[1]-f[1]])[0]*(T=[(u=e)[0]-(s=n)[0],u[1]-s[1]])[1]-y[1]*T[0]!=0&&yd(s,u,f,g)&&yd(f,g,s,u))return!0;var s,u,f,g,y,T;return!1}function Ca(n,e){for(let i=0;i<n.length;++i)if(!Vc(n[i],e))return!1;for(let i=0;i<n.length-1;++i)if(xd(n[i],n[i+1],e))return!1;return!0}function Lf(n,e){for(let i=0;i<e.length;i++)if(Ca(n,e[i]))return!0;return!1}function $c(n,e,i){const s=[];for(let u=0;u<n.length;u++){const f=[];for(let g=0;g<n[u].length;g++){const y=Mf(n[u][g],i);Wr(e,y),f.push(y)}s.push(f)}return s}function Nc(n,e,i){const s=[];for(let u=0;u<n.length;u++){const f=$c(n[u],e,i);s.push(f)}return s}function bd(n,e,i,s){if(n[0]<i[0]||n[0]>i[2]){const u=.5*s;let f=n[0]-i[0]>u?-s:i[0]-n[0]>u?s:0;f===0&&(f=n[0]-i[2]>u?-s:i[2]-n[0]>u?s:0),n[0]+=f}Wr(e,n)}function js(n,e,i,s){const u=Math.pow(2,s.z)*cs,f=[s.x*cs,s.y*cs],g=[];if(!n)return g;for(const y of n)for(const T of y){const S=[T.x+f[0],T.y+f[1]];bd(S,e,i,u),g.push(S)}return g}function qn(n,e,i,s){const u=Math.pow(2,s.z)*cs,f=[s.x*cs,s.y*cs],g=[];if(!n)return g;for(const T of n){const S=[];for(const A of T){const P=[A.x+f[0],A.y+f[1]];Wr(e,P),S.push(P)}g.push(S)}if(e[2]-e[0]<=u/2){(y=e)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(const T of g)for(const S of T)bd(S,e,i,u)}var y;return g}class _l{constructor(e,i){this.type=Cn,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Bc(e[1])){const s=e[1];if(s.type==="FeatureCollection")for(let u=0;u<s.features.length;++u){const f=s.features[u].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new _l(s,s.features[u].geometry)}else if(s.type==="Feature"){const u=s.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new _l(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new _l(s,s)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(i,s){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(!g)return!1;if(s.type==="Polygon"){const y=$c(s.coordinates,f,g),T=js(i.geometry(),u,f,g);if(!gl(u,f))return!1;for(const S of T)if(!Vc(S,y))return!1}if(s.type==="MultiPolygon"){const y=Nc(s.coordinates,f,g),T=js(i.geometry(),u,f,g);if(!gl(u,f))return!1;for(const S of T)if(!zf(S,y))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(i,s){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(!g)return!1;if(s.type==="Polygon"){const y=$c(s.coordinates,f,g),T=qn(i.geometry(),u,f,g);if(!gl(u,f))return!1;for(const S of T)if(!Ca(S,y))return!1}if(s.type==="MultiPolygon"){const y=Nc(s.coordinates,f,g),T=qn(i.geometry(),u,f,g);if(!gl(u,f))return!1;for(const S of T)if(!Lf(S,y))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var wd=_l;function vl(n){if(n instanceof ls&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof wd)return!1;let e=!0;return n.eachChild(i=>{e&&!vl(i)&&(e=!1)}),e}function yl(n){if(n instanceof ls&&n.name==="feature-state")return!1;let e=!0;return n.eachChild(i=>{e&&!yl(i)&&(e=!1)}),e}function Uc(n,e){if(n instanceof ls&&e.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild(s=>{i&&!Uc(s,e)&&(i=!1)}),i}class jc{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const s=e[1];return i.scope.has(s)?new jc(s,i.scope.get(s)):i.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Td=jc;class Gc{constructor(e,i=[],s,u=new Cf,f=[]){this.registry=e,this.path=i,this.key=i.map(g=>`[${g}]`).join(""),this.scope=u,this.errors=f,this.expectedType=s}parse(e,i,s,u,f={}){return i?this.concat(i,s,u)._parse(e,f):this._parse(e,f)}_parse(e,i){function s(u,f,g){return g==="assert"?new Fo(f,[u]):g==="coerce"?new Sa(f,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[u];if(f){let g=f.parse(e,this);if(!g)return null;if(this.expectedType){const y=this.expectedType,T=g.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||T.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(y,T))return null}else g=s(g,y,i.typeAnnotation||"coerce");else g=s(g,y,i.typeAnnotation||"assert")}if(!(g instanceof fl)&&g.type.kind!=="resolvedImage"&&us(g)){const y=new ml;try{g=new fl(g.type,g.evaluate(y))}catch(T){return this.error(T.message),null}}return g}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,s){const u=typeof e=="number"?this.path.concat(e):this.path,f=s?this.scope.concat(s):this.scope;return new Gc(this.registry,u,i||null,f,this.errors)}error(e,...i){const s=`${this.key}${i.map(u=>`[${u}]`).join("")}`;this.errors.push(new go(s,e))}checkSubtype(e,i){const s=zr(e,i);return s&&this.error(s),s}}var Sd=Gc;function us(n){if(n instanceof Td)return us(n.boundExpression);if(n instanceof ls&&n.name==="error"||n instanceof Fc||n instanceof wd)return!1;const e=n instanceof Sa||n instanceof Fo;let i=!0;return n.eachChild(s=>{i=e?i&&us(s):i&&s instanceof fl}),!!i&&vl(n)&&Uc(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Gs(n,e){const i=n.length-1;let s,u,f=0,g=i,y=0;for(;f<=g;)if(y=Math.floor((f+g)/2),s=n[y],u=n[y+1],s<=e){if(y===i||e<u)return y;f=y+1}else{if(!(s>e))throw new lr("Input is not a number.");g=y-1}return 0}class qc{constructor(e,i,s){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[u,f]of s)this.labels.push(u),this.outputs.push(f)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const s=i.parse(e[1],1,Et);if(!s)return null;const u=[];let f=null;i.expectedType&&i.expectedType.kind!=="value"&&(f=i.expectedType);for(let g=1;g<e.length;g+=2){const y=g===1?-1/0:e[g],T=e[g+1],S=g,A=g+1;if(typeof y!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',S);if(u.length&&u[u.length-1][0]>=y)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',S);const P=i.parse(T,A,f);if(!P)return null;f=f||P.type,u.push([y,P])}return new qc(f,s,u)}evaluate(e){const i=this.labels,s=this.outputs;if(i.length===1)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return s[0].evaluate(e);const f=i.length;return u>=i[f-1]?s[f-1].evaluate(e):s[Gs(i,u)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}var Ed=qc;function Fn(n,e,i){return n*(1-i)+e*i}var xl=Object.freeze({__proto__:null,number:Fn,color:function(n,e,i){return new zi(Fn(n.r,e.r,i),Fn(n.g,e.g,i),Fn(n.b,e.b,i),Fn(n.a,e.a,i))},array:function(n,e,i){return n.map((s,u)=>Fn(s,e[u],i))}});const Df=.95047,Bf=1.08883,Cd=4/29,Id=6/29,Ad=3*Id*Id,Rf=Math.PI/180,bg=180/Math.PI;function Zc(n){return n>.008856451679035631?Math.pow(n,1/3):n/Ad+Cd}function kd(n){return n>Id?n*n*n:Ad*(n-Cd)}function Wc(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function Hc(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Of(n){const e=Hc(n.r),i=Hc(n.g),s=Hc(n.b),u=Zc((.4124564*e+.3575761*i+.1804375*s)/Df),f=Zc((.2126729*e+.7151522*i+.072175*s)/1);return{l:116*f-16,a:500*(u-f),b:200*(f-Zc((.0193339*e+.119192*i+.9503041*s)/Bf)),alpha:n.a}}function Ff(n){let e=(n.l+16)/116,i=isNaN(n.a)?e:e+n.a/500,s=isNaN(n.b)?e:e-n.b/200;return e=1*kd(e),i=Df*kd(i),s=Bf*kd(s),new zi(Wc(3.2404542*i-1.5371385*e-.4985314*s),Wc(-.969266*i+1.8760108*e+.041556*s),Wc(.0556434*i-.2040259*e+1.0572252*s),n.alpha)}function wg(n,e,i){const s=e-n;return n+i*(s>180||s<-180?s-360*Math.round(s/360):s)}const bl={forward:Of,reverse:Ff,interpolate:function(n,e,i){return{l:Fn(n.l,e.l,i),a:Fn(n.a,e.a,i),b:Fn(n.b,e.b,i),alpha:Fn(n.alpha,e.alpha,i)}}},wl={forward:function(n){const{l:e,a:i,b:s}=Of(n),u=Math.atan2(s,i)*bg;return{h:u<0?u+360:u,c:Math.sqrt(i*i+s*s),l:e,alpha:n.a}},reverse:function(n){const e=n.h*Rf,i=n.c;return Ff({l:n.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:n.alpha})},interpolate:function(n,e,i){return{h:wg(n.h,e.h,i),c:Fn(n.c,e.c,i),l:Fn(n.l,e.l,i),alpha:Fn(n.alpha,e.alpha,i)}}};var Vf=Object.freeze({__proto__:null,lab:bl,hcl:wl});class Tl{constructor(e,i,s,u,f){this.type=e,this.operator=i,this.interpolation=s,this.input=u,this.labels=[],this.outputs=[];for(const[g,y]of f)this.labels.push(g),this.outputs.push(y)}static interpolationFactor(e,i,s,u){let f=0;if(e.name==="exponential")f=Md(i,e.base,s,u);else if(e.name==="linear")f=Md(i,1,s,u);else if(e.name==="cubic-bezier"){const g=e.controlPoints;f=new ee(g[0],g[1],g[2],g[3]).solve(Md(i,1,s,u))}return f}static parse(e,i){let[s,u,f,...g]=e;if(!Array.isArray(u)||u.length===0)return i.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const S=u[1];if(typeof S!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:S}}else{if(u[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const S=u.slice(1);if(S.length!==4||S.some(A=>typeof A!="number"||A<0||A>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:S}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(f=i.parse(f,2,Et),!f)return null;const y=[];let T=null;s==="interpolate-hcl"||s==="interpolate-lab"?T=_o:i.expectedType&&i.expectedType.kind!=="value"&&(T=i.expectedType);for(let S=0;S<g.length;S+=2){const A=g[S],P=g[S+1],z=S+3,F=S+4;if(typeof A!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(y.length&&y[y.length-1][0]>=A)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',z);const $=i.parse(P,F,T);if(!$)return null;T=T||$.type,y.push([A,$])}return T.kind==="number"||T.kind==="color"||T.kind==="array"&&T.itemType.kind==="number"&&typeof T.N=="number"?new Tl(T,s,u,f,y):i.error(`Type ${ai(T)} is not interpolatable.`)}evaluate(e){const i=this.labels,s=this.outputs;if(i.length===1)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return s[0].evaluate(e);const f=i.length;if(u>=i[f-1])return s[f-1].evaluate(e);const g=Gs(i,u),y=Tl.interpolationFactor(this.interpolation,u,i[g],i[g+1]),T=s[g].evaluate(e),S=s[g+1].evaluate(e);return this.operator==="interpolate"?xl[this.type.kind.toLowerCase()](T,S,y):this.operator==="interpolate-hcl"?wl.reverse(wl.interpolate(wl.forward(T),wl.forward(S),y)):bl.reverse(bl.interpolate(bl.forward(T),bl.forward(S),y))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let s=0;s<this.labels.length;s++)i.push(this.labels[s],this.outputs[s].serialize());return i}}function Md(n,e,i,s){const u=s-i,f=n-i;return u===0?0:e===1?f/u:(Math.pow(e,f)-1)/(Math.pow(e,u)-1)}var vo=Tl;class Pd{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let s=null;const u=i.expectedType;u&&u.kind!=="value"&&(s=u);const f=[];for(const y of e.slice(1)){const T=i.parse(y,1+f.length,s,void 0,{typeAnnotation:"omit"});if(!T)return null;s=s||T.type,f.push(T)}const g=u&&f.some(y=>zr(u,y.type));return new Pd(g?bn:s,f)}evaluate(e){let i,s=null,u=0;for(const f of this.args){if(u++,s=f.evaluate(e),s&&s instanceof Ir&&!s.available&&(i||(i=s),s=null,u===this.args.length))return i;if(s!==null)break}return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var $f=Pd;class Xc{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const s=[];for(let f=1;f<e.length-1;f+=2){const g=e[f];if(typeof g!="string")return i.error(`Expected string, but found ${typeof g} instead.`,f);if(/[^a-zA-Z0-9_]/.test(g))return i.error("Variable names must contain only alphanumeric characters or '_'.",f);const y=i.parse(e[f+1],f+1);if(!y)return null;s.push([g,y])}const u=i.parse(e[e.length-1],e.length-1,i.expectedType,s);return u?new Xc(s,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,s]of this.bindings)e.push(i,s.serialize());return e.push(this.result.serialize()),e}}var zd=Xc;class Yc{constructor(e,i,s){this.type=e,this.index=i,this.input=s}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,Et),u=i.parse(e[2],2,Cr(i.expectedType||bn));return s&&u?new Yc(u.type.itemType,s,u):null}evaluate(e){const i=this.index.evaluate(e),s=this.input.evaluate(e);if(i<0)throw new lr(`Array index out of bounds: ${i} < 0.`);if(i>=s.length)throw new lr(`Array index out of bounds: ${i} > ${s.length-1}.`);if(i!==Math.floor(i))throw new lr(`Array index must be an integer, but found ${i} instead.`);return s[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Tg=Yc;class Ld{constructor(e,i){this.type=Cn,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,bn),u=i.parse(e[2],2,bn);return s&&u?pd(s.type,[Cn,Pn,Et,ya,bn])?new Ld(s,u):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ai(s.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(s==null)return!1;if(!Ns(i,["boolean","string","number","null"]))throw new lr(`Expected first argument to be of type boolean, string, number or null, but found ${ai(Hi(i))} instead.`);if(!Ns(s,["string","array"]))throw new lr(`Expected second argument to be of type array or string, but found ${ai(Hi(s))} instead.`);return s.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Nf=Ld;class Sl{constructor(e,i,s){this.type=Et,this.needle=e,this.haystack=i,this.fromIndex=s}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,bn),u=i.parse(e[2],2,bn);if(!s||!u)return null;if(!pd(s.type,[Cn,Pn,Et,ya,bn]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ai(s.type)} instead`);if(e.length===4){const f=i.parse(e[3],3,Et);return f?new Sl(s,u,f):null}return new Sl(s,u)}evaluate(e){const i=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!Ns(i,["boolean","string","number","null"]))throw new lr(`Expected first argument to be of type boolean, string, number or null, but found ${ai(Hi(i))} instead.`);if(!Ns(s,["string","array"]))throw new lr(`Expected second argument to be of type array or string, but found ${ai(Hi(s))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return s.indexOf(i,u)}return s.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Uf=Sl;class Dd{constructor(e,i,s,u,f,g){this.inputType=e,this.type=i,this.input=s,this.cases=u,this.outputs=f,this.otherwise=g}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let s,u;i.expectedType&&i.expectedType.kind!=="value"&&(u=i.expectedType);const f={},g=[];for(let S=2;S<e.length-1;S+=2){let A=e[S];const P=e[S+1];Array.isArray(A)||(A=[A]);const z=i.concat(S);if(A.length===0)return z.error("Expected at least one branch label.");for(const $ of A){if(typeof $!="number"&&typeof $!="string")return z.error("Branch labels must be numbers or strings.");if(typeof $=="number"&&Math.abs($)>Number.MAX_SAFE_INTEGER)return z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $=="number"&&Math.floor($)!==$)return z.error("Numeric branch labels must be integer values.");if(s){if(z.checkSubtype(s,Hi($)))return null}else s=Hi($);if(f[String($)]!==void 0)return z.error("Branch labels must be unique.");f[String($)]=g.length}const F=i.parse(P,S,u);if(!F)return null;u=u||F.type,g.push(F)}const y=i.parse(e[1],1,bn);if(!y)return null;const T=i.parse(e[e.length-1],e.length-1,u);return T?y.type.kind!=="value"&&i.concat(1).checkSubtype(s,y.type)?null:new Dd(s,u,y,f,g,T):null}evaluate(e){const i=this.input.evaluate(e);return(Hi(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),s=[],u={};for(const g of i){const y=u[this.cases[g]];y===void 0?(u[this.cases[g]]=s.length,s.push([this.cases[g],[g]])):s[y][1].push(g)}const f=g=>this.inputType.kind==="number"?Number(g):g;for(const[g,y]of s)e.push(y.length===1?f(y[0]):y.map(f)),e.push(this.outputs[g].serialize());return e.push(this.otherwise.serialize()),e}}var Sg=Dd;class Bd{constructor(e,i,s){this.type=e,this.branches=i,this.otherwise=s}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let s;i.expectedType&&i.expectedType.kind!=="value"&&(s=i.expectedType);const u=[];for(let g=1;g<e.length-1;g+=2){const y=i.parse(e[g],g,Cn);if(!y)return null;const T=i.parse(e[g+1],g+1,s);if(!T)return null;u.push([y,T]),s=s||T.type}const f=i.parse(e[e.length-1],e.length-1,s);return f?new Bd(s,u,f):null}evaluate(e){for(const[i,s]of this.branches)if(i.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,s]of this.branches)e(i),e(s);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Eg=Bd;class qs{constructor(e,i,s,u){this.type=e,this.input=i,this.beginIndex=s,this.endIndex=u}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,bn),u=i.parse(e[2],2,Et);if(!s||!u)return null;if(!pd(s.type,[Cr(bn),Pn,bn]))return i.error(`Expected first argument to be of type array or string, but found ${ai(s.type)} instead`);if(e.length===4){const f=i.parse(e[3],3,Et);return f?new qs(s.type,s,u,f):null}return new qs(s.type,s,u)}evaluate(e){const i=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!Ns(i,["string","array"]))throw new lr(`Expected first argument to be of type array or string, but found ${ai(Hi(i))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return i.slice(s,u)}return i.slice(s)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var jf=qs;function Rd(n,e){return n==="=="||n==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Gf(n,e,i,s){return s.compare(e,i)===0}function Ia(n,e,i){const s=n!=="=="&&n!=="!=";return class L2{constructor(f,g,y){this.type=Cn,this.lhs=f,this.rhs=g,this.collator=y,this.hasUntypedArgument=f.type.kind==="value"||g.type.kind==="value"}static parse(f,g){if(f.length!==3&&f.length!==4)return g.error("Expected two or three arguments.");const y=f[0];let T=g.parse(f[1],1,bn);if(!T)return null;if(!Rd(y,T.type))return g.concat(1).error(`"${y}" comparisons are not supported for type '${ai(T.type)}'.`);let S=g.parse(f[2],2,bn);if(!S)return null;if(!Rd(y,S.type))return g.concat(2).error(`"${y}" comparisons are not supported for type '${ai(S.type)}'.`);if(T.type.kind!==S.type.kind&&T.type.kind!=="value"&&S.type.kind!=="value")return g.error(`Cannot compare types '${ai(T.type)}' and '${ai(S.type)}'.`);s&&(T.type.kind==="value"&&S.type.kind!=="value"?T=new Fo(S.type,[T]):T.type.kind!=="value"&&S.type.kind==="value"&&(S=new Fo(T.type,[S])));let A=null;if(f.length===4){if(T.type.kind!=="string"&&S.type.kind!=="string"&&T.type.kind!=="value"&&S.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(A=g.parse(f[3],3,cl),!A)return null}return new L2(T,S,A)}evaluate(f){const g=this.lhs.evaluate(f),y=this.rhs.evaluate(f);if(s&&this.hasUntypedArgument){const T=Hi(g),S=Hi(y);if(T.kind!==S.kind||T.kind!=="string"&&T.kind!=="number")throw new lr(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${T.kind}, ${S.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const T=Hi(g),S=Hi(y);if(T.kind!=="string"||S.kind!=="string")return e(f,g,y)}return this.collator?i(f,g,y,this.collator.evaluate(f)):e(f,g,y)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){const f=[n];return this.eachChild(g=>{f.push(g.serialize())}),f}}}const Cg=Ia("==",function(n,e,i){return e===i},Gf),qf=Ia("!=",function(n,e,i){return e!==i},function(n,e,i,s){return!Gf(0,e,i,s)}),Zf=Ia("<",function(n,e,i){return e<i},function(n,e,i,s){return s.compare(e,i)<0}),Wf=Ia(">",function(n,e,i){return e>i},function(n,e,i,s){return s.compare(e,i)>0}),Od=Ia("<=",function(n,e,i){return e<=i},function(n,e,i,s){return s.compare(e,i)<=0}),Ig=Ia(">=",function(n,e,i){return e>=i},function(n,e,i,s){return s.compare(e,i)>=0});class Fd{constructor(e,i,s,u,f,g){this.type=Pn,this.number=e,this.locale=i,this.currency=s,this.unit=u,this.minFractionDigits=f,this.maxFractionDigits=g}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const s=i.parse(e[1],1,Et);if(!s)return null;const u=e[2];if(typeof u!="object"||Array.isArray(u))return i.error("NumberFormat options argument must be an object.");let f=null;if(u.locale&&(f=i.parse(u.locale,1,Pn),!f))return null;let g=null;if(u.currency&&(g=i.parse(u.currency,1,Pn),!g))return null;let y=null;if(u.unit&&(y=i.parse(u.unit,1,Pn),!y))return null;let T=null;if(u["min-fraction-digits"]&&(T=i.parse(u["min-fraction-digits"],1,Et),!T))return null;let S=null;return u["max-fraction-digits"]&&(S=i.parse(u["max-fraction-digits"],1,Et),!S)?null:new Fd(s,f,g,y,T,S)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Vd{constructor(e){this.type=Et,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=i.parse(e[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${ai(s.type)} instead.`):new Vd(s):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string"||Array.isArray(i))return i.length;throw new lr(`Expected value to be of type string or array, but found ${ai(Hi(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}const Hf={"==":Cg,"!=":qf,">":Wf,"<":Zf,">=":Ig,"<=":Od,array:Fo,at:Tg,boolean:Fo,case:Eg,coalesce:$f,collator:Fc,format:pl,image:Oc,in:Nf,"index-of":Uf,interpolate:vo,"interpolate-hcl":vo,"interpolate-lab":vo,length:Vd,let:zd,literal:fl,match:Sg,number:Fo,"number-format":Fd,object:Fo,slice:jf,step:Ed,string:Fo,"to-boolean":Sa,"to-color":Sa,"to-number":Sa,"to-string":Sa,var:Td,within:wd};function Xf(n,[e,i,s,u]){e=e.evaluate(n),i=i.evaluate(n),s=s.evaluate(n);const f=u?u.evaluate(n):1,g=Af(e,i,s,f);if(g)throw new lr(g);return new zi(e/255*f,i/255*f,s/255*f,f)}function Yf(n,e){return n in e}function $d(n,e){const i=e[n];return i===void 0?null:i}function ds(n){return{type:n}}ls.register(Hf,{error:[{kind:"error"},[Pn],(n,[e])=>{throw new lr(e.evaluate(n))}],typeof:[Pn,[bn],(n,[e])=>ai(Hi(e.evaluate(n)))],"to-rgba":[Cr(Et,4),[_o],(n,[e])=>e.evaluate(n).toArray()],rgb:[_o,[Et,Et,Et],Xf],rgba:[_o,[Et,Et,Et,Et],Xf],has:{type:Cn,overloads:[[[Pn],(n,[e])=>Yf(e.evaluate(n),n.properties())],[[Pn,$s],(n,[e,i])=>Yf(e.evaluate(n),i.evaluate(n))]]},get:{type:bn,overloads:[[[Pn],(n,[e])=>$d(e.evaluate(n),n.properties())],[[Pn,$s],(n,[e,i])=>$d(e.evaluate(n),i.evaluate(n))]]},"feature-state":[bn,[Pn],(n,[e])=>$d(e.evaluate(n),n.featureState||{})],properties:[$s,[],n=>n.properties()],"geometry-type":[Pn,[],n=>n.geometryType()],id:[bn,[],n=>n.id()],zoom:[Et,[],n=>n.globals.zoom],pitch:[Et,[],n=>n.globals.pitch||0],"distance-from-center":[Et,[],n=>n.distanceFromCenter()],"heatmap-density":[Et,[],n=>n.globals.heatmapDensity||0],"line-progress":[Et,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[Et,[],n=>n.globals.skyRadialProgress||0],accumulated:[bn,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[Et,ds(Et),(n,e)=>{let i=0;for(const s of e)i+=s.evaluate(n);return i}],"*":[Et,ds(Et),(n,e)=>{let i=1;for(const s of e)i*=s.evaluate(n);return i}],"-":{type:Et,overloads:[[[Et,Et],(n,[e,i])=>e.evaluate(n)-i.evaluate(n)],[[Et],(n,[e])=>-e.evaluate(n)]]},"/":[Et,[Et,Et],(n,[e,i])=>e.evaluate(n)/i.evaluate(n)],"%":[Et,[Et,Et],(n,[e,i])=>e.evaluate(n)%i.evaluate(n)],ln2:[Et,[],()=>Math.LN2],pi:[Et,[],()=>Math.PI],e:[Et,[],()=>Math.E],"^":[Et,[Et,Et],(n,[e,i])=>Math.pow(e.evaluate(n),i.evaluate(n))],sqrt:[Et,[Et],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[Et,[Et],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[Et,[Et],(n,[e])=>Math.log(e.evaluate(n))],log2:[Et,[Et],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[Et,[Et],(n,[e])=>Math.sin(e.evaluate(n))],cos:[Et,[Et],(n,[e])=>Math.cos(e.evaluate(n))],tan:[Et,[Et],(n,[e])=>Math.tan(e.evaluate(n))],asin:[Et,[Et],(n,[e])=>Math.asin(e.evaluate(n))],acos:[Et,[Et],(n,[e])=>Math.acos(e.evaluate(n))],atan:[Et,[Et],(n,[e])=>Math.atan(e.evaluate(n))],min:[Et,ds(Et),(n,e)=>Math.min(...e.map(i=>i.evaluate(n)))],max:[Et,ds(Et),(n,e)=>Math.max(...e.map(i=>i.evaluate(n)))],abs:[Et,[Et],(n,[e])=>Math.abs(e.evaluate(n))],round:[Et,[Et],(n,[e])=>{const i=e.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[Et,[Et],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[Et,[Et],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[Cn,[Pn,bn],(n,[e,i])=>n.properties()[e.value]===i.value],"filter-id-==":[Cn,[bn],(n,[e])=>n.id()===e.value],"filter-type-==":[Cn,[Pn],(n,[e])=>n.geometryType()===e.value],"filter-<":[Cn,[Pn,bn],(n,[e,i])=>{const s=n.properties()[e.value],u=i.value;return typeof s==typeof u&&s<u}],"filter-id-<":[Cn,[bn],(n,[e])=>{const i=n.id(),s=e.value;return typeof i==typeof s&&i<s}],"filter->":[Cn,[Pn,bn],(n,[e,i])=>{const s=n.properties()[e.value],u=i.value;return typeof s==typeof u&&s>u}],"filter-id->":[Cn,[bn],(n,[e])=>{const i=n.id(),s=e.value;return typeof i==typeof s&&i>s}],"filter-<=":[Cn,[Pn,bn],(n,[e,i])=>{const s=n.properties()[e.value],u=i.value;return typeof s==typeof u&&s<=u}],"filter-id-<=":[Cn,[bn],(n,[e])=>{const i=n.id(),s=e.value;return typeof i==typeof s&&i<=s}],"filter->=":[Cn,[Pn,bn],(n,[e,i])=>{const s=n.properties()[e.value],u=i.value;return typeof s==typeof u&&s>=u}],"filter-id->=":[Cn,[bn],(n,[e])=>{const i=n.id(),s=e.value;return typeof i==typeof s&&i>=s}],"filter-has":[Cn,[bn],(n,[e])=>e.value in n.properties()],"filter-has-id":[Cn,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[Cn,[Cr(Pn)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[Cn,[Cr(bn)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[Cn,[Pn,Cr(bn)],(n,[e,i])=>i.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[Cn,[Pn,Cr(bn)],(n,[e,i])=>function(s,u,f,g){for(;f<=g;){const y=f+g>>1;if(u[y]===s)return!0;u[y]>s?g=y-1:f=y+1}return!1}(n.properties()[e.value],i.value,0,i.value.length-1)],all:{type:Cn,overloads:[[[Cn,Cn],(n,[e,i])=>e.evaluate(n)&&i.evaluate(n)],[ds(Cn),(n,e)=>{for(const i of e)if(!i.evaluate(n))return!1;return!0}]]},any:{type:Cn,overloads:[[[Cn,Cn],(n,[e,i])=>e.evaluate(n)||i.evaluate(n)],[ds(Cn),(n,e)=>{for(const i of e)if(i.evaluate(n))return!0;return!1}]]},"!":[Cn,[Cn],(n,[e])=>!e.evaluate(n)],"is-supported-script":[Cn,[Pn],(n,[e])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(e.evaluate(n))}],upcase:[Pn,[Pn],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[Pn,[Pn],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[Pn,ds(bn),(n,e)=>e.map(i=>hl(i.evaluate(n))).join("")],"resolved-locale":[Pn,[cl],(n,[e])=>e.evaluate(n).resolvedLocale()]});var Aa=Hf;function El(n){return{result:"success",value:n}}function ka(n){return{result:"error",value:n}}function Ma(n){return n["property-type"]==="data-driven"}function Vo(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function Kc(n){return!!n.expression&&n.expression.interpolated}function Bn(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Jc(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function Ag(n){return n}function Nd(n,e){const i=e.type==="color",s=n.stops&&typeof n.stops[0][0]=="object",u=s||!(s||n.property!==void 0),f=n.type||(Kc(e)?"exponential":"interval");if(i&&((n=Oo({},n)).stops&&(n.stops=n.stops.map(S=>[S[0],zi.parse(S[1])])),n.default=zi.parse(n.default?n.default:e.default)),n.colorSpace&&n.colorSpace!=="rgb"&&!Vf[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let g,y,T;if(f==="exponential")g=Qc;else if(f==="interval")g=Kf;else if(f==="categorical"){g=Ud,y=Object.create(null);for(const S of n.stops)y[S[0]]=S[1];T=typeof n.stops[0][0]}else{if(f!=="identity")throw new Error(`Unknown function type "${f}"`);g=Jf}if(s){const S={},A=[];for(let F=0;F<n.stops.length;F++){const $=n.stops[F],j=$[0].zoom;S[j]===void 0&&(S[j]={zoom:j,type:n.type,property:n.property,default:n.default,stops:[]},A.push(j)),S[j].stops.push([$[0].value,$[1]])}const P=[];for(const F of A)P.push([S[F].zoom,Nd(S[F],e)]);const z={name:"linear"};return{kind:"composite",interpolationType:z,interpolationFactor:vo.interpolationFactor.bind(void 0,z),zoomStops:P.map(F=>F[0]),evaluate:({zoom:F},$)=>Qc({stops:P,base:n.base},e,F).evaluate(F,$)}}if(u){const S=f==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:vo.interpolationFactor.bind(void 0,S),zoomStops:n.stops.map(A=>A[0]),evaluate:({zoom:A})=>g(n,e,A,y,T)}}return{kind:"source",evaluate(S,A){const P=A&&A.properties?A.properties[n.property]:void 0;return P===void 0?Cl(n.default,e.default):g(n,e,P,y,T)}}}function Cl(n,e,i){return n!==void 0?n:e!==void 0?e:i!==void 0?i:void 0}function Ud(n,e,i,s,u){return Cl(typeof i===u?s[i]:void 0,n.default,e.default)}function Kf(n,e,i){if(Bn(i)!=="number")return Cl(n.default,e.default);const s=n.stops.length;if(s===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[s-1][0])return n.stops[s-1][1];const u=Gs(n.stops.map(f=>f[0]),i);return n.stops[u][1]}function Qc(n,e,i){const s=n.base!==void 0?n.base:1;if(Bn(i)!=="number")return Cl(n.default,e.default);const u=n.stops.length;if(u===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[u-1][0])return n.stops[u-1][1];const f=Gs(n.stops.map(A=>A[0]),i),g=function(A,P,z,F){const $=F-z,j=A-z;return $===0?0:P===1?j/$:(Math.pow(P,j)-1)/(Math.pow(P,$)-1)}(i,s,n.stops[f][0],n.stops[f+1][0]),y=n.stops[f][1],T=n.stops[f+1][1];let S=xl[e.type]||Ag;if(n.colorSpace&&n.colorSpace!=="rgb"){const A=Vf[n.colorSpace];S=(P,z)=>A.reverse(A.interpolate(A.forward(P),A.forward(z),g))}return typeof y.evaluate=="function"?{evaluate(...A){const P=y.evaluate.apply(void 0,A),z=T.evaluate.apply(void 0,A);if(P!==void 0&&z!==void 0)return S(P,z,g)}}:S(y,T,g)}function Jf(n,e,i){return e.type==="color"?i=zi.parse(i):e.type==="formatted"?i=Dr.fromString(i.toString()):e.type==="resolvedImage"?i=Ir.fromString(i.toString()):Bn(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0),Cl(i,n.default,e.default)}class eu{constructor(e,i){this.expression=e,this._warningHistory={},this._evaluator=new ml,this._defaultValue=i?function(s){return s.type==="color"&&(Jc(s.default)||Array.isArray(s.default))?new zi(0,0,0,0):s.type==="color"?zi.parse(s.default)||null:s.default===void 0?null:s.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(e,i,s,u,f,g,y,T){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=s,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,s,u,f,g,y,T){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=s||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=T||null;try{const S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new lr(`Expected value to be one of ${Object.keys(this._enumValues).map(A=>JSON.stringify(A)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function Pa(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in Aa}function za(n,e){const i=new Sd(Aa,[],e?function(u){const f={color:_o,string:Pn,number:Et,enum:Pn,boolean:Cn,formatted:xa,resolvedImage:ba};return u.type==="array"?Cr(f[u.value]||bn,u.length):f[u.type]}(e):void 0),s=i.parse(n,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return s?El(new eu(s,e)):ka(i.errors)}class tu{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent=e!=="constant"&&!yl(i.expression)}evaluateWithoutErrorHandling(e,i,s,u,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,i,s,u,f,g)}evaluate(e,i,s,u,f,g){return this._styleExpression.evaluate(e,i,s,u,f,g)}}class Zs{constructor(e,i,s,u){this.kind=e,this.zoomStops=s,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!yl(i.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,i,s,u,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,i,s,u,f,g)}evaluate(e,i,s,u,f,g){return this._styleExpression.evaluate(e,i,s,u,f,g)}interpolationFactor(e,i,s){return this.interpolationType?vo.interpolationFactor(this.interpolationType,e,i,s):0}}function Ws(n,e){if((n=za(n,e)).result==="error")return n;const i=n.value.expression,s=vl(i);if(!s&&!Ma(e))return ka([new go("","data expressions not supported")]);const u=Uc(i,["zoom","pitch","distance-from-center"]);if(!u&&!Vo(e))return ka([new go("","zoom expressions not supported")]);const f=Al(i);return f||u?f instanceof go?ka([f]):f instanceof vo&&!Kc(e)?ka([new go("",'"interpolate" expressions cannot be used with this property')]):El(f?new Zs(s?"camera":"composite",n.value,f.labels,f instanceof vo?f.interpolation:void 0):new tu(s?"constant":"source",n.value)):ka([new go("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Il{constructor(e,i){this._parameters=e,this._specification=i,Oo(this,Nd(this._parameters,this._specification))}static deserialize(e){return new Il(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Al(n){let e=null;if(n instanceof zd)e=Al(n.result);else if(n instanceof $f){for(const i of n.args)if(e=Al(i),e)break}else(n instanceof Ed||n instanceof vo)&&n.input instanceof ls&&n.input.name==="zoom"&&(e=n);return e instanceof go||n.eachChild(i=>{const s=Al(i);s instanceof go?e=s:!e&&s?e=new go("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&s&&e!==s&&(e=new go("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class Rt{constructor(e,i,s,u){this.message=(e?`${e}: `:"")+s,u&&(this.identifier=u),i!=null&&i.__line__&&(this.line=i.__line__)}}function Hr(n){const e=n.key,i=n.value,s=n.valueSpec||{},u=n.objectElementValidators||{},f=n.style,g=n.styleSpec;let y=[];const T=Bn(i);if(T!=="object")return[new Rt(e,i,`object expected, ${T} found`)];for(const S in i){const A=S.split(".")[0],P=s[A]||s["*"];let z;u[A]?z=u[A]:s[A]?z=_r:u["*"]?z=u["*"]:s["*"]&&(z=_r),z?y=y.concat(z({key:(e&&`${e}.`)+S,value:i[S],valueSpec:P,style:f,styleSpec:g,object:i,objectKey:S},i)):y.push(new Rt(e,i[S],`unknown property "${S}"`))}for(const S in s)u[S]||s[S].required&&s[S].default===void 0&&i[S]===void 0&&y.push(new Rt(e,i,`missing required property "${S}"`));return y}function Qf(n){const e=n.value,i=n.valueSpec,s=n.style,u=n.styleSpec,f=n.key,g=n.arrayElementValidator||_r;if(Bn(e)!=="array")return[new Rt(f,e,`array expected, ${Bn(e)} found`)];if(i.length&&e.length!==i.length)return[new Rt(f,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new Rt(f,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let y={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};u.$version<7&&(y.function=i.function),Bn(i.value)==="object"&&(y=i.value);let T=[];for(let S=0;S<e.length;S++)T=T.concat(g({array:e,arrayIndex:S,value:e[S],valueSpec:y,style:s,styleSpec:u,key:`${f}[${S}]`}));return T}function jd(n){const e=n.key,i=n.value,s=n.valueSpec;let u=Bn(i);if(u==="number"&&i!=i&&(u="NaN"),u!=="number")return[new Rt(e,i,`number expected, ${u} found`)];if("minimum"in s){let f=s.minimum;if(Bn(s.minimum)==="array"&&(f=s.minimum[n.arrayIndex]),i<f)return[new Rt(e,i,`${i} is less than the minimum value ${f}`)]}if("maximum"in s){let f=s.maximum;if(Bn(s.maximum)==="array"&&(f=s.maximum[n.arrayIndex]),i>f)return[new Rt(e,i,`${i} is greater than the maximum value ${f}`)]}return[]}function kl(n){const e=n.valueSpec,i=Oi(n.value.type);let s,u,f,g={};const y=i!=="categorical"&&n.value.property===void 0,T=!y,S=Bn(n.value.stops)==="array"&&Bn(n.value.stops[0])==="array"&&Bn(n.value.stops[0][0])==="object",A=Hr({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(F){if(i==="identity")return[new Rt(F.key,F.value,'identity function may not have a "stops" property')];let $=[];const j=F.value;return $=$.concat(Qf({key:F.key,value:j,valueSpec:F.valueSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:P})),Bn(j)==="array"&&j.length===0&&$.push(new Rt(F.key,j,"array must have at least one stop")),$},default:function(F){return _r({key:F.key,value:F.value,valueSpec:e,style:F.style,styleSpec:F.styleSpec})}}});return i==="identity"&&y&&A.push(new Rt(n.key,n.value,'missing required property "property"')),i==="identity"||n.value.stops||A.push(new Rt(n.key,n.value,'missing required property "stops"')),i==="exponential"&&n.valueSpec.expression&&!Kc(n.valueSpec)&&A.push(new Rt(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(T&&!Ma(n.valueSpec)?A.push(new Rt(n.key,n.value,"property functions not supported")):y&&!Vo(n.valueSpec)&&A.push(new Rt(n.key,n.value,"zoom functions not supported"))),i!=="categorical"&&!S||n.value.property!==void 0||A.push(new Rt(n.key,n.value,'"property" property is required')),A;function P(F){let $=[];const j=F.value,H=F.key;if(Bn(j)!=="array")return[new Rt(H,j,`array expected, ${Bn(j)} found`)];if(j.length!==2)return[new Rt(H,j,`array length 2 expected, length ${j.length} found`)];if(S){if(Bn(j[0])!=="object")return[new Rt(H,j,`object expected, ${Bn(j[0])} found`)];if(j[0].zoom===void 0)return[new Rt(H,j,"object stop key must have zoom")];if(j[0].value===void 0)return[new Rt(H,j,"object stop key must have value")];const ae=Oi(j[0].zoom);if(typeof ae!="number")return[new Rt(H,j[0].zoom,"stop zoom values must be numbers")];if(f&&f>ae)return[new Rt(H,j[0].zoom,"stop zoom values must appear in ascending order")];ae!==f&&(f=ae,u=void 0,g={}),$=$.concat(Hr({key:`${H}[0]`,value:j[0],valueSpec:{zoom:{}},style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:jd,value:z}}))}else $=$.concat(z({key:`${H}[0]`,value:j[0],valueSpec:{},style:F.style,styleSpec:F.styleSpec},j));return Pa(as(j[1]))?$.concat([new Rt(`${H}[1]`,j[1],"expressions are not allowed in function stops.")]):$.concat(_r({key:`${H}[1]`,value:j[1],valueSpec:e,style:F.style,styleSpec:F.styleSpec}))}function z(F,$){const j=Bn(F.value),H=Oi(F.value),ae=F.value!==null?F.value:$;if(s){if(j!==s)return[new Rt(F.key,ae,`${j} stop domain type must match previous stop domain type ${s}`)]}else s=j;if(j!=="number"&&j!=="string"&&j!=="boolean"&&typeof H!="number"&&typeof H!="string"&&typeof H!="boolean")return[new Rt(F.key,ae,"stop domain value must be a number, string, or boolean")];if(j!=="number"&&i!=="categorical"){let _e=`number expected, ${j} found`;return Ma(e)&&i===void 0&&(_e+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Rt(F.key,ae,_e)]}return i!=="categorical"||j!=="number"||typeof H=="number"&&isFinite(H)&&Math.floor(H)===H?i!=="categorical"&&j==="number"&&typeof H=="number"&&typeof u=="number"&&u!==void 0&&H<u?[new Rt(F.key,ae,"stop domain values must appear in ascending order")]:(u=H,i==="categorical"&&H in g?[new Rt(F.key,ae,"stop domain values must be unique")]:(g[H]=!0,[])):[new Rt(F.key,ae,`integer expected, found ${String(H)}`)]}}function La(n){const e=(n.expressionContext==="property"?Ws:za)(as(n.value),n.valueSpec);if(e.result==="error")return e.value.map(s=>new Rt(`${n.key}${s.key}`,n.value,s.message));const i=e.value.expression||e.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!i.outputDefined())return[new Rt(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!yl(i))return[new Rt(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter")return ep(i,n);if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!Uc(i,["zoom","feature-state"]))return[new Rt(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!vl(i))return[new Rt(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ep(n,e){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const u of e.valueSpec.expression.parameters)i.delete(u);if(i.size===0)return[];const s=[];return n instanceof ls&&i.has(n.name)?[new Rt(e.key,e.value,`["${n.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(n.eachChild(u=>{s.push(...ep(u,e))}),s)}function nu(n){const e=n.key,i=n.value,s=n.valueSpec,u=[];return Array.isArray(s.values)?s.values.indexOf(Oi(i))===-1&&u.push(new Rt(e,i,`expected one of [${s.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(s.values).indexOf(Oi(i))===-1&&u.push(new Rt(e,i,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(i)} found`)),u}function Gd(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!Gd(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function iu(n,e="fill"){if(n==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Gd(n)||(n=ou(n));const i=n;let s=!0;try{s=function(S){if(!nr(S))return S;let A=as(S);return Pl(A),A=Ml(A),A}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const u=et[`filter_${e}`],f=za(s,u);let g=null;if(f.result==="error")throw new Error(f.value.map(S=>`${S.key}: ${S.message}`).join(", "));g=(S,A,P)=>f.value.evaluate(S,A,{},P);let y=null,T=null;if(s!==i){const S=za(i,u);if(S.result==="error")throw new Error(S.value.map(A=>`${A.key}: ${A.message}`).join(", "));y=(A,P,z,F,$)=>S.value.evaluate(A,P,{},z,void 0,void 0,F,$),T=!vl(S.value.expression)}return{filter:g,dynamicFilter:y||void 0,needGeometry:tp(s),needFeature:!!T}}function Ml(n){if(!Array.isArray(n))return n;const e=function(i){if(ru.has(i[0])){for(let s=1;s<i.length;s++)if(nr(i[s]))return!0}return i}(n);return e===!0?e:e.map(i=>Ml(i))}function Pl(n){let e=!1;const i=[];if(n[0]==="case"){for(let s=1;s<n.length-1;s+=2)e=e||nr(n[s]),i.push(n[s+1]);i.push(n[n.length-1])}else if(n[0]==="match"){e=e||nr(n[1]);for(let s=2;s<n.length-1;s+=2)i.push(n[s+1]);i.push(n[n.length-1])}else if(n[0]==="step"){e=e||nr(n[1]);for(let s=1;s<n.length-1;s+=2)i.push(n[s+1])}e&&(n.length=0,n.push("any",...i));for(let s=1;s<n.length;s++)Pl(n[s])}function nr(n){if(!Array.isArray(n))return!1;if((e=n[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let i=1;i<n.length;i++)if(nr(n[i]))return!0;return!1}const ru=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function kg(n,e){return n<e?-1:n>e?1:0}function tp(n){if(!Array.isArray(n))return!1;if(n[0]==="within")return!0;for(let e=1;e<n.length;e++)if(tp(n[e]))return!0;return!1}function ou(n){if(!n)return!0;const e=n[0];return n.length<=1?e!=="any":e==="=="?qd(n[1],n[2],"=="):e==="!="?Da(qd(n[1],n[2],"==")):e==="<"||e===">"||e==="<="||e===">="?qd(n[1],n[2],e):e==="any"?(i=n.slice(1),["any"].concat(i.map(ou))):e==="all"?["all"].concat(n.slice(1).map(ou)):e==="none"?["all"].concat(n.slice(1).map(ou).map(Da)):e==="in"?su(n[1],n.slice(2)):e==="!in"?Da(su(n[1],n.slice(2))):e==="has"?np(n[1]):e==="!has"?Da(np(n[1])):e!=="within"||n;var i}function qd(n,e,i){switch(n){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,n,e]}}function su(n,e){if(e.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",n,["literal",e.sort(kg)]]:["filter-in-small",n,["literal",e]]}}function np(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Da(n){return["!",n]}function Zd(n){return Gd(as(n.value))?La(Oo({},n,{expressionContext:"filter",valueSpec:n.styleSpec[`filter_${n.layerType||"fill"}`]})):ip(n)}function ip(n){const e=n.value,i=n.key;if(Bn(e)!=="array")return[new Rt(i,e,`array expected, ${Bn(e)} found`)];const s=n.styleSpec;let u,f=[];if(e.length<1)return[new Rt(i,e,"filter array must have at least 1 element")];switch(f=f.concat(nu({key:`${i}[0]`,value:e[0],valueSpec:s.filter_operator,style:n.style,styleSpec:n.styleSpec})),Oi(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Oi(e[1])==="$type"&&f.push(new Rt(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&f.push(new Rt(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=Bn(e[1]),u!=="string"&&f.push(new Rt(`${i}[1]`,e[1],`string expected, ${u} found`)));for(let g=2;g<e.length;g++)u=Bn(e[g]),Oi(e[1])==="$type"?f=f.concat(nu({key:`${i}[${g}]`,value:e[g],valueSpec:s.geometry_type,style:n.style,styleSpec:n.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&f.push(new Rt(`${i}[${g}]`,e[g],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let g=1;g<e.length;g++)f=f.concat(ip({key:`${i}[${g}]`,value:e[g],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":u=Bn(e[1]),e.length!==2?f.push(new Rt(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="string"&&f.push(new Rt(`${i}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=Bn(e[1]),e.length!==2?f.push(new Rt(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="object"&&f.push(new Rt(`${i}[1]`,e[1],`object expected, ${u} found`))}return f}function au(n,e){const i=n.key,s=n.style,u=n.styleSpec,f=n.value,g=n.objectKey,y=u[`${e}_${n.layerType}`];if(!y)return[];const T=g.match(/^(.*)-transition$/);if(e==="paint"&&T&&y[T[1]]&&y[T[1]].transition)return _r({key:i,value:f,valueSpec:u.transition,style:s,styleSpec:u});const S=n.valueSpec||y[g];if(!S)return[new Rt(i,f,`unknown property "${g}"`)];let A;if(Bn(f)==="string"&&Ma(S)&&!S.tokens&&(A=/^{([^}]+)}$/.exec(f)))return[new Rt(i,f,`"${g}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];const P=[];return n.layerType==="symbol"&&(g==="text-field"&&s&&!s.glyphs&&P.push(new Rt(i,f,'use of "text-field" requires a style "glyphs" property')),g==="text-font"&&Jc(as(f))&&Oi(f.type)==="identity"&&P.push(new Rt(i,f,'"text-font" does not support identity functions'))),P.concat(_r({key:n.key,value:f,valueSpec:S,style:s,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:g}))}function rp(n){return au(n,"paint")}function Wd(n){return au(n,"layout")}function Hd(n){let e=[];const i=n.value,s=n.key,u=n.style,f=n.styleSpec;i.type||i.ref||e.push(new Rt(s,i,'either "type" or "ref" is required'));let g=Oi(i.type);const y=Oi(i.ref);if(i.id){const T=Oi(i.id);for(let S=0;S<n.arrayIndex;S++){const A=u.layers[S];Oi(A.id)===T&&e.push(new Rt(s,i.id,`duplicate layer id "${i.id}", previously used at line ${A.id.__line__}`))}}if("ref"in i){let T;["type","source","source-layer","filter","layout"].forEach(S=>{S in i&&e.push(new Rt(s,i[S],`"${S}" is prohibited for ref layers`))}),u.layers.forEach(S=>{Oi(S.id)===y&&(T=S)}),T?T.ref?e.push(new Rt(s,i.ref,"ref cannot reference another ref layer")):g=Oi(T.type):typeof y=="string"&&e.push(new Rt(s,i.ref,`ref layer "${y}" not found`))}else if(g!=="background"&&g!=="sky")if(i.source){const T=u.sources&&u.sources[i.source],S=T&&Oi(T.type);T?S==="vector"&&g==="raster"?e.push(new Rt(s,i.source,`layer "${i.id}" requires a raster source`)):S==="raster"&&g!=="raster"?e.push(new Rt(s,i.source,`layer "${i.id}" requires a vector source`)):S!=="vector"||i["source-layer"]?S==="raster-dem"&&g!=="hillshade"?e.push(new Rt(s,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):g!=="line"||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||S==="geojson"&&T.lineMetrics||e.push(new Rt(s,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Rt(s,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new Rt(s,i.source,`source "${i.source}" not found`))}else e.push(new Rt(s,i,'missing required property "source"'));return e=e.concat(Hr({key:s,value:i,valueSpec:f.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>_r({key:`${s}.type`,value:i.type,valueSpec:f.layer.type,style:n.style,styleSpec:n.styleSpec,object:i,objectKey:"type"}),filter:T=>Zd(Oo({layerType:g},T)),layout:T=>Hr({layer:i,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":S=>Wd(Oo({layerType:g},S))}}),paint:T=>Hr({layer:i,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":S=>rp(Oo({layerType:g},S))}})}})),e}function Ba(n){const e=n.value,i=n.key,s=Bn(e);return s!=="string"?[new Rt(i,e,`string expected, ${s} found`)]:[]}const lu={promoteId:function({key:n,value:e}){if(Bn(e)==="string")return Ba({key:n,value:e});{const i=[];for(const s in e)i.push(...Ba({key:`${n}.${s}`,value:e[s]}));return i}}};function zl(n){const e=n.value,i=n.key,s=n.styleSpec,u=n.style;if(!e.type)return[new Rt(i,e,'"type" is required')];const f=Oi(e.type);let g;switch(f){case"vector":case"raster":case"raster-dem":return g=Hr({key:i,value:e,valueSpec:s[`source_${f.replace("-","_")}`],style:n.style,styleSpec:s,objectElementValidators:lu}),g;case"geojson":if(g=Hr({key:i,value:e,valueSpec:s.source_geojson,style:u,styleSpec:s,objectElementValidators:lu}),e.cluster)for(const y in e.clusterProperties){const[T,S]=e.clusterProperties[y],A=typeof T=="string"?[T,["accumulated"],["get",y]]:T;g.push(...La({key:`${i}.${y}.map`,value:S,expressionContext:"cluster-map"})),g.push(...La({key:`${i}.${y}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return g;case"video":return Hr({key:i,value:e,valueSpec:s.source_video,style:u,styleSpec:s});case"image":return Hr({key:i,value:e,valueSpec:s.source_image,style:u,styleSpec:s});case"canvas":return[new Rt(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return nu({key:`${i}.type`,value:e.type,valueSpec:{values:op(s)},style:u,styleSpec:s})}}function op(n){return n.source.reduce((e,i)=>{const s=n[i];return s.type.type==="enum"&&(e=e.concat(Object.keys(s.type.values))),e},[])}function sp(n){const e=n.value,i=n.styleSpec,s=i.light,u=n.style;let f=[];const g=Bn(e);if(e===void 0)return f;if(g!=="object")return f=f.concat([new Rt("light",e,`object expected, ${g} found`)]),f;for(const y in e){const T=y.match(/^(.*)-transition$/);f=f.concat(T&&s[T[1]]&&s[T[1]].transition?_r({key:y,value:e[y],valueSpec:i.transition,style:u,styleSpec:i}):s[y]?_r({key:y,value:e[y],valueSpec:s[y],style:u,styleSpec:i}):[new Rt(y,e[y],`unknown property "${y}"`)])}return f}function Xd(n){const e=n.value,i=n.key,s=n.style,u=n.styleSpec,f=u.terrain;let g=[];const y=Bn(e);if(e===void 0)return g;if(y!=="object")return g=g.concat([new Rt("terrain",e,`object expected, ${y} found`)]),g;for(const T in e){const S=T.match(/^(.*)-transition$/);g=g.concat(S&&f[S[1]]&&f[S[1]].transition?_r({key:T,value:e[T],valueSpec:u.transition,style:s,styleSpec:u}):f[T]?_r({key:T,value:e[T],valueSpec:f[T],style:s,styleSpec:u}):[new Rt(T,e[T],`unknown property "${T}"`)])}if(e.source){const T=s.sources&&s.sources[e.source],S=T&&Oi(T.type);T?S!=="raster-dem"&&g.push(new Rt(i,e.source,`terrain cannot be used with a source of type ${String(S)}, it only be used with a "raster-dem" source type`)):g.push(new Rt(i,e.source,`source "${e.source}" not found`))}else g.push(new Rt(i,e,'terrain is missing required property "source"'));return g}function ap(n){const e=n.value,i=n.style,s=n.styleSpec,u=s.fog;let f=[];const g=Bn(e);if(e===void 0)return f;if(g!=="object")return f=f.concat([new Rt("fog",e,`object expected, ${g} found`)]),f;for(const y in e){const T=y.match(/^(.*)-transition$/);f=f.concat(T&&u[T[1]]&&u[T[1]].transition?_r({key:y,value:e[y],valueSpec:s.transition,style:i,styleSpec:s}):u[y]?_r({key:y,value:e[y],valueSpec:u[y],style:i,styleSpec:s}):[new Rt(y,e[y],`unknown property "${y}"`)])}return f}const cu={"*":()=>[],array:Qf,boolean:function(n){const e=n.value,i=n.key,s=Bn(e);return s!=="boolean"?[new Rt(i,e,`boolean expected, ${s} found`)]:[]},number:jd,color:function(n){const e=n.key,i=n.value,s=Bn(i);return s!=="string"?[new Rt(e,i,`color expected, ${s} found`)]:md(i)===null?[new Rt(e,i,`color expected, "${i}" found`)]:[]},enum:nu,filter:Zd,function:kl,layer:Hd,object:Hr,source:zl,light:sp,terrain:Xd,fog:ap,string:Ba,formatted:function(n){return Ba(n).length===0?[]:La(n)},resolvedImage:function(n){return Ba(n).length===0?[]:La(n)},projection:function(n){const e=n.value,i=n.styleSpec,s=i.projection,u=n.style;let f=[];const g=Bn(e);if(g==="object")for(const y in e)f=f.concat(_r({key:y,value:e[y],valueSpec:s[y],style:u,styleSpec:i}));else g!=="string"&&(f=f.concat([new Rt("projection",e,`object or string expected, ${g} found`)]));return f}};function _r(n){const e=n.value,i=n.valueSpec,s=n.styleSpec;return i.expression&&Jc(Oi(e))?kl(n):i.expression&&Pa(as(e))?La(n):i.type&&cu[i.type]?cu[i.type](n):Hr(Oo({},n,{valueSpec:i.type?s[i.type]:i}))}function Mg(n){const e=n.value,i=n.key,s=Ba(n);return s.length||(e.indexOf("{fontstack}")===-1&&s.push(new Rt(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&s.push(new Rt(i,e,'"glyphs" url must include a "{range}" token'))),s}function lp(n,e=et){return $o(_r({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,objectElementValidators:{glyphs:Mg,"*":()=>[]}}))}const Pg=n=>$o(rp(n)),cp=n=>$o(Wd(n));function $o(n){return n.slice().sort((e,i)=>e.line&&i.line?e.line-i.line:0)}function up(n,e){let i=!1;if(e&&e.length)for(const s of e)n.fire(new ss(new Error(s.message))),i=!0;return i}var Ra=yo;function yo(n,e,i){var s=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var u=new Int32Array(this.arrayBuffer);n=u[0],this.d=(e=u[1])+2*(i=u[2]);for(var f=0;f<this.d*this.d;f++){var g=u[3+f],y=u[3+f+1];s.push(g===y?null:u.subarray(g,y))}var T=u[3+s.length+1];this.keys=u.subarray(u[3+s.length],T),this.bboxes=u.subarray(T),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var S=0;S<this.d*this.d;S++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=n,this.padding=i,this.scale=e/n,this.uid=0;var A=i/e*n;this.min=-A,this.max=n+A}yo.prototype.insert=function(n,e,i,s,u){this._forEachCell(e,i,s,u,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(u)},yo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},yo.prototype._insertCell=function(n,e,i,s,u,f){this.cells[u].push(f)},yo.prototype.query=function(n,e,i,s,u){var f=this.min,g=this.max;if(n<=f&&e<=f&&g<=i&&g<=s&&!u)return Array.prototype.slice.call(this.keys);var y=[];return this._forEachCell(n,e,i,s,this._queryCell,y,{},u),y},yo.prototype._queryCell=function(n,e,i,s,u,f,g,y){var T=this.cells[u];if(T!==null)for(var S=this.keys,A=this.bboxes,P=0;P<T.length;P++){var z=T[P];if(g[z]===void 0){var F=4*z;(y?y(A[F+0],A[F+1],A[F+2],A[F+3]):n<=A[F+2]&&e<=A[F+3]&&i>=A[F+0]&&s>=A[F+1])?(g[z]=!0,f.push(S[z])):g[z]=!1}}},yo.prototype._forEachCell=function(n,e,i,s,u,f,g,y){for(var T=this._convertToCellCoord(n),S=this._convertToCellCoord(e),A=this._convertToCellCoord(i),P=this._convertToCellCoord(s),z=T;z<=A;z++)for(var F=S;F<=P;F++){var $=this.d*F+z;if((!y||y(this._convertFromCellCoord(z),this._convertFromCellCoord(F),this._convertFromCellCoord(z+1),this._convertFromCellCoord(F+1)))&&u.call(this,n,e,i,s,$,f,g,y))return}},yo.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},yo.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},yo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,e=3+this.cells.length+1+1,i=0,s=0;s<this.cells.length;s++)i+=this.cells[s].length;var u=new Int32Array(e+i+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var f=e,g=0;g<n.length;g++){var y=n[g];u[3+g]=f,u.set(y,f),f+=y.length}return u[3+n.length]=f,u.set(this.keys,f),u[3+n.length+1]=f+=this.keys.length,u.set(this.bboxes,f),f+=this.bboxes.length,u.buffer};const uu={};function $t(n,e,i={}){Object.defineProperty(n,"_classRegistryKey",{value:e,writeable:!1}),uu[e]={klass:n,omit:i.omit||[]}}$t(Object,"Object"),Ra.serialize=function(n,e){const i=n.toArrayBuffer();return e&&e.push(i),{buffer:i}},Ra.deserialize=function(n){return new Ra(n.buffer)},Object.defineProperty(Ra,"name",{value:"Grid"}),$t(Ra,"Grid"),$t(zi,"Color"),$t(Error,"Error"),$t(Wi,"AJAXError"),$t(Ir,"ResolvedImage"),$t(Il,"StylePropertyFunction"),$t(eu,"StyleExpression",{omit:["_evaluator"]}),$t(Zs,"ZoomDependentExpression"),$t(tu,"ZoomConstantExpression"),$t(ls,"CompoundExpression",{omit:["_evaluate"]});for(const n in Aa)uu[Aa[n]._classRegistryKey]||$t(Aa[n],`Expression${n}`);function dp(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function Ll(n){return w.ImageBitmap&&n instanceof w.ImageBitmap}function Dl(n,e){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp)return n;if(dp(n)||Ll(n))return e&&e.push(n),n;if(ArrayBuffer.isView(n)){const i=n;return e&&e.push(i.buffer),i}if(n instanceof w.ImageData)return e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const i=[];for(const s of n)i.push(Dl(s,e));return i}if(typeof n=="object"){const i=n.constructor,s=i._classRegistryKey;if(!s)throw new Error(`can't serialize object of unregistered class ${s}`);const u=i.serialize?i.serialize(n,e):{};if(!i.serialize){for(const f in n)n.hasOwnProperty(f)&&(uu[s].omit.indexOf(f)>=0||(u[f]=Dl(n[f],e)));n instanceof Error&&(u.message=n.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(u.$name=s),u}throw new Error("can't serialize object of type "+typeof n)}function Bl(n){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||dp(n)||Ll(n)||ArrayBuffer.isView(n)||n instanceof w.ImageData)return n;if(Array.isArray(n))return n.map(Bl);if(typeof n=="object"){const e=n.$name||"Object",{klass:i}=uu[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(n);const s=Object.create(i.prototype);for(const u of Object.keys(n))u!=="$name"&&(s[u]=Bl(n[u]));return s}throw new Error("can't deserialize object of type "+typeof n)}const Rl=n=>n>=1536&&n<=1791,hp=n=>n>=1872&&n<=1919,Yd=n=>n>=2208&&n<=2303,fp=n=>n>=11904&&n<=12031,Kd=n=>n>=12032&&n<=12255,Jd=n=>n>=12272&&n<=12287,Ol=n=>n>=12288&&n<=12351,du=n=>n>=12352&&n<=12447,Oa=n=>n>=12448&&n<=12543,hu=n=>n>=12544&&n<=12591,pp=n=>n>=12704&&n<=12735,mp=n=>n>=12736&&n<=12783,Qd=n=>n>=12784&&n<=12799,gp=n=>n>=12800&&n<=13055,_p=n=>n>=13056&&n<=13311,vp=n=>n>=13312&&n<=19903,eh=n=>n>=19968&&n<=40959,yp=n=>n>=40960&&n<=42127,xp=n=>n>=42128&&n<=42191,bp=n=>n>=44032&&n<=55215,wp=n=>n>=63744&&n<=64255,fu=n=>n>=64336&&n<=65023,Fl=n=>n>=65040&&n<=65055,h=n=>n>=65072&&n<=65103,r=n=>n>=65104&&n<=65135,c=n=>n>=65136&&n<=65279,p=n=>n>=65280&&n<=65519;function _(n){for(const e of n)if(I(e.charCodeAt(0)))return!0;return!1}function x(n){for(const e of n)if(!E(e.charCodeAt(0)))return!1;return!0}function E(n){return!(Rl(n)||hp(n)||Yd(n)||fu(n)||c(n))}function I(n){return!(n!==746&&n!==747&&(n<4352||!(pp(n)||hu(n)||h(n)&&!(n>=65097&&n<=65103)||wp(n)||_p(n)||fp(n)||mp(n)||!(!Ol(n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||vp(n)||eh(n)||gp(n)||(e=>e>=12592&&e<=12687)(n)||(e=>e>=43360&&e<=43391)(n)||(e=>e>=55216&&e<=55295)(n)||(e=>e>=4352&&e<=4607)(n)||bp(n)||du(n)||Jd(n)||(e=>e>=12688&&e<=12703)(n)||Kd(n)||Qd(n)||Oa(n)&&n!==12540||!(!p(n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!r(n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||(e=>e>=5120&&e<=5759)(n)||(e=>e>=6320&&e<=6399)(n)||Fl(n)||(e=>e>=19904&&e<=19967)(n)||yp(n)||xp(n))))}function k(n){return!(I(n)||function(e){return!!((i=>i>=128&&i<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(i=>i>=8192&&i<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(i=>i>=8448&&i<=8527)(e)||(i=>i>=8528&&i<=8591)(e)||(i=>i>=8960&&i<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(i=>i>=9216&&i<=9279)(e)&&e!==9251||(i=>i>=9280&&i<=9311)(e)||(i=>i>=9312&&i<=9471)(e)||(i=>i>=9632&&i<=9727)(e)||(i=>i>=9728&&i<=9983)(e)&&!(e>=9754&&e<=9759)||(i=>i>=11008&&i<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ol(e)||Oa(e)||(i=>i>=57344&&i<=63743)(e)||h(e)||r(e)||p(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(n))}function B(n){return n>=1424&&n<=2303||fu(n)||c(n)}function R(n,e){return!(!e&&B(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||(i=>i>=6016&&i<=6143)(n))}function U(n){for(const e of n)if(B(e.charCodeAt(0)))return!0;return!1}const W="deferred",J="loading",K="loaded";let Q=null,te="unavailable",Z=null;const le=function(n){n&&typeof n=="string"&&n.indexOf("NetworkError")>-1&&(te="error"),Q&&Q(n)};function se(){de.fire(new Qn("pluginStateChange",{pluginStatus:te,pluginURL:Z}))}const de=new Ro,Se=function(){return te},be=function(){if(te!==W||!Z)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");te=J,se(),Z&&mo({url:Z},n=>{n?le(n):(te=K,se())})},Ae={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>te===K||Ae.applyArabicShaping!=null,isLoading:()=>te===J,setState(n){te=n.pluginStatus,Z=n.pluginURL},isParsed:()=>Ae.applyArabicShaping!=null&&Ae.processBidirectionalText!=null&&Ae.processStyledBidirectionalText!=null,getPluginURL:()=>Z};class Be{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(i,s){for(const u of i)if(!R(u.charCodeAt(0),s))return!1;return!0}(e,Ae.isLoaded())}}class Ne{constructor(e,i){this.property=e,this.value=i,this.expression=function(s,u){if(Jc(s))return new Il(s,u);if(Pa(s)){const f=Ws(s,u);if(f.result==="error")throw new Error(f.value.map(g=>`${g.key}: ${g.message}`).join(", "));return f.value}{let f=s;return typeof s=="string"&&u.type==="color"&&(f=zi.parse(s)),{kind:"constant",evaluate:()=>f}}}(i===void 0?e.specification.default:i,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,i,s){return this.property.possiblyEvaluate(this,e,i,s)}}class Ge{constructor(e){this.property=e,this.value=new Ne(e,void 0)}transitioned(e,i){return new Fe(this.property,this.value,i,pt({},e.transition,this.transition),e.now)}untransitioned(){return new Fe(this.property,this.value,null,{},0)}}class bt{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Dn(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new Ge(this._values[e].property)),this._values[e].value=new Ne(this._values[e].property,i===null?void 0:Dn(i))}getTransition(e){return Dn(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new Ge(this._values[e].property)),this._values[e].transition=Dn(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const s=this.getValue(i);s!==void 0&&(e[i]=s);const u=this.getTransition(i);u!==void 0&&(e[`${i}-transition`]=u)}return e}transitioned(e,i){const s=new rt(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].transitioned(e,i._values[u]);return s}untransitioned(){const e=new rt(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class Fe{constructor(e,i,s,u,f){const g=u.delay||0,y=u.duration||0;f=f||0,this.property=e,this.value=i,this.begin=f+g,this.end=this.begin+y,e.specification.transition&&(u.delay||u.duration)&&(this.prior=s)}possiblyEvaluate(e,i,s){const u=e.now||0,f=this.value.possiblyEvaluate(e,i,s),g=this.prior;if(g){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return g.possiblyEvaluate(e,i,s);{const y=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,i,s),f,ze(y))}}return f}}class rt{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,s){const u=new Ue(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,i,s);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class He{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Dn(this._values[e].value)}setValue(e,i){this._values[e]=new Ne(this._values[e].property,i===null?void 0:Dn(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const s=this.getValue(i);s!==void 0&&(e[i]=s)}return e}possiblyEvaluate(e,i,s){const u=new Ue(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,i,s);return u}}class ut{constructor(e,i,s){this.property=e,this.value=i,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,s,u){return this.property.evaluate(this.value,this.parameters,e,i,s,u)}}class Ue{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Le{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,s){const u=xl[this.specification.type];return u?u(e,i,s):e}}class Ze{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,s,u){return new ut(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},s,u)}:e.expression,i)}interpolate(e,i,s){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new ut(this,{kind:"constant",value:void 0},e.parameters);const u=xl[this.specification.type];return u?new ut(this,{kind:"constant",value:u(e.value.value,i.value.value,s)},e.parameters):e}evaluate(e,i,s,u,f,g){return e.kind==="constant"?e.value:e.evaluate(i,s,u,f,g)}}class lt{constructor(e){this.specification=e}possiblyEvaluate(e,i,s,u){return!!e.expression.evaluate(i,null,{},s,u)}interpolate(){return!1}}class mt{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new Be(0,{});for(const s in e){const u=e[s];u.specification.overridable&&this.overridableProperties.push(s);const f=this.defaultPropertyValues[s]=new Ne(u,void 0),g=this.defaultTransitionablePropertyValues[s]=new Ge(u);this.defaultTransitioningPropertyValues[s]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=f.possiblyEvaluate(i)}}}function Wt(n,e){return 256*(n=nt(Math.floor(n),0,255))+nt(Math.floor(e),0,255)}$t(Ze,"DataDrivenProperty"),$t(Le,"DataConstantProperty"),$t(lt,"ColorRampProperty");const mn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ut{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ft{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ht(n,e=1){let i=0,s=0;return{members:n.map(u=>{const f=mn[u.type].BYTES_PER_ELEMENT,g=i=In(i,Math.max(e,f)),y=u.components||1;return s=Math.max(s,f),i+=f*y,{name:u.name,type:u.type,components:y,offset:g}}),size:In(i,Math.max(s,e)),alignment:e}}function In(n,e){return Math.ceil(n/e)*e}class Qt extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const u=2*e;return this.int16[u+0]=i,this.int16[u+1]=s,e}}Qt.prototype.bytesPerElement=4,$t(Qt,"StructArrayLayout2i4");class Zn extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,s)}emplace(e,i,s,u){const f=3*e;return this.int16[f+0]=i,this.int16[f+1]=s,this.int16[f+2]=u,e}}Zn.prototype.bytesPerElement=6,$t(Zn,"StructArrayLayout3i6");class ei extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,u)}emplace(e,i,s,u,f){const g=4*e;return this.int16[g+0]=i,this.int16[g+1]=s,this.int16[g+2]=u,this.int16[g+3]=f,e}}ei.prototype.bytesPerElement=8,$t(ei,"StructArrayLayout4i8");class li extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,u,f,g,y){const T=this.length;return this.resize(T+1),this.emplace(T,e,i,s,u,f,g,y)}emplace(e,i,s,u,f,g,y,T){const S=6*e,A=12*e,P=3*e;return this.int16[S+0]=i,this.int16[S+1]=s,this.uint8[A+4]=u,this.uint8[A+5]=f,this.uint8[A+6]=g,this.uint8[A+7]=y,this.float32[P+2]=T,e}}li.prototype.bytesPerElement=12,$t(li,"StructArrayLayout2i4ub1f12");class ri extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,u)}emplace(e,i,s,u,f){const g=4*e;return this.float32[g+0]=i,this.float32[g+1]=s,this.float32[g+2]=u,this.float32[g+3]=f,e}}ri.prototype.bytesPerElement=16,$t(ri,"StructArrayLayout4f16");class Fi extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,s,u,f)}emplace(e,i,s,u,f,g){const y=6*e,T=3*e;return this.uint16[y+0]=i,this.uint16[y+1]=s,this.uint16[y+2]=u,this.uint16[y+3]=f,this.float32[T+2]=g,e}}Fi.prototype.bytesPerElement=12,$t(Fi,"StructArrayLayout4ui1f12");class Br extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,u)}emplace(e,i,s,u,f){const g=4*e;return this.uint16[g+0]=i,this.uint16[g+1]=s,this.uint16[g+2]=u,this.uint16[g+3]=f,e}}Br.prototype.bytesPerElement=8,$t(Br,"StructArrayLayout4ui8");class ro extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,u,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,s,u,f,g)}emplace(e,i,s,u,f,g,y){const T=6*e;return this.int16[T+0]=i,this.int16[T+1]=s,this.int16[T+2]=u,this.int16[T+3]=f,this.int16[T+4]=g,this.int16[T+5]=y,e}}ro.prototype.bytesPerElement=12,$t(ro,"StructArrayLayout6i12");class No extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,u,f,g,y,T,S,A,P,z){const F=this.length;return this.resize(F+1),this.emplace(F,e,i,s,u,f,g,y,T,S,A,P,z)}emplace(e,i,s,u,f,g,y,T,S,A,P,z,F){const $=12*e;return this.int16[$+0]=i,this.int16[$+1]=s,this.int16[$+2]=u,this.int16[$+3]=f,this.uint16[$+4]=g,this.uint16[$+5]=y,this.uint16[$+6]=T,this.uint16[$+7]=S,this.int16[$+8]=A,this.int16[$+9]=P,this.int16[$+10]=z,this.int16[$+11]=F,e}}No.prototype.bytesPerElement=24,$t(No,"StructArrayLayout4i4ui4i24");class gi extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,u,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,s,u,f,g)}emplace(e,i,s,u,f,g,y){const T=10*e,S=5*e;return this.int16[T+0]=i,this.int16[T+1]=s,this.int16[T+2]=u,this.float32[S+2]=f,this.float32[S+3]=g,this.float32[S+4]=y,e}}gi.prototype.bytesPerElement=20,$t(gi,"StructArrayLayout3i3f20");class oi extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}oi.prototype.bytesPerElement=4,$t(oi,"StructArrayLayout1ul4");class $n extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,u,f,g,y,T,S,A,P,z,F){const $=this.length;return this.resize($+1),this.emplace($,e,i,s,u,f,g,y,T,S,A,P,z,F)}emplace(e,i,s,u,f,g,y,T,S,A,P,z,F,$){const j=20*e,H=10*e;return this.int16[j+0]=i,this.int16[j+1]=s,this.int16[j+2]=u,this.int16[j+3]=f,this.int16[j+4]=g,this.float32[H+3]=y,this.float32[H+4]=T,this.float32[H+5]=S,this.float32[H+6]=A,this.int16[j+14]=P,this.uint32[H+8]=z,this.uint16[j+18]=F,this.uint16[j+19]=$,e}}$n.prototype.bytesPerElement=40,$t($n,"StructArrayLayout5i4f1i1ul2ui40");class Ii extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,u,f,g,y){const T=this.length;return this.resize(T+1),this.emplace(T,e,i,s,u,f,g,y)}emplace(e,i,s,u,f,g,y,T){const S=8*e;return this.int16[S+0]=i,this.int16[S+1]=s,this.int16[S+2]=u,this.int16[S+4]=f,this.int16[S+5]=g,this.int16[S+6]=y,this.int16[S+7]=T,e}}Ii.prototype.bytesPerElement=16,$t(Ii,"StructArrayLayout3i2i2i16");class vr extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,s,u,f)}emplace(e,i,s,u,f,g){const y=4*e,T=8*e;return this.float32[y+0]=i,this.float32[y+1]=s,this.float32[y+2]=u,this.int16[T+6]=f,this.int16[T+7]=g,e}}vr.prototype.bytesPerElement=16,$t(vr,"StructArrayLayout2f1f2i16");class di extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,u)}emplace(e,i,s,u,f){const g=12*e,y=3*e;return this.uint8[g+0]=i,this.uint8[g+1]=s,this.float32[y+1]=u,this.float32[y+2]=f,e}}di.prototype.bytesPerElement=12,$t(di,"StructArrayLayout2ub2f12");class yr extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,s)}emplace(e,i,s,u){const f=3*e;return this.float32[f+0]=i,this.float32[f+1]=s,this.float32[f+2]=u,e}}yr.prototype.bytesPerElement=12,$t(yr,"StructArrayLayout3f12");class xr extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,s)}emplace(e,i,s,u){const f=3*e;return this.uint16[f+0]=i,this.uint16[f+1]=s,this.uint16[f+2]=u,e}}xr.prototype.bytesPerElement=6,$t(xr,"StructArrayLayout3ui6");class hs extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,s,u,f,g,y,T,S,A,P,z,F,$,j,H,ae,_e,ie,pe,Te){const ye=this.length;return this.resize(ye+1),this.emplace(ye,e,i,s,u,f,g,y,T,S,A,P,z,F,$,j,H,ae,_e,ie,pe,Te)}emplace(e,i,s,u,f,g,y,T,S,A,P,z,F,$,j,H,ae,_e,ie,pe,Te,ye){const je=30*e,$e=15*e,tt=60*e;return this.int16[je+0]=i,this.int16[je+1]=s,this.int16[je+2]=u,this.float32[$e+2]=f,this.float32[$e+3]=g,this.uint16[je+8]=y,this.uint16[je+9]=T,this.uint32[$e+5]=S,this.uint32[$e+6]=A,this.uint32[$e+7]=P,this.uint16[je+16]=z,this.uint16[je+17]=F,this.uint16[je+18]=$,this.float32[$e+10]=j,this.float32[$e+11]=H,this.uint8[tt+48]=ae,this.uint8[tt+49]=_e,this.uint8[tt+50]=ie,this.uint32[$e+13]=pe,this.int16[je+28]=Te,this.uint8[tt+58]=ye,e}}hs.prototype.bytesPerElement=60,$t(hs,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Fa extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,s,u,f,g,y,T,S,A,P,z,F,$,j,H,ae,_e,ie,pe,Te,ye,je,$e,tt,_t,We,it,ot,dt){const vt=this.length;return this.resize(vt+1),this.emplace(vt,e,i,s,u,f,g,y,T,S,A,P,z,F,$,j,H,ae,_e,ie,pe,Te,ye,je,$e,tt,_t,We,it,ot,dt)}emplace(e,i,s,u,f,g,y,T,S,A,P,z,F,$,j,H,ae,_e,ie,pe,Te,ye,je,$e,tt,_t,We,it,ot,dt,vt){const Xe=38*e,Ct=19*e;return this.int16[Xe+0]=i,this.int16[Xe+1]=s,this.int16[Xe+2]=u,this.float32[Ct+2]=f,this.float32[Ct+3]=g,this.int16[Xe+8]=y,this.int16[Xe+9]=T,this.int16[Xe+10]=S,this.int16[Xe+11]=A,this.int16[Xe+12]=P,this.int16[Xe+13]=z,this.uint16[Xe+14]=F,this.uint16[Xe+15]=$,this.uint16[Xe+16]=j,this.uint16[Xe+17]=H,this.uint16[Xe+18]=ae,this.uint16[Xe+19]=_e,this.uint16[Xe+20]=ie,this.uint16[Xe+21]=pe,this.uint16[Xe+22]=Te,this.uint16[Xe+23]=ye,this.uint16[Xe+24]=je,this.uint16[Xe+25]=$e,this.uint16[Xe+26]=tt,this.uint16[Xe+27]=_t,this.uint16[Xe+28]=We,this.uint32[Ct+15]=it,this.float32[Ct+16]=ot,this.float32[Ct+17]=dt,this.float32[Ct+18]=vt,e}}Fa.prototype.bytesPerElement=76,$t(Fa,"StructArrayLayout3i2f6i15ui1ul3f76");class qr extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}qr.prototype.bytesPerElement=4,$t(qr,"StructArrayLayout1f4");class Xr extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,s,u,f)}emplace(e,i,s,u,f,g){const y=5*e;return this.float32[y+0]=i,this.float32[y+1]=s,this.float32[y+2]=u,this.float32[y+3]=f,this.float32[y+4]=g,e}}Xr.prototype.bytesPerElement=20,$t(Xr,"StructArrayLayout5f20");class Uo extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,u)}emplace(e,i,s,u,f){const g=6*e;return this.uint32[3*e+0]=i,this.uint16[g+2]=s,this.uint16[g+3]=u,this.uint16[g+4]=f,e}}Uo.prototype.bytesPerElement=12,$t(Uo,"StructArrayLayout1ul3ui12");class fs extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const u=2*e;return this.uint16[u+0]=i,this.uint16[u+1]=s,e}}fs.prototype.bytesPerElement=4,$t(fs,"StructArrayLayout2ui4");class ps extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}ps.prototype.bytesPerElement=2,$t(ps,"StructArrayLayout1ui2");class Va extends Ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const u=2*e;return this.float32[u+0]=i,this.float32[u+1]=s,e}}Va.prototype.bytesPerElement=8,$t(Va,"StructArrayLayout2f8");class Qy extends Ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Qy.prototype.size=40;class zg extends $n{get(e){return new Qy(this,e)}}$t(zg,"CollisionBoxArray");class e0 extends Ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}e0.prototype.size=60;class t0 extends hs{get(e){return new e0(this,e)}}$t(t0,"PlacedSymbolArray");class n0 extends Ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}n0.prototype.size=76;class i0 extends Fa{get(e){return new n0(this,e)}}$t(i0,"SymbolInstanceArray");class r0 extends qr{getoffsetX(e){return this.float32[1*e+0]}}$t(r0,"GlyphOffsetArray");class o0 extends Qt{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}$t(o0,"SymbolLineVertexArray");class s0 extends Ut{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}s0.prototype.size=12;class a0 extends Uo{get(e){return new s0(this,e)}}$t(a0,"FeatureIndexArray");class l0 extends fs{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}$t(l0,"FillExtrusionCentroidArray");const QS=Ht([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),eE=Ht([{name:"a_dash",components:4,type:"Uint16"}]);var Vl={},tE={get exports(){return Vl},set exports(n){Vl=n}},Lg={};({get exports(){return Lg},set exports(n){Lg=n}}).exports=function(n,e){var i,s,u,f,g,y,T,S;for(s=n.length-(i=3&n.length),u=e,g=3432918353,y=461845907,S=0;S<s;)T=255&n.charCodeAt(S)|(255&n.charCodeAt(++S))<<8|(255&n.charCodeAt(++S))<<16|(255&n.charCodeAt(++S))<<24,++S,u=27492+(65535&(f=5*(65535&(u=(u^=T=(65535&(T=(T=(65535&T)*g+(((T>>>16)*g&65535)<<16)&4294967295)<<15|T>>>17))*y+(((T>>>16)*y&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(T=0,i){case 3:T^=(255&n.charCodeAt(S+2))<<16;case 2:T^=(255&n.charCodeAt(S+1))<<8;case 1:u^=T=(65535&(T=(T=(65535&(T^=255&n.charCodeAt(S)))*g+(((T>>>16)*g&65535)<<16)&4294967295)<<15|T>>>17))*y+(((T>>>16)*y&65535)<<16)&4294967295}return u^=n.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0};var Dg={};({get exports(){return Dg},set exports(n){Dg=n}}).exports=function(n,e){for(var i,s=n.length,u=e^s,f=0;s>=4;)i=1540483477*(65535&(i=255&n.charCodeAt(f)|(255&n.charCodeAt(++f))<<8|(255&n.charCodeAt(++f))<<16|(255&n.charCodeAt(++f))<<24))+((1540483477*(i>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),s-=4,++f;switch(s){case 3:u^=(255&n.charCodeAt(f+2))<<16;case 2:u^=(255&n.charCodeAt(f+1))<<8;case 1:u=1540483477*(65535&(u^=255&n.charCodeAt(f)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0};var c0=Lg,nE=Dg;tE.exports=c0,Vl.murmur3=c0,Vl.murmur2=nE;class Tp{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,s,u){this.ids.push(u0(e)),this.positions.push(i,s,u)}getPositions(e){const i=u0(e);let s=0,u=this.ids.length-1;for(;s<u;){const g=s+u>>1;this.ids[g]>=i?u=g:s=g+1}const f=[];for(;this.ids[s]===i;)f.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return f}static serialize(e,i){const s=new Float64Array(e.ids),u=new Uint32Array(e.positions);return Bg(s,u,0,s.length-1),i&&i.push(s.buffer,u.buffer),{ids:s,positions:u}}static deserialize(e){const i=new Tp;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function u0(n){const e=+n;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Vl(String(n))}function Bg(n,e,i,s){for(;i<s;){const u=n[i+s>>1];let f=i-1,g=s+1;for(;;){do f++;while(n[f]<u);do g--;while(n[g]>u);if(f>=g)break;Sp(n,f,g),Sp(e,3*f,3*g),Sp(e,3*f+1,3*g+1),Sp(e,3*f+2,3*g+2)}g-i<s-g?(Bg(n,e,i,g),i=g+1):(Bg(n,e,g+1,s),s=g)}}function Sp(n,e,i){const s=n[e];n[e]=n[i],n[i]=s}$t(Tp,"FeaturePositionMap");class Hs{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,i),this.initialized=!0),!!this.location}}class Ep extends Hs{constructor(e){super(e),this.current=0}set(e,i,s){this.fetchUniformLocation(e,i)&&this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class d0 extends Hs{constructor(e){super(e),this.current=[0,0,0,0]}set(e,i,s){this.fetchUniformLocation(e,i)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3])))}}class h0 extends Hs{constructor(e){super(e),this.current=zi.transparent}set(e,i,s){this.fetchUniformLocation(e,i)&&(s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a)))}}const iE=new Float32Array(16),rE=new Float32Array(9),oE=new Float32Array(4);function Rg(n){return[Wt(255*n.r,255*n.g),Wt(255*n.b,255*n.a)]}class th{constructor(e,i,s){this.value=e,this.uniformNames=i.map(u=>`u_${u}`),this.type=s}setUniform(e,i,s,u,f){i.set(e,f,u.constantOr(this.value))}getBinding(e,i){return this.type==="color"?new h0(e):new Ep(e)}}class pu{constructor(e,i){this.uniformNames=i.map(s=>`u_${s}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,i,s,u,f){const g=f==="u_pattern"||f==="u_dash"?this.pattern:f==="u_pixel_ratio"?this.pixelRatio:null;g&&i.set(e,f,g)}getBinding(e,i){return i==="u_pattern"||i==="u_dash"?new d0(e):new Ep(e)}}class Xs{constructor(e,i,s,u){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=i.map(f=>({name:`a_${f}`,type:"Float32",components:s==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,i,s,u,f,g){const y=this.paintVertexArray.length,T=this.expression.evaluate(new Be(0),i,{},f,u,g);this.paintVertexArray.resize(e),this._setPaintValue(y,e,T)}updatePaintArray(e,i,s,u,f){const g=this.expression.evaluate({zoom:0},s,u,void 0,f);this._setPaintValue(e,i,g)}_setPaintValue(e,i,s){if(this.type==="color"){const u=Rg(s);for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,u[0],u[1])}else{for(let u=e;u<i;u++)this.paintVertexArray.emplace(u,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class jo{constructor(e,i,s,u,f,g){this.expression=e,this.uniformNames=i.map(y=>`u_${y}_t`),this.type=s,this.useIntegerZoom=u,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=i.map(y=>({name:`a_${y}`,type:"Float32",components:s==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(e,i,s,u,f,g){const y=this.expression.evaluate(new Be(this.zoom),i,{},f,u,g),T=this.expression.evaluate(new Be(this.zoom+1),i,{},f,u,g),S=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(S,e,y,T)}updatePaintArray(e,i,s,u,f){const g=this.expression.evaluate({zoom:this.zoom},s,u,void 0,f),y=this.expression.evaluate({zoom:this.zoom+1},s,u,void 0,f);this._setPaintValue(e,i,g,y)}_setPaintValue(e,i,s,u){if(this.type==="color"){const f=Rg(s),g=Rg(u);for(let y=e;y<i;y++)this.paintVertexArray.emplace(y,f[0],f[1],g[0],g[1])}else{for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,s,u);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i,s,u,f){const g=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,y=nt(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);i.set(e,f,y)}getBinding(e,i){return new Ep(e)}}class $a{constructor(e,i,s,u,f){this.expression=e,this.layerId=f,this.paintVertexAttributes=(s==="array"?eE:QS).members;for(let g=0;g<i.length;++g);this.paintVertexArray=new u}populatePaintArray(e,i,s){const u=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(u,e,i.patterns&&i.patterns[this.layerId],s)}updatePaintArray(e,i,s,u,f,g){this._setPaintValues(e,i,s.patterns&&s.patterns[this.layerId],g)}_setPaintValues(e,i,s,u){if(!u||!s)return;const f=u[s];if(!f)return;const{tl:g,br:y,pixelRatio:T}=f;for(let S=e;S<i;S++)this.paintVertexArray.emplace(S,g[0],g[1],y[0],y[1],T)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Na{constructor(e,i,s=()=>!0){this.binders={},this._buffers=[];const u=[];for(const f in e.paint._values){if(!s(f))continue;const g=e.paint.get(f);if(!(g instanceof ut&&Ma(g.property.specification)))continue;const y=aE(f,e.type),T=g.value,S=g.property.specification.type,A=g.property.useIntegerZoom,P=f==="line-dasharray"||f.endsWith("pattern"),z=f==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(T.kind!=="constant"||z)if(T.kind==="source"||z||P){const F=f0(f,S,"source");this.binders[f]=P?new $a(T,y,S,F,e.id):new Xs(T,y,S,F),u.push(`/a_${f}`)}else{const F=f0(f,S,"composite");this.binders[f]=new jo(T,y,S,A,i,F),u.push(`/z_${f}`)}else this.binders[f]=P?new pu(T.value,y):new th(T.value,y,S),u.push(`/u_${f}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof Xs||i instanceof jo?i.maxValue:0}populatePaintArrays(e,i,s,u,f,g){for(const y in this.binders){const T=this.binders[y];(T instanceof Xs||T instanceof jo||T instanceof $a)&&T.populatePaintArray(e,i,s,u,f,g)}}setConstantPatternPositions(e){for(const i in this.binders){const s=this.binders[i];s instanceof pu&&s.setConstantPatternPositions(e)}}updatePaintArrays(e,i,s,u,f,g){let y=!1;for(const T in e){const S=i.getPositions(T);for(const A of S){const P=s.feature(A.index);for(const z in this.binders){const F=this.binders[z];if((F instanceof Xs||F instanceof jo||F instanceof $a)&&F.expression.isStateDependent===!0){const $=u.paint.get(z);F.expression=$.value,F.updatePaintArray(A.start,A.end,P,e[T],f,g),y=!0}}}}return y}defines(){const e=[];for(const i in this.binders){const s=this.binders[i];(s instanceof th||s instanceof pu)&&e.push(...s.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof Xs||s instanceof jo||s instanceof $a)for(let u=0;u<s.paintVertexAttributes.length;u++)e.push(s.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof th||s instanceof pu||s instanceof jo)for(const u of s.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const i=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof th||u instanceof pu||u instanceof jo)for(const f of u.uniformNames)i.push({name:f,property:s,binding:u.getBinding(e,f)})}return i}setUniforms(e,i,s,u,f){for(const{name:g,property:y,binding:T}of s)this.binders[y].setUniform(e,T,f,u.get(y),g)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const i=this.binders[e];(i instanceof Xs||i instanceof jo||i instanceof $a)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(e){for(const i in this.binders){const s=this.binders[i];(s instanceof Xs||s instanceof jo||s instanceof $a)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof Xs||i instanceof jo||i instanceof $a)&&i.destroy()}}}class $l{constructor(e,i,s=()=>!0){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new Na(u,i,s);this.needsUpload=!1,this._featureMap=new Tp,this._bufferOffset=0}populatePaintArrays(e,i,s,u,f,g,y){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(e,i,u,f,g,y);i.id!==void 0&&this._featureMap.add(i.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,s,u,f){for(const g of s)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(e,this._featureMap,i,g,u,f)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const sE={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function aE(n,e){return sE[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}const lE={"line-pattern":{source:Fi,composite:Fi},"fill-pattern":{source:Fi,composite:Fi},"fill-extrusion-pattern":{source:Fi,composite:Fi},"line-dasharray":{source:Br,composite:Br}},cE={color:{source:Va,composite:ri},number:{source:qr,composite:Va}};function f0(n,e,i){const s=lE[n];return s&&s[i]||cE[e][i]}$t(th,"ConstantBinder"),$t(pu,"PatternConstantBinder"),$t(Xs,"SourceExpressionBinder"),$t($a,"PatternCompositeBinder"),$t(jo,"CompositeExpressionBinder"),$t(Na,"ProgramConfiguration",{omit:["_buffers"]}),$t($l,"ProgramConfigurationSet");const Cp="-transition";class Go extends Ro{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new He(i.layout)),i.paint)){this._transitionablePaint=new bt(i.paint);for(const s in e.paint)this.setPaintProperty(s,e.paint[s],{validate:!1});for(const s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ue(i.paint)}}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,s={}){i!=null&&this._validate(cp,`layers.${this.id}.layout.${e}`,e,i,s)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return St(e,Cp)?this._transitionablePaint.getTransition(e.slice(0,-Cp.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,s={}){if(i!=null&&this._validate(Pg,`layers.${this.id}.paint.${e}`,e,i,s))return!1;if(St(e,Cp))return this._transitionablePaint.setTransition(e.slice(0,-Cp.length),i||void 0),!1;{const u=this._transitionablePaint._values[e],f=u.value.isDataDriven(),g=u.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const y=this._transitionablePaint._values[e].value,T=y.isDataDriven(),S=St(e,"pattern")||e==="line-dasharray";return T||f||S||this._handleOverridablePaintPropertyUpdate(e,g,y)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,i,s){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),fn(e,(i,s)=>!(i===void 0||s==="layout"&&!Object.keys(i).length||s==="paint"&&!Object.keys(i).length))}_validate(e,i,s,u,f={}){return(!f||f.validate!==!1)&&up(this,e.call(lp,{key:i,layerType:this.type,objectKey:s,value:u,styleSpec:et,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof ut&&Ma(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=iu(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const uE=Ht([{name:"a_pos",components:2,type:"Int16"}],4),dE=Ht([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Vi{constructor(e=[]){this.segments=e}prepareSegment(e,i,s,u){let f=this.segments[this.segments.length-1];return e>Vi.MAX_VERTEX_ARRAY_LENGTH&&ue(`Max vertices per segment is ${Vi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!f||f.vertexLength+e>Vi.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:i.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},u!==void 0&&(f.sortKey=u),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,s,u){return new Vi([{vertexOffset:e,primitiveOffset:i,vertexLength:s,primitiveLength:u,vaos:{},sortKey:0}])}}Vi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,$t(Vi,"SegmentVector");var un=8192;class Ua{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Vn?new Vn(e.lng,e.lat):Vn.convert(e),this}setSouthWest(e){return this._sw=e instanceof Vn?new Vn(e.lng,e.lat):Vn.convert(e),this}extend(e){const i=this._sw,s=this._ne;let u,f;if(e instanceof Vn)u=e,f=e;else{if(!(e instanceof Ua))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ua.convert(e)):this.extend(Vn.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&e.hasOwnProperty("lon")?this.extend(Vn.convert(e)):this;if(u=e._sw,f=e._ne,!u||!f)return this}return i||s?(i.lng=Math.min(u.lng,i.lng),i.lat=Math.min(u.lat,i.lat),s.lng=Math.max(f.lng,s.lng),s.lat=Math.max(f.lat,s.lat)):(this._sw=new Vn(u.lng,u.lat),this._ne=new Vn(f.lng,f.lat)),this}getCenter(){return new Vn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Vn(this.getWest(),this.getNorth())}getSouthEast(){return new Vn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:s}=Vn.convert(e);let u=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&u}static convert(e){return!e||e instanceof Ua?e:new Ua(e)}}var Ip=1e-6,Yr=typeof Float32Array<"u"?Float32Array:Array;function p0(){var n=new Yr(9);return Yr!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function m0(n,e,i){var s=e[0],u=e[1],f=e[2],g=e[3],y=e[4],T=e[5],S=e[6],A=e[7],P=e[8],z=i[0],F=i[1],$=i[2],j=i[3],H=i[4],ae=i[5],_e=i[6],ie=i[7],pe=i[8];return n[0]=z*s+F*g+$*S,n[1]=z*u+F*y+$*A,n[2]=z*f+F*T+$*P,n[3]=j*s+H*g+ae*S,n[4]=j*u+H*y+ae*A,n[5]=j*f+H*T+ae*P,n[6]=_e*s+ie*g+pe*S,n[7]=_e*u+ie*y+pe*A,n[8]=_e*f+ie*T+pe*P,n}function qo(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Og(n,e){var i=e[0],s=e[1],u=e[2],f=e[3],g=e[4],y=e[5],T=e[6],S=e[7],A=e[8],P=e[9],z=e[10],F=e[11],$=e[12],j=e[13],H=e[14],ae=e[15],_e=i*y-s*g,ie=i*T-u*g,pe=i*S-f*g,Te=s*T-u*y,ye=s*S-f*y,je=u*S-f*T,$e=A*j-P*$,tt=A*H-z*$,_t=A*ae-F*$,We=P*H-z*j,it=P*ae-F*j,ot=z*ae-F*H,dt=_e*ot-ie*it+pe*We+Te*_t-ye*tt+je*$e;return dt?(n[0]=(y*ot-T*it+S*We)*(dt=1/dt),n[1]=(u*it-s*ot-f*We)*dt,n[2]=(j*je-H*ye+ae*Te)*dt,n[3]=(z*ye-P*je-F*Te)*dt,n[4]=(T*_t-g*ot-S*tt)*dt,n[5]=(i*ot-u*_t+f*tt)*dt,n[6]=(H*pe-$*je-ae*ie)*dt,n[7]=(A*je-z*pe+F*ie)*dt,n[8]=(g*it-y*_t+S*$e)*dt,n[9]=(s*_t-i*it-f*$e)*dt,n[10]=($*ye-j*pe+ae*_e)*dt,n[11]=(P*pe-A*ye-F*_e)*dt,n[12]=(y*tt-g*We-T*$e)*dt,n[13]=(i*We-s*tt+u*$e)*dt,n[14]=(j*ie-$*Te-H*_e)*dt,n[15]=(A*Te-P*ie+z*_e)*dt,n):null}function Nl(n,e,i){var s=e[0],u=e[1],f=e[2],g=e[3],y=e[4],T=e[5],S=e[6],A=e[7],P=e[8],z=e[9],F=e[10],$=e[11],j=e[12],H=e[13],ae=e[14],_e=e[15],ie=i[0],pe=i[1],Te=i[2],ye=i[3];return n[0]=ie*s+pe*y+Te*P+ye*j,n[1]=ie*u+pe*T+Te*z+ye*H,n[2]=ie*f+pe*S+Te*F+ye*ae,n[3]=ie*g+pe*A+Te*$+ye*_e,n[4]=(ie=i[4])*s+(pe=i[5])*y+(Te=i[6])*P+(ye=i[7])*j,n[5]=ie*u+pe*T+Te*z+ye*H,n[6]=ie*f+pe*S+Te*F+ye*ae,n[7]=ie*g+pe*A+Te*$+ye*_e,n[8]=(ie=i[8])*s+(pe=i[9])*y+(Te=i[10])*P+(ye=i[11])*j,n[9]=ie*u+pe*T+Te*z+ye*H,n[10]=ie*f+pe*S+Te*F+ye*ae,n[11]=ie*g+pe*A+Te*$+ye*_e,n[12]=(ie=i[12])*s+(pe=i[13])*y+(Te=i[14])*P+(ye=i[15])*j,n[13]=ie*u+pe*T+Te*z+ye*H,n[14]=ie*f+pe*S+Te*F+ye*ae,n[15]=ie*g+pe*A+Te*$+ye*_e,n}function nh(n,e,i){var s,u,f,g,y,T,S,A,P,z,F,$,j=i[0],H=i[1],ae=i[2];return e===n?(n[12]=e[0]*j+e[4]*H+e[8]*ae+e[12],n[13]=e[1]*j+e[5]*H+e[9]*ae+e[13],n[14]=e[2]*j+e[6]*H+e[10]*ae+e[14],n[15]=e[3]*j+e[7]*H+e[11]*ae+e[15]):(u=e[1],f=e[2],g=e[3],y=e[4],T=e[5],S=e[6],A=e[7],P=e[8],z=e[9],F=e[10],$=e[11],n[0]=s=e[0],n[1]=u,n[2]=f,n[3]=g,n[4]=y,n[5]=T,n[6]=S,n[7]=A,n[8]=P,n[9]=z,n[10]=F,n[11]=$,n[12]=s*j+y*H+P*ae+e[12],n[13]=u*j+T*H+z*ae+e[13],n[14]=f*j+S*H+F*ae+e[14],n[15]=g*j+A*H+$*ae+e[15]),n}function Ul(n,e,i){var s=i[0],u=i[1],f=i[2];return n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s,n[3]=e[3]*s,n[4]=e[4]*u,n[5]=e[5]*u,n[6]=e[6]*u,n[7]=e[7]*u,n[8]=e[8]*f,n[9]=e[9]*f,n[10]=e[10]*f,n[11]=e[11]*f,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function Fg(n,e,i){var s=Math.sin(i),u=Math.cos(i),f=e[4],g=e[5],y=e[6],T=e[7],S=e[8],A=e[9],P=e[10],z=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=f*u+S*s,n[5]=g*u+A*s,n[6]=y*u+P*s,n[7]=T*u+z*s,n[8]=S*u-f*s,n[9]=A*u-g*s,n[10]=P*u-y*s,n[11]=z*u-T*s,n}function Ap(n,e,i){var s=Math.sin(i),u=Math.cos(i),f=e[0],g=e[1],y=e[2],T=e[3],S=e[8],A=e[9],P=e[10],z=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=f*u-S*s,n[1]=g*u-A*s,n[2]=y*u-P*s,n[3]=T*u-z*s,n[8]=f*s+S*u,n[9]=g*s+A*u,n[10]=y*s+P*u,n[11]=T*s+z*u,n}function g0(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function _0(n,e,i){var s,u,f,g=i[0],y=i[1],T=i[2],S=Math.hypot(g,y,T);return S<Ip?null:(g*=S=1/S,y*=S,T*=S,s=Math.sin(e),u=Math.cos(e),n[0]=g*g*(f=1-u)+u,n[1]=y*g*f+T*s,n[2]=T*g*f-y*s,n[3]=0,n[4]=g*y*f-T*s,n[5]=y*y*f+u,n[6]=T*y*f+g*s,n[7]=0,n[8]=g*T*f+y*s,n[9]=y*T*f-g*s,n[10]=T*T*f+u,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var hE=Nl;function Vg(){var n=new Yr(3);return Yr!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function v0(n){var e=new Yr(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function ih(n){return Math.hypot(n[0],n[1],n[2])}function mu(n,e,i){var s=new Yr(3);return s[0]=n,s[1]=e,s[2]=i,s}function Ys(n,e,i){return n[0]=e[0]+i[0],n[1]=e[1]+i[1],n[2]=e[2]+i[2],n}function $g(n,e,i){return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],n}function y0(n,e,i){return n[0]=e[0]*i[0],n[1]=e[1]*i[1],n[2]=e[2]*i[2],n}function rh(n,e,i){return n[0]=Math.min(e[0],i[0]),n[1]=Math.min(e[1],i[1]),n[2]=Math.min(e[2],i[2]),n}function oh(n,e,i){return n[0]=Math.max(e[0],i[0]),n[1]=Math.max(e[1],i[1]),n[2]=Math.max(e[2],i[2]),n}function oo(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n}function sh(n,e,i,s){return n[0]=e[0]+i[0]*s,n[1]=e[1]+i[1]*s,n[2]=e[2]+i[2]*s,n}function Rr(n,e){var i=e[0],s=e[1],u=e[2],f=i*i+s*s+u*u;return f>0&&(f=1/Math.sqrt(f)),n[0]=e[0]*f,n[1]=e[1]*f,n[2]=e[2]*f,n}function xo(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function Ng(n,e,i){var s=e[0],u=e[1],f=e[2],g=i[0],y=i[1],T=i[2];return n[0]=u*T-f*y,n[1]=f*g-s*T,n[2]=s*y-u*g,n}function Li(n,e,i){var s=e[0],u=e[1],f=e[2],g=i[3]*s+i[7]*u+i[11]*f+i[15];return n[0]=(i[0]*s+i[4]*u+i[8]*f+i[12])/(g=g||1),n[1]=(i[1]*s+i[5]*u+i[9]*f+i[13])/g,n[2]=(i[2]*s+i[6]*u+i[10]*f+i[14])/g,n}function x0(n,e,i){var s=i[0],u=i[1],f=i[2],g=e[0],y=e[1],T=e[2],S=u*T-f*y,A=f*g-s*T,P=s*y-u*g,z=u*P-f*A,F=f*S-s*P,$=s*A-u*S,j=2*i[3];return A*=j,P*=j,F*=2,$*=2,n[0]=g+(S*=j)+(z*=2),n[1]=y+A+F,n[2]=T+P+$,n}var ah,Zo=$g,fE=y0,pE=ih;function b0(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n}function w0(n,e){var i=e[0],s=e[1],u=e[2],f=e[3],g=i*i+s*s+u*u+f*f;return g>0&&(g=1/Math.sqrt(g)),n[0]=i*g,n[1]=s*g,n[2]=u*g,n[3]=f*g,n}function jl(n,e,i){var s=e[0],u=e[1],f=e[2],g=e[3];return n[0]=i[0]*s+i[4]*u+i[8]*f+i[12]*g,n[1]=i[1]*s+i[5]*u+i[9]*f+i[13]*g,n[2]=i[2]*s+i[6]*u+i[10]*f+i[14]*g,n[3]=i[3]*s+i[7]*u+i[11]*f+i[15]*g,n}function T0(){var n=new Yr(4);return Yr!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function S0(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function E0(n,e,i){i*=.5;var s=e[0],u=e[1],f=e[2],g=e[3],y=Math.sin(i),T=Math.cos(i);return n[0]=s*T+g*y,n[1]=u*T+f*y,n[2]=f*T-u*y,n[3]=g*T-s*y,n}function C0(n,e,i){i*=.5;var s=e[0],u=e[1],f=e[2],g=e[3],y=Math.sin(i),T=Math.cos(i);return n[0]=s*T-f*y,n[1]=u*T+g*y,n[2]=f*T+s*y,n[3]=g*T-u*y,n}Vg(),ah=new Yr(4),Yr!=Float32Array&&(ah[0]=0,ah[1]=0,ah[2]=0,ah[3]=0);var mE=w0;Vg(),mu(1,0,0),mu(0,1,0),T0(),T0(),p0();const gE=Ht([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:I0}=gE,A0=Ht([{name:"a_pos_3",components:3,type:"Int16"}]);var lh=Ht([{name:"a_pos",type:"Int16",components:2}]);class Ug{constructor(e,i){this.pos=e,this.dir=i}intersectsPlane(e,i,s){const u=xo(i,this.dir);if(Math.abs(u)<1e-6)return!1;const f=((e[0]-this.pos[0])*i[0]+(e[1]-this.pos[1])*i[1]+(e[2]-this.pos[2])*i[2])/u;return s[0]=this.pos[0]+this.dir[0]*f,s[1]=this.pos[1]+this.dir[1]*f,s[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(e,i,s){if(function(F,$){var j=F[0],H=F[1],ae=F[2],_e=$[0],ie=$[1],pe=$[2];return Math.abs(j-_e)<=Ip*Math.max(1,Math.abs(j),Math.abs(_e))&&Math.abs(H-ie)<=Ip*Math.max(1,Math.abs(H),Math.abs(ie))&&Math.abs(ae-pe)<=Ip*Math.max(1,Math.abs(ae),Math.abs(pe))}(this.pos,e)||i===0)return s[0]=s[1]=s[2]=0,!1;const[u,f,g]=this.dir,y=this.pos[0]-e[0],T=this.pos[1]-e[1],S=this.pos[2]-e[2],A=u*u+f*f+g*g,P=2*(y*u+T*f+S*g),z=P*P-4*A*(y*y+T*T+S*S-i*i);if(z<0){const F=Math.max(-P/2,0),$=y+u*F,j=T+f*F,H=S+g*F,ae=Math.hypot($,j,H);return s[0]=$*i/ae,s[1]=j*i/ae,s[2]=H*i/ae,!1}{const F=(-P-Math.sqrt(z))/(2*A);if(F<0){const $=Math.hypot(y,T,S);return s[0]=y*i/$,s[1]=T*i/$,s[2]=S*i/$,!1}return s[0]=y+u*F,s[1]=T+f*F,s[2]=S+g*F,!0}}}class jg{constructor(e,i,s,u,f){this.TL=e,this.TR=i,this.BR=s,this.BL=u,this.horizon=f}static fromInvProjectionMatrix(e,i,s){const u=[-1,1,1],f=[1,1,1],g=[1,-1,1],y=[-1,-1,1],T=Li(u,u,e),S=Li(f,f,e),A=Li(g,g,e),P=Li(y,y,e);return new jg(T,S,A,P,i/s)}}class Gg{constructor(e,i){this.points=e,this.planes=i}static fromInvProjectionMatrix(e,i,s,u){const f=Math.pow(2,s),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const S=jl([],T,e),A=1/S[3]/i*f;return function(P,z,F){return P[0]=z[0]*F[0],P[1]=z[1]*F[1],P[2]=z[2]*F[2],P[3]=z[3]*F[3],P}(S,S,[A,A,u?1/S[3]:A,A])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const S=Rr([],Ng([],Zo([],g[T[0]],g[T[1]]),Zo([],g[T[2]],g[T[1]]))),A=-xo(S,g[T[1]]);return S.concat(A)});return new Gg(g,y)}}class Or{static fromPoints(e){const i=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0];for(const u of e)rh(i,i,u),oh(s,s,u);return new Or(i,s)}static applyTransform(e,i){const s=e.getCorners();for(let u=0;u<s.length;++u)Li(s[u],s[u],i);return Or.fromPoints(s)}constructor(e,i){this.min=e,this.max=i,this.center=oo([],Ys([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],s=v0(this.min),u=v0(this.max);for(let f=0;f<i.length;f++)s[f]=i[f]?this.min[f]:this.center[f],u[f]=i[f]?this.center[f]:this.max[f];return u[2]=this.max[2],new Or(s,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,i=this.max;return[[e[0],e[1],e[2]],[i[0],e[1],e[2]],[i[0],i[1],e[2]],[e[0],i[1],e[2]],[e[0],e[1],i[2]],[i[0],e[1],i[2]],[i[0],i[1],i[2]],[e[0],i[1],i[2]]]}intersects(e){const i=this.getCorners();let s=!0;for(let u=0;u<e.planes.length;u++){const f=e.planes[u];let g=0;for(let y=0;y<i.length;y++)g+=xo(f,i[y])+f[3]>=0;if(g===0)return 0;g!==i.length&&(s=!1)}if(s)return 2;for(let u=0;u<3;u++){let f=Number.MAX_VALUE,g=-Number.MAX_VALUE;for(let y=0;y<e.points.length;y++){const T=e.points[y][u]-this.min[u];f=Math.min(f,T),g=Math.max(g,T)}if(g<0||f>this.max[u]-this.min[u])return 0}return 1}}const ms=un/Math.PI/2,Gl=64,ch=[Gl,32,16],bo=-ms,wo=ms,_E=[new Or([bo,bo,bo],[wo,wo,wo]),new Or([bo,bo,bo],[0,0,wo]),new Or([0,bo,bo],[wo,0,wo]),new Or([bo,0,bo],[0,wo,wo]),new Or([0,0,bo],[wo,wo,wo])];function kp(n){return n*ms/hh}function k0(n,e,i,s=!0){const u=oo([],n._camera.position,n.worldSize),f=[e,i,1,1];jl(f,f,n.pixelMatrixInverse),b0(f,f,1/f[3]);const g=Rr([],Zo([],f,u)),y=n.globeMatrix,T=[y[12],y[13],y[14]],S=Zo([],T,u),A=ih(S),P=Rr([],S),z=n.worldSize/(2*Math.PI),F=xo(P,g),$=Math.asin(z/A);if($<Math.acos(F)){if(!s)return null;const _t=[],We=[];oo(_t,g,A/F),Rr(We,Zo(We,_t,S)),Rr(g,Ys(g,S,oo(g,We,Math.tan($)*A)))}const j=[];new Ug(u,g).closestPointOnSphere(T,z,j);const H=Rr([],Ot(y,0)),ae=Rr([],Ot(y,1)),_e=Rr([],Ot(y,2)),ie=xo(H,j),pe=xo(ae,j),Te=xo(_e,j),ye=we(Math.asin(-pe/z));let je=we(Math.atan2(ie,Te));je=n.center.lng+function(_t,We){const it=(We-_t+180)%360-180;return it<-180?it+360:it}(n.center.lng,je);const $e=_s(je),tt=nt(vs(ye),0,1);return new yu($e,tt)}class vE{constructor(e,i,s){this.a=Zo([],e,s),this.b=Zo([],i,s),this.center=s;const u=Rr([],this.a),f=Rr([],this.b);this.angle=Math.acos(xo(u,f))}}function qg(n,e){if(n.angle===0)return null;let i;return i=n.a[e]===0?1/n.angle*.5*Math.PI:1/n.angle*Math.atan(n.b[e]/n.a[e]/Math.sin(n.angle)-1/Math.tan(n.angle)),i<0||i>1?null:function(s,u,f,g){const y=Math.sin(f);return s*(Math.sin((1-g)*f)/y)+u*(Math.sin(g*f)/y)}(n.a[e],n.b[e],n.angle,nt(i,0,1))+n.center[e]}function gs(n){if(n.z<=1)return _E[n.z+2*n.y+n.x];const e=Zg(Mp(n));return Or.fromPoints(e)}function ql(n,e,i){return oo(n,n,1-i),sh(n,n,e,i)}function M0(n,e){const i=vu(e.zoom);if(i===0)return gs(n);const s=Mp(n),u=Zg(s),f=_s(s.getWest())*e.worldSize,g=_s(s.getEast())*e.worldSize,y=vs(s.getNorth())*e.worldSize,T=vs(s.getSouth())*e.worldSize,S=[f,y,0],A=[g,y,0],P=[f,T,0],z=[g,T,0],F=Og([],e.globeMatrix);return Li(S,S,F),Li(A,A,F),Li(P,P,F),Li(z,z,F),u[0]=ql(u[0],P,i),u[1]=ql(u[1],z,i),u[2]=ql(u[2],A,i),u[3]=ql(u[3],S,i),Or.fromPoints(u)}function P0(n,e,i){for(const s of n)Li(s,s,e),oo(s,s,i)}function yE(n,e,i){const s=e/n.worldSize,u=n.globeMatrix;if(i.z<=1){const $e=gs(i).getCorners();return P0($e,u,s),Or.fromPoints($e)}const f=Mp(i),g=Zg(f);P0(g,u,s);const y=Number.MAX_VALUE,T=[-y,-y,-y],S=[y,y,y];if(f.contains(n.center)){for(const _t of g)rh(S,S,_t),oh(T,T,_t);T[2]=0;const $e=n.point,tt=[$e.x*s,$e.y*s,0];return rh(S,S,tt),oh(T,T,tt),new Or(S,T)}const A=[u[12]*s,u[13]*s,u[14]*s],P=f.getCenter(),z=nt(n.center.lat,-wr,wr),F=nt(P.lat,-wr,wr),$=_s(n.center.lng),j=vs(z);let H=$-_s(P.lng);const ae=j-vs(F);H>.5?H-=1:H<-.5&&(H+=1);let _e=0;Math.abs(H)>Math.abs(ae)?_e=H>=0?1:3:(_e=ae>=0?0:2,sh(A,A,[u[4]*s,u[5]*s,u[6]*s],-Math.sin(Ee(ae>=0?f.getSouth():f.getNorth()))*ms));const ie=g[_e],pe=g[(_e+1)%4],Te=new vE(ie,pe,A),ye=[qg(Te,0)||ie[0],qg(Te,1)||ie[1],qg(Te,2)||ie[2]],je=vu(n.zoom);if(je>0){const $e=function({x:_t,y:We,z:it},ot,dt,vt,Xe){const Ct=1/(1<<it);let tn=_t*Ct,Dt=tn+Ct,qt=We*Ct,It=qt+Ct,sn=0;const An=(tn+Dt)/2-vt;return An>.5?sn=-1:An<-.5&&(sn=1),tn=((tn+sn)*ot-(vt*=ot))*dt+vt,Dt=((Dt+sn)*ot-vt)*dt+vt,qt=(qt*ot-(Xe*=ot))*dt+Xe,It=(It*ot-Xe)*dt+Xe,[[tn,It,0],[Dt,It,0],[Dt,qt,0],[tn,qt,0]]}(i,e,n._pixelsPerMercatorPixel,$,j);for(let _t=0;_t<g.length;_t++)ql(g[_t],$e[_t],je);const tt=Ys([],$e[_e],$e[(_e+1)%4]);oo(tt,tt,.5),ql(ye,tt,je)}for(const $e of g)rh(S,S,$e),oh(T,T,$e);return S[2]=Math.min(ie[2],pe[2]),rh(S,S,ye),oh(T,T,ye),new Or(S,T)}function Mp({x:n,y:e,z:i}){const s=1/(1<<i),u=new Vn(so(n*s),br((e+1)*s)),f=new Vn(so((n+1)*s),br(e*s));return new Ua(u,f)}function Zg(n){const e=Ee(n.getNorth()),i=Ee(n.getSouth()),s=Math.cos(e),u=Math.cos(i),f=Math.sin(e),g=Math.sin(i),y=n.getWest(),T=n.getEast();return[gu(u,g,y),gu(u,g,T),gu(s,f,T),gu(s,f,y)]}function gu(n,e,i,s=ms){return i=Ee(i),[n*Math.sin(i)*s,-e*s,n*Math.cos(i)*s]}function _u(n,e,i){return gu(Math.cos(Ee(n)),Math.sin(Ee(n)),e,i)}function uh(n,e,i,s){const u=1<<i.z,f=(n/un+i.x)/u;return _u(br((e/un+i.y)/u),so(f),s)}function Pp({min:n,max:e}){return 16383/Math.max(e[0]-n[0],e[1]-n[1],e[2]-n[2])}const z0=new Float64Array(16);function dh(n){const e=Pp(n),i=g0(z0,[e,e,e]);return nh(i,i,((s=[])[0]=-(u=n.min)[0],s[1]=-u[1],s[2]=-u[2],s));var s,u}function Wg(n){const e=(s=n.min,(i=z0)[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=s[0],i[13]=s[1],i[14]=s[2],i[15]=1,i);var i,s;const u=1/Pp(n);return Ul(e,e,[u,u,u])}function L0(n,e,i,s,u){const f=function(T){const S=un/(2*Math.PI);return T/(2*Math.PI)/S}(i),g=[n,e,-i/(2*Math.PI)],y=qo(new Float64Array(16));return nh(y,y,g),Ul(y,y,[f,f,f]),Fg(y,y,Ee(-u)),Ap(y,y,Ee(-s)),y}function vu(n){return ft(5,6,n)}function D0(n,e){const i=_u(e.lat,e.lng),s=function($){const j=_u($._center.lat,$._center.lng);let H=Ng([],mu(0,1,0),j);const ae=_0([],-$.angle,j);H=Li(H,H,ae),_0(ae,-$._pitch,H);const _e=Rr([],j);return oo(_e,_e,kp($.cameraToCenterDistance/$.pixelsPerMeter)),Li(_e,_e,ae),Ys([],j,_e)}(n);return g=(u=$g([],s,i))[0],y=u[1],T=u[2],S=(f=i)[0],A=f[1],P=f[2],F=(z=Math.sqrt(g*g+y*y+T*T)*Math.sqrt(S*S+A*A+P*P))&&xo(u,f)/z,Math.acos(Math.min(Math.max(F,-1),1));var u,f,g,y,T,S,A,P,z,F}function Hg(n,e){return D0(n,e)>Math.PI/2*1.01}const B0=Ee(85),xE=Math.cos(B0),bE=Math.sin(B0),hh=63710088e-1,R0=2*Math.PI*hh;class Vn{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Vn(Pe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,s=this.lat*i,u=e.lat*i,f=Math.sin(s)*Math.sin(u)+Math.cos(s)*Math.cos(u)*Math.cos((e.lng-this.lng)*i);return hh*Math.acos(Math.min(f,1))}toBounds(e=0){const i=360*e/40075017,s=i/Math.cos(Math.PI/180*this.lat);return new Ua(new Vn(this.lng-s,this.lat-i),new Vn(this.lng+s,this.lat+i))}toEcef(e){const i=kp(e);return _u(this.lat,this.lng,ms+i)}static convert(e){if(e instanceof Vn)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Vn(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Vn(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function Xg(n){return R0*Math.cos(n*Math.PI/180)}function _s(n){return(180+n)/360}function vs(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function Wo(n,e){return n/Xg(e)}function so(n){return 360*n-180}function br(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function O0(n,e){return n*Xg(br(e))}const wr=85.051129;function F0(n){return 1/Math.cos(n*Math.PI/180)}class yu{constructor(e,i,s=0){this.x=+e,this.y=+i,this.z=+s}static fromLngLat(e,i=0){const s=Vn.convert(e);return new yu(_s(s.lng),vs(s.lat),Wo(i,s.lat))}toLngLat(){return new Vn(so(this.x),br(this.y))}toAltitude(){return O0(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/R0*F0(br(this.y))}}function Yg(n,e,i,s,u,f,g,y,T){const S=(e+s)/2,A=(i+u)/2,P=new Y(S,A);y(P),function(z,F,$,j,H,ae){const _e=$-H,ie=j-ae;return Math.abs((j-F)*_e-($-z)*ie)/Math.hypot(_e,ie)}(P.x,P.y,f.x,f.y,g.x,g.y)>=T?(Yg(n,e,i,S,A,f,P,y,T),Yg(n,S,A,s,u,P,g,y,T)):n.push(g)}function V0(n,e,i){let s=n[0],u=s.x,f=s.y;e(s);const g=[s];for(let y=1;y<n.length;y++){const T=n[y],{x:S,y:A}=T;e(T),Yg(g,u,f,S,A,s,T,e,i),u=S,f=A,s=T}return g}function Kg(n,e,i,s){if(s(e,i)){const u=e.add(i)._mult(.5);Kg(n,e,u,s),Kg(n,u,i,s)}else n.push(i)}function wE(n,e){let i=n[0];const s=[i];for(let u=1;u<n.length;u++){const f=n[u];Kg(s,i,f,e),i=f}return s}const Jg=Math.pow(2,14)-1,$0=-Jg-1;function TE(n,e){const i=Math.round(n.x*e),s=Math.round(n.y*e);return n.x=nt(i,$0,Jg),n.y=nt(s,$0,Jg),(i<n.x||i>n.x+1||s<n.y||s>n.y+1)&&ue("Geometry exceeds allowed extent, reduce your vector tile buffer size"),n}function Ks(n,e,i){const s=n.loadGeometry(),u=n.extent,f=un/u;if(e&&i&&i.projection.isReprojectedInTileSpace){const g=1<<e.z,{scale:y,x:T,y:S,projection:A}=i,P=z=>{const F=so((e.x+z.x/u)/g),$=br((e.y+z.y/u)/g),j=A.project(F,$);z.x=(j.x*y-T)*u,z.y=(j.y*y-S)*u};for(let z=0;z<s.length;z++)if(n.type!==1)s[z]=V0(s[z],P,1);else{const F=[];for(const $ of s[z])$.x<0||$.x>=u||$.y<0||$.y>=u||(P($),F.push($));s[z]=F}}for(const g of s)for(const y of g)TE(y,f);return s}function Zl(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?Ks(n):[]}}function zp(n,e,i,s,u){n.emplaceBack(2*e+(s+1)/2,2*i+(u+1)/2)}function Lp(n,e,i){n.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}class Qg{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Qt,this.indexArray=new xr,this.segments=new Vi,this.programConfigurations=new $l(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s,u){const f=this.layers[0],g=[];let y=null;f.type==="circle"&&(y=f.layout.get("circle-sort-key"));for(const{feature:S,id:A,index:P,sourceLayerIndex:z}of e){const F=this.layers[0]._featureFilter.needGeometry,$=Zl(S,F);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),$,s))continue;const j=y?y.evaluate($,{},s):void 0,H={id:A,properties:S.properties,type:S.type,sourceLayerIndex:z,index:P,geometry:F?$.geometry:Ks(S,s,u),patterns:{},sortKey:j};g.push(H)}y&&g.sort((S,A)=>S.sortKey-A.sortKey);let T=null;u.projection.name==="globe"&&(this.globeExtVertexArray=new ro,T=u.projection);for(const S of g){const{geometry:A,index:P,sourceLayerIndex:z}=S,F=e[P].feature;this.addFeature(S,A,P,i.availableImages,s,T),i.featureIndex.insert(F,A,P,z,this.index)}}update(e,i,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,uE.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,dE.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,i,s,u,f,g){for(const y of i)for(const T of y){const S=T.x,A=T.y;if(S<0||S>=un||A<0||A>=un)continue;if(g){const F=g.projectTilePoint(S,A,f),$=g.upVector(f,S,A),j=this.globeExtVertexArray;Lp(j,F,$),Lp(j,F,$),Lp(j,F,$),Lp(j,F,$)}const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),z=P.vertexLength;zp(this.layoutVertexArray,S,A,-1,-1),zp(this.layoutVertexArray,S,A,1,-1),zp(this.layoutVertexArray,S,A,1,1),zp(this.layoutVertexArray,S,A,-1,1),this.indexArray.emplaceBack(z,z+1,z+2),this.indexArray.emplaceBack(z,z+2,z+3),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},u,f)}}function N0(n,e){for(let i=0;i<n.length;i++)if(Wl(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(Wl(n,e[i]))return!0;return!!e_(n,e)}function SE(n,e,i){return!!Wl(n,e)||!!t_(e,n,i)}function U0(n,e){if(n.length===1)return G0(e,n[0]);for(let i=0;i<e.length;i++){const s=e[i];for(let u=0;u<s.length;u++)if(Wl(n,s[u]))return!0}for(let i=0;i<n.length;i++)if(G0(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(e_(n,e[i]))return!0;return!1}function EE(n,e,i){if(n.length>1){if(e_(n,e))return!0;for(let s=0;s<e.length;s++)if(t_(e[s],n,i))return!0}for(let s=0;s<n.length;s++)if(t_(n[s],e,i))return!0;return!1}function e_(n,e){if(n.length===0||e.length===0)return!1;for(let i=0;i<n.length-1;i++){const s=n[i],u=n[i+1];for(let f=0;f<e.length-1;f++)if(CE(s,u,e[f],e[f+1]))return!0}return!1}function CE(n,e,i,s){return Me(n,i,s)!==Me(e,i,s)&&Me(n,e,i)!==Me(n,e,s)}function t_(n,e,i){const s=i*i;if(e.length===1)return n.distSqr(e[0])<s;for(let u=1;u<e.length;u++)if(j0(n,e[u-1],e[u])<s)return!0;return!1}function j0(n,e,i){const s=e.distSqr(i);if(s===0)return n.distSqr(e);const u=((n.x-e.x)*(i.x-e.x)+(n.y-e.y)*(i.y-e.y))/s;return n.distSqr(u<0?e:u>1?i:i.sub(e)._mult(u)._add(e))}function G0(n,e){let i,s,u,f=!1;for(let g=0;g<n.length;g++){i=n[g];for(let y=0,T=i.length-1;y<i.length;T=y++)s=i[y],u=i[T],s.y>e.y!=u.y>e.y&&e.x<(u.x-s.x)*(e.y-s.y)/(u.y-s.y)+s.x&&(f=!f)}return f}function Wl(n,e){let i=!1;for(let s=0,u=n.length-1;s<n.length;u=s++){const f=n[s],g=n[u];f.y>e.y!=g.y>e.y&&e.x<(g.x-f.x)*(e.y-f.y)/(g.y-f.y)+f.x&&(i=!i)}return i}function q0(n,e,i,s,u){for(const g of n)if(e<=g.x&&i<=g.y&&s>=g.x&&u>=g.y)return!0;const f=[new Y(e,i),new Y(e,u),new Y(s,u),new Y(s,i)];if(n.length>2){for(const g of f)if(Wl(n,g))return!0}for(let g=0;g<n.length-1;g++)if(IE(n[g],n[g+1],f))return!0;return!1}function IE(n,e,i){const s=i[0],u=i[2];if(n.x<s.x&&e.x<s.x||n.x>u.x&&e.x>u.x||n.y<s.y&&e.y<s.y||n.y>u.y&&e.y>u.y)return!1;const f=Me(n,e,i[0]);return f!==Me(n,e,i[1])||f!==Me(n,e,i[2])||f!==Me(n,e,i[3])}function xu(n,e,i){const s=e.paint.get(n).value;return s.kind==="constant"?s.value:i.programConfigurations.get(e.id).getMaxValue(n)}function Dp(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Z0(n,e,i,s,u){if(!e[0]&&!e[1])return n;const f=Y.convert(e)._mult(u);i==="viewport"&&f._rotate(-s);const g=[];for(let y=0;y<n.length;y++)g.push(n[y].sub(f));return g}function W0(n,e,i,s){const u=Y.convert(n)._mult(s);return e==="viewport"&&u._rotate(-i),u}$t(Qg,"CircleBucket",{omit:["layers"]});const AE=new mt({"circle-sort-key":new Ze(et.layout_circle["circle-sort-key"])});var kE={paint:new mt({"circle-radius":new Ze(et.paint_circle["circle-radius"]),"circle-color":new Ze(et.paint_circle["circle-color"]),"circle-blur":new Ze(et.paint_circle["circle-blur"]),"circle-opacity":new Ze(et.paint_circle["circle-opacity"]),"circle-translate":new Le(et.paint_circle["circle-translate"]),"circle-translate-anchor":new Le(et.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Le(et.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Le(et.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ze(et.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ze(et.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ze(et.paint_circle["circle-stroke-opacity"])}),layout:AE};function H0(n,e,i,s,u,f,g,y,T){if(f&&n.queryGeometry.isAboveHorizon)return!1;f&&(T*=n.pixelToTileUnitsFactor);const S=n.tileID.canonical,A=i.projection.upVectorScale(S,i.center.lat,i.worldSize).metersToTile;for(const P of e)for(const z of P){const F=z.add(y),$=u&&i.elevation?i.elevation.exaggeration()*u.getElevationAt(F.x,F.y,!0):0,j=i.projection.projectTilePoint(F.x,F.y,S);if($>0){const ie=i.projection.upVector(S,F.x,F.y);j.x+=ie[0]*A*$,j.y+=ie[1]*A*$,j.z+=ie[2]*A*$}const H=f?F:ME(j.x,j.y,j.z,s),ae=f?n.tilespaceRays.map(ie=>zE(ie,$)):n.queryGeometry.screenGeometry,_e=jl([],[j.x,j.y,j.z,1],s);if(!g&&f?T*=_e[3]/i.cameraToCenterDistance:g&&!f&&(T*=i.cameraToCenterDistance/_e[3]),f){const ie=br((z.y/un+S.y)/(1<<S.z));T/=i.projection.pixelsPerMeter(ie,1)/Wo(1,ie)}if(SE(ae,H,T))return!0}return!1}function ME(n,e,i,s){const u=jl([],[n,e,i,1],s);return new Y(u[0]/u[3],u[1]/u[3])}const X0=mu(0,0,0),PE=mu(0,0,1);function zE(n,e){const i=Vg();return X0[2]=e,n.intersectsPlane(X0,PE,i),new Y(i[0],i[1])}class Y0 extends Qg{}function K0(n,{width:e,height:i},s,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*i*s)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*i*s);return n.width=e,n.height=i,n.data=u,n}function J0(n,e,i){const{width:s,height:u}=e;s===n.width&&u===n.height||(n_(n,e,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,s),height:Math.min(n.height,u)},i),n.width=s,n.height=u,n.data=e.data)}function n_(n,e,i,s,u,f){if(u.width===0||u.height===0)return e;if(u.width>n.width||u.height>n.height||i.x>n.width-u.width||i.y>n.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||s.x>e.width-u.width||s.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const g=n.data,y=e.data;for(let T=0;T<u.height;T++){const S=((i.y+T)*n.width+i.x)*f,A=((s.y+T)*e.width+s.x)*f;for(let P=0;P<u.width*f;P++)y[A+P]=g[S+P]}return e}$t(Y0,"HeatmapBucket",{omit:["layers"]});class Js{constructor(e,i){K0(this,e,1,i)}resize(e){J0(this,new Js(e),1)}clone(){return new Js({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,s,u,f){n_(e,i,s,u,f,1)}}class Kr{constructor(e,i){K0(this,e,4,i)}resize(e){J0(this,new Kr(e),4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Kr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,s,u,f){n_(e,i,s,u,f,4)}}$t(Js,"AlphaImage"),$t(Kr,"RGBAImage");var LE={paint:new mt({"heatmap-radius":new Ze(et.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ze(et.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Le(et.paint_heatmap["heatmap-intensity"]),"heatmap-color":new lt(et.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Le(et.paint_heatmap["heatmap-opacity"])})};function i_(n){const e={},i=n.resolution||256,s=n.clips?n.clips.length:1,u=n.image||new Kr({width:i,height:s}),f=(g,y,T)=>{e[n.evaluationKey]=T;const S=n.expression.evaluate(e);u.data[g+y+0]=Math.floor(255*S.r/S.a),u.data[g+y+1]=Math.floor(255*S.g/S.a),u.data[g+y+2]=Math.floor(255*S.b/S.a),u.data[g+y+3]=Math.floor(255*S.a)};if(n.clips)for(let g=0,y=0;g<s;++g,y+=4*i)for(let T=0,S=0;T<i;T++,S+=4){const A=T/(i-1),{start:P,end:z}=n.clips[g];f(y,S,P*(1-A)+z*A)}else for(let g=0,y=0;g<i;g++,y+=4)f(0,y,g/(i-1));return u}var DE={paint:new mt({"hillshade-illumination-direction":new Le(et.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Le(et.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Le(et.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Le(et.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Le(et.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Le(et.paint_hillshade["hillshade-accent-color"])})};const BE=Ht([{name:"a_pos",components:2,type:"Int16"}],4),{members:RE}=BE;var bu={};function Bp(n,e,i){i=i||2;var s,u,f,g,y,T,S,A=e&&e.length,P=A?e[0]*i:n.length,z=Q0(n,0,P,i,!0),F=[];if(!z||z.next===z.prev)return F;if(A&&(z=function(j,H,ae,_e){var ie,pe,Te,ye=[];for(ie=0,pe=H.length;ie<pe;ie++)(Te=Q0(j,H[ie]*_e,ie<pe-1?H[ie+1]*_e:j.length,_e,!1))===Te.next&&(Te.steiner=!0),ye.push(GE(Te));for(ye.sort(NE),ie=0;ie<ye.length;ie++)ae=UE(ye[ie],ae);return ae}(n,e,z,i)),n.length>80*i){s=f=n[0],u=g=n[1];for(var $=i;$<P;$+=i)(y=n[$])<s&&(s=y),(T=n[$+1])<u&&(u=T),y>f&&(f=y),T>g&&(g=T);S=(S=Math.max(f-s,g-u))!==0?32767/S:0}return fh(z,F,i,s,u,S,0),F}function Q0(n,e,i,s,u){var f,g;if(u===s_(n,e,i,s)>0)for(f=e;f<i;f+=s)g=nx(f,n[f],n[f+1],g);else for(f=i-s;f>=e;f-=s)g=nx(f,n[f],n[f+1],g);return g&&Rp(g,g.next)&&(mh(g),g=g.next),g}function Hl(n,e){if(!n)return n;e||(e=n);var i,s=n;do if(i=!1,s.steiner||!Rp(s,s.next)&&$i(s.prev,s,s.next)!==0)s=s.next;else{if(mh(s),(s=e=s.prev)===s.next)break;i=!0}while(i||s!==e);return e}function fh(n,e,i,s,u,f,g){if(n){!g&&f&&function(A,P,z,F){var $=A;do $.z===0&&($.z=r_($.x,$.y,P,z,F)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==A);$.prevZ.nextZ=null,$.prevZ=null,function(j){var H,ae,_e,ie,pe,Te,ye,je,$e=1;do{for(ae=j,j=null,pe=null,Te=0;ae;){for(Te++,_e=ae,ye=0,H=0;H<$e&&(ye++,_e=_e.nextZ);H++);for(je=$e;ye>0||je>0&&_e;)ye!==0&&(je===0||!_e||ae.z<=_e.z)?(ie=ae,ae=ae.nextZ,ye--):(ie=_e,_e=_e.nextZ,je--),pe?pe.nextZ=ie:j=ie,ie.prevZ=pe,pe=ie;ae=_e}pe.nextZ=null,$e*=2}while(Te>1)}($)}(n,s,u,f);for(var y,T,S=n;n.prev!==n.next;)if(y=n.prev,T=n.next,f?FE(n,s,u,f):OE(n))e.push(y.i/i|0),e.push(n.i/i|0),e.push(T.i/i|0),mh(n),n=T.next,S=T.next;else if((n=T)===S){g?g===1?fh(n=VE(Hl(n),e,i),e,i,s,u,f,2):g===2&&$E(n,e,i,s,u,f):fh(Hl(n),e,i,s,u,f,1);break}}}function OE(n){var e=n.prev,i=n,s=n.next;if($i(e,i,s)>=0)return!1;for(var u=e.x,f=i.x,g=s.x,y=e.y,T=i.y,S=s.y,A=u<f?u<g?u:g:f<g?f:g,P=y<T?y<S?y:S:T<S?T:S,z=u>f?u>g?u:g:f>g?f:g,F=y>T?y>S?y:S:T>S?T:S,$=s.next;$!==e;){if($.x>=A&&$.x<=z&&$.y>=P&&$.y<=F&&wu(u,y,f,T,g,S,$.x,$.y)&&$i($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function FE(n,e,i,s){var u=n.prev,f=n,g=n.next;if($i(u,f,g)>=0)return!1;for(var y=u.x,T=f.x,S=g.x,A=u.y,P=f.y,z=g.y,F=y<T?y<S?y:S:T<S?T:S,$=A<P?A<z?A:z:P<z?P:z,j=y>T?y>S?y:S:T>S?T:S,H=A>P?A>z?A:z:P>z?P:z,ae=r_(F,$,e,i,s),_e=r_(j,H,e,i,s),ie=n.prevZ,pe=n.nextZ;ie&&ie.z>=ae&&pe&&pe.z<=_e;){if(ie.x>=F&&ie.x<=j&&ie.y>=$&&ie.y<=H&&ie!==u&&ie!==g&&wu(y,A,T,P,S,z,ie.x,ie.y)&&$i(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,pe.x>=F&&pe.x<=j&&pe.y>=$&&pe.y<=H&&pe!==u&&pe!==g&&wu(y,A,T,P,S,z,pe.x,pe.y)&&$i(pe.prev,pe,pe.next)>=0))return!1;pe=pe.nextZ}for(;ie&&ie.z>=ae;){if(ie.x>=F&&ie.x<=j&&ie.y>=$&&ie.y<=H&&ie!==u&&ie!==g&&wu(y,A,T,P,S,z,ie.x,ie.y)&&$i(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;pe&&pe.z<=_e;){if(pe.x>=F&&pe.x<=j&&pe.y>=$&&pe.y<=H&&pe!==u&&pe!==g&&wu(y,A,T,P,S,z,pe.x,pe.y)&&$i(pe.prev,pe,pe.next)>=0)return!1;pe=pe.nextZ}return!0}function VE(n,e,i){var s=n;do{var u=s.prev,f=s.next.next;!Rp(u,f)&&ex(u,s,s.next,f)&&ph(u,f)&&ph(f,u)&&(e.push(u.i/i|0),e.push(s.i/i|0),e.push(f.i/i|0),mh(s),mh(s.next),s=n=f),s=s.next}while(s!==n);return Hl(s)}function $E(n,e,i,s,u,f){var g=n;do{for(var y=g.next.next;y!==g.prev;){if(g.i!==y.i&&qE(g,y)){var T=tx(g,y);return g=Hl(g,g.next),T=Hl(T,T.next),fh(g,e,i,s,u,f,0),void fh(T,e,i,s,u,f,0)}y=y.next}g=g.next}while(g!==n)}function NE(n,e){return n.x-e.x}function UE(n,e){var i=function(u,f){var g,y=f,T=u.x,S=u.y,A=-1/0;do{if(S<=y.y&&S>=y.next.y&&y.next.y!==y.y){var P=y.x+(S-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(P<=T&&P>A&&(A=P,g=y.x<y.next.x?y:y.next,P===T))return g}y=y.next}while(y!==f);if(!g)return null;var z,F=g,$=g.x,j=g.y,H=1/0;y=g;do T>=y.x&&y.x>=$&&T!==y.x&&wu(S<j?T:A,S,$,j,S<j?A:T,S,y.x,y.y)&&(z=Math.abs(S-y.y)/(T-y.x),ph(y,u)&&(z<H||z===H&&(y.x>g.x||y.x===g.x&&jE(g,y)))&&(g=y,H=z)),y=y.next;while(y!==F);return g}(n,e);if(!i)return e;var s=tx(i,n);return Hl(s,s.next),Hl(i,i.next)}function jE(n,e){return $i(n.prev,n,e.prev)<0&&$i(e.next,n,n.next)<0}function r_(n,e,i,s,u){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*u|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-s)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function GE(n){var e=n,i=n;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==n);return i}function wu(n,e,i,s,u,f,g,y){return(u-g)*(e-y)>=(n-g)*(f-y)&&(n-g)*(s-y)>=(i-g)*(e-y)&&(i-g)*(f-y)>=(u-g)*(s-y)}function qE(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function(i,s){var u=i;do{if(u.i!==i.i&&u.next.i!==i.i&&u.i!==s.i&&u.next.i!==s.i&&ex(u,u.next,i,s))return!0;u=u.next}while(u!==i);return!1}(n,e)&&(ph(n,e)&&ph(e,n)&&function(i,s){var u=i,f=!1,g=(i.x+s.x)/2,y=(i.y+s.y)/2;do u.y>y!=u.next.y>y&&u.next.y!==u.y&&g<(u.next.x-u.x)*(y-u.y)/(u.next.y-u.y)+u.x&&(f=!f),u=u.next;while(u!==i);return f}(n,e)&&($i(n.prev,n,e.prev)||$i(n,e.prev,e))||Rp(n,e)&&$i(n.prev,n,n.next)>0&&$i(e.prev,e,e.next)>0)}function $i(n,e,i){return(e.y-n.y)*(i.x-e.x)-(e.x-n.x)*(i.y-e.y)}function Rp(n,e){return n.x===e.x&&n.y===e.y}function ex(n,e,i,s){var u=Fp($i(n,e,i)),f=Fp($i(n,e,s)),g=Fp($i(i,s,n)),y=Fp($i(i,s,e));return u!==f&&g!==y||!(u!==0||!Op(n,i,e))||!(f!==0||!Op(n,s,e))||!(g!==0||!Op(i,n,s))||!(y!==0||!Op(i,e,s))}function Op(n,e,i){return e.x<=Math.max(n.x,i.x)&&e.x>=Math.min(n.x,i.x)&&e.y<=Math.max(n.y,i.y)&&e.y>=Math.min(n.y,i.y)}function Fp(n){return n>0?1:n<0?-1:0}function ph(n,e){return $i(n.prev,n,n.next)<0?$i(n,e,n.next)>=0&&$i(n,n.prev,e)>=0:$i(n,e,n.prev)<0||$i(n,n.next,e)<0}function tx(n,e){var i=new o_(n.i,n.x,n.y),s=new o_(e.i,e.x,e.y),u=n.next,f=e.prev;return n.next=e,e.prev=n,i.next=u,u.prev=i,s.next=i,i.prev=s,f.next=s,s.prev=f,s}function nx(n,e,i,s){var u=new o_(n,e,i);return s?(u.next=s.next,u.prev=s,s.next.prev=u,s.next=u):(u.prev=u,u.next=u),u}function mh(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function o_(n,e,i){this.i=n,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function s_(n,e,i,s){for(var u=0,f=e,g=i-s;f<i;f+=s)u+=(n[g]-n[f])*(n[f+1]+n[g+1]),g=f;return u}function ZE(n,e,i,s,u){ix(n,e,i||0,s||n.length-1,u||WE)}function ix(n,e,i,s,u){for(;s>i;){if(s-i>600){var f=s-i+1,g=e-i+1,y=Math.log(f),T=.5*Math.exp(2*y/3),S=.5*Math.sqrt(y*T*(f-T)/f)*(g-f/2<0?-1:1);ix(n,e,Math.max(i,Math.floor(e-g*T/f+S)),Math.min(s,Math.floor(e+(f-g)*T/f+S)),u)}var A=n[e],P=i,z=s;for(gh(n,i,e),u(n[s],A)>0&&gh(n,i,s);P<z;){for(gh(n,P,z),P++,z--;u(n[P],A)<0;)P++;for(;u(n[z],A)>0;)z--}u(n[i],A)===0?gh(n,i,z):gh(n,++z,s),z<=e&&(i=z+1),e<=z&&(s=z-1)}}function gh(n,e,i){var s=n[e];n[e]=n[i],n[i]=s}function WE(n,e){return n<e?-1:n>e?1:0}function a_(n,e){const i=n.length;if(i<=1)return[n];const s=[];let u,f;for(let g=0;g<i;g++){const y=qe(n[g]);y!==0&&(n[g].area=Math.abs(y),f===void 0&&(f=y<0),f===y<0?(u&&s.push(u),u=[n[g]]):u.push(n[g]))}if(u&&s.push(u),e>1)for(let g=0;g<s.length;g++)s[g].length<=e||(ZE(s[g],e,1,s[g].length-1,HE),s[g]=s[g].slice(0,e));return s}function HE(n,e){return e.area-n.area}function l_(n,e,i){const s=i.patternDependencies;let u=!1;for(const f of e){const g=f.paint.get(`${n}-pattern`);g.isConstant()||(u=!0);const y=g.constantOr(null);y&&(u=!0,s[y]=!0)}return u}function c_(n,e,i,s,u){const f=u.patternDependencies;for(const g of e){const y=g.paint.get(`${n}-pattern`).value;if(y.kind!=="constant"){let T=y.evaluate({zoom:s},i,{},u.availableImages);T=T&&T.name?T.name:T,f[T]=!0,i.patterns[g.id]=T}}return i}({get exports(){return bu},set exports(n){bu=n}}).exports=Bp,bu.default=Bp,Bp.deviation=function(n,e,i,s){var u=e&&e.length,f=Math.abs(s_(n,0,u?e[0]*i:n.length,i));if(u)for(var g=0,y=e.length;g<y;g++)f-=Math.abs(s_(n,e[g]*i,g<y-1?e[g+1]*i:n.length,i));var T=0;for(g=0;g<s.length;g+=3){var S=s[g]*i,A=s[g+1]*i,P=s[g+2]*i;T+=Math.abs((n[S]-n[P])*(n[A+1]-n[S+1])-(n[S]-n[A])*(n[P+1]-n[S+1]))}return f===0&&T===0?0:Math.abs((T-f)/f)},Bp.flatten=function(n){for(var e=n[0][0].length,i={vertices:[],holes:[],dimensions:e},s=0,u=0;u<n.length;u++){for(var f=0;f<n[u].length;f++)for(var g=0;g<e;g++)i.vertices.push(n[u][f][g]);u>0&&i.holes.push(s+=n[u-1].length)}return i};class Vp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Qt,this.indexArray=new xr,this.indexArray2=new fs,this.programConfigurations=new $l(e.layers,e.zoom),this.segments=new Vi,this.segments2=new Vi,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=e.projection}populate(e,i,s,u){this.hasPattern=l_("fill",this.layers,i);const f=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:y,id:T,index:S,sourceLayerIndex:A}of e){const P=this.layers[0]._featureFilter.needGeometry,z=Zl(y,P);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),z,s))continue;const F=f?f.evaluate(z,{},s,i.availableImages):void 0,$={id:T,properties:y.properties,type:y.type,sourceLayerIndex:A,index:S,geometry:P?z.geometry:Ks(y,s,u),patterns:{},sortKey:F};g.push($)}f&&g.sort((y,T)=>y.sortKey-T.sortKey);for(const y of g){const{geometry:T,index:S,sourceLayerIndex:A}=y;if(this.hasPattern){const P=c_("fill",this.layers,y,this.zoom,i);this.patternFeatures.push(P)}else this.addFeature(y,T,S,s,{},i.availableImages);i.featureIndex.insert(e[S].feature,T,S,A,this.index)}}update(e,i,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s,u)}addFeatures(e,i,s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,i,s,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,RE),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,s,u,f,g=[]){for(const y of a_(i,500)){let T=0;for(const $ of y)T+=$.length;const S=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),A=S.vertexLength,P=[],z=[];for(const $ of y){if($.length===0)continue;$!==y[0]&&z.push(P.length/2);const j=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),H=j.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(H+$.length-1,H),P.push($[0].x),P.push($[0].y);for(let ae=1;ae<$.length;ae++)this.layoutVertexArray.emplaceBack($[ae].x,$[ae].y),this.indexArray2.emplaceBack(H+ae-1,H+ae),P.push($[ae].x),P.push($[ae].y);j.vertexLength+=$.length,j.primitiveLength+=$.length}const F=bu(P,z);for(let $=0;$<F.length;$+=3)this.indexArray.emplaceBack(A+F[$],A+F[$+1],A+F[$+2]);S.vertexLength+=T,S.primitiveLength+=F.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,g,u)}}$t(Vp,"FillBucket",{omit:["layers","patternFeatures"]});const XE=new mt({"fill-sort-key":new Ze(et.layout_fill["fill-sort-key"])});var YE={paint:new mt({"fill-antialias":new Le(et.paint_fill["fill-antialias"]),"fill-opacity":new Ze(et.paint_fill["fill-opacity"]),"fill-color":new Ze(et.paint_fill["fill-color"]),"fill-outline-color":new Ze(et.paint_fill["fill-outline-color"]),"fill-translate":new Le(et.paint_fill["fill-translate"]),"fill-translate-anchor":new Le(et.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ze(et.paint_fill["fill-pattern"])}),layout:XE};const KE=Ht([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),JE=Ht([{name:"a_centroid_pos",components:2,type:"Uint16"}]),QE=Ht([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:eC}=KE;var $p={},tC=Y,rx=Tu;function Tu(n,e,i,s,u){this.properties={},this.extent=i,this.type=0,this._pbf=n,this._geometry=-1,this._keys=s,this._values=u,n.readFields(nC,this,e)}function nC(n,e,i){n==1?e.id=i.readVarint():n==2?function(s,u){for(var f=s.readVarint()+s.pos;s.pos<f;){var g=u._keys[s.readVarint()],y=u._values[s.readVarint()];u.properties[g]=y}}(i,e):n==3?e.type=i.readVarint():n==4&&(e._geometry=i.pos)}function iC(n){for(var e,i,s=0,u=0,f=n.length,g=f-1;u<f;g=u++)s+=((i=n[g]).x-(e=n[u]).x)*(e.y+i.y);return s}Tu.types=["Unknown","Point","LineString","Polygon"],Tu.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var e,i=n.readVarint()+n.pos,s=1,u=0,f=0,g=0,y=[];n.pos<i;){if(u<=0){var T=n.readVarint();s=7&T,u=T>>3}if(u--,s===1||s===2)f+=n.readSVarint(),g+=n.readSVarint(),s===1&&(e&&y.push(e),e=[]),e.push(new tC(f,g));else{if(s!==7)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&y.push(e),y},Tu.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var e=n.readVarint()+n.pos,i=1,s=0,u=0,f=0,g=1/0,y=-1/0,T=1/0,S=-1/0;n.pos<e;){if(s<=0){var A=n.readVarint();i=7&A,s=A>>3}if(s--,i===1||i===2)(u+=n.readSVarint())<g&&(g=u),u>y&&(y=u),(f+=n.readSVarint())<T&&(T=f),f>S&&(S=f);else if(i!==7)throw new Error("unknown command "+i)}return[g,T,y,S]},Tu.prototype.toGeoJSON=function(n,e,i){var s,u,f=this.extent*Math.pow(2,i),g=this.extent*n,y=this.extent*e,T=this.loadGeometry(),S=Tu.types[this.type];function A(F){for(var $=0;$<F.length;$++){var j=F[$];F[$]=[360*(j.x+g)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(j.y+y)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(s=0;s<T.length;s++)P[s]=T[s][0];A(T=P);break;case 2:for(s=0;s<T.length;s++)A(T[s]);break;case 3:for(T=function(F){var $=F.length;if($<=1)return[F];for(var j,H,ae=[],_e=0;_e<$;_e++){var ie=iC(F[_e]);ie!==0&&(H===void 0&&(H=ie<0),H===ie<0?(j&&ae.push(j),j=[F[_e]]):j.push(F[_e]))}return j&&ae.push(j),ae}(T),s=0;s<T.length;s++)for(u=0;u<T[s].length;u++)A(T[s][u])}T.length===1?T=T[0]:S="Multi"+S;var z={type:"Feature",geometry:{type:S,coordinates:T},properties:this.properties};return"id"in this&&(z.id=this.id),z};var rC=rx,ox=sx;function sx(n,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(oC,this,e),this.length=this._features.length}function oC(n,e,i){n===15?e.version=i.readVarint():n===1?e.name=i.readString():n===5?e.extent=i.readVarint():n===2?e._features.push(i.pos):n===3?e._keys.push(i.readString()):n===4&&e._values.push(function(s){for(var u=null,f=s.readVarint()+s.pos;s.pos<f;){var g=s.readVarint()>>3;u=g===1?s.readString():g===2?s.readFloat():g===3?s.readDouble():g===4?s.readVarint64():g===5?s.readVarint():g===6?s.readSVarint():g===7?s.readBoolean():null}return u}(i))}sx.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var e=this._pbf.readVarint()+this._pbf.pos;return new rC(this._pbf,e,this.extent,this._keys,this._values)};var sC=ox;function aC(n,e,i){if(n===3){var s=new sC(i,i.readVarint()+i.pos);s.length&&(e[s.name]=s)}}var u_=$p.VectorTile=function(n,e){this.layers=n.readFields(aC,{},e)},Np=$p.VectorTileFeature=rx;function Up(n,e,i,s){const u=[],f=s===0?(g,y,T,S,A,P)=>{g.push(new Y(P,T+(P-y)/(S-y)*(A-T)))}:(g,y,T,S,A,P)=>{g.push(new Y(y+(P-T)/(A-T)*(S-y),P))};for(const g of n){const y=[];for(const T of g){if(T.length<=2)continue;const S=[];for(let z=0;z<T.length-1;z++){const F=T[z].x,$=T[z].y,j=T[z+1].x,H=T[z+1].y,ae=s===0?F:$,_e=s===0?j:H;ae<e?_e>e&&f(S,F,$,j,H,e):ae>i?_e<i&&f(S,F,$,j,H,i):S.push(T[z]),_e<e&&ae>=e&&f(S,F,$,j,H,e),_e>i&&ae<=i&&f(S,F,$,j,H,i)}let A=T[T.length-1];const P=s===0?A.x:A.y;P>=e&&P<=i&&S.push(A),S.length&&(A=S[S.length-1],S[0].x===A.x&&S[0].y===A.y||S.push(S[0]),y.push(S))}y.length&&u.push(y)}return u}$p.VectorTileLayer=ox;const lC=Np.types,cC=Math.pow(2,13);function _h(n,e,i,s,u,f,g,y){n.emplaceBack((e<<1)+g,(i<<1)+f,(Math.floor(s*cC)<<1)+u,Math.round(y))}function vh(n,e,i){n.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}class ax{constructor(){this.acc=new Y(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Y(e.x,e.y),this.max=new Y(e.x,e.y))}append(e,i){this.currentPolyCount.edges++,this.acc._add(e);const s=this.min,u=this.max;e.x<s.x?s.x=e.x:e.x>u.x&&(u.x=e.x),e.y<s.y?s.y=e.y:e.y>u.y&&(u.y=e.y),((e.x===0||e.x===un)&&e.x===i.x)!=((e.y===0||e.y===un)&&e.y===i.y)&&this.processBorderOverlap(e,i),i.x<0!=e.x<0&&this.addBorderIntersection(0,Fn(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>un!=e.x>un&&this.addBorderIntersection(1,Fn(i.y,e.y,(un-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,Fn(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>un!=e.y>un&&this.addBorderIntersection(3,Fn(i.x,e.x,(un-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[e];i<s[0]&&(s[0]=i),i>s[1]&&(s[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const s=e.x===0?0:1;this.addBorderIntersection(s,i.y),this.addBorderIntersection(s,e.y)}else{const s=e.y===0?2:3;this.addBorderIntersection(s,i.x),this.addBorderIntersection(s,e.x)}}centroid(){const e=this.polyCount.reduce((i,s)=>i+s.edges,0);return e!==0?this.acc.div(e)._round():new Y(0,0)}span(){return new Y(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0)}}class yh{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new ei,this.centroidVertexArray=new l0,this.indexArray=new xr,this.programConfigurations=new $l(e.layers,e.zoom),this.segments=new Vi,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=e.enableTerrain}populate(e,i,s,u){this.features=[],this.hasPattern=l_("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(f){const g=Math.exp(Math.PI*(1-f.y/(1<<f.z)*2));return 80150034*g/(g*g+1)/un/(1<<f.z)}(s),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:f,id:g,index:y,sourceLayerIndex:T}of e){const S=this.layers[0]._featureFilter.needGeometry,A=Zl(f,S);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),A,s))continue;const P={id:g,sourceLayerIndex:T,index:y,geometry:S?A.geometry:Ks(f,s,u),properties:f.properties,type:f.type,patterns:{}},z=this.layoutVertexArray.length;this.hasPattern?this.features.push(c_("fill-extrusion",this.layers,P,this.zoom,i)):this.addFeature(P,P.geometry,y,s,{},i.availableImages,u),i.featureIndex.insert(f,P.geometry,y,T,this.index,z)}this.sortBorders()}addFeatures(e,i,s,u,f){for(const g of this.features){const{geometry:y}=g;this.addFeature(g,y,g.index,i,s,u,f)}this.sortBorders()}update(e,i,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,eC),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,QE.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,JE.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,s,u,f,g,y){const T=[new Y(0,0),new Y(un,un)],S=y.projection,A=S.name==="globe",P=this.enableTerrain&&!A?new ax:null,z=lC[e.type]==="Polygon";A&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new ro);const F=a_(i,500);for(let ae=F.length-1;ae>=0;ae--){const _e=F[ae];(_e.length===0||($=_e[0]).every(ie=>ie.x<=0)||$.every(ie=>ie.x>=un)||$.every(ie=>ie.y<=0)||$.every(ie=>ie.y>=un))&&F.splice(ae,1)}var $;let j;if(A)j=px(F,T,u);else{j=[];for(const ae of F)j.push({polygon:ae,bounds:T})}const H=z?this.edgeRadius:0;for(const{polygon:ae,bounds:_e}of j){let ie=0,pe=0;for(const ye of ae)z&&!ye[0].equals(ye[ye.length-1])&&ye.push(ye[0]),pe+=z?ye.length-1:ye.length;const Te=this.segments.prepareSegment((z?5:4)*pe,this.layoutVertexArray,this.indexArray);if(z){const ye=[],je=[];ie=Te.vertexLength;for(const tt of ae){let _t,We;tt.length&&tt!==ae[0]&&je.push(ye.length/2),_t=tt[1].sub(tt[0])._perp()._unit();for(let it=1;it<tt.length;it++){const ot=tt[it],dt=tt[it===tt.length-1?1:it+1];let{x:vt,y:Xe}=ot;if(H){We=dt.sub(ot)._perp()._unit();const Ct=_t.add(We)._unit(),tn=H*Math.min(4,1/(_t.x*Ct.x+_t.y*Ct.y));vt+=tn*Ct.x,Xe+=tn*Ct.y,_t=We}_h(this.layoutVertexArray,vt,Xe,0,0,1,1,0),Te.vertexLength++,ye.push(ot.x,ot.y),A&&vh(this.layoutVertexExtArray,S.projectTilePoint(vt,Xe,u),S.upVector(u,vt,Xe))}}const $e=bu(ye,je);for(let tt=0;tt<$e.length;tt+=3)this.indexArray.emplaceBack(ie+$e[tt],ie+$e[tt+2],ie+$e[tt+1]),Te.primitiveLength++}for(const ye of ae){P&&ye.length&&P.startRing(ye[0]);let je,$e,tt,_t=ye.length>4&&dx(ye[ye.length-2],ye[0],ye[1]),We=H?uC(ye[ye.length-2],ye[0],ye[1],H):0;$e=ye[1].sub(ye[0])._perp()._unit();let it=!0;for(let ot=1,dt=0;ot<ye.length;ot++){let vt=ye[ot-1],Xe=ye[ot];const Ct=ye[ot===ye.length-1?1:ot+1];if(P&&z&&P.currentPolyCount.top++,ux(Xe,vt,_e)){H&&($e=Ct.sub(Xe)._perp()._unit(),it=!it);continue}P&&P.append(Xe,vt);const tn=Xe.sub(vt)._perp(),Dt=tn.x/(Math.abs(tn.x)+Math.abs(tn.y)),qt=tn.y>0?1:0,It=vt.dist(Xe);if(dt+It>32768&&(dt=0),H){tt=Ct.sub(Xe)._perp()._unit();let yn=cx(vt,Xe,Ct,lx($e,tt),H);isNaN(yn)&&(yn=0);const an=Xe.sub(vt)._unit();vt=vt.add(an.mult(We))._round(),Xe=Xe.add(an.mult(-yn))._round(),We=yn,$e=tt}const sn=Te.vertexLength,An=ye.length>4&&dx(vt,Xe,Ct);let wn=hx(dt,_t,it);if(_h(this.layoutVertexArray,vt.x,vt.y,Dt,qt,0,0,wn),_h(this.layoutVertexArray,vt.x,vt.y,Dt,qt,0,1,wn),dt+=It,wn=hx(dt,An,!it),_t=An,_h(this.layoutVertexArray,Xe.x,Xe.y,Dt,qt,0,0,wn),_h(this.layoutVertexArray,Xe.x,Xe.y,Dt,qt,0,1,wn),Te.vertexLength+=4,this.indexArray.emplaceBack(sn+0,sn+1,sn+2),this.indexArray.emplaceBack(sn+1,sn+3,sn+2),Te.primitiveLength+=2,H){const yn=ie+(ot===1?ye.length-2:ot-2),an=ot===1?ie:yn+1;if(this.indexArray.emplaceBack(sn+1,yn,sn+3),this.indexArray.emplaceBack(yn,an,sn+3),Te.primitiveLength+=2,je===void 0&&(je=sn),!ux(Ct,ye[ot],_e)){const Yn=ot===ye.length-1?je:Te.vertexLength;this.indexArray.emplaceBack(sn+2,sn+3,Yn),this.indexArray.emplaceBack(sn+3,Yn+1,Yn),this.indexArray.emplaceBack(sn+3,an,Yn+1),Te.primitiveLength+=3}it=!it}if(A){const yn=this.layoutVertexExtArray,an=S.projectTilePoint(vt.x,vt.y,u),Yn=S.projectTilePoint(Xe.x,Xe.y,u),dn=S.upVector(u,vt.x,vt.y),kn=S.upVector(u,Xe.x,Xe.y);vh(yn,an,dn),vh(yn,an,dn),vh(yn,Yn,kn),vh(yn,Yn,kn)}}z&&(ie+=ye.length-1)}}if(P&&P.polyCount.length>0){if(P.borders){P.vertexArrayOffset=this.centroidVertexArray.length;const ae=P.borders,_e=this.featuresOnBorder.push(P)-1;for(let ie=0;ie<4;ie++)ae[ie][0]!==Number.MAX_VALUE&&this.borders[ie].push(_e)}this.encodeCentroid(P.borders?void 0:P.centroid(),P)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,g,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((i,s)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[s].borders[e][0])}encodeCentroid(e,i,s=!0){let u,f;if(e)if(e.y!==0){const y=i.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(y.x/10)),f=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(y.y/10))}else u=Math.ceil(7*(e.x+450)),f=0;else u=0,f=+s;let g=s?this.centroidVertexArray.length:i.vertexArrayOffset;for(const y of i.polyCount){s&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*y.edges+y.top);for(let T=0;T<y.top;T++)this.centroidVertexArray.emplace(g++,u,f);for(let T=0;T<2*y.edges;T++)this.centroidVertexArray.emplace(g++,0,f),this.centroidVertexArray.emplace(g++,u,f)}}}function lx(n,e){const i=n.add(e)._unit();return n.x*i.x+n.y*i.y}function uC(n,e,i,s){const u=e.sub(n)._perp()._unit(),f=i.sub(e)._perp()._unit();return cx(n,e,i,lx(u,f),s)}function cx(n,e,i,s,u){const f=Math.sqrt(1-s*s);return Math.min(n.dist(e)/3,e.dist(i)/3,u*f/s)}function ux(n,e,i){return n.x<i[0].x&&e.x<i[0].x||n.x>i[1].x&&e.x>i[1].x||n.y<i[0].y&&e.y<i[0].y||n.y>i[1].y&&e.y>i[1].y}function dx(n,e,i){if(n.x<0||n.x>=un||e.x<0||e.x>=un||i.x<0||i.x>=un)return!1;const s=i.sub(e),u=s.perp(),f=n.sub(e);return(s.x*f.x+s.y*f.y)/Math.sqrt((s.x*s.x+s.y*s.y)*(f.x*f.x+f.y*f.y))>-.866&&u.x*f.x+u.y*f.y<0}function hx(n,e,i){const s=e?2|n:-3&n;return i?1|s:-2&s}function fx(){const n=Math.PI/32,e=Math.tan(n),i=hh;return i*Math.sqrt(1+2*e*e)-i}function px(n,e,i){const s=1<<i.z,u=so(i.x/s),f=so((i.x+1)/s),g=br(i.y/s),y=br((i.y+1)/s);return function(T,S,A,P,z=0,F){const $=[];if(!T.length||!A||!P)return $;const j=(ye,je)=>{for(const $e of ye)$.push({polygon:$e,bounds:je})},H=Math.ceil(Math.log2(A)),ae=Math.ceil(Math.log2(P)),_e=H-ae,ie=[];for(let ye=0;ye<Math.abs(_e);ye++)ie.push(_e>0?0:1);for(let ye=0;ye<Math.min(H,ae);ye++)ie.push(0),ie.push(1);let pe=T;if(pe=Up(pe,S[0].y-z,S[1].y+z,1),pe=Up(pe,S[0].x-z,S[1].x+z,0),!pe.length)return $;const Te=[];for(ie.length?Te.push({polygons:pe,bounds:S,depth:0}):j(pe,S);Te.length;){const ye=Te.pop(),je=ye.depth,$e=ie[je],tt=ye.bounds[0],_t=ye.bounds[1],We=$e===0?tt.x:tt.y,it=$e===0?_t.x:_t.y,ot=F?F($e,We,it):.5*(We+it),dt=Up(ye.polygons,We-z,ot+z,$e),vt=Up(ye.polygons,ot-z,it+z,$e);if(dt.length){const Xe=[tt,new Y($e===0?ot:_t.x,$e===1?ot:_t.y)];ie.length>je+1?Te.push({polygons:dt,bounds:Xe,depth:je+1}):j(dt,Xe)}if(vt.length){const Xe=[new Y($e===0?ot:tt.x,$e===1?ot:tt.y),_t];ie.length>je+1?Te.push({polygons:vt,bounds:Xe,depth:je+1}):j(vt,Xe)}}return $}(n,e,Math.ceil((f-u)/11.25),Math.ceil((g-y)/11.25),1,(T,S,A)=>{if(T===0)return .5*(S+A);{const P=br((i.y+S/un)/s);return(vs(.5*(br((i.y+A/un)/s)+P))*s-i.y)*un}})}$t(yh,"FillExtrusionBucket",{omit:["layers","features"]}),$t(ax,"PartMetadata");const dC=new mt({"fill-extrusion-edge-radius":new Le(et["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var hC={paint:new mt({"fill-extrusion-opacity":new Le(et["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ze(et["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Le(et["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Le(et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ze(et["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ze(et["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ze(et["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Le(et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Le(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Le(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:dC};function mx(n,e,i){var s=2*Math.PI*6378137/256/Math.pow(2,i);return[n*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}class jp{constructor(e,i,s){this.z=e,this.x=i,this.y=s,this.key=xh(0,e,e,i,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const s=function(f,g,y){var T=mx(256*f,256*(g=Math.pow(2,y)-g-1),y),S=mx(256*(f+1),256*(g+1),y);return T[0]+","+T[1]+","+S[0]+","+S[1]}(this.x,this.y,this.z),u=function(f,g,y){let T,S="";for(let A=f;A>0;A--)T=1<<A-1,S+=(g&T?1:0)+(y&T?2:0);return S}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class gx{constructor(e,i){this.wrap=e,this.canonical=i,this.key=xh(e,i.z,i.z,i.x,i.y)}}class Fr{constructor(e,i,s,u,f){this.overscaledZ=e,this.wrap=i,this.canonical=new jp(s,+u,+f),this.key=i===0&&e===s?this.canonical.key:xh(i,e,s,u,f)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new Fr(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Fr(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return xh(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-e;return xh(this.wrap*+i,e,e,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new Fr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,s=2*this.canonical.x,u=2*this.canonical.y;return[new Fr(i,this.wrap,i,s,u),new Fr(i,this.wrap,i,s+1,u),new Fr(i,this.wrap,i,s,u+1),new Fr(i,this.wrap,i,s+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Fr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Fr(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new gx(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function xh(n,e,i,s,u){const f=1<<Math.min(i,22);let g=f*(u%f)+s%f;return n&&i<22&&(g+=f*f*((n<0?-2*n-1:2*n)%(1<<2*(22-i)))),16*(32*g+i)+(e-i)}$t(jp,"CanonicalTileID"),$t(Fr,"OverscaledTileID",{omit:["projMatrix"]});class Su extends Y{constructor(e,i,s){super(e,i),this.z=s}}function bh(n,e){return n.x*e.x+n.y*e.y}function _x(n,e){if(n.length===1){let i=0;const s=e[i++];let u;for(;!u||s.equals(u);)if(u=e[i++],!u)return 1/0;for(;i<e.length;i++){const f=e[i],g=n[0],y=u.sub(s),T=f.sub(s),S=g.sub(s),A=bh(y,y),P=bh(y,T),z=bh(T,T),F=bh(S,y),$=bh(S,T),j=A*z-P*P,H=(z*F-P*$)/j,ae=(A*$-P*F)/j,_e=s.z*(1-H-ae)+u.z*H+f.z*ae;if(isFinite(_e))return _e}return 1/0}{let i=1/0;for(const s of e)i=Math.min(i,s.z);return i}}function vx(n,e,i,s,u,f,g,y){const T=g*u.getElevationAt(n,e,!0,!0),S=f[0]!==0,A=S?f[1]===0?g*(f[0]/7-450):g*function(P,z,F){const $=Math.floor(z[0]/8),j=Math.floor(z[1]/8),H=10*(z[0]-8*$),ae=10*(z[1]-8*j),_e=P.getElevationAt($,j,!0,!0),ie=P.getMeterToDEM(F),pe=Math.floor(.5*(H*ie-1)),Te=Math.floor(.5*(ae*ie-1)),ye=P.tileCoordToPixel($,j),je=2*pe+1,$e=2*Te+1,tt=function(vt,Xe,Ct,tn,Dt){return[vt.getElevationAtPixel(Xe,Ct,!0),vt.getElevationAtPixel(Xe+Dt,Ct,!0),vt.getElevationAtPixel(Xe,Ct+Dt,!0),vt.getElevationAtPixel(Xe+tn,Ct+Dt,!0)]}(P,ye.x-pe,ye.y-Te,je,$e),_t=Math.abs(tt[0]-tt[1]),We=Math.abs(tt[2]-tt[3]),it=Math.abs(tt[0]-tt[2])+Math.abs(tt[1]-tt[3]),ot=Math.min(.25,.5*ie*(_t+We)/je),dt=Math.min(.25,.5*ie*it/$e);return _e+Math.max(ot*H,dt*ae)}(u,f,y):T;return{base:T+(i===0)?-1:i,top:S?Math.max(A+s,T+i+2):T+s}}const fC=Ht([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:pC}=fC,mC=Ht([{name:"a_packed",components:4,type:"Float32"}]),{members:gC}=mC,_C=Np.types,vC=Math.cos(Math.PI/180*37.5);class Gp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new li,this.layoutVertexArray2=new ri,this.indexArray=new xr,this.programConfigurations=new $l(e.layers,e.zoom),this.segments=new Vi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s,u){this.hasPattern=l_("line",this.layers,i);const f=this.layers[0].layout.get("line-sort-key"),g=[];for(const{feature:A,id:P,index:z,sourceLayerIndex:F}of e){const $=this.layers[0]._featureFilter.needGeometry,j=Zl(A,$);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),j,s))continue;const H=f?f.evaluate(j,{},s):void 0,ae={id:P,properties:A.properties,type:A.type,sourceLayerIndex:F,index:z,geometry:$?j.geometry:Ks(A,s,u),patterns:{},sortKey:H};g.push(ae)}f&&g.sort((A,P)=>A.sortKey-P.sortKey);const{lineAtlas:y,featureIndex:T}=i,S=this.addConstantDashes(y);for(const A of g){const{geometry:P,index:z,sourceLayerIndex:F}=A;if(S&&this.addFeatureDashes(A,y),this.hasPattern){const $=c_("line",this.layers,A,this.zoom,i);this.patternFeatures.push($)}else this.addFeature(A,P,z,s,y.positions,i.availableImages);T.insert(e[z].feature,P,z,F,this.index)}}addConstantDashes(e){let i=!1;for(const s of this.layers){const u=s.paint.get("line-dasharray").value,f=s.layout.get("line-cap").value;if(u.kind!=="constant"||f.kind!=="constant")i=!0;else{const g=f.value,y=u.value;if(!y)continue;e.addDash(y,g)}}return i}addFeatureDashes(e,i){const s=this.zoom;for(const u of this.layers){const f=u.paint.get("line-dasharray").value,g=u.layout.get("line-cap").value;if(f.kind==="constant"&&g.kind==="constant")continue;let y,T;if(f.kind==="constant"){if(y=f.value,!y)continue}else y=f.evaluate({zoom:s},e);T=g.kind==="constant"?g.value:g.evaluate({zoom:s},e),i.addDash(y,T),e.patterns[u.id]=i.getKey(y,T)}}update(e,i,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s,u)}addFeatures(e,i,s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,i,s,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,gC)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,pC),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,s,u,f,g){const y=this.layers[0].layout,T=y.get("line-join").evaluate(e,{}),S=y.get("line-cap").evaluate(e,{}),A=y.get("line-miter-limit"),P=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const z of i)this.addLine(z,e,T,S,A,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,g,u)}addLine(e,i,s,u,f,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ae=0;ae<e.length-1;ae++)this.totalDistance+=e[ae].dist(e[ae+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const y=_C[i.type]==="Polygon";let T=e.length;for(;T>=2&&e[T-1].equals(e[T-2]);)T--;let S=0;for(;S<T-1&&e[S].equals(e[S+1]);)S++;if(T<(y?3:2))return;s==="bevel"&&(f=1.05);const A=this.overscaling<=16?122880/(512*this.overscaling):0,P=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let z,F,$,j,H;this.e1=this.e2=-1,y&&(z=e[T-2],H=e[S].sub(z)._unit()._perp());for(let ae=S;ae<T;ae++){if($=ae===T-1?y?e[S+1]:void 0:e[ae+1],$&&e[ae].equals($))continue;H&&(j=H),z&&(F=z),z=e[ae],H=$?$.sub(z)._unit()._perp():j,j=j||H;let _e=j.add(H);_e.x===0&&_e.y===0||_e._unit();const ie=j.x*H.x+j.y*H.y,pe=_e.x*H.x+_e.y*H.y,Te=pe!==0?1/pe:1/0,ye=2*Math.sqrt(2-2*pe),je=pe<vC&&F&&$,$e=j.x*H.y-j.y*H.x>0;if(je&&ae>S){const We=z.dist(F);if(We>2*A){const it=z.sub(z.sub(F)._mult(A/We)._round());this.updateDistance(F,it),this.addCurrentVertex(it,j,0,0,P),F=it}}const tt=F&&$;let _t=tt?s:y?"butt":u;if(tt&&_t==="round"&&(Te<g?_t="miter":Te<=2&&(_t="fakeround")),_t==="miter"&&Te>f&&(_t="bevel"),_t==="bevel"&&(Te>2&&(_t="flipbevel"),Te<f&&(_t="miter")),F&&this.updateDistance(F,z),_t==="miter")_e._mult(Te),this.addCurrentVertex(z,_e,0,0,P);else if(_t==="flipbevel"){if(Te>100)_e=H.mult(-1);else{const We=Te*j.add(H).mag()/j.sub(H).mag();_e._perp()._mult(We*($e?-1:1))}this.addCurrentVertex(z,_e,0,0,P),this.addCurrentVertex(z,_e.mult(-1),0,0,P)}else if(_t==="bevel"||_t==="fakeround"){const We=-Math.sqrt(Te*Te-1),it=$e?We:0,ot=$e?0:We;if(F&&this.addCurrentVertex(z,j,it,ot,P),_t==="fakeround"){const dt=Math.round(180*ye/Math.PI/20);for(let vt=1;vt<dt;vt++){let Xe=vt/dt;if(Xe!==.5){const tn=Xe-.5;Xe+=Xe*tn*(Xe-1)*((1.0904+ie*(ie*(3.55645-1.43519*ie)-3.2452))*tn*tn+(.848013+ie*(.215638*ie-1.06021)))}const Ct=H.sub(j)._mult(Xe)._add(j)._unit()._mult($e?-1:1);this.addHalfVertex(z,Ct.x,Ct.y,!1,$e,0,P)}}$&&this.addCurrentVertex(z,H,-it,-ot,P)}else if(_t==="butt")this.addCurrentVertex(z,_e,0,0,P);else if(_t==="square"){const We=F?1:-1;F||this.addCurrentVertex(z,_e,We,We,P),this.addCurrentVertex(z,_e,0,0,P),F&&this.addCurrentVertex(z,_e,We,We,P)}else _t==="round"&&(F&&(this.addCurrentVertex(z,j,0,0,P),this.addCurrentVertex(z,j,1,1,P,!0)),$&&(this.addCurrentVertex(z,H,-1,-1,P,!0),this.addCurrentVertex(z,H,0,0,P)));if(je&&ae<T-1){const We=z.dist($);if(We>2*A){const it=z.add($.sub(z)._mult(A/We)._round());this.updateDistance(z,it),this.addCurrentVertex(it,H,0,0,P),z=it}}}}addCurrentVertex(e,i,s,u,f,g=!1){const y=i.y*u-i.x,T=-i.y-i.x*u;this.addHalfVertex(e,i.x+i.y*s,i.y-i.x*s,g,!1,s,f),this.addHalfVertex(e,y,T,g,!0,-u,f)}addHalfVertex({x:e,y:i},s,u,f,g,y,T){this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(i<<1)+(g?1:0),Math.round(63*s)+128,Math.round(63*u)+128,1+(y===0?0:y<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const S=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,S),T.primitiveLength++),g?this.e2=S:this.e1=S}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}$t(Gp,"LineBucket",{omit:["layers","patternFeatures"]});const yC=new mt({"line-cap":new Ze(et.layout_line["line-cap"]),"line-join":new Ze(et.layout_line["line-join"]),"line-miter-limit":new Le(et.layout_line["line-miter-limit"]),"line-round-limit":new Le(et.layout_line["line-round-limit"]),"line-sort-key":new Ze(et.layout_line["line-sort-key"])});var yx={paint:new mt({"line-opacity":new Ze(et.paint_line["line-opacity"]),"line-color":new Ze(et.paint_line["line-color"]),"line-translate":new Le(et.paint_line["line-translate"]),"line-translate-anchor":new Le(et.paint_line["line-translate-anchor"]),"line-width":new Ze(et.paint_line["line-width"]),"line-gap-width":new Ze(et.paint_line["line-gap-width"]),"line-offset":new Ze(et.paint_line["line-offset"]),"line-blur":new Ze(et.paint_line["line-blur"]),"line-dasharray":new Ze(et.paint_line["line-dasharray"]),"line-pattern":new Ze(et.paint_line["line-pattern"]),"line-gradient":new lt(et.paint_line["line-gradient"]),"line-trim-offset":new Le(et.paint_line["line-trim-offset"])}),layout:yC};const xx=new class extends Ze{possiblyEvaluate(n,e){return e=new Be(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(n,e)}evaluate(n,e,i,s){return e=pt({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(n,e,i,s)}}(yx.paint.properties["line-width"].specification);function bx(n,e){return e>0?e+2*n:n}xx.useIntegerZoom=!0;const xC=Ht([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),bC=Ht([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),wC=Ht([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ht([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const TC=Ht([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),SC=Ht([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ht([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const wx=Ht([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),EC=Ht([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ht([{name:"triangle",components:3,type:"Uint16"}]),Ht([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ht([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ht([{type:"Float32",name:"offsetX"}]),Ht([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Tr=24;const ys=128;function d_(n,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new Be(n+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:s,interpolationType:u}=i;let f=0;for(;f<s.length&&s[f]<=n;)f++;f=Math.max(0,f-1);let g=f;for(;g<s.length&&s[g]<n+1;)g++;g=Math.min(s.length-1,g);const y=s[f],T=s[g];return i.kind==="composite"?{kind:"composite",minZoom:y,maxZoom:T,interpolationType:u}:{kind:"camera",minZoom:y,maxZoom:T,minSize:i.evaluate(new Be(y)),maxSize:i.evaluate(new Be(T)),interpolationType:u}}}function qp(n,{uSize:e,uSizeT:i},{lowerSize:s,upperSize:u}){return n.kind==="source"?s/ys:n.kind==="composite"?Fn(s/ys,u/ys,i):e}function Eu(n,e){let i=0,s=0;if(n.kind==="constant")s=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:u,minZoom:f,maxZoom:g}=n,y=u?nt(vo.interpolationFactor(u,e,f,g),0,1):0;n.kind==="camera"?s=Fn(n.minSize,n.maxSize,y):i=y}return{uSizeT:i,uSize:s}}var CC=Object.freeze({__proto__:null,getSizeData:d_,evaluateSizeForFeature:qp,evaluateSizeForZoom:Eu,SIZE_PACK_FACTOR:ys});function IC(n,e,i){return n.sections.forEach(s=>{s.text=function(u,f,g){const y=f.layout.get("text-transform").evaluate(g,{});return y==="uppercase"?u=u.toLocaleUpperCase():y==="lowercase"&&(u=u.toLocaleLowerCase()),Ae.applyArabicShaping&&(u=Ae.applyArabicShaping(u)),u}(s.text,e,i)}),n}const wh={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function AC(n){return n==="\uFE36"||n==="\uFE48"||n==="\uFE38"||n==="\uFE44"||n==="\uFE42"||n==="\uFE3E"||n==="\uFE3C"||n==="\uFE3A"||n==="\uFE18"||n==="\uFE40"||n==="\uFE10"||n==="\uFE13"||n==="\uFE14"||n==="\uFF40"||n==="\uFFE3"||n==="\uFE11"||n==="\uFE12"}function kC(n){return n==="\uFE35"||n==="\uFE47"||n==="\uFE37"||n==="\uFE43"||n==="\uFE41"||n==="\uFE3D"||n==="\uFE3B"||n==="\uFE39"||n==="\uFE17"||n==="\uFE3F"}var Th=ci,Tx=function(n,e,i,s,u){var f,g,y=8*u-s-1,T=(1<<y)-1,S=T>>1,A=-7,P=i?u-1:0,z=i?-1:1,F=n[e+P];for(P+=z,f=F&(1<<-A)-1,F>>=-A,A+=y;A>0;f=256*f+n[e+P],P+=z,A-=8);for(g=f&(1<<-A)-1,f>>=-A,A+=s;A>0;g=256*g+n[e+P],P+=z,A-=8);if(f===0)f=1-S;else{if(f===T)return g?NaN:1/0*(F?-1:1);g+=Math.pow(2,s),f-=S}return(F?-1:1)*g*Math.pow(2,f-s)},Sx=function(n,e,i,s,u,f){var g,y,T,S=8*f-u-1,A=(1<<S)-1,P=A>>1,z=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=s?0:f-1,$=s?1:-1,j=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(y=isNaN(e)?1:0,g=A):(g=Math.floor(Math.log(e)/Math.LN2),e*(T=Math.pow(2,-g))<1&&(g--,T*=2),(e+=g+P>=1?z/T:z*Math.pow(2,1-P))*T>=2&&(g++,T/=2),g+P>=A?(y=0,g=A):g+P>=1?(y=(e*T-1)*Math.pow(2,u),g+=P):(y=e*Math.pow(2,P-1)*Math.pow(2,u),g=0));u>=8;n[i+F]=255&y,F+=$,y/=256,u-=8);for(g=g<<u|y,S+=u;S>0;n[i+F]=255&g,F+=$,g/=256,S-=8);n[i+F-$]|=128*j};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function ci(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}ci.Varint=0,ci.Fixed64=1,ci.Bytes=2,ci.Fixed32=5;var h_=4294967296,Ex=1/h_,Cx=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Qs(n){return n.type===ci.Bytes?n.readVarint()+n.pos:n.pos+1}function Cu(n,e,i){return i?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}function Ix(n,e,i){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(s);for(var u=i.pos-1;u>=n;u--)i.buf[u+s]=i.buf[u]}function MC(n,e){for(var i=0;i<n.length;i++)e.writeVarint(n[i])}function PC(n,e){for(var i=0;i<n.length;i++)e.writeSVarint(n[i])}function zC(n,e){for(var i=0;i<n.length;i++)e.writeFloat(n[i])}function LC(n,e){for(var i=0;i<n.length;i++)e.writeDouble(n[i])}function DC(n,e){for(var i=0;i<n.length;i++)e.writeBoolean(n[i])}function BC(n,e){for(var i=0;i<n.length;i++)e.writeFixed32(n[i])}function RC(n,e){for(var i=0;i<n.length;i++)e.writeSFixed32(n[i])}function OC(n,e){for(var i=0;i<n.length;i++)e.writeFixed64(n[i])}function FC(n,e){for(var i=0;i<n.length;i++)e.writeSFixed64(n[i])}function Zp(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+16777216*n[e+3]}function Iu(n,e,i){n[i]=e,n[i+1]=e>>>8,n[i+2]=e>>>16,n[i+3]=e>>>24}function Ax(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}function VC(n,e,i){e.glyphs=[],n===1&&i.readMessage($C,e)}function $C(n,e,i){if(n===3){const{id:s,bitmap:u,width:f,height:g,left:y,top:T,advance:S}=i.readMessage(NC,{});e.glyphs.push({id:s,bitmap:new Js({width:f+6,height:g+6},u),metrics:{width:f,height:g,left:y,top:T,advance:S}})}else n===4?e.ascender=i.readSVarint():n===5&&(e.descender=i.readSVarint())}function NC(n,e,i){n===1?e.id=i.readVarint():n===2?e.bitmap=i.readBytes():n===3?e.width=i.readVarint():n===4?e.height=i.readVarint():n===5?e.left=i.readSVarint():n===6?e.top=i.readSVarint():n===7&&(e.advance=i.readVarint())}function f_(n){let e=0,i=0;for(const g of n)e+=g.w*g.h,i=Math.max(i,g.w);n.sort((g,y)=>y.h-g.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let u=0,f=0;for(const g of n)for(let y=s.length-1;y>=0;y--){const T=s[y];if(!(g.w>T.w||g.h>T.h)){if(g.x=T.x,g.y=T.y,f=Math.max(f,g.y+g.h),u=Math.max(u,g.x+g.w),g.w===T.w&&g.h===T.h){const S=s.pop();y<s.length&&(s[y]=S)}else g.h===T.h?(T.x+=g.w,T.w-=g.w):g.w===T.w?(T.y+=g.h,T.h-=g.h):(s.push({x:T.x+g.w,y:T.y,w:T.w-g.w,h:g.h}),T.y+=g.h,T.h-=g.h);break}}return{w:u,h:f,fill:e/(u*f)||0}}ci.prototype={destroy:function(){this.buf=null},readFields:function(n,e,i){for(i=i||this.length;this.pos<i;){var s=this.readVarint(),u=s>>3,f=this.pos;this.type=7&s,n(u,e,this),this.pos===f&&this.skip(s)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=Zp(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=Ax(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=Zp(this.buf,this.pos)+Zp(this.buf,this.pos+4)*h_;return this.pos+=8,n},readSFixed64:function(){var n=Zp(this.buf,this.pos)+Ax(this.buf,this.pos+4)*h_;return this.pos+=8,n},readFloat:function(){var n=Tx(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=Tx(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e,i,s=this.buf;return e=127&(i=s[this.pos++]),i<128?e:(e|=(127&(i=s[this.pos++]))<<7,i<128?e:(e|=(127&(i=s[this.pos++]))<<14,i<128?e:(e|=(127&(i=s[this.pos++]))<<21,i<128?e:function(u,f,g){var y,T,S=g.buf;if(y=(112&(T=S[g.pos++]))>>4,T<128||(y|=(127&(T=S[g.pos++]))<<3,T<128)||(y|=(127&(T=S[g.pos++]))<<10,T<128)||(y|=(127&(T=S[g.pos++]))<<17,T<128)||(y|=(127&(T=S[g.pos++]))<<24,T<128)||(y|=(1&(T=S[g.pos++]))<<31,T<128))return Cu(u,y,f);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=s[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=12&&Cx?function(i,s,u){return Cx.decode(i.subarray(s,u))}(this.buf,e,n):function(i,s,u){for(var f="",g=s;g<u;){var y,T,S,A=i[g],P=null,z=A>239?4:A>223?3:A>191?2:1;if(g+z>u)break;z===1?A<128&&(P=A):z===2?(192&(y=i[g+1]))==128&&(P=(31&A)<<6|63&y)<=127&&(P=null):z===3?(T=i[g+2],(192&(y=i[g+1]))==128&&(192&T)==128&&((P=(15&A)<<12|(63&y)<<6|63&T)<=2047||P>=55296&&P<=57343)&&(P=null)):z===4&&(T=i[g+2],S=i[g+3],(192&(y=i[g+1]))==128&&(192&T)==128&&(192&S)==128&&((P=(15&A)<<18|(63&y)<<12|(63&T)<<6|63&S)<=65535||P>=1114112)&&(P=null)),P===null?(P=65533,z=1):P>65535&&(P-=65536,f+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),f+=String.fromCharCode(P),g+=z}return f}(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==ci.Bytes)return n.push(this.readVarint(e));var i=Qs(this);for(n=n||[];this.pos<i;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==ci.Bytes)return n.push(this.readSVarint());var e=Qs(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==ci.Bytes)return n.push(this.readBoolean());var e=Qs(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==ci.Bytes)return n.push(this.readFloat());var e=Qs(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==ci.Bytes)return n.push(this.readDouble());var e=Qs(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==ci.Bytes)return n.push(this.readFixed32());var e=Qs(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==ci.Bytes)return n.push(this.readSFixed32());var e=Qs(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==ci.Bytes)return n.push(this.readFixed64());var e=Qs(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==ci.Bytes)return n.push(this.readSFixed64());var e=Qs(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=7&n;if(e===ci.Varint)for(;this.buf[this.pos++]>127;);else if(e===ci.Bytes)this.pos=this.readVarint()+this.pos;else if(e===ci.Fixed32)this.pos+=4;else{if(e!==ci.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),Iu(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),Iu(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),Iu(this.buf,-1&n,this.pos),Iu(this.buf,Math.floor(n*Ex),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),Iu(this.buf,-1&n,this.pos),Iu(this.buf,Math.floor(n*Ex),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(e,i){var s,u;if(e>=0?(s=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,u=u+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(f,g,y){y.buf[y.pos++]=127&f|128,f>>>=7,y.buf[y.pos++]=127&f|128,f>>>=7,y.buf[y.pos++]=127&f|128,f>>>=7,y.buf[y.pos++]=127&f|128,y.buf[y.pos]=127&(f>>>=7)}(s,0,i),function(f,g){var y=(7&f)<<4;g.buf[g.pos++]|=y|((f>>>=3)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f)))))}(u,i)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(Boolean(n))},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var e=this.pos;this.pos=function(s,u,f){for(var g,y,T=0;T<u.length;T++){if((g=u.charCodeAt(T))>55295&&g<57344){if(!y){g>56319||T+1===u.length?(s[f++]=239,s[f++]=191,s[f++]=189):y=g;continue}if(g<56320){s[f++]=239,s[f++]=191,s[f++]=189,y=g;continue}g=y-55296<<10|g-56320|65536,y=null}else y&&(s[f++]=239,s[f++]=191,s[f++]=189,y=null);g<128?s[f++]=g:(g<2048?s[f++]=g>>6|192:(g<65536?s[f++]=g>>12|224:(s[f++]=g>>18|240,s[f++]=g>>12&63|128),s[f++]=g>>6&63|128),s[f++]=63&g|128)}return f}(this.buf,n,this.pos);var i=this.pos-e;i>=128&&Ix(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(n){this.realloc(4),Sx(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),Sx(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=n[i]},writeRawMessage:function(n,e){this.pos++;var i=this.pos;n(e,this);var s=this.pos-i;s>=128&&Ix(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s},writeMessage:function(n,e,i){this.writeTag(n,ci.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,MC,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,PC,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,DC,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,zC,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,LC,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,BC,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,RC,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,OC,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,FC,e)},writeBytesField:function(n,e){this.writeTag(n,ci.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,ci.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,ci.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,ci.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,ci.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,ci.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,ci.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,ci.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,ci.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,ci.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,Boolean(e))}};class p_{constructor(e,{pixelRatio:i,version:s,stretchX:u,stretchY:f,content:g}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=u,this.stretchY=f,this.content=g,this.version=s}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class kx{constructor(e,i){const s={},u={};this.haveRenderCallbacks=[];const f=[];this.addImages(e,s,f),this.addImages(i,u,f);const{w:g,h:y}=f_(f),T=new Kr({width:g||1,height:y||1});for(const S in e){const A=e[S],P=s[S].paddedRect;Kr.copy(A.data,T,{x:0,y:0},{x:P.x+1,y:P.y+1},A.data)}for(const S in i){const A=i[S],P=u[S].paddedRect,z=P.x+1,F=P.y+1,$=A.data.width,j=A.data.height;Kr.copy(A.data,T,{x:0,y:0},{x:z,y:F},A.data),Kr.copy(A.data,T,{x:0,y:j-1},{x:z,y:F-1},{width:$,height:1}),Kr.copy(A.data,T,{x:0,y:0},{x:z,y:F+j},{width:$,height:1}),Kr.copy(A.data,T,{x:$-1,y:0},{x:z-1,y:F},{width:1,height:j}),Kr.copy(A.data,T,{x:0,y:0},{x:z+$,y:F},{width:1,height:j})}this.image=T,this.iconPositions=s,this.patternPositions=u}addImages(e,i,s){for(const u in e){const f=e[u],g={x:0,y:0,w:f.data.width+2,h:f.data.height+2};s.push(g),i[u]=new p_(g,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(s=>e.hasImage(s)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),i),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),i)}patchUpdatedImage(e,i,s){if(!e||!i||e.version===i.version)return;e.version=i.version;const[u,f]=e.tl;s.update(i.data,void 0,{x:u,y:f})}}$t(p_,"ImagePosition"),$t(kx,"ImageAtlas");const ao={horizontal:1,vertical:2,horizontalOnly:3};class Sh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const s=new Sh;return s.scale=e||1,s.fontStack=i,s}static forImage(e){const i=new Sh;return i.imageName=e,i}}class Au{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const s=new Au;for(let u=0;u<e.sections.length;u++){const f=e.sections[u];f.image?s.addImageSection(f):s.addTextSection(f,i)}return s}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(i,s){let u="";for(let f=0;f<i.length;f++){const g=i.charCodeAt(f+1)||null,y=i.charCodeAt(f-1)||null;u+=!s&&(g&&k(g)&&!wh[i[f+1]]||y&&k(y)&&!wh[i[f-1]])||!wh[i[f]]?i[f]:wh[i[f]]}return u}(this.text,e)}trim(){let e=0;for(let s=0;s<this.text.length&&Wp[this.text.charCodeAt(s)];s++)e++;let i=this.text.length;for(let s=this.text.length-1;s>=0&&s>=e&&Wp[this.text.charCodeAt(s)];s--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const s=new Au;return s.text=this.text.substring(e,i),s.sectionIndex=this.sectionIndex.slice(e,i),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(Sh.forText(e.scale,e.fontStack||i));const s=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(s)}addImageSection(e){const i=e.image?e.image.name:"";if(i.length===0)return void ue("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(Sh.forImage(i)),this.sectionIndex.push(this.sections.length-1)):ue("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function m_(n,e,i,s,u,f,g,y,T,S,A,P,z,F,$){const j=Au.fromFeature(n,u);P===ao.vertical&&j.verticalizePunctuation(z);let H=[];const ae=function(ye,je,$e,tt,_t,We){if(!ye)return[];const it=[],ot=function(Ct,tn,Dt,qt,It,sn){let An=0;for(let wn=0;wn<Ct.length();wn++){const yn=Ct.getSection(wn);An+=Mx(Ct.getCharCode(wn),yn,qt,It,tn,sn)}return An/Math.max(1,Math.ceil(An/Dt))}(ye,je,$e,tt,_t,We),dt=ye.text.indexOf("\u200B")>=0;let vt=0;for(let Ct=0;Ct<ye.length();Ct++){const tn=ye.getSection(Ct),Dt=ye.getCharCode(Ct);if(Wp[Dt]||(vt+=Mx(Dt,tn,tt,_t,je,We)),Ct<ye.length()-1){const qt=!((Xe=Dt)<11904||!(pp(Xe)||hu(Xe)||h(Xe)||wp(Xe)||_p(Xe)||fp(Xe)||mp(Xe)||Ol(Xe)||vp(Xe)||eh(Xe)||gp(Xe)||p(Xe)||du(Xe)||Jd(Xe)||Kd(Xe)||Qd(Xe)||Oa(Xe)||Fl(Xe)||xp(Xe)||yp(Xe)));(UC[Dt]||qt||tn.imageName)&&it.push(zx(Ct+1,vt,ot,it,jC(Dt,ye.getCharCode(Ct+1),qt&&dt),!1))}}var Xe;return Lx(zx(ye.length(),vt,ot,it,0,!0))}(j,S,f,e,s,F),{processBidirectionalText:_e,processStyledBidirectionalText:ie}=Ae;if(_e&&j.sections.length===1){const ye=_e(j.toString(),ae);for(const je of ye){const $e=new Au;$e.text=je,$e.sections=j.sections;for(let tt=0;tt<je.length;tt++)$e.sectionIndex.push(0);H.push($e)}}else if(ie){const ye=ie(j.text,j.sectionIndex,ae);for(const je of ye){const $e=new Au;$e.text=je[0],$e.sectionIndex=je[1],$e.sections=j.sections,H.push($e)}}else H=function(ye,je){const $e=[],tt=ye.text;let _t=0;for(const We of je)$e.push(ye.substring(_t,We)),_t=We;return _t<tt.length&&$e.push(ye.substring(_t,tt.length)),$e}(j,ae);const pe=[],Te={positionedLines:pe,text:j.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ye,je,$e,tt,_t,We,it,ot,dt,vt,Xe,Ct){let tn=0,Dt=0,qt=0;const It=ot==="right"?1:ot==="left"?0:.5;let sn=!1;for(const dn of _t){const kn=dn.getSections();for(const ti of kn){if(ti.imageName)continue;const hi=je[ti.fontStack];if(hi&&(sn=hi.ascender!==void 0&&hi.descender!==void 0,!sn))break}if(!sn)break}let An=0;for(const dn of _t){dn.trim();const kn=dn.getMaxScale(),ti=(kn-1)*Tr,hi={positionedGlyphs:[],lineOffset:0};ye.positionedLines[An]=hi;const ui=hi.positionedGlyphs;let fi=0;if(!dn.length()){Dt+=We,++An;continue}let _i=0,Ai=0;for(let Kn=0;Kn<dn.length();Kn++){const Xi=dn.getSection(Kn),Ni=dn.getSectionIndex(Kn),Nn=dn.getCharCode(Kn);let xi=Xi.scale,Qi=null,ni=null,Di=null,Ar=Tr,ur=0;const dr=!(dt===ao.horizontal||!Xe&&!I(Nn)||Xe&&(Wp[Nn]||(wn=Nn,Rl(wn)||hp(wn)||Yd(wn)||fu(wn)||c(wn))));if(Xi.imageName){const Vr=tt[Xi.imageName];if(!Vr)continue;Di=Xi.imageName,ye.iconsInText=ye.iconsInText||!0,ni=Vr.paddedRect;const hr=Vr.displaySize;xi=xi*Tr/Ct,Qi={width:hr[0],height:hr[1],left:1,top:-3,advance:dr?hr[1]:hr[0],localGlyph:!1},ur=sn?-Qi.height*xi:kn*Tr-17-hr[1]*xi,Ar=Qi.advance;const ta=(dr?hr[0]:hr[1])*xi-Tr*kn;ta>0&&ta>fi&&(fi=ta)}else{const Vr=$e[Xi.fontStack];if(!Vr)continue;Vr[Nn]&&(ni=Vr[Nn]);const hr=je[Xi.fontStack];if(!hr)continue;const ta=hr.glyphs[Nn];if(!ta)continue;if(Qi=ta.metrics,Ar=Nn!==8203?Tr:0,sn){const Lu=hr.ascender!==void 0?Math.abs(hr.ascender):0,zh=hr.descender!==void 0?Math.abs(hr.descender):0,Lh=(Lu+zh)*xi;_i<Lh&&(_i=Lh,Ai=(Lu-zh)/2*xi),ur=-Lu*xi}else ur=(kn-xi)*Tr-17}dr?(ye.verticalizable=!0,ui.push({glyph:Nn,imageName:Di,x:tn,y:Dt+ur,vertical:dr,scale:xi,localGlyph:Qi.localGlyph,fontStack:Xi.fontStack,sectionIndex:Ni,metrics:Qi,rect:ni}),tn+=Ar*xi+vt):(ui.push({glyph:Nn,imageName:Di,x:tn,y:Dt+ur,vertical:dr,scale:xi,localGlyph:Qi.localGlyph,fontStack:Xi.fontStack,sectionIndex:Ni,metrics:Qi,rect:ni}),tn+=Qi.advance*xi+vt)}ui.length!==0&&(qt=Math.max(tn-vt,qt),sn?Dx(ui,It,fi,Ai,We*kn/2):Dx(ui,It,fi,0,We/2)),tn=0;const cr=We*kn+fi;hi.lineOffset=Math.max(fi,ti),Dt+=cr,++An}var wn;const yn=Dt,{horizontalAlign:an,verticalAlign:Yn}=g_(it);(function(dn,kn,ti,hi,ui,fi){const _i=(kn-ti)*ui,Ai=-fi*hi;for(const cr of dn)for(const Kn of cr.positionedGlyphs)Kn.x+=_i,Kn.y+=Ai})(ye.positionedLines,It,an,Yn,qt,yn),ye.top+=-Yn*yn,ye.bottom=ye.top+yn,ye.left+=-an*qt,ye.right=ye.left+qt,ye.hasBaseline=sn}(Te,e,i,s,H,g,y,T,P,S,z,$),!function(ye){for(const je of ye)if(je.positionedGlyphs.length!==0)return!1;return!0}(pe)&&Te}const Wp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},UC={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Mx(n,e,i,s,u,f){if(e.imageName){const g=s[e.imageName];return g?g.displaySize[0]*e.scale*Tr/f+u:0}{const g=i[e.fontStack],y=g&&g.glyphs[n];return y?y.metrics.advance*e.scale+u:0}}function Px(n,e,i,s){const u=Math.pow(n-e,2);return s?n<e?u/2:2*u:u+Math.abs(i)*i}function jC(n,e,i){let s=0;return n===10&&(s-=1e4),i&&(s+=150),n!==40&&n!==65288||(s+=50),e!==41&&e!==65289||(s+=50),s}function zx(n,e,i,s,u,f){let g=null,y=Px(e,i,u,f);for(const T of s){const S=Px(e-T.x,i,u,f)+T.badness;S<=y&&(g=T,y=S)}return{index:n,x:e,priorBreak:g,badness:y}}function Lx(n){return n?Lx(n.priorBreak).concat(n.index):[]}function g_(n){let e=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function Dx(n,e,i,s,u){if(!(e||i||s||u))return;const f=n.length-1,g=n[f],y=(g.x+g.metrics.advance*g.scale)*e;for(let T=0;T<=f;T++)n[T].x-=y,n[T].y+=i+s+u}function GC(n,e,i){const{horizontalAlign:s,verticalAlign:u}=g_(i),f=e[0]-n.displaySize[0]*s,g=e[1]-n.displaySize[1]*u;return{image:n,top:g,bottom:g+n.displaySize[1],left:f,right:f+n.displaySize[0]}}function Bx(n,e,i,s,u,f){const g=n.image;let y;if(g.content){const H=g.content,ae=g.pixelRatio||1;y=[H[0]/ae,H[1]/ae,g.displaySize[0]-H[2]/ae,g.displaySize[1]-H[3]/ae]}const T=e.left*f,S=e.right*f;let A,P,z,F;i==="width"||i==="both"?(F=u[0]+T-s[3],P=u[0]+S+s[1]):(F=u[0]+(T+S-g.displaySize[0])/2,P=F+g.displaySize[0]);const $=e.top*f,j=e.bottom*f;return i==="height"||i==="both"?(A=u[1]+$-s[0],z=u[1]+j+s[2]):(A=u[1]+($+j-g.displaySize[1])/2,z=A+g.displaySize[1]),{image:g,top:A,right:P,bottom:z,left:F,collisionPadding:y}}class ea extends Y{constructor(e,i,s,u,f){super(e,i),this.angle=u,this.z=s,f!==void 0&&(this.segment=f)}clone(){return new ea(this.x,this.y,this.z,this.angle,this.segment)}}function Rx(n,e,i,s,u){if(e.segment===void 0)return!0;let f=e,g=e.segment+1,y=0;for(;y>-i/2;){if(g--,g<0)return!1;y-=n[g].dist(f),f=n[g]}y+=n[g].dist(n[g+1]),g++;const T=[];let S=0;for(;y<i/2;){const A=n[g],P=n[g+1];if(!P)return!1;let z=n[g-1].angleTo(A)-A.angleTo(P);for(z=Math.abs((z+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:y,angleDelta:z}),S+=z;y-T[0].distance>s;)S-=T.shift().angleDelta;if(S>u)return!1;g++,y+=A.dist(P)}return!0}function Ox(n){let e=0;for(let i=0;i<n.length-1;i++)e+=n[i].dist(n[i+1]);return e}function Fx(n,e,i){return n?.6*e*i:0}function Vx(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function qC(n,e,i,s,u,f){const g=Fx(i,u,f),y=Vx(i,s)*f;let T=0;const S=Ox(n)/2;for(let A=0;A<n.length-1;A++){const P=n[A],z=n[A+1],F=P.dist(z);if(T+F>S){const $=(S-T)/F,j=Fn(P.x,z.x,$),H=Fn(P.y,z.y,$),ae=new ea(j,H,0,z.angleTo(P),A);return!g||Rx(n,ae,y,g,e)?ae:void 0}T+=F}}function ZC(n,e,i,s,u,f,g,y,T){const S=Fx(s,f,g),A=Vx(s,u),P=A*g,z=n[0].x===0||n[0].x===T||n[0].y===0||n[0].y===T;return e-P<e/4&&(e=P+e/4),$x(n,z?e/2*y%e:(A/2+2*f)*g*y%e,e,S,i,P,z,!1,T)}function $x(n,e,i,s,u,f,g,y,T){const S=f/2,A=Ox(n);let P=0,z=e-i,F=[];for(let $=0;$<n.length-1;$++){const j=n[$],H=n[$+1],ae=j.dist(H),_e=H.angleTo(j);for(;z+i<P+ae;){z+=i;const ie=(z-P)/ae,pe=Fn(j.x,H.x,ie),Te=Fn(j.y,H.y,ie);if(pe>=0&&pe<T&&Te>=0&&Te<T&&z-S>=0&&z+S<=A){const ye=new ea(pe,Te,0,_e,$);ye._round(),s&&!Rx(n,ye,f,s,u)||F.push(ye)}}P+=ae}return y||F.length||g||(F=$x(n,P/2,i,s,u,f,g,!0,T)),F}function Nx(n,e,i,s,u){const f=[];for(let g=0;g<n.length;g++){const y=n[g];let T;for(let S=0;S<y.length-1;S++){let A=y[S],P=y[S+1];A.x<e&&P.x<e||(A.x<e?A=new Y(e,A.y+(e-A.x)/(P.x-A.x)*(P.y-A.y))._round():P.x<e&&(P=new Y(e,A.y+(e-A.x)/(P.x-A.x)*(P.y-A.y))._round()),A.y<i&&P.y<i||(A.y<i?A=new Y(A.x+(i-A.y)/(P.y-A.y)*(P.x-A.x),i)._round():P.y<i&&(P=new Y(A.x+(i-A.y)/(P.y-A.y)*(P.x-A.x),i)._round()),A.x>=s&&P.x>=s||(A.x>=s?A=new Y(s,A.y+(s-A.x)/(P.x-A.x)*(P.y-A.y))._round():P.x>=s&&(P=new Y(s,A.y+(s-A.x)/(P.x-A.x)*(P.y-A.y))._round()),A.y>=u&&P.y>=u||(A.y>=u?A=new Y(A.x+(u-A.y)/(P.y-A.y)*(P.x-A.x),u)._round():P.y>=u&&(P=new Y(A.x+(u-A.y)/(P.y-A.y)*(P.x-A.x),u)._round()),T&&A.equals(T[T.length-1])||(T=[A],f.push(T)),T.push(P)))))}}return f}$t(ea,"Anchor");const Eh=1e20;function Ux(n,e,i,s,u,f,g,y,T){for(let S=e;S<e+s;S++)jx(n,i*f+S,f,u,g,y,T);for(let S=i;S<i+u;S++)jx(n,S*f+e,1,s,g,y,T)}function jx(n,e,i,s,u,f,g){f[0]=0,g[0]=-Eh,g[1]=Eh,u[0]=n[e];for(let y=1,T=0,S=0;y<s;y++){u[y]=n[e+y*i];const A=y*y;do{const P=f[T];S=(u[y]-u[P]+A-P*P)/(y-P)/2}while(S<=g[T]&&--T>-1);T++,f[T]=y,g[T]=S,g[T+1]=Eh}for(let y=0,T=0;y<s;y++){for(;g[T+1]<y;)T++;const S=f[T],A=y-S;n[e+y*i]=u[S]+A*A}}const __={none:0,ideographs:1,all:2};class ku{constructor(e,i,s){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=s,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,i){const s=[];for(const u in e)for(const f of e[u])s.push({stack:u,id:f});at(s,({stack:u,id:f},g)=>{let y=this.entries[u];y||(y=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let T=y.glyphs[f];if(T!==void 0)return void g(null,{stack:u,id:f,glyph:T});if(T=this._tinySDF(y,u,f),T)return y.glyphs[f]=T,void g(null,{stack:u,id:f,glyph:T});const S=Math.floor(f/256);if(256*S>65535)return void g(new Error("glyphs > 65535 not supported"));if(y.ranges[S])return void g(null,{stack:u,id:f,glyph:T});let A=y.requests[S];A||(A=y.requests[S]=[],ku.loadGlyphRange(u,S,this.url,this.requestManager,(P,z)=>{if(z){y.ascender=z.ascender,y.descender=z.descender;for(const F in z.glyphs)this._doesCharSupportLocalGlyph(+F)||(y.glyphs[+F]=z.glyphs[+F]);y.ranges[S]=!0}for(const F of A)F(P,z);delete y.requests[S]})),A.push((P,z)=>{P?g(P):z&&g(null,{stack:u,id:f,glyph:z.glyphs[f]||null})})},(u,f)=>{if(u)i(u);else if(f){const g={};for(const{stack:y,id:T,glyph:S}of f)g[y]===void 0&&(g[y]={}),g[y].glyphs===void 0&&(g[y].glyphs={}),g[y].glyphs[T]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics},g[y].ascender=this.entries[y].ascender,g[y].descender=this.entries[y].descender;i(null,g)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==__.none&&(this.localGlyphMode===__.all?!!this.localFontFamily:!!this.localFontFamily&&(eh(e)||bp(e)||du(e)||Oa(e)||Ol(e)))}_tinySDF(e,i,s){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(s))return;let f=e.tinySDF;if(!f){let j="400";/bold/i.test(i)?j="900":/medium/i.test(i)?j="500":/light/i.test(i)&&(j="200"),f=e.tinySDF=new ku.TinySDF({fontFamily:u,fontWeight:j,fontSize:48,buffer:6,radius:16}),f.fontWeight=j}if(this.localGlyphs[f.fontWeight][s])return this.localGlyphs[f.fontWeight][s];const g=String.fromCharCode(s),{data:y,width:T,height:S,glyphWidth:A,glyphHeight:P,glyphLeft:z,glyphTop:F,glyphAdvance:$}=f.draw(g);return this.localGlyphs[f.fontWeight][s]={id:s,bitmap:new Js({width:T,height:S},y),metrics:{width:A/2,height:P/2,left:z/2,top:F/2-27,advance:$/2,localGlyph:!0}}}}function Gx(n,e,i,s){const u=[],f=n.image,g=f.pixelRatio,y=f.paddedRect.w-2,T=f.paddedRect.h-2,S=n.right-n.left,A=n.bottom-n.top,P=f.stretchX||[[0,y]],z=f.stretchY||[[0,T]],F=(We,it)=>We+it[1]-it[0],$=P.reduce(F,0),j=z.reduce(F,0),H=y-$,ae=T-j;let _e=0,ie=$,pe=0,Te=j,ye=0,je=H,$e=0,tt=ae;if(f.content&&s){const We=f.content;_e=Hp(P,0,We[0]),pe=Hp(z,0,We[1]),ie=Hp(P,We[0],We[2]),Te=Hp(z,We[1],We[3]),ye=We[0]-_e,$e=We[1]-pe,je=We[2]-We[0]-ie,tt=We[3]-We[1]-Te}const _t=(We,it,ot,dt)=>{const vt=Xp(We.stretch-_e,ie,S,n.left),Xe=Yp(We.fixed-ye,je,We.stretch,$),Ct=Xp(it.stretch-pe,Te,A,n.top),tn=Yp(it.fixed-$e,tt,it.stretch,j),Dt=Xp(ot.stretch-_e,ie,S,n.left),qt=Yp(ot.fixed-ye,je,ot.stretch,$),It=Xp(dt.stretch-pe,Te,A,n.top),sn=Yp(dt.fixed-$e,tt,dt.stretch,j),An=new Y(vt,Ct),wn=new Y(Dt,Ct),yn=new Y(Dt,It),an=new Y(vt,It),Yn=new Y(Xe/g,tn/g),dn=new Y(qt/g,sn/g),kn=e*Math.PI/180;if(kn){const ui=Math.sin(kn),fi=Math.cos(kn),_i=[fi,-ui,ui,fi];An._matMult(_i),wn._matMult(_i),an._matMult(_i),yn._matMult(_i)}const ti=We.stretch+We.fixed,hi=it.stretch+it.fixed;return{tl:An,tr:wn,bl:an,br:yn,tex:{x:f.paddedRect.x+1+ti,y:f.paddedRect.y+1+hi,w:ot.stretch+ot.fixed-ti,h:dt.stretch+dt.fixed-hi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yn,pixelOffsetBR:dn,minFontScaleX:je/g/S,minFontScaleY:tt/g/A,isSDF:i}};if(s&&(f.stretchX||f.stretchY)){const We=qx(P,H,$),it=qx(z,ae,j);for(let ot=0;ot<We.length-1;ot++){const dt=We[ot],vt=We[ot+1];for(let Xe=0;Xe<it.length-1;Xe++)u.push(_t(dt,it[Xe],vt,it[Xe+1]))}}else u.push(_t({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:y+1},{fixed:0,stretch:T+1}));return u}function Hp(n,e,i){let s=0;for(const u of n)s+=Math.max(e,Math.min(i,u[1]))-Math.max(e,Math.min(i,u[0]));return s}function qx(n,e,i){const s=[{fixed:-1,stretch:0}];for(const[u,f]of n){const g=s[s.length-1];s.push({fixed:u-g.stretch,stretch:g.stretch}),s.push({fixed:u-g.stretch,stretch:g.stretch+(f-u)})}return s.push({fixed:e+1,stretch:i}),s}function Xp(n,e,i,s){return n/e*i+s}function Yp(n,e,i,s){return n-e*i/s}function WC(n,e,i,s){const u=e+n.positionedLines[s].lineOffset;return s===0?i+u/2:i+(u+(e+n.positionedLines[s-1].lineOffset))/2}ku.loadGlyphRange=function(n,e,i,s,u){const f=256*e,g=f+255,y=s.transformRequest(s.normalizeGlyphsURL(i).replace("{fontstack}",n).replace("{range}",`${f}-${g}`),tr.Glyphs);mo(y,(T,S)=>{if(T)u(T);else if(S){const A={},P=function(z){return new Th(z).readFields(VC,{})}(S);for(const z of P.glyphs)A[z.id]=z;u(null,{glyphs:A,ascender:P.ascender,descender:P.descender})}})},ku.TinySDF=class{constructor({fontSize:n=24,buffer:e=3,radius:i=8,cutoff:s=.25,fontFamily:u="sans-serif",fontWeight:f="normal",fontStyle:g="normal"}={}){this.buffer=e,this.cutoff=s,this.radius=i;const y=this.size=n+4*e,T=this._createCanvas(y),S=this.ctx=T.getContext("2d",{willReadFrequently:!0});S.font=`${g} ${f} ${n}px ${u}`,S.textBaseline="alphabetic",S.textAlign="left",S.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(n){const e=document.createElement("canvas");return e.width=e.height=n,e}draw(n){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:s,actualBoundingBoxLeft:u,actualBoundingBoxRight:f}=this.ctx.measureText(n),g=Math.ceil(i),y=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-u))),T=Math.min(this.size-this.buffer,g+Math.ceil(s)),S=y+2*this.buffer,A=T+2*this.buffer,P=Math.max(S*A,0),z=new Uint8ClampedArray(P),F={data:z,width:S,height:A,glyphWidth:y,glyphHeight:T,glyphTop:g,glyphLeft:0,glyphAdvance:e};if(y===0||T===0)return F;const{ctx:$,buffer:j,gridInner:H,gridOuter:ae}=this;$.clearRect(j,j,y,T),$.fillText(n,j,j+g);const _e=$.getImageData(j,j,y,T);ae.fill(Eh,0,P),H.fill(0,0,P);for(let ie=0;ie<T;ie++)for(let pe=0;pe<y;pe++){const Te=_e.data[4*(ie*y+pe)+3]/255;if(Te===0)continue;const ye=(ie+j)*S+pe+j;if(Te===1)ae[ye]=0,H[ye]=Eh;else{const je=.5-Te;ae[ye]=je>0?je*je:0,H[ye]=je<0?je*je:0}}Ux(ae,0,0,S,A,S,this.f,this.v,this.z),Ux(H,j,j,y,T,S,this.f,this.v,this.z);for(let ie=0;ie<P;ie++){const pe=Math.sqrt(ae[ie])-Math.sqrt(H[ie]);z[ie]=Math.round(255-255*(pe/this.radius+this.cutoff))}return F}};class HC{constructor(e=[],i=XC){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:s}=this,u=i[e];for(;e>0;){const f=e-1>>1,g=i[f];if(s(u,g)>=0)break;i[e]=g,e=f}i[e]=u}_down(e){const{data:i,compare:s}=this,u=this.length>>1,f=i[e];for(;e<u;){let g=1+(e<<1),y=i[g];const T=g+1;if(T<this.length&&s(i[T],y)<0&&(g=T,y=i[T]),s(y,f)>=0)break;i[e]=y,e=g}i[e]=f}}function XC(n,e){return n<e?-1:n>e?1:0}function YC(n,e=1,i=!1){let s=1/0,u=1/0,f=-1/0,g=-1/0;const y=n[0];for(let F=0;F<y.length;F++){const $=y[F];(!F||$.x<s)&&(s=$.x),(!F||$.y<u)&&(u=$.y),(!F||$.x>f)&&(f=$.x),(!F||$.y>g)&&(g=$.y)}const T=Math.min(f-s,g-u);let S=T/2;const A=new HC([],KC);if(T===0)return new Y(s,u);for(let F=s;F<f;F+=T)for(let $=u;$<g;$+=T)A.push(new Mu(F+S,$+S,S,n));let P=function(F){let $=0,j=0,H=0;const ae=F[0];for(let _e=0,ie=ae.length,pe=ie-1;_e<ie;pe=_e++){const Te=ae[_e],ye=ae[pe],je=Te.x*ye.y-ye.x*Te.y;j+=(Te.x+ye.x)*je,H+=(Te.y+ye.y)*je,$+=3*je}return new Mu(j/$,H/$,0,F)}(n),z=A.length;for(;A.length;){const F=A.pop();(F.d>P.d||!P.d)&&(P=F,i&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,z)),F.max-P.d<=e||(S=F.h/2,A.push(new Mu(F.p.x-S,F.p.y-S,S,n)),A.push(new Mu(F.p.x+S,F.p.y-S,S,n)),A.push(new Mu(F.p.x-S,F.p.y+S,S,n)),A.push(new Mu(F.p.x+S,F.p.y+S,S,n)),z+=4)}return i&&(console.log(`num probes: ${z}`),console.log(`best distance: ${P.d}`)),P.p}function KC(n,e){return e.max-n.max}function Mu(n,e,i,s){this.p=new Y(n,e),this.h=i,this.d=function(u,f){let g=!1,y=1/0;for(let T=0;T<f.length;T++){const S=f[T];for(let A=0,P=S.length,z=P-1;A<P;z=A++){const F=S[A],$=S[z];F.y>u.y!=$.y>u.y&&u.x<($.x-F.x)*(u.y-F.y)/($.y-F.y)+F.x&&(g=!g),y=Math.min(y,j0(u,F,$))}}return(g?1:-1)*Math.sqrt(y)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}const v_=Number.POSITIVE_INFINITY,JC=Math.sqrt(2);function Zx(n,[e,i]){let s=0,u=0;if(i===v_){e<0&&(e=0);const f=e/JC;switch(n){case"top-right":case"top-left":u=f-7;break;case"bottom-right":case"bottom-left":u=7-f;break;case"bottom":u=7-e;break;case"top":u=e-7}switch(n){case"top-right":case"bottom-right":s=-f;break;case"top-left":case"bottom-left":s=f;break;case"left":s=e;break;case"right":s=-e}}else{switch(e=Math.abs(e),i=Math.abs(i),n){case"top-right":case"top-left":case"top":u=i-7;break;case"bottom-right":case"bottom-left":case"bottom":u=7-i}switch(n){case"top-right":case"bottom-right":case"right":s=-e;break;case"top-left":case"bottom-left":case"left":s=e}}return[s,u]}function QC(n,e,i,s,u,f,g,y,T,S){n.createArrays(),n.tilePixelRatio=un/(512*n.overscaling),n.compareText={},n.iconsNeedLinear=!1;const A=n.layers[0].layout,P=n.layers[0]._unevaluatedLayout._values,z={};if(n.textSizeData.kind==="composite"){const{minZoom:j,maxZoom:H}=n.textSizeData;z.compositeTextSizes=[P["text-size"].possiblyEvaluate(new Be(j),y),P["text-size"].possiblyEvaluate(new Be(H),y)]}if(n.iconSizeData.kind==="composite"){const{minZoom:j,maxZoom:H}=n.iconSizeData;z.compositeIconSizes=[P["icon-size"].possiblyEvaluate(new Be(j),y),P["icon-size"].possiblyEvaluate(new Be(H),y)]}z.layoutTextSize=P["text-size"].possiblyEvaluate(new Be(T+1),y),z.layoutIconSize=P["icon-size"].possiblyEvaluate(new Be(T+1),y),z.textMaxSize=P["text-size"].possiblyEvaluate(new Be(18),y);const F=A.get("text-rotation-alignment")==="map"&&A.get("symbol-placement")!=="point",$=A.get("text-size");for(const j of n.features){const H=A.get("text-font").evaluate(j,{},y).join(","),ae=$.evaluate(j,{},y),_e=z.layoutTextSize.evaluate(j,{},y),ie=(z.layoutIconSize.evaluate(j,{},y),{horizontal:{},vertical:void 0}),pe=j.text;let Te,ye=[0,0];if(pe){const tt=pe.toString(),_t=A.get("text-letter-spacing").evaluate(j,{},y)*Tr,We=A.get("text-line-height").evaluate(j,{},y)*Tr,it=x(tt)?_t:0,ot=A.get("text-anchor").evaluate(j,{},y),dt=A.get("text-variable-anchor");if(!dt){const Dt=A.get("text-radial-offset").evaluate(j,{},y);ye=Dt?Zx(ot,[Dt*Tr,v_]):A.get("text-offset").evaluate(j,{},y).map(qt=>qt*Tr)}let vt=F?"center":A.get("text-justify").evaluate(j,{},y);const Xe=A.get("symbol-placement")==="point",Ct=Xe?A.get("text-max-width").evaluate(j,{},y)*Tr:1/0,tn=Dt=>{n.allowVerticalPlacement&&_(tt)&&(ie.vertical=m_(pe,e,i,u,H,Ct,We,ot,Dt,it,ye,ao.vertical,!0,_e,ae))};if(!F&&dt){const Dt=vt==="auto"?dt.map(It=>y_(It)):[vt];let qt=!1;for(let It=0;It<Dt.length;It++){const sn=Dt[It];if(!ie.horizontal[sn])if(qt)ie.horizontal[sn]=ie.horizontal[0];else{const An=m_(pe,e,i,u,H,Ct,We,"center",sn,it,ye,ao.horizontal,!1,_e,ae);An&&(ie.horizontal[sn]=An,qt=An.positionedLines.length===1)}}tn("left")}else{if(vt==="auto"&&(vt=y_(ot)),Xe||A.get("text-writing-mode").indexOf("horizontal")>=0||!_(tt)){const Dt=m_(pe,e,i,u,H,Ct,We,ot,vt,it,ye,ao.horizontal,!1,_e,ae);Dt&&(ie.horizontal[vt]=Dt)}tn(Xe?"left":vt)}}let je=!1;if(j.icon&&j.icon.name){const tt=s[j.icon.name];tt&&(Te=GC(u[j.icon.name],A.get("icon-offset").evaluate(j,{},y),A.get("icon-anchor").evaluate(j,{},y)),je=tt.sdf,n.sdfIcons===void 0?n.sdfIcons=tt.sdf:n.sdfIcons!==tt.sdf&&ue("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(tt.pixelRatio!==n.pixelRatio||A.get("icon-rotate").constantOr(1)!==0)&&(n.iconsNeedLinear=!0))}const $e=Hx(ie.horizontal)||ie.vertical;n.iconsInText||(n.iconsInText=!!$e&&$e.iconsInText),($e||Te)&&eI(n,j,ie,Te,s,z,_e,0,ye,je,g,y,S)}f&&n.generateCollisionDebugBuffers(T,n.collisionBoxArray)}function y_(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function eI(n,e,i,s,u,f,g,y,T,S,A,P,z){let F=f.textMaxSize.evaluate(e,{},P);F===void 0&&(F=g);const $=n.layers[0].layout,j=$.get("icon-offset").evaluate(e,{},P),H=Hx(i.horizontal)||i.vertical,ae=z.name==="globe",_e=g/24,ie=n.tilePixelRatio*F/24,pe=(it=n.overscaling,n.zoom>18&&it>2&&(it>>=1),Math.max(un/(512*it),1)*$.get("symbol-spacing")),Te=$.get("text-padding")*n.tilePixelRatio,ye=$.get("icon-padding")*n.tilePixelRatio,je=Ee($.get("text-max-angle")),$e=$.get("text-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",tt=$.get("icon-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",_t=$.get("symbol-placement"),We=pe/2;var it;const ot=$.get("icon-text-fit");let dt;s&&ot!=="none"&&(n.allowVerticalPlacement&&i.vertical&&(dt=Bx(s,i.vertical,ot,$.get("icon-text-fit-padding"),j,_e)),H&&(s=Bx(s,H,ot,$.get("icon-text-fit-padding"),j,_e)));const vt=(Xe,Ct,tn)=>{if(Ct.x<0||Ct.x>=un||Ct.y<0||Ct.y>=un)return;let Dt=null;if(ae){const{x:qt,y:It,z:sn}=z.projectTilePoint(Ct.x,Ct.y,tn);Dt={anchor:new ea(qt,It,sn,0,void 0),up:z.upVector(tn,Ct.x,Ct.y)}}(function(qt,It,sn,An,wn,yn,an,Yn,dn,kn,ti,hi,ui,fi,_i,Ai,cr,Kn,Xi,Ni,Nn,xi,Qi,ni,Di){const Ar=qt.addToLineVertexArray(It,An);let ur,dr,Vr,hr,ta,Lu,zh,Lh=0,T1=0,S1=0,E1=0,P_=-1,z_=-1;const Ts={};let C1=Vl("");const Kl=sn?sn.anchor:It;let L_=0,D_=0;if(dn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[L_,D_]=dn.layout.get("text-offset").evaluate(Nn,{},Di).map(Jr=>Jr*Tr):(L_=dn.layout.get("text-radial-offset").evaluate(Nn,{},Di)*Tr,D_=v_),qt.allowVerticalPlacement&&wn.vertical){const Jr=wn.vertical;if(_i)Lu=x_(Jr),Yn&&(zh=x_(Yn));else{const Qr=dn.layout.get("text-rotate").evaluate(Nn,{},Di)+90;Vr=Kp(kn,Kl,It,ti,hi,ui,Jr,fi,Qr,Ai),Yn&&(hr=Kp(kn,Kl,It,ti,hi,ui,Yn,Kn,Qr))}}if(yn){const Jr=dn.layout.get("icon-rotate").evaluate(Nn,{},Di),Qr=dn.layout.get("icon-text-fit")!=="none",Dh=Gx(yn,Jr,Qi,Qr),R_=Yn?Gx(Yn,Jr,Qi,Qr):void 0;dr=Kp(kn,Kl,It,ti,hi,ui,yn,Kn,Jr),Lh=4*Dh.length;const I1=qt.iconSizeData;let Jl=null;I1.kind==="source"?(Jl=[ys*dn.layout.get("icon-size").evaluate(Nn,{},Di)],Jl[0]>ja&&ue(`${qt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):I1.kind==="composite"&&(Jl=[ys*xi.compositeIconSizes[0].evaluate(Nn,{},Di),ys*xi.compositeIconSizes[1].evaluate(Nn,{},Di)],(Jl[0]>ja||Jl[1]>ja)&&ue(`${qt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),qt.addSymbols(qt.icon,Dh,Jl,Ni,Xi,Nn,!1,sn,It,Ar.lineStartIndex,Ar.lineLength,-1,ni,Di),P_=qt.icon.placedSymbolArray.length-1,R_&&(T1=4*R_.length,qt.addSymbols(qt.icon,R_,Jl,Ni,Xi,Nn,ao.vertical,sn,It,Ar.lineStartIndex,Ar.lineLength,-1,ni,Di),z_=qt.icon.placedSymbolArray.length-1)}for(const Jr in wn.horizontal){const Qr=wn.horizontal[Jr];ur||(C1=Vl(Qr.text),_i?ta=x_(Qr):ur=Kp(kn,Kl,It,ti,hi,ui,Qr,fi,dn.layout.get("text-rotate").evaluate(Nn,{},Di),Ai));const Dh=Qr.positionedLines.length===1;if(S1+=Wx(qt,sn,It,Qr,an,dn,_i,Nn,Ai,Ar,wn.vertical?ao.horizontal:ao.horizontalOnly,Dh?Object.keys(wn.horizontal):[Jr],Ts,P_,xi,ni,Di),Dh)break}wn.vertical&&(E1+=Wx(qt,sn,It,wn.vertical,an,dn,_i,Nn,Ai,Ar,ao.vertical,["vertical"],Ts,z_,xi,ni,Di));let Xa=-1;const B_=(Jr,Qr)=>Jr?Math.max(Jr,Qr):Qr;Xa=B_(ta,Xa),Xa=B_(Lu,Xa),Xa=B_(zh,Xa);const CI=Xa>-1?1:0;qt.glyphOffsetArray.length>=qa.MAX_GLYPHS&&ue("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Nn.sortKey!==void 0&&qt.addToSortKeyRanges(qt.symbolInstances.length,Nn.sortKey),qt.symbolInstances.emplaceBack(Kl.x,Kl.y,Kl.z,It.x,It.y,Ts.right>=0?Ts.right:-1,Ts.center>=0?Ts.center:-1,Ts.left>=0?Ts.left:-1,Ts.vertical>=0?Ts.vertical:-1,P_,z_,C1,ur!==void 0?ur:qt.collisionBoxArray.length,ur!==void 0?ur+1:qt.collisionBoxArray.length,Vr!==void 0?Vr:qt.collisionBoxArray.length,Vr!==void 0?Vr+1:qt.collisionBoxArray.length,dr!==void 0?dr:qt.collisionBoxArray.length,dr!==void 0?dr+1:qt.collisionBoxArray.length,hr||qt.collisionBoxArray.length,hr?hr+1:qt.collisionBoxArray.length,ti,S1,E1,Lh,T1,CI,0,L_,D_,Xa)})(n,Ct,Dt,Xe,i,s,u,dt,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,Te,$e,T,0,ye,tt,j,e,f,S,A,P)};if(_t==="line")for(const Xe of Nx(e.geometry,0,0,un,un)){const Ct=ZC(Xe,pe,je,i.vertical||H,s,24,ie,n.overscaling,un);for(const tn of Ct){const Dt=H;Dt&&tI(n,Dt.text,We,tn)||vt(Xe,tn,P)}}else if(_t==="line-center"){for(const Xe of e.geometry)if(Xe.length>1){const Ct=qC(Xe,je,i.vertical||H,s,24,ie);Ct&&vt(Xe,Ct,P)}}else if(e.type==="Polygon")for(const Xe of a_(e.geometry,0)){const Ct=YC(Xe,16);vt(Xe[0],new ea(Ct.x,Ct.y,0,0,void 0),P)}else if(e.type==="LineString")for(const Xe of e.geometry)vt(Xe,new ea(Xe[0].x,Xe[0].y,0,0,void 0),P);else if(e.type==="Point")for(const Xe of e.geometry)for(const Ct of Xe)vt([Ct],new ea(Ct.x,Ct.y,0,0,void 0),P)}const ja=32640;function Wx(n,e,i,s,u,f,g,y,T,S,A,P,z,F,$,j,H){const ae=function(pe,Te,ye,je,$e,tt,_t,We){const it=[];if(Te.positionedLines.length===0)return it;const ot=je.layout.get("text-rotate").evaluate(tt,{})*Math.PI/180,dt=function(Dt){const qt=Dt[0],It=Dt[1],sn=qt*It;return sn>0?[qt,-It]:sn<0?[-qt,It]:qt===0?[It,qt]:[It,-qt]}(ye);let vt=Math.abs(Te.top-Te.bottom);for(const Dt of Te.positionedLines)vt-=Dt.lineOffset;const Xe=Te.positionedLines.length,Ct=vt/Xe;let tn=Te.top-ye[1];for(let Dt=0;Dt<Xe;++Dt){const qt=Te.positionedLines[Dt];tn=WC(Te,Ct,tn,Dt);for(const It of qt.positionedGlyphs){if(!It.rect)continue;const sn=It.rect||{};let An=4,wn=!0,yn=1,an=0;if(It.imageName){const ni=_t[It.imageName];if(!ni)continue;if(ni.sdf){ue("SDF images are not supported in formatted text and will be ignored.");continue}wn=!1,yn=ni.pixelRatio,An=1/yn}const Yn=($e||We)&&It.vertical,dn=It.metrics.advance*It.scale/2,kn=It.metrics,ti=It.rect;if(ti===null)continue;We&&Te.verticalizable&&(an=It.imageName?dn-It.metrics.width*It.scale/2:0);const hi=$e?[It.x+dn,It.y]:[0,0];let ui=[0,0],fi=[0,0],_i=!1;$e||(Yn?(fi=[It.x+dn+dt[0],It.y+dt[1]-an],_i=!0):ui=[It.x+dn+ye[0],It.y+ye[1]-an]);const Ai=ti.w*It.scale/(yn*(It.localGlyph?2:1)),cr=ti.h*It.scale/(yn*(It.localGlyph?2:1));let Kn,Xi,Ni,Nn;if(Yn){const ni=It.y-tn,Di=new Y(-dn,dn-ni),Ar=-Math.PI/2,ur=new Y(...fi);Kn=new Y(-dn+ui[0],ui[1]),Kn._rotateAround(Ar,Di)._add(ur),Kn.x+=-ni+dn,Kn.y-=(kn.left-An)*It.scale;const dr=It.imageName?kn.advance*It.scale:Tr*It.scale,Vr=String.fromCharCode(It.glyph);AC(Vr)?Kn.x+=(1-An)*It.scale:kC(Vr)?Kn.x+=dr-kn.height*It.scale+(-An-1)*It.scale:Kn.x+=It.imageName||kn.width+2*An===ti.w&&kn.height+2*An===ti.h?(dr-cr)/2:(dr-(kn.height+2*An)*It.scale)/2,Xi=new Y(Kn.x,Kn.y-Ai),Ni=new Y(Kn.x+cr,Kn.y),Nn=new Y(Kn.x+cr,Kn.y-Ai)}else{const ni=(kn.left-An)*It.scale-dn+ui[0],Di=(-kn.top-An)*It.scale+ui[1],Ar=ni+Ai,ur=Di+cr;Kn=new Y(ni,Di),Xi=new Y(Ar,Di),Ni=new Y(ni,ur),Nn=new Y(Ar,ur)}if(ot){let ni;ni=$e?new Y(0,0):_i?new Y(dt[0],dt[1]):new Y(ye[0],ye[1]),Kn._rotateAround(ot,ni),Xi._rotateAround(ot,ni),Ni._rotateAround(ot,ni),Nn._rotateAround(ot,ni)}const xi=new Y(0,0),Qi=new Y(0,0);it.push({tl:Kn,tr:Xi,bl:Ni,br:Nn,tex:sn,writingMode:Te.writingMode,glyphOffset:hi,sectionIndex:It.sectionIndex,isSDF:wn,pixelOffsetTL:xi,pixelOffsetBR:Qi,minFontScaleX:0,minFontScaleY:0})}}return it}(0,s,T,f,g,y,u,n.allowVerticalPlacement),_e=n.textSizeData;let ie=null;_e.kind==="source"?(ie=[ys*f.layout.get("text-size").evaluate(y,{},H)],ie[0]>ja&&ue(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):_e.kind==="composite"&&(ie=[ys*$.compositeTextSizes[0].evaluate(y,{},H),ys*$.compositeTextSizes[1].evaluate(y,{},H)],(ie[0]>ja||ie[1]>ja)&&ue(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,ae,ie,T,g,y,A,e,i,S.lineStartIndex,S.lineLength,F,j,H);for(const pe of P)z[pe]=n.text.placedSymbolArray.length-1;return 4*ae.length}function Hx(n){for(const e in n)return n[e];return null}function Kp(n,e,i,s,u,f,g,y,T,S){let A=g.top,P=g.bottom,z=g.left,F=g.right;const $=g.collisionPadding;if($&&(z-=$[0],A-=$[1],F+=$[2],P+=$[3]),T){const j=new Y(z,A),H=new Y(F,A),ae=new Y(z,P),_e=new Y(F,P),ie=Ee(T);let pe=new Y(0,0);S&&(pe=new Y(S[0],S[1])),j._rotateAround(ie,pe),H._rotateAround(ie,pe),ae._rotateAround(ie,pe),_e._rotateAround(ie,pe),z=Math.min(j.x,H.x,ae.x,_e.x),F=Math.max(j.x,H.x,ae.x,_e.x),A=Math.min(j.y,H.y,ae.y,_e.y),P=Math.max(j.y,H.y,ae.y,_e.y)}return n.emplaceBack(e.x,e.y,e.z,i.x,i.y,z,A,F,P,y,s,u,f),n.length-1}function x_(n){n.collisionPadding&&(n.top-=n.collisionPadding[1],n.bottom+=n.collisionPadding[3]);const e=n.bottom-n.top;return e>0?Math.max(10,e):null}function tI(n,e,i,s){const u=n.compareText;if(e in u){const f=u[e];for(let g=f.length-1;g>=0;g--)if(s.dist(f[g])<i)return!0}else u[e]=[];return u[e].push(s),!1}function Xx(n,e){const i=n.fovAboveCenter,s=n.elevation?n.elevation.getMinElevationBelowMSL()*e:0,u=(n._camera.position[2]*n.worldSize-s)/Math.cos(n._pitch),f=Math.sin(i)*u/Math.sin(Math.max(Math.PI/2-n._pitch-i,.01)),g=Math.sin(n._pitch)*f+u;return Math.min(1.01*g,u*(1/n._horizonShift))}function Xl(n,e){if(!e.isReprojectedInTileSpace)return{scale:1<<n.z,x:n.x,y:n.y,x2:n.x+1,y2:n.y+1,projection:e};const i=Math.pow(2,-n.z),s=n.x*i,u=(n.x+1)*i,f=n.y*i,g=(n.y+1)*i,y=so(s),T=so(u),S=br(f),A=br(g),P=e.project(y,S),z=e.project(T,S),F=e.project(T,A),$=e.project(y,A);let j=Math.min(P.x,z.x,F.x,$.x),H=Math.min(P.y,z.y,F.y,$.y),ae=Math.max(P.x,z.x,F.x,$.x),_e=Math.max(P.y,z.y,F.y,$.y);const ie=i/16;function pe(ye,je,$e,tt,_t,We){const it=($e+_t)/2,ot=(tt+We)/2,dt=e.project(so(it),br(ot)),vt=Math.max(0,j-dt.x,H-dt.y,dt.x-ae,dt.y-_e);j=Math.min(j,dt.x),ae=Math.max(ae,dt.x),H=Math.min(H,dt.y),_e=Math.max(_e,dt.y),vt>ie&&(pe(ye,dt,$e,tt,it,ot),pe(dt,je,it,ot,_t,We))}pe(P,z,s,f,u,f),pe(z,F,u,f,u,g),pe(F,$,u,g,s,g),pe($,P,s,g,s,f),j-=ie,H-=ie,ae+=ie,_e+=ie;const Te=1/Math.max(ae-j,_e-H);return{scale:Te,x:j*Te,y:H*Te,x2:ae*Te,y2:_e*Te,projection:e}}const nI=qo(new Float32Array(16));class Ga{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,i){return{x:0,y:0,z:0}}unproject(e,i){return new Vn(0,0)}projectTilePoint(e,i,s){return{x:e,y:i,z:0}}locationPoint(e,i,s=!0){return e._coordinatePoint(e.locationCoordinate(i),s)}pixelsPerMeter(e,i){return Wo(1,e)*i}pixelSpaceConversion(e,i,s){return 1}farthestPixelDistance(e){return Xx(e,e.pixelsPerMeter)}pointCoordinate(e,i,s,u){const f=e.horizonLineFromTop(!1),g=new Y(i,Math.max(f,s));return e.rayIntersectionCoordinate(e.pointRayIntersection(g,u))}pointCoordinate3D(e,i,s){const u=new Y(i,s);if(e.elevation)return e.elevation.pointCoordinate(u);{const f=this.pointCoordinate(e,u.x,u.y,0);return[f.x,f.y,f.z]}}isPointAboveHorizon(e,i){if(e.elevation)return!this.pointCoordinate3D(e,i.x,i.y);const s=e.horizonLineFromTop();return i.y<s}createInversionMatrix(e,i){return nI}createTileMatrix(e,i,s){let u,f,g;const y=s.canonical,T=qo(new Float64Array(16));if(this.isReprojectedInTileSpace){const S=Xl(y,this);u=1,f=S.x+s.wrap*S.scale,g=S.y,Ul(T,T,[u/S.scale,u/S.scale,e.pixelsPerMeter/i])}else u=i/e.zoomScale(y.z),f=(y.x+Math.pow(2,y.z)*s.wrap)*u,g=y.y*u;return nh(T,T,[f,g,0]),Ul(T,T,[u/un,u/un,1]),T}upVector(e,i,s){return[0,0,1]}upVectorScale(e,i,s){return{metersToTile:1}}}class iI extends Ga{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[i,s]=this.parallels=e.parallels||[29.5,45.5],u=Math.sin(Ee(i));this.n=(u+Math.sin(Ee(s)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(e,i){const{n:s,c:u,r0:f}=this,g=Ee(e-this.center[0]),y=Ee(i),T=Math.sqrt(u-2*s*Math.sin(y))/s;return{x:T*Math.sin(g*s),y:T*Math.cos(g*s)-f,z:0}}unproject(e,i){const{n:s,c:u,r0:f}=this,g=f+i;let y=Math.atan2(e,Math.abs(g))*Math.sign(g);g*s<0&&(y-=Math.PI*Math.sign(e)*Math.sign(g));const T=Ee(this.center[0])*s;y=Pe(y,-Math.PI-T,Math.PI-T);const S=nt(we(y/s)+this.center[0],-180,180),A=Math.asin(nt((u-(e*e+g*g)*s*s)/(2*s),-1,1)),P=nt(we(A),-wr,wr);return new Vn(S,P)}}const Ch=1.340264,Ih=-.081106,Ah=893e-6,kh=.003796,Jp=Math.sqrt(3)/2;class rI extends Ga{project(e,i){i=i/180*Math.PI,e=e/180*Math.PI;const s=Math.asin(Jp*Math.sin(i)),u=s*s,f=u*u*u;return{x:.5*(e*Math.cos(s)/(Jp*(Ch+3*Ih*u+f*(7*Ah+9*kh*u)))/Math.PI+.5),y:1-.5*(s*(Ch+Ih*u+f*(Ah+kh*u))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let s=i=(2*(1-i)-1)*Math.PI,u=s*s,f=u*u*u;for(let A,P,z,F=0;F<12&&(P=s*(Ch+Ih*u+f*(Ah+kh*u))-i,z=Ch+3*Ih*u+f*(7*Ah+9*kh*u),A=P/z,s=nt(s-A,-Math.PI/3,Math.PI/3),u=s*s,f=u*u*u,!(Math.abs(A)<1e-12));++F);const g=Jp*e*(Ch+3*Ih*u+f*(7*Ah+9*kh*u))/Math.cos(s),y=Math.asin(Math.sin(s)/Jp),T=nt(180*g/Math.PI,-180,180),S=nt(180*y/Math.PI,-wr,wr);return new Vn(T,S)}}class oI extends Ga{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){return{x:.5+e/360,y:.5-i/360,z:0}}unproject(e,i){const s=360*(e-.5),u=nt(360*(.5-i),-wr,wr);return new Vn(s,u)}}const Pu=Math.PI/2;function Qp(n){return Math.tan((Pu+n)/2)}class sI extends Ga{constructor(e){super(e),this.center=e.center||[0,30];const[i,s]=this.parallels=e.parallels||[30,30];let u=Ee(i),f=Ee(s);this.southernCenter=u+f<0,this.southernCenter&&(u=-u,f=-f);const g=Math.cos(u),y=Qp(u);this.n=u===f?Math.sin(u):Math.log(g/Math.cos(f))/Math.log(Qp(f)/y),this.f=g*Math.pow(Qp(u),this.n)/this.n}project(e,i){i=Ee(i),this.southernCenter&&(i=-i),e=Ee(e-this.center[0]);const s=1e-6,{n:u,f}=this;f>0?i<-Pu+s&&(i=-Pu+s):i>Pu-s&&(i=Pu-s);const g=f/Math.pow(Qp(i),u);let y=g*Math.sin(u*e),T=f-g*Math.cos(u*e);return y=.5*(y/Math.PI+.5),T=.5*(T/Math.PI+.5),{x:y,y:this.southernCenter?T:1-T,z:0}}unproject(e,i){e=(2*e-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:s,f:u}=this,f=u-i,g=Math.sign(f),y=Math.sign(s)*Math.sqrt(e*e+f*f);let T=Math.atan2(e,Math.abs(f))*g;f*s<0&&(T-=Math.PI*Math.sign(e)*g);const S=nt(we(T/s)+this.center[0],-180,180),A=nt(we(2*Math.atan(Math.pow(u/y,1/s))-Pu),-wr,wr);return new Vn(S,this.southernCenter?-A:A)}}class Yx extends Ga{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,i){return{x:_s(e),y:vs(i),z:0}}unproject(e,i){const s=so(e),u=br(i);return new Vn(s,u)}}const Kx=Ee(wr);class aI extends Ga{project(e,i){const s=(i=Ee(i))*i,u=s*s;return{x:.5*((e=Ee(e))*(.8707-.131979*s+u*(u*(.003971*s-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+s*(.015085+u*(.028874*s-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let s=i=(2*(1-i)-1)*Math.PI,u=25,f=0,g=s*s;do{g=s*s;const S=g*g;f=(s*(1.007226+g*(.015085+S*(.028874*g-.044475-.005916*S)))-i)/(1.007226+g*(.045255+S*(.259866*g-.311325-.005916*11*S))),s=nt(s-f,-Kx,Kx)}while(Math.abs(f)>1e-6&&--u>0);g=s*s;const y=nt(we(e/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),T=we(s);return new Vn(y,T)}}const Jx=Ee(wr);class lI extends Ga{project(e,i){i=Ee(i),e=Ee(e);const s=Math.cos(i),u=2/Math.PI,f=Math.acos(s*Math.cos(e/2)),g=Math.sin(f)/f,y=.5*(e*u+2*s*Math.sin(e/2)/g)||0,T=.5*(i+Math.sin(i)/g)||0;return{x:.5*(y/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(e,i){let s=e=(2*e-.5)*Math.PI,u=i=(2*(1-i)-1)*Math.PI,f=25;const g=1e-6;let y=0,T=0;do{const S=Math.cos(u),A=Math.sin(u),P=2*A*S,z=A*A,F=S*S,$=Math.cos(s/2),j=Math.sin(s/2),H=2*$*j,ae=j*j,_e=1-F*$*$,ie=_e?1/_e:0,pe=_e?Math.acos(S*$)*Math.sqrt(1/_e):0,Te=.5*(2*pe*S*j+2*s/Math.PI)-e,ye=.5*(pe*A+u)-i,je=.5*ie*(F*ae+pe*S*$*z)+1/Math.PI,$e=ie*(H*P/4-pe*A*j),tt=.125*ie*(P*j-pe*A*F*H),_t=.5*ie*(z*$+pe*ae*S)+.5,We=$e*tt-_t*je;y=(ye*$e-Te*_t)/We,T=(Te*tt-ye*je)/We,s=nt(s-y,-Math.PI,Math.PI),u=nt(u-T,-Jx,Jx)}while((Math.abs(y)>g||Math.abs(T)>g)&&--f>0);return new Vn(we(s),we(u))}}class Qx extends Ga{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ee(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){const{scale:s,cosPhi:u}=this;return{x:Ee(e)*u*s+.5,y:-Math.sin(Ee(i))/u*s+.5,z:0}}unproject(e,i){const{scale:s,cosPhi:u}=this,f=-(i-.5)/s,g=nt(we((e-.5)/s)/u,-180,180),y=Math.asin(nt(f*u,-1,1)),T=nt(we(y),-wr,wr);return new Vn(g,T)}}class cI extends Yx{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,i,s){const u=uh(e,i,s);return Li(u,u,dh(gs(s))),{x:u[0],y:u[1],z:u[2]}}locationPoint(e,i){const s=_u(i.lat,i.lng),u=Rr([],s),f=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(i),e._centerAltitude):e._centerAltitude;sh(s,s,u,Wo(1,0)*un*f);const g=qo(new Float64Array(16));return Nl(g,e.pixelMatrix,e.globeMatrix),Li(s,s,g),new Y(s[0],s[1])}pixelsPerMeter(e,i){return Wo(1,0)*i}pixelSpaceConversion(e,i,s){const u=Wo(1,e)*i,f=Fn(Wo(1,45)*i,u,s);return this.pixelsPerMeter(e,i)/f}createTileMatrix(e,i,s){const u=Wg(gs(s.canonical));return Nl(new Float64Array(16),e.globeMatrix,u)}createInversionMatrix(e,i){const{center:s}=e,u=dh(gs(i));return Ap(u,u,Ee(s.lng)),Fg(u,u,Ee(s.lat)),Ul(u,u,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(e,i,s,u){return k0(e,i,s,!0)||new yu(0,0)}pointCoordinate3D(e,i,s){const u=this.pointCoordinate(e,i,s,0);return[u.x,u.y,u.z]}isPointAboveHorizon(e,i){return!k0(e,i.x,i.y,!1)}farthestPixelDistance(e){const i=function(u,f){const g=u.cameraToCenterDistance,y=u._centerAltitude*f,T=u._camera,S=u._camera.forward(),A=Ys([],oo([],S,-g),[0,0,y]),P=u.worldSize/(2*Math.PI),z=[0,0,-P],F=u.width/u.height,$=Math.tan(u.fovAboveCenter),j=oo([],T.up(),$),H=oo([],T.right(),$*F),ae=Rr([],Ys([],Ys([],S,j),H)),_e=[];let ie;if(new Ug(A,ae).closestPointOnSphere(z,P,_e)){const pe=Ys([],_e,z),Te=Zo([],pe,A);ie=Math.cos(u.fovAboveCenter)*ih(Te)}else{const pe=Zo([],A,z),Te=Zo([],z,A);Rr(Te,Te);const ye=ih(pe)-P;ie=Math.sqrt(ye*(ye+2*P));const je=Math.acos(ie/(P+ye))-Math.acos(xo(S,Te));ie*=Math.cos(je)}return 1.01*ie}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),s=vu(e.zoom);if(s>0){const u=Xx(e,Wo(1,e.center.lat)*e.worldSize),f=e.worldSize/(2*Math.PI),g=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Fn(i,u+f*(1-Math.cos(g)),Math.pow(s,10))}return i}upVector(e,i,s){return uh(i,s,e,1)}upVectorScale(e){return{metersToTile:kp(Pp(gs(e)))}}}function e1(n){const e=n.parallels,i=!!e&&Math.abs(e[0]+e[1])<.01;switch(n.name){case"mercator":return new Yx(n);case"equirectangular":return new oI(n);case"naturalEarth":return new aI(n);case"equalEarth":return new rI(n);case"winkelTripel":return new lI(n);case"albers":return i?new Qx(n):new iI(n);case"lambertConformalConic":return i?new Qx(n):new sI(n);case"globe":return new cI(n)}throw new Error(`Invalid projection name: ${n.name}`)}const uI=Np.types,dI=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function em(n,e,i,s,u,f,g,y,T,S,A,P,z){const F=y?Math.min(ja,Math.round(y[0])):0,$=y?Math.min(ja,Math.round(y[1])):0;n.emplaceBack(e,i,Math.round(32*s),Math.round(32*u),f,g,(F<<1)+(T?1:0),$,16*S,16*A,256*P,256*z)}function tm(n,e,i,s,u,f,g){n.emplaceBack(e,i,s,u,f,g)}function nm(n,e,i,s,u){n.emplaceBack(e,i,s,u),n.emplaceBack(e,i,s,u),n.emplaceBack(e,i,s,u),n.emplaceBack(e,i,s,u)}function hI(n){for(const e of n.sections)if(U(e.text))return!0;return!1}class b_{constructor(e){this.layoutVertexArray=new No,this.indexArray=new xr,this.programConfigurations=e,this.segments=new Vi,this.dynamicLayoutVertexArray=new ri,this.opacityVertexArray=new oi,this.placedSymbolArray=new t0,this.globeExtVertexArray=new gi}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,i,s,u){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xC.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,wC.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,dI,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,bC.members,!0)),this.opacityVertexBuffer.itemSize=1),(s||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}$t(b_,"SymbolBuffers");class w_{constructor(e,i,s){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new s,this.segments=new Vi,this.collisionVertexArray=new di,this.collisionVertexArrayExt=new yr}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,TC.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,SC.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}$t(w_,"CollisionBuffers");class qa{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(g=>g.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=qo([]),this.placementViewportMatrix=qo([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=d_(this.zoom,i["text-size"]),this.iconSizeData=d_(this.zoom,i["icon-size"]);const s=this.layers[0].layout,u=s.get("symbol-sort-key"),f=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(g=>ao[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new b_(new $l(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new b_(new $l(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new r0,this.lineVertexArray=new o0,this.symbolInstances=new i0}calculateGlyphDependencies(e,i,s,u,f){for(let g=0;g<e.length;g++)if(i[e.charCodeAt(g)]=!0,u&&f){const y=wh[e.charAt(g)];y&&(i[y.charCodeAt(0)]=!0)}}populate(e,i,s,u){const f=this.layers[0],g=f.layout,y=this.projection.name==="globe",T=g.get("text-font"),S=g.get("text-field"),A=g.get("icon-image"),P=(S.value.kind!=="constant"||S.value.value instanceof Dr&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),z=A.value.kind!=="constant"||!!A.value.value||Object.keys(A.parameters).length>0,F=g.get("symbol-sort-key");if(this.features=[],!P&&!z)return;const $=i.iconDependencies,j=i.glyphDependencies,H=i.availableImages,ae=new Be(this.zoom);for(const{feature:_e,id:ie,index:pe,sourceLayerIndex:Te}of e){const ye=f._featureFilter.needGeometry,je=Zl(_e,ye);if(!f._featureFilter.filter(ae,je,s))continue;if(ye||(je.geometry=Ks(_e,s,u)),y&&_e.type!==1&&s.z<=5){const We=je.geometry,it=.98078528056,ot=(dt,vt)=>xo(uh(dt.x,dt.y,s,1),uh(vt.x,vt.y,s,1))<it;for(let dt=0;dt<We.length;dt++)We[dt]=wE(We[dt],ot)}let $e,tt;if(P){const We=f.getValueAndResolveTokens("text-field",je,s,H),it=Dr.factory(We);hI(it)&&(this.hasRTLText=!0),(!this.hasRTLText||Se()==="unavailable"||this.hasRTLText&&Ae.isParsed())&&($e=IC(it,f,je))}if(z){const We=f.getValueAndResolveTokens("icon-image",je,s,H);tt=We instanceof Ir?We:Ir.fromString(We)}if(!$e&&!tt)continue;const _t=this.sortFeaturesByKey?F.evaluate(je,{},s):void 0;if(this.features.push({id:ie,text:$e,icon:tt,index:pe,sourceLayerIndex:Te,geometry:je.geometry,properties:_e.properties,type:uI[_e.type],sortKey:_t}),tt&&($[tt.name]=!0),$e){const We=T.evaluate(je,{},s).join(","),it=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ao.vertical)>=0;for(const ot of $e.sections)if(ot.image)$[ot.image.name]=!0;else{const dt=_($e.toString()),vt=ot.fontStack||We,Xe=j[vt]=j[vt]||{};this.calculateGlyphDependencies(ot.text,Xe,it,this.allowVerticalPlacement,dt)}}}g.get("symbol-placement")==="line"&&(this.features=function(_e){const ie={},pe={},Te=[];let ye=0;function je(We){Te.push(_e[We]),ye++}function $e(We,it,ot){const dt=pe[We];return delete pe[We],pe[it]=dt,Te[dt].geometry[0].pop(),Te[dt].geometry[0]=Te[dt].geometry[0].concat(ot[0]),dt}function tt(We,it,ot){const dt=ie[it];return delete ie[it],ie[We]=dt,Te[dt].geometry[0].shift(),Te[dt].geometry[0]=ot[0].concat(Te[dt].geometry[0]),dt}function _t(We,it,ot){const dt=ot?it[0][it[0].length-1]:it[0][0];return`${We}:${dt.x}:${dt.y}`}for(let We=0;We<_e.length;We++){const it=_e[We],ot=it.geometry,dt=it.text?it.text.toString():null;if(!dt){je(We);continue}const vt=_t(dt,ot),Xe=_t(dt,ot,!0);if(vt in pe&&Xe in ie&&pe[vt]!==ie[Xe]){const Ct=tt(vt,Xe,ot),tn=$e(vt,Xe,Te[Ct].geometry);delete ie[vt],delete pe[Xe],pe[_t(dt,Te[tn].geometry,!0)]=tn,Te[Ct].geometry=null}else vt in pe?$e(vt,Xe,ot):Xe in ie?tt(vt,Xe,ot):(je(We),ie[vt]=ye-1,pe[Xe]=ye-1)}return Te.filter(We=>We.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((_e,ie)=>_e.sortKey-ie.sortKey)}update(e,i,s,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,s,u),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,s,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=e1(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const s=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:u,y:f}of i)this.lineVertexArray.emplaceBack(u,f);return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,i,s,u,f,g,y,T,S,A,P,z,F,$){const j=e.indexArray,H=e.layoutVertexArray,ae=e.globeExtVertexArray,_e=e.segments.prepareSegment(4*i.length,H,j,this.canOverlap?g.sortKey:void 0),ie=this.glyphOffsetArray.length,pe=_e.vertexLength,Te=this.allowVerticalPlacement&&y===ao.vertical?Math.PI/2:0,ye=g.text&&g.text.sections;for(let $e=0;$e<i.length;$e++){const{tl:tt,tr:_t,bl:We,br:it,tex:ot,pixelOffsetTL:dt,pixelOffsetBR:vt,minFontScaleX:Xe,minFontScaleY:Ct,glyphOffset:tn,isSDF:Dt,sectionIndex:qt}=i[$e],It=_e.vertexLength,sn=tn[1];if(em(H,S.x,S.y,tt.x,sn+tt.y,ot.x,ot.y,s,Dt,dt.x,dt.y,Xe,Ct),em(H,S.x,S.y,_t.x,sn+_t.y,ot.x+ot.w,ot.y,s,Dt,vt.x,dt.y,Xe,Ct),em(H,S.x,S.y,We.x,sn+We.y,ot.x,ot.y+ot.h,s,Dt,dt.x,vt.y,Xe,Ct),em(H,S.x,S.y,it.x,sn+it.y,ot.x+ot.w,ot.y+ot.h,s,Dt,vt.x,vt.y,Xe,Ct),T){const{x:An,y:wn,z:yn}=T.anchor,[an,Yn,dn]=T.up;tm(ae,An,wn,yn,an,Yn,dn),tm(ae,An,wn,yn,an,Yn,dn),tm(ae,An,wn,yn,an,Yn,dn),tm(ae,An,wn,yn,an,Yn,dn),nm(e.dynamicLayoutVertexArray,An,wn,yn,Te)}else nm(e.dynamicLayoutVertexArray,S.x,S.y,S.z,Te);j.emplaceBack(It,It+1,It+2),j.emplaceBack(It+1,It+2,It+3),_e.vertexLength+=4,_e.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(tn[0]),$e!==i.length-1&&qt===i[$e+1].sectionIndex||e.programConfigurations.populatePaintArrays(H.length,g,g.index,{},F,$,ye&&ye[qt])}const je=T?T.anchor:S;e.placedSymbolArray.emplaceBack(je.x,je.y,je.z,S.x,S.y,ie,this.glyphOffsetArray.length-ie,pe,A,P,S.segment,s?s[0]:0,s?s[1]:0,u[0],u[1],y,0,!1,0,z,0)}_commitLayoutVertex(e,i,s,u,f,g,y){e.emplaceBack(i,s,u,f,g,Math.round(y.x),Math.round(y.y))}_addCollisionDebugVertices(e,i,s,u,f,g,y){const T=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),S=T.vertexLength,A=y.tileAnchorX,P=y.tileAnchorY;for(let F=0;F<4;F++)s.collisionVertexArray.emplaceBack(0,0,0,0);s.collisionVertexArrayExt.emplaceBack(i,-e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(i,e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(i,e.padding,e.padding),s.collisionVertexArrayExt.emplaceBack(i,-e.padding,e.padding),this._commitLayoutVertex(s.layoutVertexArray,u,f,g,A,P,new Y(e.x1,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,f,g,A,P,new Y(e.x2,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,f,g,A,P,new Y(e.x2,e.y2)),this._commitLayoutVertex(s.layoutVertexArray,u,f,g,A,P,new Y(e.x1,e.y2)),T.vertexLength+=4;const z=s.indexArray;z.emplaceBack(S,S+1),z.emplaceBack(S+1,S+2),z.emplaceBack(S+2,S+3),z.emplaceBack(S+3,S),T.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,s,u,f,g){for(let y=u;y<f;y++){const T=s.get(y),S=this.getSymbolInstanceTextSize(e,g,i,y);this._addCollisionDebugVertices(T,S,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(e,i,s,u,f,g){for(let y=u;y<f;y++){const T=s.get(y),S=this.getSymbolInstanceIconSize(e,i,g.placedIconSymbolIndex);this._addCollisionDebugVertices(T,S,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,g)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new w_(Ii,wx.members,fs),this.iconCollisionBox=new w_(Ii,wx.members,fs);const s=Eu(this.iconSizeData,e),u=Eu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const g=this.symbolInstances.get(f);this._addTextDebugCollisionBoxes(u,e,i,g.textBoxStartIndex,g.textBoxEndIndex,g),this._addTextDebugCollisionBoxes(u,e,i,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._addIconDebugCollisionBoxes(s,e,i,g.iconBoxStartIndex,g.iconBoxEndIndex,g),this._addIconDebugCollisionBoxes(s,e,i,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g)}}getSymbolInstanceTextSize(e,i,s,u){const f=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:u),g=qp(this.textSizeData,e,f)/Tr;return this.tilePixelRatio*g}getSymbolInstanceIconSize(e,i,s){const u=this.icon.placedSymbolArray.get(s),f=qp(this.iconSizeData,e,u);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(e,i,s){e.emplaceBack(i,-s,-s),e.emplaceBack(i,s,-s),e.emplaceBack(i,s,s),e.emplaceBack(i,-s,s)}_updateTextDebugCollisionBoxes(e,i,s,u,f,g){for(let y=u;y<f;y++){const T=s.get(y),S=this.getSymbolInstanceTextSize(e,g,i,y);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,S,T.padding)}}_updateIconDebugCollisionBoxes(e,i,s,u,f,g){for(let y=u;y<f;y++){const T=s.get(y),S=this.getSymbolInstanceIconSize(e,i,g);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,S,T.padding)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=Eu(this.iconSizeData,e),u=Eu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const g=this.symbolInstances.get(f);this._updateTextDebugCollisionBoxes(u,e,i,g.textBoxStartIndex,g.textBoxEndIndex,g),this._updateTextDebugCollisionBoxes(u,e,i,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._updateIconDebugCollisionBoxes(s,e,i,g.iconBoxStartIndex,g.iconBoxEndIndex,g.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(s,e,i,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,s,u,f,g,y,T,S){const A={};if(i<s){const{x1:P,y1:z,x2:F,y2:$,padding:j,projectedAnchorX:H,projectedAnchorY:ae,projectedAnchorZ:_e,tileAnchorX:ie,tileAnchorY:pe,featureIndex:Te}=e.get(i);A.textBox={x1:P,y1:z,x2:F,y2:$,padding:j,projectedAnchorX:H,projectedAnchorY:ae,projectedAnchorZ:_e,tileAnchorX:ie,tileAnchorY:pe},A.textFeatureIndex=Te}if(u<f){const{x1:P,y1:z,x2:F,y2:$,padding:j,projectedAnchorX:H,projectedAnchorY:ae,projectedAnchorZ:_e,tileAnchorX:ie,tileAnchorY:pe,featureIndex:Te}=e.get(u);A.verticalTextBox={x1:P,y1:z,x2:F,y2:$,padding:j,projectedAnchorX:H,projectedAnchorY:ae,projectedAnchorZ:_e,tileAnchorX:ie,tileAnchorY:pe},A.verticalTextFeatureIndex=Te}if(g<y){const{x1:P,y1:z,x2:F,y2:$,padding:j,projectedAnchorX:H,projectedAnchorY:ae,projectedAnchorZ:_e,tileAnchorX:ie,tileAnchorY:pe,featureIndex:Te}=e.get(g);A.iconBox={x1:P,y1:z,x2:F,y2:$,padding:j,projectedAnchorX:H,projectedAnchorY:ae,projectedAnchorZ:_e,tileAnchorX:ie,tileAnchorY:pe},A.iconFeatureIndex=Te}if(T<S){const{x1:P,y1:z,x2:F,y2:$,padding:j,projectedAnchorX:H,projectedAnchorY:ae,projectedAnchorZ:_e,tileAnchorX:ie,tileAnchorY:pe,featureIndex:Te}=e.get(T);A.verticalIconBox={x1:P,y1:z,x2:F,y2:$,padding:j,projectedAnchorX:H,projectedAnchorY:ae,projectedAnchorZ:_e,tileAnchorX:ie,tileAnchorY:pe},A.verticalIconFeatureIndex=Te}return A}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const s=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const s=e.placedSymbolArray.get(i),u=s.vertexStartIndex+4*s.numGlyphs;for(let f=s.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),s=Math.cos(e),u=[],f=[],g=[];for(let y=0;y<this.symbolInstances.length;++y){g.push(y);const T=this.symbolInstances.get(y);u.push(0|Math.round(i*T.tileAnchorX+s*T.tileAnchorY)),f.push(T.featureIndex)}return g.sort((y,T)=>u[y]-u[T]||f[T]-f[y]),g}addToSortKeyRanges(e,i){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===i?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const s=this.symbolInstances.get(i);this.featureSortOrder.push(s.featureIndex);const{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:f,leftJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:y,placedIconSymbolIndex:T,verticalPlacedIconSymbolIndex:S}=s;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),f>=0&&f!==u&&this.addIndicesForPlacedSymbol(this.text,f),g>=0&&g!==f&&g!==u&&this.addIndicesForPlacedSymbol(this.text,g),y>=0&&this.addIndicesForPlacedSymbol(this.text,y),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T),S>=0&&this.addIndicesForPlacedSymbol(this.icon,S)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}$t(qa,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),qa.MAX_GLYPHS=65535,qa.addDynamicAttributes=nm;const fI=new mt({"symbol-placement":new Le(et.layout_symbol["symbol-placement"]),"symbol-spacing":new Le(et.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Le(et.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ze(et.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Le(et.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Le(et.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Le(et.layout_symbol["icon-ignore-placement"]),"icon-optional":new Le(et.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Le(et.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ze(et.layout_symbol["icon-size"]),"icon-text-fit":new Le(et.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Le(et.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ze(et.layout_symbol["icon-image"]),"icon-rotate":new Ze(et.layout_symbol["icon-rotate"]),"icon-padding":new Le(et.layout_symbol["icon-padding"]),"icon-keep-upright":new Le(et.layout_symbol["icon-keep-upright"]),"icon-offset":new Ze(et.layout_symbol["icon-offset"]),"icon-anchor":new Ze(et.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Le(et.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Le(et.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Le(et.layout_symbol["text-rotation-alignment"]),"text-field":new Ze(et.layout_symbol["text-field"]),"text-font":new Ze(et.layout_symbol["text-font"]),"text-size":new Ze(et.layout_symbol["text-size"]),"text-max-width":new Ze(et.layout_symbol["text-max-width"]),"text-line-height":new Ze(et.layout_symbol["text-line-height"]),"text-letter-spacing":new Ze(et.layout_symbol["text-letter-spacing"]),"text-justify":new Ze(et.layout_symbol["text-justify"]),"text-radial-offset":new Ze(et.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Le(et.layout_symbol["text-variable-anchor"]),"text-anchor":new Ze(et.layout_symbol["text-anchor"]),"text-max-angle":new Le(et.layout_symbol["text-max-angle"]),"text-writing-mode":new Le(et.layout_symbol["text-writing-mode"]),"text-rotate":new Ze(et.layout_symbol["text-rotate"]),"text-padding":new Le(et.layout_symbol["text-padding"]),"text-keep-upright":new Le(et.layout_symbol["text-keep-upright"]),"text-transform":new Ze(et.layout_symbol["text-transform"]),"text-offset":new Ze(et.layout_symbol["text-offset"]),"text-allow-overlap":new Le(et.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Le(et.layout_symbol["text-ignore-placement"]),"text-optional":new Le(et.layout_symbol["text-optional"])});var T_={paint:new mt({"icon-opacity":new Ze(et.paint_symbol["icon-opacity"]),"icon-color":new Ze(et.paint_symbol["icon-color"]),"icon-halo-color":new Ze(et.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ze(et.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ze(et.paint_symbol["icon-halo-blur"]),"icon-translate":new Le(et.paint_symbol["icon-translate"]),"icon-translate-anchor":new Le(et.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ze(et.paint_symbol["text-opacity"]),"text-color":new Ze(et.paint_symbol["text-color"],{runtimeType:_o,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new Ze(et.paint_symbol["text-halo-color"]),"text-halo-width":new Ze(et.paint_symbol["text-halo-width"]),"text-halo-blur":new Ze(et.paint_symbol["text-halo-blur"]),"text-translate":new Le(et.paint_symbol["text-translate"]),"text-translate-anchor":new Le(et.paint_symbol["text-translate-anchor"])}),layout:fI};class t1{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:ya,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}$t(t1,"FormatSectionOverride",{omit:["defaultValue"]});class im extends Go{constructor(e){super(e,T_)}recalculate(e,i){super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const u=[];for(const f of s)u.indexOf(f)<0&&u.push(f);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,i,s,u){const f=this.layout.get(e).evaluate(i,{},s,u),g=this._unevaluatedLayout._values[e];return g.isDataDriven()||Pa(g.value)||!f?f:function(y,T){return T.replace(/{([^{}]+)}/g,(S,A)=>A in y?String(y[A]):"")}(i.properties,f)}createBucket(e){return new qa(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of T_.paint.overridableProperties){if(!im.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),s=new t1(i),u=new eu(s,i.property.specification);let f=null;f=i.value.kind==="constant"||i.value.kind==="source"?new tu("source",u):new Zs("composite",u,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new ut(i.property,f,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,s){return!(!this.layout||i.isDataDriven()||s.isDataDriven())&&im.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const s=e.get("text-field"),u=T_.paint.properties[i];let f=!1;const g=y=>{for(const T of y)if(u.overrides&&u.overrides.hasOverride(T))return void(f=!0)};if(s.value.kind==="constant"&&s.value.value instanceof Dr)g(s.value.value.sections);else if(s.value.kind==="source"){const y=S=>{f||(S instanceof fl&&Hi(S.value)===xa?g(S.value.sections):S instanceof pl?g(S.sections):S.eachChild(y))},T=s.value;T._styleExpression&&y(T._styleExpression.expression)}return f}getProgramConfiguration(e){return new Na(this,e)}}var pI={paint:new mt({"background-color":new Le(et.paint_background["background-color"]),"background-pattern":new Le(et.paint_background["background-pattern"]),"background-opacity":new Le(et.paint_background["background-opacity"])})},mI={paint:new mt({"raster-opacity":new Le(et.paint_raster["raster-opacity"]),"raster-hue-rotate":new Le(et.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Le(et.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Le(et.paint_raster["raster-brightness-max"]),"raster-saturation":new Le(et.paint_raster["raster-saturation"]),"raster-contrast":new Le(et.paint_raster["raster-contrast"]),"raster-resampling":new Le(et.paint_raster["raster-resampling"]),"raster-fade-duration":new Le(et.paint_raster["raster-fade-duration"])})};class gI extends Go{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var _I={paint:new mt({"sky-type":new Le(et.paint_sky["sky-type"]),"sky-atmosphere-sun":new Le(et.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Le(et.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Le(et.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Le(et.paint_sky["sky-gradient-radius"]),"sky-gradient":new lt(et.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Le(et.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Le(et.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Le(et.paint_sky["sky-opacity"])})};function S_(n,e,i){const s=[0,0,1],u=S0([]);return C0(u,u,i?-Ee(n)+Math.PI:Ee(n)),E0(u,u,-Ee(e)),x0(s,s,u),Rr(s,s)}const vI={circle:class extends Go{constructor(n){super(n,kE)}createBucket(n){return new Qg(n)}queryRadius(n){const e=n;return xu("circle-radius",this,e)+xu("circle-stroke-width",this,e)+Dp(this.paint.get("circle-translate"))}queryIntersectsFeature(n,e,i,s,u,f,g,y){const T=W0(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),S=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return H0(n,s,f,g,y,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",T,S)}getProgramIds(){return["circle"]}getProgramConfiguration(n){return new Na(this,n)}},heatmap:class extends Go{createBucket(n){return new Y0(n)}constructor(n){super(n,LE),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=i_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(n){return xu("heatmap-radius",this,n)}queryIntersectsFeature(n,e,i,s,u,f,g,y){const T=this.paint.get("heatmap-radius").evaluate(e,i);return H0(n,s,f,g,y,!0,!0,new Y(0,0),T)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(n){return new Na(this,n)}},hillshade:class extends Go{constructor(n){super(n,DE)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Go{constructor(n){super(n,YE)}getProgramIds(){const n=this.paint.get("fill-pattern"),e=n&&n.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(n){return new Na(this,n)}recalculate(n,e){super.recalculate(n,e);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new Vp(n)}queryRadius(){return Dp(this.paint.get("fill-translate"))}queryIntersectsFeature(n,e,i,s,u,f){return!n.queryGeometry.isAboveHorizon&&U0(Z0(n.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends Go{constructor(n){super(n,hC)}createBucket(n){return new yh(n)}queryRadius(){return Dp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(n){return new Na(this,n)}queryIntersectsFeature(n,e,i,s,u,f,g,y,T){const S=W0(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),A=this.paint.get("fill-extrusion-height").evaluate(e,i),P=this.paint.get("fill-extrusion-base").evaluate(e,i),z=[0,0],F=y&&f.elevation,$=f.elevation?f.elevation.exaggeration():1,j=n.tile.getBucket(this);if(F&&j instanceof yh){const pe=j.centroidVertexArray,Te=T+1;Te<pe.length&&(z[0]=pe.geta_centroid_pos0(Te),z[1]=pe.geta_centroid_pos1(Te))}if(z[0]===0&&z[1]===1)return!1;f.projection.name==="globe"&&(s=px([s],[new Y(0,0),new Y(un,un)],n.tileID.canonical).map(pe=>pe.polygon).flat());const H=F?y:null,[ae,_e]=function(pe,Te,ye,je,$e,tt,_t,We,it,ot,dt){return pe.projection.name==="globe"?function(vt,Xe,Ct,tn,Dt,qt,It,sn,An,wn,yn){const an=[],Yn=[],dn=vt.projection.upVectorScale(yn,vt.center.lat,vt.worldSize).metersToTile,kn=[0,0,0,1],ti=[0,0,0,1],hi=(fi,_i,Ai,cr)=>{fi[0]=_i,fi[1]=Ai,fi[2]=cr,fi[3]=1},ui=fx();Ct>0&&(Ct+=ui),tn+=ui;for(const fi of Xe){const _i=[],Ai=[];for(const cr of fi){const Kn=cr.x+Dt.x,Xi=cr.y+Dt.y,Ni=vt.projection.projectTilePoint(Kn,Xi,yn),Nn=vt.projection.upVector(yn,cr.x,cr.y);let xi=Ct,Qi=tn;if(It){const ni=vx(Kn,Xi,Ct,tn,It,sn,An,wn);xi+=ni.base,Qi+=ni.top}Ct!==0?hi(kn,Ni.x+Nn[0]*dn*xi,Ni.y+Nn[1]*dn*xi,Ni.z+Nn[2]*dn*xi):hi(kn,Ni.x,Ni.y,Ni.z),hi(ti,Ni.x+Nn[0]*dn*Qi,Ni.y+Nn[1]*dn*Qi,Ni.z+Nn[2]*dn*Qi),Li(kn,kn,qt),Li(ti,ti,qt),_i.push(new Su(kn[0],kn[1],kn[2])),Ai.push(new Su(ti[0],ti[1],ti[2]))}an.push(_i),Yn.push(Ai)}return[an,Yn]}(pe,Te,ye,je,$e,tt,_t,We,it,ot,dt):_t?function(vt,Xe,Ct,tn,Dt,qt,It,sn,An){const wn=[],yn=[],an=[0,0,0,1];for(const Yn of vt){const dn=[],kn=[];for(const ti of Yn){const hi=ti.x+tn.x,ui=ti.y+tn.y,fi=vx(hi,ui,Xe,Ct,qt,It,sn,An);an[0]=hi,an[1]=ui,an[2]=fi.base,an[3]=1,jl(an,an,Dt),an[3]=Math.max(an[3],1e-5);const _i=new Su(an[0]/an[3],an[1]/an[3],an[2]/an[3]);an[0]=hi,an[1]=ui,an[2]=fi.top,an[3]=1,jl(an,an,Dt),an[3]=Math.max(an[3],1e-5);const Ai=new Su(an[0]/an[3],an[1]/an[3],an[2]/an[3]);dn.push(_i),kn.push(Ai)}wn.push(dn),yn.push(kn)}return[wn,yn]}(Te,ye,je,$e,tt,_t,We,it,ot):function(vt,Xe,Ct,tn,Dt){const qt=[],It=[],sn=Dt[8]*Xe,An=Dt[9]*Xe,wn=Dt[10]*Xe,yn=Dt[11]*Xe,an=Dt[8]*Ct,Yn=Dt[9]*Ct,dn=Dt[10]*Ct,kn=Dt[11]*Ct;for(const ti of vt){const hi=[],ui=[];for(const fi of ti){const _i=fi.x+tn.x,Ai=fi.y+tn.y,cr=Dt[0]*_i+Dt[4]*Ai+Dt[12],Kn=Dt[1]*_i+Dt[5]*Ai+Dt[13],Xi=Dt[2]*_i+Dt[6]*Ai+Dt[14],Ni=Dt[3]*_i+Dt[7]*Ai+Dt[15],Nn=cr+sn,xi=Kn+An,Qi=Xi+wn,ni=Math.max(Ni+yn,1e-5),Di=cr+an,Ar=Kn+Yn,ur=Xi+dn,dr=Math.max(Ni+kn,1e-5);hi.push(new Su(Nn/ni,xi/ni,Qi/ni)),ui.push(new Su(Di/dr,Ar/dr,ur/dr))}qt.push(hi),It.push(ui)}return[qt,It]}(Te,ye,je,$e,tt)}(f,s,P,A,S,g,H,z,$,f.center.lat,n.tileID.canonical),ie=n.queryGeometry;return function(pe,Te,ye){let je=1/0;U0(ye,Te)&&(je=_x(ye,Te[0]));for(let $e=0;$e<Te.length;$e++){const tt=Te[$e],_t=pe[$e];for(let We=0;We<tt.length-1;We++){const it=tt[We],ot=[it,tt[We+1],_t[We+1],_t[We],it];N0(ye,ot)&&(je=Math.min(je,_x(ye,ot)))}}return je!==1/0&&je}(ae,_e,ie.isPointQuery()?ie.screenBounds:ie.screenGeometry)}},line:class extends Go{constructor(n){super(n,yx),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Ed,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(n,e){super.recalculate(n,e),this.paint._values["line-floorwidth"]=xx.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new Gp(n)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(n){return new Na(this,n)}queryRadius(n){const e=n,i=bx(xu("line-width",this,e),xu("line-gap-width",this,e)),s=xu("line-offset",this,e);return i/2+Math.abs(s)+Dp(this.paint.get("line-translate"))}queryIntersectsFeature(n,e,i,s,u,f){if(n.queryGeometry.isAboveHorizon)return!1;const g=Z0(n.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),y=n.pixelToTileUnitsFactor/2*bx(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),T=this.paint.get("line-offset").evaluate(e,i);return T&&(s=function(S,A){const P=[],z=new Y(0,0);for(let F=0;F<S.length;F++){const $=S[F],j=[];for(let H=0;H<$.length;H++){const ae=$[H-1],_e=$[H],ie=$[H+1],pe=H===0?z:_e.sub(ae)._unit()._perp(),Te=H===$.length-1?z:ie.sub(_e)._unit()._perp(),ye=pe._add(Te)._unit();ye._mult(1/(ye.x*Te.x+ye.y*Te.y)),j.push(ye._mult(A)._add(_e))}P.push(j)}return P}(s,T*n.pixelToTileUnitsFactor)),function(S,A,P){for(let z=0;z<A.length;z++){const F=A[z];if(S.length>=3){for(let $=0;$<F.length;$++)if(Wl(S,F[$]))return!0}if(EE(S,F,P))return!0}return!1}(g,s,y)}isTileClipped(){return!0}},symbol:im,background:class extends Go{constructor(n){super(n,pI)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Go{constructor(n){super(n,mI)}getProgramIds(){return["raster"]}},sky:class extends Go{constructor(n){super(n,_I),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="sky-gradient"?this._updateColorRamp():n!=="sky-atmosphere-sun"&&n!=="sky-atmosphere-halo-color"&&n!=="sky-atmosphere-color"&&n!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=i_({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(n){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=n.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(n,e){if(this.paint.get("sky-type")==="atmosphere"){const s=this.paint.get("sky-atmosphere-sun"),u=!s,f=n.style.light,g=f.properties.get("position");return u&&f.properties.get("anchor")==="viewport"&&ue("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?S_(g.azimuthal,90-g.polar,e):S_(s[0],90-s[1],e)}const i=this.paint.get("sky-gradient-center");return S_(i[0],90-i[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(n){this._skyboxInvalidated=!1,this._lightPosition=n.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const n=this.paint.get("sky-type");return n==="atmosphere"?["skyboxCapture","skybox"]:n==="gradient"?["skyboxGradient"]:null}}};class Mh{constructor(e,i,s,u){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(i,u)}update(e,i,s){const{width:u,height:f}=e,{context:g}=this,{gl:y}=g,{HTMLImageElement:T,HTMLCanvasElement:S,HTMLVideoElement:A,ImageData:P,ImageBitmap:z}=w;if(y.bindTexture(y.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA&&(!i||i.premultiply!==!1)),s||this.size&&this.size[0]===u&&this.size[1]===f){const{x:F,y:$}=s||{x:0,y:0};e instanceof T||e instanceof S||e instanceof A||e instanceof P||z&&e instanceof z?y.texSubImage2D(y.TEXTURE_2D,0,F,$,y.RGBA,y.UNSIGNED_BYTE,e):y.texSubImage2D(y.TEXTURE_2D,0,F,$,u,f,y.RGBA,y.UNSIGNED_BYTE,e.data)}else this.size=[u,f],e instanceof T||e instanceof S||e instanceof A||e instanceof P||z&&e instanceof z?y.texImage2D(y.TEXTURE_2D,0,this.format,this.format,y.UNSIGNED_BYTE,e):y.texImage2D(y.TEXTURE_2D,0,this.format,u,f,0,this.format,y.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(e,i){const{context:s}=this,{gl:u}=s;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.filter=e),i!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,i),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class yI{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class xI{constructor(){this.tasks={},this.taskQueue=[],xt(["process"],this),this.invoker=new yI(this.process),this.nextId=0}add(e,i){const s=this.nextId++,u=function({type:f,isSymbolTile:g,zoom:y}){return y=y||0,f==="message"?0:f!=="maybePrepare"||g?f!=="parseTile"||g?f==="parseTile"&&g?300-y:f==="maybePrepare"&&g?400-y:500:200-y:100-y}(i);if(u===0){st();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[s]={fn:e,metadata:i,priority:u,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){st();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let u=0;u<this.taskQueue.length;u++){const f=this.tasks[this.taskQueue[u]];f.priority<i&&(i=f.priority,e=u)}if(e===null)return null;const s=this.taskQueue[e];return this.taskQueue.splice(e,1),s}remove(){this.invoker.remove()}}class n1{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const s=e[i];this._stringToNumber[s]=i,this._numberToString[i]=s}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const bI=["tile","layer","source","sourceLayer","state"];class i1{constructor(e,i,s,u,f){this.type="Feature",this._vectorTileFeature=e,this._z=i,this._x=s,this._y=u,this.properties=e.properties,this.id=f}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const i of bI)this[i]!==void 0&&(e[i]=this[i]);return e}}const To=32,xs=33,Za=new Uint16Array(8184);for(let n=0;n<2046;n++){let e=n+2,i=0,s=0,u=0,f=0,g=0,y=0;for(1&e?u=f=g=To:i=s=y=To;(e>>=1)>1;){const S=i+u>>1,A=s+f>>1;1&e?(u=i,f=s,i=g,s=y):(i=u,s=f,u=g,f=y),g=S,y=A}const T=4*n;Za[T+0]=i,Za[T+1]=s,Za[T+2]=u,Za[T+3]=f}const bs=new Uint16Array(2178),Wa=new Uint8Array(1089),rm=new Uint16Array(1089);function r1(n){return n===0?-.03125:n===32?.03125:0}var o1=Ht([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const s1={type:2,extent:un,loadGeometry:()=>[[new Y(0,0),new Y(8193,0),new Y(8193,8193),new Y(0,8193),new Y(0,0)]]};class E_{constructor(e,i,s,u,f){this.tileID=e,this.uid=Gt(),this.uses=0,this.tileSize=i,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=f,this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){const i=e+this.timeAdded;i<Gn.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Xl(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,i,s){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,f){const g={};if(!f)return g;for(const y of u){const T=y.layerIds.map(S=>f.getLayer(S)).filter(Boolean);if(T.length!==0){y.layers=T,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(S=>T.filter(A=>A.id===S)[0]));for(const S of T)g[S.id]=y}}return g}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const f=this.buckets[u];if(f instanceof qa){if(this.hasSymbolBuckets=!0,!s)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const f=this.buckets[u];if(f instanceof qa&&f.hasRTLText){this.hasRTLText=!0,Ae.isLoading()||Ae.isLoaded()||Se()!=="deferred"||be();break}}this.queryPadding=0;for(const u in this.buckets){const f=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(u).queryRadius(f))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new zg}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const s in this.buckets){const u=this.buckets[s];u.uploadPending()&&u.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Mh(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Mh(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Mh(e,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,s,u,f,g,y,T){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:y,transform:g,params:f,tileTransform:this.tileTransform},e,i,s):{}}querySourceFeatures(e,i){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const u=s.loadVTLayers(),f=i?i.sourceLayer:"",g=u._geojsonTileLayer||u[f];if(!g)return;const y=iu(i&&i.filter),{z:T,x:S,y:A}=this.tileID.canonical,P={z:T,x:S,y:A};for(let z=0;z<g.length;z++){const F=g.feature(z);if(y.needGeometry){const H=Zl(F,!0);if(!y.filter(new Be(this.tileID.overscaledZ),H,this.tileID.canonical))continue}else if(!y.filter(new Be(this.tileID.overscaledZ),F))continue;const $=s.getId(F,f),j=new i1(F,T,S,A,$);j.tile=P,e.push(j)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const s=yt(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const s=Date.now();let u=!1;if(this.expirationTime>s)u=!1;else if(i)if(this.expirationTime<i)u=!0;else{const f=this.expirationTime-i;f?this.expirationTime=s+Math.max(f,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!i)return;const s=this.latestFeatureIndex.loadVTLayers(),u=i.style.listImages();for(const f in this.buckets){if(!i.style.hasLayer(f))continue;const g=this.buckets[f],y=g.layers[0].sourceLayer||"_geojsonTileLayer",T=s[y],S=e[y];if(!T||!S||Object.keys(S).length===0)continue;if(g.update(S,T,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),g instanceof Gp||g instanceof Vp){const P=i.style._getSourceCache(g.layers[0].source);i._terrain&&i._terrain.enabled&&P&&g.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(P.id,this.tileID)}const A=i&&i.style&&i.style.getLayer(f);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Gn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Gn.now()+e}setTexture(e,i){const s=i.context,u=s.gl;this.texture=this.texture||i.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Mh(s,e,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),s.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax))}setDependencies(e,i){const s={};for(const u of i)s[u]=!0;this.dependencies[e]=s}hasDependency(e,i){for(const s of e){const u=this.dependencies[s];if(u){for(const f of i)if(u[f])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,i){if(!i||i.name==="mercator"||this._tileDebugBuffer)return;const s=Ks(s1,this.tileID.canonical,this.tileTransform)[0],u=new Qt,f=new ps;for(let g=0;g<s.length;g++){const{x:y,y:T}=s[g];u.emplaceBack(y,T),f.emplaceBack(g)}f.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(u,lh.members),this._tileDebugSegments=Vi.simpleSegment(0,0,u.length,f.length)}_makeTileBoundsBuffers(e,i){if(this._tileBoundsBuffer||!i||i.name==="mercator")return;const s=Ks(s1,this.tileID.canonical,this.tileTransform)[0];let u,f;if(this.isRaster){const g=function(y,T){const S=Xl(y,T),A=Math.pow(2,y.z);for(let H=0;H<xs;H++)for(let ae=0;ae<xs;ae++){const _e=so((y.x+(ae+r1(ae))/To)/A),ie=br((y.y+(H+r1(H))/To)/A),pe=T.project(_e,ie),Te=H*xs+ae;bs[2*Te+0]=Math.round((pe.x*S.scale-S.x)*un),bs[2*Te+1]=Math.round((pe.y*S.scale-S.y)*un)}Wa.fill(0),rm.fill(0);for(let H=2045;H>=0;H--){const ae=4*H,_e=Za[ae+0],ie=Za[ae+1],pe=Za[ae+2],Te=Za[ae+3],ye=_e+pe>>1,je=ie+Te>>1,$e=ye+je-ie,tt=je+_e-ye,_t=ie*xs+_e,We=Te*xs+pe,it=je*xs+ye,ot=Math.hypot((bs[2*_t+0]+bs[2*We+0])/2-bs[2*it+0],(bs[2*_t+1]+bs[2*We+1])/2-bs[2*it+1])>=16;if(Wa[it]=Wa[it]||(ot?1:0),H<1022){const dt=(ie+tt>>1)*xs+(_e+$e>>1),vt=(Te+tt>>1)*xs+(pe+$e>>1);Wa[it]=Wa[it]||Wa[dt]||Wa[vt]}}const P=new ei,z=new xr;let F=0;function $(H,ae){const _e=ae*xs+H;return rm[_e]===0&&(P.emplaceBack(bs[2*_e+0],bs[2*_e+1],H*un/To,ae*un/To),rm[_e]=++F),rm[_e]-1}function j(H,ae,_e,ie,pe,Te){const ye=H+_e>>1,je=ae+ie>>1;if(Math.abs(H-pe)+Math.abs(ae-Te)>1&&Wa[je*xs+ye])j(pe,Te,H,ae,ye,je),j(_e,ie,pe,Te,ye,je);else{const $e=$(H,ae),tt=$(_e,ie),_t=$(pe,Te);z.emplaceBack($e,tt,_t)}}return j(0,0,To,To,To,0),j(To,To,0,0,0,To),{vertices:P,indices:z}}(this.tileID.canonical,i);u=g.vertices,f=g.indices}else{u=new ei,f=new xr;for(const{x:y,y:T}of s)u.emplaceBack(y,T,0,0);const g=bu(u.int16,void 0,4);for(let y=0;y<g.length;y+=3)f.emplaceBack(g[y],g[y+1],g[y+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,o1.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(f),this._tileBoundsSegments=Vi.simpleSegment(0,0,u.length,f.length)}_makeGlobeTileDebugBuffers(e,i){const s=i.projection;if(!s||s.name!=="globe"||i.freezeTileCoverage)return;const u=this.tileID.canonical,f=dh(M0(u,i)),g=vu(i.zoom);let y;g>0&&(y=Og(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,u,i,f,y,g),this._makeGlobeTileDebugTextBuffer(e,u,i,f,y,g)}_globePoint(e,i,s,u,f,g,y){let T=uh(e,i,s);if(g){const S=1<<s.z,A=_s(u.center.lng),P=vs(u.center.lat),z=(s.x+.5)/S-A;let F=0;z>.5?F=-1:z<-.5&&(F=1);let $=(e/un+s.x)/S+F,j=(i/un+s.y)/S;$=($-A)*u._pixelsPerMercatorPixel+A,j=(j-P)*u._pixelsPerMercatorPixel+P;const H=[$*u.worldSize,j*u.worldSize,0];Li(H,H,g),T=ql(T,H,y)}return Li(T,T,f)}_makeGlobeTileDebugBorderBuffer(e,i,s,u,f,g){const y=new Qt,T=new ps,S=new Zn,A=(z,F,$,j,H)=>{const ae=($-z)/(H-1),_e=(j-F)/(H-1),ie=y.length;for(let pe=0;pe<H;pe++){const Te=z+pe*ae,ye=F+pe*_e;y.emplaceBack(Te,ye);const je=this._globePoint(Te,ye,i,s,u,f,g);S.emplaceBack(je[0],je[1],je[2]),T.emplaceBack(ie+pe)}},P=un;A(0,0,P,0,16),A(P,0,P,P,16),A(P,P,0,P,16),A(0,P,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(T),this._tileDebugBuffer=e.createVertexBuffer(y,lh.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(S,A0.members),this._tileDebugSegments=Vi.simpleSegment(0,0,y.length,T.length)}_makeGlobeTileDebugTextBuffer(e,i,s,u,f,g){const y=new Qt,T=new xr,S=new Zn,A=25;T.reserve(32),y.reserve(A),S.reserve(A);const P=(z,F)=>A*z+F;for(let z=0;z<A;z++){const F=2048*z;for(let $=0;$<A;$++){const j=2048*$;y.emplaceBack(j,F);const H=this._globePoint(j,F,i,s,u,f,g);S.emplaceBack(H[0],H[1],H[2])}}for(let z=0;z<4;z++)for(let F=0;F<4;F++){const $=P(z,F),j=P(z,F+1),H=P(z+1,F),ae=P(z+1,F+1);T.emplaceBack($,j,H),T.emplaceBack(H,j,ae)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(T),this._tileDebugTextBuffer=e.createVertexBuffer(y,lh.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(S,A0.members),this._tileDebugTextSegments=Vi.simpleSegment(0,0,A,32)}}class wI{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,s){const u=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},pt(this.stateChanges[e][u],s),this.deletedStates[e]===null){this.deletedStates[e]={};for(const f in this.state[e])f!==u&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const f in this.state[e][u])s[f]||(this.deletedStates[e][u][f]=null)}else for(const f in s)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][f]===null&&delete this.deletedStates[e][u][f]}removeFeatureState(e,i,s){if(this.deletedStates[e]===null)return;const u=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&i!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][s]=null);else if(i!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(s in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][s]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,i){const s=String(i),u=pt({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const f=this.deletedStates[e][i];if(f===null)return{};for(const g in f)delete u[g]}return u}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const s={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const f={};for(const g in this.stateChanges[u])this.state[u][g]||(this.state[u][g]={}),pt(this.state[u][g],this.stateChanges[u][g]),f[g]=this.state[u][g];s[u]=f}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const f={};if(this.deletedStates[u]===null)for(const g in this.state[u])f[g]={},this.state[u][g]={};else for(const g in this.deletedStates[u]){if(this.deletedStates[u][g]===null)this.state[u][g]={};else if(this.state[u][g])for(const y of Object.keys(this.deletedStates[u][g]))delete this.state[u][g][y];f[g]=this.state[u][g]}s[u]=s[u]||{},pt(s[u],f)}if(this.stateChanges={},this.deletedStates={},Object.keys(s).length!==0)for(const u in e)e[u].setFeatureState(s,i)}}class a1{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const s=this.toIdx(e,i);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function l1(n,e,i,s){let u=0,f=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(s[g])<1e-15){if(i[g]<n[g]||i[g]>e[g])return null}else{const y=1/s[g];let T=(n[g]-i[g])*y,S=(e[g]-i[g])*y;if(T>S){const A=T;T=S,S=A}if(T>u&&(u=T),S<f&&(f=S),u>f)return null}return u}function c1(n,e,i,s,u,f,g,y,T,S,A){const P=s-n,z=u-e,F=f-i,$=g-n,j=y-e,H=T-i,ae=A[1]*H-A[2]*j,_e=A[2]*$-A[0]*H,ie=A[0]*j-A[1]*$,pe=P*ae+z*_e+F*ie;if(Math.abs(pe)<1e-15)return null;const Te=1/pe,ye=S[0]-n,je=S[1]-e,$e=S[2]-i,tt=(ye*ae+je*_e+$e*ie)*Te;if(tt<0||tt>1)return null;const _t=je*F-$e*z,We=$e*P-ye*F,it=ye*z-je*P,ot=(A[0]*_t+A[1]*We+A[2]*it)*Te;return ot<0||tt+ot>1?null:($*_t+j*We+H*it)*Te}function u1(n,e,i){return(n-e)/(i-e)}function d1(n,e,i,s,u,f,g,y,T){const S=1<<i,A=f-s,P=g-u,z=(n+1)/S*A+s,F=(e+0)/S*P+u,$=(e+1)/S*P+u;y[0]=(n+0)/S*A+s,y[1]=F,T[0]=z,T[1]=$}class h1{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(f){const g=Math.ceil(Math.log2(f.dim/8)),y=[];let T=Math.ceil(Math.pow(2,g));const S=1/T,A=(F,$,j,H,ae)=>{const _e=H?1:0,ie=(F+1)*j-_e,pe=$*j,Te=($+1)*j-_e;ae[0]=F*j,ae[1]=pe,ae[2]=ie,ae[3]=Te};let P=new a1(T);const z=[];for(let F=0;F<T*T;F++){A(F%T,Math.floor(F/T),S,!1,z);const $=Ha(z[0],z[1],f),j=Ha(z[2],z[1],f),H=Ha(z[2],z[3],f),ae=Ha(z[0],z[3],f);P.minimums.push(Math.min($,j,H,ae)),P.maximums.push(Math.max($,j,H,ae)),P.leaves.push(1)}for(y.push(P),T/=2;T>=1;T/=2){const F=y[y.length-1];P=new a1(T);for(let $=0;$<T*T;$++){A($%T,Math.floor($/T),2,!0,z);const j=F.getElevation(z[0],z[1]),H=F.getElevation(z[2],z[1]),ae=F.getElevation(z[2],z[3]),_e=F.getElevation(z[0],z[3]),ie=F.isLeaf(z[0],z[1]),pe=F.isLeaf(z[2],z[1]),Te=F.isLeaf(z[2],z[3]),ye=F.isLeaf(z[0],z[3]),je=Math.min(j.min,H.min,ae.min,_e.min),$e=Math.max(j.max,H.max,ae.max,_e.max),tt=ie&&pe&&Te&&ye;P.maximums.push($e),P.minimums.push(je),P.leaves.push($e-je<=5&&tt?1:0)}y.push(P)}return y}(this.dem),s=i.length-1,u=i[s];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(i,0,0,s,0)}raycastRoot(e,i,s,u,f,g,y=1){return l1([e,i,-100],[s,u,this.maximums[0]*y],f,g)}raycast(e,i,s,u,f,g,y=1){if(!this.nodeCount)return null;const T=this.raycastRoot(e,i,s,u,f,g,y);if(T==null)return null;const S=[],A=[],P=[],z=[],F=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;F.length>0;){const{idx:$,t:j,nodex:H,nodey:ae,depth:_e}=F.pop();if(this.leaves[$]){d1(H,ae,_e,e,i,s,u,P,z);const pe=1<<_e,Te=(H+0)/pe,ye=(H+1)/pe,je=(ae+0)/pe,$e=(ae+1)/pe,tt=Ha(Te,je,this.dem)*y,_t=Ha(ye,je,this.dem)*y,We=Ha(ye,$e,this.dem)*y,it=Ha(Te,$e,this.dem)*y,ot=c1(P[0],P[1],tt,z[0],P[1],_t,z[0],z[1],We,f,g),dt=c1(z[0],z[1],We,P[0],z[1],it,P[0],P[1],tt,f,g),vt=Math.min(ot!==null?ot:Number.MAX_VALUE,dt!==null?dt:Number.MAX_VALUE);if(vt!==Number.MAX_VALUE)return vt;{const Xe=sh([],f,g,j);if(f1(tt,_t,it,We,u1(Xe[0],P[0],z[0]),u1(Xe[1],P[1],z[1]))>=Xe[2])return j}continue}let ie=0;for(let pe=0;pe<this._siblingOffset.length;pe++){d1((H<<1)+this._siblingOffset[pe][0],(ae<<1)+this._siblingOffset[pe][1],_e+1,e,i,s,u,P,z),P[2]=-100,z[2]=this.maximums[this.childOffsets[$]+pe]*y;const Te=l1(P,z,f,g);if(Te!=null){const ye=Te;S[pe]=ye;let je=!1;for(let $e=0;$e<ie&&!je;$e++)ye>=S[A[$e]]&&(A.splice($e,0,pe),je=!0);je||(A[ie]=pe),ie++}}for(let pe=0;pe<ie;pe++){const Te=A[pe];F.push({idx:this.childOffsets[$]+Te,t:S[Te],nodex:(H<<1)+this._siblingOffset[Te][0],nodey:(ae<<1)+this._siblingOffset[Te][1],depth:_e+1})}}return null}_addNode(e,i,s){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,s,u,f){if(e[u].isLeaf(i,s)===1)return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);const g=u-1,y=e[g];let T=0,S=0;for(let A=0;A<this._siblingOffset.length;A++){const P=2*i+this._siblingOffset[A][0],z=2*s+this._siblingOffset[A][1],F=y.getElevation(P,z),$=y.isLeaf(P,z),j=this._addNode(F.min,F.max,$);$&&(T|=1<<A),S||(S=j)}for(let A=0;A<this._siblingOffset.length;A++)T&1<<A||this._construct(e,2*i+this._siblingOffset[A][0],2*s+this._siblingOffset[A][1],g,S+A)}}function f1(n,e,i,s,u,f){return Fn(Fn(n,i,f),Fn(e,s,f),u)}function Ha(n,e,i){const s=i.dim,u=nt(n*s-.5,0,s-1),f=nt(e*s-.5,0,s-1),g=Math.floor(u),y=Math.floor(f),T=Math.min(g+1,s-1),S=Math.min(y+1,s-1);return f1(i.get(g,y),i.get(T,y),i.get(g,S),i.get(T,S),u-g,f-y)}const p1={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class om{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,s,u=!1,f=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(s&&s!=="mapbox"&&s!=="terrarium")return ue(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const g=this.dim=i.height-2,y=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=s||"mapbox",this.borderReady=u,!u){for(let T=0;T<g;T++)y[this._idx(-1,T)]=y[this._idx(0,T)],y[this._idx(g,T)]=y[this._idx(g-1,T)],y[this._idx(T,-1)]=y[this._idx(T,0)],y[this._idx(T,g)]=y[this._idx(T,g-1)];y[this._idx(-1,-1)]=y[this._idx(0,0)],y[this._idx(g,-1)]=y[this._idx(g-1,0)],y[this._idx(-1,g)]=y[this._idx(0,g-1)],y[this._idx(g,g)]=y[this._idx(g-1,g-1)],f&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new h1(this)}get(e,i,s=!1){s&&(e=nt(e,-1,this.dim),i=nt(i,-1,this.dim));const u=4*this._idx(e,i);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[u],this.pixels[u+1],this.pixels[u+2])}static getUnpackVector(e){return p1[e]}get unpackVector(){return p1[this.encoding]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}_unpackMapbox(e,i,s){return(256*e*256+256*i+s)/10-1e4}_unpackTerrarium(e,i,s){return 256*e+i+s/256-32768}static pack(e,i){const s=[0,0,0,0],u=om.getUnpackVector(i);let f=Math.floor((e+u[3])/u[2]);return s[2]=f%256,f=Math.floor(f/256),s[1]=f%256,f=Math.floor(f/256),s[0]=f,s}getPixels(){return new Kr({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,i,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=i*this.dim,f=i*this.dim+this.dim,g=s*this.dim,y=s*this.dim+this.dim;switch(i){case-1:u=f-1;break;case 1:f=u+1}switch(s){case-1:g=y-1;break;case 1:y=g+1}const T=-i*this.dim,S=-s*this.dim;for(let A=g;A<y;A++)for(let P=u;P<f;P++){const z=4*this._idx(P,A),F=4*this._idx(P+T,A+S);this.pixels[z+0]=e.pixels[F+0],this.pixels[z+1]=e.pixels[F+1],this.pixels[z+2]=e.pixels[F+2],this.pixels[z+3]=e.pixels[F+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}$t(om,"DEMData"),$t(h1,"DemMinMaxQuadTree",{omit:["dem"]});class TI{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,s){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const f={value:i,timeout:void 0};if(s!==void 0&&(f.timeout=setTimeout(()=>{this.remove(e,f)},s)),this.data[u].push(f),this.order.push(u),this.order.length>this.max){const g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const s=e.wrapped().key,u=i===void 0?0:this.data[s].indexOf(i),f=this.data[s][u];return this.data[s].splice(u,1),f.timeout&&clearTimeout(f.timeout),this.data[s].length===0&&delete this.data[s],this.onRemove(f.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const s in this.data)for(const u of this.data[s])e(u.value)||i.push(u);for(const s of i)this.remove(s.value.tileID,s)}}class zu{constructor(e,i,s){this.func=e,this.mask=i,this.range=s}}zu.ReadOnly=!1,zu.ReadWrite=!0,zu.disabled=new zu(519,zu.ReadOnly,[0,1]);const C_=7680;class I_{constructor(e,i,s,u,f,g){this.test=e,this.ref=i,this.mask=s,this.fail=u,this.depthFail=f,this.pass=g}}I_.disabled=new I_({func:519,mask:0},0,0,C_,C_,C_);class ws{constructor(e,i,s){this.blendFunction=e,this.blendColor=i,this.mask=s}}ws.Replace=[1,0],ws.disabled=new ws(ws.Replace,zi.transparent,[!1,!1,!1,!1]),ws.unblended=new ws(ws.Replace,zi.transparent,[!0,!0,!0,!0]),ws.alphaBlended=new ws([1,771],zi.transparent,[!0,!0,!0,!0]);const A_=1029,k_=2305;class Ho{constructor(e,i,s){this.enable=e,this.mode=i,this.frontFace=s}}Ho.disabled=new Ho(!1,A_,k_),Ho.backCCW=new Ho(!0,A_,k_),Ho.backCW=new Ho(!0,A_,2304),Ho.frontCW=new Ho(!0,1028,2304),Ho.frontCCW=new Ho(!0,1028,k_);class Yl extends Ro{constructor(e,i,s){super(),this.id=e,this._onlySymbols=s,i.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new TI(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new wI,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const i=this._tiles[e];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,i){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,i)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const s=this._tiles[i];s.upload(e),s.prepare(this.map.style.imageManager)}}getIds(){return jt(this._tiles).map(e=>e.tileID).sort(m1).map(e=>e.key)}getRenderableIds(e){const i=[];for(const s in this._tiles)this._isIdRenderable(+s,e)&&i.push(this._tiles[s]);return e?i.sort((s,u)=>{const f=s.tileID,g=u.tileID,y=new Y(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),T=new Y(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-g.overscaledZ||T.y-y.y||T.x-y.x}).map(s=>s.tileID.key):i.map(s=>s.tileID).sort(m1).map(s=>s.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,i){const s=this._tiles[e];s&&(s.state!=="loading"&&(s.state=i),this._loadTile(s,this._tileLoaded.bind(this,s,e,i)))}_tileLoaded(e,i,s,u){if(u)if(e.state="errored",u.status!==404)this._source.fire(new ss(u,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const f=this.map.painter.terrain;this.update(this.transform,f.getScaledDemTileSize(),!0),f.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Gn.now(),s==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Qn("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const i=this.getRenderableIds();for(let u=0;u<i.length;u++){const f=i[u];if(e.neighboringTiles&&e.neighboringTiles[f]){const g=this.getTileByID(f);s(e,g),s(g,e)}}function s(u,f){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let g=f.tileID.canonical.x-u.tileID.canonical.x;const y=f.tileID.canonical.y-u.tileID.canonical.y,T=Math.pow(2,u.tileID.canonical.z),S=f.tileID.key;g===0&&y===0||Math.abs(y)>1||(Math.abs(g)>1&&(Math.abs(g+T)===1?g+=T:Math.abs(g-T)===1&&(g-=T)),f.dem&&u.dem&&(u.dem.backfillBorder(f.dem,g,y),u.neighboringTiles&&u.neighboringTiles[S]&&(u.neighboringTiles[S].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,s,u){for(const f in this._tiles){let g=this._tiles[f];if(u[f]||!g.hasData()||g.tileID.overscaledZ<=i||g.tileID.overscaledZ>s)continue;let y=g.tileID;for(;g&&g.tileID.overscaledZ>i+1;){const S=g.tileID.scaledTo(g.tileID.overscaledZ-1);g=this._tiles[S.key],g&&g.hasData()&&(y=S)}let T=y;for(;T.overscaledZ>i;)if(T=T.scaledTo(T.overscaledZ-1),e[T.key]){u[y.key]=y;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const s=this._loadedParentTiles[e.key];return s&&s.tileID.overscaledZ>=i?s:null}for(let s=e.overscaledZ-1;s>=i;s--){const u=e.scaledTo(s),f=this._getLoadedTile(u);if(f)return f}}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,i){i=i||this._source.tileSize;const s=Math.ceil(e.width/i)+1,u=Math.ceil(e.height/i)+1,f=Math.floor(s*u*5),g=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,f):f,y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(y)}handleWrapJump(e){const i=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,i){const s={};for(const u in this._tiles){const f=this._tiles[u];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+i),s[f.tileID.key]=f}this._tiles=s;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,i,s){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let u;this.updateCacheSize(e,i),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(y=>new Fr(y.canonical.z,y.wrap,y.canonical.z,y.canonical.x,y.canonical.y)):(u=e.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(y=>this._source.hasTile(y)))):u=[];const f=this._updateRetainedTiles(u);if(g1(this._source.type)&&u.length!==0){const y={},T={},S=Object.keys(f);for(const P of S){const z=f[P],F=this._tiles[P];if(!F||F.fadeEndTime&&F.fadeEndTime<=Gn.now())continue;const $=this.findLoadedParent(z,Math.max(z.overscaledZ-Yl.maxOverzooming,this._source.minzoom));$&&(this._addTile($.tileID),y[$.tileID.key]=$.tileID),T[P]=z}const A=u[u.length-1].overscaledZ;for(const P in this._tiles){const z=this._tiles[P];if(f[P]||!z.hasData())continue;let F=z.tileID;for(;F.overscaledZ>A;){F=F.scaledTo(F.overscaledZ-1);const $=this._tiles[F.key];if($&&$.hasData()&&T[F.key]){f[P]=z.tileID;break}}}for(const P in y)f[P]||(this._coveredTiles[P]=!0,f[P]=y[P])}for(const y in f)this._tiles[y].clearFadeHold();const g=function(y,T){const S=[];for(const A in y)A in T||S.push(A);return S}(this._tiles,f);for(const y of g){const T=this._tiles[y];T.hasSymbolBuckets&&!T.holdingForFade()?T.setHoldDuration(this.map._fadeDuration):T.hasSymbolBuckets&&!T.symbolFadeFinished()||this._removeTile(+y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const i={};if(e.length===0)return i;const s={},u=e.reduce((S,A)=>Math.min(S,A.overscaledZ),1/0),f=e[0].overscaledZ,g=Math.max(f-Yl.maxOverzooming,this._source.minzoom),y=Math.max(f+Yl.maxUnderzooming,this._source.minzoom),T={};for(const S of e){const A=this._addTile(S);i[S.key]=S,A.hasData()||u<this._source.maxzoom&&(T[S.key]=S)}this._retainLoadedChildren(T,u,y,i);for(const S of e){let A=this._tiles[S.key];if(A.hasData())continue;if(S.canonical.z>=this._source.maxzoom){const z=S.children(this._source.maxzoom)[0],F=this.getTile(z);if(F&&F.hasData()){i[z.key]=z;continue}}else{const z=S.children(this._source.maxzoom);if(i[z[0].key]&&i[z[1].key]&&i[z[2].key]&&i[z[3].key])continue}let P=A.wasRequested();for(let z=S.overscaledZ-1;z>=g;--z){const F=S.scaledTo(z);if(s[F.key]||(s[F.key]=!0,A=this.getTile(F),!A&&P&&(A=this._addTile(F)),A&&(i[F.key]=F,P=A.wasRequested(),A.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let s,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){s=this._loadedParentTiles[u.key];break}i.push(u.key);const f=u.scaledTo(u.overscaledZ-1);if(s=this._getLoadedTile(f),s)break;u=f}for(const f of i)this._loadedParentTiles[f]=s}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const s=Boolean(i);if(!s){const u=this.map?this.map.painter:null;i=new E_(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))}return i?(i.uses++,this._tiles[e.key]=i,s||this._source.fire(new Qn("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const s=i.getExpiryTimeout();s&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},s))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,i,s){const u=[],f=this.transform;if(!f)return u;const g=f.projection.name==="globe",y=_s(f.center.lng);for(const T in this._tiles){const S=this._tiles[T];if(s&&S.clearQueryDebugViz(),S.holdingForFade())continue;let A;if(g){const P=S.tileID.canonical;if(P.z===0){const z=[Math.abs(nt(y,...Ph(P,-1))-y),Math.abs(nt(y,...Ph(P,1))-y)];A=[0,2*z.indexOf(Math.min(...z))-1]}else{const z=[Math.abs(nt(y,...Ph(P,-1))-y),Math.abs(nt(y,...Ph(P,0))-y),Math.abs(nt(y,...Ph(P,1))-y)];A=[z.indexOf(Math.min(...z))-1]}}else A=[0];for(const P of A){const z=e.containsTile(S,f,i,P);z&&u.push(z)}}return u}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(s=>this._tiles[s].tileID);for(const s of i)s.projMatrix=this.transform.calculateProjMatrix(s.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(g1(this._source.type))for(const e in this._tiles){const i=this._tiles[e];if(i.fadeEndTime!==void 0&&i.fadeEndTime>=Gn.now())return!0}return!1}setFeatureState(e,i,s){this._state.updateState(e=e||"_geojsonTileLayer",i,s)}removeFeatureState(e,i,s){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,s)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,s){const u=this._tiles[e];u&&u.setDependencies(i,s)}reloadTilesForDependencies(e,i){for(const s in this._tiles)this._tiles[s].hasDependency(e,i)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(e,i))}_preloadTiles(e,i){const s=new Map,u=Array.isArray(e)?e:[e],f=this.map.painter.terrain,g=this.usedForTerrain&&f?f.getScaledDemTileSize():this._source.tileSize;for(const y of u){const T=y.coveringTiles({tileSize:g,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const S of T)s.set(S.key,S);this.usedForTerrain&&y.updateElevation(!1)}at(Array.from(s.values()),(y,T)=>{const S=new E_(y,this._source.tileSize*y.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(S,A=>{this._source.type==="raster-dem"&&S.dem&&this._backfillDEM(S),T(A,S)})},i)}}function m1(n,e){const i=Math.abs(2*n.wrap)-+(n.wrap<0),s=Math.abs(2*e.wrap)-+(e.wrap<0);return n.overscaledZ-e.overscaledZ||s-i||e.canonical.y-n.canonical.y||e.canonical.x-n.canonical.x}function g1(n){return n==="raster"||n==="image"||n==="video"||n==="custom"}function Ph(n,e){const i=1<<n.z;return[n.x/i+e,(n.x+1)/i+e]}Yl.maxOverzooming=10,Yl.maxUnderzooming=3;class sm{constructor(e,i,s){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=s}static create(e,i,s){const u=s||e.findDEMTileFor(i);if(!u||!u.dem)return;const f=u.dem,g=u.tileID,y=1<<i.canonical.z-g.canonical.z;return new sm(u,u.tileSize/un/y,[(i.canonical.x/y-g.canonical.x)*f.dim,(i.canonical.y/y-g.canonical.y)*f.dim])}tileCoordToPixel(e,i){const s=i*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),f=Math.floor(s);return new Y(u,f)}getElevationAt(e,i,s,u){const f=e*this._scale+this._offset[0],g=i*this._scale+this._offset[1],y=Math.floor(f),T=Math.floor(g),S=this._dem;return u=!!u,s?Fn(Fn(S.get(y,T,u),S.get(y,T+1,u),g-T),Fn(S.get(y+1,T,u),S.get(y+1,T+1,u),g-T),f-y):S.get(y,T,u)}getElevationAtPixel(e,i,s){return this._dem.get(e,i,!!s)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Wo(1,e)*this._dem.stride}}class _1{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ra(un,16,0),this.featureIndexArray=new a0,this.promoteId=i}insert(e,i,s,u,f,g=0){const y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,u,f,g);const T=this.grid;for(let S=0;S<i.length;S++){const A=i[S],P=[1/0,1/0,-1/0,-1/0];for(let z=0;z<A.length;z++){const F=A[z];P[0]=Math.min(P[0],F.x),P[1]=Math.min(P[1],F.y),P[2]=Math.max(P[2],F.x),P[3]=Math.max(P[3],F.y)}P[0]<un&&P[1]<un&&P[2]>=0&&P[3]>=0&&T.insert(y,P[0],P[1],P[2],P[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new u_(new Th(this.rawTileData)).layers,this.sourceLayerCoder=new n1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i,s,u){this.loadVTLayers();const f=e.params||{},g=iu(f.filter),y=e.tileResult,T=e.transform,S=y.bufferedTilespaceBounds,A=this.grid.query(S.min.x,S.min.y,S.max.x,S.max.y,($,j,H,ae)=>q0(y.bufferedTilespaceGeometry,$,j,H,ae));A.sort(SI);let P=null;T.elevation&&A.length>0&&(P=sm.create(T.elevation,this.tileID));const z={};let F;for(let $=0;$<A.length;$++){const j=A[$];if(j===F)continue;F=j;const H=this.featureIndexArray.get(j);let ae=null;this.loadMatchingFeature(z,H,g,f.layers,f.availableImages,i,s,u,(_e,ie,pe,Te=0)=>(ae||(ae=Ks(_e,this.tileID.canonical,e.tileTransform)),ie.queryIntersectsFeature(y,_e,pe,ae,this.z,e.transform,e.pixelPosMatrix,P,Te)))}return z}loadMatchingFeature(e,i,s,u,f,g,y,T,S){const{featureIndex:A,bucketIndex:P,sourceLayerIndex:z,layoutVertexArrayOffset:F}=i,$=this.bucketLayerIDs[P];if(u&&!function(_e,ie){for(let pe=0;pe<_e.length;pe++)if(ie.indexOf(_e[pe])>=0)return!0;return!1}(u,$))return;const j=this.sourceLayerCoder.decode(z),H=this.vtLayers[j].feature(A);if(s.needGeometry){const _e=Zl(H,!0);if(!s.filter(new Be(this.tileID.overscaledZ),_e,this.tileID.canonical))return}else if(!s.filter(new Be(this.tileID.overscaledZ),H))return;const ae=this.getId(H,j);for(let _e=0;_e<$.length;_e++){const ie=$[_e];if(u&&u.indexOf(ie)<0)continue;const pe=g[ie];if(!pe)continue;let Te={};ae!==void 0&&T&&(Te=T.getState(pe.sourceLayer||"_geojsonTileLayer",ae));const ye=pt({},y[ie]);ye.paint=v1(ye.paint,pe.paint,H,Te,f),ye.layout=v1(ye.layout,pe.layout,H,Te,f);const je=!S||S(H,pe,Te,F);if(!je)continue;const $e=new i1(H,this.z,this.x,this.y,ae);$e.layer=ye;let tt=e[ie];tt===void 0&&(tt=e[ie]=[]),tt.push({featureIndex:A,feature:$e,intersectionZ:je})}}lookupSymbolFeatures(e,i,s,u,f,g,y,T){const S={};this.loadVTLayers();const A=iu(f);for(const P of e)this.loadMatchingFeature(S,{bucketIndex:s,sourceLayerIndex:u,featureIndex:P,layoutVertexArrayOffset:0},A,g,y,T,i);return S}loadFeature(e){const{featureIndex:i,sourceLayerIndex:s}=e;this.loadVTLayers();const u=this.sourceLayerCoder.decode(s),f=this.vtFeatures[u];if(f[i])return f[i];const g=this.vtLayers[u].feature(i);return f[i]=g,g}hasLayer(e){for(const i of this.bucketLayerIDs)for(const s of i)if(e===s)return!0;return!1}getId(e,i){let s=e.id;if(this.promoteId){const u=typeof this.promoteId=="string"?this.promoteId:this.promoteId[i];u!=null&&(s=e.properties[u]),typeof s=="boolean"&&(s=Number(s))}return s}}function v1(n,e,i,s,u){return Nt(n,(f,g)=>{const y=e instanceof Ue?e.get(g):null;return y&&y.evaluate?y.evaluate(i,s,u):y})}function SI(n,e){return e-n}$t(_1,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class y1{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new Js({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const s=this.getKey(e,i);return this.positions[s]}trim(){const e=this.width,i=this.height=At(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,s){const u=[];let f=e.length%2==1?-e[e.length-1]*s:0,g=e[0]*s,y=!0;u.push({left:f,right:g,isDash:y,zeroLength:e[0]===0});let T=e[0];for(let S=1;S<e.length;S++){y=!y;const A=e[S];f=T*s,T+=A,g=T*s,u.push({left:f,right:g,isDash:y,zeroLength:A===0})}return u}addRoundDash(e,i,s){const u=i/2;for(let f=-s;f<=s;f++){const g=this.width*(this.nextRow+s+f);let y=0,T=e[y];for(let S=0;S<this.width;S++){S/T.right>1&&(T=e[++y]);const A=Math.abs(S-T.left),P=Math.abs(S-T.right),z=Math.min(A,P);let F;const $=f/s*(u+1);if(T.isDash){const j=u-Math.abs($);F=Math.sqrt(z*z+j*j)}else F=u-Math.sqrt(z*z+$*$);this.image.data[g+S]=Math.max(0,Math.min(255,F+128))}}}addRegularDash(e,i){for(let T=e.length-1;T>=0;--T){const S=e[T],A=e[T+1];S.zeroLength?e.splice(T,1):A&&A.isDash===S.isDash&&(A.left=S.left,e.splice(T,1))}const s=e[0],u=e[e.length-1];s.isDash===u.isDash&&(s.left=u.left-this.width,u.right=s.right+this.width);const f=this.width*this.nextRow;let g=0,y=e[g];for(let T=0;T<this.width;T++){T/y.right>1&&(y=e[++g]);const S=Math.abs(T-y.left),A=Math.abs(T-y.right),P=Math.min(S,A);this.image.data[f+T]=Math.max(0,Math.min(255,(y.isDash?P:-P)+i+128))}}addDash(e,i){const s=this.getKey(e,i);if(this.positions[s])return this.positions[s];const u=i==="round",f=u?7:0,g=2*f+1;if(this.nextRow+g>this.height)return ue("LineAtlas out of space"),null;e.length===0&&e.push(1);let y=0;for(let A=0;A<e.length;A++)e[A]<0&&(ue("Negative value is found in line dasharray, replacing values with 0"),e[A]=0),y+=e[A];if(y!==0){const A=this.width/y,P=this.getDashRanges(e,this.width,A);u?this.addRoundDash(P,A,f):this.addRegularDash(P,i==="square"?.5*A:0)}const T=this.nextRow+f;this.nextRow+=g;const S={tl:[T,f],br:[y,0]};return this.positions[s]=S,S}}$t(y1,"LineAtlas");class x1{constructor(e){const i={},s=[];for(const y in e){const T=e[y],S=i[y]={};for(const A in T.glyphs){const P=T.glyphs[+A];if(!P||P.bitmap.width===0||P.bitmap.height===0)continue;const z=P.metrics.localGlyph?2:1,F={x:0,y:0,w:P.bitmap.width+2*z,h:P.bitmap.height+2*z};s.push(F),S[A]=F}}const{w:u,h:f}=f_(s),g=new Js({width:u||1,height:f||1});for(const y in e){const T=e[y];for(const S in T.glyphs){const A=T.glyphs[+S];if(!A||A.bitmap.width===0||A.bitmap.height===0)continue;const P=i[y][S],z=A.metrics.localGlyph?2:1;Js.copy(A.bitmap,g,{x:0,y:0},{x:P.x+z,y:P.y+z},A.bitmap)}}this.image=g,this.positions=i}}$t(x1,"GlyphAtlas");class EI{constructor(e){this.tileID=new Fr(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=Xl(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,i,s,u,f){this.status="parsing",this.data=e,this.collisionBoxArray=new zg;const g=new n1(Object.keys(e.layers).sort()),y=new _1(this.tileID,this.promoteId);y.bucketLayerIDs=[];const T={},S=new y1(256,256),A={featureIndex:y,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:S,availableImages:s},P=i.familiesBySource[this.source];for(const Te in P){const ye=e.layers[Te];if(!ye)continue;let je=!1,$e=!1;for(const We of P[Te])We[0].type==="symbol"?je=!0:$e=!0;if(this.isSymbolTile===!0&&!je||this.isSymbolTile===!1&&!$e)continue;ye.version===1&&ue(`Vector tile source "${this.source}" layer "${Te}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const tt=g.encode(Te),_t=[];for(let We=0;We<ye.length;We++){const it=ye.feature(We),ot=y.getId(it,Te);_t.push({feature:it,id:ot,index:We,sourceLayerIndex:tt})}for(const We of P[Te]){const it=We[0];this.isSymbolTile!==void 0&&it.type==="symbol"!==this.isSymbolTile||it.minzoom&&this.zoom<Math.floor(it.minzoom)||it.maxzoom&&this.zoom>=it.maxzoom||it.visibility!=="none"&&(M_(We,this.zoom,s),(T[it.id]=it.createBucket({index:y.bucketLayerIDs.length,layers:We,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:tt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:s})).populate(_t,A,this.tileID.canonical,this.tileTransform),y.bucketLayerIDs.push(We.map(ot=>ot.id)))}}let z,F,$,j;S.trim();const H={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ae=Nt(A.glyphDependencies,Te=>Object.keys(Te).map(Number));Object.keys(ae).length?u.send("getGlyphs",{uid:this.uid,stacks:ae},(Te,ye)=>{z||(z=Te,F=ye,pe.call(this))},void 0,!1,H):F={};const _e=Object.keys(A.iconDependencies);_e.length?u.send("getImages",{icons:_e,source:this.source,tileID:this.tileID,type:"icons"},(Te,ye)=>{z||(z=Te,$=ye,pe.call(this))},void 0,!1,H):$={};const ie=Object.keys(A.patternDependencies);function pe(){if(z)return f(z);if(F&&$&&j){const Te=new x1(F),ye=new kx($,j);for(const je in T){const $e=T[je];$e instanceof qa?(M_($e.layers,this.zoom,s),QC($e,F,Te.positions,$,ye.iconPositions,this.showCollisionBoxes,s,this.tileID.canonical,this.tileZoom,this.projection)):$e.hasPattern&&($e instanceof Gp||$e instanceof Vp||$e instanceof yh)&&(M_($e.layers,this.zoom,s),$e.addFeatures(A,this.tileID.canonical,ye.patternPositions,s,this.tileTransform))}this.status="done",f(null,{buckets:jt(T).filter(je=>!je.isEmpty()),featureIndex:y,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Te.image,lineAtlas:S,imageAtlas:ye,glyphMap:this.returnDependencies?F:null,iconMap:this.returnDependencies?$:null,glyphPositions:this.returnDependencies?Te.positions:null})}}ie.length?u.send("getImages",{icons:ie,source:this.source,tileID:this.tileID,type:"patterns"},(Te,ye)=>{z||(z=Te,j=ye,pe.call(this))},void 0,!1,H):j={},pe.call(this)}}function M_(n,e,i){const s=new Be(e);for(const u of n)u.recalculate(s,i)}class b1{constructor(e){this.entries={},this.scheduler=e}request(e,i,s,u){const f=this.entries[e]=this.entries[e]||{callbacks:[]};if(f.result){const[g,y]=f.result;return this.scheduler?this.scheduler.add(()=>{u(g,y)},i):u(g,y),()=>{}}return f.callbacks.push(u),f.cancel||(f.cancel=s((g,y)=>{f.result=[g,y];for(const T of f.callbacks)this.scheduler?this.scheduler.add(()=>{T(g,y)},i):T(g,y);setTimeout(()=>delete this.entries[e],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(g=>g!==u),f.callbacks.length||(f.cancel(),delete this.entries[e]))}}}function w1(n,e,i){const s=JSON.stringify(n.request);return n.data&&(this.deduped.entries[s]={result:[null,n.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom},u=>{const f=mo(n.request,(g,y,T,S)=>{g?u(g):y&&u(null,{vectorTile:i?void 0:new u_(new Th(y)),rawData:y,cacheControl:T,expires:S})});return()=>{f.cancel(),u()}},e)}o.ARRAY_TYPE=Yr,o.AUTH_ERR_MSG=Rs,o.Aabb=Or,o.Actor=class{constructor(n,e,i){this.target=n,this.parent=e,this.mapId=i,this.callbacks={},this.cancelCallbacks={},xt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=st()?n:w,this.scheduler=new xI}send(n,e,i,s,u=!1,f){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=f,this.callbacks[g]=i);const y=Vt(this.globalScope)?void 0:[];return this.target.postMessage({id:g,type:n,hasCallback:!!i,targetMapId:s,mustQueue:u,sourceMapId:this.mapId,data:Dl(e,y)},y),{cancel:()=>{i&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}receive(n){const e=n.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const s=this.cancelCallbacks[i];delete this.cancelCallbacks[i],s&&s.cancel()}else if(e.mustQueue||st()){const s=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,e),s&&s.metadata||{type:"message"})}else this.processTask(i,e)}processTask(n,e){if(e.type==="<response>"){const i=this.callbacks[n];delete this.callbacks[n],i&&(e.error?i(Bl(e.error)):i(null,Bl(e.data)))}else{const i=Vt(this.globalScope)?void 0:[],s=e.hasCallback?(f,g)=>{delete this.cancelCallbacks[n],this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:f?Dl(f):null,data:Dl(g,i)},i)}:f=>{},u=Bl(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,s);else if(this.parent.getWorkerSource){const f=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,f[0],u.source)[f[1]](u,s)}else s(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.CanonicalTileID=jp,o.Color=zi,o.ColorMode=ws,o.CullFaceMode=Ho,o.DEMData=om,o.DataConstantProperty=Le,o.DedupedRequest=b1,o.DepthMode=zu,o.EXTENT=un,o.Elevation=class{isDataAvailableAtPoint(n){const e=this._source();if(this.isUsingMockSource()||!e||n.y<0||n.y>1)return!1;const i=e.getSource().maxzoom,s=1<<i,u=Math.floor(n.x),f=Math.floor((n.x-u)*s),g=Math.floor(n.y*s),y=this.findDEMTileFor(new Fr(i,u,i,f,g));return!(!y||!y.dem)}getAtPointOrZero(n,e=0){return this.getAtPoint(n,e)||0}getAtPoint(n,e,i=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const s=this._source();if(!s||n.y<0||n.y>1)return e;const u=s.getSource().maxzoom,f=1<<u,g=Math.floor(n.x),y=n.x-g,T=new Fr(u,g,u,Math.floor(y*f),Math.floor(n.y*f)),S=this.findDEMTileFor(T);if(!S||!S.dem)return e;const A=S.dem,P=1<<S.tileID.canonical.z,z=(y*P-S.tileID.canonical.x)*A.dim,F=(n.y*P-S.tileID.canonical.y)*A.dim,$=Math.floor(z),j=Math.floor(F);return(i?this.exaggeration():1)*Fn(Fn(A.get($,j),A.get($,j+1),F-j),Fn(A.get($+1,j),A.get($+1,j+1),F-j),z-$)}getAtTileOffset(n,e,i){const s=1<<n.canonical.z;return this.getAtPointOrZero(new yu(n.wrap+(n.canonical.x+e/un)/s,(n.canonical.y+i/un)/s))}getAtTileOffsetFunc(n,e,i,s){return u=>{const f=this.getAtTileOffset(n,u.x,u.y),g=s.upVector(n.canonical,u.x,u.y);return oo(g,g,f*s.upVectorScale(n.canonical,e,i).metersToTile),g}}getForTilePoints(n,e,i,s){if(this.isUsingMockSource())return!1;const u=sm.create(this,n,s);return!!u&&(e.forEach(f=>{f[2]=this.exaggeration()*u.getElevationAt(f[0],f[1],i)}),!0)}getMinMaxForTile(n){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(n);if(!e||!e.dem)return null;const i=e.dem.tree,s=e.tileID,u=1<<n.canonical.z-s.canonical.z;let f=n.canonical.x/u-s.canonical.x,g=n.canonical.y/u-s.canonical.y,y=0;for(let T=0;T<n.canonical.z-s.canonical.z&&!i.leaves[y];T++){f*=2,g*=2;const S=2*Math.floor(g)+Math.floor(f);y=i.childOffsets[y]+S,f%=1,g%=1}return{min:this.exaggeration()*i.minimums[y],max:this.exaggeration()*i.maximums[y]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(n,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(n){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(n){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},o.ErrorEvent=ss,o.EvaluationParameters=Be,o.Event=Qn,o.Evented=Ro,o.FillExtrusionBucket=yh,o.Frustum=Gg,o.FrustumCorners=jg,o.GLOBE_RADIUS=ms,o.GLOBE_SCALE_MATCH_LATITUDE=45,o.GLOBE_ZOOM_THRESHOLD_MAX=6,o.GLOBE_ZOOM_THRESHOLD_MIN=5,o.GlobeSharedBuffers=class{constructor(n){this._createGrid(n),this._createPoles(n)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const n of this._poleSegments)n.destroy();for(const n of this._gridSegments)n.withSkirts.destroy(),n.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const n of this._wireframeSegments)n.destroy()}}_fillGridMeshWithLods(n,e){const i=new Qt,s=new xr,u=[],f=n+1+2,g=e[0]+1,y=e[0]+1+(1+e.length),T=(S,A,P)=>{let z=S===f-1?S-2:S===0?S:S-1;return z+=P?24575:0,[z,A]};for(let S=0;S<f;++S)i.emplaceBack(...T(S,0,!0));for(let S=0;S<g;++S)for(let A=0;A<f;++A)i.emplaceBack(...T(A,S,(A===0||A===f-1)&&!0));for(let S=0;S<e.length;++S){const A=e[S];for(let P=0;P<f;++P)i.emplaceBack(...T(P,A,!0))}for(let S=0;S<e.length;++S){const A=s.length,P=e[S]+1+2,z=new xr;for(let j=0;j<P-1;j++){const H=j===P-2,ae=H?f*(y-e.length+S-j):f;for(let _e=0;_e<f-1;_e++){const ie=j*f+_e;j===0||H||_e===0||_e===f-2?(z.emplaceBack(ie+1,ie,ie+ae),z.emplaceBack(ie+ae,ie+ae+1,ie+1)):(s.emplaceBack(ie+1,ie,ie+ae),s.emplaceBack(ie+ae,ie+ae+1,ie+1))}}const F=Vi.simpleSegment(0,A,i.length,s.length-A);for(let j=0;j<z.uint16.length;j+=3)s.emplaceBack(z.uint16[j],z.uint16[j+1],z.uint16[j+2]);const $=Vi.simpleSegment(0,A,i.length,s.length-A);u.push({withoutSkirts:F,withSkirts:$})}return{vertices:i,indices:s,segments:u}}_createGrid(n){const e=this._fillGridMeshWithLods(Gl,ch);this._gridSegments=e.segments,this._gridBuffer=n.createVertexBuffer(e.vertices,lh.members),this._gridIndexBuffer=n.createIndexBuffer(e.indices,!0)}_createPoles(n){const e=new xr;for(let u=0;u<=Gl;u++)e.emplaceBack(0,u+1,u+2);this._poleIndexBuffer=n.createIndexBuffer(e,!0);const i=new Xr,s=new Xr;this._poleSegments=[];for(let u=0,f=0;u<5;u++){const g=360/(1<<u);i.emplaceBack(0,-ms,0,.5,0),s.emplaceBack(0,-ms,0,.5,1);for(let y=0;y<=Gl;y++){const T=y/Gl,S=Fn(0,g,T),[A,P,z]=gu(xE,bE,S,ms);i.emplaceBack(A,P,z,T,0),s.emplaceBack(A,P,z,T,1)}this._poleSegments.push(Vi.simpleSegment(f,0,66,64)),f+=66}this._poleNorthVertexBuffer=n.createVertexBuffer(i,I0,!1),this._poleSouthVertexBuffer=n.createVertexBuffer(s,I0,!1)}getGridBuffers(n,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[n].withSkirts:this._gridSegments[n].withoutSkirts]}getPoleBuffers(n){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[n]]}getWirefameBuffers(n,e){if(!this._wireframeSegments){const i=new fs,s=Gl,u=s+1+2,f=1;this._wireframeSegments=[];for(let g=0,y=0;g<ch.length;g++){const T=ch[g];for(let A=f;A<T+f;A++)for(let P=f;P<s+f;P++){const z=A*u+P;i.emplaceBack(z,z+1),i.emplaceBack(z,z+u),i.emplaceBack(z,z+u+1)}const S=T*s*3;this._wireframeSegments.push(Vi.simpleSegment(0,y,(T+1)*u,S)),y+=S}this._wireframeIndexBuffer=n.createIndexBuffer(i)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},o.GlyphManager=ku,o.ImagePosition=p_,o.LivePerformanceUtils=ct,o.LngLat=Vn,o.LngLatBounds=Ua,o.LocalGlyphMode=__,o.MAX_MERCATOR_LATITUDE=wr,o.MercatorCoordinate=yu,o.ONE_EM=Tr,o.OverscaledTileID=Fr,o.PerformanceMarkers=Ve,o.Properties=mt,o.RGBAImage=Kr,o.Ray=Ug,o.RequestManager=class{constructor(n,e,i){this._transformRequestFn=n,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const n=function(){let e="";for(let i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",me,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,e){return this._transformRequestFn&&this._transformRequestFn(n,e)||{url:n}}normalizeStyleURL(n,e){if(!io(n))return n;const i=Gr(n);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(n,e){if(!io(n))return n;const i=Gr(n);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(n,e,i,s){if(!io(n))return n;const u=Gr(n);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),i&&u.params.push(`language=${i}`),s&&u.params.push(`worldview=${s}`),this._makeAPIURL(u,this._customAccessToken||e)}normalizeSpriteURL(n,e,i,s){const u=Gr(n);return io(n)?(u.path=`/styles/v1${u.path}/sprite${e}${i}`,this._makeAPIURL(u,this._customAccessToken||s)):(u.path+=`${e}${i}`,os(u))}normalizeTileURL(n,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!io(n))return n;const s=Gr(n);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&s.authority!=="raster"&&i===512?"@2x":""}${D.supported?".webp":"$1"}`),s.authority==="raster"?s.path=`/${L.RASTER_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${L.TILE_URL_VERSION}${s.path}`);const u=this._customAccessToken||function(f){for(const g of f){const y=g.match(/^access_token=(.*)$/);if(y)return y[1]}return null}(s.params)||L.ACCESS_TOKEN;return L.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,u)}canonicalizeTileURL(n,e){const i=Gr(n);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return n;let s="mapbox://";i.path.match(/^\/raster\/v1\//)?s+=`raster/${i.path.replace(`/${L.RASTER_URL_PREFIX}/`,"")}`:s+=`tiles/${i.path.replace(`/${L.TILE_URL_VERSION}/`,"")}`;let u=i.params;return e&&(u=u.filter(f=>!f.match(/^access_token=/))),u.length&&(s+=`?${u.join("&")}`),s}canonicalizeTileset(n,e){const i=!!e&&io(e),s=[];for(const u of n.tiles||[])Os(u)?s.push(this.canonicalizeTileURL(u,i)):s.push(u);return s}_makeAPIURL(n,e){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",s=Gr(L.API_URL);if(n.protocol=s.protocol,n.authority=s.authority,n.protocol==="http"){const u=n.params.indexOf("secure");u>=0&&n.params.splice(u,1)}if(s.path!=="/"&&(n.path=`${s.path}${n.path}`),!L.REQUIRE_ACCESS_TOKEN)return os(n);if(e=e||L.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return n.params=n.params.filter(u=>u.indexOf("access_token")===-1),n.params.push(`access_token=${e||""}`),os(n)}},o.ResourceType=tr,o.SegmentVector=Vi,o.SourceCache=Yl,o.StencilMode=I_,o.StructArrayLayout1ui2=ps,o.StructArrayLayout2f1f2i16=vr,o.StructArrayLayout2i4=Qt,o.StructArrayLayout2ui4=fs,o.StructArrayLayout3f12=yr,o.StructArrayLayout3ui6=xr,o.StructArrayLayout4i8=ei,o.StructArrayLayout5f20=Xr,o.Texture=Mh,o.Tile=E_,o.Transitionable=bt,o.Uniform1f=Ep,o.Uniform1i=class extends Hs{constructor(n){super(n),this.current=0}set(n,e,i){this.fetchUniformLocation(n,e)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},o.Uniform2f=class extends Hs{constructor(n){super(n),this.current=[0,0]}set(n,e,i){this.fetchUniformLocation(n,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}},o.Uniform3f=class extends Hs{constructor(n){super(n),this.current=[0,0,0]}set(n,e,i){this.fetchUniformLocation(n,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}},o.Uniform4f=d0,o.UniformColor=h0,o.UniformMatrix2f=class extends Hs{constructor(n){super(n),this.current=oE}set(n,e,i){if(this.fetchUniformLocation(n,e)){for(let s=0;s<4;s++)if(i[s]!==this.current[s]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}}},o.UniformMatrix3f=class extends Hs{constructor(n){super(n),this.current=rE}set(n,e,i){if(this.fetchUniformLocation(n,e)){for(let s=0;s<9;s++)if(i[s]!==this.current[s]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}},o.UniformMatrix4f=class extends Hs{constructor(n){super(n),this.current=iE}set(n,e,i){if(this.fetchUniformLocation(n,e)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let s=1;s<16;s++)if(i[s]!==this.current[s]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}},o.UnwrappedTileID=gx,o.ValidationError=Rt,o.VectorTileFeature=Np,o.VectorTileWorkerSource=class extends Ro{constructor(n,e,i,s,u){super(),this.actor=n,this.layerIndex=e,this.availableImages=i,this.loadVectorData=u||w1,this.loading={},this.loaded={},this.deduped=new b1(n.scheduler),this.isSpriteLoaded=s,this.scheduler=n.scheduler}loadTile(n,e){const i=n.uid,s=n&&n.request,u=s&&s.collectResourceTiming,f=this.loading[i]=new EI(n);f.abort=this.loadVectorData(n,(g,y)=>{const T=!this.loading[i];if(delete this.loading[i],T||g||!y)return f.status="done",T||(this.loaded[i]=f),e(g);const S=y.rawData,A={};y.expires&&(A.expires=y.expires),y.cacheControl&&(A.cacheControl=y.cacheControl),f.vectorTile=y.vectorTile||new u_(new Th(S));const P=()=>{f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,(z,F)=>{if(z||!F)return e(z);const $={};if(u){const j=en(s);j.length>0&&($.resourceTiming=JSON.parse(JSON.stringify(j)))}e(null,pt({rawTileData:S.slice(0)},F,A,$))})};this.isSpriteLoaded?P():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(P,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):P()}),this.loaded=this.loaded||{},this.loaded[i]=f})}reloadTile(n,e){const i=this.loaded,s=n.uid,u=this;if(i&&i[s]){const f=i[s];f.showCollisionBoxes=n.showCollisionBoxes,f.enableTerrain=!!n.enableTerrain,f.projection=n.projection,f.tileTransform=Xl(n.tileID.canonical,n.projection);const g=(y,T)=>{const S=f.reloadCallback;S&&(delete f.reloadCallback,f.parse(f.vectorTile,u.layerIndex,this.availableImages,u.actor,S)),e(y,T)};f.status==="parsing"?f.reloadCallback=g:f.status==="done"&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,g):g())}}abortTile(n,e){const i=n.uid,s=this.loading[i];s&&(s.abort&&s.abort(),delete this.loading[i]),e()}removeTile(n,e){const i=this.loaded,s=n.uid;i&&i[s]&&delete i[s],e()}},o.WritingMode=ao,o.ZoomDependentExpression=Zs,o.add=Ys,o.addDynamicAttributes=nm,o.adjoint=function(n,e){var i=e[0],s=e[1],u=e[2],f=e[3],g=e[4],y=e[5],T=e[6],S=e[7],A=e[8];return n[0]=g*A-y*S,n[1]=u*S-s*A,n[2]=s*y-u*g,n[3]=y*T-f*A,n[4]=i*A-u*T,n[5]=u*f-i*y,n[6]=f*S-g*T,n[7]=s*T-i*S,n[8]=i*g-s*f,n},o.asyncAll=at,o.bezier=Qe,o.bindAll=xt,o.boundsAttributes=o1,o.bufferConvexPolygon=function(n,e){const i=[];for(let s=0;s<n.length;s++){const u=Pe(s-1,-1,n.length-1),f=Pe(s+1,-1,n.length-1),g=n[s],y=n[f],T=n[u].sub(g).unit(),S=y.sub(g).unit(),A=S.angleWithSep(T.x,T.y),P=T.add(S).unit().mult(-1*e/Math.sin(A/2));i.push(g.add(P))}return i},o.cacheEntryPossiblyAdded=function(n){mi++,mi>hn&&(n.getActor().send("enforceCacheSizeLimit",rn),mi=0)},o.calculateGlobeLabelMatrix=function(n,e){const{x:i,y:s}=n.point,u=L0(i,s,n.worldSize/n._pixelsPerMercatorPixel,0,0);return Nl(u,u,Wg(gs(e)))},o.calculateGlobeMatrix=function(n){const{x:e,y:i}=n.point,{lng:s,lat:u}=n._center;return L0(e,i,n.worldSize,s,u)},o.calculateGlobeMercatorMatrix=function(n){const e=n.pixelsPerMeter,i=e/Wo(1,n.center.lat),s=qo(new Float64Array(16));return nh(s,s,[n.point.x,n.point.y,0]),Ul(s,s,[i,i,e]),Float32Array.from(s)},o.circumferenceAtLatitude=Xg,o.clamp=nt,o.clearTileCache=function(n){if(!En())return;const e=w.caches.delete(wt);n&&e.catch(n).then(()=>n())},o.clipLine=Nx,o.clone=function(n){var e=new Yr(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},o.clone$1=Dn,o.collisionCircleLayout=EC,o.config=L,o.conjugate=function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n},o.create=function(){var n=new Yr(16);return Yr!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},o.create$1=p0,o.createExpression=za,o.createLayout=Ht,o.createStyleLayer=function(n){return n.type==="custom"?new gI(n):new vI[n.type](n)},o.cross=Ng,o.degToRad=Ee,o.distance=function(n,e){return Math.hypot(e[0]-n[0],e[1]-n[1],e[2]-n[2])},o.div=function(n,e,i){return n[0]=e[0]/i[0],n[1]=e[1]/i[1],n[2]=e[2]/i[2],n},o.dot=xo,o.earthRadius=hh,o.ease=ht,o.easeCubicInOut=ze,o.ecefToLatLng=function([n,e,i]){const s=Math.hypot(n,e,i),u=Math.atan2(n,i),f=.5*Math.PI-Math.acos(-e/s);return new Vn(we(u),we(f))},o.emitValidationErrors=up,o.endsWith=St,o.enforceCacheSizeLimit=function(n){Un(),Kt&&Kt.then(e=>{e.keys().then(i=>{for(let s=0;s<i.length-n;s++)e.delete(i[s])})})},o.evaluateSizeForFeature=qp,o.evaluateSizeForZoom=Eu,o.evaluateVariableOffset=Zx,o.evented=de,o.exactEquals=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]},o.exactEquals$1=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]},o.exported=Gn,o.exported$1=D,o.extend=pt,o.extend$1=Oo,o.fillExtrusionHeightLift=fx,o.filterObject=fn,o.fromMat4=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],n},o.fromQuat=function(n,e){var i=e[0],s=e[1],u=e[2],f=e[3],g=i+i,y=s+s,T=u+u,S=i*g,A=s*g,P=s*y,z=u*g,F=u*y,$=u*T,j=f*g,H=f*y,ae=f*T;return n[0]=1-P-$,n[1]=A+ae,n[2]=z-H,n[3]=0,n[4]=A-ae,n[5]=1-S-$,n[6]=F+j,n[7]=0,n[8]=z+H,n[9]=F-j,n[10]=1-S-P,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},o.fromRotation=function(n,e){var i=Math.sin(e),s=Math.cos(e);return n[0]=s,n[1]=i,n[2]=0,n[3]=-i,n[4]=s,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},o.fromScaling=g0,o.furthestTileCorner=function(n){const e=Math.round((n+45+360)%360/90)%4;return Oe[e]},o.getAABBPointSquareDist=function(n,e,i){let s=0;for(let u=0;u<2;++u){const f=i?i[u]:0;n[u]>f&&(s+=(n[u]-f)*(n[u]-f)),e[u]<f&&(s+=(f-e[u])*(f-e[u]))}return s},o.getAnchorAlignment=g_,o.getAnchorJustification=y_,o.getBounds=function(n){let e=1/0,i=1/0,s=-1/0,u=-1/0;for(const f of n)e=Math.min(e,f.x),i=Math.min(i,f.y),s=Math.max(s,f.x),u=Math.max(u,f.y);return{min:new Y(e,i),max:new Y(s,u)}},o.getColumn=Ot,o.getGridMatrix=function(n,e,i,s){const u=e.getNorth(),f=e.getSouth(),g=e.getWest(),y=e.getEast(),T=1<<n.z,S=y-g,A=u-f,P=S/Gl,z=-A/ch[i],F=[0,P,0,z,0,0,u,g,0];if(n.z>0){const $=180/s;m0(F,F,[$/S+1,0,0,0,$/A+1,0,-.5*$/P,.5*$/z,1])}return F[2]=T,F[5]=n.x,F[8]=n.y,F},o.getImage=ll,o.getJSON=function(n,e){return Pr(pt(n,{type:"json"}),e)},o.getLatitudinalLod=function(n){const e=wr-5;n=nt(n,-e,e)/e*90;const i=Math.pow(Math.abs(Math.sin(Ee(n))),3);return Math.round(i*(ch.length-1))},o.getMapSessionAPI=De,o.getPerformanceMeasurement=en,o.getProjection=e1,o.getRTLTextPluginStatus=Se,o.getReferrer=rs,o.getTilePoint=function(n,{x:e,y:i},s=0){return new Y(((e-s)*n.scale-n.x)*un,(i*n.scale-n.y)*un)},o.getTileVec3=function(n,e,i=0){return mu(((e.x-i)*n.scale-n.x)*un,(e.y*n.scale-n.y)*un,O0(e.z,e.y))},o.getVideo=function(n,e){const i=w.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let s=0;s<n.length;s++){const u=w.document.createElement("source");Ji(n[s])||(i.crossOrigin="Anonymous"),u.src=n[s],i.appendChild(u)}return{cancel:()=>{}}},o.globeCenterToScreenPoint=function(n){const e=[0,0,0],i=qo(new Float64Array(16));return Nl(i,n.pixelMatrix,n.globeMatrix),Li(e,e,i),new Y(e[0],e[1])},o.globeDenormalizeECEF=Wg,o.globeECEFOrigin=function(n,e){const i=[0,0,0];return Li(i,i,dh(gs(e.canonical))),Li(i,i,n),i},o.globeMetersToEcef=kp,o.globeNormalizeECEF=dh,o.globePixelsToTileUnits=function(n,e){return un/(512*Math.pow(2,n))*Pp(gs(e))},o.globePoleMatrixForTile=function(n,e,i){const s=qo(new Float64Array(16)),u=(e/(1<<n)-.5)*Math.PI*2;return Ap(s,i.globeMatrix,u),Float32Array.from(s)},o.globeTileBounds=gs,o.globeTiltAtLngLat=D0,o.globeToMercatorTransition=vu,o.globeUseCustomAntiAliasing=function(n,e,i){const s=vu(i.zoom),u=n.style.map._antialias,f=!!e.extStandardDerivatives,g=e.extStandardDerivativesForceOff||n.terrain&&n.terrain.exaggeration()>0;return s===0&&!u&&!g&&f},o.identity=qo,o.identity$1=S0,o.invert=Og,o.isFullscreen=function(){return!!w.document.fullscreenElement||!!w.document.webkitFullscreenElement},o.isLngLatBehindGlobe=Hg,o.isMapAuthenticated=function(n){return ke.has(n)},o.isMapboxURL=io,o.isSafariWithAntialiasingBug=function(n){const e=n.navigator?n.navigator.userAgent:null;return!!Vt(n)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.latFromMercatorY=br,o.latLngToECEF=_u,o.len=pE,o.length=ih,o.length$1=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},o.lngFromMercatorX=so,o.loadVectorTile=w1,o.makeRequest=Pr,o.mapValue=function(n,e,i,s,u){return nt((n-e)/(i-e)*(u-s)+s,s,u)},o.mercatorScale=F0,o.mercatorXfromLng=_s,o.mercatorYfromLat=vs,o.mercatorZfromAltitude=Wo,o.mul=hE,o.mul$1=fE,o.multiply=Nl,o.multiply$1=m0,o.multiply$2=y0,o.nextPowerOfTwo=At,o.normalize=Rr,o.normalize$1=mE,o.normalize$2=w0,o.number=Fn,o.ortho=function(n,e,i,s,u,f,g){var y=1/(e-i),T=1/(s-u),S=1/(f-g);return n[0]=-2*y,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*T,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*S,n[11]=0,n[12]=(e+i)*y,n[13]=(u+s)*T,n[14]=(g+f)*S,n[15]=1,n},o.pbf=Th,o.perspective=function(n,e,i,s,u){var f,g=1/Math.tan(e/2);return n[0]=g/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=g,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,u!=null&&u!==1/0?(n[10]=(u+s)*(f=1/(s-u)),n[14]=2*u*s*f):(n[10]=-1,n[14]=-2*s),n},o.pick=function(n,e){const i={};for(let s=0;s<e.length;s++){const u=e[s];u in n&&(i[u]=n[u])}return i},o.plugin=Ae,o.pointGeometry=Y,o.polesInViewport=function(n){const e=qo(new Float64Array(16));Nl(e,n.pixelMatrix,n.globeMatrix);const i=[0,bo,0],s=[0,wo,0];return Li(i,i,e),Li(s,s,e),[i[0]>0&&i[0]<=n.width&&i[1]>0&&i[1]<=n.height&&!Hg(n,new Vn(n.center.lat,90)),s[0]>0&&s[0]<=n.width&&s[1]>0&&s[1]<=n.height&&!Hg(n,new Vn(n.center.lat,-90))]},o.polygonContainsPoint=Wl,o.polygonIntersectsBox=q0,o.polygonIntersectsPolygon=N0,o.polygonizeBounds=function(n,e,i=0,s=!0){const u=new Y(i,i),f=n.sub(u),g=e.add(u),y=[f,new Y(g.x,f.y),g,new Y(f.x,g.y)];return s&&y.push(f.clone()),y},o.posAttributes=lh,o.postMapLoadEvent=re,o.postPerformanceEvent=Ce,o.postTurnstileEvent=N,o.potpack=f_,o.prevPowerOfTwo=function(n){return n<=1?1:Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},o.radToDeg=we,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.registerForPluginStateChange=function(n){return n({pluginStatus:te,pluginURL:Z}),de.on("pluginStateChange",n),n},o.removeAuthState=function(n){ke.delete(n)},o.renderColorRamp=i_,o.resample=V0,o.rotateX=Fg,o.rotateX$1=E0,o.rotateY=Ap,o.rotateY$1=C0,o.rotateZ=function(n,e,i){var s=Math.sin(i),u=Math.cos(i),f=e[0],g=e[1],y=e[2],T=e[3],S=e[4],A=e[5],P=e[6],z=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=f*u+S*s,n[1]=g*u+A*s,n[2]=y*u+P*s,n[3]=T*u+z*s,n[4]=S*u-f*s,n[5]=A*u-g*s,n[6]=P*u-y*s,n[7]=z*u-T*s,n},o.rotateZ$1=function(n,e,i){i*=.5;var s=e[0],u=e[1],f=e[2],g=e[3],y=Math.sin(i),T=Math.cos(i);return n[0]=s*T+u*y,n[1]=u*T-s*y,n[2]=f*T+g*y,n[3]=g*T-f*y,n},o.scale=Ul,o.scale$1=b0,o.scale$2=oo,o.scaleAndAdd=sh,o.set=function(n,e,i,s){return n[0]=e,n[1]=i,n[2]=s,n},o.setCacheLimits=function(n,e){rn=n,hn=e},o.setColumn=function(n,e,i){n[4*e+0]=i[0],n[4*e+1]=i[1],n[4*e+2]=i[2],n[4*e+3]=i[3]},o.setRTLTextPlugin=function(n,e,i=!1){if(te===W||te===J||te===K)throw new Error("setRTLTextPlugin cannot be called multiple times.");Z=Gn.resolveURL(n),te=W,Q=e,se(),i||be()},o.smoothstep=ft,o.spec=et,o.squaredLength=function(n){var e=n[0],i=n[1],s=n[2];return e*e+i*i+s*s},o.storeAuthState=function(n,e){e?ke.add(n):ke.delete(n)},o.sub=Zo,o.subtract=$g,o.symbolSize=CC,o.tileAABB=function(n,e,i,s,u,f,g,y,T){if(T.name==="globe")return yE(n,e,new jp(i,s,u));const S=Xl({z:i,x:s,y:u},T);return new Or([(f+S.x/S.scale)*e,e*(S.y/S.scale),g],[(f+S.x2/S.scale)*e,e*(S.y2/S.scale),y])},o.tileCornersToBounds=Mp,o.tileTransform=Xl,o.transformMat3=function(n,e,i){var s=e[0],u=e[1],f=e[2];return n[0]=s*i[0]+u*i[3]+f*i[6],n[1]=s*i[1]+u*i[4]+f*i[7],n[2]=s*i[2]+u*i[5]+f*i[8],n},o.transformMat4=Li,o.transformMat4$1=jl,o.transformQuat=x0,o.transitionTileAABBinECEF=M0,o.translate=nh,o.transpose=function(n,e){if(n===e){var i=e[1],s=e[2],u=e[5];n[1]=e[3],n[2]=e[6],n[3]=i,n[5]=e[7],n[6]=s,n[7]=u}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8];return n},o.triggerPluginCompletionEvent=le,o.uniqueId=Gt,o.updateGlobeVertexNormal=function(n,e,i,s,u){const f=5*e+2;n.float32[f+0]=i,n.float32[f+1]=s,n.float32[f+2]=u},o.validateCustomStyleLayer=function(n){const e=[],i=n.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),n.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},o.validateFilter=n=>$o(Zd(n)),o.validateFog=n=>$o(ap(n)),o.validateLayer=n=>$o(Hd(n)),o.validateLight=n=>$o(sp(n)),o.validateSource=n=>$o(zl(n)),o.validateStyle=lp,o.validateTerrain=n=>$o(Xd(n)),o.values=jt,o.vectorTile=$p,o.version=C,o.warnOnce=ue,o.window=w,o.wrap=Pe}),v(["./shared"],function(o){function w(oe){if(typeof oe=="number"||typeof oe=="boolean"||typeof oe=="string"||oe==null)return JSON.stringify(oe);if(Array.isArray(oe)){let G="[";for(const re of oe)G+=`${w(re)},`;return`${G}]`}let N="{";for(const G of Object.keys(oe).sort())N+=`${G}:${w(oe[G])},`;return`${N}}`}function C(oe){let N="";for(const G of o.refProperties)N+=`/${w(oe[G])}`;return N}class M{constructor(N){this.keyCache={},N&&this.replace(N)}replace(N){this._layerConfigs={},this._layers={},this.update(N,[])}update(N,G){for(const he of N)this._layerConfigs[he.id]=he,(this._layers[he.id]=o.createStyleLayer(he)).compileFilter(),this.keyCache[he.id]&&delete this.keyCache[he.id];for(const he of G)delete this.keyCache[he],delete this._layerConfigs[he],delete this._layers[he];this.familiesBySource={};const re=function(he,Ce){const Re={};for(let ke=0;ke<he.length;ke++){const Ve=Ce&&Ce[he[ke].id]||C(he[ke]);Ce&&(Ce[he[ke].id]=Ve);let ct=Re[Ve];ct||(ct=Re[Ve]=[]),ct.push(he[ke])}const De=[];for(const ke in Re)De.push(Re[ke]);return De}(o.values(this._layerConfigs),this.keyCache);for(const he of re){const Ce=he.map(Bt=>this._layers[Bt.id]),Re=Ce[0];if(Re.visibility==="none")continue;const De=Re.source||"";let ke=this.familiesBySource[De];ke||(ke=this.familiesBySource[De]={});const Ve=Re.sourceLayer||"_geojsonTileLayer";let ct=ke[Ve];ct||(ct=ke[Ve]=[]),ct.push(Ce)}}}class L{loadTile(N,G){const{uid:re,encoding:he,rawImageData:Ce,padding:Re,buildQuadTree:De}=N,ke=o.window.ImageBitmap&&Ce instanceof o.window.ImageBitmap?this.getImageData(Ce,Re):Ce;G(null,new o.DEMData(re,ke,he,Re<1,De))}getImageData(N,G){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(N.width,N.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=N.width,this.offscreenCanvas.height=N.height,this.offscreenCanvasContext.drawImage(N,0,0,N.width,N.height);const re=this.offscreenCanvasContext.getImageData(-G,-G,N.width+2*G,N.height+2*G);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),re}}var D=function oe(N,G){var re,he=N&&N.type;if(he==="FeatureCollection")for(re=0;re<N.features.length;re++)oe(N.features[re],G);else if(he==="GeometryCollection")for(re=0;re<N.geometries.length;re++)oe(N.geometries[re],G);else if(he==="Feature")oe(N.geometry,G);else if(he==="Polygon")V(N.coordinates,G);else if(he==="MultiPolygon")for(re=0;re<N.coordinates.length;re++)V(N.coordinates[re],G);return N};function V(oe,N){if(oe.length!==0){q(oe[0],N);for(var G=1;G<oe.length;G++)q(oe[G],!N)}}function q(oe,N){for(var G=0,re=0,he=0,Ce=oe.length,Re=Ce-1;he<Ce;Re=he++){var De=(oe[he][0]-oe[Re][0])*(oe[Re][1]+oe[he][1]),ke=G+De;re+=Math.abs(G)>=Math.abs(De)?G-ke+De:De-ke+G,G=ke}G+re>=0!=!!N&&oe.reverse()}const X=o.VectorTileFeature.prototype.toGeoJSON;class xe{constructor(N){this._feature=N,this.extent=o.EXTENT,this.type=N.type,this.properties=N.tags,"id"in N&&!isNaN(N.id)&&(this.id=parseInt(N.id,10))}loadGeometry(){if(this._feature.type===1){const N=[];for(const G of this._feature.geometry)N.push([new o.pointGeometry(G[0],G[1])]);return N}{const N=[];for(const G of this._feature.geometry){const re=[];for(const he of G)re.push(new o.pointGeometry(he[0],he[1]));N.push(re)}return N}}toGeoJSON(N,G,re){return X.call(this,N,G,re)}}class ce{constructor(N){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=N.length,this._features=N}feature(N){return new xe(this._features[N])}}var me={},ee={get exports(){return me},set exports(oe){me=oe}},Ie=o.pointGeometry,Y=o.vectorTile.VectorTileFeature,ve=fe;function fe(oe,N){this.options=N||{},this.features=oe,this.length=oe.length}function ge(oe,N){this.id=typeof oe.id=="number"?oe.id:void 0,this.type=oe.type,this.rawGeometry=oe.type===1?[oe.geometry]:oe.geometry,this.properties=oe.tags,this.extent=N||4096}fe.prototype.feature=function(oe){return new ge(this.features[oe],this.options.extent)},ge.prototype.loadGeometry=function(){var oe=this.rawGeometry;this.geometry=[];for(var N=0;N<oe.length;N++){for(var G=oe[N],re=[],he=0;he<G.length;he++)re.push(new Ie(G[he][0],G[he][1]));this.geometry.push(re)}return this.geometry},ge.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var oe=this.geometry,N=1/0,G=-1/0,re=1/0,he=-1/0,Ce=0;Ce<oe.length;Ce++)for(var Re=oe[Ce],De=0;De<Re.length;De++){var ke=Re[De];N=Math.min(N,ke.x),G=Math.max(G,ke.x),re=Math.min(re,ke.y),he=Math.max(he,ke.y)}return[N,re,G,he]},ge.prototype.toGeoJSON=Y.prototype.toGeoJSON;var Ee=o.pbf,we=ve;function Oe(oe){var N=new Ee;return function(G,re){for(var he in G.layers)re.writeMessage(3,ze,G.layers[he])}(oe,N),N.finish()}function ze(oe,N){var G;N.writeVarintField(15,oe.version||1),N.writeStringField(1,oe.name||""),N.writeVarintField(5,oe.extent||4096);var re={keys:[],values:[],keycache:{},valuecache:{}};for(G=0;G<oe.length;G++)re.feature=oe.feature(G),N.writeMessage(2,Qe,re);var he=re.keys;for(G=0;G<he.length;G++)N.writeStringField(3,he[G]);var Ce=re.values;for(G=0;G<Ce.length;G++)N.writeMessage(4,at,Ce[G])}function Qe(oe,N){var G=oe.feature;G.id!==void 0&&N.writeVarintField(1,G.id),N.writeMessage(2,ht,oe),N.writeVarintField(3,G.type),N.writeMessage(4,Pe,G)}function ht(oe,N){var G=oe.feature,re=oe.keys,he=oe.values,Ce=oe.keycache,Re=oe.valuecache;for(var De in G.properties){var ke=G.properties[De],Ve=Ce[De];if(ke!==null){Ve===void 0&&(re.push(De),Ce[De]=Ve=re.length-1),N.writeVarint(Ve);var ct=typeof ke;ct!=="string"&&ct!=="boolean"&&ct!=="number"&&(ke=JSON.stringify(ke));var Bt=ct+":"+ke,gt=Re[Bt];gt===void 0&&(he.push(ke),Re[Bt]=gt=he.length-1),N.writeVarint(gt)}}}function nt(oe,N){return(N<<3)+(7&oe)}function ft(oe){return oe<<1^oe>>31}function Pe(oe,N){for(var G=oe.loadGeometry(),re=oe.type,he=0,Ce=0,Re=G.length,De=0;De<Re;De++){var ke=G[De],Ve=1;re===1&&(Ve=ke.length),N.writeVarint(nt(1,Ve));for(var ct=re===3?ke.length-1:ke.length,Bt=0;Bt<ct;Bt++){Bt===1&&re!==1&&N.writeVarint(nt(2,ct-1));var gt=ke[Bt].x-he,en=ke[Bt].y-Ce;N.writeVarint(ft(gt)),N.writeVarint(ft(en)),he+=gt,Ce+=en}re===3&&N.writeVarint(nt(7,1))}}function at(oe,N){var G=typeof oe;G==="string"?N.writeStringField(1,oe):G==="boolean"?N.writeBooleanField(7,oe):G==="number"&&(oe%1!=0?N.writeDoubleField(3,oe):oe<0?N.writeSVarintField(6,oe):N.writeVarintField(5,oe))}function jt(oe,N,G,re,he,Ce){if(he-re<=G)return;const Re=re+he>>1;pt(oe,N,Re,re,he,Ce%2),jt(oe,N,G,re,Re-1,Ce+1),jt(oe,N,G,Re+1,he,Ce+1)}function pt(oe,N,G,re,he,Ce){for(;he>re;){if(he-re>600){const Ve=he-re+1,ct=G-re+1,Bt=Math.log(Ve),gt=.5*Math.exp(2*Bt/3),en=.5*Math.sqrt(Bt*gt*(Ve-gt)/Ve)*(ct-Ve/2<0?-1:1);pt(oe,N,G,Math.max(re,Math.floor(G-ct*gt/Ve+en)),Math.min(he,Math.floor(G+(Ve-ct)*gt/Ve+en)),Ce)}const Re=N[2*G+Ce];let De=re,ke=he;for(zt(oe,N,re,G),N[2*he+Ce]>Re&&zt(oe,N,re,he);De<ke;){for(zt(oe,N,De,ke),De++,ke--;N[2*De+Ce]<Re;)De++;for(;N[2*ke+Ce]>Re;)ke--}N[2*re+Ce]===Re?zt(oe,N,re,ke):(ke++,zt(oe,N,ke,he)),ke<=G&&(re=ke+1),G<=ke&&(he=ke-1)}}function zt(oe,N,G,re){Gt(oe,G,re),Gt(N,2*G,2*re),Gt(N,2*G+1,2*re+1)}function Gt(oe,N,G){const re=oe[N];oe[N]=oe[G],oe[G]=re}function zn(oe,N,G,re){const he=oe-G,Ce=N-re;return he*he+Ce*Ce}ee.exports=Oe,me.fromVectorTileJs=Oe,me.fromGeojsonVt=function(oe,N){N=N||{};var G={};for(var re in oe)G[re]=new we(oe[re].features,N),G[re].name=re,G[re].version=N.version,G[re].extent=N.extent;return Oe({layers:G})},me.GeoJSONWrapper=we;const At=oe=>oe[0],Ke=oe=>oe[1];class xt{constructor(N,G=At,re=Ke,he=64,Ce=Float64Array){this.nodeSize=he,this.points=N;const Re=N.length<65536?Uint16Array:Uint32Array,De=this.ids=new Re(N.length),ke=this.coords=new Ce(2*N.length);for(let Ve=0;Ve<N.length;Ve++)De[Ve]=Ve,ke[2*Ve]=G(N[Ve]),ke[2*Ve+1]=re(N[Ve]);jt(De,ke,he,0,De.length-1,0)}range(N,G,re,he){return function(Ce,Re,De,ke,Ve,ct,Bt){const gt=[0,Ce.length-1,0],en=[];let Jt,Yt;for(;gt.length;){const cn=gt.pop(),_n=gt.pop(),Gn=gt.pop();if(_n-Gn<=Bt){for(let Qn=Gn;Qn<=_n;Qn++)Jt=Re[2*Qn],Yt=Re[2*Qn+1],Jt>=De&&Jt<=Ve&&Yt>=ke&&Yt<=ct&&en.push(Ce[Qn]);continue}const on=Math.floor((Gn+_n)/2);Jt=Re[2*on],Yt=Re[2*on+1],Jt>=De&&Jt<=Ve&&Yt>=ke&&Yt<=ct&&en.push(Ce[on]);const Jn=(cn+1)%2;(cn===0?De<=Jt:ke<=Yt)&&(gt.push(Gn),gt.push(on-1),gt.push(Jn)),(cn===0?Ve>=Jt:ct>=Yt)&&(gt.push(on+1),gt.push(_n),gt.push(Jn))}return en}(this.ids,this.coords,N,G,re,he,this.nodeSize)}within(N,G,re){return function(he,Ce,Re,De,ke,Ve){const ct=[0,he.length-1,0],Bt=[],gt=ke*ke;for(;ct.length;){const en=ct.pop(),Jt=ct.pop(),Yt=ct.pop();if(Jt-Yt<=Ve){for(let Jn=Yt;Jn<=Jt;Jn++)zn(Ce[2*Jn],Ce[2*Jn+1],Re,De)<=gt&&Bt.push(he[Jn]);continue}const cn=Math.floor((Yt+Jt)/2),_n=Ce[2*cn],Gn=Ce[2*cn+1];zn(_n,Gn,Re,De)<=gt&&Bt.push(he[cn]);const on=(en+1)%2;(en===0?Re-ke<=_n:De-ke<=Gn)&&(ct.push(Yt),ct.push(cn-1),ct.push(on)),(en===0?Re+ke>=_n:De+ke>=Gn)&&(ct.push(cn+1),ct.push(Jt),ct.push(on))}return Bt}(this.ids,this.coords,N,G,re,this.nodeSize)}}const St={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:oe=>oe},Nt=Math.fround||(fn=new Float32Array(1),oe=>(fn[0]=+oe,fn[0]));var fn;class Dn{constructor(N){this.options=Vt(Object.create(St),N),this.trees=new Array(this.options.maxZoom+1)}load(N){const{log:G,minZoom:re,maxZoom:he,nodeSize:Ce}=this.options;G&&console.time("total time");const Re=`prepare ${N.length} points`;G&&console.time(Re),this.points=N;let De=[];for(let ke=0;ke<N.length;ke++)N[ke].geometry&&De.push(ue(N[ke],ke));this.trees[he+1]=new xt(De,Mt,Ot,Ce,Float32Array),G&&console.timeEnd(Re);for(let ke=he;ke>=re;ke--){const Ve=+Date.now();De=this._cluster(De,ke),this.trees[ke]=new xt(De,Mt,Ot,Ce,Float32Array),G&&console.log("z%d: %d clusters in %dms",ke,De.length,+Date.now()-Ve)}return G&&console.timeEnd("total time"),this}getClusters(N,G){let re=((N[0]+180)%360+360)%360-180;const he=Math.max(-90,Math.min(90,N[1]));let Ce=N[2]===180?180:((N[2]+180)%360+360)%360-180;const Re=Math.max(-90,Math.min(90,N[3]));if(N[2]-N[0]>=360)re=-180,Ce=180;else if(re>Ce){const ct=this.getClusters([re,he,180,Re],G),Bt=this.getClusters([-180,he,Ce,Re],G);return ct.concat(Bt)}const De=this.trees[this._limitZoom(G)],ke=De.range(st(re),yt(Re),st(Ce),yt(he)),Ve=[];for(const ct of ke){const Bt=De.points[ct];Ve.push(Bt.numPoints?Me(Bt):this.points[Bt.index])}return Ve}getChildren(N){const G=this._getOriginId(N),re=this._getOriginZoom(N),he="No cluster with the specified id.",Ce=this.trees[re];if(!Ce)throw new Error(he);const Re=Ce.points[G];if(!Re)throw new Error(he);const De=this.options.radius/(this.options.extent*Math.pow(2,re-1)),ke=Ce.within(Re.x,Re.y,De),Ve=[];for(const ct of ke){const Bt=Ce.points[ct];Bt.parentId===N&&Ve.push(Bt.numPoints?Me(Bt):this.points[Bt.index])}if(Ve.length===0)throw new Error(he);return Ve}getLeaves(N,G,re){const he=[];return this._appendLeaves(he,N,G=G||10,re=re||0,0),he}getTile(N,G,re){const he=this.trees[this._limitZoom(N)],Ce=Math.pow(2,N),{extent:Re,radius:De}=this.options,ke=De/Re,Ve=(re-ke)/Ce,ct=(re+1+ke)/Ce,Bt={features:[]};return this._addTileFeatures(he.range((G-ke)/Ce,Ve,(G+1+ke)/Ce,ct),he.points,G,re,Ce,Bt),G===0&&this._addTileFeatures(he.range(1-ke/Ce,Ve,1,ct),he.points,Ce,re,Ce,Bt),G===Ce-1&&this._addTileFeatures(he.range(0,Ve,ke/Ce,ct),he.points,-1,re,Ce,Bt),Bt.features.length?Bt:null}getClusterExpansionZoom(N){let G=this._getOriginZoom(N)-1;for(;G<=this.options.maxZoom;){const re=this.getChildren(N);if(G++,re.length!==1)break;N=re[0].properties.cluster_id}return G}_appendLeaves(N,G,re,he,Ce){const Re=this.getChildren(G);for(const De of Re){const ke=De.properties;if(ke&&ke.cluster?Ce+ke.point_count<=he?Ce+=ke.point_count:Ce=this._appendLeaves(N,ke.cluster_id,re,he,Ce):Ce<he?Ce++:N.push(De),N.length===re)break}return Ce}_addTileFeatures(N,G,re,he,Ce,Re){for(const De of N){const ke=G[De],Ve=ke.numPoints;let ct,Bt,gt;if(Ve)ct=qe(ke),Bt=ke.x,gt=ke.y;else{const Yt=this.points[ke.index];ct=Yt.properties,Bt=st(Yt.geometry.coordinates[0]),gt=yt(Yt.geometry.coordinates[1])}const en={type:1,geometry:[[Math.round(this.options.extent*(Bt*Ce-re)),Math.round(this.options.extent*(gt*Ce-he))]],tags:ct};let Jt;Ve?Jt=ke.id:this.options.generateId?Jt=ke.index:this.points[ke.index].id&&(Jt=this.points[ke.index].id),Jt!==void 0&&(en.id=Jt),Re.features.push(en)}}_limitZoom(N){return Math.max(this.options.minZoom,Math.min(Math.floor(+N),this.options.maxZoom+1))}_cluster(N,G){const re=[],{radius:he,extent:Ce,reduce:Re,minPoints:De}=this.options,ke=he/(Ce*Math.pow(2,G));for(let Ve=0;Ve<N.length;Ve++){const ct=N[Ve];if(ct.zoom<=G)continue;ct.zoom=G;const Bt=this.trees[G+1],gt=Bt.within(ct.x,ct.y,ke),en=ct.numPoints||1;let Jt=en;for(const Yt of gt){const cn=Bt.points[Yt];cn.zoom>G&&(Jt+=cn.numPoints||1)}if(Jt>en&&Jt>=De){let Yt=ct.x*en,cn=ct.y*en,_n=Re&&en>1?this._map(ct,!0):null;const Gn=(Ve<<5)+(G+1)+this.points.length;for(const on of gt){const Jn=Bt.points[on];if(Jn.zoom<=G)continue;Jn.zoom=G;const Qn=Jn.numPoints||1;Yt+=Jn.x*Qn,cn+=Jn.y*Qn,Jn.parentId=Gn,Re&&(_n||(_n=this._map(ct,!0)),Re(_n,this._map(Jn)))}ct.parentId=Gn,re.push(gn(Yt/Jt,cn/Jt,Gn,Jt,_n))}else if(re.push(ct),Jt>1)for(const Yt of gt){const cn=Bt.points[Yt];cn.zoom<=G||(cn.zoom=G,re.push(cn))}}return re}_getOriginId(N){return N-this.points.length>>5}_getOriginZoom(N){return(N-this.points.length)%32}_map(N,G){if(N.numPoints)return G?Vt({},N.properties):N.properties;const re=this.points[N.index].properties,he=this.options.map(re);return G&&he===re?Vt({},he):he}}function gn(oe,N,G,re,he){return{x:Nt(oe),y:Nt(N),zoom:1/0,id:G,parentId:-1,numPoints:re,properties:he}}function ue(oe,N){const[G,re]=oe.geometry.coordinates;return{x:Nt(st(G)),y:Nt(yt(re)),zoom:1/0,index:N,parentId:-1}}function Me(oe){return{type:"Feature",id:oe.id,properties:qe(oe),geometry:{type:"Point",coordinates:[(N=oe.x,360*(N-.5)),Lt(oe.y)]}};var N}function qe(oe){const N=oe.numPoints,G=N>=1e4?`${Math.round(N/1e3)}k`:N>=1e3?Math.round(N/100)/10+"k":N;return Vt(Vt({},oe.properties),{cluster:!0,cluster_id:oe.id,point_count:N,point_count_abbreviated:G})}function st(oe){return oe/360+.5}function yt(oe){const N=Math.sin(oe*Math.PI/180),G=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return G<0?0:G>1?1:G}function Lt(oe){const N=(180-360*oe)*Math.PI/180;return 360*Math.atan(Math.exp(N))/Math.PI-90}function Vt(oe,N){for(const G in N)oe[G]=N[G];return oe}function Mt(oe){return oe.x}function Ot(oe){return oe.y}function wt(oe,N,G,re){for(var he,Ce=re,Re=G-N>>1,De=G-N,ke=oe[N],Ve=oe[N+1],ct=oe[G],Bt=oe[G+1],gt=N+3;gt<G;gt+=3){var en=Kt(oe[gt],oe[gt+1],ke,Ve,ct,Bt);if(en>Ce)he=gt,Ce=en;else if(en===Ce){var Jt=Math.abs(gt-Re);Jt<De&&(he=gt,De=Jt)}}Ce>re&&(he-N>3&&wt(oe,N,he,re),oe[he+2]=Ce,G-he>3&&wt(oe,he,G,re))}function Kt(oe,N,G,re,he,Ce){var Re=he-G,De=Ce-re;if(Re!==0||De!==0){var ke=((oe-G)*Re+(N-re)*De)/(Re*Re+De*De);ke>1?(G=he,re=Ce):ke>0&&(G+=Re*ke,re+=De*ke)}return(Re=oe-G)*Re+(De=N-re)*De}function Zt(oe,N,G,re){var he={id:oe===void 0?null:oe,type:N,geometry:G,tags:re,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ce){var Re=Ce.geometry,De=Ce.type;if(De==="Point"||De==="MultiPoint"||De==="LineString")rn(Ce,Re);else if(De==="Polygon"||De==="MultiLineString")for(var ke=0;ke<Re.length;ke++)rn(Ce,Re[ke]);else if(De==="MultiPolygon")for(ke=0;ke<Re.length;ke++)for(var Ve=0;Ve<Re[ke].length;Ve++)rn(Ce,Re[ke][Ve])}(he),he}function rn(oe,N){for(var G=0;G<N.length;G+=3)oe.minX=Math.min(oe.minX,N[G]),oe.minY=Math.min(oe.minY,N[G+1]),oe.maxX=Math.max(oe.maxX,N[G]),oe.maxY=Math.max(oe.maxY,N[G+1])}function hn(oe,N,G,re){if(N.geometry){var he=N.geometry.coordinates,Ce=N.geometry.type,Re=Math.pow(G.tolerance/((1<<G.maxZoom)*G.extent),2),De=[],ke=N.id;if(G.promoteId?ke=N.properties[G.promoteId]:G.generateId&&(ke=re||0),Ce==="Point")En(he,De);else if(Ce==="MultiPoint")for(var Ve=0;Ve<he.length;Ve++)En(he[Ve],De);else if(Ce==="LineString")Un(he,De,Re,!1);else if(Ce==="MultiLineString"){if(G.lineMetrics){for(Ve=0;Ve<he.length;Ve++)Un(he[Ve],De=[],Re,!1),oe.push(Zt(ke,"LineString",De,N.properties));return}jn(he,De,Re,!1)}else if(Ce==="Polygon")jn(he,De,Re,!0);else{if(Ce!=="MultiPolygon"){if(Ce==="GeometryCollection"){for(Ve=0;Ve<N.geometry.geometries.length;Ve++)hn(oe,{id:ke,geometry:N.geometry.geometries[Ve],properties:N.properties},G,re);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ve=0;Ve<he.length;Ve++){var ct=[];jn(he[Ve],ct,Re,!0),De.push(ct)}}oe.push(Zt(ke,Ce,De,N.properties))}}function En(oe,N){N.push(mi(oe[0])),N.push(tr(oe[1])),N.push(0)}function Un(oe,N,G,re){for(var he,Ce,Re=0,De=0;De<oe.length;De++){var ke=mi(oe[De][0]),Ve=tr(oe[De][1]);N.push(ke),N.push(Ve),N.push(0),De>0&&(Re+=re?(he*Ve-ke*Ce)/2:Math.sqrt(Math.pow(ke-he,2)+Math.pow(Ve-Ce,2))),he=ke,Ce=Ve}var ct=N.length-3;N[2]=1,wt(N,0,ct,G),N[ct+2]=1,N.size=Math.abs(Re),N.start=0,N.end=N.size}function jn(oe,N,G,re){for(var he=0;he<oe.length;he++){var Ce=[];Un(oe[he],Ce,G,re),N.push(Ce)}}function mi(oe){return oe/360+.5}function tr(oe){var N=Math.sin(oe*Math.PI/180),G=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return G<0?0:G>1?1:G}function Wi(oe,N,G,re,he,Ce,Re,De){if(re/=N,Ce>=(G/=N)&&Re<re)return oe;if(Re<G||Ce>=re)return null;for(var ke=[],Ve=0;Ve<oe.length;Ve++){var ct=oe[Ve],Bt=ct.geometry,gt=ct.type,en=he===0?ct.minX:ct.minY,Jt=he===0?ct.maxX:ct.maxY;if(en>=G&&Jt<re)ke.push(ct);else if(!(Jt<G||en>=re)){var Yt=[];if(gt==="Point"||gt==="MultiPoint")rs(Bt,Yt,G,re,he);else if(gt==="LineString")Pr(Bt,Yt,G,re,he,!1,De.lineMetrics);else if(gt==="MultiLineString")Ji(Bt,Yt,G,re,he,!1);else if(gt==="Polygon")Ji(Bt,Yt,G,re,he,!0);else if(gt==="MultiPolygon")for(var cn=0;cn<Bt.length;cn++){var _n=[];Ji(Bt[cn],_n,G,re,he,!0),_n.length&&Yt.push(_n)}if(Yt.length){if(De.lineMetrics&&gt==="LineString"){for(cn=0;cn<Yt.length;cn++)ke.push(Zt(ct.id,gt,Yt[cn],ct.tags));continue}gt!=="LineString"&&gt!=="MultiLineString"||(Yt.length===1?(gt="LineString",Yt=Yt[0]):gt="MultiLineString"),gt!=="Point"&&gt!=="MultiPoint"||(gt=Yt.length===3?"Point":"MultiPoint"),ke.push(Zt(ct.id,gt,Yt,ct.tags))}}}return ke.length?ke:null}function rs(oe,N,G,re,he){for(var Ce=0;Ce<oe.length;Ce+=3){var Re=oe[Ce+he];Re>=G&&Re<=re&&(N.push(oe[Ce]),N.push(oe[Ce+1]),N.push(oe[Ce+2]))}}function Pr(oe,N,G,re,he,Ce,Re){for(var De,ke,Ve=mo(oe),ct=he===0?Bo:Bs,Bt=oe.start,gt=0;gt<oe.length-3;gt+=3){var en=oe[gt],Jt=oe[gt+1],Yt=oe[gt+2],cn=oe[gt+3],_n=oe[gt+4],Gn=he===0?en:Jt,on=he===0?cn:_n,Jn=!1;Re&&(De=Math.sqrt(Math.pow(en-cn,2)+Math.pow(Jt-_n,2))),Gn<G?on>G&&(ke=ct(Ve,en,Jt,cn,_n,G),Re&&(Ve.start=Bt+De*ke)):Gn>re?on<re&&(ke=ct(Ve,en,Jt,cn,_n,re),Re&&(Ve.start=Bt+De*ke)):ar(Ve,en,Jt,Yt),on<G&&Gn>=G&&(ke=ct(Ve,en,Jt,cn,_n,G),Jn=!0),on>re&&Gn<=re&&(ke=ct(Ve,en,Jt,cn,_n,re),Jn=!0),!Ce&&Jn&&(Re&&(Ve.end=Bt+De*ke),N.push(Ve),Ve=mo(oe)),Re&&(Bt+=De)}var Qn=oe.length-3;en=oe[Qn],Jt=oe[Qn+1],Yt=oe[Qn+2],(Gn=he===0?en:Jt)>=G&&Gn<=re&&ar(Ve,en,Jt,Yt),Qn=Ve.length-3,Ce&&Qn>=3&&(Ve[Qn]!==Ve[0]||Ve[Qn+1]!==Ve[1])&&ar(Ve,Ve[0],Ve[1],Ve[2]),Ve.length&&N.push(Ve)}function mo(oe){var N=[];return N.size=oe.size,N.start=oe.start,N.end=oe.end,N}function Ji(oe,N,G,re,he,Ce){for(var Re=0;Re<oe.length;Re++)Pr(oe[Re],N,G,re,he,Ce,!1)}function ar(oe,N,G,re){oe.push(N),oe.push(G),oe.push(re)}function Bo(oe,N,G,re,he,Ce){var Re=(Ce-N)/(re-N);return oe.push(Ce),oe.push(G+(he-G)*Re),oe.push(1),Re}function Bs(oe,N,G,re,he,Ce){var Re=(Ce-G)/(he-G);return oe.push(N+(re-N)*Re),oe.push(Ce),oe.push(1),Re}function ll(oe,N){for(var G=[],re=0;re<oe.length;re++){var he,Ce=oe[re],Re=Ce.type;if(Re==="Point"||Re==="MultiPoint"||Re==="LineString")he=Rs(Ce.geometry,N);else if(Re==="MultiLineString"||Re==="Polygon"){he=[];for(var De=0;De<Ce.geometry.length;De++)he.push(Rs(Ce.geometry[De],N))}else if(Re==="MultiPolygon")for(he=[],De=0;De<Ce.geometry.length;De++){for(var ke=[],Ve=0;Ve<Ce.geometry[De].length;Ve++)ke.push(Rs(Ce.geometry[De][Ve],N));he.push(ke)}G.push(Zt(Ce.id,Re,he,Ce.tags))}return G}function Rs(oe,N){var G=[];G.size=oe.size,oe.start!==void 0&&(G.start=oe.start,G.end=oe.end);for(var re=0;re<oe.length;re+=3)G.push(oe[re]+N,oe[re+1],oe[re+2]);return G}function io(oe,N){if(oe.transformed)return oe;var G,re,he,Ce=1<<oe.z,Re=oe.x,De=oe.y;for(G=0;G<oe.features.length;G++){var ke=oe.features[G],Ve=ke.geometry,ct=ke.type;if(ke.geometry=[],ct===1)for(re=0;re<Ve.length;re+=2)ke.geometry.push(Os(Ve[re],Ve[re+1],N,Ce,Re,De));else for(re=0;re<Ve.length;re++){var Bt=[];for(he=0;he<Ve[re].length;he+=2)Bt.push(Os(Ve[re][he],Ve[re][he+1],N,Ce,Re,De));ke.geometry.push(Bt)}}return oe.transformed=!0,oe}function Os(oe,N,G,re,he,Ce){return[Math.round(G*(oe*re-he)),Math.round(G*(N*re-Ce))]}function Mc(oe,N,G,re,he){for(var Ce=N===he.maxZoom?0:he.tolerance/((1<<N)*he.extent),Re={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:G,y:re,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},De=0;De<oe.length;De++){Re.numFeatures++,Pc(Re,oe[De],Ce,he);var ke=oe[De].minX,Ve=oe[De].minY,ct=oe[De].maxX,Bt=oe[De].maxY;ke<Re.minX&&(Re.minX=ke),Ve<Re.minY&&(Re.minY=Ve),ct>Re.maxX&&(Re.maxX=ct),Bt>Re.maxY&&(Re.maxY=Bt)}return Re}function Pc(oe,N,G,re){var he=N.geometry,Ce=N.type,Re=[];if(Ce==="Point"||Ce==="MultiPoint")for(var De=0;De<he.length;De+=3)Re.push(he[De]),Re.push(he[De+1]),oe.numPoints++,oe.numSimplified++;else if(Ce==="LineString")_a(Re,he,oe,G,!1,!1);else if(Ce==="MultiLineString"||Ce==="Polygon")for(De=0;De<he.length;De++)_a(Re,he[De],oe,G,Ce==="Polygon",De===0);else if(Ce==="MultiPolygon")for(var ke=0;ke<he.length;ke++){var Ve=he[ke];for(De=0;De<Ve.length;De++)_a(Re,Ve[De],oe,G,!0,De===0)}if(Re.length){var ct=N.tags||null;if(Ce==="LineString"&&re.lineMetrics){for(var Bt in ct={},N.tags)ct[Bt]=N.tags[Bt];ct.mapbox_clip_start=he.start/he.size,ct.mapbox_clip_end=he.end/he.size}var gt={geometry:Re,type:Ce==="Polygon"||Ce==="MultiPolygon"?3:Ce==="LineString"||Ce==="MultiLineString"?2:1,tags:ct};N.id!==null&&(gt.id=N.id),oe.features.push(gt)}}function _a(oe,N,G,re,he,Ce){var Re=re*re;if(re>0&&N.size<(he?Re:re))G.numPoints+=N.length/3;else{for(var De=[],ke=0;ke<N.length;ke+=3)(re===0||N[ke+2]>Re)&&(G.numSimplified++,De.push(N[ke]),De.push(N[ke+1])),G.numPoints++;he&&function(Ve,ct){for(var Bt=0,gt=0,en=Ve.length,Jt=en-2;gt<en;Jt=gt,gt+=2)Bt+=(Ve[gt]-Ve[Jt])*(Ve[gt+1]+Ve[Jt+1]);if(Bt>0===ct)for(gt=0,en=Ve.length;gt<en/2;gt+=2){var Yt=Ve[gt],cn=Ve[gt+1];Ve[gt]=Ve[en-2-gt],Ve[gt+1]=Ve[en-1-gt],Ve[en-2-gt]=Yt,Ve[en-1-gt]=cn}}(De,Ce),oe.push(De)}}function Fs(oe,N){var G=(N=this.options=function(he,Ce){for(var Re in Ce)he[Re]=Ce[Re];return he}(Object.create(this.options),N)).debug;if(G&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var re=function(he,Ce){var Re=[];if(he.type==="FeatureCollection")for(var De=0;De<he.features.length;De++)hn(Re,he.features[De],Ce,De);else hn(Re,he.type==="Feature"?he:{geometry:he},Ce);return Re}(oe,N);this.tiles={},this.tileCoords=[],G&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),re=function(he,Ce){var Re=Ce.buffer/Ce.extent,De=he,ke=Wi(he,1,-1-Re,Re,0,-1,2,Ce),Ve=Wi(he,1,1-Re,2+Re,0,-1,2,Ce);return(ke||Ve)&&(De=Wi(he,1,-Re,1+Re,0,-1,2,Ce)||[],ke&&(De=ll(ke,1).concat(De)),Ve&&(De=De.concat(ll(Ve,-1)))),De}(re,N),re.length&&this.splitTile(re,0,0,0),G&&(re.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Gr(oe,N,G){return 32*((1<<oe)*G+N)+oe}function os(oe,N){const G=oe.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);const re=this._geoJSONIndex.getTile(G.z,G.x,G.y);if(!re)return N(null,null);const he=new ce(re.features);let Ce=me(he);Ce.byteOffset===0&&Ce.byteLength===Ce.buffer.byteLength||(Ce=new Uint8Array(Ce)),N(null,{vectorTile:he,rawData:Ce.buffer})}Fs.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Fs.prototype.splitTile=function(oe,N,G,re,he,Ce,Re){for(var De=[oe,N,G,re],ke=this.options,Ve=ke.debug;De.length;){re=De.pop(),G=De.pop(),N=De.pop(),oe=De.pop();var ct=1<<N,Bt=Gr(N,G,re),gt=this.tiles[Bt];if(!gt&&(Ve>1&&console.time("creation"),gt=this.tiles[Bt]=Mc(oe,N,G,re,ke),this.tileCoords.push({z:N,x:G,y:re}),Ve)){Ve>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,G,re,gt.numFeatures,gt.numPoints,gt.numSimplified),console.timeEnd("creation"));var en="z"+N;this.stats[en]=(this.stats[en]||0)+1,this.total++}if(gt.source=oe,he){if(N===ke.maxZoom||N===he)continue;var Jt=1<<he-N;if(G!==Math.floor(Ce/Jt)||re!==Math.floor(Re/Jt))continue}else if(N===ke.indexMaxZoom||gt.numPoints<=ke.indexMaxPoints)continue;if(gt.source=null,oe.length!==0){Ve>1&&console.time("clipping");var Yt,cn,_n,Gn,on,Jn,Qn=.5*ke.buffer/ke.extent,ss=.5-Qn,Ro=.5+Qn,et=1+Qn;Yt=cn=_n=Gn=null,on=Wi(oe,ct,G-Qn,G+Ro,0,gt.minX,gt.maxX,ke),Jn=Wi(oe,ct,G+ss,G+et,0,gt.minX,gt.maxX,ke),oe=null,on&&(Yt=Wi(on,ct,re-Qn,re+Ro,1,gt.minY,gt.maxY,ke),cn=Wi(on,ct,re+ss,re+et,1,gt.minY,gt.maxY,ke),on=null),Jn&&(_n=Wi(Jn,ct,re-Qn,re+Ro,1,gt.minY,gt.maxY,ke),Gn=Wi(Jn,ct,re+ss,re+et,1,gt.minY,gt.maxY,ke),Jn=null),Ve>1&&console.timeEnd("clipping"),De.push(Yt||[],N+1,2*G,2*re),De.push(cn||[],N+1,2*G,2*re+1),De.push(_n||[],N+1,2*G+1,2*re),De.push(Gn||[],N+1,2*G+1,2*re+1)}}},Fs.prototype.getTile=function(oe,N,G){var re=this.options,he=re.extent,Ce=re.debug;if(oe<0||oe>24)return null;var Re=1<<oe,De=Gr(oe,N=(N%Re+Re)%Re,G);if(this.tiles[De])return io(this.tiles[De],he);Ce>1&&console.log("drilling down to z%d-%d-%d",oe,N,G);for(var ke,Ve=oe,ct=N,Bt=G;!ke&&Ve>0;)Ve--,ct=Math.floor(ct/2),Bt=Math.floor(Bt/2),ke=this.tiles[Gr(Ve,ct,Bt)];return ke&&ke.source?(Ce>1&&console.log("found parent tile z%d-%d-%d",Ve,ct,Bt),Ce>1&&console.time("drilling down"),this.splitTile(ke.source,Ve,ct,Bt,oe,N,G),Ce>1&&console.timeEnd("drilling down"),this.tiles[De]?io(this.tiles[De],he):null):null};class zc extends o.VectorTileWorkerSource{constructor(N,G,re,he,Ce){super(N,G,re,he,os),Ce&&(this.loadGeoJSON=Ce)}loadData(N,G){const re=N&&N.request,he=re&&re.collectResourceTiming;this.loadGeoJSON(N,(Ce,Re)=>{if(Ce||!Re)return G(Ce);if(typeof Re!="object")return G(new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`));{D(Re,!0);try{if(N.filter){const ke=o.createExpression(N.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ke.result==="error")throw new Error(ke.value.map(ct=>`${ct.key}: ${ct.message}`).join(", "));Re={type:"FeatureCollection",features:Re.features.filter(ct=>ke.value.evaluate({zoom:0},ct))}}this._geoJSONIndex=N.cluster?new Dn(function({superclusterOptions:ke,clusterProperties:Ve}){if(!Ve||!ke)return ke;const ct={},Bt={},gt={accumulated:null,zoom:0},en={properties:null},Jt=Object.keys(Ve);for(const Yt of Jt){const[cn,_n]=Ve[Yt],Gn=o.createExpression(_n),on=o.createExpression(typeof cn=="string"?[cn,["accumulated"],["get",Yt]]:cn);ct[Yt]=Gn.value,Bt[Yt]=on.value}return ke.map=Yt=>{en.properties=Yt;const cn={};for(const _n of Jt)cn[_n]=ct[_n].evaluate(gt,en);return cn},ke.reduce=(Yt,cn)=>{en.properties=cn;for(const _n of Jt)gt.accumulated=Yt[_n],Yt[_n]=Bt[_n].evaluate(gt,en)},ke}(N)).load(Re.features):function(ke,Ve){return new Fs(ke,Ve)}(Re,N.geojsonVtOptions)}catch(ke){return G(ke)}this.loaded={};const De={};if(he){const ke=o.getPerformanceMeasurement(re);ke&&(De.resourceTiming={},De.resourceTiming[N.source]=JSON.parse(JSON.stringify(ke)))}G(null,De)}})}reloadTile(N,G){const re=this.loaded;return re&&re[N.uid]?super.reloadTile(N,G):this.loadTile(N,G)}loadGeoJSON(N,G){if(N.request)o.getJSON(N.request,G);else{if(typeof N.data!="string")return G(new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`));try{return G(null,JSON.parse(N.data))}catch{return G(new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(N,G){try{G(null,this._geoJSONIndex.getClusterExpansionZoom(N.clusterId))}catch(re){G(re)}}getClusterChildren(N,G){try{G(null,this._geoJSONIndex.getChildren(N.clusterId))}catch(re){G(re)}}getClusterLeaves(N,G){try{G(null,this._geoJSONIndex.getLeaves(N.clusterId,N.limit,N.offset))}catch(re){G(re)}}}class Vs{constructor(N){this.self=N,this.actor=new o.Actor(N,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.getProjection({name:"mercator"}),this.workerSourceTypes={vector:o.VectorTileWorkerSource,geojson:zc},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(G,re)=>{if(this.workerSourceTypes[G])throw new Error(`Worker source with name "${G}" already registered.`);this.workerSourceTypes[G]=re},this.self.registerRTLTextPlugin=G=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=G.applyArabicShaping,o.plugin.processBidirectionalText=G.processBidirectionalText,o.plugin.processStyledBidirectionalText=G.processStyledBidirectionalText}}clearCaches(N,G,re){delete this.layerIndexes[N],delete this.availableImages[N],delete this.workerSources[N],delete this.demWorkerSources[N],re()}checkIfReady(N,G,re){re()}setReferrer(N,G){this.referrer=G}spriteLoaded(N,G){this.isSpriteLoaded[N]=G;for(const re in this.workerSources[N]){const he=this.workerSources[N][re];for(const Ce in he)he[Ce]instanceof o.VectorTileWorkerSource&&(he[Ce].isSpriteLoaded=G,he[Ce].fire(new o.Event("isSpriteLoaded")))}}setImages(N,G,re){this.availableImages[N]=G;for(const he in this.workerSources[N]){const Ce=this.workerSources[N][he];for(const Re in Ce)Ce[Re].availableImages=G}re()}enableTerrain(N,G,re){this.terrain=G,re()}setProjection(N,G){this.projections[N]=o.getProjection(G)}setLayers(N,G,re){this.getLayerIndex(N).replace(G),re()}updateLayers(N,G,re){this.getLayerIndex(N).update(G.layers,G.removedIds),re()}loadTile(N,G,re){const he=this.enableTerrain?o.extend({enableTerrain:this.terrain},G):G;he.projection=this.projections[N]||this.defaultProjection,this.getWorkerSource(N,G.type,G.source).loadTile(he,re)}loadDEMTile(N,G,re){const he=this.enableTerrain?o.extend({buildQuadTree:this.terrain},G):G;this.getDEMWorkerSource(N,G.source).loadTile(he,re)}reloadTile(N,G,re){const he=this.enableTerrain?o.extend({enableTerrain:this.terrain},G):G;he.projection=this.projections[N]||this.defaultProjection,this.getWorkerSource(N,G.type,G.source).reloadTile(he,re)}abortTile(N,G,re){this.getWorkerSource(N,G.type,G.source).abortTile(G,re)}removeTile(N,G,re){this.getWorkerSource(N,G.type,G.source).removeTile(G,re)}removeSource(N,G,re){if(!this.workerSources[N]||!this.workerSources[N][G.type]||!this.workerSources[N][G.type][G.source])return;const he=this.workerSources[N][G.type][G.source];delete this.workerSources[N][G.type][G.source],he.removeSource!==void 0?he.removeSource(G,re):re()}loadWorkerSource(N,G,re){try{this.self.importScripts(G.url),re()}catch(he){re(he.toString())}}syncRTLPluginState(N,G,re){try{o.plugin.setState(G);const he=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&he!=null){this.self.importScripts(he);const Ce=o.plugin.isParsed();re(Ce?void 0:new Error(`RTL Text Plugin failed to import scripts from ${he}`),Ce)}}catch(he){re(he.toString())}}getAvailableImages(N){let G=this.availableImages[N];return G||(G=[]),G}getLayerIndex(N){let G=this.layerIndexes[N];return G||(G=this.layerIndexes[N]=new M),G}getWorkerSource(N,G,re){if(this.workerSources[N]||(this.workerSources[N]={}),this.workerSources[N][G]||(this.workerSources[N][G]={}),!this.workerSources[N][G][re]){const he={send:(Ce,Re,De,ke,Ve,ct)=>{this.actor.send(Ce,Re,De,N,Ve,ct)},scheduler:this.actor.scheduler};this.workerSources[N][G][re]=new this.workerSourceTypes[G](he,this.getLayerIndex(N),this.getAvailableImages(N),this.isSpriteLoaded[N])}return this.workerSources[N][G][re]}getDEMWorkerSource(N,G){return this.demWorkerSources[N]||(this.demWorkerSources[N]={}),this.demWorkerSources[N][G]||(this.demWorkerSources[N][G]=new L),this.demWorkerSources[N][G]}enforceCacheSizeLimit(N,G){o.enforceCacheSizeLimit(G)}getWorkerPerformanceMetrics(N,G,re){re(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Vs(self)),Vs}),v(["./shared"],function(o){function w(h,r){if(Array.isArray(h)){if(!Array.isArray(r)||h.length!==r.length)return!1;for(let c=0;c<h.length;c++)if(!w(h[c],r[c]))return!1;return!0}if(typeof h=="object"&&h!==null&&r!==null){if(typeof r!="object"||Object.keys(h).length!==Object.keys(r).length)return!1;for(const c in h)if(!w(h[c],r[c]))return!1;return!0}return h===r}var C=M;function M(h){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var p,_,x=new Blob([""],{type:"text/javascript"}),E=URL.createObjectURL(x);try{_=new Worker(E),p=!0}catch{p=!1}return _&&_.terminate(),URL.revokeObjectURL(E),p}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var p=document.createElement("canvas");p.width=p.height=1;var _=p.getContext("2d");if(!_)return!1;var x=_.getImageData(0,0,1,1);return x&&x.width===p.width}()?(L[c=r&&r.failIfMajorPerformanceCaveat]===void 0&&(L[c]=function(p){var _,x=function(E){var I=document.createElement("canvas"),k=Object.create(M.webGLContextAttributes);return k.failIfMajorPerformanceCaveat=E,I.getContext("webgl",k)||I.getContext("experimental-webgl",k)}(p);if(!x)return!1;try{_=x.createShader(x.VERTEX_SHADER)}catch{return!1}return!(!_||x.isContextLost())&&(x.shaderSource(_,"void main() {}"),x.compileShader(_),x.getShaderParameter(_,x.COMPILE_STATUS)===!0)}(c)),L[c]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var c}(h)}var L={};function D(h,r,c){const p=o.window.document.createElement(h);return r!==void 0&&(p.className=r),c&&c.appendChild(p),p}function V(h,r,c){const p=o.window.document.createElementNS("http://www.w3.org/2000/svg",h);for(const _ of Object.keys(r))p.setAttributeNS(null,_,r[_]);return c&&c.appendChild(p),p}M.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const q=o.window.document&&o.window.document.documentElement.style,X=q&&q.userSelect!==void 0?"userSelect":"WebkitUserSelect";let xe;function ce(){q&&X&&(xe=q[X],q[X]="none")}function me(){q&&X&&(q[X]=xe)}function ee(h){h.preventDefault(),h.stopPropagation(),o.window.removeEventListener("click",ee,!0)}function Ie(){o.window.addEventListener("click",ee,!0),o.window.setTimeout(()=>{o.window.removeEventListener("click",ee,!0)},0)}function Y(h,r){const c=h.getBoundingClientRect();return ge(h,c,r)}function ve(h,r){const c=h.getBoundingClientRect(),p=[];for(let _=0;_<r.length;_++)p.push(ge(h,c,r[_]));return p}function fe(h){return o.window.InstallTrigger!==void 0&&h.button===2&&h.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:h.button}function ge(h,r,c){const p=h.offsetWidth===r.width?1:h.offsetWidth/r.width;return new o.pointGeometry((c.clientX-r.left)*p,(c.clientY-r.top)*p)}function Ee(h,r){var c=r[0],p=r[1],_=r[2],x=r[3],E=c*x-_*p;return E?(h[0]=x*(E=1/E),h[1]=-p*E,h[2]=-_*E,h[3]=c*E,h):null}function we(h){const{userImage:r}=h;return!!(r&&r.render&&r.render())&&(h.data.replace(new Uint8Array(r.data.buffer)),!0)}class Oe extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:c,callback:p}of this.requestors)this._notify(c,p);this.requestors=[]}}hasImage(r){return!!this.getImage(r)}getImage(r){return this.images[r]}addImage(r,c){this._validate(r,c)&&(this.images[r]=c)}_validate(r,c){let p=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),p=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),p=!1),this._validateContent(c.content,c)||(this.fire(new o.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),p=!1),p}_validateStretch(r,c){if(!r)return!0;let p=0;for(const _ of r){if(_[0]<p||_[1]<_[0]||c<_[1])return!1;p=_[1]}return!0}_validateContent(r,c){return!(r&&(r.length!==4||r[0]<0||c.data.width<r[0]||r[1]<0||c.data.height<r[1]||r[2]<0||c.data.width<r[2]||r[3]<0||c.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,c){c.version=this.images[r].version+1,this.images[r]=c,this.updatedImages[r]=!0}removeImage(r){const c=this.images[r];delete this.images[r],delete this.patterns[r],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,c){let p=!0;if(!this.isLoaded())for(const _ of r)this.images[_]||(p=!1);this.isLoaded()||p?this._notify(r,c):this.requestors.push({ids:r,callback:c})}_notify(r,c){const p={};for(const _ of r){this.images[_]||this.fire(new o.Event("styleimagemissing",{id:_}));const x=this.images[_];x?p[_]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,hasRenderCallback:Boolean(x.userImage&&x.userImage.render)}:o.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,p)}getPixelSize(){const{width:r,height:c}=this.atlasImage;return{width:r,height:c}}getPattern(r){const c=this.patterns[r],p=this.getImage(r);if(!p)return null;if(c&&c.position.version===p.version)return c.position;if(c)c.position.version=p.version;else{const _={w:p.data.width+2,h:p.data.height+2,x:0,y:0},x=new o.ImagePosition(_,p);this.patterns[r]={bin:_,position:x}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const c=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(r,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const x in this.patterns)r.push(this.patterns[x].bin);const{w:c,h:p}=o.potpack(r),_=this.atlasImage;_.resize({width:c||1,height:p||1});for(const x in this.patterns){const{bin:E}=this.patterns[x],I=E.x+1,k=E.y+1,B=this.images[x].data,R=B.width,U=B.height;o.RGBAImage.copy(B,_,{x:0,y:0},{x:I,y:k},{width:R,height:U}),o.RGBAImage.copy(B,_,{x:0,y:U-1},{x:I,y:k-1},{width:R,height:1}),o.RGBAImage.copy(B,_,{x:0,y:0},{x:I,y:k+U},{width:R,height:1}),o.RGBAImage.copy(B,_,{x:R-1,y:0},{x:I-1,y:k},{width:1,height:U}),o.RGBAImage.copy(B,_,{x:0,y:0},{x:I+R,y:k},{width:1,height:U})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const c of r){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const p=this.images[c];we(p)&&this.updateImage(c,p)}}}const ze=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(h,r){return function([c,p,_]){const x=o.degToRad(p+90),E=o.degToRad(_);return{x:c*Math.cos(x)*Math.sin(E),y:c*Math.sin(x)*Math.sin(E),z:c*Math.cos(E),azimuthal:p,polar:_}}(h.expression.evaluate(r))}interpolate(h,r,c){return{x:o.number(h.x,r.x,c),y:o.number(h.y,r.y,c),z:o.number(h.z,r.z,c),azimuthal:o.number(h.azimuthal,r.azimuthal,c),polar:o.number(h.polar,r.polar,c)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),Qe="-transition";class ht extends o.Evented{constructor(r){super(),this._transitionable=new o.Transitionable(ze),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,c={}){if(!this._validate(o.validateLight,r,c))for(const p in r){const _=r[p];o.endsWith(p,Qe)?this._transitionable.setTransition(p.slice(0,-Qe.length),_):this._transitionable.setValue(p,_)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,p){return(!p||p.validate!==!1)&&o.emitValidationErrors(this,r.call(o.validateStyle,o.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}const nt=new o.Properties({source:new o.DataConstantProperty(o.spec.terrain.source),exaggeration:new o.DataConstantProperty(o.spec.terrain.exaggeration)}),ft="-transition";class Pe extends o.Evented{constructor(r,c){super(),this._transitionable=new o.Transitionable(nt),this.set(r),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=c}get(){return this._transitionable.serialize()}set(r){for(const c in r){const p=r[c];o.endsWith(c,ft)?this._transitionable.setTransition(c.slice(0,-ft.length),p):this._transitionable.setValue(c,p)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}}function at(h,r,c,p){const _=o.smoothstep(45,65,c),[x,E]=jt(h,p),I=o.length(r);let k=1-Math.min(1,Math.exp((I-x)/(E-x)*-6));return k*=k*k,k=Math.min(1,1.00747*k),k*_*h.alpha}function jt(h,r){const c=.5/Math.tan(.5*r);return[h.range[0]+c,h.range[1]+c]}const pt=new o.Properties({range:new o.DataConstantProperty(o.spec.fog.range),color:new o.DataConstantProperty(o.spec.fog.color),"high-color":new o.DataConstantProperty(o.spec.fog["high-color"]),"space-color":new o.DataConstantProperty(o.spec.fog["space-color"]),"horizon-blend":new o.DataConstantProperty(o.spec.fog["horizon-blend"]),"star-intensity":new o.DataConstantProperty(o.spec.fog["star-intensity"])}),zt="-transition";class Gt extends o.Evented{constructor(r,c){super(),this._transitionable=new o.Transitionable(pt),this.set(r),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const r=this._transform,c=r.projection.name==="globe",p=o.globeToMercatorTransition(r.zoom),_=this.properties.get("range"),x=[.5,3];return{range:c?[o.number(x[0],_[0],p),o.number(x[1],_[1],p)]:_,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,c={}){if(!this._validate(o.validateFog,r,c)){for(const p of Object.keys(o.spec.fog))r&&r[p]===void 0&&(r[p]=o.spec.fog[p].default);for(const p in r){const _=r[p];o.endsWith(p,zt)?this._transitionable.setTransition(p.slice(0,-zt.length),_):this._transitionable.setValue(p,_)}}}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.smoothstep(45,65,r))*c.a}getOpacityAtLatLng(r,c){return this._transform.projection.supportsFog?function(p,_,x){const E=o.MercatorCoordinate.fromLngLat(_),I=x.elevation?x.elevation.getAtPointOrZero(E):0,k=[E.x,E.y,I];return o.transformMat4(k,k,x.mercatorFogMatrix),at(p,k,x.pitch,x._fov)}(this.state,r,c):0}getFovAdjustedRange(r){return this._transform.projection.supportsFog?jt(this.state,r):[0,1]}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,p){return(!p||p.validate!==!1)&&o.emitValidationErrors(this,r.call(o.validateStyle,o.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class zn{constructor(r,c){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const p=this.workerPool.acquire(this.id);for(let _=0;_<p.length;_++){const x=new zn.Actor(p[_],c,this.id);x.name=`Worker ${_}`,this.actors.push(x)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,c,p){o.asyncAll(this.actors,(_,x)=>{_.send(r,c,x)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function At(h,r,c){return r*(o.EXTENT/(h.tileSize*Math.pow(2,c-h.tileID.overscaledZ)))}zn.Actor=o.Actor;class Ke{constructor(r,c,p,_){this.screenBounds=r,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,_)}static createFromScreenPoints(r,c){let p,_;if(r instanceof o.pointGeometry||typeof r[0]=="number"){const x=o.pointGeometry.convert(r);p=[x],_=c.isPointAboveHorizon(x)}else{const x=o.pointGeometry.convert(r[0]),E=o.pointGeometry.convert(r[1]);p=[x,E],_=o.polygonizeBounds(x,E).every(I=>c.isPointAboveHorizon(I))}return new Ke(p,c.getCameraPoint(),_,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return o.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const c=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new o.pointGeometry(1,1)):this.screenBounds[1],_=o.polygonizeBounds(c,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<p.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?_[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(_[3]=this.cameraPoint)),o.bufferConvexPolygon(_,r)}bufferedCameraGeometryGlobe(r){const c=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new o.pointGeometry(1,1)):this.screenBounds[1],_=o.polygonizeBounds(c,p,r),x=this.cameraPoint.clone();switch(3*((x.y>c.y)+(x.y>p.y))+((x.x>c.x)+(x.x>p.x))){case 0:_[0]=x,_[4]=x.clone();break;case 1:_.splice(1,0,x);break;case 2:_[1]=x;break;case 3:_.splice(4,0,x);break;case 5:_.splice(2,0,x);break;case 6:_[3]=x;break;case 7:_.splice(3,0,x);break;case 8:_[2]=x}return _}containsTile(r,c,p,_=0){const x=r.queryPadding/c._pixelsPerMercatorPixel+1,E=p?this._bufferedCameraMercator(x,c):this._bufferedScreenMercator(x,c);let I=r.tileID.wrap+(E.unwrapped?_:0);const k=E.polygon.map(te=>o.getTilePoint(r.tileTransform,te,I));if(!o.polygonIntersectsBox(k,0,0,o.EXTENT,o.EXTENT))return;I=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?_:0);const B=this.screenGeometryMercator.polygon.map(te=>o.getTileVec3(r.tileTransform,te,I)),R=B.map(te=>new o.pointGeometry(te[0],te[1])),U=c.getFreeCameraOptions().position||new o.MercatorCoordinate(0,0,0),W=o.getTileVec3(r.tileTransform,U,I),J=B.map(te=>{const Z=o.sub(te,te,W);return o.normalize(Z,Z),new o.Ray(W,Z)}),K=At(r,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:R,tilespaceRays:J,bufferedTilespaceGeometry:k,bufferedTilespaceBounds:(Q=o.getBounds(k),Q.min.x=o.clamp(Q.min.x,0,o.EXTENT),Q.min.y=o.clamp(Q.min.y,0,o.EXTENT),Q.max.x=o.clamp(Q.max.x,0,o.EXTENT),Q.max.y=o.clamp(Q.max.y,0,o.EXTENT),Q),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:K};var Q}_bufferedScreenMercator(r,c){const p=Nt(r);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let _;return _=c.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),c):{polygon:this.bufferedScreenGeometry(r).map(x=>c.pointCoordinate3D(x)),unwrapped:!0},this._screenRaycastCache[p]=_,_}}_bufferedCameraMercator(r,c){const p=Nt(r);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let _;return _=c.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),c):{polygon:this.bufferedCameraGeometry(r).map(x=>c.pointCoordinate3D(x)),unwrapped:!0},this._cameraRaycastCache[p]=_,_}}_projectAndResample(r,c){const p=function(x,E){const I=o.multiply([],E.pixelMatrix,E.globeMatrix),k=[0,-o.GLOBE_RADIUS,0,1],B=[0,o.GLOBE_RADIUS,0,1],R=[0,0,0,1];o.transformMat4$1(k,k,I),o.transformMat4$1(B,B,I),o.transformMat4$1(R,R,I);const U=new o.pointGeometry(k[0]/k[3],k[1]/k[3]),W=new o.pointGeometry(B[0]/B[3],B[1]/B[3]),J=o.polygonContainsPoint(x,U)&&k[3]<R[3],K=o.polygonContainsPoint(x,W)&&B[3]<R[3];if(!J&&!K)return null;const Q=function(Ae,Be,Ne){for(let Ge=1;Ge<Ae.length;Ge++){const bt=St(Be.pointCoordinate3D(Ae[Ge-1]).x),Fe=St(Be.pointCoordinate3D(Ae[Ge]).x);if(Ne<0){if(bt<Fe)return{idx:Ge,t:-bt/(Fe-1-bt)}}else if(Fe<bt)return{idx:Ge,t:(1-bt)/(Fe+1-bt)}}return null}(x,E,J?-1:1);if(!Q)return null;const{idx:te,t:Z}=Q;let le=te>1?xt(x.slice(0,te),E):[],se=te<x.length?xt(x.slice(te),E):[];le=le.map(Ae=>new o.pointGeometry(St(Ae.x),Ae.y)),se=se.map(Ae=>new o.pointGeometry(St(Ae.x),Ae.y));const de=[...le];de.length===0&&de.push(se[se.length-1]);const Se=o.number(de[de.length-1].y,(se.length===0?le[0]:se[0]).y,Z);let be;return be=J?[new o.pointGeometry(0,Se),new o.pointGeometry(0,0),new o.pointGeometry(1,0),new o.pointGeometry(1,Se)]:[new o.pointGeometry(1,Se),new o.pointGeometry(1,1),new o.pointGeometry(0,1),new o.pointGeometry(0,Se)],de.push(...be),se.length===0?de.push(le[0]):de.push(...se),{polygon:de.map(Ae=>new o.MercatorCoordinate(Ae.x,Ae.y)),unwrapped:!1}}(r,c);if(p)return p;const _=function(x,E){let I=!1,k=-1/0,B=0;for(let U=0;U<x.length-1;U++)x[U].x>k&&(k=x[U].x,B=U);for(let U=0;U<x.length-1;U++){const W=(B+U)%(x.length-1),J=x[W],K=x[W+1];Math.abs(J.x-K.x)>.5&&(J.x<K.x?(J.x+=1,W===0&&(x[x.length-1].x+=1)):(K.x+=1,W+1===x.length-1&&(x[0].x+=1)),I=!0)}const R=o.mercatorXfromLng(E.center.lng);return I&&R<Math.abs(R-1)&&x.forEach(U=>{U.x-=1}),{polygon:x,unwrapped:I}}(xt(r,c).map(x=>new o.pointGeometry(St(x.x),x.y)),c);return{polygon:_.polygon.map(x=>new o.MercatorCoordinate(x.x,x.y)),unwrapped:_.unwrapped}}}function xt(h,r){return o.resample(h,c=>{const p=r.pointCoordinate3D(c);c.x=p.x,c.y=p.y},1/256)}function St(h){return h<0?1+h%1:h%1}function Nt(h){return 100*h|0}function fn(h,r,c,p,_){const x=function(E,I){if(E)return _(E);if(I){h.url&&I.tiles&&h.tiles&&delete h.tiles;const k=o.pick(o.extend(I,h),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(k.vectorLayers=I.vector_layers,k.vectorLayerIds=k.vectorLayers.map(B=>B.id)),k.tiles=r.canonicalizeTileset(k,h.url),_(null,k)}};return h.url?o.getJSON(r.transformRequest(r.normalizeSourceURL(h.url,null,c,p),o.ResourceType.Source),x):o.exported.frame(()=>x(null,h))}class Dn{constructor(r,c,p){this.bounds=o.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=c||0,this.maxzoom=p||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const c=Math.pow(2,r.z),p=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*c),_=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*c),x=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*c),E=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*c);return r.x>=p&&r.x<x&&r.y>=_&&r.y<E}}class gn{constructor(r,c,p){this.context=r;const _=r.gl;this.buffer=_.createBuffer(),this.dynamicDraw=Boolean(p),this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ue={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Me{constructor(r,c,p,_){this.length=c.length,this.attributes=p,this.itemSize=c.bytesPerElement,this.dynamicDraw=_,this.context=r;const x=r.gl;this.buffer=x.createBuffer(),r.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,c){for(let p=0;p<this.attributes.length;p++){const _=c.attributes[this.attributes[p].name];_!==void 0&&r.enableVertexAttribArray(_)}}setVertexAttribPointers(r,c,p){for(let _=0;_<this.attributes.length;_++){const x=this.attributes[_],E=c.attributes[x.name];E!==void 0&&r.vertexAttribPointer(E,x.components,r[ue[x.type]],!1,this.itemSize,x.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class qe{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class st extends qe{getDefault(){return o.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class yt extends qe{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Lt extends qe{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Vt extends qe{getDefault(){return[!0,!0,!0,!0]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Mt extends qe{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Ot extends qe{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class wt extends qe{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const c=this.current;(r.func!==c.func||r.ref!==c.ref||r.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Kt extends qe{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Zt extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=r,this.dirty=!1}}class rn extends qe{getDefault(){return[0,1]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class hn extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=r,this.dirty=!1}}class En extends qe{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Un extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.BLEND):c.disable(c.BLEND),this.current=r,this.dirty=!1}}class jn extends qe{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class mi extends qe{getDefault(){return o.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class tr extends qe{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Wi extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=r,this.dirty=!1}}class rs extends qe{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Pr extends qe{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class mo extends qe{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Ji extends qe{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class ar extends qe{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Bo extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Bs extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ll extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Rs extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class io extends qe{getDefault(){return null}set(r){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Os extends qe{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class Mc extends qe{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class Pc extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class _a extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Fs extends qe{constructor(r,c){super(r),this.context=r,this.parent=c}getDefault(){return null}}class Gr extends Fs{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class os extends Fs{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class zc extends os{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Vs{constructor(r,c,p,_){this.context=r,this.width=c,this.height=p;const x=this.framebuffer=r.gl.createFramebuffer();this.colorAttachment=new Gr(r,x),_&&(this.depthAttachment=new os(r,x))}destroy(){const r=this.context.gl,c=this.colorAttachment.get();if(c&&r.deleteTexture(c),this.depthAttachment){const p=this.depthAttachment.get();p&&r.deleteRenderbuffer(p)}r.deleteFramebuffer(this.framebuffer)}}class oe{constructor(r,c=!1){if(this.gl=r,this.isWebGL2=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),c){const p=r;this.extVertexArrayObject={createVertexArrayOES:p.createVertexArray.bind(r),deleteVertexArrayOES:p.deleteVertexArray.bind(r),bindVertexArrayOES:p.bindVertexArray.bind(r)}}this.clearColor=new st(this),this.clearDepth=new yt(this),this.clearStencil=new Lt(this),this.colorMask=new Vt(this),this.depthMask=new Mt(this),this.stencilMask=new Ot(this),this.stencilFunc=new wt(this),this.stencilOp=new Kt(this),this.stencilTest=new Zt(this),this.depthRange=new rn(this),this.depthTest=new hn(this),this.depthFunc=new En(this),this.blend=new Un(this),this.blendFunc=new jn(this),this.blendColor=new mi(this),this.blendEquation=new tr(this),this.cullFace=new Wi(this),this.cullFaceSide=new rs(this),this.frontFace=new Pr(this),this.program=new mo(this),this.activeTexture=new Ji(this),this.viewport=new ar(this),this.bindFramebuffer=new Bo(this),this.bindRenderbuffer=new Bs(this),this.bindTexture=new ll(this),this.bindVertexBuffer=new Rs(this),this.bindElementBuffer=new io(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Os(this),this.pixelStoreUnpack=new Mc(this),this.pixelStoreUnpackPremultiplyAlpha=new Pc(this),this.pixelStoreUnpackFlipY=new _a(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),c||(this.extTextureHalfFloat=r.getExtension("OES_texture_half_float")),(c||this.extTextureHalfFloat&&r.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=c||r.getExtension("OES_standard_derivatives"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,c){return new gn(this,r,c)}createVertexBuffer(r,c,p){return new Me(this,r,c,p)}createRenderbuffer(r,c,p){const _=this.gl,x=_.createRenderbuffer();return this.bindRenderbuffer.set(x),_.renderbufferStorage(_.RENDERBUFFER,r,c,p),this.bindRenderbuffer.set(null),x}createFramebuffer(r,c,p){return new Vs(this,r,c,p)}clear({color:r,depth:c,stencil:p}){const _=this.gl;let x=0;r&&(x|=_.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(x|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),p!==void 0&&(x|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),_.clear(x)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){w(r.blendFunction,o.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class N extends o.Evented{constructor(r,c,p,_){if(super(),this.id=r,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(c,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new o.DedupedRequest}load(r){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map._worldview;this._tileJSONRequest=fn(this._options,this.map._requestManager,c,p,(_,x)=>{this._tileJSONRequest=null,this._loaded=!0,_?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),p&&p.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new o.ErrorEvent(_))):x&&(o.extend(this,x),x.bounds&&(this.tileBounds=new Dn(x.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(x.tiles,this.map._requestManager._customAccessToken),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),r&&r(_)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}loadTile(r,c){const p=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(p,o.ResourceType.Tile),data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile};if(_.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=c:r.request=r.actor.send("reloadTile",_,x.bind(this));else if(r.actor=this._tileWorkers[p]=this._tileWorkers[p]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",_,x.bind(this),void 0,!0);else{const E=o.loadVectorTile.call({deduped:this._deduped},_,(I,k)=>{I||!k?x.call(this,I):(_.data={cacheControl:k.cacheControl,expires:k.expires,rawData:k.rawData.slice(0)},r.actor&&r.actor.send("loadTile",_,x.bind(this),void 0,!0))},!0);r.request={cancel:E}}function x(E,I){return delete r.request,r.aborted?c(null):E&&E.status!==404?c(E):(I&&I.resourceTiming&&(r.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&r.setExpiryData(I),r.loadVectorData(I,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id})}unloadTile(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class G extends o.Evented{constructor(r,c,p,_){super(),this.id=r,this.dispatcher=p,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},c),o.extend(this,o.pick(c,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=fn(this._options,this.map._requestManager,null,null,(c,p)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new o.ErrorEvent(c)):p&&(o.extend(this,p),p.bounds&&(this.tileBounds=new Dn(p.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(p.tiles),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),r&&r(c)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,c){const p=o.exported.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);r.request=o.getImage(this.map._requestManager.transformRequest(_,o.ResourceType.Tile),(x,E,I,k)=>(delete r.request,r.aborted?(r.state="unloaded",c(null)):x?(r.state="errored",c(x)):E?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:I,expires:k}),r.setTexture(E,this.map.painter),r.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(r,c,p){r.setTexture(c,p)}static unloadTileData(r,c){r.texture&&c.saveTileTexture(r.texture)}abortTile(r,c){r.request&&(r.request.cancel(),delete r.request),c()}unloadTile(r,c){r.texture&&this.map.painter.saveTileTexture(r.texture),c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let re;function he(h,r,c,p,_,x,E,I){const k=[h,c,_,r,p,x,1,1,1],B=[E,I,1],R=o.adjoint([],k),[U,W,J]=o.transformMat3(B,B,o.transpose(R,R));return o.multiply$1(k,[U,0,0,0,W,0,0,0,J],k)}class Ce extends o.Evented{constructor(r,c,p,_){super(),this.id=r,this.dispatcher=p,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=c,this._dirty=!1}load(r,c){this._loaded=c||!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(p,_)=>{if(this._imageRequest=null,this._loaded=!0,p)this.fire(new o.ErrorEvent(p));else if(_){const{HTMLImageElement:x}=o.window;this.image=_ instanceof x?o.exported.getImageData(_):_,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading()}})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(r){this.coordinates=r,this._boundsArray=void 0;const c=r.map(o.MercatorCoordinate.fromLngLat);return this.tileID=function(p){let _=1/0,x=1/0,E=-1/0,I=-1/0;for(const U of p)_=Math.min(_,U.x),x=Math.min(x,U.y),E=Math.max(E,U.x),I=Math.max(I,U.y);const k=Math.max(E-_,I-x),B=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),R=Math.pow(2,B);return new o.CanonicalTileID(B,Math.floor((_+E)/2*R),Math.floor((x+I)/2*R))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(r){for(const k in this.tiles){const B=this.tiles[k];B.state!=="loaded"&&(B.state="loaded",B.texture=this.texture)}if(this._boundsArray)return;const c=o.tileTransform(this.tileID,this.map.transform.projection),[p,_,x,E]=this.coordinates.map(k=>{const B=c.projection.project(k[0],k[1]);return o.getTilePoint(c,B)._round()});this.perspectiveTransform=function(k,B,R,U,W,J,K,Q,te,Z){const le=he(0,0,k,0,0,B,k,B),se=he(R,U,W,J,K,Q,te,Z);return o.multiply$1(se,o.adjoint(le,le),se),[se[6]/se[8]*k/o.EXTENT,se[7]/se[8]*B/o.EXTENT]}(this.width,this.height,p.x,p.y,_.x,_.y,E.x,E.y,x.x,x.y);const I=this._boundsArray=new o.StructArrayLayout4i8;I.emplaceBack(p.x,p.y,0,0),I.emplaceBack(_.x,_.y,o.EXTENT,0),I.emplaceBack(E.x,E.y,0,o.EXTENT),I.emplaceBack(x.x,x.y,o.EXTENT,o.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=r.createVertexBuffer(I,o.boundsAttributes.members),this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,c=r.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new o.Texture(r,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(r)}loadTile(r,c){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},c(null)):(r.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Re={vector:N,raster:G,"raster-dem":class extends G{constructor(h,r,c,p){super(h,r,c,p),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(h,r){const c=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(_,x){_&&(h.state="errored",r(_)),x&&(h.dem=x,h.dem.onDeserialize(),h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0,h.state="loaded",r(null))}h.request=o.getImage(this.map._requestManager.transformRequest(c,o.ResourceType.Tile),function(_,x,E,I){if(delete h.request,h.aborted)h.state="unloaded",r(null);else if(_)h.state="errored",r(_);else if(x){this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:E,expires:I});const k=o.window.ImageBitmap&&x instanceof o.window.ImageBitmap&&(re==null&&(re=o.window.OffscreenCanvas&&new o.window.OffscreenCanvas(1,1).getContext("2d")&&typeof o.window.createImageBitmap=="function"),re),B=1-(x.width-o.prevPowerOfTwo(x.width))/2;B<1||h.neighboringTiles||(h.neighboringTiles=this._getNeighboringTiles(h.tileID));const R=k?x:o.exported.getImageData(x,B),U={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:R,encoding:this.encoding,padding:B};h.actor&&h.state!=="expired"||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",U,p.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(h){const r=h.canonical,c=Math.pow(2,r.z),p=(r.x-1+c)%c,_=r.x===0?h.wrap-1:h.wrap,x=(r.x+1+c)%c,E=r.x+1===c?h.wrap+1:h.wrap,I={};return I[new o.OverscaledTileID(h.overscaledZ,_,r.z,p,r.y).key]={backfilled:!1},I[new o.OverscaledTileID(h.overscaledZ,E,r.z,x,r.y).key]={backfilled:!1},r.y>0&&(I[new o.OverscaledTileID(h.overscaledZ,_,r.z,p,r.y-1).key]={backfilled:!1},I[new o.OverscaledTileID(h.overscaledZ,h.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},I[new o.OverscaledTileID(h.overscaledZ,E,r.z,x,r.y-1).key]={backfilled:!1}),r.y+1<c&&(I[new o.OverscaledTileID(h.overscaledZ,_,r.z,p,r.y+1).key]={backfilled:!1},I[new o.OverscaledTileID(h.overscaledZ,h.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},I[new o.OverscaledTileID(h.overscaledZ,E,r.z,x,r.y+1).key]={backfilled:!1}),I}unloadTile(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded"}},geojson:class extends o.Evented{constructor(h,r,c,p){super(),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(p),this._data=r.data,this._options=o.extend({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const _=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*_,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*_,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:o.EXTENT,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*_,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(h){this.map=h,this.setData(this._data)}setData(h){return this._data=h,this._updateWorkerData(),this}getClusterExpansionZoom(h,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},r),this}getClusterChildren(h,r){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},r),this}getClusterLeaves(h,r,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:r,offset:c},p),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.Event("dataloading",{dataType:"source"})),this._loaded=!1;const h=o.extend({},this.workerOptions),r=this._data;typeof r=="string"?(h.request=this.map._requestManager.transformRequest(o.exported.resolveURL(r),o.ResourceType.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,h,(c,p)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new o.ErrorEvent(c));else{const _={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&p&&p.resourceTiming&&p.resourceTiming[this.id]&&(_.resourceTiming=p.resourceTiming[this.id]),this.fire(new o.Event("data",_)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(h,r){const c=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(c,{type:this.type,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(p,_)=>(delete h.request,h.unloadVectorData(),h.aborted?r(null):p?r(p):(h.loadVectorData(_,this.map.painter,c==="reloadTile"),r(null))),void 0,c==="loadTile")}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0}unloadTile(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ce{constructor(h,r,c,p){super(h,r,c,p),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const h=this.options;this.urls=[];for(const r of h.urls)this.urls.push(this.map._requestManager.transformRequest(r,o.ResourceType.Source).url);o.getVideo(this.urls,(r,c)=>{this._loaded=!0,r?this.fire(new o.ErrorEvent(r)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(h){if(this.video){const r=this.video.seekable;h<r.start(0)||h>r.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=h}}getVideo(){return this.video}onAdd(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const h=this.map.painter.context,r=h.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(h,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(h)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ce,canvas:class extends Ce{constructor(h,r,c,p){super(h,r,c,p),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(x=>typeof x!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${h}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${h}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${h}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${h}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${h}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(r,this.canvas,r.gl.RGBA,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const h of[this.canvas.width,this.canvas.height])if(isNaN(h)||h<=0)return!0;return!1}},custom:class extends o.Evented{constructor(h,r,c,p){super(),this.id=h,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=r,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Dn(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),o.extend(this,o.pick(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(h){this._map=h,this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(h),this.load()}onRemove(h){this._implementation.onRemove&&this._implementation.onRemove(h)}hasTile(h){if(this._implementation.hasTile){const{x:r,y:c,z:p}=h.canonical;return this._implementation.hasTile({x:r,y:c,z:p})}return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,r){const{x:c,y:p,z:_}=h.tileID.canonical,x=new o.window.AbortController;h.request=Promise.resolve(this._implementation.loadTile({x:c,y:p,z:_},{signal:x.signal})).then(function(E){return delete h.request,h.aborted?(h.state="unloaded",r(null)):E===void 0?(h.state="errored",r(null)):E===null?(this.loadTileData(h,{width:this.tileSize,height:this.tileSize,data:null}),h.state="loaded",r(null)):function(I){return I instanceof o.window.ImageData||I instanceof o.window.HTMLCanvasElement||I instanceof o.window.ImageBitmap||I instanceof o.window.HTMLImageElement}(E)?(this.loadTileData(h,E),h.state="loaded",void r(null)):(h.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(E=>{E.code!==20&&(h.state="errored",r(E))}),h.request.cancel=()=>x.abort()}loadTileData(h,r){G.loadTileData(h,r,this._map.painter)}unloadTileData(h){G.unloadTileData(h,this._map.painter)}unloadTile(h,r){if(this.unloadTileData(h),this._implementation.unloadTile){const{x:c,y:p,z:_}=h.tileID.canonical;this._implementation.unloadTile({x:c,y:p,z:_})}r()}abortTile(h,r){h.request&&h.request.cancel&&(h.request.cancel(),delete h.request),r()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(h=>({x:h.canonical.x,y:h.canonical.y,z:h.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}}},De=function(h,r,c,p){const _=new Re[r.type](h,r,c,p);if(_.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${_.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],_),_};function ke(h,r){const c=o.identity([]);return o.scale(c,c,[.5*h.width,.5*-h.height,1]),o.translate(c,c,[1,-1,0]),o.multiply(c,c,h.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(c)}function Ve(h,r,c,p,_,x,E,I=!1){const k=h.tilesIn(p,E,I);k.sort(Bt);const B=[];for(const U of k)B.push({wrappedTileID:U.tile.tileID.wrapped().key,queryResults:U.tile.queryRenderedFeatures(r,c,h._state,U,_,x,ke(h.transform,U.tile.tileID),I)});const R=function(U){const W={},J={};for(const K of U){const Q=K.queryResults,te=K.wrappedTileID,Z=J[te]=J[te]||{};for(const le in Q){const se=Q[le],de=Z[le]=Z[le]||{},Se=W[le]=W[le]||[];for(const be of se)de[be.featureIndex]||(de[be.featureIndex]=!0,Se.push(be))}}return W}(B);for(const U in R)R[U].forEach(W=>{const J=W.feature,K=J.layer;K&&K.type!=="background"&&K.type!=="sky"&&(J.source=K.source,K["source-layer"]&&(J.sourceLayer=K["source-layer"]),J.state=J.id!==void 0?h.getFeatureState(K["source-layer"],J.id):{})});return R}function ct(h,r){const c=h.getRenderableIds().map(x=>h.getTileByID(x)),p=[],_={};for(let x=0;x<c.length;x++){const E=c[x],I=E.tileID.canonical.key;_[I]||(_[I]=!0,E.querySourceFeatures(p,r))}return p}function Bt(h,r){const c=h.tileID,p=r.tileID;return c.overscaledZ-p.overscaledZ||c.canonical.y-p.canonical.y||c.wrap-p.wrap||c.canonical.x-p.canonical.x}function gt(){return Fl.workerClass!=null?new Fl.workerClass:new o.window.Worker(Fl.workerUrl)}const en="mapboxgl_preloaded_worker_pool";class Jt{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Jt.workerCount;)this.workers.push(new gt);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[en]}numActive(){return Object.keys(this.active).length}}let Yt;function cn(){return Yt||(Yt=new Jt),Yt}function _n(h,r){const c={};for(const p in h)p!=="ref"&&(c[p]=h[p]);return o.refProperties.forEach(p=>{p in r&&(c[p]=r[p])}),c}function Gn(h){h=h.slice();const r=Object.create(null);for(let c=0;c<h.length;c++)r[h[c].id]=h[c];for(let c=0;c<h.length;c++)"ref"in h[c]&&(h[c]=_n(h[c],r[h[c].ref]));return h}Jt.workerCount=2;const on={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Jn(h,r,c){c.push({command:on.addSource,args:[h,r[h]]})}function Qn(h,r,c){r.push({command:on.removeSource,args:[h]}),c[h]=!0}function ss(h,r,c,p){Qn(h,c,p),Jn(h,r,c)}function Ro(h,r,c){let p;for(p in h[c])if(h[c].hasOwnProperty(p)&&p!=="data"&&!w(h[c][p],r[c][p]))return!1;for(p in r[c])if(r[c].hasOwnProperty(p)&&p!=="data"&&!w(h[c][p],r[c][p]))return!1;return!0}function et(h,r,c,p,_,x){let E;for(E in r=r||{},h=h||{})h.hasOwnProperty(E)&&(w(h[E],r[E])||c.push({command:x,args:[p,E,r[E],_]}));for(E in r)r.hasOwnProperty(E)&&!h.hasOwnProperty(E)&&(w(h[E],r[E])||c.push({command:x,args:[p,E,r[E],_]}))}function Oo(h){return h.id}function Oi(h,r){return h[r.id]=r,h}class as{constructor(r,c){this.reset(r,c)}reset(r,c){this.points=r||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=o.clamp(r,0,1);let c=1,p=this._distances[c];const _=r*this.paddedLength+this.padding;for(;p<_&&c<this._distances.length;)p=this._distances[++c];const x=c-1,E=this._distances[x],I=p-E,k=I>0?(_-E)/I:0;return this.points[x].mult(1-k).add(this.points[c].mult(k))}}class Ef{constructor(r,c,p){const _=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(r/p),this.yCellCount=Math.ceil(c/p);for(let E=0;E<this.xCellCount*this.yCellCount;E++)_.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=c,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,c,p,_,x){this._forEachCell(c,p,_,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(x)}insertCircle(r,c,p,_){this._forEachCell(c-_,p-_,c+_,p+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(c),this.circles.push(p),this.circles.push(_)}_insertBoxCell(r,c,p,_,x,E){this.boxCells[x].push(E)}_insertCircleCell(r,c,p,_,x,E){this.circleCells[x].push(E)}_query(r,c,p,_,x,E){if(p<0||r>this.width||_<0||c>this.height)return!x&&[];const I=[];if(r<=0&&c<=0&&this.width<=p&&this.height<=_){if(x)return!0;for(let k=0;k<this.boxKeys.length;k++)I.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const B=this.circles[3*k],R=this.circles[3*k+1],U=this.circles[3*k+2];I.push({key:this.circleKeys[k],x1:B-U,y1:R-U,x2:B+U,y2:R+U})}return E?I.filter(E):I}return this._forEachCell(r,c,p,_,this._queryCell,I,{hitTest:x,seenUids:{box:{},circle:{}}},E),x?I.length>0:I}_queryCircle(r,c,p,_,x){const E=r-p,I=r+p,k=c-p,B=c+p;if(I<0||E>this.width||B<0||k>this.height)return!_&&[];const R=[];return this._forEachCell(E,k,I,B,this._queryCellCircle,R,{hitTest:_,circle:{x:r,y:c,radius:p},seenUids:{box:{},circle:{}}},x),_?R.length>0:R}query(r,c,p,_,x){return this._query(r,c,p,_,!1,x)}hitTest(r,c,p,_,x){return this._query(r,c,p,_,!0,x)}hitTestCircle(r,c,p,_){return this._queryCircle(r,c,p,!0,_)}_queryCell(r,c,p,_,x,E,I,k){const B=I.seenUids,R=this.boxCells[x];if(R!==null){const W=this.bboxes;for(const J of R)if(!B.box[J]){B.box[J]=!0;const K=4*J;if(r<=W[K+2]&&c<=W[K+3]&&p>=W[K+0]&&_>=W[K+1]&&(!k||k(this.boxKeys[J]))){if(I.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[J],x1:W[K],y1:W[K+1],x2:W[K+2],y2:W[K+3]})}}}const U=this.circleCells[x];if(U!==null){const W=this.circles;for(const J of U)if(!B.circle[J]){B.circle[J]=!0;const K=3*J;if(this._circleAndRectCollide(W[K],W[K+1],W[K+2],r,c,p,_)&&(!k||k(this.circleKeys[J]))){if(I.hitTest)return E.push(!0),!0;{const Q=W[K],te=W[K+1],Z=W[K+2];E.push({key:this.circleKeys[J],x1:Q-Z,y1:te-Z,x2:Q+Z,y2:te+Z})}}}}}_queryCellCircle(r,c,p,_,x,E,I,k){const B=I.circle,R=I.seenUids,U=this.boxCells[x];if(U!==null){const J=this.bboxes;for(const K of U)if(!R.box[K]){R.box[K]=!0;const Q=4*K;if(this._circleAndRectCollide(B.x,B.y,B.radius,J[Q+0],J[Q+1],J[Q+2],J[Q+3])&&(!k||k(this.boxKeys[K])))return E.push(!0),!0}}const W=this.circleCells[x];if(W!==null){const J=this.circles;for(const K of W)if(!R.circle[K]){R.circle[K]=!0;const Q=3*K;if(this._circlesCollide(J[Q],J[Q+1],J[Q+2],B.x,B.y,B.radius)&&(!k||k(this.circleKeys[K])))return E.push(!0),!0}}}_forEachCell(r,c,p,_,x,E,I,k){const B=this._convertToXCellCoord(r),R=this._convertToYCellCoord(c),U=this._convertToXCellCoord(p),W=this._convertToYCellCoord(_);for(let J=B;J<=U;J++)for(let K=R;K<=W;K++)if(x.call(this,r,c,p,_,this.xCellCount*K+J,E,I,k))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,c,p,_,x,E){const I=_-r,k=x-c,B=p+E;return B*B>I*I+k*k}_circleAndRectCollide(r,c,p,_,x,E,I){const k=(E-_)/2,B=Math.abs(r-(_+k));if(B>k+p)return!1;const R=(I-x)/2,U=Math.abs(c-(x+R));if(U>R+p)return!1;if(B<=k||U<=R)return!0;const W=B-k,J=U-R;return W*W+J*J<=p*p}}const go=Math.tan(85*Math.PI/180);function va(h,r,c,p,_,x,E){const I=o.create();if(c)if(x.name==="globe"){const k=o.calculateGlobeLabelMatrix(_,r);o.multiply(I,I,k)}else{const k=Ee([],E);I[0]=k[0],I[1]=k[1],I[4]=k[2],I[5]=k[3],p||o.rotateZ(I,I,_.angle)}else o.multiply(I,_.labelPlaneMatrix,h);return I}function Cf(h,r,c,p,_,x,E){const I=va(h,r,c,p,_,x,E);return x.name==="globe"&&c||(I[2]=I[6]=I[10]=I[14]=0),I}function ya(h,r,c,p,_,x,E){if(c){if(x.name==="globe"){const I=va(h,r,c,p,_,x,E);return o.invert(I,I),o.multiply(I,h,I),I}{const I=o.clone(h),k=o.identity([]);return k[0]=E[0],k[1]=E[1],k[4]=E[2],k[5]=E[3],o.multiply(I,I,k),p||o.rotateZ(I,I,-_.angle),I}}return _.glCoordMatrix}function Et(h,r,c,p){const _=[h,r,c,1];c?o.transformMat4$1(_,_,p):If(_,_,p);const x=_[3];return _[0]/=x,_[1]/=x,_[2]/=x,_}function Pn(h,r){return Math.min(.5+h/r*.5,1.5)}function Cn(h,r){const c=h[0]/h[3],p=h[1]/h[3];return c>=-r[0]&&c<=r[0]&&p>=-r[1]&&p<=r[1]}function _o(h,r,c,p,_,x,E,I,k,B){const R=c.transform,U=p?h.textSizeData:h.iconSizeData,W=o.evaluateSizeForZoom(U,c.transform.zoom),J=R.projection.name==="globe",K=[256/c.width*2+1,256/c.height*2+1],Q=p?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;Q.clear();let te=null;J&&(te=p?h.text.globeExtVertexArray:h.icon.globeExtVertexArray);const Z=h.lineVertexArray,le=p?h.text.placedSymbolArray:h.icon.placedSymbolArray,se=c.transform.width/c.transform.height;let de,Se=!1;for(let be=0;be<le.length;be++){const Ae=le.get(be),{numGlyphs:Be,writingMode:Ne}=Ae;if(Ne!==o.WritingMode.vertical||Se||de===o.WritingMode.horizontal||(Se=!0),de=Ne,(Ae.hidden||Ne===o.WritingMode.vertical)&&!Se){ai(Be,Q);continue}Se=!1;const Ge=new o.pointGeometry(Ae.tileAnchorX,Ae.tileAnchorY);let{x:bt,y:Fe,z:rt}=R.projection.projectTilePoint(Ge.x,Ge.y,B.canonical);if(k){const[mn,Ut,Ft]=k(Ge);bt+=mn,Fe+=Ut,rt+=Ft}const He=[bt,Fe,rt,1];if(o.transformMat4$1(He,He,r),!Cn(He,K)){ai(Be,Q);continue}const ut=Pn(c.transform.cameraToCenterDistance,He[3]),Ue=o.evaluateSizeForFeature(U,W,Ae),Le=E?Ue/ut:Ue*ut,Ze=Et(bt,Fe,rt,_);if(Ze[3]<=0){ai(Be,Q);continue}let lt={};const mt=E?null:k,Wt=cl(Ae,Le,!1,I,r,_,x,h.glyphOffsetArray,Z,Q,te,Ze,Ge,lt,se,mt,R.projection,B,E);Se=Wt.useVertical,mt&&Wt.needsFlipping&&(lt={}),(Wt.notEnoughRoom||Se||Wt.needsFlipping&&cl(Ae,Le,!0,I,r,_,x,h.glyphOffsetArray,Z,Q,te,Ze,Ge,lt,se,mt,R.projection,B,E).notEnoughRoom)&&ai(Be,Q)}p?(h.text.dynamicLayoutVertexBuffer.updateData(Q),te&&h.text.globeExtVertexBuffer.updateData(te)):(h.icon.dynamicLayoutVertexBuffer.updateData(Q),te&&h.icon.globeExtVertexBuffer.updateData(te))}function $s(h,r,c,p,_,x,E,I,k,B,R,U,W,J,K,Q){const{lineStartIndex:te,glyphStartIndex:Z,segment:le}=I,se=Z+I.numGlyphs,de=te+I.lineLength,Se=r.getoffsetX(Z),be=r.getoffsetX(se-1),Ae=Cr(h*Se,c,p,_,x,E,le,te,de,k,B,R,U,W,!0,J,K,Q);if(!Ae)return null;const Be=Cr(h*be,c,p,_,x,E,le,te,de,k,B,R,U,W,!0,J,K,Q);return Be?{first:Ae,last:Be}:null}function bn(h,r,c,p){return h===o.WritingMode.horizontal&&Math.abs(p)>Math.abs(c)?{useVertical:!0}:h===o.WritingMode.vertical?p>0?{needsFlipping:!0}:null:r!==0&&function(_,x){return _===0||Math.abs(x/_)>go}(c,p)?r===1?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null}function cl(h,r,c,p,_,x,E,I,k,B,R,U,W,J,K,Q,te,Z,le){const se=r/24,de=h.lineOffsetX*se,Se=h.lineOffsetY*se,{lineStartIndex:be,glyphStartIndex:Ae,numGlyphs:Be,segment:Ne,writingMode:Ge,flipState:bt}=h,Fe=be+h.lineLength,rt=He=>{if(R){const[Ze,lt,mt]=He.up,Wt=B.length;o.updateGlobeVertexNormal(R,Wt+0,Ze,lt,mt),o.updateGlobeVertexNormal(R,Wt+1,Ze,lt,mt),o.updateGlobeVertexNormal(R,Wt+2,Ze,lt,mt),o.updateGlobeVertexNormal(R,Wt+3,Ze,lt,mt)}const[ut,Ue,Le]=He.point;o.addDynamicAttributes(B,ut,Ue,Le,He.angle)};if(Be>1){const He=$s(se,I,de,Se,c,U,W,h,k,x,J,Q,!1,te,Z,le);if(!He)return{notEnoughRoom:!0};if(p&&!c){let[ut,Ue,Le]=He.first.point,[Ze,lt,mt]=He.last.point;[ut,Ue]=Et(ut,Ue,Le,E),[Ze,lt]=Et(Ze,lt,mt,E);const Wt=bn(Ge,bt,(Ze-ut)*K,lt-Ue);if(h.flipState=Wt&&Wt.needsFlipping?1:2,Wt)return Wt}rt(He.first);for(let ut=Ae+1;ut<Ae+Be-1;ut++){const Ue=Cr(se*I.getoffsetX(ut),de,Se,c,U,W,Ne,be,Fe,k,x,J,Q,!1,!1,te,Z,le);if(!Ue)return B.length-=4*(ut-Ae),{notEnoughRoom:!0};rt(Ue)}rt(He.last)}else{if(p&&!c){const ut=Et(W.x,W.y,0,_),Ue=be+Ne+1,Le=new o.pointGeometry(k.getx(Ue),k.gety(Ue)),Ze=Et(Le.x,Le.y,0,_),lt=Ze[3]>0?Ze:ba(W,Le,ut,1,_,void 0,te,Z.canonical),mt=bn(Ge,bt,(lt[0]-ut[0])*K,lt[1]-ut[1]);if(h.flipState=mt&&mt.needsFlipping?1:2,mt)return mt}const He=Cr(se*I.getoffsetX(Ae),de,Se,c,U,W,Ne,be,Fe,k,x,J,Q,!1,!1,te,Z,le);if(!He)return{notEnoughRoom:!0};rt(He)}return{}}function xa(h,r,c,p,_){const{x,y:E,z:I}=p.projectTilePoint(h.x,h.y,r);if(!_)return Et(x,E,I,c);const[k,B,R]=_(h);return Et(x+k,E+B,I+R,c)}function ba(h,r,c,p,_,x,E,I){const k=xa(h.sub(r)._unit()._add(h),I,_,E,x);return o.sub(k,c,k),o.normalize(k,k),o.scaleAndAdd(k,c,k,p)}function Cr(h,r,c,p,_,x,E,I,k,B,R,U,W,J,K,Q,te,Z){const le=p?h-r:h+r;let se=le>0?1:-1,de=0;p&&(se*=-1,de=Math.PI),se<0&&(de+=Math.PI);let Se=I+E+(se>0?0:1)|0,be=_,Ae=_,Be=0,Ne=0;const Ge=Math.abs(le),bt=[],Fe=[];let rt=x,He=rt;const ut=()=>ba(He,rt,Ae,Ge-Be+1,R,W,Q,te.canonical);for(;Be+Ne<=Ge;){if(Se+=se,Se<I||Se>=k)return null;if(Ae=be,He=rt,bt.push(Ae),J&&Fe.push(He),rt=new o.pointGeometry(B.getx(Se),B.gety(Se)),be=U[Se],!be){const Ft=xa(rt,te.canonical,R,Q,W);be=Ft[3]>0?U[Se]=Ft:ut()}Be+=Ne,Ne=o.distance(Ae,be)}K&&W&&(U[Se]&&(be=ut(),Ne=o.distance(Ae,be)),U[Se]=be);const Ue=(Ge-Be)/Ne,Le=rt.sub(He)._mult(Ue)._add(He),Ze=o.sub([],be,Ae),lt=o.scaleAndAdd([],Ae,Ze,Ue);let mt=[0,0,1],Wt=Ze[0],mn=Ze[1];if(Z&&(mt=Q.upVector(te.canonical,Le.x,Le.y),mt[0]!==0||mt[1]!==0||mt[2]!==1)){const Ft=[mt[2],0,-mt[0]],Ht=o.cross([],mt,Ft);o.normalize(Ft,Ft),o.normalize(Ht,Ht),Wt=o.dot(Ze,Ft),mn=o.dot(Ze,Ht)}if(c){const Ft=o.cross([],mt,Ze);o.normalize(Ft,Ft),o.scaleAndAdd(lt,lt,Ft,c*se)}const Ut=de+Math.atan2(mn,Wt);return bt.push(lt),J&&Fe.push(Le),{point:lt,angle:Ut,path:bt,tilePath:Fe,up:mt}}function ai(h,r){const c=r.length,p=c+4*h;r.resize(p),r.float32.fill(-1/0,4*c,4*p)}function If(h,r,c){const p=r[0],_=r[1];return h[0]=c[0]*p+c[4]*_+c[12],h[1]=c[1]*p+c[5]*_+c[13],h[3]=c[3]*p+c[7]*_+c[15],h}const zr=100;class pd{constructor(r,c,p=new Ef(r.width+200,r.height+200,25),_=new Ef(r.width+200,r.height+200,25)){this.transform=r,this.grid=p,this.ignoredGrid=_,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+zr,this.screenBottomBoundary=r.height+zr,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=c}placeCollisionBox(r,c,p,_,x,E,I,k){let B=p.projectedAnchorX,R=p.projectedAnchorY,U=p.projectedAnchorZ;const W=p.elevation,J=p.tileID,K=r.getProjection();if(W&&J){const[be,Ae,Be]=K.upVector(J.canonical,p.tileAnchorX,p.tileAnchorY),Ne=K.upVectorScale(J.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;B+=be*W*Ne,R+=Ae*W*Ne,U+=Be*W*Ne}const Q=this.projectAndGetPerspectiveRatio(I,B,R,U,p.tileID,K.name==="globe"||!!W||this.transform.pitch>0,K),te=E*Q.perspectiveRatio,Z=(p.x1*c+_.x-p.padding)*te+Q.point.x,le=(p.y1*c+_.y-p.padding)*te+Q.point.y,se=(p.x2*c+_.x+p.padding)*te+Q.point.x,de=(p.y2*c+_.y+p.padding)*te+Q.point.y,Se=Q.perspectiveRatio<=.55||Q.occluded;return!this.isInsideGrid(Z,le,se,de)||!x&&this.grid.hitTest(Z,le,se,de,k)||Se?{box:[],offscreen:!1,occluded:Q.occluded}:{box:[Z,le,se,de],offscreen:this.isOffscreen(Z,le,se,de),occluded:!1}}placeCollisionCircles(r,c,p,_,x,E,I,k,B,R,U,W,J,K,Q){const te=[],Z=this.transform.elevation,le=r.getProjection(),se=Z?Z.getAtTileOffsetFunc(Q,this.transform.center.lat,this.transform.worldSize,le):null,de=new o.pointGeometry(p.tileAnchorX,p.tileAnchorY);let{x:Se,y:be,z:Ae}=le.projectTilePoint(de.x,de.y,Q.canonical);if(se){const[Le,Ze,lt]=se(de);Se+=Le,be+=Ze,Ae+=lt}const Be=le.name==="globe",Ne=this.projectAndGetPerspectiveRatio(I,Se,be,Ae,Q,Be||!!Z||this.transform.pitch>0,le),{perspectiveRatio:Ge}=Ne,bt=(U?E/Ge:E*Ge)/o.ONE_EM,Fe=Et(Se,be,Ae,k),rt=Ne.signedDistanceFromCamera>0?$s(bt,x,p.lineOffsetX*bt,p.lineOffsetY*bt,!1,Fe,de,p,_,k,{},Z&&!U?se:null,U&&!!Z,le,Q,U):null;let He=!1,ut=!1,Ue=!0;if(rt&&!Ne.occluded){const Le=.5*J*Ge+K,Ze=new o.pointGeometry(-100,-100),lt=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),mt=new as,{first:Wt,last:mn}=rt,Ut=Wt.path.length;let Ft=[];for(let Qt=Ut-1;Qt>=1;Qt--)Ft.push(Wt.path[Qt]);for(let Qt=1;Qt<mn.path.length;Qt++)Ft.push(mn.path[Qt]);const Ht=2.5*Le;B&&(Ft=Ft.map(([Qt,Zn,ei],li)=>(se&&!Be&&(ei=se(li<Ut-1?Wt.tilePath[Ut-1-li]:mn.tilePath[li-Ut+2])[2]),Et(Qt,Zn,ei,B))),Ft.some(Qt=>Qt[3]<=0)&&(Ft=[]));let In=[];if(Ft.length>0){let Qt=1/0,Zn=-1/0,ei=1/0,li=-1/0;for(const ri of Ft)Qt=Math.min(Qt,ri[0]),ei=Math.min(ei,ri[1]),Zn=Math.max(Zn,ri[0]),li=Math.max(li,ri[1]);Zn>=Ze.x&&Qt<=lt.x&&li>=Ze.y&&ei<=lt.y&&(In=[Ft.map(ri=>new o.pointGeometry(ri[0],ri[1]))],(Qt<Ze.x||Zn>lt.x||ei<Ze.y||li>lt.y)&&(In=o.clipLine(In,Ze.x,Ze.y,lt.x,lt.y)))}for(const Qt of In){mt.reset(Qt,.25*Le);let Zn=0;Zn=mt.length<=.5*Le?1:Math.ceil(mt.paddedLength/Ht)+1;for(let ei=0;ei<Zn;ei++){const li=ei/Math.max(Zn-1,1),ri=mt.lerp(li),Fi=ri.x+zr,Br=ri.y+zr;te.push(Fi,Br,Le,0);const ro=Fi-Le,No=Br-Le,gi=Fi+Le,oi=Br+Le;if(Ue=Ue&&this.isOffscreen(ro,No,gi,oi),ut=ut||this.isInsideGrid(ro,No,gi,oi),!c&&this.grid.hitTestCircle(Fi,Br,Le,W)&&(He=!0,!R))return{circles:[],offscreen:!1,collisionDetected:He,occluded:!1}}}}return{circles:!R&&He||!ut?[]:te,offscreen:Ue,collisionDetected:He,occluded:Ne.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let p=1/0,_=1/0,x=-1/0,E=-1/0;for(const R of r){const U=new o.pointGeometry(R.x+zr,R.y+zr);p=Math.min(p,U.x),_=Math.min(_,U.y),x=Math.max(x,U.x),E=Math.max(E,U.y),c.push(U)}const I=this.grid.query(p,_,x,E).concat(this.ignoredGrid.query(p,_,x,E)),k={},B={};for(const R of I){const U=R.key;if(k[U.bucketInstanceId]===void 0&&(k[U.bucketInstanceId]={}),k[U.bucketInstanceId][U.featureIndex])continue;const W=[new o.pointGeometry(R.x1,R.y1),new o.pointGeometry(R.x2,R.y1),new o.pointGeometry(R.x2,R.y2),new o.pointGeometry(R.x1,R.y2)];o.polygonIntersectsPolygon(c,W)&&(k[U.bucketInstanceId][U.featureIndex]=!0,B[U.bucketInstanceId]===void 0&&(B[U.bucketInstanceId]=[]),B[U.bucketInstanceId].push(U.featureIndex))}return B}insertCollisionBox(r,c,p,_,x){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:_,collisionGroupID:x},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,c,p,_,x){const E=c?this.ignoredGrid:this.grid,I={bucketInstanceId:p,featureIndex:_,collisionGroupID:x};for(let k=0;k<r.length;k+=4)E.insertCircle(I,r[k],r[k+1],r[k+2])}projectAndGetPerspectiveRatio(r,c,p,_,x,E,I){const k=[c,p,_,1];let B=!1;if(_||this.transform.pitch>0){o.transformMat4$1(k,k,r);const U=I.name==="globe";this.fogState&&x&&!U&&(B=function(J,K,Q,te,Z,le){const se=le.calculateFogTileMatrix(Z),de=[K,Q,te];return o.transformMat4(de,de,se),at(J,de,le.pitch,le._fov)}(this.fogState,c,p,_,x.toUnwrapped(),this.transform)>.9)}else If(k,k,r);const R=k[3];return{point:new o.pointGeometry((k[0]/R+1)/2*this.transform.width+zr,(-k[1]/R+1)/2*this.transform.height+zr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/R*.5,1.5),signedDistanceFromCamera:R,occluded:E&&k[2]>R||B}}isOffscreen(r,c,p,_){return p<zr||r>=this.screenRightBoundary||_<zr||c>this.screenBottomBoundary}isInsideGrid(r,c,p,_){return p>=0&&r<this.gridRightBoundary&&_>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const r=o.identity([]);return o.translate(r,r,[-100,-100,0]),r}}function Ns(h,r,c){const p=r.createTileMatrix(h,h.worldSize,c.toUnwrapped());return o.multiply(new Float32Array(16),h.projMatrix,p)}function md(h,r,c){if(r.projection.name===c.projection.name)return h.projMatrix;const p=c.clone();return p.setProjection(r.projection),Ns(p,r.getProjection(),h)}function Lc(h,r,c){return r.name===c.projection.name?h.projMatrix:Ns(c,r,h)}class ul{constructor(r,c,p,_){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?c:-c))):_&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class Us{constructor(r,c,p,_,x,E=!1){this.text=new ul(r?r.text:null,c,p,x),this.icon=new ul(r?r.icon:null,c,_,x),this.clipped=E}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class wa{constructor(r,c,p,_=!1){this.text=r,this.icon=c,this.skipFade=p,this.clipped=_}}class gd{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class Lr{constructor(r,c,p,_,x){this.bucketInstanceId=r,this.featureIndex=c,this.sourceLayerIndex=p,this.bucketIndex=_,this.tileID=x}}class zi{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const c=++this.maxGroupID;this.collisionGroups[r]={ID:c,predicate:p=>p.collisionGroupID===c}}return this.collisionGroups[r]}}function Dc(h,r,c,p,_){const{horizontalAlign:x,verticalAlign:E}=o.getAnchorAlignment(h),I=-(x-.5)*r,k=-(E-.5)*c,B=o.evaluateVariableOffset(h,p);return new o.pointGeometry(I+B[0]*_,k+B[1]*_)}function dl(h,r,c,p,_){const x=new o.pointGeometry(h,r);return c&&x._rotate(p?_:-_),x}class Dr{constructor(r,c,p,_,x){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new pd(this.transform,x),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new zi(p),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,c,p,_){const x=p.getBucket(c),E=p.latestFeatureIndex;if(!x||!E||c.id!==x.layerIds[0])return;const I=x.layers[0].layout,k=p.collisionBoxArray,B=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),R=p.tileSize/o.EXTENT,U=p.tileID.toUnwrapped();this.transform.setProjection(x.projection);const W=(J=p.tileID,K=x.getProjection(),Q=this.transform,K.name===this.projection?Q.calculateProjMatrix(J.toUnwrapped()):Ns(Q,K,J));var J,K,Q;const te=I.get("text-pitch-alignment")==="map",Z=I.get("text-rotation-alignment")==="map";c.compileFilter();const le=c.dynamicFilter(),se=c.dynamicFilterNeedsFeature(),de=this.transform.calculatePixelsToTileUnitsMatrix(p),Se=Cf(W,p.tileID.canonical,te,Z,this.transform,x.getProjection(),de);let be=null;if(te){const Ne=ya(W,p.tileID.canonical,te,Z,this.transform,x.getProjection(),de);be=o.multiply([],this.transform.labelPlaneMatrix,Ne)}let Ae=null;le&&p.latestFeatureIndex&&(Ae={unwrappedTileID:U,dynamicFilter:le,dynamicFilterNeedsFeature:se,featureIndex:p.latestFeatureIndex}),this.retainedQueryData[x.bucketInstanceId]=new Lr(x.bucketInstanceId,E,x.sourceLayerIndex,x.index,p.tileID);const Be={bucket:x,layout:I,posMatrix:W,textLabelPlaneMatrix:Se,labelToScreenMatrix:be,clippingData:Ae,scale:B,textPixelRatio:R,holdingForFade:p.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(x.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.evaluateSizeForZoom(x.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(_)for(const Ne of x.sortKeyRanges){const{sortKey:Ge,symbolInstanceStart:bt,symbolInstanceEnd:Fe}=Ne;r.push({sortKey:Ge,symbolInstanceStart:bt,symbolInstanceEnd:Fe,parameters:Be})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:Be})}attemptAnchorPlacement(r,c,p,_,x,E,I,k,B,R,U,W,J,K,Q,te,Z,le){const{textOffset0:se,textOffset1:de,crossTileID:Se}=W,be=[se,de],Ae=Dc(r,p,_,be,x),Be=this.collisionIndex.placeCollisionBox(K,x,c,dl(Ae.x,Ae.y,E,I,this.transform.angle),U,k,B,R.predicate);if(te){const Ne=K.getSymbolInstanceIconSize(le,this.transform.zoom,W.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(K,Ne,te,dl(Ae.x,Ae.y,E,I,this.transform.angle),U,k,B,R.predicate).box.length===0)return}if(Be.box.length>0){let Ne;return this.prevPlacement&&this.prevPlacement.variableOffsets[Se]&&this.prevPlacement.placements[Se]&&this.prevPlacement.placements[Se].text&&(Ne=this.prevPlacement.variableOffsets[Se].anchor),this.variableOffsets[Se]={textOffset:be,width:p,height:_,anchor:r,textScale:x,prevAnchor:Ne},this.markUsedJustification(K,r,W,Q),K.allowVerticalPlacement&&(this.markUsedOrientation(K,Q,W),this.placedOrientations[Se]=Q),{shift:Ae,placedGlyphBoxes:Be}}}placeLayerBucketPart(r,c,p,_){const{bucket:x,layout:E,posMatrix:I,textLabelPlaneMatrix:k,labelToScreenMatrix:B,clippingData:R,textPixelRatio:U,holdingForFade:W,collisionBoxArray:J,partiallyEvaluatedTextSize:K,partiallyEvaluatedIconSize:Q,collisionGroup:te}=r.parameters,Z=E.get("text-optional"),le=E.get("icon-optional"),se=E.get("text-allow-overlap"),de=E.get("icon-allow-overlap"),Se=E.get("text-rotation-alignment")==="map",be=E.get("text-pitch-alignment")==="map",Ae=E.get("icon-text-fit")!=="none",Be=E.get("symbol-z-order")==="viewport-y";this.transform.setProjection(x.projection);let Ne=se&&(de||!x.hasIconData()||le),Ge=de&&(se||!x.hasTextData()||Z);!x.collisionArrays&&J&&x.deserializeCollisionBoxes(J),p&&_&&x.updateCollisionDebugBuffers(this.transform.zoom,J);const bt=(Fe,rt,He)=>{const{crossTileID:ut,numVerticalGlyphVertices:Ue}=Fe;if(R){const gi={zoom:this.transform.zoom,pitch:this.transform.pitch};let oi=null;if(R.dynamicFilterNeedsFeature){const $n=this.retainedQueryData[x.bucketInstanceId];oi=R.featureIndex.loadFeature({featureIndex:Fe.featureIndex,bucketIndex:$n.bucketIndex,sourceLayerIndex:$n.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,R.dynamicFilter)(gi,oi,this.retainedQueryData[x.bucketInstanceId].tileID.canonical,new o.pointGeometry(Fe.tileAnchorX,Fe.tileAnchorY),this.transform.calculateDistanceTileData(R.unwrappedTileID)))return this.placements[ut]=new wa(!1,!1,!1,!0),void(c[ut]=!0)}if(c[ut])return;if(W)return void(this.placements[ut]=new wa(!1,!1,!1));let Le=!1,Ze=!1,lt=!0,mt=!1,Wt=!1,mn=null,Ut={box:null,offscreen:null,occluded:null},Ft={box:null,offscreen:null,occluded:null},Ht=null,In=null,Qt=null,Zn=0,ei=0,li=0;He.textFeatureIndex?Zn=He.textFeatureIndex:Fe.useRuntimeCollisionCircles&&(Zn=Fe.featureIndex),He.verticalTextFeatureIndex&&(ei=He.verticalTextFeatureIndex);const ri=gi=>{gi.tileID=this.retainedQueryData[x.bucketInstanceId].tileID;const oi=this.transform.elevation;(oi||gi.elevation)&&(gi.elevation=oi?oi.getAtTileOffset(gi.tileID,gi.tileAnchorX,gi.tileAnchorY):0)},Fi=He.textBox;if(Fi){ri(Fi);const gi=$n=>{let Ii=o.WritingMode.horizontal;if(x.allowVerticalPlacement&&!$n&&this.prevPlacement){const vr=this.prevPlacement.placedOrientations[ut];vr&&(this.placedOrientations[ut]=vr,Ii=vr,this.markUsedOrientation(x,Ii,Fe))}return Ii},oi=($n,Ii)=>{if(x.allowVerticalPlacement&&Ue>0&&He.verticalTextBox){for(const vr of x.writingModes)if(vr===o.WritingMode.vertical?(Ut=Ii(),Ft=Ut):Ut=$n(),Ut&&Ut.box&&Ut.box.length)break}else Ut=$n()};if(E.get("text-variable-anchor")){let $n=E.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ut]){const di=this.prevPlacement.variableOffsets[ut];$n.indexOf(di.anchor)>0&&($n=$n.filter(yr=>yr!==di.anchor),$n.unshift(di.anchor))}const Ii=(di,yr,xr)=>{const hs=x.getSymbolInstanceTextSize(K,Fe,this.transform.zoom,rt),Fa=(di.x2-di.x1)*hs+2*di.padding,qr=(di.y2-di.y1)*hs+2*di.padding,Xr=Ae&&!de?yr:null;Xr&&ri(Xr);let Uo={box:[],offscreen:!1,occluded:!1};const fs=se?2*$n.length:$n.length;for(let ps=0;ps<fs;++ps){const Va=this.attemptAnchorPlacement($n[ps%$n.length],di,Fa,qr,hs,Se,be,U,I,te,ps>=$n.length,Fe,rt,x,xr,Xr,K,Q);if(Va&&(Uo=Va.placedGlyphBoxes,Uo&&Uo.box&&Uo.box.length)){Le=!0,mn=Va.shift;break}}return Uo};oi(()=>Ii(Fi,He.iconBox,o.WritingMode.horizontal),()=>{const di=He.verticalTextBox;return di&&ri(di),x.allowVerticalPlacement&&!(Ut&&Ut.box&&Ut.box.length)&&Ue>0&&di?Ii(di,He.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Ut&&(Le=Ut.box,lt=Ut.offscreen,mt=Ut.occluded);const vr=gi(Ut&&Ut.box);if(!Le&&this.prevPlacement){const di=this.prevPlacement.variableOffsets[ut];di&&(this.variableOffsets[ut]=di,this.markUsedJustification(x,di.anchor,Fe,vr))}}else{const $n=(Ii,vr)=>{const di=x.getSymbolInstanceTextSize(K,Fe,this.transform.zoom,rt),yr=this.collisionIndex.placeCollisionBox(x,di,Ii,new o.pointGeometry(0,0),se,U,I,te.predicate);return yr&&yr.box&&yr.box.length&&(this.markUsedOrientation(x,vr,Fe),this.placedOrientations[ut]=vr),yr};oi(()=>$n(Fi,o.WritingMode.horizontal),()=>{const Ii=He.verticalTextBox;return x.allowVerticalPlacement&&Ue>0&&Ii?(ri(Ii),$n(Ii,o.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),gi(Ut&&Ut.box&&Ut.box.length)}}if(Ht=Ut,Le=Ht&&Ht.box&&Ht.box.length>0,lt=Ht&&Ht.offscreen,mt=Ht&&Ht.occluded,Fe.useRuntimeCollisionCircles){const gi=x.text.placedSymbolArray.get(Fe.centerJustifiedTextSymbolIndex>=0?Fe.centerJustifiedTextSymbolIndex:Fe.verticalPlacedTextSymbolIndex),oi=o.evaluateSizeForFeature(x.textSizeData,K,gi),$n=E.get("text-padding");In=this.collisionIndex.placeCollisionCircles(x,se,gi,x.lineVertexArray,x.glyphOffsetArray,oi,I,k,B,p,be,te.predicate,Fe.collisionCircleDiameter*oi/o.ONE_EM,$n,this.retainedQueryData[x.bucketInstanceId].tileID),Le=se||In.circles.length>0&&!In.collisionDetected,lt=lt&&In.offscreen,mt=In.occluded}if(He.iconFeatureIndex&&(li=He.iconFeatureIndex),He.iconBox){const gi=oi=>{ri(oi);const $n=Ae&&mn?dl(mn.x,mn.y,Se,be,this.transform.angle):new o.pointGeometry(0,0),Ii=x.getSymbolInstanceIconSize(Q,this.transform.zoom,Fe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(x,Ii,oi,$n,de,U,I,te.predicate)};Ft&&Ft.box&&Ft.box.length&&He.verticalIconBox?(Qt=gi(He.verticalIconBox),Ze=Qt.box.length>0):(Qt=gi(He.iconBox),Ze=Qt.box.length>0),lt=lt&&Qt.offscreen,Wt=Qt.occluded}const Br=Z||Fe.numHorizontalGlyphVertices===0&&Ue===0,ro=le||Fe.numIconVertices===0;if(Br||ro?ro?Br||(Ze=Ze&&Le):Le=Ze&&Le:Ze=Le=Ze&&Le,Le&&Ht&&Ht.box&&this.collisionIndex.insertCollisionBox(Ht.box,E.get("text-ignore-placement"),x.bucketInstanceId,Ft&&Ft.box&&ei?ei:Zn,te.ID),Ze&&Qt&&this.collisionIndex.insertCollisionBox(Qt.box,E.get("icon-ignore-placement"),x.bucketInstanceId,li,te.ID),In&&(Le&&this.collisionIndex.insertCollisionCircles(In.circles,E.get("text-ignore-placement"),x.bucketInstanceId,Zn,te.ID),p)){const gi=x.bucketInstanceId;let oi=this.collisionCircleArrays[gi];oi===void 0&&(oi=this.collisionCircleArrays[gi]=new gd);for(let $n=0;$n<In.circles.length;$n+=4)oi.circles.push(In.circles[$n+0]),oi.circles.push(In.circles[$n+1]),oi.circles.push(In.circles[$n+2]),oi.circles.push(In.collisionDetected?1:0)}const No=x.projection.name!=="globe";Ne=Ne&&(No||!mt),Ge=Ge&&(No||!Wt),this.placements[ut]=new wa(Le||Ne,Ze||Ge,lt||x.justReloaded),c[ut]=!0};if(Be){const Fe=x.getSortedSymbolIndexes(this.transform.angle);for(let rt=Fe.length-1;rt>=0;--rt){const He=Fe[rt];bt(x.symbolInstances.get(He),He,x.collisionArrays[He])}}else for(let Fe=r.symbolInstanceStart;Fe<r.symbolInstanceEnd;Fe++)bt(x.symbolInstances.get(Fe),Fe,x.collisionArrays[Fe]);if(p&&x.bucketInstanceId in this.collisionCircleArrays){const Fe=this.collisionCircleArrays[x.bucketInstanceId];o.invert(Fe.invProjMatrix,I),Fe.viewportMatrix=this.collisionIndex.getViewportMatrix()}x.justReloaded=!1}markUsedJustification(r,c,p,_){const{leftJustifiedTextSymbolIndex:x,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:k,crossTileID:B}=p,R=o.getAnchorJustification(c),U=_===o.WritingMode.vertical?k:R==="left"?x:R==="center"?E:R==="right"?I:-1;x>=0&&(r.text.placedSymbolArray.get(x).crossTileID=U>=0&&x!==U?0:B),E>=0&&(r.text.placedSymbolArray.get(E).crossTileID=U>=0&&E!==U?0:B),I>=0&&(r.text.placedSymbolArray.get(I).crossTileID=U>=0&&I!==U?0:B),k>=0&&(r.text.placedSymbolArray.get(k).crossTileID=U>=0&&k!==U?0:B)}markUsedOrientation(r,c,p){const _=c===o.WritingMode.horizontal||c===o.WritingMode.horizontalOnly?c:0,x=c===o.WritingMode.vertical?c:0,{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:k,verticalPlacedTextSymbolIndex:B}=p,R=r.text.placedSymbolArray;E>=0&&(R.get(E).placedOrientation=_),I>=0&&(R.get(I).placedOrientation=_),k>=0&&(R.get(k).placedOrientation=_),B>=0&&(R.get(B).placedOrientation=x)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let p=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const _=c?c.symbolFadeChange(r):1,x=c?c.opacities:{},E=c?c.variableOffsets:{},I=c?c.placedOrientations:{};for(const k in this.placements){const B=this.placements[k],R=x[k];R?(this.opacities[k]=new Us(R,_,B.text,B.icon,null,B.clipped),p=p||B.text!==R.text.placed||B.icon!==R.icon.placed):(this.opacities[k]=new Us(null,_,B.text,B.icon,B.skipFade,B.clipped),p=p||B.text||B.icon)}for(const k in x){const B=x[k];if(!this.opacities[k]){const R=new Us(B,_,!1,!1);R.isHidden()||(this.opacities[k]=R,p=p||B.text.placed||B.icon.placed)}}for(const k in E)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=E[k]);for(const k in I)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=I[k]);p?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:r)}updateLayerOpacities(r,c){const p={};for(const _ of c){const x=_.getBucket(r);x&&_.latestFeatureIndex&&r.id===x.layerIds[0]&&this.updateBucketOpacities(x,p,_.collisionBoxArray)}}updateBucketOpacities(r,c,p){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const _=r.layers[0].layout,x=!!r.layers[0].dynamicFilter(),E=new Us(null,0,!1,!1,!0),I=_.get("text-allow-overlap"),k=_.get("icon-allow-overlap"),B=_.get("text-variable-anchor"),R=_.get("text-rotation-alignment")==="map",U=_.get("text-pitch-alignment")==="map",W=_.get("icon-text-fit")!=="none",J=new Us(null,0,I&&(k||!r.hasIconData()||_.get("icon-optional")),k&&(I||!r.hasTextData()||_.get("text-optional")),!0);!r.collisionArrays&&p&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(p);const K=(te,Z,le)=>{for(let se=0;se<Z/4;se++)te.opacityVertexArray.emplaceBack(le)};let Q=0;for(let te=0;te<r.symbolInstances.length;te++){const Z=r.symbolInstances.get(te),{numHorizontalGlyphVertices:le,numVerticalGlyphVertices:se,crossTileID:de,numIconVertices:Se}=Z;let be=this.opacities[de];c[de]?be=E:be||(be=J,this.opacities[de]=be),c[de]=!0;const Ae=le>0||se>0,Be=Se>0,Ne=this.placedOrientations[de],Ge=Ne===o.WritingMode.vertical,bt=Ne===o.WritingMode.horizontal||Ne===o.WritingMode.horizontalOnly;if(!Ae&&!Be||be.isHidden()||Q++,Ae){const Fe=Rc(be.text);K(r.text,le,Ge?Ta:Fe),K(r.text,se,bt?Ta:Fe);const rt=be.text.isHidden(),{leftJustifiedTextSymbolIndex:He,centerJustifiedTextSymbolIndex:ut,rightJustifiedTextSymbolIndex:Ue,verticalPlacedTextSymbolIndex:Le}=Z,Ze=r.text.placedSymbolArray,lt=rt||Ge?1:0;He>=0&&(Ze.get(He).hidden=lt),ut>=0&&(Ze.get(ut).hidden=lt),Ue>=0&&(Ze.get(Ue).hidden=lt),Le>=0&&(Ze.get(Le).hidden=rt||bt?1:0);const mt=this.variableOffsets[de];mt&&this.markUsedJustification(r,mt.anchor,Z,Ne);const Wt=this.placedOrientations[de];Wt&&(this.markUsedJustification(r,"left",Z,Wt),this.markUsedOrientation(r,Wt,Z))}if(Be){const Fe=Rc(be.icon),{placedIconSymbolIndex:rt,verticalPlacedIconSymbolIndex:He}=Z,ut=r.icon.placedSymbolArray,Ue=be.icon.isHidden()?1:0;rt>=0&&(K(r.icon,Se,Ge?Ta:Fe),ut.get(rt).hidden=Ue),He>=0&&(K(r.icon,Z.numVerticalIconVertices,bt?Ta:Fe),ut.get(He).hidden=Ue)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Fe=r.collisionArrays[te];if(Fe){let rt=new o.pointGeometry(0,0),He=!0;if(Fe.textBox||Fe.verticalTextBox){if(B){const Ue=this.variableOffsets[de];Ue?(rt=Dc(Ue.anchor,Ue.width,Ue.height,Ue.textOffset,Ue.textScale),R&&rt._rotate(U?this.transform.angle:-this.transform.angle)):He=!1}x&&(He=!be.clipped),Fe.textBox&&Ir(r.textCollisionBox.collisionVertexArray,be.text.placed,!He||Ge,rt.x,rt.y),Fe.verticalTextBox&&Ir(r.textCollisionBox.collisionVertexArray,be.text.placed,!He||bt,rt.x,rt.y)}const ut=He&&Boolean(!bt&&Fe.verticalIconBox);Fe.iconBox&&Ir(r.iconCollisionBox.collisionVertexArray,be.icon.placed,ut,W?rt.x:0,W?rt.y:0),Fe.verticalIconBox&&Ir(r.iconCollisionBox.collisionVertexArray,be.icon.placed,!ut,W?rt.x:0,W?rt.y:0)}}}if(r.fullyClipped=Q===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const te=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=te.invProjMatrix,r.placementViewportMatrix=te.viewportMatrix,r.collisionCircleArray=te.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,c){const p=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*p>r}setStale(){this.stale=!0}}function Ir(h,r,c,p,_){h.emplaceBack(r?1:0,c?1:0,p||0,_||0),h.emplaceBack(r?1:0,c?1:0,p||0,_||0),h.emplaceBack(r?1:0,c?1:0,p||0,_||0),h.emplaceBack(r?1:0,c?1:0,p||0,_||0)}const Af=Math.pow(2,25),Bc=Math.pow(2,24),Hi=Math.pow(2,17),hl=Math.pow(2,16),_d=Math.pow(2,9),fl=Math.pow(2,8),lr=Math.pow(2,1);function Rc(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const r=h.placed?1:0,c=Math.floor(127*h.opacity);return c*Af+r*Bc+c*Hi+r*hl+c*_d+r*fl+c*lr+r}const Ta=0;class Fo{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,c,p,_,x){const E=this._bucketParts;for(;this._currentTileIndex<r.length;)if(c.getBucketParts(E,_,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((I,k)=>I.sortKey-k.sortKey));this._currentPartIndex<E.length;){const I=E[this._currentPartIndex];if(c.placeLayerBucketPart(I,this._seenCrossTileIDs,p,I.symbolInstanceStart===0),this._currentPartIndex++,x())return!0}return!1}}class pl{constructor(r,c,p,_,x,E,I,k){this.placement=new Dr(r,x,E,I,k),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(r,c,p){const _=o.exported.now(),x=()=>{const E=o.exported.now()-_;return!this._forceFullPlacement&&E>2};for(;this._currentPlacementIndex>=0;){const E=c[r[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=I)&&(!E.maxzoom||E.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Fo(E)),this._inProgressLayer.continuePlacement(p[E.source],this.placement,this._showCollisionBoxes,E,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Oc=512/o.EXTENT/2;class xg{constructor(r,c,p){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=p;for(let _=0;_<c.length;_++){const x=c.get(_),E=x.key;this.indexedSymbolInstances[E]||(this.indexedSymbolInstances[E]=[]),this.indexedSymbolInstances[E].push({crossTileID:x.crossTileID,coord:this.getScaledCoordinates(x,r)})}}getScaledCoordinates(r,c){const p=Oc/Math.pow(2,c.canonical.z-this.tileID.canonical.z);return{x:Math.floor((c.canonical.x*o.EXTENT+r.tileAnchorX)*p),y:Math.floor((c.canonical.y*o.EXTENT+r.tileAnchorY)*p)}}findMatches(r,c,p){const _=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let x=0;x<r.length;x++){const E=r.get(x);if(E.crossTileID)continue;const I=this.indexedSymbolInstances[E.key];if(!I)continue;const k=this.getScaledCoordinates(E,c);for(const B of I)if(Math.abs(B.coord.x-k.x)<=_&&Math.abs(B.coord.y-k.y)<=_&&!p[B.crossTileID]){p[B.crossTileID]=!0,E.crossTileID=B.crossTileID;break}}}}class vd{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Sa{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const c=Math.round((r-this.lng)/360);if(c!==0)for(const p in this.indexes){const _=this.indexes[p],x={};for(const E in _){const I=_[E];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+c),x[I.tileID.key]=I}this.indexes[p]=x}this.lng=r}addBucket(r,c,p){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let x=0;x<c.symbolInstances.length;x++)c.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const _=this.usedCrossTileIDs[r.overscaledZ];for(const x in this.indexes){const E=this.indexes[x];if(Number(x)>r.overscaledZ)for(const I in E){const k=E[I];k.tileID.isChildOf(r)&&k.findMatches(c.symbolInstances,r,_)}else{const I=E[r.scaledTo(Number(x)).key];I&&I.findMatches(c.symbolInstances,r,_)}}for(let x=0;x<c.symbolInstances.length;x++){const E=c.symbolInstances.get(x);E.crossTileID||(E.crossTileID=p.generate(),_[E.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new xg(r,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(r,c){for(const p in c.indexedSymbolInstances)for(const _ of c.indexedSymbolInstances[p])delete this.usedCrossTileIDs[r][_.crossTileID]}removeStaleBuckets(r){let c=!1;for(const p in this.indexes){const _=this.indexes[p];for(const x in _)r[_[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,_[x]),delete _[x],c=!0)}return c}}class kf{constructor(){this.layerIndexes={},this.crossTileIDs=new vd,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,c,p,_){let x=this.layerIndexes[r.id];x===void 0&&(x=this.layerIndexes[r.id]=new Sa);let E=!1;const I={};_.name!=="globe"&&x.handleWrapJump(p);for(const k of c){const B=k.getBucket(r);B&&r.id===B.layerIds[0]&&(B.bucketInstanceId||(B.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket(k.tileID,B,this.crossTileIDs)&&(E=!0),I[B.bucketInstanceId]=!0)}return x.removeStaleBuckets(I)&&(E=!0),E}pruneUnusedLayers(r){const c={};r.forEach(p=>{c[p]=!0});for(const p in this.layerIndexes)c[p]||delete this.layerIndexes[p]}}const ml=(h,r)=>o.emitValidationErrors(h,r&&r.filter(c=>c.identifier!=="source.canvas")),Ea=o.pick(on,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),ls=o.pick(on,["setCenter","setZoom","setBearing","setPitch"]),Fc={version:8,layers:[],sources:{}},cs={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Wr extends o.Evented{constructor(r,c={}){super(),this.map=r,this.dispatcher=new zn(cn(),this),this.imageManager=new Oe,this.imageManager.setEventedParent(this),this.glyphManager=new o.GlyphManager(r._requestManager,c.localFontFamily?o.LocalGlyphMode.all:c.localIdeographFontFamily?o.LocalGlyphMode.ideographs:o.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.crossTileSymbolIndex=new kf,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const p=this;this._rtlTextPluginCallback=Wr.registerForPluginStateChange(_=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(x,E)=>{if(o.triggerPluginCompletionEvent(x),E&&E.every(I=>I))for(const I in p._sourceCaches){const k=p._sourceCaches[I],B=k.getSource().type;B!=="vector"&&B!=="geojson"||k.reload()}})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const x=this.getSource(_.sourceId);if(x&&x.vectorLayerIds)for(const E in this._layers){const I=this._layers[E];I.source===x.id&&this._validateLayer(I)}})}loadURL(r,c={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const p=typeof c.validate=="boolean"?c.validate:!o.isMapboxURL(r);r=this.map._requestManager.normalizeStyleURL(r,c.accessToken);const _=this.map._requestManager.transformRequest(r,o.ResourceType.Style);this._request=o.getJSON(_,(x,E)=>{this._request=null,x?this.fire(new o.ErrorEvent(x)):E&&this._load(E,p)})}loadJSON(r,c={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(r,c.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Fc,!1)}_updateLayerCount(r,c){const p=c?1:-1;r.is3D()&&(this._num3DLayers+=p),r.type==="circle"&&(this._numCircleLayers+=p),r.type==="symbol"&&(this._numSymbolLayers+=p)}_load(r,c){if(c&&ml(this,o.validateStyle(r)))return;this._loaded=!0,this.stylesheet=o.clone$1(r),this._updateMapProjection();for(const _ in r.sources)this.addSource(_,r.sources[_],{validate:!1});this._changed=!1,r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(r.glyphs);const p=Gn(this.stylesheet.layers);this._order=p.map(_=>_.id),this._layers={},this._serializedLayers={};for(let _ of p)_=o.createStyleLayer(_),_.setEventedParent(this,{layer:{id:_.id}}),this._layers[_.id]=_,this._serializedLayers[_.id]=_.serialize(),this._updateLayerCount(_,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ht(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(r){this._spriteRequest=function(c,p,_){let x,E,I;const k=o.exported.devicePixelRatio>1?"@2x":"";let B=o.getJSON(p.transformRequest(p.normalizeSpriteURL(c,k,".json"),o.ResourceType.SpriteJSON),(W,J)=>{B=null,I||(I=W,x=J,U())}),R=o.getImage(p.transformRequest(p.normalizeSpriteURL(c,k,".png"),o.ResourceType.SpriteImage),(W,J)=>{R=null,I||(I=W,E=J,U())});function U(){if(I)_(I);else if(x&&E){const W=o.exported.getImageData(E),J={};for(const K in x){const{width:Q,height:te,x:Z,y:le,sdf:se,pixelRatio:de,stretchX:Se,stretchY:be,content:Ae}=x[K],Be=new o.RGBAImage({width:Q,height:te});o.RGBAImage.copy(W,Be,{x:Z,y:le},{x:0,y:0},{width:Q,height:te}),J[K]={data:Be,pixelRatio:de,sdf:se,stretchX:Se,stretchY:be,content:Ae}}_(null,J)}}return{cancel(){B&&(B.cancel(),B=null),R&&(R.cancel(),R=null)}}}(r,this.map._requestManager,(c,p)=>{if(this._spriteRequest=null,c)this.fire(new o.ErrorEvent(c));else if(p)for(const _ in p)this.imageManager.addImage(_,p[_]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(r){const c=this.getSource(r.source);if(!c)return;const p=r.sourceLayer;p&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(p)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${c.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const c=[];for(const p of r){const _=this._layers[p];_.type!=="custom"&&c.push(_.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(r){return!!this.terrain&&(typeof r.isLayerDraped=="function"?r.isLayerDraped():cs[r.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(r){if(!this._loaded)return;const c=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(_.length||x.length)&&this._updateWorkerLayers(_,x);for(const E in this._updatedSources){const I=this._updatedSources[E];I==="reload"?this._reloadSource(E):I==="clear"&&this._clearSource(E)}this._updateTilesForChangedImages();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(r);this.light.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._resetUpdates()}const p={};for(const _ in this._sourceCaches){const x=this._sourceCaches[_];p[_]=x.used,x.used=!1}for(const _ of this._order){const x=this._layers[_];if(x.recalculate(r,this._availableImages),!x.isHidden(r.zoom)){const I=this._getLayerSourceCache(x);I&&(I.used=!0)}const E=this.map.painter;if(E){const I=x.getProgramIds();if(!I)continue;const k=x.getProgramConfiguration(r.zoom);for(const B of I)E.useProgram(B,k)}}for(const _ in p){const x=this._sourceCaches[_];p[_]!==x.used&&x.getSource().fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:x.getSource().id}))}this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(r){if(this._checkLoaded(),ml(this,o.validateStyle(r)))return!1;(r=o.clone$1(r)).layers=Gn(r.layers);const c=function(_,x){if(!_)return[{command:on.setStyle,args:[x]}];let E=[];try{if(!w(_.version,x.version))return[{command:on.setStyle,args:[x]}];w(_.center,x.center)||E.push({command:on.setCenter,args:[x.center]}),w(_.zoom,x.zoom)||E.push({command:on.setZoom,args:[x.zoom]}),w(_.bearing,x.bearing)||E.push({command:on.setBearing,args:[x.bearing]}),w(_.pitch,x.pitch)||E.push({command:on.setPitch,args:[x.pitch]}),w(_.sprite,x.sprite)||E.push({command:on.setSprite,args:[x.sprite]}),w(_.glyphs,x.glyphs)||E.push({command:on.setGlyphs,args:[x.glyphs]}),w(_.transition,x.transition)||E.push({command:on.setTransition,args:[x.transition]}),w(_.light,x.light)||E.push({command:on.setLight,args:[x.light]}),w(_.fog,x.fog)||E.push({command:on.setFog,args:[x.fog]}),w(_.projection,x.projection)||E.push({command:on.setProjection,args:[x.projection]});const I={},k=[];(function(U,W,J,K){let Q;for(Q in W=W||{},U=U||{})U.hasOwnProperty(Q)&&(W.hasOwnProperty(Q)||Qn(Q,J,K));for(Q in W)W.hasOwnProperty(Q)&&(U.hasOwnProperty(Q)?w(U[Q],W[Q])||(U[Q].type==="geojson"&&W[Q].type==="geojson"&&Ro(U,W,Q)?J.push({command:on.setGeoJSONSourceData,args:[Q,W[Q].data]}):ss(Q,W,J,K)):Jn(Q,W,J))})(_.sources,x.sources,k,I);const B=[];_.layers&&_.layers.forEach(U=>{U.source&&I[U.source]?E.push({command:on.removeLayer,args:[U.id]}):B.push(U)});let R=_.terrain;R&&I[R.source]&&(E.push({command:on.setTerrain,args:[void 0]}),R=void 0),E=E.concat(k),w(R,x.terrain)||E.push({command:on.setTerrain,args:[x.terrain]}),function(U,W,J){W=W||[];const K=(U=U||[]).map(Oo),Q=W.map(Oo),te=U.reduce(Oi,{}),Z=W.reduce(Oi,{}),le=K.slice(),se=Object.create(null);let de,Se,be,Ae,Be,Ne,Ge;for(de=0,Se=0;de<K.length;de++)be=K[de],Z.hasOwnProperty(be)?Se++:(J.push({command:on.removeLayer,args:[be]}),le.splice(le.indexOf(be,Se),1));for(de=0,Se=0;de<Q.length;de++)be=Q[Q.length-1-de],le[le.length-1-de]!==be&&(te.hasOwnProperty(be)?(J.push({command:on.removeLayer,args:[be]}),le.splice(le.lastIndexOf(be,le.length-Se),1)):Se++,Ne=le[le.length-de],J.push({command:on.addLayer,args:[Z[be],Ne]}),le.splice(le.length-de,0,be),se[be]=!0);for(de=0;de<Q.length;de++)if(be=Q[de],Ae=te[be],Be=Z[be],!se[be]&&!w(Ae,Be))if(w(Ae.source,Be.source)&&w(Ae["source-layer"],Be["source-layer"])&&w(Ae.type,Be.type)){for(Ge in et(Ae.layout,Be.layout,J,be,null,on.setLayoutProperty),et(Ae.paint,Be.paint,J,be,null,on.setPaintProperty),w(Ae.filter,Be.filter)||J.push({command:on.setFilter,args:[be,Be.filter]}),w(Ae.minzoom,Be.minzoom)&&w(Ae.maxzoom,Be.maxzoom)||J.push({command:on.setLayerZoomRange,args:[be,Be.minzoom,Be.maxzoom]}),Ae)Ae.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?et(Ae[Ge],Be[Ge],J,be,Ge.slice(6),on.setPaintProperty):w(Ae[Ge],Be[Ge])||J.push({command:on.setLayerProperty,args:[be,Ge,Be[Ge]]}));for(Ge in Be)Be.hasOwnProperty(Ge)&&!Ae.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?et(Ae[Ge],Be[Ge],J,be,Ge.slice(6),on.setPaintProperty):w(Ae[Ge],Be[Ge])||J.push({command:on.setLayerProperty,args:[be,Ge,Be[Ge]]}))}else J.push({command:on.removeLayer,args:[be]}),Ne=le[le.lastIndexOf(be)+1],J.push({command:on.addLayer,args:[Be,Ne]})}(B,x.layers,E)}catch(I){console.warn("Unable to compute style diff:",I),E=[{command:on.setStyle,args:[x]}]}return E}(this.serialize(),r).filter(_=>!(_.command in ls));if(c.length===0)return!1;const p=c.filter(_=>!(_.command in Ea));if(p.length>0)throw new Error(`Unimplemented: ${p.map(_=>_.command).join(", ")}.`);return c.forEach(_=>{_.command!=="setTransition"&&_.command!=="setProjection"&&this[_.command].apply(this,_.args)}),this.stylesheet=r,this._updateMapProjection(),!0}addImage(r,c){return this.getImage(r)?this.fire(new o.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,c),this._afterImageUpdated(r),this)}updateImage(r,c){this.imageManager.updateImage(r,c)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r),this._afterImageUpdated(r),this):this.fire(new o.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(r,c,p={}){if(this._checkLoaded(),this.getSource(r)!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(o.validateSource,`sources.${r}`,c,null,p))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const _=De(r,c,this.dispatcher,this);_.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(r),source:_.serialize(),sourceId:r}));const x=E=>{const I=(E?"symbol:":"other:")+r,k=this._sourceCaches[I]=new o.SourceCache(I,_,E);(E?this._symbolSourceCaches:this._otherSourceCaches)[r]=k,k.style=this,k.onAdd(this.map)};x(!1),c.type!=="vector"&&c.type!=="geojson"||x(!0),_.onAdd&&_.onAdd(this.map),this._changed=!0}removeSource(r){this._checkLoaded();const c=this.getSource(r);if(!c)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===r)return this.fire(new o.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.get().source===r)return this.fire(new o.ErrorEvent(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const p=this._getSourceCaches(r);for(const _ of p)delete this._sourceCaches[_.id],delete this._updatedSources[_.id],_.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles();return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(r,c){this._checkLoaded(),this.getSource(r).setData(c),this._changed=!0}getSource(r){const c=this._getSourceCache(r);return c&&c.getSource()}_getSources(){const r=[];for(const c in this._otherSourceCaches){const p=this._getSourceCache(c);p&&r.push(p.getSource())}return r}addLayer(r,c,p={}){this._checkLoaded();const _=r.id;if(this.getLayer(_))return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${_}" already exists on this map`)));let x;if(r.type==="custom"){if(ml(this,o.validateCustomStyleLayer(r)))return;x=o.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(_,r.source),r=o.clone$1(r),r=o.extend(r,{source:_})),this._validate(o.validateLayer,`layers.${_}`,r,{arrayIndex:-1},p))return;x=o.createStyleLayer(r),this._validateLayer(x),x.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[x.id]=x.serialize(),this._updateLayerCount(x,!0)}const E=c?this._order.indexOf(c):this._order.length;if(c&&E===-1)return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(E,0,_),this._layerOrderChanged=!0,this._layers[_]=x;const I=this._getLayerSourceCache(x);if(this._removedLayers[_]&&x.source&&I&&x.type!=="custom"){const k=this._removedLayers[_];delete this._removedLayers[_],k.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",I.pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(r,c){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===c)return;const p=this._order.indexOf(r);this._order.splice(p,1);const _=c?this._order.indexOf(c):this._order.length;c&&_===-1?this.fire(new o.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(_,0,r),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(r){this._checkLoaded();const c=this._layers[r];if(!c)return void this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const p=this._order.indexOf(r);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=c,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}hasLayerType(r){for(const c in this._layers)if(this._layers[c].type===r)return!0;return!1}setLayerZoomRange(r,c,p){this._checkLoaded();const _=this.getLayer(r);_?_.minzoom===c&&_.maxzoom===p||(c!=null&&(_.minzoom=c),p!=null&&(_.maxzoom=p),this._updateLayer(_)):this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(r,c,p={}){this._checkLoaded();const _=this.getLayer(r);if(_){if(!w(_.filter,c))return c==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(o.validateFilter,`layers.${_.id}.filter`,c,{layerType:_.type},p)||(_.filter=o.clone$1(c),this._updateLayer(_)))}else this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be filtered.`)))}getFilter(r){const c=this.getLayer(r);return c&&o.clone$1(c.filter)}setLayoutProperty(r,c,p,_={}){this._checkLoaded();const x=this.getLayer(r);x?w(x.getLayoutProperty(c),p)||(x.setLayoutProperty(c,p,_),this._updateLayer(x)):this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(r,c){const p=this.getLayer(r);if(p)return p.getLayoutProperty(c);this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style.`)))}setPaintProperty(r,c,p,_={}){this._checkLoaded();const x=this.getLayer(r);x?w(x.getPaintProperty(c),p)||(x.setPaintProperty(c,p,_)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(r,c){const p=this.getLayer(r);return p&&p.getPaintProperty(c)}setFeatureState(r,c){this._checkLoaded();const p=r.source,_=r.sourceLayer,x=this.getSource(p);if(!x)return void this.fire(new o.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const E=x.type;if(E==="geojson"&&_)return void this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(E==="vector"&&!_)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided.")));const I=this._getSourceCaches(p);for(const k of I)k.setFeatureState(_,r.id,c)}removeFeatureState(r,c){this._checkLoaded();const p=r.source,_=this.getSource(p);if(!_)return void this.fire(new o.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const x=_.type,E=x==="vector"?r.sourceLayer:void 0;if(x==="vector"&&!E)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const I=this._getSourceCaches(p);for(const k of I)k.removeFeatureState(E,r.id,c)}getFeatureState(r){this._checkLoaded();const c=r.source,p=r.sourceLayer,_=this.getSource(c);if(_){if(_.type!=="vector"||p)return r.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(p,r.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const r={};for(const c in this._sourceCaches){const p=this._sourceCaches[c].getSource();r[p.id]||(r[p.id]=p.serialize())}return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:r,layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0;const c=this._getLayerSourceCache(r);r.source&&!this._updatedSources[r.source]&&c&&c.getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",c.pause()),this._changed=!0,r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const c=E=>this._layers[E].type==="fill-extrusion",p={},_=[];for(let E=this._order.length-1;E>=0;E--){const I=this._order[E];if(c(I)){p[I]=E;for(const k of r){const B=k[I];if(B)for(const R of B)_.push(R)}}}_.sort((E,I)=>I.intersectionZ-E.intersectionZ);const x=[];for(let E=this._order.length-1;E>=0;E--){const I=this._order[E];if(c(I))for(let k=_.length-1;k>=0;k--){const B=_[k].feature;if(p[B.layer.id]<E)break;x.push(B),_.pop()}else for(const k of r){const B=k[I];if(B)for(const R of B)x.push(R.feature)}}return x}queryRenderedFeatures(r,c,p){c&&c.filter&&this._validate(o.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const _={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const k of c.layers){const B=this._layers[k];if(!B)return this.fire(new o.ErrorEvent(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];_[B.source]=!0}}const x=[];c.availableImages=this._availableImages;const E=c&&c.layers?c.layers.some(k=>{const B=this.getLayer(k);return B&&B.is3D()}):this.has3DLayers(),I=Ke.createFromScreenPoints(r,p);for(const k in this._sourceCaches){const B=this._sourceCaches[k].getSource().id;c.layers&&!_[B]||x.push(Ve(this._sourceCaches[k],this._layers,this._serializedLayers,I,c,p,E,!!this.map._showQueryGeometry))}return this.placement&&x.push(function(k,B,R,U,W,J,K){const Q={},te=J.queryRenderedSymbols(U),Z=[];for(const le of Object.keys(te).map(Number))Z.push(K[le]);Z.sort(Bt);for(const le of Z){const se=le.featureIndex.lookupSymbolFeatures(te[le.bucketInstanceId],B,le.bucketIndex,le.sourceLayerIndex,W.filter,W.layers,W.availableImages,k);for(const de in se){const Se=Q[de]=Q[de]||[],be=se[de];be.sort((Ae,Be)=>{const Ne=le.featureSortOrder;if(Ne){const Ge=Ne.indexOf(Ae.featureIndex);return Ne.indexOf(Be.featureIndex)-Ge}return Be.featureIndex-Ae.featureIndex});for(const Ae of be)Se.push(Ae)}}for(const le in Q)Q[le].forEach(se=>{const de=se.feature,Se=R(k[le]).getFeatureState(de.layer["source-layer"],de.id);de.source=de.layer.source,de.layer["source-layer"]&&(de.sourceLayer=de.layer["source-layer"]),de.state=Se});return Q}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),I.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(r,c){c&&c.filter&&this._validate(o.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const p=this._getSourceCaches(r);let _=[];for(const x of p)_=_.concat(ct(x,c));return _}addSourceType(r,c,p){return Wr.getSourceType(r)?p(new Error(`A source type called "${r}" already exists.`)):(Wr.setSourceType(r,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:c.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(r,c={}){this._checkLoaded();const p=this.light.getLight();let _=!1;for(const E in r)if(!w(r[E],p[E])){_=!0;break}if(!_)return;const x=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(r,c),this.light.updateTransitions(x)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(r,c=1){if(this._checkLoaded(),!r)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(c===1){if(typeof r.source=="object"){const p="terrain-dem-src";this.addSource(p,r.source),r=o.clone$1(r),r=o.extend(r,{source:p})}if(this._validate(o.validateTerrain,"terrain",r))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode)this._createTerrain(r,c);else{const p=this.terrain,_=p.get();for(const x of Object.keys(o.spec.terrain))!r.hasOwnProperty(x)&&o.spec.terrain[x].default&&(r[x]=o.spec.terrain[x].default);for(const x in r)if(!w(r[x],_[x])){p.set(r),this.stylesheet.terrain=r;const E=this._setTransitionParameters({duration:0});p.updateTransitions(E);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const c=this.fog=new Gt(r,this.map.transform);this.stylesheet.fog=r;const p=this._setTransitionParameters({duration:0});c.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,p=c.get();Object.keys(r).length===0&&c.set(r);for(const _ in r)if(!w(r[_],p[_])){c.set(r),this.stylesheet.fog=r;const x=this._setTransitionParameters({duration:0});c.updateTransitions(x);break}}else this._createFog(r);this._markersNeedUpdate=!0}_setTransitionParameters(r){return{now:o.exported.now(),transition:o.extend(r,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const r=this._order.filter(p=>this.isLayerDraped(this._layers[p])),c=this._order.filter(p=>!this.isLayerDraped(this._layers[p]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...c)}_createTerrain(r,c){const p=this.terrain=new Pe(r,c);this.stylesheet.terrain=r,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const _=this._setTransitionParameters({duration:0});p.updateTransitions(_)}_force3DLayerUpdate(){for(const r in this._layers){const c=this._layers[r];c.type==="fill-extrusion"&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const c=this._layers[r];c.type==="symbol"&&this._updateLayer(c)}}_validate(r,c,p,_,x={}){return(!x||x.validate!==!1)&&ml(this,r.call(o.validateStyle,o.extend({key:c,style:this.serialize(),value:p,styleSpec:o.spec},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this._sourceCaches)this._sourceCaches[r].clearTiles(),this._sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){const c=this._getSourceCaches(r);for(const p of c)p.clearTiles()}_reloadSource(r){const c=this._getSourceCaches(r);for(const p of c)p.resume(),p.reload()}_reloadSources(){for(const r of this._getSources())r.reload&&r.reload()}_updateSources(r){for(const c in this._sourceCaches)this._sourceCaches[c].update(r)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const c=this._sourceCaches[r];c.resume(),c.reload()}}_updatePlacement(r,c,p,_,x=!1){let E=!1,I=!1;const k={};for(const B of this._order){const R=this._layers[B];if(R.type!=="symbol")continue;if(!k[R.source]){const W=this._getLayerSourceCache(R);if(!W)continue;k[R.source]=W.getRenderableIds(!0).map(J=>W.getTileByID(J)).sort((J,K)=>K.tileID.overscaledZ-J.tileID.overscaledZ||(J.tileID.isLessThan(K.tileID)?-1:1))}const U=this.crossTileSymbolIndex.addLayer(R,k[R.source],r.center.lng,r.projection);E=E||U}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),x=x||this._layerOrderChanged||p===0,this._layerOrderChanged&&this.fire(new o.Event("neworder")),(x||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),r.zoom))&&(this.pauseablePlacement=new pl(r,this._order,x,c,p,_,this.placement,this.fog&&r.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),I=!0),E&&this.pauseablePlacement.placement.setStale()),I||E)for(const B of this._order){const R=this._layers[B];R.type==="symbol"&&this.placement.updateLayerOpacities(R,k[R.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,c,p){this.imageManager.getImages(c.icons,p),this._updateTilesForChangedImages();const _=x=>{x&&x.setDependencies(c.tileID.key,c.type,c.icons)};_(this._otherSourceCaches[c.source]),_(this._symbolSourceCaches[c.source])}getGlyphs(r,c,p){this.glyphManager.getGlyphs(c.stacks,p)}getResource(r,c,p){return o.makeRequest(c,p)}_getSourceCache(r){return this._otherSourceCaches[r]}_getLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}_getSourceCaches(r){const c=[];return this._otherSourceCaches[r]&&c.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&c.push(this._symbolSourceCaches[r]),c}_isSourceCacheLoaded(r){const c=this._getSourceCaches(r);return c.length===0?(this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${r}'`))),!1):c.every(p=>p.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Wr.getSourceType=function(h){return Re[h]},Wr.setSourceType=function(h,r){Re[h]=r},Wr.registerForPluginStateChange=o.registerForPluginStateChange;var gl=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Mf="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Pf=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Vc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,zf=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let yd={},xd={};const Ca=[];js(gl,Ca),js(Pf,Ca),js(Vc,Ca),js(zf,Ca),yd=qn("",Pf),xd=qn(zf,Vc);const Lf=qn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),$c=gl,Nc=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var bd={background:qn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:qn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:qn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:qn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:qn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:qn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:qn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:qn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:qn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:qn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:qn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:qn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:qn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:qn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:qn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:qn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:qn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:qn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:qn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:qn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:qn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:qn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:qn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:qn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:qn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:qn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Mf),skyboxGradient:qn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Mf),skyboxCapture:qn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:qn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:qn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function js(h,r){const c=h.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let p of c)if(p=p.trim(),p[0]==="#"&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const _=p.split(" ");for(const x of _)r.includes(x)||r.push(x)}}function qn(h,r){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=r.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),_={},x=[...Ca];return js(h,x),js(r,x),{fragmentSource:h=h.replace(c,(E,I,k,B,R)=>(_[R]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${R}
varying ${k} ${B} ${R};
#else
uniform ${k} ${B} u_${R};
#endif
`:`
#ifdef HAS_UNIFORM_u_${R}
    ${k} ${B} ${R} = u_${R};
#endif
`)),vertexSource:r=r.replace(c,(E,I,k,B,R)=>{const U=B==="float"?"vec2":"vec4",W=R.match(/color/)?"color":U;return _[R]?I==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${k} ${U} a_${R};
varying ${k} ${B} ${R};
#else
uniform ${k} ${B} u_${R};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = a_${R};
#else
    ${k} ${B} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = unpack_mix_${W}(a_${R}, u_${R}_t);
#else
    ${k} ${B} ${R} = u_${R};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${k} ${U} a_${R};
#else
uniform ${k} ${B} u_${R};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${k} ${B} ${R} = a_${R};
#else
    ${k} ${B} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${k} ${B} ${R} = unpack_mix_${W}(a_${R}, u_${R}_t);
#else
    ${k} ${B} ${R} = u_${R};
#endif
`}),staticAttributes:p,usedDefines:x}}class _l{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,c,p,_,x,E,I){this.context=r;let k=this.boundPaintVertexBuffers.length!==_.length;for(let R=0;!k&&R<_.length;R++)this.boundPaintVertexBuffers[R]!==_[R]&&(k=!0);let B=this.boundDynamicVertexBuffers.length!==I.length;for(let R=0;!B&&R<I.length;R++)this.boundDynamicVertexBuffers[R]!==I[R]&&(B=!0);if(!r.extVertexArrayObject||!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==p||k||B||this.boundIndexBuffer!==x||this.boundVertexOffset!==E)this.freshBind(c,p,_,x,E,I);else{r.bindVertexArrayOES.set(this.vao);for(const R of I)R&&R.bind();x&&x.dynamicDraw&&x.bind()}}freshBind(r,c,p,_,x,E){let I;const k=r.numAttributes,B=this.context,R=B.gl;if(B.extVertexArrayObject)this.vao&&this.destroy(),this.vao=B.extVertexArrayObject.createVertexArrayOES(),B.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=r,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=_,this.boundVertexOffset=x,this.boundDynamicVertexBuffers=E;else{I=B.currentNumAttributes||0;for(let U=k;U<I;U++)R.disableVertexAttribArray(U)}c.enableAttributes(R,r),c.bind(),c.setVertexAttribPointers(R,r,x);for(const U of p)U.enableAttributes(R,r),U.bind(),U.setVertexAttribPointers(R,r,x);for(const U of E)U&&(U.enableAttributes(R,r),U.bind(),U.setVertexAttribPointers(R,r,x));_&&_.bind(),B.currentNumAttributes=k}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function wd(h,r){const c=Math.pow(2,r.canonical.z),p=r.canonical.y;return[new o.MercatorCoordinate(0,p/c).toLngLat().lat,new o.MercatorCoordinate(0,(p+1)/c).toLngLat().lat]}function vl(h,r,c,p,_,x,E){const I=h.context,k=I.gl,B=c.fbo;if(!B)return;h.prepareDrawTile();const R=h.useProgram("hillshade");I.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,B.colorAttachment.get());const U=((Q,te,Z,le)=>{const se=Z.paint.get("hillshade-shadow-color"),de=Z.paint.get("hillshade-highlight-color"),Se=Z.paint.get("hillshade-accent-color");let be=Z.paint.get("hillshade-illumination-direction")*(Math.PI/180);Z.paint.get("hillshade-illumination-anchor")==="viewport"&&(be-=Q.transform.angle);const Ae=!Q.options.moving;return{u_matrix:le||Q.transform.calculateProjMatrix(te.tileID.toUnwrapped(),Ae),u_image:0,u_latrange:wd(0,te.tileID),u_light:[Z.paint.get("hillshade-exaggeration"),be],u_shadow:se,u_highlight:de,u_accent:Se}})(h,c,p,h.terrain?r.projMatrix:null);h.prepareDrawProgram(I,R,r.toUnwrapped());const{tileBoundsBuffer:W,tileBoundsIndexBuffer:J,tileBoundsSegments:K}=h.getTileBoundsBuffers(c);R.draw(I,k.TRIANGLES,_,x,E,o.CullFaceMode.disabled,U,p.id,W,J,K)}function yl(h,r,c){if(!r.needsDEMTextureUpload)return;const p=h.context,_=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||h.getTileTexture(c.stride);const x=c.getPixels();r.demTexture?r.demTexture.update(x,{premultiply:!1}):r.demTexture=new o.Texture(p,x,_.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}function Uc(h,r,c,p,_,x){const E=h.context,I=E.gl;if(!r.dem)return;const k=r.dem;if(E.activeTexture.set(I.TEXTURE1),yl(h,r,k),!r.demTexture)return;r.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const B=k.dim;E.activeTexture.set(I.TEXTURE0);let R=r.fbo;if(!R){const K=new o.Texture(E,{width:B,height:B,data:null},I.RGBA);K.bind(I.LINEAR,I.CLAMP_TO_EDGE),R=r.fbo=E.createFramebuffer(B,B,!0),R.colorAttachment.set(K.texture)}E.bindFramebuffer.set(R.framebuffer),E.viewport.set([0,0,B,B]);const{tileBoundsBuffer:U,tileBoundsIndexBuffer:W,tileBoundsSegments:J}=h.getMercatorTileBoundsBuffers();h.useProgram("hillshadePrepare").draw(E,I.TRIANGLES,p,_,x,o.CullFaceMode.disabled,((K,Q)=>{const te=Q.stride,Z=o.create();return o.ortho(Z,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(Z,Z,[0,-o.EXTENT,0]),{u_matrix:Z,u_image:1,u_dimension:[te,te],u_zoom:K.overscaledZ,u_unpack:Q.unpackVector}})(r.tileID,k),c.id,U,W,J),r.needsHillshadePrepare=!1}const jc=h=>({u_matrix:new o.UniformMatrix4f(h),u_image0:new o.Uniform1i(h),u_skirt_height:new o.Uniform1f(h)}),Td=(h,r)=>({u_matrix:h,u_image0:0,u_skirt_height:r}),Gc=(h,r,c,p,_,x,E,I,k,B,R,U,W,J,K)=>({u_proj_matrix:Float32Array.from(h),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:c,u_zoom_transition:_,u_merc_center:x,u_image0:0,u_frustum_tl:E,u_frustum_tr:I,u_frustum_br:k,u_frustum_bl:B,u_globe_pos:R,u_globe_radius:U,u_viewport:W,u_grid_matrix:K?Float32Array.from(K):new Float32Array(9),u_skirt_height:J});function Sd(h,r){return h!=null&&r!=null&&!(!h.hasData()||!r.hasData())&&h.demTexture!=null&&r.demTexture!=null&&h.tileID.key!==r.tileID.key}const us=new class{constructor(){this.operations={}}newMorphing(h,r,c,p,_){if(h in this.operations){const x=this.operations[h];x.to.tileID.key!==c.tileID.key&&(x.queued=c)}else this.operations[h]={startTime:p,phase:0,duration:_,from:r,to:c,queued:null}}getMorphValuesForProxy(h){if(!(h in this.operations))return null;const r=this.operations[h];return{from:r.from,to:r.to,phase:r.phase}}update(h){for(const r in this.operations){const c=this.operations[r];for(c.phase=(h-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,h)){delete this.operations[r];break}}}_nextOp(h,r){return!!h.queued&&(h.from=h.to,h.to=h.queued,h.queued=null,h.phase=0,h.startTime=r,!0)}_validOp(h){return h.from.hasData()&&h.to.hasData()}},Gs={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function qc(h){return 6*Math.pow(1.5,22-h)}function Ed(h,r){const c=1<<h.z;return!r&&(h.x===0||h.x===c-1)||h.y===0||h.y===c-1}const Fn=h=>({u_matrix:h});function xl(h,r,c,p,_){if(_>0){const x=o.exported.now(),E=(x-h.timeAdded)/_,I=r?(x-r.timeAdded)/_:-1,k=c.getSource(),B=p.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),R=!r||Math.abs(r.tileID.overscaledZ-B)>Math.abs(h.tileID.overscaledZ-B),U=R&&h.refreshedUponExpiration?1:o.clamp(R?E:1-I,0,1);return h.refreshedUponExpiration&&E>=1&&(h.refreshedUponExpiration=!1),r?{opacity:1,mix:1-U}:{opacity:U,mix:0}}return{opacity:1,mix:0}}class Df extends o.SourceCache{constructor(r){const c={type:"raster-dem",maxzoom:r.transform.maxZoom},p=new zn(cn(),null),_=De("mock-dem",c,p,r.style);super("mock-dem",_,!1),_.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,c){r.state="loaded",c(null)}}class Bf extends o.SourceCache{constructor(r){const c=De("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new zn(cn(),null),r.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,c,p){if(r.freezeTileCoverage)return;this.transform=r;const _=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((x,E)=>{if(x[E.key]="",!this._tiles[E.key]){const I=new o.Tile(E,this._source.tileSize*E.overscaleFactor(),r.tileZoom);I.state="loaded",this._tiles[E.key]=I}return x},{});for(const x in this._tiles)x in _||(this.freeFBO(x),this._tiles[x].unloadVectorData(),delete this._tiles[x])}freeFBO(r){const c=this.proxyCachedFBO[r];if(c!==void 0){const p=Object.values(c);this.renderCachePool.push(...p),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Cd extends o.OverscaledTileID{constructor(r,c,p){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=c,this.projMatrix=p}}class Id extends o.Elevation{constructor(r,c){super(),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,_,x]=function(k){const B=new o.StructArrayLayout2i4,R=new o.StructArrayLayout3ui6,U=131;B.reserve(17161),R.reserve(33800);const W=o.EXTENT/128,J=o.EXTENT+W/2,K=J+W;for(let te=-W;te<K;te+=W)for(let Z=-W;Z<K;Z+=W){const le=Z<0||Z>J||te<0||te>J?24575:0,se=o.clamp(Math.round(Z),0,o.EXTENT),de=o.clamp(Math.round(te),0,o.EXTENT);B.emplaceBack(se+le,de)}const Q=(te,Z)=>{const le=Z*U+te;R.emplaceBack(le+1,le,le+U),R.emplaceBack(le+U,le+U+1,le+1)};for(let te=1;te<129;te++)for(let Z=1;Z<129;Z++)Q(Z,te);return[0,129].forEach(te=>{for(let Z=0;Z<130;Z++)Q(Z,te),Q(te,Z)}),[B,R,32768]}(),E=r.context;this.gridBuffer=E.createVertexBuffer(p,o.posAttributes.members),this.gridIndexBuffer=E.createIndexBuffer(_),this.gridSegments=o.SegmentVector.simpleSegment(0,0,p.length,_.length),this.gridNoSkirtSegments=o.SegmentVector.simpleSegment(0,0,p.length,x),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Bf(c.map),this.orthoMatrix=o.create(),o.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.EXTENT,0,o.EXTENT,0,1);const I=E.gl;this._overlapStencilMode=new o.StencilMode({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Df(c.map)}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),r.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=r,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,c,p){if(r&&r.terrain){this._style!==r&&(this.style=r),this.enabled=!0;const _=r.terrain.properties;this.sourceCache=r.terrain.drapeRenderMode===0?this._mockSourceCache:r._getSourceCache(_.get("source")),this._exaggeration=_.get("exaggeration");const x=()=>{this.sourceCache.used&&o.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const E=this.getScaledDemTileSize();this.sourceCache.update(c,E,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,x(),this._initializing=!0),x(),c.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const r=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||r.efficiency!==100&&o.warnOnce(`Terrain render cache efficiency is not optimal (${r.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${r.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._sourceCaches)this._style._sourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const _=this.proxyCoords=c.getIds().map(k=>{const B=c.getTileByID(k).tileID;return B.projMatrix=p.calculateProjMatrix(B.toUnwrapped()),B});(function(k,B){const R=B.transform.pointCoordinate(B.transform.getCameraPoint()),U=new o.pointGeometry(R.x,R.y);k.sort((W,J)=>{if(J.overscaledZ-W.overscaledZ)return J.overscaledZ-W.overscaledZ;const K=new o.pointGeometry(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),Q=new o.pointGeometry(J.canonical.x+(1<<J.canonical.z)*J.wrap,J.canonical.y),te=U.mult(1<<W.canonical.z);return te.x-=.5,te.y-=.5,te.distSqr(K)-te.distSqr(Q)})})(_,this.painter),this._previousZoom=p.zoom;const x=this.proxyToSource||{};this.proxyToSource={},_.forEach(k=>{this.proxyToSource[k.key]={}}),this.terrainTileForTile={};const E=this._style._sourceCaches;for(const k in E){const B=E[k];if(!B.used||(B!==this.sourceCache&&this.resetTileLookupCache(B.id),this._setupProxiedCoordsForOrtho(B,r[k],x),B.usedForTerrain))continue;const R=r[k];B.getSource().reparseOverscaled&&this._assignTerrainTiles(R)}this.proxiedCoords[c.id]=_.map(k=>new Cd(k,k.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(x),this.renderingToTexture=!1,this._updateTimestamp=o.exported.now();const I={};this._visibleDemTiles=[];for(const k of this.proxyCoords){const B=this.terrainTileForTile[k.key];if(!B)continue;const R=B.tileID.key;R in I||(this._visibleDemTiles.push(B),I[R]=R)}}_assignTerrainTiles(r){this._initializing||r.forEach(c=>{if(this.terrainTileForTile[c.key])return;const p=this._findTileCoveringTileID(c,this.sourceCache);p&&(this.terrainTileForTile[c.key]=p)})}_prepareDEMTextures(){const r=this.painter.context,c=r.gl;for(const p in this.terrainTileForTile){const _=this.terrainTileForTile[p],x=_.dem;!x||_.demTexture&&!_.needsDEMTextureUpload||(r.activeTexture.set(c.TEXTURE1),yl(this.painter,_,x))}}_prepareDemTileUniforms(r,c,p,_){if(!c||c.demTexture==null)return!1;const x=r.tileID.canonical,E=Math.pow(2,c.tileID.canonical.z-x.z),I=_||"";return p[`u_dem_tl${I}`]=[x.x*E%1,x.y*E%1],p[`u_dem_scale${I}`]=E,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const r=this.painter.context,c=r.gl;if(!this._emptyDepthBufferTexture){const p=new o.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new o.Texture(r,p,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let r=0;const c=this._visibleDemTiles.reduce((p,_)=>{if(!_.dem)return p;const x=_.dem.tree.minimums[0];return x>0&&r++,p+x},0);return r?c/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,c=r.gl;r.activeTexture.set(c.TEXTURE2);const p=this._getLoadedAreaMinimum(),_=new o.RGBAImage({width:1,height:1},new Uint8Array(o.DEMData.pack(p,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let x=this._emptyDEMTexture;return x?x.update(_,{premultiply:!1}):x=this._emptyDEMTexture=new o.Texture(r,_,c.RGBA,{premultiply:!1}),x}setupElevationDraw(r,c,p){const _=this.painter.context,x=_.gl,E=(I=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:o.DEMData.getUnpackVector(I),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var I;E.u_dem_size=this.sourceCache.getSource().tileSize,E.u_exaggeration=this.exaggeration();let k=null,B=null,R=1;if(p&&p.morphing&&this._useVertexMorphing){const U=p.morphing.srcDemTile,W=p.morphing.dstDemTile;R=p.morphing.phase,U&&W&&(this._prepareDemTileUniforms(r,U,E,"_prev")&&(B=U),this._prepareDemTileUniforms(r,W,E)&&(k=W))}if(B&&k?(_.activeTexture.set(x.TEXTURE2),k.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE,x.NEAREST),_.activeTexture.set(x.TEXTURE4),B.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE,x.NEAREST),E.u_dem_lerp=R):(k=this.terrainTileForTile[r.tileID.key],_.activeTexture.set(x.TEXTURE2),(this._prepareDemTileUniforms(r,k,E)?k.demTexture:this.emptyDEMTexture).bind(x.NEAREST,x.CLAMP_TO_EDGE)),_.activeTexture.set(x.TEXTURE3),p&&p.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),this._depthFBO&&(E.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),E.u_depth_size_inv=[1,1]),p&&p.useMeterToDem&&k){const U=(1<<k.tileID.canonical.z)*o.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;E.u_meter_to_dem=U}if(p&&p.labelPlaneMatrixInv&&(E.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),c.setTerrainUniformValues(_,E),this.painter.transform.projection.name==="globe"){const U=this.globeUniformValues(this.painter.transform,r.tileID.canonical,p&&p.useDenormalizedUpVectorScale);c.setGlobeUniformValues(_,U)}}globeUniformValues(r,c,p){const _=r.projection;return{u_tile_tl_up:_.upVector(c,0,0),u_tile_tr_up:_.upVector(c,o.EXTENT,0),u_tile_br_up:_.upVector(c,o.EXTENT,o.EXTENT),u_tile_bl_up:_.upVector(c,0,o.EXTENT),u_tile_up_scale:p?o.globeMetersToEcef(1):_.upVectorScale(c,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const c=this.painter,p=this.painter.context;r.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(_,x,E,I,k){if(_.transform.projection.name==="globe")(function(B,R,U,W,J){const K=B.context,Q=K.gl;let te,Z;const le=B.options.showTerrainWireframe?2:0,se=B.transform,de=o.globeUseCustomAntiAliasing(B,K,se),Se=(ut,Ue)=>{if(Z===ut)return;const Le=[Gs[ut],"PROJECTION_GLOBE_VIEW"];de&&Le.push("CUSTOM_ANTIALIASING"),Ue&&Le.push(Gs[le]),te=B.useProgram("globeRaster",null,Le),Z=ut},be=B.colorModeForRenderPass(),Ae=new o.DepthMode(Q.LEQUAL,o.DepthMode.ReadWrite,B.depthRangeFor3D);us.update(J);const Be=o.calculateGlobeMercatorMatrix(se),Ne=[o.mercatorXfromLng(se.center.lng),o.mercatorYfromLat(se.center.lat)],Ge=le?[!1,!0]:[!1],bt=B.globeSharedBuffers,Fe=[se.width*o.exported.devicePixelRatio,se.height*o.exported.devicePixelRatio],rt=Float32Array.from(se.globeMatrix),He={useDenormalizedUpVectorScale:!0};if(Ge.forEach(ut=>{const Ue=B.transform,Le=qc(Ue.zoom)*R.exaggeration();Z=-1;const Ze=ut?Q.LINES:Q.TRIANGLES;for(const lt of W){const mt=U.getTile(lt),Wt=o.StencilMode.disabled,mn=R.prevTerrainTileForTile[lt.key],Ut=R.terrainTileForTile[lt.key];Sd(mn,Ut)&&us.newMorphing(lt.key,mn,Ut,J,250),K.activeTexture.set(Q.TEXTURE0),mt.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const Ft=us.getMorphValuesForProxy(lt.key),Ht=Ft?1:0;Ft&&o.extend$1(He,{morphing:{srcDemTile:Ft.from,dstDemTile:Ft.to,phase:o.easeCubicInOut(Ft.phase)}});const In=o.tileCornersToBounds(lt.canonical),Qt=o.getLatitudinalLod(In.getCenter().lat),Zn=o.getGridMatrix(lt.canonical,In,Qt,Ue.worldSize/Ue._pixelsPerMercatorPixel),ei=o.globeNormalizeECEF(o.globeTileBounds(lt.canonical)),li=Gc(Ue.projMatrix,rt,Be,ei,o.globeToMercatorTransition(Ue.zoom),Ne,Ue.frustumCorners.TL,Ue.frustumCorners.TR,Ue.frustumCorners.BR,Ue.frustumCorners.BL,Ue.globeCenterInViewSpace,Ue.globeRadius,Fe,Le,Zn);if(Se(Ht,ut),R.setupElevationDraw(mt,te,He),B.prepareDrawProgram(K,te,lt.toUnwrapped()),bt){const[ri,Fi,Br]=ut?bt.getWirefameBuffers(B.context,Qt):bt.getGridBuffers(Qt,Le!==0);te.draw(K,Ze,Ae,Wt,be,o.CullFaceMode.backCCW,li,"globe_raster",ri,Fi,Br)}}}),bt){const ut=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];de&&ut.push("CUSTOM_ANTIALIASING"),te=B.useProgram("globeRaster",null,ut);for(const Ue of W){const{x:Le,y:Ze,z:lt}=Ue.canonical,mt=Ze===0,Wt=Ze===(1<<lt)-1,[mn,Ut,Ft,Ht]=bt.getPoleBuffers(lt);if(Ht&&(mt||Wt)){const In=U.getTile(Ue);K.activeTexture.set(Q.TEXTURE0),In.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);let Qt=o.globePoleMatrixForTile(lt,Le,se);const Zn=o.globeNormalizeECEF(o.globeTileBounds(Ue.canonical)),ei=(li,ri)=>li.draw(K,Q.TRIANGLES,Ae,o.StencilMode.disabled,be,o.CullFaceMode.disabled,Gc(se.projMatrix,Qt,Qt,Zn,0,Ne,se.frustumCorners.TL,se.frustumCorners.TR,se.frustumCorners.BR,se.frustumCorners.BL,se.globeCenterInViewSpace,se.globeRadius,Fe,0),"globe_pole_raster",ri,Ft,Ht);R.setupElevationDraw(In,te,He),B.prepareDrawProgram(K,te,Ue.toUnwrapped()),mt&&ei(te,mn),Wt&&(Qt=o.scale(o.create(),Qt,[1,-1,1]),ei(te,Ut))}}}})(_,x,E,I,k);else{const B=_.context,R=B.gl;let U,W;const J=_.options.showTerrainWireframe?2:0,K=(se,de)=>{if(W===se)return;const Se=[Gs[se]];de&&Se.push(Gs[J]),U=_.useProgram("terrainRaster",null,Se),W=se},Q=_.colorModeForRenderPass(),te=new o.DepthMode(R.LEQUAL,o.DepthMode.ReadWrite,_.depthRangeFor3D);us.update(k);const Z=_.transform,le=qc(Z.zoom)*x.exaggeration();(J?[!1,!0]:[!1]).forEach(se=>{W=-1;const de=se?R.LINES:R.TRIANGLES,[Se,be]=se?x.getWirefameBuffer():[x.gridIndexBuffer,x.gridSegments];for(const Ae of I){const Be=E.getTile(Ae),Ne=o.StencilMode.disabled,Ge=x.prevTerrainTileForTile[Ae.key],bt=x.terrainTileForTile[Ae.key];Sd(Ge,bt)&&us.newMorphing(Ae.key,Ge,bt,k,250),B.activeTexture.set(R.TEXTURE0),Be.texture.bind(R.LINEAR,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST);const Fe=us.getMorphValuesForProxy(Ae.key),rt=Fe?1:0;let He;Fe&&(He={morphing:{srcDemTile:Fe.from,dstDemTile:Fe.to,phase:o.easeCubicInOut(Fe.phase)}});const ut=Td(Ae.projMatrix,Ed(Ae.canonical,Z.renderWorldCopies)?le/10:le);K(rt,se),x.setupElevationDraw(Be,U,He),_.prepareDrawProgram(B,U,Ae.toUnwrapped()),U.draw(B,de,te,Ne,Q,o.CullFaceMode.backCCW,ut,"terrain_raster",x.gridBuffer,Se,be)}})}}(c,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const c=this.painter,p=this.painter.context,_=this.proxySourceCache,x=this.proxiedCoords[_.id],E=this._drapedRenderBatches.shift(),I=[],k=c.style.order;let B=0;for(const R of x){const U=_.getTileByID(R.proxyTileKey),W=_.proxyCachedFBO[R.key]?_.proxyCachedFBO[R.key][r]:void 0,J=W!==void 0?_.renderCache[W]:this.pool[B++],K=W!==void 0;if(U.texture=J.tex,K&&!J.dirty){I.push(U.tileID);continue}let Q;p.bindFramebuffer.set(J.fb.framebuffer),this.renderedToTile=!1,J.dirty&&(p.clear({color:o.Color.transparent,stencil:0}),J.dirty=!1);for(let te=E.start;te<=E.end;++te){const Z=c.style._layers[k[te]];if(Z.isHidden(c.transform.zoom))continue;const le=c.style._getLayerSourceCache(Z),se=le?this.proxyToSource[R.key][le.id]:[R];if(!se)continue;const de=se;p.viewport.set([0,0,J.fb.width,J.fb.height]),Q!==(le?le.id:null)&&(this._setupStencil(J,se,Z,le),Q=le?le.id:null),c.renderLayer(c,le,Z,de)}this.renderedToTile?(J.dirty=!0,I.push(U.tileID)):K||--B,B===5&&(B=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),E.end+1}postRender(){}renderCacheEfficiency(r){const c=r.order.length;if(c===0)return{efficiency:100};let p,_=0,x=0,E=!1;for(let I=0;I<c;++I){const k=r._layers[r.order[I]];this._style.isLayerDraped(k)?(E&&++_,++x):E||(E=!0,p=k.id)}return x===0?{efficiency:100}:{efficiency:100*(1-_/x),firstUndrapedLayer:p}}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{r=Math.min(r,c.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,c,p){if(!this._visibleDemTiles)return null;const _=this._visibleDemTiles.filter(x=>x.dem).map(x=>{const E=x.tileID,I=1<<E.overscaledZ,{x:k,y:B}=E.canonical,R=k/I,U=(k+1)/I,W=B/I,J=(B+1)/I;return{minx:R,miny:W,maxx:U,maxy:J,t:x.dem.tree.raycastRoot(R,W,U,J,r,c,p),tile:x}});_.sort((x,E)=>(x.t!==null?x.t:Number.MAX_VALUE)-(E.t!==null?E.t:Number.MAX_VALUE));for(const x of _){if(x.t==null)return null;const E=x.tile.dem.tree.raycast(x.minx,x.miny,x.maxx,x.maxy,r,c,p);if(E!=null)return E}return null}_createFBO(){const r=this.painter.context,c=r.gl,p=this.drapeBufferSize;r.activeTexture.set(c.TEXTURE0);const _=new o.Texture(r,{width:p[0],height:p[1],data:null},c.RGBA);_.bind(c.LINEAR,c.CLAMP_TO_EDGE);const x=r.createFramebuffer(p[0],p[1],!1);return x.colorAttachment.set(_.texture),x.depthAttachment=new zc(r,x.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,x.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):x.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&!r.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:x,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const r in this._style._sourceCaches)if(this._style._sourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const c=this._style._layers[r],p=c.isHidden(this.painter.transform.zoom);return c.type==="custom"?!p&&c.shouldRedrape():!p&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const p of this._style._getSources())if(p instanceof N){r=!0;break}if(!r)return;const c={};for(let p=0;p<this._style.order.length;++p){const _=this._style._layers[this._style.order[p]],x=this._style._getLayerSourceCache(_);if(x&&!c[x.id]&&!_.isHidden(this.painter.transform.zoom)&&_.type==="line"&&_.widthExpression()instanceof o.ZoomDependentExpression){c[x.id]=!0;for(const E of this.proxyCoords){const I=this.proxyToSource[E.key][x.id];if(I)for(const k of I)this._clearRenderCacheForTile(x.id,k)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const p in this._style._sourceCaches)if(this._style._sourceCaches[p]._source instanceof G){r=!0;break}if(!r)return;const c={};for(let p=0;p<this._style.order.length;++p){const _=this._style._layers[this._style.order[p]],x=this._style._getLayerSourceCache(_);if(!x||c[x.id]||_.isHidden(this.painter.transform.zoom)||_.type!=="raster")continue;const E=_.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const k=this.proxyToSource[I.key][x.id];if(k)for(const B of k){const R=xl(x.getTile(B),x.findLoadedParent(B,0),x,this.painter.transform,E);(R.opacity!==1||R.mix!==0)&&this._clearRenderCacheForTile(x.id,B)}}}}_setupDrapedRenderBatches(){const r=this._style.order,c=r.length;if(c===0)return;const p=[];let _,x=0,E=this._style._layers[r[x]];for(;!this._style.isLayerDraped(E)&&E.isHidden(this.painter.transform.zoom)&&++x<c;)E=this._style._layers[r[x]];for(;x<c;++x){const I=this._style._layers[r[x]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?_===void 0&&(_=x):_!==void 0&&(p.push({start:_,end:x-1}),_=void 0))}_!==void 0&&p.push({start:_,end:x-1}),this._drapedRenderBatches=p}_setupRenderCache(r){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const E=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let I=0;I<E.length;++I){const k=Object.values(E[I]);c.renderCachePool.push(...k)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,_=this._tilesDirty;for(let E=p.length-1;E>=0;E--){const I=p[E];if(c.getTileByID(I.key),c.proxyCachedFBO[I.key]!==void 0){const k=r[I.key],B=this.proxyToSource[I.key];let R=0;for(const U in B){const W=B[U],J=k[U];if(!J||J.length!==W.length||W.some((K,Q)=>K!==J[Q]||_[U]&&_[U].hasOwnProperty(K.key))){R=-1;break}++R}for(const U in c.proxyCachedFBO[I.key])c.renderCache[c.proxyCachedFBO[I.key][U]].dirty=R<0||R!==Object.values(k).length}}const x=[...this._drapedRenderBatches];x.sort((E,I)=>I.end-I.start-(E.end-E.start));for(const E of x)for(const I of p){if(c.proxyCachedFBO[I.key])continue;let k=c.renderCachePool.pop();k===void 0&&c.renderCache.length<50&&(k=c.renderCache.length,c.renderCache.push(this._createFBO())),k!==void 0&&(c.proxyCachedFBO[I.key]={},c.proxyCachedFBO[I.key][E.start]=k,c.renderCache[k].dirty=!0)}this._tilesDirty={}}_setupStencil(r,c,p,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const x=this.painter.context,E=x.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let I;if(p.isTileClipped())I=c.length,this._overlapStencilMode.test={func:E.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:E.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(x.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):o.StencilMode.disabled}_renderTileClippingMasks(r,c){const p=this.painter,_=this.painter.context,x=_.gl;p._tileClippingMaskIDs={},_.setColorMode(o.ColorMode.disabled),_.setDepthMode(o.DepthMode.disabled);const E=p.useProgram("clippingMask");for(const I of r){const k=p._tileClippingMaskIDs[I.key]=--c;E.draw(_,x.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:x.ALWAYS,mask:0},k,255,x.KEEP,x.KEEP,x.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Fn(I.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(r){const c=this.painter.transform;if(r.x<0||r.x>c.width||r.y<0||r.y>c.height)return null;const p=[r.x,r.y,1,1];o.transformMat4$1(p,p,c.pixelMatrixInverse),o.scale$1(p,p,1/p[3]),p[0]/=c.worldSize,p[1]/=c.worldSize;const _=c._camera.position,x=o.mercatorZfromAltitude(1,c.center.lat),E=[_[0],_[1],_[2]/x,0],I=o.subtract([],p.slice(0,3),E);o.normalize(I,I);const k=this.raycast(E,I,this._exaggeration);return k!==null&&k?(o.scaleAndAdd(E,E,I,k),E[3]=E[2],E[2]*=x,E):null}drawDepth(){const r=this.painter,c=r.context,p=this.proxySourceCache,_=Math.ceil(r.width),x=Math.ceil(r.height);if(!this._depthFBO||this._depthFBO.width===_&&this._depthFBO.height===x||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const E=c.gl,I=c.createFramebuffer(_,x,!0);c.activeTexture.set(E.TEXTURE0);const k=new o.Texture(c,{width:_,height:x,data:null},E.RGBA);k.bind(E.NEAREST,E.CLAMP_TO_EDGE),I.colorAttachment.set(k.texture);const B=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,_,x);I.depthAttachment.set(B),this._depthFBO=I,this._depthTexture=k}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,_,x]),function(E,I,k,B){if(E.transform.projection.name==="globe")return;const R=E.context,U=R.gl;R.clear({depth:1});const W=E.useProgram("terrainDepth"),J=new o.DepthMode(U.LESS,o.DepthMode.ReadWrite,E.depthRangeFor3D);for(const K of B){const Q=k.getTile(K),te=Td(K.projMatrix,0);I.setupElevationDraw(Q,W),W.draw(R,U.TRIANGLES,J,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.backCCW,te,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}}(r,this,p,this.proxyCoords)}_setupProxiedCoordsForOrtho(r,c,p){if(r.getSource()instanceof Ce)return this._setupProxiedCoordsForImageSource(r,c,p);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const _=this.proxiedCoords[r.id]=[],x=this.proxyCoords;for(let I=0;I<x.length;I++){const k=x[I],B=this._findTileCoveringTileID(k,r);if(B){const R=this._createProxiedId(k,B,p[k.key]&&p[k.key][r.id]);_.push(R),this.proxyToSource[k.key][r.id]=[R]}}let E=!1;for(let I=0;I<c.length;I++){const k=r.getTile(c[I]);if(!k||!k.hasData())continue;const B=this._findTileCoveringTileID(k.tileID,this.proxySourceCache);if(B&&B.tileID.canonical.z!==k.tileID.canonical.z){const R=this.proxyToSource[B.tileID.key][r.id],U=this._createProxiedId(B.tileID,k,p[B.tileID.key]&&p[B.tileID.key][r.id]);R?R.splice(R.length-1,0,U):this.proxyToSource[B.tileID.key][r.id]=[U],_.push(U),E=!0}}this._sourceTilesOverlap[r.id]=E}_setupProxiedCoordsForImageSource(r,c,p){if(!r.getSource().loaded())return;const _=this.proxiedCoords[r.id]=[],x=this.proxyCoords,E=r.getSource(),I=new o.pointGeometry(E.tileID.x,E.tileID.y)._div(1<<E.tileID.z),k=E.coordinates.map(o.MercatorCoordinate.fromLngLat).reduce((R,U)=>(R.min.x=Math.min(R.min.x,U.x-I.x),R.min.y=Math.min(R.min.y,U.y-I.y),R.max.x=Math.max(R.max.x,U.x-I.x),R.max.y=Math.max(R.max.y,U.y-I.y),R),{min:new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),B=(R,U)=>{const W=R.wrap+R.canonical.x/(1<<R.canonical.z),J=R.canonical.y/(1<<R.canonical.z),K=o.EXTENT/(1<<R.canonical.z),Q=U.wrap+U.canonical.x/(1<<U.canonical.z),te=U.canonical.y/(1<<U.canonical.z);return W+K<Q+k.min.x||W>Q+k.max.x||J+K<te+k.min.y||J>te+k.max.y};for(let R=0;R<x.length;R++){const U=x[R];for(let W=0;W<c.length;W++){const J=r.getTile(c[W]);if(!J||!J.hasData()||B(U,J.tileID))continue;const K=this._createProxiedId(U,J,p[U.key]&&p[U.key][r.id]),Q=this.proxyToSource[U.key][r.id];Q?Q.push(K):this.proxyToSource[U.key][r.id]=[K],_.push(K)}}}_createProxiedId(r,c,p){let _=this.orthoMatrix;if(p){const x=p.find(E=>E.key===c.tileID.key);if(x)return x}if(c.tileID.key!==r.key){const x=r.canonical.z-c.tileID.canonical.z;let E,I,k;_=o.create();const B=c.tileID.wrap-r.wrap<<r.overscaledZ;x>0?(E=o.EXTENT>>x,I=E*((c.tileID.canonical.x<<x)-r.canonical.x+B),k=E*((c.tileID.canonical.y<<x)-r.canonical.y)):(E=o.EXTENT<<-x,I=o.EXTENT*(c.tileID.canonical.x-(r.canonical.x+B<<-x)),k=o.EXTENT*(c.tileID.canonical.y-(r.canonical.y<<-x))),o.ortho(_,0,E,0,E,0,1),o.translate(_,_,[I,k,0])}return new Cd(c.tileID,r.key,_)}_findTileCoveringTileID(r,c){let p=c.getTile(r);if(p&&p.hasData())return p;const _=this._findCoveringTileCache[c.id],x=_[r.key];if(p=x?c.getTileByID(x):null,p&&p.hasData()||x===null)return p;let E=p?p.tileID:r,I=E.overscaledZ;const k=c.getSource().minzoom,B=[];if(!x){const U=c.getSource().maxzoom;if(r.canonical.z>=U){const W=r.canonical.z-U;c.getSource().reparseOverscaled?(I=Math.max(r.canonical.z+2,c.transform.tileZoom),E=new o.OverscaledTileID(I,r.wrap,U,r.canonical.x>>W,r.canonical.y>>W)):W!==0&&(I=U,E=new o.OverscaledTileID(I,r.wrap,U,r.canonical.x>>W,r.canonical.y>>W))}E.key!==r.key&&(B.push(E.key),p=c.getTile(E))}const R=U=>{B.forEach(W=>{_[W]=U}),B.length=0};for(I-=1;I>=k&&(!p||!p.hasData());I--){p&&R(p.tileID.key);const U=E.calculateScaledKey(I);if(p=c.getTileByID(U),p&&p.hasData())break;const W=_[U];if(W===null)break;W===void 0?B.push(U):p=c.getTileByID(W)}return R(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,c){let p=this._tilesDirty[r];p||(p=this._tilesDirty[r]={}),p[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const r=function(c){let p=0;const _=new o.StructArrayLayout2ui4,x=131;for(let E=1;E<129;E++){for(let I=1;I<129;I++)p=E*x+I,_.emplaceBack(p,p+1),_.emplaceBack(p,p+x),_.emplaceBack(p+1,p+x),E===128&&_.emplaceBack(p+x,p+x+1);_.emplaceBack(p+1,p+1+x)}return _}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(r),this.wireframeSegments=o.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,r.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Ad{static cacheKey(r,c,p,_){let x=`${c}${_?_.cacheKey:""}`;for(const E of p)r.usedDefines.includes(E)&&(x+=`/${E}`);return x}constructor(r,c,p,_,x,E){const I=r.gl;this.program=I.createProgram();const k=function(Z){const le=[];for(let se=0;se<Z.length;se++){if(Z[se]===null)continue;const de=Z[se].split(" ");le.push(de.pop())}return le}(p.staticAttributes),B=_?_.getBinderAttributes():[],R=k.concat(B);let U=_?_.defines():[];U=U.concat(E.map(Z=>`#define ${Z}`));const W=r.isWebGL2?`#version 300 es
`:"",J=W+U.concat(r.extStandardDerivatives&&W.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Nc):Nc,Nc,$c,Lf.fragmentSource,xd.fragmentSource,p.fragmentSource).join(`
`),K=W+U.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,$c,Lf.vertexSource,xd.vertexSource,yd.vertexSource,p.vertexSource).join(`
`),Q=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(Q,J),I.compileShader(Q),I.attachShader(this.program,Q);const te=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(te,K),I.compileShader(te),I.attachShader(this.program,te),this.attributes={},this.numAttributes=R.length;for(let Z=0;Z<this.numAttributes;Z++)R[Z]&&(I.bindAttribLocation(this.program,Z,R[Z]),this.attributes[R[Z]]=Z);I.linkProgram(this.program),I.deleteShader(te),I.deleteShader(Q),this.fixedUniforms=x(r),this.binderUniforms=_?_.getUniforms(r):[],E.includes("TERRAIN")&&(this.terrainUniforms=(Z=>({u_dem:new o.Uniform1i(Z),u_dem_prev:new o.Uniform1i(Z),u_dem_unpack:new o.Uniform4f(Z),u_dem_tl:new o.Uniform2f(Z),u_dem_scale:new o.Uniform1f(Z),u_dem_tl_prev:new o.Uniform2f(Z),u_dem_scale_prev:new o.Uniform1f(Z),u_dem_size:new o.Uniform1f(Z),u_dem_lerp:new o.Uniform1f(Z),u_exaggeration:new o.Uniform1f(Z),u_depth:new o.Uniform1i(Z),u_depth_size_inv:new o.Uniform2f(Z),u_meter_to_dem:new o.Uniform1f(Z),u_label_plane_matrix_inv:new o.UniformMatrix4f(Z)}))(r)),E.includes("GLOBE")&&(this.globeUniforms=(Z=>({u_tile_tl_up:new o.Uniform3f(Z),u_tile_tr_up:new o.Uniform3f(Z),u_tile_br_up:new o.Uniform3f(Z),u_tile_bl_up:new o.Uniform3f(Z),u_tile_up_scale:new o.Uniform1f(Z)}))(r)),E.includes("FOG")&&(this.fogUniforms=(Z=>({u_fog_matrix:new o.UniformMatrix4f(Z),u_fog_range:new o.Uniform2f(Z),u_fog_color:new o.Uniform4f(Z),u_fog_horizon_blend:new o.Uniform1f(Z),u_fog_temporal_offset:new o.Uniform1f(Z),u_frustum_tl:new o.Uniform3f(Z),u_frustum_tr:new o.Uniform3f(Z),u_frustum_br:new o.Uniform3f(Z),u_frustum_bl:new o.Uniform3f(Z),u_globe_pos:new o.Uniform3f(Z),u_globe_radius:new o.Uniform1f(Z),u_globe_transition:new o.Uniform1f(Z),u_is_globe:new o.Uniform1i(Z),u_viewport:new o.Uniform2f(Z)}))(r))}}setTerrainUniformValues(r,c){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const _ in c)p[_]&&p[_].set(this.program,_,c[_])}}setGlobeUniformValues(r,c){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const _ in c)p[_]&&p[_].set(this.program,_,c[_])}}setFogUniformValues(r,c){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const _ in c)p[_].set(this.program,_,c[_])}}draw(r,c,p,_,x,E,I,k,B,R,U,W,J,K,Q){const te=r.gl;if(this.failedToCreate)return;r.program.set(this.program),r.setDepthMode(p),r.setStencilMode(_),r.setColorMode(x),r.setCullFace(E);for(const le of Object.keys(this.fixedUniforms))this.fixedUniforms[le].set(this.program,le,I[le]);K&&K.setUniforms(this.program,r,this.binderUniforms,W,{zoom:J});const Z={[te.LINES]:2,[te.TRIANGLES]:3,[te.LINE_STRIP]:1}[c];for(const le of U.get()){const se=le.vaos||(le.vaos={});(se[k]||(se[k]=new _l)).bind(r,this,B,K?K.getPaintVertexBuffers():[],R,le.vertexOffset,Q||[]),te.drawElements(c,le.primitiveLength*Z,te.UNSIGNED_SHORT,le.primitiveOffset*Z*2)}}}function Rf(h,r){const c=Math.pow(2,r.tileID.overscaledZ),p=r.tileSize*Math.pow(2,h.transform.tileZoom)/c,_=p*(r.tileID.canonical.x+r.tileID.wrap*c),x=p*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_tile_units_to_pixels:1/At(r,1,h.transform.tileZoom),u_pixel_coord_upper:[_>>16,x>>16],u_pixel_coord_lower:[65535&_,65535&x]}}const bg=o.create(),Zc=(h,r,c,p,_,x,E,I,k,B,R)=>{const U=r.style.light,W=U.properties.get("position"),J=[W.x,W.y,W.z],K=o.create$1();U.properties.get("anchor")==="viewport"&&(o.fromRotation(K,-r.transform.angle),o.transformMat3(J,J,K));const Q=U.properties.get("color"),te=r.transform,Z={u_matrix:h,u_lightpos:J,u_lightintensity:U.properties.get("intensity"),u_lightcolor:[Q.r,Q.g,Q.b],u_vertical_gradient:+c,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:bg,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:_,u_edge_radius:x};return te.projection.name==="globe"&&(Z.u_tile_id=[E.canonical.x,E.canonical.y,1<<E.canonical.z],Z.u_zoom_transition=k,Z.u_inv_rot_matrix=R,Z.u_merc_center=B,Z.u_up_dir=te.projection.upVector(new o.CanonicalTileID(0,0,0),B[0]*o.EXTENT,B[1]*o.EXTENT),Z.u_height_lift=I),Z},kd=(h,r,c,p,_,x,E,I,k,B,R,U)=>{const W=Zc(h,r,c,p,_,x,E,k,B,R,U),J={u_height_factor:-Math.pow(2,E.overscaledZ)/I.tileSize/8};return o.extend(W,Rf(r,I),J)},Wc=h=>({u_matrix:h}),Hc=(h,r,c)=>o.extend(Wc(h),Rf(r,c)),Of=(h,r)=>({u_matrix:h,u_world:r}),Ff=(h,r,c,p)=>o.extend(Hc(h,r,c),{u_world:p}),wg=o.create(),bl=(h,r,c,p,_,x)=>{const E=h.transform,I=E.projection.name==="globe";let k;if(x.paint.get("circle-pitch-alignment")==="map")if(I){const R=o.globePixelsToTileUnits(E.zoom,r.canonical)*E._pixelsPerMercatorPixel;k=Float32Array.from([R,0,0,R])}else k=E.calculatePixelsToTileUnitsMatrix(c);else k=new Float32Array([E.pixelsToGLUnits[0],0,0,E.pixelsToGLUnits[1]]);const B={u_camera_to_center_distance:E.cameraToCenterDistance,u_matrix:h.translatePosMatrix(r.projMatrix,c,x.paint.get("circle-translate"),x.paint.get("circle-translate-anchor")),u_device_pixel_ratio:o.exported.devicePixelRatio,u_extrude_scale:k,u_inv_rot_matrix:wg,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){B.u_inv_rot_matrix=p,B.u_merc_center=_,B.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],B.u_zoom_transition=o.globeToMercatorTransition(E.zoom);const R=_[0]*o.EXTENT,U=_[1]*o.EXTENT;B.u_up_dir=E.projection.upVector(new o.CanonicalTileID(0,0,0),R,U)}return B},wl=h=>{const r=[];return h.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),h.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r},Vf=(h,r,c,p)=>{const _=o.EXTENT/c.tileSize;return{u_matrix:h,u_camera_to_center_distance:r.getCameraToCenterDistance(p),u_extrude_scale:[r.pixelsToGLUnits[0]/_,r.pixelsToGLUnits[1]/_]}},Tl=(h,r,c=1)=>({u_matrix:h,u_color:r,u_overlay:0,u_overlay_scale:c}),Md=o.create(),vo=(h,r,c,p,_,x,E)=>{const I=h.transform,k=I.projection.name==="globe",B=k?o.globePixelsToTileUnits(I.zoom,r.canonical)*I._pixelsPerMercatorPixel:At(c,1,x),R={u_matrix:r.projMatrix,u_extrude_scale:B,u_intensity:E,u_inv_rot_matrix:Md,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(k){R.u_inv_rot_matrix=p,R.u_merc_center=_,R.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],R.u_zoom_transition=o.globeToMercatorTransition(I.zoom);const U=_[0]*o.EXTENT,W=_[1]*o.EXTENT;R.u_up_dir=I.projection.upVector(new o.CanonicalTileID(0,0,0),U,W)}return R},Pd=(h,r,c,p,_,x,E)=>{const I=h.transform,k=I.calculatePixelsToTileUnitsMatrix(r);return{u_matrix:zd(h,r,c,p),u_pixels_to_tile_units:k,u_device_pixel_ratio:x,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:Yc(c)?r.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Xc(r,h.transform),u_alpha_discard_threshold:0,u_trim_offset:E}},$f=(h,r,c,p,_)=>{const x=h.transform;return{u_matrix:zd(h,r,c,p),u_texsize:r.imageAtlasTexture.size,u_pixels_to_tile_units:x.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:_,u_image:0,u_tile_units_to_pixels:Xc(r,x),u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Xc(h,r){return 1/At(h,1,r.tileZoom)}function zd(h,r,c,p){return h.translatePosMatrix(p||r.tileID.projMatrix,r,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function Yc(h){const r=h.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}const Tg=(h,r,c,p,_,x)=>{return{u_matrix:h,u_tl_parent:r,u_scale_parent:c,u_fade_t:p.mix,u_opacity:p.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(I=_.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(E=_.paint.get("raster-contrast"),E>0?1/(1-E):1+E),u_spin_weights:Ld(_.paint.get("raster-hue-rotate")),u_perspective_transform:x};var E,I};function Ld(h){h*=Math.PI/180;const r=Math.sin(h),c=Math.cos(h);return[(2*c+1)/3,(-Math.sqrt(3)*r-c+1)/3,(Math.sqrt(3)*r-c+1)/3]}const Nf=o.create(),Sl=(h,r,c,p,_,x,E,I,k,B,R,U,W,J,K,Q)=>{const te=_.transform,Z={u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:te.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:te.width/te.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:E,u_coord_matrix:I,u_is_text:+k,u_pitch_with_map:+p,u_texsize:B,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Nf,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Nf,u_up_vector:[0,-1,0]};return Q.name==="globe"&&(Z.u_tile_id=[R.canonical.x,R.canonical.y,1<<R.canonical.z],Z.u_zoom_transition=U,Z.u_inv_rot_matrix=J,Z.u_merc_center=W,Z.u_camera_forward=te._camera.forward(),Z.u_ecef_origin=o.globeECEFOrigin(te.globeMatrix,R.toUnwrapped()),Z.u_tile_matrix=Float32Array.from(te.globeMatrix),Z.u_up_vector=K),Z},Uf=(h,r,c,p,_,x,E,I,k,B,R,U,W,J,K,Q,te)=>o.extend(Sl(h,r,c,p,_,x,E,I,k,B,U,W,J,K,Q,te),{u_gamma_scale:p?_.transform.cameraToCenterDistance*Math.cos(_.terrain?0:_.transform._pitch):1,u_device_pixel_ratio:o.exported.devicePixelRatio,u_is_halo:+R}),Dd=(h,r,c,p,_,x,E,I,k,B,R,U,W,J,K,Q)=>o.extend(Uf(h,r,c,p,_,x,E,I,!0,k,!0,R,U,W,J,K,Q),{u_texsize_icon:B,u_texture_icon:1}),Sg=(h,r,c)=>({u_matrix:h,u_opacity:r,u_color:c}),Bd=(h,r,c,p,_)=>o.extend(function(x,E,I){const k=E.imageManager.getPattern(x.toString()),{width:B,height:R}=E.imageManager.getPixelSize(),U=Math.pow(2,I.tileID.overscaledZ),W=I.tileSize*Math.pow(2,E.transform.tileZoom)/U,J=W*(I.tileID.canonical.x+I.tileID.wrap*U),K=W*I.tileID.canonical.y;return{u_image:0,u_pattern_tl:k.tl,u_pattern_br:k.br,u_texsize:[B,R],u_pattern_size:k.displaySize,u_tile_units_to_pixels:1/At(I,1,E.transform.tileZoom),u_pixel_coord_upper:[J>>16,K>>16],u_pixel_coord_lower:[65535&J,65535&K]}}(p,c,_),{u_matrix:h,u_opacity:r}),Eg={fillExtrusion:h=>({u_matrix:new o.UniformMatrix4f(h),u_lightpos:new o.Uniform3f(h),u_lightintensity:new o.Uniform1f(h),u_lightcolor:new o.Uniform3f(h),u_vertical_gradient:new o.Uniform1f(h),u_opacity:new o.Uniform1f(h),u_edge_radius:new o.Uniform1f(h),u_ao:new o.Uniform2f(h),u_tile_id:new o.Uniform3f(h),u_zoom_transition:new o.Uniform1f(h),u_inv_rot_matrix:new o.UniformMatrix4f(h),u_merc_center:new o.Uniform2f(h),u_up_dir:new o.Uniform3f(h),u_height_lift:new o.Uniform1f(h)}),fillExtrusionPattern:h=>({u_matrix:new o.UniformMatrix4f(h),u_lightpos:new o.Uniform3f(h),u_lightintensity:new o.Uniform1f(h),u_lightcolor:new o.Uniform3f(h),u_vertical_gradient:new o.Uniform1f(h),u_height_factor:new o.Uniform1f(h),u_edge_radius:new o.Uniform1f(h),u_ao:new o.Uniform2f(h),u_tile_id:new o.Uniform3f(h),u_zoom_transition:new o.Uniform1f(h),u_inv_rot_matrix:new o.UniformMatrix4f(h),u_merc_center:new o.Uniform2f(h),u_up_dir:new o.Uniform3f(h),u_height_lift:new o.Uniform1f(h),u_image:new o.Uniform1i(h),u_texsize:new o.Uniform2f(h),u_pixel_coord_upper:new o.Uniform2f(h),u_pixel_coord_lower:new o.Uniform2f(h),u_tile_units_to_pixels:new o.Uniform1f(h),u_opacity:new o.Uniform1f(h)}),fill:h=>({u_matrix:new o.UniformMatrix4f(h)}),fillPattern:h=>({u_matrix:new o.UniformMatrix4f(h),u_image:new o.Uniform1i(h),u_texsize:new o.Uniform2f(h),u_pixel_coord_upper:new o.Uniform2f(h),u_pixel_coord_lower:new o.Uniform2f(h),u_tile_units_to_pixels:new o.Uniform1f(h)}),fillOutline:h=>({u_matrix:new o.UniformMatrix4f(h),u_world:new o.Uniform2f(h)}),fillOutlinePattern:h=>({u_matrix:new o.UniformMatrix4f(h),u_world:new o.Uniform2f(h),u_image:new o.Uniform1i(h),u_texsize:new o.Uniform2f(h),u_pixel_coord_upper:new o.Uniform2f(h),u_pixel_coord_lower:new o.Uniform2f(h),u_tile_units_to_pixels:new o.Uniform1f(h)}),circle:h=>({u_camera_to_center_distance:new o.Uniform1f(h),u_extrude_scale:new o.UniformMatrix2f(h),u_device_pixel_ratio:new o.Uniform1f(h),u_matrix:new o.UniformMatrix4f(h),u_inv_rot_matrix:new o.UniformMatrix4f(h),u_merc_center:new o.Uniform2f(h),u_tile_id:new o.Uniform3f(h),u_zoom_transition:new o.Uniform1f(h),u_up_dir:new o.Uniform3f(h)}),collisionBox:h=>({u_matrix:new o.UniformMatrix4f(h),u_camera_to_center_distance:new o.Uniform1f(h),u_extrude_scale:new o.Uniform2f(h)}),collisionCircle:h=>({u_matrix:new o.UniformMatrix4f(h),u_inv_matrix:new o.UniformMatrix4f(h),u_camera_to_center_distance:new o.Uniform1f(h),u_viewport_size:new o.Uniform2f(h)}),debug:h=>({u_color:new o.UniformColor(h),u_matrix:new o.UniformMatrix4f(h),u_overlay:new o.Uniform1i(h),u_overlay_scale:new o.Uniform1f(h)}),clippingMask:h=>({u_matrix:new o.UniformMatrix4f(h)}),heatmap:h=>({u_extrude_scale:new o.Uniform1f(h),u_intensity:new o.Uniform1f(h),u_matrix:new o.UniformMatrix4f(h),u_inv_rot_matrix:new o.UniformMatrix4f(h),u_merc_center:new o.Uniform2f(h),u_tile_id:new o.Uniform3f(h),u_zoom_transition:new o.Uniform1f(h),u_up_dir:new o.Uniform3f(h)}),heatmapTexture:h=>({u_image:new o.Uniform1i(h),u_color_ramp:new o.Uniform1i(h),u_opacity:new o.Uniform1f(h)}),hillshade:h=>({u_matrix:new o.UniformMatrix4f(h),u_image:new o.Uniform1i(h),u_latrange:new o.Uniform2f(h),u_light:new o.Uniform2f(h),u_shadow:new o.UniformColor(h),u_highlight:new o.UniformColor(h),u_accent:new o.UniformColor(h)}),hillshadePrepare:h=>({u_matrix:new o.UniformMatrix4f(h),u_image:new o.Uniform1i(h),u_dimension:new o.Uniform2f(h),u_zoom:new o.Uniform1f(h),u_unpack:new o.Uniform4f(h)}),line:h=>({u_matrix:new o.UniformMatrix4f(h),u_pixels_to_tile_units:new o.UniformMatrix2f(h),u_device_pixel_ratio:new o.Uniform1f(h),u_units_to_pixels:new o.Uniform2f(h),u_dash_image:new o.Uniform1i(h),u_gradient_image:new o.Uniform1i(h),u_image_height:new o.Uniform1f(h),u_texsize:new o.Uniform2f(h),u_tile_units_to_pixels:new o.Uniform1f(h),u_alpha_discard_threshold:new o.Uniform1f(h),u_trim_offset:new o.Uniform2f(h)}),linePattern:h=>({u_matrix:new o.UniformMatrix4f(h),u_texsize:new o.Uniform2f(h),u_pixels_to_tile_units:new o.UniformMatrix2f(h),u_device_pixel_ratio:new o.Uniform1f(h),u_image:new o.Uniform1i(h),u_units_to_pixels:new o.Uniform2f(h),u_tile_units_to_pixels:new o.Uniform1f(h),u_alpha_discard_threshold:new o.Uniform1f(h)}),raster:h=>({u_matrix:new o.UniformMatrix4f(h),u_tl_parent:new o.Uniform2f(h),u_scale_parent:new o.Uniform1f(h),u_fade_t:new o.Uniform1f(h),u_opacity:new o.Uniform1f(h),u_image0:new o.Uniform1i(h),u_image1:new o.Uniform1i(h),u_brightness_low:new o.Uniform1f(h),u_brightness_high:new o.Uniform1f(h),u_saturation_factor:new o.Uniform1f(h),u_contrast_factor:new o.Uniform1f(h),u_spin_weights:new o.Uniform3f(h),u_perspective_transform:new o.Uniform2f(h)}),symbolIcon:h=>({u_is_size_zoom_constant:new o.Uniform1i(h),u_is_size_feature_constant:new o.Uniform1i(h),u_size_t:new o.Uniform1f(h),u_size:new o.Uniform1f(h),u_camera_to_center_distance:new o.Uniform1f(h),u_rotate_symbol:new o.Uniform1i(h),u_aspect_ratio:new o.Uniform1f(h),u_fade_change:new o.Uniform1f(h),u_matrix:new o.UniformMatrix4f(h),u_label_plane_matrix:new o.UniformMatrix4f(h),u_coord_matrix:new o.UniformMatrix4f(h),u_is_text:new o.Uniform1i(h),u_pitch_with_map:new o.Uniform1i(h),u_texsize:new o.Uniform2f(h),u_tile_id:new o.Uniform3f(h),u_zoom_transition:new o.Uniform1f(h),u_inv_rot_matrix:new o.UniformMatrix4f(h),u_merc_center:new o.Uniform2f(h),u_camera_forward:new o.Uniform3f(h),u_tile_matrix:new o.UniformMatrix4f(h),u_up_vector:new o.Uniform3f(h),u_ecef_origin:new o.Uniform3f(h),u_texture:new o.Uniform1i(h)}),symbolSDF:h=>({u_is_size_zoom_constant:new o.Uniform1i(h),u_is_size_feature_constant:new o.Uniform1i(h),u_size_t:new o.Uniform1f(h),u_size:new o.Uniform1f(h),u_camera_to_center_distance:new o.Uniform1f(h),u_rotate_symbol:new o.Uniform1i(h),u_aspect_ratio:new o.Uniform1f(h),u_fade_change:new o.Uniform1f(h),u_matrix:new o.UniformMatrix4f(h),u_label_plane_matrix:new o.UniformMatrix4f(h),u_coord_matrix:new o.UniformMatrix4f(h),u_is_text:new o.Uniform1i(h),u_pitch_with_map:new o.Uniform1i(h),u_texsize:new o.Uniform2f(h),u_texture:new o.Uniform1i(h),u_gamma_scale:new o.Uniform1f(h),u_device_pixel_ratio:new o.Uniform1f(h),u_tile_id:new o.Uniform3f(h),u_zoom_transition:new o.Uniform1f(h),u_inv_rot_matrix:new o.UniformMatrix4f(h),u_merc_center:new o.Uniform2f(h),u_camera_forward:new o.Uniform3f(h),u_tile_matrix:new o.UniformMatrix4f(h),u_up_vector:new o.Uniform3f(h),u_ecef_origin:new o.Uniform3f(h),u_is_halo:new o.Uniform1i(h)}),symbolTextAndIcon:h=>({u_is_size_zoom_constant:new o.Uniform1i(h),u_is_size_feature_constant:new o.Uniform1i(h),u_size_t:new o.Uniform1f(h),u_size:new o.Uniform1f(h),u_camera_to_center_distance:new o.Uniform1f(h),u_rotate_symbol:new o.Uniform1i(h),u_aspect_ratio:new o.Uniform1f(h),u_fade_change:new o.Uniform1f(h),u_matrix:new o.UniformMatrix4f(h),u_label_plane_matrix:new o.UniformMatrix4f(h),u_coord_matrix:new o.UniformMatrix4f(h),u_is_text:new o.Uniform1i(h),u_pitch_with_map:new o.Uniform1i(h),u_texsize:new o.Uniform2f(h),u_texsize_icon:new o.Uniform2f(h),u_texture:new o.Uniform1i(h),u_texture_icon:new o.Uniform1i(h),u_gamma_scale:new o.Uniform1f(h),u_device_pixel_ratio:new o.Uniform1f(h),u_is_halo:new o.Uniform1i(h)}),background:h=>({u_matrix:new o.UniformMatrix4f(h),u_opacity:new o.Uniform1f(h),u_color:new o.UniformColor(h)}),backgroundPattern:h=>({u_matrix:new o.UniformMatrix4f(h),u_opacity:new o.Uniform1f(h),u_image:new o.Uniform1i(h),u_pattern_tl:new o.Uniform2f(h),u_pattern_br:new o.Uniform2f(h),u_texsize:new o.Uniform2f(h),u_pattern_size:new o.Uniform2f(h),u_pixel_coord_upper:new o.Uniform2f(h),u_pixel_coord_lower:new o.Uniform2f(h),u_tile_units_to_pixels:new o.Uniform1f(h)}),terrainRaster:jc,terrainDepth:jc,skybox:h=>({u_matrix:new o.UniformMatrix4f(h),u_sun_direction:new o.Uniform3f(h),u_cubemap:new o.Uniform1i(h),u_opacity:new o.Uniform1f(h),u_temporal_offset:new o.Uniform1f(h)}),skyboxGradient:h=>({u_matrix:new o.UniformMatrix4f(h),u_color_ramp:new o.Uniform1i(h),u_center_direction:new o.Uniform3f(h),u_radius:new o.Uniform1f(h),u_opacity:new o.Uniform1f(h),u_temporal_offset:new o.Uniform1f(h)}),skyboxCapture:h=>({u_matrix_3f:new o.UniformMatrix3f(h),u_sun_direction:new o.Uniform3f(h),u_sun_intensity:new o.Uniform1f(h),u_color_tint_r:new o.Uniform4f(h),u_color_tint_m:new o.Uniform4f(h),u_luminance:new o.Uniform1f(h)}),globeRaster:h=>({u_proj_matrix:new o.UniformMatrix4f(h),u_globe_matrix:new o.UniformMatrix4f(h),u_normalize_matrix:new o.UniformMatrix4f(h),u_merc_matrix:new o.UniformMatrix4f(h),u_zoom_transition:new o.Uniform1f(h),u_merc_center:new o.Uniform2f(h),u_image0:new o.Uniform1i(h),u_grid_matrix:new o.UniformMatrix3f(h),u_skirt_height:new o.Uniform1f(h),u_frustum_tl:new o.Uniform3f(h),u_frustum_tr:new o.Uniform3f(h),u_frustum_br:new o.Uniform3f(h),u_frustum_bl:new o.Uniform3f(h),u_globe_pos:new o.Uniform3f(h),u_globe_radius:new o.Uniform1f(h),u_viewport:new o.Uniform2f(h)}),globeAtmosphere:h=>({u_frustum_tl:new o.Uniform3f(h),u_frustum_tr:new o.Uniform3f(h),u_frustum_br:new o.Uniform3f(h),u_frustum_bl:new o.Uniform3f(h),u_horizon:new o.Uniform1f(h),u_transition:new o.Uniform1f(h),u_fadeout_range:new o.Uniform1f(h),u_color:new o.Uniform4f(h),u_high_color:new o.Uniform4f(h),u_space_color:new o.Uniform4f(h),u_star_intensity:new o.Uniform1f(h),u_star_density:new o.Uniform1f(h),u_star_size:new o.Uniform1f(h),u_temporal_offset:new o.Uniform1f(h),u_horizon_angle:new o.Uniform1f(h),u_rotation_matrix:new o.UniformMatrix4f(h)})};let qs;function jf(h,r,c,p,_,x,E){const I=h.context,k=I.gl,B=h.transform,R=h.useProgram("collisionBox"),U=[];let W=0,J=0;for(let de=0;de<p.length;de++){const Se=p[de],be=r.getTile(Se),Ae=be.getBucket(c);if(!Ae)continue;const Be=md(Se,Ae,B);let Ne=Be;_[0]===0&&_[1]===0||(Ne=h.translatePosMatrix(Be,be,_,x));const Ge=E?Ae.textCollisionBox:Ae.iconCollisionBox,bt=Ae.collisionCircleArray;if(bt.length>0){const Fe=o.create(),rt=Ne;o.mul(Fe,Ae.placementInvProjMatrix,B.glCoordMatrix),o.mul(Fe,Fe,Ae.placementViewportMatrix),U.push({circleArray:bt,circleOffset:J,transform:rt,invTransform:Fe,projection:Ae.getProjection()}),W+=bt.length/4,J=W}Ge&&(h.terrain&&h.terrain.setupElevationDraw(be,R),R.draw(I,k.LINES,o.DepthMode.disabled,o.StencilMode.disabled,h.colorModeForRenderPass(),o.CullFaceMode.disabled,Vf(Ne,B,be,Ae.getProjection()),c.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,null,B.zoom,null,[Ge.collisionVertexBuffer,Ge.collisionVertexBufferExt]))}if(!E||!U.length)return;const K=h.useProgram("collisionCircle"),Q=new o.StructArrayLayout2f1f2i16;Q.resize(4*W),Q._trim();let te=0;for(const de of U)for(let Se=0;Se<de.circleArray.length/4;Se++){const be=4*Se,Ae=de.circleArray[be+0],Be=de.circleArray[be+1],Ne=de.circleArray[be+2],Ge=de.circleArray[be+3];Q.emplace(te++,Ae,Be,Ne,Ge,0),Q.emplace(te++,Ae,Be,Ne,Ge,1),Q.emplace(te++,Ae,Be,Ne,Ge,2),Q.emplace(te++,Ae,Be,Ne,Ge,3)}(!qs||qs.length<2*W)&&(qs=function(de){const Se=2*de,be=new o.StructArrayLayout3ui6;be.resize(Se),be._trim();for(let Ae=0;Ae<Se;Ae++){const Be=6*Ae;be.uint16[Be+0]=4*Ae+0,be.uint16[Be+1]=4*Ae+1,be.uint16[Be+2]=4*Ae+2,be.uint16[Be+3]=4*Ae+2,be.uint16[Be+4]=4*Ae+3,be.uint16[Be+5]=4*Ae+0}return be}(W));const Z=I.createIndexBuffer(qs,!0),le=I.createVertexBuffer(Q,o.collisionCircleLayout.members,!0);for(const de of U){const Se={u_matrix:de.transform,u_inv_matrix:de.invTransform,u_camera_to_center_distance:(se=B).getCameraToCenterDistance(de.projection),u_viewport_size:[se.width,se.height]};K.draw(I,k.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,h.colorModeForRenderPass(),o.CullFaceMode.disabled,Se,c.id,le,Z,o.SegmentVector.simpleSegment(0,2*de.circleOffset,de.circleArray.length,de.circleArray.length/2),null,B.zoom)}var se;le.destroy(),Z.destroy()}const Rd=o.create();function Gf({width:h,height:r,anchor:c,textOffset:p,textScale:_},x){const{horizontalAlign:E,verticalAlign:I}=o.getAnchorAlignment(c),k=-(E-.5)*h,B=-(I-.5)*r,R=o.evaluateVariableOffset(c,p);return new o.pointGeometry((k/_+R[0])*x,(B/_+R[1])*x)}function Ia(h,r,c,p,_,x,E,I,k,B,R){const U=h.text.placedSymbolArray,W=h.text.dynamicLayoutVertexArray,J=h.icon.dynamicLayoutVertexArray,K={},Q=h.getProjection(),te=Lc(I,Q,x),Z=x.elevation,le=Q.upVectorScale(I.canonical,x.center.lat,x.worldSize).metersToTile;W.clear();for(let se=0;se<U.length;se++){const de=U.get(se),{tileAnchorX:Se,tileAnchorY:be,numGlyphs:Ae}=de,Be=h.allowVerticalPlacement&&!de.placedOrientation,Ne=de.hidden||!de.crossTileID||Be?null:p[de.crossTileID];if(Ne){let Ge=0,bt=0,Fe=0;if(Z){const Wt=Z?Z.getAtTileOffset(I,Se,be):0,[mn,Ut,Ft]=Q.upVector(I.canonical,Se,be);Ge=Wt*mn*le,bt=Wt*Ut*le,Fe=Wt*Ft*le}let[rt,He,ut,Ue]=Et(de.projectedAnchorX+Ge,de.projectedAnchorY+bt,de.projectedAnchorZ+Fe,c?te:E);const Le=Pn(x.getCameraToCenterDistance(Q),Ue);let Ze=_.evaluateSizeForFeature(h.textSizeData,B,de)*Le/o.ONE_EM;c&&(Ze*=h.tilePixelRatio/k);const lt=Gf(Ne,Ze);c?({x:rt,y:He,z:ut}=Q.projectTilePoint(Se+lt.x,be+lt.y,I.canonical),[rt,He,ut]=Et(rt+Ge,He+bt,ut+Fe,E)):(r&&lt._rotate(-x.angle),rt+=lt.x,He+=lt.y,ut=0);const mt=h.allowVerticalPlacement&&de.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let Wt=0;Wt<Ae;Wt++)o.addDynamicAttributes(W,rt,He,ut,mt);R&&de.associatedIconIndex>=0&&(K[de.associatedIconIndex]={x:rt,y:He,z:ut,angle:mt})}else ai(Ae,W)}if(R){J.clear();const se=h.icon.placedSymbolArray;for(let de=0;de<se.length;de++){const Se=se.get(de),{numGlyphs:be}=Se,Ae=K[de];if(Se.hidden||!Ae)ai(be,J);else{const{x:Be,y:Ne,z:Ge,angle:bt}=Ae;for(let Fe=0;Fe<be;Fe++)o.addDynamicAttributes(J,Be,Ne,Ge,bt)}}h.icon.dynamicLayoutVertexBuffer.updateData(J)}h.text.dynamicLayoutVertexBuffer.updateData(W)}function Cg(h,r,c){return c.iconsInText&&r?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function qf(h,r,c,p,_,x,E,I,k,B,R,U){const W=h.context,J=W.gl,K=h.transform,Q=I==="map",te=k==="map",Z=Q&&c.layout.get("symbol-placement")!=="point",le=Q&&!te&&!Z,se=c.layout.get("symbol-sort-key").constantOr(1)!==void 0;let de=!1;const Se=h.depthModeForSublayer(0,o.DepthMode.ReadOnly),be=[o.mercatorXfromLng(K.center.lng),o.mercatorYfromLat(K.center.lat)],Ae=c.layout.get("text-variable-anchor"),Be=K.projection.name==="globe",Ne=[],Ge=[0,-1,0];let bt=Ge;!Be&&!K.mercatorFromTransition||Q||(bt=function(Fe){const rt=Fe._camera.getWorldToCamera(Fe.worldSize,1),He=o.multiply([],rt,Fe.globeMatrix);o.invert(He,He);const ut=[0,0,0],Ue=[0,1,0,0];return o.transformMat4$1(Ue,Ue,He),ut[0]=Ue[0],ut[1]=Ue[1],ut[2]=Ue[2],o.normalize(ut,ut),ut}(K));for(const Fe of p){const rt=r.getTile(Fe),He=rt.getBucket(c);if(!He||He.projection.name==="mercator"&&Be)continue;const ut=_?He.text:He.icon;if(!ut||He.fullyClipped||!ut.segments.get().length)continue;const Ue=ut.programConfigurations.get(c.id),Le=_||He.sdfIcons,Ze=_?He.textSizeData:He.iconSizeData,lt=te||K.pitch!==0,mt=o.evaluateSizeForZoom(Ze,K.zoom);let Wt,mn,Ut,Ft,Ht=[0,0],In=null;if(_){if(mn=rt.glyphAtlasTexture,Ut=J.LINEAR,Wt=rt.glyphAtlasTexture.size,He.iconsInText){Ht=rt.imageAtlasTexture.size,In=rt.imageAtlasTexture;const qr=Ze.kind==="composite"||Ze.kind==="camera";Ft=lt||h.options.rotating||h.options.zooming||qr?J.LINEAR:J.NEAREST}}else{const qr=c.layout.get("icon-size").constantOr(0)!==1||He.iconsNeedLinear;mn=rt.imageAtlasTexture,Ut=Le||h.options.rotating||h.options.zooming||qr||lt?J.LINEAR:J.NEAREST,Wt=rt.imageAtlasTexture.size}const Qt=He.projection.name==="globe",Zn=Qt?bt:Ge,ei=Qt?o.globeToMercatorTransition(K.zoom):0,li=Lc(Fe,He.getProjection(),K),ri=K.calculatePixelsToTileUnitsMatrix(rt),Fi=va(li,rt.tileID.canonical,te,Q,K,He.getProjection(),ri),Br=h.terrain&&te&&Z?o.invert(o.create(),Fi):Rd,ro=ya(li,rt.tileID.canonical,te,Q,K,He.getProjection(),ri),No=Ae&&He.hasTextData(),gi=c.layout.get("icon-text-fit")!=="none"&&No&&He.hasIconData();if(Z){const qr=K.elevation,Xr=qr?qr.getAtTileOffsetFunc(Fe,K.center.lat,K.worldSize,He.getProjection()):null,Uo=Cf(li,rt.tileID.canonical,te,Q,K,He.getProjection(),ri);_o(He,li,h,_,Uo,ro,te,B,Xr,Fe)}const oi=Z||_&&Ae||gi,$n=h.translatePosMatrix(li,rt,x,E),Ii=oi?Rd:Fi,vr=h.translatePosMatrix(ro,rt,x,E,!0),di=He.getProjection().createInversionMatrix(K,Fe.canonical),yr=[];h.terrainRenderModeElevated()&&te&&yr.push("PITCH_WITH_MAP_TERRAIN"),Qt&&yr.push("PROJECTION_GLOBE_VIEW"),oi&&yr.push("PROJECTED_POS_ON_VIEWPORT");const xr=Le&&c.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let hs;hs=Le?He.iconsInText?Dd(Ze.kind,mt,le,te,h,$n,Ii,vr,Wt,Ht,Fe,ei,be,di,Zn,He.getProjection()):Uf(Ze.kind,mt,le,te,h,$n,Ii,vr,_,Wt,!0,Fe,ei,be,di,Zn,He.getProjection()):Sl(Ze.kind,mt,le,te,h,$n,Ii,vr,_,Wt,Fe,ei,be,di,Zn,He.getProjection());const Fa={program:h.useProgram(Cg(Le,_,He),Ue,yr),buffers:ut,uniformValues:hs,atlasTexture:mn,atlasTextureIcon:In,atlasInterpolation:Ut,atlasInterpolationIcon:Ft,isSDF:Le,hasHalo:xr,tile:rt,labelPlaneMatrixInv:Br};if(se&&He.canOverlap){de=!0;const qr=ut.segments.get();for(const Xr of qr)Ne.push({segments:new o.SegmentVector([Xr]),sortKey:Xr.sortKey,state:Fa})}else Ne.push({segments:ut.segments,sortKey:0,state:Fa})}de&&Ne.sort((Fe,rt)=>Fe.sortKey-rt.sortKey);for(const Fe of Ne){const rt=Fe.state;if(h.terrain&&h.terrain.setupElevationDraw(rt.tile,rt.program,{useDepthForOcclusion:!Be,labelPlaneMatrixInv:rt.labelPlaneMatrixInv}),W.activeTexture.set(J.TEXTURE0),rt.atlasTexture.bind(rt.atlasInterpolation,J.CLAMP_TO_EDGE),rt.atlasTextureIcon&&(W.activeTexture.set(J.TEXTURE1),rt.atlasTextureIcon&&rt.atlasTextureIcon.bind(rt.atlasInterpolationIcon,J.CLAMP_TO_EDGE)),rt.isSDF){const He=rt.uniformValues;rt.hasHalo&&(He.u_is_halo=1,Zf(rt.buffers,Fe.segments,c,h,rt.program,Se,R,U,He)),He.u_is_halo=0}Zf(rt.buffers,Fe.segments,c,h,rt.program,Se,R,U,rt.uniformValues)}}function Zf(h,r,c,p,_,x,E,I,k){const B=p.context,R=[h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer,h.globeExtVertexBuffer];_.draw(B,B.gl.TRIANGLES,x,E,I,o.CullFaceMode.disabled,k,c.id,h.layoutVertexBuffer,h.indexBuffer,r,c.paint,p.transform.zoom,h.programConfigurations.get(c.id),R)}function Wf(h,r,c,p,_,x,E){const I=h.context.gl,k=c.paint.get("fill-pattern"),B=k&&k.constantOr(1);let R,U,W,J,K;E?(U=B&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",R=I.LINES):(U=B?"fillPattern":"fill",R=I.TRIANGLES);for(const Q of p){const te=r.getTile(Q);if(B&&!te.patternsLoaded())continue;const Z=te.getBucket(c);if(!Z)continue;h.prepareDrawTile();const le=Z.programConfigurations.get(c.id),se=h.useProgram(U,le);B&&(h.context.activeTexture.set(I.TEXTURE0),te.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),le.updatePaintBuffers());const de=k.constantOr(null);if(de&&te.imageAtlas){const be=te.imageAtlas.patternPositions[de.toString()];be&&le.setConstantPatternPositions(be)}const Se=h.translatePosMatrix(Q.projMatrix,te,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(E){J=Z.indexBuffer2,K=Z.segments2;const be=h.terrain&&h.terrain.renderingToTexture?h.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];W=U==="fillOutlinePattern"&&B?Ff(Se,h,te,be):Of(Se,be)}else J=Z.indexBuffer,K=Z.segments,W=B?Hc(Se,h,te):Wc(Se);h.prepareDrawProgram(h.context,se,Q.toUnwrapped()),se.draw(h.context,R,_,h.stencilModeForClipping(Q),x,o.CullFaceMode.disabled,W,c.id,Z.layoutVertexBuffer,J,K,c.paint,h.transform.zoom,le)}}function Od(h,r,c,p,_,x,E){const I=h.context,k=I.gl,B=h.transform,R=c.paint.get("fill-extrusion-pattern"),U=R.constantOr(1),W=c.paint.get("fill-extrusion-opacity"),J=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),c.paint.get("fill-extrusion-ambient-occlusion-radius")],K=c.layout.get("fill-extrusion-edge-radius"),Q=B.projection.name==="globe"?o.fillExtrusionHeightLift():0,te=B.projection.name==="globe",Z=te?o.globeToMercatorTransition(B.zoom):0,le=[o.mercatorXfromLng(B.center.lng),o.mercatorYfromLat(B.center.lat)],se=[];te&&se.push("PROJECTION_GLOBE_VIEW"),J[0]>0&&se.push("FAUX_AO");for(const de of p){const Se=r.getTile(de),be=Se.getBucket(c);if(!be||be.projection.name!==B.projection.name)continue;const Ae=be.programConfigurations.get(c.id),Be=h.useProgram(U?"fillExtrusionPattern":"fillExtrusion",Ae,se);if(h.terrain){const ut=h.terrain;if(h.style.terrainSetForDrapingOnly())ut.setupElevationDraw(Se,Be,{useMeterToDem:!0});else{if(!be.enableTerrain)continue;if(ut.setupElevationDraw(Se,Be,{useMeterToDem:!0}),Ig(I,r,de,be,c,ut),!be.centroidVertexBuffer){const Ue=Be.attributes.a_centroid_pos;Ue!==void 0&&k.vertexAttrib2f(Ue,0,0)}}}U&&(h.context.activeTexture.set(k.TEXTURE0),Se.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),Ae.updatePaintBuffers());const Ne=R.constantOr(null);if(Ne&&Se.imageAtlas){const ut=Se.imageAtlas.patternPositions[Ne.toString()];ut&&Ae.setConstantPatternPositions(ut)}const Ge=h.translatePosMatrix(de.projMatrix,Se,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),bt=B.projection.createInversionMatrix(B,de.canonical),Fe=c.paint.get("fill-extrusion-vertical-gradient"),rt=U?kd(Ge,h,Fe,W,J,K,de,Se,Q,Z,le,bt):Zc(Ge,h,Fe,W,J,K,de,Q,Z,le,bt);h.prepareDrawProgram(I,Be,de.toUnwrapped());const He=[];h.terrain&&He.push(be.centroidVertexBuffer),te&&He.push(be.layoutVertexExtBuffer),Be.draw(I,I.gl.TRIANGLES,_,x,E,o.CullFaceMode.backCCW,rt,c.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,c.paint,h.transform.zoom,Ae,He)}}function Ig(h,r,c,p,_,x){const E=[Z=>{let le=Z.canonical.x-1,se=Z.wrap;return le<0&&(le=(1<<Z.canonical.z)-1,se--),new o.OverscaledTileID(Z.overscaledZ,se,Z.canonical.z,le,Z.canonical.y)},Z=>{let le=Z.canonical.x+1,se=Z.wrap;return le===1<<Z.canonical.z&&(le=0,se++),new o.OverscaledTileID(Z.overscaledZ,se,Z.canonical.z,le,Z.canonical.y)},Z=>new o.OverscaledTileID(Z.overscaledZ,Z.wrap,Z.canonical.z,Z.canonical.x,(Z.canonical.y===0?1<<Z.canonical.z:Z.canonical.y)-1),Z=>new o.OverscaledTileID(Z.overscaledZ,Z.wrap,Z.canonical.z,Z.canonical.x,Z.canonical.y===(1<<Z.canonical.z)-1?0:Z.canonical.y+1)],I=Z=>{const le=r.getSource().minzoom,se=Se=>{const be=r.getTileByID(Se);if(be&&be.hasData())return be.getBucket(_)},de=[0,-1,1];for(const Se of de){if(Z.overscaledZ+Se<le)continue;const be=se(Z.calculateScaledKey(Z.overscaledZ+Se));if(be)return be}},k=[0,0,0],B=(Z,le)=>(k[0]=Math.min(Z.min.y,le.min.y),k[1]=Math.max(Z.max.y,le.max.y),k[2]=o.EXTENT-le.min.x>Z.max.x?le.min.x-o.EXTENT:Z.max.x,k),R=(Z,le)=>(k[0]=Math.min(Z.min.x,le.min.x),k[1]=Math.max(Z.max.x,le.max.x),k[2]=o.EXTENT-le.min.y>Z.max.y?le.min.y-o.EXTENT:Z.max.y,k),U=[(Z,le)=>B(Z,le),(Z,le)=>B(le,Z),(Z,le)=>R(Z,le),(Z,le)=>R(le,Z)],W=new o.pointGeometry(0,0);let J,K,Q;const te=(Z,le,se,de,Se)=>{const be=[[de?se:Z,de?Z:se,0],[de?se:le,de?le:se,0]],Ae=Se<0?o.EXTENT+Se:Se,Be=[de?Ae:(Z+le)/2,de?(Z+le)/2:Ae,0];return se===0&&Se<0||se!==0&&Se>0?x.getForTilePoints(Q,[Be],!0,K):be.push(Be),x.getForTilePoints(c,be,!0,J),Math.max(be[0][2],be[1][2],Be[2])/x.exaggeration()};for(let Z=0;Z<4;Z++){const le=(Z<2?1:5)-Z,se=p.borders[Z];if(se.length===0)continue;const de=Q=E[Z](c),Se=I(de);if(!(Se&&Se instanceof o.FillExtrusionBucket&&Se.enableTerrain)||p.borderDoneWithNeighborZ[Z]===Se.canonical.z&&Se.borderDoneWithNeighborZ[le]===p.canonical.z||(K=x.findDEMTileFor(de),!K||!K.dem))continue;if(!J){const Ne=x.findDEMTileFor(c);if(!Ne||!Ne.dem)return;J=Ne}const be=Se.borders[le];let Ae=0;const Be=Se.borderDoneWithNeighborZ[le]!==p.canonical.z;if(p.canonical.z===Se.canonical.z){for(let Ne=0;Ne<se.length;Ne++){const Ge=p.featuresOnBorder[se[Ne]],bt=Ge.borders[Z];let Fe;for(;Ae<be.length&&(Fe=Se.featuresOnBorder[be[Ae]],!(Fe.borders[le][1]>bt[0]+3));)Be&&Se.encodeCentroid(void 0,Fe,!1),Ae++;if(Fe&&Ae<be.length){const rt=Ae;let He=0;for(;!(Fe.borders[le][0]>bt[1]-3)&&(He++,++Ae!==be.length);)Fe=Se.featuresOnBorder[be[Ae]];if(Fe=Se.featuresOnBorder[be[rt]],Ge.intersectsCount()>1||Fe.intersectsCount()>1||He!==1){He!==1&&(Ae=rt),p.encodeCentroid(void 0,Ge,!1),Be&&Se.encodeCentroid(void 0,Fe,!1);continue}const ut=U[Z](Ge,Fe),Ue=Z%2?o.EXTENT-1:0;W.x=te(ut[0],Math.min(o.EXTENT-1,ut[1]),Ue,Z<2,ut[2]),W.y=0,p.encodeCentroid(W,Ge,!1),Be&&Se.encodeCentroid(W,Fe,!1)}else p.encodeCentroid(void 0,Ge,!1)}p.borderDoneWithNeighborZ[Z]=Se.canonical.z,p.needsCentroidUpdate=!0,Be&&(Se.borderDoneWithNeighborZ[le]=p.canonical.z,Se.needsCentroidUpdate=!0)}else{for(const Ne of se)p.encodeCentroid(void 0,p.featuresOnBorder[Ne],!1);if(Be){for(const Ne of be)Se.encodeCentroid(void 0,Se.featuresOnBorder[Ne],!1);Se.borderDoneWithNeighborZ[le]=p.canonical.z,Se.needsCentroidUpdate=!0}p.borderDoneWithNeighborZ[Z]=Se.canonical.z,p.needsCentroidUpdate=!0}}(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(h)}const Fd=new o.Color(1,0,0,1),Vd=new o.Color(0,1,0,1),Hf=new o.Color(0,0,1,1),Xf=new o.Color(1,0,1,1),Yf=new o.Color(0,1,1,1);function $d(h,r,c){const p=h.context,_=h.transform,x=p.gl,E=_.projection.name==="globe",I=E?["PROJECTION_GLOBE_VIEW"]:null;let k=c.projMatrix;if(E&&o.globeToMercatorTransition(_.zoom)>0){const Ge=o.transitionTileAABBinECEF(c.canonical,_),bt=o.globeDenormalizeECEF(Ge);k=o.multiply(new Float32Array(16),_.globeMatrix,bt),o.multiply(k,_.projMatrix,k)}const B=h.useProgram("debug",null,I),R=r.getTileByID(c.key);h.terrain&&h.terrain.setupElevationDraw(R,B);const U=o.DepthMode.disabled,W=o.StencilMode.disabled,J=h.colorModeForRenderPass(),K="$debug";p.activeTexture.set(x.TEXTURE0),h.emptyTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE),E?R._makeGlobeTileDebugBuffers(h.context,_):R._makeDebugTileBoundsBuffers(h.context,_.projection);const Q=R._tileDebugBuffer||h.debugBuffer,te=R._tileDebugIndexBuffer||h.debugIndexBuffer,Z=R._tileDebugSegments||h.debugSegments;B.draw(p,x.LINE_STRIP,U,W,J,o.CullFaceMode.disabled,Tl(k,o.Color.red),K,Q,te,Z,null,null,null,[R._globeTileDebugBorderBuffer]);const le=R.latestRawTileData,se=Math.floor((le&&le.byteLength||0)/1024),de=r.getTile(c).tileSize,Se=512/Math.min(de,512)*(c.overscaledZ/_.zoom)*.5;let be=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(be+=` => ${c.overscaledZ}`),be+=` ${se}kb`,function(Ge,bt){Ge.initDebugOverlayCanvas();const Fe=Ge.debugOverlayCanvas,rt=Ge.context.gl,He=Ge.debugOverlayCanvas.getContext("2d");He.clearRect(0,0,Fe.width,Fe.height),He.shadowColor="white",He.shadowBlur=2,He.lineWidth=1.5,He.strokeStyle="white",He.textBaseline="top",He.font="bold 36px Open Sans, sans-serif",He.fillText(bt,5,5),He.strokeText(bt,5,5),Ge.debugOverlayTexture.update(Fe),Ge.debugOverlayTexture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE)}(h,be);const Ae=R._tileDebugTextBuffer||h.debugBuffer,Be=R._tileDebugTextIndexBuffer||h.quadTriangleIndexBuffer,Ne=R._tileDebugTextSegments||h.debugSegments;B.draw(p,x.TRIANGLES,U,W,o.ColorMode.alphaBlended,o.CullFaceMode.disabled,Tl(k,o.Color.transparent,Se),K,Ae,Be,Ne,null,null,null,[R._globeTileDebugTextBuffer])}function ds(h,r,c,p){El(h,0,r+c/2,h.transform.width,c,p)}function Aa(h,r,c,p){El(h,r-c/2,0,c,h.transform.height,p)}function El(h,r,c,p,_,x){const E=h.context,I=E.gl;I.enable(I.SCISSOR_TEST),I.scissor(r*o.exported.devicePixelRatio,c*o.exported.devicePixelRatio,p*o.exported.devicePixelRatio,_*o.exported.devicePixelRatio),E.clear({color:x}),I.disable(I.SCISSOR_TEST)}const ka=o.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ma}=ka;function Vo(h,r,c,p){h.emplaceBack(r,c,p)}class Kc{constructor(r){this.vertexArray=new o.StructArrayLayout3f12,this.indices=new o.StructArrayLayout3ui6,Vo(this.vertexArray,-1,-1,1),Vo(this.vertexArray,1,-1,1),Vo(this.vertexArray,-1,1,1),Vo(this.vertexArray,1,1,1),Vo(this.vertexArray,-1,-1,-1),Vo(this.vertexArray,1,-1,-1),Vo(this.vertexArray,-1,1,-1),Vo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,Ma),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=o.SegmentVector.simpleSegment(0,0,36,12)}}function Bn(h,r,c,p,_,x){const E=h.gl,I=r.paint.get("sky-atmosphere-color"),k=r.paint.get("sky-atmosphere-halo-color"),B=r.paint.get("sky-atmosphere-sun-intensity"),R=((U,W,J,K,Q)=>({u_matrix_3f:U,u_sun_direction:W,u_sun_intensity:J,u_color_tint_r:[K.r,K.g,K.b,K.a],u_color_tint_m:[Q.r,Q.g,Q.b,Q.a],u_luminance:5e-5}))(o.fromMat4(o.create$1(),p),_,B,I,k);E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_CUBE_MAP_POSITIVE_X+x,r.skyboxTexture,0),c.draw(h,E.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.frontCW,R,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const Jc=o.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Ag{constructor(r){const c=new o.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const p=new o.StructArrayLayout3ui6;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(c,Jc.members),this.indexBuffer=r.createIndexBuffer(p),this.segments=o.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Nd={symbol:function(h,r,c,p,_){if(h.renderPass!=="translucent")return;const x=o.StencilMode.disabled,E=h.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(I,k,B,R,U,W,J){const K=k.transform,Q=U==="map",te=W==="map";for(const Z of I){const le=R.getTile(Z),se=le.getBucket(B);if(!se||!se.text||!se.text.segments.get().length)continue;const de=o.evaluateSizeForZoom(se.textSizeData,K.zoom),Se=Lc(Z,se.getProjection(),K),be=K.calculatePixelsToTileUnitsMatrix(le),Ae=va(Se,le.tileID.canonical,te,Q,K,se.getProjection(),be),Be=B.layout.get("icon-text-fit")!=="none"&&se.hasIconData();if(de){const Ne=Math.pow(2,K.zoom-le.tileID.overscaledZ);Ia(se,Q,te,J,o.symbolSize,K,Ae,Z,Ne,de,Be)}}}(p,h,c,r,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),_),c.paint.get("icon-opacity").constantOr(1)!==0&&qf(h,r,c,p,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),x,E),c.paint.get("text-opacity").constantOr(1)!==0&&qf(h,r,c,p,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),x,E),r.map.showCollisionBoxes&&(jf(h,r,c,p,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),jf(h,r,c,p,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(h,r,c,p){if(h.renderPass!=="translucent")return;const _=c.paint.get("circle-opacity"),x=c.paint.get("circle-stroke-width"),E=c.paint.get("circle-stroke-opacity"),I=c.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)===0&&(x.constantOr(1)===0||E.constantOr(1)===0))return;const k=h.context,B=k.gl,R=h.transform,U=h.depthModeForSublayer(0,o.DepthMode.ReadOnly),W=o.StencilMode.disabled,J=h.colorModeForRenderPass(),K=R.projection.name==="globe",Q=[o.mercatorXfromLng(R.center.lng),o.mercatorYfromLat(R.center.lat)],te=[];for(let le=0;le<p.length;le++){const se=p[le],de=r.getTile(se),Se=de.getBucket(c);if(!Se||Se.projection.name!==R.projection.name)continue;const be=Se.programConfigurations.get(c.id),Ae=wl(c);K&&Ae.push("PROJECTION_GLOBE_VIEW");const Be=h.useProgram("circle",be,Ae),Ne=Se.layoutVertexBuffer,Ge=Se.globeExtVertexBuffer,bt=Se.indexBuffer,Fe=R.projection.createInversionMatrix(R,se.canonical),rt={programConfiguration:be,program:Be,layoutVertexBuffer:Ne,globeExtVertexBuffer:Ge,indexBuffer:bt,uniformValues:bl(h,se,de,Fe,Q,c),tile:de};if(I){const He=Se.segments.get();for(const ut of He)te.push({segments:new o.SegmentVector([ut]),sortKey:ut.sortKey,state:rt})}else te.push({segments:Se.segments,sortKey:0,state:rt})}I&&te.sort((le,se)=>le.sortKey-se.sortKey);const Z={useDepthForOcclusion:!K};for(const le of te){const{programConfiguration:se,program:de,layoutVertexBuffer:Se,globeExtVertexBuffer:be,indexBuffer:Ae,uniformValues:Be,tile:Ne}=le.state,Ge=le.segments;h.terrain&&h.terrain.setupElevationDraw(Ne,de,Z),h.prepareDrawProgram(k,de,Ne.tileID.toUnwrapped()),de.draw(k,B.TRIANGLES,U,W,J,o.CullFaceMode.disabled,Be,c.id,Se,Ae,Ge,c.paint,R.zoom,se,[be])}},heatmap:function(h,r,c,p){if(c.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const _=h.context,x=_.gl,E=o.StencilMode.disabled,I=new o.ColorMode([x.ONE,x.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(J,K,Q,te){const Z=J.gl,le=K.width*te,se=K.height*te;J.activeTexture.set(Z.TEXTURE1),J.viewport.set([0,0,le,se]);let de=Q.heatmapFbo;if(!de||de&&(de.width!==le||de.height!==se)){de&&de.destroy();const Se=Z.createTexture();Z.bindTexture(Z.TEXTURE_2D,Se),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_S,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_T,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MAG_FILTER,Z.LINEAR),de=Q.heatmapFbo=J.createFramebuffer(le,se,!1),function(be,Ae,Be,Ne,Ge,bt){const Fe=be.gl;Fe.texImage2D(Fe.TEXTURE_2D,0,be.isWebGL2&&be.extRenderToTextureHalfFloat?Fe.RGBA16F:Fe.RGBA,Ge,bt,0,Fe.RGBA,be.extRenderToTextureHalfFloat?be.isWebGL2?Fe.HALF_FLOAT:be.extTextureHalfFloat.HALF_FLOAT_OES:Fe.UNSIGNED_BYTE,null),Ne.colorAttachment.set(Be)}(J,0,Se,de,le,se)}else Z.bindTexture(Z.TEXTURE_2D,de.colorAttachment.get()),J.bindFramebuffer.set(de.framebuffer)})(_,h,c,h.transform.projection.name==="globe"?.5:.25),_.clear({color:o.Color.transparent});const k=h.transform,B=k.projection.name==="globe",R=B?["PROJECTION_GLOBE_VIEW"]:null,U=B?o.CullFaceMode.frontCCW:o.CullFaceMode.disabled,W=[o.mercatorXfromLng(k.center.lng),o.mercatorYfromLat(k.center.lat)];for(let J=0;J<p.length;J++){const K=p[J];if(r.hasRenderableParent(K))continue;const Q=r.getTile(K),te=Q.getBucket(c);if(!te||te.projection.name!==k.projection.name)continue;const Z=te.programConfigurations.get(c.id),le=h.useProgram("heatmap",Z,R),{zoom:se}=h.transform;h.terrain&&h.terrain.setupElevationDraw(Q,le),h.prepareDrawProgram(_,le,K.toUnwrapped());const de=k.projection.createInversionMatrix(k,K.canonical);le.draw(_,x.TRIANGLES,o.DepthMode.disabled,E,I,U,vo(h,K,Q,de,W,se,c.paint.get("heatmap-intensity")),c.id,te.layoutVertexBuffer,te.indexBuffer,te.segments,c.paint,h.transform.zoom,Z,B?[te.globeExtVertexBuffer]:null)}_.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(_,x){const E=_.context,I=E.gl,k=x.heatmapFbo;if(!k)return;E.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,k.colorAttachment.get()),E.activeTexture.set(I.TEXTURE1);let B=x.colorRampTexture;B||(B=x.colorRampTexture=new o.Texture(E,x.colorRamp,I.RGBA)),B.bind(I.LINEAR,I.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(E,I.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,_.colorModeForRenderPass(),o.CullFaceMode.disabled,((R,U,W,J)=>({u_image:0,u_color_ramp:1,u_opacity:U.paint.get("heatmap-opacity")}))(0,x),x.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,x.paint,_.transform.zoom)}(h,c))},line:function(h,r,c,p){if(h.renderPass!=="translucent")return;const _=c.paint.get("line-opacity"),x=c.paint.get("line-width");if(_.constantOr(1)===0||x.constantOr(1)===0)return;const E=h.depthModeForSublayer(0,o.DepthMode.ReadOnly),I=h.colorModeForRenderPass(),k=h.terrain&&h.terrain.renderingToTexture?1:o.exported.devicePixelRatio,B=c.paint.get("line-dasharray"),R=B.constantOr(1),U=c.layout.get("line-cap"),W=c.paint.get("line-pattern"),J=W.constantOr(1),K=c.paint.get("line-gradient"),Q=J?"linePattern":"line",te=h.context,Z=te.gl,le=(de=>{const Se=[];Yc(de)&&Se.push("RENDER_LINE_DASH"),de.paint.get("line-gradient")&&Se.push("RENDER_LINE_GRADIENT");const be=de.paint.get("line-trim-offset");be[0]===0&&be[1]===0||Se.push("RENDER_LINE_TRIM_OFFSET");const Ae=de.paint.get("line-pattern").constantOr(1),Be=de.paint.get("line-opacity").constantOr(1)!==1;return!Ae&&Be&&Se.push("RENDER_LINE_ALPHA_DISCARD"),Se})(c);let se=le.includes("RENDER_LINE_ALPHA_DISCARD");h.terrain&&h.terrain.clipOrMaskOverlapStencilType()&&(se=!1);for(const de of p){const Se=r.getTile(de);if(J&&!Se.patternsLoaded())continue;const be=Se.getBucket(c);if(!be)continue;h.prepareDrawTile();const Ae=be.programConfigurations.get(c.id),Be=h.useProgram(Q,Ae,le),Ne=W.constantOr(null);if(Ne&&Se.imageAtlas){const Le=Se.imageAtlas.patternPositions[Ne.toString()];Le&&Ae.setConstantPatternPositions(Le)}const Ge=B.constantOr(null),bt=U.constantOr(null);if(!J&&Ge&&bt&&Se.lineAtlas){const Le=Se.lineAtlas.getDash(Ge,bt);Le&&Ae.setConstantPatternPositions(Le)}let[Fe,rt]=c.paint.get("line-trim-offset");(bt==="round"||bt==="square")&&Fe!==rt&&(Fe===0&&(Fe-=1),rt===1&&(rt+=1));const He=h.terrain?de.projMatrix:null,ut=J?$f(h,Se,c,He,k):Pd(h,Se,c,He,be.lineClipsArray.length,k,[Fe,rt]);if(K){const Le=be.gradients[c.id];let Ze=Le.texture;if(c.gradientVersion!==Le.version){let lt=256;if(c.stepInterpolant){const mt=r.getSource().maxzoom,Wt=de.canonical.z===mt?Math.ceil(1<<h.transform.maxZoom-de.canonical.z):1;lt=o.clamp(o.nextPowerOfTwo(be.maxLineLength/o.EXTENT*1024*Wt),256,te.maxTextureSize)}Le.gradient=o.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:lt,image:Le.gradient||void 0,clips:be.lineClipsArray}),Le.texture?Le.texture.update(Le.gradient):Le.texture=new o.Texture(te,Le.gradient,Z.RGBA),Le.version=c.gradientVersion,Ze=Le.texture}te.activeTexture.set(Z.TEXTURE1),Ze.bind(c.stepInterpolant?Z.NEAREST:Z.LINEAR,Z.CLAMP_TO_EDGE)}R&&(te.activeTexture.set(Z.TEXTURE0),Se.lineAtlasTexture.bind(Z.LINEAR,Z.REPEAT),Ae.updatePaintBuffers()),J&&(te.activeTexture.set(Z.TEXTURE0),Se.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Ae.updatePaintBuffers()),h.prepareDrawProgram(te,Be,de.toUnwrapped());const Ue=Le=>{Be.draw(te,Z.TRIANGLES,E,Le,I,o.CullFaceMode.disabled,ut,c.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,c.paint,h.transform.zoom,Ae,[be.layoutVertexBuffer2])};if(se){const Le=h.stencilModeForClipping(de).ref;Le===0&&h.terrain&&te.clear({stencil:0});const Ze={func:Z.EQUAL,mask:255};ut.u_alpha_discard_threshold=.8,Ue(new o.StencilMode(Ze,Le,255,Z.KEEP,Z.KEEP,Z.INVERT)),ut.u_alpha_discard_threshold=0,Ue(new o.StencilMode(Ze,Le,255,Z.KEEP,Z.KEEP,Z.KEEP))}else Ue(h.stencilModeForClipping(de))}se&&(h.resetStencilClippingMasks(),h.terrain&&te.clear({stencil:0}))},fill:function(h,r,c,p){const _=c.paint.get("fill-color"),x=c.paint.get("fill-opacity");if(x.constantOr(1)===0)return;const E=h.colorModeForRenderPass(),I=c.paint.get("fill-pattern"),k=h.opaquePassEnabledForLayer()&&!I.constantOr(1)&&_.constantOr(o.Color.transparent).a===1&&x.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===k){const B=h.depthModeForSublayer(1,h.renderPass==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly);Wf(h,r,c,p,B,E,!1)}if(h.renderPass==="translucent"&&c.paint.get("fill-antialias")){const B=h.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,o.DepthMode.ReadOnly);Wf(h,r,c,p,B,E,!0)}},"fill-extrusion":function(h,r,c,p){const _=c.paint.get("fill-extrusion-opacity");if(_!==0&&h.renderPass==="translucent"){const x=new o.DepthMode(h.context.gl.LEQUAL,o.DepthMode.ReadWrite,h.depthRangeFor3D);if(_!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))Od(h,r,c,p,x,o.StencilMode.disabled,o.ColorMode.disabled),Od(h,r,c,p,x,h.stencilModeFor3D(),h.colorModeForRenderPass()),h.resetStencilClippingMasks();else{const E=h.colorModeForRenderPass();Od(h,r,c,p,x,o.StencilMode.disabled,E)}}},hillshade:function(h,r,c,p){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent")return;const _=h.context,x=h.depthModeForSublayer(0,o.DepthMode.ReadOnly),E=h.colorModeForRenderPass(),I=h.terrain&&h.terrain.renderingToTexture,[k,B]=h.renderPass!=="translucent"||I?[{},p]:h.stencilConfigForOverlap(p);for(const R of B){const U=r.getTile(R);if(U.needsHillshadePrepare&&h.renderPass==="offscreen")Uc(h,U,c,x,o.StencilMode.disabled,E);else if(h.renderPass==="translucent"){const W=I&&h.terrain?h.terrain.stencilModeForRTTOverlap(R):k[R.overscaledZ];vl(h,R,U,c,x,W,E)}}_.viewport.set([0,0,h.width,h.height]),h.resetStencilClippingMasks()},raster:function(h,r,c,p,_,x){if(h.renderPass!=="translucent"||c.paint.get("raster-opacity")===0||!p.length)return;const E=h.context,I=E.gl,k=r.getSource(),B=h.useProgram("raster"),R=h.colorModeForRenderPass(),U=h.terrain&&h.terrain.renderingToTexture,[W,J]=k instanceof Ce||U?[{},p]:h.stencilConfigForOverlap(p),K=J[J.length-1].overscaledZ,Q=!h.options.moving;for(const te of J){const Z=U?o.DepthMode.disabled:h.depthModeForSublayer(te.overscaledZ-K,c.paint.get("raster-opacity")===1?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly,I.LESS),le=te.toUnwrapped(),se=r.getTile(te);if(U&&(!se||!se.hasData()))continue;const de=U?te.projMatrix:h.transform.calculateProjMatrix(le,Q),Se=h.terrain&&U?h.terrain.stencilModeForRTTOverlap(te):W[te.overscaledZ],be=x?0:c.paint.get("raster-fade-duration");se.registerFadeDuration(be);const Ae=r.findLoadedParent(te,0),Be=xl(se,Ae,r,h.transform,be);let Ne,Ge;h.terrain&&h.terrain.prepareDrawTile();const bt=c.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;E.activeTexture.set(I.TEXTURE0),se.texture.bind(bt,I.CLAMP_TO_EDGE),E.activeTexture.set(I.TEXTURE1),Ae?(Ae.texture.bind(bt,I.CLAMP_TO_EDGE),Ne=Math.pow(2,Ae.tileID.overscaledZ-se.tileID.overscaledZ),Ge=[se.tileID.canonical.x*Ne%1,se.tileID.canonical.y*Ne%1]):se.texture.bind(bt,I.CLAMP_TO_EDGE);const Fe=Tg(de,Ge||[0,0],Ne||1,Be,c,k instanceof Ce?k.perspectiveTransform:[0,0]);if(h.prepareDrawProgram(E,B,le),k instanceof Ce)k.boundsBuffer&&k.boundsSegments&&B.draw(E,I.TRIANGLES,Z,o.StencilMode.disabled,R,o.CullFaceMode.disabled,Fe,c.id,k.boundsBuffer,h.quadTriangleIndexBuffer,k.boundsSegments);else{const{tileBoundsBuffer:rt,tileBoundsIndexBuffer:He,tileBoundsSegments:ut}=h.getTileBoundsBuffers(se);B.draw(E,I.TRIANGLES,Z,Se,R,o.CullFaceMode.disabled,Fe,c.id,rt,He,ut)}}h.resetStencilClippingMasks()},background:function(h,r,c,p){const _=c.paint.get("background-color"),x=c.paint.get("background-opacity");if(x===0)return;const E=h.context,I=E.gl,k=h.transform,B=k.tileSize,R=c.paint.get("background-pattern");if(h.isPatternMissing(R))return;const U=!R&&_.a===1&&x===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==U)return;const W=o.StencilMode.disabled,J=h.depthModeForSublayer(0,U==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly),K=h.colorModeForRenderPass(),Q=h.useProgram(R?"backgroundPattern":"background");let te,Z=p;Z||(te=h.getBackgroundTiles(),Z=Object.values(te).map(le=>le.tileID)),R&&(E.activeTexture.set(I.TEXTURE0),h.imageManager.bind(h.context));for(const le of Z){const se=le.toUnwrapped(),de=p?le.projMatrix:h.transform.calculateProjMatrix(se);h.prepareDrawTile();const Se=r?r.getTile(le):te?te[le.key]:new o.Tile(le,B,k.zoom,h),be=R?Bd(de,x,h,R,{tileID:le,tileSize:B}):Sg(de,x,_);h.prepareDrawProgram(E,Q,se);const{tileBoundsBuffer:Ae,tileBoundsIndexBuffer:Be,tileBoundsSegments:Ne}=h.getTileBoundsBuffers(Se);Q.draw(E,I.TRIANGLES,J,W,K,o.CullFaceMode.disabled,be,c.id,Ae,Be,Ne)}},sky:function(h,r,c){const p=h.transform,_=p.projection.name==="mercator"||p.projection.name==="globe"?1:o.smoothstep(7,8,p.zoom),x=c.paint.get("sky-opacity")*_;if(x===0)return;const E=h.context,I=c.paint.get("sky-type"),k=new o.DepthMode(E.gl.LEQUAL,o.DepthMode.ReadOnly,[0,1]),B=h.frameCounter/1e3%1;I==="atmosphere"?h.renderPass==="offscreen"?c.needsSkyboxCapture(h)&&(function(R,U,W,J){const K=R.context,Q=K.gl;let te=U.skyboxFbo;if(!te){te=U.skyboxFbo=K.createFramebuffer(32,32,!1),U.skyboxGeometry=new Kc(K),U.skyboxTexture=K.gl.createTexture(),Q.bindTexture(Q.TEXTURE_CUBE_MAP,U.skyboxTexture),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_MAG_FILTER,Q.LINEAR);for(let de=0;de<6;++de)Q.texImage2D(Q.TEXTURE_CUBE_MAP_POSITIVE_X+de,0,Q.RGBA,32,32,0,Q.RGBA,Q.UNSIGNED_BYTE,null)}K.bindFramebuffer.set(te.framebuffer),K.viewport.set([0,0,32,32]);const Z=U.getCenter(R,!0),le=R.useProgram("skyboxCapture"),se=new Float64Array(16);o.identity(se),o.rotateY(se,se,.5*-Math.PI),Bn(K,U,le,se,Z,0),o.identity(se),o.rotateY(se,se,.5*Math.PI),Bn(K,U,le,se,Z,1),o.identity(se),o.rotateX(se,se,.5*-Math.PI),Bn(K,U,le,se,Z,2),o.identity(se),o.rotateX(se,se,.5*Math.PI),Bn(K,U,le,se,Z,3),o.identity(se),Bn(K,U,le,se,Z,4),o.identity(se),o.rotateY(se,se,Math.PI),Bn(K,U,le,se,Z,5),K.viewport.set([0,0,R.width,R.height])}(h,c),c.markSkyboxValid(h)):h.renderPass==="sky"&&function(R,U,W,J,K){const Q=R.context,te=Q.gl,Z=R.transform,le=R.useProgram("skybox");Q.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_CUBE_MAP,U.skyboxTexture);const se=((de,Se,be,Ae,Be)=>({u_matrix:de,u_sun_direction:Se,u_cubemap:0,u_opacity:Ae,u_temporal_offset:Be}))(Z.skyboxMatrix,U.getCenter(R,!1),0,J,K);R.prepareDrawProgram(Q,le),le.draw(Q,te.TRIANGLES,W,o.StencilMode.disabled,R.colorModeForRenderPass(),o.CullFaceMode.backCW,se,"skybox",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)}(h,c,k,x,B):I==="gradient"&&h.renderPass==="sky"&&function(R,U,W,J,K){const Q=R.context,te=Q.gl,Z=R.transform,le=R.useProgram("skyboxGradient");U.skyboxGeometry||(U.skyboxGeometry=new Kc(Q)),Q.activeTexture.set(te.TEXTURE0);let se=U.colorRampTexture;se||(se=U.colorRampTexture=new o.Texture(Q,U.colorRamp,te.RGBA)),se.bind(te.LINEAR,te.CLAMP_TO_EDGE);const de=((Se,be,Ae,Be,Ne)=>({u_matrix:Se,u_color_ramp:0,u_center_direction:be,u_radius:o.degToRad(Ae),u_opacity:Be,u_temporal_offset:Ne}))(Z.skyboxMatrix,U.getCenter(R,!1),U.paint.get("sky-gradient-radius"),J,K);R.prepareDrawProgram(Q,le),le.draw(Q,te.TRIANGLES,W,o.StencilMode.disabled,R.colorModeForRenderPass(),o.CullFaceMode.backCW,de,"skyboxGradient",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)}(h,c,k,x,B)},debug:function(h,r,c){for(let p=0;p<c.length;p++)$d(h,r,c[p])},custom:function(h,r,c,p){const _=h.context,x=c.implementation;if(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes("custom")||h.terrain&&(h.terrain.renderingToTexture||h.renderPass==="offscreen")&&c.isLayerDraped()){if(h.renderPass==="offscreen"){const E=x.prerender;if(E){if(h.setCustomLayerDefaults(),_.setColorMode(h.colorModeForRenderPass()),h.transform.projection.name==="globe"){const I=h.transform.pointMerc;E.call(x,_.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(h.transform.zoom),[I.x,I.y],h.transform.pixelsPerMeterRatio)}else E.call(x,_.gl,h.transform.customLayerMatrix());_.setDirty(),h.setBaseState()}}else if(h.renderPass==="translucent"){if(h.terrain&&h.terrain.renderingToTexture){const I=x.renderToTile;if(I){const k=p[0].canonical,B=new o.MercatorCoordinate(k.x+p[0].wrap*(1<<k.z),k.y,k.z);_.setDepthMode(o.DepthMode.disabled),_.setStencilMode(o.StencilMode.disabled),_.setColorMode(h.colorModeForRenderPass()),h.setCustomLayerDefaults(),I.call(x,_.gl,B),_.setDirty(),h.setBaseState()}return}h.setCustomLayerDefaults(),_.setColorMode(h.colorModeForRenderPass()),_.setStencilMode(o.StencilMode.disabled);const E=x.renderingMode==="3d"?new o.DepthMode(h.context.gl.LEQUAL,o.DepthMode.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,o.DepthMode.ReadOnly);if(_.setDepthMode(E),h.transform.projection.name==="globe"){const I=h.transform.pointMerc;x.render(_.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(h.transform.zoom),[I.x,I.y],h.transform.pixelsPerMeterRatio)}else x.render(_.gl,h.transform.customLayerMatrix());_.setDirty(),h.setBaseState(),_.bindFramebuffer.set(null)}}else o.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Cl{constructor(r,c,p=!1){this.context=new oe(r,p),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=o.SourceCache.maxUnderzooming+o.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new kf,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(r,c){const p=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Id(this,r));const _=this._terrain;this.transform.elevation=p?_:null,_.update(r,this.transform,c)}_updateFog(r){const c=r.fog;if(!c||this.transform.projection.name==="globe"||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,_]=c.getFovAdjustedRange(this.transform._fov);if(p>_)return void(this.transform.fogCullDistSq=null);const x=p+.78*(_-p);this.transform.fogCullDistSq=x*x}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(r,c){if(this.width=r*o.exported.devicePixelRatio,this.height=c*o.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._layers[p].resize()}setup(){const r=this.context,c=new o.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(o.EXTENT,0),c.emplaceBack(0,o.EXTENT),c.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(c,o.posAttributes.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const p=new o.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(o.EXTENT,0),p.emplaceBack(0,o.EXTENT),p.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=r.createVertexBuffer(p,o.posAttributes.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const _=new o.StructArrayLayout2i4;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(_,o.posAttributes.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const x=new o.StructArrayLayout4i8;x.emplaceBack(0,0,0,0),x.emplaceBack(o.EXTENT,0,o.EXTENT,0),x.emplaceBack(0,o.EXTENT,0,o.EXTENT),x.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.mercatorBoundsBuffer=r.createVertexBuffer(x,o.boundsAttributes.members),this.mercatorBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const E=new o.StructArrayLayout3ui6;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(E);const I=new o.StructArrayLayout1ui2;for(const B of[0,1,3,2,0])I.emplaceBack(B);this.debugIndexBuffer=r.createIndexBuffer(I),this.emptyTexture=new o.Texture(r,new o.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA),this.identityMat=o.create();const k=this.context.gl;this.stencilClearMode=new o.StencilMode({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.loadTimeStamps.push(o.window.performance.now()),this.atmosphereBuffer=new Ag(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context,c=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(r,c.TRIANGLES,o.DepthMode.disabled,this.stencilClearMode,o.ColorMode.disabled,o.CullFaceMode.disabled,Fn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,c,p){if(!c||this.currentStencilSource===c.id||!r.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const k of p)if(this._tileClippingMaskIDs[k.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=c.id;const _=this.context,x=_.gl;this.nextStencilID+p.length>256&&this.clearStencil(),_.setColorMode(o.ColorMode.disabled),_.setDepthMode(o.DepthMode.disabled);const E=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of p){const k=c.getTile(I),B=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:R,tileBoundsIndexBuffer:U,tileBoundsSegments:W}=this.getTileBoundsBuffers(k);E.draw(_,x.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:x.ALWAYS,mask:0},B,255,x.KEEP,x.KEEP,x.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Fn(I.projMatrix),"$clipping",R,U,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,c=this.context.gl;return new o.StencilMode({func:c.NOTEQUAL,mask:255},r,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const c=this.context.gl;return new o.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(r){const c=this.context.gl,p=r.sort((E,I)=>I.overscaledZ-E.overscaledZ),_=p[p.length-1].overscaledZ,x=p[0].overscaledZ-_+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const E={};for(let I=0;I<x;I++)E[I+_]=new o.StencilMode({func:c.GEQUAL,mask:255},I+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=x,[E,p]}return[{[_]:o.StencilMode.disabled},p]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new o.ColorMode([r.CONSTANT_COLOR,r.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?o.ColorMode.unblended:o.ColorMode.alphaBlended}depthModeForSublayer(r,c,p){if(!this.opaquePassEnabledForLayer())return o.DepthMode.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new o.DepthMode(p||this.context.gl.LEQUAL,c,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,c){this.style=r,this.options=c,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const p=this.style.order,_=this.style._sourceCaches;for(const k in _){const B=_[k];B.used&&B.prepare(this.context)}const x={},E={},I={};for(const k in _){const B=_[k];x[k]=B.getVisibleCoordinates(),E[k]=x[k].slice().reverse(),I[k]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<p.length;k++)if(this.style._layers[p[k]].is3D()){this.opaquePassCutoff=k;break}if(this.terrain&&(this.terrain.updateTileBinding(I),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.GlobeSharedBuffers(this.context)),o.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const k of p){const B=this.style._layers[k],R=r._getLayerSourceCache(B);if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const U=R?E[R.id]:void 0;(B.type==="custom"||B.isSky()||U&&U.length)&&this.renderLayer(this,R,B,U)}if(this.depthRangeFor3D=[0,1-(r.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[p[this.currentLayer]],B=r._getLayerSourceCache(k);if(k.isSky())continue;const R=B?E[B.id]:void 0;this._renderTileClippingMasks(k,B,R),this.renderLayer(this,B,k,R)}if(this.style.fog&&this.transform.projection.supportsFog&&function(k,B){const R=k.context,U=R.gl,W=k.transform,J=new o.DepthMode(U.LEQUAL,o.DepthMode.ReadOnly,[0,1]),K=k.useProgram("globeAtmosphere",null,W.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Q=o.globeToMercatorTransition(W.zoom),te=B.properties.get("color").toArray01(),Z=B.properties.get("high-color").toArray01(),le=B.properties.get("space-color").toArray01PremultipliedAlpha(),se=o.identity$1([]);o.rotateY$1(se,se,-o.degToRad(W._center.lng)),o.rotateX$1(se,se,o.degToRad(W._center.lat)),o.rotateZ$1(se,se,W.angle),o.rotateX$1(se,se,-W._pitch);const de=o.fromQuat(new Float32Array(16),se),Se=o.mapValue(B.properties.get("star-intensity"),0,1,0,.25),be=5e-4,Ae=o.mapValue(B.properties.get("horizon-blend"),0,1,be,.25),Be=o.globeUseCustomAntiAliasing(k,R,W)&&Ae===be?W.worldSize/(2*Math.PI*1.025)-1:W.globeRadius,Ne=k.frameCounter/1e3%1,Ge=o.length(W.globeCenterInViewSpace),bt=Math.sqrt(Math.pow(Ge,2)-Math.pow(Be,2)),Fe=Math.acos(bt/Ge),rt=((ut,Ue,Le,Ze,lt,mt,Wt,mn,Ut,Ft,Ht,In,Qt,Zn)=>({u_frustum_tl:ut,u_frustum_tr:Ue,u_frustum_br:Le,u_frustum_bl:Ze,u_horizon:lt,u_transition:mt,u_fadeout_range:Wt,u_color:mn,u_high_color:Ut,u_space_color:Ft,u_star_intensity:Ht,u_star_size:5*o.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:In,u_horizon_angle:Qt,u_rotation_matrix:Zn}))(W.frustumCorners.TL,W.frustumCorners.TR,W.frustumCorners.BR,W.frustumCorners.BL,W.frustumCorners.horizon,Q,Ae,te,Z,le,Se,Ne,Fe,de);k.prepareDrawProgram(R,K);const He=k.atmosphereBuffer;He&&K.draw(R,U.TRIANGLES,J,o.StencilMode.disabled,o.ColorMode.alphaBlended,o.CullFaceMode.backCW,rt,"skybox",He.vertexBuffer,He.indexBuffer,He.segments)}(this,this.style.fog),this.renderPass="sky",(o.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const k=this.style._layers[p[this.currentLayer]],B=r._getLayerSourceCache(k);k.isSky()&&this.renderLayer(this,B,k,B?E[B.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;){const k=this.style._layers[p[this.currentLayer]],B=r._getLayerSourceCache(k);if(k.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(k)){if(k.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const R=B?(k.type==="symbol"?I:E)[B.id]:void 0;this._renderTileClippingMasks(k,B,B?x[B.id]:void 0),this.renderLayer(this,B,k,R),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let k=null;o.values(this.style._layers).forEach(B=>{const R=r._getLayerSourceCache(B);R&&!B.isHidden(this.transform.zoom)&&(!k||k.getSource().maxzoom<R.getSource().maxzoom)&&(k=R)}),k&&this.options.showTileBoundaries&&Nd.debug(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const B=k.transform.padding;ds(k,k.transform.height-(B.top||0),3,Fd),ds(k,B.bottom||0,3,Vd),Aa(k,B.left||0,3,Hf),Aa(k,k.transform.width-(B.right||0),3,Xf);const R=k.transform.centerPoint;(function(U,W,J,K){El(U,W-1,J-10,2,20,K),El(U,W-10,J-1,20,2,K)})(k,R.x,k.transform.height-R.y,Yf)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(o.window.performance.now()),this.saveCanvasCopy())}}renderLayer(r,c,p,_){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||_&&_.length)&&(this.id=p.id,this.gpuTimingStart(p),(!r.transform.projection.unsupportedLayers||!r.transform.projection.unsupportedLayers.includes(p.type)||r.terrain&&p.type==="custom")&&Nd[p.type](r,c,p,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let p=this.gpuTimers[r.id];p||(p=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),p.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,p.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,c=r.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),r.beginQueryEXT(r.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const c={};for(const p in r){const _=r[p],x=this.context.extTimerQuery,E=x.getQueryObjectEXT(_.query,x.QUERY_RESULT_EXT)/1e6;x.deleteQueryEXT(_.query),c[p]=E}return c}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let p=0;for(const _ of r)p+=c.getQueryObjectEXT(_,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(_);return p}translatePosMatrix(r,c,p,_,x){if(!p[0]&&!p[1])return r;const E=x?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(E){const B=Math.sin(E),R=Math.cos(E);p=[p[0]*R-p[1]*B,p[0]*B+p[1]*R]}const I=[x?p[0]:At(c,p[0],this.transform.zoom),x?p[1]:At(c,p[1],this.transform.zoom),0],k=new Float32Array(16);return o.translate(k,r,I),k}saveTileTexture(r){const c=this._tileTextures[r.size[0]];c?c.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const c=this._tileTextures[r];return c&&c.length>0?c.pop():null}isPatternMissing(r){return r===null||r!==void 0&&!this.imageManager.getPattern(r.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const r=this.terrain&&this.terrain.renderingToTexture,c=this.terrain&&this.terrain.exaggeration()===0,p=this.style&&this.style.fog,_=[];return this.terrainRenderModeElevated()&&_.push("TERRAIN"),this.transform.projection.name==="globe"&&_.push("GLOBE"),c&&_.push("ZERO_EXAGGERATION"),p&&!r&&p.getOpacity(this.transform.pitch)!==0&&_.push("FOG"),r&&_.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&_.push("OVERDRAW_INSPECTOR"),_}useProgram(r,c,p){this.cache=this.cache||{};const _=p||[],x=this.currentGlobalDefines().concat(_),E=Ad.cacheKey(bd[r],r,x,c);return this.cache[E]||(this.cache[E]=new Ad(this.context,r,bd[r],c,Eg[r],x)),this.cache[E]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(r,c,p){if(this.terrain&&this.terrain.renderingToTexture)return;const _=this.style.fog;if(_){const x=_.getOpacity(this.transform.pitch),E=((I,k,B,R,U,W,J,K,Q,te,Z)=>{const le=I.transform,se=k.properties.get("color").toArray01();se[3]=R;const de=I.frameCounter/1e3%1;return{u_fog_matrix:B?le.calculateFogTileMatrix(B):I.identityMat,u_fog_range:k.getFovAdjustedRange(le._fov),u_fog_color:se,u_fog_horizon_blend:k.properties.get("horizon-blend"),u_fog_temporal_offset:de,u_frustum_tl:U,u_frustum_tr:W,u_frustum_br:J,u_frustum_bl:K,u_globe_pos:Q,u_globe_radius:te,u_viewport:Z,u_globe_transition:o.globeToMercatorTransition(le.zoom),u_is_globe:+(le.projection.name==="globe")}})(this,_,p,x,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.exported.devicePixelRatio,this.transform.height*o.exported.devicePixelRatio]);c.setFogUniformValues(r,E)}}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,c=r.createTexture();return r.bindTexture(r.TEXTURE_2D,c),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,c=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const _ of p)c[_.key]=r[_.key]||new o.Tile(_,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class Ud{constructor(r=0,c=0,p=0,_=0){if(isNaN(r)||r<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=c,this.left=p,this.right=_}interpolate(r,c,p){return c.top!=null&&r.top!=null&&(this.top=o.number(r.top,c.top,p)),c.bottom!=null&&r.bottom!=null&&(this.bottom=o.number(r.bottom,c.bottom,p)),c.left!=null&&r.left!=null&&(this.left=o.number(r.left,c.left,p)),c.right!=null&&r.right!=null&&(this.right=o.number(r.right,c.right,p)),this}getCenter(r,c){const p=o.clamp((this.left+r-this.right)/2,0,r),_=o.clamp((this.top+c-this.bottom)/2,0,c);return new o.pointGeometry(p,_)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Ud(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Kf(h,r){const c=o.getColumn(h,3);o.fromQuat(h,r),o.setColumn(h,3,c)}function Qc(h,r){const c=o.identity$1([]);return o.rotateZ$1(c,c,-r),o.rotateX$1(c,c,-h),c}function Jf(h,r){const c=[h[0],h[1],0],p=[r[0],r[1],0];if(o.length(c)>=1e-15){const E=o.normalize([],c);o.scale$2(p,E,o.dot(p,E)),r[0]=p[0],r[1]=p[1]}const _=o.cross([],r,h);if(o.len(_)<1e-15)return null;const x=Math.atan2(-_[1],_[0]);return Qc(Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2]),x)}class eu{constructor(r,c){this.position=r,this.orientation=c}get position(){return this._position}set position(r){if(r){const c=r instanceof o.MercatorCoordinate?r:new o.MercatorCoordinate(r[0],r[1],r[2]);this._renderWorldCopies&&(c.x=o.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(r,c){if(this.orientation=null,!this.position)return;const p=this._elevation?this._elevation.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(r)):0,_=this.position,x=o.MercatorCoordinate.fromLngLat(r,p),E=[x.x-_.x,x.y-_.y,x.z-_.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=Jf(E,c)}setPitchBearing(r,c){this.orientation=Qc(o.degToRad(r),o.degToRad(-c))}}class Pa{constructor(r,c){this._transform=o.identity([]),this.orientation=c,this.position=r}get mercatorPosition(){const r=this.position;return new o.MercatorCoordinate(r[0],r[1],r[2])}get position(){const r=o.getColumn(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var c;r&&o.setColumn(this._transform,3,[(c=r)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||o.identity$1([]),r&&Kf(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,c){this._orientation=Qc(r,c),Kf(this._transform,this._orientation)}forward(){const r=o.getColumn(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=o.getColumn(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=o.getColumn(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,c){const p=new Float64Array(16);return o.invert(p,this.getWorldToCamera(r,c)),p}getWorldToCameraPosition(r,c,p){const _=this.position;o.scale$2(_,_,-r);const x=new Float64Array(16);return o.fromScaling(x,[p,p,p]),o.translate(x,x,_),x[10]*=c,x}getWorldToCamera(r,c){const p=new Float64Array(16),_=new Float64Array(4),x=this.position;return o.conjugate(_,this._orientation),o.scale$2(x,x,-r),o.fromQuat(p,_),o.translate(p,p,x),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=c,p[9]*=c,p[10]*=c,p[11]*=c,p}getCameraToClipPerspective(r,c,p,_){const x=new Float64Array(16);return o.perspective(x,r,c,p,_),x}getDistanceToElevation(r,c=!1){const p=r===0?0:o.mercatorZfromAltitude(r,c?o.latFromMercatorY(this.position[1]):this.position[1]),_=this.forward();return(p-this.position[2])/_[2]}clone(){return new Pa([...this.position],[...this.orientation])}}function za(h,r){const c=Zs(h.projection,h.zoom,h.width,h.height),p=function(x,E,I,k,B){const R=new o.LngLat(I.lng-180*Ws,I.lat),U=new o.LngLat(I.lng+180*Ws,I.lat),W=x.project(R.lng,R.lat),J=x.project(U.lng,U.lat),K=-Math.atan2(J.y-W.y,J.x-W.x),Q=o.MercatorCoordinate.fromLngLat(I);Q.y=o.clamp(Q.y,-.999975,.999975);const te=Q.toLngLat(),Z=x.project(te.lng,te.lat),le=o.MercatorCoordinate.fromLngLat(te);le.x+=Ws;const se=le.toLngLat(),de=x.project(se.lng,se.lat),Se=Al(de.x-Z.x,de.y-Z.y,K),be=o.MercatorCoordinate.fromLngLat(te);be.y+=Ws;const Ae=be.toLngLat(),Be=x.project(Ae.lng,Ae.lat),Ne=Al(Be.x-Z.x,Be.y-Z.y,K),Ge=Math.abs(Se.x)/Math.abs(Ne.y),bt=o.identity([]);o.rotateZ(bt,bt,-K*(1-(B?0:k)));const Fe=o.identity([]);return o.scale(Fe,Fe,[1,1-(1-Ge)*k,1]),Fe[4]=-Ne.x/Ne.y*k,o.rotateZ(Fe,Fe,K),o.multiply(Fe,bt,Fe),Fe}(h.projection,0,h.center,c,r),_=tu(h);return o.scale(p,p,[_,_,1]),p}function tu(h){const r=h.projection,c=Zs(h.projection,h.zoom,h.width,h.height),p=Il(r,h.center),_=Il(r,o.LngLat.convert(r.center));return Math.pow(2,p*c+(1-c)*_)}function Zs(h,r,c,p,_=1/0){const x=h.range;if(!x)return 0;const E=Math.min(_,Math.max(c,p)),I=Math.log(E/1024)/Math.LN2;return o.smoothstep(x[0]+I,x[1]+I,r)}const Ws=1/4e4;function Il(h,r){const c=o.clamp(r.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),p=new o.LngLat(r.lng-180*Ws,c),_=new o.LngLat(r.lng+180*Ws,c),x=h.project(p.lng,c),E=h.project(_.lng,c),I=o.MercatorCoordinate.fromLngLat(p),k=o.MercatorCoordinate.fromLngLat(_),B=E.x-x.x,R=E.y-x.y,U=k.x-I.x,W=k.y-I.y,J=Math.sqrt((U*U+W*W)/(B*B+R*R));return Math.log(J)/Math.LN2}function Al(h,r,c){const p=Math.cos(c),_=Math.sin(c);return{x:h*p-r*_,y:h*_+r*p}}class Rt{constructor(r,c,p,_,x,E,I){this.tileSize=512,this._renderWorldCopies=x===void 0||x,this._minZoom=r||0,this._maxZoom=c||22,this._minPitch=p==null?0:p,this._maxPitch=_==null?60:_,this.setProjection(E),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ud,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Pa,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const r=new Rt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(r,c=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||p)&&this._updateCameraOnTerrain(),(r||p)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return o.pick(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=o.getProjection(this.projectionOptions);const p=!w(c,this.getProjection());return p&&this._calcMatrices(),this.mercatorFromTransition=!1,p}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.getProjection({name:"mercator"});const c=r!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return o.wrap(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const c=-r*Math.PI/180;var p;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(p=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),function(_,x,E){var I=x[0],k=x[1],B=x[2],R=x[3],U=Math.sin(E),W=Math.cos(E);_[0]=I*W+B*U,_[1]=k*W+R*U,_[2]=I*-U+B*W,_[3]=k*-U+R*W}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const c=o.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=o.degToRad(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const c=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const r=this._elevation;this._centerAltitude=r.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=r.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let _=0,x=0;for(let E=0;E<c.length;E++){const I=new o.pointGeometry(c[E][0]*this.width,p+c[E][1]*(this.height-p)),k=r.pointCoordinate(I);if(!k)continue;const B=1/Math.hypot(k[0]-this._camera.position[0],k[1]-this._camera.position[1]);_+=k[3]*B,x+=B}return x===0?NaN:_/x}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*c,_=this._mercatorZfromZoom(r),x=this._mercatorZfromZoom(this._maxZoom),E=Math.max(_-p,x);this._setZoom(this._zoomFromMercatorZ(E))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let p;p=r.z<this._camera.position[2]?[c.x,c.y,c.z]:[r.x,r.y,r.z];const _=o.length(o.sub([],this._camera.position,p));return o.clamp(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let c=!1;if(r.orientation&&!o.exactEquals(r.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(r.orientation)),r.position){const p=[r.position.x,r.position.y,r.position.z];o.exactEquals$1(p,this._camera.position)||(this._setCameraPosition(p),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,c=new eu;return c.position=new o.MercatorCoordinate(r[0],r[1],r[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(r){if(!o.length$1(r))return!1;o.normalize$1(r,r);const c=o.transformQuat([],[0,0,-1],r),p=o.transformQuat([],[0,-1,0],r);if(p[2]<0)return!1;const _=Jf(c,p);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(r){const c=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;r[2]=o.clamp(r[2],_/p,_/c),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,c,p){this._unmodified=!1,this._edgeInsets.interpolate(r,c,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const c=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(r){const c=[new o.UnwrappedTileID(0,r)];if(this.renderWorldCopies){const p=this.pointCoordinate(new o.pointGeometry(0,0)),_=this.pointCoordinate(new o.pointGeometry(this.width,0)),x=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),E=this.pointCoordinate(new o.pointGeometry(0,this.height)),I=Math.floor(Math.min(p.x,_.x,x.x,E.x)),k=Math.floor(Math.max(p.x,_.x,x.x,E.x)),B=1;for(let R=I-B;R<=k+B;R++)R!==0&&c.push(new o.UnwrappedTileID(R,r))}return c}coveringTiles(r){let c=this.coveringZoomLevel(r);const p=c,_=this.elevation&&!r.isTerrainDEM,x=this.projection.name==="mercator";if(r.minzoom!==void 0&&c<r.minzoom)return[];r.maxzoom!==void 0&&c>r.maxzoom&&(c=r.maxzoom);const E=this.locationCoordinate(this.center),I=this.center.lat,k=1<<c,B=[k*E.x,k*E.y,0],R=this.projection.name==="globe",U=!R,W=o.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,U),J=R?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),K=k*o.mercatorZfromAltitude(1,this.center.lat),Q=this._camera.position[2]/o.mercatorZfromAltitude(1,this.center.lat),te=[k*J.x,k*J.y,Q*(U?1:K)],Z=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),le=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,se=r.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,de=r.isTerrainDEM?-se:this._elevation?this._elevation.getMinElevationBelowMSL():0,Se=this.projection.isReprojectedInTileSpace?tu(this):1,be=Ue=>{const Ze=new o.MercatorCoordinate(Ue.x+25e-6,Ue.y,Ue.z),lt=new o.MercatorCoordinate(Ue.x,Ue.y+25e-6,Ue.z),mt=Ue.toLngLat(),Wt=Ze.toLngLat(),mn=lt.toLngLat(),Ut=this.locationCoordinate(mt),Ft=this.locationCoordinate(Wt),Ht=this.locationCoordinate(mn),In=Math.hypot(Ft.x-Ut.x,Ft.y-Ut.y),Qt=Math.hypot(Ht.x-Ut.x,Ht.y-Ut.y);return Math.sqrt(In*Qt)*Se/25e-6},Ae=Ue=>{const Le=se,Ze=de;return{aabb:o.tileAABB(this,k,0,0,0,Ue,Ze,Le,this.projection),zoom:0,x:0,y:0,minZ:Ze,maxZ:Le,wrap:Ue,fullyVisible:!1}},Be=[];let Ne=[];const Ge=c,bt=r.reparseOverscaled?p:c,Fe=Ue=>Ue*Ue,rt=Fe((Q-this._centerAltitude)*K),He=Ue=>{if(!this._elevation||!Ue.tileID||!x)return;const Le=this._elevation.getMinMaxForTile(Ue.tileID),Ze=Ue.aabb;Le?(Ze.min[2]=Le.min,Ze.max[2]=Le.max,Ze.center[2]=(Ze.min[2]+Ze.max[2])/2):(Ue.shouldSplit=ut(Ue),Ue.shouldSplit||(Ze.min[2]=Ze.max[2]=Ze.center[2]=this._centerAltitude))},ut=Ue=>{if(Ue.zoom<le)return!0;if(Ue.zoom===Ge)return!1;if(Ue.shouldSplit!=null)return Ue.shouldSplit;const Le=Ue.aabb.distanceX(te),Ze=Ue.aabb.distanceY(te);let lt=rt,mt=1;if(R){lt=Fe(Ue.aabb.distanceZ(te));const Ut=Math.pow(2,Ue.zoom),Ft=o.latFromMercatorY((Ue.y+1)/Ut),Ht=o.latFromMercatorY(Ue.y/Ut),In=Math.min(Math.max(I,Ft),Ht),Qt=o.circumferenceAtLatitude(In)/o.circumferenceAtLatitude(I);if(mt=In===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Qt/this._mercatorScaleRatio),this.zoom<=o.GLOBE_ZOOM_THRESHOLD_MIN&&Ue.zoom===Ge-1&&Qt>=.9)return!0}else if(_&&(lt=Fe(Ue.aabb.distanceZ(te)*K)),this.projection.isReprojectedInTileSpace&&p<=5){const Ut=Math.pow(2,Ue.zoom),Ft=be(new o.MercatorCoordinate((Ue.x+.5)/Ut,(Ue.y+.5)/Ut));mt=Ft>.85?1:Ft}const Wt=Le*Le+Ze*Ze+lt,mn=Fe((1<<Ge-Ue.zoom)*Z*mt*((Ut,Ft)=>{if(Ft*Fe(.707)<Ut)return 1;const Ht=Math.sqrt(Ft/Ut);return Ht/(1.4144271570014144+(Math.pow(1.1,Ht-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(lt,rt),Wt));return Wt<mn};if(this.renderWorldCopies)for(let Ue=1;Ue<=3;Ue++)Be.push(Ae(-Ue)),Be.push(Ae(Ue));for(Be.push(Ae(0));Be.length>0;){const Ue=Be.pop(),Le=Ue.x,Ze=Ue.y;let lt=Ue.fullyVisible;if(!lt){const mt=Ue.aabb.intersects(W);if(mt===0)continue;lt=mt===2}if(Ue.zoom!==Ge&&ut(Ue))for(let mt=0;mt<4;mt++){const Wt=(Le<<1)+mt%2,mn=(Ze<<1)+(mt>>1),Ut={aabb:x?Ue.aabb.quadrant(mt):o.tileAABB(this,k,Ue.zoom+1,Wt,mn,Ue.wrap,Ue.minZ,Ue.maxZ,this.projection),zoom:Ue.zoom+1,x:Wt,y:mn,wrap:Ue.wrap,fullyVisible:lt,tileID:void 0,shouldSplit:void 0,minZ:Ue.minZ,maxZ:Ue.maxZ};_&&!R&&(Ut.tileID=new o.OverscaledTileID(Ue.zoom+1===Ge?bt:Ue.zoom+1,Ue.wrap,Ue.zoom+1,Wt,mn),He(Ut)),Be.push(Ut)}else{const mt=Ue.zoom===Ge?bt:Ue.zoom;if(r.minzoom&&r.minzoom>mt)continue;const Wt=B[0]-(.5+Le+(Ue.wrap<<Ue.zoom))*(1<<c-Ue.zoom),mn=B[1]-.5-Ze,Ut=Ue.tileID?Ue.tileID:new o.OverscaledTileID(mt,Ue.wrap,Ue.zoom,Le,Ze);Ne.push({tileID:Ut,distanceSq:Wt*Wt+mn*mn})}}if(this.fogCullDistSq){const Ue=this.fogCullDistSq,Le=this.horizonLineFromTop();Ne=Ne.filter(Ze=>{const lt=[0,0,0,1],mt=[o.EXTENT,o.EXTENT,0,1],Wt=this.calculateFogTileMatrix(Ze.tileID.toUnwrapped());o.transformMat4$1(lt,lt,Wt),o.transformMat4$1(mt,mt,Wt);const mn=o.getAABBPointSquareDist(lt,mt);if(mn===0)return!0;let Ut=!1;const Ft=this._elevation;if(Ft&&mn>Ue&&Le!==0){const Ht=this.calculateProjMatrix(Ze.tileID.toUnwrapped());let In;r.isTerrainDEM||(In=Ft.getMinMaxForTile(Ze.tileID)),In||(In={min:de,max:se});const Qt=o.furthestTileCorner(this.rotation),Zn=[Qt[0]*o.EXTENT,Qt[1]*o.EXTENT,In.max];o.transformMat4(Zn,Zn,Ht),Ut=(1-Zn[1])*this.height*.5<Le}return mn<Ue||Ut})}return Ne.sort((Ue,Le)=>Ue.distanceSq-Le.distanceSq).map(Ue=>Ue.tileID)}resize(r,c){this.width=r,this.height=c,this.pixelsToGLUnits=[2/r,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const c=o.clamp(r.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),p=this.projection.project(r.lng,c);return new o.pointGeometry(p.x*this.worldSize,p.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,c){let p,_;const x=this.centerPoint;if(this.projection.name==="globe"){const I=this.worldSize;p=(c.x-x.x)/I,_=(c.y-x.y)/I}else{const I=this.pointCoordinate(c),k=this.pointCoordinate(x);p=I.x-k.x,_=I.y-k.y}const E=this.locationCoordinate(r);this.setLocation(new o.MercatorCoordinate(E.x-p,E.y-_))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,c){const p=c?o.mercatorZfromAltitude(c,r.lat):void 0,_=this.projection.project(r.lng,r.lat);return new o.MercatorCoordinate(_.x,_.y,p)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,c){const p=c!=null?c:this._centerAltitude,_=[r.x,r.y,0,1],x=[r.x,r.y,1,1];o.transformMat4$1(_,_,this.pixelMatrixInverse),o.transformMat4$1(x,x,this.pixelMatrixInverse);const E=x[3];o.scale$1(_,_,1/_[3]),o.scale$1(x,x,1/E);const I=_[2],k=x[2];return{p0:_,p1:x,t:I===k?0:(p-I)/(k-I)}}screenPointToMercatorRay(r){const c=[r.x,r.y,0,1],p=[r.x,r.y,1,1];return o.transformMat4$1(c,c,this.pixelMatrixInverse),o.transformMat4$1(p,p,this.pixelMatrixInverse),o.scale$1(c,c,1/c[3]),o.scale$1(p,p,1/p[3]),c[2]=o.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,p[2]=o.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,o.scale$1(c,c,1/this.worldSize),o.scale$1(p,p,1/this.worldSize),new o.Ray([c[0],c[1],c[2]],o.normalize([],o.sub([],p,c)))}rayIntersectionCoordinate(r){const{p0:c,p1:p,t:_}=r,x=o.mercatorZfromAltitude(c[2],this._center.lat),E=o.mercatorZfromAltitude(p[2],this._center.lat);return new o.MercatorCoordinate(o.number(c[0],p[0],_)/this.worldSize,o.number(c[1],p[1],_)/this.worldSize,o.number(x,E,_))}pointCoordinate(r,c=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,c)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let c=this.projection.pointCoordinate3D(this,r.x,r.y);if(c)return new o.MercatorCoordinate(c[0],c[1],c[2]);let p=0,_=this.horizonLineFromTop();if(r.y>_)return this.pointCoordinate(r);const x=.02*_,E=r.clone();for(let I=0;I<10&&_-p>x;I++){E.y=o.number(p,_,.66);const k=this.projection.pointCoordinate3D(this,E.x,E.y);k?(_=E.y,c=k):p=E.y}return c?new o.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}_coordinatePoint(r,c){const p=c&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,_=[r.x*this.worldSize,r.y*this.worldSize,p+r.toAltitude(),1];return o.transformMat4$1(_,_,this.pixelMatrix),_[3]>0?new o.pointGeometry(_[0]/_[3],_[1]/_[3]):new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:c}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,_=this.width-this._edgeInsets.right,x=this.pointLocation3D(new o.pointGeometry(c,r)),E=this.pointLocation3D(new o.pointGeometry(_,r)),I=this.pointLocation3D(new o.pointGeometry(_,p)),k=this.pointLocation3D(new o.pointGeometry(c,p));let B=Math.min(x.lng,E.lng,I.lng,k.lng),R=Math.max(x.lng,E.lng,I.lng,k.lng),U=Math.min(x.lat,E.lat,I.lat,k.lat),W=Math.max(x.lat,E.lat,I.lat,k.lat);const J=Math.pow(2,-this.zoom)/16*270,K=this.projection.name==="globe"?1:4,Q=(te,Z,le,se,de)=>{const Se=(te+le)/2,be=(Z+se)/2,Ae=new o.pointGeometry(Se,be),{lng:Be,lat:Ne}=this.pointLocation3D(Ae),Ge=Math.max(0,B-Be,U-Ne,Be-R,Ne-W);B=Math.min(B,Be),R=Math.max(R,Be),U=Math.min(U,Ne),W=Math.max(W,Ne),(de<K||Ge>J)&&(Q(te,Z,Se,be,de+1),Q(Se,be,le,se,de+1))};if(Q(c,r,_,r,1),Q(_,r,_,p,1),Q(_,p,c,p,1),Q(c,p,c,r,1),this.projection.name==="globe"){const[te,Z]=o.polesInViewport(this);te?(W=90,R=180,B=-180):Z&&(U=-90,R=180,B=-180)}return new o.LngLatBounds(new o.LngLat(B,U),new o.LngLat(R,W))}_getBoundsRectangular(r,c){const{top:p,left:_}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,I=new o.pointGeometry(_,p),k=new o.pointGeometry(E,p),B=new o.pointGeometry(E,x),R=new o.pointGeometry(_,x);let U=this.pointCoordinate(I,r),W=this.pointCoordinate(k,r);const J=this.pointCoordinate(B,c),K=this.pointCoordinate(R,c),Q=(te,Z)=>(Z.y-te.y)/(Z.x-te.x);return U.y>1&&W.y>=0?U=new o.MercatorCoordinate((1-K.y)/Q(K,U)+K.x,1):U.y<0&&W.y<=1&&(U=new o.MercatorCoordinate(-K.y/Q(K,U)+K.x,0)),W.y>1&&U.y>=0?W=new o.MercatorCoordinate((1-J.y)/Q(J,W)+J.x,1):W.y<0&&U.y<=1&&(W=new o.MercatorCoordinate(-J.y/Q(J,W)+J.x,0)),new o.LngLatBounds().extend(this.coordinateLocation(U)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(K)).extend(this.coordinateLocation(J))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=r.visibleDemTiles.reduce((p,_)=>{if(_.dem){const x=_.dem.tree;p.min=Math.min(p.min,x.minimums[0]),p.max=Math.max(p.max,x.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*r.exaggeration(),c.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,p=this.height/2-c*(1-this._horizonShift);return r?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-o.MAX_MERCATOR_LATITUDE,this.maxLat=o.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=o.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=o.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=o.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,c){return this.projection.createTileMatrix(this,c,r)}calculateDistanceTileData(r){const c=r.key,p=this._distanceTileDataCache;if(p[c])return p[c];const _=r.canonical,x=1/this.height,E=this.cameraWorldSize,I=E/this.zoomScale(_.z),k=(_.x+Math.pow(2,_.z)*r.wrap)*I,B=_.y*I,R=this.point;R.x*=E/this.worldSize,R.y*=E/this.worldSize;const U=this.angle,W=Math.sin(-U),J=-Math.cos(-U);return p[c]={bearing:[W,J],center:[(R.x-k)*x,(R.y-B)*x],scale:I/o.EXTENT*x},p[c]}calculateFogTileMatrix(r){const c=r.key,p=this._fogTileMatrixCache;if(p[c])return p[c];const _=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return o.multiply(_,this.worldToFogMatrix,_),p[c]=new Float32Array(_),p[c]}calculateProjMatrix(r,c=!1){const p=r.key,_=c?this._alignedProjMatrixCache:this._projMatrixCache;if(_[p])return _[p];const x=this.calculatePosMatrix(r,this.worldSize);return o.multiply(x,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,x),_[p]=new Float32Array(x),_[p]}calculatePixelsToTileUnitsMatrix(r){const c=r.tileID.key,p=this._pixelsToTileUnitsCache;if(p[c])return p[c];const _=function(x,E){const{scale:I}=x.tileTransform,k=I*o.EXTENT/(x.tileSize*Math.pow(2,E.zoom-x.tileID.overscaledZ+x.tileID.canonical.z));return B=new Float32Array(4),W=(R=E.inverseAdjustmentMatrix)[1],J=R[2],K=R[3],te=(U=[k,k])[1],B[0]=R[0]*(Q=U[0]),B[1]=W*Q,B[2]=J*te,B[3]=K*te,B;var B,R,U,W,J,K,Q,te}(r,this);return p[c]=_,p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,c=o.fromScaling([],[r,r,r]);return o.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const c=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(c),_=this._camera.forward(),x=o.mercatorZfromAltitude(1,this._center.lat);p[2]/=x,_[2]/=x,o.normalize(_,_);const E=r.raycast(p,_,r.exaggeration());if(E){const I=o.scaleAndAdd([],p,_,E),k=new o.MercatorCoordinate(I[0],I[1],o.mercatorZfromAltitude(I[2],o.latFromMercatorY(I[1]))),B=(k.z+o.length([k.x-p[0],k.y-p[1],k.z-p[2]*x]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(B),this._centerAltitude=k.toAltitude(),this._center=this.coordinateLocation(k),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const c=this._elevation,p=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(p),x=c.getAtPointOrZero(new o.MercatorCoordinate(..._)),E=this.pixelsPerMeter/this.worldSize*x,I=this._minimumHeightOverTerrain(),k=_[2]-E;if(k<=I)if(k<0||r){const B=this.locationCoordinate(this._center,this._centerAltitude),R=[_[0],_[1],B.z-_[2]],U=o.length(R);R[2]-=(I-k)/this._pixelsPerMercatorPixel;const W=o.length(R);if(W===0)return;o.scale$2(R,R,U/W*this._pixelsPerMercatorPixel),this._camera.position=[_[0],_[1],B.z*this._pixelsPerMercatorPixel-R[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const W=this.center;return W.lat=o.clamp(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(W.lng=o.clamp(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const c=this._unmodified,{x:p,y:_}=this.point;let x=0,E=p,I=_;const k=this.width/2,B=this.height/2,R=this.worldMinY*this.scale,U=this.worldMaxY*this.scale;if(_-B<R&&(I=R+B),_+B>U&&(I=U-B),U-R<this.height&&(x=Math.max(x,this.height/(U-R)),I=(U+R)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,J=this.worldMaxX*this.scale,K=this.worldSize/2-(W+J)/2;E=(p+K+this.worldSize)%this.worldSize-K,E-k<W&&(E=W+k),E+k>J&&(E=J-k),J-W<this.width&&(x=Math.max(x,this.width/(J-W)),E=(J+W)/2)}E===p&&I===_||(this.center=this.unproject(new o.pointGeometry(E,I))),x&&(this.zoom+=this.scaleZoom(x)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,c=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.mercatorZfromAltitude(1,this.center.lat)/o.mercatorZfromAltitude(1,o.GLOBE_SCALE_MATCH_LATITUDE));const p=Zs(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,p),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const _=this.projection.zAxisUnit==="meters"?c:1,x=this._camera.getWorldToCamera(this.worldSize,_),E=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);E[8]=2*-r.x/this.width,E[9]=2*r.y/this.height;let I=o.mul([],E,x);if(this.projection.isReprojectedInTileSpace){const be=this.locationCoordinate(this.center),Ae=o.identity([]);o.translate(Ae,Ae,[be.x*this.worldSize,be.y*this.worldSize,0]),o.multiply(Ae,Ae,za(this)),o.translate(Ae,Ae,[-be.x*this.worldSize,-be.y*this.worldSize,0]),o.multiply(I,I,Ae),this.inverseAdjustmentMatrix=function(Be){const Ne=za(Be,!0);return Ee([],[Ne[0],Ne[1],Ne[4],Ne[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=o.scale([],I,[this.worldSize,this.worldSize,this.worldSize/_,1]),this.projMatrix=I,this.invProjMatrix=o.invert(new Float64Array(16),this.projMatrix);const k=o.invert([],E);this.frustumCorners=o.FrustumCorners.fromInvProjectionMatrix(k,this.horizonLineFromTop(),this.height);const B=new Float32Array(16);o.identity(B),o.scale(B,B,[1,-1,1]),o.rotateX(B,B,this._pitch),o.rotateZ(B,B,this.angle);const R=o.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),U=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;R[8]=2*-r.x/this.width,R[9]=2*(r.y+U)/this.height,this.skyboxMatrix=o.multiply(B,R,B);const W=this.point,J=W.x,K=W.y,Q=this.width%2/2,te=this.height%2/2,Z=Math.cos(this.angle),le=Math.sin(this.angle),se=J-Math.round(J)+Z*Q+le*te,de=K-Math.round(K)+Z*te+le*Q,Se=new Float64Array(I);if(o.translate(Se,Se,[se>.5?se-1:se,de>.5?de-1:de,0]),this.alignedProjMatrix=Se,I=o.create(),o.scale(I,I,[this.width/2,-this.height/2,1]),o.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=o.create(),o.scale(I,I,[1,-1,1]),o.translate(I,I,[-1,-1,0]),o.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=o.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=I,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.calculateGlobeMatrix(this);const be=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.transformMat4(be,be,x),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=I;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,p=this._camera.position,_=1/this.height/this._pixelsPerMercatorPixel,x=[r,r,c];o.scale$2(x,x,_),o.scale$2(p,p,-1),o.multiply$2(p,p,x);const E=o.create();o.translate(E,E,p),o.scale(E,E,x),this.mercatorFogMatrix=E,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,c,_)}_computeCameraPosition(r){const c=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),_=this.point,x=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-r/this.worldSize*this._centerAltitude;return[_.x/this.worldSize-p[0]*x,_.y/this.worldSize-p[1]*x,r/this.worldSize*this._centerAltitude-p[2]*x]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],_=r[2];let x=1;this.projection.wrap&&(this.center=this.center.wrap()),_>0&&(x=Math.min((c-p)/_,1)),this._camera.position=o.scaleAndAdd([],this._camera.position,r,x),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,c=this._camera.forward(),{pitch:p,bearing:_}=this._camera.getPitchBearing(),x=o.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,E=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.degToRad(this._maxPitch)),I=Math.max((r[2]-x)/Math.cos(p),E),k=this._zoomFromMercatorZ(I);o.scaleAndAdd(r,r,c,I),this._pitch=o.clamp(p,o.degToRad(this.minPitch),o.degToRad(this.maxPitch)),this.angle=o.wrap(_,-Math.PI,Math.PI),this._setZoom(o.clamp(k,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.MercatorCoordinate(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let c=0,p=o.GLOBE_ZOOM_THRESHOLD_MAX,_=0,x=1/0;for(;p-c>1e-6&&p>c;){const E=c+.5*(p-c),I=this.tileSize*Math.pow(2,E),k=this.getCameraToCenterDistance(this.projection,E,I),B=this.scaleZoom(k/(r*this.tileSize)),R=Math.abs(E-B);R<x&&(x=R,_=E),E<B?c=E:p=E}return _}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,c){const p=Math.min(r.x,c.x),_=Math.max(r.x,c.x),x=Math.min(r.y,c.y),E=Math.max(r.y,c.y);if(x<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const I=[new o.pointGeometry(p,x),new o.pointGeometry(_,E),new o.pointGeometry(p,E),new o.pointGeometry(_,x)],k=this.renderWorldCopies?-3:0,B=this.renderWorldCopies?4:1;for(const R of I){const U=this.pointRayIntersection(R);if(U.t<0)return!0;const W=this.rayIntersectionCoordinate(U);if(W.x<k||W.y<0||W.x>B||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.pointGeometry(0,0),new o.pointGeometry(this.width,this.height))}zoomDeltaToMovement(r,c){const p=o.length(o.sub([],this._camera.position,r)),_=this._zoomFromMercatorZ(p)+c;return p-this._mercatorZfromZoom(_)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([c,p,_],x){const E=[c,p,_,1];o.transformMat4$1(E,E,x);const I=E[3]=Math.max(E[3],1e-6);return E[0]/=I,E[1]/=I,E[2]/=I,E}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.pointGeometry(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,r))}}getCameraToCenterDistance(r,c=this.zoom,p=this.worldSize){const _=Zs(r,c,this.width,this.height,1024),x=r.pixelSpaceConversion(this.center.lat,p,_);return .5/Math.tan(.5*this._fov)*this.height*x}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.multiply(r,r,this.globeMatrix),r}}function Hr(h,r){let c=!1,p=null;const _=()=>{p=null,c&&(h(),p=setTimeout(_,r),c=!1)};return()=>(c=!0,p||_(),p)}class Qf{constructor(r){this._hashName=r&&encodeURIComponent(r),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Hr(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,o.window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),o.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const c=jd(r);if(this._hashName){const p=this._hashName;let _=!1;const x=o.window.location.hash.slice(1).split("&").map(E=>{const I=E.split("=")[0];return I===p?(_=!0,`${I}=${c}`):E}).filter(E=>E);return _||x.push(`${p}=${c}`),`#${x.join("&")}`}return`#${c}`}_getCurrentHash(){const r=o.window.location.hash.replace("#","");if(this._hashName){let c;return r.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(c=p)}),(c&&c[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(p=>isNaN(p))){const p=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(c[3]||0):r.getBearing();return r.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:p,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=o.window.location.href.replace(/(#.+)?$/,this.getHashString());o.window.history.replaceState(o.window.history.state,null,r)}}function jd(h,r){const c=h.getCenter(),p=Math.round(100*h.getZoom())/100,_=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,_),E=Math.round(c.lng*x)/x,I=Math.round(c.lat*x)/x,k=h.getBearing(),B=h.getPitch();let R=r?`/${E}/${I}/${p}`:`${p}/${I}/${E}`;return(k||B)&&(R+="/"+Math.round(10*k)/10),B&&(R+=`/${Math.round(B)}`),R}const kl={linearity:.3,easing:o.bezier(0,0,.3,1)},La=o.extend({deceleration:2500,maxSpeed:1400},kl),ep=o.extend({deceleration:20,maxSpeed:1400},kl),nu=o.extend({deceleration:1e3,maxSpeed:360},kl),Gd=o.extend({deceleration:1e3,maxSpeed:90},kl);class iu{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,c=o.exported.now();for(;r.length>0&&c-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)c.zoom+=x.zoomDelta||0,c.bearing+=x.bearingDelta||0,c.pitch+=x.pitchDelta||0,x.panDelta&&c.pan._add(x.panDelta),x.around&&(c.around=x.around),x.pinchAround&&(c.pinchAround=x.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(c.pan.mag()){const x=Pl(c.pan.mag(),p,o.extend({},La,r||{}));_.offset=c.pan.mult(x.amount/c.pan.mag()),_.center=this._map.transform.center,Ml(_,x)}if(c.zoom){const x=Pl(c.zoom,p,ep);_.zoom=this._map.transform.zoom+x.amount,Ml(_,x)}if(c.bearing){const x=Pl(c.bearing,p,nu);_.bearing=this._map.transform.bearing+o.clamp(x.amount,-179,179),Ml(_,x)}if(c.pitch){const x=Pl(c.pitch,p,Gd);_.pitch=this._map.transform.pitch+x.amount,Ml(_,x)}if(_.zoom||_.bearing){const x=c.pinchAround===void 0?c.around:c.pinchAround;_.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),_.noMoveStart=!0,_}}function Ml(h,r){(!h.duration||h.duration<r.duration)&&(h.duration=r.duration,h.easing=r.easing)}function Pl(h,r,c){const{maxSpeed:p,linearity:_,deceleration:x}=c,E=o.clamp(h*_/(r/1e3),-p,p),I=Math.abs(E)/(x*_);return{easing:c.easing,duration:1e3*I,amount:E*(I/2)}}class nr extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,p,_={}){const x=Y(c.getCanvasContainer(),p),E=c.unproject(x);super(r,o.extend({point:x,lngLat:E,originalEvent:p},_)),this._defaultPrevented=!1,this.target=c}}class ru extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,p){const _=r==="touchend"?p.changedTouches:p.touches,x=ve(c.getCanvasContainer(),_),E=x.map(k=>c.unproject(k)),I=x.reduce((k,B,R,U)=>k.add(B.div(U.length)),new o.pointGeometry(0,0));super(r,{points:x,point:I,lngLats:E,lngLat:c.unproject(I),originalEvent:p}),this._defaultPrevented=!1}}class kg extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,p){super(r,{originalEvent:p}),this._defaultPrevented=!1}}class tp{constructor(r,c){this._map=r,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new kg(r.type,this._map,r))}mousedown(r,c){return this._mousedownPos=c,this._firePreventable(new nr(r.type,this._map,r))}mouseup(r){this._map.fire(new nr(r.type,this._map,r))}preclick(r){const c=o.extend({},r);c.type="preclick",this._map.fire(new nr(c.type,this._map,c))}click(r,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(r),this._map.fire(new nr(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new nr(r.type,this._map,r))}mouseover(r){this._map.fire(new nr(r.type,this._map,r))}mouseout(r){this._map.fire(new nr(r.type,this._map,r))}touchstart(r){return this._firePreventable(new ru(r.type,this._map,r))}touchmove(r){this._map.fire(new ru(r.type,this._map,r))}touchend(r){this._map.fire(new ru(r.type,this._map,r))}touchcancel(r){this._map.fire(new ru(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ou{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new nr(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new nr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new nr(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class qd{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,c){this.isEnabled()&&r.shiftKey&&r.button===0&&(ce(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(r,c){if(!this._active)return;const p=c,_=this._startPos,x=this._lastPos;if(!_||!x||x.equals(p)||!this._box&&p.dist(_)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=D("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const E=Math.min(_.x,p.x),I=Math.max(_.x,p.x),k=Math.min(_.y,p.y),B=Math.max(_.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${E}px,${k}px)`,this._box.style.width=I-E+"px",this._box.style.height=B-k+"px")})}mouseupWindow(r,c){if(!this._active)return;const p=this._startPos,_=c;if(p&&r.button===0){if(this.reset(),Ie(),p.x!==_.x||p.y!==_.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:x=>x.fitScreenCoordinates(p,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),me(),delete this._startPos,delete this._lastPos}_fireEvent(r,c){return this._map.fire(new o.Event(r,{originalEvent:c}))}}function su(h,r){const c={};for(let p=0;p<h.length;p++)c[h[p].identifier]=r[p];return c}class np{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,c,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),p.length===this.numTouches&&(this.centroid=function(_){const x=new o.pointGeometry(0,0);for(const E of _)x._add(E);return x.div(_.length)}(c),this.touches=su(p,c)))}touchmove(r,c,p){if(this.aborted||!this.centroid)return;const _=su(p,c);for(const x in this.touches){const E=this.touches[x],I=_[x];(!I||I.dist(E)>30)&&(this.aborted=!0)}}touchend(r,c,p){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Da{constructor(r){this.singleTap=new np(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,c,p){this.singleTap.touchstart(r,c,p)}touchmove(r,c,p){this.singleTap.touchmove(r,c,p)}touchend(r,c,p){const _=this.singleTap.touchend(r,c,p);if(_){const x=r.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(_)<30;if(x&&E||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class Zd{constructor(){this._zoomIn=new Da({numTouches:1,numTaps:2}),this._zoomOut=new Da({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,c,p){this._zoomIn.touchstart(r,c,p),this._zoomOut.touchstart(r,c,p)}touchmove(r,c,p){this._zoomIn.touchmove(r,c,p),this._zoomOut.touchmove(r,c,p)}touchend(r,c,p){const _=this._zoomIn.touchend(r,c,p),x=this._zoomOut.touchend(r,c,p);return _?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(_)},{originalEvent:r})}):x?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(x)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const ip={0:1,2:2};class au{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,c){return!1}_move(r,c){return{}}mousedown(r,c){if(this._lastPoint)return;const p=fe(r);this._correctButton(r,p)&&(this._lastPoint=c,this._eventButton=p)}mousemoveWindow(r,c){const p=this._lastPoint;if(p){if(r.preventDefault(),this._eventButton!=null&&function(_,x){const E=ip[x];return _.buttons===void 0||(_.buttons&E)!==E}(r,this._eventButton))this.reset();else if(this._moved||!(c.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(p,c)}}mouseupWindow(r){this._lastPoint&&fe(r)===this._eventButton&&(this._moved&&Ie(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class rp extends au{mousedown(r,c){super.mousedown(r,c),this._lastPoint&&(this._active=!0)}_correctButton(r,c){return c===0&&!r.ctrlKey}_move(r,c){return{around:c,panDelta:c.sub(r)}}}class Wd extends au{_correctButton(r,c){return c===0&&r.ctrlKey||c===2}_move(r,c){const p=.8*(c.x-r.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(r){r.preventDefault()}}class Hd extends au{_correctButton(r,c){return c===0&&r.ctrlKey||c===2}_move(r,c){const p=-.5*(c.y-r.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(r){r.preventDefault()}}class Ba{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),o.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0)}touchstart(r,c,p){return this._calculateTransform(r,c,p)}touchmove(r,c,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1&&!o.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,c,p)}}touchend(r,c,p){this._calculateTransform(r,c,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,c,p){p.length>0&&(this._active=!0);const _=su(p,c),x=new o.pointGeometry(0,0),E=new o.pointGeometry(0,0);let I=0;for(const B in _){const R=_[B],U=this._touches[B];U&&(x._add(R),E._add(R.sub(U)),I++,_[B]=R)}if(this._touches=_,I<this._minTouches||!E.mag())return;const k=E.div(I);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(I),panDelta:k}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=D("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class lu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,c,p){return{}}touchstart(r,c,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([c[0],c[1]]))}touchmove(r,c,p){const _=this._firstTwoTouches;if(!_)return;r.preventDefault();const[x,E]=_,I=zl(p,c,x),k=zl(p,c,E);if(!I||!k)return;const B=this._aroundCenter?null:I.add(k).div(2);return this._move([I,k],B,r)}touchend(r,c,p){if(!this._firstTwoTouches)return;const[_,x]=this._firstTwoTouches,E=zl(p,c,_),I=zl(p,c,x);E&&I||(this._active&&Ie(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function zl(h,r,c){for(let p=0;p<h.length;p++)if(h[p].identifier===c)return r[p]}function op(h,r){return Math.log(h/r)/Math.LN2}class sp extends lu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,c){const p=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(op(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:op(this._distance,p),pinchAround:c}}}function Xd(h,r){return 180*h.angleWith(r)/Math.PI}class ap extends lu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,c){const p=this._vector;if(this._vector=r[0].sub(r[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Xd(this._vector,p),pinchAround:c}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const c=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const _=Xd(r,p);return Math.abs(_)<c}}function cu(h){return Math.abs(h.y)>Math.abs(h.x)}class _r extends lu{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,cu(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,c,p){const _=this._lastPoints;if(!_)return;const x=r[0].sub(_[0]),E=r[1].sub(_[1]);return this._map._cooperativeGestures&&!o.isFullscreen()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(x,E,p.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(x.y+E.y)/2*-.5})}gestureBeginsVertically(r,c,p){if(this._valid!==void 0)return this._valid;const _=r.mag()>=2,x=c.mag()>=2;if(!_&&!x)return;if(!_||!x)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const E=r.y>0==c.y>0;return cu(r)&&cu(c)&&E}}const Mg={panStep:100,bearingStep:15,pitchStep:10};class lp{constructor(){const r=Mg;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let c=0,p=0,_=0,x=0,E=0;switch(r.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:r.shiftKey?p=-1:(r.preventDefault(),x=-1);break;case 39:r.shiftKey?p=1:(r.preventDefault(),x=1);break;case 38:r.shiftKey?_=1:(r.preventDefault(),E=-1);break;case 40:r.shiftKey?_=-1:(r.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(p=0,_=0),{cameraAnimation:I=>{const k=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:Pg,zoom:c?Math.round(k)+c*(r.shiftKey?2:1):k,bearing:I.getBearing()+p*this._bearingStep,pitch:I.getPitch()+_*this._pitchStep,offset:[-x*this._panStep,-E*this._panStep],center:I.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Pg(h){return h*(2-h)}const cp=4.000244140625;class $o{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||o.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=r.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const p=o.exported.now(),_=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,c!==0&&c%cp==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(_*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),r.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=r,this._delta-=c,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=Y(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>cp?this._wheelZoomRate:this._defaultZoomRate;let B=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&B!==0&&(B=1/B);const R=c(),U=Math.pow(2,R),W=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):U;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(W*B))),this._type==="wheel"&&(this._startZoom=R,this._easing=this._smoothOutEasing(200)),this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:c(),_=this._startZoom,x=this._easing;let E,I=!1;if(this._type==="wheel"&&_&&x){const k=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),B=x(k);E=o.number(_,p,B),k<1?this._frameId||(this._frameId=!0):I=!0}else E=p,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:E-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let c=o.ease;if(this._prevEase){const p=this._prevEase,_=(o.exported.now()-p.start)/p.duration,x=p.easing(_+.01)-p.easing(_),E=.27/Math.sqrt(x*x+1e-4)*.01,I=Math.sqrt(.0729-E*E);c=o.bezier(E,I,.25,1)}return this._prevEase={start:o.exported.now(),duration:r,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=D("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(o.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class up{constructor(r,c){this._clickZoom=r,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ra{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,c){return r.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(r.shiftKey?-1:1),around:p.unproject(c)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yo{constructor(){this._tap=new Da({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,c,p){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=c[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(r,c,p))}touchmove(r,c,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const _=c[0],x=_.y-this._swipePoint.y;return this._swipePoint=_,r.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(r,c,p)}touchend(r,c,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(r,c,p)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class uu{constructor(r,c,p){this._el=r,this._mousePan=c,this._touchPan=p}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class $t{constructor(r,c,p){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=c,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class dp{constructor(r,c,p,_){this._el=r,this._touchZoom=c,this._touchRotate=p,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ll=h=>h.zoom||h.drag||h.pitch||h.rotate;class Dl extends o.Event{}class Bl{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,c){const p=o.sub([],c,r);this.radius=o.length(p[2]<0?o.div([],p,this.constants):[p[0],p[1],0])}projectRay(r){o.div(r,r,this.constants),o.normalize(r,r),o.mul$1(r,r,this.constants);const c=o.scale$2([],r,this.radius);if(c[2]>0){const p=o.scale$2([],[0,0,1],o.dot(c,[0,0,1])),_=o.scale$2([],o.normalize([],[c[0],c[1],0]),this.radius),x=o.add([],c,o.scale$2([],o.sub([],o.add([],_,p),c),2));c[0]=x[0],c[1]=x[1]}return c}}function Rl(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class hp{constructor(r,c){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new iu(r),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Bl,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),o.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[o.window,"blur",void 0]];for(const[_,x,E]of this._listeners)_.addEventListener(x,_===o.window.document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[r,c,p]of this._listeners)r.removeEventListener(c,r===o.window.document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(r){const c=this._map,p=c.getCanvasContainer();this._add("mapEvent",new tp(c,r));const _=c.boxZoom=new qd(c,r);this._add("boxZoom",_);const x=new Zd,E=new Ra;c.doubleClickZoom=new up(E,x),this._add("tapZoom",x),this._add("clickZoom",E);const I=new yo;this._add("tapDragZoom",I);const k=c.touchPitch=new _r(c);this._add("touchPitch",k);const B=new Wd(r),R=new Hd(r);c.dragRotate=new $t(r,B,R),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",R,["mouseRotate"]);const U=new rp(r),W=new Ba(c,r);c.dragPan=new uu(p,U,W),this._add("mousePan",U),this._add("touchPan",W,["touchZoom","touchRotate"]);const J=new ap,K=new sp;c.touchZoomRotate=new dp(p,K,J,I),this._add("touchRotate",J,["touchPan","touchZoom"]),this._add("touchZoom",K,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ou(c));const Q=c.scrollZoom=new $o(c,this);this._add("scrollZoom",Q,["mousePan"]);const te=c.keyboard=new lp;this._add("keyboard",te);for(const Z of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[Z]&&c[Z].enable(r[Z])}_add(r,c,p){this._handlers.push({handlerName:r,handler:c,allowed:p}),this._handlersById[r]=c}stop(r){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ll(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,c,p){for(const _ in r)if(_!==p&&(!c||c.indexOf(_)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const c=[];for(const p of r)this._el.contains(p.target)&&c.push(p);return c}handleEvent(r,c){this._updatingCamera=!0;const p=r.type==="renderFrame",_=p?void 0:r,x={needsRenderFrame:!1},E={},I={},k=r.touches?this._getMapTouches(r.touches):void 0,B=k?ve(this._el,k):p?void 0:Y(this._el,r);for(const{handlerName:W,handler:J,allowed:K}of this._handlers){if(!J.isEnabled())continue;let Q;this._blockedByActive(I,K,W)?J.reset():J[c||r.type]&&(Q=J[c||r.type](r,B,k),this.mergeHandlerResult(x,E,Q,W,_),Q&&Q.needsRenderFrame&&this._triggerRenderFrame()),(Q||J.isActive())&&(I[W]=J)}const R={};for(const W in this._previousActiveHandlers)I[W]||(R[W]=_);this._previousActiveHandlers=I,(Object.keys(R).length||Rl(x))&&(this._changes.push([x,E,R]),this._triggerRenderFrame()),(Object.keys(I).length||Rl(x))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:U}=x;U&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],U(this._map))}mergeHandlerResult(r,c,p,_,x){if(!p)return;o.extend(r,p);const E={handlerName:_,originalEvent:p.originalEvent||x};p.zoomDelta!==void 0&&(c.zoom=E),p.panDelta!==void 0&&(c.drag=E),p.pitchDelta!==void 0&&(c.pitch=E),p.bearingDelta!==void 0&&(c.rotate=E)}_applyChanges(){const r={},c={},p={};for(const[_,x,E]of this._changes)_.panDelta&&(r.panDelta=(r.panDelta||new o.pointGeometry(0,0))._add(_.panDelta)),_.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(r.around=_.around),_.aroundCoord!==void 0&&(r.aroundCoord=_.aroundCoord),_.pinchAround!==void 0&&(r.pinchAround=_.pinchAround),_.noInertia&&(r.noInertia=_.noInertia),o.extend(c,x),o.extend(p,E);this._updateMapTransform(r,c,p),this._changes=[]}_updateMapTransform(r,c,p){const _=this._map,x=_.transform,E=le=>[le.x,le.y,le.z];if((le=>{const se=this._eventsInProgress.drag;return se&&!this._handlersById[se.handlerName].isActive()})()&&!Rl(r)){const le=x.zoom;x.cameraElevationReference="sea",x.recenterOnTerrain(),x.cameraElevationReference="ground",le!==x.zoom&&this._map._update(!0)}if(x._isCameraConstrained&&_._stop(!0),!Rl(r))return void this._fireEvents(c,p,!0);let{panDelta:I,zoomDelta:k,bearingDelta:B,pitchDelta:R,around:U,aroundCoord:W,pinchAround:J}=r;x._isCameraConstrained&&(k>0&&(k=0),x._isCameraConstrained=!1),J!==void 0&&(U=J),(k||(le=>c.drag&&!this._eventsInProgress.drag)())&&U&&(this._dragOrigin=E(x.pointCoordinate3D(U)),this._trackingEllipsoid.setup(x._camera.position,this._dragOrigin)),x.cameraElevationReference="sea",_._stop(!0),U=U||_.transform.centerPoint,B&&(x.bearing+=B),R&&(x.pitch+=R),x._updateCameraState();const K=[0,0,0];if(I)if(x.projection.name==="mercator"){const le=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(U).dir),se=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(U.sub(I)).dir);K[0]=se[0]-le[0],K[1]=se[1]-le[1]}else{const le=x.pointCoordinate(U);if(x.projection.name==="globe"){I=I.rotate(-x.angle);const se=x._pixelsPerMercatorPixel/x.worldSize;K[0]=-I.x*o.mercatorScale(o.latFromMercatorY(le.y))*se,K[1]=-I.y*o.mercatorScale(x.center.lat)*se}else{const se=x.pointCoordinate(U.sub(I));le&&se&&(K[0]=se.x-le.x,K[1]=se.y-le.y)}}const Q=x.zoom,te=[0,0,0];if(k){const le=E(W||x.pointCoordinate3D(U)),se={dir:o.normalize([],o.sub([],le,x._camera.position))};if(se.dir[2]<0){const de=x.zoomDeltaToMovement(le,k);o.scale$2(te,se.dir,de)}}const Z=o.add(K,K,te);x._translateCameraConstrained(Z),k&&Math.abs(x.zoom-Q)>1e-4&&x.recenterOnTerrain(),x.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(c,p,!0)}_fireEvents(r,c,p){const _=Ll(this._eventsInProgress),x=Ll(r),E={};for(const R in r){const{originalEvent:U}=r[R];this._eventsInProgress[R]||(E[`${R}start`]=U),this._eventsInProgress[R]=r[R]}!_&&x&&this._fireEvent("movestart",x.originalEvent);for(const R in E)this._fireEvent(R,E[R]);x&&this._fireEvent("move",x.originalEvent);for(const R in r){const{originalEvent:U}=r[R];this._fireEvent(R,U)}const I={};let k;for(const R in this._eventsInProgress){const{handlerName:U,originalEvent:W}=this._eventsInProgress[R];this._handlersById[U].isActive()||(delete this._eventsInProgress[R],k=c[U]||W,I[`${R}end`]=k)}for(const R in I)this._fireEvent(R,I[R]);const B=Ll(this._eventsInProgress);if(p&&(_||x)&&!B){this._updatingCamera=!0;const R=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),U=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;R?(U(R.bearing||this._map.getBearing())&&(R.bearing=0),this._map.easeTo(R,{originalEvent:k})):(this._map.fire(new o.Event("moveend",{originalEvent:k})),U(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,c){this._map.fire(new o.Event(r,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new Dl("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Yd="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class fp extends o.Evented{constructor(r,c){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=c.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,c){return this.jumpTo({center:r},c)}panBy(r,c,p){return r=o.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,o.extend({offset:r},c),p)}panTo(r,c,p){return this.easeTo(o.extend({center:r},c),p)}getZoom(){return this.transform.zoom}setZoom(r,c){return this.jumpTo({zoom:r},c),this}zoomTo(r,c,p){return this.easeTo(o.extend({zoom:r},c),p)}zoomIn(r,c){return this.zoomTo(this.getZoom()+1,r,c),this}zoomOut(r,c){return this.zoomTo(this.getZoom()-1,r,c),this}getBearing(){return this.transform.bearing}setBearing(r,c){return this.jumpTo({bearing:r},c),this}getPadding(){return this.transform.padding}setPadding(r,c){return this.jumpTo({padding:r},c),this}rotateTo(r,c,p){return this.easeTo(o.extend({bearing:r},c),p)}resetNorth(r,c){return this.rotateTo(0,o.extend({duration:1e3},r),c),this}resetNorthPitch(r,c){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},r),c),this}snapToNorth(r,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,c):this}getPitch(){return this.transform.pitch}setPitch(r,c){return this.jumpTo({pitch:r},c),this}cameraForBounds(r,c){r=o.LngLatBounds.convert(r);const p=c&&c.bearing||0,_=c&&c.pitch||0,x=r.getNorthWest(),E=r.getSouthEast();return this._cameraForBounds(this.transform,x,E,p,_,c)}_extendCameraOptions(r){const c={top:0,bottom:0,right:0,left:0};if(typeof(r=o.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=="number"){const p=r.padding;r.padding={top:p,bottom:p,right:p,left:p}}return r.padding=o.extend(c,r.padding),r}_minimumAABBFrustumDistance(r,c){const p=c.max[0]-c.min[0],_=c.max[1]-c.min[1];return p/_>r.aspect?p/(2*Math.tan(.5*r.fovX)*r.aspect):_/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,c,p,_,x,E){const I=r.clone(),k=this._extendCameraOptions(E);I.bearing=_,I.pitch=x;const B=o.LngLat.convert(c),R=o.LngLat.convert(p),U=.5*(B.lat+R.lat),W=.5*(B.lng+R.lng),J=o.latLngToECEF(U,W),K=o.normalize([],J),Q=o.normalize([],o.cross([],K,[0,1,0])),te=o.cross([],Q,K),Z=[Q[0],Q[1],Q[2],0,te[0],te[1],te[2],0,K[0],K[1],K[2],0,0,0,0,1],le=[J,o.latLngToECEF(B.lat,B.lng),o.latLngToECEF(R.lat,B.lng),o.latLngToECEF(R.lat,R.lng),o.latLngToECEF(B.lat,R.lng),o.latLngToECEF(U,B.lng),o.latLngToECEF(U,R.lng),o.latLngToECEF(B.lat,W),o.latLngToECEF(R.lat,W)];let se=o.Aabb.fromPoints(le.map(lt=>[o.dot(Q,lt),o.dot(te,lt),o.dot(K,lt)]));const de=o.transformMat4([],se.center,Z);o.squaredLength(de)===0&&o.set(de,0,0,1),o.normalize(de,de),o.scale$2(de,de,o.GLOBE_RADIUS),I.center=o.ecefToLatLng(de);const Se=I.getWorldToCameraMatrix(),be=o.invert(new Float64Array(16),Se);se=o.Aabb.applyTransform(se,o.multiply([],Se,Z)),o.transformMat4(de,de,Se);const Ae=.5*(se.max[2]-se.min[2]),Be=this._minimumAABBFrustumDistance(I,se),Ne=o.scale$2([],[0,0,1],Ae),Ge=o.add(Ne,de,Ne),bt=Be+(I.pitch===0?0:o.distance(de,Ge)),Fe=I.globeCenterInViewSpace,rt=o.sub([],de,[Fe[0],Fe[1],Fe[2]]);o.normalize(rt,rt),o.scale$2(rt,rt,bt);const He=o.add([],de,rt);o.transformMat4(He,He,be);const ut=o.earthRadius/o.GLOBE_RADIUS,Ue=o.length(He),Le=o.mercatorZfromAltitude(Math.max(Ue*ut-o.earthRadius,Number.EPSILON),0),Ze=Math.min(I.zoomFromMercatorZAdjusted(Le),k.maxZoom);return Ze>.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"mercator"}),I.zoom=Ze,this._cameraForBounds(I,c,p,_,x,E)):{center:I.center,zoom:Ze,bearing:_,pitch:x}}queryTerrainElevation(r,c){const p=this.transform.elevation;return p?(c=o.extend({},{exaggerated:!0},c),p.getAtPoint(o.MercatorCoordinate.fromLngLat(r),null,c.exaggerated)):null}_cameraForBounds(r,c,p,_,x,E){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,c,p,_,x,E);const I=r.clone(),k=this._extendCameraOptions(E),B=I.padding;I.bearing=_,I.pitch=x;const R=o.LngLat.convert(c),U=o.LngLat.convert(p),W=new o.LngLat(R.lng,U.lat),J=new o.LngLat(U.lng,R.lat),K=I.project(R),Q=I.project(U),te=this.queryTerrainElevation(R),Z=this.queryTerrainElevation(U),le=this.queryTerrainElevation(W),se=this.queryTerrainElevation(J),de=[[K.x,K.y,Math.min(te||0,Z||0,le||0,se||0)],[Q.x,Q.y,Math.max(te||0,Z||0,le||0,se||0)]];let Se=o.Aabb.fromPoints(de);const be=I.getWorldToCameraMatrix(),Ae=o.invert(new Float64Array(16),be);Se=o.Aabb.applyTransform(Se,be);const Be=o.sub([],Se.max,Se.min),Ne=B.left||0,Ge=B.right||0,bt=B.bottom||0,Fe=B.top||0,{left:rt,right:He,top:ut,bottom:Ue}=k.padding,Le=.5*(Ne+Ge),Ze=.5*(Fe+bt),lt=Math.min(I.scaleZoom(I.scale*Math.min((I.width-(Ne+Ge+rt+He))/Be[0],(I.height-(bt+Fe+Ue+ut))/Be[1])),k.maxZoom),mt=I.scale/I.zoomScale(lt);Se=new o.Aabb([Se.min[0]-(rt+Le)*mt,Se.min[1]-(Ue+Ze)*mt,Se.min[2]],[Se.max[0]+(He+Le)*mt,Se.max[1]+(ut+Ze)*mt,Se.max[2]]);const Wt=.5*Be[2],mn=this._minimumAABBFrustumDistance(I,Se),Ut=[0,0,1,0];o.transformMat4$1(Ut,Ut,be),o.normalize$2(Ut,Ut);const Ft=o.scale$2([],Ut,mn+Wt),Ht=o.add([],Se.center,Ft),In=(typeof k.offset.x=="number"&&typeof k.offset.y=="number"?new o.pointGeometry(k.offset.x,k.offset.y):o.pointGeometry.convert(k.offset)).rotate(-o.degToRad(_));Se.center[0]-=In.x*mt,Se.center[1]+=In.y*mt,o.transformMat4(Se.center,Se.center,Ae),o.transformMat4(Ht,Ht,Ae);const Qt=[Se.center[0],Se.center[1],Ht[2]*I.pixelsPerMeter];o.scale$2(Qt,Qt,1/I.worldSize);const Zn=o.lngFromMercatorX(Qt[0]),ei=o.latFromMercatorY(Qt[1]),li=Math.min(I._zoomFromMercatorZ(Qt[2]),k.maxZoom),ri=new o.LngLat(Zn,ei);return I.mercatorFromTransition&&li<.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"globe"}),I.zoom=li,this._cameraForBounds(I,c,p,_,x,E)):{center:ri,zoom:li,bearing:_,pitch:x}}fitBounds(r,c,p){const _=this.cameraForBounds(r,c);return this._fitInternal(_,c,p)}fitScreenCoordinates(r,c,p,_,x){const E=o.pointGeometry.convert(r),I=o.pointGeometry.convert(c),k=new o.pointGeometry(Math.min(E.x,I.x),Math.min(E.y,I.y)),B=new o.pointGeometry(Math.max(E.x,I.x),Math.max(E.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(E,I))return this;const R=this.transform.pointLocation3D(k),U=this.transform.pointLocation3D(B),W=this.transform.pointLocation3D(new o.pointGeometry(k.x,B.y)),J=this.transform.pointLocation3D(new o.pointGeometry(B.x,k.y)),K=[Math.min(R.lng,U.lng,W.lng,J.lng),Math.min(R.lat,U.lat,W.lat,J.lat)],Q=[Math.max(R.lng,U.lng,W.lng,J.lng),Math.max(R.lat,U.lat,W.lat,J.lat)],te=_&&_.pitch?_.pitch:this.getPitch(),Z=this._cameraForBounds(this.transform,K,Q,p,te,_);return this._fitInternal(Z,_,x)}_fitInternal(r,c,p){return r?(delete(c=o.extend(r,c)).padding,c.linear?this.easeTo(c,p):this.flyTo(c,p)):this}jumpTo(r,c){this.stop();const p=r.preloadOnly?this.transform.clone():this.transform;let _=!1,x=!1,E=!1;return"zoom"in r&&p.zoom!==+r.zoom&&(_=!0,p.zoom=+r.zoom),r.center!==void 0&&(p.center=o.LngLat.convert(r.center)),"bearing"in r&&p.bearing!==+r.bearing&&(x=!0,p.bearing=+r.bearing),"pitch"in r&&p.pitch!==+r.pitch&&(E=!0,p.pitch=+r.pitch),r.padding==null||p.isPaddingEqual(r.padding)||(p.padding=r.padding),r.preloadOnly?(this._preloadTiles(p),this):(this.fire(new o.Event("movestart",c)).fire(new o.Event("move",c)),_&&this.fire(new o.Event("zoomstart",c)).fire(new o.Event("zoom",c)).fire(new o.Event("zoomend",c)),x&&this.fire(new o.Event("rotatestart",c)).fire(new o.Event("rotate",c)).fire(new o.Event("rotateend",c)),E&&this.fire(new o.Event("pitchstart",c)).fire(new o.Event("pitch",c)).fire(new o.Event("pitchend",c)),this.fire(new o.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.warnOnce(Yd),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,c){const p=this.transform;if(!p.projection.supportsFreeCamera)return o.warnOnce(Yd),this;this.stop();const _=p.zoom,x=p.pitch,E=p.bearing;p.setFreeCameraOptions(r);const I=_!==p.zoom,k=x!==p.pitch,B=E!==p.bearing;return this.fire(new o.Event("movestart",c)).fire(new o.Event("move",c)),I&&this.fire(new o.Event("zoomstart",c)).fire(new o.Event("zoom",c)).fire(new o.Event("zoomend",c)),B&&this.fire(new o.Event("rotatestart",c)).fire(new o.Event("rotate",c)).fire(new o.Event("rotateend",c)),k&&this.fire(new o.Event("pitchstart",c)).fire(new o.Event("pitch",c)).fire(new o.Event("pitchend",c)),this.fire(new o.Event("moveend",c)),this}easeTo(r,c){this._stop(!1,r.easeId),((r=o.extend({offset:[0,0],duration:500,easing:o.ease},r)).animate===!1||!r.essential&&o.exported.prefersReducedMotion)&&(r.duration=0);const p=this.transform,_=this.getZoom(),x=this.getBearing(),E=this.getPitch(),I=this.getPadding(),k="zoom"in r?+r.zoom:_,B="bearing"in r?this._normalizeBearing(r.bearing,x):x,R="pitch"in r?+r.pitch:E,U="padding"in r?r.padding:p.padding,W=o.pointGeometry.convert(r.offset);let J,K,Q;if(p.projection.name==="globe"){const Ne=o.MercatorCoordinate.fromLngLat(p.center),Ge=W.rotate(-p.angle);Ne.x+=Ge.x/p.worldSize,Ne.y+=Ge.y/p.worldSize;const bt=Ne.toLngLat(),Fe=o.LngLat.convert(r.center||bt);this._normalizeCenter(Fe),J=p.centerPoint.add(Ge),K=new o.pointGeometry(Ne.x,Ne.y).mult(p.worldSize),Q=new o.pointGeometry(o.mercatorXfromLng(Fe.lng),o.mercatorYfromLat(Fe.lat)).mult(p.worldSize).sub(K)}else{J=p.centerPoint.add(W);const Ne=p.pointLocation(J),Ge=o.LngLat.convert(r.center||Ne);this._normalizeCenter(Ge),K=p.project(Ne),Q=p.project(Ge).sub(K)}const te=p.zoomScale(k-_);let Z,le;r.around&&(Z=o.LngLat.convert(r.around),le=p.locationPoint(Z));const se=this._zooming||k!==_,de=this._rotating||x!==B,Se=this._pitching||R!==E,be=!p.isPaddingEqual(U),Ae=Ne=>Ge=>{if(se&&(Ne.zoom=o.number(_,k,Ge)),de&&(Ne.bearing=o.number(x,B,Ge)),Se&&(Ne.pitch=o.number(E,R,Ge)),be&&(Ne.interpolatePadding(I,U,Ge),J=Ne.centerPoint.add(W)),Z)Ne.setLocationAtPoint(Z,le);else{const bt=Ne.zoomScale(Ne.zoom-_),Fe=k>_?Math.min(2,te):Math.max(.5,te),rt=Math.pow(Fe,1-Ge),He=Ne.unproject(K.add(Q.mult(Ge*rt)).mult(bt));Ne.setLocationAtPoint(Ne.renderWorldCopies?He.wrap():He,J)}return r.preloadOnly||this._fireMoveEvents(c),Ne};if(r.preloadOnly){const Ne=this._emulate(Ae,r.duration,p);return this._preloadTiles(Ne),this}const Be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=se,this._rotating=de,this._pitching=Se,this._padding=be,this._easeId=r.easeId,this._prepareEase(c,r.noMoveStart,Be),this._ease(Ae(p),Ne=>{p.recenterOnTerrain(),this._afterEase(c,Ne)},r),this}_prepareEase(r,c,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||p.moving||this.fire(new o.Event("movestart",r)),this._zooming&&!p.zooming&&this.fire(new o.Event("zoomstart",r)),this._rotating&&!p.rotating&&this.fire(new o.Event("rotatestart",r)),this._pitching&&!p.pitching&&this.fire(new o.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new o.Event("move",r)),this._zooming&&this.fire(new o.Event("zoom",r)),this._rotating&&this.fire(new o.Event("rotate",r)),this._pitching&&this.fire(new o.Event("pitch",r))}_afterEase(r,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,_=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new o.Event("zoomend",r)),_&&this.fire(new o.Event("rotateend",r)),x&&this.fire(new o.Event("pitchend",r)),this.fire(new o.Event("moveend",r))}flyTo(r,c){if(!r.essential&&o.exported.prefersReducedMotion){const lt=o.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(lt,c)}this.stop(),r=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},r);const p=this.transform,_=this.getZoom(),x=this.getBearing(),E=this.getPitch(),I=this.getPadding(),k="zoom"in r?o.clamp(+r.zoom,p.minZoom,p.maxZoom):_,B="bearing"in r?this._normalizeBearing(r.bearing,x):x,R="pitch"in r?+r.pitch:E,U="padding"in r?r.padding:p.padding,W=p.zoomScale(k-_),J=o.pointGeometry.convert(r.offset);let K=p.centerPoint.add(J);const Q=p.pointLocation(K),te=o.LngLat.convert(r.center||Q);this._normalizeCenter(te);const Z=p.project(Q),le=p.project(te).sub(Z);let se=r.curve;const de=Math.max(p.width,p.height),Se=de/W,be=le.mag();if("minZoom"in r){const lt=o.clamp(Math.min(r.minZoom,_,k),p.minZoom,p.maxZoom),mt=de/p.zoomScale(lt-_);se=Math.sqrt(mt/be*2)}const Ae=se*se;function Be(lt){const mt=(Se*Se-de*de+(lt?-1:1)*Ae*Ae*be*be)/(2*(lt?Se:de)*Ae*be);return Math.log(Math.sqrt(mt*mt+1)-mt)}function Ne(lt){return(Math.exp(lt)-Math.exp(-lt))/2}function Ge(lt){return(Math.exp(lt)+Math.exp(-lt))/2}const bt=Be(0);let Fe=function(lt){return Ge(bt)/Ge(bt+se*lt)},rt=function(lt){return de*((Ge(bt)*(Ne(mt=bt+se*lt)/Ge(mt))-Ne(bt))/Ae)/be;var mt},He=(Be(1)-bt)/se;if(Math.abs(be)<1e-6||!isFinite(He)){if(Math.abs(de-Se)<1e-6)return this.easeTo(r,c);const lt=Se<de?-1:1;He=Math.abs(Math.log(Se/de))/se,rt=function(){return 0},Fe=function(mt){return Math.exp(lt*se*mt)}}r.duration="duration"in r?+r.duration:1e3*He/("screenSpeed"in r?+r.screenSpeed/se:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const ut=x!==B,Ue=R!==E,Le=!p.isPaddingEqual(U),Ze=lt=>mt=>{const Wt=mt*He,mn=1/Fe(Wt);lt.zoom=mt===1?k:_+lt.scaleZoom(mn),ut&&(lt.bearing=o.number(x,B,mt)),Ue&&(lt.pitch=o.number(E,R,mt)),Le&&(lt.interpolatePadding(I,U,mt),K=lt.centerPoint.add(J));const Ut=mt===1?te:lt.unproject(Z.add(le.mult(rt(Wt))).mult(mn));return lt.setLocationAtPoint(lt.renderWorldCopies?Ut.wrap():Ut,K),lt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(c),lt};if(r.preloadOnly){const lt=this._emulate(Ze,r.duration,p);return this._preloadTiles(lt),this}return this._zooming=!0,this._rotating=ut,this._pitching=Ue,this._padding=Le,this._prepareEase(c,!1),this._ease(Ze(p),()=>this._afterEase(c),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,c)}if(!r){const p=this.handlers;p&&p.stop(!1)}return this}_ease(r,c,p){p.animate===!1||p.duration===0?(r(1),c()):(this._easeStart=o.exported.now(),this._easeOptions=p,this._onEaseFrame=r,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,c){r=o.wrap(r,-180,180);const p=Math.abs(r-c);return Math.abs(r-360-c)<p&&(r-=360),Math.abs(r+360-c)<p&&(r+=360),r}_normalizeCenter(r){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const p=r.lng-c.center.lng;r.lng+=p>180?-360:p<-180?360:0}_emulate(r,c,p){const _=Math.ceil(15*c/1e3),x=[],E=r(p.clone());for(let I=0;I<=_;I++){const k=E(I/_);x.push(k.clone())}return x}}class Kd{constructor(r={}){this.options=r,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const c=this.options&&this.options.compact;return this._map=r,this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D("button","mapboxgl-ctrl-attrib-button",this._container),D("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(r,c){const p=this._map._getUIString(`AttributionControl.${c}`);r.setAttribute("aria-label",p),r.removeAttribute("title"),r.firstElementChild&&r.firstElementChild.setAttribute("title",p)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(r){const p=c.reduce((_,x,E)=>(x.value&&(_+=`${x.key}=${x.value}${E<c.length-1?"&":""}`),_),"?");r.href=`${o.config.FEEDBACK_URL}/${p}#${jd(this._map,!0)}`,r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const c=this._map.style._sourceCaches;for(const _ in c){const x=c[_];if(x.used){const E=x.getSource();E.attribution&&r.indexOf(E.attribution)<0&&r.push(E.attribution)}}r.sort((_,x)=>_.length-x.length),r=r.filter((_,x)=>{for(let E=x+1;E<r.length;E++)if(r[E].indexOf(_)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const p=r.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,r.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Jd{constructor(){o.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=D("div","mapboxgl-ctrl");const c=D("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const c in r){const p=r[c].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const c=r[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class Ol{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const c=++this._id;return this._queue.push({callback:r,id:c,cancelled:!1}),c}remove(r){const c=this._currentlyRunning,p=c?this._queue.concat(c):this._queue;for(const _ of p)if(_.id===r)return void(_.cancelled=!0)}run(r=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const p of c)if(!p.cancelled&&(p.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function du(h,r,c){if(h=new o.LngLat(h.lng,h.lat),r){const p=new o.LngLat(h.lng-360,h.lat),_=new o.LngLat(h.lng+360,h.lat),x=360*Math.ceil(Math.abs(h.lng-c.center.lng)/360),E=c.locationPoint(h).distSqr(r),I=r.x<0||r.y<0||r.x>c.width||r.y>c.height;c.locationPoint(p).distSqr(r)<E&&(I||Math.abs(p.lng-c.center.lng)<x)?h=p:c.locationPoint(_).distSqr(r)<E&&(I||Math.abs(_.lng-c.center.lng)<x)&&(h=_)}for(;Math.abs(h.lng-c.center.lng)>180;){const p=c.locationPoint(h);if(p.x>=0&&p.y>=0&&p.x<=c.width&&p.y<=c.height)break;h.lng>c.center.lng?h.lng-=360:h.lng+=360}return h}const Oa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class hu extends o.Evented{constructor(r,c){if(super(),(r instanceof o.window.HTMLElement||c)&&(r=o.extend({element:r},c)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=o.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=D("div");const _=41,x=27,E=V("svg",{display:"block",height:_*this._scale+"px",width:x*this._scale+"px",viewBox:`0 0 ${x} ${_}`},this._element),I=V("radialGradient",{id:"shadowGradient"},V("defs",{},E));V("stop",{offset:"10%","stop-opacity":.4},I),V("stop",{offset:"100%","stop-opacity":.05},I),V("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},E),V("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},E),V("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},E),V("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},E),this._offset=o.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",_=>{_.preventDefault()}),this._element.addEventListener("mousedown",_=>{_.preventDefault()});const p=this._element.classList;for(const _ in Oa)p.remove(`mapboxgl-marker-anchor-${_}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=o.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const c=r.code,p=r.charCode||r.keyCode;c!=="Space"&&c!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(r){const c=r.originalEvent.target,p=this._element;this._popup&&(c===p||p.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,c=this._pos;if(!r||!c)return!1;const p=r.unproject(c),_=r.getFreeCameraOptions();if(!_.position)return!1;const x=_.position.toLngLat();return x.distanceTo(p)<.9*x.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const c=this._pos;if(!c||c.x<0||c.x>r.transform.width||c.y<0||c.y>r.transform.height)return void this._clearFadeTimer();const p=r.unproject(c);let _;r._showingGlobe()&&o.isLngLatBehindGlobe(r.transform,this._lngLat)?_=0:(_=1-r._queryFogOpacity(p),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(_*=this._occludedOpacity)),this._element.style.opacity=`${_}`,this._element.style.pointerEvents=_>0?"auto":"none",this._popup&&this._popup._setOpacity(_),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${Oa[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${c.x}px,${c.y}px)
        `}_calculateXYTransform(){const r=this._pos,c=this._map,p=this.getPitchAlignment();if(!c||!r||p!=="map")return"";if(!c._showingGlobe()){const k=c.getPitch();return k?`rotateX(${k}deg)`:""}const _=o.radToDeg(o.globeTiltAtLngLat(c.transform,this._lngLat)),x=r.sub(o.globeCenterToScreenPoint(c.transform)),E=Math.abs(x.x)+Math.abs(x.y);if(E===0)return"";const I=_/E;return`rotateX(${-x.y*I}deg) rotateY(${x.x*I}deg)`}_calculateZTransform(){const r=this._pos,c=this._map;if(!c||!r)return"";let p=0;const _=this.getRotationAlignment();if(_==="map")if(c._showingGlobe()){const x=c.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),E=c.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(x);p=o.radToDeg(Math.atan2(E.y,E.x))-90}else p=-c.getBearing();else if(_==="horizon"){const x=o.smoothstep(4,6,c.getZoom()),E=o.globeCenterToScreenPoint(c.transform);E.y+=x*c.transform.height;const I=r.sub(E),k=o.radToDeg(Math.atan2(I.y,I.x));p=(k>90?k-270:k+90)*(1-x)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(r){o.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=du(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),r===!0?this._updateFrameId=o.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=o.pointGeometry.convert(r),this._update(),this}_onMove(r){const c=this._map;if(!c)return;const p=this._pointerdownPos,_=this._positionDelta;if(p&&_){if(!this._isDragging){const x=this._clickTolerance||c._clickTolerance;if(r.point.dist(p)<x)return;this._isDragging=!0}this._pos=r.point.sub(_),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(r){const c=this._map,p=this._pos;c&&p&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(p),this._pointerdownPos=r.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const c=this._map;return c&&(r?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const pp={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},mp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Qd(h=new o.pointGeometry(0,0),r="bottom"){if(typeof h=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(h,2)));switch(r){case"top":return new o.pointGeometry(0,h);case"top-left":return new o.pointGeometry(c,c);case"top-right":return new o.pointGeometry(-c,c);case"bottom":return new o.pointGeometry(0,-h);case"bottom-left":return new o.pointGeometry(c,-c);case"bottom-right":return new o.pointGeometry(-c,-c);case"left":return new o.pointGeometry(h,0);case"right":return new o.pointGeometry(-h,0)}return new o.pointGeometry(0,0)}return h instanceof o.pointGeometry||Array.isArray(h)?o.pointGeometry.convert(h):o.pointGeometry.convert(h[r]||[0,0])}class gp{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const c=o.easeCubicInOut((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,c,p){this._start=this.getValue(c),this._end=r,this._startTime=c,this._endTime=c+p}}const _p={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},vp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},eh={showCompass:!0,showZoom:!0,visualizePitch:!1};class yp{constructor(r,c,p=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Wd({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,p&&(this.mousePitch=new Hd({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(r,c){this.mouseRotate.mousedown(r,c),this.mousePitch&&this.mousePitch.mousedown(r,c),ce()}move(r,c){const p=this.map,_=this.mouseRotate.mousemoveWindow(r,c),x=_&&_.bearingDelta;if(x&&p.setBearing(p.getBearing()+x),this.mousePitch){const E=this.mousePitch.mousemoveWindow(r,c),I=E&&E.pitchDelta;I&&p.setPitch(p.getPitch()+I)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){me(),o.window.removeEventListener("mousemove",this.mousemove),o.window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(o.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),Y(this.element,r)),o.window.addEventListener("mousemove",this.mousemove),o.window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,Y(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ve(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=ve(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const xp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},bp={maxWidth:100,unit:"metric"};function wp(h,r,c){const p=fu(r),_=p/r,x={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[c];this._map._requestDomTask(()=>{this._container.style.width=h*_+"px",this._container.innerHTML=`${p}&nbsp;${x}`})}function fu(h){const r=Math.pow(10,`${Math.floor(h)}`.length-1);let c=h/r;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:c>=1?1:function(p){const _=Math.pow(10,Math.ceil(-Math.log(p)/Math.LN10));return Math.round(p*_)/_}(c),r*c}const Fl={version:o.version,supported:C,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends fp{constructor(h){if(o.LivePerformanceUtils.mark(o.PerformanceMarkers.create),(h=o.extend({},vp,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(h.antialias&&o.isSafariWithAntialiasingBug(o.window)&&(h.antialias=!1,o.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Rt(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),h),this._interactive=h.interactive,this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._useWebGL2=h.useWebGL2,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=h.crossSourceCollisions,this._collectResourceTiming=h.collectResourceTiming,this._optimizeForTerrain=h.optimizeForTerrain,this._language=this._parseLanguage(h.language),this._worldview=h.worldview,this._renderTaskQueue=new Ol,this._domRenderTaskQueue=new Ol,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.uniqueId(),this._locale=o.extend({},_p,h.locale),this._clickTolerance=h.clickTolerance,this._cooperativeGestures=h.cooperativeGestures,this._performanceMetricsCollection=h.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new gp(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new o.RequestManager(h.transformRequest,h.accessToken,h.testMode),this._silenceAuthErrors=!!h.testMode,typeof h.container=="string"){if(this._container=o.window.document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof o.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(this._container.childNodes.length>0&&o.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),h.maxBounds&&this.setMaxBounds(h.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1),o.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new hp(this,h),this._localFontFamily=h.localFontFamily,this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),h.projection&&this.setProjection(h.projection),this._hash=h.hash&&new Qf(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,o.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),h.attributionControl&&this.addControl(new Kd({customAttribution:h.customAttribution})),this._logoControl=new Jd,this.addControl(this._logoControl,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new o.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new o.Event(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(h,r){if(r===void 0&&(r=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=h.onAdd(this);this._controls.push(h);const p=this._controlPositions[r];return r.indexOf("bottom")!==-1?p.insertBefore(c,p.firstChild):p.appendChild(c),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(h);return r>-1&&this._controls.splice(r,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(h){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new o.Event("movestart",h)).fire(new o.Event("move",h)),this.fire(new o.Event("resize",h)),r&&this.fire(new o.Event("moveend",h)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(h){return this.transform.setMaxBounds(o.LngLatBounds.convert(h)),this._update()}setMinZoom(h){if((h=h==null?-2:h)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h?this.setZoom(h):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h==null?22:h)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h?this.setZoom(h):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h==null?0:h)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h?this.setPitch(h):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h==null?85:h)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h?this.setPitch(h):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(h){return h==="auto"?o.window.navigator.language:Array.isArray(h)?h.length===0?void 0:h.map(r=>r==="auto"?o.window.navigator.language:r):h}setLanguage(h){const r=this._parseLanguage(h);if(!this.style||r===this._language)return this;this._language=r,this.style._reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(h){return this.style&&h!==this._worldview?(this._worldview=h,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(h){return this._lazyInitEmptyStyle(),h?typeof h=="string"&&(h={name:h}):h=null,this._useExplicitProjection=!!h,this._prioritizeAndUpdateProjection(h,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const h=this.transform,r=h.projection.name;let c;r==="globe"&&h.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?(h.setMercatorFromTransition(),c=!0):r==="mercator"&&h.zoom<o.GLOBE_ZOOM_THRESHOLD_MAX&&(h.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(h,r){return this._updateProjection(h||r||{name:"mercator"})}_updateProjection(h){let r;if(r=h.name==="globe"&&this.transform.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(h),this.style.applyProjectionUpdate(),r){this.painter.clearBackgroundTiles();for(const c in this.style._sourceCaches)this.style._sourceCaches[c].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(h){return this.transform.locationPoint3D(o.LngLat.convert(h))}unproject(h){return this.transform.pointLocation3D(o.pointGeometry.convert(h))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(h,r,c){if(h==="mouseenter"||h==="mouseover"){let p=!1;const _=E=>{const I=r.filter(B=>this.getLayer(B)),k=I.length?this.queryRenderedFeatures(E.point,{layers:I}):[];k.length?p||(p=!0,c.call(this,new nr(h,this,E.originalEvent,{features:k}))):p=!1},x=()=>{p=!1};return{layers:new Set(r),listener:c,delegates:{mousemove:_,mouseout:x}}}if(h==="mouseleave"||h==="mouseout"){let p=!1;const _=E=>{const I=r.filter(k=>this.getLayer(k));(I.length?this.queryRenderedFeatures(E.point,{layers:I}):[]).length?p=!0:p&&(p=!1,c.call(this,new nr(h,this,E.originalEvent)))},x=E=>{p&&(p=!1,c.call(this,new nr(h,this,E.originalEvent)))};return{layers:new Set(r),listener:c,delegates:{mousemove:_,mouseout:x}}}{const p=_=>{const x=r.filter(I=>this.getLayer(I)),E=x.length?this.queryRenderedFeatures(_.point,{layers:x}):[];E.length&&(_.features=E,c.call(this,_),delete _.features)};return{layers:new Set(r),listener:c,delegates:{[h]:p}}}}on(h,r,c){if(c===void 0)return super.on(h,r);Array.isArray(r)||(r=[r]);const p=this._createDelegatedListener(h,r,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(p);for(const _ in p.delegates)this.on(_,p.delegates[_]);return this}once(h,r,c){if(c===void 0)return super.once(h,r);Array.isArray(r)||(r=[r]);const p=this._createDelegatedListener(h,r,c);for(const _ in p.delegates)this.once(_,p.delegates[_]);return this}off(h,r,c){if(c===void 0)return super.off(h,r);r=new Set(Array.isArray(r)?r:[r]);const p=(x,E)=>{if(x.size!==E.size)return!1;for(const I of x)if(!E.has(I))return!1;return!0},_=this._delegatedListeners?this._delegatedListeners[h]:void 0;return _&&(x=>{for(let E=0;E<x.length;E++){const I=x[E];if(I.listener===c&&p(I.layers,r)){for(const k in I.delegates)this.off(k,I.delegates[k]);return x.splice(E,1),this}}})(_),this}queryRenderedFeatures(h,r){return this.style?(r!==void 0||h===void 0||h instanceof o.pointGeometry||Array.isArray(h)||(r=h,h=void 0),this.style.queryRenderedFeatures(h=h||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}querySourceFeatures(h,r){return this.style.querySourceFeatures(h,r)}setStyle(h,r){return(r=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&h?(this._diffStyle(h,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(h,r))}_getUIString(h){const r=this._locale[h];if(r==null)throw new Error(`Missing UI string '${h}'`);return r}_updateStyle(h,r){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),h&&(this.style=new Wr(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof h=="string"?this.style.loadURL(h):this.style.loadJSON(h)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Wr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,r){if(typeof h=="string"){const c=this._requestManager.normalizeStyleURL(h),p=this._requestManager.transformRequest(c,o.ResourceType.Style);o.getJSON(p,(_,x)=>{_?this.fire(new o.ErrorEvent(_)):x&&this._updateDiff(x,r)})}else typeof h=="object"&&this._updateDiff(h,r)}_updateDiff(h,r){try{this.style.setState(h)&&this._update(!0)}catch(c){o.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(h,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.warnOnce("There is no style added to the map."),!1)}addSource(h,r){return this._lazyInitEmptyStyle(),this.style.addSource(h,r),this._update(!0)}isSourceLoaded(h){return!!this.style&&this.style._isSourceCacheLoaded(h)}areTilesLoaded(){const h=this.style&&this.style._sourceCaches;for(const r in h){const c=h[r]._tiles;for(const p in c){const _=c[p];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}addSourceType(h,r,c){this._lazyInitEmptyStyle(),this.style.addSourceType(h,r,c)}removeSource(h){return this.style.removeSource(h),this._updateTerrain(),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,r,{pixelRatio:c=1,sdf:p=!1,stretchX:_,stretchY:x,content:E}={}){if(this._lazyInitEmptyStyle(),r instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&r instanceof o.window.ImageBitmap){const{width:I,height:k,data:B}=o.exported.getImageData(r);this.style.addImage(h,{data:new o.RGBAImage({width:I,height:k},B),pixelRatio:c,stretchX:_,stretchY:x,content:E,sdf:p,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:k}=r,B=r;this.style.addImage(h,{data:new o.RGBAImage({width:I,height:k},new Uint8Array(B.data)),pixelRatio:c,stretchX:_,stretchY:x,content:E,sdf:p,version:0,userImage:B}),B.onAdd&&B.onAdd(this,h)}}updateImage(h,r){const c=this.style.getImage(h);if(!c)return void this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=r instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&r instanceof o.window.ImageBitmap?o.exported.getImageData(r):r,{width:_,height:x}=p;_!==void 0&&x!==void 0?_===c.data.width&&x===c.data.height?(c.data.replace(p.data,!(r instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&r instanceof o.window.ImageBitmap)),this.style.updateImage(h,c)):this.fire(new o.ErrorEvent(new Error(`The width and height of the updated image (${_}, ${x})
                must be that same as the previous version of the image
                (${c.data.width}, ${c.data.height})`))):this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,r){o.getImage(this._requestManager.transformRequest(h,o.ResourceType.Image),(c,p)=>{r(c,p instanceof o.window.HTMLImageElement?o.exported.getImageData(p):p)})}listImages(){return this.style.listImages()}addLayer(h,r){return this._lazyInitEmptyStyle(),this.style.addLayer(h,r),this._update(!0)}moveLayer(h,r){return this.style.moveLayer(h,r),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,r,c){return this.style.setLayerZoomRange(h,r,c),this._update(!0)}setFilter(h,r,c={}){return this.style.setFilter(h,r,c),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,r,c,p={}){return this.style.setPaintProperty(h,r,c,p),this._update(!0)}getPaintProperty(h,r){return this.style.getPaintProperty(h,r)}setLayoutProperty(h,r,c,p={}){return this.style.setLayoutProperty(h,r,c,p),this._update(!0)}getLayoutProperty(h,r){return this.style.getLayoutProperty(h,r)}setLight(h,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,r),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(h){return this._lazyInitEmptyStyle(),!h&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(h),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(h){return this._lazyInitEmptyStyle(),this.style.setFog(h),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(h){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.LngLat.convert(h),this.transform):0}setFeatureState(h,r){return this.style.setFeatureState(h,r),this._update()}removeFeatureState(h,r){return this.style.removeFeatureState(h,r),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}_updateContainerDimensions(){if(!this._container)return;const h=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let c,p,_,x=this._container;for(;x&&(!p||!_);){const E=o.window.getComputedStyle(x).transform;E&&E!=="none"&&(c=E.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&c[0]!=="0"&&c[0]!=="1"&&(p=c[0]),c[3]&&c[3]!=="0"&&c[3]!=="1"&&(_=c[3])),x=x.parentElement}this._containerWidth=p?Math.abs(h/p):h,this._containerHeight=_?Math.abs(r/_):r}_detectMissingCSS(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=D("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=D("div","mapboxgl-canvas-container",h);this._interactive&&r.classList.add("mapboxgl-interactive"),this._canvas=D("canvas","mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=D("div","mapboxgl-control-container",h),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{p[_]=D("div",`mapboxgl-ctrl-${_}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(h,r){const c=o.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(h),this._canvas.height=c*Math.ceil(r),this._canvas.style.width=`${h}px`,this._canvas.style.height=`${r}px`}_addMarker(h){this._markers.push(h)}_removeMarker(h){const r=this._markers.indexOf(h);r!==-1&&this._markers.splice(r,1)}_addPopup(h){this._popups.push(h)}_removePopup(h){const r=this._popups.indexOf(h);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const h=o.extend({},C.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._useWebGL2&&this._canvas.getContext("webgl2",h),c=r||this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);c?(this._useWebGL2&&!r&&o.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),o.storeAuthState(c,!0),this.painter=new Cl(c,this.transform,!!r),this.on("data",p=>{p.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.exported$1.testSupport(c)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_requestDomTask(h){!this.loaded()||this.loaded()&&!this.isMoving()?h():this._domRenderTaskQueue.add(h)}_render(h){let r;const c=this.painter.context.extTimerQuery,p=o.exported.now();if(this.listens("gpu-timing-frame")&&(r=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],o.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],o.window.performance.now())),this._renderTaskQueue.run(h),this._domRenderTaskQueue.run(h),this._removed)return;this._updateProjectionTransition();const _=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,k=this.transform.pitch,B=o.exported.now(),R=new o.EvaluationParameters(I,{now:B,fadeDuration:_,pitch:k,transition:this.style.getTransition()});this.style.update(R)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let x=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),x=this._updateAverageElevation(p),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):x=this._updateAverageElevation(p),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,_,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:_,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const I=o.exported.now()-p;c.endQueryEXT(c.TIME_ELAPSED_EXT,r),setTimeout(()=>{const k=c.getQueryObjectEXT(r,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(r),this.fire(new o.Event("gpu-timing-frame",{cpuTime:I,gpuTime:k})),o.window.performance.mark("frame-gpu",{startTime:p,detail:{gpuTime:k}})},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const k=this.painter.queryGpuTimers(I);this.fire(new o.Event("gpu-timing-layer",{layerTimes:k}))},50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const k=this.painter.queryGpuTimeDeferredRender(I);this.fire(new o.Event("gpu-timing-deferred-render",{gpuTime:k}))},50)}const E=this._sourcesDirty||this._styleDirty||this._placementDirty||x;if(E||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(x=this._updateAverageElevation(p,!0)),x)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new o.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const k=this._calculateSpeedIndex();this.fire(new o.Event("speedindexcompleted",{speedIndex:k})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||E||(this._fullyLoaded=!0,o.LivePerformanceUtils.mark(o.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&o.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(h){for(const r of this._markers)h&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!h||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(h,r=!1){const c=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);if((r||h-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(h)){const p=this.transform.averageElevation;let _=this.transform.sampleAverageElevation(),x=!1;this.transform.elevation&&(x=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(_)?_=0:this._averageElevationLastSampledAt=h;const E=Math.abs(p-_);if(E>1){if(this._isInitialLoad||x)return this._averageElevation.jumpTo(_),c(_);this._averageElevation.easeTo(_,h,300)}else if(E>1e-4)return this._averageElevation.jumpTo(_),c(_)}return!!this._averageElevation.isEasing(h)&&c(this._averageElevation.getValue(h))}_authenticate(){o.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,h=>{if(h&&(h.message===o.AUTH_ERR_MSG||h.status===401)){const r=this.painter.context.gl;o.storeAuthState(r,!1),this._logoControl instanceof Jd&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),o.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const h=this._isDragging();this.painter.updateTerrain(this.style,h)}_calculateSpeedIndex(){const h=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const c=this.painter.context.gl,p=c.createFramebuffer();function _(x){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,x,0);const E=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,E),E}return c.bindFramebuffer(c.FRAMEBUFFER,p),this._canvasPixelComparison(_(h),r.canvasCopies.map(_),r.timeStamps)}_canvasPixelComparison(h,r,c){let p=c[1]-c[0];const _=h.length/4;for(let x=0;x<r.length;x++){const E=r[x];let I=0;for(let k=0;k<E.length;k+=4)E[k]===h[k]&&E[k+1]===h[k+1]&&E[k+2]===h[k+2]&&E[k+3]===h[k+3]&&(I+=1);p+=(c[x+2]-c[x+1])*(1-I/_)}return p}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1),o.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),o.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(h){this._renderNextFrame=this._renderNextFrame||h,this.style&&!this._frame&&(this._frame=o.exported.frame(r=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(r)}))}_preloadTiles(h){const r=this.style?Object.values(this.style._sourceCaches):[];return o.asyncAll(r,(c,p)=>c._preloadTiles(h,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}_onVisibilityChange(){o.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(h){this._showTerrainWireframe!==h&&(this._showTerrainWireframe=h,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(h){this._speedIndexTiming!==h&&(this._speedIndexTiming=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(h){this._showTileAABBs!==h&&(this._showTileAABBs=h,h&&this._update())}_setCacheLimits(h,r){o.setCacheLimits(h,r)}get version(){return o.version}},NavigationControl:class{constructor(h){this.options=o.extend({},eh,h),this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),D("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),D("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:r}):c.resetNorth({},{originalEvent:r}))}),this._compassIcon=D("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map;if(!h)return;const r=h.getZoom(),c=r===h.getMaxZoom(),p=r===h.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const h=this._map;if(!h)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(h.transform.pitch*(Math.PI/180)),.5)}) rotateX(${h.transform.pitch}deg) rotateZ(${h.transform.angle*(180/Math.PI)}deg)`:`rotate(${h.transform.angle*(180/Math.PI)}deg)`;h._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),h.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&h.on("pitch",this._rotateCompassArrow),h.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new yp(h,this._compass,this.options.visualizePitch)),this._container}onRemove(){const h=this._map;h&&(this._container.remove(),this.options.showZoom&&h.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&h.off("pitch",this._rotateCompassArrow),h.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(h,r){const c=D("button",h,this._container);return c.type="button",c.addEventListener("click",r),c}_setButtonTitle(h,r){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${r}`);h.setAttribute("aria-label",c),h.firstElementChild&&h.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends o.Evented{constructor(h){super(),this.options=o.extend({geolocation:o.window.navigator.geolocation},xp,h),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Hr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(h){return this._map=h,this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(h){const r=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,h(c)};this._supportsGeolocation!==void 0?h(this._supportsGeolocation):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(c=>r(c.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(h){const r=this._map.getMaxBounds(),c=h.coords;return!!r&&(c.longitude<r.getWest()||c.longitude>r.getEast()||c.latitude<r.getSouth()||c.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",h)),this._finish()}}_updateCamera(h){const r=new o.LngLat(h.coords.longitude,h.coords.latitude),c=h.coords.accuracy,p=this._map.getBearing(),_=o.extend({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(c),_,{geolocateSource:!0})}_updateMarker(h){if(h){const r=new o.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map.transform,r=o.mercatorZfromAltitude(1,h._center.lat)*h.worldSize,c=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=D("button","mapboxgl-ctrl-geolocate",this._container),D("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D("div","mapboxgl-user-location"),this._dotElement.appendChild(D("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(D("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new hu({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=D("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new hu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}}_onDeviceOrientation(h){this._userLocationDotMarker&&(h.webkitCompassHeading?this._heading=h.webkitCompassHeading:h.absolute===!0&&(this._heading=-1*h.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(h={maximumAge:6e5,timeout:0},this._noTimeout=!0):(h=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,h),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const h=()=>{o.window.addEventListener("ondeviceorientationabsolute"in o.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};o.window.DeviceMotionEvent!==void 0&&typeof o.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&h()}).catch(console.error):h()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),o.window.removeEventListener("deviceorientation",this._onDeviceOrientation),o.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Kd,ScaleControl:class{constructor(h){this.options=o.extend({},bp,h),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=wp.bind(this)),o.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const h=this.options.maxWidth||100,r=this._map,c=r._containerHeight/2,p=r._containerWidth/2-h/2,_=r.unproject([p,c]),x=r.unproject([p+h,c]),E=_.distanceTo(x);if(this.options.unit==="imperial"){const I=3.2808*E;I>5280?this._setScale(h,I/5280,"mile"):this._setScale(h,I,"foot")}else this.options.unit==="nautical"?this._setScale(h,E/1852,"nautical-mile"):E>=1e3?this._setScale(h,E/1e3,"kilometer"):this._setScale(h,E,"meter")}_setScale(h,r,c){const p=fu(r),_=p/r;this._map._requestDomTask(()=>{this._container.style.width=h*_+"px",this._container.innerHTML=c!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:c}).format(p):`${p}&nbsp;nm`})}onAdd(h){return this._map=h,this._language=h.getLanguage(),this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(h){this._language=h,this._update()}setUnit(h){this.options.unit=h,this._update()}},FullscreenControl:class{constructor(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof o.window.HTMLElement?this._container=h.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in o.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!o.window.document.fullscreenEnabled&&!o.window.document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=D("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D("span","mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",h)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(o.window.document.fullscreenElement||o.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.Evented{constructor(h){super(),this.options=o.extend(Object.create(pp),h),o.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(h&&h.className?h.className.trim().split(/\s+/):[])}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&h.on("preclick",this._onClose),this.options.closeOnMove&&h.on("move",this._onClose),h.on("remove",this.remove),this._update(),h._addPopup(this),this._focusFirstElement(),this._trackPointer?(h.on("mousemove",this._onMouseEvent),h.on("mouseup",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")):h.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const h=this._map;return h&&(h.off("move",this._update),h.off("move",this._onClose),h.off("preclick",this._onClose),h.off("click",this._onClose),h.off("remove",this.remove),h.off("mousemove",this._onMouseEvent),h.off("mouseup",this._onMouseEvent),h.off("drag",this._onMouseEvent),h._canvasContainer&&h._canvasContainer.classList.remove("mapboxgl-track-pointer"),h._removePopup(this),this._map=void 0),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){this._lngLat=o.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const h=this._map;return h&&(h.off("move",this._update),h.on("mousemove",this._onMouseEvent),h.on("drag",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(o.window.document.createTextNode(h))}setHTML(h){const r=o.window.document.createDocumentFragment(),c=o.window.document.createElement("body");let p;for(c.innerHTML=h;p=c.firstChild,p;)r.appendChild(p);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=D("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(h),this.options.closeButton){const c=this._closeButton=D("button","mapboxgl-popup-close-button",r);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(h){return this._classList.add(h),this._updateClassList(),this}removeClassName(h){return this._classList.delete(h),this._updateClassList(),this}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){let r;return this._classList.delete(h)?r=!1:(this._classList.add(h),r=!0),this._updateClassList(),r}_onMouseEvent(h){this._update(h.point)}_getAnchor(h){if(this.options.anchor)return this.options.anchor;const r=this._map,c=this._container,p=this._pos;if(!r||!c||!p)return"bottom";const _=c.offsetWidth,x=c.offsetHeight,E=p.x<_/2,I=p.x>r.transform.width-_/2;if(p.y+h<x)return E?"top-left":I?"top-right":"top";if(p.y>r.transform.height-x){if(E)return"bottom-left";if(I)return"bottom-right"}return E?"left":I?"right":"bottom"}_updateClassList(){const h=this._container;if(!h)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),h.className=r.join(" ")}_update(h){const r=this._map,c=this._content;if(!r||!this._lngLat&&!this._trackPointer||!c)return;let p=this._container;if(p||(p=this._container=D("div","mapboxgl-popup",r.getContainer()),this._tip=D("div","mapboxgl-popup-tip",p),p.appendChild(c)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=du(this._lngLat,this._pos,r.transform)),!this._trackPointer||h){const _=this._pos=this._trackPointer&&h?h:r.project(this._lngLat),x=Qd(this.options.offset),E=this._anchor=this._getAnchor(x.y),I=Qd(this.options.offset,E),k=_.add(I).round();r._requestDomTask(()=>{this._container&&E&&(this._container.style.transform=`${Oa[E]} translate(${k.x}px,${k.y}px)`)})}if(!this._marker&&r._showingGlobe()){const _=o.isLngLatBehindGlobe(r.transform,this._lngLat)?0:1;this._setOpacity(_)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(mp);h&&h.focus()}_onClose(){this.remove()}_setOpacity(h){this._container&&(this._container.style.opacity=`${h}`),this._content&&(this._content.style.pointerEvents=h?"auto":"none")}},Marker:hu,Style:Wr,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,FreeCameraOptions:eu,Evented:o.Evented,config:o.config,prewarm:function(){cn().acquire(en)},clearPrewarmedResources:function(){const h=Yt;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(en),Yt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(h){o.config.ACCESS_TOKEN=h},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(h){o.config.API_URL=h},get workerCount(){return Jt.workerCount},set workerCount(h){Jt.workerCount=h},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){o.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){o.clearTileCache(h)},workerUrl:"",workerClass:null,setNow:o.exported.setNow,restoreNow:o.exported.restoreNow};return Fl});var b=m;return b})})(z2);const _c=z2.exports,Ci=Symbol(),qz=vn({__name:"Map",props:{accessToken:null,options:null},emits:["loaded"],setup(t,{expose:a,emit:l}){const d=t;_c.accessToken=d.accessToken;const m=Si(),v=Si(),b=Je(!1),o=ne(()=>v.value);return a({map:o}),ji(Ci,o),Ye(()=>{var w;return(w=d.options)==null?void 0:w.center},w=>{!v.value||!w||v.value.flyTo({center:w})}),Ye(()=>{var w;return(w=d.options)==null?void 0:w.zoom},w=>{!v.value||w===void 0||v.value.flyTo({zoom:w})}),Ye(()=>{var w;return(w=d.options)==null?void 0:w.pitch},w=>{!v.value||w===void 0||v.value.flyTo({pitch:w})}),Ye(()=>{var w;return(w=d.options)==null?void 0:w.bearing},w=>{!v.value||w===void 0||v.value.flyTo({bearing:w})}),Ye(()=>{var w;return(w=d.options)==null?void 0:w.bounds},w=>{!v.value||!w||v.value.fitBounds(w)}),Ye(()=>{var w;return(w=d.options)==null?void 0:w.maxZoom},w=>{!v.value||w===void 0||v.value.setMaxZoom(w)}),Ye(()=>{var w;return(w=d.options)==null?void 0:w.minZoom},w=>{!v.value||w===void 0||v.value.setMinZoom(w)}),Ye(()=>{var w;return(w=d.options)==null?void 0:w.maxBounds},w=>{!v.value||!w||v.value.setMaxBounds(w)}),Ye(()=>{var w;return(w=d.options)==null?void 0:w.maxPitch},w=>{!v.value||w===void 0||v.value.setMaxPitch(w)}),Ye(()=>{var w;return(w=d.options)==null?void 0:w.minPitch},w=>{!v.value||w===void 0||v.value.setMinPitch(w)}),Ye(()=>{var w;return(w=d.options)==null?void 0:w.style},w=>{var C;!v.value||!w||(w instanceof Object?(C=v.value)==null||C.setStyle(w,{diff:!0}):v.value.setStyle(w))}),Ye(()=>{var w;return(w=d.options)==null?void 0:w.projection},w=>{!v.value||v.value.setProjection(w)}),On(()=>{m.value&&(v.value=new _c.Map({container:m.value,style:"mapbox://styles/mapbox/streets-v11",center:[120,30],zoom:2,...d.options}),v.value.on("load",()=>{l("loaded"),b.value=!0}))}),mr(()=>{v.value&&v.value.remove()}),(w,C)=>(Zi(),ho(Rn,null,[xy("div",{ref_key:"mapRef",ref:m,style:{position:"absolute",height:"100%",width:"100%"}},null,512),b.value?my(w.$slots,"default",{key:0}):hk("",!0)],64))}}),Zz=vn({__name:"Sprite",props:{name:null,url:null},setup(t){const a=t,l=ln(Ci,void 0),d=()=>{if(!l)return;const m=l.value.hasImage(a.name);typeof a.url=="string"?l.value.loadImage(a.url,(v,b)=>{v||!b||(m?l.value.updateImage(a.name,b):l.value.addImage(a.name,b))}):m?l.value.updateImage(a.name,a.url):l.value.addImage(a.name,a.url)};return Ye(()=>a.url,d),On(d),mr(()=>{l&&l.value.hasImage(a.name)&&l.value.removeImage(a.name)}),(m,v)=>null}});function gm(t,a,l){const d=()=>{t.value&&t.value.removeEventListener(a,l)};Ye(t,m=>{d(),m&&m.addEventListener(a,l)}),Ei(()=>{d()})}function si(t,a,l,d){On(()=>{t.on(a,l,d)}),Ei(()=>{t.off(a,l,d)})}function D2(t,a,l){let d;const m=()=>{!d||d.disconnect()};Ye(t,v=>{m(),v&&(d=new MutationObserver(l),d.observe(v,a))}),mr(()=>{m()})}const Wz=vn({__name:"Marker",props:{center:null,options:null},emits:["click","mouseenter","mousemove","mouseleave","update:center"],setup(t,{emit:a}){const l=t,d=Si(),m=ln(Ci,void 0),v=Je(),b=()=>{if(!m||!l.center)return;const C=l.options||{};v.value.innerHTML&&(C.element=v.value),d.value=new _c.Marker(C).setLngLat(l.center),d.value.addTo(m.value),d.value.on("dragend",w)},o=()=>{!m||!d.value||(d.value.off("dragend",w),d.value.remove(),d.value=void 0)},w=()=>{if(!d.value)return;const{lng:C,lat:M}=d.value.getLngLat();a("update:center",[C,M])};return D2(v.value,{attributes:!0,childList:!0,subtree:!0},()=>{b()}),gm(ne(()=>{var C;return(C=d.value)==null?void 0:C.getElement()}),"click",C=>{a("click",C)}),gm(ne(()=>{var C;return(C=d.value)==null?void 0:C.getElement()}),"mouseenter",C=>{a("mouseenter",C)}),gm(ne(()=>{var C;return(C=d.value)==null?void 0:C.getElement()}),"mousemove",C=>{a("mousemove",C)}),gm(ne(()=>{var C;return(C=d.value)==null?void 0:C.getElement()}),"mouseleave",C=>{a("mouseleave",C)}),Ye(()=>l.center,()=>{l.center?d.value?d.value.setLngLat(l.center):b():o()}),Ye(()=>{var C;return(C=l.options)==null?void 0:C.offset},C=>{!d.value||!C||d.value.setOffset(C)}),Ye(()=>{var C;return(C=l.options)==null?void 0:C.draggable},C=>{!d.value||C===void 0||d.value.setDraggable(C)}),Ye(()=>{var C;return(C=l.options)==null?void 0:C.scale},()=>{!d.value||(o(),b())}),Ye(()=>{var C;return(C=l.options)==null?void 0:C.rotation},C=>{!d.value||C===void 0||d.value.setRotation(C)}),Ye(()=>{var C;return(C=l.options)==null?void 0:C.color},()=>{!d.value||(o(),b())}),Ye(()=>{var C;return(C=l.options)==null?void 0:C.anchor},()=>{!d.value||(o(),b())}),Ye(()=>{var C;return(C=l.options)==null?void 0:C.rotationAlignment},C=>{!d.value||!C||d.value.setRotationAlignment(C)}),Ye(()=>{var C;return(C=l.options)==null?void 0:C.pitchAlignment},C=>{var M;C&&((M=d.value)==null||M.setPitchAlignment(C))}),On(()=>{b()}),mr(()=>{o()}),(C,M)=>(Zi(),ho("div",{ref_key:"elRef",ref:v},[my(C.$slots,"default")],512))}}),Hz=vn({__name:"Popup",props:{visible:{type:Boolean},center:null,options:null},emits:["update:visible"],setup(t,{emit:a}){const l=t,d=ln(Ci,void 0),m=Si(),v=Je();D2(ne(()=>v.value),{attributes:!0,childList:!0,subtree:!0,characterData:!0},()=>{l.visible&&m.value&&v.value&&m.value.setHTML(v.value.innerHTML)});const b=()=>{!d||!l.center||!l.visible||!v.value||(m.value=new _c.Popup(l.options||{}).setLngLat(l.center).setHTML(v.value.innerHTML).addTo(d.value),m.value.on("close",w))},o=()=>{m.value&&(m.value.off("close",w),m.value.remove())};Ye(()=>l.visible,()=>{o(),l.visible&&b()}),Ye(()=>l.center,()=>{!d||!m.value||!l.visible||(l.center?m.value.setLngLat(l.center).addTo(d.value):o())}),Ye(()=>{var C;return(C=l.options)==null?void 0:C.anchor},C=>{!m.value||!l.visible||C&&(o(),b())}),Ye(()=>{var C;return(C=l.options)==null?void 0:C.offset},C=>{!m.value||!l.visible||C&&m.value.setOffset(C)}),Ye(()=>{var C;return(C=l.options)==null?void 0:C.maxWidth},C=>{!m.value||!l.visible||C&&m.value.setMaxWidth(C)});const w=()=>{a("update:visible",!1)};return On(()=>{b()}),mr(()=>{o()}),(C,M)=>(Zi(),ho("div",{style:{display:"none"},ref_key:"popupRef",ref:v},[my(C.$slots,"default")],512))}}),Xz=vn({__name:"Fog",props:{color:null,range:null},setup(t){const a=t,l=ln(Ci,void 0),d=()=>{if(!l)return;const m={};Object.keys(a).forEach(v=>{a[v]!==void 0&&(m[v]=a[v])}),l.value.setFog(m)};return Ye(()=>a.color,()=>d()),Ye(()=>a["horizon-blend"],()=>d()),Ye(()=>a["high-color"],()=>d()),Ye(()=>a["space-color"],()=>d()),Ye(()=>a["star-intensity"],()=>d()),Ye(()=>a.range,()=>d()),On(()=>{d()}),mr(()=>{!l||l.value.setFog()}),(m,v)=>null}}),Yz=vn({__name:"FeatureState",props:{feature:null,state:null},setup(t){const a=t,l=ln(Ci,void 0),d=(v,b)=>{!l||!v.id||l.value.setFeatureState(v,b)},m=v=>{!l||!v.id||l.value.removeFeatureState(v)};return Ye(()=>a.feature,(v,b)=>{m(b),d(v,a.state)}),Ye(()=>a.state,v=>{d(a.feature,v)}),On(()=>{d(a.feature,a.state)}),mr(()=>{m(a.feature)}),(v,b)=>null}}),Kz=vn({__name:"AttributionControl",props:{compact:{type:Boolean},customAttribution:null,position:null},setup(t){const a=t,l=Si(),d=ln(Ci,void 0);return On(()=>{!d||(l.value=new _c.AttributionControl({compact:a.compact||!1,customAttribution:a.customAttribution}),d.value.addControl(l.value,a.position||"bottom-right"))}),mr(()=>{!d||!l.value||d.value.removeControl(l.value)}),(m,v)=>null}}),Jz=vn({__name:"NavigationControl",props:{showCompass:{type:Boolean},showZoom:{type:Boolean},visualizePitch:{type:Boolean},position:null},setup(t){const a=t,l=Si(),d=ln(Ci,void 0);return On(()=>{!d||(l.value=new _c.NavigationControl({showCompass:a.showCompass||!0,showZoom:a.showZoom||!0,visualizePitch:a.visualizePitch||!1}),d.value.addControl(l.value,a.position||"top-left"))}),mr(()=>{!d||!l.value||d.value.removeControl(l.value)}),(m,v)=>null}}),Qz=vn({__name:"ScaleControl",props:{maxWidth:null,unit:null,position:null},setup(t){const a=t,l=Si(),d=ln(Ci,void 0);return Ye(()=>a.unit,()=>{a.unit&&l.value.setUnit(a.unit)}),On(()=>{var m;!d||(l.value=new _c.ScaleControl({maxWidth:(m=a.maxWidth)!=null?m:100,unit:a.unit||"metric"}),d.value.addControl(l.value,a.position||"top-right"))}),mr(()=>{!d||!l.value||d.value.removeControl(l.value)}),(m,v)=>null}});function or(t,a,l){for(const d in t)d in a&&t[d]===a[d]||l(d,t[d]);for(const d in a)d in t||l(d,void 0)}const eL=vn({__name:"BackgroundLayer",props:{id:null,sourceLayer:null,paint:null,layout:null},setup(t){const a=t,l=Si(),d=ln(Ci,void 0),m=(b,o)=>{!d||d.value.setPaintProperty(a.id,b,o)},v=(b,o)=>{!d||d.value.setLayoutProperty(a.id,b,o)};return Ye(()=>({...a.paint}),(b,o)=>{or(b,o,m)},{deep:!1}),Ye(()=>({...a.layout}),(b,o)=>{or(b,o,v)},{deep:!1}),On(()=>{!d||(d.value.addLayer({id:a.id,type:"background",paint:a.paint||{},layout:a.layout||{}},a.sourceLayer),l.value=d.value.getLayer(a.id))}),Ei(()=>{!d||!l.value||d.value.removeLayer(a.id)}),(b,o)=>null}}),tL=vn({__name:"CircleLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(t,{emit:a}){const l=t,d=Si(),m=ln(Ci,void 0);m!=null&&m.value&&(si(m.value,"click",l.id,w=>{a("click",w)}),si(m.value,"mouseenter",l.id,w=>{a("mouseenter",w)}),si(m.value,"mousemove",l.id,w=>{a("mousemove",w)}),si(m.value,"mouseleave",l.id,w=>{a("mouseleave",w)}));const v=(w,C)=>{!m||!d.value||m.value.setPaintProperty(l.id,w,C)},b=(w,C)=>{!m||!d.value||m.value.setLayoutProperty(l.id,w,C)},o=()=>{var w,C;!m||!d.value||m.value.setLayerZoomRange(l.id,(w=l.minzoom)!=null?w:0,(C=l.maxzoom)!=null?C:24)};return Ye(()=>({...l.paint}),(w,C)=>{or(w,C,v)},{deep:!1}),Ye(()=>({...l.layout}),(w,C)=>{or(w,C,b)},{deep:!1}),Ye(()=>l.minzoom,o),Ye(()=>l.maxzoom,o),Ye(()=>l.filter,()=>{!m||!d.value||m.value.setFilter(l.id,l.filter)}),On(()=>{var w,C;if(!m)return;const M={type:"circle",id:l.id,source:l.source,paint:l.paint||{},layout:l.layout||{},minzoom:(w=l.minzoom)!=null?w:0,maxzoom:(C=l.maxzoom)!=null?C:24};l.filter&&(M.filter=l.filter),l.sourceLayer&&(M["source-layer"]=l.sourceLayer),m.value.addLayer(M),d.value=m.value.getLayer(l.id)}),Ei(()=>{!m||!d.value||m.value.removeLayer(l.id)}),(w,C)=>null}}),nL=vn({__name:"FillExtrusionLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(t,{emit:a}){const l=t,d=Si(),m=ln(Ci,void 0);m&&(si(m.value,"click",l.id,w=>{a("click",w)}),si(m.value,"mouseenter",l.id,w=>{a("mouseenter",w)}),si(m.value,"mousemove",l.id,w=>{a("mousemove",w)}),si(m.value,"mouseleave",l.id,w=>{a("mouseleave",w)}));const v=(w,C)=>{!m||!d.value||m.value.setPaintProperty(l.id,w,C)},b=(w,C)=>{!m||!d.value||m.value.setLayoutProperty(l.id,w,C)},o=()=>{var w,C;!m||!d.value||m.value.setLayerZoomRange(l.id,(w=l.minzoom)!=null?w:0,(C=l.maxzoom)!=null?C:24)};return Ye(()=>({...l.paint}),(w,C)=>{or(w,C,v)},{deep:!1}),Ye(()=>({...l.layout}),(w,C)=>{or(w,C,b)},{deep:!1}),Ye(()=>l.minzoom,o),Ye(()=>l.maxzoom,o),Ye(()=>l.filter,()=>{!m||!d.value||m.value.setFilter(l.id,l.filter)}),On(()=>{var w,C;if(!m)return;const M={type:"fill-extrusion",id:l.id,source:l.source,paint:l.paint||{},layout:l.layout||{},minzoom:(w=l.minzoom)!=null?w:0,maxzoom:(C=l.maxzoom)!=null?C:24};l.filter&&(M.filter=l.filter),l.sourceLayer&&(M["source-layer"]=l.sourceLayer),m.value.addLayer(M),d.value=m.value.getLayer(l.id)}),Ei(()=>{!m||!d.value||m.value.removeLayer(l.id)}),(w,C)=>null}}),iL=vn({__name:"FillLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(t,{emit:a}){const l=t,d=Si(),m=ln(Ci,void 0);m&&(si(m.value,"click",l.id,w=>{a("click",w)}),si(m.value,"mouseenter",l.id,w=>{a("mouseenter",w)}),si(m.value,"mousemove",l.id,w=>{a("mousemove",w)}),si(m.value,"mouseleave",l.id,w=>{a("mouseleave",w)}));const v=(w,C)=>{!m||!d.value||m.value.setPaintProperty(l.id,w,C)},b=(w,C)=>{!m||!d.value||m.value.setLayoutProperty(l.id,w,C)},o=()=>{var w,C;!m||!d.value||m.value.setLayerZoomRange(l.id,(w=l.minzoom)!=null?w:0,(C=l.maxzoom)!=null?C:24)};return Ye(()=>({...l.paint}),(w,C)=>{or(w,C,v)},{deep:!1}),Ye(()=>({...l.layout}),(w,C)=>{or(w,C,b)},{deep:!1}),Ye(()=>l.minzoom,o),Ye(()=>l.maxzoom,o),Ye(()=>l.filter,()=>{!m||!d.value||m.value.setFilter(l.id,l.filter)}),On(()=>{var w,C;if(!m)return;const M={type:"fill",id:l.id,source:l.source,paint:l.paint||{},layout:l.layout||{},minzoom:(w=l.minzoom)!=null?w:0,maxzoom:(C=l.maxzoom)!=null?C:24};l.filter&&(M.filter=l.filter),l.sourceLayer&&(M["source-layer"]=l.sourceLayer),m.value.addLayer(M),d.value=m.value.getLayer(l.id)}),Ei(()=>{!m||!d.value||m.value.removeLayer(l.id)}),(w,C)=>null}}),rL=vn({__name:"HeatmapLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(t,{emit:a}){const l=t,d=Si(),m=ln(Ci,void 0);m&&(si(m.value,"click",l.id,w=>{a("click",w)}),si(m.value,"mouseenter",l.id,w=>{a("mouseenter",w)}),si(m.value,"mousemove",l.id,w=>{a("mousemove",w)}),si(m.value,"mouseleave",l.id,w=>{a("mouseleave",w)}));const v=(w,C)=>{!m||!d.value||m.value.setPaintProperty(l.id,w,C)},b=(w,C)=>{!m||!d.value||m.value.setLayoutProperty(l.id,w,C)},o=()=>{var w,C;!m||!d.value||m.value.setLayerZoomRange(l.id,(w=l.minzoom)!=null?w:0,(C=l.maxzoom)!=null?C:24)};return Ye(()=>({...l.paint}),(w,C)=>{or(w,C,v)},{deep:!1}),Ye(()=>({...l.layout}),(w,C)=>{or(w,C,b)},{deep:!1}),Ye(()=>l.minzoom,o),Ye(()=>l.maxzoom,o),Ye(()=>l.filter,()=>{!m||!d.value||m.value.setFilter(l.id,l.filter)}),On(()=>{var w,C;if(!m)return;const M={type:"heatmap",id:l.id,source:l.source,paint:l.paint||{},layout:l.layout||{},minzoom:(w=l.minzoom)!=null?w:0,maxzoom:(C=l.maxzoom)!=null?C:24};l.filter&&(M.filter=l.filter),l.sourceLayer&&(M["source-layer"]=l.sourceLayer),m.value.addLayer(M),d.value=m.value.getLayer(l.id)}),Ei(()=>{!m||!d.value||m.value.removeLayer(l.id)}),(w,C)=>null}}),oL=vn({__name:"HillshadeLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(t,{emit:a}){const l=t,d=Si(),m=ln(Ci,void 0);m&&(si(m.value,"click",l.id,w=>{a("click",w)}),si(m.value,"mouseenter",l.id,w=>{a("mouseenter",w)}),si(m.value,"mousemove",l.id,w=>{a("mousemove",w)}),si(m.value,"mouseleave",l.id,w=>{a("mouseleave",w)}));const v=(w,C)=>{!m||!d.value||m.value.setPaintProperty(l.id,w,C)},b=(w,C)=>{!m||!d.value||m.value.setLayoutProperty(l.id,w,C)},o=()=>{var w,C;!m||!d.value||m.value.setLayerZoomRange(l.id,(w=l.minzoom)!=null?w:0,(C=l.maxzoom)!=null?C:24)};return Ye(()=>({...l.paint}),(w,C)=>{or(w,C,v)},{deep:!1}),Ye(()=>({...l.layout}),(w,C)=>{or(w,C,b)},{deep:!1}),Ye(()=>l.minzoom,o),Ye(()=>l.maxzoom,o),Ye(()=>l.filter,()=>{!m||!d.value||m.value.setFilter(l.id,l.filter)}),On(()=>{var w,C;if(!m)return;const M={type:"hillshade",id:l.id,source:l.source,paint:l.paint||{},layout:l.layout||{},minzoom:(w=l.minzoom)!=null?w:0,maxzoom:(C=l.maxzoom)!=null?C:24};l.filter&&(M.filter=l.filter),l.sourceLayer&&(M["source-layer"]=l.sourceLayer),m.value.addLayer(M),d.value=m.value.getLayer(l.id)}),Ei(()=>{!m||!d.value||m.value.removeLayer(l.id)}),(w,C)=>null}}),sL=vn({__name:"LineLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(t,{emit:a}){const l=t,d=Si(),m=ln(Ci,void 0);m&&(si(m.value,"click",l.id,w=>{a("click",w)}),si(m.value,"mouseenter",l.id,w=>{a("mouseenter",w)}),si(m.value,"mousemove",l.id,w=>{a("mousemove",w)}),si(m.value,"mouseleave",l.id,w=>{a("mouseleave",w)}));const v=(w,C)=>{!m||!d.value||m.value.setPaintProperty(l.id,w,C)},b=(w,C)=>{!m||!d.value||m.value.setLayoutProperty(l.id,w,C)},o=()=>{var w,C;!m||!d.value||m.value.setLayerZoomRange(l.id,(w=l.minzoom)!=null?w:0,(C=l.maxzoom)!=null?C:24)};return Ye(()=>({...l.paint}),(w,C)=>{or(w,C,v)},{deep:!1}),Ye(()=>({...l.layout}),(w,C)=>{or(w,C,b)},{deep:!1}),Ye(()=>l.minzoom,o),Ye(()=>l.maxzoom,o),Ye(()=>l.filter,()=>{!m||!d.value||m.value.setFilter(l.id,l.filter)}),On(()=>{var w,C;if(!m)return;const M={type:"line",id:l.id,source:l.source,paint:l.paint||{},layout:l.layout||{},minzoom:(w=l.minzoom)!=null?w:0,maxzoom:(C=l.maxzoom)!=null?C:24};l.filter&&(M.filter=l.filter),l.sourceLayer&&(M["source-layer"]=l.sourceLayer),m.value.addLayer(M),d.value=m.value.getLayer(l.id)}),Ei(()=>{m&&d.value&&m.value.removeLayer(l.id)}),(w,C)=>null}}),aL=vn({__name:"RasterLayer",props:{id:null,source:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(t,{emit:a}){const l=t,d=Si(),m=ln(Ci,void 0);m&&(si(m.value,"click",l.id,w=>{a("click",w)}),si(m.value,"mouseenter",l.id,w=>{a("mouseenter",w)}),si(m.value,"mousemove",l.id,w=>{a("mousemove",w)}),si(m.value,"mouseleave",l.id,w=>{a("mouseleave",w)}));const v=(w,C)=>{!m||!d.value||m.value.setPaintProperty(l.id,w,C)},b=(w,C)=>{!m||!d.value||m.value.setLayoutProperty(l.id,w,C)},o=()=>{var w,C;!m||!d.value||m.value.setLayerZoomRange(l.id,(w=l.minzoom)!=null?w:0,(C=l.maxzoom)!=null?C:24)};return Ye(()=>({...l.paint}),(w,C)=>{or(w,C,v)},{deep:!1}),Ye(()=>({...l.layout}),(w,C)=>{or(w,C,b)},{deep:!1}),Ye(()=>l.minzoom,o),Ye(()=>l.maxzoom,o),Ye(()=>l.filter,()=>{!m||!d.value||m.value.setFilter(l.id,l.filter)}),On(()=>{var w,C;if(!m)return;const M={type:"raster",id:l.id,source:l.source,paint:l.paint||{},layout:l.layout||{},minzoom:(w=l.minzoom)!=null?w:0,maxzoom:(C=l.maxzoom)!=null?C:24};l.filter&&(M.filter=l.filter),m.value.addLayer(M),d.value=m.value.getLayer(l.id)}),Ei(()=>{!m||!d.value||m.value.removeLayer(l.id)}),(w,C)=>null}}),lL=vn({__name:"SymbolLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(t,{emit:a}){const l=t,d=Si(),m=ln(Ci,void 0);m&&(si(m.value,"click",l.id,w=>{a("click",w)}),si(m.value,"mouseenter",l.id,w=>{a("mouseenter",w)}),si(m.value,"mousemove",l.id,w=>{a("mousemove",w)}),si(m.value,"mouseleave",l.id,w=>{a("mouseleave",w)}));const v=(w,C)=>{!m||!d.value||m.value.setPaintProperty(l.id,w,C)},b=(w,C)=>{!m||!d.value||m.value.setLayoutProperty(l.id,w,C)},o=()=>{var w,C;!m||!d.value||m.value.setLayerZoomRange(l.id,(w=l.minzoom)!=null?w:0,(C=l.maxzoom)!=null?C:24)};return Ye(()=>({...l.paint}),(w,C)=>{or(w,C,v)},{deep:!1}),Ye(()=>({...l.layout}),(w,C)=>{or(w,C,b)},{deep:!1}),Ye(()=>l.minzoom,o),Ye(()=>l.maxzoom,o),Ye(()=>l.filter,()=>{!m||!d.value||m.value.setFilter(l.id,l.filter)}),On(()=>{var w,C;if(!m)return;const M={type:"symbol",id:l.id,source:l.source,paint:l.paint||{},layout:l.layout||{},minzoom:(w=l.minzoom)!=null?w:0,maxzoom:(C=l.maxzoom)!=null?C:24};l.filter&&(M.filter=l.filter),l.sourceLayer&&(M["source-layer"]=l.sourceLayer),m.value.addLayer(M),d.value=m.value.getLayer(l.id)}),Ei(()=>{!m||!d.value||m.value.removeLayer(l.id)}),(w,C)=>null}}),cL=vn({__name:"SkyLayer",props:{id:null,paint:null,layout:null},setup(t){const a=t,l=Si(),d=ln(Ci,void 0),m=(b,o)=>{!d||d.value.setPaintProperty(a.id,b,o)},v=(b,o)=>{!d||d.value.setLayoutProperty(a.id,b,o)};return Ye(()=>({...a.paint}),(b,o)=>{or(b,o,m)},{deep:!1}),Ye(()=>({...a.layout}),(b,o)=>{or(b,o,v)},{deep:!1}),On(()=>{!d||(d.value.addLayer({id:a.id,type:"sky",paint:a.paint||{},layout:a.layout||{}}),l.value=d.value.getLayer(a.id))}),Ei(()=>{!d||!l.value||d.value.removeLayer(a.id)}),(b,o)=>null}}),uL=vn({__name:"GeoSource",props:{id:null,data:null,attribution:null,buffer:null,cluster:{type:Boolean},clusterMaxZoom:null,clusterMinPoints:null,clusterProperties:null,clusterRadius:null,filter:{type:[Boolean,Array,null]},generateId:{type:Boolean},lineMetrics:{type:Boolean},maxzoom:null,protomteId:null,tolerance:null},setup(t){const a=t,l=Si(),d=ln(Ci,void 0);return Ye(()=>a.data,m=>{!d||!m||!l.value||l.value.setData(m)},{deep:!0}),On(()=>{if(!d)return;const m={type:"geojson",data:a.data};a.buffer!==void 0&&(m.buffer=a.buffer),a.generateId&&(m.generateId=a.generateId),a.lineMetrics&&(m.lineMetrics=a.lineMetrics),a.maxzoom!==void 0&&(m.maxzoom=a.maxzoom),a.tolerance!==void 0&&(m.tolerance=a.tolerance),a.filter&&(m.filter=a.filter),a.attribution&&(m.attribution=a.attribution),a.protomteId&&(m.promoteId=a.protomteId),a.cluster&&(m.cluster=a.cluster,a.clusterMaxZoom&&(m.clusterMaxZoom=a.clusterMaxZoom),a.clusterMinPoints&&(m.clusterMinPoints=a.clusterMinPoints),a.clusterProperties&&(m.clusterProperties=a.clusterProperties),a.clusterRadius&&(m.clusterRadius=a.clusterRadius)),d.value.addSource(a.id,m),l.value=d.value.getSource(a.id)}),mr(()=>{!d||!l.value||d.value.removeSource(a.id)}),(m,v)=>null}}),dL=vn({__name:"RasterSource",props:{id:null,url:null,tiles:null,tileSize:null,scheme:null,attribution:null,bounds:null,minzoom:null,maxzoom:null},setup(t){const a=t,l=Si(),d=ln(Ci,void 0),m=()=>{!d||(d.value.style._sourceCaches[`other:${a.id}`].clearTiles(),d.value.style._sourceCaches[`other:${a.id}`].update(d.value.transform),d.value.triggerRepaint())};return Ye(()=>a.url,v=>{!v||!l.value||(l.value.url=v,m())}),Ye(()=>a.tiles,v=>{a.url||!v||!l.value||(l.value.tiles=v,m())}),On(()=>{if(!d)return;const v={id:a.id,type:"raster",scheme:a.scheme||"xyz",tileSize:a.tileSize||256,attribution:a.attribution||"",bounds:a.bounds||[-180,-85.051129,180,85.051129],minzoom:a.minzoom||0,maxzoom:a.maxzoom||22};a.tiles&&(v.tiles=a.tiles),a.url&&(delete v.tiles,v.url=a.url),(v.url||v.tiles)&&(d.value.addSource(a.id,v),l.value=d.value.getSource(a.id))}),mr(()=>{!d||!l.value||d.value.removeSource(a.id)}),(v,b)=>null}}),hL=vn({__name:"RasterDemSource",props:{id:null,url:null,tiles:null,tileSize:null,attribution:null,bounds:null,minzoom:null,maxzoom:null,exaggeration:null,encoding:null,volatile:{type:Boolean}},setup(t){const a=t,l=Si(),d=ln(Ci,void 0);return On(()=>{if(!d)return;const m={id:a.id,type:"raster-dem",tileSize:a.tileSize||256,attribution:a.attribution||"",bounds:a.bounds||[-180,-85.051129,180,85.051129],minzoom:a.minzoom||0,maxzoom:a.maxzoom||22};a.tiles&&(m.tiles=a.tiles),a.url&&(delete m.tiles,m.url=a.url),(m.url||m.tiles)&&(d.value.addSource(a.id,m),l.value=d.value.getSource(a.id),d.value.setTerrain({source:a.id,exaggeration:a.exaggeration||1}))}),mr(()=>{!d||!l.value||(d.value.setTerrain(),d.value.removeSource(a.id))}),(m,v)=>null}}),fL=vn({__name:"VectorSource",props:{id:null,url:null,tiles:null,promoteId:null,scheme:null,attribution:null,bounds:null,minzoom:null,maxzoom:null,volatile:{type:Boolean}},setup(t){const a=t,l=Si(),d=ln(Ci,void 0);return Ye(()=>a.url,m=>{m&&l.value.setUrl(m)}),Ye(()=>a.tiles,m=>{m&&!a.url&&l.value.setTiles(m)}),On(()=>{if(!d)return;const m={id:a.id,type:"vector",scheme:a.scheme||"xyz",attribution:a.attribution||"",bounds:a.bounds||[-180,-85.051129,180,85.051129],minzoom:a.minzoom||0,maxzoom:a.maxzoom||22};a.promoteId&&(m.promoteId=a.promoteId),a.tiles&&(m.tiles=a.tiles),a.url&&(delete m.tiles,m.url=a.url),(m.url||m.tiles)&&(d.value.addSource(a.id,m),l.value=d.value.getSource(a.id))}),mr(()=>{!d||!l.value||d.value.removeSource(a.id)}),(m,v)=>null}}),pL=vn({__name:"ImageSource",props:{id:null,url:null,coordinates:null},setup(t){const a=t,l=Si(),d=ln(Ci,void 0),m=()=>{!l.value||l.value.updateImage({url:a.url,coordinates:a.coordinates})};return Ye(()=>a.url,m),Ye(()=>a.coordinates,m),On(()=>{!d||(d.value.addSource(a.id,{type:"image",url:a.url,coordinates:a.coordinates}),l.value=d.value.getSource(a.id))}),mr(()=>{!d||!l.value||d.value.removeSource(a.id)}),(v,b)=>null}}),mL=vn({__name:"VideoSource",props:{id:null,urls:null,coordinates:null,playing:{type:Boolean}},setup(t){const a=t,l=Si(),d=ln(Ci,void 0),m=()=>{!d||!l.value||l.value.setCoordinates(a.coordinates)},v=()=>{a.playing?l.value.play():l.value.pause()};return Ye(()=>a.coordinates,m),Ye(()=>a.playing,v),On(()=>{!d||(d.value.addSource(a.id,{type:"video",urls:a.urls,coordinates:a.coordinates}),l.value=d.value.getSource(a.id),v())}),mr(()=>{!d||!l.value||d.value.removeSource(a.id)}),(b,o)=>null}}),gL=vn({__name:"CanvasSource",props:{id:null,animate:{type:Boolean},coordinates:null},setup(t,{expose:a}){const l=t,d=Je(),m=Si(),v=ln(Ci,void 0);return a({canvas:d}),Ye(()=>l.coordinates,b=>{m.value.setCoordinates(b)}),Ye(()=>l.animate,()=>{l.animate?m.value.play():m.value.pause()}),On(()=>{v&&(v.value.addSource(l.id,{type:"canvas",canvas:d.value,animate:l.animate||!1,coordinates:l.coordinates}),m.value=v.value.getSource(l.id))}),mr(()=>{v&&m.value&&v.value.removeSource(l.id)}),(b,o)=>(Zi(),ho("canvas",{style:{display:"none"},ref_key:"canvasRef",ref:d,height:"400",width:"400"},null,512))}}),_L={install:t=>{t.component("v-map",qz),t.component("v-sprite",Zz),t.component("v-marker",Wz),t.component("v-popup",Hz),t.component("v-fog",Xz),t.component("v-feature-state",Yz),t.component("v-attribution-control",Kz),t.component("v-navigation-control",Jz),t.component("v-scale-control",Qz),t.component("v-background-layer",eL),t.component("v-circle-layer",tL),t.component("v-fillextrusion-layer",nL),t.component("v-fill-layer",iL),t.component("v-heatmap-layer",rL),t.component("v-hillshade-layer",oL),t.component("v-line-layer",sL),t.component("v-raster-layer",aL),t.component("v-symbol-layer",lL),t.component("v-sky-layer",cL),t.component("v-geo-source",uL),t.component("v-vector-source",fL),t.component("v-raster-source",dL),t.component("v-rasterdem-source",hL),t.component("v-image-source",pL),t.component("v-video-source",mL),t.component("v-canvas-source",gL)}};const Bv=Symbol.for("vuetify:display"),Yb={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},vL=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yb;return la(Yb,t)};function Kb(t){return ki&&!t?window.innerWidth:0}function Jb(t){return ki&&!t?window.innerHeight:0}function yL(){const t=ki?window.navigator.userAgent:"ssr";function a(q){return Boolean(t.match(q))}const l=a(/android/i),d=a(/iphone|ipad|ipod/i),m=a(/cordova/i),v=a(/electron/i),b=a(/chrome/i),o=a(/edge/i),w=a(/firefox/i),C=a(/opera/i),M=a(/win/i),L=a(/mac/i),D=a(/linux/i),V=a(/ssr/i);return{android:l,ios:d,cordova:m,electron:v,chrome:b,edge:o,firefox:w,opera:C,win:M,mac:L,linux:D,touch:OP,ssr:V}}function xL(t,a){const{thresholds:l,mobileBreakpoint:d}=vL(t),m=Je(Jb(a)),v=yL(),b=pi({}),o=Je(Kb(a));function w(){m.value=Jb(),o.value=Kb()}return Ms(()=>{const C=o.value<l.sm,M=o.value<l.md&&!C,L=o.value<l.lg&&!(M||C),D=o.value<l.xl&&!(L||M||C),V=o.value<l.xxl&&!(D||L||M||C),q=o.value>=l.xxl,X=C?"xs":M?"sm":L?"md":D?"lg":V?"xl":"xxl",xe=typeof d=="number"?d:l[d],ce=v.ssr?v.android||v.ios||v.opera:o.value<xe;b.xs=C,b.sm=M,b.md=L,b.lg=D,b.xl=V,b.xxl=q,b.smAndUp=!C,b.mdAndUp=!(C||M),b.lgAndUp=!(C||M||L),b.xlAndUp=!(C||M||L||D),b.smAndDown=!(L||D||V||q),b.mdAndDown=!(D||V||q),b.lgAndDown=!(V||q),b.xlAndDown=!q,b.name=X,b.height=m.value,b.width=o.value,b.mobile=ce,b.mobileBreakpoint=d,b.platform=v,b.thresholds=l}),ki&&window.addEventListener("resize",w,{passive:!0}),{...ly(b),update:w}}function ag(){const t=ln(Bv);if(!t)throw new Error("Could not find Vuetify display injection");return t}function B2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:a,...l}=t,d=la(a,l),{aliases:m={},components:v={},directives:b={}}=d,o=LP(d.defaults),w=xL(d.display,d.ssr),C=JP(d.theme),M=sz(d.icons),L=yz(d.locale);return{install:V=>{for(const q in b)V.directive(q,b[q]);for(const q in v)V.component(q,v[q]);for(const q in m)V.component(q,Pt({...m[q],name:q,aliasName:m[q].name}));if(C.install(V),V.provide(cf,o),V.provide(Bv,w),V.provide(hf,C),V.provide(Pv,M),V.provide(Ku,L),ki&&d.ssr){const{mount:q}=V;V.mount=function(){const X=q(...arguments);return Gi(()=>w.update()),V.mount=q,X}}Ur.reset(),V.mixin({computed:{$vuetify(){return pi({defaults:Vh.call(this,cf),display:Vh.call(this,Bv),theme:Vh.call(this,hf),icons:Vh.call(this,Pv),locale:Vh.call(this,Ku)})}}})},defaults:o,display:w,theme:C,icons:M,locale:L}}const bL="3.0.0";B2.version=bL;function Vh(t){var v;var a,l;const d=this.$,m=(v=(a=d.parent)==null?void 0:a.provides)!=null?v:(l=d.vnode.appContext)==null?void 0:l.provides;if(m&&t in m)return m[t]}const wL=Pt({name:"VApp",props:{...t2({fullHeight:!0}),...Xn()},setup(t,a){let{slots:l}=a;const d=yi(t),{layoutClasses:m,layoutStyles:v,getLayoutItem:b,items:o,layoutRef:w}=n2(t),{rtlClasses:C}=ha();return kt(()=>{var M;return O("div",{ref:w,class:["v-application",d.themeClasses.value,m.value,C.value],style:v.value},[O("div",{class:"v-application__wrap"},[(M=l.default)==null?void 0:M.call(l)])])}),{getLayoutItem:b,items:o,theme:d}}});function po(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top center 0",l=arguments.length>2?arguments[2]:void 0;return Pt({name:t,props:{group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:{type:String,default:l},origin:{type:String,default:a}},setup(d,m){let{slots:v}=m;return()=>{const b=d.group?Gk:ks;return zs(b,{name:t,mode:d.mode,onBeforeEnter(o){o.style.transformOrigin=d.origin},onLeave(o){if(d.leaveAbsolute){const{offsetTop:w,offsetLeft:C,offsetWidth:M,offsetHeight:L}=o;o._transitionInitialStyles={position:o.style.position,top:o.style.top,left:o.style.left,width:o.style.width,height:o.style.height},o.style.position="absolute",o.style.top=`${w}px`,o.style.left=`${C}px`,o.style.width=`${M}px`,o.style.height=`${L}px`}d.hideOnLeave&&o.style.setProperty("display","none","important")},onAfterLeave(o){if(d.leaveAbsolute&&o!=null&&o._transitionInitialStyles){const{position:w,top:C,left:M,width:L,height:D}=o._transitionInitialStyles;delete o._transitionInitialStyles,o.style.position=w||"",o.style.top=C||"",o.style.left=M||"",o.style.width=L||"",o.style.height=D||""}}},v.default)}}})}function R2(t,a){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"in-out";return Pt({name:t,props:{mode:{type:String,default:l}},setup(d,m){let{slots:v}=m;return()=>zs(ks,{name:t,...a},v.default)}})}function O2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const l=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?"width":"height",d=Mo(`offset-${l}`);return{onBeforeEnter(b){b._parent=b.parentNode,b._initialStyle={transition:b.style.transition,overflow:b.style.overflow,[l]:b.style[l]}},onEnter(b){const o=b._initialStyle;b.style.setProperty("transition","none","important"),b.style.overflow="hidden";const w=`${b[d]}px`;b.style[l]="0",b.offsetHeight,b.style.transition=o.transition,t&&b._parent&&b._parent.classList.add(t),requestAnimationFrame(()=>{b.style[l]=w})},onAfterEnter:v,onEnterCancelled:v,onLeave(b){b._initialStyle={transition:"",overflow:b.style.overflow,[l]:b.style[l]},b.style.overflow="hidden",b.style[l]=`${b[d]}px`,b.offsetHeight,requestAnimationFrame(()=>b.style[l]="0")},onAfterLeave:m,onLeaveCancelled:m};function m(b){t&&b._parent&&b._parent.classList.remove(t),v(b)}function v(b){const o=b._initialStyle[l];b.style.overflow=b._initialStyle.overflow,o!=null&&(b.style[l]=o),delete b._initialStyle}}const lg=Pt({name:"VDialogTransition",props:{target:Object},setup(t,a){let{slots:l}=a;const d={onBeforeEnter(m){m.style.pointerEvents="none",m.style.visibility="hidden"},async onEnter(m,v){var b;await new Promise(V=>requestAnimationFrame(V)),await new Promise(V=>requestAnimationFrame(V)),m.style.visibility="";const{x:o,y:w,sx:C,sy:M,speed:L}=ew(t.target,m),D=uc(m,[{transform:`translate(${o}px, ${w}px) scale(${C}, ${M})`,opacity:0},{transform:""}],{duration:225*L,easing:BP});(b=Qb(m))==null||b.forEach(V=>{uc(V,[{opacity:0},{opacity:0,offset:.33},{opacity:1}],{duration:225*2*L,easing:uf})}),D.finished.then(()=>v())},onAfterEnter(m){m.style.removeProperty("pointer-events")},onBeforeLeave(m){m.style.pointerEvents="none"},async onLeave(m,v){var b;await new Promise(V=>requestAnimationFrame(V));const{x:o,y:w,sx:C,sy:M,speed:L}=ew(t.target,m);uc(m,[{transform:""},{transform:`translate(${o}px, ${w}px) scale(${C}, ${M})`,opacity:0}],{duration:125*L,easing:RP}).finished.then(()=>v()),(b=Qb(m))==null||b.forEach(V=>{uc(V,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*L,easing:uf})})},onAfterLeave(m){m.style.removeProperty("pointer-events")}};return()=>t.target?O(ks,nn({name:"dialog-transition"},d,{css:!1}),l):O(ks,{name:"dialog-transition"},l)}});function Qb(t){var a;const l=(a=t.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:a.children;return l&&[...l]}function ew(t,a){const l=t.getBoundingClientRect(),d=Ey(a),[m,v]=getComputedStyle(a).transformOrigin.split(" ").map(ce=>parseFloat(ce)),[b,o]=getComputedStyle(a).getPropertyValue("--v-overlay-anchor-origin").split(" ");let w=l.left+l.width/2;b==="left"||o==="left"?w-=l.width/2:(b==="right"||o==="right")&&(w+=l.width/2);let C=l.top+l.height/2;b==="top"||o==="top"?C-=l.height/2:(b==="bottom"||o==="bottom")&&(C+=l.height/2);const M=l.width/d.width,L=l.height/d.height,D=Math.max(1,M,L),V=M/D,q=L/D,X=d.width*d.height/(window.innerWidth*window.innerHeight),xe=X>.12?Math.min(1.5,(X-.12)*10+1):1;return{x:w-(m+d.left),y:C-(v+d.top),sx:V,sy:q,speed:xe}}const TL=po("fab-transition","center center","out-in"),SL=po("dialog-bottom-transition"),EL=po("dialog-top-transition"),Rv=po("fade-transition"),F2=po("scale-transition"),CL=po("scroll-x-transition"),IL=po("scroll-x-reverse-transition"),AL=po("scroll-y-transition"),kL=po("scroll-y-reverse-transition"),ML=po("slide-x-transition"),PL=po("slide-x-reverse-transition"),Uy=po("slide-y-transition"),zL=po("slide-y-reverse-transition"),cg=R2("expand-transition",O2()),jy=R2("expand-x-transition",O2("",!0));function LL(t){return{aspectStyles:ne(()=>{const a=Number(t.aspectRatio);return a?{paddingBottom:String(1/a*100)+"%"}:void 0})}}const V2=Pt({name:"VResponsive",props:{aspectRatio:[String,Number],contentClass:String,...es()},setup(t,a){let{slots:l}=a;const{aspectStyles:d}=LL(t),{dimensionStyles:m}=ts(t);return kt(()=>{var v;return O("div",{class:"v-responsive",style:m.value},[O("div",{class:"v-responsive__sizer",style:d.value},null),(v=l.additional)==null?void 0:v.call(l),l.default&&O("div",{class:["v-responsive__content",t.contentClass]},[l.default()])])}),{}}});function DL(t,a){if(!ky)return;const l=a.modifiers||{},d=a.value,{handler:m,options:v}=typeof d=="object"?d:{handler:d,options:{}},b=new IntersectionObserver(function(){var o;let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],C=arguments.length>1?arguments[1]:void 0;const M=(o=t._observe)==null?void 0:o[a.instance.$.uid];if(!M)return;const L=w.some(D=>D.isIntersecting);m&&(!l.quiet||M.init)&&(!l.once||L||M.init)&&m(L,w,C),L&&l.once?$2(t,a):M.init=!0},v);t._observe=Object(t._observe),t._observe[a.instance.$.uid]={init:!1,observer:b},b.observe(t)}function $2(t,a){var l;const d=(l=t._observe)==null?void 0:l[a.instance.$.uid];!d||(d.observer.unobserve(t),delete t._observe[a.instance.$.uid])}const N2={mounted:DL,unmounted:$2},ug=N2,fa=Mn({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:t=>t!==!0}},"transition"),As=(t,a)=>{let{slots:l}=a;const{transition:d,...m}=t,{component:v=ks,...b}=typeof d=="object"?d:{};return zs(v,nn(typeof d=="string"?{name:d}:b,m),l)},ld=Pt({name:"VImg",directives:{intersect:ug},props:{aspectRatio:[String,Number],alt:String,cover:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},srcset:String,width:[String,Number],...fa()},emits:{loadstart:t=>!0,load:t=>!0,error:t=>!0},setup(t,a){let{emit:l,slots:d}=a;const m=Je(""),v=Je(),b=Je(t.eager?"loading":"idle"),o=Je(),w=Je(),C=ne(()=>t.src&&typeof t.src=="object"?{src:t.src.src,srcset:t.srcset||t.src.srcset,lazySrc:t.lazySrc||t.src.lazySrc,aspect:Number(t.aspectRatio||t.src.aspect)}:{src:t.src,srcset:t.srcset,lazySrc:t.lazySrc,aspect:Number(t.aspectRatio||0)}),M=ne(()=>C.value.aspect||o.value/w.value||0);Ye(()=>t.src,()=>{L(b.value!=="idle")}),Km(()=>L());function L(fe){if(!(t.eager&&fe)&&!(ky&&!fe&&!t.eager)){if(b.value="loading",C.value.lazySrc){const ge=new Image;ge.src=C.value.lazySrc,X(ge,null)}!C.value.src||Gi(()=>{var ge,Ee;if(l("loadstart",((ge=v.value)==null?void 0:ge.currentSrc)||C.value.src),(Ee=v.value)!=null&&Ee.complete){if(v.value.naturalWidth||V(),b.value==="error")return;M.value||X(v.value,null),D()}else M.value||X(v.value),q()})}}function D(){var fe;q(),b.value="loaded",l("load",((fe=v.value)==null?void 0:fe.currentSrc)||C.value.src)}function V(){var fe;b.value="error",l("error",((fe=v.value)==null?void 0:fe.currentSrc)||C.value.src)}function q(){const fe=v.value;fe&&(m.value=fe.currentSrc||fe.src)}function X(fe){let ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const Ee=()=>{const{naturalHeight:we,naturalWidth:Oe}=fe;we||Oe?(o.value=Oe,w.value=we):!fe.complete&&b.value==="loading"&&ge!=null?setTimeout(Ee,ge):(fe.currentSrc.endsWith(".svg")||fe.currentSrc.startsWith("data:image/svg+xml"))&&(o.value=1,w.value=1)};Ee()}const xe=ne(()=>({"v-img__img--cover":t.cover,"v-img__img--contain":!t.cover})),ce=()=>{var fe;if(!C.value.src||b.value==="idle")return null;const ge=O("img",{class:["v-img__img",xe.value],src:C.value.src,srcset:C.value.srcset,alt:"",sizes:t.sizes,ref:v,onLoad:D,onError:V},null),Ee=(fe=d.sources)==null?void 0:fe.call(d);return O(As,{transition:t.transition,appear:!0},{default:()=>[qi(Ee?O("picture",{class:"v-img__picture"},[Ee,ge]):ge,[[Ls,b.value==="loaded"]])]})},me=()=>O(As,{transition:t.transition},{default:()=>[C.value.lazySrc&&b.value!=="loaded"&&O("img",{class:["v-img__img","v-img__img--preload",xe.value],src:C.value.lazySrc,alt:""},null)]}),ee=()=>d.placeholder?O(As,{transition:t.transition,appear:!0},{default:()=>[(b.value==="loading"||b.value==="error"&&!d.error)&&O("div",{class:"v-img__placeholder"},[d.placeholder()])]}):null,Ie=()=>d.error?O(As,{transition:t.transition,appear:!0},{default:()=>[b.value==="error"&&O("div",{class:"v-img__error"},[d.error()])]}):null,Y=()=>t.gradient?O("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${t.gradient})`}},null):null,ve=Je(!1);{const fe=Ye(M,ge=>{ge&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{ve.value=!0})}),fe())})}return kt(()=>qi(O(V2,{class:["v-img",{"v-img--booting":!ve.value}],style:{width:Xt(t.width==="auto"?o.value:t.width)},aspectRatio:M.value,"aria-label":t.alt,role:t.alt?"img":void 0},{additional:()=>O(Rn,null,[O(ce,null,null),O(me,null,null),O(Y,null,null),O(ee,null,null),O(Ie,null,null)]),default:d.default}),[[uo("intersect"),{handler:L,options:t.options},null,{once:!0}]])),{currentSrc:m,image:v,state:b,naturalWidth:o,naturalHeight:w}}}),$m=Mi()({name:"VToolbarTitle",props:{text:String,...Sn()},setup(t,a){let{slots:l}=a;return kt(()=>{var d;const m=!!(l.default||l.text||t.text);return O(t.tag,{class:"v-toolbar-title"},{default:()=>[m&&O("div",{class:"v-toolbar-title__placeholder"},[l.text?l.text():t.text,(d=l.default)==null?void 0:d.call(l)])]})}),{}}}),BL=[null,"prominent","default","comfortable","compact"],U2=Mn({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:t=>BL.includes(t)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...fo(),...sr(),...Pi(),...Sn({tag:"header"}),...Xn()},"v-toolbar"),Nm=Mi()({name:"VToolbar",props:U2(),setup(t,a){var l;let{slots:d}=a;const{backgroundColorClasses:m,backgroundColorStyles:v}=Yi(Tt(t,"color")),{borderClasses:b}=Lo(t),{elevationClasses:o}=Mr(t),{roundedClasses:w}=Ki(t),{themeClasses:C}=yi(t),M=Je(!!(t.extended||(l=d.extension)!=null&&l.call(d))),L=ne(()=>parseInt(Number(t.height)+(t.density==="prominent"?Number(t.height):0)-(t.density==="comfortable"?8:0)-(t.density==="compact"?16:0),10)),D=ne(()=>M.value?parseInt(Number(t.extensionHeight)+(t.density==="prominent"?Number(t.extensionHeight):0)-(t.density==="comfortable"?4:0)-(t.density==="compact"?8:0),10):0);return rr({VBtn:{variant:"text"}}),kt(()=>{var V,q,X,xe,ce;const me=!!(t.title||d.title),ee=!!(d.image||t.image),Ie=(V=d.extension)==null?void 0:V.call(d);return M.value=!!(t.extended||Ie),O(t.tag,{class:["v-toolbar",{"v-toolbar--absolute":t.absolute,"v-toolbar--collapse":t.collapse,"v-toolbar--flat":t.flat,"v-toolbar--floating":t.floating,[`v-toolbar--density-${t.density}`]:!0},m.value,b.value,o.value,w.value,C.value],style:[v.value]},{default:()=>[ee&&O("div",{key:"image",class:"v-toolbar__image"},[O(Ti,{defaults:{VImg:{cover:!0,src:t.image}}},{default:()=>[d.image?(q=d.image)==null?void 0:q.call(d):O(ld,null,null)]})]),O("div",{class:"v-toolbar__content",style:{height:Xt(L.value)}},[d.prepend&&O("div",{class:"v-toolbar__prepend"},[(X=d.prepend)==null?void 0:X.call(d)]),me&&O($m,{key:"title",text:t.title},{text:d.title}),(xe=d.default)==null?void 0:xe.call(d),d.append&&O("div",{class:"v-toolbar__append"},[(ce=d.append)==null?void 0:ce.call(d)])]),O(cg,null,{default:()=>[M.value&&O("div",{class:"v-toolbar__extension",style:{height:Xt(D.value)}},[Ie])]})]})}),{contentHeight:L,extensionHeight:D}}});function RL(t){var a;return Po(t,Object.keys((a=Nm==null?void 0:Nm.props)!=null?a:{}))}const OL=Pt({name:"VAppBar",props:{modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:t=>["top","bottom"].includes(t)},...U2(),...nd(),height:{type:[Number,String],default:64}},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=Je(),m=Tn(t,"modelValue"),v=ne(()=>{var L,D;var o,w;const C=(L=(o=d.value)==null?void 0:o.contentHeight)!=null?L:0,M=(D=(w=d.value)==null?void 0:w.extensionHeight)!=null?D:0;return C+M}),{layoutItemStyles:b}=id({id:t.name,order:ne(()=>parseInt(t.order,10)),position:Tt(t,"location"),layoutSize:v,elementSize:v,active:m,absolute:Tt(t,"absolute")});return kt(()=>{const[o]=RL(t);return O(Nm,nn({ref:d,class:["v-app-bar",{"v-app-bar--bottom":t.location==="bottom"}],style:{...b.value,height:void 0}},o),l)}),{}}}),FL=Pt({name:"VAppBarNavIcon",props:{icon:{type:pn,default:"$menu"}},setup(t,a){let{slots:l}=a;return kt(()=>O(pr,{class:"v-app-bar-nav-icon",icon:t.icon},l)),{}}}),VL=Pt({name:"VToolbarItems",props:Do({variant:"text"}),setup(t,a){let{slots:l}=a;return rr({VBtn:{color:Tt(t,"color"),height:"inherit",variant:Tt(t,"variant")}}),kt(()=>{var d;return O("div",{class:"v-toolbar-items"},[(d=l.default)==null?void 0:d.call(l)])}),{}}}),$L=Pt({name:"VAppBarTitle",props:{...$m.props},setup(t,a){let{slots:l}=a;return kt(()=>O($m,{class:"v-app-bar-title"},l)),{}}});const j2=zo("v-alert-title"),NL=["success","info","warning","error"],UL=Pt({name:"VAlert",props:{border:{type:[Boolean,String],validator:t=>typeof t=="boolean"||["top","end","bottom","start"].includes(t)},borderColor:String,closable:Boolean,closeIcon:{type:pn,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:t=>NL.includes(t)},...gr(),...es(),...sr(),...Cc(),...od(),...Pi(),...Sn(),...Xn(),...Do({variant:"flat"})},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=Tn(t,"modelValue"),m=ne(()=>{var Ie;if(t.icon!==!1)return t.type?(Ie=t.icon)!=null?Ie:`$${t.type}`:t.icon}),v=ne(()=>{var Ie;return{color:(Ie=t.color)!=null?Ie:t.type,variant:t.variant}}),{themeClasses:b}=yi(t),{colorClasses:o,colorStyles:w,variantClasses:C}=Ec(v),{densityClasses:M}=jr(t),{dimensionStyles:L}=ts(t),{elevationClasses:D}=Mr(t),{locationStyles:V}=Ic(t),{positionClasses:q}=sd(t),{roundedClasses:X}=Ki(t),{textColorClasses:xe,textColorStyles:ce}=no(Tt(t,"borderColor")),{t:me}=ns(),ee=ne(()=>({"aria-label":me(t.closeLabel),onClick(Ie){d.value=!1}}));return()=>{var Ie,Y;const ve=!!(l.prepend||m.value),fe=!!(l.title||t.title),ge=!!(t.text||l.text),Ee=!!(l.close||t.closable);return d.value&&O(t.tag,{class:["v-alert",t.border&&{"v-alert--border":!!t.border,[`v-alert--border-${t.border===!0?"start":t.border}`]:!0},{"v-alert--prominent":t.prominent},b.value,o.value,M.value,D.value,q.value,X.value,C.value],style:[w.value,L.value,V.value],role:"alert"},{default:()=>[Sc(!1,"v-alert"),t.border&&O("div",{key:"border",class:["v-alert__border",xe.value],style:ce.value},null),ve&&O(Ti,{key:"prepend",defaults:{VIcon:{density:t.density,icon:m.value,size:t.prominent?44:28}}},{default:()=>[O("div",{class:"v-alert__prepend"},[l.prepend?l.prepend():m.value&&O(er,null,null)])]}),O("div",{class:"v-alert__content"},[fe&&O(j2,{key:"title"},{default:()=>[l.title?l.title():t.title]}),ge&&(l.text?l.text():t.text),(Ie=l.default)==null?void 0:Ie.call(l)]),l.append&&O("div",{key:"append",class:"v-alert__append"},[l.append()]),Ee&&O(Ti,{key:"close",defaults:{VBtn:{icon:t.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var we;return[O("div",{class:"v-alert__close"},[(we=(Y=l.close)==null?void 0:Y.call(l,{props:ee.value}))!=null?we:O(pr,ee.value,null)])]}})]})}}});const G2=Pt({name:"VMessages",props:{active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},...fa({transition:{component:Uy,leaveAbsolute:!0,group:!0}})},setup(t,a){let{slots:l}=a;const d=ne(()=>ko(t.messages)),{textColorClasses:m,textColorStyles:v}=no(ne(()=>t.color));return kt(()=>O(As,{transition:t.transition,tag:"div",class:["v-messages",m.value],style:v.value},{default:()=>[t.active&&d.value.map((b,o)=>O("div",{class:"v-messages__message",key:`${o}-${d.value}`},[l.message?l.message({message:b}):b]))]})),{}}}),q2=Symbol.for("vuetify:form"),jL=Mn({disabled:Boolean,fastFail:Boolean,lazyValidation:Boolean,readonly:Boolean,modelValue:{type:Boolean,default:null},validateOn:{type:String,default:"input"}},"form");function GL(t){const a=Tn(t,"modelValue"),l=ne(()=>t.disabled),d=ne(()=>t.readonly),m=Je(!1),v=Je([]),b=Je([]);async function o(){const M=[];let L=!0;b.value=[],m.value=!0;for(const D of v.value){const V=await D.validate();if(V.length>0&&(L=!1,M.push({id:D.id,errorMessages:V})),!L&&t.fastFail)break}return b.value=M,m.value=!1,{valid:L,errors:b.value}}function w(){v.value.forEach(M=>M.reset()),a.value=null}function C(){v.value.forEach(M=>M.resetValidation()),b.value=[],a.value=null}return Ye(v,()=>{let M=0,L=0;const D=[];for(const V of v.value)V.isValid===!1?(L++,D.push({id:V.id,errorMessages:V.errorMessages})):V.isValid===!0&&M++;b.value=D,a.value=L>0?!1:M===v.value.length?!0:null},{deep:!0}),ji(q2,{register:M=>{let{id:L,validate:D,reset:V,resetValidation:q}=M;v.value.some(X=>X.id===L)&&mc(`Duplicate input name "${L}"`),v.value.push({id:L,validate:D,reset:V,resetValidation:q,isValid:null,errorMessages:[]})},unregister:M=>{v.value=v.value.filter(L=>L.id!==M)},update:(M,L,D)=>{const V=v.value.find(q=>q.id===M);!V||(V.isValid=L,V.errorMessages=D)},isDisabled:l,isReadonly:d,isValidating:m,items:v,validateOn:Tt(t,"validateOn")}),{errors:b,isDisabled:l,isReadonly:d,isValidating:m,items:v,validate:o,reset:w,resetValidation:C}}function qL(){return ln(q2,null)}const dg=Mn({focused:Boolean},"focus");function Ac(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ua();const l=Tn(t,"focused"),d=ne(()=>({[`${a}--focused`]:l.value}));function m(){l.value=!0}function v(){l.value=!1}return{focusClasses:d,isFocused:l,focus:m,blur:v}}const Z2=Mn({disabled:Boolean,error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:Boolean,rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...dg()},"validation");function W2(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ua(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ur();const d=Tn(t,"modelValue"),m=ne(()=>t.validationValue===void 0?d.value:t.validationValue),v=qL(),b=Je([]),o=Je(!0),w=ne(()=>!!(ko(d.value===""?null:d.value).length||ko(m.value===""?null:m.value).length)),C=ne(()=>!!(t.disabled||v!=null&&v.isDisabled.value)),M=ne(()=>!!(t.readonly||v!=null&&v.isReadonly.value)),L=ne(()=>t.errorMessages.length?ko(t.errorMessages):b.value),D=ne(()=>t.error||L.value.length?!1:t.rules.length&&o.value?null:!0),V=Je(!1),q=ne(()=>({[`${a}--error`]:D.value===!1,[`${a}--dirty`]:w.value,[`${a}--disabled`]:C.value,[`${a}--readonly`]:M.value})),X=ne(()=>{var Ie;return(Ie=t.name)!=null?Ie:Ui(l)});Km(()=>{v==null||v.register({id:X.value,validate:ee,reset:ce,resetValidation:me})}),Ei(()=>{v==null||v.unregister(X.value)});const xe=ne(()=>t.validateOn||(v==null?void 0:v.validateOn.value)||"input");On(()=>v==null?void 0:v.update(X.value,D.value,L.value)),df(()=>xe.value==="input",()=>{Ye(m,()=>{if(m.value!=null)ee();else if(t.focused){const Ie=Ye(()=>t.focused,Y=>{Y||ee(),Ie()})}})}),df(()=>xe.value==="blur",()=>{Ye(()=>t.focused,Ie=>{Ie||ee()})}),Ye(D,()=>{v==null||v.update(X.value,D.value,L.value)});function ce(){me(),d.value=null}function me(){o.value=!0,b.value=[]}async function ee(){const Ie=[];V.value=!0;for(const Y of t.rules){if(Ie.length>=(t.maxErrors||1))break;const fe=await(typeof Y=="function"?Y:()=>Y)(m.value);if(fe!==!0){if(typeof fe!="string"){console.warn(`${fe} is not a valid value. Rule functions must return boolean true or a string.`);continue}Ie.push(fe)}}return b.value=Ie,V.value=!1,o.value=!1,b.value}return{errorMessages:L,isDirty:w,isDisabled:C,isReadonly:M,isPristine:o,isValid:D,isValidating:V,reset:ce,resetValidation:me,validate:ee,validationClasses:q}}function H2(t){const{t:a}=ns();function l(d){var w;let{name:m}=d;const v={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[m],b=t[`onClick:${m}`],o=b&&v?a(`$vuetify.input.${v}`,(w=t.label)!=null?w:""):void 0;return O(er,{icon:t[`${m}Icon`],"aria-label":o,onClick:b},null)}return{InputIcon:l}}const pa=Mn({id:String,appendIcon:pn,prependIcon:pn,hideDetails:[Boolean,String],messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:t=>["horizontal","vertical"].includes(t)},"onClick:prepend":Kh,"onClick:append":Kh,...gr(),...Z2()},"VInput"),Ds=Mi()({name:"VInput",props:{...pa()},emits:{"update:modelValue":t=>!0},setup(t,a){let{attrs:l,slots:d,emit:m}=a;const{densityClasses:v}=jr(t),{InputIcon:b}=H2(t),o=Ur(),w=ne(()=>t.id||`input-${o}`),{errorMessages:C,isDirty:M,isDisabled:L,isReadonly:D,isPristine:V,isValid:q,isValidating:X,reset:xe,resetValidation:ce,validate:me,validationClasses:ee}=W2(t,"v-input",w),Ie=ne(()=>({id:w,isDirty:M,isDisabled:L,isReadonly:D,isPristine:V,isValid:q,isValidating:X,reset:xe,resetValidation:ce,validate:me}));return kt(()=>{var Y,ve,fe,ge,Ee;const we=!!(d.prepend||t.prependIcon),Oe=!!(d.append||t.appendIcon),ze=!!((Y=t.messages)!=null&&Y.length||C.value.length),Qe=!t.hideDetails||t.hideDetails==="auto"&&(ze||!!d.details);return O("div",{class:["v-input",`v-input--${t.direction}`,v.value,ee.value]},[we&&O("div",{key:"prepend",class:"v-input__prepend"},[(ve=d.prepend)==null?void 0:ve.call(d,Ie.value),t.prependIcon&&O(b,{key:"prepend-icon",name:"prepend"},null)]),d.default&&O("div",{class:"v-input__control"},[(fe=d.default)==null?void 0:fe.call(d,Ie.value)]),Oe&&O("div",{key:"append",class:"v-input__append"},[t.appendIcon&&O(b,{key:"append-icon",name:"append"},null),(ge=d.append)==null?void 0:ge.call(d,Ie.value)]),Qe&&O("div",{class:"v-input__details"},[O(G2,{active:ze,messages:C.value.length>0?C.value:t.messages},{message:d.message}),(Ee=d.details)==null?void 0:Ee.call(d,Ie.value)])])}),{reset:xe,resetValidation:ce,validate:me}}});function al(t){const a=Object.keys(Ds.props).filter(l=>!OT(l));return Po(t,a)}const cd=Pt({name:"VLabel",props:{text:String,clickable:Boolean,...Xn()},setup(t,a){let{slots:l}=a;return kt(()=>{var d;return O("label",{class:["v-label",{"v-label--clickable":t.clickable}]},[t.text,(d=l.default)==null?void 0:d.call(l)])}),{}}});const X2=Symbol.for("vuetify:selection-control-group"),Gy=Mn({color:String,disabled:Boolean,error:Boolean,id:String,inline:Boolean,falseIcon:pn,trueIcon:pn,ripple:{type:Boolean,default:!0},multiple:{type:Boolean,default:null},name:String,readonly:Boolean,modelValue:null,type:String,valueComparator:{type:Function,default:yf},...Xn(),...gr()},"VSelectionControlGroup"),Y2=Pt({name:"VSelectionControlGroup",props:{defaultsTarget:{type:String,default:"VSelectionControl"},...Gy()},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=Tn(t,"modelValue"),m=Ur(),v=ne(()=>t.id||`v-selection-control-group-${m}`),b=ne(()=>t.name||v.value);return ji(X2,{modelValue:d}),rr({[t.defaultsTarget]:{color:Tt(t,"color"),disabled:Tt(t,"disabled"),density:Tt(t,"density"),error:Tt(t,"error"),inline:Tt(t,"inline"),modelValue:d,multiple:ne(()=>!!t.multiple||t.multiple==null&&Array.isArray(d.value)),name:b,falseIcon:Tt(t,"falseIcon"),trueIcon:Tt(t,"trueIcon"),readonly:Tt(t,"readonly"),ripple:Tt(t,"ripple"),type:Tt(t,"type"),valueComparator:Tt(t,"valueComparator")}}),kt(()=>{var o;return O("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":t.inline}],"aria-labelled-by":t.type==="radio"?v.value:void 0,role:t.type==="radio"?"radiogroup":void 0},[(o=l.default)==null?void 0:o.call(l)])}),{}}}),hg=Mn({label:String,trueValue:null,falseValue:null,value:null,...Gy()},"VSelectionControl");function ZL(t){const a=ln(X2,void 0),{densityClasses:l}=jr(t),d=Tn(t,"modelValue"),m=ne(()=>t.trueValue!==void 0?t.trueValue:t.value!==void 0?t.value:!0),v=ne(()=>t.falseValue!==void 0?t.falseValue:!1),b=ne(()=>!!t.multiple||t.multiple==null&&Array.isArray(d.value)),o=ne({get(){const L=a?a.modelValue.value:d.value;return b.value?L.some(D=>t.valueComparator(D,m.value)):t.valueComparator(L,m.value)},set(L){if(t.readonly)return;const D=L?m.value:v.value;let V=D;b.value&&(V=L?[...ko(d.value),D]:ko(d.value).filter(q=>!t.valueComparator(q,m.value))),a?a.modelValue.value=V:d.value=V}}),{textColorClasses:w,textColorStyles:C}=no(ne(()=>o.value&&!t.error&&!t.disabled?t.color:void 0)),M=ne(()=>o.value?t.trueIcon:t.falseIcon);return{group:a,densityClasses:l,trueValue:m,falseValue:v,model:o,textColorClasses:w,textColorStyles:C,icon:M}}const bf=Mi()({name:"VSelectionControl",directives:{Ripple:sl},inheritAttrs:!1,props:hg(),emits:{"update:modelValue":t=>!0},setup(t,a){let{attrs:l,slots:d}=a;const{densityClasses:m,icon:v,model:b,textColorClasses:o,textColorStyles:w,trueValue:C}=ZL(t),M=Ur(),L=ne(()=>t.id||`input-${M}`),D=Je(!1),V=Je(!1),q=Je();function X(me){D.value=!0,(!Mv||Mv&&me.target.matches(":focus-visible"))&&(V.value=!0)}function xe(){D.value=!1,V.value=!1}function ce(me){b.value=me.target.checked}return kt(()=>{var me,ee;const Ie=d.label?d.label({label:t.label,props:{for:L.value}}):t.label,[Y,ve]=bc(l);return O("div",nn({class:["v-selection-control",{"v-selection-control--dirty":b.value,"v-selection-control--disabled":t.disabled,"v-selection-control--error":t.error,"v-selection-control--focused":D.value,"v-selection-control--focus-visible":V.value,"v-selection-control--inline":t.inline},m.value]},Y),[O("div",{class:["v-selection-control__wrapper",o.value],style:w.value},[(me=d.default)==null?void 0:me.call(d),qi(O("div",{class:["v-selection-control__input"]},[v.value&&O(er,{key:"icon",icon:v.value},null),O("input",nn({ref:q,checked:b.value,disabled:t.disabled,id:L.value,onBlur:xe,onFocus:X,onInput:ce,"aria-readonly":t.readonly,type:t.type,value:C.value,name:t.name,"aria-checked":t.type==="checkbox"?b.value:void 0},ve),null),(ee=d.input)==null?void 0:ee.call(d,{model:b,textColorClasses:o,textColorStyles:w,props:{onFocus:X,onBlur:xe,id:L.value}})]),[[uo("ripple"),t.ripple&&[!t.disabled&&!t.readonly,null,["center","circle"]]]])]),Ie&&O(cd,{for:L.value,clickable:!0},{default:()=>[Ie]})])}),{isFocused:D,input:q}}});function K2(t){return Po(t,Object.keys(bf.props))}const J2=Mn({indeterminate:Boolean,indeterminateIcon:{type:pn,default:"$checkboxIndeterminate"},...hg({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),ud=Pt({name:"VCheckboxBtn",props:J2(),emits:{"update:modelValue":t=>!0,"update:indeterminate":t=>!0},setup(t,a){let{slots:l}=a;const d=Tn(t,"indeterminate"),m=Tn(t,"modelValue");function v(w){d.value&&(d.value=!1)}const b=ne(()=>t.indeterminate?t.indeterminateIcon:t.falseIcon),o=ne(()=>t.indeterminate?t.indeterminateIcon:t.trueIcon);return kt(()=>O(bf,nn(t,{modelValue:m.value,"onUpdate:modelValue":[w=>m.value=w,v],class:"v-checkbox-btn",type:"checkbox",inline:!0,falseIcon:b.value,trueIcon:o.value,"aria-checked":t.indeterminate?"mixed":void 0}),l)),{}}});function WL(t){return Po(t,Object.keys(ud.props))}const HL=Pt({name:"VCheckbox",inheritAttrs:!1,props:{...pa(),...J2()},emits:{"update:focused":t=>!0},setup(t,a){let{attrs:l,slots:d}=a;const{isFocused:m,focus:v,blur:b}=Ac(t),o=Ur(),w=ne(()=>t.id||`checkbox-${o}`);return kt(()=>{const[C,M]=bc(l),[L,D]=al(t),[V,q]=WL(t);return O(Ds,nn({class:"v-checkbox"},C,L,{id:w.value,focused:m.value}),{...d,default:X=>{let{id:xe,isDisabled:ce,isReadonly:me}=X;return O(ud,nn(V,{id:xe.value,disabled:ce.value,readonly:me.value},M,{onFocus:v,onBlur:b}),d)}})}),{}}});const XL=Mn({start:Boolean,end:Boolean,icon:pn,image:String,...gr(),...Pi(),...da(),...Sn(),...Do({variant:"flat"})},"VAvatar"),rl=Pt({name:"VAvatar",props:XL(),setup(t,a){let{slots:l}=a;const{colorClasses:d,colorStyles:m,variantClasses:v}=Ec(t),{densityClasses:b}=jr(t),{roundedClasses:o}=Ki(t),{sizeClasses:w,sizeStyles:C}=rd(t);return kt(()=>{var M;return O(t.tag,{class:["v-avatar",{"v-avatar--start":t.start,"v-avatar--end":t.end},d.value,b.value,o.value,w.value,v.value],style:[m.value,C.value]},{default:()=>[t.image?O(ld,{key:"image",src:t.image,alt:""},null):t.icon?O(er,{key:"icon",icon:t.icon},null):(M=l.default)==null?void 0:M.call(l),Sc(!1,"v-avatar")]})}),{}}});const Q2=Symbol.for("vuetify:v-chip-group"),YL=Pt({name:"VChipGroup",props:{column:Boolean,filter:Boolean,valueComparator:{type:Function,default:yf},...ed({selectedClass:"v-chip--selected"}),...Sn(),...Xn(),...Do({variant:"tonal"})},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const{themeClasses:d}=yi(t),{isSelected:m,select:v,next:b,prev:o,selected:w}=Tc(t,Q2);return rr({VChip:{color:Tt(t,"color"),filter:Tt(t,"filter"),variant:Tt(t,"variant")}}),kt(()=>{var C;return O(t.tag,{class:["v-chip-group",{"v-chip-group--column":t.column},d.value]},{default:()=>[(C=l.default)==null?void 0:C.call(l,{isSelected:m,select:v,next:b,prev:o,selected:w.value})]})}),{}}}),wf=Pt({name:"VChip",directives:{Ripple:sl},props:{activeClass:String,appendAvatar:String,appendIcon:pn,closable:Boolean,closeIcon:{type:pn,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:Boolean,pill:Boolean,prependAvatar:String,prependIcon:pn,ripple:{type:Boolean,default:!0},text:String,modelValue:{type:Boolean,default:!0},...fo(),...gr(),...sr(),...wc(),...Pi(),...ad(),...da(),...Sn({tag:"span"}),...Xn(),...Do({variant:"tonal"})},emits:{"click:close":t=>!0,"update:active":t=>!0,"update:modelValue":t=>!0,"group:selected":t=>!0},setup(t,a){let{attrs:l,emit:d,slots:m}=a;const{borderClasses:v}=Lo(t),{colorClasses:b,colorStyles:o,variantClasses:w}=Ec(t),{densityClasses:C}=jr(t),{elevationClasses:M}=Mr(t),{roundedClasses:L}=Ki(t),{sizeClasses:D}=rd(t),{themeClasses:V}=yi(t),q=Tn(t,"modelValue"),X=td(t,Q2,!1),xe=xf(t,l);function ce(me){q.value=!1,d("click:close",me)}return()=>{var me;const ee=xe.isLink.value?"a":t.tag,Ie=!!(m.append||t.appendIcon||t.appendAvatar),Y=!!(m.close||t.closable),ve=!!(m.filter||t.filter)&&X,fe=!!(m.prepend||t.prependIcon||t.prependAvatar),ge=!X||X.isSelected.value,Ee=!t.disabled&&(!!X||xe.isClickable.value||t.link),we=t.link?t.link:X==null?void 0:X.toggle;return q.value&&qi(O(ee,{class:["v-chip",{"v-chip--disabled":t.disabled,"v-chip--label":t.label,"v-chip--link":Ee,"v-chip--filter":ve,"v-chip--pill":t.pill},V.value,v.value,ge?b.value:void 0,C.value,M.value,L.value,D.value,w.value,X==null?void 0:X.selectedClass.value],style:[ge?o.value:void 0],disabled:t.disabled||void 0,draggable:t.draggable,href:xe.href.value,onClick:Ee&&we},{default:()=>{var Oe;return[Sc(Ee,"v-chip"),ve&&O(Ti,{key:"filter",defaults:{VIcon:{icon:t.filterIcon}}},{default:()=>[O(jy,null,{default:()=>[qi(O("div",{class:"v-chip__filter"},[m.filter?m.filter():O(er,null,null)]),[[Ls,X.isSelected.value]])]})]}),fe&&O(Ti,{key:"prepend",defaults:{VAvatar:{image:t.prependAvatar},VIcon:{icon:t.prependIcon}}},{default:()=>[m.prepend?O("div",{class:"v-chip__prepend"},[m.prepend()]):t.prependAvatar?O(rl,{start:!0},null):t.prependIcon?O(er,{start:!0},null):void 0]}),(Oe=(me=m.default)==null?void 0:me.call(m,{isSelected:X==null?void 0:X.isSelected.value,selectedClass:X==null?void 0:X.selectedClass.value,select:X==null?void 0:X.select,toggle:X==null?void 0:X.toggle,value:X==null?void 0:X.value.value,disabled:t.disabled}))!=null?Oe:t.text,Ie&&O(Ti,{key:"append",defaults:{VAvatar:{image:t.appendAvatar},VIcon:{icon:t.appendIcon}}},{default:()=>[m.append?O("div",{class:"v-chip__append"},[m.append()]):t.appendAvatar?O(rl,{end:!0},null):t.appendIcon?O(er,{end:!0},null):void 0]}),Y&&O(Ti,{key:"close",defaults:{VIcon:{icon:t.closeIcon,size:"x-small"}}},{default:()=>[O("div",{class:"v-chip__close",onClick:ce},[m.close?m.close():O(er,null,null)])]})]}}),[[uo("ripple"),Ee&&t.ripple,null]])}}});const kc=Pt({name:"VDivider",props:{color:String,inset:Boolean,length:[Number,String],thickness:[Number,String],vertical:Boolean,...Xn()},setup(t,a){let{attrs:l}=a;const{themeClasses:d}=yi(t),{backgroundColorClasses:m,backgroundColorStyles:v}=Yi(Tt(t,"color")),b=ne(()=>{const o={};return t.length&&(o[t.vertical?"maxHeight":"maxWidth"]=Xt(t.length)),t.thickness&&(o[t.vertical?"borderRightWidth":"borderTopWidth"]=Xt(t.thickness)),o});return kt(()=>O("hr",{class:[{"v-divider":!0,"v-divider--inset":t.inset,"v-divider--vertical":t.vertical},d.value,m.value],style:[b.value,v.value],"aria-orientation":!l.role||l.role==="separator"?t.vertical?"vertical":"horizontal":void 0,role:`${l.role||"separator"}`},null)),{}}}),Ov=Symbol.for("vuetify:list");function eS(){const t=ln(Ov,{hasPrepend:Je(!1),updateHasPrepend:()=>null}),a={hasPrepend:Je(!1),updateHasPrepend:l=>{l&&(a.hasPrepend.value=l)}};return ji(Ov,a),t}function tS(){return ln(Ov,null)}const KL={open:t=>{let{id:a,value:l,opened:d,parents:m}=t;if(l){const v=new Set;v.add(a);let b=m.get(a);for(;b!=null;)v.add(b),b=m.get(b);return v}else return d.delete(a),d},select:()=>null},nS={open:t=>{let{id:a,value:l,opened:d,parents:m}=t;if(l){let v=m.get(a);for(d.add(a);v!=null&&v!==a;)d.add(v),v=m.get(v);return d}else d.delete(a);return d},select:()=>null},JL={open:nS.open,select:t=>{let{id:a,value:l,opened:d,parents:m}=t;if(!l)return d;const v=[];let b=m.get(a);for(;b!=null;)v.push(b),b=m.get(b);return new Set(v)}},qy=t=>{const a={select:l=>{let{id:d,value:m,selected:v}=l;if(t&&!m){const b=Array.from(v.entries()).reduce((o,w)=>{let[C,M]=w;return M==="on"?[...o,C]:o},[]);if(b.length===1&&b[0]===d)return v}return v.set(d,m?"on":"off"),v},in:(l,d,m)=>{let v=new Map;for(const b of l||[])v=a.select({id:b,value:!0,selected:new Map(v),children:d,parents:m});return v},out:l=>{const d=[];for(const[m,v]of l.entries())v==="on"&&d.push(m);return d}};return a},iS=t=>{const a=qy(t);return{select:d=>{let{selected:m,id:v,...b}=d;const o=m.has(v)?new Map([[v,m.get(v)]]):new Map;return a.select({...b,id:v,selected:o})},in:(d,m,v)=>{let b=new Map;return d!=null&&d.length&&(b=a.in(d.slice(0,1),m,v)),b},out:(d,m,v)=>a.out(d,m,v)}},QL=t=>{const a=qy(t);return{select:d=>{let{id:m,selected:v,children:b,...o}=d;return b.has(m)?v:a.select({id:m,selected:v,children:b,...o})},in:a.in,out:a.out}},eD=t=>{const a=iS(t);return{select:d=>{let{id:m,selected:v,children:b,...o}=d;return b.has(m)?v:a.select({id:m,selected:v,children:b,...o})},in:a.in,out:a.out}},tD=t=>{const a={select:l=>{let{id:d,value:m,selected:v,children:b,parents:o}=l;const w=new Map(v),C=[d];for(;C.length;){const L=C.shift();v.set(L,m?"on":"off"),b.has(L)&&C.push(...b.get(L))}let M=o.get(d);for(;M;){const L=b.get(M),D=L.every(q=>v.get(q)==="on"),V=L.every(q=>!v.has(q)||v.get(q)==="off");v.set(M,D?"on":V?"off":"indeterminate"),M=o.get(M)}return t&&!m&&Array.from(v.entries()).reduce((D,V)=>{let[q,X]=V;return X==="on"?[...D,q]:D},[]).length===0?w:v},in:(l,d,m)=>{let v=new Map;for(const b of l||[])v=a.select({id:b,value:!0,selected:new Map(v),children:d,parents:m});return v},out:(l,d)=>{const m=[];for(const[v,b]of l.entries())b==="on"&&!d.has(v)&&m.push(v);return m}};return a},mf=Symbol.for("vuetify:nested"),rS={id:Je(),root:{register:()=>null,unregister:()=>null,parents:Je(new Map),children:Je(new Map),open:()=>null,openOnSelect:()=>null,select:()=>null,opened:Je(new Set),selected:Je(new Map),selectedValues:Je([])}},nD=Mn({selectStrategy:[String,Function],openStrategy:[String,Function],opened:Array,selected:Array,mandatory:Boolean},"nested"),iD=t=>{let a=!1;const l=Je(new Map),d=Je(new Map),m=Tn(t,"opened",t.opened,L=>new Set(L),L=>[...L.values()]),v=ne(()=>{if(typeof t.selectStrategy=="object")return t.selectStrategy;switch(t.selectStrategy){case"single-leaf":return eD(t.mandatory);case"leaf":return QL(t.mandatory);case"independent":return qy(t.mandatory);case"single-independent":return iS(t.mandatory);case"classic":default:return tD(t.mandatory)}}),b=ne(()=>{if(typeof t.openStrategy=="function")return t.openStrategy;switch(t.openStrategy){case"list":return JL;case"single":return KL;case"multiple":default:return nS}}),o=Tn(t,"selected",t.selected,L=>v.value.in(L,l.value,d.value),L=>v.value.out(L,l.value,d.value));Ei(()=>{a=!0});function w(L){const D=[];let V=L;for(;V!=null;)D.unshift(V),V=d.value.get(V);return D}const C=kr("nested"),M={id:Je(),root:{opened:m,selected:o,selectedValues:ne(()=>{const L=[];for(const[D,V]of o.value.entries())V==="on"&&L.push(D);return L}),register:(L,D,V)=>{D&&L!==D&&d.value.set(L,D),V&&l.value.set(L,[]),D!=null&&l.value.set(D,[...l.value.get(D)||[],L])},unregister:L=>{var V;if(a)return;l.value.delete(L);const D=d.value.get(L);if(D){const q=(V=l.value.get(D))!=null?V:[];l.value.set(D,q.filter(X=>X!==L))}d.value.delete(L),m.value.delete(L)},open:(L,D,V)=>{C.emit("click:open",{id:L,value:D,path:w(L),event:V});const q=b.value.open({id:L,value:D,opened:new Set(m.value),children:l.value,parents:d.value,event:V});q&&(m.value=q)},openOnSelect:(L,D,V)=>{const q=b.value.select({id:L,value:D,selected:new Map(o.value),opened:new Set(m.value),children:l.value,parents:d.value,event:V});q&&(m.value=q)},select:(L,D,V)=>{C.emit("click:select",{id:L,value:D,path:w(L),event:V});const q=v.value.select({id:L,value:D,selected:new Map(o.value),children:l.value,parents:d.value,event:V});q&&(o.value=q),M.root.openOnSelect(L,D,V)},children:l,parents:d}};return ji(mf,M),M.root},oS=(t,a)=>{const l=ln(mf,rS),d=ne(()=>{var v;return(v=t.value)!=null?v:Symbol(Ur())}),m={...l,id:d,open:(v,b)=>l.root.open(d.value,v,b),openOnSelect:(v,b)=>l.root.openOnSelect(d.value,v,b),isOpen:ne(()=>l.root.opened.value.has(d.value)),parent:ne(()=>l.root.parents.value.get(d.value)),select:(v,b)=>l.root.select(d.value,v,b),isSelected:ne(()=>l.root.selected.value.get(d.value)==="on"),isIndeterminate:ne(()=>l.root.selected.value.get(d.value)==="indeterminate"),isLeaf:ne(()=>!l.root.children.value.get(d.value)),isGroupActivator:l.isGroupActivator};return!l.isGroupActivator&&l.root.register(d.value,l.id.value,a),Ei(()=>{!l.isGroupActivator&&l.root.unregister(d.value)}),a&&ji(mf,m),m},rD=()=>{const t=ln(mf,rS);ji(mf,{...t,isGroupActivator:!0})},oD=Pt({name:"VListGroupActivator",setup(t,a){let{slots:l}=a;return rD(),()=>{var d;return(d=l.default)==null?void 0:d.call(l)}}}),sD=Mn({activeColor:String,color:String,collapseIcon:{type:pn,default:"$collapse"},expandIcon:{type:pn,default:"$expand"},prependIcon:pn,appendIcon:pn,fluid:Boolean,subgroup:Boolean,value:null,...Sn()},"VListGroup"),Zy=Mi()({name:"VListGroup",props:{title:String,...sD()},setup(t,a){let{slots:l}=a;const{isOpen:d,open:m,id:v}=oS(Tt(t,"value"),!0),b=ne(()=>`v-list-group--id-${String(v.value)}`),o=tS();function w(L){m(!d.value,L)}const C=ne(()=>({onClick:w,class:"v-list-group__header",id:b.value})),M=ne(()=>d.value?t.collapseIcon:t.expandIcon);return kt(()=>{var L;return O(t.tag,{class:["v-list-group",{"v-list-group--prepend":o==null?void 0:o.hasPrepend.value,"v-list-group--fluid":t.fluid,"v-list-group--subgroup":t.subgroup}]},{default:()=>[l.activator&&O(Ti,{defaults:{VListItem:{active:d.value,activeColor:t.activeColor,color:t.color,prependIcon:t.prependIcon||t.subgroup&&M.value,appendIcon:t.appendIcon||!t.subgroup&&M.value,title:t.title,value:t.value}}},{default:()=>[O(oD,null,{default:()=>[l.activator({props:C.value,isOpen:d})]})]}),O(cg,null,{default:()=>[qi(O("div",{class:"v-list-group__items",role:"group","aria-labelledby":b.value},[(L=l.default)==null?void 0:L.call(l)]),[[Ls,d.value]])]})]})}),{}}});function aD(t){return Po(t,Object.keys(Zy.props))}const sS=zo("v-list-item-subtitle"),aS=zo("v-list-item-title"),wi=Mi()({name:"VListItem",directives:{Ripple:sl},props:{active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:pn,disabled:Boolean,lines:String,link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:pn,subtitle:[String,Number,Boolean],title:[String,Number,Boolean],value:null,...fo(),...gr(),...es(),...sr(),...Pi(),...ad(),...Sn(),...Xn(),...Do({variant:"text"})},emits:{click:t=>!0},setup(t,a){let{attrs:l,slots:d,emit:m}=a;const v=xf(t,l),b=ne(()=>{var Pe;return(Pe=t.value)!=null?Pe:v.href.value}),{select:o,isSelected:w,isIndeterminate:C,isGroupActivator:M,root:L,parent:D,openOnSelect:V}=oS(b,!1),q=tS(),X=ne(()=>{var Pe;return t.active!==!1&&(t.active||((Pe=v.isActive)==null?void 0:Pe.value)||w.value)}),xe=ne(()=>t.link!==!1&&v.isLink.value),ce=ne(()=>!t.disabled&&t.link!==!1&&(t.link||v.isClickable.value||t.value!=null&&!!q)),me=ne(()=>t.rounded||t.nav),ee=ne(()=>{var Pe;return{color:X.value&&(Pe=t.activeColor)!=null?Pe:t.color,variant:t.variant}});Ye(()=>{var Pe;return(Pe=v.isActive)==null?void 0:Pe.value},Pe=>{Pe&&D.value!=null&&L.open(D.value,!0),Pe&&V(Pe)},{immediate:!0});const{themeClasses:Ie}=yi(t),{borderClasses:Y}=Lo(t),{colorClasses:ve,colorStyles:fe,variantClasses:ge}=Ec(ee),{densityClasses:Ee}=jr(t),{dimensionStyles:we}=ts(t),{elevationClasses:Oe}=Mr(t),{roundedClasses:ze}=Ki(me),Qe=ne(()=>t.lines?`v-list-item--${t.lines}-line`:void 0),ht=ne(()=>({isActive:X.value,select:o,isSelected:w.value,isIndeterminate:C.value}));function nt(Pe){var at;m("click",Pe),!(M||!ce.value)&&((at=v.navigate)==null||at.call(v,Pe),t.value!=null&&o(!w.value,Pe))}function ft(Pe){(Pe.key==="Enter"||Pe.key===" ")&&(Pe.preventDefault(),nt(Pe))}return kt(()=>{var Pe,at,jt,pt,zt;const Gt=xe.value?"a":t.tag,zn=!q||w.value||X.value,At=d.title||t.title,Ke=d.subtitle||t.subtitle,xt=!!(d.append||t.appendAvatar||t.appendIcon),St=!!(d.prepend||t.prependAvatar||t.prependIcon);return q==null||q.updateHasPrepend(St),qi(O(Gt,{class:["v-list-item",{"v-list-item--active":X.value,"v-list-item--disabled":t.disabled,"v-list-item--link":ce.value,"v-list-item--nav":t.nav,"v-list-item--prepend":!St&&(q==null?void 0:q.hasPrepend.value),[`${t.activeClass}`]:t.activeClass&&X.value},Ie.value,Y.value,zn?ve.value:void 0,Ee.value,Oe.value,Qe.value,ze.value,ge.value],style:[zn?fe.value:void 0,we.value],href:v.href.value,tabindex:ce.value?0:void 0,onClick:nt,onKeydown:ce.value&&!xe.value&&ft},{default:()=>[Sc(ce.value||X.value,"v-list-item"),St&&O(Ti,{key:"prepend",defaults:{VAvatar:{density:t.density,image:t.prependAvatar},VIcon:{density:t.density,icon:t.prependIcon},VListItemAction:{start:!0}}},{default:()=>[O("div",{class:"v-list-item__prepend"},[t.prependAvatar&&O(rl,{key:"prepend-avatar"},null),t.prependIcon&&O(er,{key:"prepend-icon"},null),(Pe=d.prepend)==null?void 0:Pe.call(d,ht.value)])]}),O("div",{class:"v-list-item__content"},[At&&O(aS,{key:"title"},{default:()=>{var Nt;return[(Nt=(at=d.title)==null?void 0:at.call(d,{title:t.title}))!=null?Nt:t.title]}}),Ke&&O(sS,{key:"subtitle"},{default:()=>{var Nt;return[(Nt=(jt=d.subtitle)==null?void 0:jt.call(d,{subtitle:t.subtitle}))!=null?Nt:t.subtitle]}}),(pt=d.default)==null?void 0:pt.call(d,ht.value)]),xt&&O(Ti,{key:"append",defaults:{VAvatar:{density:t.density,image:t.appendAvatar},VIcon:{density:t.density,icon:t.appendIcon},VListItemAction:{end:!0}}},{default:()=>[O("div",{class:"v-list-item__append"},[(zt=d.append)==null?void 0:zt.call(d,ht.value),t.appendIcon&&O(er,{key:"append-icon"},null),t.appendAvatar&&O(rl,{key:"append-avatar"},null)])]})]}),[[uo("ripple"),ce.value]])}),{}}}),lS=Pt({name:"VListSubheader",props:{color:String,inset:Boolean,sticky:Boolean,title:String,...Sn()},setup(t,a){let{slots:l}=a;const{textColorClasses:d,textColorStyles:m}=no(Tt(t,"color"));return kt(()=>{var v;const b=!!(l.default||t.title);return O(t.tag,{class:["v-list-subheader",{"v-list-subheader--inset":t.inset,"v-list-subheader--sticky":t.sticky},d.value],style:{textColorStyles:m}},{default:()=>{var o;return[b&&O("div",{class:"v-list-subheader__text"},[(o=(v=l.default)==null?void 0:v.call(l))!=null?o:t.title])]}})}),{}}}),cS=Mi()({name:"VListChildren",props:{items:Array},setup(t,a){let{slots:l}=a;return eS(),()=>{var v;var d,m;return(v=(d=l.default)==null?void 0:d.call(l))!=null?v:(m=t.items)==null?void 0:m.map(b=>{var xe,ce;let{children:o,props:w,type:C,raw:M}=b;if(C==="divider"){var L;return(xe=(L=l.divider)==null?void 0:L.call(l,{props:w}))!=null?xe:O(kc,w,null)}if(C==="subheader"){var D;return(ce=(D=l.subheader)==null?void 0:D.call(l,{props:w}))!=null?ce:O(lS,w,{default:l.subheader})}const V={subtitle:l.subtitle?me=>{var ee;return(ee=l.subtitle)==null?void 0:ee.call(l,{...me,item:M})}:void 0,prepend:l.prepend?me=>{var ee;return(ee=l.prepend)==null?void 0:ee.call(l,{...me,item:M})}:void 0,append:l.append?me=>{var ee;return(ee=l.append)==null?void 0:ee.call(l,{...me,item:M})}:void 0,default:l.default?me=>{var ee;return(ee=l.default)==null?void 0:ee.call(l,{...me,item:M})}:void 0,title:l.title?me=>{var ee;return(ee=l.title)==null?void 0:ee.call(l,{...me,item:M})}:void 0},[q,X]=aD(w);return o?O(Zy,nn({value:w==null?void 0:w.value},q),{activator:me=>{let{props:ee}=me;return l.header?l.header({...w,...ee}):O(wi,nn(w,ee),V)},default:()=>O(cS,{items:o},l)}):l.item?l.item(w):O(wi,w,V)})}}}),uS=Mn({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},returnObject:Boolean},"item");function Nu(t,a){var o;const l=Is(a,t.itemTitle,a),d=t.returnObject?a:Is(a,t.itemValue,l),m=Is(a,t.itemChildren),v=t.itemProps===!0?typeof a=="object"&&a!=null&&!Array.isArray(a)?"children"in a?Po(a,["children"])[1]:a:void 0:Is(a,t.itemProps),b={title:l,value:d,...v};return{title:String((o=b.title)!=null?o:""),value:b.value,props:b,children:Array.isArray(m)?dS(t,m):void 0,raw:a}}function dS(t,a){const l=[];for(const d of a)l.push(Nu(t,d));return l}function Wy(t){const a=ne(()=>dS(t,t.items));function l(m){return m.map(v=>Nu(t,v))}function d(m){return m.map(v=>{let{props:b}=v;return b.value})}return{items:a,transformIn:l,transformOut:d}}function lD(t,a){const l=Is(a,t.itemType,"item"),d=typeof a=="string"?a:Is(a,t.itemTitle),m=Is(a,t.itemValue,void 0),v=Is(a,t.itemChildren),b=t.itemProps===!0?Po(a,["children"])[1]:Is(a,t.itemProps),o={title:d,value:m,...b};return{type:l,title:o.title,value:o.value,props:o,children:l==="item"&&v?hS(t,v):void 0,raw:a}}function hS(t,a){const l=[];for(const d of a)l.push(lD(t,d));return l}function cD(t){return{items:ne(()=>hS(t,t.items))}}const ma=Mi()({name:"VList",props:{activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,lines:{type:[Boolean,String],default:"one"},nav:Boolean,...nD({selectStrategy:"single-leaf",openStrategy:"list"}),...fo(),...gr(),...es(),...sr(),itemType:{type:String,default:"type"},...uS(),...Pi(),...Sn(),...Xn(),...Do({variant:"text"})},emits:{"update:selected":t=>!0,"update:opened":t=>!0,"click:open":t=>!0,"click:select":t=>!0},setup(t,a){let{slots:l}=a;const{items:d}=cD(t),{themeClasses:m}=yi(t),{backgroundColorClasses:v,backgroundColorStyles:b}=Yi(Tt(t,"bgColor")),{borderClasses:o}=Lo(t),{densityClasses:w}=jr(t),{dimensionStyles:C}=ts(t),{elevationClasses:M}=Mr(t),{roundedClasses:L}=Ki(t),{open:D,select:V}=iD(t),q=ne(()=>t.lines?`v-list--${t.lines}-line`:void 0),X=Tt(t,"activeColor"),xe=Tt(t,"color");eS(),rr({VListGroup:{activeColor:X,color:xe},VListItem:{activeClass:Tt(t,"activeClass"),activeColor:X,color:xe,density:Tt(t,"density"),disabled:Tt(t,"disabled"),lines:Tt(t,"lines"),nav:Tt(t,"nav"),variant:Tt(t,"variant")}});const ce=Je(!1),me=Je();function ee(ge){ce.value=!0}function Ie(ge){ce.value=!1}function Y(ge){var Ee;!ce.value&&!(ge.relatedTarget&&(Ee=me.value)!=null&&Ee.contains(ge.relatedTarget))&&fe()}function ve(ge){!me.value||(ge.key==="ArrowDown"?fe("next"):ge.key==="ArrowUp"?fe("prev"):ge.key==="Home"?fe("first"):ge.key==="End"&&fe("last"))}function fe(ge){if(!me.value)return;const Ee=[...me.value.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')].filter(ht=>!ht.hasAttribute("disabled")),we=Ee.indexOf(document.activeElement);if(ge)if(ge==="first"){var ze;(ze=Ee[0])==null||ze.focus()}else if(ge==="last"){var Qe;(Qe=Ee.at(-1))==null||Qe.focus()}else{let ht,nt=we;const ft=ge==="next"?1:-1;do nt+=ft,ht=Ee[nt];while((!ht||ht.offsetParent==null)&&nt<Ee.length&&nt>=0);ht?ht.focus():fe(ge==="next"?"first":"last")}else{var Oe;(Oe=Ee[0])==null||Oe.focus()}}return kt(()=>O(t.tag,{ref:me,class:["v-list",{"v-list--disabled":t.disabled,"v-list--nav":t.nav},m.value,v.value,o.value,w.value,M.value,q.value,L.value],style:[b.value,C.value],role:"listbox","aria-activedescendant":void 0,onFocusin:ee,onFocusout:Ie,onFocus:Y,onKeydown:ve},{default:()=>[O(cS,{items:d.value},l)]})),{open:D,select:V,focus:fe}}}),uD=zo("v-list-img"),dD=Pt({name:"VListItemAction",props:{start:Boolean,end:Boolean,...Sn()},setup(t,a){let{slots:l}=a;return kt(()=>O(t.tag,{class:["v-list-item-action",{"v-list-item-action--start":t.start,"v-list-item-action--end":t.end}]},l)),{}}}),hD=Pt({name:"VListItemMedia",props:{start:Boolean,end:Boolean,...Sn()},setup(t,a){let{slots:l}=a;return kt(()=>O(t.tag,{class:["v-list-item-media",{"v-list-item-media--start":t.start,"v-list-item-media--end":t.end}]},l)),{}}});const fS=Mn({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function pS(t,a){const l={},d=m=>()=>{if(!ki)return Promise.resolve(!0);const v=m==="openDelay";return l.closeDelay&&window.clearTimeout(l.closeDelay),delete l.closeDelay,l.openDelay&&window.clearTimeout(l.openDelay),delete l.openDelay,new Promise(b=>{var w;const o=parseInt((w=t[m])!=null?w:0,10);l[m]=window.setTimeout(()=>{a==null||a(v),b(v)},o)})};return{runCloseDelay:d("closeDelay"),runOpenDelay:d("openDelay")}}const Fv=Symbol.for("vuetify:v-menu"),fD=Mn({activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...fS()},"VOverlay/useActivator");function pD(t,a){let{isActive:l,isTop:d}=a;const m=Je();let v=!1,b=!1,o=!0;const w=ne(()=>t.openOnFocus||t.openOnFocus==null&&t.openOnHover),C=ne(()=>t.openOnClick||t.openOnClick==null&&!t.openOnHover&&!w.value),{runOpenDelay:M,runCloseDelay:L}=pS(t,ee=>{ee===(t.openOnHover&&v||w.value&&b)&&!(t.openOnHover&&l.value&&!d.value)&&(l.value!==ee&&(o=!0),l.value=ee)}),D={click:ee=>{ee.stopPropagation(),m.value=ee.currentTarget||ee.target,l.value=!l.value},mouseenter:ee=>{v=!0,m.value=ee.currentTarget||ee.target,M()},mouseleave:ee=>{v=!1,L()},focus:ee=>{Mv&&!ee.target.matches(":focus-visible")||(b=!0,ee.stopPropagation(),m.value=ee.currentTarget||ee.target,M())},blur:ee=>{b=!1,ee.stopPropagation(),L()}},V=ne(()=>{const ee={};return C.value&&(ee.click=D.click),t.openOnHover&&(ee.mouseenter=D.mouseenter,ee.mouseleave=D.mouseleave),w.value&&(ee.focus=D.focus,ee.blur=D.blur),ee}),q=ne(()=>{const ee={};if(t.openOnHover&&(ee.mouseenter=()=>{v=!0,M()},ee.mouseleave=()=>{v=!1,L()}),t.closeOnContentClick){const Ie=ln(Fv,null);ee.click=()=>{l.value=!1,Ie==null||Ie.closeParents()}}return ee}),X=ne(()=>{const ee={};return t.openOnHover&&(ee.mouseenter=()=>{o&&(v=!0,o=!1,M())},ee.mouseleave=()=>{v=!1,L()}),ee});Ye(d,ee=>{ee&&(t.openOnHover&&!v&&(!w.value||!b)||w.value&&!b&&(!t.openOnHover||!v))&&(l.value=!1)});const xe=Je();Ms(()=>{!xe.value||Gi(()=>{const ee=xe.value;m.value=cP(ee)?ee.$el:ee})});const ce=kr("useActivator");let me;return Ye(()=>!!t.activator,ee=>{ee&&ki?(me=_f(),me.run(()=>{mD(t,ce,{activatorEl:m,activatorEvents:V})})):me&&me.stop()},{flush:"post",immediate:!0}),{activatorEl:m,activatorRef:xe,activatorEvents:V,contentEvents:q,scrimEvents:X}}function mD(t,a,l){let{activatorEl:d,activatorEvents:m}=l;Ye(()=>t.activator,(w,C)=>{if(C&&w!==C){const M=o(C);M&&b(M)}w&&Gi(()=>v())},{immediate:!0}),Ye(()=>t.activatorProps,()=>{v()}),vc(()=>{b()});function v(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.activatorProps;!w||(Object.entries(m.value).forEach(M=>{let[L,D]=M;w.addEventListener(L,D)}),Object.keys(C).forEach(M=>{C[M]==null?w.removeAttribute(M):w.setAttribute(M,C[M])}))}function b(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.activatorProps;!w||(Object.entries(m.value).forEach(M=>{let[L,D]=M;w.removeEventListener(L,D)}),Object.keys(C).forEach(M=>{w.removeAttribute(M)}))}function o(){var w;let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.activator,M;if(C)if(C==="parent"){var L,D;let V=a==null||(L=a.proxy)==null||(D=L.$el)==null?void 0:D.parentNode;for(;V.hasAttribute("data-no-activator");)V=V.parentNode;M=V}else typeof C=="string"?M=document.querySelector(C):"$el"in C?M=C.$el:M=C;return d.value=((w=M)==null?void 0:w.nodeType)===Node.ELEMENT_NODE?M:null,d.value}}const fg=Mn({eager:Boolean},"lazy");function Hy(t,a){const l=Je(!1),d=ne(()=>l.value||t.eager||a.value);Ye(a,()=>l.value=!0);function m(){t.eager||(l.value=!1)}return{isBooted:l,hasContent:d,onAfterLeave:m}}function ev(t,a){return{x:t.x+a.x,y:t.y+a.y}}function gD(t,a){return{x:t.x-a.x,y:t.y-a.y}}function tw(t,a){if(t.side==="top"||t.side==="bottom"){const{side:l,align:d}=t,m=d==="left"?0:d==="center"?a.width/2:d==="right"?a.width:d,v=l==="top"?0:l==="bottom"?a.height:l;return ev({x:m,y:v},a)}else if(t.side==="left"||t.side==="right"){const{side:l,align:d}=t,m=l==="left"?0:l==="right"?a.width:l,v=d==="top"?0:d==="center"?a.height/2:d==="bottom"?a.height:d;return ev({x:m,y:v},a)}return ev({x:a.width/2,y:a.height/2},a)}const mS={static:yD,connected:bD},_D=Mn({locationStrategy:{type:[String,Function],default:"static",validator:t=>typeof t=="function"||t in mS},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay/locationStrategies");function vD(t,a){const l=Je({}),d=Je();let m;Ms(async()=>{var b;(b=m)==null||b.stop(),d.value=void 0,ki&&a.isActive.value&&t.locationStrategy&&(m=_f(),await Gi(),m.run(()=>{if(typeof t.locationStrategy=="function"){var o;d.value=(o=t.locationStrategy(a,t,l))==null?void 0:o.updateLocation}else{var w;d.value=(w=mS[t.locationStrategy](a,t,l))==null?void 0:w.updateLocation}}))}),ki&&window.addEventListener("resize",v,{passive:!0}),vc(()=>{var b;ki&&window.removeEventListener("resize",v),d.value=void 0,(b=m)==null||b.stop()});function v(b){var o;(o=d.value)==null||o.call(d,b)}return{contentStyles:l,updateLocation:d}}function yD(){}function xD(t){const a=Ey(t);return a.x-=parseFloat(t.style.left||0),a.y-=parseFloat(t.style.top||0),a}function bD(t,a,l){const d=FP(t.activatorEl.value);d&&Object.assign(l.value,{position:"fixed"});const{preferredAnchor:m,preferredOrigin:v}=Sy(()=>{const V=Cv(a.location,t.isRtl.value),q=a.origin==="overlap"?V:a.origin==="auto"?H_(V):Cv(a.origin,t.isRtl.value);return V.side===q.side&&V.align===X_(q).align?{preferredAnchor:Mb(V),preferredOrigin:Mb(q)}:{preferredAnchor:V,preferredOrigin:q}}),[b,o,w,C]=["minWidth","minHeight","maxWidth","maxHeight"].map(V=>ne(()=>{const q=parseFloat(a[V]);return isNaN(q)?1/0:q})),M=ne(()=>{if(Array.isArray(a.offset))return a.offset;if(typeof a.offset=="string"){const V=a.offset.split(" ").map(parseFloat);return V.length<2&&V.push(0),V}return typeof a.offset=="number"?[a.offset,0]:[0,0]});let L=!1;if(ki){const V=new ResizeObserver(()=>{L&&D()});Ye([t.activatorEl,t.contentEl],(q,X)=>{let[xe,ce]=q,[me,ee]=X;me&&V.unobserve(me),xe&&V.observe(xe),ee&&V.unobserve(ee),ce&&V.observe(ce)},{immediate:!0}),vc(()=>{V.disconnect()})}function D(){if(L=!1,requestAnimationFrame(()=>{requestAnimationFrame(()=>L=!0)}),!t.activatorEl.value||!t.contentEl.value)return;const V=t.activatorEl.value.getBoundingClientRect(),q=xD(t.contentEl.value),X=Om(t.contentEl.value),xe=12;X.length||(X.push(document.documentElement),t.contentEl.value.style.top&&t.contentEl.value.style.left||(q.x+=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),q.y+=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const ce=X.reduce((we,Oe)=>{const ze=Oe.getBoundingClientRect(),Qe=new Zu({x:Oe===document.documentElement?0:ze.x,y:Oe===document.documentElement?0:ze.y,width:Oe.clientWidth,height:Oe.clientHeight});return we?new Zu({x:Math.max(we.left,Qe.left),y:Math.max(we.top,Qe.top),width:Math.min(we.right,Qe.right)-Math.max(we.left,Qe.left),height:Math.min(we.bottom,Qe.bottom)-Math.max(we.top,Qe.top)}):Qe},void 0);ce.x+=xe,ce.y+=xe,ce.width-=xe*2,ce.height-=xe*2;let me={anchor:m.value,origin:v.value};function ee(we){const Oe=new Zu(q),ze=tw(we.anchor,V),Qe=tw(we.origin,Oe);let{x:ht,y:nt}=gD(ze,Qe);switch(we.anchor.side){case"top":nt-=M.value[0];break;case"bottom":nt+=M.value[0];break;case"left":ht-=M.value[0];break;case"right":ht+=M.value[0];break}switch(we.anchor.align){case"top":nt-=M.value[1];break;case"bottom":nt+=M.value[1];break;case"left":ht-=M.value[1];break;case"right":ht+=M.value[1];break}return Oe.x+=ht,Oe.y+=nt,Oe.width=Math.min(Oe.width,w.value),Oe.height=Math.min(Oe.height,C.value),{overflows:zb(Oe,ce),x:ht,y:nt}}let Ie=0,Y=0;const ve={x:0,y:0},fe={x:!1,y:!1};let ge=-1;for(;;){if(ge++>10){Av("Infinite loop detected in connectedLocationStrategy");break}const{x:we,y:Oe,overflows:ze}=ee(me);Ie+=we,Y+=Oe,q.x+=we,q.y+=Oe;{const Qe=Pb(me.anchor),ht=ze.x.before||ze.x.after,nt=ze.y.before||ze.y.after;let ft=!1;if(["x","y"].forEach(Pe=>{if(Pe==="x"&&ht&&!fe.x||Pe==="y"&&nt&&!fe.y){const at={anchor:{...me.anchor},origin:{...me.origin}},jt=Pe==="x"?Qe==="y"?X_:H_:Qe==="y"?H_:X_;at.anchor=jt(at.anchor),at.origin=jt(at.origin);const{overflows:pt}=ee(at);(pt[Pe].before<=ze[Pe].before&&pt[Pe].after<=ze[Pe].after||pt[Pe].before+pt[Pe].after<(ze[Pe].before+ze[Pe].after)/2)&&(me=at,ft=fe[Pe]=!0)}}),ft)continue}ze.x.before&&(Ie+=ze.x.before,q.x+=ze.x.before),ze.x.after&&(Ie-=ze.x.after,q.x-=ze.x.after),ze.y.before&&(Y+=ze.y.before,q.y+=ze.y.before),ze.y.after&&(Y-=ze.y.after,q.y-=ze.y.after);{const Qe=zb(q,ce);ve.x=ce.width-Qe.x.before-Qe.x.after,ve.y=ce.height-Qe.y.before-Qe.y.after,Ie+=Qe.x.before,q.x+=Qe.x.before,Y+=Qe.y.before,q.y+=Qe.y.before}break}const Ee=Pb(me.anchor);Object.assign(l.value,{"--v-overlay-anchor-origin":`${me.anchor.side} ${me.anchor.align}`,transformOrigin:`${me.origin.side} ${me.origin.align}`,top:Xt(nw(Y)),left:Xt(nw(Ie)),minWidth:Xt(Ee==="y"?Math.min(b.value,V.width):b.value),maxWidth:Xt(iw(Co(ve.x,b.value===1/0?0:b.value,w.value))),maxHeight:Xt(iw(Co(ve.y,o.value===1/0?0:o.value,C.value)))})}return Ye(()=>[m.value,v.value,a.offset,a.minWidth,a.minHeight,a.maxWidth,a.maxHeight],()=>D(),{immediate:!d}),d&&Gi(()=>D()),requestAnimationFrame(()=>{l.value.maxHeight&&D()}),{updateLocation:D}}function nw(t){return Math.round(t*devicePixelRatio)/devicePixelRatio}function iw(t){return Math.ceil(t*devicePixelRatio)/devicePixelRatio}let Vv=!0;const Um=[];function wD(t){!Vv||Um.length?(Um.push(t),$v()):(Vv=!1,t(),$v())}let rw=-1;function $v(){cancelAnimationFrame(rw),rw=requestAnimationFrame(()=>{const t=Um.shift();t&&t(),Um.length?$v():Vv=!0})}const Nv={none:null,close:ED,block:CD,reposition:ID},TD=Mn({scrollStrategy:{type:[String,Function],default:"block",validator:t=>typeof t=="function"||t in Nv}},"VOverlay/scrollStrategies");function SD(t,a){if(!ki)return;let l;Ms(async()=>{var d;(d=l)==null||d.stop(),a.isActive.value&&t.scrollStrategy&&(l=_f(),await Gi(),l.run(()=>{if(typeof t.scrollStrategy=="function")t.scrollStrategy(a,t);else{var m;(m=Nv[t.scrollStrategy])==null||m.call(Nv,a,t)}}))})}function ED(t){var l;function a(d){t.isActive.value=!1}gS((l=t.activatorEl.value)!=null?l:t.contentEl.value,a)}function CD(t,a){var l;const d=(l=t.root.value)==null?void 0:l.offsetParent,m=[...new Set([...Om(t.activatorEl.value,a.contained?d:void 0),...Om(t.contentEl.value,a.contained?d:void 0)])].filter(o=>!o.classList.contains("v-overlay-scroll-blocked")),v=window.innerWidth-document.documentElement.offsetWidth,b=(o=>Ay(o)&&o)(d||document.documentElement);b&&t.root.value.classList.add("v-overlay--scroll-blocked"),m.forEach((o,w)=>{o.style.setProperty("--v-body-scroll-x",Xt(-o.scrollLeft)),o.style.setProperty("--v-body-scroll-y",Xt(-o.scrollTop)),o.style.setProperty("--v-scrollbar-offset",Xt(v)),o.classList.add("v-overlay-scroll-blocked")}),vc(()=>{m.forEach((o,w)=>{const C=parseFloat(o.style.getPropertyValue("--v-body-scroll-x")),M=parseFloat(o.style.getPropertyValue("--v-body-scroll-y"));o.style.removeProperty("--v-body-scroll-x"),o.style.removeProperty("--v-body-scroll-y"),o.style.removeProperty("--v-scrollbar-offset"),o.classList.remove("v-overlay-scroll-blocked"),o.scrollLeft=-C,o.scrollTop=-M}),b&&t.root.value.classList.remove("v-overlay--scroll-blocked")})}function ID(t){var m;let a=!1,l=-1;function d(v){wD(()=>{var b,o;const w=performance.now();(b=(o=t.updateLocation).value)==null||b.call(o,v),a=(performance.now()-w)/(1e3/60)>2})}gS((m=t.activatorEl.value)!=null?m:t.contentEl.value,v=>{a?(cancelAnimationFrame(l),l=requestAnimationFrame(()=>{l=requestAnimationFrame(()=>{d(v)})})):d(v)})}function gS(t,a){const l=[document,...Om(t)];l.forEach(d=>{d.addEventListener("scroll",a,{passive:!0})}),vc(()=>{l.forEach(d=>{d.removeEventListener("scroll",a)})})}const ow=Symbol.for("vuetify:stack"),$h=pi([]);function AD(t,a){const l=kr("useStack"),d=ln(ow,void 0),m=pi({activeChildren:new Set});ji(ow,m);const v=Je(+a.value);df(t,()=>{var w;const C=(w=$h.at(-1))==null?void 0:w[1];v.value=C?C+10:+a.value,$h.push([l.uid,v.value]),d==null||d.activeChildren.add(l.uid),vc(()=>{const M=$h.findIndex(L=>L[0]===l.uid);$h.splice(M,1),d==null||d.activeChildren.delete(l.uid)})});const b=Je(!0);Ms(()=>{var w;const C=((w=$h.at(-1))==null?void 0:w[0])===l.uid;setTimeout(()=>b.value=C)});const o=ne(()=>!m.activeChildren.size);return{globalTop:vf(b),localTop:o,stackStyles:ne(()=>({zIndex:v.value}))}}function Jh(t){return{teleportTarget:ne(()=>{const l=t.value;if(l===!0||!ki)return;const d=l===!1?document.body:typeof l=="string"?document.querySelector(l):l;if(d==null){_A(`Unable to locate target ${l}`);return}if(!Jh.cache.has(d)){const m=document.createElement("div");m.className="v-overlay-container",d.appendChild(m),Jh.cache.set(d,m)}return Jh.cache.get(d)})}}Jh.cache=new WeakMap;function kD(){return!0}function _S(t,a,l){if(!t||vS(t,l)===!1)return!1;const d=KT(a);if(typeof ShadowRoot<"u"&&d instanceof ShadowRoot&&d.host===t.target)return!1;const m=(typeof l.value=="object"&&l.value.include||(()=>[]))();return m.push(a),!m.some(v=>v==null?void 0:v.contains(t.target))}function vS(t,a){return(typeof a.value=="object"&&a.value.closeConditional||kD)(t)}function MD(t,a,l){const d=typeof l.value=="function"?l.value:l.value.handler;a._clickOutside.lastMousedownWasOutside&&_S(t,a,l)&&setTimeout(()=>{vS(t,l)&&d&&d(t)},0)}function sw(t,a){const l=KT(t);a(document),typeof ShadowRoot<"u"&&l instanceof ShadowRoot&&a(l)}const yS={mounted(t,a){const l=m=>MD(m,t,a),d=m=>{t._clickOutside.lastMousedownWasOutside=_S(m,t,a)};sw(t,m=>{m.addEventListener("click",l,!0),m.addEventListener("mousedown",d,!0)}),t._clickOutside||(t._clickOutside={lastMousedownWasOutside:!0}),t._clickOutside[a.instance.$.uid]={onClick:l,onMousedown:d}},unmounted(t,a){!t._clickOutside||(sw(t,l=>{var d;if(!l||!((d=t._clickOutside)!=null&&d[a.instance.$.uid]))return;const{onClick:m,onMousedown:v}=t._clickOutside[a.instance.$.uid];l.removeEventListener("click",m,!0),l.removeEventListener("mousedown",v,!0)}),delete t._clickOutside[a.instance.$.uid])}};function PD(t){const{modelValue:a,color:l,...d}=t;return O(ks,{name:"fade-transition",appear:!0},{default:()=>[t.modelValue&&O("div",nn({class:["v-overlay__scrim",t.color.backgroundColorClasses.value],style:t.color.backgroundColorStyles.value},d),null)]})}const Tf=Mn({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[String,Boolean],default:!0},zIndex:{type:[Number,String],default:2e3},...fD(),...es(),...fg(),..._D(),...TD(),...Xn(),...fa()},"v-overlay"),dd=Mi()({name:"VOverlay",directives:{ClickOutside:yS},inheritAttrs:!1,props:Tf(),emits:{"click:outside":t=>!0,"update:modelValue":t=>!0,afterLeave:()=>!0},setup(t,a){let{slots:l,attrs:d,emit:m}=a;const v=Tn(t,"modelValue"),b=ne({get:()=>v.value,set:Pe=>{Pe&&t.disabled||(v.value=Pe)}}),{teleportTarget:o}=Jh(ne(()=>t.attach||t.contained)),{themeClasses:w}=yi(t),{rtlClasses:C,isRtl:M}=ha(),{hasContent:L,onAfterLeave:D}=Hy(t,b),V=Yi(ne(()=>typeof t.scrim=="string"?t.scrim:null)),{globalTop:q,localTop:X,stackStyles:xe}=AD(b,Tt(t,"zIndex")),{activatorEl:ce,activatorRef:me,activatorEvents:ee,contentEvents:Ie,scrimEvents:Y}=pD(t,{isActive:b,isTop:X}),{dimensionStyles:ve}=ts(t);Ye(()=>t.disabled,Pe=>{Pe&&(b.value=!1)});const fe=Je(),ge=Je(),{contentStyles:Ee,updateLocation:we}=vD(t,{isRtl:M,contentEl:ge,activatorEl:ce,isActive:b});SD(t,{root:fe,contentEl:ge,activatorEl:ce,isActive:b,updateLocation:we});function Oe(Pe){m("click:outside",Pe),t.persistent?ft():b.value=!1}function ze(){return b.value&&q.value}ki&&Ye(b,Pe=>{Pe?window.addEventListener("keydown",Qe):window.removeEventListener("keydown",Qe)},{immediate:!0});function Qe(Pe){Pe.key==="Escape"&&q.value&&(t.persistent?ft():b.value=!1)}const ht=y2();df(()=>t.closeOnBack,()=>{Sz(ht,Pe=>{q.value&&b.value?(Pe(!1),t.persistent?ft():b.value=!1):Pe()})});const nt=Je();Ye(()=>b.value&&(t.absolute||t.contained)&&o.value==null,Pe=>{if(Pe){const at=JT(fe.value);at&&at!==document.scrollingElement&&(nt.value=at.scrollTop)}});function ft(){t.noClickAnimation||ge.value&&uc(ge.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:uf})}return kt(()=>{var Pe,at;return O(Rn,null,[(Pe=l.activator)==null?void 0:Pe.call(l,{isActive:b.value,props:nn({ref:me},V_(ee.value),t.activatorProps)}),ki&&O(lk,{disabled:!o.value,to:o.value},{default:()=>[L.value&&O("div",nn({class:["v-overlay",{"v-overlay--absolute":t.absolute||t.contained,"v-overlay--active":b.value,"v-overlay--contained":t.contained},w.value,C.value],style:[xe.value,{top:Xt(nt.value)}],ref:fe},d),[O(PD,nn({color:V,modelValue:b.value&&!!t.scrim},V_(Y.value)),null),O(As,{appear:!0,persisted:!0,transition:t.transition,target:ce.value,onAfterLeave:()=>{D(),m("afterLeave")}},{default:()=>[qi(O("div",nn({ref:ge,class:["v-overlay__content",t.contentClass],style:[ve.value,Ee.value]},V_(Ie.value),t.contentProps),[(at=l.default)==null?void 0:at.call(l,{isActive:b})]),[[Ls,b.value],[uo("click-outside"),{handler:Oe,closeConditional:ze,include:()=>[ce.value]}]])]})])]})])}),{activatorEl:ce,animateClick:ft,contentEl:ge,globalTop:q,localTop:X,updateLocation:we}}});function pg(t){return Po(t,Object.keys(dd.props))}const tv=Symbol("Forwarded refs");function is(t){for(var a=arguments.length,l=new Array(a>1?a-1:0),d=1;d<a;d++)l[d-1]=arguments[d];return t[tv]=l,new Proxy(t,{get(m,v){if(Reflect.has(m,v))return Reflect.get(m,v);for(const b of l)if(b.value&&Reflect.has(b.value,v)){const o=Reflect.get(b.value,v);return typeof o=="function"?o.bind(b.value):o}},getOwnPropertyDescriptor(m,v){const b=Reflect.getOwnPropertyDescriptor(m,v);if(b)return b;if(!(typeof v=="symbol"||v.startsWith("__"))){for(const o of l){if(!o.value)continue;const w=Reflect.getOwnPropertyDescriptor(o.value,v);if(w)return w;if("_"in o.value&&"setupState"in o.value._){const C=Reflect.getOwnPropertyDescriptor(o.value._.setupState,v);if(C)return C}}for(const o of l){let w=o.value&&Object.getPrototypeOf(o.value);for(;w;){const C=Reflect.getOwnPropertyDescriptor(w,v);if(C)return C;w=Object.getPrototypeOf(w)}}for(const o of l){const w=o.value&&o.value[tv];if(!w)continue;const C=w.slice();for(;C.length;){const M=C.shift(),L=Reflect.getOwnPropertyDescriptor(M.value,v);if(L)return L;const D=M.value&&M.value[tv];D&&C.push(...D)}}}}})}function mg(){const a=kr("useScopeId").vnode.scopeId;return{scopeId:a?{[a]:""}:void 0}}const gg=Mi()({name:"VMenu",props:{id:String,...ig(Tf({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:lg}}),["absolute"])},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=Tn(t,"modelValue"),{scopeId:m}=mg(),v=Ur(),b=ne(()=>t.id||`v-menu-${v}`),o=Je(),w=ln(Fv,null);let C=0;ji(Fv,{register(){++C},unregister(){--C},closeParents(){setTimeout(()=>{C||(d.value=!1,w==null||w.closeParents())},40)}}),Ye(d,L=>{L?w==null||w.register():w==null||w.unregister()});function M(){w==null||w.closeParents()}return kt(()=>{const[L]=pg(t);return O(dd,nn({ref:o,class:["v-menu"]},L,{modelValue:d.value,"onUpdate:modelValue":D=>d.value=D,absolute:!0,activatorProps:nn({"aria-haspopup":"menu","aria-expanded":String(d.value),"aria-owns":b.value},t.activatorProps),"onClick:outside":M},m),{activator:l.activator,default:function(){for(var D,V=arguments.length,q=new Array(V),X=0;X<V;X++)q[X]=arguments[X];return O(Ti,{root:!0},{default:()=>[(D=l.default)==null?void 0:D.call(l,...q)]})}})}),is({id:b},o)}});const jh=Pt({name:"VFieldLabel",props:{floating:Boolean},setup(t,a){let{slots:l}=a;return kt(()=>O(cd,{class:["v-field-label",{"v-field-label--floating":t.floating}],"aria-hidden":t.floating||void 0},l)),{}}}),zD=["underlined","outlined","filled","solo","plain"],_g=Mn({appendInnerIcon:pn,bgColor:String,clearable:Boolean,clearIcon:{type:pn,default:"$clear"},active:Boolean,color:String,dirty:Boolean,disabled:Boolean,error:Boolean,label:String,persistentClear:Boolean,prependInnerIcon:pn,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:t=>zD.includes(t)},"onClick:clear":Kh,"onClick:appendInner":Kh,"onClick:prependInner":Kh,...Xn(),...Ry()},"v-field"),Sf=Mi()({name:"VField",inheritAttrs:!1,props:{id:String,...dg(),..._g()},emits:{"click:control":t=>!0,"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,a){let{attrs:l,emit:d,slots:m}=a;const{themeClasses:v}=yi(t),{loaderClasses:b}=sg(t),{focusClasses:o,isFocused:w,focus:C,blur:M}=Ac(t),{InputIcon:L}=H2(t),D=ne(()=>t.dirty||t.active),V=ne(()=>!t.singleLine&&!!(t.label||m.label)),q=Ur(),X=ne(()=>t.id||`input-${q}`),xe=Je(),ce=Je(),me=Je(),{backgroundColorClasses:ee,backgroundColorStyles:Ie}=Yi(Tt(t,"bgColor")),{textColorClasses:Y,textColorStyles:ve}=no(ne(()=>D.value&&w.value&&!t.error&&!t.disabled?t.color:void 0));Ye(D,Ee=>{if(V.value){const we=xe.value.$el,Oe=ce.value.$el,ze=Ey(we),Qe=Oe.getBoundingClientRect(),ht=Qe.x-ze.x,nt=Qe.y-ze.y-(ze.height/2-Qe.height/2),ft=Qe.width/.75,Pe=Math.abs(ft-ze.width)>1?{maxWidth:Xt(ft)}:void 0,at=getComputedStyle(we),jt=getComputedStyle(Oe),pt=parseFloat(at.transitionDuration)*1e3||150,zt=parseFloat(jt.getPropertyValue("--v-field-label-scale")),Gt=jt.getPropertyValue("color");we.style.visibility="visible",Oe.style.visibility="hidden",uc(we,{transform:`translate(${ht}px, ${nt}px) scale(${zt})`,color:Gt,...Pe},{duration:pt,easing:uf,direction:Ee?"normal":"reverse"}).finished.then(()=>{we.style.removeProperty("visibility"),Oe.style.removeProperty("visibility")})}},{flush:"post"});const fe=ne(()=>({isActive:D,isFocused:w,controlRef:me,blur:M,focus:C}));function ge(Ee){Ee.target!==document.activeElement&&Ee.preventDefault(),d("click:control",Ee)}return kt(()=>{var Ee,we,Oe;const ze=t.variant==="outlined",Qe=m["prepend-inner"]||t.prependInnerIcon,ht=!!(t.clearable||m.clear),nt=!!(m["append-inner"]||t.appendInnerIcon||ht),ft=m.label?m.label({label:t.label,props:{for:X.value}}):t.label;return O("div",nn({class:["v-field",{"v-field--active":D.value,"v-field--appended":nt,"v-field--disabled":t.disabled,"v-field--dirty":t.dirty,"v-field--error":t.error,"v-field--has-background":!!t.bgColor,"v-field--persistent-clear":t.persistentClear,"v-field--prepended":Qe,"v-field--reverse":t.reverse,"v-field--single-line":t.singleLine,"v-field--no-label":!ft,[`v-field--variant-${t.variant}`]:!0},v.value,ee.value,o.value,b.value],style:[Ie.value,ve.value],onClick:ge},l),[O("div",{class:"v-field__overlay"},null),O(Oy,{name:"v-field",active:t.loading,color:t.error?"error":t.color},{default:m.loader}),Qe&&O("div",{key:"prepend",class:"v-field__prepend-inner"},[t.prependInnerIcon&&O(L,{key:"prepend-icon",name:"prependInner"},null),(Ee=m["prepend-inner"])==null?void 0:Ee.call(m,fe.value)]),O("div",{class:"v-field__field","data-no-activator":""},[["solo","filled"].includes(t.variant)&&V.value&&O(jh,{key:"floating-label",ref:ce,class:[Y.value],floating:!0,for:X.value},{default:()=>[ft]}),O(jh,{ref:xe,for:X.value},{default:()=>[ft]}),(we=m.default)==null?void 0:we.call(m,{...fe.value,props:{id:X.value,class:"v-field__input"},focus:C,blur:M})]),ht&&O(jy,{key:"clear"},{default:()=>[qi(O("div",{class:"v-field__clearable"},[m.clear?m.clear():O(L,{name:"clear"},null)]),[[Ls,t.dirty]])]}),nt&&O("div",{key:"append",class:"v-field__append-inner"},[(Oe=m["append-inner"])==null?void 0:Oe.call(m,fe.value),t.appendInnerIcon&&O(L,{key:"append-icon",name:"appendInner"},null)]),O("div",{class:["v-field__outline",Y.value]},[ze&&O(Rn,null,[O("div",{class:"v-field__outline__start"},null),V.value&&O("div",{class:"v-field__outline__notch"},[O(jh,{ref:ce,floating:!0,for:X.value},{default:()=>[ft]})]),O("div",{class:"v-field__outline__end"},null)]),["plain","underlined"].includes(t.variant)&&V.value&&O(jh,{ref:ce,floating:!0,for:X.value},{default:()=>[ft]})])])}),{controlRef:me}}});function Xy(t){const a=Object.keys(Sf.props).filter(l=>!OT(l));return Po(t,a)}const vg=Pt({name:"VCounter",functional:!0,props:{active:Boolean,max:[Number,String],value:{type:[Number,String],default:0},...fa({transition:{component:Uy}})},setup(t,a){let{slots:l}=a;const d=ne(()=>t.max?`${t.value} / ${t.max}`:String(t.value));return kt(()=>O(As,{transition:t.transition},{default:()=>[qi(O("div",{class:"v-counter"},[l.default?l.default({counter:d.value,max:t.max,value:t.value}):d.value]),[[Ls,t.active]])]})),{}}}),LD=["color","file","time","date","datetime-local","week","month"],yg=Mi()({name:"VTextField",directives:{Intersect:ug},inheritAttrs:!1,props:{autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,hint:String,persistentHint:Boolean,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,type:{type:String,default:"text"},...pa(),..._g()},emits:{"click:control":t=>!0,"click:input":t=>!0,"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,a){let{attrs:l,emit:d,slots:m}=a;const v=Tn(t,"modelValue"),{isFocused:b,focus:o,blur:w}=Ac(t),C=ne(()=>{var Y;return typeof t.counterValue=="function"?t.counterValue(v.value):((Y=v.value)!=null?Y:"").toString().length}),M=ne(()=>{if(l.maxlength)return l.maxlength;if(!(!t.counter||typeof t.counter!="number"&&typeof t.counter!="string"))return t.counter});function L(Y,ve){var fe,ge;!t.autofocus||!Y||(fe=ve[0].target)==null||(ge=fe.focus)==null||ge.call(fe)}const D=Je(),V=Je(),q=Je(),X=ne(()=>LD.includes(t.type)||t.persistentPlaceholder||b.value),xe=ne(()=>t.messages.length?t.messages:b.value||t.persistentHint?t.hint:"");function ce(){if(q.value!==document.activeElement){var Y;(Y=q.value)==null||Y.focus()}b.value||o()}function me(Y){ce(),d("click:control",Y)}function ee(Y){Y.stopPropagation(),ce(),Gi(()=>{v.value=null,Dm(t["onClick:clear"],Y)})}function Ie(Y){v.value=Y.target.value}return kt(()=>{const Y=!!(m.counter||t.counter||t.counterValue),ve=!!(Y||m.details),[fe,ge]=bc(l),[{modelValue:Ee,...we}]=al(t),[Oe]=Xy(t);return O(Ds,nn({ref:D,modelValue:v.value,"onUpdate:modelValue":ze=>v.value=ze,class:["v-text-field",{"v-text-field--prefixed":t.prefix,"v-text-field--suffixed":t.suffix,"v-text-field--flush-details":["plain","underlined"].includes(t.variant)}],"onClick:prepend":t["onClick:prepend"],"onClick:append":t["onClick:append"]},fe,we,{focused:b.value,messages:xe.value}),{...m,default:ze=>{let{id:Qe,isDisabled:ht,isDirty:nt,isReadonly:ft,isValid:Pe}=ze;return O(Sf,nn({ref:V,onMousedown:at=>{at.target!==q.value&&at.preventDefault()},"onClick:control":me,"onClick:clear":ee,"onClick:prependInner":t["onClick:prependInner"],"onClick:appendInner":t["onClick:appendInner"],role:"textbox"},Oe,{id:Qe.value,active:X.value||nt.value,dirty:nt.value||t.dirty,focused:b.value,error:Pe.value===!1}),{...m,default:at=>{let{props:{class:jt,...pt}}=at;const zt=qi(O("input",nn({ref:q,value:v.value,onInput:Ie,autofocus:t.autofocus,readonly:ft.value,disabled:ht.value,name:t.name,placeholder:t.placeholder,size:1,type:t.type,onFocus:ce,onBlur:w},pt,ge),null),[[uo("intersect"),{handler:L},null,{once:!0}]]);return O(Rn,null,[t.prefix&&O("span",{class:"v-text-field__prefix"},[t.prefix]),m.default?O("div",{class:jt,onClick:Gt=>d("click:input",Gt),"data-no-activator":""},[m.default(),zt]):aa(zt,{class:jt}),t.suffix&&O("span",{class:"v-text-field__suffix"},[t.suffix])])}})},details:ve?ze=>{var Qe;return O(Rn,null,[(Qe=m.details)==null?void 0:Qe.call(m,ze),Y&&O(Rn,null,[O("span",null,null),O(vg,{active:t.persistentCounter||b.value,value:C.value,max:M.value},m.counter)])])}:void 0})}),is({},D,V,q)}}),Yy=Mn({chips:Boolean,closableChips:Boolean,eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,menu:Boolean,menuIcon:{type:pn,default:"$dropdown"},menuProps:{type:Object},modelValue:null,multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,readonly:Boolean,...uS({itemChildren:!1})},"select"),DD=Mi()({name:"VSelect",props:{...Yy(),...fa({transition:{component:lg}})},emits:{"update:modelValue":t=>!0,"update:menu":t=>!0},setup(t,a){let{slots:l}=a;const{t:d}=ns(),m=Je(),v=Tn(t,"menu"),{items:b,transformIn:o,transformOut:w}=Wy(t),C=Tn(t,"modelValue",[],ee=>o(ko(ee)),ee=>{var Y;const Ie=w(ee);return t.multiple?Ie:(Y=Ie[0])!=null?Y:null}),M=ne(()=>C.value.map(ee=>b.value.find(Ie=>Ie.value===ee.value)||ee)),L=ne(()=>M.value.map(ee=>ee.props.value)),D=Je();function V(ee){C.value=[],t.openOnClear&&(v.value=!0)}function q(){t.hideNoData&&!b.value.length||t.readonly||(v.value=!v.value)}function X(ee){if(!t.readonly){if(["Enter","ArrowDown"," "].includes(ee.key)&&(v.value=!0),["Escape","Tab"].includes(ee.key)&&(v.value=!1),ee.key==="ArrowDown"){var Ie;(Ie=D.value)==null||Ie.focus("next")}else if(ee.key==="ArrowUp"){var Y;(Y=D.value)==null||Y.focus("prev")}else if(ee.key==="Home"){var ve;(ve=D.value)==null||ve.focus("first")}else if(ee.key==="End"){var fe;(fe=D.value)==null||fe.focus("last")}}}function xe(ee){if(t.multiple){const Ie=L.value.findIndex(Y=>Y===ee.value);if(Ie===-1)C.value=[...C.value,ee];else{const Y=[...C.value];Y.splice(Ie,1),C.value=Y}}else C.value=[ee],v.value=!1}function ce(ee){var Ie;(Ie=D.value)!=null&&Ie.$el.contains(ee.relatedTarget)||(v.value=!1)}function me(ee){if(ee.relatedTarget==null){var Ie;(Ie=m.value)==null||Ie.focus()}}return kt(()=>{const ee=!!(t.chips||l.chip);return O(yg,{ref:m,modelValue:C.value.map(Ie=>Ie.props.value).join(", "),"onUpdate:modelValue":Ie=>{Ie==null&&(C.value=[])},validationValue:C.externalValue,dirty:C.value.length>0,class:["v-select",{"v-select--active-menu":v.value,"v-select--chips":!!t.chips,[`v-select--${t.multiple?"multiple":"single"}`]:!0,"v-select--selected":C.value.length}],appendInnerIcon:t.menuIcon,readonly:!0,"onClick:clear":V,"onClick:control":q,onBlur:ce,onKeydown:X},{...l,default:()=>{var Ie,Y,ve;return O(Rn,null,[O(gg,nn({modelValue:v.value,"onUpdate:modelValue":fe=>v.value=fe,activator:"parent",contentClass:"v-select__content",eager:t.eager,openOnClick:!1,closeOnContentClick:!1,transition:t.transition},t.menuProps),{default:()=>[O(ma,{ref:D,selected:L.value,selectStrategy:t.multiple?"independent":"single-independent",onMousedown:fe=>fe.preventDefault(),onFocusout:me},{default:()=>{var fe;return[!b.value.length&&!t.hideNoData&&((fe=(Ie=l["no-data"])==null?void 0:Ie.call(l))!=null?fe:O(wi,{title:d(t.noDataText)},null)),(Y=l["prepend-item"])==null?void 0:Y.call(l),b.value.map((ge,Ee)=>{var Oe;var we;return(Oe=(we=l.item)==null?void 0:we.call(l,{item:ge,index:Ee,props:nn(ge.props,{onClick:()=>xe(ge)})}))!=null?Oe:O(wi,nn({key:Ee},ge.props,{onClick:()=>xe(ge)}),{prepend:ze=>{let{isSelected:Qe}=ze;return t.multiple&&!t.hideSelected?O(ud,{modelValue:Qe,ripple:!1},null):void 0}})}),(ve=l["append-item"])==null?void 0:ve.call(l)]}})]}),M.value.map((fe,ge)=>{function Ee(Oe){Oe.stopPropagation(),Oe.preventDefault(),xe(fe)}const we={"onClick:close":Ee,modelValue:!0,"onUpdate:modelValue":void 0};return O("div",{key:fe.value,class:"v-select__selection"},[ee?O(Ti,{defaults:{VChip:{closable:t.closableChips,size:"small",text:fe.title}}},{default:()=>[l.chip?l.chip({item:fe,index:ge,props:we}):O(wf,we,null)]}):l.selection?l.selection({item:fe,index:ge}):O("span",{class:"v-select__selection-text"},[fe.title,t.multiple&&ge<M.value.length-1&&O("span",{class:"v-select__selection-comma"},[Yo(",")])])])})])}})}),is({menu:v,select:xe},m)}}),BD=(t,a,l)=>t==null||a==null?-1:t.toString().toLocaleLowerCase().indexOf(a.toString().toLocaleLowerCase()),xS=Mn({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function RD(t,a,l){var w,C;const d=[],m=(w=l==null?void 0:l.default)!=null?w:BD,v=l!=null&&l.filterKeys?ko(l.filterKeys):!1,b=Object.keys((C=l==null?void 0:l.customKeyFilter)!=null?C:{}).length;if(!(t!=null&&t.length))return d;e:for(let M=0;M<t.length;M++){const L=t[M],D={},V={};let q=-1;if(a&&!(l!=null&&l.noFilter)){if(typeof L=="object"){const ce=v||Object.keys(L);for(const me of ce){var o;const ee=Is(L,me,L),Ie=l==null||(o=l.customKeyFilter)==null?void 0:o[me];if(q=Ie?Ie(ee,a,L):m(ee,a,L),q!==-1&&q!==!1)Ie?D[me]=q:V[me]=q;else if((l==null?void 0:l.filterMode)==="every")continue e}}else q=m(L,a,L),q!==-1&&q!==!1&&(V.title=q);const X=Object.keys(V).length,xe=Object.keys(D).length;if(!X&&!xe||(l==null?void 0:l.filterMode)==="union"&&xe!==b&&!X||(l==null?void 0:l.filterMode)==="intersection"&&(xe!==b||!X))continue}d.push({index:M,matches:{...V,...D}})}return d}function bS(t,a,l){const d=ne(()=>typeof(l==null?void 0:l.value)!="string"&&typeof(l==null?void 0:l.value)!="number"?"":String(l.value));return{filteredItems:ne(()=>{const v=Ui(a);return RD(v,d.value,{customKeyFilter:t.customKeyFilter,default:t.customFilter,filterKeys:t.filterKeys,filterMode:t.filterMode,noFilter:t.noFilter}).map(o=>{let{index:w,matches:C}=o;return{item:v[w],matches:C}})})}}function OD(t,a,l){if(Array.isArray(a))throw new Error("Multiple matches is not implemented");return typeof a=="number"&&~a?O(Rn,null,[O("span",{class:"v-autocomplete__unmask"},[t.substr(0,a)]),O("span",{class:"v-autocomplete__mask"},[t.substr(a,l)]),O("span",{class:"v-autocomplete__unmask"},[t.substr(a+l)])]):t}const FD=Mi()({name:"VAutocomplete",props:{search:String,...xS({filterKeys:["title"]}),...Yy(),...fa({transition:!1})},emits:{"update:search":t=>!0,"update:modelValue":t=>!0,"update:menu":t=>!0},setup(t,a){let{slots:l}=a;const{t:d}=ns(),m=Je(),v=Je(!1),b=Je(!0),o=Tn(t,"menu"),{items:w,transformIn:C,transformOut:M}=Wy(t),L=Tn(t,"search",""),D=Tn(t,"modelValue",[],we=>C(ko(we)),we=>{var ze;const Oe=M(we);return t.multiple?Oe:(ze=Oe[0])!=null?ze:null}),{filteredItems:V}=bS(t,w,ne(()=>b.value?void 0:L.value)),q=ne(()=>D.value.map(we=>w.value.find(Oe=>Oe.value===we.value)||we)),X=ne(()=>q.value.map(we=>we.props.value)),xe=Je();function ce(we){D.value=[],t.openOnClear&&(o.value=!0),L.value=""}function me(){t.hideNoData&&!w.value.length||t.readonly||(o.value=!0)}function ee(we){if(!t.readonly){if(["Enter","ArrowDown"].includes(we.key)&&(o.value=!0),["Escape"].includes(we.key)&&(o.value=!1),["Enter","Escape","Tab"].includes(we.key)&&(b.value=!0),we.key==="ArrowDown"){var Oe;(Oe=xe.value)==null||Oe.focus("next")}else if(we.key==="ArrowUp"){var ze;(ze=xe.value)==null||ze.focus("prev")}}}function Ie(we){L.value=we.target.value}function Y(){v.value&&(b.value=!0)}function ve(we){v.value=!0}function fe(we){if(we.relatedTarget==null){var Oe;(Oe=m.value)==null||Oe.focus()}}const ge=Je(!1);function Ee(we){if(t.multiple){const Oe=X.value.findIndex(ze=>ze===we.value);if(Oe===-1)D.value=[...D.value,we],L.value="";else{const ze=[...D.value];ze.splice(Oe,1),D.value=ze}}else D.value=[we],ge.value=!0,l.selection||(L.value=we.title),o.value=!1,b.value=!0,Gi(()=>ge.value=!1)}return Ye(v,we=>{var ze;if(we){var Oe;ge.value=!0,L.value=t.multiple||!!l.selection?"":String((ze=(Oe=q.value.at(-1))==null?void 0:Oe.props.title)!=null?ze:""),b.value=!0,Gi(()=>ge.value=!1)}else o.value=!1,L.value=""}),Ye(L,we=>{!v.value||ge.value||(we&&(o.value=!0),b.value=!we)}),kt(()=>{const we=!!(t.chips||l.chip);return O(yg,{ref:m,modelValue:L.value,"onUpdate:modelValue":Oe=>{Oe==null&&(D.value=[])},validationValue:D.externalValue,dirty:D.value.length>0,onInput:Ie,class:["v-autocomplete",{"v-autocomplete--active-menu":o.value,"v-autocomplete--chips":!!t.chips,[`v-autocomplete--${t.multiple?"multiple":"single"}`]:!0,"v-autocomplete--selection-slot":!!l.selection}],appendInnerIcon:t.menuIcon,readonly:t.readonly,"onClick:clear":ce,"onClick:control":me,"onClick:input":me,onFocus:()=>v.value=!0,onBlur:()=>v.value=!1,onKeydown:ee},{...l,default:()=>{var Oe,ze,Qe;return O(Rn,null,[O(gg,nn({modelValue:o.value,"onUpdate:modelValue":ht=>o.value=ht,activator:"parent",contentClass:"v-autocomplete__content",eager:t.eager,openOnClick:!1,closeOnContentClick:!1,transition:t.transition,onAfterLeave:Y},t.menuProps),{default:()=>[O(ma,{ref:xe,selected:X.value,selectStrategy:t.multiple?"independent":"single-independent",onMousedown:ht=>ht.preventDefault(),onFocusin:ve,onFocusout:fe},{default:()=>{var ht;return[!V.value.length&&!t.hideNoData&&((ht=(Oe=l["no-data"])==null?void 0:Oe.call(l))!=null?ht:O(wi,{title:d(t.noDataText)},null)),(ze=l["prepend-item"])==null?void 0:ze.call(l),V.value.map((nt,ft)=>{var pt;var Pe;let{item:at,matches:jt}=nt;return(pt=(Pe=l.item)==null?void 0:Pe.call(l,{item:at,index:ft,props:nn(at.props,{onClick:()=>Ee(at)})}))!=null?pt:O(wi,nn({key:ft},at.props,{onClick:()=>Ee(at)}),{prepend:zt=>{let{isSelected:Gt}=zt;return t.multiple&&!t.hideSelected?O(ud,{modelValue:Gt,ripple:!1},null):void 0},title:()=>{var Gt;var zt;return b.value?at.title:OD(at.title,jt.title,(Gt=(zt=L.value)==null?void 0:zt.length)!=null?Gt:0)}})}),(Qe=l["append-item"])==null?void 0:Qe.call(l)]}})]}),q.value.map((ht,nt)=>{function ft(at){at.stopPropagation(),at.preventDefault(),Ee(ht)}const Pe={"onClick:close":ft,modelValue:!0,"onUpdate:modelValue":void 0};return O("div",{key:ht.value,class:"v-autocomplete__selection"},[we?O(Ti,{defaults:{VChip:{closable:t.closableChips,size:"small",text:ht.title}}},{default:()=>[l.chip?l.chip({item:ht,index:nt,props:Pe}):O(wf,Pe,null)]}):l.selection?l.selection({item:ht,index:nt}):O("span",{class:"v-autocomplete__selection-text"},[ht.title,t.multiple&&nt<q.value.length-1&&O("span",{class:"v-autocomplete__selection-comma"},[Yo(",")])])])})])}})}),is({isFocused:v,isPristine:b,menu:o,search:L,filteredItems:V,select:Ee},m)}});const VD=Pt({name:"VBadge",inheritAttrs:!1,props:{bordered:Boolean,color:String,content:[Number,String],dot:Boolean,floating:Boolean,icon:pn,inline:Boolean,label:{type:String,default:"$vuetify.badge"},max:[Number,String],modelValue:{type:Boolean,default:!0},offsetX:[Number,String],offsetY:[Number,String],textColor:String,...Cc({location:"top end"}),...Pi(),...Sn(),...Xn(),...fa({transition:"scale-rotate-transition"})},setup(t,a){const{backgroundColorClasses:l,backgroundColorStyles:d}=Yi(Tt(t,"color")),{roundedClasses:m}=Ki(t),{t:v}=ns(),{textColorClasses:b,textColorStyles:o}=no(Tt(t,"textColor")),{themeClasses:w}=i2(),{locationStyles:C}=Ic(t,!0,M=>{var D,V;return(t.floating?t.dot?2:4:t.dot?8:12)+(["top","bottom"].includes(M)?+((D=t.offsetY)!=null?D:0):["left","right"].includes(M)?+((V=t.offsetX)!=null?V:0):0)});return kt(()=>{var M,L,D,V;const q=Number(t.content),X=!t.max||isNaN(q)?t.content:q<=t.max?q:`${t.max}+`,[xe,ce]=Po(a.attrs,["aria-atomic","aria-label","aria-live","role","title"]);return O(t.tag,nn({class:["v-badge",{"v-badge--bordered":t.bordered,"v-badge--dot":t.dot,"v-badge--floating":t.floating,"v-badge--inline":t.inline}]},ce),{default:()=>[O("div",{class:"v-badge__wrapper"},[(M=(L=a.slots).default)==null?void 0:M.call(L),O(As,{transition:t.transition},{default:()=>[qi(O("span",nn({class:["v-badge__badge",w.value,l.value,m.value,b.value],style:[d.value,o.value,t.inline?{}:C.value],"aria-atomic":"true","aria-label":v(t.label,q),"aria-live":"polite",role:"status"},xe),[t.dot?void 0:a.slots.badge?(D=(V=a.slots).badge)==null?void 0:D.call(V):t.icon?O(er,{icon:t.icon},null):X]),[[Ls,t.modelValue]])]})])]})}),{}}});const wS=Pt({name:"VBannerActions",props:{color:String,density:String},setup(t,a){let{slots:l}=a;return rr({VBtn:{color:t.color,density:t.density,variant:"text"}}),kt(()=>{var d;return O("div",{class:"v-banner-actions"},[(d=l.default)==null?void 0:d.call(l)])}),{}}}),TS=zo("v-banner-text"),$D=Pt({name:"VBanner",props:{avatar:String,color:String,icon:pn,lines:String,stacked:Boolean,sticky:Boolean,text:String,...fo(),...gr(),...es(),...sr(),...Cc(),...od(),...Pi(),...Sn(),...Xn()},setup(t,a){let{slots:l}=a;const{borderClasses:d}=Lo(t),{densityClasses:m}=jr(t),{mobile:v}=ag(),{dimensionStyles:b}=ts(t),{elevationClasses:o}=Mr(t),{locationStyles:w}=Ic(t),{positionClasses:C}=sd(t),{roundedClasses:M}=Ki(t),{themeClasses:L}=yi(t),D=Tt(t,"color"),V=Tt(t,"density");rr({VBannerActions:{color:D,density:V}}),kt(()=>{var q;const X=!!(t.text||l.text),xe=!!(l.prepend||t.avatar||t.icon);return O(t.tag,{class:["v-banner",{"v-banner--stacked":t.stacked||v.value,"v-banner--sticky":t.sticky,[`v-banner--${t.lines}-line`]:!!t.lines},d.value,m.value,o.value,C.value,M.value,L.value],style:[b.value,w.value],role:"banner"},{default:()=>[xe&&O(Ti,{key:"prepend",defaults:{VAvatar:{color:D.value,density:V.value,icon:t.icon,image:t.avatar}}},{default:()=>[O("div",{class:"v-banner__prepend"},[l.prepend?l.prepend():(t.avatar||t.icon)&&O(rl,null,null)])]}),O("div",{class:"v-banner__content"},[X&&O(TS,{key:"text"},{default:()=>[l.text?l.text():t.text]}),(q=l.default)==null?void 0:q.call(l)]),l.actions&&O(wS,null,{default:()=>[l.actions()]})]})})}});const SS=zo("v-breadcrumbs-divider","li"),ES=Pt({name:"VBreadcrumbsItem",props:{active:Boolean,activeClass:String,activeColor:String,color:String,disabled:Boolean,title:String,...ad(),...Sn({tag:"li"})},setup(t,a){let{slots:l,attrs:d}=a;const m=xf(t,d),v=ne(()=>{var C;return t.active||((C=m.isActive)==null?void 0:C.value)}),b=ne(()=>v.value?t.activeColor:t.color),{textColorClasses:o,textColorStyles:w}=no(b);return kt(()=>{var C;const M=m.isLink.value?"a":t.tag;return O(M,{class:["v-breadcrumbs-item",{"v-breadcrumbs-item--active":v.value,"v-breadcrumbs-item--disabled":t.disabled,"v-breadcrumbs-item--link":m.isLink.value,[`${t.activeClass}`]:v.value&&t.activeClass},o.value],style:[w.value],href:m.href.value,"aria-current":v.value?"page":void 0,onClick:m.navigate},{default:()=>{var L;return[(L=(C=l.default)==null?void 0:C.call(l))!=null?L:t.title]}})}),{}}}),ND=Mi()({name:"VBreadcrumbs",props:{activeClass:String,activeColor:String,bgColor:String,color:String,disabled:Boolean,divider:{type:String,default:"/"},icon:pn,items:{type:Array,default:()=>[]},...gr(),...Pi(),...Sn({tag:"ul"})},setup(t,a){let{slots:l}=a;const{backgroundColorClasses:d,backgroundColorStyles:m}=Yi(Tt(t,"bgColor")),{densityClasses:v}=jr(t),{roundedClasses:b}=Ki(t);return rr({VBreadcrumbsItem:{activeClass:Tt(t,"activeClass"),activeColor:Tt(t,"activeColor"),color:Tt(t,"color"),disabled:Tt(t,"disabled")}}),kt(()=>{var o;const w=!!(l.prepend||t.icon);return O(t.tag,{class:["v-breadcrumbs",d.value,v.value,b.value],style:m.value},{default:()=>[w&&O(Ti,{key:"prepend",defaults:{VIcon:{icon:t.icon,start:!0}}},{default:()=>[O("div",{class:"v-breadcrumbs__prepend"},[l.prepend?l.prepend():t.icon&&O(er,null,null)])]}),t.items.map((C,M,L)=>{var D;return O(Rn,null,[O(ES,nn({key:M,disabled:M>=L.length-1},typeof C=="string"?{title:C}:C),{default:l.title?()=>{var V;return(V=l.title)==null?void 0:V.call(l,{item:C,index:M})}:void 0}),M<L.length-1&&O(SS,null,{default:()=>{var V;return[(V=(D=l.divider)==null?void 0:D.call(l,{item:C,index:M}))!=null?V:t.divider]}})])}),(o=l.default)==null?void 0:o.call(l)]})}),{}}});const CS=Pt({name:"VCardActions",setup(t,a){let{slots:l}=a;return rr({VBtn:{variant:"text"}}),kt(()=>{var d;return O("div",{class:"v-card-actions"},[(d=l.default)==null?void 0:d.call(l)])}),{}}}),IS=zo("v-card-subtitle"),AS=zo("v-card-title"),kS=vn({name:"VCardItem",props:{appendAvatar:String,appendIcon:pn,prependAvatar:String,prependIcon:pn,subtitle:String,title:String,...gr()},setup(t,a){let{slots:l}=a;return kt(()=>{var d,m,v,b,o;const w=!!(t.prependAvatar||t.prependIcon||l.prepend),C=!!(t.appendAvatar||t.appendIcon||l.append),M=!!(t.title||l.title),L=!!(t.subtitle||l.subtitle);return O("div",{class:"v-card-item"},[w&&O(Ti,{key:"prepend",defaults:{VAvatar:{density:t.density,icon:t.prependIcon,image:t.prependAvatar},VIcon:{density:t.density,icon:t.prependIcon}}},{default:()=>{var D;return[O("div",{class:"v-card-item__prepend"},[(D=(d=l.prepend)==null?void 0:d.call(l))!=null?D:O(rl,null,null)])]}}),O("div",{class:"v-card-item__content"},[M&&O(AS,{key:"title"},{default:()=>{var D;return[(D=(m=l.title)==null?void 0:m.call(l))!=null?D:t.title]}}),L&&O(IS,{key:"subtitle"},{default:()=>{var D;return[(D=(v=l.subtitle)==null?void 0:v.call(l))!=null?D:t.subtitle]}}),(b=l.default)==null?void 0:b.call(l)]),C&&O(Ti,{key:"append",defaults:{VAvatar:{density:t.density,icon:t.appendIcon,image:t.appendAvatar},VIcon:{density:t.density,icon:t.appendIcon}}},{default:()=>{var D;return[O("div",{class:"v-card-item__append"},[(D=(o=l.append)==null?void 0:o.call(l))!=null?D:O(rl,null,null)])]}})])}),{}}}),MS=zo("v-card-text"),hd=Pt({name:"VCard",directives:{Ripple:sl},props:{appendAvatar:String,appendIcon:pn,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:pn,ripple:Boolean,subtitle:String,text:String,title:String,...Xn(),...fo(),...gr(),...es(),...sr(),...Ry(),...Cc(),...od(),...Pi(),...ad(),...Sn(),...Do({variant:"elevated"})},setup(t,a){let{attrs:l,slots:d}=a;const{themeClasses:m}=yi(t),{borderClasses:v}=Lo(t),{colorClasses:b,colorStyles:o,variantClasses:w}=Ec(t),{densityClasses:C}=jr(t),{dimensionStyles:M}=ts(t),{elevationClasses:L}=Mr(t),{loaderClasses:D}=sg(t),{locationStyles:V}=Ic(t),{positionClasses:q}=sd(t),{roundedClasses:X}=Ki(t),xe=xf(t,l),ce=ne(()=>t.link!==!1&&xe.isLink.value),me=ne(()=>!t.disabled&&t.link!==!1&&(t.link||xe.isClickable.value));return kt(()=>{var ee,Ie,Y;const ve=ce.value?"a":t.tag,fe=!!(d.title||t.title),ge=!!(d.subtitle||t.subtitle),Ee=fe||ge,we=!!(d.append||t.appendAvatar||t.appendIcon),Oe=!!(d.prepend||t.prependAvatar||t.prependIcon),ze=!!(d.image||t.image),Qe=Ee||Oe||we,ht=!!(d.text||t.text);return qi(O(ve,{class:["v-card",{"v-card--disabled":t.disabled,"v-card--flat":t.flat,"v-card--hover":t.hover&&!(t.disabled||t.flat),"v-card--link":me.value},m.value,v.value,b.value,C.value,L.value,D.value,q.value,X.value,w.value],style:[o.value,M.value,V.value],href:xe.href.value,onClick:me.value&&xe.navigate},{default:()=>[ze&&O(Ti,{key:"image",defaults:{VImg:{cover:!0,src:t.image}}},{default:()=>{var nt;return[O("div",{class:"v-card__image"},[(nt=(ee=d.image)==null?void 0:ee.call(d))!=null?nt:O(ld,null,null)])]}}),O(Oy,{name:"v-card",active:!!t.loading,color:typeof t.loading=="boolean"?void 0:t.loading},{default:d.loader}),Qe&&O(kS,{key:"item",prependAvatar:t.prependAvatar,prependIcon:t.prependIcon,title:t.title,subtitle:t.subtitle,appendAvatar:t.appendAvatar,appendIcon:t.appendIcon},{default:d.item,prepend:d.prepend,title:d.title,subtitle:d.subtitle,append:d.append}),ht&&O(MS,{key:"text"},{default:()=>{var nt;return[(nt=(Ie=d.text)==null?void 0:Ie.call(d))!=null?nt:t.text]}}),(Y=d.default)==null?void 0:Y.call(d),d.actions&&O(CS,null,{default:d.actions}),Sc(me.value,"v-card")]}),[[uo("ripple"),me.value]])}),{}}});const UD=t=>{const{touchstartX:a,touchendX:l,touchstartY:d,touchendY:m}=t,v=.5,b=16;t.offsetX=l-a,t.offsetY=m-d,Math.abs(t.offsetY)<v*Math.abs(t.offsetX)&&(t.left&&l<a-b&&t.left(t),t.right&&l>a+b&&t.right(t)),Math.abs(t.offsetX)<v*Math.abs(t.offsetY)&&(t.up&&m<d-b&&t.up(t),t.down&&m>d+b&&t.down(t))};function jD(t,a){var l;const d=t.changedTouches[0];a.touchstartX=d.clientX,a.touchstartY=d.clientY,(l=a.start)==null||l.call(a,{originalEvent:t,...a})}function GD(t,a){var l;const d=t.changedTouches[0];a.touchendX=d.clientX,a.touchendY=d.clientY,(l=a.end)==null||l.call(a,{originalEvent:t,...a}),UD(a)}function qD(t,a){var l;const d=t.changedTouches[0];a.touchmoveX=d.clientX,a.touchmoveY=d.clientY,(l=a.move)==null||l.call(a,{originalEvent:t,...a})}function ZD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:t.left,right:t.right,up:t.up,down:t.down,start:t.start,move:t.move,end:t.end};return{touchstart:l=>jD(l,a),touchend:l=>GD(l,a),touchmove:l=>qD(l,a)}}function WD(t,a){var w,C;var l;const d=a.value,m=d!=null&&d.parent?t.parentElement:t,v=(w=d==null?void 0:d.options)!=null?w:{passive:!0},b=(l=a.instance)==null?void 0:l.$.uid;if(!m||!b)return;const o=ZD(a.value);m._touchHandlers=(C=m._touchHandlers)!=null?C:Object.create(null),m._touchHandlers[b]=o,BT(o).forEach(M=>{m.addEventListener(M,o[M],v)})}function HD(t,a){var l,d;const m=(l=a.value)!=null&&l.parent?t.parentElement:t,v=(d=a.instance)==null?void 0:d.$.uid;if(!(m!=null&&m._touchHandlers)||!v)return;const b=m._touchHandlers[v];BT(b).forEach(o=>{m.removeEventListener(o,b[o])}),delete m._touchHandlers[v]}const Ky={mounted:WD,unmounted:HD},PS=Symbol.for("vuetify:v-window"),zS=Symbol.for("vuetify:v-window-group"),LS=Mi()({name:"VWindow",directives:{Touch:Ky},props:{continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:t=>typeof t=="boolean"||t==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{default:"force"},...Sn(),...Xn()},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const{themeClasses:d}=yi(t),{isRtl:m}=ha(),{t:v}=ns(),b=Tc(t,zS),o=Je(),w=ne(()=>m.value?!t.reverse:t.reverse),C=Je(!1),M=ne(()=>{const Ie=t.direction==="vertical"?"y":"x",ve=(w.value?!C.value:C.value)?"-reverse":"";return`v-window-${Ie}${ve}-transition`}),L=Je(0),D=Je(void 0),V=ne(()=>b.items.value.findIndex(Ie=>b.selected.value.includes(Ie.id)));Ye(V,(Ie,Y)=>{const ve=b.items.value.length,fe=ve-1;ve<=2?C.value=Ie<Y:Ie===fe&&Y===0?C.value=!0:Ie===0&&Y===fe?C.value=!1:C.value=Ie<Y}),ji(PS,{transition:M,isReversed:C,transitionCount:L,transitionHeight:D,rootRef:o});const q=ne(()=>t.continuous||V.value!==0),X=ne(()=>t.continuous||V.value!==b.items.value.length-1);function xe(){q.value&&b.prev()}function ce(){X.value&&b.next()}const me=ne(()=>{const Ie=[],Y={icon:m.value?t.nextIcon:t.prevIcon,class:`v-window__${w.value?"right":"left"}`,onClick:b.prev,ariaLabel:v("$vuetify.carousel.prev")};Ie.push(q.value?l.prev?l.prev({props:Y}):O(pr,Y,null):O("div",null,null));const ve={icon:m.value?t.prevIcon:t.nextIcon,class:`v-window__${w.value?"left":"right"}`,onClick:b.next,ariaLabel:v("$vuetify.carousel.next")};return Ie.push(X.value?l.next?l.next({props:ve}):O(pr,ve,null):O("div",null,null)),Ie}),ee=ne(()=>t.touch===!1?t.touch:{...{left:()=>{w.value?xe():ce()},right:()=>{w.value?ce():xe()},start:Y=>{let{originalEvent:ve}=Y;ve.stopPropagation()}},...t.touch===!0?{}:t.touch});return kt(()=>{var Ie,Y;return qi(O(t.tag,{ref:o,class:["v-window",{"v-window--show-arrows-on-hover":t.showArrows==="hover"},d.value]},{default:()=>[O("div",{class:"v-window__container",style:{height:D.value}},[(Ie=l.default)==null?void 0:Ie.call(l,{group:b}),t.showArrows!==!1&&O("div",{class:"v-window__controls"},[me.value])]),(Y=l.additional)==null?void 0:Y.call(l,{group:b})]}),[[uo("touch"),ee.value]])}),{group:b}}}),DS=Pt({name:"VWindowItem",directives:{Touch:Ky},props:{reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...wc(),...fg()},emits:{"group:selected":t=>!0},setup(t,a){let{slots:l}=a;const d=ln(PS),m=td(t,zS),{isBooted:v}=Ny();if(!d||!m)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const b=Je(!1),o=ne(()=>d.isReversed.value?t.reverseTransition!==!1:t.transition!==!1);function w(){!b.value||!d||(b.value=!1,d.transitionCount.value>0&&(d.transitionCount.value-=1,d.transitionCount.value===0&&(d.transitionHeight.value=void 0)))}function C(){if(!(b.value||!d)){if(b.value=!0,d.transitionCount.value===0){var q;d.transitionHeight.value=Xt((q=d.rootRef.value)==null?void 0:q.clientHeight)}d.transitionCount.value+=1}}function M(){w()}function L(q){!b.value||Gi(()=>{!o.value||!b.value||!d||(d.transitionHeight.value=Xt(q.clientHeight))})}const D=ne(()=>{const q=d.isReversed.value?t.reverseTransition:t.transition;return o.value?{name:typeof q!="string"?d.transition.value:q,onBeforeEnter:C,onAfterEnter:w,onEnterCancelled:M,onBeforeLeave:C,onAfterLeave:w,onLeaveCancelled:M,onEnter:L}:!1}),{hasContent:V}=Hy(t,m.isSelected);return kt(()=>{var q;return O(As,{transition:v.value&&D.value},{default:()=>[qi(O("div",{class:["v-window-item",m.selectedClass.value]},[V.value&&((q=l.default)==null?void 0:q.call(l))]),[[Ls,m.isSelected.value]])]})}),{}}}),XD=Pt({name:"VCarousel",props:{color:String,cycle:Boolean,delimiterIcon:{type:pn,default:"$delimiter"},height:{type:[Number,String],default:500},hideDelimiters:Boolean,hideDelimiterBackground:Boolean,interval:{type:[Number,String],default:6e3,validator:t=>t>0},modelValue:null,progress:[Boolean,String],showArrows:{type:[Boolean,String],default:!0,validator:t=>typeof t=="boolean"||t==="hover"},verticalDelimiters:[Boolean,String]},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=Tn(t,"modelValue"),{t:m}=ns(),v=Je();let b=-1;Ye(d,w),Ye(()=>t.interval,w),Ye(()=>t.cycle,C=>{C?w():window.clearTimeout(b)}),On(o);function o(){!t.cycle||!v.value||(b=window.setTimeout(v.value.group.next,+t.interval>0?+t.interval:6e3))}function w(){window.clearTimeout(b),window.requestAnimationFrame(o)}return kt(()=>O(LS,{ref:v,modelValue:d.value,"onUpdate:modelValue":C=>d.value=C,class:["v-carousel",{"v-carousel--hide-delimiter-background":t.hideDelimiterBackground,"v-carousel--vertical-delimiters":t.verticalDelimiters}],style:{height:Xt(t.height)},continuous:!0,mandatory:"force",showArrows:t.showArrows},{default:l.default,additional:C=>{let{group:M}=C;return O(Rn,null,[!t.hideDelimiters&&O("div",{class:"v-carousel__controls",style:{left:t.verticalDelimiters==="left"&&t.verticalDelimiters?0:"auto",right:t.verticalDelimiters==="right"?0:"auto"}},[M.items.value.length>0&&O(Ti,{defaults:{VBtn:{color:t.color,icon:t.delimiterIcon,size:"x-small",variant:"text"}},scoped:!0},{default:()=>[M.items.value.map((L,D)=>{const V={"aria-label":m("$vuetify.carousel.ariaLabel.delimiter",D+1,M.items.value.length),class:[M.isSelected(L.id)&&"v-btn--active"],onClick:()=>M.select(L.id,!0)};return l.item?l.item({props:V,item:L}):O(pr,nn(L,V),null)})]})]),t.progress&&O(By,{class:"v-carousel__progress",color:typeof t.progress=="string"?t.progress:void 0,modelValue:(M.getItemIndex(d.value)+1)/M.items.value.length*100},null)])},prev:l.prev,next:l.next})),{}}}),YD=Pt({name:"VCarouselItem",inheritAttrs:!1,props:{value:null},setup(t,a){let{slots:l,attrs:d}=a;kt(()=>O(DS,{class:"v-carousel-item",value:t.value},{default:()=>[O(ld,d,l)]}))}});const KD=zo("v-code");const JD=Pt({name:"VColorPickerCanvas",props:{color:{type:Object},disabled:Boolean,dotSize:{type:[Number,String],default:10},height:{type:[Number,String],default:150},width:{type:[Number,String],default:300}},emits:{"update:color":t=>!0,"update:position":t=>!0},setup(t,a){let{emit:l}=a;const d=Je(!1),m=Je(!1),v=Je({x:0,y:0}),b=ne(()=>{const{x:q,y:X}=v.value,xe=parseInt(t.dotSize,10)/2;return{width:Xt(t.dotSize),height:Xt(t.dotSize),transform:`translate(${Xt(q-xe)}, ${Xt(X-xe)})`}}),o=Je();function w(q,X,xe){const{left:ce,top:me,width:ee,height:Ie}=xe;v.value={x:Co(q-ce,0,ee),y:Co(X-me,0,Ie)}}function C(q){t.disabled||!o.value||w(q.clientX,q.clientY,o.value.getBoundingClientRect())}function M(q){q.preventDefault(),!t.disabled&&(d.value=!0,window.addEventListener("mousemove",L),window.addEventListener("mouseup",D),window.addEventListener("touchmove",L),window.addEventListener("touchend",D))}function L(q){if(t.disabled||!o.value)return;d.value=!0;const X=hP(q);w(X.clientX,X.clientY,o.value.getBoundingClientRect())}function D(){window.removeEventListener("mousemove",L),window.removeEventListener("mouseup",D),window.removeEventListener("touchmove",L),window.removeEventListener("touchend",D)}Ye(v,()=>{var Ie,Y;var q,X;if(m.value){m.value=!1;return}if(!o.value)return;const{width:xe,height:ce}=o.value.getBoundingClientRect(),{x:me,y:ee}=v.value;l("update:color",{h:(Ie=(q=t.color)==null?void 0:q.h)!=null?Ie:0,s:Co(me,0,xe)/xe,v:1-Co(ee,0,ce)/ce,a:(Y=(X=t.color)==null?void 0:X.a)!=null?Y:1})});function V(){var ee;var q;if(!o.value)return;const X=o.value,xe=X.getContext("2d");if(!xe)return;const ce=xe.createLinearGradient(0,0,X.width,0);ce.addColorStop(0,"hsla(0, 0%, 100%, 1)"),ce.addColorStop(1,`hsla(${(ee=(q=t.color)==null?void 0:q.h)!=null?ee:0}, 100%, 50%, 1)`),xe.fillStyle=ce,xe.fillRect(0,0,X.width,X.height);const me=xe.createLinearGradient(0,0,0,X.height);me.addColorStop(0,"hsla(0, 0%, 100%, 0)"),me.addColorStop(1,"hsla(0, 0%, 0%, 1)"),xe.fillStyle=me,xe.fillRect(0,0,X.width,X.height)}return Ye(()=>{var q;return(q=t.color)==null?void 0:q.h},V,{immediate:!0}),Ye(()=>t.color,()=>{if(d.value){d.value=!1;return}!t.color||(m.value=!0,v.value={x:t.color.s*parseInt(t.width,10),y:(1-t.color.v)*parseInt(t.height,10)})},{deep:!0,immediate:!0}),On(()=>V()),kt(()=>O("div",{class:"v-color-picker-canvas",style:{width:Xt(t.width),height:Xt(t.height)},onClick:C,onMousedown:M,onTouchstart:M},[O("canvas",{ref:o,width:t.width,height:t.height},null),O("div",{class:["v-color-picker-canvas__dot",{"v-color-picker-canvas__dot--disabled":t.disabled}],style:b.value},null)])),{}}});var aw;function dc(t,a){return a.every(l=>t.hasOwnProperty(l))}function BS(t){var l;if(!t)return null;let a=null;if(typeof t=="string"){const d=AP(t);a=ZT(d)}return typeof t=="object"&&(dc(t,["r","g","b"])?a=Iy(t):dc(t,["h","s","l"])?a=GT(t):dc(t,["h","s","v"])&&(a=t)),a!=null?{...a,a:(l=a.a)!=null?l:1}:null}function QD(t,a){if(a){const{a:l,...d}=t;return d}return t}function eB(t,a){if(a==null||typeof a=="string"){const l=WT(t);return t.a===1?l.slice(0,7):l}if(typeof a=="object"){let l;return dc(a,["r","g","b"])?l=rg(t):dc(a,["h","s","l"])?l=jT(t):dc(a,["h","s","v"])&&(l=t),QD(l,!dc(a,["a"]))}return t}const Sm={h:0,s:0,v:1,a:1},Uv={inputProps:{type:"number",min:0},inputs:[{label:"R",max:255,step:1,getValue:t=>Math.round(t.r),getColor:(t,a)=>({...t,r:Number(a)})},{label:"G",max:255,step:1,getValue:t=>Math.round(t.g),getColor:(t,a)=>({...t,g:Number(a)})},{label:"B",max:255,step:1,getValue:t=>Math.round(t.b),getColor:(t,a)=>({...t,b:Number(a)})},{label:"A",max:1,step:.01,getValue:t=>Math.round(t.a*100)/100,getColor:(t,a)=>({...t,a:Number(a)})}],to:rg,from:Iy},tB={...Uv,inputs:(aw=Uv.inputs)==null?void 0:aw.slice(0,3)},jv={inputProps:{type:"number",min:0},inputs:[{label:"H",max:360,step:1,getValue:t=>Math.round(t.h),getColor:(t,a)=>({...t,h:Number(a)})},{label:"S",max:1,step:.01,getValue:t=>Math.round(t.s*100)/100,getColor:(t,a)=>({...t,s:Number(a)})},{label:"L",max:1,step:.01,getValue:t=>Math.round(t.l*100)/100,getColor:(t,a)=>({...t,l:Number(a)})},{label:"A",max:1,step:.01,getValue:t=>Math.round(t.a*100)/100,getColor:(t,a)=>({...t,a:Number(a)})}],to:jT,from:GT},nB={...jv,inputs:jv.inputs.slice(0,3)},RS={inputProps:{type:"text"},inputs:[{label:"HEXA",getValue:t=>t,getColor:(t,a)=>a}],to:WT,from:ZT},iB={...RS,inputs:[{label:"HEX",getValue:t=>t.slice(0,7),getColor:(t,a)=>a}]},hc={rgb:tB,rgba:Uv,hsl:nB,hsla:jv,hex:iB,hexa:RS},rB=t=>{let{label:a,...l}=t;return O("div",{class:"v-color-picker-edit__input"},[O("input",l,null),O("span",null,[a])])},oB=Pt({name:"VColorPickerEdit",props:{color:Object,disabled:Boolean,mode:{type:String,default:"rgba",validator:t=>Object.keys(hc).includes(t)},modes:{type:Array,default:()=>Object.keys(hc),validator:t=>Array.isArray(t)&&t.every(a=>Object.keys(hc).includes(a))}},emits:{"update:color":t=>!0,"update:mode":t=>!0},setup(t,a){let{emit:l}=a;const d=ne(()=>t.modes.map(v=>({...hc[v],name:v}))),m=ne(()=>{var v;const b=d.value.find(w=>w.name===t.mode);if(!b)return[];const o=t.color?b.to(t.color):{};return(v=b.inputs)==null?void 0:v.map(w=>{let{getValue:C,getColor:M,...L}=w;return{...b.inputProps,...L,disabled:t.disabled,value:C(o),onChange:D=>{const V=D.target;!V||l("update:color",b.from(M(o,V.value)))}}})});return kt(()=>{var v;return O("div",{class:"v-color-picker-edit"},[(v=m.value)==null?void 0:v.map(b=>O(rB,b,null)),d.value.length>1&&O(pr,{icon:"$unfold",size:"x-small",variant:"plain",onClick:()=>{const b=d.value.findIndex(o=>o.name===t.mode);l("update:mode",d.value[(b+1)%d.value.length].name)}},null)])}),{}}});const Jy=Symbol.for("vuetify:v-slider");function Gv(t,a,l){const d=l==="vertical",m=a.getBoundingClientRect(),v="touches"in t?t.touches[0]:t;return d?v.clientY-(m.top+m.height/2):v.clientX-(m.left+m.width/2)}function sB(t,a){return"touches"in t&&t.touches.length?t.touches[0][a]:"changedTouches"in t&&t.changedTouches.length?t.changedTouches[0][a]:t[a]}const OS=Mn({disabled:Boolean,error:Boolean,readonly:Boolean,max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:0},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:t=>typeof t=="boolean"||t==="always"},thumbSize:{type:[Number,String],default:20},showTicks:{type:[Boolean,String],default:!1,validator:t=>typeof t=="boolean"||t==="always"},ticks:{type:[Array,Object]},tickSize:{type:[Number,String],default:2},color:String,trackColor:String,trackFillColor:String,trackSize:{type:[Number,String],default:4},direction:{type:String,default:"horizontal",validator:t=>["vertical","horizontal"].includes(t)},reverse:Boolean,...Pi(),...sr({elevation:2})},"slider"),FS=t=>{let{props:a,handleSliderMouseUp:l,handleMouseMove:d,getActiveThumb:m}=t;const{isRtl:v}=ha(),b=ne(()=>v.value!==a.reverse),o=ne(()=>{let At=v.value?"rtl":"ltr";return a.reverse&&(At=At==="rtl"?"ltr":"rtl"),At}),w=ne(()=>parseFloat(a.min)),C=ne(()=>parseFloat(a.max)),M=ne(()=>a.step>0?parseFloat(a.step):0),L=ne(()=>{const At=M.value.toString().trim();return At.includes(".")?At.length-At.indexOf(".")-1:0}),D=ne(()=>parseInt(a.thumbSize,10)),V=ne(()=>parseInt(a.tickSize,10)),q=ne(()=>parseInt(a.trackSize,10)),X=ne(()=>(C.value-w.value)/M.value),xe=Tt(a,"disabled"),ce=ne(()=>a.direction==="vertical"),me=ne(()=>{var At;return a.error||a.disabled?void 0:(At=a.thumbColor)!=null?At:a.color}),ee=ne(()=>{var At;return a.error||a.disabled?void 0:(At=a.trackColor)!=null?At:a.color}),Ie=ne(()=>{var At;return a.error||a.disabled?void 0:(At=a.trackFillColor)!=null?At:a.color}),Y=Je(!1),ve=Je(0),fe=Je(),ge=Je();function Ee(At){if(M.value<=0)return At;const Ke=Co(At,w.value,C.value),xt=w.value%M.value,St=Math.round((Ke-xt)/M.value)*M.value+xt;return parseFloat(Math.min(St,C.value).toFixed(L.value))}function we(At){var Ke;const xt=a.direction==="vertical",St=xt?"top":"left",Nt=xt?"height":"width",fn=xt?"clientY":"clientX",{[St]:Dn,[Nt]:gn}=(Ke=fe.value)==null?void 0:Ke.$el.getBoundingClientRect(),ue=sB(At,fn);let Me=Math.min(Math.max((ue-Dn-ve.value)/gn,0),1)||0;return(xt||b.value)&&(Me=1-Me),Ee(w.value+Me*(C.value-w.value))}let Oe=!1;const ze=At=>{Oe||(ve.value=0,l(we(At))),Y.value=!1,Oe=!1,ve.value=0},Qe=At=>{ge.value=m(At),ge.value&&(ge.value.focus(),Y.value=!0,ge.value.contains(At.target)?(Oe=!0,ve.value=Gv(At,ge.value,a.direction)):(ve.value=0,d(we(At))))},ht={passive:!0,capture:!0};function nt(At){Oe=!0,d(we(At))}function ft(At){At.stopPropagation(),At.preventDefault(),ze(At),window.removeEventListener("mousemove",nt,ht),window.removeEventListener("mouseup",ft)}function Pe(At){var Ke;ze(At),window.removeEventListener("touchmove",nt,ht),(Ke=At.target)==null||Ke.removeEventListener("touchend",Pe)}function at(At){var Ke;Qe(At),window.addEventListener("touchmove",nt,ht),(Ke=At.target)==null||Ke.addEventListener("touchend",Pe,{passive:!1})}function jt(At){At.preventDefault(),Qe(At),window.addEventListener("mousemove",nt,ht),window.addEventListener("mouseup",ft,{passive:!1})}const pt=At=>{const Ke=(At-w.value)/(C.value-w.value)*100;return Co(isNaN(Ke)?0:Ke,0,100)},zt=ne(()=>a.ticks?Array.isArray(a.ticks)?a.ticks.map(At=>({value:At,position:pt(At),label:At.toString()})):Object.keys(a.ticks).map(At=>({value:parseFloat(At),position:pt(parseFloat(At)),label:a.ticks[At]})):X.value!==1/0?cc(X.value+1).map(At=>{const Ke=w.value+At*M.value;return{value:Ke,position:pt(Ke)}}):[]),Gt=ne(()=>zt.value.some(At=>{let{label:Ke}=At;return!!Ke})),zn={activeThumbRef:ge,color:Tt(a,"color"),decimals:L,disabled:xe,direction:Tt(a,"direction"),elevation:Tt(a,"elevation"),hasLabels:Gt,horizontalDirection:o,isReversed:b,min:w,max:C,mousePressed:Y,numTicks:X,onSliderMousedown:jt,onSliderTouchstart:at,parsedTicks:zt,parseMouseMove:we,position:pt,readonly:Tt(a,"readonly"),rounded:Tt(a,"rounded"),roundValue:Ee,showTicks:Tt(a,"showTicks"),startOffset:ve,step:M,thumbSize:D,thumbColor:me,thumbLabel:Tt(a,"thumbLabel"),ticks:Tt(a,"ticks"),tickSize:V,trackColor:ee,trackContainerRef:fe,trackFillColor:Ie,trackSize:q,vertical:ce};return ji(Jy,zn),zn},qv=Pt({name:"VSliderThumb",directives:{Ripple:sl},props:{focused:Boolean,max:{type:Number,required:!0},min:{type:Number,required:!0},modelValue:{type:Number,required:!0},position:{type:Number,required:!0}},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l,emit:d}=a;const m=ln(Jy);if(!m)throw new Error("[Vuetify] v-slider-thumb must be used inside v-slider or v-range-slider");const{thumbColor:v,step:b,vertical:o,disabled:w,thumbSize:C,thumbLabel:M,direction:L,readonly:D,elevation:V,isReversed:q,horizontalDirection:X,mousePressed:xe,decimals:ce}=m,{textColorClasses:me,textColorStyles:ee}=no(v),{pageup:Ie,pagedown:Y,end:ve,home:fe,left:ge,right:Ee,down:we,up:Oe}=Ev,ze=[Ie,Y,ve,fe,ge,Ee,we,Oe],Qe=ne(()=>b.value?[1,2,3]:[1,5,10]);function ht(ft,Pe){if(!ze.includes(ft.key))return;ft.preventDefault();const at=b.value||.1,jt=(t.max-t.min)/at;if([ge,Ee,we,Oe].includes(ft.key)){const zt=(q.value?[ge,Oe]:[Ee,Oe]).includes(ft.key)?1:-1,Gt=ft.shiftKey?2:ft.ctrlKey?1:0;Pe=Pe+zt*at*Qe.value[Gt]}else if(ft.key===fe)Pe=t.min;else if(ft.key===ve)Pe=t.max;else{const pt=ft.key===Y?1:-1;Pe=Pe-pt*at*(jt>100?jt/10:10)}return Math.max(t.min,Math.min(t.max,Pe))}function nt(ft){const Pe=ht(ft,t.modelValue);Pe!=null&&d("update:modelValue",Pe)}return kt(()=>{var ft;const Pe=Xt(o.value?100-t.position:t.position,"%"),at=o.value?"block":"inline",{elevationClasses:jt}=Mr(ne(()=>w.value?void 0:V.value));return O("div",{class:["v-slider-thumb",{"v-slider-thumb--focused":t.focused,"v-slider-thumb--pressed":t.focused&&xe.value}],style:{[`inset-${at}-start`]:`calc(${Pe} - var(--v-slider-thumb-size) / 2)`,"--v-slider-thumb-size":Xt(C.value),direction:o.value?void 0:X.value},role:"slider",tabindex:w.value?-1:0,"aria-valuemin":t.min,"aria-valuemax":t.max,"aria-valuenow":t.modelValue,"aria-readonly":D.value,"aria-orientation":L.value,onKeydown:D.value?void 0:nt},[O("div",{class:["v-slider-thumb__surface",me.value,jt.value],style:{...ee.value}},null),qi(O("div",{class:["v-slider-thumb__ripple",me.value],style:ee.value},null),[[uo("ripple"),!0,null,{circle:!0,center:!0}]]),O(F2,{origin:"bottom center"},{default:()=>{var pt;return[qi(O("div",{class:"v-slider-thumb__label-container"},[O("div",{class:["v-slider-thumb__label"]},[O("div",null,[(pt=(ft=l["thumb-label"])==null?void 0:ft.call(l,{modelValue:t.modelValue}))!=null?pt:t.modelValue.toFixed(b.value?ce.value:1)])])]),[[Ls,M.value&&t.focused||M.value==="always"]])]}})])}),{}}});const VS=Pt({name:"VSliderTrack",props:{start:{type:Number,required:!0},stop:{type:Number,required:!0}},emits:{},setup(t,a){let{slots:l}=a;const d=ln(Jy);if(!d)throw new Error("[Vuetify] v-slider-track must be inside v-slider or v-range-slider");const{color:m,horizontalDirection:v,parsedTicks:b,rounded:o,showTicks:w,tickSize:C,trackColor:M,trackFillColor:L,trackSize:D,vertical:V,min:q,max:X}=d,{roundedClasses:xe}=Ki(o),{backgroundColorClasses:ce,backgroundColorStyles:me}=Yi(L),{backgroundColorClasses:ee,backgroundColorStyles:Ie}=Yi(M),Y=ne(()=>`inset-${V.value?"block-end":"inline-start"}`),ve=ne(()=>V.value?"height":"width"),fe=ne(()=>({[Y.value]:"0%",[ve.value]:"100%"})),ge=ne(()=>t.stop-t.start),Ee=ne(()=>({[Y.value]:Xt(t.start,"%"),[ve.value]:Xt(ge.value,"%")})),we=ne(()=>(V.value?b.value.slice().reverse():b.value).map((ze,Qe)=>{var Pe;var ht;const nt=V.value?"bottom":"margin-inline-start",ft=ze.value!==q.value&&ze.value!==X.value?Xt(ze.position,"%"):void 0;return O("div",{key:ze.value,class:["v-slider-track__tick",{"v-slider-track__tick--filled":ze.position>=t.start&&ze.position<=t.stop,"v-slider-track__tick--first":ze.value===q.value,"v-slider-track__tick--last":ze.value===X.value}],style:{[nt]:ft}},[(ze.label||l["tick-label"])&&O("div",{class:"v-slider-track__tick-label"},[(Pe=(ht=l["tick-label"])==null?void 0:ht.call(l,{tick:ze,index:Qe}))!=null?Pe:ze.label])])}));return kt(()=>O("div",{class:["v-slider-track",xe.value],style:{"--v-slider-track-size":Xt(D.value),"--v-slider-tick-size":Xt(C.value),direction:V.value?void 0:v.value}},[O("div",{class:["v-slider-track__background",ee.value,{"v-slider-track__background--opacity":!!m.value||!L.value}],style:{...fe.value,...Ie.value}},null),O("div",{class:["v-slider-track__fill",ce.value],style:{...Ee.value,...me.value}},null),w.value&&O("div",{class:["v-slider-track__ticks",{"v-slider-track__ticks--always-show":w.value==="always"}]},[we.value])])),{}}}),Zv=Pt({name:"VSlider",props:{...dg(),...OS(),...pa(),modelValue:{type:[Number,String],default:0}},emits:{"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=Je(),{min:m,max:v,mousePressed:b,roundValue:o,onSliderMousedown:w,onSliderTouchstart:C,trackContainerRef:M,position:L,hasLabels:D,readonly:V}=FS({props:t,handleSliderMouseUp:ee=>q.value=o(ee),handleMouseMove:ee=>q.value=o(ee),getActiveThumb:()=>{var ee;return(ee=d.value)==null?void 0:ee.$el}}),q=Tn(t,"modelValue",void 0,ee=>{const Ie=typeof ee=="string"?parseFloat(ee):ee==null?m.value:ee;return o(Ie)}),{isFocused:X,focus:xe,blur:ce}=Ac(t),me=ne(()=>L(q.value));return kt(()=>{const[ee,Ie]=al(t),Y=!!(t.label||l.label||l.prepend);return O(Ds,nn({class:["v-slider",{"v-slider--has-labels":!!l["tick-label"]||D.value,"v-slider--focused":X.value,"v-slider--pressed":b.value,"v-slider--disabled":t.disabled}]},ee,{focused:X.value}),{...l,prepend:Y?ve=>{var Ee;var fe,ge;return O(Rn,null,[((Ee=(fe=l.label)==null?void 0:fe.call(l,ve))!=null?Ee:t.label)?O(cd,{class:"v-slider__label",text:t.label},null):void 0,(ge=l.prepend)==null?void 0:ge.call(l,ve)])}:void 0,default:ve=>{let{id:fe}=ve;return O("div",{class:"v-slider__container",onMousedown:V.value?void 0:w,onTouchstartPassive:V.value?void 0:C},[O("input",{id:fe.value,name:t.name||fe.value,disabled:t.disabled,readonly:t.readonly,tabindex:"-1",value:q.value},null),O(VS,{ref:M,start:0,stop:me.value},{"tick-label":l["tick-label"]}),O(qv,{ref:d,focused:X.value,min:m.value,max:v.value,modelValue:q.value,"onUpdate:modelValue":ge=>q.value=ge,position:me.value,elevation:t.elevation,onFocus:xe,onBlur:ce},{"thumb-label":l["thumb-label"]})])}})}),{}}}),aB=Pt({name:"VColorPickerPreview",props:{color:{type:Object},disabled:Boolean,hideAlpha:Boolean},emits:{"update:color":t=>!0},setup(t,a){let{emit:l}=a;return kt(()=>{var v;var d,m;return O("div",{class:["v-color-picker-preview",{"v-color-picker-preview--hide-alpha":t.hideAlpha}]},[O("div",{class:"v-color-picker-preview__dot"},[O("div",{style:{background:qT((v=t.color)!=null?v:Sm)}},null)]),O("div",{class:"v-color-picker-preview__sliders"},[O(Zv,{class:"v-color-picker-preview__track v-color-picker-preview__hue",modelValue:(d=t.color)==null?void 0:d.h,"onUpdate:modelValue":b=>{var o;return l("update:color",{...(o=t.color)!=null?o:Sm,h:b})},step:0,min:0,max:360,disabled:t.disabled,thumbSize:14,trackSize:8,trackFillColor:"white",hideDetails:!0},null),!t.hideAlpha&&O(Zv,{class:"v-color-picker-preview__track v-color-picker-preview__alpha",modelValue:(m=t.color)==null?void 0:m.a,"onUpdate:modelValue":b=>{var o;return l("update:color",{...(o=t.color)!=null?o:Sm,a:b})},step:0,min:0,max:1,disabled:t.disabled,thumbSize:14,trackSize:8,trackFillColor:"white",hideDetails:!0},null)])])}),{}}});const lB=Object.freeze({base:"#f44336",lighten5:"#ffebee",lighten4:"#ffcdd2",lighten3:"#ef9a9a",lighten2:"#e57373",lighten1:"#ef5350",darken1:"#e53935",darken2:"#d32f2f",darken3:"#c62828",darken4:"#b71c1c",accent1:"#ff8a80",accent2:"#ff5252",accent3:"#ff1744",accent4:"#d50000"}),cB=Object.freeze({base:"#e91e63",lighten5:"#fce4ec",lighten4:"#f8bbd0",lighten3:"#f48fb1",lighten2:"#f06292",lighten1:"#ec407a",darken1:"#d81b60",darken2:"#c2185b",darken3:"#ad1457",darken4:"#880e4f",accent1:"#ff80ab",accent2:"#ff4081",accent3:"#f50057",accent4:"#c51162"}),uB=Object.freeze({base:"#9c27b0",lighten5:"#f3e5f5",lighten4:"#e1bee7",lighten3:"#ce93d8",lighten2:"#ba68c8",lighten1:"#ab47bc",darken1:"#8e24aa",darken2:"#7b1fa2",darken3:"#6a1b9a",darken4:"#4a148c",accent1:"#ea80fc",accent2:"#e040fb",accent3:"#d500f9",accent4:"#aa00ff"}),dB=Object.freeze({base:"#673ab7",lighten5:"#ede7f6",lighten4:"#d1c4e9",lighten3:"#b39ddb",lighten2:"#9575cd",lighten1:"#7e57c2",darken1:"#5e35b1",darken2:"#512da8",darken3:"#4527a0",darken4:"#311b92",accent1:"#b388ff",accent2:"#7c4dff",accent3:"#651fff",accent4:"#6200ea"}),hB=Object.freeze({base:"#3f51b5",lighten5:"#e8eaf6",lighten4:"#c5cae9",lighten3:"#9fa8da",lighten2:"#7986cb",lighten1:"#5c6bc0",darken1:"#3949ab",darken2:"#303f9f",darken3:"#283593",darken4:"#1a237e",accent1:"#8c9eff",accent2:"#536dfe",accent3:"#3d5afe",accent4:"#304ffe"}),fB=Object.freeze({base:"#2196f3",lighten5:"#e3f2fd",lighten4:"#bbdefb",lighten3:"#90caf9",lighten2:"#64b5f6",lighten1:"#42a5f5",darken1:"#1e88e5",darken2:"#1976d2",darken3:"#1565c0",darken4:"#0d47a1",accent1:"#82b1ff",accent2:"#448aff",accent3:"#2979ff",accent4:"#2962ff"}),pB=Object.freeze({base:"#03a9f4",lighten5:"#e1f5fe",lighten4:"#b3e5fc",lighten3:"#81d4fa",lighten2:"#4fc3f7",lighten1:"#29b6f6",darken1:"#039be5",darken2:"#0288d1",darken3:"#0277bd",darken4:"#01579b",accent1:"#80d8ff",accent2:"#40c4ff",accent3:"#00b0ff",accent4:"#0091ea"}),mB=Object.freeze({base:"#00bcd4",lighten5:"#e0f7fa",lighten4:"#b2ebf2",lighten3:"#80deea",lighten2:"#4dd0e1",lighten1:"#26c6da",darken1:"#00acc1",darken2:"#0097a7",darken3:"#00838f",darken4:"#006064",accent1:"#84ffff",accent2:"#18ffff",accent3:"#00e5ff",accent4:"#00b8d4"}),gB=Object.freeze({base:"#009688",lighten5:"#e0f2f1",lighten4:"#b2dfdb",lighten3:"#80cbc4",lighten2:"#4db6ac",lighten1:"#26a69a",darken1:"#00897b",darken2:"#00796b",darken3:"#00695c",darken4:"#004d40",accent1:"#a7ffeb",accent2:"#64ffda",accent3:"#1de9b6",accent4:"#00bfa5"}),_B=Object.freeze({base:"#4caf50",lighten5:"#e8f5e9",lighten4:"#c8e6c9",lighten3:"#a5d6a7",lighten2:"#81c784",lighten1:"#66bb6a",darken1:"#43a047",darken2:"#388e3c",darken3:"#2e7d32",darken4:"#1b5e20",accent1:"#b9f6ca",accent2:"#69f0ae",accent3:"#00e676",accent4:"#00c853"}),vB=Object.freeze({base:"#8bc34a",lighten5:"#f1f8e9",lighten4:"#dcedc8",lighten3:"#c5e1a5",lighten2:"#aed581",lighten1:"#9ccc65",darken1:"#7cb342",darken2:"#689f38",darken3:"#558b2f",darken4:"#33691e",accent1:"#ccff90",accent2:"#b2ff59",accent3:"#76ff03",accent4:"#64dd17"}),yB=Object.freeze({base:"#cddc39",lighten5:"#f9fbe7",lighten4:"#f0f4c3",lighten3:"#e6ee9c",lighten2:"#dce775",lighten1:"#d4e157",darken1:"#c0ca33",darken2:"#afb42b",darken3:"#9e9d24",darken4:"#827717",accent1:"#f4ff81",accent2:"#eeff41",accent3:"#c6ff00",accent4:"#aeea00"}),xB=Object.freeze({base:"#ffeb3b",lighten5:"#fffde7",lighten4:"#fff9c4",lighten3:"#fff59d",lighten2:"#fff176",lighten1:"#ffee58",darken1:"#fdd835",darken2:"#fbc02d",darken3:"#f9a825",darken4:"#f57f17",accent1:"#ffff8d",accent2:"#ffff00",accent3:"#ffea00",accent4:"#ffd600"}),bB=Object.freeze({base:"#ffc107",lighten5:"#fff8e1",lighten4:"#ffecb3",lighten3:"#ffe082",lighten2:"#ffd54f",lighten1:"#ffca28",darken1:"#ffb300",darken2:"#ffa000",darken3:"#ff8f00",darken4:"#ff6f00",accent1:"#ffe57f",accent2:"#ffd740",accent3:"#ffc400",accent4:"#ffab00"}),wB=Object.freeze({base:"#ff9800",lighten5:"#fff3e0",lighten4:"#ffe0b2",lighten3:"#ffcc80",lighten2:"#ffb74d",lighten1:"#ffa726",darken1:"#fb8c00",darken2:"#f57c00",darken3:"#ef6c00",darken4:"#e65100",accent1:"#ffd180",accent2:"#ffab40",accent3:"#ff9100",accent4:"#ff6d00"}),TB=Object.freeze({base:"#ff5722",lighten5:"#fbe9e7",lighten4:"#ffccbc",lighten3:"#ffab91",lighten2:"#ff8a65",lighten1:"#ff7043",darken1:"#f4511e",darken2:"#e64a19",darken3:"#d84315",darken4:"#bf360c",accent1:"#ff9e80",accent2:"#ff6e40",accent3:"#ff3d00",accent4:"#dd2c00"}),SB=Object.freeze({base:"#795548",lighten5:"#efebe9",lighten4:"#d7ccc8",lighten3:"#bcaaa4",lighten2:"#a1887f",lighten1:"#8d6e63",darken1:"#6d4c41",darken2:"#5d4037",darken3:"#4e342e",darken4:"#3e2723"}),EB=Object.freeze({base:"#607d8b",lighten5:"#eceff1",lighten4:"#cfd8dc",lighten3:"#b0bec5",lighten2:"#90a4ae",lighten1:"#78909c",darken1:"#546e7a",darken2:"#455a64",darken3:"#37474f",darken4:"#263238"}),CB=Object.freeze({base:"#9e9e9e",lighten5:"#fafafa",lighten4:"#f5f5f5",lighten3:"#eeeeee",lighten2:"#e0e0e0",lighten1:"#bdbdbd",darken1:"#757575",darken2:"#616161",darken3:"#424242",darken4:"#212121"}),IB=Object.freeze({black:"#000000",white:"#ffffff",transparent:"#ffffff00"}),AB=Object.freeze({red:lB,pink:cB,purple:uB,deepPurple:dB,indigo:hB,blue:fB,lightBlue:pB,cyan:mB,teal:gB,green:_B,lightGreen:vB,lime:yB,yellow:xB,amber:bB,orange:wB,deepOrange:TB,brown:SB,blueGrey:EB,grey:CB,shades:IB});function kB(t){return Object.keys(t).map(a=>{const l=t[a];return l.base?[l.base,l.darken4,l.darken3,l.darken2,l.darken1,l.lighten1,l.lighten2,l.lighten3,l.lighten4,l.lighten5]:[l.black,l.white,l.transparent]})}const MB=Pt({name:"VColorPickerSwatches",props:{swatches:{type:Array,default:()=>kB(AB)},disabled:Boolean,color:Object,maxHeight:[Number,String]},emits:{"update:color":t=>!0},setup(t,a){let{emit:l}=a;return kt(()=>O("div",{class:"v-color-picker-swatches",style:{maxHeight:Xt(t.maxHeight)}},[O("div",null,[t.swatches.map(d=>O("div",{class:"v-color-picker-swatches__swatch"},[d.map(m=>{const v=BS(m);return O("div",{class:"v-color-picker-swatches__color",onClick:()=>v&&l("update:color",v)},[O("div",{style:{background:m}},[t.color&&yf(t.color,v)?O(er,{size:"x-small",icon:"$success",color:PP(m,"#FFFFFF")>2?"white":"black"},null):void 0])])})]))])])),{}}});const $S=Pt({name:"VSheet",props:{color:String,...fo(),...es(),...sr(),...Cc(),...od(),...Pi(),...Sn(),...Xn()},setup(t,a){let{slots:l}=a;const{themeClasses:d}=yi(t),{backgroundColorClasses:m,backgroundColorStyles:v}=Yi(Tt(t,"color")),{borderClasses:b}=Lo(t),{dimensionStyles:o}=ts(t),{elevationClasses:w}=Mr(t),{locationStyles:C}=Ic(t),{positionClasses:M}=sd(t),{roundedClasses:L}=Ki(t);return()=>O(t.tag,{class:["v-sheet",d.value,m.value,b.value,w.value,M.value,L.value],style:[v.value,o.value,C.value]},l)}}),PB=Pt({name:"VColorPicker",inheritAttrs:!1,props:{canvasHeight:{type:[String,Number],default:150},disabled:Boolean,dotSize:{type:[Number,String],default:10},hideCanvas:Boolean,hideSliders:Boolean,hideInputs:Boolean,mode:{type:String,default:"rgba",validator:t=>Object.keys(hc).includes(t)},modes:{type:Array,default:()=>Object.keys(hc),validator:t=>Array.isArray(t)&&t.every(a=>Object.keys(hc).includes(a))},showSwatches:Boolean,swatches:Array,swatchesMaxHeight:{type:[Number,String],default:150},modelValue:{type:[Object,String]},width:{type:[Number,String],default:300},...sr(),...Pi(),...Xn()},emits:{"update:modelValue":t=>!0,"update:mode":t=>!0},setup(t){const a=Tn(t,"mode"),l=Je(null),d=Tn(t,"modelValue",void 0,v=>{let b=BS(v);return b?(l.value&&(b={...b,h:l.value.h},l.value=null),b):null},v=>v?eB(v,t.modelValue):null),m=v=>{d.value=v,l.value=v};return On(()=>{t.modes.includes(a.value)||(a.value=t.modes[0])}),kt(()=>{var v;return O($S,{rounded:t.rounded,elevation:t.elevation,theme:t.theme,class:["v-color-picker"],style:{"--v-color-picker-color-hsv":qT({...(v=d.value)!=null?v:Sm,a:1})},maxWidth:t.width},{default:()=>[!t.hideCanvas&&O(JD,{key:"canvas",color:d.value,"onUpdate:color":m,disabled:t.disabled,dotSize:t.dotSize,width:t.width,height:t.canvasHeight},null),(!t.hideSliders||!t.hideInputs)&&O("div",{key:"controls",class:"v-color-picker__controls"},[!t.hideSliders&&O(aB,{key:"preview",color:d.value,"onUpdate:color":m,hideAlpha:!a.value.endsWith("a"),disabled:t.disabled},null),!t.hideInputs&&O(oB,{key:"edit",modes:t.modes,mode:a.value,"onUpdate:mode":b=>a.value=b,color:d.value,"onUpdate:color":m,disabled:t.disabled},null)]),t.showSwatches&&O(MB,{key:"swatches",color:d.value,"onUpdate:color":m,maxHeight:t.swatchesMaxHeight,swatches:t.swatches,disabled:t.disabled},null)]})}),{}}});function zB(t,a,l){if(Array.isArray(a))throw new Error("Multiple matches is not implemented");return typeof a=="number"&&~a?O(Rn,null,[O("span",{class:"v-combobox__unmask"},[t.substr(0,a)]),O("span",{class:"v-combobox__mask"},[t.substr(a,l)]),O("span",{class:"v-combobox__unmask"},[t.substr(a+l)])]):t}const LB=Mi()({name:"VCombobox",props:{delimiters:Array,...xS({filterKeys:["title"]}),...Yy({hideNoData:!0,returnObject:!0}),...fa({transition:!1})},emits:{"update:modelValue":t=>!0,"update:search":t=>!0,"update:menu":t=>!0},setup(t,a){var ft;var l;let{emit:d,slots:m}=a;const{t:v}=ns(),b=Je(),o=Je(!1),w=Je(!0),C=Tn(t,"menu"),M=Je(-1),L=ne(()=>{var Pe;return(Pe=b.value)==null?void 0:Pe.color}),{items:D,transformIn:V,transformOut:q}=Wy(t),{textColorClasses:X,textColorStyles:xe}=no(L),ce=Tn(t,"modelValue",[],Pe=>V(ko(Pe||[])),Pe=>{var jt;const at=q(Pe);return t.multiple?at:(jt=at[0])!=null?jt:null}),me=Je(t.multiple?"":(ft=(l=ce.value[0])==null?void 0:l.title)!=null?ft:""),ee=ne({get:()=>me.value,set:Pe=>{var at;if(me.value=Pe,t.multiple||(ce.value=[Nu(t,Pe)]),Pe&&t.multiple&&(at=t.delimiters)!=null&&at.length){const jt=Pe.split(new RegExp(`(?:${t.delimiters.join("|")})+`));jt.length>1&&(jt.forEach(pt=>{pt=pt.trim(),pt&&Qe(Nu(t,pt))}),me.value="")}Pe||(M.value=-1),o.value&&(C.value=!0),w.value=!Pe}});Ye(me,Pe=>{d("update:search",Pe)}),Ye(ce,Pe=>{var jt;if(!t.multiple){var at;me.value=(jt=(at=Pe[0])==null?void 0:at.title)!=null?jt:""}});const{filteredItems:Ie}=bS(t,D,ne(()=>w.value?void 0:ee.value)),Y=ne(()=>ce.value.map(Pe=>D.value.find(at=>at.value===Pe.value)||Pe)),ve=ne(()=>Y.value.map(Pe=>Pe.props.value)),fe=ne(()=>Y.value[M.value]),ge=Je();function Ee(Pe){ce.value=[],t.openOnClear&&(C.value=!0)}function we(){t.hideNoData&&!D.value.length||t.readonly||(C.value=!0)}function Oe(Pe){if(t.readonly)return;const at=b.value.selectionStart,jt=ve.value.length;if(M.value>-1&&Pe.preventDefault(),["Enter","ArrowDown"].includes(Pe.key)&&(C.value=!0),["Escape"].includes(Pe.key)&&(C.value=!1),["Enter","Escape","Tab"].includes(Pe.key)&&(w.value=!0),Pe.key==="ArrowDown"){var pt;(pt=ge.value)==null||pt.focus("next")}else if(Pe.key==="ArrowUp"){var zt;(zt=ge.value)==null||zt.focus("prev")}if(!!t.multiple){if(["Backspace","Delete"].includes(Pe.key)){if(M.value<0){Pe.key==="Backspace"&&!ee.value&&(M.value=jt-1);return}Qe(fe.value),Gi(()=>!fe.value&&(M.value=jt-2))}if(Pe.key==="ArrowLeft"){if(M.value<0&&at>0)return;const Gt=M.value>-1?M.value-1:jt-1;Y.value[Gt]?M.value=Gt:(M.value=-1,b.value.setSelectionRange(ee.value.length,ee.value.length))}if(Pe.key==="ArrowRight"){if(M.value<0)return;const Gt=M.value+1;Y.value[Gt]?M.value=Gt:(M.value=-1,b.value.setSelectionRange(0,0))}Pe.key==="Enter"&&(Qe(Nu(t,ee.value)),ee.value="")}}function ze(){o.value&&(w.value=!0)}function Qe(Pe){if(t.multiple){const at=ve.value.findIndex(jt=>jt===Pe.value);if(at===-1)ce.value=[...ce.value,Pe];else{const jt=[...ce.value];jt.splice(at,1),ce.value=jt}ee.value=""}else ce.value=[Pe],me.value=Pe.title,Gi(()=>{C.value=!1,w.value=!0})}function ht(Pe){o.value=!0}function nt(Pe){if(Pe.relatedTarget==null){var at;(at=b.value)==null||at.focus()}}return Ye(Ie,Pe=>{!Pe.length&&t.hideNoData&&(C.value=!1)}),Ye(o,Pe=>{if(Pe)M.value=-1;else{if(C.value=!1,!t.multiple||!ee.value)return;ce.value=[...ce.value,Nu(t,ee.value)],ee.value=""}}),kt(()=>{const Pe=!!(t.chips||m.chip);return O(yg,{ref:b,modelValue:ee.value,"onUpdate:modelValue":[at=>ee.value=at,at=>{at==null&&(ce.value=[])}],validationValue:ce.externalValue,dirty:ce.value.length>0,class:["v-combobox",{"v-combobox--active-menu":C.value,"v-combobox--chips":!!t.chips,"v-combobox--selecting-index":M.value>-1,[`v-combobox--${t.multiple?"multiple":"single"}`]:!0}],appendInnerIcon:t.items.length?t.menuIcon:void 0,readonly:t.readonly,"onClick:clear":Ee,"onClick:control":we,"onClick:input":we,onFocus:()=>o.value=!0,onBlur:()=>o.value=!1,onKeydown:Oe},{...m,default:()=>{var at,jt,pt;return O(Rn,null,[O(gg,nn({modelValue:C.value,"onUpdate:modelValue":zt=>C.value=zt,activator:"parent",contentClass:"v-combobox__content",eager:t.eager,openOnClick:!1,closeOnContentClick:!1,transition:t.transition,onAfterLeave:ze},t.menuProps),{default:()=>[O(ma,{ref:ge,selected:ve.value,selectStrategy:t.multiple?"independent":"single-independent",onMousedown:zt=>zt.preventDefault(),onFocusin:ht,onFocusout:nt},{default:()=>{var zt;return[!Ie.value.length&&!t.hideNoData&&((zt=(at=m["no-data"])==null?void 0:at.call(m))!=null?zt:O(wi,{title:v(t.noDataText)},null)),(jt=m["prepend-item"])==null?void 0:jt.call(m),Ie.value.map((Gt,zn)=>{var St;var At;let{item:Ke,matches:xt}=Gt;return(St=(At=m.item)==null?void 0:At.call(m,{item:Ke,index:zn,props:nn(Ke.props,{onClick:()=>Qe(Ke)})}))!=null?St:O(wi,nn({key:zn},Ke.props,{onClick:()=>Qe(Ke)}),{prepend:Nt=>{let{isSelected:fn}=Nt;return t.multiple&&!t.hideSelected?O(ud,{modelValue:fn,ripple:!1},null):void 0},title:()=>{var fn;var Nt;return w.value?Ke.title:zB(Ke.title,xt.title,(fn=(Nt=ee.value)==null?void 0:Nt.length)!=null?fn:0)}})}),(pt=m["append-item"])==null?void 0:pt.call(m)]}})]}),Y.value.map((zt,Gt)=>{function zn(Ke){Ke.stopPropagation(),Ke.preventDefault(),Qe(zt)}const At={"onClick:close":zn,modelValue:!0,"onUpdate:modelValue":void 0};return O("div",{key:zt.value,class:["v-combobox__selection",Gt===M.value&&["v-combobox__selection--selected",X.value]],style:Gt===M.value?xe.value:{}},[Pe?O(Ti,{defaults:{VChip:{closable:t.closableChips,size:"small",text:zt.title}}},{default:()=>[m.chip?m.chip({item:zt,index:Gt,props:At}):O(wf,At,null)]}):m.selection?m.selection({item:zt,index:Gt}):O("span",{class:"v-combobox__selection-text"},[zt.title,t.multiple&&Gt<Y.value.length-1&&O("span",{class:"v-combobox__selection-comma"},[Yo(",")])])])})])}})}),is({isFocused:o,isPristine:w,menu:C,search:ee,selectionIndex:M,filteredItems:Ie,select:Qe},b)}});const DB=Mi()({name:"VDialog",props:{fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...Tf({origin:"center center",scrollStrategy:"block",transition:{component:lg},zIndex:2400})},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=Tn(t,"modelValue"),{scopeId:m}=mg(),v=Je();function b(o){var w,C;const M=o.relatedTarget,L=o.target;if(M!==L&&(w=v.value)!=null&&w.contentEl&&(C=v.value)!=null&&C.globalTop&&![document,v.value.contentEl].includes(L)&&!v.value.contentEl.contains(L)){const D=[...v.value.contentEl.querySelectorAll('button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])')].filter(X=>!X.hasAttribute("disabled")&&!X.matches('[tabindex="-1"]'));if(!D.length)return;const V=D[0],q=D[D.length-1];M===V?q.focus():V.focus()}}return ki&&Ye(()=>d.value&&t.retainFocus,o=>{o?document.addEventListener("focusin",b):document.removeEventListener("focusin",b)},{immediate:!0}),Ye(d,async o=>{if(await Gi(),o){var w;(w=v.value.contentEl)==null||w.focus({preventScroll:!0})}else{var C;(C=v.value.activatorEl)==null||C.focus({preventScroll:!0})}}),kt(()=>{const[o]=pg(t);return O(dd,nn({ref:v,class:["v-dialog",{"v-dialog--fullscreen":t.fullscreen,"v-dialog--scrollable":t.scrollable}]},o,{modelValue:d.value,"onUpdate:modelValue":w=>d.value=w,"aria-role":"dialog","aria-modal":"true",activatorProps:nn({"aria-haspopup":"dialog","aria-expanded":String(d.value)},t.activatorProps)},m),{activator:l.activator,default:function(){for(var w,C=arguments.length,M=new Array(C),L=0;L<C;L++)M[L]=arguments[L];return O(Ti,{root:!0},{default:()=>[(w=l.default)==null?void 0:w.call(l,...M)]})}})}),is({},v)}});const gf=Symbol.for("vuetify:v-expansion-panel"),BB=["default","accordion","inset","popout"],RB=Pt({name:"VExpansionPanels",props:{color:String,variant:{type:String,default:"default",validator:t=>BB.includes(t)},readonly:Boolean,...ed(),...Sn(),...Xn()},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;Tc(t,gf);const{themeClasses:d}=yi(t),m=ne(()=>t.variant&&`v-expansion-panels--variant-${t.variant}`);return rr({VExpansionPanel:{color:Tt(t,"color")},VExpansionPanelTitle:{readonly:Tt(t,"readonly")}}),kt(()=>O(t.tag,{class:["v-expansion-panels",d.value,m.value]},l)),{}}}),NS=Mn({color:String,expandIcon:{type:pn,default:"$expand"},collapseIcon:{type:pn,default:"$collapse"},hideActions:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean},"VExpansionPanelTitle"),US=Pt({name:"VExpansionPanelTitle",directives:{Ripple:sl},props:{...NS()},setup(t,a){let{slots:l}=a;const d=ln(gf);if(!d)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:m,backgroundColorStyles:v}=Yi(t,"color"),b=ne(()=>({collapseIcon:t.collapseIcon,disabled:d.disabled.value,expanded:d.isSelected.value,expandIcon:t.expandIcon,readonly:t.readonly}));return kt(()=>{var o;return qi(O("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":d.isSelected.value},m.value],style:v.value,type:"button",tabindex:d.disabled.value?-1:void 0,disabled:d.disabled.value,"aria-expanded":d.isSelected.value,onClick:t.readonly?void 0:d.toggle},[O("span",{class:"v-expansion-panel-title__overlay"},null),(o=l.default)==null?void 0:o.call(l,b.value),!t.hideActions&&O("span",{class:"v-expansion-panel-title__icon"},[l.actions?l.actions(b.value):O(er,{icon:d.isSelected.value?t.collapseIcon:t.expandIcon},null)])]),[[uo("ripple"),t.ripple]])}),{}}}),jS=Pt({name:"VExpansionPanelText",props:{...fg()},setup(t,a){let{slots:l}=a;const d=ln(gf);if(!d)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:m,onAfterLeave:v}=Hy(t,d.isSelected);return kt(()=>{var b;return O(cg,{onAfterLeave:v},{default:()=>[qi(O("div",{class:"v-expansion-panel-text"},[l.default&&m.value&&O("div",{class:"v-expansion-panel-text__wrapper"},[(b=l.default)==null?void 0:b.call(l)])]),[[Ls,d.isSelected.value]])]})}),{}}}),OB=Pt({name:"VExpansionPanel",props:{title:String,text:String,bgColor:String,...sr(),...wc(),...fg(),...Pi(),...Sn(),...NS()},emits:{"group:selected":t=>!0},setup(t,a){let{slots:l}=a;const d=td(t,gf),{backgroundColorClasses:m,backgroundColorStyles:v}=Yi(t,"bgColor"),{elevationClasses:b}=Mr(t),{roundedClasses:o}=Ki(t),w=ne(()=>(d==null?void 0:d.disabled.value)||t.disabled),C=ne(()=>d.group.items.value.reduce((D,V,q)=>(d.group.selected.value.includes(V.id)&&D.push(q),D),[])),M=ne(()=>{const D=d.group.items.value.findIndex(V=>V.id===d.id);return!d.isSelected.value&&C.value.some(V=>V-D===1)}),L=ne(()=>{const D=d.group.items.value.findIndex(V=>V.id===d.id);return!d.isSelected.value&&C.value.some(V=>V-D===-1)});return ji(gf,d),kt(()=>{var D;const V=!!(l.text||t.text),q=!!(l.title||t.title);return O(t.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":d.isSelected.value,"v-expansion-panel--before-active":M.value,"v-expansion-panel--after-active":L.value,"v-expansion-panel--disabled":w.value},o.value,m.value],style:v.value,"aria-expanded":d.isSelected.value},{default:()=>[O("div",{class:["v-expansion-panel__shadow",...b.value]},null),q&&O(US,{key:"title",collapseIcon:t.collapseIcon,color:t.color,expandIcon:t.expandIcon,hideActions:t.hideActions,ripple:t.ripple},{default:()=>[l.title?l.title():t.title]}),V&&O(jS,{key:"text",eager:t.eager},{default:()=>[l.text?l.text():t.text]}),(D=l.default)==null?void 0:D.call(l)]})}),{}}});const FB=Pt({name:"VFileInput",inheritAttrs:!1,props:{chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,hint:String,persistentHint:Boolean,placeholder:String,showSize:{type:[Boolean,Number],default:!1,validator:t=>typeof t=="boolean"||[1e3,1024].includes(t)},...pa({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:t=>ko(t).every(a=>a!=null&&typeof a=="object")},..._g({clearable:!0})},emits:{"click:control":t=>!0,"update:modelValue":t=>!0},setup(t,a){let{attrs:l,emit:d,slots:m}=a;const{t:v}=ns(),b=Tn(t,"modelValue"),o=ne(()=>typeof t.showSize!="boolean"?t.showSize:void 0),w=ne(()=>{var Y;return((Y=b.value)!=null?Y:[]).reduce((ve,fe)=>{let{size:ge=0}=fe;return ve+ge},0)}),C=ne(()=>kb(w.value,o.value)),M=ne(()=>{var Y;return((Y=b.value)!=null?Y:[]).map(ve=>{const{name:fe="",size:ge=0}=ve;return t.showSize?`${fe} (${kb(ge,o.value)})`:fe})}),L=ne(()=>{var fe;var Y;const ve=(fe=(Y=b.value)==null?void 0:Y.length)!=null?fe:0;return t.showSize?v(t.counterSizeString,ve,C.value):v(t.counterString,ve)}),D=Je(),V=Je(),q=Je(!1),X=Je(),xe=ne(()=>t.messages.length?t.messages:t.persistentHint?t.hint:"");function ce(){if(X.value!==document.activeElement){var Y;(Y=X.value)==null||Y.focus()}q.value||(q.value=!0)}function me(Y){Dm(t["onClick:prepend"],Y),ee(Y)}function ee(Y){var ve;(ve=X.value)==null||ve.click(),d("click:control",Y)}function Ie(Y){Y.stopPropagation(),ce(),Gi(()=>{b.value=[],X!=null&&X.value&&(X.value.value=""),Dm(t["onClick:clear"],Y)})}return kt(()=>{const Y=!!(m.counter||t.counter),ve=!!(Y||m.details),[fe,ge]=bc(l),[{modelValue:Ee,...we}]=al(t),[Oe]=Xy(t);return O(Ds,nn({ref:D,modelValue:b.value,"onUpdate:modelValue":ze=>b.value=ze,class:"v-file-input","onClick:prepend":me,"onClick:append":t["onClick:append"]},fe,we,{focused:q.value,messages:xe.value}),{...m,default:ze=>{let{isDisabled:Qe,isDirty:ht,isReadonly:nt,isValid:ft}=ze;return O(Sf,nn({ref:V,"prepend-icon":t.prependIcon,"onClick:control":ee,"onClick:clear":Ie,"onClick:prependInner":t["onClick:prependInner"],"onClick:appendInner":t["onClick:appendInner"]},Oe,{active:ht.value||q.value,dirty:ht.value,focused:q.value,error:ft.value===!1}),{...m,default:Pe=>{let{props:{class:at,...jt}}=Pe;return O(Rn,null,[O("input",nn({ref:X,type:"file",readonly:nt.value,disabled:Qe.value,multiple:t.multiple,name:t.name,onClick:pt=>{pt.stopPropagation(),ce()},onChange:pt=>{var Gt;if(!pt.target)return;const zt=pt.target;b.value=[...(Gt=zt.files)!=null?Gt:[]]},onFocus:ce,onBlur:()=>q.value=!1},jt,ge),null),O("div",{class:at},[b.value.length>0&&(m.selection?m.selection({fileNames:M.value,totalBytes:w.value,totalBytesReadable:C.value}):t.chips?M.value.map(pt=>O(wf,{key:pt,size:"small",color:t.color},{default:()=>[pt]})):M.value.join(", "))])])}})},details:ve?ze=>{var Qe;return O(Rn,null,[(Qe=m.details)==null?void 0:Qe.call(m,ze),Y&&O(Rn,null,[O("span",null,null),O(vg,{active:!!b.value.length,value:L.value},m.counter)])])}:void 0})}),is({},D,V,X)}});const VB=Pt({name:"VFooter",props:{app:Boolean,color:String,height:{type:[Number,String],default:"auto"},...fo(),...sr(),...nd(),...Pi(),...Sn({tag:"footer"}),...Xn()},setup(t,a){let{slots:l}=a;const{themeClasses:d}=yi(t),{backgroundColorClasses:m,backgroundColorStyles:v}=Yi(Tt(t,"color")),{borderClasses:b}=Lo(t),{elevationClasses:o}=Mr(t),{roundedClasses:w}=Ki(t),C=Je(32),{resizeRef:M}=gc(V=>{!V.length||(C.value=V[0].target.clientHeight)}),L=ne(()=>t.height==="auto"?C.value:parseInt(t.height,10)),{layoutItemStyles:D}=id({id:t.name,order:ne(()=>parseInt(t.order,10)),position:ne(()=>"bottom"),layoutSize:L,elementSize:ne(()=>t.height==="auto"?void 0:L.value),active:ne(()=>t.app),absolute:Tt(t,"absolute")});return kt(()=>O(t.tag,{ref:M,class:["v-footer",d.value,m.value,b.value,o.value,w.value],style:[v,t.app?D.value:void 0]},l)),{}}}),$B=Pt({name:"VForm",props:{...jL()},emits:{"update:modelValue":t=>!0,submit:t=>!0},setup(t,a){let{slots:l,emit:d}=a;const m=GL(t),v=Je();function b(w){w.preventDefault(),m.reset()}function o(w){const C=w,M=m.validate();C.then=M.then.bind(M),C.catch=M.catch.bind(M),C.finally=M.finally.bind(M),d("submit",C),C.defaultPrevented||M.then(L=>{let{valid:D}=L;if(D){var V;(V=v.value)==null||V.submit()}}),C.preventDefault()}return kt(()=>{var w;return O("form",{ref:v,class:"v-form",novalidate:!0,onReset:b,onSubmit:o},[(w=l.default)==null?void 0:w.call(l,m)])}),is(m,v)}}),NB=Pt({name:"VHover",props:{disabled:Boolean,modelValue:{type:Boolean,default:void 0},...fS()},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=Tn(t,"modelValue"),{runOpenDelay:m,runCloseDelay:v}=pS(t,b=>!t.disabled&&(d.value=b));return()=>{var b;return(b=l.default)==null?void 0:b.call(l,{isHovering:d.value,props:{onMouseenter:m,onMouseleave:v}})}}});const GS=Symbol.for("vuetify:v-item-group"),UB=Pt({name:"VItemGroup",props:{...ed({selectedClass:"v-item--selected"}),...Sn(),...Xn()},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const{themeClasses:d}=yi(t),{isSelected:m,select:v,next:b,prev:o,selected:w}=Tc(t,GS);return()=>{var C;return O(t.tag,{class:["v-item-group",d.value]},{default:()=>[(C=l.default)==null?void 0:C.call(l,{isSelected:m,select:v,next:b,prev:o,selected:w.value})]})}}}),jB=Mi()({name:"VItem",props:wc(),emits:{"group:selected":t=>!0},setup(t,a){let{slots:l}=a;const{isSelected:d,select:m,toggle:v,selectedClass:b,value:o,disabled:w}=td(t,GS);return()=>{var C;return(C=l.default)==null?void 0:C.call(l,{isSelected:d.value,selectedClass:b.value,select:m,toggle:v,value:o.value,disabled:w.value})}}});const GB=zo("v-kbd"),qB=Pt({name:"VLazy",directives:{intersect:ug},props:{modelValue:Boolean,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},...es(),...Sn(),...fa({transition:"fade-transition"})},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const{dimensionStyles:d}=ts(t),m=Tn(t,"modelValue");function v(b){m.value||(m.value=b)}return kt(()=>{var b;return qi(O(t.tag,{class:"v-lazy",style:d.value},{default:()=>[m.value&&O(As,{transition:t.transition},{default:()=>[(b=l.default)==null?void 0:b.call(l)]})]}),[[uo("intersect"),v,t.options]])}),{}}});const ZB=Pt({name:"VLocaleProvider",props:{locale:String,fallbackLocale:String,messages:Object,rtl:{type:Boolean,default:void 0}},setup(t,a){let{slots:l}=a;const{rtlClasses:d}=xz(t);return kt(()=>{var m;return O("div",{class:["v-locale-provider",d.value]},[(m=l.default)==null?void 0:m.call(l)])}),{}}});function WB(t){let{rootEl:a,isSticky:l,layoutItemStyles:d}=t;const m=Je(!1),v=Je(0),b=ne(()=>{const C=typeof m.value=="boolean"?"top":m.value;return[l.value?{top:"auto",bottom:"auto",height:void 0}:void 0,m.value?{[C]:Xt(v.value)}:{top:d.value.top}]});On(()=>{Ye(l,C=>{C?window.addEventListener("scroll",w,{passive:!0}):window.removeEventListener("scroll",w)},{immediate:!0})}),Ei(()=>{document.removeEventListener("scroll",w)});let o=0;function w(){var q;const C=o>window.scrollY?"up":"down",M=a.value.getBoundingClientRect(),L=parseFloat((q=d.value.top)!=null?q:0),D=window.scrollY-Math.max(0,v.value-L),V=M.height+Math.max(v.value,L)-window.scrollY-window.innerHeight;M.height<window.innerHeight-L?(m.value="top",v.value=L):C==="up"&&m.value==="bottom"||C==="down"&&m.value==="top"?(v.value=window.scrollY+M.top,m.value=!0):C==="down"&&V<=0?(v.value=0,m.value="bottom"):C==="up"&&D<=0&&(v.value=M.top+D,m.value="top"),o=window.scrollY}return{isStuck:m,stickyStyles:b}}const HB=100,XB=20;function lw(t){const a=1.41421356237;return(t<0?-1:1)*Math.sqrt(Math.abs(t))*a}function cw(t){if(t.length<2)return 0;if(t.length===2)return t[1].t===t[0].t?0:(t[1].d-t[0].d)/(t[1].t-t[0].t);let a=0;for(let l=t.length-1;l>0;l--){if(t[l].t===t[l-1].t)continue;const d=lw(a),m=(t[l].d-t[l-1].d)/(t[l].t-t[l-1].t);a+=(m-d)*Math.abs(m),l===t.length-1&&(a*=.5)}return lw(a)*1e3}function YB(){const t={};function a(m){Array.from(m.changedTouches).forEach(v=>{var o;((o=t[v.identifier])!=null?o:t[v.identifier]=new dP(XB)).push([m.timeStamp,v])})}function l(m){Array.from(m.changedTouches).forEach(v=>{delete t[v.identifier]})}function d(m){var v;const b=(v=t[m])==null?void 0:v.values().reverse();if(!b)throw new Error(`No samples for touch id ${m}`);const o=b[0],w=[],C=[];for(const M of b){if(o[0]-M[0]>HB)break;w.push({t:M[0],d:M[1].clientX}),C.push({t:M[0],d:M[1].clientY})}return{x:cw(w),y:cw(C),get direction(){const{x:M,y:L}=this,[D,V]=[Math.abs(M),Math.abs(L)];return D>V&&M>=0?"right":D>V&&M<=0?"left":V>D&&L>=0?"down":V>D&&L<=0?"up":KB()}}}return{addMovement:a,endTouch:l,getVelocity:d}}function KB(){throw new Error}function JB(t){let{isActive:a,isTemporary:l,width:d,touchless:m,position:v}=t;On(()=>{window.addEventListener("touchstart",ce,{passive:!0}),window.addEventListener("touchmove",me,{passive:!1}),window.addEventListener("touchend",ee,{passive:!0})}),Ei(()=>{window.removeEventListener("touchstart",ce),window.removeEventListener("touchmove",me),window.removeEventListener("touchend",ee)});const b=ne(()=>v.value!=="bottom"),{addMovement:o,endTouch:w,getVelocity:C}=YB();let M=!1;const L=Je(!1),D=Je(0),V=Je(0);let q;function X(Y,ve){return(v.value==="left"?Y:v.value==="right"?document.documentElement.clientWidth-Y:v.value==="bottom"?document.documentElement.clientHeight-Y:Fu())-(ve?d.value:0)}function xe(Y){let ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const fe=v.value==="left"?(Y-V.value)/d.value:v.value==="right"?(document.documentElement.clientWidth-Y-V.value)/d.value:v.value==="bottom"?(document.documentElement.clientHeight-Y-V.value)/d.value:Fu();return ve?Math.max(0,Math.min(1,fe)):fe}function ce(Y){if(m.value)return;const ve=Y.changedTouches[0].clientX,fe=Y.changedTouches[0].clientY,ge=25,Ee=v.value==="left"?ve<ge:v.value==="right"?ve>document.documentElement.clientWidth-ge:v.value==="bottom"?fe>document.documentElement.clientHeight-ge:Fu(),we=a.value&&(v.value==="left"?ve<d.value:v.value==="right"?ve>document.documentElement.clientWidth-d.value:v.value==="bottom"?fe>document.documentElement.clientHeight-d.value:Fu());(Ee||we||a.value&&l.value)&&(M=!0,q=[ve,fe],V.value=X(b.value?ve:fe,a.value),D.value=xe(b.value?ve:fe),w(Y),o(Y))}function me(Y){const ve=Y.changedTouches[0].clientX,fe=Y.changedTouches[0].clientY;if(M){if(!Y.cancelable){M=!1;return}const Ee=Math.abs(ve-q[0]),we=Math.abs(fe-q[1]);(b.value?Ee>we&&Ee>3:we>Ee&&we>3)?(L.value=!0,M=!1):(b.value?we:Ee)>3&&(M=!1)}if(!L.value)return;Y.preventDefault(),o(Y);const ge=xe(b.value?ve:fe,!1);D.value=Math.max(0,Math.min(1,ge)),ge>1?V.value=X(b.value?ve:fe,!0):ge<0&&(V.value=X(b.value?ve:fe,!1))}function ee(Y){if(M=!1,!L.value)return;o(Y),L.value=!1;const ve=C(Y.changedTouches[0].identifier),fe=Math.abs(ve.x),ge=Math.abs(ve.y);(b.value?fe>ge&&fe>400:ge>fe&&ge>3)?a.value=ve.direction===({left:"right",right:"left",bottom:"up"}[v.value]||Fu()):a.value=D.value>.5}const Ie=ne(()=>L.value?{transform:v.value==="left"?`translateX(calc(-100% + ${D.value*d.value}px))`:v.value==="right"?`translateX(calc(100% - ${D.value*d.value}px))`:v.value==="bottom"?`translateY(calc(100% - ${D.value*d.value}px))`:Fu(),transition:"none"}:void 0);return{isDragging:L,dragProgress:D,dragStyles:Ie}}function Fu(){throw new Error}const QB=["start","end","left","right","bottom"],fd=Pt({name:"VNavigationDrawer",props:{color:String,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,modelValue:{type:Boolean,default:null},permanent:Boolean,rail:Boolean,railWidth:{type:[Number,String],default:56},scrim:{type:[String,Boolean],default:!0},image:String,temporary:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},location:{type:String,default:"start",validator:t=>QB.includes(t)},sticky:Boolean,...fo(),...sr(),...nd(),...Pi(),...Sn({tag:"nav"}),...Xn()},emits:{"update:modelValue":t=>!0},setup(t,a){let{attrs:l,slots:d}=a;const{isRtl:m}=ha(),{themeClasses:v}=yi(t),{borderClasses:b}=Lo(t),{backgroundColorClasses:o,backgroundColorStyles:w}=Yi(Tt(t,"color")),{elevationClasses:C}=Mr(t),{mobile:M}=ag(),{roundedClasses:L}=Ki(t),D=y2(),V=Tn(t,"modelValue",null,ft=>!!ft),{ssrBootStyles:q}=Ny(),X=Je(),xe=Je(!1),ce=ne(()=>t.rail&&t.expandOnHover&&xe.value?Number(t.width):Number(t.rail?t.railWidth:t.width)),me=ne(()=>Iv(t.location,m.value)),ee=ne(()=>!t.permanent&&(M.value||t.temporary)),Ie=ne(()=>t.sticky&&!ee.value&&me.value!=="bottom");t.disableResizeWatcher||Ye(ee,ft=>!t.permanent&&(V.value=!ft)),!t.disableRouteWatcher&&D&&Ye(D.currentRoute,()=>ee.value&&(V.value=!1)),Ye(()=>t.permanent,ft=>{ft&&(V.value=!0)}),Km(()=>{t.modelValue!=null||ee.value||(V.value=t.permanent||!M.value)});const{isDragging:Y,dragProgress:ve,dragStyles:fe}=JB({isActive:V,isTemporary:ee,width:ce,touchless:Tt(t,"touchless"),position:me}),ge=ne(()=>{const ft=ee.value?0:t.rail&&t.expandOnHover?Number(t.railWidth):ce.value;return Y.value?ft*ve.value:ft}),{layoutItemStyles:Ee,layoutRect:we,layoutItemScrimStyles:Oe}=id({id:t.name,order:ne(()=>parseInt(t.order,10)),position:me,layoutSize:ge,elementSize:ce,active:ne(()=>V.value||Y.value),disableTransitions:ne(()=>Y.value),absolute:ne(()=>t.absolute||Ie.value&&typeof ze.value!="string")}),{isStuck:ze,stickyStyles:Qe}=WB({rootEl:X,isSticky:Ie,layoutItemStyles:Ee}),ht=Yi(ne(()=>typeof t.scrim=="string"?t.scrim:null)),nt=ne(()=>({...Y.value?{opacity:ve.value*.2,transition:"none"}:void 0,...we.value?{left:Xt(we.value.left),right:Xt(we.value.right),top:Xt(we.value.top),bottom:Xt(we.value.bottom)}:void 0,...Oe.value}));return rr({VList:{bgColor:"transparent"}}),kt(()=>{var ft,Pe,at,jt;const pt=d.image||t.image;return O(Rn,null,[O(t.tag,nn({ref:X,onMouseenter:()=>xe.value=!0,onMouseleave:()=>xe.value=!1,class:["v-navigation-drawer",`v-navigation-drawer--${me.value}`,{"v-navigation-drawer--expand-on-hover":t.expandOnHover,"v-navigation-drawer--floating":t.floating,"v-navigation-drawer--is-hovering":xe.value,"v-navigation-drawer--rail":t.rail,"v-navigation-drawer--temporary":ee.value,"v-navigation-drawer--active":V.value,"v-navigation-drawer--sticky":Ie.value},v.value,o.value,b.value,C.value,L.value],style:[w.value,Ee.value,fe.value,q.value,Qe.value]},l),{default:()=>[pt&&O("div",{key:"image",class:"v-navigation-drawer__img"},[d.image?(ft=d.image)==null?void 0:ft.call(d,{image:t.image}):O("img",{src:t.image,alt:""},null)]),d.prepend&&O("div",{class:"v-navigation-drawer__prepend"},[(Pe=d.prepend)==null?void 0:Pe.call(d)]),O("div",{class:"v-navigation-drawer__content"},[(at=d.default)==null?void 0:at.call(d)]),d.append&&O("div",{class:"v-navigation-drawer__append"},[(jt=d.append)==null?void 0:jt.call(d)])]}),O(ks,{name:"fade-transition"},{default:()=>[ee.value&&(Y.value||V.value)&&!!t.scrim&&O("div",{class:["v-navigation-drawer__scrim",ht.backgroundColorClasses.value],style:[nt.value,ht.backgroundColorStyles.value],onClick:()=>V.value=!1},null)]})])}),{isStuck:ze}}});function eR(t){var a,l,d;if(!ki)return;const m=kr("useHydration"),v=m==null||(a=m.root)==null||(l=a.appContext)==null||(d=l.app)==null?void 0:d._container;return v!=null&&v.__vue_app__?t():On(t)}const tR=Pt({name:"VNoSsr",setup(t,a){let{slots:l}=a;const d=Je(!1);return eR(()=>d.value=!0),()=>{var m;return d.value&&((m=l.default)==null?void 0:m.call(l))}}});function nR(){const t=Je([]);Qw(()=>t.value=[]);function a(l,d){t.value[d]=l}return{refs:t,updateRef:a}}const iR=Pt({name:"VPagination",props:{activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:t=>t.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:t=>t%1===0},totalVisible:[Number,String],firstIcon:{type:pn,default:"$first"},prevIcon:{type:pn,default:"$prev"},nextIcon:{type:pn,default:"$next"},lastIcon:{type:pn,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...fo(),...gr(),...sr(),...Pi(),...da(),...Sn({tag:"nav"}),...Xn(),...Do({variant:"text"})},emits:{"update:modelValue":t=>!0,first:t=>!0,prev:t=>!0,next:t=>!0,last:t=>!0},setup(t,a){let{slots:l,emit:d}=a;const m=Tn(t,"modelValue"),{t:v,n:b}=ns(),{isRtl:o}=ha(),{themeClasses:w}=yi(t),C=Je(-1);rr(void 0,{scoped:!0});const{resizeRef:M}=gc(ve=>{if(!ve.length)return;const{target:fe,contentRect:ge}=ve[0],Ee=fe.querySelector(".v-pagination__list > *");if(!Ee)return;const we=ge.width,Oe=Ee.offsetWidth+parseFloat(getComputedStyle(Ee).marginRight)*2,ze=t.showFirstLastPage?5:3;C.value=Math.max(0,Math.floor(+((we-Oe*ze)/Oe).toFixed(2)))}),L=ne(()=>parseInt(t.length,10)),D=ne(()=>parseInt(t.start,10)),V=ne(()=>t.totalVisible?parseInt(t.totalVisible,10):C.value>=0?C.value:L.value),q=ne(()=>{if(L.value<=0||isNaN(L.value)||L.value>Number.MAX_SAFE_INTEGER)return[];if(V.value<=1)return[m.value];if(L.value<=V.value)return cc(L.value,D.value);const ve=V.value%2===0,fe=ve?V.value/2:Math.floor(V.value/2),ge=ve?fe:fe+1,Ee=L.value-fe;if(ge-m.value>=0)return[...cc(Math.max(1,V.value-1),D.value),t.ellipsis,L.value];if(m.value-Ee>=(ve?1:0)){const we=V.value-1,Oe=L.value-we+D.value;return[D.value,t.ellipsis,...cc(we,Oe)]}else{const we=Math.max(1,V.value-3),Oe=we===1?m.value:m.value-Math.ceil(we/2)+D.value;return[D.value,t.ellipsis,...cc(we,Oe),t.ellipsis,L.value]}});function X(ve,fe,ge){ve.preventDefault(),m.value=fe,ge&&d(ge,fe)}const{refs:xe,updateRef:ce}=nR();rr({VPaginationBtn:{color:Tt(t,"color"),border:Tt(t,"border"),density:Tt(t,"density"),size:Tt(t,"size"),variant:Tt(t,"variant"),rounded:Tt(t,"rounded"),elevation:Tt(t,"elevation")}});const me=ne(()=>q.value.map((ve,fe)=>{const ge=Ee=>ce(Ee,fe);if(typeof ve=="string")return{isActive:!1,key:`ellipsis-${fe}`,page:ve,props:{ref:ge,ellipsis:!0,icon:!0,disabled:!0}};{const Ee=ve===m.value;return{isActive:Ee,key:ve,page:b(ve),props:{ref:ge,ellipsis:!1,icon:!0,disabled:!!t.disabled||t.length<2,color:Ee?t.activeColor:t.color,ariaCurrent:Ee,ariaLabel:v(Ee?t.currentPageAriaLabel:t.pageAriaLabel,fe+1),onClick:we=>X(we,ve)}}}})),ee=ne(()=>{const ve=!!t.disabled||m.value<=D.value,fe=!!t.disabled||m.value>=D.value+L.value-1;return{first:t.showFirstLastPage?{icon:o.value?t.lastIcon:t.firstIcon,onClick:ge=>X(ge,D.value,"first"),disabled:ve,ariaLabel:v(t.firstAriaLabel),ariaDisabled:ve}:void 0,prev:{icon:o.value?t.nextIcon:t.prevIcon,onClick:ge=>X(ge,m.value-1,"prev"),disabled:ve,ariaLabel:v(t.previousAriaLabel),ariaDisabled:ve},next:{icon:o.value?t.prevIcon:t.nextIcon,onClick:ge=>X(ge,m.value+1,"next"),disabled:fe,ariaLabel:v(t.nextAriaLabel),ariaDisabled:fe},last:t.showFirstLastPage?{icon:o.value?t.firstIcon:t.lastIcon,onClick:ge=>X(ge,D.value+L.value-1,"last"),disabled:fe,ariaLabel:v(t.lastAriaLabel),ariaDisabled:fe}:void 0}});function Ie(){var ve;const fe=m.value-D.value;(ve=xe.value[fe])==null||ve.$el.focus()}function Y(ve){ve.key===Ev.left&&!t.disabled&&m.value>t.start?(m.value=m.value-1,Gi(Ie)):ve.key===Ev.right&&!t.disabled&&m.value<D.value+L.value-1&&(m.value=m.value+1,Gi(Ie))}return kt(()=>O(t.tag,{ref:M,class:["v-pagination",w.value],role:"navigation","aria-label":v(t.ariaLabel),onKeydown:Y,"data-test":"v-pagination-root"},{default:()=>[O("ul",{class:"v-pagination__list"},[t.showFirstLastPage&&O("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[l.first?l.first(ee.value.first):O(pr,nn({_as:"VPaginationBtn"},ee.value.first),null)]),O("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[l.prev?l.prev(ee.value.prev):O(pr,nn({_as:"VPaginationBtn"},ee.value.prev),null)]),me.value.map((ve,fe)=>O("li",{key:ve.key,class:["v-pagination__item",{"v-pagination__item--is-active":ve.isActive}],"data-test":"v-pagination-item"},[l.item?l.item(ve):O(pr,nn({_as:"VPaginationBtn"},ve.props),{default:()=>[ve.page]})])),O("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[l.next?l.next(ee.value.next):O(pr,nn({_as:"VPaginationBtn"},ee.value.next),null)]),t.showFirstLastPage&&O("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[l.last?l.last(ee.value.last):O(pr,nn({_as:"VPaginationBtn"},ee.value.last),null)])])]})),{}}});function rR(t){return Math.floor(Math.abs(t))*Math.sign(t)}const oR=Pt({name:"VParallax",props:{scale:{type:[Number,String],default:.5}},setup(t,a){let{slots:l}=a;const{intersectionRef:d,isIntersecting:m}=Ly(),{resizeRef:v,contentRect:b}=gc(),{height:o}=ag(),w=Je();Ms(()=>{var V;d.value=v.value=(V=w.value)==null?void 0:V.$el});let C;Ye(m,V=>{V?(C=JT(d.value),C=C===document.scrollingElement?document:C,C.addEventListener("scroll",D,{passive:!0}),D()):C.removeEventListener("scroll",D)}),Ei(()=>{var V;(V=C)==null||V.removeEventListener("scroll",D)}),Ye(o,D),Ye(()=>{var V;return(V=b.value)==null?void 0:V.height},D);const M=ne(()=>1-Co(+t.scale));let L=-1;function D(){!m.value||(cancelAnimationFrame(L),L=requestAnimationFrame(()=>{var ve,fe;var V;const q=((V=w.value)==null?void 0:V.$el).querySelector(".v-img__img");if(!q)return;const X=(ve=C.clientHeight)!=null?ve:document.documentElement.clientHeight,xe=(fe=C.scrollTop)!=null?fe:window.scrollY,ce=d.value.offsetTop,me=b.value.height,ee=ce+(me-X)/2,Ie=rR((xe-ee)*M.value),Y=Math.max(1,(M.value*(X-me)+me)/me);q.style.setProperty("transform",`translateY(${Ie}px) scale(${Y})`)}))}return kt(()=>O(ld,{class:["v-parallax",{"v-parallax--active":m.value}],ref:w,cover:!0,onLoadstart:D,onLoad:D},l)),{}}}),sR=Pt({name:"VRadio",props:{...hg({falseIcon:"$radioOff",trueIcon:"$radioOn"})},setup(t,a){let{slots:l}=a;return kt(()=>O(bf,nn(t,{class:"v-radio",type:"radio"}),l)),{}}});const aR=Pt({name:"VRadioGroup",inheritAttrs:!1,props:{height:{type:[Number,String],default:"auto"},...pa(),...ig(Gy(),["multiple"]),trueIcon:{type:pn,default:"$radioOn"},falseIcon:{type:pn,default:"$radioOff"},type:{type:String,default:"radio"}},emits:{"update:modelValue":t=>!0},setup(t,a){let{attrs:l,slots:d}=a;const m=Ur(),v=ne(()=>t.id||`radio-group-${m}`),b=Tn(t,"modelValue");return kt(()=>{const[o,w]=bc(l),[C,M]=al(t),[L,D]=K2({...t,multiple:!1}),V=d.label?d.label({label:t.label,props:{for:v.value}}):t.label;return O(Ds,nn({class:"v-radio-group"},o,C,{modelValue:b.value,"onUpdate:modelValue":q=>b.value=q,id:v.value}),{...d,default:q=>{let{id:X,isDisabled:xe,isReadonly:ce}=q;return O(Rn,null,[V&&O(cd,{for:X.value,clickable:!0},{default:()=>[V]}),O(Y2,nn(L,{id:X.value,defaultsTarget:"VRadio",trueIcon:t.trueIcon,falseIcon:t.falseIcon,type:t.type,disabled:xe.value,readonly:ce.value},w,{modelValue:b.value,"onUpdate:modelValue":me=>b.value=me}),d)])}})}),{}}}),lR=Pt({name:"VRangeSlider",props:{...dg(),...pa(),...OS(),strict:Boolean,modelValue:{type:Array,default:()=>[0,0]}},emits:{"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=Je(),m=Je(),v=Je();function b(fe){if(!d.value||!m.value)return;const ge=Gv(fe,d.value.$el,t.direction),Ee=Gv(fe,m.value.$el,t.direction),we=Math.abs(ge),Oe=Math.abs(Ee);return we<Oe||we===Oe&&ge<0?d.value.$el:m.value.$el}const{activeThumbRef:o,hasLabels:w,max:C,min:M,mousePressed:L,onSliderMousedown:D,onSliderTouchstart:V,position:q,roundValue:X,trackContainerRef:xe}=FS({props:t,handleSliderMouseUp:fe=>{var ge;ce.value=o.value===((ge=d.value)==null?void 0:ge.$el)?[fe,ce.value[1]]:[ce.value[0],fe]},handleMouseMove:fe=>{var ge;const[Ee,we]=ce.value;if(!t.strict&&Ee===we&&Ee!==M.value){var Oe,ze,Qe;o.value=fe>Ee?(Oe=m.value)==null?void 0:Oe.$el:(ze=d.value)==null?void 0:ze.$el,(Qe=o.value)==null||Qe.focus()}o.value===((ge=d.value)==null?void 0:ge.$el)?ce.value=[Math.min(fe,we),we]:ce.value=[Ee,Math.max(Ee,fe)]},getActiveThumb:b}),ce=Tn(t,"modelValue",void 0,fe=>!fe||!fe.length?[0,0]:fe.map(ge=>X(ge))),{isFocused:me,focus:ee,blur:Ie}=Ac(t),Y=ne(()=>q(ce.value[0])),ve=ne(()=>q(ce.value[1]));return kt(()=>{const[fe,ge]=al(t),Ee=!!(t.label||l.label||l.prepend);return O(Ds,nn({class:["v-slider","v-range-slider",{"v-slider--has-labels":!!l["tick-label"]||w.value,"v-slider--focused":me.value,"v-slider--pressed":L.value,"v-slider--disabled":t.disabled}],ref:v},fe,{focused:me.value}),{...l,prepend:Ee?we=>{var Qe;var Oe,ze;return O(Rn,null,[((Qe=(Oe=l.label)==null?void 0:Oe.call(l,we))!=null?Qe:t.label)?O(cd,{class:"v-slider__label",text:t.label},null):void 0,(ze=l.prepend)==null?void 0:ze.call(l,we)])}:void 0,default:we=>{var Oe,ze;let{id:Qe}=we;return O("div",{class:"v-slider__container",onMousedown:D,onTouchstartPassive:V},[O("input",{id:`${Qe.value}_start`,name:t.name||Qe.value,disabled:t.disabled,readonly:t.readonly,tabindex:"-1",value:ce.value[0]},null),O("input",{id:`${Qe.value}_stop`,name:t.name||Qe.value,disabled:t.disabled,readonly:t.readonly,tabindex:"-1",value:ce.value[1]},null),O(VS,{ref:xe,start:Y.value,stop:ve.value},{"tick-label":l["tick-label"]}),O(qv,{ref:d,focused:me&&o.value===((Oe=d.value)==null?void 0:Oe.$el),modelValue:ce.value[0],"onUpdate:modelValue":ht=>ce.value=[ht,ce.value[1]],onFocus:ht=>{var nt,ft;if(ee(),o.value=(nt=d.value)==null?void 0:nt.$el,ce.value[0]===ce.value[1]&&ce.value[1]===M.value&&ht.relatedTarget!==((ft=m.value)==null?void 0:ft.$el)){var Pe,at;(Pe=d.value)==null||Pe.$el.blur(),(at=m.value)==null||at.$el.focus()}},onBlur:()=>{Ie(),o.value=void 0},min:M.value,max:ce.value[1],position:Y.value},{"thumb-label":l["thumb-label"]}),O(qv,{ref:m,focused:me&&o.value===((ze=m.value)==null?void 0:ze.$el),modelValue:ce.value[1],"onUpdate:modelValue":ht=>ce.value=[ce.value[0],ht],onFocus:ht=>{var nt,ft;if(ee(),o.value=(nt=m.value)==null?void 0:nt.$el,ce.value[0]===ce.value[1]&&ce.value[0]===C.value&&ht.relatedTarget!==((ft=d.value)==null?void 0:ft.$el)){var Pe,at;(Pe=m.value)==null||Pe.$el.blur(),(at=d.value)==null||at.$el.focus()}},onBlur:()=>{Ie(),o.value=void 0},min:ce.value[0],max:C.value,position:ve.value},{"thumb-label":l["thumb-label"]})])}})}),{}}});const cR=Mi()({name:"VRating",props:{name:String,itemAriaLabel:{type:String,default:"$vuetify.rating.ariaLabel.item"},activeColor:String,color:String,clearable:Boolean,disabled:Boolean,emptyIcon:{type:pn,default:"$ratingEmpty"},fullIcon:{type:pn,default:"$ratingFull"},halfIncrements:Boolean,hover:Boolean,length:{type:[Number,String],default:5},readonly:Boolean,modelValue:{type:Number,default:0},itemLabels:Array,itemLabelPosition:{type:String,default:"top",validator:t=>["top","bottom"].includes(t)},ripple:Boolean,...gr(),...da(),...Sn(),...Xn()},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const{t:d}=ns(),{themeClasses:m}=yi(t),v=Tn(t,"modelValue"),b=ne(()=>cc(Number(t.length),1)),o=ne(()=>b.value.flatMap(ee=>t.halfIncrements?[ee-.5,ee]:[ee])),w=Je(-1),C=Je(-1),M=Je();let L=!1;const D=ne(()=>o.value.map(ee=>{var Oe;const Ie=t.hover&&w.value>-1,Y=v.value>=ee,ve=w.value>=ee,ge=(Ie?ve:Y)?t.fullIcon:t.emptyIcon,Ee=(Oe=t.activeColor)!=null?Oe:t.color,we=Y||ve?Ee:t.color;return{isFilled:Y,isHovered:ve,icon:ge,color:we}})),V=ne(()=>[0,...o.value].map(ee=>{function Ie(){w.value=ee}function Y(){w.value=-1}function ve(){if(ee===0&&v.value===0){var Ee;(Ee=M.value)==null||Ee.focus()}else C.value=ee}function fe(){L||(C.value=-1)}function ge(){t.disabled||t.readonly||(v.value=v.value===ee&&t.clearable?0:ee)}return{onMouseenter:t.hover?Ie:void 0,onMouseleave:t.hover?Y:void 0,onFocus:ve,onBlur:fe,onClick:ge}}));function q(){L=!0}function X(){L=!1}const xe=ne(()=>{var ee;return(ee=t.name)!=null?ee:`v-rating-${Ur()}`});function ce(ee){var Ie,Y;let{value:ve,index:fe,showStar:ge=!0}=ee;const{onMouseenter:Ee,onMouseleave:we,onFocus:Oe,onBlur:ze,onClick:Qe}=V.value[fe+1],ht=`${xe.value}-${String(ve).replace(".","-")}`,nt={color:(Ie=D.value[fe])==null?void 0:Ie.color,density:t.density,disabled:t.disabled,icon:(Y=D.value[fe])==null?void 0:Y.icon,ripple:t.ripple,size:t.size,tag:"span",variant:"plain"};return O(Rn,null,[O("label",{for:ht,class:{"v-rating__item--half":t.halfIncrements&&ve%1>0,"v-rating__item--full":t.halfIncrements&&ve%1===0},onMousedown:q,onMouseup:X,onMouseenter:Ee,onMouseleave:we},[O("span",{class:"v-rating__hidden"},[d(t.itemAriaLabel,ve,t.length)]),ge?l.item?l.item({...D.value[fe],props:nt,value:ve,index:fe}):O(pr,nt,null):void 0]),O("input",{class:"v-rating__hidden",name:xe.value,id:ht,type:"radio",value:ve,checked:v.value===ve,onClick:Qe,onFocus:Oe,onBlur:ze,ref:fe===0?M:void 0,readonly:t.readonly,disabled:t.disabled},null)])}function me(ee){return l["item-label"]?l["item-label"](ee):ee.label?O("span",null,[ee.label]):O("span",null,[Yo("\xA0")])}return kt(()=>{var ee;const Ie=!!((ee=t.itemLabels)!=null&&ee.length)||l["item-label"];return O(t.tag,{class:["v-rating",{"v-rating--hover":t.hover,"v-rating--readonly":t.readonly},m.value]},{default:()=>[O(ce,{value:0,index:-1,showStar:!1},null),b.value.map((Y,ve)=>{var fe,ge;return O("div",{class:"v-rating__wrapper"},[Ie&&t.itemLabelPosition==="top"?me({value:Y,index:ve,label:(fe=t.itemLabels)==null?void 0:fe[ve]}):void 0,O("div",{class:["v-rating__item",{"v-rating__item--focused":Math.ceil(C.value)===Y}]},[t.halfIncrements?O(Rn,null,[O(ce,{value:Y-.5,index:ve*2},null),O(ce,{value:Y,index:ve*2+1},null)]):O(ce,{value:Y,index:ve},null)]),Ie&&t.itemLabelPosition==="bottom"?me({value:Y,index:ve,label:(ge=t.itemLabels)==null?void 0:ge[ve]}):void 0])})]})}),{}}});function uw(t){const l=Math.abs(t);return Math.sign(t)*(l/((1/.501-2)*(1-l)+1))}function dw(t){let{selectedElement:a,containerSize:l,contentSize:d,isRtl:m,currentScrollOffset:v,isHorizontal:b}=t;const o=b?a.clientWidth:a.clientHeight,w=b?a.offsetLeft:a.offsetTop,C=m&&b?d-w-o:w,M=l+v,L=o+C,D=o*.4;return C<=v?v=Math.max(C-D,0):M<=L&&(v=Math.min(v-(M-L-D),d-l)),v}function uR(t){let{selectedElement:a,containerSize:l,contentSize:d,isRtl:m,isHorizontal:v}=t;const b=v?a.clientWidth:a.clientHeight,o=v?a.offsetLeft:a.offsetTop,w=m&&v?d-o-b/2-l/2:o+b/2-l/2;return Math.min(d-l,Math.max(0,w))}const qS=Symbol.for("vuetify:v-slide-group"),ZS=Mi()({name:"VSlideGroup",props:{centerActive:Boolean,direction:{type:String,default:"horizontal"},symbol:{type:null,default:qS},nextIcon:{type:pn,default:"$next"},prevIcon:{type:pn,default:"$prev"},showArrows:{type:[Boolean,String],validator:t=>typeof t=="boolean"||["always","desktop","mobile"].includes(t)},...Sn(),...ed({selectedClass:"v-slide-group-item--active"})},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const{isRtl:d}=ha(),{mobile:m}=ag(),v=Tc(t,t.symbol),b=Je(!1),o=Je(0),w=Je(0),C=Je(0),M=ne(()=>t.direction==="horizontal"),{resizeRef:L,contentRect:D}=gc(),{resizeRef:V,contentRect:q}=gc(),X=ne(()=>v.selected.value.length?v.items.value.findIndex(pt=>pt.id===v.selected.value[0]):-1),xe=ne(()=>v.selected.value.length?v.items.value.findIndex(pt=>pt.id===v.selected.value[v.selected.value.length-1]):-1);if(ki){let pt=-1;Ye(()=>[v.selected.value,D.value,q.value,M.value],()=>{cancelAnimationFrame(pt),pt=requestAnimationFrame(()=>{if(D.value&&q.value){const zt=M.value?"width":"height";w.value=D.value[zt],C.value=q.value[zt],b.value=w.value+1<C.value}if(X.value>=0&&V.value){const zt=V.value.children[xe.value];X.value===0||!b.value?o.value=0:t.centerActive?o.value=uR({selectedElement:zt,containerSize:w.value,contentSize:C.value,isRtl:d.value,isHorizontal:M.value}):b.value&&(o.value=dw({selectedElement:zt,containerSize:w.value,contentSize:C.value,isRtl:d.value,currentScrollOffset:o.value,isHorizontal:M.value}))}})})}const ce=Je(!1);let me=0,ee=0;function Ie(pt){const zt=M.value?"clientX":"clientY";ee=(d.value&&M.value?-1:1)*o.value,me=pt.touches[0][zt],ce.value=!0}function Y(pt){if(!b.value)return;const zt=M.value?"clientX":"clientY",Gt=d.value&&M.value?-1:1;o.value=Gt*(ee+me-pt.touches[0][zt])}function ve(pt){const zt=C.value-w.value;o.value<0||!b.value?o.value=0:o.value>=zt&&(o.value=zt),ce.value=!1}function fe(){!L.value||(L.value[M.value?"scrollLeft":"scrollTop"]=0)}const ge=Je(!1);function Ee(pt){if(ge.value=!0,!(!b.value||!V.value)){for(const zt of pt.composedPath())for(const Gt of V.value.children)if(Gt===zt){o.value=dw({selectedElement:Gt,containerSize:w.value,contentSize:C.value,isRtl:d.value,currentScrollOffset:o.value,isHorizontal:M.value});return}}}function we(pt){ge.value=!1}function Oe(pt){var zt;!ge.value&&!(pt.relatedTarget&&(zt=V.value)!=null&&zt.contains(pt.relatedTarget))&&Qe()}function ze(pt){!V.value||(M.value?pt.key==="ArrowRight"?Qe(d.value?"prev":"next"):pt.key==="ArrowLeft"&&Qe(d.value?"next":"prev"):pt.key==="ArrowDown"?Qe("next"):pt.key==="ArrowUp"&&Qe("prev"),pt.key==="Home"?Qe("first"):pt.key==="End"&&Qe("last"))}function Qe(pt){if(!!V.value)if(pt){if(pt==="next"){var Gt;const xt=(Gt=V.value.querySelector(":focus"))==null?void 0:Gt.nextElementSibling;xt?xt.focus():Qe("first")}else if(pt==="prev"){var zn;const xt=(zn=V.value.querySelector(":focus"))==null?void 0:zn.previousElementSibling;xt?xt.focus():Qe("last")}else if(pt==="first"){var At;(At=V.value.firstElementChild)==null||At.focus()}else if(pt==="last"){var Ke;(Ke=V.value.lastElementChild)==null||Ke.focus()}}else{var zt;(zt=[...V.value.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')].filter(St=>!St.hasAttribute("disabled"))[0])==null||zt.focus()}}function ht(pt){const zt=o.value+(pt==="prev"?-1:1)*w.value;o.value=Co(zt,0,C.value-w.value)}const nt=ne(()=>{let pt=o.value>C.value-w.value?-(C.value-w.value)+uw(C.value-w.value-o.value):-o.value;o.value<=0&&(pt=uw(-o.value));const zt=d.value&&M.value?-1:1;return{transform:`translate${M.value?"X":"Y"}(${zt*pt}px)`,transition:ce.value?"none":"",willChange:ce.value?"transform":""}}),ft=ne(()=>({next:v.next,prev:v.prev,select:v.select,isSelected:v.isSelected})),Pe=ne(()=>{switch(t.showArrows){case"always":return!0;case"desktop":return!m.value;case!0:return b.value||Math.abs(o.value)>0;case"mobile":return m.value||b.value||Math.abs(o.value)>0;default:return!m.value&&(b.value||Math.abs(o.value)>0)}}),at=ne(()=>Math.abs(o.value)>0),jt=ne(()=>C.value>Math.abs(o.value)+w.value);return kt(()=>{var pt,zt,Gt;return O(t.tag,{class:["v-slide-group",{"v-slide-group--vertical":!M.value,"v-slide-group--has-affixes":Pe.value,"v-slide-group--is-overflowing":b.value}],tabindex:ge.value||v.selected.value.length?-1:0,onFocus:Oe},{default:()=>{var zn,At;return[Pe.value&&O("div",{key:"prev",class:["v-slide-group__prev",{"v-slide-group__prev--disabled":!at.value}],onClick:()=>ht("prev")},[(zn=(pt=l.prev)==null?void 0:pt.call(l,ft.value))!=null?zn:O(Rv,null,{default:()=>[O(er,{icon:d.value?t.nextIcon:t.prevIcon},null)]})]),O("div",{key:"container",ref:L,class:"v-slide-group__container",onScroll:fe},[O("div",{ref:V,class:"v-slide-group__content",style:nt.value,onTouchstartPassive:Ie,onTouchmovePassive:Y,onTouchendPassive:ve,onFocusin:Ee,onFocusout:we,onKeydown:ze},[(zt=l.default)==null?void 0:zt.call(l,ft.value)])]),Pe.value&&O("div",{key:"next",class:["v-slide-group__next",{"v-slide-group__next--disabled":!jt.value}],onClick:()=>ht("next")},[(At=(Gt=l.next)==null?void 0:Gt.call(l,ft.value))!=null?At:O(Rv,null,{default:()=>[O(er,{icon:d.value?t.prevIcon:t.nextIcon},null)]})])]}})}),{selected:v.selected,scrollTo:ht,scrollOffset:o,focus:Qe}}}),dR=Mi()({name:"VSlideGroupItem",props:{...wc()},emits:{"group:selected":t=>!0},setup(t,a){let{slots:l}=a;const d=td(t,qS);return()=>{var m;return(m=l.default)==null?void 0:m.call(l,{isSelected:d.isSelected.value,select:d.select,toggle:d.toggle,selectedClass:d.selectedClass.value})}}});const hR=Mi()({name:"VSnackbar",props:{multiLine:Boolean,timeout:{type:[Number,String],default:5e3},vertical:Boolean,...Cc({location:"bottom"}),...od(),...Pi(),...Do(),...ig(Tf({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=Tn(t,"modelValue"),{locationStyles:m}=Ic(t),{positionClasses:v}=sd(t),{scopeId:b}=mg(),{colorClasses:o,colorStyles:w,variantClasses:C}=Ec(t),{roundedClasses:M}=Ki(t),L=Je();Ye(d,V),Ye(()=>t.timeout,V),On(()=>{d.value&&V()});let D=-1;function V(){window.clearTimeout(D);const X=Number(t.timeout);!d.value||X===-1||(D=window.setTimeout(()=>{d.value=!1},X))}function q(){window.clearTimeout(D)}return kt(()=>{const[X]=pg(t);return O(dd,nn({ref:L,class:["v-snackbar",{"v-snackbar--active":d.value,"v-snackbar--multi-line":t.multiLine&&!t.vertical,"v-snackbar--vertical":t.vertical},v.value]},X,{modelValue:d.value,"onUpdate:modelValue":xe=>d.value=xe,contentProps:nn({style:m.value},X.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none"},b),{default:()=>[O("div",{class:["v-snackbar__wrapper",o.value,M.value,C.value],style:[w.value],onPointerenter:q,onPointerleave:V},[Sc(!1,"v-snackbar"),l.default&&O("div",{class:"v-snackbar__content",role:"status","aria-live":"polite"},[l.default()]),l.actions&&O(Ti,{defaults:{VBtn:{variant:"text",ripple:!1}}},{default:()=>[O("div",{class:"v-snackbar__actions"},[l.actions()])]})])],activator:l.activator})}),is({},L)}});const fR=Pt({name:"VSwitch",inheritAttrs:!1,props:{indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...pa(),...hg()},emits:{"update:focused":t=>!0,"update:modelValue":()=>!0,"update:indeterminate":t=>!0},setup(t,a){let{attrs:l,slots:d}=a;const m=Tn(t,"indeterminate"),v=Tn(t,"modelValue"),{loaderClasses:b}=sg(t),{isFocused:o,focus:w,blur:C}=Ac(t),M=ne(()=>typeof t.loading=="string"&&t.loading!==""?t.loading:t.color),L=Ur(),D=ne(()=>t.id||`switch-${L}`);function V(){m.value&&(m.value=!1)}return kt(()=>{const[q,X]=bc(l),[xe,ce]=al(t),[me,ee]=K2(t),Ie=Je();function Y(){var ve,fe;(ve=Ie.value)==null||(fe=ve.input)==null||fe.click()}return O(Ds,nn({class:["v-switch",{"v-switch--inset":t.inset},{"v-switch--indeterminate":m.value},b.value]},q,xe,{id:D.value,focused:o.value}),{...d,default:ve=>{let{id:fe,isDisabled:ge,isReadonly:Ee,isValid:we}=ve;return O(bf,nn({ref:Ie},me,{modelValue:v.value,"onUpdate:modelValue":[Oe=>v.value=Oe,V],id:fe.value,type:"checkbox","aria-checked":m.value?"mixed":void 0,disabled:ge.value,readonly:Ee.value,onFocus:w,onBlur:C},X),{...d,default:()=>O("div",{class:"v-switch__track",onClick:Y},null),input:Oe=>{let{textColorClasses:ze,textColorStyles:Qe}=Oe;return O("div",{class:["v-switch__thumb",ze.value],style:Qe.value},[t.loading&&O(Oy,{name:"v-switch",active:!0,color:we.value===!1?void 0:M.value},{default:ht=>d.loader?d.loader(ht):O(Dy,{active:ht.isActive,color:ht.color,indeterminate:!0,size:"16",width:"2"},null)})])}})}})}),{}}});const pR=Pt({name:"VSystemBar",props:{color:String,height:[Number,String],window:Boolean,...sr(),...nd(),...Pi(),...Sn(),...Xn()},setup(t,a){let{slots:l}=a;const{themeClasses:d}=yi(t),{backgroundColorClasses:m,backgroundColorStyles:v}=Yi(Tt(t,"color")),{elevationClasses:b}=Mr(t),{roundedClasses:o}=Ki(t),w=ne(()=>{var M;return(M=t.height)!=null?M:t.window?32:24}),{layoutItemStyles:C}=id({id:t.name,order:ne(()=>parseInt(t.order,10)),position:Je("top"),layoutSize:w,elementSize:w,active:ne(()=>!0),absolute:Tt(t,"absolute")});return kt(()=>O(t.tag,{class:["v-system-bar",{"v-system-bar--window":t.window},d.value,m.value,b.value,o.value],style:[v.value,C.value]},l)),{}}});const WS=Symbol.for("vuetify:v-tabs"),HS=Pt({name:"VTab",props:{fixed:Boolean,icon:[Boolean,String,Function,Object],prependIcon:pn,appendIcon:pn,stacked:Boolean,title:String,ripple:{type:Boolean,default:!0},color:String,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Sn(),...ad(),...wc({selectedClass:"v-tab--selected"}),...Xn()},setup(t,a){let{slots:l,attrs:d}=a;const{textColorClasses:m,textColorStyles:v}=no(t,"sliderColor"),b=ne(()=>t.direction==="horizontal"),o=Je(!1),w=Je(),C=Je();function M(L){let{value:D}=L;if(o.value=D,D){var V,q;const X=(V=w.value)==null||(q=V.$el.parentElement)==null?void 0:q.querySelector(".v-tab--selected .v-tab__slider"),xe=C.value;if(!X||!xe)return;const ce=getComputedStyle(X).color,me=X.getBoundingClientRect(),ee=xe.getBoundingClientRect(),Ie=b.value?"x":"y",Y=b.value?"X":"Y",ve=b.value?"right":"bottom",fe=b.value?"width":"height",ge=me[Ie],Ee=ee[Ie],we=ge>Ee?me[ve]-ee[ve]:me[Ie]-ee[Ie],Oe=Math.sign(we)>0?b.value?"right":"bottom":Math.sign(we)<0?b.value?"left":"top":"center",Qe=(Math.abs(we)+(Math.sign(we)<0?me[fe]:ee[fe]))/Math.max(me[fe],ee[fe]),ht=me[fe]/ee[fe],nt=1.5;uc(xe,{backgroundColor:[ce,""],transform:[`translate${Y}(${we}px) scale${Y}(${ht})`,`translate${Y}(${we/nt}px) scale${Y}(${(Qe-1)/nt+1})`,""],transformOrigin:Array(3).fill(Oe)},{duration:225,easing:uf})}}return kt(()=>{const[L]=Po(t,["href","to","replace","icon","stacked","prependIcon","appendIcon","ripple","theme","disabled","selectedClass","value","color"]);return O(pr,nn({_as:"VTab",symbol:WS,ref:w,class:["v-tab"],tabindex:o.value?0:-1,role:"tab","aria-selected":String(o.value),active:!1,block:t.fixed,maxWidth:t.fixed?300:void 0,variant:"text",rounded:0},L,d,{"onGroup:selected":M}),{default:()=>[l.default?l.default():t.title,!t.hideSlider&&O("div",{ref:C,class:["v-tab__slider",m.value],style:v.value},null)]})}),{}}});function mR(t){return t?t.map(a=>typeof a=="string"?{title:a,value:a}:a):[]}const gR=Pt({name:"VTabs",props:{alignTabs:{type:String,default:"start"},color:String,direction:{type:String,default:"horizontal"},fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,modelValue:null,mandatory:{type:[Boolean,String],default:"force"},...gr(),...Sn()},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=Tn(t,"modelValue"),m=ne(()=>mR(t.items)),{densityClasses:v}=jr(t),{backgroundColorClasses:b,backgroundColorStyles:o}=Yi(Tt(t,"bgColor"));return rr({VTab:{color:Tt(t,"color"),direction:Tt(t,"direction"),stacked:Tt(t,"stacked"),fixed:Tt(t,"fixedTabs"),sliderColor:Tt(t,"sliderColor"),hideSlider:Tt(t,"hideSlider")}}),kt(()=>O(ZS,{modelValue:d.value,"onUpdate:modelValue":w=>d.value=w,class:["v-tabs",`v-tabs--${t.direction}`,`v-tabs--align-tabs-${t.alignTabs}`,{"v-tabs--fixed-tabs":t.fixedTabs,"v-tabs--grow":t.grow,"v-tabs--stacked":t.stacked},v.value,b.value],style:[{"--v-tabs-height":Xt(t.height)},o.value],role:"tablist",symbol:WS,mandatory:t.mandatory,direction:t.direction},{default:()=>[l.default?l.default():m.value.map(w=>O(HS,nn(w,{key:w.title}),null))]})),{}}});const _R=Pt({name:"VTable",props:{fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...gr(),...Sn(),...Xn()},setup(t,a){let{slots:l}=a;const{themeClasses:d}=yi(t),{densityClasses:m}=jr(t);return kt(()=>{var v,b;return O(t.tag,{class:["v-table",{"v-table--fixed-height":!!t.height,"v-table--fixed-header":t.fixedHeader,"v-table--fixed-footer":t.fixedFooter,"v-table--has-top":!!l.top,"v-table--has-bottom":!!l.bottom,"v-table--hover":t.hover},d.value,m.value]},{default:()=>[(v=l.top)==null?void 0:v.call(l),l.default&&O("div",{class:"v-table__wrapper",style:{height:Xt(t.height)}},[O("table",null,[l.default()])]),(b=l.bottom)==null?void 0:b.call(l)]})}),{}}});const vR=Pt({name:"VTextarea",directives:{Intersect:ug},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,hint:String,persistentHint:Boolean,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:t=>!isNaN(parseFloat(t))},maxRows:{type:[Number,String],validator:t=>!isNaN(parseFloat(t))},suffix:String,...pa(),..._g()},emits:{"click:control":t=>!0,"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,a){let{attrs:l,emit:d,slots:m}=a;const v=Tn(t,"modelValue"),{isFocused:b,focus:o,blur:w}=Ac(t),C=ne(()=>typeof t.counterValue=="function"?t.counterValue(v.value):(v.value||"").toString().length),M=ne(()=>{if(l.maxlength)return l.maxlength;if(!(!t.counter||typeof t.counter!="number"&&typeof t.counter!="string"))return t.counter});function L(Ee,we){var Oe,ze;!t.autofocus||!Ee||(Oe=we[0].target)==null||(ze=Oe.focus)==null||ze.call(Oe)}const D=Je(),V=Je(),q=Je(""),X=Je(),xe=ne(()=>b.value||t.persistentPlaceholder),ce=ne(()=>t.messages.length?t.messages:xe.value||t.persistentHint?t.hint:"");function me(){if(X.value!==document.activeElement){var Ee;(Ee=X.value)==null||Ee.focus()}b.value||o()}function ee(Ee){me(),d("click:control",Ee)}function Ie(Ee){Ee.stopPropagation(),me(),Gi(()=>{v.value="",Dm(t["onClick:clear"],Ee)})}function Y(Ee){v.value=Ee.target.value}const ve=Je();function fe(){!t.autoGrow||Gi(()=>{if(!ve.value||!V.value)return;const Ee=getComputedStyle(ve.value),we=getComputedStyle(V.value.$el),Oe=parseFloat(Ee.getPropertyValue("--v-field-padding-top"))+parseFloat(Ee.getPropertyValue("--v-input-padding-top"))+parseFloat(Ee.getPropertyValue("--v-field-padding-bottom")),ze=ve.value.scrollHeight,Qe=parseFloat(Ee.lineHeight),ht=Math.max(parseFloat(t.rows)*Qe+Oe,parseFloat(we.getPropertyValue("--v-input-control-height"))),nt=parseFloat(t.maxRows)*Qe+Oe||1/0;q.value=Xt(Co(ze!=null?ze:0,ht,nt))})}On(fe),Ye(v,fe),Ye(()=>t.rows,fe),Ye(()=>t.maxRows,fe),Ye(()=>t.density,fe);let ge;return Ye(ve,Ee=>{if(Ee)ge=new ResizeObserver(fe),ge.observe(ve.value);else{var we;(we=ge)==null||we.disconnect()}}),Ei(()=>{var Ee;(Ee=ge)==null||Ee.disconnect()}),kt(()=>{const Ee=!!(m.counter||t.counter||t.counterValue),we=!!(Ee||m.details),[Oe,ze]=bc(l),[{modelValue:Qe,...ht}]=al(t),[nt]=Xy(t);return O(Ds,nn({ref:D,modelValue:v.value,"onUpdate:modelValue":ft=>v.value=ft,class:["v-textarea v-text-field",{"v-textarea--prefixed":t.prefix,"v-textarea--suffixed":t.suffix,"v-text-field--prefixed":t.prefix,"v-text-field--suffixed":t.suffix,"v-textarea--auto-grow":t.autoGrow,"v-textarea--no-resize":t.noResize||t.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(t.variant)}],"onClick:prepend":t["onClick:prepend"],"onClick:append":t["onClick:append"]},Oe,ht,{focused:b.value,messages:ce.value}),{...m,default:ft=>{let{isDisabled:Pe,isDirty:at,isReadonly:jt,isValid:pt}=ft;return O(Sf,nn({ref:V,style:{"--v-textarea-control-height":q.value},"onClick:control":ee,"onClick:clear":Ie,"onClick:prependInner":t["onClick:prependInner"],"onClick:appendInner":t["onClick:appendInner"],role:"textbox"},nt,{active:xe.value||at.value,dirty:at.value||t.dirty,focused:b.value,error:pt.value===!1}),{...m,default:zt=>{let{props:{class:Gt,...zn}}=zt;return O(Rn,null,[t.prefix&&O("span",{class:"v-text-field__prefix"},[t.prefix]),qi(O("textarea",nn({ref:X,class:Gt,value:v.value,onInput:Y,autofocus:t.autofocus,readonly:jt.value,disabled:Pe.value,placeholder:t.placeholder,rows:t.rows,name:t.name,onFocus:me,onBlur:w},zn,ze),null),[[uo("intersect"),{handler:L},null,{once:!0}]]),t.autoGrow&&qi(O("textarea",{class:[Gt,"v-textarea__sizer"],"onUpdate:modelValue":At=>v.value=At,ref:ve,readonly:!0,"aria-hidden":"true"},null),[[Yk,v.value]]),t.suffix&&O("span",{class:"v-text-field__suffix"},[t.suffix])])}})},details:we?ft=>{var Pe;return O(Rn,null,[(Pe=m.details)==null?void 0:Pe.call(m,ft),Ee&&O(Rn,null,[O("span",null,null),O(vg,{active:t.persistentCounter||b.value,value:C.value,max:M.value},m.counter)])])}:void 0})}),is({},D,V,X)}});const yR=Pt({name:"VThemeProvider",props:{withBackground:Boolean,...Xn(),...Sn()},setup(t,a){let{slots:l}=a;const{themeClasses:d}=yi(t);return()=>{var m,v;return t.withBackground?O(t.tag,{class:["v-theme-provider",d.value]},{default:()=>[(v=l.default)==null?void 0:v.call(l)]}):(m=l.default)==null?void 0:m.call(l)}}});const xR=Pt({name:"VTimeline",props:{align:{type:String,default:"center",validator:t=>["center","start"].includes(t)},direction:{type:String,default:"vertical",validator:t=>["vertical","horizontal"].includes(t)},justify:{type:String,default:"auto",validator:t=>["auto","center"].includes(t)},side:{type:String,validator:t=>t==null||["start","end"].includes(t)},lineInset:{type:[String,Number],default:0},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:t=>["start","end","both"].includes(t)},...gr(),...Sn(),...Xn()},setup(t,a){let{slots:l}=a;const{themeClasses:d}=yi(t),{densityClasses:m}=jr(t);rr({VTimelineDivider:{lineColor:Tt(t,"lineColor")},VTimelineItem:{density:Tt(t,"density"),lineInset:Tt(t,"lineInset")}});const v=ne(()=>{const o=t.side?t.side:t.density!=="default"?"end":null;return o&&`v-timeline--side-${o}`}),b=ne(()=>{const o=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(t.truncateLine){case"both":return o;case"start":return o[0];case"end":return o[1];default:return null}});return kt(()=>O(t.tag,{class:["v-timeline",`v-timeline--${t.direction}`,`v-timeline--align-${t.align}`,`v-timeline--justify-${t.justify}`,b.value,{"v-timeline--inset-line":!!t.lineInset},d.value,m.value,v.value],style:{"--v-timeline-line-thickness":Xt(t.lineThickness)}},l)),{}}}),bR=Pt({name:"VTimelineDivider",props:{dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:pn,iconColor:String,lineColor:String,...Pi(),...da(),...sr()},setup(t,a){let{slots:l}=a;const{sizeClasses:d,sizeStyles:m}=rd(t,"v-timeline-divider__dot"),{backgroundColorStyles:v,backgroundColorClasses:b}=Yi(Tt(t,"dotColor")),{roundedClasses:o}=Ki(t,"v-timeline-divider__dot"),{elevationClasses:w}=Mr(t),{backgroundColorClasses:C,backgroundColorStyles:M}=Yi(Tt(t,"lineColor"));return rr({VIcon:{color:Tt(t,"iconColor"),icon:Tt(t,"icon"),size:Tt(t,"size")}}),kt(()=>{var D;var L;return O("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":t.fillDot}]},[O("div",{class:["v-timeline-divider__before",C.value],style:M.value},null),!t.hideDot&&O("div",{key:"dot",class:["v-timeline-divider__dot",w.value,o.value,d.value],style:m.value},[O("div",{class:["v-timeline-divider__inner-dot",b.value,o.value],style:v.value},[(D=(L=l.default)==null?void 0:L.call(l))!=null?D:t.icon?O(er,null,null):void 0])]),O("div",{class:["v-timeline-divider__after",C.value],style:M.value},null)])}),{}}}),wR=Pt({name:"VTimelineItem",props:{density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:pn,iconColor:String,lineInset:[Number,String],...Pi(),...sr(),...da(),...Sn(),...es()},setup(t,a){let{slots:l}=a;const{dimensionStyles:d}=ts(t),m=Je(0),v=Je();return Ye(v,b=>{var w;var o;!b||(m.value=(w=(o=b.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:o.getBoundingClientRect().width)!=null?w:0)},{flush:"post"}),kt(()=>{var b,o;return O("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":t.fillDot}],style:{"--v-timeline-dot-size":Xt(m.value),"--v-timeline-line-inset":t.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${Xt(t.lineInset)})`:Xt(0)}},[O("div",{class:"v-timeline-item__body",style:d.value},[(b=l.default)==null?void 0:b.call(l)]),O(bR,{ref:v,hideDot:t.hideDot,icon:t.icon,iconColor:t.iconColor,size:t.size,elevation:t.elevation,dotColor:t.dotColor,fillDot:t.fillDot,rounded:t.rounded},{default:l.icon}),t.density!=="compact"&&O("div",{class:"v-timeline-item__opposite"},[!t.hideOpposite&&((o=l.opposite)==null?void 0:o.call(l))])])}),{}}});const TR=Mi()({name:"VTooltip",props:{id:String,text:String,...ig(Tf({closeOnBack:!1,location:"end",locationStrategy:"connected",minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent","eager"])},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=Tn(t,"modelValue"),{scopeId:m}=mg(),v=Ur(),b=ne(()=>t.id||`v-tooltip-${v}`),o=Je(),w=ne(()=>t.location.split(" ").length>1?t.location:t.location+" center"),C=ne(()=>t.origin==="auto"||t.origin==="overlap"||t.origin.split(" ").length>1||t.location.split(" ").length>1?t.origin:t.origin+" center"),M=ne(()=>t.transition?t.transition:d.value?"scale-transition":"fade-transition");return kt(()=>{const[L]=pg(t);return O(dd,nn({ref:o,class:["v-tooltip"],id:b.value},L,{modelValue:d.value,"onUpdate:modelValue":D=>d.value=D,transition:M.value,absolute:!0,location:w.value,origin:C.value,persistent:!0,role:"tooltip",eager:!0,activatorProps:nn({"aria-describedby":b.value},t.activatorProps)},m),{activator:l.activator,default:function(){var xe;for(var D,V=arguments.length,q=new Array(V),X=0;X<V;X++)q[X]=arguments[X];return(xe=(D=l.default)==null?void 0:D.call(l,...q))!=null?xe:t.text}})}),is({},o)}}),SR=Pt({name:"VValidation",props:{...Z2()},emits:{"update:modelValue":t=>!0},setup(t,a){let{slots:l}=a;const d=W2(t,"validation");return()=>{var m;return(m=l.default)==null?void 0:m.call(l,d)}}}),ER=Object.freeze(Object.defineProperty({__proto__:null,VApp:wL,VAppBar:OL,VAppBarNavIcon:FL,VAppBarTitle:$L,VAlert:UL,VAlertTitle:j2,VAutocomplete:FD,VAvatar:rl,VBadge:VD,VBanner:$D,VBannerActions:wS,VBannerText:TS,VBottomNavigation:o2,VBreadcrumbs:ND,VBreadcrumbsItem:ES,VBreadcrumbsDivider:SS,VBtn:pr,VBtnGroup:r2,VBtnToggle:tz,VCard:hd,VCardActions:CS,VCardItem:kS,VCardSubtitle:IS,VCardText:MS,VCardTitle:AS,VCarousel:XD,VCarouselItem:YD,VCheckbox:HL,VCheckboxBtn:ud,VChip:wf,VChipGroup:YL,VCode:KD,VColorPicker:PB,VCombobox:LB,VCounter:vg,VDefaultsProvider:Ti,VDialog:DB,VDivider:kc,VExpansionPanels:RB,VExpansionPanel:OB,VExpansionPanelText:jS,VExpansionPanelTitle:US,VField:Sf,VFieldLabel:jh,VFileInput:FB,VFooter:VB,VForm:$B,VContainer:Cz,VCol:kz,VRow:Rz,VSpacer:Dv,VHover:NB,VIcon:er,VComponentIcon:s2,VSvgIcon:a2,VLigatureIcon:rz,VClassIcon:zy,VImg:ld,VInput:Ds,VItemGroup:UB,VItem:jB,VKbd:GB,VLabel:cd,VLayout:M2,VLayoutItem:Fz,VLazy:qB,VList:ma,VListGroup:Zy,VListImg:uD,VListItem:wi,VListItemAction:dD,VListItemMedia:hD,VListItemSubtitle:sS,VListItemTitle:aS,VListSubheader:lS,VLocaleProvider:ZB,VMain:P2,VMenu:gg,VMessages:G2,VNavigationDrawer:fd,VNoSsr:tR,VOverlay:dd,VPagination:iR,VParallax:oR,VProgressCircular:Dy,VProgressLinear:By,VRadio:sR,VRadioGroup:aR,VRangeSlider:lR,VRating:cR,VResponsive:V2,VSelect:DD,VSelectionControl:bf,VSelectionControlGroup:Y2,VSheet:$S,VSlideGroup:ZS,VSlideGroupItem:dR,VSlider:Zv,VSnackbar:hR,VSwitch:fR,VSystemBar:pR,VTabs:gR,VTab:HS,VTable:_R,VTextarea:vR,VTextField:yg,VThemeProvider:yR,VTimeline:xR,VTimelineItem:wR,VToolbar:Nm,VToolbarTitle:$m,VToolbarItems:VL,VTooltip:TR,VValidation:SR,VWindow:LS,VWindowItem:DS,VDialogTransition:lg,VFabTransition:TL,VDialogBottomTransition:SL,VDialogTopTransition:EL,VFadeTransition:Rv,VScaleTransition:F2,VScrollXTransition:CL,VScrollXReverseTransition:IL,VScrollYTransition:AL,VScrollYReverseTransition:kL,VSlideXTransition:ML,VSlideXReverseTransition:PL,VSlideYTransition:Uy,VSlideYReverseTransition:zL,VExpandTransition:cg,VExpandXTransition:jy},Symbol.toStringTag,{value:"Module"}));function CR(t,a){var L,D,V,q;const l=a.modifiers||{},d=a.value,{once:m,immediate:v,...b}=l,o=!Object.keys(b).length,{handler:w,options:C}=typeof d=="object"?d:{handler:d,options:{attributes:(L=b==null?void 0:b.attr)!=null?L:o,characterData:(D=b==null?void 0:b.char)!=null?D:o,childList:(V=b==null?void 0:b.child)!=null?V:o,subtree:(q=b==null?void 0:b.sub)!=null?q:o}},M=new MutationObserver(function(){let X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],xe=arguments.length>1?arguments[1]:void 0;w==null||w(X,xe),m&&XS(t,a)});v&&(w==null||w([],M)),t._mutate=Object(t._mutate),t._mutate[a.instance.$.uid]={observer:M},M.observe(t,C)}function XS(t,a){var l;!((l=t._mutate)!=null&&l[a.instance.$.uid])||(t._mutate[a.instance.$.uid].observer.disconnect(),delete t._mutate[a.instance.$.uid])}const IR={mounted:CR,unmounted:XS};function AR(t,a){var l,d;const m=a.value,v={passive:!((l=a.modifiers)!=null&&l.active)};window.addEventListener("resize",m,v),t._onResize=Object(t._onResize),t._onResize[a.instance.$.uid]={handler:m,options:v},(d=a.modifiers)!=null&&d.quiet||m()}function kR(t,a){var l;if(!((l=t._onResize)!=null&&l[a.instance.$.uid]))return;const{handler:d,options:m}=t._onResize[a.instance.$.uid];window.removeEventListener("resize",d,m),delete t._onResize[a.instance.$.uid]}const MR={mounted:AR,unmounted:kR};function YS(t,a){var o;const{self:l=!1}=(o=a.modifiers)!=null?o:{},d=a.value,m=typeof d=="object"&&d.options||{passive:!0},v=typeof d=="function"||"handleEvent"in d?d:d.handler,b=l?t:a.arg?document.querySelector(a.arg):window;!b||(b.addEventListener("scroll",v,m),t._onScroll=Object(t._onScroll),t._onScroll[a.instance.$.uid]={handler:v,options:m,target:l?void 0:b})}function KS(t,a){var l;if(!((l=t._onScroll)!=null&&l[a.instance.$.uid]))return;const{handler:d,options:m,target:v=t}=t._onScroll[a.instance.$.uid];v.removeEventListener("scroll",d,m),delete t._onScroll[a.instance.$.uid]}function PR(t,a){a.value!==a.oldValue&&(KS(t,a),YS(t,a))}const zR={mounted:YS,unmounted:KS,updated:PR},LR=Object.freeze(Object.defineProperty({__proto__:null,ClickOutside:yS,Intersect:N2,Mutate:IR,Resize:MR,Ripple:sl,Scroll:zR,Touch:Ky},Symbol.toStringTag,{value:"Module"})),DR={dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF",primary:"#f6f8fc",secondary:"#f6f8fc",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"}},BR=B2({components:ER,directives:LR,theme:{defaultTheme:"myCustomLightTheme",themes:{myCustomLightTheme:DR}}}),Nh=vn({__name:"LeftIndex",setup(t){const a=Qu(),l=pi({index:"mdi-map-outline",land:"mdi-tree-outline",elevation:"mdi-landslide-outline"}),d=pi({index:"mdi-map",land:"mdi-tree",elevation:"mdi-landslide"});function m(w){w==="sub_index"?(l.index=d.index,l.land="mdi-tree-outline",l.elevation="mdi-landslide-outline"):w==="land"?(l.index="mdi-map-outline",l.land=d.land,l.elevation="mdi-landslide-outline"):w==="elevation"&&(l.index="mdi-map-outline",l.land="mdi-tree-outline",l.elevation=d.elevation)}function v(){a.push({name:"sub_index"}),m("sub_index")}function b(){a.push({name:"land"}),m("land")}function o(){a.push({name:"elevation"}),m("elevation")}return(w,C)=>(Zi(),Ps(hd,null,{default:ii(()=>[O(fd,{"expand-on-hover":"",rail:"",width:"200",permanent:"",color:"primary"},{default:ii(()=>[O(wi,{nav:""},{append:ii(()=>[]),_:1}),O(kc),O(ma,{density:"compact",nav:""},{default:ii(()=>[O(wi,{onClick:v,class:"rounded-end-pill","prepend-icon":l.index,title:"\u5168\u7403\u6838\u7535",value:"nuclear"},null,8,["prepend-icon"]),O(wi,{onClick:b,class:"rounded-end-pill","prepend-icon":l.land,title:"\u571F\u5730\u5229\u7528",value:"land"},null,8,["prepend-icon"]),O(wi,{onClick:o,class:"rounded-end-pill","prepend-icon":l.elevation,title:"\u5730\u5F62\u9AD8\u7A0B",value:"elevation"},null,8,["prepend-icon"])]),_:1})]),_:1})]),_:1}))}});const nv=vn({__name:"LeftFinance",setup(t){const a=Qu(),l=pi({GDP:"mdi-bank-outline",density:"mdi-account-multiple-outline"}),d=pi({GDP:"mdi-bank",density:"mdi-account-multiple"});function m(o){o==="GDP"?(l.GDP=d.GDP,l.density="mdi-account-multiple-outline"):o==="density"&&(l.GDP="mdi-bank-outline",l.density=d.density)}function v(){a.push({name:"gdp"}),m("GDP")}function b(){a.push({name:"density"}),m("density")}return(o,w)=>(Zi(),Ps(hd,null,{default:ii(()=>[O(fd,{width:"200",permanent:"","expand-on-hover":"",rail:"",color:"primary"},{default:ii(()=>[O(wi,{nav:""},{append:ii(()=>[]),_:1}),O(kc),O(ma,{density:"compact",nav:""},{default:ii(()=>[O(wi,{onClick:v,class:"rounded-end-pill","prepend-icon":l.GDP,title:"\u56FD\u6C11\u751F\u4EA7\u603B\u503C",value:"GDP"},null,8,["prepend-icon"]),O(wi,{onClick:b,class:"rounded-end-pill","prepend-icon":l.density,title:"\u4EBA\u53E3\u5BC6\u5EA6",value:"density"},null,8,["prepend-icon"])]),_:1})]),_:1})]),_:1}))}});const _m=vn({__name:"LeftMeteorology",setup(t){const a=Qu(),l=pi({weather:"mdi-cloud-percent-outline",typhoon:"mdi-lightning-bolt-outline",inversion:"mdi-chart-areaspline"}),d=pi({weather:"mdi-cloud-percent",typhoon:"mdi-lightning-bolt",inversion:"mdi-chart-areaspline-variant"});function m(w){w==="weather"?(l.weather=d.weather,l.typhoon="mdi-lightning-bolt-outline",l.inversion="mdi-chart-areaspline"):w==="typhoon"?(l.weather="mdi-cloud-percent-outline",l.typhoon=d.typhoon,l.inversion="mdi-chart-areaspline"):w==="inversion"&&(l.weather="mdi-cloud-percent-outline",l.typhoon="mdi-lightning-bolt-outline",l.inversion=d.inversion)}function v(){a.push({name:"weather"}),m("weather")}function b(){a.push({name:"typhoon"}),m("typhoon")}function o(){a.push({name:"inversion"}),m("inversion")}return(w,C)=>(Zi(),Ps(hd,null,{default:ii(()=>[O(fd,{width:"200",permanent:"","expand-on-hover":"",rail:"",color:"primary"},{default:ii(()=>[O(wi,{nav:""},{append:ii(()=>[]),_:1}),O(kc),O(ma,{density:"compact",nav:""},{default:ii(()=>[O(wi,{onClick:v,class:"rounded-end-pill","prepend-icon":l.weather,title:"\u5168\u7403\u6C14\u8C61",value:"weather"},null,8,["prepend-icon"]),O(wi,{onClick:b,class:"rounded-end-pill","prepend-icon":l.typhoon,title:"\u53F0\u98CE\u60C5\u51B5",value:"typhoon"},null,8,["prepend-icon"]),O(wi,{onClick:o,class:"rounded-end-pill","prepend-icon":l.inversion,title:"\u6C14\u8C61\u53CD\u6F14",value:"inversion"},null,8,["prepend-icon"])]),_:1})]),_:1})]),_:1}))}});const vm=vn({__name:"LeftNuclear",setup(t){const a=Qu(),l=pi({dose_single:"mdi-account-outline",dose_mutilate:"mdi-account-group-outline",other:"mdi-circle-outline"}),d=pi({dose_single:"mdi-account",dose_mutilate:"mdi-account-group",other:"mdi-circle"});function m(w){w==="dose_single"?(l.dose_single=d.dose_single,l.dose_mutilate="mdi-account-group-outline",l.other="mdi-circle-outline"):w==="dose_mutilate"?(l.dose_single="mdi-account-outline",l.dose_mutilate=d.dose_mutilate,l.other="mdi-circle-outline"):w==="other"&&(l.dose_single="mdi-account-outline",l.dose_mutilate="mdi-account-group-outline",l.other=d.other)}function v(){a.push({name:"single"}),m("dose_single")}function b(){a.push({name:"multiple"}),m("dose_mutilate")}function o(){a.push({name:"other"}),m("other")}return(w,C)=>(Zi(),Ps(hd,null,{default:ii(()=>[O(fd,{width:"200","expand-on-hover":"",rail:"",permanent:"",color:"primary"},{default:ii(()=>[O(wi,{nav:""},{append:ii(()=>[]),_:1}),O(kc),O(ma,{density:"compact",nav:""},{default:ii(()=>[O(wi,{onClick:v,class:"rounded-end-pill","prepend-icon":l.dose_single,title:"\u4E2A\u4EBA\u5242\u91CF",value:"dose_single"},null,8,["prepend-icon"]),O(wi,{onClick:b,class:"rounded-end-pill","prepend-icon":l.dose_mutilate,title:"\u96C6\u4F53\u8BA1\u91CF",value:"dose_mutilate"},null,8,["prepend-icon"]),O(wi,{onClick:o,class:"rounded-end-pill","prepend-icon":l.other,title:"\u5176\u4ED6",value:"other"},null,8,["prepend-icon"])]),_:1})]),_:1})]),_:1}))}});const iv=vn({__name:"LeftEvacuate",setup(t){const a=Qu(),l=pi({success:"mdi-run",failure:"mdi-alert-circle-outline"}),d=pi({success:"mdi-run-fast",failure:"mdi-alert-circle"}),m=o=>{o==="success"?(l.success=d.success,l.failure="mdi-alert-circle-outline"):o==="failure"&&(l.success="mdi-run",l.failure=d.failure)};function v(){a.push({name:"success"}),m("success")}function b(){a.push({name:"failure"}),m("failure")}return(o,w)=>(Zi(),Ps(hd,null,{default:ii(()=>[O(fd,{"expand-on-hover":"",rail:"",width:"200",permanent:"",color:"primary"},{default:ii(()=>[O(wi,{nav:""},{append:ii(()=>[]),_:1}),O(kc),O(ma,{density:"compact",nav:""},{default:ii(()=>[O(wi,{onClick:v,class:"rounded-end-pill","prepend-icon":l.success,title:"\u64A4\u79BB\u6210\u529F",value:"success"},null,8,["prepend-icon"]),O(wi,{onClick:b,class:"rounded-end-pill","prepend-icon":l.failure,title:"\u64A4\u79BB\u5931\u8D25",value:"failure"},null,8,["prepend-icon"])]),_:1})]),_:1})]),_:1}))}});const ga="pk.eyJ1Ijoia29pZ29rb3JvIiwiYSI6ImNsOXAxZDIzZDA0OHQ0MW1wMHd2Y3Rxa3IifQ.X9ACqkqRQ_m3IvwqsGYy0w",RR={class:"container"},ic=vn({__name:"MapIndex",setup(t){const a=Je(),l=pi({mapOptions:{style:"mapbox://styles/mapbox/satellite-v9",center:[-103.5917,40.6699],projection:"mercator",zoom:4},popupOptions:{visible:!1,center:void 0,content:""}}),d=o=>{const w=o.target,C=w.queryRenderedFeatures(o.point,{layers:["clusters"]}),M=C[0].properties.cluster_id;w.getSource("earthquakes").getClusterExpansionZoom(M,(L,D)=>{L||w.easeTo({center:C[0].geometry.coordinates,zoom:D})})},m=o=>{o.target.getCanvas().style.cursor="pointer"},v=o=>{o.target.getCanvas().style.cursor=""},b=o=>{const w=o.features[0].geometry.coordinates.slice(),C=o.features[0].properties.mag,M=o.features[0].properties.tsunami===1?"yes":"no";for(;Math.abs(o.lngLat.lng-w[0])>180;)w[0]+=o.lngLat.lng>w[0]?360:-360;l.popupOptions.visible=!0,l.popupOptions.content=`magnitude: ${C}<br>Was there a tsunami?: ${M}`,l.popupOptions.center=w};return(o,w)=>{const C=fr("v-geo-source"),M=fr("v-circle-layer"),L=fr("v-symbol-layer"),D=fr("v-popup"),V=fr("v-map");return Zi(),ho("div",RR,[O(V,{ref_key:"mapRef",ref:a,accessToken:Ui(ga),options:l.mapOptions},{default:ii(()=>[O(C,{id:"earthquakes",data:"http://127.0.0.1:8000/index/index_geojson/",cluster:!0,clusterMaxZoom:16,clusterRadius:50}),O(M,{id:"clusters",source:"earthquakes",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#51bbd6",30,"#f1f075",50,"#f28cb1",80,"#e20656"],"circle-radius":["step",["get","point_count"],20,100,30,750,40]},onClick:d,onMouseenter:m,onMouseleave:v}),O(L,{id:"cluster-count",source:"earthquakes",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}}),O(M,{id:"uncluster-point",source:"earthquakes",filter:["!",["has","point_count"]],paint:{"circle-color":"#11b4da","circle-radius":4,"circle-stroke-width":1,"circle-stroke-color":"#fff"},onClick:b}),O(D,{visible:l.popupOptions.visible,center:l.popupOptions.center},{default:ii(()=>[Yo(zI(l.popupOptions.content),1)]),_:1},8,["visible","center"])]),_:1},8,["accessToken","options"])])}}}),OR={class:"container"},rv=vn({__name:"MapLand",setup(t){return(a,l)=>{const d=fr("v-raster-source"),m=fr("v-raster-layer"),v=fr("v-map");return Zi(),ho("div",OR,[O(v,{ref:"mapRef",accessToken:Ui(ga),options:{center:[120,30],zoom:4,style:"mapbox://styles/mapbox/satellite-v9",projection:"mercator"}},{default:ii(()=>[O(d,{id:"tiles",tiles:["mapbox://mapbox.satellite"],tileSize:256},null,8,["tiles"]),O(m,{id:"tiles",source:"tiles"})]),_:1},8,["accessToken"])])}}}),FR={class:"container"},VR=vn({__name:"MapElevation",setup(t){const a=Je();return(l,d)=>{const m=fr("v-map");return Zi(),ho("div",FR,[O(m,{ref_key:"mapRef",ref:a,accessToken:Ui(ga),options:{center:[120,30],zoom:10,style:"mapbox://styles/mapbox/outdoors-v12",projection:"mercator"}},null,8,["accessToken"])])}}});var eo=63710088e-1,$R={centimeters:eo*100,centimetres:eo*100,degrees:eo/111325,feet:eo*3.28084,inches:eo*39.37,kilometers:eo/1e3,kilometres:eo/1e3,meters:eo,metres:eo,miles:eo/1609.344,millimeters:eo*1e3,millimetres:eo*1e3,nauticalmiles:eo/1852,radians:1,yards:eo*1.0936};function JS(t,a,l){l===void 0&&(l={});var d={type:"Feature"};return(l.id===0||l.id)&&(d.id=l.id),l.bbox&&(d.bbox=l.bbox),d.properties=a||{},d.geometry=t,d}function NR(t,a,l){if(l===void 0&&(l={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!fw(t[0])||!fw(t[1]))throw new Error("coordinates must contain numbers");var d={type:"Point",coordinates:t};return JS(d,a,l)}function Wv(t,a,l){l===void 0&&(l={});for(var d=0,m=t;d<m.length;d++){var v=m[d];if(v.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var b=0;b<v[v.length-1].length;b++)if(v[v.length-1][b]!==v[0][b])throw new Error("First and last Position are not equivalent.")}var o={type:"Polygon",coordinates:t};return JS(o,a,l)}function UR(t,a){a===void 0&&(a={});var l={type:"FeatureCollection"};return a.id&&(l.id=a.id),a.bbox&&(l.bbox=a.bbox),l.features=t,l}function jR(t,a){a===void 0&&(a="kilometers");var l=$R[a];if(!l)throw new Error(a+" units is invalid");return t/l}function hw(t){var a=t%(2*Math.PI);return a*180/Math.PI}function ov(t){var a=t%360;return a*Math.PI/180}function fw(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function GR(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return t.geometry.coordinates;if(t.type==="Point")return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function qR(t,a,l,d){d===void 0&&(d={});var m=GR(t),v=ov(m[0]),b=ov(m[1]),o=ov(l),w=jR(a,d.units),C=Math.asin(Math.sin(b)*Math.cos(w)+Math.cos(b)*Math.sin(w)*Math.cos(o)),M=v+Math.atan2(Math.sin(o)*Math.sin(w)*Math.cos(b),Math.cos(w)-Math.sin(b)*Math.sin(C)),L=hw(M),D=hw(C);return NR([L,D],d.properties)}function sv(t,a,l){l===void 0&&(l={});for(var d=l.steps||64,m=l.properties?l.properties:!Array.isArray(t)&&t.type==="Feature"&&t.properties?t.properties:{},v=[],b=0;b<d;b++)v.push(qR(t,a,b*-360/d,l).geometry.coordinates);return v.push(v[0]),Wv([v],m)}const ZR={class:"container"},WR=vn({__name:"MapSPF",setup(t){const a=[[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[4,0,2,4,8,5,4,6,5,9,1,3,2,4,4,6],[3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],[4,0,2,4,8,6,5,6,5,8,1,3,2,4,4,6],[5,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[6,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,1,5,9,2,3,2,4,3,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,8,2,5,9,1,3,2,4,4,6],[5,0,2,4,8,6,4,6,5,9,1,3,2,8,4,6],[1,0,2,4,8,6,4,6,4,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,2,2,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,5,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,3,9,1,3,2,4,4,6],[1,0,6,4,8,6,4,6,5,9,1,3,2,4,4,5],[1,2,2,4,1,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,3,4,6,5,9,2,3,2,4,4,6],[8,0,2,4,8,6,4,6,7,9,1,3,2,4,4,6],[1,2,6,4,8,6,4,6,3,9,1,3,2,4,4,6],[1,6,2,4,8,6,4,6,5,9,1,3,2,5,4,6],[1,8,2,4,8,6,4,6,5,9,1,3,2,4,4,7],[1,0,2,4,8,6,4,6,3,9,1,3,2,4,4,6],[1,0,5,4,8,6,4,6,5,9,1,3,2,4,4,6]],l=["#3034C5","#3454FF","#35AEFE","#4CFFDF","#69FF65","#DFFF4D","#FFBE35","#FE6934","#813332","#100101"];function d(w){return w===0?"black":l[w]}const m=UR([]);sv([120,30],10,{steps:100,units:"kilometers"});const v=30,b=[120,30];let o;for(let w=0;w<v;w++){let C=sv(b,w+1,{steps:64,units:"kilometers"});const M=a[w];for(let L=0;L<16;L++)w===0?m.features.push(Wv([[b,...C.geometry.coordinates[0].slice(4*L,4*(L+1)+1),b]],{color:d(M[L])})):(o=sv(b,w,{steps:64,units:"kilometers"}),m.features.push(Wv([[...o.geometry.coordinates[0].slice(4*L,4*(L+1)+1),...C.geometry.coordinates[0].slice(4*L,4*(L+1)+1).reverse(),o.geometry.coordinates[0][4*L]]],{color:d(M[L])})))}return(w,C)=>{const M=fr("v-geo-source"),L=fr("v-fill-layer"),D=fr("v-map");return Zi(),ho("div",ZR,[O(D,{ref:"mapRef",accessToken:Ui(ga),options:{center:[120,30],zoom:10,style:"mapbox://styles/mapbox/satellite-v9",projection:"mercator"}},{default:ii(()=>[O(M,{id:"spf",data:Ui(m)},null,8,["data"]),O(L,{id:"spf",source:"spf",paint:{"fill-color":["get","color"]}})]),_:1},8,["accessToken"])])}}}),HR={class:"container"},XR=vn({__name:"MapPopulation",setup(t){const a=Je();return(l,d)=>{const m=fr("v-map");return Zi(),ho("div",HR,[O(m,{ref_key:"mapRef",ref:a,accessToken:Ui(ga),options:{center:[120,30],zoom:10,style:"mapbox://styles/mapbox/outdoors-v12",projection:"mercator"}},null,8,["accessToken"])])}}}),YR={class:"container"},KR=vn({__name:"MapWorldMeteorology",setup(t){const a=Je();return(l,d)=>{const m=fr("v-map");return Zi(),ho("div",YR,[O(m,{ref_key:"mapRef",ref:a,accessToken:Ui(ga),options:{center:[120,30],zoom:10,style:"mapbox://styles/mapbox/outdoors-v12",projection:"mercator"}},null,8,["accessToken"])])}}}),JR={class:"container"},QR=vn({__name:"MapTyphoon",setup(t){const a=Je();return(l,d)=>{const m=fr("v-map");return Zi(),ho("div",JR,[O(m,{ref_key:"mapRef",ref:a,accessToken:Ui(ga),options:{center:[120,30],zoom:10,style:"mapbox://styles/mapbox/outdoors-v12",projection:"mercator"}},null,8,["accessToken"])])}}}),e3={class:"container"},t3=vn({__name:"MapInversion",setup(t){const a=Je();return(l,d)=>{const m=fr("v-map");return Zi(),ho("div",e3,[O(m,{ref_key:"mapRef",ref:a,accessToken:Ui(ga),options:{center:[120,30],zoom:10,style:"mapbox://styles/mapbox/outdoors-v12",projection:"mercator"}},null,8,["accessToken"])])}}}),n3={class:"container"},av=vn({__name:"MapDose",setup(t){const a=Je();return(l,d)=>{const m=fr("v-map");return Zi(),ho("div",n3,[O(m,{ref_key:"mapRef",ref:a,accessToken:Ui(ga),options:{center:[120,30],zoom:10,style:"mapbox://styles/mapbox/outdoors-v12",projection:"mercator"}},null,8,["accessToken"])])}}}),i3=[{path:"/",components:{left_draw:Nh,main_view:ic}},{path:"/index",name:"index",components:{left_draw:Nh,main_view:ic}},{path:"/finance",name:"finance",components:{left_draw:nv,main_view:ic}},{path:"/meteorology",name:"meteorology",components:{left_draw:_m,main_view:ic}},{path:"/nuclear",name:"nuclear",components:{left_draw:vm,main_view:ic}},{path:"/evacuate",name:"evacuate",components:{left_draw:iv,main_view:WR}},{path:"/index/index",name:"sub_index",components:{left_draw:Nh,main_view:ic}},{path:"/index/land",name:"land",components:{left_draw:Nh,main_view:rv}},{path:"/index/elevation",name:"elevation",components:{left_draw:Nh,main_view:VR}},{path:"/finance/gdp",name:"gdp",components:{left_draw:nv,main_view:ic}},{path:"/finance/density",name:"density",components:{left_draw:nv,main_view:XR}},{path:"/meteorology/weather",name:"weather",components:{left_draw:_m,main_view:KR}},{path:"/meteorology/typhoon",name:"typhoon",components:{left_draw:_m,main_view:QR}},{path:"/meteorology/inversion",name:"inversion",components:{left_draw:_m,main_view:t3}},{path:"/nuclear/single",name:"single",components:{left_draw:vm,main_view:av}},{path:"/nuclear/multiple",name:"multiple",components:{left_draw:vm,main_view:av}},{path:"/nuclear/single",name:"single",components:{left_draw:vm,main_view:av}},{path:"/evacuate/success",name:"success",components:{left_draw:iv,main_view:rv}},{path:"/evacuate/failure",name:"failure",components:{left_draw:iv,main_view:rv}}],r3=iP({history:yM(),routes:i3});Qk(jz).use(r3).use(BR).use(_L).mount("#app");
