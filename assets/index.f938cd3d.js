(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const g of d)if(g.type==="childList")for(const _ of g.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&c(_)}).observe(document,{childList:!0,subtree:!0});function a(d){const g={};return d.integrity&&(g.integrity=d.integrity),d.referrerpolicy&&(g.referrerPolicy=d.referrerpolicy),d.crossorigin==="use-credentials"?g.credentials="include":d.crossorigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function c(d){if(d.ep)return;d.ep=!0;const g=a(d);fetch(d.href,g)}})();function Ny(e,o){const a=Object.create(null),c=e.split(",");for(let d=0;d<c.length;d++)a[c[d]]=!0;return o?d=>!!a[d.toLowerCase()]:d=>!!a[d]}const mk="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",gk=Ny(mk);function NE(e){return!!e||e===""}function $y(e){if(Mn(e)){const o={};for(let a=0;a<e.length;a++){const c=e[a],d=mr(c)?yk(c):$y(c);if(d)for(const g in d)o[g]=d[g]}return o}else{if(mr(e))return e;if(Ji(e))return e}}const vk=/;(?![^(]*\))/g,_k=/:(.+)/;function yk(e){const o={};return e.split(vk).forEach(a=>{if(a){const c=a.split(_k);c.length>1&&(o[c[0].trim()]=c[1].trim())}}),o}function Uy(e){let o="";if(mr(e))o=e;else if(Mn(e))for(let a=0;a<e.length;a++){const c=Uy(e[a]);c&&(o+=c+" ")}else if(Ji(e))for(const a in e)e[a]&&(o+=a+" ");return o.trim()}const Si={},ih=[],rs=()=>{},xk=()=>!1,bk=/^on[^a-z]/,wg=e=>bk.test(e),jy=e=>e.startsWith("onUpdate:"),Cr=Object.assign,Gy=(e,o)=>{const a=e.indexOf(o);a>-1&&e.splice(a,1)},wk=Object.prototype.hasOwnProperty,Hn=(e,o)=>wk.call(e,o),Mn=Array.isArray,cf=e=>Eg(e)==="[object Map]",Ek=e=>Eg(e)==="[object Set]",Bn=e=>typeof e=="function",mr=e=>typeof e=="string",qy=e=>typeof e=="symbol",Ji=e=>e!==null&&typeof e=="object",$E=e=>Ji(e)&&Bn(e.then)&&Bn(e.catch),Sk=Object.prototype.toString,Eg=e=>Sk.call(e),Tk=e=>Eg(e).slice(8,-1),Ck=e=>Eg(e)==="[object Object]",Zy=e=>mr(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Wm=Ny(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Sg=e=>{const o=Object.create(null);return a=>o[a]||(o[a]=e(a))},Ik=/-(\w)/g,Ro=Sg(e=>e.replace(Ik,(o,a)=>a?a.toUpperCase():"")),Ak=/\B([A-Z])/g,dh=Sg(e=>e.replace(Ak,"-$1").toLowerCase()),xl=Sg(e=>e.charAt(0).toUpperCase()+e.slice(1)),Hm=Sg(e=>e?`on${xl(e)}`:""),xf=(e,o)=>!Object.is(e,o),Xm=(e,o)=>{for(let a=0;a<e.length;a++)e[a](o)},tg=(e,o,a)=>{Object.defineProperty(e,o,{configurable:!0,enumerable:!1,value:a})},ng=e=>{const o=parseFloat(e);return isNaN(o)?e:o};let A1;const kk=()=>A1||(A1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let ko;class UE{constructor(o=!1){this.detached=o,this.active=!0,this.effects=[],this.cleanups=[],this.parent=ko,!o&&ko&&(this.index=(ko.scopes||(ko.scopes=[])).push(this)-1)}run(o){if(this.active){const a=ko;try{return ko=this,o()}finally{ko=a}}}on(){ko=this}off(){ko=this.parent}stop(o){if(this.active){let a,c;for(a=0,c=this.effects.length;a<c;a++)this.effects[a].stop();for(a=0,c=this.cleanups.length;a<c;a++)this.cleanups[a]();if(this.scopes)for(a=0,c=this.scopes.length;a<c;a++)this.scopes[a].stop(!0);if(!this.detached&&this.parent&&!o){const d=this.parent.scopes.pop();d&&d!==this&&(this.parent.scopes[this.index]=d,d.index=this.index)}this.parent=void 0,this.active=!1}}}function Nf(e){return new UE(e)}function Mk(e,o=ko){o&&o.active&&o.effects.push(e)}function Dc(e){ko&&ko.cleanups.push(e)}const Wy=e=>{const o=new Set(e);return o.w=0,o.n=0,o},jE=e=>(e.w&vl)>0,GE=e=>(e.n&vl)>0,Pk=({deps:e})=>{if(e.length)for(let o=0;o<e.length;o++)e[o].w|=vl},zk=e=>{const{deps:o}=e;if(o.length){let a=0;for(let c=0;c<o.length;c++){const d=o[c];jE(d)&&!GE(d)?d.delete(e):o[a++]=d,d.w&=~vl,d.n&=~vl}o.length=a}},q_=new WeakMap;let sf=0,vl=1;const Z_=30;let ts;const Ac=Symbol(""),W_=Symbol("");class Hy{constructor(o,a=null,c){this.fn=o,this.scheduler=a,this.active=!0,this.deps=[],this.parent=void 0,Mk(this,c)}run(){if(!this.active)return this.fn();let o=ts,a=gl;for(;o;){if(o===this)return;o=o.parent}try{return this.parent=ts,ts=this,gl=!0,vl=1<<++sf,sf<=Z_?Pk(this):k1(this),this.fn()}finally{sf<=Z_&&zk(this),vl=1<<--sf,ts=this.parent,gl=a,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ts===this?this.deferStop=!0:this.active&&(k1(this),this.onStop&&this.onStop(),this.active=!1)}}function k1(e){const{deps:o}=e;if(o.length){for(let a=0;a<o.length;a++)o[a].delete(e);o.length=0}}let gl=!0;const qE=[];function Rc(){qE.push(gl),gl=!1}function Bc(){const e=qE.pop();gl=e===void 0?!0:e}function po(e,o,a){if(gl&&ts){let c=q_.get(e);c||q_.set(e,c=new Map);let d=c.get(a);d||c.set(a,d=Wy()),ZE(d)}}function ZE(e,o){let a=!1;sf<=Z_?GE(e)||(e.n|=vl,a=!jE(e)):a=!e.has(ts),a&&(e.add(ts),ts.deps.push(e))}function ma(e,o,a,c,d,g){const _=q_.get(e);if(!_)return;let s=[];if(o==="clear")s=[..._.values()];else if(a==="length"&&Mn(e))_.forEach((w,S)=>{(S==="length"||S>=c)&&s.push(w)});else switch(a!==void 0&&s.push(_.get(a)),o){case"add":Mn(e)?Zy(a)&&s.push(_.get("length")):(s.push(_.get(Ac)),cf(e)&&s.push(_.get(W_)));break;case"delete":Mn(e)||(s.push(_.get(Ac)),cf(e)&&s.push(_.get(W_)));break;case"set":cf(e)&&s.push(_.get(Ac));break}if(s.length===1)s[0]&&H_(s[0]);else{const w=[];for(const S of s)S&&w.push(...S);H_(Wy(w))}}function H_(e,o){const a=Mn(e)?e:[...e];for(const c of a)c.computed&&M1(c);for(const c of a)c.computed||M1(c)}function M1(e,o){(e!==ts||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const Lk=Ny("__proto__,__v_isRef,__isVue"),WE=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(qy)),Dk=Xy(),Rk=Xy(!1,!0),Bk=Xy(!0),P1=Ok();function Ok(){const e={};return["includes","indexOf","lastIndexOf"].forEach(o=>{e[o]=function(...a){const c=Yn(this);for(let g=0,_=this.length;g<_;g++)po(c,"get",g+"");const d=c[o](...a);return d===-1||d===!1?c[o](...a.map(Yn)):d}}),["push","pop","shift","unshift","splice"].forEach(o=>{e[o]=function(...a){Rc();const c=Yn(this)[o].apply(this,a);return Bc(),c}}),e}function Xy(e=!1,o=!1){return function(c,d,g){if(d==="__v_isReactive")return!e;if(d==="__v_isReadonly")return e;if(d==="__v_isShallow")return o;if(d==="__v_raw"&&g===(e?o?Qk:JE:o?KE:YE).get(c))return c;const _=Mn(c);if(!e&&_&&Hn(P1,d))return Reflect.get(P1,d,g);const s=Reflect.get(c,d,g);return(qy(d)?WE.has(d):Lk(d))||(e||po(c,"get",d),o)?s:Pi(s)?_&&Zy(d)?s:s.value:Ji(s)?e?$f(s):Ki(s):s}}const Fk=HE(),Vk=HE(!0);function HE(e=!1){return function(a,c,d,g){let _=a[c];if(ah(_)&&Pi(_)&&!Pi(d))return!1;if(!e&&(!ig(d)&&!ah(d)&&(_=Yn(_),d=Yn(d)),!Mn(a)&&Pi(_)&&!Pi(d)))return _.value=d,!0;const s=Mn(a)&&Zy(c)?Number(c)<a.length:Hn(a,c),w=Reflect.set(a,c,d,g);return a===Yn(g)&&(s?xf(d,_)&&ma(a,"set",c,d):ma(a,"add",c,d)),w}}function Nk(e,o){const a=Hn(e,o);e[o];const c=Reflect.deleteProperty(e,o);return c&&a&&ma(e,"delete",o,void 0),c}function $k(e,o){const a=Reflect.has(e,o);return(!qy(o)||!WE.has(o))&&po(e,"has",o),a}function Uk(e){return po(e,"iterate",Mn(e)?"length":Ac),Reflect.ownKeys(e)}const XE={get:Dk,set:Fk,deleteProperty:Nk,has:$k,ownKeys:Uk},jk={get:Bk,set(e,o){return!0},deleteProperty(e,o){return!0}},Gk=Cr({},XE,{get:Rk,set:Vk}),Yy=e=>e,Tg=e=>Reflect.getPrototypeOf(e);function Rm(e,o,a=!1,c=!1){e=e.__v_raw;const d=Yn(e),g=Yn(o);a||(o!==g&&po(d,"get",o),po(d,"get",g));const{has:_}=Tg(d),s=c?Yy:a?Qy:bf;if(_.call(d,o))return s(e.get(o));if(_.call(d,g))return s(e.get(g));e!==d&&e.get(o)}function Bm(e,o=!1){const a=this.__v_raw,c=Yn(a),d=Yn(e);return o||(e!==d&&po(c,"has",e),po(c,"has",d)),e===d?a.has(e):a.has(e)||a.has(d)}function Om(e,o=!1){return e=e.__v_raw,!o&&po(Yn(e),"iterate",Ac),Reflect.get(e,"size",e)}function z1(e){e=Yn(e);const o=Yn(this);return Tg(o).has.call(o,e)||(o.add(e),ma(o,"add",e,e)),this}function L1(e,o){o=Yn(o);const a=Yn(this),{has:c,get:d}=Tg(a);let g=c.call(a,e);g||(e=Yn(e),g=c.call(a,e));const _=d.call(a,e);return a.set(e,o),g?xf(o,_)&&ma(a,"set",e,o):ma(a,"add",e,o),this}function D1(e){const o=Yn(this),{has:a,get:c}=Tg(o);let d=a.call(o,e);d||(e=Yn(e),d=a.call(o,e)),c&&c.call(o,e);const g=o.delete(e);return d&&ma(o,"delete",e,void 0),g}function R1(){const e=Yn(this),o=e.size!==0,a=e.clear();return o&&ma(e,"clear",void 0,void 0),a}function Fm(e,o){return function(c,d){const g=this,_=g.__v_raw,s=Yn(_),w=o?Yy:e?Qy:bf;return!e&&po(s,"iterate",Ac),_.forEach((S,A)=>c.call(d,w(S),w(A),g))}}function Vm(e,o,a){return function(...c){const d=this.__v_raw,g=Yn(d),_=cf(g),s=e==="entries"||e===Symbol.iterator&&_,w=e==="keys"&&_,S=d[e](...c),A=a?Yy:o?Qy:bf;return!o&&po(g,"iterate",w?W_:Ac),{next(){const{value:z,done:L}=S.next();return L?{value:z,done:L}:{value:s?[A(z[0]),A(z[1])]:A(z),done:L}},[Symbol.iterator](){return this}}}}function al(e){return function(...o){return e==="delete"?!1:this}}function qk(){const e={get(g){return Rm(this,g)},get size(){return Om(this)},has:Bm,add:z1,set:L1,delete:D1,clear:R1,forEach:Fm(!1,!1)},o={get(g){return Rm(this,g,!1,!0)},get size(){return Om(this)},has:Bm,add:z1,set:L1,delete:D1,clear:R1,forEach:Fm(!1,!0)},a={get(g){return Rm(this,g,!0)},get size(){return Om(this,!0)},has(g){return Bm.call(this,g,!0)},add:al("add"),set:al("set"),delete:al("delete"),clear:al("clear"),forEach:Fm(!0,!1)},c={get(g){return Rm(this,g,!0,!0)},get size(){return Om(this,!0)},has(g){return Bm.call(this,g,!0)},add:al("add"),set:al("set"),delete:al("delete"),clear:al("clear"),forEach:Fm(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(g=>{e[g]=Vm(g,!1,!1),a[g]=Vm(g,!0,!1),o[g]=Vm(g,!1,!0),c[g]=Vm(g,!0,!0)}),[e,a,o,c]}const[Zk,Wk,Hk,Xk]=qk();function Ky(e,o){const a=o?e?Xk:Hk:e?Wk:Zk;return(c,d,g)=>d==="__v_isReactive"?!e:d==="__v_isReadonly"?e:d==="__v_raw"?c:Reflect.get(Hn(a,d)&&d in c?a:c,d,g)}const Yk={get:Ky(!1,!1)},Kk={get:Ky(!1,!0)},Jk={get:Ky(!0,!1)},YE=new WeakMap,KE=new WeakMap,JE=new WeakMap,Qk=new WeakMap;function eM(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function tM(e){return e.__v_skip||!Object.isExtensible(e)?0:eM(Tk(e))}function Ki(e){return ah(e)?e:Jy(e,!1,XE,Yk,YE)}function QE(e){return Jy(e,!1,Gk,Kk,KE)}function $f(e){return Jy(e,!0,jk,Jk,JE)}function Jy(e,o,a,c,d){if(!Ji(e)||e.__v_raw&&!(o&&e.__v_isReactive))return e;const g=d.get(e);if(g)return g;const _=tM(e);if(_===0)return e;const s=new Proxy(e,_===2?c:a);return d.set(e,s),s}function rh(e){return ah(e)?rh(e.__v_raw):!!(e&&e.__v_isReactive)}function ah(e){return!!(e&&e.__v_isReadonly)}function ig(e){return!!(e&&e.__v_isShallow)}function eS(e){return rh(e)||ah(e)}function Yn(e){const o=e&&e.__v_raw;return o?Yn(o):e}function tS(e){return tg(e,"__v_skip",!0),e}const bf=e=>Ji(e)?Ki(e):e,Qy=e=>Ji(e)?$f(e):e;function nS(e){gl&&ts&&(e=Yn(e),ZE(e.dep||(e.dep=Wy())))}function iS(e,o){e=Yn(e),e.dep&&H_(e.dep)}function Pi(e){return!!(e&&e.__v_isRef===!0)}function Qe(e){return rS(e,!1)}function Ci(e){return rS(e,!0)}function rS(e,o){return Pi(e)?e:new nM(e,o)}class nM{constructor(o,a){this.__v_isShallow=a,this.dep=void 0,this.__v_isRef=!0,this._rawValue=a?o:Yn(o),this._value=a?o:bf(o)}get value(){return nS(this),this._value}set value(o){const a=this.__v_isShallow||ig(o)||ah(o);o=a?o:Yn(o),xf(o,this._rawValue)&&(this._rawValue=o,this._value=a?o:bf(o),iS(this))}}function Xn(e){return Pi(e)?e.value:e}const iM={get:(e,o,a)=>Xn(Reflect.get(e,o,a)),set:(e,o,a,c)=>{const d=e[o];return Pi(d)&&!Pi(a)?(d.value=a,!0):Reflect.set(e,o,a,c)}};function oS(e){return rh(e)?e:new Proxy(e,iM)}function e0(e){const o=Mn(e)?new Array(e.length):{};for(const a in e)o[a]=St(e,a);return o}class rM{constructor(o,a,c){this._object=o,this._key=a,this._defaultValue=c,this.__v_isRef=!0}get value(){const o=this._object[this._key];return o===void 0?this._defaultValue:o}set value(o){this._object[this._key]=o}}function St(e,o,a){const c=e[o];return Pi(c)?c:new rM(e,o,a)}var sS;class oM{constructor(o,a,c,d){this._setter=a,this.dep=void 0,this.__v_isRef=!0,this[sS]=!1,this._dirty=!0,this.effect=new Hy(o,()=>{this._dirty||(this._dirty=!0,iS(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!d,this.__v_isReadonly=c}get value(){const o=Yn(this);return nS(o),(o._dirty||!o._cacheable)&&(o._dirty=!1,o._value=o.effect.run()),o._value}set value(o){this._setter(o)}}sS="__v_isReadonly";function sM(e,o,a=!1){let c,d;const g=Bn(e);return g?(c=e,d=rs):(c=e.get,d=e.set),new oM(c,d,g||!d,a)}const uf=[];function aM(e,...o){Rc();const a=uf.length?uf[uf.length-1].component:null,c=a&&a.appContext.config.warnHandler,d=lM();if(c)fa(c,a,11,[e+o.join(""),a&&a.proxy,d.map(({vnode:g})=>`at <${OS(a,g.type)}>`).join(`
`),d]);else{const g=[`[Vue warn]: ${e}`,...o];d.length&&g.push(`
`,...cM(d)),console.warn(...g)}Bc()}function lM(){let e=uf[uf.length-1];if(!e)return[];const o=[];for(;e;){const a=o[0];a&&a.vnode===e?a.recurseCount++:o.push({vnode:e,recurseCount:0});const c=e.component&&e.component.parent;e=c&&c.vnode}return o}function cM(e){const o=[];return e.forEach((a,c)=>{o.push(...c===0?[]:[`
`],...uM(a))}),o}function uM({vnode:e,recurseCount:o}){const a=o>0?`... (${o} recursive calls)`:"",c=e.component?e.component.parent==null:!1,d=` at <${OS(e.component,e.type,c)}`,g=">"+a;return e.props?[d,...hM(e.props),g]:[d+g]}function hM(e){const o=[],a=Object.keys(e);return a.slice(0,3).forEach(c=>{o.push(...aS(c,e[c]))}),a.length>3&&o.push(" ..."),o}function aS(e,o,a){return mr(o)?(o=JSON.stringify(o),a?o:[`${e}=${o}`]):typeof o=="number"||typeof o=="boolean"||o==null?a?o:[`${e}=${o}`]:Pi(o)?(o=aS(e,Yn(o.value),!0),a?o:[`${e}=Ref<`,o,">"]):Bn(o)?[`${e}=fn${o.name?`<${o.name}>`:""}`]:(o=Yn(o),a?o:[`${e}=`,o])}function fa(e,o,a,c){let d;try{d=c?e(...c):e()}catch(g){Cg(g,o,a)}return d}function Po(e,o,a,c){if(Bn(e)){const g=fa(e,o,a,c);return g&&$E(g)&&g.catch(_=>{Cg(_,o,a)}),g}const d=[];for(let g=0;g<e.length;g++)d.push(Po(e[g],o,a,c));return d}function Cg(e,o,a,c=!0){const d=o?o.vnode:null;if(o){let g=o.parent;const _=o.proxy,s=a;for(;g;){const S=g.ec;if(S){for(let A=0;A<S.length;A++)if(S[A](e,_,s)===!1)return}g=g.parent}const w=o.appContext.config.errorHandler;if(w){fa(w,null,10,[e,_,s]);return}}dM(e,a,d,c)}function dM(e,o,a,c=!0){console.error(e)}let wf=!1,X_=!1;const $r=[];let Ls=0;const oh=[];let da=null,xc=0;const lS=Promise.resolve();let t0=null;function Zi(e){const o=t0||lS;return e?o.then(this?e.bind(this):e):o}function fM(e){let o=Ls+1,a=$r.length;for(;o<a;){const c=o+a>>>1;Ef($r[c])<e?o=c+1:a=c}return o}function n0(e){(!$r.length||!$r.includes(e,wf&&e.allowRecurse?Ls+1:Ls))&&(e.id==null?$r.push(e):$r.splice(fM(e.id),0,e),cS())}function cS(){!wf&&!X_&&(X_=!0,t0=lS.then(hS))}function pM(e){const o=$r.indexOf(e);o>Ls&&$r.splice(o,1)}function mM(e){Mn(e)?oh.push(...e):(!da||!da.includes(e,e.allowRecurse?xc+1:xc))&&oh.push(e),cS()}function B1(e,o=wf?Ls+1:0){for(;o<$r.length;o++){const a=$r[o];a&&a.pre&&($r.splice(o,1),o--,a())}}function uS(e){if(oh.length){const o=[...new Set(oh)];if(oh.length=0,da){da.push(...o);return}for(da=o,da.sort((a,c)=>Ef(a)-Ef(c)),xc=0;xc<da.length;xc++)da[xc]();da=null,xc=0}}const Ef=e=>e.id==null?1/0:e.id,gM=(e,o)=>{const a=Ef(e)-Ef(o);if(a===0){if(e.pre&&!o.pre)return-1;if(o.pre&&!e.pre)return 1}return a};function hS(e){X_=!1,wf=!0,$r.sort(gM);const o=rs;try{for(Ls=0;Ls<$r.length;Ls++){const a=$r[Ls];a&&a.active!==!1&&fa(a,null,14)}}finally{Ls=0,$r.length=0,uS(),wf=!1,t0=null,($r.length||oh.length)&&hS()}}function vM(e,o,...a){if(e.isUnmounted)return;const c=e.vnode.props||Si;let d=a;const g=o.startsWith("update:"),_=g&&o.slice(7);if(_&&_ in c){const A=`${_==="modelValue"?"model":_}Modifiers`,{number:z,trim:L}=c[A]||Si;L&&(d=a.map(R=>R.trim())),z&&(d=a.map(ng))}let s,w=c[s=Hm(o)]||c[s=Hm(Ro(o))];!w&&g&&(w=c[s=Hm(dh(o))]),w&&Po(w,e,6,d);const S=c[s+"Once"];if(S){if(!e.emitted)e.emitted={};else if(e.emitted[s])return;e.emitted[s]=!0,Po(S,e,6,d)}}function dS(e,o,a=!1){const c=o.emitsCache,d=c.get(e);if(d!==void 0)return d;const g=e.emits;let _={},s=!1;if(!Bn(e)){const w=S=>{const A=dS(S,o,!0);A&&(s=!0,Cr(_,A))};!a&&o.mixins.length&&o.mixins.forEach(w),e.extends&&w(e.extends),e.mixins&&e.mixins.forEach(w)}return!g&&!s?(Ji(e)&&c.set(e,null),null):(Mn(g)?g.forEach(w=>_[w]=null):Cr(_,g),Ji(e)&&c.set(e,_),_)}function Ig(e,o){return!e||!wg(o)?!1:(o=o.slice(2).replace(/Once$/,""),Hn(e,o[0].toLowerCase()+o.slice(1))||Hn(e,dh(o))||Hn(e,o))}let Ur=null,fS=null;function rg(e){const o=Ur;return Ur=e,fS=e&&e.type.__scopeId||null,o}function fi(e,o=Ur,a){if(!o||e._n)return e;const c=(...d)=>{c._d&&H1(-1);const g=rg(o);let _;try{_=e(...d)}finally{rg(g),c._d&&H1(1)}return _};return c._n=!0,c._c=!0,c._d=!0,c}function __(e){const{type:o,vnode:a,proxy:c,withProxy:d,props:g,propsOptions:[_],slots:s,attrs:w,emit:S,render:A,renderCache:z,data:L,setupState:R,ctx:$,inheritAttrs:Z}=e;let de,ne;const ce=rg(e);try{if(a.shapeFlag&4){const Ee=d||c;de=zs(A.call(Ee,Ee,z,g,R,L,$)),ne=w}else{const Ee=o;de=zs(Ee.length>1?Ee(g,{attrs:w,slots:s,emit:S}):Ee(g,null)),ne=o.props?w:_M(w)}}catch(Ee){ff.length=0,Cg(Ee,e,1),de=F(zo)}let K=de;if(ne&&Z!==!1){const Ee=Object.keys(ne),{shapeFlag:Y}=K;Ee.length&&Y&7&&(_&&Ee.some(jy)&&(ne=yM(ne,_)),K=ga(K,ne))}return a.dirs&&(K=ga(K),K.dirs=K.dirs?K.dirs.concat(a.dirs):a.dirs),a.transition&&(K.transition=a.transition),de=K,rg(ce),de}const _M=e=>{let o;for(const a in e)(a==="class"||a==="style"||wg(a))&&((o||(o={}))[a]=e[a]);return o},yM=(e,o)=>{const a={};for(const c in e)(!jy(c)||!(c.slice(9)in o))&&(a[c]=e[c]);return a};function xM(e,o,a){const{props:c,children:d,component:g}=e,{props:_,children:s,patchFlag:w}=o,S=g.emitsOptions;if(o.dirs||o.transition)return!0;if(a&&w>=0){if(w&1024)return!0;if(w&16)return c?O1(c,_,S):!!_;if(w&8){const A=o.dynamicProps;for(let z=0;z<A.length;z++){const L=A[z];if(_[L]!==c[L]&&!Ig(S,L))return!0}}}else return(d||s)&&(!s||!s.$stable)?!0:c===_?!1:c?_?O1(c,_,S):!0:!!_;return!1}function O1(e,o,a){const c=Object.keys(o);if(c.length!==Object.keys(e).length)return!0;for(let d=0;d<c.length;d++){const g=c[d];if(o[g]!==e[g]&&!Ig(a,g))return!0}return!1}function bM({vnode:e,parent:o},a){for(;o&&o.subTree===e;)(e=o.vnode).el=a,o=o.parent}const wM=e=>e.__isSuspense;function EM(e,o){o&&o.pendingBranch?Mn(e)?o.effects.push(...e):o.effects.push(e):mM(e)}function Gi(e,o){if(Tr){let a=Tr.provides;const c=Tr.parent&&Tr.parent.provides;c===a&&(a=Tr.provides=Object.create(c)),a[e]=o}}function cn(e,o,a=!1){const c=Tr||Ur;if(c){const d=c.parent==null?c.vnode.appContext&&c.vnode.appContext.provides:c.parent.provides;if(d&&e in d)return d[e];if(arguments.length>1)return a&&Bn(o)?o.call(c.proxy):o}}function Vs(e,o){return i0(e,null,o)}const F1={};function Ye(e,o,a){return i0(e,o,a)}function i0(e,o,{immediate:a,deep:c,flush:d,onTrack:g,onTrigger:_}=Si){const s=Tr;let w,S=!1,A=!1;if(Pi(e)?(w=()=>e.value,S=ig(e)):rh(e)?(w=()=>e,c=!0):Mn(e)?(A=!0,S=e.some(ne=>rh(ne)||ig(ne)),w=()=>e.map(ne=>{if(Pi(ne))return ne.value;if(rh(ne))return Ec(ne);if(Bn(ne))return fa(ne,s,2)})):Bn(e)?o?w=()=>fa(e,s,2):w=()=>{if(!(s&&s.isUnmounted))return z&&z(),Po(e,s,3,[L])}:w=rs,o&&c){const ne=w;w=()=>Ec(ne())}let z,L=ne=>{z=de.onStop=()=>{fa(ne,s,4)}};if(If)return L=rs,o?a&&Po(o,s,3,[w(),A?[]:void 0,L]):w(),rs;let R=A?[]:F1;const $=()=>{if(!!de.active)if(o){const ne=de.run();(c||S||(A?ne.some((ce,K)=>xf(ce,R[K])):xf(ne,R)))&&(z&&z(),Po(o,s,3,[ne,R===F1?void 0:R,L]),R=ne)}else de.run()};$.allowRecurse=!!o;let Z;d==="sync"?Z=$:d==="post"?Z=()=>ro($,s&&s.suspense):($.pre=!0,s&&($.id=s.uid),Z=()=>n0($));const de=new Hy(w,Z);return o?a?$():R=de.run():d==="post"?ro(de.run.bind(de),s&&s.suspense):de.run(),()=>{de.stop(),s&&s.scope&&Gy(s.scope.effects,de)}}function SM(e,o,a){const c=this.proxy,d=mr(e)?e.includes(".")?pS(c,e):()=>c[e]:e.bind(c,c);let g;Bn(o)?g=o:(g=o.handler,a=o);const _=Tr;lh(this);const s=i0(d,g.bind(c),a);return _?lh(_):kc(),s}function pS(e,o){const a=o.split(".");return()=>{let c=e;for(let d=0;d<a.length&&c;d++)c=c[a[d]];return c}}function Ec(e,o){if(!Ji(e)||e.__v_skip||(o=o||new Set,o.has(e)))return e;if(o.add(e),Pi(e))Ec(e.value,o);else if(Mn(e))for(let a=0;a<e.length;a++)Ec(e[a],o);else if(Ek(e)||cf(e))e.forEach(a=>{Ec(a,o)});else if(Ck(e))for(const a in e)Ec(e[a],o);return e}function mS(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Fn(()=>{e.isMounted=!0}),Ii(()=>{e.isUnmounting=!0}),e}const Ao=[Function,Array],TM={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ao,onEnter:Ao,onAfterEnter:Ao,onEnterCancelled:Ao,onBeforeLeave:Ao,onLeave:Ao,onAfterLeave:Ao,onLeaveCancelled:Ao,onBeforeAppear:Ao,onAppear:Ao,onAfterAppear:Ao,onAppearCancelled:Ao},setup(e,{slots:o}){const a=zg(),c=mS();let d;return()=>{const g=o.default&&r0(o.default(),!0);if(!g||!g.length)return;let _=g[0];if(g.length>1){for(const Z of g)if(Z.type!==zo){_=Z;break}}const s=Yn(e),{mode:w}=s;if(c.isLeaving)return y_(_);const S=V1(_);if(!S)return y_(_);const A=Sf(S,s,c,a);Tf(S,A);const z=a.subTree,L=z&&V1(z);let R=!1;const{getTransitionKey:$}=S.type;if($){const Z=$();d===void 0?d=Z:Z!==d&&(d=Z,R=!0)}if(L&&L.type!==zo&&(!bc(S,L)||R)){const Z=Sf(L,s,c,a);if(Tf(L,Z),w==="out-in")return c.isLeaving=!0,Z.afterLeave=()=>{c.isLeaving=!1,a.update()},y_(_);w==="in-out"&&S.type!==zo&&(Z.delayLeave=(de,ne,ce)=>{const K=vS(c,L);K[String(L.key)]=L,de._leaveCb=()=>{ne(),de._leaveCb=void 0,delete A.delayedLeave},A.delayedLeave=ce})}return _}}},gS=TM;function vS(e,o){const{leavingVNodes:a}=e;let c=a.get(o.type);return c||(c=Object.create(null),a.set(o.type,c)),c}function Sf(e,o,a,c){const{appear:d,mode:g,persisted:_=!1,onBeforeEnter:s,onEnter:w,onAfterEnter:S,onEnterCancelled:A,onBeforeLeave:z,onLeave:L,onAfterLeave:R,onLeaveCancelled:$,onBeforeAppear:Z,onAppear:de,onAfterAppear:ne,onAppearCancelled:ce}=o,K=String(e.key),Ee=vS(a,e),Y=(ve,Se)=>{ve&&Po(ve,c,9,Se)},_e=(ve,Se)=>{const be=Se[1];Y(ve,Se),Mn(ve)?ve.every(De=>De.length<=1)&&be():ve.length<=1&&be()},fe={mode:g,persisted:_,beforeEnter(ve){let Se=s;if(!a.isMounted)if(d)Se=Z||s;else return;ve._leaveCb&&ve._leaveCb(!0);const be=Ee[K];be&&bc(e,be)&&be.el._leaveCb&&be.el._leaveCb(),Y(Se,[ve])},enter(ve){let Se=w,be=S,De=A;if(!a.isMounted)if(d)Se=de||w,be=ne||S,De=ce||A;else return;let ze=!1;const Ke=ve._enterCb=ct=>{ze||(ze=!0,ct?Y(De,[ve]):Y(be,[ve]),fe.delayedLeave&&fe.delayedLeave(),ve._enterCb=void 0)};Se?_e(Se,[ve,Ke]):Ke()},leave(ve,Se){const be=String(e.key);if(ve._enterCb&&ve._enterCb(!0),a.isUnmounting)return Se();Y(z,[ve]);let De=!1;const ze=ve._leaveCb=Ke=>{De||(De=!0,Se(),Ke?Y($,[ve]):Y(R,[ve]),ve._leaveCb=void 0,Ee[be]===e&&delete Ee[be])};Ee[be]=e,L?_e(L,[ve,ze]):ze()},clone(ve){return Sf(ve,o,a,c)}};return fe}function y_(e){if(Ag(e))return e=ga(e),e.children=null,e}function V1(e){return Ag(e)?e.children?e.children[0]:void 0:e}function Tf(e,o){e.shapeFlag&6&&e.component?Tf(e.component.subTree,o):e.shapeFlag&128?(e.ssContent.transition=o.clone(e.ssContent),e.ssFallback.transition=o.clone(e.ssFallback)):e.transition=o}function r0(e,o=!1,a){let c=[],d=0;for(let g=0;g<e.length;g++){let _=e[g];const s=a==null?_.key:String(a)+String(_.key!=null?_.key:g);_.type===On?(_.patchFlag&128&&d++,c=c.concat(r0(_.children,o,s))):(o||_.type!==zo)&&c.push(s!=null?ga(_,{key:s}):_)}if(d>1)for(let g=0;g<c.length;g++)c[g].patchFlag=-2;return c}function gn(e){return Bn(e)?{setup:e,name:e.name}:e}const hf=e=>!!e.type.__asyncLoader,Ag=e=>e.type.__isKeepAlive;function _S(e,o){xS(e,"a",o)}function yS(e,o){xS(e,"da",o)}function xS(e,o,a=Tr){const c=e.__wdc||(e.__wdc=()=>{let d=a;for(;d;){if(d.isDeactivated)return;d=d.parent}return e()});if(kg(o,c,a),a){let d=a.parent;for(;d&&d.parent;)Ag(d.parent.vnode)&&CM(c,o,a,d),d=d.parent}}function CM(e,o,a,c){const d=kg(o,e,c,!0);gr(()=>{Gy(c[o],d)},a)}function kg(e,o,a=Tr,c=!1){if(a){const d=a[e]||(a[e]=[]),g=o.__weh||(o.__weh=(..._)=>{if(a.isUnmounted)return;Rc(),lh(a);const s=Po(o,a,e,_);return kc(),Bc(),s});return c?d.unshift(g):d.push(g),g}}const _a=e=>(o,a=Tr)=>(!If||e==="sp")&&kg(e,(...c)=>o(...c),a),Mg=_a("bm"),Fn=_a("m"),bS=_a("bu"),wS=_a("u"),Ii=_a("bum"),gr=_a("um"),IM=_a("sp"),AM=_a("rtg"),kM=_a("rtc");function MM(e,o=Tr){kg("ec",e,o)}function Wi(e,o){const a=Ur;if(a===null)return e;const c=Lg(a)||a.proxy,d=e.dirs||(e.dirs=[]);for(let g=0;g<o.length;g++){let[_,s,w,S=Si]=o[g];Bn(_)&&(_={mounted:_,updated:_}),_.deep&&Ec(s),d.push({dir:_,instance:c,value:s,oldValue:void 0,arg:w,modifiers:S})}return e}function pc(e,o,a,c){const d=e.dirs,g=o&&o.dirs;for(let _=0;_<d.length;_++){const s=d[_];g&&(s.oldValue=g[_].value);let w=s.dir[c];w&&(Rc(),Po(w,a,8,[e.el,s,e,o]),Bc())}}const o0="components",PM="directives";function Os(e,o){return s0(o0,e,!0,o)||e}const ES=Symbol();function zM(e){return mr(e)?s0(o0,e,!1)||e:e||ES}function mo(e){return s0(PM,e)}function s0(e,o,a=!0,c=!1){const d=Ur||Tr;if(d){const g=d.type;if(e===o0){const s=BS(g,!1);if(s&&(s===o||s===Ro(o)||s===xl(Ro(o))))return g}const _=N1(d[e]||g[e],o)||N1(d.appContext[e],o);return!_&&c?g:_}}function N1(e,o){return e&&(e[o]||e[Ro(o)]||e[xl(Ro(o))])}function Uf(e,o,a={},c,d){if(Ur.isCE||Ur.parent&&hf(Ur.parent)&&Ur.parent.isCE)return F("slot",o==="default"?null:{name:o},c&&c());let g=e[o];g&&g._c&&(g._d=!1),bi();const _=g&&SS(g(a)),s=jr(On,{key:a.key||_&&_.key||`_${o}`},_||(c?c():[]),_&&e._===1?64:-2);return!d&&s.scopeId&&(s.slotScopeIds=[s.scopeId+"-s"]),g&&g._c&&(g._d=!0),s}function SS(e){return e.some(o=>ag(o)?!(o.type===zo||o.type===On&&!SS(o.children)):!0)?e:null}function x_(e,o){const a={};for(const c in e)a[o&&/[A-Z]/.test(c)?`on:${c}`:Hm(c)]=e[c];return a}const Y_=e=>e?DS(e)?Lg(e)||e.proxy:Y_(e.parent):null,og=Cr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Y_(e.parent),$root:e=>Y_(e.root),$emit:e=>e.emit,$options:e=>a0(e),$forceUpdate:e=>e.f||(e.f=()=>n0(e.update)),$nextTick:e=>e.n||(e.n=Zi.bind(e.proxy)),$watch:e=>SM.bind(e)}),LM={get({_:e},o){const{ctx:a,setupState:c,data:d,props:g,accessCache:_,type:s,appContext:w}=e;let S;if(o[0]!=="$"){const R=_[o];if(R!==void 0)switch(R){case 1:return c[o];case 2:return d[o];case 4:return a[o];case 3:return g[o]}else{if(c!==Si&&Hn(c,o))return _[o]=1,c[o];if(d!==Si&&Hn(d,o))return _[o]=2,d[o];if((S=e.propsOptions[0])&&Hn(S,o))return _[o]=3,g[o];if(a!==Si&&Hn(a,o))return _[o]=4,a[o];K_&&(_[o]=0)}}const A=og[o];let z,L;if(A)return o==="$attrs"&&po(e,"get",o),A(e);if((z=s.__cssModules)&&(z=z[o]))return z;if(a!==Si&&Hn(a,o))return _[o]=4,a[o];if(L=w.config.globalProperties,Hn(L,o))return L[o]},set({_:e},o,a){const{data:c,setupState:d,ctx:g}=e;return d!==Si&&Hn(d,o)?(d[o]=a,!0):c!==Si&&Hn(c,o)?(c[o]=a,!0):Hn(e.props,o)||o[0]==="$"&&o.slice(1)in e?!1:(g[o]=a,!0)},has({_:{data:e,setupState:o,accessCache:a,ctx:c,appContext:d,propsOptions:g}},_){let s;return!!a[_]||e!==Si&&Hn(e,_)||o!==Si&&Hn(o,_)||(s=g[0])&&Hn(s,_)||Hn(c,_)||Hn(og,_)||Hn(d.config.globalProperties,_)},defineProperty(e,o,a){return a.get!=null?e._.accessCache[o]=0:Hn(a,"value")&&this.set(e,o,a.value,null),Reflect.defineProperty(e,o,a)}};let K_=!0;function DM(e){const o=a0(e),a=e.proxy,c=e.ctx;K_=!1,o.beforeCreate&&$1(o.beforeCreate,e,"bc");const{data:d,computed:g,methods:_,watch:s,provide:w,inject:S,created:A,beforeMount:z,mounted:L,beforeUpdate:R,updated:$,activated:Z,deactivated:de,beforeDestroy:ne,beforeUnmount:ce,destroyed:K,unmounted:Ee,render:Y,renderTracked:_e,renderTriggered:fe,errorCaptured:ve,serverPrefetch:Se,expose:be,inheritAttrs:De,components:ze,directives:Ke,filters:ct}=o;if(S&&RM(S,c,null,e.appContext.config.unwrapInjectedRef),_)for(const Pe in _){const at=_[Pe];Bn(at)&&(c[Pe]=at.bind(a))}if(d){const Pe=d.call(a,a);Ji(Pe)&&(e.data=Ki(Pe))}if(K_=!0,g)for(const Pe in g){const at=g[Pe],Gt=Bn(at)?at.bind(a,a):Bn(at.get)?at.get.bind(a,a):rs,pt=!Bn(at)&&Bn(at.set)?at.set.bind(a):rs,Lt=ie({get:Gt,set:pt});Object.defineProperty(c,Pe,{enumerable:!0,configurable:!0,get:()=>Lt.value,set:qt=>Lt.value=qt})}if(s)for(const Pe in s)TS(s[Pe],c,a,Pe);if(w){const Pe=Bn(w)?w.call(a):w;Reflect.ownKeys(Pe).forEach(at=>{Gi(at,Pe[at])})}A&&$1(A,e,"c");function ft(Pe,at){Mn(at)?at.forEach(Gt=>Pe(Gt.bind(a))):at&&Pe(at.bind(a))}if(ft(Mg,z),ft(Fn,L),ft(bS,R),ft(wS,$),ft(_S,Z),ft(yS,de),ft(MM,ve),ft(kM,_e),ft(AM,fe),ft(Ii,ce),ft(gr,Ee),ft(IM,Se),Mn(be))if(be.length){const Pe=e.exposed||(e.exposed={});be.forEach(at=>{Object.defineProperty(Pe,at,{get:()=>a[at],set:Gt=>a[at]=Gt})})}else e.exposed||(e.exposed={});Y&&e.render===rs&&(e.render=Y),De!=null&&(e.inheritAttrs=De),ze&&(e.components=ze),Ke&&(e.directives=Ke)}function RM(e,o,a=rs,c=!1){Mn(e)&&(e=J_(e));for(const d in e){const g=e[d];let _;Ji(g)?"default"in g?_=cn(g.from||d,g.default,!0):_=cn(g.from||d):_=cn(g),Pi(_)&&c?Object.defineProperty(o,d,{enumerable:!0,configurable:!0,get:()=>_.value,set:s=>_.value=s}):o[d]=_}}function $1(e,o,a){Po(Mn(e)?e.map(c=>c.bind(o.proxy)):e.bind(o.proxy),o,a)}function TS(e,o,a,c){const d=c.includes(".")?pS(a,c):()=>a[c];if(mr(e)){const g=o[e];Bn(g)&&Ye(d,g)}else if(Bn(e))Ye(d,e.bind(a));else if(Ji(e))if(Mn(e))e.forEach(g=>TS(g,o,a,c));else{const g=Bn(e.handler)?e.handler.bind(a):o[e.handler];Bn(g)&&Ye(d,g,e)}}function a0(e){const o=e.type,{mixins:a,extends:c}=o,{mixins:d,optionsCache:g,config:{optionMergeStrategies:_}}=e.appContext,s=g.get(o);let w;return s?w=s:!d.length&&!a&&!c?w=o:(w={},d.length&&d.forEach(S=>sg(w,S,_,!0)),sg(w,o,_)),Ji(o)&&g.set(o,w),w}function sg(e,o,a,c=!1){const{mixins:d,extends:g}=o;g&&sg(e,g,a,!0),d&&d.forEach(_=>sg(e,_,a,!0));for(const _ in o)if(!(c&&_==="expose")){const s=BM[_]||a&&a[_];e[_]=s?s(e[_],o[_]):o[_]}return e}const BM={data:U1,props:yc,emits:yc,methods:yc,computed:yc,beforeCreate:Hr,created:Hr,beforeMount:Hr,mounted:Hr,beforeUpdate:Hr,updated:Hr,beforeDestroy:Hr,beforeUnmount:Hr,destroyed:Hr,unmounted:Hr,activated:Hr,deactivated:Hr,errorCaptured:Hr,serverPrefetch:Hr,components:yc,directives:yc,watch:FM,provide:U1,inject:OM};function U1(e,o){return o?e?function(){return Cr(Bn(e)?e.call(this,this):e,Bn(o)?o.call(this,this):o)}:o:e}function OM(e,o){return yc(J_(e),J_(o))}function J_(e){if(Mn(e)){const o={};for(let a=0;a<e.length;a++)o[e[a]]=e[a];return o}return e}function Hr(e,o){return e?[...new Set([].concat(e,o))]:o}function yc(e,o){return e?Cr(Cr(Object.create(null),e),o):o}function FM(e,o){if(!e)return o;if(!o)return e;const a=Cr(Object.create(null),e);for(const c in o)a[c]=Hr(e[c],o[c]);return a}function VM(e,o,a,c=!1){const d={},g={};tg(g,Pg,1),e.propsDefaults=Object.create(null),CS(e,o,d,g);for(const _ in e.propsOptions[0])_ in d||(d[_]=void 0);a?e.props=c?d:QE(d):e.type.props?e.props=d:e.props=g,e.attrs=g}function NM(e,o,a,c){const{props:d,attrs:g,vnode:{patchFlag:_}}=e,s=Yn(d),[w]=e.propsOptions;let S=!1;if((c||_>0)&&!(_&16)){if(_&8){const A=e.vnode.dynamicProps;for(let z=0;z<A.length;z++){let L=A[z];if(Ig(e.emitsOptions,L))continue;const R=o[L];if(w)if(Hn(g,L))R!==g[L]&&(g[L]=R,S=!0);else{const $=Ro(L);d[$]=Q_(w,s,$,R,e,!1)}else R!==g[L]&&(g[L]=R,S=!0)}}}else{CS(e,o,d,g)&&(S=!0);let A;for(const z in s)(!o||!Hn(o,z)&&((A=dh(z))===z||!Hn(o,A)))&&(w?a&&(a[z]!==void 0||a[A]!==void 0)&&(d[z]=Q_(w,s,z,void 0,e,!0)):delete d[z]);if(g!==s)for(const z in g)(!o||!Hn(o,z)&&!0)&&(delete g[z],S=!0)}S&&ma(e,"set","$attrs")}function CS(e,o,a,c){const[d,g]=e.propsOptions;let _=!1,s;if(o)for(let w in o){if(Wm(w))continue;const S=o[w];let A;d&&Hn(d,A=Ro(w))?!g||!g.includes(A)?a[A]=S:(s||(s={}))[A]=S:Ig(e.emitsOptions,w)||(!(w in c)||S!==c[w])&&(c[w]=S,_=!0)}if(g){const w=Yn(a),S=s||Si;for(let A=0;A<g.length;A++){const z=g[A];a[z]=Q_(d,w,z,S[z],e,!Hn(S,z))}}return _}function Q_(e,o,a,c,d,g){const _=e[a];if(_!=null){const s=Hn(_,"default");if(s&&c===void 0){const w=_.default;if(_.type!==Function&&Bn(w)){const{propsDefaults:S}=d;a in S?c=S[a]:(lh(d),c=S[a]=w.call(null,o),kc())}else c=w}_[0]&&(g&&!s?c=!1:_[1]&&(c===""||c===dh(a))&&(c=!0))}return c}function IS(e,o,a=!1){const c=o.propsCache,d=c.get(e);if(d)return d;const g=e.props,_={},s=[];let w=!1;if(!Bn(e)){const A=z=>{w=!0;const[L,R]=IS(z,o,!0);Cr(_,L),R&&s.push(...R)};!a&&o.mixins.length&&o.mixins.forEach(A),e.extends&&A(e.extends),e.mixins&&e.mixins.forEach(A)}if(!g&&!w)return Ji(e)&&c.set(e,ih),ih;if(Mn(g))for(let A=0;A<g.length;A++){const z=Ro(g[A]);j1(z)&&(_[z]=Si)}else if(g)for(const A in g){const z=Ro(A);if(j1(z)){const L=g[A],R=_[z]=Mn(L)||Bn(L)?{type:L}:L;if(R){const $=Z1(Boolean,R.type),Z=Z1(String,R.type);R[0]=$>-1,R[1]=Z<0||$<Z,($>-1||Hn(R,"default"))&&s.push(z)}}}const S=[_,s];return Ji(e)&&c.set(e,S),S}function j1(e){return e[0]!=="$"}function G1(e){const o=e&&e.toString().match(/^\s*function (\w+)/);return o?o[1]:e===null?"null":""}function q1(e,o){return G1(e)===G1(o)}function Z1(e,o){return Mn(o)?o.findIndex(a=>q1(a,e)):Bn(o)&&q1(o,e)?0:-1}const AS=e=>e[0]==="_"||e==="$stable",l0=e=>Mn(e)?e.map(zs):[zs(e)],$M=(e,o,a)=>{if(o._n)return o;const c=fi((...d)=>l0(o(...d)),a);return c._c=!1,c},kS=(e,o,a)=>{const c=e._ctx;for(const d in e){if(AS(d))continue;const g=e[d];if(Bn(g))o[d]=$M(d,g,c);else if(g!=null){const _=l0(g);o[d]=()=>_}}},MS=(e,o)=>{const a=l0(o);e.slots.default=()=>a},UM=(e,o)=>{if(e.vnode.shapeFlag&32){const a=o._;a?(e.slots=Yn(o),tg(o,"_",a)):kS(o,e.slots={})}else e.slots={},o&&MS(e,o);tg(e.slots,Pg,1)},jM=(e,o,a)=>{const{vnode:c,slots:d}=e;let g=!0,_=Si;if(c.shapeFlag&32){const s=o._;s?a&&s===1?g=!1:(Cr(d,o),!a&&s===1&&delete d._):(g=!o.$stable,kS(o,d)),_=o}else o&&(MS(e,o),_={default:1});if(g)for(const s in d)!AS(s)&&!(s in _)&&delete d[s]};function PS(){return{app:null,config:{isNativeTag:xk,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let GM=0;function qM(e,o){return function(c,d=null){Bn(c)||(c=Object.assign({},c)),d!=null&&!Ji(d)&&(d=null);const g=PS(),_=new Set;let s=!1;const w=g.app={_uid:GM++,_component:c,_props:d,_container:null,_context:g,_instance:null,version:fP,get config(){return g.config},set config(S){},use(S,...A){return _.has(S)||(S&&Bn(S.install)?(_.add(S),S.install(w,...A)):Bn(S)&&(_.add(S),S(w,...A))),w},mixin(S){return g.mixins.includes(S)||g.mixins.push(S),w},component(S,A){return A?(g.components[S]=A,w):g.components[S]},directive(S,A){return A?(g.directives[S]=A,w):g.directives[S]},mount(S,A,z){if(!s){const L=F(c,d);return L.appContext=g,A&&o?o(L,S):e(L,S,z),s=!0,w._container=S,S.__vue_app__=w,Lg(L.component)||L.component.proxy}},unmount(){s&&(e(null,w._container),delete w._container.__vue_app__)},provide(S,A){return g.provides[S]=A,w}};return w}}function ey(e,o,a,c,d=!1){if(Mn(e)){e.forEach((L,R)=>ey(L,o&&(Mn(o)?o[R]:o),a,c,d));return}if(hf(c)&&!d)return;const g=c.shapeFlag&4?Lg(c.component)||c.component.proxy:c.el,_=d?null:g,{i:s,r:w}=e,S=o&&o.r,A=s.refs===Si?s.refs={}:s.refs,z=s.setupState;if(S!=null&&S!==w&&(mr(S)?(A[S]=null,Hn(z,S)&&(z[S]=null)):Pi(S)&&(S.value=null)),Bn(w))fa(w,s,12,[_,A]);else{const L=mr(w),R=Pi(w);if(L||R){const $=()=>{if(e.f){const Z=L?Hn(z,w)?z[w]:A[w]:w.value;d?Mn(Z)&&Gy(Z,g):Mn(Z)?Z.includes(g)||Z.push(g):L?(A[w]=[g],Hn(z,w)&&(z[w]=A[w])):(w.value=[g],e.k&&(A[e.k]=w.value))}else L?(A[w]=_,Hn(z,w)&&(z[w]=_)):R&&(w.value=_,e.k&&(A[e.k]=_))};_?($.id=-1,ro($,a)):$()}}}const ro=EM;function ZM(e){return WM(e)}function WM(e,o){const a=kk();a.__VUE__=!0;const{insert:c,remove:d,patchProp:g,createElement:_,createText:s,createComment:w,setText:S,setElementText:A,parentNode:z,nextSibling:L,setScopeId:R=rs,insertStaticContent:$}=e,Z=(he,Me,qe,st=null,yt=null,Dt=null,Nt=!1,Pt=null,Ft=!!Me.dynamicChildren)=>{if(he===Me)return;he&&!bc(he,Me)&&(st=Tt(he),qt(he,yt,Dt,!0),he=null),Me.patchFlag===-2&&(Ft=!1,Me.dynamicChildren=null);const{type:Et,ref:Jt,shapeFlag:Wt}=Me;switch(Et){case u0:de(he,Me,qe,st);break;case zo:ne(he,Me,qe,st);break;case b_:he==null&&ce(Me,qe,st,Nt);break;case On:ze(he,Me,qe,st,yt,Dt,Nt,Pt,Ft);break;default:Wt&1?Y(he,Me,qe,st,yt,Dt,Nt,Pt,Ft):Wt&6?Ke(he,Me,qe,st,yt,Dt,Nt,Pt,Ft):(Wt&64||Wt&128)&&Et.process(he,Me,qe,st,yt,Dt,Nt,Pt,Ft,pn)}Jt!=null&&yt&&ey(Jt,he&&he.ref,Dt,Me||he,!Me)},de=(he,Me,qe,st)=>{if(he==null)c(Me.el=s(Me.children),qe,st);else{const yt=Me.el=he.el;Me.children!==he.children&&S(yt,Me.children)}},ne=(he,Me,qe,st)=>{he==null?c(Me.el=w(Me.children||""),qe,st):Me.el=he.el},ce=(he,Me,qe,st)=>{[he.el,he.anchor]=$(he.children,Me,qe,st,he.el,he.anchor)},K=({el:he,anchor:Me},qe,st)=>{let yt;for(;he&&he!==Me;)yt=L(he),c(he,qe,st),he=yt;c(Me,qe,st)},Ee=({el:he,anchor:Me})=>{let qe;for(;he&&he!==Me;)qe=L(he),d(he),he=qe;d(Me)},Y=(he,Me,qe,st,yt,Dt,Nt,Pt,Ft)=>{Nt=Nt||Me.type==="svg",he==null?_e(Me,qe,st,yt,Dt,Nt,Pt,Ft):Se(he,Me,yt,Dt,Nt,Pt,Ft)},_e=(he,Me,qe,st,yt,Dt,Nt,Pt)=>{let Ft,Et;const{type:Jt,props:Wt,shapeFlag:on,transition:fn,dirs:Tn}=he;if(Ft=he.el=_(he.type,Dt,Wt&&Wt.is,Wt),on&8?A(Ft,he.children):on&16&&ve(he.children,Ft,null,st,yt,Dt&&Jt!=="foreignObject",Nt,Pt),Tn&&pc(he,null,st,"created"),Wt){for(const Gn in Wt)Gn!=="value"&&!Wm(Gn)&&g(Ft,Gn,null,Wt[Gn],Dt,he.children,st,yt,bt);"value"in Wt&&g(Ft,"value",null,Wt.value),(Et=Wt.onVnodeBeforeMount)&&Ms(Et,st,he)}fe(Ft,he,he.scopeId,Nt,st),Tn&&pc(he,null,st,"beforeMount");const jn=(!yt||yt&&!yt.pendingBranch)&&fn&&!fn.persisted;jn&&fn.beforeEnter(Ft),c(Ft,Me,qe),((Et=Wt&&Wt.onVnodeMounted)||jn||Tn)&&ro(()=>{Et&&Ms(Et,st,he),jn&&fn.enter(Ft),Tn&&pc(he,null,st,"mounted")},yt)},fe=(he,Me,qe,st,yt)=>{if(qe&&R(he,qe),st)for(let Dt=0;Dt<st.length;Dt++)R(he,st[Dt]);if(yt){let Dt=yt.subTree;if(Me===Dt){const Nt=yt.vnode;fe(he,Nt,Nt.scopeId,Nt.slotScopeIds,yt.parent)}}},ve=(he,Me,qe,st,yt,Dt,Nt,Pt,Ft=0)=>{for(let Et=Ft;Et<he.length;Et++){const Jt=he[Et]=Pt?dl(he[Et]):zs(he[Et]);Z(null,Jt,Me,qe,st,yt,Dt,Nt,Pt)}},Se=(he,Me,qe,st,yt,Dt,Nt)=>{const Pt=Me.el=he.el;let{patchFlag:Ft,dynamicChildren:Et,dirs:Jt}=Me;Ft|=he.patchFlag&16;const Wt=he.props||Si,on=Me.props||Si;let fn;qe&&mc(qe,!1),(fn=on.onVnodeBeforeUpdate)&&Ms(fn,qe,Me,he),Jt&&pc(Me,he,qe,"beforeUpdate"),qe&&mc(qe,!0);const Tn=yt&&Me.type!=="foreignObject";if(Et?be(he.dynamicChildren,Et,Pt,qe,st,Tn,Dt):Nt||at(he,Me,Pt,null,qe,st,Tn,Dt,!1),Ft>0){if(Ft&16)De(Pt,Me,Wt,on,qe,st,yt);else if(Ft&2&&Wt.class!==on.class&&g(Pt,"class",null,on.class,yt),Ft&4&&g(Pt,"style",Wt.style,on.style,yt),Ft&8){const jn=Me.dynamicProps;for(let Gn=0;Gn<jn.length;Gn++){const vi=jn[Gn],rr=Wt[vi],Hi=on[vi];(Hi!==rr||vi==="value")&&g(Pt,vi,rr,Hi,yt,he.children,qe,st,bt)}}Ft&1&&he.children!==Me.children&&A(Pt,Me.children)}else!Nt&&Et==null&&De(Pt,Me,Wt,on,qe,st,yt);((fn=on.onVnodeUpdated)||Jt)&&ro(()=>{fn&&Ms(fn,qe,Me,he),Jt&&pc(Me,he,qe,"updated")},st)},be=(he,Me,qe,st,yt,Dt,Nt)=>{for(let Pt=0;Pt<Me.length;Pt++){const Ft=he[Pt],Et=Me[Pt],Jt=Ft.el&&(Ft.type===On||!bc(Ft,Et)||Ft.shapeFlag&70)?z(Ft.el):qe;Z(Ft,Et,Jt,null,st,yt,Dt,Nt,!0)}},De=(he,Me,qe,st,yt,Dt,Nt)=>{if(qe!==st){if(qe!==Si)for(const Pt in qe)!Wm(Pt)&&!(Pt in st)&&g(he,Pt,qe[Pt],null,Nt,Me.children,yt,Dt,bt);for(const Pt in st){if(Wm(Pt))continue;const Ft=st[Pt],Et=qe[Pt];Ft!==Et&&Pt!=="value"&&g(he,Pt,Et,Ft,Nt,Me.children,yt,Dt,bt)}"value"in st&&g(he,"value",qe.value,st.value)}},ze=(he,Me,qe,st,yt,Dt,Nt,Pt,Ft)=>{const Et=Me.el=he?he.el:s(""),Jt=Me.anchor=he?he.anchor:s("");let{patchFlag:Wt,dynamicChildren:on,slotScopeIds:fn}=Me;fn&&(Pt=Pt?Pt.concat(fn):fn),he==null?(c(Et,qe,st),c(Jt,qe,st),ve(Me.children,qe,Jt,yt,Dt,Nt,Pt,Ft)):Wt>0&&Wt&64&&on&&he.dynamicChildren?(be(he.dynamicChildren,on,qe,yt,Dt,Nt,Pt),(Me.key!=null||yt&&Me===yt.subTree)&&c0(he,Me,!0)):at(he,Me,qe,Jt,yt,Dt,Nt,Pt,Ft)},Ke=(he,Me,qe,st,yt,Dt,Nt,Pt,Ft)=>{Me.slotScopeIds=Pt,he==null?Me.shapeFlag&512?yt.ctx.activate(Me,qe,st,Nt,Ft):ct(Me,qe,st,yt,Dt,Nt,Ft):nt(he,Me,Ft)},ct=(he,Me,qe,st,yt,Dt,Nt)=>{const Pt=he.component=oP(he,st,yt);if(Ag(he)&&(Pt.ctx.renderer=pn),sP(Pt),Pt.asyncDep){if(yt&&yt.registerDep(Pt,ft),!he.el){const Ft=Pt.subTree=F(zo);ne(null,Ft,Me,qe)}return}ft(Pt,he,Me,qe,yt,Dt,Nt)},nt=(he,Me,qe)=>{const st=Me.component=he.component;if(xM(he,Me,qe))if(st.asyncDep&&!st.asyncResolved){Pe(st,Me,qe);return}else st.next=Me,pM(st.update),st.update();else Me.el=he.el,st.vnode=Me},ft=(he,Me,qe,st,yt,Dt,Nt)=>{const Pt=()=>{if(he.isMounted){let{next:Jt,bu:Wt,u:on,parent:fn,vnode:Tn}=he,jn=Jt,Gn;mc(he,!1),Jt?(Jt.el=Tn.el,Pe(he,Jt,Nt)):Jt=Tn,Wt&&Xm(Wt),(Gn=Jt.props&&Jt.props.onVnodeBeforeUpdate)&&Ms(Gn,fn,Jt,Tn),mc(he,!0);const vi=__(he),rr=he.subTree;he.subTree=vi,Z(rr,vi,z(rr.el),Tt(rr),he,yt,Dt),Jt.el=vi.el,jn===null&&bM(he,vi.el),on&&ro(on,yt),(Gn=Jt.props&&Jt.props.onVnodeUpdated)&&ro(()=>Ms(Gn,fn,Jt,Tn),yt)}else{let Jt;const{el:Wt,props:on}=Me,{bm:fn,m:Tn,parent:jn}=he,Gn=hf(Me);if(mc(he,!1),fn&&Xm(fn),!Gn&&(Jt=on&&on.onVnodeBeforeMount)&&Ms(Jt,jn,Me),mc(he,!0),Wt&&_n){const vi=()=>{he.subTree=__(he),_n(Wt,he.subTree,he,yt,null)};Gn?Me.type.__asyncLoader().then(()=>!he.isUnmounted&&vi()):vi()}else{const vi=he.subTree=__(he);Z(null,vi,qe,st,he,yt,Dt),Me.el=vi.el}if(Tn&&ro(Tn,yt),!Gn&&(Jt=on&&on.onVnodeMounted)){const vi=Me;ro(()=>Ms(Jt,jn,vi),yt)}(Me.shapeFlag&256||jn&&hf(jn.vnode)&&jn.vnode.shapeFlag&256)&&he.a&&ro(he.a,yt),he.isMounted=!0,Me=qe=st=null}},Ft=he.effect=new Hy(Pt,()=>n0(Et),he.scope),Et=he.update=()=>Ft.run();Et.id=he.uid,mc(he,!0),Et()},Pe=(he,Me,qe)=>{Me.component=he;const st=he.vnode.props;he.vnode=Me,he.next=null,NM(he,Me.props,st,qe),jM(he,Me.children,qe),Rc(),B1(),Bc()},at=(he,Me,qe,st,yt,Dt,Nt,Pt,Ft=!1)=>{const Et=he&&he.children,Jt=he?he.shapeFlag:0,Wt=Me.children,{patchFlag:on,shapeFlag:fn}=Me;if(on>0){if(on&128){pt(Et,Wt,qe,st,yt,Dt,Nt,Pt,Ft);return}else if(on&256){Gt(Et,Wt,qe,st,yt,Dt,Nt,Pt,Ft);return}}fn&8?(Jt&16&&bt(Et,yt,Dt),Wt!==Et&&A(qe,Wt)):Jt&16?fn&16?pt(Et,Wt,qe,st,yt,Dt,Nt,Pt,Ft):bt(Et,yt,Dt,!0):(Jt&8&&A(qe,""),fn&16&&ve(Wt,qe,st,yt,Dt,Nt,Pt,Ft))},Gt=(he,Me,qe,st,yt,Dt,Nt,Pt,Ft)=>{he=he||ih,Me=Me||ih;const Et=he.length,Jt=Me.length,Wt=Math.min(Et,Jt);let on;for(on=0;on<Wt;on++){const fn=Me[on]=Ft?dl(Me[on]):zs(Me[on]);Z(he[on],fn,qe,null,yt,Dt,Nt,Pt,Ft)}Et>Jt?bt(he,yt,Dt,!0,!1,Wt):ve(Me,qe,st,yt,Dt,Nt,Pt,Ft,Wt)},pt=(he,Me,qe,st,yt,Dt,Nt,Pt,Ft)=>{let Et=0;const Jt=Me.length;let Wt=he.length-1,on=Jt-1;for(;Et<=Wt&&Et<=on;){const fn=he[Et],Tn=Me[Et]=Ft?dl(Me[Et]):zs(Me[Et]);if(bc(fn,Tn))Z(fn,Tn,qe,null,yt,Dt,Nt,Pt,Ft);else break;Et++}for(;Et<=Wt&&Et<=on;){const fn=he[Wt],Tn=Me[on]=Ft?dl(Me[on]):zs(Me[on]);if(bc(fn,Tn))Z(fn,Tn,qe,null,yt,Dt,Nt,Pt,Ft);else break;Wt--,on--}if(Et>Wt){if(Et<=on){const fn=on+1,Tn=fn<Jt?Me[fn].el:st;for(;Et<=on;)Z(null,Me[Et]=Ft?dl(Me[Et]):zs(Me[Et]),qe,Tn,yt,Dt,Nt,Pt,Ft),Et++}}else if(Et>on)for(;Et<=Wt;)qt(he[Et],yt,Dt,!0),Et++;else{const fn=Et,Tn=Et,jn=new Map;for(Et=Tn;Et<=on;Et++){const tr=Me[Et]=Ft?dl(Me[Et]):zs(Me[Et]);tr.key!=null&&jn.set(tr.key,Et)}let Gn,vi=0;const rr=on-Tn+1;let Hi=!1,us=0;const zr=new Array(rr);for(Et=0;Et<rr;Et++)zr[Et]=0;for(Et=fn;Et<=Wt;Et++){const tr=he[Et];if(vi>=rr){qt(tr,yt,Dt,!0);continue}let cr;if(tr.key!=null)cr=jn.get(tr.key);else for(Gn=Tn;Gn<=on;Gn++)if(zr[Gn-Tn]===0&&bc(tr,Me[Gn])){cr=Gn;break}cr===void 0?qt(tr,yt,Dt,!0):(zr[cr-Tn]=Et+1,cr>=us?us=cr:Hi=!0,Z(tr,Me[cr],qe,null,yt,Dt,Nt,Pt,Ft),vi++)}const yo=Hi?HM(zr):ih;for(Gn=yo.length-1,Et=rr-1;Et>=0;Et--){const tr=Tn+Et,cr=Me[tr],$o=tr+1<Jt?Me[tr+1].el:st;zr[Et]===0?Z(null,cr,qe,$o,yt,Dt,Nt,Pt,Ft):Hi&&(Gn<0||Et!==yo[Gn]?Lt(cr,qe,$o,2):Gn--)}}},Lt=(he,Me,qe,st,yt=null)=>{const{el:Dt,type:Nt,transition:Pt,children:Ft,shapeFlag:Et}=he;if(Et&6){Lt(he.component.subTree,Me,qe,st);return}if(Et&128){he.suspense.move(Me,qe,st);return}if(Et&64){Nt.move(he,Me,qe,pn);return}if(Nt===On){c(Dt,Me,qe);for(let Wt=0;Wt<Ft.length;Wt++)Lt(Ft[Wt],Me,qe,st);c(he.anchor,Me,qe);return}if(Nt===b_){K(he,Me,qe);return}if(st!==2&&Et&1&&Pt)if(st===0)Pt.beforeEnter(Dt),c(Dt,Me,qe),ro(()=>Pt.enter(Dt),yt);else{const{leave:Wt,delayLeave:on,afterLeave:fn}=Pt,Tn=()=>c(Dt,Me,qe),jn=()=>{Wt(Dt,()=>{Tn(),fn&&fn()})};on?on(Dt,Tn,jn):jn()}else c(Dt,Me,qe)},qt=(he,Me,qe,st=!1,yt=!1)=>{const{type:Dt,props:Nt,ref:Pt,children:Ft,dynamicChildren:Et,shapeFlag:Jt,patchFlag:Wt,dirs:on}=he;if(Pt!=null&&ey(Pt,null,qe,he,!0),Jt&256){Me.ctx.deactivate(he);return}const fn=Jt&1&&on,Tn=!hf(he);let jn;if(Tn&&(jn=Nt&&Nt.onVnodeBeforeUnmount)&&Ms(jn,Me,he),Jt&6)Je(he.component,qe,st);else{if(Jt&128){he.suspense.unmount(qe,st);return}fn&&pc(he,null,Me,"beforeUnmount"),Jt&64?he.type.remove(he,Me,qe,yt,pn,st):Et&&(Dt!==On||Wt>0&&Wt&64)?bt(Et,Me,qe,!1,!0):(Dt===On&&Wt&384||!yt&&Jt&16)&&bt(Ft,Me,qe),st&&Ln(he)}(Tn&&(jn=Nt&&Nt.onVnodeUnmounted)||fn)&&ro(()=>{jn&&Ms(jn,Me,he),fn&&pc(he,null,Me,"unmounted")},qe)},Ln=he=>{const{type:Me,el:qe,anchor:st,transition:yt}=he;if(Me===On){kt(qe,st);return}if(Me===b_){Ee(he);return}const Dt=()=>{d(qe),yt&&!yt.persisted&&yt.afterLeave&&yt.afterLeave()};if(he.shapeFlag&1&&yt&&!yt.persisted){const{leave:Nt,delayLeave:Pt}=yt,Ft=()=>Nt(qe,Dt);Pt?Pt(he.el,Dt,Ft):Ft()}else Dt()},kt=(he,Me)=>{let qe;for(;he!==Me;)qe=L(he),d(he),he=qe;d(Me)},Je=(he,Me,qe)=>{const{bum:st,scope:yt,update:Dt,subTree:Nt,um:Pt}=he;st&&Xm(st),yt.stop(),Dt&&(Dt.active=!1,qt(Nt,he,Me,qe)),Pt&&ro(Pt,Me),ro(()=>{he.isUnmounted=!0},Me),Me&&Me.pendingBranch&&!Me.isUnmounted&&he.asyncDep&&!he.asyncResolved&&he.suspenseId===Me.pendingId&&(Me.deps--,Me.deps===0&&Me.resolve())},bt=(he,Me,qe,st=!1,yt=!1,Dt=0)=>{for(let Nt=Dt;Nt<he.length;Nt++)qt(he[Nt],Me,qe,st,yt)},Tt=he=>he.shapeFlag&6?Tt(he.component.subTree):he.shapeFlag&128?he.suspense.next():L(he.anchor||he.el),Ut=(he,Me,qe)=>{he==null?Me._vnode&&qt(Me._vnode,null,null,!0):Z(Me._vnode||null,he,Me,null,null,null,qe),B1(),uS(),Me._vnode=he},pn={p:Z,um:qt,m:Lt,r:Ln,mt:ct,mc:ve,pc:at,pbc:be,n:Tt,o:e};let Dn,_n;return o&&([Dn,_n]=o(pn)),{render:Ut,hydrate:Dn,createApp:qM(Ut,Dn)}}function mc({effect:e,update:o},a){e.allowRecurse=o.allowRecurse=a}function c0(e,o,a=!1){const c=e.children,d=o.children;if(Mn(c)&&Mn(d))for(let g=0;g<c.length;g++){const _=c[g];let s=d[g];s.shapeFlag&1&&!s.dynamicChildren&&((s.patchFlag<=0||s.patchFlag===32)&&(s=d[g]=dl(d[g]),s.el=_.el),a||c0(_,s))}}function HM(e){const o=e.slice(),a=[0];let c,d,g,_,s;const w=e.length;for(c=0;c<w;c++){const S=e[c];if(S!==0){if(d=a[a.length-1],e[d]<S){o[c]=d,a.push(c);continue}for(g=0,_=a.length-1;g<_;)s=g+_>>1,e[a[s]]<S?g=s+1:_=s;S<e[a[g]]&&(g>0&&(o[c]=a[g-1]),a[g]=c)}}for(g=a.length,_=a[g-1];g-- >0;)a[g]=_,_=o[_];return a}const XM=e=>e.__isTeleport,df=e=>e&&(e.disabled||e.disabled===""),W1=e=>typeof SVGElement<"u"&&e instanceof SVGElement,ty=(e,o)=>{const a=e&&e.to;return mr(a)?o?o(a):null:a},YM={__isTeleport:!0,process(e,o,a,c,d,g,_,s,w,S){const{mc:A,pc:z,pbc:L,o:{insert:R,querySelector:$,createText:Z,createComment:de}}=S,ne=df(o.props);let{shapeFlag:ce,children:K,dynamicChildren:Ee}=o;if(e==null){const Y=o.el=Z(""),_e=o.anchor=Z("");R(Y,a,c),R(_e,a,c);const fe=o.target=ty(o.props,$),ve=o.targetAnchor=Z("");fe&&(R(ve,fe),_=_||W1(fe));const Se=(be,De)=>{ce&16&&A(K,be,De,d,g,_,s,w)};ne?Se(a,_e):fe&&Se(fe,ve)}else{o.el=e.el;const Y=o.anchor=e.anchor,_e=o.target=e.target,fe=o.targetAnchor=e.targetAnchor,ve=df(e.props),Se=ve?a:_e,be=ve?Y:fe;if(_=_||W1(_e),Ee?(L(e.dynamicChildren,Ee,Se,d,g,_,s),c0(e,o,!0)):w||z(e,o,Se,be,d,g,_,s,!1),ne)ve||Nm(o,a,Y,S,1);else if((o.props&&o.props.to)!==(e.props&&e.props.to)){const De=o.target=ty(o.props,$);De&&Nm(o,De,null,S,0)}else ve&&Nm(o,_e,fe,S,1)}},remove(e,o,a,c,{um:d,o:{remove:g}},_){const{shapeFlag:s,children:w,anchor:S,targetAnchor:A,target:z,props:L}=e;if(z&&g(A),(_||!df(L))&&(g(S),s&16))for(let R=0;R<w.length;R++){const $=w[R];d($,o,a,!0,!!$.dynamicChildren)}},move:Nm,hydrate:KM};function Nm(e,o,a,{o:{insert:c},m:d},g=2){g===0&&c(e.targetAnchor,o,a);const{el:_,anchor:s,shapeFlag:w,children:S,props:A}=e,z=g===2;if(z&&c(_,o,a),(!z||df(A))&&w&16)for(let L=0;L<S.length;L++)d(S[L],o,a,2);z&&c(s,o,a)}function KM(e,o,a,c,d,g,{o:{nextSibling:_,parentNode:s,querySelector:w}},S){const A=o.target=ty(o.props,w);if(A){const z=A._lpa||A.firstChild;if(o.shapeFlag&16)if(df(o.props))o.anchor=S(_(e),o,s(e),a,c,d,g),o.targetAnchor=z;else{o.anchor=_(e);let L=z;for(;L;)if(L=_(L),L&&L.nodeType===8&&L.data==="teleport anchor"){o.targetAnchor=L,A._lpa=o.targetAnchor&&_(o.targetAnchor);break}S(z,o,A,a,c,d,g)}}return o.anchor&&_(o.anchor)}const JM=YM,On=Symbol(void 0),u0=Symbol(void 0),zo=Symbol(void 0),b_=Symbol(void 0),ff=[];let ns=null;function bi(e=!1){ff.push(ns=e?null:[])}function QM(){ff.pop(),ns=ff[ff.length-1]||null}let Cf=1;function H1(e){Cf+=e}function zS(e){return e.dynamicChildren=Cf>0?ns||ih:null,QM(),Cf>0&&ns&&ns.push(e),e}function go(e,o,a,c,d,g){return zS(h0(e,o,a,c,d,g,!0))}function jr(e,o,a,c,d){return zS(F(e,o,a,c,d,!0))}function ag(e){return e?e.__v_isVNode===!0:!1}function bc(e,o){return e.type===o.type&&e.key===o.key}const Pg="__vInternal",LS=({key:e})=>e!=null?e:null,Ym=({ref:e,ref_key:o,ref_for:a})=>e!=null?mr(e)||Pi(e)||Bn(e)?{i:Ur,r:e,k:o,f:!!a}:e:null;function h0(e,o=null,a=null,c=0,d=null,g=e===On?0:1,_=!1,s=!1){const w={__v_isVNode:!0,__v_skip:!0,type:e,props:o,key:o&&LS(o),ref:o&&Ym(o),scopeId:fS,slotScopeIds:null,children:a,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:g,patchFlag:c,dynamicProps:d,dynamicChildren:null,appContext:null};return s?(d0(w,a),g&128&&e.normalize(w)):a&&(w.shapeFlag|=mr(a)?8:16),Cf>0&&!_&&ns&&(w.patchFlag>0||g&6)&&w.patchFlag!==32&&ns.push(w),w}const F=eP;function eP(e,o=null,a=null,c=0,d=null,g=!1){if((!e||e===ES)&&(e=zo),ag(e)){const s=ga(e,o,!0);return a&&d0(s,a),Cf>0&&!g&&ns&&(s.shapeFlag&6?ns[ns.indexOf(e)]=s:ns.push(s)),s.patchFlag|=-2,s}if(dP(e)&&(e=e.__vccOpts),o){o=tP(o);let{class:s,style:w}=o;s&&!mr(s)&&(o.class=Uy(s)),Ji(w)&&(eS(w)&&!Mn(w)&&(w=Cr({},w)),o.style=$y(w))}const _=mr(e)?1:wM(e)?128:XM(e)?64:Ji(e)?4:Bn(e)?2:0;return h0(e,o,a,c,d,_,g,!0)}function tP(e){return e?eS(e)||Pg in e?Cr({},e):e:null}function ga(e,o,a=!1){const{props:c,ref:d,patchFlag:g,children:_}=e,s=o?nn(c||{},o):c;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:s,key:s&&LS(s),ref:o&&o.ref?a&&d?Mn(d)?d.concat(Ym(o)):[d,Ym(o)]:Ym(o):d,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:_,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:o&&e.type!==On?g===-1?16:g|16:g,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ga(e.ssContent),ssFallback:e.ssFallback&&ga(e.ssFallback),el:e.el,anchor:e.anchor}}function Ds(e=" ",o=0){return F(u0,null,e,o)}function nP(e="",o=!1){return o?(bi(),jr(zo,null,e)):F(zo,null,e)}function zs(e){return e==null||typeof e=="boolean"?F(zo):Mn(e)?F(On,null,e.slice()):typeof e=="object"?dl(e):F(u0,null,String(e))}function dl(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:ga(e)}function d0(e,o){let a=0;const{shapeFlag:c}=e;if(o==null)o=null;else if(Mn(o))a=16;else if(typeof o=="object")if(c&65){const d=o.default;d&&(d._c&&(d._d=!1),d0(e,d()),d._c&&(d._d=!0));return}else{a=32;const d=o._;!d&&!(Pg in o)?o._ctx=Ur:d===3&&Ur&&(Ur.slots._===1?o._=1:(o._=2,e.patchFlag|=1024))}else Bn(o)?(o={default:o,_ctx:Ur},a=32):(o=String(o),c&64?(a=16,o=[Ds(o)]):a=8);e.children=o,e.shapeFlag|=a}function nn(...e){const o={};for(let a=0;a<e.length;a++){const c=e[a];for(const d in c)if(d==="class")o.class!==c.class&&(o.class=Uy([o.class,c.class]));else if(d==="style")o.style=$y([o.style,c.style]);else if(wg(d)){const g=o[d],_=c[d];_&&g!==_&&!(Mn(g)&&g.includes(_))&&(o[d]=g?[].concat(g,_):_)}else d!==""&&(o[d]=c[d])}return o}function Ms(e,o,a,c=null){Po(e,o,7,[a,c])}const iP=PS();let rP=0;function oP(e,o,a){const c=e.type,d=(o?o.appContext:e.appContext)||iP,g={uid:rP++,vnode:e,type:c,parent:o,appContext:d,root:null,next:null,subTree:null,effect:null,update:null,scope:new UE(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:o?o.provides:Object.create(d.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:IS(c,d),emitsOptions:dS(c,d),emit:null,emitted:null,propsDefaults:Si,inheritAttrs:c.inheritAttrs,ctx:Si,data:Si,props:Si,attrs:Si,slots:Si,refs:Si,setupState:Si,setupContext:null,suspense:a,suspenseId:a?a.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return g.ctx={_:g},g.root=o?o.root:g,g.emit=vM.bind(null,g),e.ce&&e.ce(g),g}let Tr=null;const zg=()=>Tr||Ur,lh=e=>{Tr=e,e.scope.on()},kc=()=>{Tr&&Tr.scope.off(),Tr=null};function DS(e){return e.vnode.shapeFlag&4}let If=!1;function sP(e,o=!1){If=o;const{props:a,children:c}=e.vnode,d=DS(e);VM(e,a,d,o),UM(e,c);const g=d?aP(e,o):void 0;return If=!1,g}function aP(e,o){const a=e.type;e.accessCache=Object.create(null),e.proxy=tS(new Proxy(e.ctx,LM));const{setup:c}=a;if(c){const d=e.setupContext=c.length>1?cP(e):null;lh(e),Rc();const g=fa(c,e,0,[e.props,d]);if(Bc(),kc(),$E(g)){if(g.then(kc,kc),o)return g.then(_=>{X1(e,_,o)}).catch(_=>{Cg(_,e,0)});e.asyncDep=g}else X1(e,g,o)}else RS(e,o)}function X1(e,o,a){Bn(o)?e.type.__ssrInlineRender?e.ssrRender=o:e.render=o:Ji(o)&&(e.setupState=oS(o)),RS(e,a)}let Y1;function RS(e,o,a){const c=e.type;if(!e.render){if(!o&&Y1&&!c.render){const d=c.template||a0(e).template;if(d){const{isCustomElement:g,compilerOptions:_}=e.appContext.config,{delimiters:s,compilerOptions:w}=c,S=Cr(Cr({isCustomElement:g,delimiters:s},_),w);c.render=Y1(d,S)}}e.render=c.render||rs}lh(e),Rc(),DM(e),Bc(),kc()}function lP(e){return new Proxy(e.attrs,{get(o,a){return po(e,"get","$attrs"),o[a]}})}function cP(e){const o=c=>{e.exposed=c||{}};let a;return{get attrs(){return a||(a=lP(e))},slots:e.slots,emit:e.emit,expose:o}}function Lg(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(oS(tS(e.exposed)),{get(o,a){if(a in o)return o[a];if(a in og)return og[a](e)}}))}const uP=/(?:^|[-_])(\w)/g,hP=e=>e.replace(uP,o=>o.toUpperCase()).replace(/[-_]/g,"");function BS(e,o=!0){return Bn(e)?e.displayName||e.name:e.name||o&&e.__name}function OS(e,o,a=!1){let c=BS(o);if(!c&&o.__file){const d=o.__file.match(/([^/\\]+)\.\w+$/);d&&(c=d[1])}if(!c&&e&&e.parent){const d=g=>{for(const _ in g)if(g[_]===o)return _};c=d(e.components||e.parent.type.components)||d(e.appContext.components)}return c?hP(c):a?"App":"Anonymous"}function dP(e){return Bn(e)&&"__vccOpts"in e}const ie=(e,o)=>sM(e,o,If);function Ns(e,o,a){const c=arguments.length;return c===2?Ji(o)&&!Mn(o)?ag(o)?F(e,null,[o]):F(e,o):F(e,null,o):(c>3?a=Array.prototype.slice.call(arguments,2):c===3&&ag(a)&&(a=[a]),F(e,o,a))}const fP="3.2.41",pP="http://www.w3.org/2000/svg",wc=typeof document<"u"?document:null,K1=wc&&wc.createElement("template"),mP={insert:(e,o,a)=>{o.insertBefore(e,a||null)},remove:e=>{const o=e.parentNode;o&&o.removeChild(e)},createElement:(e,o,a,c)=>{const d=o?wc.createElementNS(pP,e):wc.createElement(e,a?{is:a}:void 0);return e==="select"&&c&&c.multiple!=null&&d.setAttribute("multiple",c.multiple),d},createText:e=>wc.createTextNode(e),createComment:e=>wc.createComment(e),setText:(e,o)=>{e.nodeValue=o},setElementText:(e,o)=>{e.textContent=o},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>wc.querySelector(e),setScopeId(e,o){e.setAttribute(o,"")},insertStaticContent(e,o,a,c,d,g){const _=a?a.previousSibling:o.lastChild;if(d&&(d===g||d.nextSibling))for(;o.insertBefore(d.cloneNode(!0),a),!(d===g||!(d=d.nextSibling)););else{K1.innerHTML=c?`<svg>${e}</svg>`:e;const s=K1.content;if(c){const w=s.firstChild;for(;w.firstChild;)s.appendChild(w.firstChild);s.removeChild(w)}o.insertBefore(s,a)}return[_?_.nextSibling:o.firstChild,a?a.previousSibling:o.lastChild]}};function gP(e,o,a){const c=e._vtc;c&&(o=(o?[o,...c]:[...c]).join(" ")),o==null?e.removeAttribute("class"):a?e.setAttribute("class",o):e.className=o}function vP(e,o,a){const c=e.style,d=mr(a);if(a&&!d){for(const g in a)ny(c,g,a[g]);if(o&&!mr(o))for(const g in o)a[g]==null&&ny(c,g,"")}else{const g=c.display;d?o!==a&&(c.cssText=a):o&&e.removeAttribute("style"),"_vod"in e&&(c.display=g)}}const J1=/\s*!important$/;function ny(e,o,a){if(Mn(a))a.forEach(c=>ny(e,o,c));else if(a==null&&(a=""),o.startsWith("--"))e.setProperty(o,a);else{const c=_P(e,o);J1.test(a)?e.setProperty(dh(c),a.replace(J1,""),"important"):e[c]=a}}const Q1=["Webkit","Moz","ms"],w_={};function _P(e,o){const a=w_[o];if(a)return a;let c=Ro(o);if(c!=="filter"&&c in e)return w_[o]=c;c=xl(c);for(let d=0;d<Q1.length;d++){const g=Q1[d]+c;if(g in e)return w_[o]=g}return o}const ew="http://www.w3.org/1999/xlink";function yP(e,o,a,c,d){if(c&&o.startsWith("xlink:"))a==null?e.removeAttributeNS(ew,o.slice(6,o.length)):e.setAttributeNS(ew,o,a);else{const g=gk(o);a==null||g&&!NE(a)?e.removeAttribute(o):e.setAttribute(o,g?"":a)}}function xP(e,o,a,c,d,g,_){if(o==="innerHTML"||o==="textContent"){c&&_(c,d,g),e[o]=a==null?"":a;return}if(o==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=a;const w=a==null?"":a;(e.value!==w||e.tagName==="OPTION")&&(e.value=w),a==null&&e.removeAttribute(o);return}let s=!1;if(a===""||a==null){const w=typeof e[o];w==="boolean"?a=NE(a):a==null&&w==="string"?(a="",s=!0):w==="number"&&(a=0,s=!0)}try{e[o]=a}catch{}s&&e.removeAttribute(o)}function eh(e,o,a,c){e.addEventListener(o,a,c)}function bP(e,o,a,c){e.removeEventListener(o,a,c)}function wP(e,o,a,c,d=null){const g=e._vei||(e._vei={}),_=g[o];if(c&&_)_.value=c;else{const[s,w]=EP(o);if(c){const S=g[o]=CP(c,d);eh(e,s,S,w)}else _&&(bP(e,s,_,w),g[o]=void 0)}}const tw=/(?:Once|Passive|Capture)$/;function EP(e){let o;if(tw.test(e)){o={};let c;for(;c=e.match(tw);)e=e.slice(0,e.length-c[0].length),o[c[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):dh(e.slice(2)),o]}let E_=0;const SP=Promise.resolve(),TP=()=>E_||(SP.then(()=>E_=0),E_=Date.now());function CP(e,o){const a=c=>{if(!c._vts)c._vts=Date.now();else if(c._vts<=a.attached)return;Po(IP(c,a.value),o,5,[c])};return a.value=e,a.attached=TP(),a}function IP(e,o){if(Mn(o)){const a=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{a.call(e),e._stopped=!0},o.map(c=>d=>!d._stopped&&c&&c(d))}else return o}const nw=/^on[a-z]/,AP=(e,o,a,c,d=!1,g,_,s,w)=>{o==="class"?gP(e,c,d):o==="style"?vP(e,a,c):wg(o)?jy(o)||wP(e,o,a,c,_):(o[0]==="."?(o=o.slice(1),!0):o[0]==="^"?(o=o.slice(1),!1):kP(e,o,c,d))?xP(e,o,c,g,_,s,w):(o==="true-value"?e._trueValue=c:o==="false-value"&&(e._falseValue=c),yP(e,o,c,d))};function kP(e,o,a,c){return c?!!(o==="innerHTML"||o==="textContent"||o in e&&nw.test(o)&&Bn(a)):o==="spellcheck"||o==="draggable"||o==="translate"||o==="form"||o==="list"&&e.tagName==="INPUT"||o==="type"&&e.tagName==="TEXTAREA"||nw.test(o)&&mr(a)?!1:o in e}const ll="transition",Yd="animation",Fs=(e,{slots:o})=>Ns(gS,VS(e),o);Fs.displayName="Transition";const FS={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},MP=Fs.props=Cr({},gS.props,FS),gc=(e,o=[])=>{Mn(e)?e.forEach(a=>a(...o)):e&&e(...o)},iw=e=>e?Mn(e)?e.some(o=>o.length>1):e.length>1:!1;function VS(e){const o={};for(const ze in e)ze in FS||(o[ze]=e[ze]);if(e.css===!1)return o;const{name:a="v",type:c,duration:d,enterFromClass:g=`${a}-enter-from`,enterActiveClass:_=`${a}-enter-active`,enterToClass:s=`${a}-enter-to`,appearFromClass:w=g,appearActiveClass:S=_,appearToClass:A=s,leaveFromClass:z=`${a}-leave-from`,leaveActiveClass:L=`${a}-leave-active`,leaveToClass:R=`${a}-leave-to`}=e,$=PP(d),Z=$&&$[0],de=$&&$[1],{onBeforeEnter:ne,onEnter:ce,onEnterCancelled:K,onLeave:Ee,onLeaveCancelled:Y,onBeforeAppear:_e=ne,onAppear:fe=ce,onAppearCancelled:ve=K}=o,Se=(ze,Ke,ct)=>{hl(ze,Ke?A:s),hl(ze,Ke?S:_),ct&&ct()},be=(ze,Ke)=>{ze._isLeaving=!1,hl(ze,z),hl(ze,R),hl(ze,L),Ke&&Ke()},De=ze=>(Ke,ct)=>{const nt=ze?fe:ce,ft=()=>Se(Ke,ze,ct);gc(nt,[Ke,ft]),rw(()=>{hl(Ke,ze?w:g),ha(Ke,ze?A:s),iw(nt)||ow(Ke,c,Z,ft)})};return Cr(o,{onBeforeEnter(ze){gc(ne,[ze]),ha(ze,g),ha(ze,_)},onBeforeAppear(ze){gc(_e,[ze]),ha(ze,w),ha(ze,S)},onEnter:De(!1),onAppear:De(!0),onLeave(ze,Ke){ze._isLeaving=!0;const ct=()=>be(ze,Ke);ha(ze,z),$S(),ha(ze,L),rw(()=>{!ze._isLeaving||(hl(ze,z),ha(ze,R),iw(Ee)||ow(ze,c,de,ct))}),gc(Ee,[ze,ct])},onEnterCancelled(ze){Se(ze,!1),gc(K,[ze])},onAppearCancelled(ze){Se(ze,!0),gc(ve,[ze])},onLeaveCancelled(ze){be(ze),gc(Y,[ze])}})}function PP(e){if(e==null)return null;if(Ji(e))return[S_(e.enter),S_(e.leave)];{const o=S_(e);return[o,o]}}function S_(e){return ng(e)}function ha(e,o){o.split(/\s+/).forEach(a=>a&&e.classList.add(a)),(e._vtc||(e._vtc=new Set)).add(o)}function hl(e,o){o.split(/\s+/).forEach(c=>c&&e.classList.remove(c));const{_vtc:a}=e;a&&(a.delete(o),a.size||(e._vtc=void 0))}function rw(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let zP=0;function ow(e,o,a,c){const d=e._endId=++zP,g=()=>{d===e._endId&&c()};if(a)return setTimeout(g,a);const{type:_,timeout:s,propCount:w}=NS(e,o);if(!_)return c();const S=_+"end";let A=0;const z=()=>{e.removeEventListener(S,L),g()},L=R=>{R.target===e&&++A>=w&&z()};setTimeout(()=>{A<w&&z()},s+1),e.addEventListener(S,L)}function NS(e,o){const a=window.getComputedStyle(e),c=$=>(a[$]||"").split(", "),d=c(ll+"Delay"),g=c(ll+"Duration"),_=sw(d,g),s=c(Yd+"Delay"),w=c(Yd+"Duration"),S=sw(s,w);let A=null,z=0,L=0;o===ll?_>0&&(A=ll,z=_,L=g.length):o===Yd?S>0&&(A=Yd,z=S,L=w.length):(z=Math.max(_,S),A=z>0?_>S?ll:Yd:null,L=A?A===ll?g.length:w.length:0);const R=A===ll&&/\b(transform|all)(,|$)/.test(a[ll+"Property"]);return{type:A,timeout:z,propCount:L,hasTransform:R}}function sw(e,o){for(;e.length<o.length;)e=e.concat(e);return Math.max(...o.map((a,c)=>aw(a)+aw(e[c])))}function aw(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function $S(){return document.body.offsetHeight}const US=new WeakMap,jS=new WeakMap,LP={name:"TransitionGroup",props:Cr({},MP,{tag:String,moveClass:String}),setup(e,{slots:o}){const a=zg(),c=mS();let d,g;return wS(()=>{if(!d.length)return;const _=e.moveClass||`${e.name||"v"}-move`;if(!FP(d[0].el,a.vnode.el,_))return;d.forEach(RP),d.forEach(BP);const s=d.filter(OP);$S(),s.forEach(w=>{const S=w.el,A=S.style;ha(S,_),A.transform=A.webkitTransform=A.transitionDuration="";const z=S._moveCb=L=>{L&&L.target!==S||(!L||/transform$/.test(L.propertyName))&&(S.removeEventListener("transitionend",z),S._moveCb=null,hl(S,_))};S.addEventListener("transitionend",z)})}),()=>{const _=Yn(e),s=VS(_);let w=_.tag||On;d=g,g=o.default?r0(o.default()):[];for(let S=0;S<g.length;S++){const A=g[S];A.key!=null&&Tf(A,Sf(A,s,c,a))}if(d)for(let S=0;S<d.length;S++){const A=d[S];Tf(A,Sf(A,s,c,a)),US.set(A,A.el.getBoundingClientRect())}return F(w,null,g)}}},DP=LP;function RP(e){const o=e.el;o._moveCb&&o._moveCb(),o._enterCb&&o._enterCb()}function BP(e){jS.set(e,e.el.getBoundingClientRect())}function OP(e){const o=US.get(e),a=jS.get(e),c=o.left-a.left,d=o.top-a.top;if(c||d){const g=e.el.style;return g.transform=g.webkitTransform=`translate(${c}px,${d}px)`,g.transitionDuration="0s",e}}function FP(e,o,a){const c=e.cloneNode();e._vtc&&e._vtc.forEach(_=>{_.split(/\s+/).forEach(s=>s&&c.classList.remove(s))}),a.split(/\s+/).forEach(_=>_&&c.classList.add(_)),c.style.display="none";const d=o.nodeType===1?o:o.parentNode;d.appendChild(c);const{hasTransform:g}=NS(c);return d.removeChild(c),g}const lw=e=>{const o=e.props["onUpdate:modelValue"]||!1;return Mn(o)?a=>Xm(o,a):o};function VP(e){e.target.composing=!0}function cw(e){const o=e.target;o.composing&&(o.composing=!1,o.dispatchEvent(new Event("input")))}const NP={created(e,{modifiers:{lazy:o,trim:a,number:c}},d){e._assign=lw(d);const g=c||d.props&&d.props.type==="number";eh(e,o?"change":"input",_=>{if(_.target.composing)return;let s=e.value;a&&(s=s.trim()),g&&(s=ng(s)),e._assign(s)}),a&&eh(e,"change",()=>{e.value=e.value.trim()}),o||(eh(e,"compositionstart",VP),eh(e,"compositionend",cw),eh(e,"change",cw))},mounted(e,{value:o}){e.value=o==null?"":o},beforeUpdate(e,{value:o,modifiers:{lazy:a,trim:c,number:d}},g){if(e._assign=lw(g),e.composing||document.activeElement===e&&e.type!=="range"&&(a||c&&e.value.trim()===o||(d||e.type==="number")&&ng(e.value)===o))return;const _=o==null?"":o;e.value!==_&&(e.value=_)}},$s={beforeMount(e,{value:o},{transition:a}){e._vod=e.style.display==="none"?"":e.style.display,a&&o?a.beforeEnter(e):Kd(e,o)},mounted(e,{value:o},{transition:a}){a&&o&&a.enter(e)},updated(e,{value:o,oldValue:a},{transition:c}){!o!=!a&&(c?o?(c.beforeEnter(e),Kd(e,!0),c.enter(e)):c.leave(e,()=>{Kd(e,!1)}):Kd(e,o))},beforeUnmount(e,{value:o}){Kd(e,o)}};function Kd(e,o){e.style.display=o?e._vod:"none"}const $P=Cr({patchProp:AP},mP);let uw;function UP(){return uw||(uw=ZM($P))}const jP=(...e)=>{const o=UP().createApp(...e),{mount:a}=o;return o.mount=c=>{const d=GP(c);if(!d)return;const g=o._component;!Bn(g)&&!g.render&&!g.template&&(g.template=d.innerHTML),d.innerHTML="";const _=a(d,!1,d instanceof SVGElement);return d instanceof Element&&(d.removeAttribute("v-cloak"),d.setAttribute("data-v-app","")),_},o};function GP(e){return mr(e)?document.querySelector(e):e}/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const th=typeof window<"u";function qP(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const xi=Object.assign;function T_(e,o){const a={};for(const c in o){const d=o[c];a[c]=os(d)?d.map(e):e(d)}return a}const pf=()=>{},os=Array.isArray,ZP=/\/$/,WP=e=>e.replace(ZP,"");function C_(e,o,a="/"){let c,d={},g="",_="";const s=o.indexOf("#");let w=o.indexOf("?");return s<w&&s>=0&&(w=-1),w>-1&&(c=o.slice(0,w),g=o.slice(w+1,s>-1?s:o.length),d=e(g)),s>-1&&(c=c||o.slice(0,s),_=o.slice(s,o.length)),c=KP(c!=null?c:o,a),{fullPath:c+(g&&"?")+g+_,path:c,query:d,hash:_}}function HP(e,o){const a=o.query?e(o.query):"";return o.path+(a&&"?")+a+(o.hash||"")}function hw(e,o){return!o||!e.toLowerCase().startsWith(o.toLowerCase())?e:e.slice(o.length)||"/"}function XP(e,o,a){const c=o.matched.length-1,d=a.matched.length-1;return c>-1&&c===d&&ch(o.matched[c],a.matched[d])&&GS(o.params,a.params)&&e(o.query)===e(a.query)&&o.hash===a.hash}function ch(e,o){return(e.aliasOf||e)===(o.aliasOf||o)}function GS(e,o){if(Object.keys(e).length!==Object.keys(o).length)return!1;for(const a in e)if(!YP(e[a],o[a]))return!1;return!0}function YP(e,o){return os(e)?dw(e,o):os(o)?dw(o,e):e===o}function dw(e,o){return os(o)?e.length===o.length&&e.every((a,c)=>a===o[c]):e.length===1&&e[0]===o}function KP(e,o){if(e.startsWith("/"))return e;if(!e)return o;const a=o.split("/"),c=e.split("/");let d=a.length-1,g,_;for(g=0;g<c.length;g++)if(_=c[g],_!==".")if(_==="..")d>1&&d--;else break;return a.slice(0,d).join("/")+"/"+c.slice(g-(g===c.length?1:0)).join("/")}var Af;(function(e){e.pop="pop",e.push="push"})(Af||(Af={}));var mf;(function(e){e.back="back",e.forward="forward",e.unknown=""})(mf||(mf={}));function JP(e){if(!e)if(th){const o=document.querySelector("base");e=o&&o.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),WP(e)}const QP=/^[^#]+#/;function ez(e,o){return e.replace(QP,"#")+o}function tz(e,o){const a=document.documentElement.getBoundingClientRect(),c=e.getBoundingClientRect();return{behavior:o.behavior,left:c.left-a.left-(o.left||0),top:c.top-a.top-(o.top||0)}}const Dg=()=>({left:window.pageXOffset,top:window.pageYOffset});function nz(e){let o;if("el"in e){const a=e.el,c=typeof a=="string"&&a.startsWith("#"),d=typeof a=="string"?c?document.getElementById(a.slice(1)):document.querySelector(a):a;if(!d)return;o=tz(d,e)}else o=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(o):window.scrollTo(o.left!=null?o.left:window.pageXOffset,o.top!=null?o.top:window.pageYOffset)}function fw(e,o){return(history.state?history.state.position-o:-1)+e}const iy=new Map;function iz(e,o){iy.set(e,o)}function rz(e){const o=iy.get(e);return iy.delete(e),o}let oz=()=>location.protocol+"//"+location.host;function qS(e,o){const{pathname:a,search:c,hash:d}=o,g=e.indexOf("#");if(g>-1){let s=d.includes(e.slice(g))?e.slice(g).length:1,w=d.slice(s);return w[0]!=="/"&&(w="/"+w),hw(w,"")}return hw(a,e)+c+d}function sz(e,o,a,c){let d=[],g=[],_=null;const s=({state:L})=>{const R=qS(e,location),$=a.value,Z=o.value;let de=0;if(L){if(a.value=R,o.value=L,_&&_===$){_=null;return}de=Z?L.position-Z.position:0}else c(R);d.forEach(ne=>{ne(a.value,$,{delta:de,type:Af.pop,direction:de?de>0?mf.forward:mf.back:mf.unknown})})};function w(){_=a.value}function S(L){d.push(L);const R=()=>{const $=d.indexOf(L);$>-1&&d.splice($,1)};return g.push(R),R}function A(){const{history:L}=window;!L.state||L.replaceState(xi({},L.state,{scroll:Dg()}),"")}function z(){for(const L of g)L();g=[],window.removeEventListener("popstate",s),window.removeEventListener("beforeunload",A)}return window.addEventListener("popstate",s),window.addEventListener("beforeunload",A),{pauseListeners:w,listen:S,destroy:z}}function pw(e,o,a,c=!1,d=!1){return{back:e,current:o,forward:a,replaced:c,position:window.history.length,scroll:d?Dg():null}}function az(e){const{history:o,location:a}=window,c={value:qS(e,a)},d={value:o.state};d.value||g(c.value,{back:null,current:c.value,forward:null,position:o.length-1,replaced:!0,scroll:null},!0);function g(w,S,A){const z=e.indexOf("#"),L=z>-1?(a.host&&document.querySelector("base")?e:e.slice(z))+w:oz()+e+w;try{o[A?"replaceState":"pushState"](S,"",L),d.value=S}catch(R){console.error(R),a[A?"replace":"assign"](L)}}function _(w,S){const A=xi({},o.state,pw(d.value.back,w,d.value.forward,!0),S,{position:d.value.position});g(w,A,!0),c.value=w}function s(w,S){const A=xi({},d.value,o.state,{forward:w,scroll:Dg()});g(A.current,A,!0);const z=xi({},pw(c.value,w,null),{position:A.position+1},S);g(w,z,!1),c.value=w}return{location:c,state:d,push:s,replace:_}}function lz(e){e=JP(e);const o=az(e),a=sz(e,o.state,o.location,o.replace);function c(g,_=!0){_||a.pauseListeners(),history.go(g)}const d=xi({location:"",base:e,go:c,createHref:ez.bind(null,e)},o,a);return Object.defineProperty(d,"location",{enumerable:!0,get:()=>o.location.value}),Object.defineProperty(d,"state",{enumerable:!0,get:()=>o.state.value}),d}function cz(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),lz(e)}function uz(e){return typeof e=="string"||e&&typeof e=="object"}function ZS(e){return typeof e=="string"||typeof e=="symbol"}const cl={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},WS=Symbol("");var mw;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(mw||(mw={}));function uh(e,o){return xi(new Error,{type:e,[WS]:!0},o)}function ua(e,o){return e instanceof Error&&WS in e&&(o==null||!!(e.type&o))}const gw="[^/]+?",hz={sensitive:!1,strict:!1,start:!0,end:!0},dz=/[.+*?^${}()[\]/\\]/g;function fz(e,o){const a=xi({},hz,o),c=[];let d=a.start?"^":"";const g=[];for(const S of e){const A=S.length?[]:[90];a.strict&&!S.length&&(d+="/");for(let z=0;z<S.length;z++){const L=S[z];let R=40+(a.sensitive?.25:0);if(L.type===0)z||(d+="/"),d+=L.value.replace(dz,"\\$&"),R+=40;else if(L.type===1){const{value:$,repeatable:Z,optional:de,regexp:ne}=L;g.push({name:$,repeatable:Z,optional:de});const ce=ne||gw;if(ce!==gw){R+=10;try{new RegExp(`(${ce})`)}catch(Ee){throw new Error(`Invalid custom RegExp for param "${$}" (${ce}): `+Ee.message)}}let K=Z?`((?:${ce})(?:/(?:${ce}))*)`:`(${ce})`;z||(K=de&&S.length<2?`(?:/${K})`:"/"+K),de&&(K+="?"),d+=K,R+=20,de&&(R+=-8),Z&&(R+=-20),ce===".*"&&(R+=-50)}A.push(R)}c.push(A)}if(a.strict&&a.end){const S=c.length-1;c[S][c[S].length-1]+=.7000000000000001}a.strict||(d+="/?"),a.end?d+="$":a.strict&&(d+="(?:/|$)");const _=new RegExp(d,a.sensitive?"":"i");function s(S){const A=S.match(_),z={};if(!A)return null;for(let L=1;L<A.length;L++){const R=A[L]||"",$=g[L-1];z[$.name]=R&&$.repeatable?R.split("/"):R}return z}function w(S){let A="",z=!1;for(const L of e){(!z||!A.endsWith("/"))&&(A+="/"),z=!1;for(const R of L)if(R.type===0)A+=R.value;else if(R.type===1){const{value:$,repeatable:Z,optional:de}=R,ne=$ in S?S[$]:"";if(os(ne)&&!Z)throw new Error(`Provided param "${$}" is an array but it is not repeatable (* or + modifiers)`);const ce=os(ne)?ne.join("/"):ne;if(!ce)if(de)L.length<2&&(A.endsWith("/")?A=A.slice(0,-1):z=!0);else throw new Error(`Missing required param "${$}"`);A+=ce}}return A||"/"}return{re:_,score:c,keys:g,parse:s,stringify:w}}function pz(e,o){let a=0;for(;a<e.length&&a<o.length;){const c=o[a]-e[a];if(c)return c;a++}return e.length<o.length?e.length===1&&e[0]===40+40?-1:1:e.length>o.length?o.length===1&&o[0]===40+40?1:-1:0}function mz(e,o){let a=0;const c=e.score,d=o.score;for(;a<c.length&&a<d.length;){const g=pz(c[a],d[a]);if(g)return g;a++}if(Math.abs(d.length-c.length)===1){if(vw(c))return 1;if(vw(d))return-1}return d.length-c.length}function vw(e){const o=e[e.length-1];return e.length>0&&o[o.length-1]<0}const gz={type:0,value:""},vz=/[a-zA-Z0-9_]/;function _z(e){if(!e)return[[]];if(e==="/")return[[gz]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function o(R){throw new Error(`ERR (${a})/"${S}": ${R}`)}let a=0,c=a;const d=[];let g;function _(){g&&d.push(g),g=[]}let s=0,w,S="",A="";function z(){!S||(a===0?g.push({type:0,value:S}):a===1||a===2||a===3?(g.length>1&&(w==="*"||w==="+")&&o(`A repeatable param (${S}) must be alone in its segment. eg: '/:ids+.`),g.push({type:1,value:S,regexp:A,repeatable:w==="*"||w==="+",optional:w==="*"||w==="?"})):o("Invalid state to consume buffer"),S="")}function L(){S+=w}for(;s<e.length;){if(w=e[s++],w==="\\"&&a!==2){c=a,a=4;continue}switch(a){case 0:w==="/"?(S&&z(),_()):w===":"?(z(),a=1):L();break;case 4:L(),a=c;break;case 1:w==="("?a=2:vz.test(w)?L():(z(),a=0,w!=="*"&&w!=="?"&&w!=="+"&&s--);break;case 2:w===")"?A[A.length-1]=="\\"?A=A.slice(0,-1)+w:a=3:A+=w;break;case 3:z(),a=0,w!=="*"&&w!=="?"&&w!=="+"&&s--,A="";break;default:o("Unknown state");break}}return a===2&&o(`Unfinished custom RegExp for param "${S}"`),z(),_(),d}function yz(e,o,a){const c=fz(_z(e.path),a),d=xi(c,{record:e,parent:o,children:[],alias:[]});return o&&!d.record.aliasOf==!o.record.aliasOf&&o.children.push(d),d}function xz(e,o){const a=[],c=new Map;o=xw({strict:!1,end:!0,sensitive:!1},o);function d(A){return c.get(A)}function g(A,z,L){const R=!L,$=bz(A);$.aliasOf=L&&L.record;const Z=xw(o,A),de=[$];if("alias"in A){const K=typeof A.alias=="string"?[A.alias]:A.alias;for(const Ee of K)de.push(xi({},$,{components:L?L.record.components:$.components,path:Ee,aliasOf:L?L.record:$}))}let ne,ce;for(const K of de){const{path:Ee}=K;if(z&&Ee[0]!=="/"){const Y=z.record.path,_e=Y[Y.length-1]==="/"?"":"/";K.path=z.record.path+(Ee&&_e+Ee)}if(ne=yz(K,z,Z),L?L.alias.push(ne):(ce=ce||ne,ce!==ne&&ce.alias.push(ne),R&&A.name&&!yw(ne)&&_(A.name)),$.children){const Y=$.children;for(let _e=0;_e<Y.length;_e++)g(Y[_e],ne,L&&L.children[_e])}L=L||ne,(ne.record.components&&Object.keys(ne.record.components).length||ne.record.name||ne.record.redirect)&&w(ne)}return ce?()=>{_(ce)}:pf}function _(A){if(ZS(A)){const z=c.get(A);z&&(c.delete(A),a.splice(a.indexOf(z),1),z.children.forEach(_),z.alias.forEach(_))}else{const z=a.indexOf(A);z>-1&&(a.splice(z,1),A.record.name&&c.delete(A.record.name),A.children.forEach(_),A.alias.forEach(_))}}function s(){return a}function w(A){let z=0;for(;z<a.length&&mz(A,a[z])>=0&&(A.record.path!==a[z].record.path||!HS(A,a[z]));)z++;a.splice(z,0,A),A.record.name&&!yw(A)&&c.set(A.record.name,A)}function S(A,z){let L,R={},$,Z;if("name"in A&&A.name){if(L=c.get(A.name),!L)throw uh(1,{location:A});Z=L.record.name,R=xi(_w(z.params,L.keys.filter(ce=>!ce.optional).map(ce=>ce.name)),A.params&&_w(A.params,L.keys.map(ce=>ce.name))),$=L.stringify(R)}else if("path"in A)$=A.path,L=a.find(ce=>ce.re.test($)),L&&(R=L.parse($),Z=L.record.name);else{if(L=z.name?c.get(z.name):a.find(ce=>ce.re.test(z.path)),!L)throw uh(1,{location:A,currentLocation:z});Z=L.record.name,R=xi({},z.params,A.params),$=L.stringify(R)}const de=[];let ne=L;for(;ne;)de.unshift(ne.record),ne=ne.parent;return{name:Z,path:$,params:R,matched:de,meta:Ez(de)}}return e.forEach(A=>g(A)),{addRoute:g,resolve:S,removeRoute:_,getRoutes:s,getRecordMatcher:d}}function _w(e,o){const a={};for(const c of o)c in e&&(a[c]=e[c]);return a}function bz(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:wz(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function wz(e){const o={},a=e.props||!1;if("component"in e)o.default=a;else for(const c in e.components)o[c]=typeof a=="boolean"?a:a[c];return o}function yw(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Ez(e){return e.reduce((o,a)=>xi(o,a.meta),{})}function xw(e,o){const a={};for(const c in e)a[c]=c in o?o[c]:e[c];return a}function HS(e,o){return o.children.some(a=>a===e||HS(e,a))}const XS=/#/g,Sz=/&/g,Tz=/\//g,Cz=/=/g,Iz=/\?/g,YS=/\+/g,Az=/%5B/g,kz=/%5D/g,KS=/%5E/g,Mz=/%60/g,JS=/%7B/g,Pz=/%7C/g,QS=/%7D/g,zz=/%20/g;function f0(e){return encodeURI(""+e).replace(Pz,"|").replace(Az,"[").replace(kz,"]")}function Lz(e){return f0(e).replace(JS,"{").replace(QS,"}").replace(KS,"^")}function ry(e){return f0(e).replace(YS,"%2B").replace(zz,"+").replace(XS,"%23").replace(Sz,"%26").replace(Mz,"`").replace(JS,"{").replace(QS,"}").replace(KS,"^")}function Dz(e){return ry(e).replace(Cz,"%3D")}function Rz(e){return f0(e).replace(XS,"%23").replace(Iz,"%3F")}function Bz(e){return e==null?"":Rz(e).replace(Tz,"%2F")}function lg(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function Oz(e){const o={};if(e===""||e==="?")return o;const c=(e[0]==="?"?e.slice(1):e).split("&");for(let d=0;d<c.length;++d){const g=c[d].replace(YS," "),_=g.indexOf("="),s=lg(_<0?g:g.slice(0,_)),w=_<0?null:lg(g.slice(_+1));if(s in o){let S=o[s];os(S)||(S=o[s]=[S]),S.push(w)}else o[s]=w}return o}function bw(e){let o="";for(let a in e){const c=e[a];if(a=Dz(a),c==null){c!==void 0&&(o+=(o.length?"&":"")+a);continue}(os(c)?c.map(g=>g&&ry(g)):[c&&ry(c)]).forEach(g=>{g!==void 0&&(o+=(o.length?"&":"")+a,g!=null&&(o+="="+g))})}return o}function Fz(e){const o={};for(const a in e){const c=e[a];c!==void 0&&(o[a]=os(c)?c.map(d=>d==null?null:""+d):c==null?c:""+c)}return o}const Vz=Symbol(""),ww=Symbol(""),Rg=Symbol(""),eT=Symbol(""),oy=Symbol("");function Jd(){let e=[];function o(c){return e.push(c),()=>{const d=e.indexOf(c);d>-1&&e.splice(d,1)}}function a(){e=[]}return{add:o,list:()=>e,reset:a}}function fl(e,o,a,c,d){const g=c&&(c.enterCallbacks[d]=c.enterCallbacks[d]||[]);return()=>new Promise((_,s)=>{const w=z=>{z===!1?s(uh(4,{from:a,to:o})):z instanceof Error?s(z):uz(z)?s(uh(2,{from:o,to:z})):(g&&c.enterCallbacks[d]===g&&typeof z=="function"&&g.push(z),_())},S=e.call(c&&c.instances[d],o,a,w);let A=Promise.resolve(S);e.length<3&&(A=A.then(w)),A.catch(z=>s(z))})}function I_(e,o,a,c){const d=[];for(const g of e)for(const _ in g.components){let s=g.components[_];if(!(o!=="beforeRouteEnter"&&!g.instances[_]))if(Nz(s)){const S=(s.__vccOpts||s)[o];S&&d.push(fl(S,a,c,g,_))}else{let w=s();d.push(()=>w.then(S=>{if(!S)return Promise.reject(new Error(`Couldn't resolve component "${_}" at "${g.path}"`));const A=qP(S)?S.default:S;g.components[_]=A;const L=(A.__vccOpts||A)[o];return L&&fl(L,a,c,g,_)()}))}}return d}function Nz(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Ew(e){const o=cn(Rg),a=cn(eT),c=ie(()=>o.resolve(Xn(e.to))),d=ie(()=>{const{matched:w}=c.value,{length:S}=w,A=w[S-1],z=a.matched;if(!A||!z.length)return-1;const L=z.findIndex(ch.bind(null,A));if(L>-1)return L;const R=Sw(w[S-2]);return S>1&&Sw(A)===R&&z[z.length-1].path!==R?z.findIndex(ch.bind(null,w[S-2])):L}),g=ie(()=>d.value>-1&&Gz(a.params,c.value.params)),_=ie(()=>d.value>-1&&d.value===a.matched.length-1&&GS(a.params,c.value.params));function s(w={}){return jz(w)?o[Xn(e.replace)?"replace":"push"](Xn(e.to)).catch(pf):Promise.resolve()}return{route:c,href:ie(()=>c.value.href),isActive:g,isExactActive:_,navigate:s}}const $z=gn({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Ew,setup(e,{slots:o}){const a=Ki(Ew(e)),{options:c}=cn(Rg),d=ie(()=>({[Tw(e.activeClass,c.linkActiveClass,"router-link-active")]:a.isActive,[Tw(e.exactActiveClass,c.linkExactActiveClass,"router-link-exact-active")]:a.isExactActive}));return()=>{const g=o.default&&o.default(a);return e.custom?g:Ns("a",{"aria-current":a.isExactActive?e.ariaCurrentValue:null,href:a.href,onClick:a.navigate,class:d.value},g)}}}),Uz=$z;function jz(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const o=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(o))return}return e.preventDefault&&e.preventDefault(),!0}}function Gz(e,o){for(const a in o){const c=o[a],d=e[a];if(typeof c=="string"){if(c!==d)return!1}else if(!os(d)||d.length!==c.length||c.some((g,_)=>g!==d[_]))return!1}return!0}function Sw(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Tw=(e,o,a)=>e!=null?e:o!=null?o:a,qz=gn({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:o,slots:a}){const c=cn(oy),d=ie(()=>e.route||c.value),g=cn(ww,0),_=ie(()=>{let S=Xn(g);const{matched:A}=d.value;let z;for(;(z=A[S])&&!z.components;)S++;return S}),s=ie(()=>d.value.matched[_.value]);Gi(ww,ie(()=>_.value+1)),Gi(Vz,s),Gi(oy,d);const w=Qe();return Ye(()=>[w.value,s.value,e.name],([S,A,z],[L,R,$])=>{A&&(A.instances[z]=S,R&&R!==A&&S&&S===L&&(A.leaveGuards.size||(A.leaveGuards=R.leaveGuards),A.updateGuards.size||(A.updateGuards=R.updateGuards))),S&&A&&(!R||!ch(A,R)||!L)&&(A.enterCallbacks[z]||[]).forEach(Z=>Z(S))},{flush:"post"}),()=>{const S=d.value,A=e.name,z=s.value,L=z&&z.components[A];if(!L)return Cw(a.default,{Component:L,route:S});const R=z.props[A],$=R?R===!0?S.params:typeof R=="function"?R(S):R:null,de=Ns(L,xi({},$,o,{onVnodeUnmounted:ne=>{ne.component.isUnmounted&&(z.instances[A]=null)},ref:w}));return Cw(a.default,{Component:de,route:S})||de}}});function Cw(e,o){if(!e)return null;const a=e(o);return a.length===1?a[0]:a}const Zz=qz;function Wz(e){const o=xz(e.routes,e),a=e.parseQuery||Oz,c=e.stringifyQuery||bw,d=e.history,g=Jd(),_=Jd(),s=Jd(),w=Ci(cl);let S=cl;th&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const A=T_.bind(null,Je=>""+Je),z=T_.bind(null,Bz),L=T_.bind(null,lg);function R(Je,bt){let Tt,Ut;return ZS(Je)?(Tt=o.getRecordMatcher(Je),Ut=bt):Ut=Je,o.addRoute(Ut,Tt)}function $(Je){const bt=o.getRecordMatcher(Je);bt&&o.removeRoute(bt)}function Z(){return o.getRoutes().map(Je=>Je.record)}function de(Je){return!!o.getRecordMatcher(Je)}function ne(Je,bt){if(bt=xi({},bt||w.value),typeof Je=="string"){const he=C_(a,Je,bt.path),Me=o.resolve({path:he.path},bt),qe=d.createHref(he.fullPath);return xi(he,Me,{params:L(Me.params),hash:lg(he.hash),redirectedFrom:void 0,href:qe})}let Tt;if("path"in Je)Tt=xi({},Je,{path:C_(a,Je.path,bt.path).path});else{const he=xi({},Je.params);for(const Me in he)he[Me]==null&&delete he[Me];Tt=xi({},Je,{params:z(Je.params)}),bt.params=z(bt.params)}const Ut=o.resolve(Tt,bt),pn=Je.hash||"";Ut.params=A(L(Ut.params));const Dn=HP(c,xi({},Je,{hash:Lz(pn),path:Ut.path})),_n=d.createHref(Dn);return xi({fullPath:Dn,hash:pn,query:c===bw?Fz(Je.query):Je.query||{}},Ut,{redirectedFrom:void 0,href:_n})}function ce(Je){return typeof Je=="string"?C_(a,Je,w.value.path):xi({},Je)}function K(Je,bt){if(S!==Je)return uh(8,{from:bt,to:Je})}function Ee(Je){return fe(Je)}function Y(Je){return Ee(xi(ce(Je),{replace:!0}))}function _e(Je){const bt=Je.matched[Je.matched.length-1];if(bt&&bt.redirect){const{redirect:Tt}=bt;let Ut=typeof Tt=="function"?Tt(Je):Tt;return typeof Ut=="string"&&(Ut=Ut.includes("?")||Ut.includes("#")?Ut=ce(Ut):{path:Ut},Ut.params={}),xi({query:Je.query,hash:Je.hash,params:"path"in Ut?{}:Je.params},Ut)}}function fe(Je,bt){const Tt=S=ne(Je),Ut=w.value,pn=Je.state,Dn=Je.force,_n=Je.replace===!0,he=_e(Tt);if(he)return fe(xi(ce(he),{state:typeof he=="object"?xi({},pn,he.state):pn,force:Dn,replace:_n}),bt||Tt);const Me=Tt;Me.redirectedFrom=bt;let qe;return!Dn&&XP(c,Ut,Tt)&&(qe=uh(16,{to:Me,from:Ut}),pt(Ut,Ut,!0,!1)),(qe?Promise.resolve(qe):Se(Me,Ut)).catch(st=>ua(st)?ua(st,2)?st:Gt(st):Pe(st,Me,Ut)).then(st=>{if(st){if(ua(st,2))return fe(xi({replace:_n},ce(st.to),{state:typeof st.to=="object"?xi({},pn,st.to.state):pn,force:Dn}),bt||Me)}else st=De(Me,Ut,!0,_n,pn);return be(Me,Ut,st),st})}function ve(Je,bt){const Tt=K(Je,bt);return Tt?Promise.reject(Tt):Promise.resolve()}function Se(Je,bt){let Tt;const[Ut,pn,Dn]=Hz(Je,bt);Tt=I_(Ut.reverse(),"beforeRouteLeave",Je,bt);for(const he of Ut)he.leaveGuards.forEach(Me=>{Tt.push(fl(Me,Je,bt))});const _n=ve.bind(null,Je,bt);return Tt.push(_n),Xu(Tt).then(()=>{Tt=[];for(const he of g.list())Tt.push(fl(he,Je,bt));return Tt.push(_n),Xu(Tt)}).then(()=>{Tt=I_(pn,"beforeRouteUpdate",Je,bt);for(const he of pn)he.updateGuards.forEach(Me=>{Tt.push(fl(Me,Je,bt))});return Tt.push(_n),Xu(Tt)}).then(()=>{Tt=[];for(const he of Je.matched)if(he.beforeEnter&&!bt.matched.includes(he))if(os(he.beforeEnter))for(const Me of he.beforeEnter)Tt.push(fl(Me,Je,bt));else Tt.push(fl(he.beforeEnter,Je,bt));return Tt.push(_n),Xu(Tt)}).then(()=>(Je.matched.forEach(he=>he.enterCallbacks={}),Tt=I_(Dn,"beforeRouteEnter",Je,bt),Tt.push(_n),Xu(Tt))).then(()=>{Tt=[];for(const he of _.list())Tt.push(fl(he,Je,bt));return Tt.push(_n),Xu(Tt)}).catch(he=>ua(he,8)?he:Promise.reject(he))}function be(Je,bt,Tt){for(const Ut of s.list())Ut(Je,bt,Tt)}function De(Je,bt,Tt,Ut,pn){const Dn=K(Je,bt);if(Dn)return Dn;const _n=bt===cl,he=th?history.state:{};Tt&&(Ut||_n?d.replace(Je.fullPath,xi({scroll:_n&&he&&he.scroll},pn)):d.push(Je.fullPath,pn)),w.value=Je,pt(Je,bt,Tt,_n),Gt()}let ze;function Ke(){ze||(ze=d.listen((Je,bt,Tt)=>{if(!kt.listening)return;const Ut=ne(Je),pn=_e(Ut);if(pn){fe(xi(pn,{replace:!0}),Ut).catch(pf);return}S=Ut;const Dn=w.value;th&&iz(fw(Dn.fullPath,Tt.delta),Dg()),Se(Ut,Dn).catch(_n=>ua(_n,12)?_n:ua(_n,2)?(fe(_n.to,Ut).then(he=>{ua(he,20)&&!Tt.delta&&Tt.type===Af.pop&&d.go(-1,!1)}).catch(pf),Promise.reject()):(Tt.delta&&d.go(-Tt.delta,!1),Pe(_n,Ut,Dn))).then(_n=>{_n=_n||De(Ut,Dn,!1),_n&&(Tt.delta&&!ua(_n,8)?d.go(-Tt.delta,!1):Tt.type===Af.pop&&ua(_n,20)&&d.go(-1,!1)),be(Ut,Dn,_n)}).catch(pf)}))}let ct=Jd(),nt=Jd(),ft;function Pe(Je,bt,Tt){Gt(Je);const Ut=nt.list();return Ut.length?Ut.forEach(pn=>pn(Je,bt,Tt)):console.error(Je),Promise.reject(Je)}function at(){return ft&&w.value!==cl?Promise.resolve():new Promise((Je,bt)=>{ct.add([Je,bt])})}function Gt(Je){return ft||(ft=!Je,Ke(),ct.list().forEach(([bt,Tt])=>Je?Tt(Je):bt()),ct.reset()),Je}function pt(Je,bt,Tt,Ut){const{scrollBehavior:pn}=e;if(!th||!pn)return Promise.resolve();const Dn=!Tt&&rz(fw(Je.fullPath,0))||(Ut||!Tt)&&history.state&&history.state.scroll||null;return Zi().then(()=>pn(Je,bt,Dn)).then(_n=>_n&&nz(_n)).catch(_n=>Pe(_n,Je,bt))}const Lt=Je=>d.go(Je);let qt;const Ln=new Set,kt={currentRoute:w,listening:!0,addRoute:R,removeRoute:$,hasRoute:de,getRoutes:Z,resolve:ne,options:e,push:Ee,replace:Y,go:Lt,back:()=>Lt(-1),forward:()=>Lt(1),beforeEach:g.add,beforeResolve:_.add,afterEach:s.add,onError:nt.add,isReady:at,install(Je){const bt=this;Je.component("RouterLink",Uz),Je.component("RouterView",Zz),Je.config.globalProperties.$router=bt,Object.defineProperty(Je.config.globalProperties,"$route",{enumerable:!0,get:()=>Xn(w)}),th&&!qt&&w.value===cl&&(qt=!0,Ee(d.location).catch(pn=>{}));const Tt={};for(const pn in cl)Tt[pn]=ie(()=>w.value[pn]);Je.provide(Rg,bt),Je.provide(eT,Ki(Tt)),Je.provide(oy,w);const Ut=Je.unmount;Ln.add(Je),Je.unmount=function(){Ln.delete(Je),Ln.size<1&&(S=cl,ze&&ze(),ze=null,w.value=cl,qt=!1,ft=!1),Ut()}}};return kt}function Xu(e){return e.reduce((o,a)=>o.then(()=>a()),Promise.resolve())}function Hz(e,o){const a=[],c=[],d=[],g=Math.max(o.matched.length,e.matched.length);for(let _=0;_<g;_++){const s=o.matched[_];s&&(e.matched.find(S=>ch(S,s))?c.push(s):a.push(s));const w=e.matched[_];w&&(o.matched.find(S=>ch(S,w))||d.push(w))}return[a,c,d]}function fh(){return cn(Rg)}function ph(e){const{icons:o,activeIcons:a,temp:c}=Ki(e);function d(g){Object.keys(o).forEach(_=>{_===g?o[_]=a[_]:o[_]=c[_]})}return{icons:o,toggleIcon:d}}function Iw(e,o,a){Xz(e,o),o.set(e,a)}function Xz(e,o){if(o.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yz(e,o,a){var c=tT(e,o,"set");return Kz(e,c,a),a}function Kz(e,o,a){if(o.set)o.set.call(e,a);else{if(!o.writable)throw new TypeError("attempted to set read only private field");o.value=a}}function vc(e,o){var a=tT(e,o,"get");return Jz(e,a)}function tT(e,o,a){if(!o.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return o.get(e)}function Jz(e,o){return o.get?o.get.call(e):o.value}function nT(e,o,a){const c=o.length-1;if(c<0)return e===void 0?a:e;for(let d=0;d<c;d++){if(e==null)return a;e=e[o[d]]}return e==null||e[o[c]]===void 0?a:e[o[c]]}function jf(e,o){if(e===o)return!0;if(e instanceof Date&&o instanceof Date&&e.getTime()!==o.getTime()||e!==Object(e)||o!==Object(o))return!1;const a=Object.keys(e);return a.length!==Object.keys(o).length?!1:a.every(c=>jf(e[c],o[c]))}function sy(e,o,a){return e==null||!o||typeof o!="string"?a:e[o]!==void 0?e[o]:(o=o.replace(/\[(\w+)\]/g,".$1"),o=o.replace(/^\./,""),nT(e,o.split("."),a))}function Rs(e,o,a){if(o==null)return e===void 0?a:e;if(e!==Object(e))return a;if(typeof o=="string")return sy(e,o,a);if(Array.isArray(o))return nT(e,o,a);if(typeof o!="function")return a;const c=o(e,a);return typeof c>"u"?a:c}function Sc(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:e},(a,c)=>o+c)}function Yt(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(!(e==null||e===""))return isNaN(+e)?String(e):isFinite(+e)?`${Number(e)}${o}`:void 0}function ay(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function Qz(e){return e==null?void 0:e.$el}const Aw=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16}),ly=Object.freeze({enter:"Enter",tab:"Tab",delete:"Delete",esc:"Escape",space:"Space",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",end:"End",home:"Home",del:"Delete",backspace:"Backspace",insert:"Insert",pageup:"PageUp",pagedown:"PageDown",shift:"Shift"});function iT(e){return Object.keys(e)}function Bo(e,o){const a=Object.create(null),c=Object.create(null);for(const d in e)o.some(g=>g instanceof RegExp?g.test(d):g===d)?a[d]=e[d]:c[d]=e[d];return[a,c]}function Bg(e,o){const a={...e};return o.forEach(c=>delete a[c]),a}function Oc(e){return Bo(e,["class","style","id",/^data-/])}function Lo(e){return e==null?[]:Array.isArray(e)?e:[e]}function Mo(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(o,Math.min(a,e))}function A_(e,o){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return e+a.repeat(Math.max(0,o-e.length))}function eL(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const a=[];let c=0;for(;c<e.length;)a.push(e.substr(c,o)),c+=o;return a}function kw(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;if(e<o)return`${e} B`;const a=o===1024?["Ki","Mi","Gi"]:["k","M","G"];let c=-1;for(;Math.abs(e)>=o&&c<a.length-1;)e/=o,++c;return`${e.toFixed(1)} ${a[c]}B`}function va(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;const c={};for(const d in e)c[d]=e[d];for(const d in o){const g=e[d],_=o[d];if(ay(g)&&ay(_)){c[d]=va(g,_,a);continue}if(Array.isArray(g)&&Array.isArray(_)&&a){c[d]=a(g,_);continue}c[d]=_}return c}function rT(e){return e.map(o=>o.type===On?rT(o.children):o).flat()}function p0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"").replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase()}function gf(e,o){if(!o||typeof o!="object")return[];if(Array.isArray(o))return o.map(a=>gf(e,a)).flat(1);if(Array.isArray(o.children))return o.children.map(a=>gf(e,a)).flat(1);if(o.component){if(Object.getOwnPropertySymbols(o.component.provides).includes(e))return[o.component];if(o.component.subTree)return gf(e,o.component.subTree).flat(1)}return[]}var $m=new WeakMap,Yu=new WeakMap;class tL{constructor(o){Iw(this,$m,{writable:!0,value:[]}),Iw(this,Yu,{writable:!0,value:0}),this.size=o}push(o){vc(this,$m)[vc(this,Yu)]=o,Yz(this,Yu,(vc(this,Yu)+1)%this.size)}values(){return vc(this,$m).slice(vc(this,Yu)).concat(vc(this,$m).slice(0,vc(this,Yu)))}}function nL(e){return"touches"in e?{clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}:{clientX:e.clientX,clientY:e.clientY}}function m0(e){const o=Ki({}),a=ie(e);return Vs(()=>{for(const c in a.value)o[c]=a.value[c]},{flush:"sync"}),e0(o)}function cg(e,o){return e.includes(o)}const iL=/^on[^a-z]/,oT=e=>iL.test(e),vf=[Function,Array];function ug(e){for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];if(Array.isArray(e))for(const d of e)d(...a);else typeof e=="function"&&e(...a)}const sT=["top","bottom"],rL=["start","end","left","right"];function cy(e,o){let[a,c]=e.split(" ");return c||(c=cg(sT,a)?"start":cg(rL,a)?"top":"center"),{side:uy(a,o),align:uy(c,o)}}function uy(e,o){return e==="start"?o?"right":"left":e==="end"?o?"left":"right":e}function k_(e){return{side:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.side],align:e.align}}function M_(e){return{side:e.side,align:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.align]}}function Mw(e){return{side:e.align,align:e.side}}function Pw(e){return cg(sT,e.side)?"y":"x"}class sh{constructor(o){let{x:a,y:c,width:d,height:g}=o;this.x=a,this.y=c,this.width=d,this.height=g}get top(){return this.y}get bottom(){return this.y+this.height}get left(){return this.x}get right(){return this.x+this.width}}function zw(e,o){return{x:{before:Math.max(0,o.left-e.left),after:Math.max(0,e.right-o.right)},y:{before:Math.max(0,o.top-e.top),after:Math.max(0,e.bottom-o.bottom)}}}function g0(e){const o=e.getBoundingClientRect(),a=getComputedStyle(e),c=a.transform;if(c){let d,g,_,s,w;if(c.startsWith("matrix3d("))d=c.slice(9,-1).split(/, /),g=+d[0],_=+d[5],s=+d[12],w=+d[13];else if(c.startsWith("matrix("))d=c.slice(7,-1).split(/, /),g=+d[0],_=+d[3],s=+d[4],w=+d[5];else return new sh(o);const S=a.transformOrigin,A=o.x-s-(1-g)*parseFloat(S),z=o.y-w-(1-_)*parseFloat(S.slice(S.indexOf(" ")+1)),L=g?o.width/g:e.offsetWidth+1,R=_?o.height/_:e.offsetHeight+1;return new sh({x:A,y:z,width:L,height:R})}else return new sh(o)}function Tc(e,o,a){if(typeof e.animate>"u")return{finished:Promise.resolve()};const c=e.animate(o,a);return typeof c.finished>"u"&&(c.finished=new Promise(d=>{c.onfinish=()=>{d(c)}})),c}function aT(e,o,a){if(a&&(o={_isVue:!0,$parent:a,$options:o}),o){if(o.$_alreadyWarned=o.$_alreadyWarned||[],o.$_alreadyWarned.includes(e))return;o.$_alreadyWarned.push(e)}return`[Vuetify] ${e}`+(o?aL(o):"")}function Mc(e,o,a){const c=aT(e,o,a);c!=null&&console.warn(c)}function hy(e,o,a){const c=aT(e,o,a);c!=null&&console.error(c)}const oL=/(?:^|[-_])(\w)/g,sL=e=>e.replace(oL,o=>o.toUpperCase()).replace(/[-_]/g,"");function P_(e,o){if(e.$root===e)return"<Root>";const a=typeof e=="function"&&e.cid!=null?e.options:e._isVue?e.$options||e.constructor.options:e||{};let c=a.name||a._componentTag;const d=a.__file;if(!c&&d){const g=d.match(/([^/\\]+)\.vue$/);c=g==null?void 0:g[1]}return(c?`<${sL(c)}>`:"<Anonymous>")+(d&&o!==!1?` at ${d}`:"")}function aL(e){if(e._isVue&&e.$parent){const o=[];let a=0;for(;e;){if(o.length>0){const c=o[o.length-1];if(c.constructor===e.constructor){a++,e=e.$parent;continue}else a>0&&(o[o.length-1]=[c,a],a=0)}o.push(e),e=e.$parent}return`

found in

`+o.map((c,d)=>`${d===0?"---> ":" ".repeat(5+d*2)}${Array.isArray(c)?`${P_(c[0])}... (${c[1]} recursive calls)`:P_(c)}`).join(`
`)}else return`

(found in ${P_(e)})`}const lL=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],cL=e=>e<=.0031308?e*12.92:1.055*e**(1/2.4)-.055,uL=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],hL=e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4;function lT(e){const o=Array(3),a=cL,c=lL;for(let d=0;d<3;++d)o[d]=Math.round(Mo(a(c[d][0]*e[0]+c[d][1]*e[1]+c[d][2]*e[2]))*255);return(o[0]<<16)+(o[1]<<8)+(o[2]<<0)}function v0(e){const o=[0,0,0],a=hL,c=uL,d=a((e>>16&255)/255),g=a((e>>8&255)/255),_=a((e>>0&255)/255);for(let s=0;s<3;++s)o[s]=c[s][0]*d+c[s][1]*g+c[s][2]*_;return o}const hg=.20689655172413793,dL=e=>e>hg**3?Math.cbrt(e):e/(3*hg**2)+4/29,fL=e=>e>hg?e**3:3*hg**2*(e-4/29);function cT(e){const o=dL,a=o(e[1]);return[116*a-16,500*(o(e[0]/.95047)-a),200*(a-o(e[2]/1.08883))]}function uT(e){const o=fL,a=(e[0]+16)/116;return[o(a+e[1]/500)*.95047,o(a),o(a-e[2]/200)*1.08883]}function Lw(e){return!!e&&/^(#|var\(--|(rgb|hsl)a?\()/.test(e)}function dg(e){let o;if(typeof e=="number")o=e;else if(typeof e=="string"){let a=e.startsWith("#")?e.substring(1):e;a.length===3&&(a=a.split("").map(c=>c+c).join("")),a.length!==6&&a.length!==8&&Mc(`'${e}' is not a valid rgb color`),o=parseInt(a,16)}else throw new TypeError(`Colors can only be numbers or strings, recieved ${e==null?e:e.constructor.name} instead`);return o<0?(Mc(`Colors cannot be negative: '${e}'`),o=0):(o>4294967295||isNaN(o))&&(Mc(`'${e}' is not a valid rgb color`),o=16777215),o}function pL(e){let o=e.toString(16);return o.length<6&&(o="0".repeat(6-o.length)+o),"#"+o}function Og(e){const{h:o,s:a,v:c,a:d}=e,g=s=>{const w=(s+o/60)%6;return c-c*a*Math.max(Math.min(w,4-w,1),0)},_=[g(5),g(3),g(1)].map(s=>Math.round(s*255));return{r:_[0],g:_[1],b:_[2],a:d}}function _0(e){if(!e)return{h:0,s:1,v:1,a:1};const o=e.r/255,a=e.g/255,c=e.b/255,d=Math.max(o,a,c),g=Math.min(o,a,c);let _=0;d!==g&&(d===o?_=60*(0+(a-c)/(d-g)):d===a?_=60*(2+(c-o)/(d-g)):d===c&&(_=60*(4+(o-a)/(d-g)))),_<0&&(_=_+360);const s=d===0?0:(d-g)/d,w=[_,s,d];return{h:w[0],s:w[1],v:w[2],a:e.a}}function hT(e){const{h:o,s:a,v:c,a:d}=e,g=c-c*a/2,_=g===1||g===0?0:(c-g)/Math.min(g,1-g);return{h:o,s:_,l:g,a:d}}function dT(e){const{h:o,s:a,l:c,a:d}=e,g=c+a*Math.min(c,1-c),_=g===0?0:2-2*c/g;return{h:o,s:_,v:g,a:d}}function mL(e){return`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`}function fT(e){return mL(Og(e))}function gL(e){const o=a=>{const c=Math.round(a).toString(16);return("00".substr(0,2-c.length)+c).toUpperCase()};return`#${[o(e.r),o(e.g),o(e.b),o(Math.round(e.a*255))].join("")}`}function vL(e){const o=eL(e.slice(1),2).map(a=>parseInt(a,16));return{r:o[0],g:o[1],b:o[2],a:Math.round(o[3]/255*100)/100}}function pT(e){const o=vL(e);return _0(o)}function mT(e){return gL(Og(e))}function _L(e){return e.startsWith("#")&&(e=e.slice(1)),e=e.replace(/([^0-9a-f])/gi,"F"),(e.length===3||e.length===4)&&(e=e.split("").map(o=>o+o).join("")),e.length===6?e=A_(e,8,"F"):e=A_(A_(e,6),8,"F"),`#${e}`.toUpperCase().substr(0,9)}function gT(e){const o=dg(e);return{r:(o&16711680)>>16,g:(o&65280)>>8,b:o&255}}function yL(e,o){const a=cT(v0(e));return a[0]=a[0]+o*10,lT(uT(a))}function xL(e,o){const a=cT(v0(e));return a[0]=a[0]-o*10,lT(uT(a))}function dy(e){const o=dg(e);return v0(o)[1]}function bL(e,o){const a=dy(e),c=dy(o),d=Math.max(a,c),g=Math.min(a,c);return(d+.05)/(g+.05)}function Mr(e,o){const a=zg();if(!a)throw new Error(`[Vuetify] ${e} ${o||"must be called from inside a setup function"}`);return a}function ya(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const o=Mr(e).type;return p0((o==null?void 0:o.aliasName)||(o==null?void 0:o.name))}let vT=0,Km=new WeakMap;function Gr(){const e=Mr("getUid");if(Km.has(e))return Km.get(e);{const o=vT++;return Km.set(e,o),o}}Gr.reset=()=>{vT=0,Km=new WeakMap};function wL(e){const{provides:o}=Mr("injectSelf");if(o&&e in o)return o[e]}const kf=Symbol.for("vuetify:defaults");function EL(e){return Qe(e!=null?e:{})}function _T(){const e=cn(kf);if(!e)throw new Error("[Vuetify] Could not find defaults instance");return e}function sr(e,o){const a=_T(),c=Qe(e),d=ie(()=>{const g=Xn(o==null?void 0:o.scoped),_=Xn(o==null?void 0:o.reset),s=Xn(o==null?void 0:o.root);let w=va(c.value,{prev:a.value});if(g)return w;if(_||s){const S=Number(_||1/0);for(let A=0;A<=S&&w.prev;A++)w=w.prev;return w}return va(w.prev,w)});return Gi(kf,d),d}function Pn(e,o){return a=>Object.keys(e).reduce((c,d)=>{const _=typeof e[d]=="object"&&e[d]!=null&&!Array.isArray(e[d])?e[d]:{type:e[d]};return a&&d in a?c[d]={..._,default:a[d]}:c[d]=_,o&&!c[d].source&&(c[d].source=o),c},{})}function SL(e,o){var a,c;return((a=e.props)==null?void 0:a.hasOwnProperty(o))||((c=e.props)==null?void 0:c.hasOwnProperty(p0(o)))}const zt=function(o){var a,c;return o._setup=(a=o._setup)!=null?a:o.setup,o.name?(o._setup&&(o.props=(c=o.props)!=null?c:{},o.props=Pn(o.props,o.name)(),o.props._as=String,o.setup=function(g,_){const s=zg(),w=_T(),S=Ci(),A=QE({...Yn(g)});Vs(()=>{var Z,de,ne;const R=w.value.global,$=w.value[(Z=g._as)!=null?Z:o.name];if($){const ce=Object.entries($).filter(K=>{let[Ee]=K;return Ee.startsWith("V")});ce.length&&(S.value=Object.fromEntries(ce))}for(const ce of Object.keys(g)){let K=g[ce];SL(s.vnode,ce)||(K=(ne=(de=$==null?void 0:$[ce])!=null?de:R==null?void 0:R[ce])!=null?ne:g[ce]),A[ce]!==K&&(A[ce]=K)}});const z=o._setup(A,_);let L;return Ye(S,(R,$)=>{!R&&L?L.stop():R&&!$&&(L=Nf(),L.run(()=>{var de;var Z;sr(va((de=(Z=wL(kf))==null?void 0:Z.value)!=null?de:{},R))}))},{immediate:!0}),z}),o):(Mc("The component is missing an explicit name, unable to generate default prop value"),o)};function Li(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return o=>(e?zt:gn)(o)}function Oo(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",a=arguments.length>2?arguments[2]:void 0;return zt({name:a!=null?a:xl(Ro(e.replace(/__/g,"-"))),props:{tag:{type:String,default:o}},setup(c,d){let{slots:g}=d;return()=>{var _;return Ns(c.tag,{class:e},(_=g.default)==null?void 0:_.call(g))}}})}function yT(e){if(typeof e.getRootNode!="function"){for(;e.parentNode;)e=e.parentNode;return e!==document?null:document}const o=e.getRootNode();return o!==document&&o.getRootNode({composed:!0})!==document?null:o}const Mf="cubic-bezier(0.4, 0, 0.2, 1)",TL="cubic-bezier(0.0, 0, 0.2, 1)",CL="cubic-bezier(0.4, 0, 1, 1)";function xT(e){for(;e;){if(y0(e))return e;e=e.parentElement}return document.scrollingElement}function fg(e,o){const a=[];if(o&&e&&!o.contains(e))return a;for(;e&&(y0(e)&&a.push(e),e!==o);)e=e.parentElement;return a}function y0(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const o=window.getComputedStyle(e);return o.overflowY==="scroll"||o.overflowY==="auto"&&e.scrollHeight>e.clientHeight}const zi=typeof window<"u",x0=zi&&"IntersectionObserver"in window,IL=zi&&("ontouchstart"in window||window.navigator.maxTouchPoints>0),fy=zi&&typeof CSS<"u"&&CSS.supports("selector(:focus-visible)");function AL(e){for(;e;){if(window.getComputedStyle(e).position==="fixed")return!0;e=e.offsetParent}return!1}function Mt(e){const o=Mr("useRender");o.render=e}const vo=Pn({border:[Boolean,Number,String]},"border");function Fo(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ya();return{borderClasses:ie(()=>{const c=Pi(e)?e.value:e.border,d=[];if(c===!0||c==="")d.push(`${o}--border`);else if(typeof c=="string"||c===0)for(const g of String(c).split(" "))d.push(`border-${g}`);return d})}}const kL=[null,"default","comfortable","compact"],vr=Pn({density:{type:String,default:"default",validator:e=>kL.includes(e)}},"density");function qr(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ya();return{densityClasses:ie(()=>`${o}--density-${e.density}`)}}const lr=Pn({elevation:{type:[Number,String],validator(e){const o=parseInt(e);return!isNaN(o)&&o>=0&&o<=24}}},"elevation");function Pr(e){return{elevationClasses:ie(()=>{const a=Pi(e)?e.value:e.elevation,c=[];return a==null||c.push(`elevation-${a}`),c})}}function Pf(e,o){let a;Ye(e,c=>{if(c&&!a)a=Nf(),a.run(o);else{var d;(d=a)==null||d.stop(),a=void 0}},{immediate:!0})}function En(e,o,a){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:z=>z,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:z=>z;const g=Mr("useProxiedModel"),_=Qe(e[o]!==void 0?e[o]:a),s=p0(o),S=ie(s!==o?()=>{var z,L,R,$;return e[o],!!(((z=g.vnode.props)!=null&&z.hasOwnProperty(o)||(L=g.vnode.props)!=null&&L.hasOwnProperty(s))&&((R=g.vnode.props)!=null&&R.hasOwnProperty(`onUpdate:${o}`)||($=g.vnode.props)!=null&&$.hasOwnProperty(`onUpdate:${s}`)))}:()=>{var z,L;return e[o],!!((z=g.vnode.props)!=null&&z.hasOwnProperty(o)&&(L=g.vnode.props)!=null&&L.hasOwnProperty(`onUpdate:${o}`))});Pf(()=>!S.value,()=>{Ye(()=>e[o],z=>{_.value=z})});const A=ie({get(){return c(S.value?e[o]:_.value)},set(z){const L=d(z);(S.value?e[o]:_.value)===L||c(S.value?e[o]:_.value)===z||(_.value=L,g==null||g.emit(`update:${o}`,L))}});return Object.defineProperty(A,"externalValue",{get:()=>S.value?e[o]:_.value}),A}const mh=Pn({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),Fc=Pn({value:null,disabled:Boolean,selectedClass:String},"group-item");function gh(e,o){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const c=Mr("useGroupItem");if(!c)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const d=Gr();Gi(Symbol.for(`${o.description}:id`),d);const g=cn(o,null);if(!g){if(!a)return g;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${o.description}`)}const _=St(e,"value"),s=ie(()=>g.disabled.value||e.disabled);g.register({id:d,value:_,disabled:s},c),Ii(()=>{g.unregister(d)});const w=ie(()=>g.isSelected(d)),S=ie(()=>w.value&&[g.selectedClass.value,e.selectedClass]);return Ye(w,A=>{c.emit("group:selected",{value:A})}),{id:d,isSelected:w,toggle:()=>g.select(d,!w.value),select:A=>g.select(d,A),selectedClass:S,value:_,disabled:s,group:g}}function Vc(e,o){let a=!1;const c=Ki([]),d=En(e,"modelValue",[],L=>L==null?[]:bT(c,Lo(L)),L=>{const R=PL(c,L);return e.multiple?R:R[0]}),g=Mr("useGroup");function _(L,R){const $=L,Z=Symbol.for(`${o.description}:id`),ne=gf(Z,g==null?void 0:g.vnode).indexOf(R);ne>-1?c.splice(ne,0,$):c.push($)}function s(L){if(a)return;w();const R=c.findIndex($=>$.id===L);c.splice(R,1)}function w(){const L=c.find(R=>!R.disabled);L&&e.mandatory==="force"&&!d.value.length&&(d.value=[L.id])}Fn(()=>{w()}),Ii(()=>{a=!0});function S(L,R){const $=c.find(Z=>Z.id===L);if(!(R&&$!=null&&$.disabled))if(e.multiple){const Z=d.value.slice(),de=Z.findIndex(ce=>ce===L),ne=~de;if(R=R!=null?R:!ne,ne&&e.mandatory&&Z.length<=1||!ne&&e.max!=null&&Z.length+1>e.max)return;de<0&&R?Z.push(L):de>=0&&!R&&Z.splice(de,1),d.value=Z}else{const Z=d.value.includes(L);if(e.mandatory&&Z)return;d.value=(R!=null?R:!Z)?[L]:[]}}function A(L){if(e.multiple&&Mc('This method is not supported when using "multiple" prop'),d.value.length){const R=d.value[0],$=c.findIndex(ne=>ne.id===R);let Z=($+L)%c.length,de=c[Z];for(;de.disabled&&Z!==$;)Z=(Z+L)%c.length,de=c[Z];if(de.disabled)return;d.value=[c[Z].id]}else{const R=c.find($=>!$.disabled);R&&(d.value=[R.id])}}const z={register:_,unregister:s,selected:d,select:S,disabled:St(e,"disabled"),prev:()=>A(c.length-1),next:()=>A(1),isSelected:L=>d.value.includes(L),selectedClass:ie(()=>e.selectedClass),items:ie(()=>c),getItemIndex:L=>ML(c,L)};return Gi(o,z),z}function ML(e,o){const a=bT(e,[o]);return a.length?e.findIndex(c=>c.id===a[0]):-1}function bT(e,o){const a=[];for(let c=0;c<e.length;c++){const d=e[c];d.value!=null?o.find(g=>jf(g,d.value))!=null&&a.push(d.id):o.includes(c)&&a.push(d.id)}return a}function PL(e,o){const a=[];for(let c=0;c<e.length;c++){const d=e[c];o.includes(d.id)&&a.push(d.value!=null?d.value:c)}return a}function zc(e){const o=Qe(),a=Qe();if(zi){const c=new ResizeObserver(d=>{e==null||e(d,c),d.length&&(a.value=d[0].contentRect)});Ii(()=>{c.disconnect()}),Ye(o,(d,g)=>{g&&(c.unobserve(g),a.value=void 0),d&&c.observe(d)},{flush:"post"})}return{resizeRef:o,contentRect:$f(a)}}const pg=Symbol.for("vuetify:layout"),wT=Symbol.for("vuetify:layout-item"),Dw=1e3,ET=Pn({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),vh=Pn({name:{type:String},order:{type:[Number,String],default:0},absolute:Boolean},"layout-item");function zL(){const e=cn(pg);if(!e)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:e.getLayoutItem,mainRect:e.mainRect,mainStyles:e.mainStyles}}function _h(e){var s;const o=cn(pg);if(!o)throw new Error("[Vuetify] Could not find injected layout");const a=(s=e.id)!=null?s:`layout-item-${Gr()}`,c=Mr("useLayoutItem");Gi(wT,{id:a});const d=Qe(!1);yS(()=>d.value=!0),_S(()=>d.value=!1);const{layoutItemStyles:g,layoutItemScrimStyles:_}=o.register(c,{...e,active:ie(()=>d.value?!1:e.active.value),id:a});return Ii(()=>o.unregister(a)),{layoutItemStyles:g,layoutRect:o.layoutRect,layoutItemScrimStyles:_}}const LL=(e,o,a,c)=>{let d={top:0,left:0,right:0,bottom:0};const g=[{id:"",layer:{...d}}];for(const _ of e){const s=o.get(_),w=a.get(_),S=c.get(_);if(!s||!w||!S)continue;const A={...d,[s.value]:parseInt(d[s.value],10)+(S.value?parseInt(w.value,10):0)};g.push({id:_,layer:A}),d=A}return g};function ST(e){const o=cn(pg,null),a=ie(()=>o?o.rootZIndex.value-100:Dw),c=Qe([]),d=Ki(new Map),g=Ki(new Map),_=Ki(new Map),s=Ki(new Map),w=Ki(new Map),{resizeRef:S,contentRect:A}=zc(),z=ie(()=>{var ve;const _e=new Map,fe=(ve=e.overlaps)!=null?ve:[];for(const Se of fe.filter(be=>be.includes(":"))){const[be,De]=Se.split(":");if(!c.value.includes(be)||!c.value.includes(De))continue;const ze=d.get(be),Ke=d.get(De),ct=g.get(be),nt=g.get(De);!ze||!Ke||!ct||!nt||(_e.set(De,{position:ze.value,amount:parseInt(ct.value,10)}),_e.set(be,{position:Ke.value,amount:-parseInt(nt.value,10)}))}return _e}),L=ie(()=>{const _e=[...new Set([..._.values()].map(ve=>ve.value))].sort((ve,Se)=>ve-Se),fe=[];for(const ve of _e){const Se=c.value.filter(be=>{var De;return((De=_.get(be))==null?void 0:De.value)===ve});fe.push(...Se)}return LL(fe,d,g,s)}),R=ie(()=>!Array.from(w.values()).some(_e=>_e.value)),$=ie(()=>L.value[L.value.length-1].layer),Z=ie(()=>({"--v-layout-left":Yt($.value.left),"--v-layout-right":Yt($.value.right),"--v-layout-top":Yt($.value.top),"--v-layout-bottom":Yt($.value.bottom),...R.value?void 0:{transition:"none"}})),de=ie(()=>L.value.slice(1).map((_e,fe)=>{let{id:ve}=_e;const{layer:Se}=L.value[fe],be=g.get(ve),De=d.get(ve);return{id:ve,...Se,size:Number(be.value),position:De.value}})),ne=_e=>de.value.find(fe=>fe.id===_e),ce=Mr("createLayout"),K=Qe(!1);Fn(()=>{K.value=!0}),Gi(pg,{register:(_e,fe)=>{let{id:ve,order:Se,position:be,layoutSize:De,elementSize:ze,active:Ke,disableTransitions:ct,absolute:nt}=fe;_.set(ve,Se),d.set(ve,be),g.set(ve,De),s.set(ve,Ke),ct&&w.set(ve,ct);const Pe=gf(wT,ce==null?void 0:ce.vnode).indexOf(_e);Pe>-1?c.value.splice(Pe,0,ve):c.value.push(ve);const at=ie(()=>de.value.findIndex(qt=>qt.id===ve)),Gt=ie(()=>a.value+L.value.length*2-at.value*2),pt=ie(()=>{const qt=be.value==="left"||be.value==="right",Ln=be.value==="right",kt=be.value==="bottom",Je={[be.value]:0,zIndex:Gt.value,transform:`translate${qt?"X":"Y"}(${(Ke.value?0:-110)*(Ln||kt?-1:1)}%)`,position:nt.value||a.value!==Dw?"absolute":"fixed",...R.value?void 0:{transition:"none"}};if(!K.value)return Je;const bt=de.value[at.value];if(!bt)throw new Error(`[Vuetify] Could not find layout item "${ve}"`);const Tt=z.value.get(ve);return Tt&&(bt[Tt.position]+=Tt.amount),{...Je,height:qt?`calc(100% - ${bt.top}px - ${bt.bottom}px)`:ze.value?`${ze.value}px`:void 0,left:Ln?void 0:`${bt.left}px`,right:Ln?`${bt.right}px`:void 0,top:be.value!=="bottom"?`${bt.top}px`:void 0,bottom:be.value!=="top"?`${bt.bottom}px`:void 0,width:qt?ze.value?`${ze.value}px`:void 0:`calc(100% - ${bt.left}px - ${bt.right}px)`}}),Lt=ie(()=>({zIndex:Gt.value-1}));return{layoutItemStyles:pt,layoutItemScrimStyles:Lt,zIndex:Gt}},unregister:_e=>{_.delete(_e),d.delete(_e),g.delete(_e),s.delete(_e),w.delete(_e),c.value=c.value.filter(fe=>fe!==_e)},mainRect:$,mainStyles:Z,getLayoutItem:ne,items:de,layoutRect:A,rootZIndex:a});const Ee=ie(()=>["v-layout",{"v-layout--full-height":e.fullHeight}]),Y=ie(()=>({zIndex:a.value,position:o?"relative":void 0,overflow:o?"hidden":void 0}));return{layoutClasses:Ee,layoutStyles:Y,getLayoutItem:ne,items:de,layoutRect:A,layoutRef:S}}const Di=Pn({rounded:{type:[Boolean,Number,String],default:void 0}},"rounded");function er(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ya();return{roundedClasses:ie(()=>{const c=Pi(e)?e.value:e.rounded,d=[];if(c===!0||c==="")d.push(`${o}--rounded`);else if(typeof c=="string"||c===0)for(const g of String(c).split(" "))d.push(`rounded-${g}`);return d})}}const Sn=Pn({tag:{type:String,default:"div"}},"tag"),Ku=2.4,Rw=.2126729,Bw=.7151522,Ow=.072175,DL=.55,RL=.58,BL=.57,OL=.62,Um=.03,Fw=1.45,FL=5e-4,VL=1.25,NL=1.25,Vw=.078,Nw=12.82051282051282,jm=.06,$w=.001;function Uw(e,o){const a=((e>>16&255)/255)**Ku,c=((e>>8&255)/255)**Ku,d=((e>>0&255)/255)**Ku,g=((o>>16&255)/255)**Ku,_=((o>>8&255)/255)**Ku,s=((o>>0&255)/255)**Ku;let w=a*Rw+c*Bw+d*Ow,S=g*Rw+_*Bw+s*Ow;if(w<=Um&&(w+=(Um-w)**Fw),S<=Um&&(S+=(Um-S)**Fw),Math.abs(S-w)<FL)return 0;let A;if(S>w){const z=(S**DL-w**RL)*VL;A=z<$w?0:z<Vw?z-z*Nw*jm:z-jm}else{const z=(S**OL-w**BL)*NL;A=z>-$w?0:z>-Vw?z-z*Nw*jm:z+jm}return A*100}const zf=Symbol.for("vuetify:theme"),Kn=Pn({theme:String},"theme"),Qd={defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#6200EE","primary-darken-1":"#3700B3",secondary:"#03DAC6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-variant":"#BDBDBD","on-surface-variant":"#424242",primary:"#BB86FC","primary-darken-1":"#3700B3",secondary:"#03DAC5","secondary-darken-1":"#03DAC5",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}};function $L(){var d;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Qd;if(!e)return{...Qd,isDisabled:!0};const o={};for(const[g,_]of Object.entries((d=e.themes)!=null?d:{})){var a,c;const s=_.dark||g==="dark"?(a=Qd.themes)==null?void 0:a.dark:(c=Qd.themes)==null?void 0:c.light;o[g]=va(s,_)}return va(Qd,{...e,themes:o})}function UL(e){const o=Ki($L(e)),a=Qe(o.defaultTheme),c=Qe(o.themes),d=ie(()=>{const S={};for(const[A,z]of Object.entries(c.value)){const L=S[A]={...z,colors:{...z.colors}};if(o.variations)for(const R of o.variations.colors){const $=L.colors[R];if(!!$)for(const Z of["lighten","darken"]){const de=Z==="lighten"?yL:xL;for(const ne of Sc(o.variations[Z],1))L.colors[`${R}-${Z}-${ne}`]=pL(de(dg($),ne))}}for(const R of Object.keys(L.colors)){if(/^on-[a-z]/.test(R)||L.colors[`on-${R}`])continue;const $=`on-${R}`,Z=dg(L.colors[R]),de=Math.abs(Uw(0,Z)),ne=Math.abs(Uw(16777215,Z));L.colors[$]=ne>Math.min(de,50)?"#fff":"#000"}}return S}),g=ie(()=>d.value[a.value]),_=ie(()=>{const S=[];g.value.dark&&Ju(S,":root",["color-scheme: dark"]);for(const[R,$]of Object.entries(d.value)){const{variables:Z,dark:de}=$;Ju(S,`.v-theme--${R}`,[`color-scheme: ${de?"dark":"normal"}`,...jL($),...Object.keys(Z).map(ne=>{const ce=Z[ne],K=typeof ce=="string"&&ce.startsWith("#")?gT(ce):void 0,Ee=K?`${K.r}, ${K.g}, ${K.b}`:void 0;return`--v-${ne}: ${Ee!=null?Ee:ce}`})])}const A=[],z=[],L=new Set(Object.values(d.value).flatMap(R=>Object.keys(R.colors)));for(const R of L)/^on-[a-z]/.test(R)?Ju(z,`.${R}`,[`color: rgb(var(--v-theme-${R})) !important`]):(Ju(A,`.bg-${R}`,[`--v-theme-overlay-multiplier: var(--v-theme-${R}-overlay-multiplier)`,`background: rgb(var(--v-theme-${R})) !important`,`color: rgb(var(--v-theme-on-${R})) !important`]),Ju(z,`.text-${R}`,[`color: rgb(var(--v-theme-${R})) !important`]),Ju(z,`.border-${R}`,[`--v-border-color: var(--v-theme-${R})`]));return S.push(...A,...z),S.map((R,$)=>$===0?R:`    ${R}`).join("")});function s(S){const A=S._context.provides.usehead;if(A)A.addHeadObjs(ie(()=>{const L={children:_.value,type:"text/css",id:"vuetify-theme-stylesheet"};return o.cspNonce&&(L.nonce=o.cspNonce),{style:[L]}})),zi&&Vs(()=>A.updateDOM());else{let R=function(){if(!o.isDisabled){if(typeof document<"u"&&!L){const $=document.createElement("style");$.type="text/css",$.id="vuetify-theme-stylesheet",o.cspNonce&&$.setAttribute("nonce",o.cspNonce),L=$,document.head.appendChild(L)}L&&(L.innerHTML=_.value)}};var z=R;let L=zi?document.getElementById("vuetify-theme-stylesheet"):null;Ye(_,R,{immediate:!0})}}const w=ie(()=>o.isDisabled?void 0:`v-theme--${a.value}`);return{install:s,isDisabled:o.isDisabled,name:a,themes:c,current:g,computedThemes:d,themeClasses:w,styles:_,global:{name:a,current:g}}}function wi(e){Mr("provideTheme");const o=cn(zf,null);if(!o)throw new Error("Could not find Vuetify theme injection");const a=ie(()=>{var g;return(g=e.theme)!=null?g:o==null?void 0:o.name.value}),c=ie(()=>o.isDisabled?void 0:`v-theme--${a.value}`),d={...o,name:a,themeClasses:c};return Gi(zf,d),d}function TT(){Mr("useTheme");const e=cn(zf,null);if(!e)throw new Error("Could not find Vuetify theme injection");return e}function Ju(e,o,a){e.push(`${o} {
`,...a.map(c=>`  ${c};
`),`}
`)}function jL(e){const o=e.dark?2:1,a=e.dark?1:2,c=[];for(const[d,g]of Object.entries(e.colors)){const _=gT(g);c.push(`--v-theme-${d}: ${_.r},${_.g},${_.b}`),d.startsWith("on-")||c.push(`--v-theme-${d}-overlay-multiplier: ${dy(g)>.18?o:a}`)}return c}function b0(e){return m0(()=>{const o=[],a={};return e.value.background&&(Lw(e.value.background)?a.backgroundColor=e.value.background:o.push(`bg-${e.value.background}`)),e.value.text&&(Lw(e.value.text)?(a.color=e.value.text,a.caretColor=e.value.text):o.push(`text-${e.value.text}`)),{colorClasses:o,colorStyles:a}})}function oo(e,o){const a=ie(()=>({text:Pi(e)?e.value:o?e[o]:null})),{colorClasses:c,colorStyles:d}=b0(a);return{textColorClasses:c,textColorStyles:d}}function Qi(e,o){const a=ie(()=>({background:Pi(e)?e.value:o?e[o]:null})),{colorClasses:c,colorStyles:d}=b0(a);return{backgroundColorClasses:c,backgroundColorStyles:d}}const GL=["elevated","flat","tonal","outlined","text","plain"];function Nc(e,o){return F(On,null,[e&&F("span",{key:"overlay",class:`${o}__overlay`},null),F("span",{key:"underlay",class:`${o}__underlay`},null)])}const Vo=Pn({color:String,variant:{type:String,default:"elevated",validator:e=>GL.includes(e)}},"variant");function $c(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ya();const a=ie(()=>{const{variant:g}=Xn(e);return`${o}--variant-${g}`}),{colorClasses:c,colorStyles:d}=b0(ie(()=>{const{variant:g,color:_}=Xn(e);return{[["elevated","flat"].includes(g)?"background":"text"]:_}}));return{colorClasses:c,colorStyles:d,variantClasses:a}}const CT=zt({name:"VBtnGroup",props:{divided:Boolean,...vo(),...vr(),...lr(),...Di(),...Sn(),...Kn(),...Vo()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=wi(e),{densityClasses:d}=qr(e),{borderClasses:g}=Fo(e),{elevationClasses:_}=Pr(e),{roundedClasses:s}=er(e);sr({VBtn:{height:"auto",color:St(e,"color"),density:St(e,"density"),flat:!0,variant:St(e,"variant")}}),Mt(()=>F(e.tag,{class:["v-btn-group",{"v-btn-group--divided":e.divided},c.value,g.value,d.value,_.value,s.value]},a))}}),w0=Symbol.for("vuetify:v-btn-toggle"),qL=Li()({name:"VBtnToggle",props:mh(),emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{isSelected:c,next:d,prev:g,select:_,selected:s}=Vc(e,w0);return Mt(()=>{var w;return F(CT,{class:"v-btn-toggle"},{default:()=>[(w=a.default)==null?void 0:w.call(a,{isSelected:c,next:d,prev:g,select:_,selected:s})]})}),{next:d,prev:g,select:_}}}),IT=zt({name:"VBottomNavigation",props:{bgColor:String,color:String,grow:Boolean,mode:{type:String,validator:e=>!e||["horizontal","shift"].includes(e)},height:{type:[Number,String],default:56},...vo(),...vr(),...lr(),...Di(),...vh({name:"bottom-navigation"}),...Sn({tag:"header"}),...mh({modelValue:!0,selectedClass:"v-btn--selected"}),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{themeClasses:c}=TT(),{borderClasses:d}=Fo(e),{backgroundColorClasses:g,backgroundColorStyles:_}=Qi(St(e,"bgColor")),{densityClasses:s}=qr(e),{elevationClasses:w}=Pr(e),{roundedClasses:S}=er(e),A=ie(()=>Number(e.height)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0)),z=En(e,"modelValue"),{layoutItemStyles:L}=_h({id:e.name,order:ie(()=>parseInt(e.order,10)),position:ie(()=>"bottom"),layoutSize:ie(()=>z.value?A.value:0),elementSize:A,active:z,absolute:St(e,"absolute")});return Vc(e,w0),sr({VBtn:{color:St(e,"color"),density:St(e,"density"),stacked:ie(()=>e.mode!=="horizontal"),variant:"text"}},{scoped:!0}),Mt(()=>F(e.tag,{class:["v-bottom-navigation",{"v-bottom-navigation--active":z.value,"v-bottom-navigation--grow":e.grow,"v-bottom-navigation--shift":e.mode==="shift"},c.value,g.value,d.value,s.value,w.value,S.value],style:[_.value,L.value,{height:Yt(A.value),transform:`translateY(${Yt(z.value?0:100,"%")})`}]},{default:()=>[a.default&&F("div",{class:"v-bottom-navigation__content"},[a.default()])]})),{}}});const Ti=gn({name:"VDefaultsProvider",props:{defaults:Object,reset:[Number,String],root:Boolean,scoped:Boolean},setup(e,o){let{slots:a}=o;const{defaults:c,reset:d,root:g,scoped:_}=e0(e);return sr(c,{reset:d,root:g,scoped:_}),()=>{var s;return(s=a.default)==null?void 0:s.call(a)}}});const ZL={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sort:"mdi-arrow-up",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus"},WL={component:e=>Ns(E0,{...e,class:"mdi"})},mn=[String,Function,Object],py=Symbol.for("vuetify:icons"),Fg=Pn({icon:{type:mn,required:!0},tag:{type:String,required:!0}},"icon"),AT=zt({name:"VComponentIcon",props:Fg(),setup(e){return()=>F(e.tag,null,{default:()=>[F(e.icon,null,null)]})}}),kT=zt({name:"VSvgIcon",inheritAttrs:!1,props:Fg(),setup(e,o){let{attrs:a}=o;return()=>F(e.tag,nn(a,{style:null}),{default:()=>[F("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[F("path",{d:e.icon},null)])]})}}),HL=zt({name:"VLigatureIcon",props:Fg(),setup(e){return()=>F(e.tag,null,{default:()=>[e.icon]})}}),E0=zt({name:"VClassIcon",props:Fg(),setup(e){return()=>F(e.tag,{class:e.icon},null)}}),XL={svg:{component:kT},class:{component:E0}};function YL(e){return va({defaultSet:"mdi",sets:{...XL,mdi:WL},aliases:ZL},e)}const KL=e=>{const o=cn(py);if(!o)throw new Error("Missing Vuetify Icons provide!");return{iconData:ie(()=>{const c=Pi(e)?e.value:e.icon;if(!c)throw new Error("Icon value is undefined or null");let d=c;if(typeof c=="string"&&c.includes("$")){var g;d=(g=o.aliases)==null?void 0:g[c.slice(c.indexOf("$")+1)]}if(!d)throw new Error(`Could not find aliased icon "${c}"`);if(typeof d!="string")return{component:AT,icon:d};const _=Object.keys(o.sets).find(S=>typeof d=="string"&&d.startsWith(`${S}:`)),s=_?d.slice(_.length+1):d;return{component:o.sets[_!=null?_:o.defaultSet].component,icon:s}})}},JL=["x-small","small","default","large","x-large"],xa=Pn({size:{type:[String,Number],default:"default"}},"size");function yh(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ya();return m0(()=>{let a,c;return cg(JL,e.size)?a=`${o}--size-${e.size}`:e.size&&(c={width:Yt(e.size),height:Yt(e.size)}),{sizeClasses:a,sizeStyles:c}})}const QL=Pn({color:String,start:Boolean,end:Boolean,icon:mn,...xa(),...Sn({tag:"i"}),...Kn()},"v-icon"),ir=zt({name:"VIcon",props:QL(),setup(e,o){let{attrs:a,slots:c}=o,d;c.default&&(d=ie(()=>{var A,z;const L=(A=c.default)==null?void 0:A.call(c);if(!!L)return(z=rT(L).filter(R=>R.children&&typeof R.children=="string")[0])==null?void 0:z.children}));const{themeClasses:g}=wi(e),{iconData:_}=KL(d||e),{sizeClasses:s}=yh(e),{textColorClasses:w,textColorStyles:S}=oo(St(e,"color"));return Mt(()=>F(_.value.component,{tag:e.tag,icon:_.value.icon,class:["v-icon","notranslate",g.value,s.value,w.value,{"v-icon--clickable":!!a.onClick,"v-icon--start":e.start,"v-icon--end":e.end}],style:[s.value?void 0:{fontSize:Yt(e.size),height:Yt(e.size),width:Yt(e.size)},S.value],role:a.onClick?"button":void 0,"aria-hidden":!a.onClick},null)),{}}});function S0(e){const o=Qe(),a=Qe(!1);if(x0){const c=new IntersectionObserver(d=>{e==null||e(d,c),a.value=!!d.find(g=>g.isIntersecting)});Ii(()=>{c.disconnect()}),Ye(o,(d,g)=>{g&&(c.unobserve(g),a.value=!1),d&&c.observe(d)},{flush:"post"})}return{intersectionRef:o,isIntersecting:a}}const T0=zt({name:"VProgressCircular",props:{bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...xa(),...Sn({tag:"div"}),...Kn()},setup(e,o){let{slots:a}=o;const c=20,d=2*Math.PI*c,g=Qe(),{themeClasses:_}=wi(e),{sizeClasses:s,sizeStyles:w}=yh(e),{textColorClasses:S,textColorStyles:A}=oo(St(e,"color")),{textColorClasses:z,textColorStyles:L}=oo(St(e,"bgColor")),{intersectionRef:R,isIntersecting:$}=S0(),{resizeRef:Z,contentRect:de}=zc(),ne=ie(()=>Math.max(0,Math.min(100,parseFloat(e.modelValue)))),ce=ie(()=>Number(e.width)),K=ie(()=>w.value?Number(e.size):de.value?de.value.width:Math.max(ce.value,32)),Ee=ie(()=>c/(1-ce.value/K.value)*2),Y=ie(()=>ce.value/K.value*Ee.value),_e=ie(()=>Yt((100-ne.value)/100*d));return Vs(()=>{R.value=g.value,Z.value=g.value}),Mt(()=>F(e.tag,{ref:g,class:["v-progress-circular",{"v-progress-circular--indeterminate":!!e.indeterminate,"v-progress-circular--visible":$.value,"v-progress-circular--disable-shrink":e.indeterminate==="disable-shrink"},_.value,s.value,S.value],style:[w.value,A.value],role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.indeterminate?void 0:ne.value},{default:()=>[F("svg",{style:{transform:`rotate(calc(-90deg + ${Number(e.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${Ee.value} ${Ee.value}`},[F("circle",{class:["v-progress-circular__underlay",z.value],style:L.value,fill:"transparent",cx:"50%",cy:"50%",r:c,"stroke-width":Y.value,"stroke-dasharray":d,"stroke-dashoffset":0},null),F("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:c,"stroke-width":Y.value,"stroke-dasharray":d,"stroke-dashoffset":_e.value},null)]),a.default&&F("div",{class:"v-progress-circular__content"},[a.default({value:ne.value})])]})),{}}});const my=Symbol("rippleStop"),eD=80;function jw(e,o){e.style.transform=o,e.style.webkitTransform=o}function z_(e,o){e.style.opacity=`calc(${o} * var(--v-theme-overlay-multiplier))`}function gy(e){return e.constructor.name==="TouchEvent"}function MT(e){return e.constructor.name==="KeyboardEvent"}const tD=function(e,o){var a;let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d=0,g=0;if(!MT(e)){const L=o.getBoundingClientRect(),R=gy(e)?e.touches[e.touches.length-1]:e;d=R.clientX-L.left,g=R.clientY-L.top}let _=0,s=.3;(a=o._ripple)!=null&&a.circle?(s=.15,_=o.clientWidth/2,_=c.center?_:_+Math.sqrt((d-_)**2+(g-_)**2)/4):_=Math.sqrt(o.clientWidth**2+o.clientHeight**2)/2;const w=`${(o.clientWidth-_*2)/2}px`,S=`${(o.clientHeight-_*2)/2}px`,A=c.center?w:`${d-_}px`,z=c.center?S:`${g-_}px`;return{radius:_,scale:s,x:A,y:z,centerX:w,centerY:S}},mg={show(e,o){var a;let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(o!=null&&(a=o._ripple)!=null&&a.enabled))return;const d=document.createElement("span"),g=document.createElement("span");d.appendChild(g),d.className="v-ripple__container",c.class&&(d.className+=` ${c.class}`);const{radius:_,scale:s,x:w,y:S,centerX:A,centerY:z}=tD(e,o,c),L=`${_*2}px`;g.className="v-ripple__animation",g.style.width=L,g.style.height=L,o.appendChild(d);const R=window.getComputedStyle(o);R&&R.position==="static"&&(o.style.position="relative",o.dataset.previousPosition="static"),g.classList.add("v-ripple__animation--enter"),g.classList.add("v-ripple__animation--visible"),jw(g,`translate(${w}, ${S}) scale3d(${s},${s},${s})`),z_(g,0),g.dataset.activated=String(performance.now()),setTimeout(()=>{g.classList.remove("v-ripple__animation--enter"),g.classList.add("v-ripple__animation--in"),jw(g,`translate(${A}, ${z}) scale3d(1,1,1)`),z_(g,.08)},0)},hide(e){var o;if(!(e!=null&&(o=e._ripple)!=null&&o.enabled))return;const a=e.getElementsByClassName("v-ripple__animation");if(a.length===0)return;const c=a[a.length-1];if(c.dataset.isHiding)return;c.dataset.isHiding="true";const d=performance.now()-Number(c.dataset.activated),g=Math.max(250-d,0);setTimeout(()=>{c.classList.remove("v-ripple__animation--in"),c.classList.add("v-ripple__animation--out"),z_(c,0),setTimeout(()=>{e.getElementsByClassName("v-ripple__animation").length===1&&e.dataset.previousPosition&&(e.style.position=e.dataset.previousPosition,delete e.dataset.previousPosition),c.parentNode&&e.removeChild(c.parentNode)},300)},g)}};function PT(e){return typeof e>"u"||!!e}function Lf(e){const o={},a=e.currentTarget;if(!(!(a!=null&&a._ripple)||a._ripple.touched||e[my])){if(e[my]=!0,gy(e))a._ripple.touched=!0,a._ripple.isTouch=!0;else if(a._ripple.isTouch)return;if(o.center=a._ripple.centered||MT(e),a._ripple.class&&(o.class=a._ripple.class),gy(e)){if(a._ripple.showTimerCommit)return;a._ripple.showTimerCommit=()=>{mg.show(e,a,o)},a._ripple.showTimer=window.setTimeout(()=>{var c;a!=null&&(c=a._ripple)!=null&&c.showTimerCommit&&(a._ripple.showTimerCommit(),a._ripple.showTimerCommit=null)},eD)}else mg.show(e,a,o)}}function Gw(e){e[my]=!0}function fo(e){const o=e.currentTarget;if(!(!o||!o._ripple)){if(window.clearTimeout(o._ripple.showTimer),e.type==="touchend"&&o._ripple.showTimerCommit){o._ripple.showTimerCommit(),o._ripple.showTimerCommit=null,o._ripple.showTimer=window.setTimeout(()=>{fo(e)});return}window.setTimeout(()=>{o._ripple&&(o._ripple.touched=!1)}),mg.hide(o)}}function zT(e){const o=e.currentTarget;!o||!o._ripple||(o._ripple.showTimerCommit&&(o._ripple.showTimerCommit=null),window.clearTimeout(o._ripple.showTimer))}let Df=!1;function LT(e){!Df&&(e.keyCode===Aw.enter||e.keyCode===Aw.space)&&(Df=!0,Lf(e))}function DT(e){Df=!1,fo(e)}function RT(e){Df&&(Df=!1,fo(e))}function BT(e,o,a){var _;const{value:c,modifiers:d}=o,g=PT(c);if(g||mg.hide(e),e._ripple=(_=e._ripple)!=null?_:{},e._ripple.enabled=g,e._ripple.centered=d.center,e._ripple.circle=d.circle,ay(c)&&c.class&&(e._ripple.class=c.class),g&&!a){if(d.stop){e.addEventListener("touchstart",Gw,{passive:!0}),e.addEventListener("mousedown",Gw);return}e.addEventListener("touchstart",Lf,{passive:!0}),e.addEventListener("touchend",fo,{passive:!0}),e.addEventListener("touchmove",zT,{passive:!0}),e.addEventListener("touchcancel",fo),e.addEventListener("mousedown",Lf),e.addEventListener("mouseup",fo),e.addEventListener("mouseleave",fo),e.addEventListener("keydown",LT),e.addEventListener("keyup",DT),e.addEventListener("blur",RT),e.addEventListener("dragstart",fo,{passive:!0})}else!g&&a&&OT(e)}function OT(e){e.removeEventListener("mousedown",Lf),e.removeEventListener("touchstart",Lf),e.removeEventListener("touchend",fo),e.removeEventListener("touchmove",zT),e.removeEventListener("touchcancel",fo),e.removeEventListener("mouseup",fo),e.removeEventListener("mouseleave",fo),e.removeEventListener("keydown",LT),e.removeEventListener("keyup",DT),e.removeEventListener("dragstart",fo),e.removeEventListener("blur",RT)}function nD(e,o){BT(e,o,!1)}function iD(e){delete e._ripple,OT(e)}function rD(e,o){if(o.value===o.oldValue)return;const a=PT(o.oldValue);BT(e,o,a)}const bl={mounted:nD,unmounted:iD,updated:rD},ss=Pn({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function as(e){return{dimensionStyles:ie(()=>({height:Yt(e.height),maxHeight:Yt(e.maxHeight),maxWidth:Yt(e.maxWidth),minHeight:Yt(e.minHeight),minWidth:Yt(e.minWidth),width:Yt(e.width)}))}}const oD={badge:"Badge",close:"Close",dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},datePicker:{itemsSelected:"{0} selected",nextMonthAriaLabel:"Next month",nextYearAriaLabel:"Next year",prevMonthAriaLabel:"Previous month",prevYearAriaLabel:"Previous year"},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Goto Page {0}",currentPage:"Page {0}, Current Page",first:"First page",last:"Last page"}},rating:{ariaLabel:{item:"Rating {0} of {1}"}}},qw="$vuetify.",Zw=(e,o)=>e.replace(/\{(\d+)\}/g,(a,c)=>String(o[+c])),FT=(e,o,a)=>function(c){for(var d=arguments.length,g=new Array(d>1?d-1:0),_=1;_<d;_++)g[_-1]=arguments[_];if(!c.startsWith(qw))return Zw(c,g);const s=c.replace(qw,""),w=e.value&&a.value[e.value],S=o.value&&a.value[o.value];let A=sy(w,s,null);return A||(Mc(`Translation key "${c}" not found in "${e.value}", trying fallback locale`),A=sy(S,s,null)),A||(hy(`Translation key "${c}" not found in fallback`),A=c),typeof A!="string"&&(hy(`Translation key "${c}" has a non-string value`),A=c),Zw(A,g)};function VT(e,o){return(a,c)=>new Intl.NumberFormat([e.value,o.value],c).format(a)}function L_(e,o,a){var d,g;const c=En(e,o,(d=e[o])!=null?d:a.value);return c.value=(g=e[o])!=null?g:a.value,Ye(a,_=>{e[o]==null&&(c.value=a.value)}),c}function NT(e){return o=>{const a=L_(o,"locale",e.current),c=L_(o,"fallback",e.fallback),d=L_(o,"messages",e.messages);return{name:"vuetify",current:a,fallback:c,messages:d,t:FT(a,c,d),n:VT(a,c),provide:NT({current:a,fallback:c,messages:d})}}}function sD(e){var d,g;const o=Qe((d=e==null?void 0:e.locale)!=null?d:"en"),a=Qe((g=e==null?void 0:e.fallback)!=null?g:"en"),c=Qe({en:oD,...e==null?void 0:e.messages});return{name:"vuetify",current:o,fallback:a,messages:c,t:FT(o,a,c),n:VT(o,a),provide:NT({current:o,fallback:a,messages:c})}}const aD={af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!1,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1},hh=Symbol.for("vuetify:locale");function lD(e){return e.name!=null}function cD(e){const o=e!=null&&e.adapter&&lD(e==null?void 0:e.adapter)?e==null?void 0:e.adapter:sD(e),a=hD(o,e);return{...o,...a}}function ls(){const e=cn(hh);if(!e)throw new Error("[Vuetify] Could not find injected locale instance");return e}function uD(e){const o=cn(hh);if(!o)throw new Error("[Vuetify] Could not find injected locale instance");const a=o.provide(e),c=dD(a,o.rtl,e),d={...a,...c};return Gi(hh,d),d}function hD(e,o){var d;const a=Qe((d=o==null?void 0:o.rtl)!=null?d:aD),c=ie(()=>{var g;return(g=a.value[e.current.value])!=null?g:!1});return{isRtl:c,rtl:a,rtlClasses:ie(()=>`v-locale--is-${c.value?"rtl":"ltr"}`)}}function dD(e,o,a){const c=ie(()=>{var d,g;return(g=(d=a.rtl)!=null?d:o.value[e.current.value])!=null?g:!1});return{isRtl:c,rtl:o,rtlClasses:ie(()=>`v-locale--is-${c.value?"rtl":"ltr"}`)}}function ba(){const e=cn(hh);if(!e)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:e.isRtl,rtlClasses:e.rtlClasses}}const C0=zt({name:"VProgressLinear",props:{active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,...Di(),...Sn(),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=En(e,"modelValue"),{isRtl:d}=ba(),{themeClasses:g}=wi(e),{textColorClasses:_,textColorStyles:s}=oo(e,"color"),{backgroundColorClasses:w,backgroundColorStyles:S}=Qi(ie(()=>e.bgColor||e.color)),{backgroundColorClasses:A,backgroundColorStyles:z}=Qi(e,"color"),{roundedClasses:L}=er(e),{intersectionRef:R,isIntersecting:$}=S0(),Z=ie(()=>parseInt(e.max,10)),de=ie(()=>parseInt(e.height,10)),ne=ie(()=>parseFloat(e.bufferValue)/Z.value*100),ce=ie(()=>parseFloat(c.value)/Z.value*100),K=ie(()=>d.value!==e.reverse),Ee=ie(()=>e.indeterminate?"fade-transition":"slide-x-transition"),Y=ie(()=>e.bgOpacity==null?e.bgOpacity:parseFloat(e.bgOpacity));function _e(fe){if(!R.value)return;const{left:ve,right:Se,width:be}=R.value.getBoundingClientRect(),De=K.value?be-fe.clientX+(Se-be):fe.clientX-ve;c.value=Math.round(De/be*Z.value)}return Mt(()=>F(e.tag,{ref:R,class:["v-progress-linear",{"v-progress-linear--active":e.active&&$.value,"v-progress-linear--reverse":K.value,"v-progress-linear--rounded":e.rounded,"v-progress-linear--rounded-bar":e.roundedBar,"v-progress-linear--striped":e.striped},L.value,g.value],style:{height:e.active?Yt(de.value):0,"--v-progress-linear-height":Yt(de.value)},role:"progressbar","aria-valuemin":"0","aria-valuemax":e.max,"aria-valuenow":e.indeterminate?void 0:ce.value,onClick:e.clickable&&_e},{default:()=>[e.stream&&F("div",{key:"stream",class:["v-progress-linear__stream",_.value],style:{...s.value,[K.value?"left":"right"]:Yt(-de.value),borderTop:`${Yt(de.value/2)} dotted`,opacity:Y.value,top:`calc(50% - ${Yt(de.value/4)})`,width:Yt(100-ne.value,"%"),"--v-progress-linear-stream-to":Yt(de.value*(K.value?1:-1))}},null),F("div",{class:["v-progress-linear__background",w.value],style:[S.value,{opacity:Y.value,width:Yt(e.stream?ne.value:100,"%")}]},null),F(Fs,{name:Ee.value},{default:()=>[e.indeterminate?F("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(fe=>F("div",{key:fe,class:["v-progress-linear__indeterminate",fe,A.value],style:z.value},null))]):F("div",{class:["v-progress-linear__determinate",A.value],style:[z.value,{width:Yt(ce.value,"%")}]},null)]}),a.default&&F("div",{class:"v-progress-linear__content"},[a.default({value:ce.value,buffer:ne.value})])]})),{}}}),I0=Pn({loading:Boolean},"loader");function Vg(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ya();return{loaderClasses:ie(()=>({[`${o}--loading`]:e.loading}))}}function A0(e,o){var a;let{slots:c}=o;return F("div",{class:`${e.name}__loader`},[((a=c.default)==null?void 0:a.call(c,{color:e.color,isActive:e.active}))||F(C0,{active:e.active,color:e.color,height:"2",indeterminate:!0},null)])}const Ww={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},Uc=Pn({location:String},"location");function jc(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=arguments.length>2?arguments[2]:void 0;const{isRtl:c}=ba();return{locationStyles:ie(()=>{if(!e.location)return{};const{side:g,align:_}=cy(e.location.split(" ").length>1?e.location:`${e.location} center`,c.value);function s(S){return a?a(S):0}const w={};return g!=="center"&&(o?w[Ww[g]]=`calc(100% - ${s(g)}px)`:w[g]=0),_!=="center"?o?w[Ww[_]]=`calc(100% - ${s(_)}px)`:w[_]=0:(g==="center"?w.top=w.left="50%":w[{top:"left",bottom:"left",left:"top",right:"top"}[g]]="50%",w.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[g]),w})}}const fD=["static","relative","fixed","absolute","sticky"],xh=Pn({position:{type:String,validator:e=>fD.includes(e)}},"position");function bh(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ya();return{positionClasses:ie(()=>e.position?`${o}--${e.position}`:void 0)}}function $T(){var e,o;return(e=Mr("useRouter"))==null||(o=e.proxy)==null?void 0:o.$router}function Gf(e,o){const a=zM("RouterLink"),c=ie(()=>!!(e.href||e.to)),d=ie(()=>(c==null?void 0:c.value)||!!(o.onClick||o.onClickOnce));if(typeof a=="string")return{isLink:c,isClickable:d,href:St(e,"href")};const g=e.to?a.useLink(e):void 0;return{isLink:c,isClickable:d,route:g==null?void 0:g.route,navigate:g==null?void 0:g.navigate,isActive:g&&ie(()=>{var _,s;return e.exact?(_=g.isExactActive)==null?void 0:_.value:(s=g.isActive)==null?void 0:s.value}),href:ie(()=>e.to?g==null?void 0:g.route.value.href:e.href)}}const wh=Pn({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let D_=!1;function pD(e,o){let a=!1,c,d;zi&&(Zi(()=>{window.addEventListener("popstate",g),c=e==null?void 0:e.beforeEach((_,s,w)=>{D_?a?o(w):w():setTimeout(()=>a?o(w):w()),D_=!0}),d=e==null?void 0:e.afterEach(()=>{D_=!1})}),Dc(()=>{var _,s;window.removeEventListener("popstate",g),(_=c)==null||_(),(s=d)==null||s()}));function g(_){var s;(s=_.state)!=null&&s.replaced||(a=!0,setTimeout(()=>a=!1))}}function mD(e,o){Ye(()=>{var a;return(a=e.isActive)==null?void 0:a.value},a=>{e.isLink.value&&a&&o&&Zi(()=>{o(!0)})},{immediate:!0})}const Fi=zt({name:"VBtn",directives:{Ripple:bl},props:{active:{type:Boolean,default:void 0},symbol:{type:null,default:w0},flat:Boolean,icon:[Boolean,String,Function,Object],prependIcon:mn,appendIcon:mn,block:Boolean,stacked:Boolean,ripple:{type:Boolean,default:!0},...vo(),...Di(),...vr(),...ss(),...lr(),...Fc(),...I0(),...Uc(),...xh(),...wh(),...xa(),...Sn({tag:"button"}),...Kn(),...Vo({variant:"elevated"})},emits:{"group:selected":e=>!0},setup(e,o){let{attrs:a,slots:c}=o;const{themeClasses:d}=wi(e),{borderClasses:g}=Fo(e),{colorClasses:_,colorStyles:s,variantClasses:w}=$c(e),{densityClasses:S}=qr(e),{dimensionStyles:A}=as(e),{elevationClasses:z}=Pr(e),{loaderClasses:L}=Vg(e),{locationStyles:R}=jc(e),{positionClasses:$}=bh(e),{roundedClasses:Z}=er(e),{sizeClasses:de,sizeStyles:ne}=yh(e),ce=gh(e,e.symbol,!1),K=Gf(e,a),Ee=ie(()=>{var fe;return e.active!==!1&&(e.active||((fe=K.isActive)==null?void 0:fe.value)||(ce==null?void 0:ce.isSelected.value))}),Y=ie(()=>(ce==null?void 0:ce.disabled.value)||e.disabled),_e=ie(()=>e.variant==="elevated"&&!(e.disabled||e.flat||e.border));return mD(K,ce==null?void 0:ce.select),Mt(()=>{var fe,ve,Se,be;const De=K.isLink.value?"a":e.tag,ze=!ce||ce.isSelected.value,Ke=!!(e.prependIcon||c.prepend),ct=!!(e.appendIcon||c.append),nt=!!(e.icon&&e.icon!==!0);return Wi(F(De,{type:De==="a"?void 0:"button",class:["v-btn",ce==null?void 0:ce.selectedClass.value,{"v-btn--active":Ee.value,"v-btn--block":e.block,"v-btn--disabled":Y.value,"v-btn--elevated":_e.value,"v-btn--flat":e.flat,"v-btn--icon":!!e.icon,"v-btn--loading":e.loading,"v-btn--stacked":e.stacked},d.value,g.value,ze?_.value:void 0,S.value,z.value,L.value,$.value,Z.value,de.value,w.value],style:[ze?s.value:void 0,A.value,R.value,ne.value],disabled:Y.value||void 0,href:K.href.value,onClick:ft=>{var Pe;Y.value||((Pe=K.navigate)==null||Pe.call(K,ft),ce==null||ce.toggle())}},{default:()=>{var ft;return[Nc(!0,"v-btn"),!e.icon&&Ke&&F(Ti,{key:"prepend",defaults:{VIcon:{icon:e.prependIcon}}},{default:()=>{var Pe;return[F("span",{class:"v-btn__prepend"},[(Pe=(fe=c.prepend)==null?void 0:fe.call(c))!=null?Pe:F(ir,null,null)])]}}),F("span",{class:"v-btn__content","data-no-activator":""},[F(Ti,{key:"content",defaults:{VIcon:{icon:nt?e.icon:void 0}}},{default:()=>{var Pe;return[(Pe=(ve=c.default)==null?void 0:ve.call(c))!=null?Pe:nt&&F(ir,{key:"icon"},null)]}})]),!e.icon&&ct&&F(Ti,{key:"append",defaults:{VIcon:{icon:e.appendIcon}}},{default:()=>{var Pe;return[F("span",{class:"v-btn__append"},[(Pe=(Se=c.append)==null?void 0:Se.call(c))!=null?Pe:F(ir,null,null)])]}}),!!e.loading&&F("span",{key:"loader",class:"v-btn__loader"},[(ft=(be=c.loader)==null?void 0:be.call(c))!=null?ft:F(T0,{color:typeof e.loading=="boolean"?void 0:e.loading,indeterminate:!0,size:"23",width:"2"},null)])]}}),[[mo("ripple"),!Y.value&&e.ripple,null]])}),{}}});const gD=zt({name:"VContainer",props:{fluid:{type:Boolean,default:!1},...Sn()},setup(e,o){let{slots:a}=o;return Mt(()=>F(e.tag,{class:["v-container",{"v-container--fluid":e.fluid}]},a)),{}}}),k0=["sm","md","lg","xl","xxl"],UT=(()=>k0.reduce((e,o)=>(e[o]={type:[Boolean,String,Number],default:!1},e),{}))(),jT=(()=>k0.reduce((e,o)=>(e["offset"+xl(o)]={type:[String,Number],default:null},e),{}))(),GT=(()=>k0.reduce((e,o)=>(e["order"+xl(o)]={type:[String,Number],default:null},e),{}))(),Hw={col:Object.keys(UT),offset:Object.keys(jT),order:Object.keys(GT)};function vD(e,o,a){let c=e;if(!(a==null||a===!1)){if(o){const d=o.replace(e,"");c+=`-${d}`}return e==="col"&&(c="v-"+c),e==="col"&&(a===""||a===!0)||(c+=`-${a}`),c.toLowerCase()}}const _D=["auto","start","end","center","baseline","stretch"],yD=zt({name:"VCol",props:{cols:{type:[Boolean,String,Number],default:!1},...UT,offset:{type:[String,Number],default:null},...jT,order:{type:[String,Number],default:null},...GT,alignSelf:{type:String,default:null,validator:e=>_D.includes(e)},...Sn()},setup(e,o){let{slots:a}=o;const c=ie(()=>{const d=[];let g;for(g in Hw)Hw[g].forEach(s=>{const w=e[s],S=vD(g,s,w);S&&d.push(S)});const _=d.some(s=>s.startsWith("v-col-"));return d.push({"v-col":!_||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),d});return()=>{var d;return Ns(e.tag,{class:c.value},(d=a.default)==null?void 0:d.call(a))}}}),xD=["sm","md","lg","xl","xxl"],M0=["start","end","center"],qT=["space-between","space-around","space-evenly"];function P0(e,o){return xD.reduce((a,c)=>(a[e+xl(c)]=o(),a),{})}const bD=[...M0,"baseline","stretch"],ZT=e=>bD.includes(e),WT=P0("align",()=>({type:String,default:null,validator:ZT})),wD=[...M0,...qT],HT=e=>wD.includes(e),XT=P0("justify",()=>({type:String,default:null,validator:HT})),ED=[...M0,...qT,"stretch"],YT=e=>ED.includes(e),KT=P0("alignContent",()=>({type:String,default:null,validator:YT})),Xw={align:Object.keys(WT),justify:Object.keys(XT),alignContent:Object.keys(KT)},SD={align:"align",justify:"justify",alignContent:"align-content"};function TD(e,o,a){let c=SD[e];if(a!=null){if(o){const d=o.replace(e,"");c+=`-${d}`}return c+=`-${a}`,c.toLowerCase()}}const CD=zt({name:"VRow",props:{dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:ZT},...WT,justify:{type:String,default:null,validator:HT},...XT,alignContent:{type:String,default:null,validator:YT},...KT,...Sn()},setup(e,o){let{slots:a}=o;const c=ie(()=>{const d=[];let g;for(g in Xw)Xw[g].forEach(_=>{const s=e[_],w=TD(g,_,s);w&&d.push(w)});return d.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),d});return()=>{var d;return Ns(e.tag,{class:["v-row",c.value]},(d=a.default)==null?void 0:d.call(a))}}}),vy=Oo("flex-grow-1","div","VSpacer"),ID=gn({__name:"FooterBottom",setup(e){const o=fh(),{icons:a,toggleIcon:c}=ph({icons:{index:"mdi-map-outline",finance:"mdi-file-document-edit-outline",meteorology:"mdi-cloud-outline",nuclear:"mdi-atom",evacuate:"mdi-run"},activeIcons:{index:"mdi-map",finance:"mdi-file-document-edit",meteorology:"mdi-cloud",nuclear:"mdi-atom-variant",evacuate:"mdi-run-fast"},temp:{index:"mdi-map-outline",finance:"mdi-file-document-edit-outline",meteorology:"mdi-cloud-outline",nuclear:"mdi-atom",evacuate:"mdi-run"}});function d(){o.push({name:"finance"}),c("finance")}function g(){o.push({name:"index"}),c("index")}function _(){o.push({name:"meteorology"}),c("meteorology")}function s(){o.push({name:"nuclear"}),c("nuclear")}function w(){o.push({name:"evacuate"}),c("evacuate")}return(S,A)=>(bi(),jr(IT,{elevation:"0",height:"74","bg-color":"primary"},{default:fi(()=>[F(vy),F(Fi,{class:"rounded-lg",onClick:g,"prepend-icon":Xn(a).index},{default:fi(()=>[Ds("\u6838\u7535\u5206\u5E03")]),_:1},8,["prepend-icon"]),F(Fi,{class:"rounded-lg",onClick:d,"prepend-icon":Xn(a).finance},{default:fi(()=>[Ds("\u7ECF\u6D4E\u6548\u5E94")]),_:1},8,["prepend-icon"]),F(Fi,{class:"rounded-lg",onClick:_,"prepend-icon":Xn(a).meteorology},{default:fi(()=>[Ds("\u6C14\u8C61\u53CD\u6F14")]),_:1},8,["prepend-icon"]),F(Fi,{class:"rounded-lg",onClick:s,"prepend-icon":Xn(a).nuclear},{default:fi(()=>[Ds("\u4E8B\u6545\u6A21\u62DF")]),_:1},8,["prepend-icon"]),F(Fi,{class:"rounded-lg",onClick:w,"prepend-icon":Xn(a).evacuate},{default:fi(()=>[Ds("\u64A4\u79BB\u4EFF\u771F")]),_:1},8,["prepend-icon"]),F(vy)]),_:1}))}}),wa=(e,o)=>{const a=e.__vccOpts||e;for(const[c,d]of o)a[c]=d;return a};function _o(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top center 0",a=arguments.length>2?arguments[2]:void 0;return zt({name:e,props:{group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:{type:String,default:a},origin:{type:String,default:o}},setup(c,d){let{slots:g}=d;return()=>{const _=c.group?DP:Fs;return Ns(_,{name:e,mode:c.mode,onBeforeEnter(s){s.style.transformOrigin=c.origin},onLeave(s){if(c.leaveAbsolute){const{offsetTop:w,offsetLeft:S,offsetWidth:A,offsetHeight:z}=s;s._transitionInitialStyles={position:s.style.position,top:s.style.top,left:s.style.left,width:s.style.width,height:s.style.height},s.style.position="absolute",s.style.top=`${w}px`,s.style.left=`${S}px`,s.style.width=`${A}px`,s.style.height=`${z}px`}c.hideOnLeave&&s.style.setProperty("display","none","important")},onAfterLeave(s){if(c.leaveAbsolute&&s!=null&&s._transitionInitialStyles){const{position:w,top:S,left:A,width:z,height:L}=s._transitionInitialStyles;delete s._transitionInitialStyles,s.style.position=w||"",s.style.top=S||"",s.style.left=A||"",s.style.width=z||"",s.style.height=L||""}}},g.default)}}})}function JT(e,o){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"in-out";return zt({name:e,props:{mode:{type:String,default:a}},setup(c,d){let{slots:g}=d;return()=>Ns(Fs,{name:e,...o},g.default)}})}function QT(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const a=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?"width":"height",c=Ro(`offset-${a}`);return{onBeforeEnter(_){_._parent=_.parentNode,_._initialStyle={transition:_.style.transition,overflow:_.style.overflow,[a]:_.style[a]}},onEnter(_){const s=_._initialStyle;_.style.setProperty("transition","none","important"),_.style.overflow="hidden";const w=`${_[c]}px`;_.style[a]="0",_.offsetHeight,_.style.transition=s.transition,e&&_._parent&&_._parent.classList.add(e),requestAnimationFrame(()=>{_.style[a]=w})},onAfterEnter:g,onEnterCancelled:g,onLeave(_){_._initialStyle={transition:"",overflow:_.style.overflow,[a]:_.style[a]},_.style.overflow="hidden",_.style[a]=`${_[c]}px`,_.offsetHeight,requestAnimationFrame(()=>_.style[a]="0")},onAfterLeave:d,onLeaveCancelled:d};function d(_){e&&_._parent&&_._parent.classList.remove(e),g(_)}function g(_){const s=_._initialStyle[a];_.style.overflow=_._initialStyle.overflow,s!=null&&(_.style[a]=s),delete _._initialStyle}}const Ng=zt({name:"VDialogTransition",props:{target:Object},setup(e,o){let{slots:a}=o;const c={onBeforeEnter(d){d.style.pointerEvents="none",d.style.visibility="hidden"},async onEnter(d,g){var _;await new Promise(R=>requestAnimationFrame(R)),await new Promise(R=>requestAnimationFrame(R)),d.style.visibility="";const{x:s,y:w,sx:S,sy:A,speed:z}=Kw(e.target,d),L=Tc(d,[{transform:`translate(${s}px, ${w}px) scale(${S}, ${A})`,opacity:0},{transform:""}],{duration:225*z,easing:TL});(_=Yw(d))==null||_.forEach(R=>{Tc(R,[{opacity:0},{opacity:0,offset:.33},{opacity:1}],{duration:225*2*z,easing:Mf})}),L.finished.then(()=>g())},onAfterEnter(d){d.style.removeProperty("pointer-events")},onBeforeLeave(d){d.style.pointerEvents="none"},async onLeave(d,g){var _;await new Promise(R=>requestAnimationFrame(R));const{x:s,y:w,sx:S,sy:A,speed:z}=Kw(e.target,d);Tc(d,[{transform:""},{transform:`translate(${s}px, ${w}px) scale(${S}, ${A})`,opacity:0}],{duration:125*z,easing:CL}).finished.then(()=>g()),(_=Yw(d))==null||_.forEach(R=>{Tc(R,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*z,easing:Mf})})},onAfterLeave(d){d.style.removeProperty("pointer-events")}};return()=>e.target?F(Fs,nn({name:"dialog-transition"},c,{css:!1}),a):F(Fs,{name:"dialog-transition"},a)}});function Yw(e){var o;const a=(o=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:o.children;return a&&[...a]}function Kw(e,o){const a=e.getBoundingClientRect(),c=g0(o),[d,g]=getComputedStyle(o).transformOrigin.split(" ").map(ne=>parseFloat(ne)),[_,s]=getComputedStyle(o).getPropertyValue("--v-overlay-anchor-origin").split(" ");let w=a.left+a.width/2;_==="left"||s==="left"?w-=a.width/2:(_==="right"||s==="right")&&(w+=a.width/2);let S=a.top+a.height/2;_==="top"||s==="top"?S-=a.height/2:(_==="bottom"||s==="bottom")&&(S+=a.height/2);const A=a.width/c.width,z=a.height/c.height,L=Math.max(1,A,z),R=A/L,$=z/L,Z=c.width*c.height/(window.innerWidth*window.innerHeight),de=Z>.12?Math.min(1.5,(Z-.12)*10+1):1;return{x:w-(d+c.left),y:S-(g+c.top),sx:R,sy:$,speed:de}}const AD=_o("fab-transition","center center","out-in"),kD=_o("dialog-bottom-transition"),MD=_o("dialog-top-transition"),_y=_o("fade-transition"),e2=_o("scale-transition"),PD=_o("scroll-x-transition"),zD=_o("scroll-x-reverse-transition"),LD=_o("scroll-y-transition"),DD=_o("scroll-y-reverse-transition"),RD=_o("slide-x-transition"),BD=_o("slide-x-reverse-transition"),z0=_o("slide-y-transition"),OD=_o("slide-y-reverse-transition"),$g=JT("expand-transition",QT()),L0=JT("expand-x-transition",QT("",!0));function FD(e){return{aspectStyles:ie(()=>{const o=Number(e.aspectRatio);return o?{paddingBottom:String(1/o*100)+"%"}:void 0})}}const t2=zt({name:"VResponsive",props:{aspectRatio:[String,Number],contentClass:String,...ss()},setup(e,o){let{slots:a}=o;const{aspectStyles:c}=FD(e),{dimensionStyles:d}=as(e);return Mt(()=>{var g;return F("div",{class:"v-responsive",style:d.value},[F("div",{class:"v-responsive__sizer",style:c.value},null),(g=a.additional)==null?void 0:g.call(a),a.default&&F("div",{class:["v-responsive__content",e.contentClass]},[a.default()])])}),{}}});function VD(e,o){if(!x0)return;const a=o.modifiers||{},c=o.value,{handler:d,options:g}=typeof c=="object"?c:{handler:c,options:{}},_=new IntersectionObserver(function(){var s;let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],S=arguments.length>1?arguments[1]:void 0;const A=(s=e._observe)==null?void 0:s[o.instance.$.uid];if(!A)return;const z=w.some(L=>L.isIntersecting);d&&(!a.quiet||A.init)&&(!a.once||z||A.init)&&d(z,w,S),z&&a.once?n2(e,o):A.init=!0},g);e._observe=Object(e._observe),e._observe[o.instance.$.uid]={init:!1,observer:_},_.observe(e)}function n2(e,o){var a;const c=(a=e._observe)==null?void 0:a[o.instance.$.uid];!c||(c.observer.unobserve(e),delete e._observe[o.instance.$.uid])}const i2={mounted:VD,unmounted:n2},Ug=i2,Ea=Pn({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:e=>e!==!0}},"transition"),Bs=(e,o)=>{let{slots:a}=o;const{transition:c,...d}=e,{component:g=Fs,..._}=typeof c=="object"?c:{};return Ns(g,nn(typeof c=="string"?{name:c}:_,d),a)},Eh=zt({name:"VImg",directives:{intersect:Ug},props:{aspectRatio:[String,Number],alt:String,cover:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},srcset:String,width:[String,Number],...Ea()},emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,o){let{emit:a,slots:c}=o;const d=Qe(""),g=Qe(),_=Qe(e.eager?"loading":"idle"),s=Qe(),w=Qe(),S=ie(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),A=ie(()=>S.value.aspect||s.value/w.value||0);Ye(()=>e.src,()=>{z(_.value!=="idle")}),Mg(()=>z());function z(fe){if(!(e.eager&&fe)&&!(x0&&!fe&&!e.eager)){if(_.value="loading",S.value.lazySrc){const ve=new Image;ve.src=S.value.lazySrc,Z(ve,null)}!S.value.src||Zi(()=>{var ve,Se;if(a("loadstart",((ve=g.value)==null?void 0:ve.currentSrc)||S.value.src),(Se=g.value)!=null&&Se.complete){if(g.value.naturalWidth||R(),_.value==="error")return;A.value||Z(g.value,null),L()}else A.value||Z(g.value),$()})}}function L(){var fe;$(),_.value="loaded",a("load",((fe=g.value)==null?void 0:fe.currentSrc)||S.value.src)}function R(){var fe;_.value="error",a("error",((fe=g.value)==null?void 0:fe.currentSrc)||S.value.src)}function $(){const fe=g.value;fe&&(d.value=fe.currentSrc||fe.src)}function Z(fe){let ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const Se=()=>{const{naturalHeight:be,naturalWidth:De}=fe;be||De?(s.value=De,w.value=be):!fe.complete&&_.value==="loading"&&ve!=null?setTimeout(Se,ve):(fe.currentSrc.endsWith(".svg")||fe.currentSrc.startsWith("data:image/svg+xml"))&&(s.value=1,w.value=1)};Se()}const de=ie(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),ne=()=>{var fe;if(!S.value.src||_.value==="idle")return null;const ve=F("img",{class:["v-img__img",de.value],src:S.value.src,srcset:S.value.srcset,alt:"",sizes:e.sizes,ref:g,onLoad:L,onError:R},null),Se=(fe=c.sources)==null?void 0:fe.call(c);return F(Bs,{transition:e.transition,appear:!0},{default:()=>[Wi(Se?F("picture",{class:"v-img__picture"},[Se,ve]):ve,[[$s,_.value==="loaded"]])]})},ce=()=>F(Bs,{transition:e.transition},{default:()=>[S.value.lazySrc&&_.value!=="loaded"&&F("img",{class:["v-img__img","v-img__img--preload",de.value],src:S.value.lazySrc,alt:""},null)]}),K=()=>c.placeholder?F(Bs,{transition:e.transition,appear:!0},{default:()=>[(_.value==="loading"||_.value==="error"&&!c.error)&&F("div",{class:"v-img__placeholder"},[c.placeholder()])]}):null,Ee=()=>c.error?F(Bs,{transition:e.transition,appear:!0},{default:()=>[_.value==="error"&&F("div",{class:"v-img__error"},[c.error()])]}):null,Y=()=>e.gradient?F("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,_e=Qe(!1);{const fe=Ye(A,ve=>{ve&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{_e.value=!0})}),fe())})}return Mt(()=>Wi(F(t2,{class:["v-img",{"v-img--booting":!_e.value}],style:{width:Yt(e.width==="auto"?s.value:e.width)},aspectRatio:A.value,"aria-label":e.alt,role:e.alt?"img":void 0},{additional:()=>F(On,null,[F(ne,null,null),F(ce,null,null),F(Y,null,null),F(K,null,null),F(Ee,null,null)]),default:c.default}),[[mo("intersect"),{handler:z,options:e.options},null,{once:!0}]])),{currentSrc:d,image:g,state:_,naturalWidth:s,naturalHeight:w}}}),gg=Li()({name:"VToolbarTitle",props:{text:String,...Sn()},setup(e,o){let{slots:a}=o;return Mt(()=>{var c;const d=!!(a.default||a.text||e.text);return F(e.tag,{class:"v-toolbar-title"},{default:()=>[d&&F("div",{class:"v-toolbar-title__placeholder"},[a.text?a.text():e.text,(c=a.default)==null?void 0:c.call(a)])]})}),{}}}),ND=[null,"prominent","default","comfortable","compact"],r2=Pn({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:e=>ND.includes(e)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...vo(),...lr(),...Di(),...Sn({tag:"header"}),...Kn()},"v-toolbar"),vg=Li()({name:"VToolbar",props:r2(),setup(e,o){var a;let{slots:c}=o;const{backgroundColorClasses:d,backgroundColorStyles:g}=Qi(St(e,"color")),{borderClasses:_}=Fo(e),{elevationClasses:s}=Pr(e),{roundedClasses:w}=er(e),{themeClasses:S}=wi(e),A=Qe(!!(e.extended||(a=c.extension)!=null&&a.call(c))),z=ie(()=>parseInt(Number(e.height)+(e.density==="prominent"?Number(e.height):0)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0),10)),L=ie(()=>A.value?parseInt(Number(e.extensionHeight)+(e.density==="prominent"?Number(e.extensionHeight):0)-(e.density==="comfortable"?4:0)-(e.density==="compact"?8:0),10):0);return sr({VBtn:{variant:"text"}}),Mt(()=>{var R,$,Z,de,ne;const ce=!!(e.title||c.title),K=!!(c.image||e.image),Ee=(R=c.extension)==null?void 0:R.call(c);return A.value=!!(e.extended||Ee),F(e.tag,{class:["v-toolbar",{"v-toolbar--absolute":e.absolute,"v-toolbar--collapse":e.collapse,"v-toolbar--flat":e.flat,"v-toolbar--floating":e.floating,[`v-toolbar--density-${e.density}`]:!0},d.value,_.value,s.value,w.value,S.value],style:[g.value]},{default:()=>[K&&F("div",{key:"image",class:"v-toolbar__image"},[F(Ti,{defaults:{VImg:{cover:!0,src:e.image}}},{default:()=>[c.image?($=c.image)==null?void 0:$.call(c):F(Eh,null,null)]})]),F("div",{class:"v-toolbar__content",style:{height:Yt(z.value)}},[c.prepend&&F("div",{class:"v-toolbar__prepend"},[(Z=c.prepend)==null?void 0:Z.call(c)]),ce&&F(gg,{key:"title",text:e.title},{text:c.title}),(de=c.default)==null?void 0:de.call(c),c.append&&F("div",{class:"v-toolbar__append"},[(ne=c.append)==null?void 0:ne.call(c)])]),F($g,null,{default:()=>[A.value&&F("div",{class:"v-toolbar__extension",style:{height:Yt(L.value)}},[Ee])]})]})}),{contentHeight:z,extensionHeight:L}}});function $D(e){var o;return Bo(e,Object.keys((o=vg==null?void 0:vg.props)!=null?o:{}))}const o2=zt({name:"VAppBar",props:{modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...r2(),...vh(),height:{type:[Number,String],default:64}},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=Qe(),d=En(e,"modelValue"),g=ie(()=>{var z,L;var s,w;const S=(z=(s=c.value)==null?void 0:s.contentHeight)!=null?z:0,A=(L=(w=c.value)==null?void 0:w.extensionHeight)!=null?L:0;return S+A}),{layoutItemStyles:_}=_h({id:e.name,order:ie(()=>parseInt(e.order,10)),position:St(e,"location"),layoutSize:g,elementSize:g,active:d,absolute:St(e,"absolute")});return Mt(()=>{const[s]=$D(e);return F(vg,nn({ref:c,class:["v-app-bar",{"v-app-bar--bottom":e.location==="bottom"}],style:{..._.value,height:void 0}},s),a)}),{}}}),UD=zt({name:"VAppBarNavIcon",props:{icon:{type:mn,default:"$menu"}},setup(e,o){let{slots:a}=o;return Mt(()=>F(Fi,{class:"v-app-bar-nav-icon",icon:e.icon},a)),{}}}),jD=zt({name:"VToolbarItems",props:Vo({variant:"text"}),setup(e,o){let{slots:a}=o;return sr({VBtn:{color:St(e,"color"),height:"inherit",variant:St(e,"variant")}}),Mt(()=>{var c;return F("div",{class:"v-toolbar-items"},[(c=a.default)==null?void 0:c.call(a)])}),{}}}),GD=zt({name:"VAppBarTitle",props:{...gg.props},setup(e,o){let{slots:a}=o;return Mt(()=>F(gg,{class:"v-app-bar-title"},a)),{}}}),qD={};function ZD(e,o){return bi(),jr(o2,{color:"primary",elevation:"0",height:"30"})}const WD=wa(qD,[["render",ZD]]);const s2=zt({name:"VLayout",props:ET(),setup(e,o){let{slots:a}=o;const{layoutClasses:c,layoutStyles:d,getLayoutItem:g,items:_,layoutRef:s}=ST(e);return Mt(()=>{var w;return F("div",{ref:s,class:c.value,style:d.value},[(w=a.default)==null?void 0:w.call(a)])}),{getLayoutItem:g,items:_}}});const HD=zt({name:"VLayoutItem",props:{position:{type:String,required:!0},size:{type:[Number,String],default:300},modelValue:Boolean,...vh()},setup(e,o){let{slots:a}=o;const{layoutItemStyles:c}=_h({id:e.name,order:ie(()=>parseInt(e.order,10)),position:St(e,"position"),elementSize:St(e,"size"),layoutSize:St(e,"size"),active:St(e,"modelValue"),absolute:St(e,"absolute")});return()=>{var d;return F("div",{class:["v-layout-item"],style:c.value},[(d=a.default)==null?void 0:d.call(a)])}}});function D0(){const e=Qe(!1);return Fn(()=>{window.requestAnimationFrame(()=>{e.value=!0})}),{ssrBootStyles:ie(()=>e.value?void 0:{transition:"none !important"}),isBooted:$f(e)}}const a2=zt({name:"VMain",props:{scrollable:Boolean,...Sn({tag:"main"})},setup(e,o){let{slots:a}=o;const{mainStyles:c}=zL(),{ssrBootStyles:d}=D0();return Mt(()=>{var g,_;return F(e.tag,{class:["v-main",{"v-main--scrollable":e.scrollable}],style:[c.value,d.value]},{default:()=>[e.scrollable?F("div",{class:"v-main__scroller"},[(g=a.default)==null?void 0:g.call(a)]):(_=a.default)==null?void 0:_.call(a)]})}),{}}}),XD=gn({__name:"MainLayout",setup(e){return(o,a)=>{const c=Os("router-view");return bi(),jr(s2,null,{default:fi(()=>[F(a2,null,{default:fi(()=>[F(WD),F(c,{class:"map",name:"main_view"}),F(ID),F(c,{class:"draw",name:"left_draw"})]),_:1})]),_:1})}}});const YD=wa(XD,[["__scopeId","data-v-9dfdefde"]]),KD={components:{MainLayout:YD}};function JD(e,o,a,c,d,g){const _=Os("MainLayout");return bi(),jr(_)}const QD=wa(KD,[["render",JD],["__scopeId","data-v-2cc332ae"]]);var eR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l2={exports:{}};(function(e,o){(function(a,c){e.exports=c()})(eR,function(){var a,c,d;function g(s,w){if(!a)a=w;else if(!c)c=w;else{var S="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+c+")(sharedChunk); self.onerror = null;",A={};a(A),d=w(A),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([S],{type:"text/javascript"})))}}g(["exports"],function(s){var w=typeof self<"u"?self:{},S="2.13.0";let A;const z={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(A==null){const n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{A={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):n}catch{A=n}}return A},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},L={supported:!1,testSupport:function(n){!Z&&$&&(de?ne(n):R=n)}};let R,$,Z=!1,de=!1;function ne(n){const t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,$),n.isContextLost())return;L.supported=!0}catch{}n.deleteTexture(t),Z=!0}w.document&&($=w.document.createElement("img"),$.onload=function(){R&&ne(R),R=null,de=!0},$.onerror=function(){Z=!0,R=null},$.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ce="01";var K=Ee;function Ee(n,t,i,l){this.cx=3*n,this.bx=3*(i-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=t,this.p2x=i,this.p2y=l}Ee.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,t){if(t===void 0&&(t=1e-6),n<0)return 0;if(n>1)return 1;for(var i=n,l=0;l<8;l++){var h=this.sampleCurveX(i)-n;if(Math.abs(h)<t)return i;var p=this.sampleCurveDerivativeX(i);if(Math.abs(p)<1e-6)break;i-=h/p}var v=0,x=1;for(i=n,l=0;l<20&&(h=this.sampleCurveX(i),!(Math.abs(h-n)<t));l++)n>h?v=i:x=i,i=.5*(x-v)+v;return i},solve:function(n,t){return this.sampleCurveY(this.solveCurveX(n,t))}};var Y=_e;function _e(n,t){this.x=n,this.y=t}_e.prototype={clone:function(){return new _e(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,t){return this.clone()._rotateAround(n,t)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var t=n.x-this.x,i=n.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,t){return Math.atan2(this.x*t-this.y*n,this.x*n+this.y*t)},_matMult:function(n){var t=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=t,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var t=Math.cos(n),i=Math.sin(n),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(n,t){var i=Math.cos(n),l=Math.sin(n),h=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},_e.convert=function(n){return n instanceof _e?n:Array.isArray(n)?new _e(n[0],n[1]):n};const fe=Math.PI/180,ve=180/Math.PI;function Se(n){return n*fe}function be(n){return n*ve}const De=[[0,0],[1,0],[1,1],[0,1]];function ze(n){if(n<=0)return 0;if(n>=1)return 1;const t=n*n,i=t*n;return 4*(n<.5?i:3*(n-t)+i-.75)}function Ke(n,t,i,l){const h=new K(n,t,i,l);return function(p){return h.solve(p)}}const ct=Ke(.25,.1,.25,1);function nt(n,t,i){return Math.min(i,Math.max(t,n))}function ft(n,t,i){return(i=nt((i-n)/(t-n),0,1))*i*(3-2*i)}function Pe(n,t,i){const l=i-t,h=((n-t)%l+l)%l+t;return h===t?i:h}function at(n,t,i){if(!n.length)return i(null,[]);let l=n.length;const h=new Array(n.length);let p=null;n.forEach((v,x)=>{t(v,(E,T)=>{E&&(p=E),h[x]=T,--l==0&&i(p,h)})})}function Gt(n){const t=[];for(const i in n)t.push(n[i]);return t}function pt(n,...t){for(const i of t)for(const l in i)n[l]=i[l];return n}let Lt=1;function qt(){return Lt++}function Ln(){return function n(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,n)}()}function kt(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Je(n){return!!n&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)}function bt(n,t){n.forEach(i=>{t[i]&&(t[i]=t[i].bind(t))})}function Tt(n,t){return n.indexOf(t,n.length-t.length)!==-1}function Ut(n,t,i){const l={};for(const h in n)l[h]=t.call(i||this,n[h],h,n);return l}function pn(n,t,i){const l={};for(const h in n)t.call(i||this,n[h],h,n)&&(l[h]=n[h]);return l}function Dn(n){return Array.isArray(n)?n.map(Dn):typeof n=="object"&&n?Ut(n,Dn):n}const _n={};function he(n){_n[n]||(typeof console<"u"&&console.warn(n),_n[n]=!0)}function Me(n,t,i){return(i.y-n.y)*(t.x-n.x)>(t.y-n.y)*(i.x-n.x)}function qe(n){let t=0;for(let i,l,h=0,p=n.length,v=p-1;h<p;v=h++)i=n[h],l=n[v],t+=(l.x-i.x)*(i.y+l.y);return t}function st(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function yt(n){const t={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,l,h,p)=>{const v=h||p;return t[l]=!v||v.toLowerCase(),""}),t["max-age"]){const i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}let Dt=null;function Nt(n){if(Dt==null){const t=n.navigator?n.navigator.userAgent:null;Dt=!!n.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Dt}function Pt(n){try{const t=w[n];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ft(n,t){return[n[4*t],n[4*t+1],n[4*t+2],n[4*t+3]]}const Et="mapbox-tiles";let Jt,Wt,on=500,fn=50;function Tn(){try{return w.caches}catch{}}function jn(){Tn()&&!Jt&&(Jt=w.caches.open(Et))}function Gn(n){const t=n.indexOf("?");if(t<0)return n;const i=function(h){const p=h.indexOf("?");return p>0?h.slice(p+1).split("&"):[]}(n),l=i.filter(h=>{const p=h.split("=");return p[0]==="language"||p[0]==="worldview"});return l.length?`${n.slice(0,t)}?${l.join("&")}`:n.slice(0,t)}let vi=1/0;const rr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(rr);class Hi extends Error{constructor(t,i,l){i===401&&qs(l)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=i,this.url=l}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const us=st()?()=>self.worker&&self.worker.referrer:()=>(w.location.protocol==="blob:"?w.parent:w).location.href,zr=function(n,t){if(!(/^file:/.test(i=n.url)||/^file:/.test(us())&&!/^\w+:/.test(i))){if(w.fetch&&w.Request&&w.AbortController&&w.Request.prototype.hasOwnProperty("signal"))return function(l,h){const p=new w.AbortController,v=new w.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:us(),signal:p.signal});let x=!1,E=!1;const T=(k=v.url).indexOf("sku=")>0&&qs(k);var k;l.type==="json"&&v.headers.set("Accept","application/json");const P=(V,N,G)=>{if(E)return;if(V&&V.message!=="SecurityError"&&he(V),N&&G)return D(N);const X=Date.now();w.fetch(v).then(le=>{if(le.ok){const ye=T?le.clone():null;return D(le,ye,X)}return h(new Hi(le.statusText,le.status,l.url))}).catch(le=>{le.name!=="AbortError"&&h(new Error(`${le.message} ${l.url}`))})},D=(V,N,G)=>{(l.type==="arrayBuffer"?V.arrayBuffer():l.type==="json"?V.json():V.text()).then(X=>{E||(N&&G&&function(le,ye,re){if(jn(),!Jt)return;const ge={status:ye.status,statusText:ye.statusText,headers:new w.Headers};ye.headers.forEach((je,Ne)=>ge.headers.set(Ne,je));const Te=yt(ye.headers.get("Cache-Control")||"");if(Te["no-store"])return;Te["max-age"]&&ge.headers.set("Expires",new Date(re+1e3*Te["max-age"]).toUTCString());const xe=ge.headers.get("Expires");xe&&(new Date(xe).getTime()-re<42e4||function(je,Ne){if(Wt===void 0)try{new Response(new ReadableStream),Wt=!0}catch{Wt=!1}Wt?Ne(je.body):je.blob().then(Ne)}(ye,je=>{const Ne=new w.Response(je,ge);jn(),Jt&&Jt.then(tt=>tt.put(Gn(le.url),Ne)).catch(tt=>he(tt.message))}))}(v,N,G),x=!0,h(null,X,V.headers.get("Cache-Control"),V.headers.get("Expires")))}).catch(X=>{E||h(new Error(X.message))})};return T?function(V,N){if(jn(),!Jt)return N(null);const G=Gn(V.url);Jt.then(X=>{X.match(G).then(le=>{const ye=function(re){if(!re)return!1;const ge=new Date(re.headers.get("Expires")||0),Te=yt(re.headers.get("Cache-Control")||"");return ge>Date.now()&&!Te["no-cache"]}(le);X.delete(G),ye&&X.put(G,le.clone()),N(null,le,ye)}).catch(N)}).catch(N)}(v,P):P(null,null),{cancel:()=>{E=!0,x||p.abort()}}}(n,t);if(st()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,t,void 0,!0)}var i;return function(l,h){const p=new w.XMLHttpRequest;p.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(p.responseType="arraybuffer");for(const v in l.headers)p.setRequestHeader(v,l.headers[v]);return l.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=l.credentials==="include",p.onerror=()=>{h(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){let v=p.response;if(l.type==="json")try{v=JSON.parse(p.response)}catch(x){return h(x)}h(null,v,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else h(new Hi(p.statusText,p.status,l.url))},p.send(l.body),{cancel:()=>p.abort()}}(n,t)},yo=function(n,t){return zr(pt(n,{type:"arrayBuffer"}),t)};function tr(n){const t=w.document.createElement("a");return t.href=n,t.protocol===w.document.location.protocol&&t.host===w.document.location.host}const cr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let $o,js;$o=[],js=0;const El=function(n,t){if(L.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),js>=z.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:n,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return $o.push(p),p}js++;let i=!1;const l=()=>{if(!i)for(i=!0,js--;$o.length&&js<z.MAX_PARALLEL_IMAGE_REQUESTS;){const p=$o.shift(),{requestParameters:v,callback:x,cancelled:E}=p;E||(p.cancel=El(v,x).cancel)}},h=yo(n,(p,v,x,E)=>{l(),p?t(p):v&&(w.createImageBitmap?function(T,k){const P=new w.Blob([new Uint8Array(T)],{type:"image/png"});w.createImageBitmap(P).then(D=>{k(null,D)}).catch(D=>{k(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(T,k)=>t(T,k,x,E)):function(T,k){const P=new w.Image,D=w.URL;P.onload=()=>{k(null,P),D.revokeObjectURL(P.src),P.onload=null,w.requestAnimationFrame(()=>{P.src=cr})},P.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const V=new w.Blob([new Uint8Array(T)],{type:"image/png"});P.src=T.byteLength?D.createObjectURL(V):cr}(v,(T,k)=>t(T,k,x,E)))});return{cancel:()=>{h.cancel(),l()}}},Gs="NO_ACCESS_TOKEN";function ao(n){return n.indexOf("mapbox:")===0}function qs(n){return z.API_URL_REGEX.test(n)}function qc(n){return z.API_CDN_URL_REGEX.test(n)}function Zc(n){return z.API_STYLE_REGEX.test(n)&&!Aa(n)}function Aa(n){return z.API_SPRITE_REGEX.test(n)}const Zs=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Zr(n){const t=n.match(Zs);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function hs(n){const t=n.params.length?`?${n.params.join("&")}`:"";return`${n.protocol}://${n.authority}${n.path}${t}`}function Wc(n){if(!n)return null;const t=n.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(w.atob(t[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ws{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const i=Wc(z.ACCESS_TOKEN);let l="";return l=i&&i.u?w.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(h,p)=>String.fromCharCode(Number("0x"+p)))):z.ACCESS_TOKEN||"",t?`mapbox.eventData.${t}:${l}`:`mapbox.eventData:${l}`}fetchEventData(){const t=Pt("localStorage"),i=this.getStorageKey(),l=this.getStorageKey("uuid");if(t)try{const h=w.localStorage.getItem(i);h&&(this.eventData=JSON.parse(h));const p=w.localStorage.getItem(l);p&&(this.anonId=p)}catch{he("Unable to read from LocalStorage")}}saveEventData(){const t=Pt("localStorage"),i=this.getStorageKey(),l=this.getStorageKey("uuid");if(t)try{w.localStorage.setItem(l,this.anonId),Object.keys(this.eventData).length>=1&&w.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{he("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,i,l,h){if(!z.EVENTS_URL)return;const p=Zr(z.EVENTS_URL);p.params.push(`access_token=${h||z.ACCESS_TOKEN||""}`);const v={event:this.type,created:new Date(t).toISOString()},x=i?pt(v,i):v,E={url:hs(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([x])};this.pendingRequest=function(T,k){return zr(pt(T,{method:"POST"}),k)}(E,T=>{this.pendingRequest=null,l(T),this.saveEventData(),this.processRequests(h)})}queueRequest(t,i){this.queue.push(t),this.processRequests(i)}}const se=new class extends Ws{constructor(n){super("appUserTurnstile"),this._customAccessToken=n}postTurnstileEvent(n,t){z.EVENTS_URL&&z.ACCESS_TOKEN&&Array.isArray(n)&&n.some(i=>ao(i)||qs(i))&&this.queueRequest(Date.now(),t)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Wc(z.ACCESS_TOKEN),i=t?t.u:z.ACCESS_TOKEN;let l=i!==this.eventData.tokenU;Je(this.anonId)||(this.anonId=Ln(),l=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),v=new Date(h),x=(h-this.eventData.lastSuccess)/864e5;l=l||x>=1||x<-1||p.getDate()!==v.getDate()}else l=!0;l?this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:S,skuId:ce,"enabled.telemetry":!1,userId:this.anonId},p=>{p||(this.eventData.lastSuccess=h,this.eventData.tokenU=i)},n):this.processRequests()}},U=se.postTurnstileEvent.bind(se),q=new class extends Ws{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(n,t,i,l){this.skuToken=t,this.errorCb=l,z.EVENTS_URL&&(i||z.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Gs)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),Je(this.anonId)||(this.anonId=Ln()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:S,skuId:ce,skuToken:this.skuToken,userId:this.anonId},l=>{l?this.errorCb(l):t&&(this.success[t]=!0)},n))}},oe=q.postMapLoadEvent.bind(q),me=new class extends Ws{constructor(){super("gljs.performance")}postPerformanceEvent(n,t){z.EVENTS_URL&&(n||z.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},n)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:i}=this.queue.shift(),l=function(h){const p=w.performance.getEntriesByType("resource"),v=w.performance.getEntriesByType("mark"),x=function(D){const V={};if(D){for(const N in D)if(N!=="other")for(const G of D[N]){const X=`${N}ResolveRangeMin`,le=`${N}ResolveRangeMax`,ye=`${N}RequestCount`,re=`${N}RequestCachedCount`;V[X]=Math.min(V[X]||1/0,G.startTime),V[le]=Math.max(V[le]||-1/0,G.responseEnd);const ge=Te=>{V[Te]===void 0&&(V[Te]=0),++V[Te]};G.transferSize!==void 0&&G.transferSize===0&&ge(re),ge(ye)}}return V}(function(D,V){const N={};if(D)for(const G of D){const X=V(G);N[X]===void 0&&(N[X]=[]),N[X].push(G)}return N}(p,Bt)),E=w.devicePixelRatio,T=w.navigator.connection||w.navigator.mozConnection||w.navigator.webkitConnection,k={counters:[],metadata:[],attributes:[]},P=(D,V,N)=>{N!=null&&D.push({name:V,value:N.toString()})};for(const D in x)P(k.counters,D,x[D]);if(h.interactionRange[0]!==1/0&&h.interactionRange[1]!==-1/0&&(P(k.counters,"interactionRangeMin",h.interactionRange[0]),P(k.counters,"interactionRangeMax",h.interactionRange[1])),v)for(const D of Object.keys(Ve)){const V=Ve[D],N=v.find(G=>G.name===V);N&&P(k.counters,V,N.startTime)}return P(k.counters,"visibilityHidden",h.visibilityHidden),P(k.attributes,"style",function(D){if(D)for(const V of D){const N=V.name.split("?")[0];if(Zc(N)){const G=N.split("/").slice(-2);if(G.length===2)return`mapbox://styles/${G[0]}/${G[1]}`}}}(p)),P(k.attributes,"terrainEnabled",h.terrainEnabled?"true":"false"),P(k.attributes,"fogEnabled",h.fogEnabled?"true":"false"),P(k.attributes,"projection",h.projection),P(k.attributes,"zoom",h.zoom),P(k.metadata,"devicePixelRatio",E),P(k.metadata,"connectionEffectiveType",T?T.effectiveType:void 0),P(k.metadata,"navigatorUserAgent",w.navigator.userAgent),P(k.metadata,"screenWidth",w.screen.width),P(k.metadata,"screenHeight",w.screen.height),P(k.metadata,"windowWidth",w.innerWidth),P(k.metadata,"windowHeight",w.innerHeight),P(k.metadata,"mapWidth",h.width/E),P(k.metadata,"mapHeight",h.height/E),P(k.metadata,"webglRenderer",h.renderer),P(k.metadata,"webglVendor",h.vendor),P(k.metadata,"sdkVersion",S),P(k.metadata,"sdkIdentifier","mapbox-gl-js"),k}(i);for(const h of l.metadata);for(const h of l.counters);for(const h of l.attributes);this.postEvent(t,l,()=>{},n)}},Ie=me.postPerformanceEvent.bind(me),Oe=new class extends Ws{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(n,t,i,l){if(!z.API_URL||!z.SESSION_PATH)return;const h=Zr(z.API_URL+z.SESSION_PATH);h.params.push(`sku=${t||""}`),h.params.push(`access_token=${l||z.ACCESS_TOKEN||""}`);const p={url:hs(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(v,x){return zr(pt(v,{method:"GET"}),x)}(p,v=>{this.pendingRequest=null,i(v),this.saveEventData(),this.processRequests(l)})}getSessionAPI(n,t,i,l){this.skuToken=t,this.errorCb=l,z.SESSION_PATH&&z.API_URL&&(i||z.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Gs)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||this.getSession(i,this.skuToken,l=>{l?this.errorCb(l):t&&(this.success[t]=!0)},n)}},Re=Oe.getSessionAPI.bind(Oe),ke=new Set,Ve={create:"create",load:"load",fullLoad:"fullLoad"},ut={mark(n){w.performance.mark(n)},measure(n,t,i){w.performance.measure(n,t,i)}};function Bt(n){const t=n.name.split("?")[0];return qc(t)&&t.includes("mapbox-gl.js")?"javascript":qc(t)&&t.includes("mapbox-gl.css")?"css":function(i){return z.API_FONTS_REGEX.test(i)}(t)?"fontRange":Aa(t)?"sprite":Zc(t)?"style":function(i){return z.API_TILEJSON_REGEX.test(i)}(t)?"tilejson":"other"}const gt=w.performance;function tn(n){const t=n?n.url.toString():void 0;return gt.getEntriesByName(t)}let Qt,Kt,un,yn;const qn={now:()=>un!==void 0?un:w.performance.now(),setNow(n){un=n},restoreNow(){un=void 0},frame(n){const t=w.requestAnimationFrame(n);return{cancel:()=>w.cancelAnimationFrame(t)}},getImageData(n,t=0){const{width:i,height:l}=n;yn||(yn=w.document.createElement("canvas"));const h=yn.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return(i>yn.width||l>yn.height)&&(yn.width=i,yn.height=l),h.clearRect(-t,-t,i+2*t,l+2*t),h.drawImage(n,0,0,i,l),h.getImageData(-t,-t,i+2*t,l+2*t)},resolveURL:n=>(Qt||(Qt=w.document.createElement("a")),Qt.href=n,Qt.href),get devicePixelRatio(){return w.devicePixelRatio},get prefersReducedMotion(){return!!w.matchMedia&&(Kt==null&&(Kt=w.matchMedia("(prefers-reduced-motion: reduce)")),Kt.matches)}};function sn(n,t,i){i[n]&&i[n].indexOf(t)!==-1||(i[n]=i[n]||[],i[n].push(t))}function ei(n,t,i){if(i&&i[n]){const l=i[n].indexOf(t);l!==-1&&i[n].splice(l,1)}}class ti{constructor(t,i={}){pt(this,i),this.type=t}}class ds extends ti{constructor(t,i={}){super("error",pt({error:t},i))}}class Uo{on(t,i){return this._listeners=this._listeners||{},sn(t,i,this._listeners),this}off(t,i){return ei(t,i,this._listeners),ei(t,i,this._oneTimeListeners),this}once(t,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},sn(t,i,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,i){typeof t=="string"&&(t=new ti(t,i||{}));const l=t.type;if(this.listens(l)){t.target=this;const h=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const x of h)x.call(this,t);const p=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const x of p)ei(l,x,this._oneTimeListeners),x.call(this,t);const v=this._eventedParent;v&&(pt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(t))}else t instanceof ds&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,i){return this._eventedParent=t,this._eventedParentData=i,this}}var et=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function jo(n,...t){for(const i of t)for(const l in i)n[l]=i[l];return n}function Vi(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function fs(n){if(Array.isArray(n))return n.map(fs);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const t={};for(const i in n)t[i]=fs(n[i]);return t}return Vi(n)}class Qf extends Error{constructor(t,i){super(i),this.message=i,this.key=t}}var xo=Qf;class ka{constructor(t,i=[]){this.parent=t,this.bindings={};for(const[l,h]of i)this.bindings[l]=h}concat(t){return new ka(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var ep=ka;const Ma={kind:"null"},Ct={kind:"number"},zn={kind:"string"},Cn={kind:"boolean"},bo={kind:"color"},Hs={kind:"object"},bn={kind:"value"},Sl={kind:"collator"},Pa={kind:"formatted"},za={kind:"resolvedImage"};function Ir(n,t){return{kind:"array",itemType:n,N:t}}function ci(n){if(n.kind==="array"){const t=ci(n.itemType);return typeof n.N=="number"?`array<${t}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${t}>`}return n.kind}const tp=[Ma,Ct,zn,Cn,bo,Pa,Hs,Ir(bn),za];function Lr(n,t){if(t.kind==="error")return null;if(n.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Lr(n.itemType,t.itemType))&&(typeof n.N!="number"||n.N===t.N))return null}else{if(n.kind===t.kind)return null;if(n.kind==="value"){for(const i of tp)if(!Lr(i,t))return null}}return`Expected ${ci(n)} but found ${ci(t)} instead.`}function kh(n,t){return t.some(i=>i.kind===n.kind)}function Xs(n,t){return t.some(i=>i==="null"?n===null:i==="array"?Array.isArray(n):i==="object"?n&&!Array.isArray(n)&&typeof n=="object":i===typeof n)}var Mh,Hc={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Tl(n){return(n=Math.round(n))<0?0:n>255?255:n}function Ys(n){return Tl(n[n.length-1]==="%"?parseFloat(n)/100*255:parseInt(n))}function La(n){return(t=n[n.length-1]==="%"?parseFloat(n)/100:parseFloat(n))<0?0:t>1?1:t;var t}function Ph(n,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?n+(t-n)*i*6:2*i<1?t:3*i<2?n+(t-n)*(2/3-i)*6:n}try{Mh={}.parseCSSColor=function(n){var t,i=n.replace(/ /g,"").toLowerCase();if(i in Hc)return Hc[i].slice();if(i[0]==="#")return i.length===4?(t=parseInt(i.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:i.length===7&&(t=parseInt(i.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var l=i.indexOf("("),h=i.indexOf(")");if(l!==-1&&h+1===i.length){var p=i.substr(0,l),v=i.substr(l+1,h-(l+1)).split(","),x=1;switch(p){case"rgba":if(v.length!==4)return null;x=La(v.pop());case"rgb":return v.length!==3?null:[Ys(v[0]),Ys(v[1]),Ys(v[2]),x];case"hsla":if(v.length!==4)return null;x=La(v.pop());case"hsl":if(v.length!==3)return null;var E=(parseFloat(v[0])%360+360)%360/360,T=La(v[1]),k=La(v[2]),P=k<=.5?k*(T+1):k+T-k*T,D=2*k-P;return[Tl(255*Ph(D,P,E+1/3)),Tl(255*Ph(D,P,E)),Tl(255*Ph(D,P,E-1/3)),x];default:return null}}return null}}catch{}class Dr{constructor(t,i,l,h=1){this.r=t,this.g=i,this.b=l,this.a=h}static parse(t){if(!t)return;if(t instanceof Dr)return t;if(typeof t!="string")return;const i=Mh(t);return i?new Dr(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[t,i,l,h]=this.toArray();return`rgba(${Math.round(t)},${Math.round(i)},${Math.round(l)},${h})`}toArray(){const{r:t,g:i,b:l,a:h}=this;return h===0?[0,0,0,0]:[255*t/h,255*i/h,255*l/h,h]}toArray01(){const{r:t,g:i,b:l,a:h}=this;return h===0?[0,0,0,0]:[t/h,i/h,l/h,h]}toArray01PremultipliedAlpha(){const{r:t,g:i,b:l,a:h}=this;return[t,i,l,h]}}Dr.black=new Dr(0,0,0,1),Dr.white=new Dr(1,1,1,1),Dr.transparent=new Dr(0,0,0,0),Dr.red=new Dr(1,0,0,1),Dr.blue=new Dr(0,0,1,1);var Ri=Dr;class Xc{constructor(t,i,l){this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,i){return this.collator.compare(t,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Cl{constructor(t,i,l,h,p){this.text=t.normalize?t.normalize():t,this.image=i,this.scale=l,this.fontStack=h,this.textColor=p}}class Rr{constructor(t){this.sections=t}static fromString(t){return new Rr([new Cl(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Rr?t:Rr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const i of this.sections){if(i.image){t.push(["image",i.image.name]);continue}t.push(i.text);const l={};i.fontStack&&(l["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(l["font-scale"]=i.scale),i.textColor&&(l["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(l)}return t}}class Ar{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Ar({name:t,available:!1}):null}serialize(){return["image",this.name]}}function np(n,t,i,l){return typeof n=="number"&&n>=0&&n<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[n,t,i,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[n,t,i,l]:[n,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Yc(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Ri||n instanceof Xc||n instanceof Rr||n instanceof Ar)return!0;if(Array.isArray(n)){for(const t of n)if(!Yc(t))return!1;return!0}if(typeof n=="object"){for(const t in n)if(!Yc(n[t]))return!1;return!0}return!1}function Xi(n){if(n===null)return Ma;if(typeof n=="string")return zn;if(typeof n=="boolean")return Cn;if(typeof n=="number")return Ct;if(n instanceof Ri)return bo;if(n instanceof Xc)return Sl;if(n instanceof Rr)return Pa;if(n instanceof Ar)return za;if(Array.isArray(n)){const t=n.length;let i;for(const l of n){const h=Xi(l);if(i){if(i===h)continue;i=bn;break}i=h}return Ir(i||bn,t)}return Hs}function Il(n){const t=typeof n;return n===null?"":t==="string"||t==="number"||t==="boolean"?String(n):n instanceof Ri||n instanceof Rr||n instanceof Ar?n.toString():JSON.stringify(n)}class zh{constructor(t,i){this.type=t,this.value=i}static parse(t,i){if(t.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Yc(t[1]))return i.error("invalid value");const l=t[1];let h=Xi(l);const p=i.expectedType;return h.kind!=="array"||h.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(h=p),new zh(h,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ri?["rgba"].concat(this.value.toArray()):this.value instanceof Rr?this.value.serialize():this.value}}var Al=zh,ur=class{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}};const Kc={string:zn,number:Ct,boolean:Cn,object:Hs};class Da{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let l,h=1;const p=t[0];if(p==="array"){let x,E;if(t.length>2){const T=t[1];if(typeof T!="string"||!(T in Kc)||T==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);x=Kc[T],h++}else x=bn;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);E=t[2],h++}l=Ir(x,E)}else l=Kc[p];const v=[];for(;h<t.length;h++){const x=i.parse(t[h],h,bn);if(!x)return null;v.push(x)}return new Da(l,v)}evaluate(t){for(let i=0;i<this.args.length;i++){const l=this.args[i].evaluate(t);if(!Lr(this.type,Xi(l)))return l;if(i===this.args.length-1)throw new ur(`Expected value to be of type ${ci(this.type)}, but found ${ci(Xi(l))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,i=[t.kind];if(t.kind==="array"){const l=t.itemType;if(l.kind==="string"||l.kind==="number"||l.kind==="boolean"){i.push(l.kind);const h=t.N;(typeof h=="number"||this.args.length>1)&&i.push(h)}}return i.concat(this.args.map(l=>l.serialize()))}}var Go=Da;class kl{constructor(t){this.type=Pa,this.sections=t}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return i.error("First argument must be an image or text section.");const h=[];let p=!1;for(let v=1;v<=t.length-1;++v){const x=t[v];if(p&&typeof x=="object"&&!Array.isArray(x)){p=!1;let E=null;if(x["font-scale"]&&(E=i.parse(x["font-scale"],1,Ct),!E))return null;let T=null;if(x["text-font"]&&(T=i.parse(x["text-font"],1,Ir(zn)),!T))return null;let k=null;if(x["text-color"]&&(k=i.parse(x["text-color"],1,bo),!k))return null;const P=h[h.length-1];P.scale=E,P.font=T,P.textColor=k}else{const E=i.parse(t[v],1,bn);if(!E)return null;const T=E.type.kind;if(T!=="string"&&T!=="value"&&T!=="null"&&T!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,h.push({content:E,scale:null,font:null,textColor:null})}}return new kl(h)}evaluate(t){return new Rr(this.sections.map(i=>{const l=i.content.evaluate(t);return Xi(l)===za?new Cl("",l,null,null,null):new Cl(Il(l),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null)}))}eachChild(t){for(const i of this.sections)t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const i of this.sections){t.push(i.content.serialize());const l={};i.scale&&(l["font-scale"]=i.scale.serialize()),i.font&&(l["text-font"]=i.font.serialize()),i.textColor&&(l["text-color"]=i.textColor.serialize()),t.push(l)}return t}}class Jc{constructor(t){this.type=za,this.input=t}static parse(t,i){if(t.length!==2)return i.error("Expected two arguments.");const l=i.parse(t[1],1,zn);return l?new Jc(l):i.error("No image name provided.")}evaluate(t){const i=this.input.evaluate(t),l=Ar.fromString(i);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(i)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const tv={"to-boolean":Cn,"to-color":bo,"to-number":Ct,"to-string":zn};class Lh{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const l=t[0];if((l==="to-boolean"||l==="to-string")&&t.length!==2)return i.error("Expected one argument.");const h=tv[l],p=[];for(let v=1;v<t.length;v++){const x=i.parse(t[v],v,bn);if(!x)return null;p.push(x)}return new Lh(h,p)}evaluate(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){let i,l;for(const h of this.args){if(i=h.evaluate(t),l=null,i instanceof Ri)return i;if(typeof i=="string"){const p=t.parseColor(i);if(p)return p}else if(Array.isArray(i)&&(l=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:np(i[0],i[1],i[2],i[3]),!l))return new Ri(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new ur(l||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const l of this.args){if(i=l.evaluate(t),i===null)return 0;const h=Number(i);if(!isNaN(h))return h}throw new ur(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?Rr.fromString(Il(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Ar.fromString(Il(this.args[0].evaluate(t))):Il(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new kl([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Jc(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(i=>{t.push(i.serialize())}),t}}var Ra=Lh;const ip=["Unknown","Point","LineString","Polygon"];var Ml=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ip[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:i,y:l}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*t-n[0])+this.featureDistanceData.bearing[1]*(l*t-n[1])}return 0}parseColor(n){let t=this._parseColorCache[n];return t||(t=this._parseColorCache[n]=Ri.parse(n)),t}};class Ba{constructor(t,i,l,h){this.name=t,this.type=i,this._evaluate=l,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,i){const l=t[0],h=Ba.definitions[l];if(!h)return i.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(h)?h[0]:h.type,v=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,x=v.filter(([T])=>!Array.isArray(T)||T.length===t.length-1);let E=null;for(const[T,k]of x){E=new Vh(i.registry,i.path,null,i.scope);const P=[];let D=!1;for(let V=1;V<t.length;V++){const N=t[V],G=Array.isArray(T)?T[V-1]:T.type,X=E.parse(N,1+P.length,G);if(!X){D=!0;break}P.push(X)}if(!D)if(Array.isArray(T)&&T.length!==P.length)E.error(`Expected ${T.length} arguments, but found ${P.length} instead.`);else{for(let V=0;V<P.length;V++){const N=Array.isArray(T)?T[V]:T.type,G=P[V];E.concat(V+1).checkSubtype(N,G.type)}if(E.errors.length===0)return new Ba(l,p,k,P)}}if(x.length===1)i.errors.push(...E.errors);else{const T=(x.length?x:v).map(([P])=>{return D=P,Array.isArray(D)?`(${D.map(ci).join(", ")})`:`(${ci(D.type)}...)`;var D}).join(" | "),k=[];for(let P=1;P<t.length;P++){const D=i.parse(t[P],1+k.length);if(!D)return null;k.push(ci(D.type))}i.error(`Expected arguments of type ${T}, but found (${k.join(", ")}) instead.`)}return null}static register(t,i){Ba.definitions=i;for(const l in i)t[l]=Ba}}var ps=Ba;class Qc{constructor(t,i,l){this.type=Sl,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=i}static parse(t,i){if(t.length!==2)return i.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return i.error("Collator options argument must be an object.");const h=i.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Cn);if(!h)return null;const p=i.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Cn);if(!p)return null;let v=null;return l.locale&&(v=i.parse(l.locale,1,zn),!v)?null:new Qc(h,p,v)}evaluate(t){return new Xc(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const ms=8192;function Yr(n,t){n[0]=Math.min(n[0],t[0]),n[1]=Math.min(n[1],t[1]),n[2]=Math.max(n[2],t[0]),n[3]=Math.max(n[3],t[1])}function Pl(n,t){return!(n[0]<=t[0]||n[2]>=t[2]||n[1]<=t[1]||n[3]>=t[3])}function rp(n,t){const i=(180+n[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(i*h*ms),Math.round(l*h*ms)]}function op(n,t,i){const l=n[0]-t[0],h=n[1]-t[1],p=n[0]-i[0],v=n[1]-i[1];return l*v-p*h==0&&l*p<=0&&h*v<=0}function eu(n,t){let i=!1;for(let v=0,x=t.length;v<x;v++){const E=t[v];for(let T=0,k=E.length;T<k-1;T++){if(op(n,E[T],E[T+1]))return!1;(h=E[T])[1]>(l=n)[1]!=(p=E[T+1])[1]>l[1]&&l[0]<(p[0]-h[0])*(l[1]-h[1])/(p[1]-h[1])+h[0]&&(i=!i)}}var l,h,p;return i}function sp(n,t){for(let i=0;i<t.length;i++)if(eu(n,t[i]))return!0;return!1}function Dh(n,t,i,l){const h=l[0]-i[0],p=l[1]-i[1],v=(n[0]-i[0])*p-h*(n[1]-i[1]),x=(t[0]-i[0])*p-h*(t[1]-i[1]);return v>0&&x<0||v<0&&x>0}function Rh(n,t,i){for(const T of i)for(let k=0;k<T.length-1;++k)if((x=[(v=T[k+1])[0]-(p=T[k])[0],v[1]-p[1]])[0]*(E=[(h=t)[0]-(l=n)[0],h[1]-l[1]])[1]-x[1]*E[0]!=0&&Dh(l,h,p,v)&&Dh(p,v,l,h))return!0;var l,h,p,v,x,E;return!1}function Oa(n,t){for(let i=0;i<n.length;++i)if(!eu(n[i],t))return!1;for(let i=0;i<n.length-1;++i)if(Rh(n[i],n[i+1],t))return!1;return!0}function ap(n,t){for(let i=0;i<t.length;i++)if(Oa(n,t[i]))return!0;return!1}function tu(n,t,i){const l=[];for(let h=0;h<n.length;h++){const p=[];for(let v=0;v<n[h].length;v++){const x=rp(n[h][v],i);Yr(t,x),p.push(x)}l.push(p)}return l}function nu(n,t,i){const l=[];for(let h=0;h<n.length;h++){const p=tu(n[h],t,i);l.push(p)}return l}function Bh(n,t,i,l){if(n[0]<i[0]||n[0]>i[2]){const h=.5*l;let p=n[0]-i[0]>h?-l:i[0]-n[0]>h?l:0;p===0&&(p=n[0]-i[2]>h?-l:i[2]-n[0]>h?l:0),n[0]+=p}Yr(t,n)}function Ks(n,t,i,l){const h=Math.pow(2,l.z)*ms,p=[l.x*ms,l.y*ms],v=[];if(!n)return v;for(const x of n)for(const E of x){const T=[E.x+p[0],E.y+p[1]];Bh(T,t,i,h),v.push(T)}return v}function Zn(n,t,i,l){const h=Math.pow(2,l.z)*ms,p=[l.x*ms,l.y*ms],v=[];if(!n)return v;for(const E of n){const T=[];for(const k of E){const P=[k.x+p[0],k.y+p[1]];Yr(t,P),T.push(P)}v.push(T)}if(t[2]-t[0]<=h/2){(x=t)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const E of v)for(const T of E)Bh(T,t,i,h)}var x;return v}class zl{constructor(t,i){this.type=Cn,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Yc(t[1])){const l=t[1];if(l.type==="FeatureCollection")for(let h=0;h<l.features.length;++h){const p=l.features[h].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new zl(l,l.features[h].geometry)}else if(l.type==="Feature"){const h=l.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new zl(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new zl(l,l)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,l){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],v=i.canonicalID();if(!v)return!1;if(l.type==="Polygon"){const x=tu(l.coordinates,p,v),E=Ks(i.geometry(),h,p,v);if(!Pl(h,p))return!1;for(const T of E)if(!eu(T,x))return!1}if(l.type==="MultiPolygon"){const x=nu(l.coordinates,p,v),E=Ks(i.geometry(),h,p,v);if(!Pl(h,p))return!1;for(const T of E)if(!sp(T,x))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,l){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],v=i.canonicalID();if(!v)return!1;if(l.type==="Polygon"){const x=tu(l.coordinates,p,v),E=Zn(i.geometry(),h,p,v);if(!Pl(h,p))return!1;for(const T of E)if(!Oa(T,x))return!1}if(l.type==="MultiPolygon"){const x=nu(l.coordinates,p,v),E=Zn(i.geometry(),h,p,v);if(!Pl(h,p))return!1;for(const T of E)if(!ap(T,x))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Oh=zl;function Ll(n){if(n instanceof ps&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof Oh)return!1;let t=!0;return n.eachChild(i=>{t&&!Ll(i)&&(t=!1)}),t}function Dl(n){if(n instanceof ps&&n.name==="feature-state")return!1;let t=!0;return n.eachChild(i=>{t&&!Dl(i)&&(t=!1)}),t}function iu(n,t){if(n instanceof ps&&t.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild(l=>{i&&!iu(l,t)&&(i=!1)}),i}class ru{constructor(t,i){this.type=i.type,this.name=t,this.boundExpression=i}static parse(t,i){if(t.length!==2||typeof t[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const l=t[1];return i.scope.has(l)?new ru(l,i.scope.get(l)):i.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Fh=ru;class ou{constructor(t,i=[],l,h=new ep,p=[]){this.registry=t,this.path=i,this.key=i.map(v=>`[${v}]`).join(""),this.scope=h,this.errors=p,this.expectedType=l}parse(t,i,l,h,p={}){return i?this.concat(i,l,h)._parse(t,p):this._parse(t,p)}_parse(t,i){function l(h,p,v){return v==="assert"?new Go(p,[h]):v==="coerce"?new Ra(p,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[h];if(p){let v=p.parse(t,this);if(!v)return null;if(this.expectedType){const x=this.expectedType,E=v.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||E.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string"){if(this.checkSubtype(x,E))return null}else v=l(v,x,i.typeAnnotation||"coerce");else v=l(v,x,i.typeAnnotation||"assert")}if(!(v instanceof Al)&&v.type.kind!=="resolvedImage"&&gs(v)){const x=new Ml;try{v=new Al(v.type,v.evaluate(x))}catch(E){return this.error(E.message),null}}return v}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,i,l){const h=typeof t=="number"?this.path.concat(t):this.path,p=l?this.scope.concat(l):this.scope;return new ou(this.registry,h,i||null,p,this.errors)}error(t,...i){const l=`${this.key}${i.map(h=>`[${h}]`).join("")}`;this.errors.push(new xo(l,t))}checkSubtype(t,i){const l=Lr(t,i);return l&&this.error(l),l}}var Vh=ou;function gs(n){if(n instanceof Fh)return gs(n.boundExpression);if(n instanceof ps&&n.name==="error"||n instanceof Qc||n instanceof Oh)return!1;const t=n instanceof Ra||n instanceof Go;let i=!0;return n.eachChild(l=>{i=t?i&&gs(l):i&&l instanceof Al}),!!i&&Ll(n)&&iu(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Js(n,t){const i=n.length-1;let l,h,p=0,v=i,x=0;for(;p<=v;)if(x=Math.floor((p+v)/2),l=n[x],h=n[x+1],l<=t){if(x===i||t<h)return x;p=x+1}else{if(!(l>t))throw new ur("Input is not a number.");v=x-1}return 0}class su{constructor(t,i,l){this.type=t,this.input=i,this.labels=[],this.outputs=[];for(const[h,p]of l)this.labels.push(h),this.outputs.push(p)}static parse(t,i){if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");const l=i.parse(t[1],1,Ct);if(!l)return null;const h=[];let p=null;i.expectedType&&i.expectedType.kind!=="value"&&(p=i.expectedType);for(let v=1;v<t.length;v+=2){const x=v===1?-1/0:t[v],E=t[v+1],T=v,k=v+1;if(typeof x!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(h.length&&h[h.length-1][0]>=x)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const P=i.parse(E,k,p);if(!P)return null;p=p||P.type,h.push([x,P])}return new su(p,l,h)}evaluate(t){const i=this.labels,l=this.outputs;if(i.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=i[0])return l[0].evaluate(t);const p=i.length;return h>=i[p-1]?l[p-1].evaluate(t):l[Js(i,h)].evaluate(t)}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&t.push(this.labels[i]),t.push(this.outputs[i].serialize());return t}}var Nh=su;function Vn(n,t,i){return n*(1-i)+t*i}var Rl=Object.freeze({__proto__:null,number:Vn,color:function(n,t,i){return new Ri(Vn(n.r,t.r,i),Vn(n.g,t.g,i),Vn(n.b,t.b,i),Vn(n.a,t.a,i))},array:function(n,t,i){return n.map((l,h)=>Vn(l,t[h],i))}});const lp=.95047,cp=1.08883,$h=4/29,Uh=6/29,jh=3*Uh*Uh,up=Math.PI/180,nv=180/Math.PI;function au(n){return n>.008856451679035631?Math.pow(n,1/3):n/jh+$h}function Gh(n){return n>Uh?n*n*n:jh*(n-$h)}function lu(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function cu(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function hp(n){const t=cu(n.r),i=cu(n.g),l=cu(n.b),h=au((.4124564*t+.3575761*i+.1804375*l)/lp),p=au((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*p-16,a:500*(h-p),b:200*(p-au((.0193339*t+.119192*i+.9503041*l)/cp)),alpha:n.a}}function dp(n){let t=(n.l+16)/116,i=isNaN(n.a)?t:t+n.a/500,l=isNaN(n.b)?t:t-n.b/200;return t=1*Gh(t),i=lp*Gh(i),l=cp*Gh(l),new Ri(lu(3.2404542*i-1.5371385*t-.4985314*l),lu(-.969266*i+1.8760108*t+.041556*l),lu(.0556434*i-.2040259*t+1.0572252*l),n.alpha)}function iv(n,t,i){const l=t-n;return n+i*(l>180||l<-180?l-360*Math.round(l/360):l)}const Bl={forward:hp,reverse:dp,interpolate:function(n,t,i){return{l:Vn(n.l,t.l,i),a:Vn(n.a,t.a,i),b:Vn(n.b,t.b,i),alpha:Vn(n.alpha,t.alpha,i)}}},Ol={forward:function(n){const{l:t,a:i,b:l}=hp(n),h=Math.atan2(l,i)*nv;return{h:h<0?h+360:h,c:Math.sqrt(i*i+l*l),l:t,alpha:n.a}},reverse:function(n){const t=n.h*up,i=n.c;return dp({l:n.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:n.alpha})},interpolate:function(n,t,i){return{h:iv(n.h,t.h,i),c:Vn(n.c,t.c,i),l:Vn(n.l,t.l,i),alpha:Vn(n.alpha,t.alpha,i)}}};var fp=Object.freeze({__proto__:null,lab:Bl,hcl:Ol});class Fl{constructor(t,i,l,h,p){this.type=t,this.operator=i,this.interpolation=l,this.input=h,this.labels=[],this.outputs=[];for(const[v,x]of p)this.labels.push(v),this.outputs.push(x)}static interpolationFactor(t,i,l,h){let p=0;if(t.name==="exponential")p=qh(i,t.base,l,h);else if(t.name==="linear")p=qh(i,1,l,h);else if(t.name==="cubic-bezier"){const v=t.controlPoints;p=new K(v[0],v[1],v[2],v[3]).solve(qh(i,1,l,h))}return p}static parse(t,i){let[l,h,p,...v]=t;if(!Array.isArray(h)||h.length===0)return i.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const T=h[1];if(typeof T!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:T}}else{if(h[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const T=h.slice(1);if(T.length!==4||T.some(k=>typeof k!="number"||k<0||k>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:T}}}if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(p=i.parse(p,2,Ct),!p)return null;const x=[];let E=null;l==="interpolate-hcl"||l==="interpolate-lab"?E=bo:i.expectedType&&i.expectedType.kind!=="value"&&(E=i.expectedType);for(let T=0;T<v.length;T+=2){const k=v[T],P=v[T+1],D=T+3,V=T+4;if(typeof k!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(x.length&&x[x.length-1][0]>=k)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const N=i.parse(P,V,E);if(!N)return null;E=E||N.type,x.push([k,N])}return E.kind==="number"||E.kind==="color"||E.kind==="array"&&E.itemType.kind==="number"&&typeof E.N=="number"?new Fl(E,l,h,p,x):i.error(`Type ${ci(E)} is not interpolatable.`)}evaluate(t){const i=this.labels,l=this.outputs;if(i.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=i[0])return l[0].evaluate(t);const p=i.length;if(h>=i[p-1])return l[p-1].evaluate(t);const v=Js(i,h),x=Fl.interpolationFactor(this.interpolation,h,i[v],i[v+1]),E=l[v].evaluate(t),T=l[v+1].evaluate(t);return this.operator==="interpolate"?Rl[this.type.kind.toLowerCase()](E,T,x):this.operator==="interpolate-hcl"?Ol.reverse(Ol.interpolate(Ol.forward(E),Ol.forward(T),x)):Bl.reverse(Bl.interpolate(Bl.forward(E),Bl.forward(T),x))}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,t,this.input.serialize()];for(let l=0;l<this.labels.length;l++)i.push(this.labels[l],this.outputs[l].serialize());return i}}function qh(n,t,i,l){const h=l-i,p=n-i;return h===0?0:t===1?p/h:(Math.pow(t,p)-1)/(Math.pow(t,h)-1)}var wo=Fl;class Zh{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expectected at least one argument.");let l=null;const h=i.expectedType;h&&h.kind!=="value"&&(l=h);const p=[];for(const x of t.slice(1)){const E=i.parse(x,1+p.length,l,void 0,{typeAnnotation:"omit"});if(!E)return null;l=l||E.type,p.push(E)}const v=h&&p.some(x=>Lr(h,x.type));return new Zh(v?bn:l,p)}evaluate(t){let i,l=null,h=0;for(const p of this.args){if(h++,l=p.evaluate(t),l&&l instanceof Ar&&!l.available&&(i||(i=l),l=null,h===this.args.length))return i;if(l!==null)break}return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var pp=Zh;class uu{constructor(t,i){this.type=i.type,this.bindings=[].concat(t),this.result=i}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const i of this.bindings)t(i[1]);t(this.result)}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let p=1;p<t.length-1;p+=2){const v=t[p];if(typeof v!="string")return i.error(`Expected string, but found ${typeof v} instead.`,p);if(/[^a-zA-Z0-9_]/.test(v))return i.error("Variable names must contain only alphanumeric characters or '_'.",p);const x=i.parse(t[p+1],p+1);if(!x)return null;l.push([v,x])}const h=i.parse(t[t.length-1],t.length-1,i.expectedType,l);return h?new uu(l,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[i,l]of this.bindings)t.push(i,l.serialize());return t.push(this.result.serialize()),t}}var Wh=uu;class hu{constructor(t,i,l){this.type=t,this.index=i,this.input=l}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=i.parse(t[1],1,Ct),h=i.parse(t[2],2,Ir(i.expectedType||bn));return l&&h?new hu(h.type.itemType,l,h):null}evaluate(t){const i=this.index.evaluate(t),l=this.input.evaluate(t);if(i<0)throw new ur(`Array index out of bounds: ${i} < 0.`);if(i>=l.length)throw new ur(`Array index out of bounds: ${i} > ${l.length-1}.`);if(i!==Math.floor(i))throw new ur(`Array index must be an integer, but found ${i} instead.`);return l[i]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var rv=hu;class Hh{constructor(t,i){this.type=Cn,this.needle=t,this.haystack=i}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=i.parse(t[1],1,bn),h=i.parse(t[2],2,bn);return l&&h?kh(l.type,[Cn,zn,Ct,Ma,bn])?new Hh(l,h):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ci(l.type)} instead`):null}evaluate(t){const i=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(l==null)return!1;if(!Xs(i,["boolean","string","number","null"]))throw new ur(`Expected first argument to be of type boolean, string, number or null, but found ${ci(Xi(i))} instead.`);if(!Xs(l,["string","array"]))throw new ur(`Expected second argument to be of type array or string, but found ${ci(Xi(l))} instead.`);return l.indexOf(i)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var mp=Hh;class Vl{constructor(t,i,l){this.type=Ct,this.needle=t,this.haystack=i,this.fromIndex=l}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=i.parse(t[1],1,bn),h=i.parse(t[2],2,bn);if(!l||!h)return null;if(!kh(l.type,[Cn,zn,Ct,Ma,bn]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ci(l.type)} instead`);if(t.length===4){const p=i.parse(t[3],3,Ct);return p?new Vl(l,h,p):null}return new Vl(l,h)}evaluate(t){const i=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!Xs(i,["boolean","string","number","null"]))throw new ur(`Expected first argument to be of type boolean, string, number or null, but found ${ci(Xi(i))} instead.`);if(!Xs(l,["string","array"]))throw new ur(`Expected second argument to be of type array or string, but found ${ci(Xi(l))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(t);return l.indexOf(i,h)}return l.indexOf(i)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var gp=Vl;class Xh{constructor(t,i,l,h,p,v){this.inputType=t,this.type=i,this.input=l,this.cases=h,this.outputs=p,this.otherwise=v}static parse(t,i){if(t.length<5)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return i.error("Expected an even number of arguments.");let l,h;i.expectedType&&i.expectedType.kind!=="value"&&(h=i.expectedType);const p={},v=[];for(let T=2;T<t.length-1;T+=2){let k=t[T];const P=t[T+1];Array.isArray(k)||(k=[k]);const D=i.concat(T);if(k.length===0)return D.error("Expected at least one branch label.");for(const N of k){if(typeof N!="number"&&typeof N!="string")return D.error("Branch labels must be numbers or strings.");if(typeof N=="number"&&Math.abs(N)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof N=="number"&&Math.floor(N)!==N)return D.error("Numeric branch labels must be integer values.");if(l){if(D.checkSubtype(l,Xi(N)))return null}else l=Xi(N);if(p[String(N)]!==void 0)return D.error("Branch labels must be unique.");p[String(N)]=v.length}const V=i.parse(P,T,h);if(!V)return null;h=h||V.type,v.push(V)}const x=i.parse(t[1],1,bn);if(!x)return null;const E=i.parse(t[t.length-1],t.length-1,h);return E?x.type.kind!=="value"&&i.concat(1).checkSubtype(l,x.type)?null:new Xh(l,h,x,p,v,E):null}evaluate(t){const i=this.input.evaluate(t);return(Xi(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),l=[],h={};for(const v of i){const x=h[this.cases[v]];x===void 0?(h[this.cases[v]]=l.length,l.push([this.cases[v],[v]])):l[x][1].push(v)}const p=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,x]of l)t.push(x.length===1?p(x[0]):x.map(p)),t.push(this.outputs[v].serialize());return t.push(this.otherwise.serialize()),t}}var ov=Xh;class Yh{constructor(t,i,l){this.type=t,this.branches=i,this.otherwise=l}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return i.error("Expected an odd number of arguments.");let l;i.expectedType&&i.expectedType.kind!=="value"&&(l=i.expectedType);const h=[];for(let v=1;v<t.length-1;v+=2){const x=i.parse(t[v],v,Cn);if(!x)return null;const E=i.parse(t[v+1],v+1,l);if(!E)return null;h.push([x,E]),l=l||E.type}const p=i.parse(t[t.length-1],t.length-1,l);return p?new Yh(l,h,p):null}evaluate(t){for(const[i,l]of this.branches)if(i.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[i,l]of this.branches)t(i),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var sv=Yh;class Qs{constructor(t,i,l,h){this.type=t,this.input=i,this.beginIndex=l,this.endIndex=h}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=i.parse(t[1],1,bn),h=i.parse(t[2],2,Ct);if(!l||!h)return null;if(!kh(l.type,[Ir(bn),zn,bn]))return i.error(`Expected first argument to be of type array or string, but found ${ci(l.type)} instead`);if(t.length===4){const p=i.parse(t[3],3,Ct);return p?new Qs(l.type,l,h,p):null}return new Qs(l.type,l,h)}evaluate(t){const i=this.input.evaluate(t),l=this.beginIndex.evaluate(t);if(!Xs(i,["string","array"]))throw new ur(`Expected first argument to be of type array or string, but found ${ci(Xi(i))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(t);return i.slice(l,h)}return i.slice(l)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var vp=Qs;function Kh(n,t){return n==="=="||n==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function _p(n,t,i,l){return l.compare(t,i)===0}function Fa(n,t,i){const l=n!=="=="&&n!=="!=";return class c2{constructor(p,v,x){this.type=Cn,this.lhs=p,this.rhs=v,this.collator=x,this.hasUntypedArgument=p.type.kind==="value"||v.type.kind==="value"}static parse(p,v){if(p.length!==3&&p.length!==4)return v.error("Expected two or three arguments.");const x=p[0];let E=v.parse(p[1],1,bn);if(!E)return null;if(!Kh(x,E.type))return v.concat(1).error(`"${x}" comparisons are not supported for type '${ci(E.type)}'.`);let T=v.parse(p[2],2,bn);if(!T)return null;if(!Kh(x,T.type))return v.concat(2).error(`"${x}" comparisons are not supported for type '${ci(T.type)}'.`);if(E.type.kind!==T.type.kind&&E.type.kind!=="value"&&T.type.kind!=="value")return v.error(`Cannot compare types '${ci(E.type)}' and '${ci(T.type)}'.`);l&&(E.type.kind==="value"&&T.type.kind!=="value"?E=new Go(T.type,[E]):E.type.kind!=="value"&&T.type.kind==="value"&&(T=new Go(E.type,[T])));let k=null;if(p.length===4){if(E.type.kind!=="string"&&T.type.kind!=="string"&&E.type.kind!=="value"&&T.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(k=v.parse(p[3],3,Sl),!k)return null}return new c2(E,T,k)}evaluate(p){const v=this.lhs.evaluate(p),x=this.rhs.evaluate(p);if(l&&this.hasUntypedArgument){const E=Xi(v),T=Xi(x);if(E.kind!==T.kind||E.kind!=="string"&&E.kind!=="number")throw new ur(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${E.kind}, ${T.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const E=Xi(v),T=Xi(x);if(E.kind!=="string"||T.kind!=="string")return t(p,v,x)}return this.collator?i(p,v,x,this.collator.evaluate(p)):t(p,v,x)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[n];return this.eachChild(v=>{p.push(v.serialize())}),p}}}const av=Fa("==",function(n,t,i){return t===i},_p),yp=Fa("!=",function(n,t,i){return t!==i},function(n,t,i,l){return!_p(0,t,i,l)}),xp=Fa("<",function(n,t,i){return t<i},function(n,t,i,l){return l.compare(t,i)<0}),bp=Fa(">",function(n,t,i){return t>i},function(n,t,i,l){return l.compare(t,i)>0}),Jh=Fa("<=",function(n,t,i){return t<=i},function(n,t,i,l){return l.compare(t,i)<=0}),lv=Fa(">=",function(n,t,i){return t>=i},function(n,t,i,l){return l.compare(t,i)>=0});class Qh{constructor(t,i,l,h,p,v){this.type=zn,this.number=t,this.locale=i,this.currency=l,this.unit=h,this.minFractionDigits=p,this.maxFractionDigits=v}static parse(t,i){if(t.length!==3)return i.error("Expected two arguments.");const l=i.parse(t[1],1,Ct);if(!l)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return i.error("NumberFormat options argument must be an object.");let p=null;if(h.locale&&(p=i.parse(h.locale,1,zn),!p))return null;let v=null;if(h.currency&&(v=i.parse(h.currency,1,zn),!v))return null;let x=null;if(h.unit&&(x=i.parse(h.unit,1,zn),!x))return null;let E=null;if(h["min-fraction-digits"]&&(E=i.parse(h["min-fraction-digits"],1,Ct),!E))return null;let T=null;return h["max-fraction-digits"]&&(T=i.parse(h["max-fraction-digits"],1,Ct),!T)?null:new Qh(l,p,v,x,E,T)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class ed{constructor(t){this.type=Ct,this.input=t}static parse(t,i){if(t.length!==2)return i.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=i.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${ci(l.type)} instead.`):new ed(l):null}evaluate(t){const i=this.input.evaluate(t);if(typeof i=="string"||Array.isArray(i))return i.length;throw new ur(`Expected value to be of type string or array, but found ${ci(Xi(i))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(i=>{t.push(i.serialize())}),t}}const wp={"==":av,"!=":yp,">":bp,"<":xp,">=":lv,"<=":Jh,array:Go,at:rv,boolean:Go,case:sv,coalesce:pp,collator:Qc,format:kl,image:Jc,in:mp,"index-of":gp,interpolate:wo,"interpolate-hcl":wo,"interpolate-lab":wo,length:ed,let:Wh,literal:Al,match:ov,number:Go,"number-format":Qh,object:Go,slice:vp,step:Nh,string:Go,"to-boolean":Ra,"to-color":Ra,"to-number":Ra,"to-string":Ra,var:Fh,within:Oh};function Ep(n,[t,i,l,h]){t=t.evaluate(n),i=i.evaluate(n),l=l.evaluate(n);const p=h?h.evaluate(n):1,v=np(t,i,l,p);if(v)throw new ur(v);return new Ri(t/255*p,i/255*p,l/255*p,p)}function Sp(n,t){return n in t}function td(n,t){const i=t[n];return i===void 0?null:i}function vs(n){return{type:n}}ps.register(wp,{error:[{kind:"error"},[zn],(n,[t])=>{throw new ur(t.evaluate(n))}],typeof:[zn,[bn],(n,[t])=>ci(Xi(t.evaluate(n)))],"to-rgba":[Ir(Ct,4),[bo],(n,[t])=>t.evaluate(n).toArray()],rgb:[bo,[Ct,Ct,Ct],Ep],rgba:[bo,[Ct,Ct,Ct,Ct],Ep],has:{type:Cn,overloads:[[[zn],(n,[t])=>Sp(t.evaluate(n),n.properties())],[[zn,Hs],(n,[t,i])=>Sp(t.evaluate(n),i.evaluate(n))]]},get:{type:bn,overloads:[[[zn],(n,[t])=>td(t.evaluate(n),n.properties())],[[zn,Hs],(n,[t,i])=>td(t.evaluate(n),i.evaluate(n))]]},"feature-state":[bn,[zn],(n,[t])=>td(t.evaluate(n),n.featureState||{})],properties:[Hs,[],n=>n.properties()],"geometry-type":[zn,[],n=>n.geometryType()],id:[bn,[],n=>n.id()],zoom:[Ct,[],n=>n.globals.zoom],pitch:[Ct,[],n=>n.globals.pitch||0],"distance-from-center":[Ct,[],n=>n.distanceFromCenter()],"heatmap-density":[Ct,[],n=>n.globals.heatmapDensity||0],"line-progress":[Ct,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[Ct,[],n=>n.globals.skyRadialProgress||0],accumulated:[bn,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[Ct,vs(Ct),(n,t)=>{let i=0;for(const l of t)i+=l.evaluate(n);return i}],"*":[Ct,vs(Ct),(n,t)=>{let i=1;for(const l of t)i*=l.evaluate(n);return i}],"-":{type:Ct,overloads:[[[Ct,Ct],(n,[t,i])=>t.evaluate(n)-i.evaluate(n)],[[Ct],(n,[t])=>-t.evaluate(n)]]},"/":[Ct,[Ct,Ct],(n,[t,i])=>t.evaluate(n)/i.evaluate(n)],"%":[Ct,[Ct,Ct],(n,[t,i])=>t.evaluate(n)%i.evaluate(n)],ln2:[Ct,[],()=>Math.LN2],pi:[Ct,[],()=>Math.PI],e:[Ct,[],()=>Math.E],"^":[Ct,[Ct,Ct],(n,[t,i])=>Math.pow(t.evaluate(n),i.evaluate(n))],sqrt:[Ct,[Ct],(n,[t])=>Math.sqrt(t.evaluate(n))],log10:[Ct,[Ct],(n,[t])=>Math.log(t.evaluate(n))/Math.LN10],ln:[Ct,[Ct],(n,[t])=>Math.log(t.evaluate(n))],log2:[Ct,[Ct],(n,[t])=>Math.log(t.evaluate(n))/Math.LN2],sin:[Ct,[Ct],(n,[t])=>Math.sin(t.evaluate(n))],cos:[Ct,[Ct],(n,[t])=>Math.cos(t.evaluate(n))],tan:[Ct,[Ct],(n,[t])=>Math.tan(t.evaluate(n))],asin:[Ct,[Ct],(n,[t])=>Math.asin(t.evaluate(n))],acos:[Ct,[Ct],(n,[t])=>Math.acos(t.evaluate(n))],atan:[Ct,[Ct],(n,[t])=>Math.atan(t.evaluate(n))],min:[Ct,vs(Ct),(n,t)=>Math.min(...t.map(i=>i.evaluate(n)))],max:[Ct,vs(Ct),(n,t)=>Math.max(...t.map(i=>i.evaluate(n)))],abs:[Ct,[Ct],(n,[t])=>Math.abs(t.evaluate(n))],round:[Ct,[Ct],(n,[t])=>{const i=t.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[Ct,[Ct],(n,[t])=>Math.floor(t.evaluate(n))],ceil:[Ct,[Ct],(n,[t])=>Math.ceil(t.evaluate(n))],"filter-==":[Cn,[zn,bn],(n,[t,i])=>n.properties()[t.value]===i.value],"filter-id-==":[Cn,[bn],(n,[t])=>n.id()===t.value],"filter-type-==":[Cn,[zn],(n,[t])=>n.geometryType()===t.value],"filter-<":[Cn,[zn,bn],(n,[t,i])=>{const l=n.properties()[t.value],h=i.value;return typeof l==typeof h&&l<h}],"filter-id-<":[Cn,[bn],(n,[t])=>{const i=n.id(),l=t.value;return typeof i==typeof l&&i<l}],"filter->":[Cn,[zn,bn],(n,[t,i])=>{const l=n.properties()[t.value],h=i.value;return typeof l==typeof h&&l>h}],"filter-id->":[Cn,[bn],(n,[t])=>{const i=n.id(),l=t.value;return typeof i==typeof l&&i>l}],"filter-<=":[Cn,[zn,bn],(n,[t,i])=>{const l=n.properties()[t.value],h=i.value;return typeof l==typeof h&&l<=h}],"filter-id-<=":[Cn,[bn],(n,[t])=>{const i=n.id(),l=t.value;return typeof i==typeof l&&i<=l}],"filter->=":[Cn,[zn,bn],(n,[t,i])=>{const l=n.properties()[t.value],h=i.value;return typeof l==typeof h&&l>=h}],"filter-id->=":[Cn,[bn],(n,[t])=>{const i=n.id(),l=t.value;return typeof i==typeof l&&i>=l}],"filter-has":[Cn,[bn],(n,[t])=>t.value in n.properties()],"filter-has-id":[Cn,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[Cn,[Ir(zn)],(n,[t])=>t.value.indexOf(n.geometryType())>=0],"filter-id-in":[Cn,[Ir(bn)],(n,[t])=>t.value.indexOf(n.id())>=0],"filter-in-small":[Cn,[zn,Ir(bn)],(n,[t,i])=>i.value.indexOf(n.properties()[t.value])>=0],"filter-in-large":[Cn,[zn,Ir(bn)],(n,[t,i])=>function(l,h,p,v){for(;p<=v;){const x=p+v>>1;if(h[x]===l)return!0;h[x]>l?v=x-1:p=x+1}return!1}(n.properties()[t.value],i.value,0,i.value.length-1)],all:{type:Cn,overloads:[[[Cn,Cn],(n,[t,i])=>t.evaluate(n)&&i.evaluate(n)],[vs(Cn),(n,t)=>{for(const i of t)if(!i.evaluate(n))return!1;return!0}]]},any:{type:Cn,overloads:[[[Cn,Cn],(n,[t,i])=>t.evaluate(n)||i.evaluate(n)],[vs(Cn),(n,t)=>{for(const i of t)if(i.evaluate(n))return!0;return!1}]]},"!":[Cn,[Cn],(n,[t])=>!t.evaluate(n)],"is-supported-script":[Cn,[zn],(n,[t])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(t.evaluate(n))}],upcase:[zn,[zn],(n,[t])=>t.evaluate(n).toUpperCase()],downcase:[zn,[zn],(n,[t])=>t.evaluate(n).toLowerCase()],concat:[zn,vs(bn),(n,t)=>t.map(i=>Il(i.evaluate(n))).join("")],"resolved-locale":[zn,[Sl],(n,[t])=>t.evaluate(n).resolvedLocale()]});var Va=wp;function Nl(n){return{result:"success",value:n}}function Na(n){return{result:"error",value:n}}function $a(n){return n["property-type"]==="data-driven"}function qo(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function du(n){return!!n.expression&&n.expression.interpolated}function Rn(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function fu(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function cv(n){return n}function nd(n,t){const i=t.type==="color",l=n.stops&&typeof n.stops[0][0]=="object",h=l||!(l||n.property!==void 0),p=n.type||(du(t)?"exponential":"interval");if(i&&((n=jo({},n)).stops&&(n.stops=n.stops.map(T=>[T[0],Ri.parse(T[1])])),n.default=Ri.parse(n.default?n.default:t.default)),n.colorSpace&&n.colorSpace!=="rgb"&&!fp[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let v,x,E;if(p==="exponential")v=pu;else if(p==="interval")v=Tp;else if(p==="categorical"){v=id,x=Object.create(null);for(const T of n.stops)x[T[0]]=T[1];E=typeof n.stops[0][0]}else{if(p!=="identity")throw new Error(`Unknown function type "${p}"`);v=Cp}if(l){const T={},k=[];for(let V=0;V<n.stops.length;V++){const N=n.stops[V],G=N[0].zoom;T[G]===void 0&&(T[G]={zoom:G,type:n.type,property:n.property,default:n.default,stops:[]},k.push(G)),T[G].stops.push([N[0].value,N[1]])}const P=[];for(const V of k)P.push([T[V].zoom,nd(T[V],t)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:wo.interpolationFactor.bind(void 0,D),zoomStops:P.map(V=>V[0]),evaluate:({zoom:V},N)=>pu({stops:P,base:n.base},t,V).evaluate(V,N)}}if(h){const T=p==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:wo.interpolationFactor.bind(void 0,T),zoomStops:n.stops.map(k=>k[0]),evaluate:({zoom:k})=>v(n,t,k,x,E)}}return{kind:"source",evaluate(T,k){const P=k&&k.properties?k.properties[n.property]:void 0;return P===void 0?$l(n.default,t.default):v(n,t,P,x,E)}}}function $l(n,t,i){return n!==void 0?n:t!==void 0?t:i!==void 0?i:void 0}function id(n,t,i,l,h){return $l(typeof i===h?l[i]:void 0,n.default,t.default)}function Tp(n,t,i){if(Rn(i)!=="number")return $l(n.default,t.default);const l=n.stops.length;if(l===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[l-1][0])return n.stops[l-1][1];const h=Js(n.stops.map(p=>p[0]),i);return n.stops[h][1]}function pu(n,t,i){const l=n.base!==void 0?n.base:1;if(Rn(i)!=="number")return $l(n.default,t.default);const h=n.stops.length;if(h===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[h-1][0])return n.stops[h-1][1];const p=Js(n.stops.map(k=>k[0]),i),v=function(k,P,D,V){const N=V-D,G=k-D;return N===0?0:P===1?G/N:(Math.pow(P,G)-1)/(Math.pow(P,N)-1)}(i,l,n.stops[p][0],n.stops[p+1][0]),x=n.stops[p][1],E=n.stops[p+1][1];let T=Rl[t.type]||cv;if(n.colorSpace&&n.colorSpace!=="rgb"){const k=fp[n.colorSpace];T=(P,D)=>k.reverse(k.interpolate(k.forward(P),k.forward(D),v))}return typeof x.evaluate=="function"?{evaluate(...k){const P=x.evaluate.apply(void 0,k),D=E.evaluate.apply(void 0,k);if(P!==void 0&&D!==void 0)return T(P,D,v)}}:T(x,E,v)}function Cp(n,t,i){return t.type==="color"?i=Ri.parse(i):t.type==="formatted"?i=Rr.fromString(i.toString()):t.type==="resolvedImage"?i=Ar.fromString(i.toString()):Rn(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),$l(i,n.default,t.default)}class mu{constructor(t,i){this.expression=t,this._warningHistory={},this._evaluator=new Ml,this._defaultValue=i?function(l){return l.type==="color"&&(fu(l.default)||Array.isArray(l.default))?new Ri(0,0,0,0):l.type==="color"?Ri.parse(l.default)||null:l.default===void 0?null:l.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(t,i,l,h,p,v,x,E){return this._evaluator.globals=t,this._evaluator.feature=i,this._evaluator.featureState=l,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(t,i,l,h,p,v,x,E){this._evaluator.globals=t,this._evaluator.feature=i||null,this._evaluator.featureState=l||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=E||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new ur(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function Ua(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in Va}function ja(n,t){const i=new Vh(Va,[],t?function(h){const p={color:bo,string:zn,number:Ct,enum:zn,boolean:Cn,formatted:Pa,resolvedImage:za};return h.type==="array"?Ir(p[h.value]||bn,h.length):p[h.type]}(t):void 0),l=i.parse(n,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Nl(new mu(l,t)):Na(i.errors)}class gu{constructor(t,i){this.kind=t,this._styleExpression=i,this.isStateDependent=t!=="constant"&&!Dl(i.expression)}evaluateWithoutErrorHandling(t,i,l,h,p,v){return this._styleExpression.evaluateWithoutErrorHandling(t,i,l,h,p,v)}evaluate(t,i,l,h,p,v){return this._styleExpression.evaluate(t,i,l,h,p,v)}}class ea{constructor(t,i,l,h){this.kind=t,this.zoomStops=l,this._styleExpression=i,this.isStateDependent=t!=="camera"&&!Dl(i.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,i,l,h,p,v){return this._styleExpression.evaluateWithoutErrorHandling(t,i,l,h,p,v)}evaluate(t,i,l,h,p,v){return this._styleExpression.evaluate(t,i,l,h,p,v)}interpolationFactor(t,i,l){return this.interpolationType?wo.interpolationFactor(this.interpolationType,t,i,l):0}}function ta(n,t){if((n=ja(n,t)).result==="error")return n;const i=n.value.expression,l=Ll(i);if(!l&&!$a(t))return Na([new xo("","data expressions not supported")]);const h=iu(i,["zoom","pitch","distance-from-center"]);if(!h&&!qo(t))return Na([new xo("","zoom expressions not supported")]);const p=jl(i);return p||h?p instanceof xo?Na([p]):p instanceof wo&&!du(t)?Na([new xo("",'"interpolate" expressions cannot be used with this property')]):Nl(p?new ea(l?"camera":"composite",n.value,p.labels,p instanceof wo?p.interpolation:void 0):new gu(l?"constant":"source",n.value)):Na([new xo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ul{constructor(t,i){this._parameters=t,this._specification=i,jo(this,nd(this._parameters,this._specification))}static deserialize(t){return new Ul(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function jl(n){let t=null;if(n instanceof Wh)t=jl(n.result);else if(n instanceof pp){for(const i of n.args)if(t=jl(i),t)break}else(n instanceof Nh||n instanceof wo)&&n.input instanceof ps&&n.input.name==="zoom"&&(t=n);return t instanceof xo||n.eachChild(i=>{const l=jl(i);l instanceof xo?t=l:!t&&l?t=new xo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new xo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}class Ot{constructor(t,i,l,h){this.message=(t?`${t}: `:"")+l,h&&(this.identifier=h),i!=null&&i.__line__&&(this.line=i.__line__)}}function Kr(n){const t=n.key,i=n.value,l=n.valueSpec||{},h=n.objectElementValidators||{},p=n.style,v=n.styleSpec;let x=[];const E=Rn(i);if(E!=="object")return[new Ot(t,i,`object expected, ${E} found`)];for(const T in i){const k=T.split(".")[0],P=l[k]||l["*"];let D;h[k]?D=h[k]:l[k]?D=_r:h["*"]?D=h["*"]:l["*"]&&(D=_r),D?x=x.concat(D({key:(t&&`${t}.`)+T,value:i[T],valueSpec:P,style:p,styleSpec:v,object:i,objectKey:T},i)):x.push(new Ot(t,i[T],`unknown property "${T}"`))}for(const T in l)h[T]||l[T].required&&l[T].default===void 0&&i[T]===void 0&&x.push(new Ot(t,i,`missing required property "${T}"`));return x}function Ip(n){const t=n.value,i=n.valueSpec,l=n.style,h=n.styleSpec,p=n.key,v=n.arrayElementValidator||_r;if(Rn(t)!=="array")return[new Ot(p,t,`array expected, ${Rn(t)} found`)];if(i.length&&t.length!==i.length)return[new Ot(p,t,`array length ${i.length} expected, length ${t.length} found`)];if(i["min-length"]&&t.length<i["min-length"])return[new Ot(p,t,`array length at least ${i["min-length"]} expected, length ${t.length} found`)];let x={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};h.$version<7&&(x.function=i.function),Rn(i.value)==="object"&&(x=i.value);let E=[];for(let T=0;T<t.length;T++)E=E.concat(v({array:t,arrayIndex:T,value:t[T],valueSpec:x,style:l,styleSpec:h,key:`${p}[${T}]`}));return E}function rd(n){const t=n.key,i=n.value,l=n.valueSpec;let h=Rn(i);if(h==="number"&&i!=i&&(h="NaN"),h!=="number")return[new Ot(t,i,`number expected, ${h} found`)];if("minimum"in l){let p=l.minimum;if(Rn(l.minimum)==="array"&&(p=l.minimum[n.arrayIndex]),i<p)return[new Ot(t,i,`${i} is less than the minimum value ${p}`)]}if("maximum"in l){let p=l.maximum;if(Rn(l.maximum)==="array"&&(p=l.maximum[n.arrayIndex]),i>p)return[new Ot(t,i,`${i} is greater than the maximum value ${p}`)]}return[]}function Gl(n){const t=n.valueSpec,i=Vi(n.value.type);let l,h,p,v={};const x=i!=="categorical"&&n.value.property===void 0,E=!x,T=Rn(n.value.stops)==="array"&&Rn(n.value.stops[0])==="array"&&Rn(n.value.stops[0][0])==="object",k=Kr({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(V){if(i==="identity")return[new Ot(V.key,V.value,'identity function may not have a "stops" property')];let N=[];const G=V.value;return N=N.concat(Ip({key:V.key,value:G,valueSpec:V.valueSpec,style:V.style,styleSpec:V.styleSpec,arrayElementValidator:P})),Rn(G)==="array"&&G.length===0&&N.push(new Ot(V.key,G,"array must have at least one stop")),N},default:function(V){return _r({key:V.key,value:V.value,valueSpec:t,style:V.style,styleSpec:V.styleSpec})}}});return i==="identity"&&x&&k.push(new Ot(n.key,n.value,'missing required property "property"')),i==="identity"||n.value.stops||k.push(new Ot(n.key,n.value,'missing required property "stops"')),i==="exponential"&&n.valueSpec.expression&&!du(n.valueSpec)&&k.push(new Ot(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(E&&!$a(n.valueSpec)?k.push(new Ot(n.key,n.value,"property functions not supported")):x&&!qo(n.valueSpec)&&k.push(new Ot(n.key,n.value,"zoom functions not supported"))),i!=="categorical"&&!T||n.value.property!==void 0||k.push(new Ot(n.key,n.value,'"property" property is required')),k;function P(V){let N=[];const G=V.value,X=V.key;if(Rn(G)!=="array")return[new Ot(X,G,`array expected, ${Rn(G)} found`)];if(G.length!==2)return[new Ot(X,G,`array length 2 expected, length ${G.length} found`)];if(T){if(Rn(G[0])!=="object")return[new Ot(X,G,`object expected, ${Rn(G[0])} found`)];if(G[0].zoom===void 0)return[new Ot(X,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new Ot(X,G,"object stop key must have value")];const le=Vi(G[0].zoom);if(typeof le!="number")return[new Ot(X,G[0].zoom,"stop zoom values must be numbers")];if(p&&p>le)return[new Ot(X,G[0].zoom,"stop zoom values must appear in ascending order")];le!==p&&(p=le,h=void 0,v={}),N=N.concat(Kr({key:`${X}[0]`,value:G[0],valueSpec:{zoom:{}},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{zoom:rd,value:D}}))}else N=N.concat(D({key:`${X}[0]`,value:G[0],valueSpec:{},style:V.style,styleSpec:V.styleSpec},G));return Ua(fs(G[1]))?N.concat([new Ot(`${X}[1]`,G[1],"expressions are not allowed in function stops.")]):N.concat(_r({key:`${X}[1]`,value:G[1],valueSpec:t,style:V.style,styleSpec:V.styleSpec}))}function D(V,N){const G=Rn(V.value),X=Vi(V.value),le=V.value!==null?V.value:N;if(l){if(G!==l)return[new Ot(V.key,le,`${G} stop domain type must match previous stop domain type ${l}`)]}else l=G;if(G!=="number"&&G!=="string"&&G!=="boolean"&&typeof X!="number"&&typeof X!="string"&&typeof X!="boolean")return[new Ot(V.key,le,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&i!=="categorical"){let ye=`number expected, ${G} found`;return $a(t)&&i===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ot(V.key,le,ye)]}return i!=="categorical"||G!=="number"||typeof X=="number"&&isFinite(X)&&Math.floor(X)===X?i!=="categorical"&&G==="number"&&typeof X=="number"&&typeof h=="number"&&h!==void 0&&X<h?[new Ot(V.key,le,"stop domain values must appear in ascending order")]:(h=X,i==="categorical"&&X in v?[new Ot(V.key,le,"stop domain values must be unique")]:(v[X]=!0,[])):[new Ot(V.key,le,`integer expected, found ${String(X)}`)]}}function Ga(n){const t=(n.expressionContext==="property"?ta:ja)(fs(n.value),n.valueSpec);if(t.result==="error")return t.value.map(l=>new Ot(`${n.key}${l.key}`,n.value,l.message));const i=t.value.expression||t.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!i.outputDefined())return[new Ot(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!Dl(i))return[new Ot(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter")return Ap(i,n);if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!iu(i,["zoom","feature-state"]))return[new Ot(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!Ll(i))return[new Ot(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ap(n,t){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const h of t.valueSpec.expression.parameters)i.delete(h);if(i.size===0)return[];const l=[];return n instanceof ps&&i.has(n.name)?[new Ot(t.key,t.value,`["${n.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(n.eachChild(h=>{l.push(...Ap(h,t))}),l)}function vu(n){const t=n.key,i=n.value,l=n.valueSpec,h=[];return Array.isArray(l.values)?l.values.indexOf(Vi(i))===-1&&h.push(new Ot(t,i,`expected one of [${l.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(l.values).indexOf(Vi(i))===-1&&h.push(new Ot(t,i,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(i)} found`)),h}function od(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const t of n.slice(1))if(!od(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function _u(n,t="fill"){if(n==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};od(n)||(n=xu(n));const i=n;let l=!0;try{l=function(T){if(!or(T))return T;let k=fs(T);return Zl(k),k=ql(k),k}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const h=et[`filter_${t}`],p=ja(l,h);let v=null;if(p.result==="error")throw new Error(p.value.map(T=>`${T.key}: ${T.message}`).join(", "));v=(T,k,P)=>p.value.evaluate(T,k,{},P);let x=null,E=null;if(l!==i){const T=ja(i,h);if(T.result==="error")throw new Error(T.value.map(k=>`${k.key}: ${k.message}`).join(", "));x=(k,P,D,V,N)=>T.value.evaluate(k,P,{},D,void 0,void 0,V,N),E=!Ll(T.value.expression)}return{filter:v,dynamicFilter:x||void 0,needGeometry:kp(l),needFeature:!!E}}function ql(n){if(!Array.isArray(n))return n;const t=function(i){if(yu.has(i[0])){for(let l=1;l<i.length;l++)if(or(i[l]))return!0}return i}(n);return t===!0?t:t.map(i=>ql(i))}function Zl(n){let t=!1;const i=[];if(n[0]==="case"){for(let l=1;l<n.length-1;l+=2)t=t||or(n[l]),i.push(n[l+1]);i.push(n[n.length-1])}else if(n[0]==="match"){t=t||or(n[1]);for(let l=2;l<n.length-1;l+=2)i.push(n[l+1]);i.push(n[n.length-1])}else if(n[0]==="step"){t=t||or(n[1]);for(let l=1;l<n.length-1;l+=2)i.push(n[l+1])}t&&(n.length=0,n.push("any",...i));for(let l=1;l<n.length;l++)Zl(n[l])}function or(n){if(!Array.isArray(n))return!1;if((t=n[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let i=1;i<n.length;i++)if(or(n[i]))return!0;return!1}const yu=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function uv(n,t){return n<t?-1:n>t?1:0}function kp(n){if(!Array.isArray(n))return!1;if(n[0]==="within")return!0;for(let t=1;t<n.length;t++)if(kp(n[t]))return!0;return!1}function xu(n){if(!n)return!0;const t=n[0];return n.length<=1?t!=="any":t==="=="?sd(n[1],n[2],"=="):t==="!="?qa(sd(n[1],n[2],"==")):t==="<"||t===">"||t==="<="||t===">="?sd(n[1],n[2],t):t==="any"?(i=n.slice(1),["any"].concat(i.map(xu))):t==="all"?["all"].concat(n.slice(1).map(xu)):t==="none"?["all"].concat(n.slice(1).map(xu).map(qa)):t==="in"?bu(n[1],n.slice(2)):t==="!in"?qa(bu(n[1],n.slice(2))):t==="has"?Mp(n[1]):t==="!has"?qa(Mp(n[1])):t!=="within"||n;var i}function sd(n,t,i){switch(n){case"$type":return[`filter-type-${i}`,t];case"$id":return[`filter-id-${i}`,t];default:return[`filter-${i}`,n,t]}}function bu(n,t){if(t.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(i=>typeof i!=typeof t[0])?["filter-in-large",n,["literal",t.sort(uv)]]:["filter-in-small",n,["literal",t]]}}function Mp(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function qa(n){return["!",n]}function ad(n){return od(fs(n.value))?Ga(jo({},n,{expressionContext:"filter",valueSpec:n.styleSpec[`filter_${n.layerType||"fill"}`]})):Pp(n)}function Pp(n){const t=n.value,i=n.key;if(Rn(t)!=="array")return[new Ot(i,t,`array expected, ${Rn(t)} found`)];const l=n.styleSpec;let h,p=[];if(t.length<1)return[new Ot(i,t,"filter array must have at least 1 element")];switch(p=p.concat(vu({key:`${i}[0]`,value:t[0],valueSpec:l.filter_operator,style:n.style,styleSpec:n.styleSpec})),Vi(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Vi(t[1])==="$type"&&p.push(new Ot(i,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&p.push(new Ot(i,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=Rn(t[1]),h!=="string"&&p.push(new Ot(`${i}[1]`,t[1],`string expected, ${h} found`)));for(let v=2;v<t.length;v++)h=Rn(t[v]),Vi(t[1])==="$type"?p=p.concat(vu({key:`${i}[${v}]`,value:t[v],valueSpec:l.geometry_type,style:n.style,styleSpec:n.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&p.push(new Ot(`${i}[${v}]`,t[v],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let v=1;v<t.length;v++)p=p.concat(Pp({key:`${i}[${v}]`,value:t[v],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":h=Rn(t[1]),t.length!==2?p.push(new Ot(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&p.push(new Ot(`${i}[1]`,t[1],`string expected, ${h} found`));break;case"within":h=Rn(t[1]),t.length!==2?p.push(new Ot(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="object"&&p.push(new Ot(`${i}[1]`,t[1],`object expected, ${h} found`))}return p}function wu(n,t){const i=n.key,l=n.style,h=n.styleSpec,p=n.value,v=n.objectKey,x=h[`${t}_${n.layerType}`];if(!x)return[];const E=v.match(/^(.*)-transition$/);if(t==="paint"&&E&&x[E[1]]&&x[E[1]].transition)return _r({key:i,value:p,valueSpec:h.transition,style:l,styleSpec:h});const T=n.valueSpec||x[v];if(!T)return[new Ot(i,p,`unknown property "${v}"`)];let k;if(Rn(p)==="string"&&$a(T)&&!T.tokens&&(k=/^{([^}]+)}$/.exec(p)))return[new Ot(i,p,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(k[1])} }\`.`)];const P=[];return n.layerType==="symbol"&&(v==="text-field"&&l&&!l.glyphs&&P.push(new Ot(i,p,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&fu(fs(p))&&Vi(p.type)==="identity"&&P.push(new Ot(i,p,'"text-font" does not support identity functions'))),P.concat(_r({key:n.key,value:p,valueSpec:T,style:l,styleSpec:h,expressionContext:"property",propertyType:t,propertyKey:v}))}function zp(n){return wu(n,"paint")}function ld(n){return wu(n,"layout")}function cd(n){let t=[];const i=n.value,l=n.key,h=n.style,p=n.styleSpec;i.type||i.ref||t.push(new Ot(l,i,'either "type" or "ref" is required'));let v=Vi(i.type);const x=Vi(i.ref);if(i.id){const E=Vi(i.id);for(let T=0;T<n.arrayIndex;T++){const k=h.layers[T];Vi(k.id)===E&&t.push(new Ot(l,i.id,`duplicate layer id "${i.id}", previously used at line ${k.id.__line__}`))}}if("ref"in i){let E;["type","source","source-layer","filter","layout"].forEach(T=>{T in i&&t.push(new Ot(l,i[T],`"${T}" is prohibited for ref layers`))}),h.layers.forEach(T=>{Vi(T.id)===x&&(E=T)}),E?E.ref?t.push(new Ot(l,i.ref,"ref cannot reference another ref layer")):v=Vi(E.type):typeof x=="string"&&t.push(new Ot(l,i.ref,`ref layer "${x}" not found`))}else if(v!=="background"&&v!=="sky")if(i.source){const E=h.sources&&h.sources[i.source],T=E&&Vi(E.type);E?T==="vector"&&v==="raster"?t.push(new Ot(l,i.source,`layer "${i.id}" requires a raster source`)):T==="raster"&&v!=="raster"?t.push(new Ot(l,i.source,`layer "${i.id}" requires a vector source`)):T!=="vector"||i["source-layer"]?T==="raster-dem"&&v!=="hillshade"?t.push(new Ot(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||T==="geojson"&&E.lineMetrics||t.push(new Ot(l,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Ot(l,i,`layer "${i.id}" must specify a "source-layer"`)):t.push(new Ot(l,i.source,`source "${i.source}" not found`))}else t.push(new Ot(l,i,'missing required property "source"'));return t=t.concat(Kr({key:l,value:i,valueSpec:p.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>_r({key:`${l}.type`,value:i.type,valueSpec:p.layer.type,style:n.style,styleSpec:n.styleSpec,object:i,objectKey:"type"}),filter:E=>ad(jo({layerType:v},E)),layout:E=>Kr({layer:i,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":T=>ld(jo({layerType:v},T))}}),paint:E=>Kr({layer:i,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":T=>zp(jo({layerType:v},T))}})}})),t}function Za(n){const t=n.value,i=n.key,l=Rn(t);return l!=="string"?[new Ot(i,t,`string expected, ${l} found`)]:[]}const Eu={promoteId:function({key:n,value:t}){if(Rn(t)==="string")return Za({key:n,value:t});{const i=[];for(const l in t)i.push(...Za({key:`${n}.${l}`,value:t[l]}));return i}}};function Wl(n){const t=n.value,i=n.key,l=n.styleSpec,h=n.style;if(!t.type)return[new Ot(i,t,'"type" is required')];const p=Vi(t.type);let v;switch(p){case"vector":case"raster":case"raster-dem":return v=Kr({key:i,value:t,valueSpec:l[`source_${p.replace("-","_")}`],style:n.style,styleSpec:l,objectElementValidators:Eu}),v;case"geojson":if(v=Kr({key:i,value:t,valueSpec:l.source_geojson,style:h,styleSpec:l,objectElementValidators:Eu}),t.cluster)for(const x in t.clusterProperties){const[E,T]=t.clusterProperties[x],k=typeof E=="string"?[E,["accumulated"],["get",x]]:E;v.push(...Ga({key:`${i}.${x}.map`,value:T,expressionContext:"cluster-map"})),v.push(...Ga({key:`${i}.${x}.reduce`,value:k,expressionContext:"cluster-reduce"}))}return v;case"video":return Kr({key:i,value:t,valueSpec:l.source_video,style:h,styleSpec:l});case"image":return Kr({key:i,value:t,valueSpec:l.source_image,style:h,styleSpec:l});case"canvas":return[new Ot(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vu({key:`${i}.type`,value:t.type,valueSpec:{values:Lp(l)},style:h,styleSpec:l})}}function Lp(n){return n.source.reduce((t,i)=>{const l=n[i];return l.type.type==="enum"&&(t=t.concat(Object.keys(l.type.values))),t},[])}function Dp(n){const t=n.value,i=n.styleSpec,l=i.light,h=n.style;let p=[];const v=Rn(t);if(t===void 0)return p;if(v!=="object")return p=p.concat([new Ot("light",t,`object expected, ${v} found`)]),p;for(const x in t){const E=x.match(/^(.*)-transition$/);p=p.concat(E&&l[E[1]]&&l[E[1]].transition?_r({key:x,value:t[x],valueSpec:i.transition,style:h,styleSpec:i}):l[x]?_r({key:x,value:t[x],valueSpec:l[x],style:h,styleSpec:i}):[new Ot(x,t[x],`unknown property "${x}"`)])}return p}function ud(n){const t=n.value,i=n.key,l=n.style,h=n.styleSpec,p=h.terrain;let v=[];const x=Rn(t);if(t===void 0)return v;if(x!=="object")return v=v.concat([new Ot("terrain",t,`object expected, ${x} found`)]),v;for(const E in t){const T=E.match(/^(.*)-transition$/);v=v.concat(T&&p[T[1]]&&p[T[1]].transition?_r({key:E,value:t[E],valueSpec:h.transition,style:l,styleSpec:h}):p[E]?_r({key:E,value:t[E],valueSpec:p[E],style:l,styleSpec:h}):[new Ot(E,t[E],`unknown property "${E}"`)])}if(t.source){const E=l.sources&&l.sources[t.source],T=E&&Vi(E.type);E?T!=="raster-dem"&&v.push(new Ot(i,t.source,`terrain cannot be used with a source of type ${String(T)}, it only be used with a "raster-dem" source type`)):v.push(new Ot(i,t.source,`source "${t.source}" not found`))}else v.push(new Ot(i,t,'terrain is missing required property "source"'));return v}function Rp(n){const t=n.value,i=n.style,l=n.styleSpec,h=l.fog;let p=[];const v=Rn(t);if(t===void 0)return p;if(v!=="object")return p=p.concat([new Ot("fog",t,`object expected, ${v} found`)]),p;for(const x in t){const E=x.match(/^(.*)-transition$/);p=p.concat(E&&h[E[1]]&&h[E[1]].transition?_r({key:x,value:t[x],valueSpec:l.transition,style:i,styleSpec:l}):h[x]?_r({key:x,value:t[x],valueSpec:h[x],style:i,styleSpec:l}):[new Ot(x,t[x],`unknown property "${x}"`)])}return p}const Su={"*":()=>[],array:Ip,boolean:function(n){const t=n.value,i=n.key,l=Rn(t);return l!=="boolean"?[new Ot(i,t,`boolean expected, ${l} found`)]:[]},number:rd,color:function(n){const t=n.key,i=n.value,l=Rn(i);return l!=="string"?[new Ot(t,i,`color expected, ${l} found`)]:Mh(i)===null?[new Ot(t,i,`color expected, "${i}" found`)]:[]},enum:vu,filter:ad,function:Gl,layer:cd,object:Kr,source:Wl,light:Dp,terrain:ud,fog:Rp,string:Za,formatted:function(n){return Za(n).length===0?[]:Ga(n)},resolvedImage:function(n){return Za(n).length===0?[]:Ga(n)},projection:function(n){const t=n.value,i=n.styleSpec,l=i.projection,h=n.style;let p=[];const v=Rn(t);if(v==="object")for(const x in t)p=p.concat(_r({key:x,value:t[x],valueSpec:l[x],style:h,styleSpec:i}));else v!=="string"&&(p=p.concat([new Ot("projection",t,`object or string expected, ${v} found`)]));return p}};function _r(n){const t=n.value,i=n.valueSpec,l=n.styleSpec;return i.expression&&fu(Vi(t))?Gl(n):i.expression&&Ua(fs(t))?Ga(n):i.type&&Su[i.type]?Su[i.type](n):Kr(jo({},n,{valueSpec:i.type?l[i.type]:i}))}function hv(n){const t=n.value,i=n.key,l=Za(n);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new Ot(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new Ot(i,t,'"glyphs" url must include a "{range}" token'))),l}function Bp(n,t=et){return Zo(_r({key:"",value:n,valueSpec:t.$root,styleSpec:t,style:n,objectElementValidators:{glyphs:hv,"*":()=>[]}}))}const dv=n=>Zo(zp(n)),Op=n=>Zo(ld(n));function Zo(n){return n.slice().sort((t,i)=>t.line&&i.line?t.line-i.line:0)}function Fp(n,t){let i=!1;if(t&&t.length)for(const l of t)n.fire(new ds(new Error(l.message))),i=!0;return i}var Wa=Eo;function Eo(n,t,i){var l=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var h=new Int32Array(this.arrayBuffer);n=h[0],this.d=(t=h[1])+2*(i=h[2]);for(var p=0;p<this.d*this.d;p++){var v=h[3+p],x=h[3+p+1];l.push(v===x?null:h.subarray(v,x))}var E=h[3+l.length+1];this.keys=h.subarray(h[3+l.length],E),this.bboxes=h.subarray(E),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var T=0;T<this.d*this.d;T++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=n,this.padding=i,this.scale=t/n,this.uid=0;var k=i/t*n;this.min=-k,this.max=n+k}Eo.prototype.insert=function(n,t,i,l,h){this._forEachCell(t,i,l,h,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(h)},Eo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Eo.prototype._insertCell=function(n,t,i,l,h,p){this.cells[h].push(p)},Eo.prototype.query=function(n,t,i,l,h){var p=this.min,v=this.max;if(n<=p&&t<=p&&v<=i&&v<=l&&!h)return Array.prototype.slice.call(this.keys);var x=[];return this._forEachCell(n,t,i,l,this._queryCell,x,{},h),x},Eo.prototype._queryCell=function(n,t,i,l,h,p,v,x){var E=this.cells[h];if(E!==null)for(var T=this.keys,k=this.bboxes,P=0;P<E.length;P++){var D=E[P];if(v[D]===void 0){var V=4*D;(x?x(k[V+0],k[V+1],k[V+2],k[V+3]):n<=k[V+2]&&t<=k[V+3]&&i>=k[V+0]&&l>=k[V+1])?(v[D]=!0,p.push(T[D])):v[D]=!1}}},Eo.prototype._forEachCell=function(n,t,i,l,h,p,v,x){for(var E=this._convertToCellCoord(n),T=this._convertToCellCoord(t),k=this._convertToCellCoord(i),P=this._convertToCellCoord(l),D=E;D<=k;D++)for(var V=T;V<=P;V++){var N=this.d*V+D;if((!x||x(this._convertFromCellCoord(D),this._convertFromCellCoord(V),this._convertFromCellCoord(D+1),this._convertFromCellCoord(V+1)))&&h.call(this,n,t,i,l,N,p,v,x))return}},Eo.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},Eo.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},Eo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var h=new Int32Array(t+i+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var p=t,v=0;v<n.length;v++){var x=n[v];h[3+v]=p,h.set(x,p),p+=x.length}return h[3+n.length]=p,h.set(this.keys,p),h[3+n.length+1]=p+=this.keys.length,h.set(this.bboxes,p),p+=this.bboxes.length,h.buffer};const Tu={};function $t(n,t,i={}){Object.defineProperty(n,"_classRegistryKey",{value:t,writeable:!1}),Tu[t]={klass:n,omit:i.omit||[]}}$t(Object,"Object"),Wa.serialize=function(n,t){const i=n.toArrayBuffer();return t&&t.push(i),{buffer:i}},Wa.deserialize=function(n){return new Wa(n.buffer)},Object.defineProperty(Wa,"name",{value:"Grid"}),$t(Wa,"Grid"),$t(Ri,"Color"),$t(Error,"Error"),$t(Hi,"AJAXError"),$t(Ar,"ResolvedImage"),$t(Ul,"StylePropertyFunction"),$t(mu,"StyleExpression",{omit:["_evaluator"]}),$t(ea,"ZoomDependentExpression"),$t(gu,"ZoomConstantExpression"),$t(ps,"CompoundExpression",{omit:["_evaluate"]});for(const n in Va)Tu[Va[n]._classRegistryKey]||$t(Va[n],`Expression${n}`);function Vp(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function Hl(n){return w.ImageBitmap&&n instanceof w.ImageBitmap}function Xl(n,t){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp)return n;if(Vp(n)||Hl(n))return t&&t.push(n),n;if(ArrayBuffer.isView(n)){const i=n;return t&&t.push(i.buffer),i}if(n instanceof w.ImageData)return t&&t.push(n.data.buffer),n;if(Array.isArray(n)){const i=[];for(const l of n)i.push(Xl(l,t));return i}if(typeof n=="object"){const i=n.constructor,l=i._classRegistryKey;if(!l)throw new Error(`can't serialize object of unregistered class ${l}`);const h=i.serialize?i.serialize(n,t):{};if(!i.serialize){for(const p in n)n.hasOwnProperty(p)&&(Tu[l].omit.indexOf(p)>=0||(h[p]=Xl(n[p],t)));n instanceof Error&&(h.message=n.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(h.$name=l),h}throw new Error("can't serialize object of type "+typeof n)}function Yl(n){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||Vp(n)||Hl(n)||ArrayBuffer.isView(n)||n instanceof w.ImageData)return n;if(Array.isArray(n))return n.map(Yl);if(typeof n=="object"){const t=n.$name||"Object",{klass:i}=Tu[t];if(!i)throw new Error(`can't deserialize unregistered class ${t}`);if(i.deserialize)return i.deserialize(n);const l=Object.create(i.prototype);for(const h of Object.keys(n))h!=="$name"&&(l[h]=Yl(n[h]));return l}throw new Error("can't deserialize object of type "+typeof n)}const Kl=n=>n>=1536&&n<=1791,Np=n=>n>=1872&&n<=1919,hd=n=>n>=2208&&n<=2303,$p=n=>n>=11904&&n<=12031,dd=n=>n>=12032&&n<=12255,fd=n=>n>=12272&&n<=12287,Jl=n=>n>=12288&&n<=12351,Cu=n=>n>=12352&&n<=12447,Ha=n=>n>=12448&&n<=12543,Iu=n=>n>=12544&&n<=12591,Up=n=>n>=12704&&n<=12735,jp=n=>n>=12736&&n<=12783,pd=n=>n>=12784&&n<=12799,Gp=n=>n>=12800&&n<=13055,qp=n=>n>=13056&&n<=13311,Zp=n=>n>=13312&&n<=19903,md=n=>n>=19968&&n<=40959,Wp=n=>n>=40960&&n<=42127,Hp=n=>n>=42128&&n<=42191,Xp=n=>n>=44032&&n<=55215,Yp=n=>n>=63744&&n<=64255,Au=n=>n>=64336&&n<=65023,Ql=n=>n>=65040&&n<=65055,f=n=>n>=65072&&n<=65103,r=n=>n>=65104&&n<=65135,u=n=>n>=65136&&n<=65279,m=n=>n>=65280&&n<=65519;function y(n){for(const t of n)if(I(t.charCodeAt(0)))return!0;return!1}function b(n){for(const t of n)if(!C(t.charCodeAt(0)))return!1;return!0}function C(n){return!(Kl(n)||Np(n)||hd(n)||Au(n)||u(n))}function I(n){return!(n!==746&&n!==747&&(n<4352||!(Up(n)||Iu(n)||f(n)&&!(n>=65097&&n<=65103)||Yp(n)||qp(n)||$p(n)||jp(n)||!(!Jl(n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||Zp(n)||md(n)||Gp(n)||(t=>t>=12592&&t<=12687)(n)||(t=>t>=43360&&t<=43391)(n)||(t=>t>=55216&&t<=55295)(n)||(t=>t>=4352&&t<=4607)(n)||Xp(n)||Cu(n)||fd(n)||(t=>t>=12688&&t<=12703)(n)||dd(n)||pd(n)||Ha(n)&&n!==12540||!(!m(n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!r(n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||(t=>t>=5120&&t<=5759)(n)||(t=>t>=6320&&t<=6399)(n)||Ql(n)||(t=>t>=19904&&t<=19967)(n)||Wp(n)||Hp(n))))}function M(n){return!(I(n)||function(t){return!!((i=>i>=128&&i<=255)(t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||(i=>i>=8192&&i<=8303)(t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||(i=>i>=8448&&i<=8527)(t)||(i=>i>=8528&&i<=8591)(t)||(i=>i>=8960&&i<=9215)(t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||(i=>i>=9216&&i<=9279)(t)&&t!==9251||(i=>i>=9280&&i<=9311)(t)||(i=>i>=9312&&i<=9471)(t)||(i=>i>=9632&&i<=9727)(t)||(i=>i>=9728&&i<=9983)(t)&&!(t>=9754&&t<=9759)||(i=>i>=11008&&i<=11263)(t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Jl(t)||Ha(t)||(i=>i>=57344&&i<=63743)(t)||f(t)||r(t)||m(t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(n))}function B(n){return n>=1424&&n<=2303||Au(n)||u(n)}function O(n,t){return!(!t&&B(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||(i=>i>=6016&&i<=6143)(n))}function j(n){for(const t of n)if(B(t.charCodeAt(0)))return!0;return!1}const H="deferred",Q="loading",J="loaded";let ee=null,te="unavailable",W=null;const ue=function(n){n&&typeof n=="string"&&n.indexOf("NetworkError")>-1&&(te="error"),ee&&ee(n)};function ae(){pe.fire(new ti("pluginStateChange",{pluginStatus:te,pluginURL:W}))}const pe=new Uo,Ce=function(){return te},we=function(){if(te!==H||!W)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");te=Q,ae(),W&&yo({url:W},n=>{n?ue(n):(te=J,ae())})},Ae={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>te===J||Ae.applyArabicShaping!=null,isLoading:()=>te===Q,setState(n){te=n.pluginStatus,W=n.pluginURL},isParsed:()=>Ae.applyArabicShaping!=null&&Ae.processBidirectionalText!=null&&Ae.processStyledBidirectionalText!=null,getPluginURL:()=>W};class Be{constructor(t,i){this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(t){return function(i,l){for(const h of i)if(!O(h.charCodeAt(0),l))return!1;return!0}(t,Ae.isLoaded())}}class $e{constructor(t,i){this.property=t,this.value=i,this.expression=function(l,h){if(fu(l))return new Ul(l,h);if(Ua(l)){const p=ta(l,h);if(p.result==="error")throw new Error(p.value.map(v=>`${v.key}: ${v.message}`).join(", "));return p.value}{let p=l;return typeof l=="string"&&h.type==="color"&&(p=Ri.parse(l)),{kind:"constant",evaluate:()=>p}}}(i===void 0?t.specification.default:i,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,i,l){return this.property.possiblyEvaluate(this,t,i,l)}}class Ge{constructor(t){this.property=t,this.value=new $e(t,void 0)}transitioned(t,i){return new Fe(this.property,this.value,i,pt({},t.transition,this.transition),t.now)}untransitioned(){return new Fe(this.property,this.value,null,{},0)}}class wt{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Dn(this._values[t].value.value)}setValue(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new Ge(this._values[t].property)),this._values[t].value=new $e(this._values[t].property,i===null?void 0:Dn(i))}getTransition(t){return Dn(this._values[t].transition)}setTransition(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new Ge(this._values[t].property)),this._values[t].transition=Dn(i)||void 0}serialize(){const t={};for(const i of Object.keys(this._values)){const l=this.getValue(i);l!==void 0&&(t[i]=l);const h=this.getTransition(i);h!==void 0&&(t[`${i}-transition`]=h)}return t}transitioned(t,i){const l=new rt(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].transitioned(t,i._values[h]);return l}untransitioned(){const t=new rt(this._properties);for(const i of Object.keys(this._values))t._values[i]=this._values[i].untransitioned();return t}}class Fe{constructor(t,i,l,h,p){const v=h.delay||0,x=h.duration||0;p=p||0,this.property=t,this.value=i,this.begin=p+v,this.end=this.begin+x,t.specification.transition&&(h.delay||h.duration)&&(this.prior=l)}possiblyEvaluate(t,i,l){const h=t.now||0,p=this.value.possiblyEvaluate(t,i,l),v=this.prior;if(v){if(h>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(h<this.begin)return v.possiblyEvaluate(t,i,l);{const x=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(t,i,l),p,ze(x))}}return p}}class rt{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,i,l){const h=new Ue(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(t,i,l);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class He{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return Dn(this._values[t].value)}setValue(t,i){this._values[t]=new $e(this._values[t].property,i===null?void 0:Dn(i))}serialize(){const t={};for(const i of Object.keys(this._values)){const l=this.getValue(i);l!==void 0&&(t[i]=l)}return t}possiblyEvaluate(t,i,l){const h=new Ue(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(t,i,l);return h}}class ht{constructor(t,i,l){this.property=t,this.value=i,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,i,l,h){return this.property.evaluate(this.value,this.parameters,t,i,l,h)}}class Ue{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Le{constructor(t){this.specification=t}possiblyEvaluate(t,i){return t.expression.evaluate(i)}interpolate(t,i,l){const h=Rl[this.specification.type];return h?h(t,i,l):t}}class Ze{constructor(t,i){this.specification=t,this.overrides=i}possiblyEvaluate(t,i,l,h){return new ht(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(i,null,{},l,h)}:t.expression,i)}interpolate(t,i,l){if(t.value.kind!=="constant"||i.value.kind!=="constant")return t;if(t.value.value===void 0||i.value.value===void 0)return new ht(this,{kind:"constant",value:void 0},t.parameters);const h=Rl[this.specification.type];return h?new ht(this,{kind:"constant",value:h(t.value.value,i.value.value,l)},t.parameters):t}evaluate(t,i,l,h,p,v){return t.kind==="constant"?t.value:t.evaluate(i,l,h,p,v)}}class lt{constructor(t){this.specification=t}possiblyEvaluate(t,i,l,h){return!!t.expression.evaluate(i,null,{},l,h)}interpolate(){return!1}}class mt{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new Be(0,{});for(const l in t){const h=t[l];h.specification.overridable&&this.overridableProperties.push(l);const p=this.defaultPropertyValues[l]=new $e(h,void 0),v=this.defaultTransitionablePropertyValues[l]=new Ge(h);this.defaultTransitioningPropertyValues[l]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=p.possiblyEvaluate(i)}}}function Ht(n,t){return 256*(n=nt(Math.floor(n),0,255))+nt(Math.floor(t),0,255)}$t(Ze,"DataDrivenProperty"),$t(Le,"DataConstantProperty"),$t(lt,"ColorRampProperty");const vn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class jt{constructor(t,i){this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Vt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,i){return t._trim(),i&&(t.isTransferred=!0,i.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const i=Object.create(this.prototype);return i.arrayBuffer=t.arrayBuffer,i.length=t.length,i.capacity=t.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Xt(n,t=1){let i=0,l=0;return{members:n.map(h=>{const p=vn[h.type].BYTES_PER_ELEMENT,v=i=In(i,Math.max(t,p)),x=h.components||1;return l=Math.max(l,p),i+=p*x,{name:h.name,type:h.type,components:x,offset:v}}),size:In(i,Math.max(l,t)),alignment:t}}function In(n,t){return Math.ceil(n/t)*t}class en extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i){const l=this.length;return this.resize(l+1),this.emplace(l,t,i)}emplace(t,i,l){const h=2*t;return this.int16[h+0]=i,this.int16[h+1]=l,t}}en.prototype.bytesPerElement=4,$t(en,"StructArrayLayout2i4");class Wn extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,l)}emplace(t,i,l,h){const p=3*t;return this.int16[p+0]=i,this.int16[p+1]=l,this.int16[p+2]=h,t}}Wn.prototype.bytesPerElement=6,$t(Wn,"StructArrayLayout3i6");class ni extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=4*t;return this.int16[v+0]=i,this.int16[v+1]=l,this.int16[v+2]=h,this.int16[v+3]=p,t}}ni.prototype.bytesPerElement=8,$t(ni,"StructArrayLayout4i8");class ui extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,x){const E=this.length;return this.resize(E+1),this.emplace(E,t,i,l,h,p,v,x)}emplace(t,i,l,h,p,v,x,E){const T=6*t,k=12*t,P=3*t;return this.int16[T+0]=i,this.int16[T+1]=l,this.uint8[k+4]=h,this.uint8[k+5]=p,this.uint8[k+6]=v,this.uint8[k+7]=x,this.float32[P+2]=E,t}}ui.prototype.bytesPerElement=12,$t(ui,"StructArrayLayout2i4ub1f12");class oi extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=4*t;return this.float32[v+0]=i,this.float32[v+1]=l,this.float32[v+2]=h,this.float32[v+3]=p,t}}oi.prototype.bytesPerElement=16,$t(oi,"StructArrayLayout4f16");class Ni extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,l,h,p)}emplace(t,i,l,h,p,v){const x=6*t,E=3*t;return this.uint16[x+0]=i,this.uint16[x+1]=l,this.uint16[x+2]=h,this.uint16[x+3]=p,this.float32[E+2]=v,t}}Ni.prototype.bytesPerElement=12,$t(Ni,"StructArrayLayout4ui1f12");class Br extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=4*t;return this.uint16[v+0]=i,this.uint16[v+1]=l,this.uint16[v+2]=h,this.uint16[v+3]=p,t}}Br.prototype.bytesPerElement=8,$t(Br,"StructArrayLayout4ui8");class lo extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,i,l,h,p,v)}emplace(t,i,l,h,p,v,x){const E=6*t;return this.int16[E+0]=i,this.int16[E+1]=l,this.int16[E+2]=h,this.int16[E+3]=p,this.int16[E+4]=v,this.int16[E+5]=x,t}}lo.prototype.bytesPerElement=12,$t(lo,"StructArrayLayout6i12");class Wo extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,x,E,T,k,P,D){const V=this.length;return this.resize(V+1),this.emplace(V,t,i,l,h,p,v,x,E,T,k,P,D)}emplace(t,i,l,h,p,v,x,E,T,k,P,D,V){const N=12*t;return this.int16[N+0]=i,this.int16[N+1]=l,this.int16[N+2]=h,this.int16[N+3]=p,this.uint16[N+4]=v,this.uint16[N+5]=x,this.uint16[N+6]=E,this.uint16[N+7]=T,this.int16[N+8]=k,this.int16[N+9]=P,this.int16[N+10]=D,this.int16[N+11]=V,t}}Wo.prototype.bytesPerElement=24,$t(Wo,"StructArrayLayout4i4ui4i24");class _i extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,i,l,h,p,v)}emplace(t,i,l,h,p,v,x){const E=10*t,T=5*t;return this.int16[E+0]=i,this.int16[E+1]=l,this.int16[E+2]=h,this.float32[T+2]=p,this.float32[T+3]=v,this.float32[T+4]=x,t}}_i.prototype.bytesPerElement=20,$t(_i,"StructArrayLayout3i3f20");class si extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint32[1*t+0]=i,t}}si.prototype.bytesPerElement=4,$t(si,"StructArrayLayout1ul4");class $n extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,x,E,T,k,P,D,V){const N=this.length;return this.resize(N+1),this.emplace(N,t,i,l,h,p,v,x,E,T,k,P,D,V)}emplace(t,i,l,h,p,v,x,E,T,k,P,D,V,N){const G=20*t,X=10*t;return this.int16[G+0]=i,this.int16[G+1]=l,this.int16[G+2]=h,this.int16[G+3]=p,this.int16[G+4]=v,this.float32[X+3]=x,this.float32[X+4]=E,this.float32[X+5]=T,this.float32[X+6]=k,this.int16[G+14]=P,this.uint32[X+8]=D,this.uint16[G+18]=V,this.uint16[G+19]=N,t}}$n.prototype.bytesPerElement=40,$t($n,"StructArrayLayout5i4f1i1ul2ui40");class ki extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,x){const E=this.length;return this.resize(E+1),this.emplace(E,t,i,l,h,p,v,x)}emplace(t,i,l,h,p,v,x,E){const T=8*t;return this.int16[T+0]=i,this.int16[T+1]=l,this.int16[T+2]=h,this.int16[T+4]=p,this.int16[T+5]=v,this.int16[T+6]=x,this.int16[T+7]=E,t}}ki.prototype.bytesPerElement=16,$t(ki,"StructArrayLayout3i2i2i16");class yr extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,l,h,p)}emplace(t,i,l,h,p,v){const x=4*t,E=8*t;return this.float32[x+0]=i,this.float32[x+1]=l,this.float32[x+2]=h,this.int16[E+6]=p,this.int16[E+7]=v,t}}yr.prototype.bytesPerElement=16,$t(yr,"StructArrayLayout2f1f2i16");class pi extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=12*t,x=3*t;return this.uint8[v+0]=i,this.uint8[v+1]=l,this.float32[x+1]=h,this.float32[x+2]=p,t}}pi.prototype.bytesPerElement=12,$t(pi,"StructArrayLayout2ub2f12");class xr extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,l)}emplace(t,i,l,h){const p=3*t;return this.float32[p+0]=i,this.float32[p+1]=l,this.float32[p+2]=h,t}}xr.prototype.bytesPerElement=12,$t(xr,"StructArrayLayout3f12");class br extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,l)}emplace(t,i,l,h){const p=3*t;return this.uint16[p+0]=i,this.uint16[p+1]=l,this.uint16[p+2]=h,t}}br.prototype.bytesPerElement=6,$t(br,"StructArrayLayout3ui6");class _s extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,x,E,T,k,P,D,V,N,G,X,le,ye,re,ge,Te){const xe=this.length;return this.resize(xe+1),this.emplace(xe,t,i,l,h,p,v,x,E,T,k,P,D,V,N,G,X,le,ye,re,ge,Te)}emplace(t,i,l,h,p,v,x,E,T,k,P,D,V,N,G,X,le,ye,re,ge,Te,xe){const je=30*t,Ne=15*t,tt=60*t;return this.int16[je+0]=i,this.int16[je+1]=l,this.int16[je+2]=h,this.float32[Ne+2]=p,this.float32[Ne+3]=v,this.uint16[je+8]=x,this.uint16[je+9]=E,this.uint32[Ne+5]=T,this.uint32[Ne+6]=k,this.uint32[Ne+7]=P,this.uint16[je+16]=D,this.uint16[je+17]=V,this.uint16[je+18]=N,this.float32[Ne+10]=G,this.float32[Ne+11]=X,this.uint8[tt+48]=le,this.uint8[tt+49]=ye,this.uint8[tt+50]=re,this.uint32[Ne+13]=ge,this.int16[je+28]=Te,this.uint8[tt+58]=xe,t}}_s.prototype.bytesPerElement=60,$t(_s,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Xa extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p,v,x,E,T,k,P,D,V,N,G,X,le,ye,re,ge,Te,xe,je,Ne,tt,vt,We,it,ot,dt){const _t=this.length;return this.resize(_t+1),this.emplace(_t,t,i,l,h,p,v,x,E,T,k,P,D,V,N,G,X,le,ye,re,ge,Te,xe,je,Ne,tt,vt,We,it,ot,dt)}emplace(t,i,l,h,p,v,x,E,T,k,P,D,V,N,G,X,le,ye,re,ge,Te,xe,je,Ne,tt,vt,We,it,ot,dt,_t){const Xe=38*t,It=19*t;return this.int16[Xe+0]=i,this.int16[Xe+1]=l,this.int16[Xe+2]=h,this.float32[It+2]=p,this.float32[It+3]=v,this.int16[Xe+8]=x,this.int16[Xe+9]=E,this.int16[Xe+10]=T,this.int16[Xe+11]=k,this.int16[Xe+12]=P,this.int16[Xe+13]=D,this.uint16[Xe+14]=V,this.uint16[Xe+15]=N,this.uint16[Xe+16]=G,this.uint16[Xe+17]=X,this.uint16[Xe+18]=le,this.uint16[Xe+19]=ye,this.uint16[Xe+20]=re,this.uint16[Xe+21]=ge,this.uint16[Xe+22]=Te,this.uint16[Xe+23]=xe,this.uint16[Xe+24]=je,this.uint16[Xe+25]=Ne,this.uint16[Xe+26]=tt,this.uint16[Xe+27]=vt,this.uint16[Xe+28]=We,this.uint32[It+15]=it,this.float32[It+16]=ot,this.float32[It+17]=dt,this.float32[It+18]=_t,t}}Xa.prototype.bytesPerElement=76,$t(Xa,"StructArrayLayout3i2f6i15ui1ul3f76");class Wr extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.float32[1*t+0]=i,t}}Wr.prototype.bytesPerElement=4,$t(Wr,"StructArrayLayout1f4");class Jr extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,l,h,p){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,l,h,p)}emplace(t,i,l,h,p,v){const x=5*t;return this.float32[x+0]=i,this.float32[x+1]=l,this.float32[x+2]=h,this.float32[x+3]=p,this.float32[x+4]=v,t}}Jr.prototype.bytesPerElement=20,$t(Jr,"StructArrayLayout5f20");class Ho extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,l,h)}emplace(t,i,l,h,p){const v=6*t;return this.uint32[3*t+0]=i,this.uint16[v+2]=l,this.uint16[v+3]=h,this.uint16[v+4]=p,t}}Ho.prototype.bytesPerElement=12,$t(Ho,"StructArrayLayout1ul3ui12");class ys extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i){const l=this.length;return this.resize(l+1),this.emplace(l,t,i)}emplace(t,i,l){const h=2*t;return this.uint16[h+0]=i,this.uint16[h+1]=l,t}}ys.prototype.bytesPerElement=4,$t(ys,"StructArrayLayout2ui4");class xs extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint16[1*t+0]=i,t}}xs.prototype.bytesPerElement=2,$t(xs,"StructArrayLayout1ui2");class Ya extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i){const l=this.length;return this.resize(l+1),this.emplace(l,t,i)}emplace(t,i,l){const h=2*t;return this.float32[h+0]=i,this.float32[h+1]=l,t}}Ya.prototype.bytesPerElement=8,$t(Ya,"StructArrayLayout2f8");class Q0 extends jt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Q0.prototype.size=40;class fv extends $n{get(t){return new Q0(this,t)}}$t(fv,"CollisionBoxArray");class ex extends jt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}ex.prototype.size=60;class tx extends _s{get(t){return new ex(this,t)}}$t(tx,"PlacedSymbolArray");class nx extends jt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(t){this._structArray.uint32[this._pos4+15]=t}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}nx.prototype.size=76;class ix extends Xa{get(t){return new nx(this,t)}}$t(ix,"SymbolInstanceArray");class rx extends Wr{getoffsetX(t){return this.float32[1*t+0]}}$t(rx,"GlyphOffsetArray");class ox extends en{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}$t(ox,"SymbolLineVertexArray");class sx extends jt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}sx.prototype.size=12;class ax extends Ho{get(t){return new sx(this,t)}}$t(ax,"FeatureIndexArray");class lx extends ys{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}$t(lx,"FillExtrusionCentroidArray");const $C=Xt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),UC=Xt([{name:"a_dash",components:4,type:"Uint16"}]);var ec={},jC={get exports(){return ec},set exports(n){ec=n}},pv={};({get exports(){return pv},set exports(n){pv=n}}).exports=function(n,t){var i,l,h,p,v,x,E,T;for(l=n.length-(i=3&n.length),h=t,v=3432918353,x=461845907,T=0;T<l;)E=255&n.charCodeAt(T)|(255&n.charCodeAt(++T))<<8|(255&n.charCodeAt(++T))<<16|(255&n.charCodeAt(++T))<<24,++T,h=27492+(65535&(p=5*(65535&(h=(h^=E=(65535&(E=(E=(65535&E)*v+(((E>>>16)*v&65535)<<16)&4294967295)<<15|E>>>17))*x+(((E>>>16)*x&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(p>>>16)&65535)<<16);switch(E=0,i){case 3:E^=(255&n.charCodeAt(T+2))<<16;case 2:E^=(255&n.charCodeAt(T+1))<<8;case 1:h^=E=(65535&(E=(E=(65535&(E^=255&n.charCodeAt(T)))*v+(((E>>>16)*v&65535)<<16)&4294967295)<<15|E>>>17))*x+(((E>>>16)*x&65535)<<16)&4294967295}return h^=n.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var mv={};({get exports(){return mv},set exports(n){mv=n}}).exports=function(n,t){for(var i,l=n.length,h=t^l,p=0;l>=4;)i=1540483477*(65535&(i=255&n.charCodeAt(p)|(255&n.charCodeAt(++p))<<8|(255&n.charCodeAt(++p))<<16|(255&n.charCodeAt(++p))<<24))+((1540483477*(i>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),l-=4,++p;switch(l){case 3:h^=(255&n.charCodeAt(p+2))<<16;case 2:h^=(255&n.charCodeAt(p+1))<<8;case 1:h=1540483477*(65535&(h^=255&n.charCodeAt(p)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var cx=pv,GC=mv;jC.exports=cx,ec.murmur3=cx,ec.murmur2=GC;class Kp{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,i,l,h){this.ids.push(ux(t)),this.positions.push(i,l,h)}getPositions(t){const i=ux(t);let l=0,h=this.ids.length-1;for(;l<h;){const v=l+h>>1;this.ids[v]>=i?h=v:l=v+1}const p=[];for(;this.ids[l]===i;)p.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return p}static serialize(t,i){const l=new Float64Array(t.ids),h=new Uint32Array(t.positions);return gv(l,h,0,l.length-1),i&&i.push(l.buffer,h.buffer),{ids:l,positions:h}}static deserialize(t){const i=new Kp;return i.ids=t.ids,i.positions=t.positions,i.indexed=!0,i}}function ux(n){const t=+n;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:ec(String(n))}function gv(n,t,i,l){for(;i<l;){const h=n[i+l>>1];let p=i-1,v=l+1;for(;;){do p++;while(n[p]<h);do v--;while(n[v]>h);if(p>=v)break;Jp(n,p,v),Jp(t,3*p,3*v),Jp(t,3*p+1,3*v+1),Jp(t,3*p+2,3*v+2)}v-i<l-v?(gv(n,t,i,v),i=v+1):(gv(n,t,v+1,l),l=v)}}function Jp(n,t,i){const l=n[t];n[t]=n[i],n[i]=l}$t(Kp,"FeaturePositionMap");class na{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,i),this.initialized=!0),!!this.location}}class Qp extends na{constructor(t){super(t),this.current=0}set(t,i,l){this.fetchUniformLocation(t,i)&&this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class hx extends na{constructor(t){super(t),this.current=[0,0,0,0]}set(t,i,l){this.fetchUniformLocation(t,i)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3])))}}class dx extends na{constructor(t){super(t),this.current=Ri.transparent}set(t,i,l){this.fetchUniformLocation(t,i)&&(l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a)))}}const qC=new Float32Array(16),ZC=new Float32Array(9),WC=new Float32Array(4);function vv(n){return[Ht(255*n.r,255*n.g),Ht(255*n.b,255*n.a)]}class gd{constructor(t,i,l){this.value=t,this.uniformNames=i.map(h=>`u_${h}`),this.type=l}setUniform(t,i,l,h,p){i.set(t,p,h.constantOr(this.value))}getBinding(t,i){return this.type==="color"?new dx(t):new Qp(t)}}class ku{constructor(t,i){this.uniformNames=i.map(l=>`u_${l}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,i,l,h,p){const v=p==="u_pattern"||p==="u_dash"?this.pattern:p==="u_pixel_ratio"?this.pixelRatio:null;v&&i.set(t,p,v)}getBinding(t,i){return i==="u_pattern"||i==="u_dash"?new hx(t):new Qp(t)}}class ia{constructor(t,i,l,h){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=i.map(p=>({name:`a_${p}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,i,l,h,p,v){const x=this.paintVertexArray.length,E=this.expression.evaluate(new Be(0),i,{},p,h,v);this.paintVertexArray.resize(t),this._setPaintValue(x,t,E)}updatePaintArray(t,i,l,h,p){const v=this.expression.evaluate({zoom:0},l,h,void 0,p);this._setPaintValue(t,i,v)}_setPaintValue(t,i,l){if(this.type==="color"){const h=vv(l);for(let p=t;p<i;p++)this.paintVertexArray.emplace(p,h[0],h[1])}else{for(let h=t;h<i;h++)this.paintVertexArray.emplace(h,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Xo{constructor(t,i,l,h,p,v){this.expression=t,this.uniformNames=i.map(x=>`u_${x}_t`),this.type=l,this.useIntegerZoom=h,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=i.map(x=>({name:`a_${x}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(t,i,l,h,p,v){const x=this.expression.evaluate(new Be(this.zoom),i,{},p,h,v),E=this.expression.evaluate(new Be(this.zoom+1),i,{},p,h,v),T=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(T,t,x,E)}updatePaintArray(t,i,l,h,p){const v=this.expression.evaluate({zoom:this.zoom},l,h,void 0,p),x=this.expression.evaluate({zoom:this.zoom+1},l,h,void 0,p);this._setPaintValue(t,i,v,x)}_setPaintValue(t,i,l,h){if(this.type==="color"){const p=vv(l),v=vv(h);for(let x=t;x<i;x++)this.paintVertexArray.emplace(x,p[0],p[1],v[0],v[1])}else{for(let p=t;p<i;p++)this.paintVertexArray.emplace(p,l,h);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,i,l,h,p){const v=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,x=nt(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);i.set(t,p,x)}getBinding(t,i){return new Qp(t)}}class Ka{constructor(t,i,l,h,p){this.expression=t,this.layerId=p,this.paintVertexAttributes=(l==="array"?UC:$C).members;for(let v=0;v<i.length;++v);this.paintVertexArray=new h}populatePaintArray(t,i,l){const h=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(h,t,i.patterns&&i.patterns[this.layerId],l)}updatePaintArray(t,i,l,h,p,v){this._setPaintValues(t,i,l.patterns&&l.patterns[this.layerId],v)}_setPaintValues(t,i,l,h){if(!h||!l)return;const p=h[l];if(!p)return;const{tl:v,br:x,pixelRatio:E}=p;for(let T=t;T<i;T++)this.paintVertexArray.emplace(T,v[0],v[1],x[0],x[1],E)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ja{constructor(t,i,l=()=>!0){this.binders={},this._buffers=[];const h=[];for(const p in t.paint._values){if(!l(p))continue;const v=t.paint.get(p);if(!(v instanceof ht&&$a(v.property.specification)))continue;const x=XC(p,t.type),E=v.value,T=v.property.specification.type,k=v.property.useIntegerZoom,P=p==="line-dasharray"||p.endsWith("pattern"),D=p==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(E.kind!=="constant"||D)if(E.kind==="source"||D||P){const V=fx(p,T,"source");this.binders[p]=P?new Ka(E,x,T,V,t.id):new ia(E,x,T,V),h.push(`/a_${p}`)}else{const V=fx(p,T,"composite");this.binders[p]=new Xo(E,x,T,k,i,V),h.push(`/z_${p}`)}else this.binders[p]=P?new ku(E.value,x):new gd(E.value,x,T),h.push(`/u_${p}`)}this.cacheKey=h.sort().join("")}getMaxValue(t){const i=this.binders[t];return i instanceof ia||i instanceof Xo?i.maxValue:0}populatePaintArrays(t,i,l,h,p,v){for(const x in this.binders){const E=this.binders[x];(E instanceof ia||E instanceof Xo||E instanceof Ka)&&E.populatePaintArray(t,i,l,h,p,v)}}setConstantPatternPositions(t){for(const i in this.binders){const l=this.binders[i];l instanceof ku&&l.setConstantPatternPositions(t)}}updatePaintArrays(t,i,l,h,p,v){let x=!1;for(const E in t){const T=i.getPositions(E);for(const k of T){const P=l.feature(k.index);for(const D in this.binders){const V=this.binders[D];if((V instanceof ia||V instanceof Xo||V instanceof Ka)&&V.expression.isStateDependent===!0){const N=h.paint.get(D);V.expression=N.value,V.updatePaintArray(k.start,k.end,P,t[E],p,v),x=!0}}}}return x}defines(){const t=[];for(const i in this.binders){const l=this.binders[i];(l instanceof gd||l instanceof ku)&&t.push(...l.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const i in this.binders){const l=this.binders[i];if(l instanceof ia||l instanceof Xo||l instanceof Ka)for(let h=0;h<l.paintVertexAttributes.length;h++)t.push(l.paintVertexAttributes[h].name)}return t}getBinderUniforms(){const t=[];for(const i in this.binders){const l=this.binders[i];if(l instanceof gd||l instanceof ku||l instanceof Xo)for(const h of l.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const i=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof gd||h instanceof ku||h instanceof Xo)for(const p of h.uniformNames)i.push({name:p,property:l,binding:h.getBinding(t,p)})}return i}setUniforms(t,i,l,h,p){for(const{name:v,property:x,binding:E}of l)this.binders[x].setUniform(t,E,p,h.get(x),v)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const i=this.binders[t];(i instanceof ia||i instanceof Xo||i instanceof Ka)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(t){for(const i in this.binders){const l=this.binders[i];(l instanceof ia||l instanceof Xo||l instanceof Ka)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const i=this.binders[t];(i instanceof ia||i instanceof Xo||i instanceof Ka)&&i.destroy()}}}class tc{constructor(t,i,l=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new Ja(h,i,l);this.needsUpload=!1,this._featureMap=new Kp,this._bufferOffset=0}populatePaintArrays(t,i,l,h,p,v,x){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(t,i,h,p,v,x);i.id!==void 0&&this._featureMap.add(i.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,i,l,h,p){for(const v of l)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(t,this._featureMap,i,v,h,p)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const HC={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function XC(n,t){return HC[n]||[n.replace(`${t}-`,"").replace(/-/g,"_")]}const YC={"line-pattern":{source:Ni,composite:Ni},"fill-pattern":{source:Ni,composite:Ni},"fill-extrusion-pattern":{source:Ni,composite:Ni},"line-dasharray":{source:Br,composite:Br}},KC={color:{source:Ya,composite:oi},number:{source:Wr,composite:Ya}};function fx(n,t,i){const l=YC[n];return l&&l[i]||KC[t][i]}$t(gd,"ConstantBinder"),$t(ku,"PatternConstantBinder"),$t(ia,"SourceExpressionBinder"),$t(Ka,"PatternCompositeBinder"),$t(Xo,"CompositeExpressionBinder"),$t(Ja,"ProgramConfiguration",{omit:["_buffers"]}),$t(tc,"ProgramConfigurationSet");const em="-transition";class Yo extends Uo{constructor(t,i){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),i.layout&&(this._unevaluatedLayout=new He(i.layout)),i.paint)){this._transitionablePaint=new wt(i.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ue(i.paint)}}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,i,l={}){i!=null&&this._validate(Op,`layers.${this.id}.layout.${t}`,t,i,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,i):this.visibility=i)}getPaintProperty(t){return Tt(t,em)?this._transitionablePaint.getTransition(t.slice(0,-em.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,i,l={}){if(i!=null&&this._validate(dv,`layers.${this.id}.paint.${t}`,t,i,l))return!1;if(Tt(t,em))return this._transitionablePaint.setTransition(t.slice(0,-em.length),i||void 0),!1;{const h=this._transitionablePaint._values[t],p=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(t,i),this._handleSpecialPaintPropertyUpdate(t);const x=this._transitionablePaint._values[t].value,E=x.isDataDriven(),T=Tt(t,"pattern")||t==="line-dasharray";return E||p||T||this._handleOverridablePaintPropertyUpdate(t,v,x)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,i,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,i)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),pn(t,(i,l)=>!(i===void 0||l==="layout"&&!Object.keys(i).length||l==="paint"&&!Object.keys(i).length))}_validate(t,i,l,h,p={}){return(!p||p.validate!==!1)&&Fp(this,t.call(Bp,{key:i,layerType:this.type,objectKey:l,value:h,styleSpec:et,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const i=this.paint.get(t);if(i instanceof ht&&$a(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=_u(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const JC=Xt([{name:"a_pos",components:2,type:"Int16"}],4),QC=Xt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class $i{constructor(t=[]){this.segments=t}prepareSegment(t,i,l,h){let p=this.segments[this.segments.length-1];return t>$i.MAX_VERTEX_ARRAY_LENGTH&&he(`Max vertices per segment is ${$i.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!p||p.vertexLength+t>$i.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==h)&&(p={vertexOffset:i.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},h!==void 0&&(p.sortKey=h),this.segments.push(p)),p}get(){return this.segments}destroy(){for(const t of this.segments)for(const i in t.vaos)t.vaos[i].destroy()}static simpleSegment(t,i,l,h){return new $i([{vertexOffset:t,primitiveOffset:i,vertexLength:l,primitiveLength:h,vaos:{},sortKey:0}])}}$i.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,$t($i,"SegmentVector");var hn=8192;class Qa{constructor(t,i){t&&(i?this.setSouthWest(t).setNorthEast(i):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Nn?new Nn(t.lng,t.lat):Nn.convert(t),this}setSouthWest(t){return this._sw=t instanceof Nn?new Nn(t.lng,t.lat):Nn.convert(t),this}extend(t){const i=this._sw,l=this._ne;let h,p;if(t instanceof Nn)h=t,p=t;else{if(!(t instanceof Qa))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Qa.convert(t)):this.extend(Nn.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&t.hasOwnProperty("lon")?this.extend(Nn.convert(t)):this;if(h=t._sw,p=t._ne,!h||!p)return this}return i||l?(i.lng=Math.min(h.lng,i.lng),i.lat=Math.min(h.lat,i.lat),l.lng=Math.max(p.lng,l.lng),l.lat=Math.max(p.lat,l.lat)):(this._sw=new Nn(h.lng,h.lat),this._ne=new Nn(p.lng,p.lat)),this}getCenter(){return new Nn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Nn(this.getWest(),this.getNorth())}getSouthEast(){return new Nn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:i,lat:l}=Nn.convert(t);let h=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&h}static convert(t){return!t||t instanceof Qa?t:new Qa(t)}}var tm=1e-6,Qr=typeof Float32Array<"u"?Float32Array:Array;function px(){var n=new Qr(9);return Qr!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function mx(n,t,i){var l=t[0],h=t[1],p=t[2],v=t[3],x=t[4],E=t[5],T=t[6],k=t[7],P=t[8],D=i[0],V=i[1],N=i[2],G=i[3],X=i[4],le=i[5],ye=i[6],re=i[7],ge=i[8];return n[0]=D*l+V*v+N*T,n[1]=D*h+V*x+N*k,n[2]=D*p+V*E+N*P,n[3]=G*l+X*v+le*T,n[4]=G*h+X*x+le*k,n[5]=G*p+X*E+le*P,n[6]=ye*l+re*v+ge*T,n[7]=ye*h+re*x+ge*k,n[8]=ye*p+re*E+ge*P,n}function Ko(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function _v(n,t){var i=t[0],l=t[1],h=t[2],p=t[3],v=t[4],x=t[5],E=t[6],T=t[7],k=t[8],P=t[9],D=t[10],V=t[11],N=t[12],G=t[13],X=t[14],le=t[15],ye=i*x-l*v,re=i*E-h*v,ge=i*T-p*v,Te=l*E-h*x,xe=l*T-p*x,je=h*T-p*E,Ne=k*G-P*N,tt=k*X-D*N,vt=k*le-V*N,We=P*X-D*G,it=P*le-V*G,ot=D*le-V*X,dt=ye*ot-re*it+ge*We+Te*vt-xe*tt+je*Ne;return dt?(n[0]=(x*ot-E*it+T*We)*(dt=1/dt),n[1]=(h*it-l*ot-p*We)*dt,n[2]=(G*je-X*xe+le*Te)*dt,n[3]=(D*xe-P*je-V*Te)*dt,n[4]=(E*vt-v*ot-T*tt)*dt,n[5]=(i*ot-h*vt+p*tt)*dt,n[6]=(X*ge-N*je-le*re)*dt,n[7]=(k*je-D*ge+V*re)*dt,n[8]=(v*it-x*vt+T*Ne)*dt,n[9]=(l*vt-i*it-p*Ne)*dt,n[10]=(N*xe-G*ge+le*ye)*dt,n[11]=(P*ge-k*xe-V*ye)*dt,n[12]=(x*tt-v*We-E*Ne)*dt,n[13]=(i*We-l*tt+h*Ne)*dt,n[14]=(G*re-N*Te-X*ye)*dt,n[15]=(k*Te-P*re+D*ye)*dt,n):null}function nc(n,t,i){var l=t[0],h=t[1],p=t[2],v=t[3],x=t[4],E=t[5],T=t[6],k=t[7],P=t[8],D=t[9],V=t[10],N=t[11],G=t[12],X=t[13],le=t[14],ye=t[15],re=i[0],ge=i[1],Te=i[2],xe=i[3];return n[0]=re*l+ge*x+Te*P+xe*G,n[1]=re*h+ge*E+Te*D+xe*X,n[2]=re*p+ge*T+Te*V+xe*le,n[3]=re*v+ge*k+Te*N+xe*ye,n[4]=(re=i[4])*l+(ge=i[5])*x+(Te=i[6])*P+(xe=i[7])*G,n[5]=re*h+ge*E+Te*D+xe*X,n[6]=re*p+ge*T+Te*V+xe*le,n[7]=re*v+ge*k+Te*N+xe*ye,n[8]=(re=i[8])*l+(ge=i[9])*x+(Te=i[10])*P+(xe=i[11])*G,n[9]=re*h+ge*E+Te*D+xe*X,n[10]=re*p+ge*T+Te*V+xe*le,n[11]=re*v+ge*k+Te*N+xe*ye,n[12]=(re=i[12])*l+(ge=i[13])*x+(Te=i[14])*P+(xe=i[15])*G,n[13]=re*h+ge*E+Te*D+xe*X,n[14]=re*p+ge*T+Te*V+xe*le,n[15]=re*v+ge*k+Te*N+xe*ye,n}function vd(n,t,i){var l,h,p,v,x,E,T,k,P,D,V,N,G=i[0],X=i[1],le=i[2];return t===n?(n[12]=t[0]*G+t[4]*X+t[8]*le+t[12],n[13]=t[1]*G+t[5]*X+t[9]*le+t[13],n[14]=t[2]*G+t[6]*X+t[10]*le+t[14],n[15]=t[3]*G+t[7]*X+t[11]*le+t[15]):(h=t[1],p=t[2],v=t[3],x=t[4],E=t[5],T=t[6],k=t[7],P=t[8],D=t[9],V=t[10],N=t[11],n[0]=l=t[0],n[1]=h,n[2]=p,n[3]=v,n[4]=x,n[5]=E,n[6]=T,n[7]=k,n[8]=P,n[9]=D,n[10]=V,n[11]=N,n[12]=l*G+x*X+P*le+t[12],n[13]=h*G+E*X+D*le+t[13],n[14]=p*G+T*X+V*le+t[14],n[15]=v*G+k*X+N*le+t[15]),n}function ic(n,t,i){var l=i[0],h=i[1],p=i[2];return n[0]=t[0]*l,n[1]=t[1]*l,n[2]=t[2]*l,n[3]=t[3]*l,n[4]=t[4]*h,n[5]=t[5]*h,n[6]=t[6]*h,n[7]=t[7]*h,n[8]=t[8]*p,n[9]=t[9]*p,n[10]=t[10]*p,n[11]=t[11]*p,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function yv(n,t,i){var l=Math.sin(i),h=Math.cos(i),p=t[4],v=t[5],x=t[6],E=t[7],T=t[8],k=t[9],P=t[10],D=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=p*h+T*l,n[5]=v*h+k*l,n[6]=x*h+P*l,n[7]=E*h+D*l,n[8]=T*h-p*l,n[9]=k*h-v*l,n[10]=P*h-x*l,n[11]=D*h-E*l,n}function nm(n,t,i){var l=Math.sin(i),h=Math.cos(i),p=t[0],v=t[1],x=t[2],E=t[3],T=t[8],k=t[9],P=t[10],D=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=p*h-T*l,n[1]=v*h-k*l,n[2]=x*h-P*l,n[3]=E*h-D*l,n[8]=p*l+T*h,n[9]=v*l+k*h,n[10]=x*l+P*h,n[11]=E*l+D*h,n}function gx(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=t[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function vx(n,t,i){var l,h,p,v=i[0],x=i[1],E=i[2],T=Math.hypot(v,x,E);return T<tm?null:(v*=T=1/T,x*=T,E*=T,l=Math.sin(t),h=Math.cos(t),n[0]=v*v*(p=1-h)+h,n[1]=x*v*p+E*l,n[2]=E*v*p-x*l,n[3]=0,n[4]=v*x*p-E*l,n[5]=x*x*p+h,n[6]=E*x*p+v*l,n[7]=0,n[8]=v*E*p+x*l,n[9]=x*E*p-v*l,n[10]=E*E*p+h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});var eI=nc;function xv(){var n=new Qr(3);return Qr!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function _x(n){var t=new Qr(3);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function _d(n){return Math.hypot(n[0],n[1],n[2])}function Mu(n,t,i){var l=new Qr(3);return l[0]=n,l[1]=t,l[2]=i,l}function ra(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n}function bv(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n}function yx(n,t,i){return n[0]=t[0]*i[0],n[1]=t[1]*i[1],n[2]=t[2]*i[2],n}function yd(n,t,i){return n[0]=Math.min(t[0],i[0]),n[1]=Math.min(t[1],i[1]),n[2]=Math.min(t[2],i[2]),n}function xd(n,t,i){return n[0]=Math.max(t[0],i[0]),n[1]=Math.max(t[1],i[1]),n[2]=Math.max(t[2],i[2]),n}function co(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n}function bd(n,t,i,l){return n[0]=t[0]+i[0]*l,n[1]=t[1]+i[1]*l,n[2]=t[2]+i[2]*l,n}function Or(n,t){var i=t[0],l=t[1],h=t[2],p=i*i+l*l+h*h;return p>0&&(p=1/Math.sqrt(p)),n[0]=t[0]*p,n[1]=t[1]*p,n[2]=t[2]*p,n}function So(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function wv(n,t,i){var l=t[0],h=t[1],p=t[2],v=i[0],x=i[1],E=i[2];return n[0]=h*E-p*x,n[1]=p*v-l*E,n[2]=l*x-h*v,n}function Bi(n,t,i){var l=t[0],h=t[1],p=t[2],v=i[3]*l+i[7]*h+i[11]*p+i[15];return n[0]=(i[0]*l+i[4]*h+i[8]*p+i[12])/(v=v||1),n[1]=(i[1]*l+i[5]*h+i[9]*p+i[13])/v,n[2]=(i[2]*l+i[6]*h+i[10]*p+i[14])/v,n}function xx(n,t,i){var l=i[0],h=i[1],p=i[2],v=t[0],x=t[1],E=t[2],T=h*E-p*x,k=p*v-l*E,P=l*x-h*v,D=h*P-p*k,V=p*T-l*P,N=l*k-h*T,G=2*i[3];return k*=G,P*=G,V*=2,N*=2,n[0]=v+(T*=G)+(D*=2),n[1]=x+k+V,n[2]=E+P+N,n}var wd,Jo=bv,tI=yx,nI=_d;function bx(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n}function wx(n,t){var i=t[0],l=t[1],h=t[2],p=t[3],v=i*i+l*l+h*h+p*p;return v>0&&(v=1/Math.sqrt(v)),n[0]=i*v,n[1]=l*v,n[2]=h*v,n[3]=p*v,n}function rc(n,t,i){var l=t[0],h=t[1],p=t[2],v=t[3];return n[0]=i[0]*l+i[4]*h+i[8]*p+i[12]*v,n[1]=i[1]*l+i[5]*h+i[9]*p+i[13]*v,n[2]=i[2]*l+i[6]*h+i[10]*p+i[14]*v,n[3]=i[3]*l+i[7]*h+i[11]*p+i[15]*v,n}function Ex(){var n=new Qr(4);return Qr!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function Sx(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function Tx(n,t,i){i*=.5;var l=t[0],h=t[1],p=t[2],v=t[3],x=Math.sin(i),E=Math.cos(i);return n[0]=l*E+v*x,n[1]=h*E+p*x,n[2]=p*E-h*x,n[3]=v*E-l*x,n}function Cx(n,t,i){i*=.5;var l=t[0],h=t[1],p=t[2],v=t[3],x=Math.sin(i),E=Math.cos(i);return n[0]=l*E-p*x,n[1]=h*E+v*x,n[2]=p*E+l*x,n[3]=v*E-h*x,n}xv(),wd=new Qr(4),Qr!=Float32Array&&(wd[0]=0,wd[1]=0,wd[2]=0,wd[3]=0);var iI=wx;xv(),Mu(1,0,0),Mu(0,1,0),Ex(),Ex(),px();const rI=Xt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ix}=rI,Ax=Xt([{name:"a_pos_3",components:3,type:"Int16"}]);var Ed=Xt([{name:"a_pos",type:"Int16",components:2}]);class Ev{constructor(t,i){this.pos=t,this.dir=i}intersectsPlane(t,i,l){const h=So(i,this.dir);if(Math.abs(h)<1e-6)return!1;const p=((t[0]-this.pos[0])*i[0]+(t[1]-this.pos[1])*i[1]+(t[2]-this.pos[2])*i[2])/h;return l[0]=this.pos[0]+this.dir[0]*p,l[1]=this.pos[1]+this.dir[1]*p,l[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(t,i,l){if(function(V,N){var G=V[0],X=V[1],le=V[2],ye=N[0],re=N[1],ge=N[2];return Math.abs(G-ye)<=tm*Math.max(1,Math.abs(G),Math.abs(ye))&&Math.abs(X-re)<=tm*Math.max(1,Math.abs(X),Math.abs(re))&&Math.abs(le-ge)<=tm*Math.max(1,Math.abs(le),Math.abs(ge))}(this.pos,t)||i===0)return l[0]=l[1]=l[2]=0,!1;const[h,p,v]=this.dir,x=this.pos[0]-t[0],E=this.pos[1]-t[1],T=this.pos[2]-t[2],k=h*h+p*p+v*v,P=2*(x*h+E*p+T*v),D=P*P-4*k*(x*x+E*E+T*T-i*i);if(D<0){const V=Math.max(-P/2,0),N=x+h*V,G=E+p*V,X=T+v*V,le=Math.hypot(N,G,X);return l[0]=N*i/le,l[1]=G*i/le,l[2]=X*i/le,!1}{const V=(-P-Math.sqrt(D))/(2*k);if(V<0){const N=Math.hypot(x,E,T);return l[0]=x*i/N,l[1]=E*i/N,l[2]=T*i/N,!1}return l[0]=x+h*V,l[1]=E+p*V,l[2]=T+v*V,!0}}}class Sv{constructor(t,i,l,h,p){this.TL=t,this.TR=i,this.BR=l,this.BL=h,this.horizon=p}static fromInvProjectionMatrix(t,i,l){const h=[-1,1,1],p=[1,1,1],v=[1,-1,1],x=[-1,-1,1],E=Bi(h,h,t),T=Bi(p,p,t),k=Bi(v,v,t),P=Bi(x,x,t);return new Sv(E,T,k,P,i/l)}}class Tv{constructor(t,i){this.points=t,this.planes=i}static fromInvProjectionMatrix(t,i,l,h){const p=Math.pow(2,l),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const T=rc([],E,t),k=1/T[3]/i*p;return function(P,D,V){return P[0]=D[0]*V[0],P[1]=D[1]*V[1],P[2]=D[2]*V[2],P[3]=D[3]*V[3],P}(T,T,[k,k,h?1/T[3]:k,k])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const T=Or([],wv([],Jo([],v[E[0]],v[E[1]]),Jo([],v[E[2]],v[E[1]]))),k=-So(T,v[E[1]]);return T.concat(k)});return new Tv(v,x)}}class Fr{static fromPoints(t){const i=[1/0,1/0,1/0],l=[-1/0,-1/0,-1/0];for(const h of t)yd(i,i,h),xd(l,l,h);return new Fr(i,l)}static applyTransform(t,i){const l=t.getCorners();for(let h=0;h<l.length;++h)Bi(l[h],l[h],i);return Fr.fromPoints(l)}constructor(t,i){this.min=t,this.max=i,this.center=co([],ra([],this.min,this.max),.5)}quadrant(t){const i=[t%2==0,t<2],l=_x(this.min),h=_x(this.max);for(let p=0;p<i.length;p++)l[p]=i[p]?this.min[p]:this.center[p],h[p]=i[p]?this.center[p]:this.max[p];return h[2]=this.max[2],new Fr(l,h)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,i=this.max;return[[t[0],t[1],t[2]],[i[0],t[1],t[2]],[i[0],i[1],t[2]],[t[0],i[1],t[2]],[t[0],t[1],i[2]],[i[0],t[1],i[2]],[i[0],i[1],i[2]],[t[0],i[1],i[2]]]}intersects(t){const i=this.getCorners();let l=!0;for(let h=0;h<t.planes.length;h++){const p=t.planes[h];let v=0;for(let x=0;x<i.length;x++)v+=So(p,i[x])+p[3]>=0;if(v===0)return 0;v!==i.length&&(l=!1)}if(l)return 2;for(let h=0;h<3;h++){let p=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let x=0;x<t.points.length;x++){const E=t.points[x][h]-this.min[h];p=Math.min(p,E),v=Math.max(v,E)}if(v<0||p>this.max[h]-this.min[h])return 0}return 1}}const bs=hn/Math.PI/2,oc=64,Sd=[oc,32,16],To=-bs,Co=bs,oI=[new Fr([To,To,To],[Co,Co,Co]),new Fr([To,To,To],[0,0,Co]),new Fr([0,To,To],[Co,0,Co]),new Fr([To,0,To],[0,Co,Co]),new Fr([0,0,To],[Co,Co,Co])];function im(n){return n*bs/Id}function kx(n,t,i,l=!0){const h=co([],n._camera.position,n.worldSize),p=[t,i,1,1];rc(p,p,n.pixelMatrixInverse),bx(p,p,1/p[3]);const v=Or([],Jo([],p,h)),x=n.globeMatrix,E=[x[12],x[13],x[14]],T=Jo([],E,h),k=_d(T),P=Or([],T),D=n.worldSize/(2*Math.PI),V=So(P,v),N=Math.asin(D/k);if(N<Math.acos(V)){if(!l)return null;const vt=[],We=[];co(vt,v,k/V),Or(We,Jo(We,vt,T)),Or(v,ra(v,T,co(v,We,Math.tan(N)*k)))}const G=[];new Ev(h,v).closestPointOnSphere(E,D,G);const X=Or([],Ft(x,0)),le=Or([],Ft(x,1)),ye=Or([],Ft(x,2)),re=So(X,G),ge=So(le,G),Te=So(ye,G),xe=be(Math.asin(-ge/D));let je=be(Math.atan2(re,Te));je=n.center.lng+function(vt,We){const it=(We-vt+180)%360-180;return it<-180?it+360:it}(n.center.lng,je);const Ne=Es(je),tt=nt(Ss(xe),0,1);return new Du(Ne,tt)}class sI{constructor(t,i,l){this.a=Jo([],t,l),this.b=Jo([],i,l),this.center=l;const h=Or([],this.a),p=Or([],this.b);this.angle=Math.acos(So(h,p))}}function Cv(n,t){if(n.angle===0)return null;let i;return i=n.a[t]===0?1/n.angle*.5*Math.PI:1/n.angle*Math.atan(n.b[t]/n.a[t]/Math.sin(n.angle)-1/Math.tan(n.angle)),i<0||i>1?null:function(l,h,p,v){const x=Math.sin(p);return l*(Math.sin((1-v)*p)/x)+h*(Math.sin(v*p)/x)}(n.a[t],n.b[t],n.angle,nt(i,0,1))+n.center[t]}function ws(n){if(n.z<=1)return oI[n.z+2*n.y+n.x];const t=Iv(rm(n));return Fr.fromPoints(t)}function sc(n,t,i){return co(n,n,1-i),bd(n,n,t,i)}function Mx(n,t){const i=Lu(t.zoom);if(i===0)return ws(n);const l=rm(n),h=Iv(l),p=Es(l.getWest())*t.worldSize,v=Es(l.getEast())*t.worldSize,x=Ss(l.getNorth())*t.worldSize,E=Ss(l.getSouth())*t.worldSize,T=[p,x,0],k=[v,x,0],P=[p,E,0],D=[v,E,0],V=_v([],t.globeMatrix);return Bi(T,T,V),Bi(k,k,V),Bi(P,P,V),Bi(D,D,V),h[0]=sc(h[0],P,i),h[1]=sc(h[1],D,i),h[2]=sc(h[2],k,i),h[3]=sc(h[3],T,i),Fr.fromPoints(h)}function Px(n,t,i){for(const l of n)Bi(l,l,t),co(l,l,i)}function aI(n,t,i){const l=t/n.worldSize,h=n.globeMatrix;if(i.z<=1){const Ne=ws(i).getCorners();return Px(Ne,h,l),Fr.fromPoints(Ne)}const p=rm(i),v=Iv(p);Px(v,h,l);const x=Number.MAX_VALUE,E=[-x,-x,-x],T=[x,x,x];if(p.contains(n.center)){for(const vt of v)yd(T,T,vt),xd(E,E,vt);E[2]=0;const Ne=n.point,tt=[Ne.x*l,Ne.y*l,0];return yd(T,T,tt),xd(E,E,tt),new Fr(T,E)}const k=[h[12]*l,h[13]*l,h[14]*l],P=p.getCenter(),D=nt(n.center.lat,-Er,Er),V=nt(P.lat,-Er,Er),N=Es(n.center.lng),G=Ss(D);let X=N-Es(P.lng);const le=G-Ss(V);X>.5?X-=1:X<-.5&&(X+=1);let ye=0;Math.abs(X)>Math.abs(le)?ye=X>=0?1:3:(ye=le>=0?0:2,bd(k,k,[h[4]*l,h[5]*l,h[6]*l],-Math.sin(Se(le>=0?p.getSouth():p.getNorth()))*bs));const re=v[ye],ge=v[(ye+1)%4],Te=new sI(re,ge,k),xe=[Cv(Te,0)||re[0],Cv(Te,1)||re[1],Cv(Te,2)||re[2]],je=Lu(n.zoom);if(je>0){const Ne=function({x:vt,y:We,z:it},ot,dt,_t,Xe){const It=1/(1<<it);let rn=vt*It,Rt=rn+It,Zt=We*It,At=Zt+It,an=0;const An=(rn+Rt)/2-_t;return An>.5?an=-1:An<-.5&&(an=1),rn=((rn+an)*ot-(_t*=ot))*dt+_t,Rt=((Rt+an)*ot-_t)*dt+_t,Zt=(Zt*ot-(Xe*=ot))*dt+Xe,At=(At*ot-Xe)*dt+Xe,[[rn,At,0],[Rt,At,0],[Rt,Zt,0],[rn,Zt,0]]}(i,t,n._pixelsPerMercatorPixel,N,G);for(let vt=0;vt<v.length;vt++)sc(v[vt],Ne[vt],je);const tt=ra([],Ne[ye],Ne[(ye+1)%4]);co(tt,tt,.5),sc(xe,tt,je)}for(const Ne of v)yd(T,T,Ne),xd(E,E,Ne);return T[2]=Math.min(re[2],ge[2]),yd(T,T,xe),xd(E,E,xe),new Fr(T,E)}function rm({x:n,y:t,z:i}){const l=1/(1<<i),h=new Nn(uo(n*l),wr((t+1)*l)),p=new Nn(uo((n+1)*l),wr(t*l));return new Qa(h,p)}function Iv(n){const t=Se(n.getNorth()),i=Se(n.getSouth()),l=Math.cos(t),h=Math.cos(i),p=Math.sin(t),v=Math.sin(i),x=n.getWest(),E=n.getEast();return[Pu(h,v,x),Pu(h,v,E),Pu(l,p,E),Pu(l,p,x)]}function Pu(n,t,i,l=bs){return i=Se(i),[n*Math.sin(i)*l,-t*l,n*Math.cos(i)*l]}function zu(n,t,i){return Pu(Math.cos(Se(n)),Math.sin(Se(n)),t,i)}function Td(n,t,i,l){const h=1<<i.z,p=(n/hn+i.x)/h;return zu(wr((t/hn+i.y)/h),uo(p),l)}function om({min:n,max:t}){return 16383/Math.max(t[0]-n[0],t[1]-n[1],t[2]-n[2])}const zx=new Float64Array(16);function Cd(n){const t=om(n),i=gx(zx,[t,t,t]);return vd(i,i,((l=[])[0]=-(h=n.min)[0],l[1]=-h[1],l[2]=-h[2],l));var l,h}function Av(n){const t=(l=n.min,(i=zx)[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=l[0],i[13]=l[1],i[14]=l[2],i[15]=1,i);var i,l;const h=1/om(n);return ic(t,t,[h,h,h])}function Lx(n,t,i,l,h){const p=function(E){const T=hn/(2*Math.PI);return E/(2*Math.PI)/T}(i),v=[n,t,-i/(2*Math.PI)],x=Ko(new Float64Array(16));return vd(x,x,v),ic(x,x,[p,p,p]),yv(x,x,Se(-h)),nm(x,x,Se(-l)),x}function Lu(n){return ft(5,6,n)}function Dx(n,t){const i=zu(t.lat,t.lng),l=function(N){const G=zu(N._center.lat,N._center.lng);let X=wv([],Mu(0,1,0),G);const le=vx([],-N.angle,G);X=Bi(X,X,le),vx(le,-N._pitch,X);const ye=Or([],G);return co(ye,ye,im(N.cameraToCenterDistance/N.pixelsPerMeter)),Bi(ye,ye,le),ra([],G,ye)}(n);return v=(h=bv([],l,i))[0],x=h[1],E=h[2],T=(p=i)[0],k=p[1],P=p[2],V=(D=Math.sqrt(v*v+x*x+E*E)*Math.sqrt(T*T+k*k+P*P))&&So(h,p)/D,Math.acos(Math.min(Math.max(V,-1),1));var h,p,v,x,E,T,k,P,D,V}function kv(n,t){return Dx(n,t)>Math.PI/2*1.01}const Rx=Se(85),lI=Math.cos(Rx),cI=Math.sin(Rx),Id=63710088e-1,Bx=2*Math.PI*Id;class Nn{constructor(t,i){if(isNaN(t)||isNaN(i))throw new Error(`Invalid LngLat object: (${t}, ${i})`);if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Nn(Pe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const i=Math.PI/180,l=this.lat*i,h=t.lat*i,p=Math.sin(l)*Math.sin(h)+Math.cos(l)*Math.cos(h)*Math.cos((t.lng-this.lng)*i);return Id*Math.acos(Math.min(p,1))}toBounds(t=0){const i=360*t/40075017,l=i/Math.cos(Math.PI/180*this.lat);return new Qa(new Nn(this.lng-l,this.lat-i),new Nn(this.lng+l,this.lat+i))}toEcef(t){const i=im(t);return zu(this.lat,this.lng,bs+i)}static convert(t){if(t instanceof Nn)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Nn(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Nn(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function Mv(n){return Bx*Math.cos(n*Math.PI/180)}function Es(n){return(180+n)/360}function Ss(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function Qo(n,t){return n/Mv(t)}function uo(n){return 360*n-180}function wr(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function Ox(n,t){return n*Mv(wr(t))}const Er=85.051129;function Fx(n){return 1/Math.cos(n*Math.PI/180)}class Du{constructor(t,i,l=0){this.x=+t,this.y=+i,this.z=+l}static fromLngLat(t,i=0){const l=Nn.convert(t);return new Du(Es(l.lng),Ss(l.lat),Qo(i,l.lat))}toLngLat(){return new Nn(uo(this.x),wr(this.y))}toAltitude(){return Ox(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Bx*Fx(wr(this.y))}}function Pv(n,t,i,l,h,p,v,x,E){const T=(t+l)/2,k=(i+h)/2,P=new Y(T,k);x(P),function(D,V,N,G,X,le){const ye=N-X,re=G-le;return Math.abs((G-V)*ye-(N-D)*re)/Math.hypot(ye,re)}(P.x,P.y,p.x,p.y,v.x,v.y)>=E?(Pv(n,t,i,T,k,p,P,x,E),Pv(n,T,k,l,h,P,v,x,E)):n.push(v)}function Vx(n,t,i){let l=n[0],h=l.x,p=l.y;t(l);const v=[l];for(let x=1;x<n.length;x++){const E=n[x],{x:T,y:k}=E;t(E),Pv(v,h,p,T,k,l,E,t,i),h=T,p=k,l=E}return v}function zv(n,t,i,l){if(l(t,i)){const h=t.add(i)._mult(.5);zv(n,t,h,l),zv(n,h,i,l)}else n.push(i)}function uI(n,t){let i=n[0];const l=[i];for(let h=1;h<n.length;h++){const p=n[h];zv(l,i,p,t),i=p}return l}const Lv=Math.pow(2,14)-1,Nx=-Lv-1;function hI(n,t){const i=Math.round(n.x*t),l=Math.round(n.y*t);return n.x=nt(i,Nx,Lv),n.y=nt(l,Nx,Lv),(i<n.x||i>n.x+1||l<n.y||l>n.y+1)&&he("Geometry exceeds allowed extent, reduce your vector tile buffer size"),n}function oa(n,t,i){const l=n.loadGeometry(),h=n.extent,p=hn/h;if(t&&i&&i.projection.isReprojectedInTileSpace){const v=1<<t.z,{scale:x,x:E,y:T,projection:k}=i,P=D=>{const V=uo((t.x+D.x/h)/v),N=wr((t.y+D.y/h)/v),G=k.project(V,N);D.x=(G.x*x-E)*h,D.y=(G.y*x-T)*h};for(let D=0;D<l.length;D++)if(n.type!==1)l[D]=Vx(l[D],P,1);else{const V=[];for(const N of l[D])N.x<0||N.x>=h||N.y<0||N.y>=h||(P(N),V.push(N));l[D]=V}}for(const v of l)for(const x of v)hI(x,p);return l}function ac(n,t){return{type:n.type,id:n.id,properties:n.properties,geometry:t?oa(n):[]}}function sm(n,t,i,l,h){n.emplaceBack(2*t+(l+1)/2,2*i+(h+1)/2)}function am(n,t,i){n.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class Dv{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new en,this.indexArray=new br,this.segments=new $i,this.programConfigurations=new tc(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,l,h){const p=this.layers[0],v=[];let x=null;p.type==="circle"&&(x=p.layout.get("circle-sort-key"));for(const{feature:T,id:k,index:P,sourceLayerIndex:D}of t){const V=this.layers[0]._featureFilter.needGeometry,N=ac(T,V);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),N,l))continue;const G=x?x.evaluate(N,{},l):void 0,X={id:k,properties:T.properties,type:T.type,sourceLayerIndex:D,index:P,geometry:V?N.geometry:oa(T,l,h),patterns:{},sortKey:G};v.push(X)}x&&v.sort((T,k)=>T.sortKey-k.sortKey);let E=null;h.projection.name==="globe"&&(this.globeExtVertexArray=new lo,E=h.projection);for(const T of v){const{geometry:k,index:P,sourceLayerIndex:D}=T,V=t[P].feature;this.addFeature(T,k,P,i.availableImages,l,E),i.featureIndex.insert(V,k,P,D,this.index)}}update(t,i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,JC.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,QC.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,i,l,h,p,v){for(const x of i)for(const E of x){const T=E.x,k=E.y;if(T<0||T>=hn||k<0||k>=hn)continue;if(v){const V=v.projectTilePoint(T,k,p),N=v.upVector(p,T,k),G=this.globeExtVertexArray;am(G,V,N),am(G,V,N),am(G,V,N),am(G,V,N)}const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),D=P.vertexLength;sm(this.layoutVertexArray,T,k,-1,-1),sm(this.layoutVertexArray,T,k,1,-1),sm(this.layoutVertexArray,T,k,1,1),sm(this.layoutVertexArray,T,k,-1,1),this.indexArray.emplaceBack(D,D+1,D+2),this.indexArray.emplaceBack(D,D+2,D+3),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},h,p)}}function $x(n,t){for(let i=0;i<n.length;i++)if(lc(t,n[i]))return!0;for(let i=0;i<t.length;i++)if(lc(n,t[i]))return!0;return!!Rv(n,t)}function dI(n,t,i){return!!lc(n,t)||!!Bv(t,n,i)}function Ux(n,t){if(n.length===1)return Gx(t,n[0]);for(let i=0;i<t.length;i++){const l=t[i];for(let h=0;h<l.length;h++)if(lc(n,l[h]))return!0}for(let i=0;i<n.length;i++)if(Gx(t,n[i]))return!0;for(let i=0;i<t.length;i++)if(Rv(n,t[i]))return!0;return!1}function fI(n,t,i){if(n.length>1){if(Rv(n,t))return!0;for(let l=0;l<t.length;l++)if(Bv(t[l],n,i))return!0}for(let l=0;l<n.length;l++)if(Bv(n[l],t,i))return!0;return!1}function Rv(n,t){if(n.length===0||t.length===0)return!1;for(let i=0;i<n.length-1;i++){const l=n[i],h=n[i+1];for(let p=0;p<t.length-1;p++)if(pI(l,h,t[p],t[p+1]))return!0}return!1}function pI(n,t,i,l){return Me(n,i,l)!==Me(t,i,l)&&Me(n,t,i)!==Me(n,t,l)}function Bv(n,t,i){const l=i*i;if(t.length===1)return n.distSqr(t[0])<l;for(let h=1;h<t.length;h++)if(jx(n,t[h-1],t[h])<l)return!0;return!1}function jx(n,t,i){const l=t.distSqr(i);if(l===0)return n.distSqr(t);const h=((n.x-t.x)*(i.x-t.x)+(n.y-t.y)*(i.y-t.y))/l;return n.distSqr(h<0?t:h>1?i:i.sub(t)._mult(h)._add(t))}function Gx(n,t){let i,l,h,p=!1;for(let v=0;v<n.length;v++){i=n[v];for(let x=0,E=i.length-1;x<i.length;E=x++)l=i[x],h=i[E],l.y>t.y!=h.y>t.y&&t.x<(h.x-l.x)*(t.y-l.y)/(h.y-l.y)+l.x&&(p=!p)}return p}function lc(n,t){let i=!1;for(let l=0,h=n.length-1;l<n.length;h=l++){const p=n[l],v=n[h];p.y>t.y!=v.y>t.y&&t.x<(v.x-p.x)*(t.y-p.y)/(v.y-p.y)+p.x&&(i=!i)}return i}function qx(n,t,i,l,h){for(const v of n)if(t<=v.x&&i<=v.y&&l>=v.x&&h>=v.y)return!0;const p=[new Y(t,i),new Y(t,h),new Y(l,h),new Y(l,i)];if(n.length>2){for(const v of p)if(lc(n,v))return!0}for(let v=0;v<n.length-1;v++)if(mI(n[v],n[v+1],p))return!0;return!1}function mI(n,t,i){const l=i[0],h=i[2];if(n.x<l.x&&t.x<l.x||n.x>h.x&&t.x>h.x||n.y<l.y&&t.y<l.y||n.y>h.y&&t.y>h.y)return!1;const p=Me(n,t,i[0]);return p!==Me(n,t,i[1])||p!==Me(n,t,i[2])||p!==Me(n,t,i[3])}function Ru(n,t,i){const l=t.paint.get(n).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(n)}function lm(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Zx(n,t,i,l,h){if(!t[0]&&!t[1])return n;const p=Y.convert(t)._mult(h);i==="viewport"&&p._rotate(-l);const v=[];for(let x=0;x<n.length;x++)v.push(n[x].sub(p));return v}function Wx(n,t,i,l){const h=Y.convert(n)._mult(l);return t==="viewport"&&h._rotate(-i),h}$t(Dv,"CircleBucket",{omit:["layers"]});const gI=new mt({"circle-sort-key":new Ze(et.layout_circle["circle-sort-key"])});var vI={paint:new mt({"circle-radius":new Ze(et.paint_circle["circle-radius"]),"circle-color":new Ze(et.paint_circle["circle-color"]),"circle-blur":new Ze(et.paint_circle["circle-blur"]),"circle-opacity":new Ze(et.paint_circle["circle-opacity"]),"circle-translate":new Le(et.paint_circle["circle-translate"]),"circle-translate-anchor":new Le(et.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Le(et.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Le(et.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ze(et.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ze(et.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ze(et.paint_circle["circle-stroke-opacity"])}),layout:gI};function Hx(n,t,i,l,h,p,v,x,E){if(p&&n.queryGeometry.isAboveHorizon)return!1;p&&(E*=n.pixelToTileUnitsFactor);const T=n.tileID.canonical,k=i.projection.upVectorScale(T,i.center.lat,i.worldSize).metersToTile;for(const P of t)for(const D of P){const V=D.add(x),N=h&&i.elevation?i.elevation.exaggeration()*h.getElevationAt(V.x,V.y,!0):0,G=i.projection.projectTilePoint(V.x,V.y,T);if(N>0){const re=i.projection.upVector(T,V.x,V.y);G.x+=re[0]*k*N,G.y+=re[1]*k*N,G.z+=re[2]*k*N}const X=p?V:_I(G.x,G.y,G.z,l),le=p?n.tilespaceRays.map(re=>xI(re,N)):n.queryGeometry.screenGeometry,ye=rc([],[G.x,G.y,G.z,1],l);if(!v&&p?E*=ye[3]/i.cameraToCenterDistance:v&&!p&&(E*=i.cameraToCenterDistance/ye[3]),p){const re=wr((D.y/hn+T.y)/(1<<T.z));E/=i.projection.pixelsPerMeter(re,1)/Qo(1,re)}if(dI(le,X,E))return!0}return!1}function _I(n,t,i,l){const h=rc([],[n,t,i,1],l);return new Y(h[0]/h[3],h[1]/h[3])}const Xx=Mu(0,0,0),yI=Mu(0,0,1);function xI(n,t){const i=xv();return Xx[2]=t,n.intersectsPlane(Xx,yI,i),new Y(i[0],i[1])}class Yx extends Dv{}function Kx(n,{width:t,height:i},l,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*i*l)throw new RangeError("mismatched image size")}else h=new Uint8Array(t*i*l);return n.width=t,n.height=i,n.data=h,n}function Jx(n,t,i){const{width:l,height:h}=t;l===n.width&&h===n.height||(Ov(n,t,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,l),height:Math.min(n.height,h)},i),n.width=l,n.height=h,n.data=t.data)}function Ov(n,t,i,l,h,p){if(h.width===0||h.height===0)return t;if(h.width>n.width||h.height>n.height||i.x>n.width-h.width||i.y>n.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||l.x>t.width-h.width||l.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const v=n.data,x=t.data;for(let E=0;E<h.height;E++){const T=((i.y+E)*n.width+i.x)*p,k=((l.y+E)*t.width+l.x)*p;for(let P=0;P<h.width*p;P++)x[k+P]=v[T+P]}return t}$t(Yx,"HeatmapBucket",{omit:["layers"]});class sa{constructor(t,i){Kx(this,t,1,i)}resize(t){Jx(this,new sa(t),1)}clone(){return new sa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,l,h,p){Ov(t,i,l,h,p,1)}}class eo{constructor(t,i){Kx(this,t,4,i)}resize(t){Jx(this,new eo(t),4)}replace(t,i){i?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new eo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,l,h,p){Ov(t,i,l,h,p,4)}}$t(sa,"AlphaImage"),$t(eo,"RGBAImage");var bI={paint:new mt({"heatmap-radius":new Ze(et.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ze(et.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Le(et.paint_heatmap["heatmap-intensity"]),"heatmap-color":new lt(et.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Le(et.paint_heatmap["heatmap-opacity"])})};function Fv(n){const t={},i=n.resolution||256,l=n.clips?n.clips.length:1,h=n.image||new eo({width:i,height:l}),p=(v,x,E)=>{t[n.evaluationKey]=E;const T=n.expression.evaluate(t);h.data[v+x+0]=Math.floor(255*T.r/T.a),h.data[v+x+1]=Math.floor(255*T.g/T.a),h.data[v+x+2]=Math.floor(255*T.b/T.a),h.data[v+x+3]=Math.floor(255*T.a)};if(n.clips)for(let v=0,x=0;v<l;++v,x+=4*i)for(let E=0,T=0;E<i;E++,T+=4){const k=E/(i-1),{start:P,end:D}=n.clips[v];p(x,T,P*(1-k)+D*k)}else for(let v=0,x=0;v<i;v++,x+=4)p(0,x,v/(i-1));return h}var wI={paint:new mt({"hillshade-illumination-direction":new Le(et.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Le(et.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Le(et.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Le(et.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Le(et.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Le(et.paint_hillshade["hillshade-accent-color"])})};const EI=Xt([{name:"a_pos",components:2,type:"Int16"}],4),{members:SI}=EI;var Bu={};function cm(n,t,i){i=i||2;var l,h,p,v,x,E,T,k=t&&t.length,P=k?t[0]*i:n.length,D=Qx(n,0,P,i,!0),V=[];if(!D||D.next===D.prev)return V;if(k&&(D=function(G,X,le,ye){var re,ge,Te,xe=[];for(re=0,ge=X.length;re<ge;re++)(Te=Qx(G,X[re]*ye,re<ge-1?X[re+1]*ye:G.length,ye,!1))===Te.next&&(Te.steiner=!0),xe.push(zI(Te));for(xe.sort(kI),re=0;re<xe.length;re++)le=MI(xe[re],le);return le}(n,t,D,i)),n.length>80*i){l=p=n[0],h=v=n[1];for(var N=i;N<P;N+=i)(x=n[N])<l&&(l=x),(E=n[N+1])<h&&(h=E),x>p&&(p=x),E>v&&(v=E);T=(T=Math.max(p-l,v-h))!==0?32767/T:0}return Ad(D,V,i,l,h,T,0),V}function Qx(n,t,i,l,h){var p,v;if(h===$v(n,t,i,l)>0)for(p=t;p<i;p+=l)v=nb(p,n[p],n[p+1],v);else for(p=i-l;p>=t;p-=l)v=nb(p,n[p],n[p+1],v);return v&&um(v,v.next)&&(Md(v),v=v.next),v}function cc(n,t){if(!n)return n;t||(t=n);var i,l=n;do if(i=!1,l.steiner||!um(l,l.next)&&Ui(l.prev,l,l.next)!==0)l=l.next;else{if(Md(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function Ad(n,t,i,l,h,p,v){if(n){!v&&p&&function(k,P,D,V){var N=k;do N.z===0&&(N.z=Vv(N.x,N.y,P,D,V)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next;while(N!==k);N.prevZ.nextZ=null,N.prevZ=null,function(G){var X,le,ye,re,ge,Te,xe,je,Ne=1;do{for(le=G,G=null,ge=null,Te=0;le;){for(Te++,ye=le,xe=0,X=0;X<Ne&&(xe++,ye=ye.nextZ);X++);for(je=Ne;xe>0||je>0&&ye;)xe!==0&&(je===0||!ye||le.z<=ye.z)?(re=le,le=le.nextZ,xe--):(re=ye,ye=ye.nextZ,je--),ge?ge.nextZ=re:G=re,re.prevZ=ge,ge=re;le=ye}ge.nextZ=null,Ne*=2}while(Te>1)}(N)}(n,l,h,p);for(var x,E,T=n;n.prev!==n.next;)if(x=n.prev,E=n.next,p?CI(n,l,h,p):TI(n))t.push(x.i/i|0),t.push(n.i/i|0),t.push(E.i/i|0),Md(n),n=E.next,T=E.next;else if((n=E)===T){v?v===1?Ad(n=II(cc(n),t,i),t,i,l,h,p,2):v===2&&AI(n,t,i,l,h,p):Ad(cc(n),t,i,l,h,p,1);break}}}function TI(n){var t=n.prev,i=n,l=n.next;if(Ui(t,i,l)>=0)return!1;for(var h=t.x,p=i.x,v=l.x,x=t.y,E=i.y,T=l.y,k=h<p?h<v?h:v:p<v?p:v,P=x<E?x<T?x:T:E<T?E:T,D=h>p?h>v?h:v:p>v?p:v,V=x>E?x>T?x:T:E>T?E:T,N=l.next;N!==t;){if(N.x>=k&&N.x<=D&&N.y>=P&&N.y<=V&&Ou(h,x,p,E,v,T,N.x,N.y)&&Ui(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function CI(n,t,i,l){var h=n.prev,p=n,v=n.next;if(Ui(h,p,v)>=0)return!1;for(var x=h.x,E=p.x,T=v.x,k=h.y,P=p.y,D=v.y,V=x<E?x<T?x:T:E<T?E:T,N=k<P?k<D?k:D:P<D?P:D,G=x>E?x>T?x:T:E>T?E:T,X=k>P?k>D?k:D:P>D?P:D,le=Vv(V,N,t,i,l),ye=Vv(G,X,t,i,l),re=n.prevZ,ge=n.nextZ;re&&re.z>=le&&ge&&ge.z<=ye;){if(re.x>=V&&re.x<=G&&re.y>=N&&re.y<=X&&re!==h&&re!==v&&Ou(x,k,E,P,T,D,re.x,re.y)&&Ui(re.prev,re,re.next)>=0||(re=re.prevZ,ge.x>=V&&ge.x<=G&&ge.y>=N&&ge.y<=X&&ge!==h&&ge!==v&&Ou(x,k,E,P,T,D,ge.x,ge.y)&&Ui(ge.prev,ge,ge.next)>=0))return!1;ge=ge.nextZ}for(;re&&re.z>=le;){if(re.x>=V&&re.x<=G&&re.y>=N&&re.y<=X&&re!==h&&re!==v&&Ou(x,k,E,P,T,D,re.x,re.y)&&Ui(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;ge&&ge.z<=ye;){if(ge.x>=V&&ge.x<=G&&ge.y>=N&&ge.y<=X&&ge!==h&&ge!==v&&Ou(x,k,E,P,T,D,ge.x,ge.y)&&Ui(ge.prev,ge,ge.next)>=0)return!1;ge=ge.nextZ}return!0}function II(n,t,i){var l=n;do{var h=l.prev,p=l.next.next;!um(h,p)&&eb(h,l,l.next,p)&&kd(h,p)&&kd(p,h)&&(t.push(h.i/i|0),t.push(l.i/i|0),t.push(p.i/i|0),Md(l),Md(l.next),l=n=p),l=l.next}while(l!==n);return cc(l)}function AI(n,t,i,l,h,p){var v=n;do{for(var x=v.next.next;x!==v.prev;){if(v.i!==x.i&&LI(v,x)){var E=tb(v,x);return v=cc(v,v.next),E=cc(E,E.next),Ad(v,t,i,l,h,p,0),void Ad(E,t,i,l,h,p,0)}x=x.next}v=v.next}while(v!==n)}function kI(n,t){return n.x-t.x}function MI(n,t){var i=function(h,p){var v,x=p,E=h.x,T=h.y,k=-1/0;do{if(T<=x.y&&T>=x.next.y&&x.next.y!==x.y){var P=x.x+(T-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(P<=E&&P>k&&(k=P,v=x.x<x.next.x?x:x.next,P===E))return v}x=x.next}while(x!==p);if(!v)return null;var D,V=v,N=v.x,G=v.y,X=1/0;x=v;do E>=x.x&&x.x>=N&&E!==x.x&&Ou(T<G?E:k,T,N,G,T<G?k:E,T,x.x,x.y)&&(D=Math.abs(T-x.y)/(E-x.x),kd(x,h)&&(D<X||D===X&&(x.x>v.x||x.x===v.x&&PI(v,x)))&&(v=x,X=D)),x=x.next;while(x!==V);return v}(n,t);if(!i)return t;var l=tb(i,n);return cc(l,l.next),cc(i,i.next)}function PI(n,t){return Ui(n.prev,n,t.prev)<0&&Ui(t.next,n,n.next)<0}function Vv(n,t,i,l,h){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*h|0)|n<<8))|n<<4))|n<<2))|n<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function zI(n){var t=n,i=n;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==n);return i}function Ou(n,t,i,l,h,p,v,x){return(h-v)*(t-x)>=(n-v)*(p-x)&&(n-v)*(l-x)>=(i-v)*(t-x)&&(i-v)*(p-x)>=(h-v)*(l-x)}function LI(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!function(i,l){var h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==l.i&&h.next.i!==l.i&&eb(h,h.next,i,l))return!0;h=h.next}while(h!==i);return!1}(n,t)&&(kd(n,t)&&kd(t,n)&&function(i,l){var h=i,p=!1,v=(i.x+l.x)/2,x=(i.y+l.y)/2;do h.y>x!=h.next.y>x&&h.next.y!==h.y&&v<(h.next.x-h.x)*(x-h.y)/(h.next.y-h.y)+h.x&&(p=!p),h=h.next;while(h!==i);return p}(n,t)&&(Ui(n.prev,n,t.prev)||Ui(n,t.prev,t))||um(n,t)&&Ui(n.prev,n,n.next)>0&&Ui(t.prev,t,t.next)>0)}function Ui(n,t,i){return(t.y-n.y)*(i.x-t.x)-(t.x-n.x)*(i.y-t.y)}function um(n,t){return n.x===t.x&&n.y===t.y}function eb(n,t,i,l){var h=dm(Ui(n,t,i)),p=dm(Ui(n,t,l)),v=dm(Ui(i,l,n)),x=dm(Ui(i,l,t));return h!==p&&v!==x||!(h!==0||!hm(n,i,t))||!(p!==0||!hm(n,l,t))||!(v!==0||!hm(i,n,l))||!(x!==0||!hm(i,t,l))}function hm(n,t,i){return t.x<=Math.max(n.x,i.x)&&t.x>=Math.min(n.x,i.x)&&t.y<=Math.max(n.y,i.y)&&t.y>=Math.min(n.y,i.y)}function dm(n){return n>0?1:n<0?-1:0}function kd(n,t){return Ui(n.prev,n,n.next)<0?Ui(n,t,n.next)>=0&&Ui(n,n.prev,t)>=0:Ui(n,t,n.prev)<0||Ui(n,n.next,t)<0}function tb(n,t){var i=new Nv(n.i,n.x,n.y),l=new Nv(t.i,t.x,t.y),h=n.next,p=t.prev;return n.next=t,t.prev=n,i.next=h,h.prev=i,l.next=i,i.prev=l,p.next=l,l.prev=p,l}function nb(n,t,i,l){var h=new Nv(n,t,i);return l?(h.next=l.next,h.prev=l,l.next.prev=h,l.next=h):(h.prev=h,h.next=h),h}function Md(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Nv(n,t,i){this.i=n,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function $v(n,t,i,l){for(var h=0,p=t,v=i-l;p<i;p+=l)h+=(n[v]-n[p])*(n[p+1]+n[v+1]),v=p;return h}function DI(n,t,i,l,h){ib(n,t,i||0,l||n.length-1,h||RI)}function ib(n,t,i,l,h){for(;l>i;){if(l-i>600){var p=l-i+1,v=t-i+1,x=Math.log(p),E=.5*Math.exp(2*x/3),T=.5*Math.sqrt(x*E*(p-E)/p)*(v-p/2<0?-1:1);ib(n,t,Math.max(i,Math.floor(t-v*E/p+T)),Math.min(l,Math.floor(t+(p-v)*E/p+T)),h)}var k=n[t],P=i,D=l;for(Pd(n,i,t),h(n[l],k)>0&&Pd(n,i,l);P<D;){for(Pd(n,P,D),P++,D--;h(n[P],k)<0;)P++;for(;h(n[D],k)>0;)D--}h(n[i],k)===0?Pd(n,i,D):Pd(n,++D,l),D<=t&&(i=D+1),t<=D&&(l=D-1)}}function Pd(n,t,i){var l=n[t];n[t]=n[i],n[i]=l}function RI(n,t){return n<t?-1:n>t?1:0}function Uv(n,t){const i=n.length;if(i<=1)return[n];const l=[];let h,p;for(let v=0;v<i;v++){const x=qe(n[v]);x!==0&&(n[v].area=Math.abs(x),p===void 0&&(p=x<0),p===x<0?(h&&l.push(h),h=[n[v]]):h.push(n[v]))}if(h&&l.push(h),t>1)for(let v=0;v<l.length;v++)l[v].length<=t||(DI(l[v],t,1,l[v].length-1,BI),l[v]=l[v].slice(0,t));return l}function BI(n,t){return t.area-n.area}function jv(n,t,i){const l=i.patternDependencies;let h=!1;for(const p of t){const v=p.paint.get(`${n}-pattern`);v.isConstant()||(h=!0);const x=v.constantOr(null);x&&(h=!0,l[x]=!0)}return h}function Gv(n,t,i,l,h){const p=h.patternDependencies;for(const v of t){const x=v.paint.get(`${n}-pattern`).value;if(x.kind!=="constant"){let E=x.evaluate({zoom:l},i,{},h.availableImages);E=E&&E.name?E.name:E,p[E]=!0,i.patterns[v.id]=E}}return i}({get exports(){return Bu},set exports(n){Bu=n}}).exports=cm,Bu.default=cm,cm.deviation=function(n,t,i,l){var h=t&&t.length,p=Math.abs($v(n,0,h?t[0]*i:n.length,i));if(h)for(var v=0,x=t.length;v<x;v++)p-=Math.abs($v(n,t[v]*i,v<x-1?t[v+1]*i:n.length,i));var E=0;for(v=0;v<l.length;v+=3){var T=l[v]*i,k=l[v+1]*i,P=l[v+2]*i;E+=Math.abs((n[T]-n[P])*(n[k+1]-n[T+1])-(n[T]-n[k])*(n[P+1]-n[T+1]))}return p===0&&E===0?0:Math.abs((E-p)/p)},cm.flatten=function(n){for(var t=n[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,h=0;h<n.length;h++){for(var p=0;p<n[h].length;p++)for(var v=0;v<t;v++)i.vertices.push(n[h][p][v]);h>0&&i.holes.push(l+=n[h-1].length)}return i};class fm{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new en,this.indexArray=new br,this.indexArray2=new ys,this.programConfigurations=new tc(t.layers,t.zoom),this.segments=new $i,this.segments2=new $i,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=t.projection}populate(t,i,l,h){this.hasPattern=jv("fill",this.layers,i);const p=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:x,id:E,index:T,sourceLayerIndex:k}of t){const P=this.layers[0]._featureFilter.needGeometry,D=ac(x,P);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),D,l))continue;const V=p?p.evaluate(D,{},l,i.availableImages):void 0,N={id:E,properties:x.properties,type:x.type,sourceLayerIndex:k,index:T,geometry:P?D.geometry:oa(x,l,h),patterns:{},sortKey:V};v.push(N)}p&&v.sort((x,E)=>x.sortKey-E.sortKey);for(const x of v){const{geometry:E,index:T,sourceLayerIndex:k}=x;if(this.hasPattern){const P=Gv("fill",this.layers,x,this.zoom,i);this.patternFeatures.push(P)}else this.addFeature(x,E,T,l,{},i.availableImages);i.featureIndex.insert(t[T].feature,E,T,k,this.index)}}update(t,i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,l,h)}addFeatures(t,i,l,h,p){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,i,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,SI),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,i,l,h,p,v=[]){for(const x of Uv(i,500)){let E=0;for(const N of x)E+=N.length;const T=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),k=T.vertexLength,P=[],D=[];for(const N of x){if(N.length===0)continue;N!==x[0]&&D.push(P.length/2);const G=this.segments2.prepareSegment(N.length,this.layoutVertexArray,this.indexArray2),X=G.vertexLength;this.layoutVertexArray.emplaceBack(N[0].x,N[0].y),this.indexArray2.emplaceBack(X+N.length-1,X),P.push(N[0].x),P.push(N[0].y);for(let le=1;le<N.length;le++)this.layoutVertexArray.emplaceBack(N[le].x,N[le].y),this.indexArray2.emplaceBack(X+le-1,X+le),P.push(N[le].x),P.push(N[le].y);G.vertexLength+=N.length,G.primitiveLength+=N.length}const V=Bu(P,D);for(let N=0;N<V.length;N+=3)this.indexArray.emplaceBack(k+V[N],k+V[N+1],k+V[N+2]);T.vertexLength+=E,T.primitiveLength+=V.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,p,v,h)}}$t(fm,"FillBucket",{omit:["layers","patternFeatures"]});const OI=new mt({"fill-sort-key":new Ze(et.layout_fill["fill-sort-key"])});var FI={paint:new mt({"fill-antialias":new Le(et.paint_fill["fill-antialias"]),"fill-opacity":new Ze(et.paint_fill["fill-opacity"]),"fill-color":new Ze(et.paint_fill["fill-color"]),"fill-outline-color":new Ze(et.paint_fill["fill-outline-color"]),"fill-translate":new Le(et.paint_fill["fill-translate"]),"fill-translate-anchor":new Le(et.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ze(et.paint_fill["fill-pattern"])}),layout:OI};const VI=Xt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),NI=Xt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),$I=Xt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:UI}=VI;var pm={},jI=Y,rb=Fu;function Fu(n,t,i,l,h){this.properties={},this.extent=i,this.type=0,this._pbf=n,this._geometry=-1,this._keys=l,this._values=h,n.readFields(GI,this,t)}function GI(n,t,i){n==1?t.id=i.readVarint():n==2?function(l,h){for(var p=l.readVarint()+l.pos;l.pos<p;){var v=h._keys[l.readVarint()],x=h._values[l.readVarint()];h.properties[v]=x}}(i,t):n==3?t.type=i.readVarint():n==4&&(t._geometry=i.pos)}function qI(n){for(var t,i,l=0,h=0,p=n.length,v=p-1;h<p;v=h++)l+=((i=n[v]).x-(t=n[h]).x)*(t.y+i.y);return l}Fu.types=["Unknown","Point","LineString","Polygon"],Fu.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var t,i=n.readVarint()+n.pos,l=1,h=0,p=0,v=0,x=[];n.pos<i;){if(h<=0){var E=n.readVarint();l=7&E,h=E>>3}if(h--,l===1||l===2)p+=n.readSVarint(),v+=n.readSVarint(),l===1&&(t&&x.push(t),t=[]),t.push(new jI(p,v));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&x.push(t),x},Fu.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var t=n.readVarint()+n.pos,i=1,l=0,h=0,p=0,v=1/0,x=-1/0,E=1/0,T=-1/0;n.pos<t;){if(l<=0){var k=n.readVarint();i=7&k,l=k>>3}if(l--,i===1||i===2)(h+=n.readSVarint())<v&&(v=h),h>x&&(x=h),(p+=n.readSVarint())<E&&(E=p),p>T&&(T=p);else if(i!==7)throw new Error("unknown command "+i)}return[v,E,x,T]},Fu.prototype.toGeoJSON=function(n,t,i){var l,h,p=this.extent*Math.pow(2,i),v=this.extent*n,x=this.extent*t,E=this.loadGeometry(),T=Fu.types[this.type];function k(V){for(var N=0;N<V.length;N++){var G=V[N];V[N]=[360*(G.x+v)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+x)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(l=0;l<E.length;l++)P[l]=E[l][0];k(E=P);break;case 2:for(l=0;l<E.length;l++)k(E[l]);break;case 3:for(E=function(V){var N=V.length;if(N<=1)return[V];for(var G,X,le=[],ye=0;ye<N;ye++){var re=qI(V[ye]);re!==0&&(X===void 0&&(X=re<0),X===re<0?(G&&le.push(G),G=[V[ye]]):G.push(V[ye]))}return G&&le.push(G),le}(E),l=0;l<E.length;l++)for(h=0;h<E[l].length;h++)k(E[l][h])}E.length===1?E=E[0]:T="Multi"+T;var D={type:"Feature",geometry:{type:T,coordinates:E},properties:this.properties};return"id"in this&&(D.id=this.id),D};var ZI=rb,ob=sb;function sb(n,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(WI,this,t),this.length=this._features.length}function WI(n,t,i){n===15?t.version=i.readVarint():n===1?t.name=i.readString():n===5?t.extent=i.readVarint():n===2?t._features.push(i.pos):n===3?t._keys.push(i.readString()):n===4&&t._values.push(function(l){for(var h=null,p=l.readVarint()+l.pos;l.pos<p;){var v=l.readVarint()>>3;h=v===1?l.readString():v===2?l.readFloat():v===3?l.readDouble():v===4?l.readVarint64():v===5?l.readVarint():v===6?l.readSVarint():v===7?l.readBoolean():null}return h}(i))}sb.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var t=this._pbf.readVarint()+this._pbf.pos;return new ZI(this._pbf,t,this.extent,this._keys,this._values)};var HI=ob;function XI(n,t,i){if(n===3){var l=new HI(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}var qv=pm.VectorTile=function(n,t){this.layers=n.readFields(XI,{},t)},mm=pm.VectorTileFeature=rb;function gm(n,t,i,l){const h=[],p=l===0?(v,x,E,T,k,P)=>{v.push(new Y(P,E+(P-x)/(T-x)*(k-E)))}:(v,x,E,T,k,P)=>{v.push(new Y(x+(P-E)/(k-E)*(T-x),P))};for(const v of n){const x=[];for(const E of v){if(E.length<=2)continue;const T=[];for(let D=0;D<E.length-1;D++){const V=E[D].x,N=E[D].y,G=E[D+1].x,X=E[D+1].y,le=l===0?V:N,ye=l===0?G:X;le<t?ye>t&&p(T,V,N,G,X,t):le>i?ye<i&&p(T,V,N,G,X,i):T.push(E[D]),ye<t&&le>=t&&p(T,V,N,G,X,t),ye>i&&le<=i&&p(T,V,N,G,X,i)}let k=E[E.length-1];const P=l===0?k.x:k.y;P>=t&&P<=i&&T.push(k),T.length&&(k=T[T.length-1],T[0].x===k.x&&T[0].y===k.y||T.push(T[0]),x.push(T))}x.length&&h.push(x)}return h}pm.VectorTileLayer=ob;const YI=mm.types,KI=Math.pow(2,13);function zd(n,t,i,l,h,p,v,x){n.emplaceBack((t<<1)+v,(i<<1)+p,(Math.floor(l*KI)<<1)+h,Math.round(x))}function Ld(n,t,i){n.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class ab{constructor(){this.acc=new Y(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Y(t.x,t.y),this.max=new Y(t.x,t.y))}append(t,i){this.currentPolyCount.edges++,this.acc._add(t);const l=this.min,h=this.max;t.x<l.x?l.x=t.x:t.x>h.x&&(h.x=t.x),t.y<l.y?l.y=t.y:t.y>h.y&&(h.y=t.y),((t.x===0||t.x===hn)&&t.x===i.x)!=((t.y===0||t.y===hn)&&t.y===i.y)&&this.processBorderOverlap(t,i),i.x<0!=t.x<0&&this.addBorderIntersection(0,Vn(i.y,t.y,(0-i.x)/(t.x-i.x))),i.x>hn!=t.x>hn&&this.addBorderIntersection(1,Vn(i.y,t.y,(hn-i.x)/(t.x-i.x))),i.y<0!=t.y<0&&this.addBorderIntersection(2,Vn(i.x,t.x,(0-i.y)/(t.y-i.y))),i.y>hn!=t.y>hn&&this.addBorderIntersection(3,Vn(i.x,t.x,(hn-i.y)/(t.y-i.y)))}addBorderIntersection(t,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const l=this.borders[t];i<l[0]&&(l[0]=i),i>l[1]&&(l[1]=i)}processBorderOverlap(t,i){if(t.x===i.x){if(t.y===i.y)return;const l=t.x===0?0:1;this.addBorderIntersection(l,i.y),this.addBorderIntersection(l,t.y)}else{const l=t.y===0?2:3;this.addBorderIntersection(l,i.x),this.addBorderIntersection(l,t.x)}}centroid(){const t=this.polyCount.reduce((i,l)=>i+l.edges,0);return t!==0?this.acc.div(t)._round():new Y(0,0)}span(){return new Y(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((t,i)=>t+ +(i[0]!==Number.MAX_VALUE),0)}}class Dd{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.layoutVertexArray=new ni,this.centroidVertexArray=new lx,this.indexArray=new br,this.programConfigurations=new tc(t.layers,t.zoom),this.segments=new $i,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=t.enableTerrain}populate(t,i,l,h){this.features=[],this.hasPattern=jv("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(p){const v=Math.exp(Math.PI*(1-p.y/(1<<p.z)*2));return 80150034*v/(v*v+1)/hn/(1<<p.z)}(l),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:p,id:v,index:x,sourceLayerIndex:E}of t){const T=this.layers[0]._featureFilter.needGeometry,k=ac(p,T);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),k,l))continue;const P={id:v,sourceLayerIndex:E,index:x,geometry:T?k.geometry:oa(p,l,h),properties:p.properties,type:p.type,patterns:{}},D=this.layoutVertexArray.length;this.hasPattern?this.features.push(Gv("fill-extrusion",this.layers,P,this.zoom,i)):this.addFeature(P,P.geometry,x,l,{},i.availableImages,h),i.featureIndex.insert(p,P.geometry,x,E,this.index,D)}this.sortBorders()}addFeatures(t,i,l,h,p){for(const v of this.features){const{geometry:x}=v;this.addFeature(v,x,v.index,i,l,h,p)}this.sortBorders()}update(t,i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,UI),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,$I.members,!0))),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,NI.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,i,l,h,p,v,x){const E=[new Y(0,0),new Y(hn,hn)],T=x.projection,k=T.name==="globe",P=this.enableTerrain&&!k?new ab:null,D=YI[t.type]==="Polygon";k&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new lo);const V=Uv(i,500);for(let le=V.length-1;le>=0;le--){const ye=V[le];(ye.length===0||(N=ye[0]).every(re=>re.x<=0)||N.every(re=>re.x>=hn)||N.every(re=>re.y<=0)||N.every(re=>re.y>=hn))&&V.splice(le,1)}var N;let G;if(k)G=pb(V,E,h);else{G=[];for(const le of V)G.push({polygon:le,bounds:E})}const X=D?this.edgeRadius:0;for(const{polygon:le,bounds:ye}of G){let re=0,ge=0;for(const xe of le)D&&!xe[0].equals(xe[xe.length-1])&&xe.push(xe[0]),ge+=D?xe.length-1:xe.length;const Te=this.segments.prepareSegment((D?5:4)*ge,this.layoutVertexArray,this.indexArray);if(D){const xe=[],je=[];re=Te.vertexLength;for(const tt of le){let vt,We;tt.length&&tt!==le[0]&&je.push(xe.length/2),vt=tt[1].sub(tt[0])._perp()._unit();for(let it=1;it<tt.length;it++){const ot=tt[it],dt=tt[it===tt.length-1?1:it+1];let{x:_t,y:Xe}=ot;if(X){We=dt.sub(ot)._perp()._unit();const It=vt.add(We)._unit(),rn=X*Math.min(4,1/(vt.x*It.x+vt.y*It.y));_t+=rn*It.x,Xe+=rn*It.y,vt=We}zd(this.layoutVertexArray,_t,Xe,0,0,1,1,0),Te.vertexLength++,xe.push(ot.x,ot.y),k&&Ld(this.layoutVertexExtArray,T.projectTilePoint(_t,Xe,h),T.upVector(h,_t,Xe))}}const Ne=Bu(xe,je);for(let tt=0;tt<Ne.length;tt+=3)this.indexArray.emplaceBack(re+Ne[tt],re+Ne[tt+2],re+Ne[tt+1]),Te.primitiveLength++}for(const xe of le){P&&xe.length&&P.startRing(xe[0]);let je,Ne,tt,vt=xe.length>4&&hb(xe[xe.length-2],xe[0],xe[1]),We=X?JI(xe[xe.length-2],xe[0],xe[1],X):0;Ne=xe[1].sub(xe[0])._perp()._unit();let it=!0;for(let ot=1,dt=0;ot<xe.length;ot++){let _t=xe[ot-1],Xe=xe[ot];const It=xe[ot===xe.length-1?1:ot+1];if(P&&D&&P.currentPolyCount.top++,ub(Xe,_t,ye)){X&&(Ne=It.sub(Xe)._perp()._unit(),it=!it);continue}P&&P.append(Xe,_t);const rn=Xe.sub(_t)._perp(),Rt=rn.x/(Math.abs(rn.x)+Math.abs(rn.y)),Zt=rn.y>0?1:0,At=_t.dist(Xe);if(dt+At>32768&&(dt=0),X){tt=It.sub(Xe)._perp()._unit();let xn=cb(_t,Xe,It,lb(Ne,tt),X);isNaN(xn)&&(xn=0);const ln=Xe.sub(_t)._unit();_t=_t.add(ln.mult(We))._round(),Xe=Xe.add(ln.mult(-xn))._round(),We=xn,Ne=tt}const an=Te.vertexLength,An=xe.length>4&&hb(_t,Xe,It);let wn=db(dt,vt,it);if(zd(this.layoutVertexArray,_t.x,_t.y,Rt,Zt,0,0,wn),zd(this.layoutVertexArray,_t.x,_t.y,Rt,Zt,0,1,wn),dt+=At,wn=db(dt,An,!it),vt=An,zd(this.layoutVertexArray,Xe.x,Xe.y,Rt,Zt,0,0,wn),zd(this.layoutVertexArray,Xe.x,Xe.y,Rt,Zt,0,1,wn),Te.vertexLength+=4,this.indexArray.emplaceBack(an+0,an+1,an+2),this.indexArray.emplaceBack(an+1,an+3,an+2),Te.primitiveLength+=2,X){const xn=re+(ot===1?xe.length-2:ot-2),ln=ot===1?re:xn+1;if(this.indexArray.emplaceBack(an+1,xn,an+3),this.indexArray.emplaceBack(xn,ln,an+3),Te.primitiveLength+=2,je===void 0&&(je=an),!ub(It,xe[ot],ye)){const Jn=ot===xe.length-1?je:Te.vertexLength;this.indexArray.emplaceBack(an+2,an+3,Jn),this.indexArray.emplaceBack(an+3,Jn+1,Jn),this.indexArray.emplaceBack(an+3,ln,Jn+1),Te.primitiveLength+=3}it=!it}if(k){const xn=this.layoutVertexExtArray,ln=T.projectTilePoint(_t.x,_t.y,h),Jn=T.projectTilePoint(Xe.x,Xe.y,h),dn=T.upVector(h,_t.x,_t.y),kn=T.upVector(h,Xe.x,Xe.y);Ld(xn,ln,dn),Ld(xn,ln,dn),Ld(xn,Jn,kn),Ld(xn,Jn,kn)}}D&&(re+=xe.length-1)}}if(P&&P.polyCount.length>0){if(P.borders){P.vertexArrayOffset=this.centroidVertexArray.length;const le=P.borders,ye=this.featuresOnBorder.push(P)-1;for(let re=0;re<4;re++)le[re][0]!==Number.MAX_VALUE&&this.borders[re].push(ye)}this.encodeCentroid(P.borders?void 0:P.centroid(),P)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,p,v,h)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort((i,l)=>this.featuresOnBorder[i].borders[t][0]-this.featuresOnBorder[l].borders[t][0])}encodeCentroid(t,i,l=!0){let h,p;if(t)if(t.y!==0){const x=i.span()._mult(this.tileToMeter);h=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(x.x/10)),p=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(x.y/10))}else h=Math.ceil(7*(t.x+450)),p=0;else h=0,p=+l;let v=l?this.centroidVertexArray.length:i.vertexArrayOffset;for(const x of i.polyCount){l&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*x.edges+x.top);for(let E=0;E<x.top;E++)this.centroidVertexArray.emplace(v++,h,p);for(let E=0;E<2*x.edges;E++)this.centroidVertexArray.emplace(v++,0,p),this.centroidVertexArray.emplace(v++,h,p)}}}function lb(n,t){const i=n.add(t)._unit();return n.x*i.x+n.y*i.y}function JI(n,t,i,l){const h=t.sub(n)._perp()._unit(),p=i.sub(t)._perp()._unit();return cb(n,t,i,lb(h,p),l)}function cb(n,t,i,l,h){const p=Math.sqrt(1-l*l);return Math.min(n.dist(t)/3,t.dist(i)/3,h*p/l)}function ub(n,t,i){return n.x<i[0].x&&t.x<i[0].x||n.x>i[1].x&&t.x>i[1].x||n.y<i[0].y&&t.y<i[0].y||n.y>i[1].y&&t.y>i[1].y}function hb(n,t,i){if(n.x<0||n.x>=hn||t.x<0||t.x>=hn||i.x<0||i.x>=hn)return!1;const l=i.sub(t),h=l.perp(),p=n.sub(t);return(l.x*p.x+l.y*p.y)/Math.sqrt((l.x*l.x+l.y*l.y)*(p.x*p.x+p.y*p.y))>-.866&&h.x*p.x+h.y*p.y<0}function db(n,t,i){const l=t?2|n:-3&n;return i?1|l:-2&l}function fb(){const n=Math.PI/32,t=Math.tan(n),i=Id;return i*Math.sqrt(1+2*t*t)-i}function pb(n,t,i){const l=1<<i.z,h=uo(i.x/l),p=uo((i.x+1)/l),v=wr(i.y/l),x=wr((i.y+1)/l);return function(E,T,k,P,D=0,V){const N=[];if(!E.length||!k||!P)return N;const G=(xe,je)=>{for(const Ne of xe)N.push({polygon:Ne,bounds:je})},X=Math.ceil(Math.log2(k)),le=Math.ceil(Math.log2(P)),ye=X-le,re=[];for(let xe=0;xe<Math.abs(ye);xe++)re.push(ye>0?0:1);for(let xe=0;xe<Math.min(X,le);xe++)re.push(0),re.push(1);let ge=E;if(ge=gm(ge,T[0].y-D,T[1].y+D,1),ge=gm(ge,T[0].x-D,T[1].x+D,0),!ge.length)return N;const Te=[];for(re.length?Te.push({polygons:ge,bounds:T,depth:0}):G(ge,T);Te.length;){const xe=Te.pop(),je=xe.depth,Ne=re[je],tt=xe.bounds[0],vt=xe.bounds[1],We=Ne===0?tt.x:tt.y,it=Ne===0?vt.x:vt.y,ot=V?V(Ne,We,it):.5*(We+it),dt=gm(xe.polygons,We-D,ot+D,Ne),_t=gm(xe.polygons,ot-D,it+D,Ne);if(dt.length){const Xe=[tt,new Y(Ne===0?ot:vt.x,Ne===1?ot:vt.y)];re.length>je+1?Te.push({polygons:dt,bounds:Xe,depth:je+1}):G(dt,Xe)}if(_t.length){const Xe=[new Y(Ne===0?ot:tt.x,Ne===1?ot:tt.y),vt];re.length>je+1?Te.push({polygons:_t,bounds:Xe,depth:je+1}):G(_t,Xe)}}return N}(n,t,Math.ceil((p-h)/11.25),Math.ceil((v-x)/11.25),1,(E,T,k)=>{if(E===0)return .5*(T+k);{const P=wr((i.y+T/hn)/l);return(Ss(.5*(wr((i.y+k/hn)/l)+P))*l-i.y)*hn}})}$t(Dd,"FillExtrusionBucket",{omit:["layers","features"]}),$t(ab,"PartMetadata");const QI=new mt({"fill-extrusion-edge-radius":new Le(et["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var eA={paint:new mt({"fill-extrusion-opacity":new Le(et["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ze(et["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Le(et["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Le(et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ze(et["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ze(et["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ze(et["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Le(et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Le(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Le(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:QI};function mb(n,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[n*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class vm{constructor(t,i,l){this.z=t,this.x=i,this.y=l,this.key=Rd(0,t,t,i,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,i){const l=function(p,v,x){var E=mb(256*p,256*(v=Math.pow(2,x)-v-1),x),T=mb(256*(p+1),256*(v+1),x);return E[0]+","+E[1]+","+T[0]+","+T[1]}(this.x,this.y,this.z),h=function(p,v,x){let E,T="";for(let k=p;k>0;k--)E=1<<k-1,T+=(v&E?1:0)+(x&E?2:0);return T}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",l)}toString(){return`${this.z}/${this.x}/${this.y}`}}class gb{constructor(t,i){this.wrap=t,this.canonical=i,this.key=Rd(t,i.z,i.z,i.x,i.y)}}class Vr{constructor(t,i,l,h,p){this.overscaledZ=t,this.wrap=i,this.canonical=new vm(l,+h,+p),this.key=i===0&&t===l?this.canonical.key:Rd(i,t,l,h,p)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const i=this.canonical.z-t;return t>this.canonical.z?new Vr(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Vr(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(t,i=!0){if(this.overscaledZ===t&&i)return this.key;if(t>this.canonical.z)return Rd(this.wrap*+i,t,this.canonical.z,this.canonical.x,this.canonical.y);{const l=this.canonical.z-t;return Rd(this.wrap*+i,t,t,this.canonical.x>>l,this.canonical.y>>l)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const i=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>i&&t.canonical.y===this.canonical.y>>i}children(t){if(this.overscaledZ>=t)return[new Vr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,l=2*this.canonical.x,h=2*this.canonical.y;return[new Vr(i,this.wrap,i,l,h),new Vr(i,this.wrap,i,l+1,h),new Vr(i,this.wrap,i,l,h+1),new Vr(i,this.wrap,i,l+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Vr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Vr(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new gb(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Rd(n,t,i,l,h){const p=1<<Math.min(i,22);let v=p*(h%p)+l%p;return n&&i<22&&(v+=p*p*((n<0?-2*n-1:2*n)%(1<<2*(22-i)))),16*(32*v+i)+(t-i)}$t(vm,"CanonicalTileID"),$t(Vr,"OverscaledTileID",{omit:["projMatrix"]});class Vu extends Y{constructor(t,i,l){super(t,i),this.z=l}}function Bd(n,t){return n.x*t.x+n.y*t.y}function vb(n,t){if(n.length===1){let i=0;const l=t[i++];let h;for(;!h||l.equals(h);)if(h=t[i++],!h)return 1/0;for(;i<t.length;i++){const p=t[i],v=n[0],x=h.sub(l),E=p.sub(l),T=v.sub(l),k=Bd(x,x),P=Bd(x,E),D=Bd(E,E),V=Bd(T,x),N=Bd(T,E),G=k*D-P*P,X=(D*V-P*N)/G,le=(k*N-P*V)/G,ye=l.z*(1-X-le)+h.z*X+p.z*le;if(isFinite(ye))return ye}return 1/0}{let i=1/0;for(const l of t)i=Math.min(i,l.z);return i}}function _b(n,t,i,l,h,p,v,x){const E=v*h.getElevationAt(n,t,!0,!0),T=p[0]!==0,k=T?p[1]===0?v*(p[0]/7-450):v*function(P,D,V){const N=Math.floor(D[0]/8),G=Math.floor(D[1]/8),X=10*(D[0]-8*N),le=10*(D[1]-8*G),ye=P.getElevationAt(N,G,!0,!0),re=P.getMeterToDEM(V),ge=Math.floor(.5*(X*re-1)),Te=Math.floor(.5*(le*re-1)),xe=P.tileCoordToPixel(N,G),je=2*ge+1,Ne=2*Te+1,tt=function(_t,Xe,It,rn,Rt){return[_t.getElevationAtPixel(Xe,It,!0),_t.getElevationAtPixel(Xe+Rt,It,!0),_t.getElevationAtPixel(Xe,It+Rt,!0),_t.getElevationAtPixel(Xe+rn,It+Rt,!0)]}(P,xe.x-ge,xe.y-Te,je,Ne),vt=Math.abs(tt[0]-tt[1]),We=Math.abs(tt[2]-tt[3]),it=Math.abs(tt[0]-tt[2])+Math.abs(tt[1]-tt[3]),ot=Math.min(.25,.5*re*(vt+We)/je),dt=Math.min(.25,.5*re*it/Ne);return ye+Math.max(ot*X,dt*le)}(h,p,x):E;return{base:E+(i===0)?-1:i,top:T?Math.max(k+l,E+i+2):E+l}}const tA=Xt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:nA}=tA,iA=Xt([{name:"a_packed",components:4,type:"Float32"}]),{members:rA}=iA,oA=mm.types,sA=Math.cos(Math.PI/180*37.5);class _m{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new ui,this.layoutVertexArray2=new oi,this.indexArray=new br,this.programConfigurations=new tc(t.layers,t.zoom),this.segments=new $i,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,l,h){this.hasPattern=jv("line",this.layers,i);const p=this.layers[0].layout.get("line-sort-key"),v=[];for(const{feature:k,id:P,index:D,sourceLayerIndex:V}of t){const N=this.layers[0]._featureFilter.needGeometry,G=ac(k,N);if(!this.layers[0]._featureFilter.filter(new Be(this.zoom),G,l))continue;const X=p?p.evaluate(G,{},l):void 0,le={id:P,properties:k.properties,type:k.type,sourceLayerIndex:V,index:D,geometry:N?G.geometry:oa(k,l,h),patterns:{},sortKey:X};v.push(le)}p&&v.sort((k,P)=>k.sortKey-P.sortKey);const{lineAtlas:x,featureIndex:E}=i,T=this.addConstantDashes(x);for(const k of v){const{geometry:P,index:D,sourceLayerIndex:V}=k;if(T&&this.addFeatureDashes(k,x),this.hasPattern){const N=Gv("line",this.layers,k,this.zoom,i);this.patternFeatures.push(N)}else this.addFeature(k,P,D,l,x.positions,i.availableImages);E.insert(t[D].feature,P,D,V,this.index)}}addConstantDashes(t){let i=!1;for(const l of this.layers){const h=l.paint.get("line-dasharray").value,p=l.layout.get("line-cap").value;if(h.kind!=="constant"||p.kind!=="constant")i=!0;else{const v=p.value,x=h.value;if(!x)continue;t.addDash(x,v)}}return i}addFeatureDashes(t,i){const l=this.zoom;for(const h of this.layers){const p=h.paint.get("line-dasharray").value,v=h.layout.get("line-cap").value;if(p.kind==="constant"&&v.kind==="constant")continue;let x,E;if(p.kind==="constant"){if(x=p.value,!x)continue}else x=p.evaluate({zoom:l},t);E=v.kind==="constant"?v.value:v.evaluate({zoom:l},t),i.addDash(x,E),t.patterns[h.id]=i.getKey(x,E)}}update(t,i,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,l,h)}addFeatures(t,i,l,h,p){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,i,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,rA)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,nA),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,i,l,h,p,v){const x=this.layers[0].layout,E=x.get("line-join").evaluate(t,{}),T=x.get("line-cap").evaluate(t,{}),k=x.get("line-miter-limit"),P=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const D of i)this.addLine(D,t,E,T,k,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,p,v,h)}addLine(t,i,l,h,p,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let le=0;le<t.length-1;le++)this.totalDistance+=t[le].dist(t[le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x=oA[i.type]==="Polygon";let E=t.length;for(;E>=2&&t[E-1].equals(t[E-2]);)E--;let T=0;for(;T<E-1&&t[T].equals(t[T+1]);)T++;if(E<(x?3:2))return;l==="bevel"&&(p=1.05);const k=this.overscaling<=16?122880/(512*this.overscaling):0,P=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let D,V,N,G,X;this.e1=this.e2=-1,x&&(D=t[E-2],X=t[T].sub(D)._unit()._perp());for(let le=T;le<E;le++){if(N=le===E-1?x?t[T+1]:void 0:t[le+1],N&&t[le].equals(N))continue;X&&(G=X),D&&(V=D),D=t[le],X=N?N.sub(D)._unit()._perp():G,G=G||X;let ye=G.add(X);ye.x===0&&ye.y===0||ye._unit();const re=G.x*X.x+G.y*X.y,ge=ye.x*X.x+ye.y*X.y,Te=ge!==0?1/ge:1/0,xe=2*Math.sqrt(2-2*ge),je=ge<sA&&V&&N,Ne=G.x*X.y-G.y*X.x>0;if(je&&le>T){const We=D.dist(V);if(We>2*k){const it=D.sub(D.sub(V)._mult(k/We)._round());this.updateDistance(V,it),this.addCurrentVertex(it,G,0,0,P),V=it}}const tt=V&&N;let vt=tt?l:x?"butt":h;if(tt&&vt==="round"&&(Te<v?vt="miter":Te<=2&&(vt="fakeround")),vt==="miter"&&Te>p&&(vt="bevel"),vt==="bevel"&&(Te>2&&(vt="flipbevel"),Te<p&&(vt="miter")),V&&this.updateDistance(V,D),vt==="miter")ye._mult(Te),this.addCurrentVertex(D,ye,0,0,P);else if(vt==="flipbevel"){if(Te>100)ye=X.mult(-1);else{const We=Te*G.add(X).mag()/G.sub(X).mag();ye._perp()._mult(We*(Ne?-1:1))}this.addCurrentVertex(D,ye,0,0,P),this.addCurrentVertex(D,ye.mult(-1),0,0,P)}else if(vt==="bevel"||vt==="fakeround"){const We=-Math.sqrt(Te*Te-1),it=Ne?We:0,ot=Ne?0:We;if(V&&this.addCurrentVertex(D,G,it,ot,P),vt==="fakeround"){const dt=Math.round(180*xe/Math.PI/20);for(let _t=1;_t<dt;_t++){let Xe=_t/dt;if(Xe!==.5){const rn=Xe-.5;Xe+=Xe*rn*(Xe-1)*((1.0904+re*(re*(3.55645-1.43519*re)-3.2452))*rn*rn+(.848013+re*(.215638*re-1.06021)))}const It=X.sub(G)._mult(Xe)._add(G)._unit()._mult(Ne?-1:1);this.addHalfVertex(D,It.x,It.y,!1,Ne,0,P)}}N&&this.addCurrentVertex(D,X,-it,-ot,P)}else if(vt==="butt")this.addCurrentVertex(D,ye,0,0,P);else if(vt==="square"){const We=V?1:-1;V||this.addCurrentVertex(D,ye,We,We,P),this.addCurrentVertex(D,ye,0,0,P),V&&this.addCurrentVertex(D,ye,We,We,P)}else vt==="round"&&(V&&(this.addCurrentVertex(D,G,0,0,P),this.addCurrentVertex(D,G,1,1,P,!0)),N&&(this.addCurrentVertex(D,X,-1,-1,P,!0),this.addCurrentVertex(D,X,0,0,P)));if(je&&le<E-1){const We=D.dist(N);if(We>2*k){const it=D.add(N.sub(D)._mult(k/We)._round());this.updateDistance(D,it),this.addCurrentVertex(it,X,0,0,P),D=it}}}}addCurrentVertex(t,i,l,h,p,v=!1){const x=i.y*h-i.x,E=-i.y-i.x*h;this.addHalfVertex(t,i.x+i.y*l,i.y-i.x*l,v,!1,l,p),this.addHalfVertex(t,x,E,v,!0,-h,p)}addHalfVertex({x:t,y:i},l,h,p,v,x,E){this.layoutVertexArray.emplaceBack((t<<1)+(p?1:0),(i<<1)+(v?1:0),Math.round(63*l)+128,Math.round(63*h)+128,1+(x===0?0:x<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const T=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),E.primitiveLength++),v?this.e2=T:this.e1=T}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,i){this.distance+=t.dist(i),this.updateScaledDistance()}}$t(_m,"LineBucket",{omit:["layers","patternFeatures"]});const aA=new mt({"line-cap":new Ze(et.layout_line["line-cap"]),"line-join":new Ze(et.layout_line["line-join"]),"line-miter-limit":new Le(et.layout_line["line-miter-limit"]),"line-round-limit":new Le(et.layout_line["line-round-limit"]),"line-sort-key":new Ze(et.layout_line["line-sort-key"])});var yb={paint:new mt({"line-opacity":new Ze(et.paint_line["line-opacity"]),"line-color":new Ze(et.paint_line["line-color"]),"line-translate":new Le(et.paint_line["line-translate"]),"line-translate-anchor":new Le(et.paint_line["line-translate-anchor"]),"line-width":new Ze(et.paint_line["line-width"]),"line-gap-width":new Ze(et.paint_line["line-gap-width"]),"line-offset":new Ze(et.paint_line["line-offset"]),"line-blur":new Ze(et.paint_line["line-blur"]),"line-dasharray":new Ze(et.paint_line["line-dasharray"]),"line-pattern":new Ze(et.paint_line["line-pattern"]),"line-gradient":new lt(et.paint_line["line-gradient"]),"line-trim-offset":new Le(et.paint_line["line-trim-offset"])}),layout:aA};const xb=new class extends Ze{possiblyEvaluate(n,t){return t=new Be(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(n,t)}evaluate(n,t,i,l){return t=pt({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(n,t,i,l)}}(yb.paint.properties["line-width"].specification);function bb(n,t){return t>0?t+2*n:n}xb.useIntegerZoom=!0;const lA=Xt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),cA=Xt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),uA=Xt([{name:"a_projected_pos",components:4,type:"Float32"}],4);Xt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const hA=Xt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),dA=Xt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Xt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const wb=Xt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),fA=Xt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Xt([{name:"triangle",components:3,type:"Uint16"}]),Xt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Xt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Xt([{type:"Float32",name:"offsetX"}]),Xt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Sr=24;const Ts=128;function Zv(n,t){const{expression:i}=t;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new Be(n+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:h}=i;let p=0;for(;p<l.length&&l[p]<=n;)p++;p=Math.max(0,p-1);let v=p;for(;v<l.length&&l[v]<n+1;)v++;v=Math.min(l.length-1,v);const x=l[p],E=l[v];return i.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:E,interpolationType:h}:{kind:"camera",minZoom:x,maxZoom:E,minSize:i.evaluate(new Be(x)),maxSize:i.evaluate(new Be(E)),interpolationType:h}}}function ym(n,{uSize:t,uSizeT:i},{lowerSize:l,upperSize:h}){return n.kind==="source"?l/Ts:n.kind==="composite"?Vn(l/Ts,h/Ts,i):t}function Nu(n,t){let i=0,l=0;if(n.kind==="constant")l=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:h,minZoom:p,maxZoom:v}=n,x=h?nt(wo.interpolationFactor(h,t,p,v),0,1):0;n.kind==="camera"?l=Vn(n.minSize,n.maxSize,x):i=x}return{uSizeT:i,uSize:l}}var pA=Object.freeze({__proto__:null,getSizeData:Zv,evaluateSizeForFeature:ym,evaluateSizeForZoom:Nu,SIZE_PACK_FACTOR:Ts});function mA(n,t,i){return n.sections.forEach(l=>{l.text=function(h,p,v){const x=p.layout.get("text-transform").evaluate(v,{});return x==="uppercase"?h=h.toLocaleUpperCase():x==="lowercase"&&(h=h.toLocaleLowerCase()),Ae.applyArabicShaping&&(h=Ae.applyArabicShaping(h)),h}(l.text,t,i)}),n}const Od={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function gA(n){return n==="\uFE36"||n==="\uFE48"||n==="\uFE38"||n==="\uFE44"||n==="\uFE42"||n==="\uFE3E"||n==="\uFE3C"||n==="\uFE3A"||n==="\uFE18"||n==="\uFE40"||n==="\uFE10"||n==="\uFE13"||n==="\uFE14"||n==="\uFF40"||n==="\uFFE3"||n==="\uFE11"||n==="\uFE12"}function vA(n){return n==="\uFE35"||n==="\uFE47"||n==="\uFE37"||n==="\uFE43"||n==="\uFE41"||n==="\uFE3D"||n==="\uFE3B"||n==="\uFE39"||n==="\uFE17"||n==="\uFE3F"}var Fd=hi,Eb=function(n,t,i,l,h){var p,v,x=8*h-l-1,E=(1<<x)-1,T=E>>1,k=-7,P=i?h-1:0,D=i?-1:1,V=n[t+P];for(P+=D,p=V&(1<<-k)-1,V>>=-k,k+=x;k>0;p=256*p+n[t+P],P+=D,k-=8);for(v=p&(1<<-k)-1,p>>=-k,k+=l;k>0;v=256*v+n[t+P],P+=D,k-=8);if(p===0)p=1-T;else{if(p===E)return v?NaN:1/0*(V?-1:1);v+=Math.pow(2,l),p-=T}return(V?-1:1)*v*Math.pow(2,p-l)},Sb=function(n,t,i,l,h,p){var v,x,E,T=8*p-h-1,k=(1<<T)-1,P=k>>1,D=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,V=l?0:p-1,N=l?1:-1,G=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(x=isNaN(t)?1:0,v=k):(v=Math.floor(Math.log(t)/Math.LN2),t*(E=Math.pow(2,-v))<1&&(v--,E*=2),(t+=v+P>=1?D/E:D*Math.pow(2,1-P))*E>=2&&(v++,E/=2),v+P>=k?(x=0,v=k):v+P>=1?(x=(t*E-1)*Math.pow(2,h),v+=P):(x=t*Math.pow(2,P-1)*Math.pow(2,h),v=0));h>=8;n[i+V]=255&x,V+=N,x/=256,h-=8);for(v=v<<h|x,T+=h;T>0;n[i+V]=255&v,V+=N,v/=256,T-=8);n[i+V-N]|=128*G};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function hi(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}hi.Varint=0,hi.Fixed64=1,hi.Bytes=2,hi.Fixed32=5;var Wv=4294967296,Tb=1/Wv,Cb=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function aa(n){return n.type===hi.Bytes?n.readVarint()+n.pos:n.pos+1}function $u(n,t,i){return i?4294967296*t+(n>>>0):4294967296*(t>>>0)+(n>>>0)}function Ib(n,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var h=i.pos-1;h>=n;h--)i.buf[h+l]=i.buf[h]}function _A(n,t){for(var i=0;i<n.length;i++)t.writeVarint(n[i])}function yA(n,t){for(var i=0;i<n.length;i++)t.writeSVarint(n[i])}function xA(n,t){for(var i=0;i<n.length;i++)t.writeFloat(n[i])}function bA(n,t){for(var i=0;i<n.length;i++)t.writeDouble(n[i])}function wA(n,t){for(var i=0;i<n.length;i++)t.writeBoolean(n[i])}function EA(n,t){for(var i=0;i<n.length;i++)t.writeFixed32(n[i])}function SA(n,t){for(var i=0;i<n.length;i++)t.writeSFixed32(n[i])}function TA(n,t){for(var i=0;i<n.length;i++)t.writeFixed64(n[i])}function CA(n,t){for(var i=0;i<n.length;i++)t.writeSFixed64(n[i])}function xm(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16)+16777216*n[t+3]}function Uu(n,t,i){n[i]=t,n[i+1]=t>>>8,n[i+2]=t>>>16,n[i+3]=t>>>24}function Ab(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16)+(n[t+3]<<24)}function IA(n,t,i){t.glyphs=[],n===1&&i.readMessage(AA,t)}function AA(n,t,i){if(n===3){const{id:l,bitmap:h,width:p,height:v,left:x,top:E,advance:T}=i.readMessage(kA,{});t.glyphs.push({id:l,bitmap:new sa({width:p+6,height:v+6},h),metrics:{width:p,height:v,left:x,top:E,advance:T}})}else n===4?t.ascender=i.readSVarint():n===5&&(t.descender=i.readSVarint())}function kA(n,t,i){n===1?t.id=i.readVarint():n===2?t.bitmap=i.readBytes():n===3?t.width=i.readVarint():n===4?t.height=i.readVarint():n===5?t.left=i.readSVarint():n===6?t.top=i.readSVarint():n===7&&(t.advance=i.readVarint())}function Hv(n){let t=0,i=0;for(const v of n)t+=v.w*v.h,i=Math.max(i,v.w);n.sort((v,x)=>x.h-v.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let h=0,p=0;for(const v of n)for(let x=l.length-1;x>=0;x--){const E=l[x];if(!(v.w>E.w||v.h>E.h)){if(v.x=E.x,v.y=E.y,p=Math.max(p,v.y+v.h),h=Math.max(h,v.x+v.w),v.w===E.w&&v.h===E.h){const T=l.pop();x<l.length&&(l[x]=T)}else v.h===E.h?(E.x+=v.w,E.w-=v.w):v.w===E.w?(E.y+=v.h,E.h-=v.h):(l.push({x:E.x+v.w,y:E.y,w:E.w-v.w,h:v.h}),E.y+=v.h,E.h-=v.h);break}}return{w:h,h:p,fill:t/(h*p)||0}}hi.prototype={destroy:function(){this.buf=null},readFields:function(n,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),h=l>>3,p=this.pos;this.type=7&l,n(h,t,this),this.pos===p&&this.skip(l)}return t},readMessage:function(n,t){return this.readFields(n,t,this.readVarint()+this.pos)},readFixed32:function(){var n=xm(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=Ab(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=xm(this.buf,this.pos)+xm(this.buf,this.pos+4)*Wv;return this.pos+=8,n},readSFixed64:function(){var n=xm(this.buf,this.pos)+Ab(this.buf,this.pos+4)*Wv;return this.pos+=8,n},readFloat:function(){var n=Eb(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=Eb(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(h,p,v){var x,E,T=v.buf;if(x=(112&(E=T[v.pos++]))>>4,E<128||(x|=(127&(E=T[v.pos++]))<<3,E<128)||(x|=(127&(E=T[v.pos++]))<<10,E<128)||(x|=(127&(E=T[v.pos++]))<<17,E<128)||(x|=(127&(E=T[v.pos++]))<<24,E<128)||(x|=(1&(E=T[v.pos++]))<<31,E<128))return $u(h,x,p);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var n=this.readVarint()+this.pos,t=this.pos;return this.pos=n,n-t>=12&&Cb?function(i,l,h){return Cb.decode(i.subarray(l,h))}(this.buf,t,n):function(i,l,h){for(var p="",v=l;v<h;){var x,E,T,k=i[v],P=null,D=k>239?4:k>223?3:k>191?2:1;if(v+D>h)break;D===1?k<128&&(P=k):D===2?(192&(x=i[v+1]))==128&&(P=(31&k)<<6|63&x)<=127&&(P=null):D===3?(E=i[v+2],(192&(x=i[v+1]))==128&&(192&E)==128&&((P=(15&k)<<12|(63&x)<<6|63&E)<=2047||P>=55296&&P<=57343)&&(P=null)):D===4&&(E=i[v+2],T=i[v+3],(192&(x=i[v+1]))==128&&(192&E)==128&&(192&T)==128&&((P=(15&k)<<18|(63&x)<<12|(63&E)<<6|63&T)<=65535||P>=1114112)&&(P=null)),P===null?(P=65533,D=1):P>65535&&(P-=65536,p+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),p+=String.fromCharCode(P),v+=D}return p}(this.buf,t,n)},readBytes:function(){var n=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,n);return this.pos=n,t},readPackedVarint:function(n,t){if(this.type!==hi.Bytes)return n.push(this.readVarint(t));var i=aa(this);for(n=n||[];this.pos<i;)n.push(this.readVarint(t));return n},readPackedSVarint:function(n){if(this.type!==hi.Bytes)return n.push(this.readSVarint());var t=aa(this);for(n=n||[];this.pos<t;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==hi.Bytes)return n.push(this.readBoolean());var t=aa(this);for(n=n||[];this.pos<t;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==hi.Bytes)return n.push(this.readFloat());var t=aa(this);for(n=n||[];this.pos<t;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==hi.Bytes)return n.push(this.readDouble());var t=aa(this);for(n=n||[];this.pos<t;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==hi.Bytes)return n.push(this.readFixed32());var t=aa(this);for(n=n||[];this.pos<t;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==hi.Bytes)return n.push(this.readSFixed32());var t=aa(this);for(n=n||[];this.pos<t;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==hi.Bytes)return n.push(this.readFixed64());var t=aa(this);for(n=n||[];this.pos<t;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==hi.Bytes)return n.push(this.readSFixed64());var t=aa(this);for(n=n||[];this.pos<t;)n.push(this.readSFixed64());return n},skip:function(n){var t=7&n;if(t===hi.Varint)for(;this.buf[this.pos++]>127;);else if(t===hi.Bytes)this.pos=this.readVarint()+this.pos;else if(t===hi.Fixed32)this.pos+=4;else{if(t!==hi.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(n,t){this.writeVarint(n<<3|t)},realloc:function(n){for(var t=this.length||16;t<this.pos+n;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),Uu(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),Uu(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),Uu(this.buf,-1&n,this.pos),Uu(this.buf,Math.floor(n*Tb),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),Uu(this.buf,-1&n,this.pos),Uu(this.buf,Math.floor(n*Tb),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(t,i){var l,h;if(t>=0?(l=t%4294967296|0,h=t/4294967296|0):(h=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,h=h+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(p,v,x){x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,x.buf[x.pos]=127&(p>>>=7)}(l,0,i),function(p,v){var x=(7&p)<<4;v.buf[v.pos++]|=x|((p>>>=3)?128:0),p&&(v.buf[v.pos++]=127&p|((p>>>=7)?128:0),p&&(v.buf[v.pos++]=127&p|((p>>>=7)?128:0),p&&(v.buf[v.pos++]=127&p|((p>>>=7)?128:0),p&&(v.buf[v.pos++]=127&p|((p>>>=7)?128:0),p&&(v.buf[v.pos++]=127&p)))))}(h,i)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(Boolean(n))},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var t=this.pos;this.pos=function(l,h,p){for(var v,x,E=0;E<h.length;E++){if((v=h.charCodeAt(E))>55295&&v<57344){if(!x){v>56319||E+1===h.length?(l[p++]=239,l[p++]=191,l[p++]=189):x=v;continue}if(v<56320){l[p++]=239,l[p++]=191,l[p++]=189,x=v;continue}v=x-55296<<10|v-56320|65536,x=null}else x&&(l[p++]=239,l[p++]=191,l[p++]=189,x=null);v<128?l[p++]=v:(v<2048?l[p++]=v>>6|192:(v<65536?l[p++]=v>>12|224:(l[p++]=v>>18|240,l[p++]=v>>12&63|128),l[p++]=v>>6&63|128),l[p++]=63&v|128)}return p}(this.buf,n,this.pos);var i=this.pos-t;i>=128&&Ib(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(n){this.realloc(4),Sb(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),Sb(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var t=n.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=n[i]},writeRawMessage:function(n,t){this.pos++;var i=this.pos;n(t,this);var l=this.pos-i;l>=128&&Ib(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(n,t,i){this.writeTag(n,hi.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(n,t){t.length&&this.writeMessage(n,_A,t)},writePackedSVarint:function(n,t){t.length&&this.writeMessage(n,yA,t)},writePackedBoolean:function(n,t){t.length&&this.writeMessage(n,wA,t)},writePackedFloat:function(n,t){t.length&&this.writeMessage(n,xA,t)},writePackedDouble:function(n,t){t.length&&this.writeMessage(n,bA,t)},writePackedFixed32:function(n,t){t.length&&this.writeMessage(n,EA,t)},writePackedSFixed32:function(n,t){t.length&&this.writeMessage(n,SA,t)},writePackedFixed64:function(n,t){t.length&&this.writeMessage(n,TA,t)},writePackedSFixed64:function(n,t){t.length&&this.writeMessage(n,CA,t)},writeBytesField:function(n,t){this.writeTag(n,hi.Bytes),this.writeBytes(t)},writeFixed32Field:function(n,t){this.writeTag(n,hi.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(n,t){this.writeTag(n,hi.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(n,t){this.writeTag(n,hi.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(n,t){this.writeTag(n,hi.Fixed64),this.writeSFixed64(t)},writeVarintField:function(n,t){this.writeTag(n,hi.Varint),this.writeVarint(t)},writeSVarintField:function(n,t){this.writeTag(n,hi.Varint),this.writeSVarint(t)},writeStringField:function(n,t){this.writeTag(n,hi.Bytes),this.writeString(t)},writeFloatField:function(n,t){this.writeTag(n,hi.Fixed32),this.writeFloat(t)},writeDoubleField:function(n,t){this.writeTag(n,hi.Fixed64),this.writeDouble(t)},writeBooleanField:function(n,t){this.writeVarintField(n,Boolean(t))}};class Xv{constructor(t,{pixelRatio:i,version:l,stretchX:h,stretchY:p,content:v}){this.paddedRect=t,this.pixelRatio=i,this.stretchX=h,this.stretchY=p,this.content=v,this.version=l}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class kb{constructor(t,i){const l={},h={};this.haveRenderCallbacks=[];const p=[];this.addImages(t,l,p),this.addImages(i,h,p);const{w:v,h:x}=Hv(p),E=new eo({width:v||1,height:x||1});for(const T in t){const k=t[T],P=l[T].paddedRect;eo.copy(k.data,E,{x:0,y:0},{x:P.x+1,y:P.y+1},k.data)}for(const T in i){const k=i[T],P=h[T].paddedRect,D=P.x+1,V=P.y+1,N=k.data.width,G=k.data.height;eo.copy(k.data,E,{x:0,y:0},{x:D,y:V},k.data),eo.copy(k.data,E,{x:0,y:G-1},{x:D,y:V-1},{width:N,height:1}),eo.copy(k.data,E,{x:0,y:0},{x:D,y:V+G},{width:N,height:1}),eo.copy(k.data,E,{x:N-1,y:0},{x:D-1,y:V},{width:1,height:G}),eo.copy(k.data,E,{x:0,y:0},{x:D+N,y:V},{width:1,height:G})}this.image=E,this.iconPositions=l,this.patternPositions=h}addImages(t,i,l){for(const h in t){const p=t[h],v={x:0,y:0,w:p.data.width+2,h:p.data.height+2};l.push(v),i[h]=new Xv(v,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(l=>t.hasImage(l)),t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),i),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),i)}patchUpdatedImage(t,i,l){if(!t||!i||t.version===i.version)return;t.version=i.version;const[h,p]=t.tl;l.update(i.data,void 0,{x:h,y:p})}}$t(Xv,"ImagePosition"),$t(kb,"ImageAtlas");const ho={horizontal:1,vertical:2,horizontalOnly:3};class Vd{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,i){const l=new Vd;return l.scale=t||1,l.fontStack=i,l}static forImage(t){const i=new Vd;return i.imageName=t,i}}class ju{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,i){const l=new ju;for(let h=0;h<t.sections.length;h++){const p=t.sections[h];p.image?l.addImageSection(p):l.addTextSection(p,i)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(t){this.text=function(i,l){let h="";for(let p=0;p<i.length;p++){const v=i.charCodeAt(p+1)||null,x=i.charCodeAt(p-1)||null;h+=!l&&(v&&M(v)&&!Od[i[p+1]]||x&&M(x)&&!Od[i[p-1]])||!Od[i[p]]?i[p]:Od[i[p]]}return h}(this.text,t)}trim(){let t=0;for(let l=0;l<this.text.length&&bm[this.text.charCodeAt(l)];l++)t++;let i=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&bm[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)}substring(t,i){const l=new ju;return l.text=this.text.substring(t,i),l.sectionIndex=this.sectionIndex.slice(t,i),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,i)=>Math.max(t,this.sections[i].scale),0)}addTextSection(t,i){this.text+=t.text,this.sections.push(Vd.forText(t.scale,t.fontStack||i));const l=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(l)}addImageSection(t){const i=t.image?t.image.name:"";if(i.length===0)return void he("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Vd.forImage(i)),this.sectionIndex.push(this.sections.length-1)):he("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Yv(n,t,i,l,h,p,v,x,E,T,k,P,D,V,N){const G=ju.fromFeature(n,h);P===ho.vertical&&G.verticalizePunctuation(D);let X=[];const le=function(xe,je,Ne,tt,vt,We){if(!xe)return[];const it=[],ot=function(It,rn,Rt,Zt,At,an){let An=0;for(let wn=0;wn<It.length();wn++){const xn=It.getSection(wn);An+=Mb(It.getCharCode(wn),xn,Zt,At,rn,an)}return An/Math.max(1,Math.ceil(An/Rt))}(xe,je,Ne,tt,vt,We),dt=xe.text.indexOf("\u200B")>=0;let _t=0;for(let It=0;It<xe.length();It++){const rn=xe.getSection(It),Rt=xe.getCharCode(It);if(bm[Rt]||(_t+=Mb(Rt,rn,tt,vt,je,We)),It<xe.length()-1){const Zt=!((Xe=Rt)<11904||!(Up(Xe)||Iu(Xe)||f(Xe)||Yp(Xe)||qp(Xe)||$p(Xe)||jp(Xe)||Jl(Xe)||Zp(Xe)||md(Xe)||Gp(Xe)||m(Xe)||Cu(Xe)||fd(Xe)||dd(Xe)||pd(Xe)||Ha(Xe)||Ql(Xe)||Hp(Xe)||Wp(Xe)));(MA[Rt]||Zt||rn.imageName)&&it.push(zb(It+1,_t,ot,it,PA(Rt,xe.getCharCode(It+1),Zt&&dt),!1))}}var Xe;return Lb(zb(xe.length(),_t,ot,it,0,!0))}(G,T,p,t,l,V),{processBidirectionalText:ye,processStyledBidirectionalText:re}=Ae;if(ye&&G.sections.length===1){const xe=ye(G.toString(),le);for(const je of xe){const Ne=new ju;Ne.text=je,Ne.sections=G.sections;for(let tt=0;tt<je.length;tt++)Ne.sectionIndex.push(0);X.push(Ne)}}else if(re){const xe=re(G.text,G.sectionIndex,le);for(const je of xe){const Ne=new ju;Ne.text=je[0],Ne.sectionIndex=je[1],Ne.sections=G.sections,X.push(Ne)}}else X=function(xe,je){const Ne=[],tt=xe.text;let vt=0;for(const We of je)Ne.push(xe.substring(vt,We)),vt=We;return vt<tt.length&&Ne.push(xe.substring(vt,tt.length)),Ne}(G,le);const ge=[],Te={positionedLines:ge,text:G.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(xe,je,Ne,tt,vt,We,it,ot,dt,_t,Xe,It){let rn=0,Rt=0,Zt=0;const At=ot==="right"?1:ot==="left"?0:.5;let an=!1;for(const dn of vt){const kn=dn.getSections();for(const ii of kn){if(ii.imageName)continue;const mi=je[ii.fontStack];if(mi&&(an=mi.ascender!==void 0&&mi.descender!==void 0,!an))break}if(!an)break}let An=0;for(const dn of vt){dn.trim();const kn=dn.getMaxScale(),ii=(kn-1)*Sr,mi={positionedGlyphs:[],lineOffset:0};xe.positionedLines[An]=mi;const di=mi.positionedGlyphs;let gi=0;if(!dn.length()){Rt+=We,++An;continue}let yi=0,Mi=0;for(let Qn=0;Qn<dn.length();Qn++){const Yi=dn.getSection(Qn),ji=dn.getSectionIndex(Qn),Un=dn.getCharCode(Qn);let Ei=Yi.scale,nr=null,ri=null,Oi=null,kr=Sr,dr=0;const fr=!(dt===ho.horizontal||!Xe&&!I(Un)||Xe&&(bm[Un]||(wn=Un,Kl(wn)||Np(wn)||hd(wn)||Au(wn)||u(wn))));if(Yi.imageName){const Nr=tt[Yi.imageName];if(!Nr)continue;Oi=Yi.imageName,xe.iconsInText=xe.iconsInText||!0,ri=Nr.paddedRect;const pr=Nr.displaySize;Ei=Ei*Sr/It,nr={width:pr[0],height:pr[1],left:1,top:-3,advance:fr?pr[1]:pr[0],localGlyph:!1},dr=an?-nr.height*Ei:kn*Sr-17-pr[1]*Ei,kr=nr.advance;const ca=(fr?pr[0]:pr[1])*Ei-Sr*kn;ca>0&&ca>gi&&(gi=ca)}else{const Nr=Ne[Yi.fontStack];if(!Nr)continue;Nr[Un]&&(ri=Nr[Un]);const pr=je[Yi.fontStack];if(!pr)continue;const ca=pr.glyphs[Un];if(!ca)continue;if(nr=ca.metrics,kr=Un!==8203?Sr:0,an){const Hu=pr.ascender!==void 0?Math.abs(pr.ascender):0,Wd=pr.descender!==void 0?Math.abs(pr.descender):0,Hd=(Hu+Wd)*Ei;yi<Hd&&(yi=Hd,Mi=(Hu-Wd)/2*Ei),dr=-Hu*Ei}else dr=(kn-Ei)*Sr-17}fr?(xe.verticalizable=!0,di.push({glyph:Un,imageName:Oi,x:rn,y:Rt+dr,vertical:fr,scale:Ei,localGlyph:nr.localGlyph,fontStack:Yi.fontStack,sectionIndex:ji,metrics:nr,rect:ri}),rn+=kr*Ei+_t):(di.push({glyph:Un,imageName:Oi,x:rn,y:Rt+dr,vertical:fr,scale:Ei,localGlyph:nr.localGlyph,fontStack:Yi.fontStack,sectionIndex:ji,metrics:nr,rect:ri}),rn+=nr.advance*Ei+_t)}di.length!==0&&(Zt=Math.max(rn-_t,Zt),an?Db(di,At,gi,Mi,We*kn/2):Db(di,At,gi,0,We/2)),rn=0;const hr=We*kn+gi;mi.lineOffset=Math.max(gi,ii),Rt+=hr,++An}var wn;const xn=Rt,{horizontalAlign:ln,verticalAlign:Jn}=Kv(it);(function(dn,kn,ii,mi,di,gi){const yi=(kn-ii)*di,Mi=-gi*mi;for(const hr of dn)for(const Qn of hr.positionedGlyphs)Qn.x+=yi,Qn.y+=Mi})(xe.positionedLines,At,ln,Jn,Zt,xn),xe.top+=-Jn*xn,xe.bottom=xe.top+xn,xe.left+=-ln*Zt,xe.right=xe.left+Zt,xe.hasBaseline=an}(Te,t,i,l,X,v,x,E,P,T,D,N),!function(xe){for(const je of xe)if(je.positionedGlyphs.length!==0)return!1;return!0}(ge)&&Te}const bm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},MA={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Mb(n,t,i,l,h,p){if(t.imageName){const v=l[t.imageName];return v?v.displaySize[0]*t.scale*Sr/p+h:0}{const v=i[t.fontStack],x=v&&v.glyphs[n];return x?x.metrics.advance*t.scale+h:0}}function Pb(n,t,i,l){const h=Math.pow(n-t,2);return l?n<t?h/2:2*h:h+Math.abs(i)*i}function PA(n,t,i){let l=0;return n===10&&(l-=1e4),i&&(l+=150),n!==40&&n!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function zb(n,t,i,l,h,p){let v=null,x=Pb(t,i,h,p);for(const E of l){const T=Pb(t-E.x,i,h,p)+E.badness;T<=x&&(v=E,x=T)}return{index:n,x:t,priorBreak:v,badness:x}}function Lb(n){return n?Lb(n.priorBreak).concat(n.index):[]}function Kv(n){let t=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Db(n,t,i,l,h){if(!(t||i||l||h))return;const p=n.length-1,v=n[p],x=(v.x+v.metrics.advance*v.scale)*t;for(let E=0;E<=p;E++)n[E].x-=x,n[E].y+=i+l+h}function zA(n,t,i){const{horizontalAlign:l,verticalAlign:h}=Kv(i),p=t[0]-n.displaySize[0]*l,v=t[1]-n.displaySize[1]*h;return{image:n,top:v,bottom:v+n.displaySize[1],left:p,right:p+n.displaySize[0]}}function Rb(n,t,i,l,h,p){const v=n.image;let x;if(v.content){const X=v.content,le=v.pixelRatio||1;x=[X[0]/le,X[1]/le,v.displaySize[0]-X[2]/le,v.displaySize[1]-X[3]/le]}const E=t.left*p,T=t.right*p;let k,P,D,V;i==="width"||i==="both"?(V=h[0]+E-l[3],P=h[0]+T+l[1]):(V=h[0]+(E+T-v.displaySize[0])/2,P=V+v.displaySize[0]);const N=t.top*p,G=t.bottom*p;return i==="height"||i==="both"?(k=h[1]+N-l[0],D=h[1]+G+l[2]):(k=h[1]+(N+G-v.displaySize[1])/2,D=k+v.displaySize[1]),{image:v,top:k,right:P,bottom:D,left:V,collisionPadding:x}}class la extends Y{constructor(t,i,l,h,p){super(t,i),this.angle=h,this.z=l,p!==void 0&&(this.segment=p)}clone(){return new la(this.x,this.y,this.z,this.angle,this.segment)}}function Bb(n,t,i,l,h){if(t.segment===void 0)return!0;let p=t,v=t.segment+1,x=0;for(;x>-i/2;){if(v--,v<0)return!1;x-=n[v].dist(p),p=n[v]}x+=n[v].dist(n[v+1]),v++;const E=[];let T=0;for(;x<i/2;){const k=n[v],P=n[v+1];if(!P)return!1;let D=n[v-1].angleTo(k)-k.angleTo(P);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:x,angleDelta:D}),T+=D;x-E[0].distance>l;)T-=E.shift().angleDelta;if(T>h)return!1;v++,x+=k.dist(P)}return!0}function Ob(n){let t=0;for(let i=0;i<n.length-1;i++)t+=n[i].dist(n[i+1]);return t}function Fb(n,t,i){return n?.6*t*i:0}function Vb(n,t){return Math.max(n?n.right-n.left:0,t?t.right-t.left:0)}function LA(n,t,i,l,h,p){const v=Fb(i,h,p),x=Vb(i,l)*p;let E=0;const T=Ob(n)/2;for(let k=0;k<n.length-1;k++){const P=n[k],D=n[k+1],V=P.dist(D);if(E+V>T){const N=(T-E)/V,G=Vn(P.x,D.x,N),X=Vn(P.y,D.y,N),le=new la(G,X,0,D.angleTo(P),k);return!v||Bb(n,le,x,v,t)?le:void 0}E+=V}}function DA(n,t,i,l,h,p,v,x,E){const T=Fb(l,p,v),k=Vb(l,h),P=k*v,D=n[0].x===0||n[0].x===E||n[0].y===0||n[0].y===E;return t-P<t/4&&(t=P+t/4),Nb(n,D?t/2*x%t:(k/2+2*p)*v*x%t,t,T,i,P,D,!1,E)}function Nb(n,t,i,l,h,p,v,x,E){const T=p/2,k=Ob(n);let P=0,D=t-i,V=[];for(let N=0;N<n.length-1;N++){const G=n[N],X=n[N+1],le=G.dist(X),ye=X.angleTo(G);for(;D+i<P+le;){D+=i;const re=(D-P)/le,ge=Vn(G.x,X.x,re),Te=Vn(G.y,X.y,re);if(ge>=0&&ge<E&&Te>=0&&Te<E&&D-T>=0&&D+T<=k){const xe=new la(ge,Te,0,ye,N);xe._round(),l&&!Bb(n,xe,p,l,h)||V.push(xe)}}P+=le}return x||V.length||v||(V=Nb(n,P/2,i,l,h,p,v,!0,E)),V}function $b(n,t,i,l,h){const p=[];for(let v=0;v<n.length;v++){const x=n[v];let E;for(let T=0;T<x.length-1;T++){let k=x[T],P=x[T+1];k.x<t&&P.x<t||(k.x<t?k=new Y(t,k.y+(t-k.x)/(P.x-k.x)*(P.y-k.y))._round():P.x<t&&(P=new Y(t,k.y+(t-k.x)/(P.x-k.x)*(P.y-k.y))._round()),k.y<i&&P.y<i||(k.y<i?k=new Y(k.x+(i-k.y)/(P.y-k.y)*(P.x-k.x),i)._round():P.y<i&&(P=new Y(k.x+(i-k.y)/(P.y-k.y)*(P.x-k.x),i)._round()),k.x>=l&&P.x>=l||(k.x>=l?k=new Y(l,k.y+(l-k.x)/(P.x-k.x)*(P.y-k.y))._round():P.x>=l&&(P=new Y(l,k.y+(l-k.x)/(P.x-k.x)*(P.y-k.y))._round()),k.y>=h&&P.y>=h||(k.y>=h?k=new Y(k.x+(h-k.y)/(P.y-k.y)*(P.x-k.x),h)._round():P.y>=h&&(P=new Y(k.x+(h-k.y)/(P.y-k.y)*(P.x-k.x),h)._round()),E&&k.equals(E[E.length-1])||(E=[k],p.push(E)),E.push(P)))))}}return p}$t(la,"Anchor");const Nd=1e20;function Ub(n,t,i,l,h,p,v,x,E){for(let T=t;T<t+l;T++)jb(n,i*p+T,p,h,v,x,E);for(let T=i;T<i+h;T++)jb(n,T*p+t,1,l,v,x,E)}function jb(n,t,i,l,h,p,v){p[0]=0,v[0]=-Nd,v[1]=Nd,h[0]=n[t];for(let x=1,E=0,T=0;x<l;x++){h[x]=n[t+x*i];const k=x*x;do{const P=p[E];T=(h[x]-h[P]+k-P*P)/(x-P)/2}while(T<=v[E]&&--E>-1);E++,p[E]=x,v[E]=T,v[E+1]=Nd}for(let x=0,E=0;x<l;x++){for(;v[E+1]<x;)E++;const T=p[E],k=x-T;n[t+x*i]=h[T]+k*k}}const Jv={none:0,ideographs:1,all:2};class Gu{constructor(t,i,l){this.requestManager=t,this.localGlyphMode=i,this.localFontFamily=l,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,i){const l=[];for(const h in t)for(const p of t[h])l.push({stack:h,id:p});at(l,({stack:h,id:p},v)=>{let x=this.entries[h];x||(x=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=x.glyphs[p];if(E!==void 0)return void v(null,{stack:h,id:p,glyph:E});if(E=this._tinySDF(x,h,p),E)return x.glyphs[p]=E,void v(null,{stack:h,id:p,glyph:E});const T=Math.floor(p/256);if(256*T>65535)return void v(new Error("glyphs > 65535 not supported"));if(x.ranges[T])return void v(null,{stack:h,id:p,glyph:E});let k=x.requests[T];k||(k=x.requests[T]=[],Gu.loadGlyphRange(h,T,this.url,this.requestManager,(P,D)=>{if(D){x.ascender=D.ascender,x.descender=D.descender;for(const V in D.glyphs)this._doesCharSupportLocalGlyph(+V)||(x.glyphs[+V]=D.glyphs[+V]);x.ranges[T]=!0}for(const V of k)V(P,D);delete x.requests[T]})),k.push((P,D)=>{P?v(P):D&&v(null,{stack:h,id:p,glyph:D.glyphs[p]||null})})},(h,p)=>{if(h)i(h);else if(p){const v={};for(const{stack:x,id:E,glyph:T}of p)v[x]===void 0&&(v[x]={}),v[x].glyphs===void 0&&(v[x].glyphs={}),v[x].glyphs[E]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics},v[x].ascender=this.entries[x].ascender,v[x].descender=this.entries[x].descender;i(null,v)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==Jv.none&&(this.localGlyphMode===Jv.all?!!this.localFontFamily:!!this.localFontFamily&&(md(t)||Xp(t)||Cu(t)||Ha(t)||Jl(t)))}_tinySDF(t,i,l){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(l))return;let p=t.tinySDF;if(!p){let G="400";/bold/i.test(i)?G="900":/medium/i.test(i)?G="500":/light/i.test(i)&&(G="200"),p=t.tinySDF=new Gu.TinySDF({fontFamily:h,fontWeight:G,fontSize:48,buffer:6,radius:16}),p.fontWeight=G}if(this.localGlyphs[p.fontWeight][l])return this.localGlyphs[p.fontWeight][l];const v=String.fromCharCode(l),{data:x,width:E,height:T,glyphWidth:k,glyphHeight:P,glyphLeft:D,glyphTop:V,glyphAdvance:N}=p.draw(v);return this.localGlyphs[p.fontWeight][l]={id:l,bitmap:new sa({width:E,height:T},x),metrics:{width:k/2,height:P/2,left:D/2,top:V/2-27,advance:N/2,localGlyph:!0}}}}function Gb(n,t,i,l){const h=[],p=n.image,v=p.pixelRatio,x=p.paddedRect.w-2,E=p.paddedRect.h-2,T=n.right-n.left,k=n.bottom-n.top,P=p.stretchX||[[0,x]],D=p.stretchY||[[0,E]],V=(We,it)=>We+it[1]-it[0],N=P.reduce(V,0),G=D.reduce(V,0),X=x-N,le=E-G;let ye=0,re=N,ge=0,Te=G,xe=0,je=X,Ne=0,tt=le;if(p.content&&l){const We=p.content;ye=wm(P,0,We[0]),ge=wm(D,0,We[1]),re=wm(P,We[0],We[2]),Te=wm(D,We[1],We[3]),xe=We[0]-ye,Ne=We[1]-ge,je=We[2]-We[0]-re,tt=We[3]-We[1]-Te}const vt=(We,it,ot,dt)=>{const _t=Em(We.stretch-ye,re,T,n.left),Xe=Sm(We.fixed-xe,je,We.stretch,N),It=Em(it.stretch-ge,Te,k,n.top),rn=Sm(it.fixed-Ne,tt,it.stretch,G),Rt=Em(ot.stretch-ye,re,T,n.left),Zt=Sm(ot.fixed-xe,je,ot.stretch,N),At=Em(dt.stretch-ge,Te,k,n.top),an=Sm(dt.fixed-Ne,tt,dt.stretch,G),An=new Y(_t,It),wn=new Y(Rt,It),xn=new Y(Rt,At),ln=new Y(_t,At),Jn=new Y(Xe/v,rn/v),dn=new Y(Zt/v,an/v),kn=t*Math.PI/180;if(kn){const di=Math.sin(kn),gi=Math.cos(kn),yi=[gi,-di,di,gi];An._matMult(yi),wn._matMult(yi),ln._matMult(yi),xn._matMult(yi)}const ii=We.stretch+We.fixed,mi=it.stretch+it.fixed;return{tl:An,tr:wn,bl:ln,br:xn,tex:{x:p.paddedRect.x+1+ii,y:p.paddedRect.y+1+mi,w:ot.stretch+ot.fixed-ii,h:dt.stretch+dt.fixed-mi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Jn,pixelOffsetBR:dn,minFontScaleX:je/v/T,minFontScaleY:tt/v/k,isSDF:i}};if(l&&(p.stretchX||p.stretchY)){const We=qb(P,X,N),it=qb(D,le,G);for(let ot=0;ot<We.length-1;ot++){const dt=We[ot],_t=We[ot+1];for(let Xe=0;Xe<it.length-1;Xe++)h.push(vt(dt,it[Xe],_t,it[Xe+1]))}}else h.push(vt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:E+1}));return h}function wm(n,t,i){let l=0;for(const h of n)l+=Math.max(t,Math.min(i,h[1]))-Math.max(t,Math.min(i,h[0]));return l}function qb(n,t,i){const l=[{fixed:-1,stretch:0}];for(const[h,p]of n){const v=l[l.length-1];l.push({fixed:h-v.stretch,stretch:v.stretch}),l.push({fixed:h-v.stretch,stretch:v.stretch+(p-h)})}return l.push({fixed:t+1,stretch:i}),l}function Em(n,t,i,l){return n/t*i+l}function Sm(n,t,i,l){return n-t*i/l}function RA(n,t,i,l){const h=t+n.positionedLines[l].lineOffset;return l===0?i+h/2:i+(h+(t+n.positionedLines[l-1].lineOffset))/2}Gu.loadGlyphRange=function(n,t,i,l,h){const p=256*t,v=p+255,x=l.transformRequest(l.normalizeGlyphsURL(i).replace("{fontstack}",n).replace("{range}",`${p}-${v}`),rr.Glyphs);yo(x,(E,T)=>{if(E)h(E);else if(T){const k={},P=function(D){return new Fd(D).readFields(IA,{})}(T);for(const D of P.glyphs)k[D.id]=D;h(null,{glyphs:k,ascender:P.ascender,descender:P.descender})}})},Gu.TinySDF=class{constructor({fontSize:n=24,buffer:t=3,radius:i=8,cutoff:l=.25,fontFamily:h="sans-serif",fontWeight:p="normal",fontStyle:v="normal"}={}){this.buffer=t,this.cutoff=l,this.radius=i;const x=this.size=n+4*t,E=this._createCanvas(x),T=this.ctx=E.getContext("2d",{willReadFrequently:!0});T.font=`${v} ${p} ${n}px ${h}`,T.textBaseline="alphabetic",T.textAlign="left",T.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(n){const t=document.createElement("canvas");return t.width=t.height=n,t}draw(n){const{width:t,actualBoundingBoxAscent:i,actualBoundingBoxDescent:l,actualBoundingBoxLeft:h,actualBoundingBoxRight:p}=this.ctx.measureText(n),v=Math.ceil(i),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-h))),E=Math.min(this.size-this.buffer,v+Math.ceil(l)),T=x+2*this.buffer,k=E+2*this.buffer,P=Math.max(T*k,0),D=new Uint8ClampedArray(P),V={data:D,width:T,height:k,glyphWidth:x,glyphHeight:E,glyphTop:v,glyphLeft:0,glyphAdvance:t};if(x===0||E===0)return V;const{ctx:N,buffer:G,gridInner:X,gridOuter:le}=this;N.clearRect(G,G,x,E),N.fillText(n,G,G+v);const ye=N.getImageData(G,G,x,E);le.fill(Nd,0,P),X.fill(0,0,P);for(let re=0;re<E;re++)for(let ge=0;ge<x;ge++){const Te=ye.data[4*(re*x+ge)+3]/255;if(Te===0)continue;const xe=(re+G)*T+ge+G;if(Te===1)le[xe]=0,X[xe]=Nd;else{const je=.5-Te;le[xe]=je>0?je*je:0,X[xe]=je<0?je*je:0}}Ub(le,0,0,T,k,T,this.f,this.v,this.z),Ub(X,G,G,x,E,T,this.f,this.v,this.z);for(let re=0;re<P;re++){const ge=Math.sqrt(le[re])-Math.sqrt(X[re]);D[re]=Math.round(255-255*(ge/this.radius+this.cutoff))}return V}};class BA{constructor(t=[],i=OA){if(this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:i,compare:l}=this,h=i[t];for(;t>0;){const p=t-1>>1,v=i[p];if(l(h,v)>=0)break;i[t]=v,t=p}i[t]=h}_down(t){const{data:i,compare:l}=this,h=this.length>>1,p=i[t];for(;t<h;){let v=1+(t<<1),x=i[v];const E=v+1;if(E<this.length&&l(i[E],x)<0&&(v=E,x=i[E]),l(x,p)>=0)break;i[t]=x,t=v}i[t]=p}}function OA(n,t){return n<t?-1:n>t?1:0}function FA(n,t=1,i=!1){let l=1/0,h=1/0,p=-1/0,v=-1/0;const x=n[0];for(let V=0;V<x.length;V++){const N=x[V];(!V||N.x<l)&&(l=N.x),(!V||N.y<h)&&(h=N.y),(!V||N.x>p)&&(p=N.x),(!V||N.y>v)&&(v=N.y)}const E=Math.min(p-l,v-h);let T=E/2;const k=new BA([],VA);if(E===0)return new Y(l,h);for(let V=l;V<p;V+=E)for(let N=h;N<v;N+=E)k.push(new qu(V+T,N+T,T,n));let P=function(V){let N=0,G=0,X=0;const le=V[0];for(let ye=0,re=le.length,ge=re-1;ye<re;ge=ye++){const Te=le[ye],xe=le[ge],je=Te.x*xe.y-xe.x*Te.y;G+=(Te.x+xe.x)*je,X+=(Te.y+xe.y)*je,N+=3*je}return new qu(G/N,X/N,0,V)}(n),D=k.length;for(;k.length;){const V=k.pop();(V.d>P.d||!P.d)&&(P=V,i&&console.log("found best %d after %d probes",Math.round(1e4*V.d)/1e4,D)),V.max-P.d<=t||(T=V.h/2,k.push(new qu(V.p.x-T,V.p.y-T,T,n)),k.push(new qu(V.p.x+T,V.p.y-T,T,n)),k.push(new qu(V.p.x-T,V.p.y+T,T,n)),k.push(new qu(V.p.x+T,V.p.y+T,T,n)),D+=4)}return i&&(console.log(`num probes: ${D}`),console.log(`best distance: ${P.d}`)),P.p}function VA(n,t){return t.max-n.max}function qu(n,t,i,l){this.p=new Y(n,t),this.h=i,this.d=function(h,p){let v=!1,x=1/0;for(let E=0;E<p.length;E++){const T=p[E];for(let k=0,P=T.length,D=P-1;k<P;D=k++){const V=T[k],N=T[D];V.y>h.y!=N.y>h.y&&h.x<(N.x-V.x)*(h.y-V.y)/(N.y-V.y)+V.x&&(v=!v),x=Math.min(x,jx(h,V,N))}}return(v?1:-1)*Math.sqrt(x)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}const Qv=Number.POSITIVE_INFINITY,NA=Math.sqrt(2);function Zb(n,[t,i]){let l=0,h=0;if(i===Qv){t<0&&(t=0);const p=t/NA;switch(n){case"top-right":case"top-left":h=p-7;break;case"bottom-right":case"bottom-left":h=7-p;break;case"bottom":h=7-t;break;case"top":h=t-7}switch(n){case"top-right":case"bottom-right":l=-p;break;case"top-left":case"bottom-left":l=p;break;case"left":l=t;break;case"right":l=-t}}else{switch(t=Math.abs(t),i=Math.abs(i),n){case"top-right":case"top-left":case"top":h=i-7;break;case"bottom-right":case"bottom-left":case"bottom":h=7-i}switch(n){case"top-right":case"bottom-right":case"right":l=-t;break;case"top-left":case"bottom-left":case"left":l=t}}return[l,h]}function $A(n,t,i,l,h,p,v,x,E,T){n.createArrays(),n.tilePixelRatio=hn/(512*n.overscaling),n.compareText={},n.iconsNeedLinear=!1;const k=n.layers[0].layout,P=n.layers[0]._unevaluatedLayout._values,D={};if(n.textSizeData.kind==="composite"){const{minZoom:G,maxZoom:X}=n.textSizeData;D.compositeTextSizes=[P["text-size"].possiblyEvaluate(new Be(G),x),P["text-size"].possiblyEvaluate(new Be(X),x)]}if(n.iconSizeData.kind==="composite"){const{minZoom:G,maxZoom:X}=n.iconSizeData;D.compositeIconSizes=[P["icon-size"].possiblyEvaluate(new Be(G),x),P["icon-size"].possiblyEvaluate(new Be(X),x)]}D.layoutTextSize=P["text-size"].possiblyEvaluate(new Be(E+1),x),D.layoutIconSize=P["icon-size"].possiblyEvaluate(new Be(E+1),x),D.textMaxSize=P["text-size"].possiblyEvaluate(new Be(18),x);const V=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",N=k.get("text-size");for(const G of n.features){const X=k.get("text-font").evaluate(G,{},x).join(","),le=N.evaluate(G,{},x),ye=D.layoutTextSize.evaluate(G,{},x),re=(D.layoutIconSize.evaluate(G,{},x),{horizontal:{},vertical:void 0}),ge=G.text;let Te,xe=[0,0];if(ge){const tt=ge.toString(),vt=k.get("text-letter-spacing").evaluate(G,{},x)*Sr,We=k.get("text-line-height").evaluate(G,{},x)*Sr,it=b(tt)?vt:0,ot=k.get("text-anchor").evaluate(G,{},x),dt=k.get("text-variable-anchor");if(!dt){const Rt=k.get("text-radial-offset").evaluate(G,{},x);xe=Rt?Zb(ot,[Rt*Sr,Qv]):k.get("text-offset").evaluate(G,{},x).map(Zt=>Zt*Sr)}let _t=V?"center":k.get("text-justify").evaluate(G,{},x);const Xe=k.get("symbol-placement")==="point",It=Xe?k.get("text-max-width").evaluate(G,{},x)*Sr:1/0,rn=Rt=>{n.allowVerticalPlacement&&y(tt)&&(re.vertical=Yv(ge,t,i,h,X,It,We,ot,Rt,it,xe,ho.vertical,!0,ye,le))};if(!V&&dt){const Rt=_t==="auto"?dt.map(At=>e_(At)):[_t];let Zt=!1;for(let At=0;At<Rt.length;At++){const an=Rt[At];if(!re.horizontal[an])if(Zt)re.horizontal[an]=re.horizontal[0];else{const An=Yv(ge,t,i,h,X,It,We,"center",an,it,xe,ho.horizontal,!1,ye,le);An&&(re.horizontal[an]=An,Zt=An.positionedLines.length===1)}}rn("left")}else{if(_t==="auto"&&(_t=e_(ot)),Xe||k.get("text-writing-mode").indexOf("horizontal")>=0||!y(tt)){const Rt=Yv(ge,t,i,h,X,It,We,ot,_t,it,xe,ho.horizontal,!1,ye,le);Rt&&(re.horizontal[_t]=Rt)}rn(Xe?"left":_t)}}let je=!1;if(G.icon&&G.icon.name){const tt=l[G.icon.name];tt&&(Te=zA(h[G.icon.name],k.get("icon-offset").evaluate(G,{},x),k.get("icon-anchor").evaluate(G,{},x)),je=tt.sdf,n.sdfIcons===void 0?n.sdfIcons=tt.sdf:n.sdfIcons!==tt.sdf&&he("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(tt.pixelRatio!==n.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(n.iconsNeedLinear=!0))}const Ne=Hb(re.horizontal)||re.vertical;n.iconsInText||(n.iconsInText=!!Ne&&Ne.iconsInText),(Ne||Te)&&UA(n,G,re,Te,l,D,ye,0,xe,je,v,x,T)}p&&n.generateCollisionDebugBuffers(E,n.collisionBoxArray)}function e_(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function UA(n,t,i,l,h,p,v,x,E,T,k,P,D){let V=p.textMaxSize.evaluate(t,{},P);V===void 0&&(V=v);const N=n.layers[0].layout,G=N.get("icon-offset").evaluate(t,{},P),X=Hb(i.horizontal)||i.vertical,le=D.name==="globe",ye=v/24,re=n.tilePixelRatio*V/24,ge=(it=n.overscaling,n.zoom>18&&it>2&&(it>>=1),Math.max(hn/(512*it),1)*N.get("symbol-spacing")),Te=N.get("text-padding")*n.tilePixelRatio,xe=N.get("icon-padding")*n.tilePixelRatio,je=Se(N.get("text-max-angle")),Ne=N.get("text-rotation-alignment")==="map"&&N.get("symbol-placement")!=="point",tt=N.get("icon-rotation-alignment")==="map"&&N.get("symbol-placement")!=="point",vt=N.get("symbol-placement"),We=ge/2;var it;const ot=N.get("icon-text-fit");let dt;l&&ot!=="none"&&(n.allowVerticalPlacement&&i.vertical&&(dt=Rb(l,i.vertical,ot,N.get("icon-text-fit-padding"),G,ye)),X&&(l=Rb(l,X,ot,N.get("icon-text-fit-padding"),G,ye)));const _t=(Xe,It,rn)=>{if(It.x<0||It.x>=hn||It.y<0||It.y>=hn)return;let Rt=null;if(le){const{x:Zt,y:At,z:an}=D.projectTilePoint(It.x,It.y,rn);Rt={anchor:new la(Zt,At,an,0,void 0),up:D.upVector(rn,It.x,It.y)}}(function(Zt,At,an,An,wn,xn,ln,Jn,dn,kn,ii,mi,di,gi,yi,Mi,hr,Qn,Yi,ji,Un,Ei,nr,ri,Oi){const kr=Zt.addToLineVertexArray(At,An);let dr,fr,Nr,pr,ca,Hu,Wd,Hd=0,E1=0,S1=0,T1=0,d_=-1,f_=-1;const ks={};let C1=ec("");const dc=an?an.anchor:At;let p_=0,m_=0;if(dn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[p_,m_]=dn.layout.get("text-offset").evaluate(Un,{},Oi).map(to=>to*Sr):(p_=dn.layout.get("text-radial-offset").evaluate(Un,{},Oi)*Sr,m_=Qv),Zt.allowVerticalPlacement&&wn.vertical){const to=wn.vertical;if(yi)Hu=t_(to),Jn&&(Wd=t_(Jn));else{const no=dn.layout.get("text-rotate").evaluate(Un,{},Oi)+90;Nr=Tm(kn,dc,At,ii,mi,di,to,gi,no,Mi),Jn&&(pr=Tm(kn,dc,At,ii,mi,di,Jn,Qn,no))}}if(xn){const to=dn.layout.get("icon-rotate").evaluate(Un,{},Oi),no=dn.layout.get("icon-text-fit")!=="none",Xd=Gb(xn,to,nr,no),v_=Jn?Gb(Jn,to,nr,no):void 0;fr=Tm(kn,dc,At,ii,mi,di,xn,Qn,to),Hd=4*Xd.length;const I1=Zt.iconSizeData;let fc=null;I1.kind==="source"?(fc=[Ts*dn.layout.get("icon-size").evaluate(Un,{},Oi)],fc[0]>el&&he(`${Zt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):I1.kind==="composite"&&(fc=[Ts*Ei.compositeIconSizes[0].evaluate(Un,{},Oi),Ts*Ei.compositeIconSizes[1].evaluate(Un,{},Oi)],(fc[0]>el||fc[1]>el)&&he(`${Zt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Zt.addSymbols(Zt.icon,Xd,fc,ji,Yi,Un,!1,an,At,kr.lineStartIndex,kr.lineLength,-1,ri,Oi),d_=Zt.icon.placedSymbolArray.length-1,v_&&(E1=4*v_.length,Zt.addSymbols(Zt.icon,v_,fc,ji,Yi,Un,ho.vertical,an,At,kr.lineStartIndex,kr.lineLength,-1,ri,Oi),f_=Zt.icon.placedSymbolArray.length-1)}for(const to in wn.horizontal){const no=wn.horizontal[to];dr||(C1=ec(no.text),yi?ca=t_(no):dr=Tm(kn,dc,At,ii,mi,di,no,gi,dn.layout.get("text-rotate").evaluate(Un,{},Oi),Mi));const Xd=no.positionedLines.length===1;if(S1+=Wb(Zt,an,At,no,ln,dn,yi,Un,Mi,kr,wn.vertical?ho.horizontal:ho.horizontalOnly,Xd?Object.keys(wn.horizontal):[to],ks,d_,Ei,ri,Oi),Xd)break}wn.vertical&&(T1+=Wb(Zt,an,At,wn.vertical,ln,dn,yi,Un,Mi,kr,ho.vertical,["vertical"],ks,f_,Ei,ri,Oi));let sl=-1;const g_=(to,no)=>to?Math.max(to,no):no;sl=g_(ca,sl),sl=g_(Hu,sl),sl=g_(Wd,sl);const pk=sl>-1?1:0;Zt.glyphOffsetArray.length>=nl.MAX_GLYPHS&&he("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Un.sortKey!==void 0&&Zt.addToSortKeyRanges(Zt.symbolInstances.length,Un.sortKey),Zt.symbolInstances.emplaceBack(dc.x,dc.y,dc.z,At.x,At.y,ks.right>=0?ks.right:-1,ks.center>=0?ks.center:-1,ks.left>=0?ks.left:-1,ks.vertical>=0?ks.vertical:-1,d_,f_,C1,dr!==void 0?dr:Zt.collisionBoxArray.length,dr!==void 0?dr+1:Zt.collisionBoxArray.length,Nr!==void 0?Nr:Zt.collisionBoxArray.length,Nr!==void 0?Nr+1:Zt.collisionBoxArray.length,fr!==void 0?fr:Zt.collisionBoxArray.length,fr!==void 0?fr+1:Zt.collisionBoxArray.length,pr||Zt.collisionBoxArray.length,pr?pr+1:Zt.collisionBoxArray.length,ii,S1,T1,Hd,E1,pk,0,p_,m_,sl)})(n,It,Rt,Xe,i,l,h,dt,n.layers[0],n.collisionBoxArray,t.index,t.sourceLayerIndex,n.index,Te,Ne,E,0,xe,tt,G,t,p,T,k,P)};if(vt==="line")for(const Xe of $b(t.geometry,0,0,hn,hn)){const It=DA(Xe,ge,je,i.vertical||X,l,24,re,n.overscaling,hn);for(const rn of It){const Rt=X;Rt&&jA(n,Rt.text,We,rn)||_t(Xe,rn,P)}}else if(vt==="line-center"){for(const Xe of t.geometry)if(Xe.length>1){const It=LA(Xe,je,i.vertical||X,l,24,re);It&&_t(Xe,It,P)}}else if(t.type==="Polygon")for(const Xe of Uv(t.geometry,0)){const It=FA(Xe,16);_t(Xe[0],new la(It.x,It.y,0,0,void 0),P)}else if(t.type==="LineString")for(const Xe of t.geometry)_t(Xe,new la(Xe[0].x,Xe[0].y,0,0,void 0),P);else if(t.type==="Point")for(const Xe of t.geometry)for(const It of Xe)_t([It],new la(It.x,It.y,0,0,void 0),P)}const el=32640;function Wb(n,t,i,l,h,p,v,x,E,T,k,P,D,V,N,G,X){const le=function(ge,Te,xe,je,Ne,tt,vt,We){const it=[];if(Te.positionedLines.length===0)return it;const ot=je.layout.get("text-rotate").evaluate(tt,{})*Math.PI/180,dt=function(Rt){const Zt=Rt[0],At=Rt[1],an=Zt*At;return an>0?[Zt,-At]:an<0?[-Zt,At]:Zt===0?[At,Zt]:[At,-Zt]}(xe);let _t=Math.abs(Te.top-Te.bottom);for(const Rt of Te.positionedLines)_t-=Rt.lineOffset;const Xe=Te.positionedLines.length,It=_t/Xe;let rn=Te.top-xe[1];for(let Rt=0;Rt<Xe;++Rt){const Zt=Te.positionedLines[Rt];rn=RA(Te,It,rn,Rt);for(const At of Zt.positionedGlyphs){if(!At.rect)continue;const an=At.rect||{};let An=4,wn=!0,xn=1,ln=0;if(At.imageName){const ri=vt[At.imageName];if(!ri)continue;if(ri.sdf){he("SDF images are not supported in formatted text and will be ignored.");continue}wn=!1,xn=ri.pixelRatio,An=1/xn}const Jn=(Ne||We)&&At.vertical,dn=At.metrics.advance*At.scale/2,kn=At.metrics,ii=At.rect;if(ii===null)continue;We&&Te.verticalizable&&(ln=At.imageName?dn-At.metrics.width*At.scale/2:0);const mi=Ne?[At.x+dn,At.y]:[0,0];let di=[0,0],gi=[0,0],yi=!1;Ne||(Jn?(gi=[At.x+dn+dt[0],At.y+dt[1]-ln],yi=!0):di=[At.x+dn+xe[0],At.y+xe[1]-ln]);const Mi=ii.w*At.scale/(xn*(At.localGlyph?2:1)),hr=ii.h*At.scale/(xn*(At.localGlyph?2:1));let Qn,Yi,ji,Un;if(Jn){const ri=At.y-rn,Oi=new Y(-dn,dn-ri),kr=-Math.PI/2,dr=new Y(...gi);Qn=new Y(-dn+di[0],di[1]),Qn._rotateAround(kr,Oi)._add(dr),Qn.x+=-ri+dn,Qn.y-=(kn.left-An)*At.scale;const fr=At.imageName?kn.advance*At.scale:Sr*At.scale,Nr=String.fromCharCode(At.glyph);gA(Nr)?Qn.x+=(1-An)*At.scale:vA(Nr)?Qn.x+=fr-kn.height*At.scale+(-An-1)*At.scale:Qn.x+=At.imageName||kn.width+2*An===ii.w&&kn.height+2*An===ii.h?(fr-hr)/2:(fr-(kn.height+2*An)*At.scale)/2,Yi=new Y(Qn.x,Qn.y-Mi),ji=new Y(Qn.x+hr,Qn.y),Un=new Y(Qn.x+hr,Qn.y-Mi)}else{const ri=(kn.left-An)*At.scale-dn+di[0],Oi=(-kn.top-An)*At.scale+di[1],kr=ri+Mi,dr=Oi+hr;Qn=new Y(ri,Oi),Yi=new Y(kr,Oi),ji=new Y(ri,dr),Un=new Y(kr,dr)}if(ot){let ri;ri=Ne?new Y(0,0):yi?new Y(dt[0],dt[1]):new Y(xe[0],xe[1]),Qn._rotateAround(ot,ri),Yi._rotateAround(ot,ri),ji._rotateAround(ot,ri),Un._rotateAround(ot,ri)}const Ei=new Y(0,0),nr=new Y(0,0);it.push({tl:Qn,tr:Yi,bl:ji,br:Un,tex:an,writingMode:Te.writingMode,glyphOffset:mi,sectionIndex:At.sectionIndex,isSDF:wn,pixelOffsetTL:Ei,pixelOffsetBR:nr,minFontScaleX:0,minFontScaleY:0})}}return it}(0,l,E,p,v,x,h,n.allowVerticalPlacement),ye=n.textSizeData;let re=null;ye.kind==="source"?(re=[Ts*p.layout.get("text-size").evaluate(x,{},X)],re[0]>el&&he(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ye.kind==="composite"&&(re=[Ts*N.compositeTextSizes[0].evaluate(x,{},X),Ts*N.compositeTextSizes[1].evaluate(x,{},X)],(re[0]>el||re[1]>el)&&he(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,le,re,E,v,x,k,t,i,T.lineStartIndex,T.lineLength,V,G,X);for(const ge of P)D[ge]=n.text.placedSymbolArray.length-1;return 4*le.length}function Hb(n){for(const t in n)return n[t];return null}function Tm(n,t,i,l,h,p,v,x,E,T){let k=v.top,P=v.bottom,D=v.left,V=v.right;const N=v.collisionPadding;if(N&&(D-=N[0],k-=N[1],V+=N[2],P+=N[3]),E){const G=new Y(D,k),X=new Y(V,k),le=new Y(D,P),ye=new Y(V,P),re=Se(E);let ge=new Y(0,0);T&&(ge=new Y(T[0],T[1])),G._rotateAround(re,ge),X._rotateAround(re,ge),le._rotateAround(re,ge),ye._rotateAround(re,ge),D=Math.min(G.x,X.x,le.x,ye.x),V=Math.max(G.x,X.x,le.x,ye.x),k=Math.min(G.y,X.y,le.y,ye.y),P=Math.max(G.y,X.y,le.y,ye.y)}return n.emplaceBack(t.x,t.y,t.z,i.x,i.y,D,k,V,P,x,l,h,p),n.length-1}function t_(n){n.collisionPadding&&(n.top-=n.collisionPadding[1],n.bottom+=n.collisionPadding[3]);const t=n.bottom-n.top;return t>0?Math.max(10,t):null}function jA(n,t,i,l){const h=n.compareText;if(t in h){const p=h[t];for(let v=p.length-1;v>=0;v--)if(l.dist(p[v])<i)return!0}else h[t]=[];return h[t].push(l),!1}function Xb(n,t){const i=n.fovAboveCenter,l=n.elevation?n.elevation.getMinElevationBelowMSL()*t:0,h=(n._camera.position[2]*n.worldSize-l)/Math.cos(n._pitch),p=Math.sin(i)*h/Math.sin(Math.max(Math.PI/2-n._pitch-i,.01)),v=Math.sin(n._pitch)*p+h;return Math.min(1.01*v,h*(1/n._horizonShift))}function uc(n,t){if(!t.isReprojectedInTileSpace)return{scale:1<<n.z,x:n.x,y:n.y,x2:n.x+1,y2:n.y+1,projection:t};const i=Math.pow(2,-n.z),l=n.x*i,h=(n.x+1)*i,p=n.y*i,v=(n.y+1)*i,x=uo(l),E=uo(h),T=wr(p),k=wr(v),P=t.project(x,T),D=t.project(E,T),V=t.project(E,k),N=t.project(x,k);let G=Math.min(P.x,D.x,V.x,N.x),X=Math.min(P.y,D.y,V.y,N.y),le=Math.max(P.x,D.x,V.x,N.x),ye=Math.max(P.y,D.y,V.y,N.y);const re=i/16;function ge(xe,je,Ne,tt,vt,We){const it=(Ne+vt)/2,ot=(tt+We)/2,dt=t.project(uo(it),wr(ot)),_t=Math.max(0,G-dt.x,X-dt.y,dt.x-le,dt.y-ye);G=Math.min(G,dt.x),le=Math.max(le,dt.x),X=Math.min(X,dt.y),ye=Math.max(ye,dt.y),_t>re&&(ge(xe,dt,Ne,tt,it,ot),ge(dt,je,it,ot,vt,We))}ge(P,D,l,p,h,p),ge(D,V,h,p,h,v),ge(V,N,h,v,l,v),ge(N,P,l,v,l,p),G-=re,X-=re,le+=re,ye+=re;const Te=1/Math.max(le-G,ye-X);return{scale:Te,x:G*Te,y:X*Te,x2:le*Te,y2:ye*Te,projection:t}}const GA=Ko(new Float32Array(16));class tl{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,i){return{x:0,y:0,z:0}}unproject(t,i){return new Nn(0,0)}projectTilePoint(t,i,l){return{x:t,y:i,z:0}}locationPoint(t,i,l=!0){return t._coordinatePoint(t.locationCoordinate(i),l)}pixelsPerMeter(t,i){return Qo(1,t)*i}pixelSpaceConversion(t,i,l){return 1}farthestPixelDistance(t){return Xb(t,t.pixelsPerMeter)}pointCoordinate(t,i,l,h){const p=t.horizonLineFromTop(!1),v=new Y(i,Math.max(p,l));return t.rayIntersectionCoordinate(t.pointRayIntersection(v,h))}pointCoordinate3D(t,i,l){const h=new Y(i,l);if(t.elevation)return t.elevation.pointCoordinate(h);{const p=this.pointCoordinate(t,h.x,h.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(t,i){if(t.elevation)return!this.pointCoordinate3D(t,i.x,i.y);const l=t.horizonLineFromTop();return i.y<l}createInversionMatrix(t,i){return GA}createTileMatrix(t,i,l){let h,p,v;const x=l.canonical,E=Ko(new Float64Array(16));if(this.isReprojectedInTileSpace){const T=uc(x,this);h=1,p=T.x+l.wrap*T.scale,v=T.y,ic(E,E,[h/T.scale,h/T.scale,t.pixelsPerMeter/i])}else h=i/t.zoomScale(x.z),p=(x.x+Math.pow(2,x.z)*l.wrap)*h,v=x.y*h;return vd(E,E,[p,v,0]),ic(E,E,[h/hn,h/hn,1]),E}upVector(t,i,l){return[0,0,1]}upVectorScale(t,i,l){return{metersToTile:1}}}class qA extends tl{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[i,l]=this.parallels=t.parallels||[29.5,45.5],h=Math.sin(Se(i));this.n=(h+Math.sin(Se(l)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(t,i){const{n:l,c:h,r0:p}=this,v=Se(t-this.center[0]),x=Se(i),E=Math.sqrt(h-2*l*Math.sin(x))/l;return{x:E*Math.sin(v*l),y:E*Math.cos(v*l)-p,z:0}}unproject(t,i){const{n:l,c:h,r0:p}=this,v=p+i;let x=Math.atan2(t,Math.abs(v))*Math.sign(v);v*l<0&&(x-=Math.PI*Math.sign(t)*Math.sign(v));const E=Se(this.center[0])*l;x=Pe(x,-Math.PI-E,Math.PI-E);const T=nt(be(x/l)+this.center[0],-180,180),k=Math.asin(nt((h-(t*t+v*v)*l*l)/(2*l),-1,1)),P=nt(be(k),-Er,Er);return new Nn(T,P)}}const $d=1.340264,Ud=-.081106,jd=893e-6,Gd=.003796,Cm=Math.sqrt(3)/2;class ZA extends tl{project(t,i){i=i/180*Math.PI,t=t/180*Math.PI;const l=Math.asin(Cm*Math.sin(i)),h=l*l,p=h*h*h;return{x:.5*(t*Math.cos(l)/(Cm*($d+3*Ud*h+p*(7*jd+9*Gd*h)))/Math.PI+.5),y:1-.5*(l*($d+Ud*h+p*(jd+Gd*h))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let l=i=(2*(1-i)-1)*Math.PI,h=l*l,p=h*h*h;for(let k,P,D,V=0;V<12&&(P=l*($d+Ud*h+p*(jd+Gd*h))-i,D=$d+3*Ud*h+p*(7*jd+9*Gd*h),k=P/D,l=nt(l-k,-Math.PI/3,Math.PI/3),h=l*l,p=h*h*h,!(Math.abs(k)<1e-12));++V);const v=Cm*t*($d+3*Ud*h+p*(7*jd+9*Gd*h))/Math.cos(l),x=Math.asin(Math.sin(l)/Cm),E=nt(180*v/Math.PI,-180,180),T=nt(180*x/Math.PI,-Er,Er);return new Nn(E,T)}}class WA extends tl{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){return{x:.5+t/360,y:.5-i/360,z:0}}unproject(t,i){const l=360*(t-.5),h=nt(360*(.5-i),-Er,Er);return new Nn(l,h)}}const Zu=Math.PI/2;function Im(n){return Math.tan((Zu+n)/2)}class HA extends tl{constructor(t){super(t),this.center=t.center||[0,30];const[i,l]=this.parallels=t.parallels||[30,30];let h=Se(i),p=Se(l);this.southernCenter=h+p<0,this.southernCenter&&(h=-h,p=-p);const v=Math.cos(h),x=Im(h);this.n=h===p?Math.sin(h):Math.log(v/Math.cos(p))/Math.log(Im(p)/x),this.f=v*Math.pow(Im(h),this.n)/this.n}project(t,i){i=Se(i),this.southernCenter&&(i=-i),t=Se(t-this.center[0]);const l=1e-6,{n:h,f:p}=this;p>0?i<-Zu+l&&(i=-Zu+l):i>Zu-l&&(i=Zu-l);const v=p/Math.pow(Im(i),h);let x=v*Math.sin(h*t),E=p-v*Math.cos(h*t);return x=.5*(x/Math.PI+.5),E=.5*(E/Math.PI+.5),{x,y:this.southernCenter?E:1-E,z:0}}unproject(t,i){t=(2*t-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:l,f:h}=this,p=h-i,v=Math.sign(p),x=Math.sign(l)*Math.sqrt(t*t+p*p);let E=Math.atan2(t,Math.abs(p))*v;p*l<0&&(E-=Math.PI*Math.sign(t)*v);const T=nt(be(E/l)+this.center[0],-180,180),k=nt(be(2*Math.atan(Math.pow(h/x,1/l))-Zu),-Er,Er);return new Nn(T,this.southernCenter?-k:k)}}class Yb extends tl{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,i){return{x:Es(t),y:Ss(i),z:0}}unproject(t,i){const l=uo(t),h=wr(i);return new Nn(l,h)}}const Kb=Se(Er);class XA extends tl{project(t,i){const l=(i=Se(i))*i,h=l*l;return{x:.5*((t=Se(t))*(.8707-.131979*l+h*(h*(.003971*l-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+l*(.015085+h*(.028874*l-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let l=i=(2*(1-i)-1)*Math.PI,h=25,p=0,v=l*l;do{v=l*l;const T=v*v;p=(l*(1.007226+v*(.015085+T*(.028874*v-.044475-.005916*T)))-i)/(1.007226+v*(.045255+T*(.259866*v-.311325-.005916*11*T))),l=nt(l-p,-Kb,Kb)}while(Math.abs(p)>1e-6&&--h>0);v=l*l;const x=nt(be(t/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),E=be(l);return new Nn(x,E)}}const Jb=Se(Er);class YA extends tl{project(t,i){i=Se(i),t=Se(t);const l=Math.cos(i),h=2/Math.PI,p=Math.acos(l*Math.cos(t/2)),v=Math.sin(p)/p,x=.5*(t*h+2*l*Math.sin(t/2)/v)||0,E=.5*(i+Math.sin(i)/v)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(t,i){let l=t=(2*t-.5)*Math.PI,h=i=(2*(1-i)-1)*Math.PI,p=25;const v=1e-6;let x=0,E=0;do{const T=Math.cos(h),k=Math.sin(h),P=2*k*T,D=k*k,V=T*T,N=Math.cos(l/2),G=Math.sin(l/2),X=2*N*G,le=G*G,ye=1-V*N*N,re=ye?1/ye:0,ge=ye?Math.acos(T*N)*Math.sqrt(1/ye):0,Te=.5*(2*ge*T*G+2*l/Math.PI)-t,xe=.5*(ge*k+h)-i,je=.5*re*(V*le+ge*T*N*D)+1/Math.PI,Ne=re*(X*P/4-ge*k*G),tt=.125*re*(P*G-ge*k*V*X),vt=.5*re*(D*N+ge*le*T)+.5,We=Ne*tt-vt*je;x=(xe*Ne-Te*vt)/We,E=(Te*tt-xe*je)/We,l=nt(l-x,-Math.PI,Math.PI),h=nt(h-E,-Jb,Jb)}while((Math.abs(x)>v||Math.abs(E)>v)&&--p>0);return new Nn(be(l),be(h))}}class Qb extends tl{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Se(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){const{scale:l,cosPhi:h}=this;return{x:Se(t)*h*l+.5,y:-Math.sin(Se(i))/h*l+.5,z:0}}unproject(t,i){const{scale:l,cosPhi:h}=this,p=-(i-.5)/l,v=nt(be((t-.5)/l)/h,-180,180),x=Math.asin(nt(p*h,-1,1)),E=nt(be(x),-Er,Er);return new Nn(v,E)}}class KA extends Yb{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,i,l){const h=Td(t,i,l);return Bi(h,h,Cd(ws(l))),{x:h[0],y:h[1],z:h[2]}}locationPoint(t,i){const l=zu(i.lat,i.lng),h=Or([],l),p=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(i),t._centerAltitude):t._centerAltitude;bd(l,l,h,Qo(1,0)*hn*p);const v=Ko(new Float64Array(16));return nc(v,t.pixelMatrix,t.globeMatrix),Bi(l,l,v),new Y(l[0],l[1])}pixelsPerMeter(t,i){return Qo(1,0)*i}pixelSpaceConversion(t,i,l){const h=Qo(1,t)*i,p=Vn(Qo(1,45)*i,h,l);return this.pixelsPerMeter(t,i)/p}createTileMatrix(t,i,l){const h=Av(ws(l.canonical));return nc(new Float64Array(16),t.globeMatrix,h)}createInversionMatrix(t,i){const{center:l}=t,h=Cd(ws(i));return nm(h,h,Se(l.lng)),yv(h,h,Se(l.lat)),ic(h,h,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(t,i,l,h){return kx(t,i,l,!0)||new Du(0,0)}pointCoordinate3D(t,i,l){const h=this.pointCoordinate(t,i,l,0);return[h.x,h.y,h.z]}isPointAboveHorizon(t,i){return!kx(t,i.x,i.y,!1)}farthestPixelDistance(t){const i=function(h,p){const v=h.cameraToCenterDistance,x=h._centerAltitude*p,E=h._camera,T=h._camera.forward(),k=ra([],co([],T,-v),[0,0,x]),P=h.worldSize/(2*Math.PI),D=[0,0,-P],V=h.width/h.height,N=Math.tan(h.fovAboveCenter),G=co([],E.up(),N),X=co([],E.right(),N*V),le=Or([],ra([],ra([],T,G),X)),ye=[];let re;if(new Ev(k,le).closestPointOnSphere(D,P,ye)){const ge=ra([],ye,D),Te=Jo([],ge,k);re=Math.cos(h.fovAboveCenter)*_d(Te)}else{const ge=Jo([],k,D),Te=Jo([],D,k);Or(Te,Te);const xe=_d(ge)-P;re=Math.sqrt(xe*(xe+2*P));const je=Math.acos(re/(P+xe))-Math.acos(So(T,Te));re*=Math.cos(je)}return 1.01*re}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),l=Lu(t.zoom);if(l>0){const h=Xb(t,Qo(1,t.center.lat)*t.worldSize),p=t.worldSize/(2*Math.PI),v=Math.max(t.width,t.height)/t.worldSize*Math.PI;return Vn(i,h+p*(1-Math.cos(v)),Math.pow(l,10))}return i}upVector(t,i,l){return Td(i,l,t,1)}upVectorScale(t){return{metersToTile:im(om(ws(t)))}}}function e1(n){const t=n.parallels,i=!!t&&Math.abs(t[0]+t[1])<.01;switch(n.name){case"mercator":return new Yb(n);case"equirectangular":return new WA(n);case"naturalEarth":return new XA(n);case"equalEarth":return new ZA(n);case"winkelTripel":return new YA(n);case"albers":return i?new Qb(n):new qA(n);case"lambertConformalConic":return i?new Qb(n):new HA(n);case"globe":return new KA(n)}throw new Error(`Invalid projection name: ${n.name}`)}const JA=mm.types,QA=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Am(n,t,i,l,h,p,v,x,E,T,k,P,D){const V=x?Math.min(el,Math.round(x[0])):0,N=x?Math.min(el,Math.round(x[1])):0;n.emplaceBack(t,i,Math.round(32*l),Math.round(32*h),p,v,(V<<1)+(E?1:0),N,16*T,16*k,256*P,256*D)}function km(n,t,i,l,h,p,v){n.emplaceBack(t,i,l,h,p,v)}function Mm(n,t,i,l,h){n.emplaceBack(t,i,l,h),n.emplaceBack(t,i,l,h),n.emplaceBack(t,i,l,h),n.emplaceBack(t,i,l,h)}function ek(n){for(const t of n.sections)if(j(t.text))return!0;return!1}class n_{constructor(t){this.layoutVertexArray=new Wo,this.indexArray=new br,this.programConfigurations=t,this.segments=new $i,this.dynamicLayoutVertexArray=new oi,this.opacityVertexArray=new si,this.placedSymbolArray=new tx,this.globeExtVertexArray=new _i}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,i,l,h){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,lA.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,uA.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,QA,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,cA.members,!0)),this.opacityVertexBuffer.itemSize=1),(l||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}$t(n_,"SymbolBuffers");class i_{constructor(t,i,l){this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new l,this.segments=new $i,this.collisionVertexArray=new pi,this.collisionVertexArrayExt=new xr}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,hA.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,dA.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}$t(i_,"CollisionBuffers");class nl{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(v=>v.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ko([]),this.placementViewportMatrix=Ko([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Zv(this.zoom,i["text-size"]),this.iconSizeData=Zv(this.zoom,i["icon-size"]);const l=this.layers[0].layout,h=l.get("symbol-sort-key"),p=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=l.get("text-writing-mode").map(v=>ho[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=t.sourceID,this.projection=t.projection}createArrays(){this.text=new n_(new tc(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new n_(new tc(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new rx,this.lineVertexArray=new ox,this.symbolInstances=new ix}calculateGlyphDependencies(t,i,l,h,p){for(let v=0;v<t.length;v++)if(i[t.charCodeAt(v)]=!0,h&&p){const x=Od[t.charAt(v)];x&&(i[x.charCodeAt(0)]=!0)}}populate(t,i,l,h){const p=this.layers[0],v=p.layout,x=this.projection.name==="globe",E=v.get("text-font"),T=v.get("text-field"),k=v.get("icon-image"),P=(T.value.kind!=="constant"||T.value.value instanceof Rr&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),D=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,V=v.get("symbol-sort-key");if(this.features=[],!P&&!D)return;const N=i.iconDependencies,G=i.glyphDependencies,X=i.availableImages,le=new Be(this.zoom);for(const{feature:ye,id:re,index:ge,sourceLayerIndex:Te}of t){const xe=p._featureFilter.needGeometry,je=ac(ye,xe);if(!p._featureFilter.filter(le,je,l))continue;if(xe||(je.geometry=oa(ye,l,h)),x&&ye.type!==1&&l.z<=5){const We=je.geometry,it=.98078528056,ot=(dt,_t)=>So(Td(dt.x,dt.y,l,1),Td(_t.x,_t.y,l,1))<it;for(let dt=0;dt<We.length;dt++)We[dt]=uI(We[dt],ot)}let Ne,tt;if(P){const We=p.getValueAndResolveTokens("text-field",je,l,X),it=Rr.factory(We);ek(it)&&(this.hasRTLText=!0),(!this.hasRTLText||Ce()==="unavailable"||this.hasRTLText&&Ae.isParsed())&&(Ne=mA(it,p,je))}if(D){const We=p.getValueAndResolveTokens("icon-image",je,l,X);tt=We instanceof Ar?We:Ar.fromString(We)}if(!Ne&&!tt)continue;const vt=this.sortFeaturesByKey?V.evaluate(je,{},l):void 0;if(this.features.push({id:re,text:Ne,icon:tt,index:ge,sourceLayerIndex:Te,geometry:je.geometry,properties:ye.properties,type:JA[ye.type],sortKey:vt}),tt&&(N[tt.name]=!0),Ne){const We=E.evaluate(je,{},l).join(","),it=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ho.vertical)>=0;for(const ot of Ne.sections)if(ot.image)N[ot.image.name]=!0;else{const dt=y(Ne.toString()),_t=ot.fontStack||We,Xe=G[_t]=G[_t]||{};this.calculateGlyphDependencies(ot.text,Xe,it,this.allowVerticalPlacement,dt)}}}v.get("symbol-placement")==="line"&&(this.features=function(ye){const re={},ge={},Te=[];let xe=0;function je(We){Te.push(ye[We]),xe++}function Ne(We,it,ot){const dt=ge[We];return delete ge[We],ge[it]=dt,Te[dt].geometry[0].pop(),Te[dt].geometry[0]=Te[dt].geometry[0].concat(ot[0]),dt}function tt(We,it,ot){const dt=re[it];return delete re[it],re[We]=dt,Te[dt].geometry[0].shift(),Te[dt].geometry[0]=ot[0].concat(Te[dt].geometry[0]),dt}function vt(We,it,ot){const dt=ot?it[0][it[0].length-1]:it[0][0];return`${We}:${dt.x}:${dt.y}`}for(let We=0;We<ye.length;We++){const it=ye[We],ot=it.geometry,dt=it.text?it.text.toString():null;if(!dt){je(We);continue}const _t=vt(dt,ot),Xe=vt(dt,ot,!0);if(_t in ge&&Xe in re&&ge[_t]!==re[Xe]){const It=tt(_t,Xe,ot),rn=Ne(_t,Xe,Te[It].geometry);delete re[_t],delete ge[Xe],ge[vt(dt,Te[rn].geometry,!0)]=rn,Te[It].geometry=null}else _t in ge?Ne(_t,Xe,ot):Xe in re?tt(_t,Xe,ot):(je(We),re[_t]=xe-1,ge[Xe]=xe-1)}return Te.filter(We=>We.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ye,re)=>ye.sortKey-re.sortKey)}update(t,i,l,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,i,this.layers,l,h),this.icon.programConfigurations.updatePaintArrays(t,i,this.layers,l,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=e1(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,i){const l=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:h,y:p}of i)this.lineVertexArray.emplaceBack(h,p);return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,i,l,h,p,v,x,E,T,k,P,D,V,N){const G=t.indexArray,X=t.layoutVertexArray,le=t.globeExtVertexArray,ye=t.segments.prepareSegment(4*i.length,X,G,this.canOverlap?v.sortKey:void 0),re=this.glyphOffsetArray.length,ge=ye.vertexLength,Te=this.allowVerticalPlacement&&x===ho.vertical?Math.PI/2:0,xe=v.text&&v.text.sections;for(let Ne=0;Ne<i.length;Ne++){const{tl:tt,tr:vt,bl:We,br:it,tex:ot,pixelOffsetTL:dt,pixelOffsetBR:_t,minFontScaleX:Xe,minFontScaleY:It,glyphOffset:rn,isSDF:Rt,sectionIndex:Zt}=i[Ne],At=ye.vertexLength,an=rn[1];if(Am(X,T.x,T.y,tt.x,an+tt.y,ot.x,ot.y,l,Rt,dt.x,dt.y,Xe,It),Am(X,T.x,T.y,vt.x,an+vt.y,ot.x+ot.w,ot.y,l,Rt,_t.x,dt.y,Xe,It),Am(X,T.x,T.y,We.x,an+We.y,ot.x,ot.y+ot.h,l,Rt,dt.x,_t.y,Xe,It),Am(X,T.x,T.y,it.x,an+it.y,ot.x+ot.w,ot.y+ot.h,l,Rt,_t.x,_t.y,Xe,It),E){const{x:An,y:wn,z:xn}=E.anchor,[ln,Jn,dn]=E.up;km(le,An,wn,xn,ln,Jn,dn),km(le,An,wn,xn,ln,Jn,dn),km(le,An,wn,xn,ln,Jn,dn),km(le,An,wn,xn,ln,Jn,dn),Mm(t.dynamicLayoutVertexArray,An,wn,xn,Te)}else Mm(t.dynamicLayoutVertexArray,T.x,T.y,T.z,Te);G.emplaceBack(At,At+1,At+2),G.emplaceBack(At+1,At+2,At+3),ye.vertexLength+=4,ye.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(rn[0]),Ne!==i.length-1&&Zt===i[Ne+1].sectionIndex||t.programConfigurations.populatePaintArrays(X.length,v,v.index,{},V,N,xe&&xe[Zt])}const je=E?E.anchor:T;t.placedSymbolArray.emplaceBack(je.x,je.y,je.z,T.x,T.y,re,this.glyphOffsetArray.length-re,ge,k,P,T.segment,l?l[0]:0,l?l[1]:0,h[0],h[1],x,0,!1,0,D,0)}_commitLayoutVertex(t,i,l,h,p,v,x){t.emplaceBack(i,l,h,p,v,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(t,i,l,h,p,v,x){const E=l.segments.prepareSegment(4,l.layoutVertexArray,l.indexArray),T=E.vertexLength,k=x.tileAnchorX,P=x.tileAnchorY;for(let V=0;V<4;V++)l.collisionVertexArray.emplaceBack(0,0,0,0);l.collisionVertexArrayExt.emplaceBack(i,-t.padding,-t.padding),l.collisionVertexArrayExt.emplaceBack(i,t.padding,-t.padding),l.collisionVertexArrayExt.emplaceBack(i,t.padding,t.padding),l.collisionVertexArrayExt.emplaceBack(i,-t.padding,t.padding),this._commitLayoutVertex(l.layoutVertexArray,h,p,v,k,P,new Y(t.x1,t.y1)),this._commitLayoutVertex(l.layoutVertexArray,h,p,v,k,P,new Y(t.x2,t.y1)),this._commitLayoutVertex(l.layoutVertexArray,h,p,v,k,P,new Y(t.x2,t.y2)),this._commitLayoutVertex(l.layoutVertexArray,h,p,v,k,P,new Y(t.x1,t.y2)),E.vertexLength+=4;const D=l.indexArray;D.emplaceBack(T,T+1),D.emplaceBack(T+1,T+2),D.emplaceBack(T+2,T+3),D.emplaceBack(T+3,T),E.primitiveLength+=4}_addTextDebugCollisionBoxes(t,i,l,h,p,v){for(let x=h;x<p;x++){const E=l.get(x),T=this.getSymbolInstanceTextSize(t,v,i,x);this._addCollisionDebugVertices(E,T,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(t,i,l,h,p,v){for(let x=h;x<p;x++){const E=l.get(x),T=this.getSymbolInstanceIconSize(t,i,v.placedIconSymbolIndex);this._addCollisionDebugVertices(E,T,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,v)}}generateCollisionDebugBuffers(t,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new i_(ki,wb.members,ys),this.iconCollisionBox=new i_(ki,wb.members,ys);const l=Nu(this.iconSizeData,t),h=Nu(this.textSizeData,t);for(let p=0;p<this.symbolInstances.length;p++){const v=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(h,t,i,v.textBoxStartIndex,v.textBoxEndIndex,v),this._addTextDebugCollisionBoxes(h,t,i,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._addIconDebugCollisionBoxes(l,t,i,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._addIconDebugCollisionBoxes(l,t,i,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}}getSymbolInstanceTextSize(t,i,l,h){const p=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:h),v=ym(this.textSizeData,t,p)/Sr;return this.tilePixelRatio*v}getSymbolInstanceIconSize(t,i,l){const h=this.icon.placedSymbolArray.get(l),p=ym(this.iconSizeData,t,h);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(t,i,l){t.emplaceBack(i,-l,-l),t.emplaceBack(i,l,-l),t.emplaceBack(i,l,l),t.emplaceBack(i,-l,l)}_updateTextDebugCollisionBoxes(t,i,l,h,p,v){for(let x=h;x<p;x++){const E=l.get(x),T=this.getSymbolInstanceTextSize(t,v,i,x);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,T,E.padding)}}_updateIconDebugCollisionBoxes(t,i,l,h,p,v){for(let x=h;x<p;x++){const E=l.get(x),T=this.getSymbolInstanceIconSize(t,i,v);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,T,E.padding)}}updateCollisionDebugBuffers(t,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const l=Nu(this.iconSizeData,t),h=Nu(this.textSizeData,t);for(let p=0;p<this.symbolInstances.length;p++){const v=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(h,t,i,v.textBoxStartIndex,v.textBoxEndIndex,v),this._updateTextDebugCollisionBoxes(h,t,i,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._updateIconDebugCollisionBoxes(l,t,i,v.iconBoxStartIndex,v.iconBoxEndIndex,v.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(l,t,i,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,i,l,h,p,v,x,E,T){const k={};if(i<l){const{x1:P,y1:D,x2:V,y2:N,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge,featureIndex:Te}=t.get(i);k.textBox={x1:P,y1:D,x2:V,y2:N,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge},k.textFeatureIndex=Te}if(h<p){const{x1:P,y1:D,x2:V,y2:N,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge,featureIndex:Te}=t.get(h);k.verticalTextBox={x1:P,y1:D,x2:V,y2:N,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge},k.verticalTextFeatureIndex=Te}if(v<x){const{x1:P,y1:D,x2:V,y2:N,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge,featureIndex:Te}=t.get(v);k.iconBox={x1:P,y1:D,x2:V,y2:N,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge},k.iconFeatureIndex=Te}if(E<T){const{x1:P,y1:D,x2:V,y2:N,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge,featureIndex:Te}=t.get(E);k.verticalIconBox={x1:P,y1:D,x2:V,y2:N,padding:G,projectedAnchorX:X,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:re,tileAnchorY:ge},k.verticalIconFeatureIndex=Te}return k}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const l=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,i){const l=t.placedSymbolArray.get(i),h=l.vertexStartIndex+4*l.numGlyphs;for(let p=l.vertexStartIndex;p<h;p+=4)t.indexArray.emplaceBack(p,p+1,p+2),t.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(t),l=Math.cos(t),h=[],p=[],v=[];for(let x=0;x<this.symbolInstances.length;++x){v.push(x);const E=this.symbolInstances.get(x);h.push(0|Math.round(i*E.tileAnchorX+l*E.tileAnchorY)),p.push(E.featureIndex)}return v.sort((x,E)=>h[x]-h[E]||p[E]-p[x]),v}addToSortKeyRanges(t,i){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===i?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const l=this.symbolInstances.get(i);this.featureSortOrder.push(l.featureIndex);const{rightJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:p,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:T}=l;h>=0&&this.addIndicesForPlacedSymbol(this.text,h),p>=0&&p!==h&&this.addIndicesForPlacedSymbol(this.text,p),v>=0&&v!==p&&v!==h&&this.addIndicesForPlacedSymbol(this.text,v),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}$t(nl,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),nl.MAX_GLYPHS=65535,nl.addDynamicAttributes=Mm;const tk=new mt({"symbol-placement":new Le(et.layout_symbol["symbol-placement"]),"symbol-spacing":new Le(et.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Le(et.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ze(et.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Le(et.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Le(et.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Le(et.layout_symbol["icon-ignore-placement"]),"icon-optional":new Le(et.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Le(et.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ze(et.layout_symbol["icon-size"]),"icon-text-fit":new Le(et.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Le(et.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ze(et.layout_symbol["icon-image"]),"icon-rotate":new Ze(et.layout_symbol["icon-rotate"]),"icon-padding":new Le(et.layout_symbol["icon-padding"]),"icon-keep-upright":new Le(et.layout_symbol["icon-keep-upright"]),"icon-offset":new Ze(et.layout_symbol["icon-offset"]),"icon-anchor":new Ze(et.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Le(et.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Le(et.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Le(et.layout_symbol["text-rotation-alignment"]),"text-field":new Ze(et.layout_symbol["text-field"]),"text-font":new Ze(et.layout_symbol["text-font"]),"text-size":new Ze(et.layout_symbol["text-size"]),"text-max-width":new Ze(et.layout_symbol["text-max-width"]),"text-line-height":new Ze(et.layout_symbol["text-line-height"]),"text-letter-spacing":new Ze(et.layout_symbol["text-letter-spacing"]),"text-justify":new Ze(et.layout_symbol["text-justify"]),"text-radial-offset":new Ze(et.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Le(et.layout_symbol["text-variable-anchor"]),"text-anchor":new Ze(et.layout_symbol["text-anchor"]),"text-max-angle":new Le(et.layout_symbol["text-max-angle"]),"text-writing-mode":new Le(et.layout_symbol["text-writing-mode"]),"text-rotate":new Ze(et.layout_symbol["text-rotate"]),"text-padding":new Le(et.layout_symbol["text-padding"]),"text-keep-upright":new Le(et.layout_symbol["text-keep-upright"]),"text-transform":new Ze(et.layout_symbol["text-transform"]),"text-offset":new Ze(et.layout_symbol["text-offset"]),"text-allow-overlap":new Le(et.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Le(et.layout_symbol["text-ignore-placement"]),"text-optional":new Le(et.layout_symbol["text-optional"])});var r_={paint:new mt({"icon-opacity":new Ze(et.paint_symbol["icon-opacity"]),"icon-color":new Ze(et.paint_symbol["icon-color"]),"icon-halo-color":new Ze(et.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ze(et.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ze(et.paint_symbol["icon-halo-blur"]),"icon-translate":new Le(et.paint_symbol["icon-translate"]),"icon-translate-anchor":new Le(et.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ze(et.paint_symbol["text-opacity"]),"text-color":new Ze(et.paint_symbol["text-color"],{runtimeType:bo,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new Ze(et.paint_symbol["text-halo-color"]),"text-halo-width":new Ze(et.paint_symbol["text-halo-width"]),"text-halo-blur":new Ze(et.paint_symbol["text-halo-blur"]),"text-translate":new Le(et.paint_symbol["text-translate"]),"text-translate-anchor":new Le(et.paint_symbol["text-translate-anchor"])}),layout:tk};class t1{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Ma,this.defaultValue=t}evaluate(t){if(t.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(t.formattedSection))return i.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}$t(t1,"FormatSectionOverride",{omit:["defaultValue"]});class Pm extends Yo{constructor(t){super(t,r_)}recalculate(t,i){super.recalculate(t,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const l=this.layout.get("text-writing-mode");if(l){const h=[];for(const p of l)h.indexOf(p)<0&&h.push(p);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,i,l,h){const p=this.layout.get(t).evaluate(i,{},l,h),v=this._unevaluatedLayout._values[t];return v.isDataDriven()||Ua(v.value)||!p?p:function(x,E){return E.replace(/{([^{}]+)}/g,(T,k)=>k in x?String(x[k]):"")}(i.properties,p)}createBucket(t){return new nl(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of r_.paint.overridableProperties){if(!Pm.hasPaintOverride(this.layout,t))continue;const i=this.paint.get(t),l=new t1(i),h=new mu(l,i.property.specification);let p=null;p=i.value.kind==="constant"||i.value.kind==="source"?new gu("source",h):new ea("composite",h,i.value.zoomStops,i.value._interpolationType),this.paint._values[t]=new ht(i.property,p,i.parameters)}}_handleOverridablePaintPropertyUpdate(t,i,l){return!(!this.layout||i.isDataDriven()||l.isDataDriven())&&Pm.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,i){const l=t.get("text-field"),h=r_.paint.properties[i];let p=!1;const v=x=>{for(const E of x)if(h.overrides&&h.overrides.hasOverride(E))return void(p=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Rr)v(l.value.value.sections);else if(l.value.kind==="source"){const x=T=>{p||(T instanceof Al&&Xi(T.value)===Pa?v(T.value.sections):T instanceof kl?v(T.sections):T.eachChild(x))},E=l.value;E._styleExpression&&x(E._styleExpression.expression)}return p}getProgramConfiguration(t){return new Ja(this,t)}}var nk={paint:new mt({"background-color":new Le(et.paint_background["background-color"]),"background-pattern":new Le(et.paint_background["background-pattern"]),"background-opacity":new Le(et.paint_background["background-opacity"])})},ik={paint:new mt({"raster-opacity":new Le(et.paint_raster["raster-opacity"]),"raster-hue-rotate":new Le(et.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Le(et.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Le(et.paint_raster["raster-brightness-max"]),"raster-saturation":new Le(et.paint_raster["raster-saturation"]),"raster-contrast":new Le(et.paint_raster["raster-contrast"]),"raster-resampling":new Le(et.paint_raster["raster-resampling"]),"raster-fade-duration":new Le(et.paint_raster["raster-fade-duration"])})};class rk extends Yo{constructor(t){super(t,{}),this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var ok={paint:new mt({"sky-type":new Le(et.paint_sky["sky-type"]),"sky-atmosphere-sun":new Le(et.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Le(et.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Le(et.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Le(et.paint_sky["sky-gradient-radius"]),"sky-gradient":new lt(et.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Le(et.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Le(et.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Le(et.paint_sky["sky-opacity"])})};function o_(n,t,i){const l=[0,0,1],h=Sx([]);return Cx(h,h,i?-Se(n)+Math.PI:Se(n)),Tx(h,h,-Se(t)),xx(l,l,h),Or(l,l)}const sk={circle:class extends Yo{constructor(n){super(n,vI)}createBucket(n){return new Dv(n)}queryRadius(n){const t=n;return Ru("circle-radius",this,t)+Ru("circle-stroke-width",this,t)+lm(this.paint.get("circle-translate"))}queryIntersectsFeature(n,t,i,l,h,p,v,x){const E=Wx(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,n.pixelToTileUnitsFactor),T=this.paint.get("circle-radius").evaluate(t,i)+this.paint.get("circle-stroke-width").evaluate(t,i);return Hx(n,l,p,v,x,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",E,T)}getProgramIds(){return["circle"]}getProgramConfiguration(n){return new Ja(this,n)}},heatmap:class extends Yo{createBucket(n){return new Yx(n)}constructor(n){super(n,bI),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Fv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(n){return Ru("heatmap-radius",this,n)}queryIntersectsFeature(n,t,i,l,h,p,v,x){const E=this.paint.get("heatmap-radius").evaluate(t,i);return Hx(n,l,p,v,x,!0,!0,new Y(0,0),E)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(n){return new Ja(this,n)}},hillshade:class extends Yo{constructor(n){super(n,wI)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Yo{constructor(n){super(n,FI)}getProgramIds(){const n=this.paint.get("fill-pattern"),t=n&&n.constantOr(1),i=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(n){return new Ja(this,n)}recalculate(n,t){super.recalculate(n,t);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new fm(n)}queryRadius(){return lm(this.paint.get("fill-translate"))}queryIntersectsFeature(n,t,i,l,h,p){return!n.queryGeometry.isAboveHorizon&&Ux(Zx(n.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,n.pixelToTileUnitsFactor),l)}isTileClipped(){return!0}},"fill-extrusion":class extends Yo{constructor(n){super(n,eA)}createBucket(n){return new Dd(n)}queryRadius(){return lm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(n){return new Ja(this,n)}queryIntersectsFeature(n,t,i,l,h,p,v,x,E){const T=Wx(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,n.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(t,i),P=this.paint.get("fill-extrusion-base").evaluate(t,i),D=[0,0],V=x&&p.elevation,N=p.elevation?p.elevation.exaggeration():1,G=n.tile.getBucket(this);if(V&&G instanceof Dd){const ge=G.centroidVertexArray,Te=E+1;Te<ge.length&&(D[0]=ge.geta_centroid_pos0(Te),D[1]=ge.geta_centroid_pos1(Te))}if(D[0]===0&&D[1]===1)return!1;p.projection.name==="globe"&&(l=pb([l],[new Y(0,0),new Y(hn,hn)],n.tileID.canonical).map(ge=>ge.polygon).flat());const X=V?x:null,[le,ye]=function(ge,Te,xe,je,Ne,tt,vt,We,it,ot,dt){return ge.projection.name==="globe"?function(_t,Xe,It,rn,Rt,Zt,At,an,An,wn,xn){const ln=[],Jn=[],dn=_t.projection.upVectorScale(xn,_t.center.lat,_t.worldSize).metersToTile,kn=[0,0,0,1],ii=[0,0,0,1],mi=(gi,yi,Mi,hr)=>{gi[0]=yi,gi[1]=Mi,gi[2]=hr,gi[3]=1},di=fb();It>0&&(It+=di),rn+=di;for(const gi of Xe){const yi=[],Mi=[];for(const hr of gi){const Qn=hr.x+Rt.x,Yi=hr.y+Rt.y,ji=_t.projection.projectTilePoint(Qn,Yi,xn),Un=_t.projection.upVector(xn,hr.x,hr.y);let Ei=It,nr=rn;if(At){const ri=_b(Qn,Yi,It,rn,At,an,An,wn);Ei+=ri.base,nr+=ri.top}It!==0?mi(kn,ji.x+Un[0]*dn*Ei,ji.y+Un[1]*dn*Ei,ji.z+Un[2]*dn*Ei):mi(kn,ji.x,ji.y,ji.z),mi(ii,ji.x+Un[0]*dn*nr,ji.y+Un[1]*dn*nr,ji.z+Un[2]*dn*nr),Bi(kn,kn,Zt),Bi(ii,ii,Zt),yi.push(new Vu(kn[0],kn[1],kn[2])),Mi.push(new Vu(ii[0],ii[1],ii[2]))}ln.push(yi),Jn.push(Mi)}return[ln,Jn]}(ge,Te,xe,je,Ne,tt,vt,We,it,ot,dt):vt?function(_t,Xe,It,rn,Rt,Zt,At,an,An){const wn=[],xn=[],ln=[0,0,0,1];for(const Jn of _t){const dn=[],kn=[];for(const ii of Jn){const mi=ii.x+rn.x,di=ii.y+rn.y,gi=_b(mi,di,Xe,It,Zt,At,an,An);ln[0]=mi,ln[1]=di,ln[2]=gi.base,ln[3]=1,rc(ln,ln,Rt),ln[3]=Math.max(ln[3],1e-5);const yi=new Vu(ln[0]/ln[3],ln[1]/ln[3],ln[2]/ln[3]);ln[0]=mi,ln[1]=di,ln[2]=gi.top,ln[3]=1,rc(ln,ln,Rt),ln[3]=Math.max(ln[3],1e-5);const Mi=new Vu(ln[0]/ln[3],ln[1]/ln[3],ln[2]/ln[3]);dn.push(yi),kn.push(Mi)}wn.push(dn),xn.push(kn)}return[wn,xn]}(Te,xe,je,Ne,tt,vt,We,it,ot):function(_t,Xe,It,rn,Rt){const Zt=[],At=[],an=Rt[8]*Xe,An=Rt[9]*Xe,wn=Rt[10]*Xe,xn=Rt[11]*Xe,ln=Rt[8]*It,Jn=Rt[9]*It,dn=Rt[10]*It,kn=Rt[11]*It;for(const ii of _t){const mi=[],di=[];for(const gi of ii){const yi=gi.x+rn.x,Mi=gi.y+rn.y,hr=Rt[0]*yi+Rt[4]*Mi+Rt[12],Qn=Rt[1]*yi+Rt[5]*Mi+Rt[13],Yi=Rt[2]*yi+Rt[6]*Mi+Rt[14],ji=Rt[3]*yi+Rt[7]*Mi+Rt[15],Un=hr+an,Ei=Qn+An,nr=Yi+wn,ri=Math.max(ji+xn,1e-5),Oi=hr+ln,kr=Qn+Jn,dr=Yi+dn,fr=Math.max(ji+kn,1e-5);mi.push(new Vu(Un/ri,Ei/ri,nr/ri)),di.push(new Vu(Oi/fr,kr/fr,dr/fr))}Zt.push(mi),At.push(di)}return[Zt,At]}(Te,xe,je,Ne,tt)}(p,l,P,k,T,v,X,D,N,p.center.lat,n.tileID.canonical),re=n.queryGeometry;return function(ge,Te,xe){let je=1/0;Ux(xe,Te)&&(je=vb(xe,Te[0]));for(let Ne=0;Ne<Te.length;Ne++){const tt=Te[Ne],vt=ge[Ne];for(let We=0;We<tt.length-1;We++){const it=tt[We],ot=[it,tt[We+1],vt[We+1],vt[We],it];$x(xe,ot)&&(je=Math.min(je,vb(xe,ot)))}}return je!==1/0&&je}(le,ye,re.isPointQuery()?re.screenBounds:re.screenGeometry)}},line:class extends Yo{constructor(n){super(n,yb),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Nh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(n,t){super.recalculate(n,t),this.paint._values["line-floorwidth"]=xb.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new _m(n)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(n){return new Ja(this,n)}queryRadius(n){const t=n,i=bb(Ru("line-width",this,t),Ru("line-gap-width",this,t)),l=Ru("line-offset",this,t);return i/2+Math.abs(l)+lm(this.paint.get("line-translate"))}queryIntersectsFeature(n,t,i,l,h,p){if(n.queryGeometry.isAboveHorizon)return!1;const v=Zx(n.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,n.pixelToTileUnitsFactor),x=n.pixelToTileUnitsFactor/2*bb(this.paint.get("line-width").evaluate(t,i),this.paint.get("line-gap-width").evaluate(t,i)),E=this.paint.get("line-offset").evaluate(t,i);return E&&(l=function(T,k){const P=[],D=new Y(0,0);for(let V=0;V<T.length;V++){const N=T[V],G=[];for(let X=0;X<N.length;X++){const le=N[X-1],ye=N[X],re=N[X+1],ge=X===0?D:ye.sub(le)._unit()._perp(),Te=X===N.length-1?D:re.sub(ye)._unit()._perp(),xe=ge._add(Te)._unit();xe._mult(1/(xe.x*Te.x+xe.y*Te.y)),G.push(xe._mult(k)._add(ye))}P.push(G)}return P}(l,E*n.pixelToTileUnitsFactor)),function(T,k,P){for(let D=0;D<k.length;D++){const V=k[D];if(T.length>=3){for(let N=0;N<V.length;N++)if(lc(T,V[N]))return!0}if(fI(T,V,P))return!0}return!1}(v,l,x)}isTileClipped(){return!0}},symbol:Pm,background:class extends Yo{constructor(n){super(n,nk)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Yo{constructor(n){super(n,ik)}getProgramIds(){return["raster"]}},sky:class extends Yo{constructor(n){super(n,ok),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="sky-gradient"?this._updateColorRamp():n!=="sky-atmosphere-sun"&&n!=="sky-atmosphere-halo-color"&&n!=="sky-atmosphere-color"&&n!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Fv({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(n){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=n.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(n,t){if(this.paint.get("sky-type")==="atmosphere"){const l=this.paint.get("sky-atmosphere-sun"),h=!l,p=n.style.light,v=p.properties.get("position");return h&&p.properties.get("anchor")==="viewport"&&he("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?o_(v.azimuthal,90-v.polar,t):o_(l[0],90-l[1],t)}const i=this.paint.get("sky-gradient-center");return o_(i[0],90-i[1],t)}is3D(){return!1}isSky(){return!0}markSkyboxValid(n){this._skyboxInvalidated=!1,this._lightPosition=n.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const n=this.paint.get("sky-type");return n==="atmosphere"?["skyboxCapture","skybox"]:n==="gradient"?["skyboxGradient"]:null}}};class qd{constructor(t,i,l,h){this.context=t,this.format=l,this.texture=t.gl.createTexture(),this.update(i,h)}update(t,i,l){const{width:h,height:p}=t,{context:v}=this,{gl:x}=v,{HTMLImageElement:E,HTMLCanvasElement:T,HTMLVideoElement:k,ImageData:P,ImageBitmap:D}=w;if(x.bindTexture(x.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA&&(!i||i.premultiply!==!1)),l||this.size&&this.size[0]===h&&this.size[1]===p){const{x:V,y:N}=l||{x:0,y:0};t instanceof E||t instanceof T||t instanceof k||t instanceof P||D&&t instanceof D?x.texSubImage2D(x.TEXTURE_2D,0,V,N,x.RGBA,x.UNSIGNED_BYTE,t):x.texSubImage2D(x.TEXTURE_2D,0,V,N,h,p,x.RGBA,x.UNSIGNED_BYTE,t.data)}else this.size=[h,p],t instanceof E||t instanceof T||t instanceof k||t instanceof P||D&&t instanceof D?x.texImage2D(x.TEXTURE_2D,0,this.format,this.format,x.UNSIGNED_BYTE,t):x.texImage2D(x.TEXTURE_2D,0,this.format,h,p,0,this.format,x.UNSIGNED_BYTE,t.data);this.useMipmap=Boolean(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(t,i){const{context:l}=this,{gl:h}=l;h.bindTexture(h.TEXTURE_2D,this.texture),t!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,t),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?t===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:t),this.filter=t),i!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,i),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class ak{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class lk{constructor(){this.tasks={},this.taskQueue=[],bt(["process"],this),this.invoker=new ak(this.process),this.nextId=0}add(t,i){const l=this.nextId++,h=function({type:p,isSymbolTile:v,zoom:x}){return x=x||0,p==="message"?0:p!=="maybePrepare"||v?p!=="parseTile"||v?p==="parseTile"&&v?300-x:p==="maybePrepare"&&v?400-x:500:200-x:100-x}(i);if(h===0){st();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[l]={fn:t,metadata:i,priority:h,id:l},this.taskQueue.push(l),this.invoker.trigger(),{cancel:()=>{delete this.tasks[l]}}}process(){st();try{if(this.taskQueue=this.taskQueue.filter(l=>!!this.tasks[l]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const i=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let t=null,i=1/0;for(let h=0;h<this.taskQueue.length;h++){const p=this.tasks[this.taskQueue[h]];p.priority<i&&(i=p.priority,t=h)}if(t===null)return null;const l=this.taskQueue[t];return this.taskQueue.splice(t,1),l}remove(){this.invoker.remove()}}class n1{constructor(t){this._stringToNumber={},this._numberToString=[];for(let i=0;i<t.length;i++){const l=t[i];this._stringToNumber[l]=i,this._numberToString[i]=l}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const ck=["tile","layer","source","sourceLayer","state"];class i1{constructor(t,i,l,h,p){this.type="Feature",this._vectorTileFeature=t,this._z=i,this._x=l,this._y=h,this.properties=t.properties,this.id=p}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const i of ck)this[i]!==void 0&&(t[i]=this[i]);return t}}const Io=32,Cs=33,il=new Uint16Array(8184);for(let n=0;n<2046;n++){let t=n+2,i=0,l=0,h=0,p=0,v=0,x=0;for(1&t?h=p=v=Io:i=l=x=Io;(t>>=1)>1;){const T=i+h>>1,k=l+p>>1;1&t?(h=i,p=l,i=v,l=x):(i=h,l=p,h=v,p=x),v=T,x=k}const E=4*n;il[E+0]=i,il[E+1]=l,il[E+2]=h,il[E+3]=p}const Is=new Uint16Array(2178),rl=new Uint8Array(1089),zm=new Uint16Array(1089);function r1(n){return n===0?-.03125:n===32?.03125:0}var o1=Xt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const s1={type:2,extent:hn,loadGeometry:()=>[[new Y(0,0),new Y(8193,0),new Y(8193,8193),new Y(0,8193),new Y(0,0)]]};class s_{constructor(t,i,l,h,p){this.tileID=t,this.uid=qt(),this.uses=0,this.tileSize=i,this.tileZoom=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=p,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(t){const i=t+this.timeAdded;i<qn.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=uc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,i,l){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(h,p){const v={};if(!p)return v;for(const x of h){const E=x.layerIds.map(T=>p.getLayer(T)).filter(Boolean);if(E.length!==0){x.layers=E,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(T=>E.filter(k=>k.id===T)[0]));for(const T of E)v[T.id]=x}}return v}(t.buckets,i.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const p=this.buckets[h];if(p instanceof nl){if(this.hasSymbolBuckets=!0,!l)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const p=this.buckets[h];if(p instanceof nl&&p.hasRTLText){this.hasRTLText=!0,Ae.isLoading()||Ae.isLoaded()||Ce()!=="deferred"||we();break}}this.queryPadding=0;for(const h in this.buckets){const p=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(h).queryRadius(p))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas)}else this.collisionBoxArray=new fv}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.id]}upload(t){for(const l in this.buckets){const h=this.buckets[l];h.uploadPending()&&h.upload(t)}const i=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new qd(t,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new qd(t,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new qd(t,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,i,l,h,p,v,x,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:x,transform:v,params:p,tileTransform:this.tileTransform},t,i,l):{}}querySourceFeatures(t,i){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const h=l.loadVTLayers(),p=i?i.sourceLayer:"",v=h._geojsonTileLayer||h[p];if(!v)return;const x=_u(i&&i.filter),{z:E,x:T,y:k}=this.tileID.canonical,P={z:E,x:T,y:k};for(let D=0;D<v.length;D++){const V=v.feature(D);if(x.needGeometry){const X=ac(V,!0);if(!x.filter(new Be(this.tileID.overscaledZ),X,this.tileID.canonical))continue}else if(!x.filter(new Be(this.tileID.overscaledZ),V))continue;const N=l.getId(V,p),G=new i1(V,E,T,k,N);G.tile=P,t.push(G)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const i=this.expirationTime;if(t.cacheControl){const l=yt(t.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const l=Date.now();let h=!1;if(this.expirationTime>l)h=!1;else if(i)if(this.expirationTime<i)h=!0;else{const p=this.expirationTime-i;p?this.expirationTime=l+Math.max(p,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0||!i)return;const l=this.latestFeatureIndex.loadVTLayers(),h=i.style.listImages();for(const p in this.buckets){if(!i.style.hasLayer(p))continue;const v=this.buckets[p],x=v.layers[0].sourceLayer||"_geojsonTileLayer",E=l[x],T=t[x];if(!E||!T||Object.keys(T).length===0)continue;if(v.update(T,E,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),v instanceof _m||v instanceof fm){const P=i.style._getSourceCache(v.layers[0].source);i._terrain&&i._terrain.enabled&&P&&v.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(P.id,this.tileID)}const k=i&&i.style&&i.style.getLayer(p);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<qn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=qn.now()+t}setTexture(t,i){const l=i.context,h=l.gl;this.texture=this.texture||i.getTileTexture(t.width),this.texture?this.texture.update(t,{useMipmap:!0}):(this.texture=new qd(l,t,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),l.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax))}setDependencies(t,i){const l={};for(const h of i)l[h]=!0;this.dependencies[t]=l}hasDependency(t,i){for(const l of t){const h=this.dependencies[l];if(h){for(const p of i)if(h[p])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,i){if(!i||i.name==="mercator"||this._tileDebugBuffer)return;const l=oa(s1,this.tileID.canonical,this.tileTransform)[0],h=new en,p=new xs;for(let v=0;v<l.length;v++){const{x,y:E}=l[v];h.emplaceBack(x,E),p.emplaceBack(v)}p.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(p),this._tileDebugBuffer=t.createVertexBuffer(h,Ed.members),this._tileDebugSegments=$i.simpleSegment(0,0,h.length,p.length)}_makeTileBoundsBuffers(t,i){if(this._tileBoundsBuffer||!i||i.name==="mercator")return;const l=oa(s1,this.tileID.canonical,this.tileTransform)[0];let h,p;if(this.isRaster){const v=function(x,E){const T=uc(x,E),k=Math.pow(2,x.z);for(let X=0;X<Cs;X++)for(let le=0;le<Cs;le++){const ye=uo((x.x+(le+r1(le))/Io)/k),re=wr((x.y+(X+r1(X))/Io)/k),ge=E.project(ye,re),Te=X*Cs+le;Is[2*Te+0]=Math.round((ge.x*T.scale-T.x)*hn),Is[2*Te+1]=Math.round((ge.y*T.scale-T.y)*hn)}rl.fill(0),zm.fill(0);for(let X=2045;X>=0;X--){const le=4*X,ye=il[le+0],re=il[le+1],ge=il[le+2],Te=il[le+3],xe=ye+ge>>1,je=re+Te>>1,Ne=xe+je-re,tt=je+ye-xe,vt=re*Cs+ye,We=Te*Cs+ge,it=je*Cs+xe,ot=Math.hypot((Is[2*vt+0]+Is[2*We+0])/2-Is[2*it+0],(Is[2*vt+1]+Is[2*We+1])/2-Is[2*it+1])>=16;if(rl[it]=rl[it]||(ot?1:0),X<1022){const dt=(re+tt>>1)*Cs+(ye+Ne>>1),_t=(Te+tt>>1)*Cs+(ge+Ne>>1);rl[it]=rl[it]||rl[dt]||rl[_t]}}const P=new ni,D=new br;let V=0;function N(X,le){const ye=le*Cs+X;return zm[ye]===0&&(P.emplaceBack(Is[2*ye+0],Is[2*ye+1],X*hn/Io,le*hn/Io),zm[ye]=++V),zm[ye]-1}function G(X,le,ye,re,ge,Te){const xe=X+ye>>1,je=le+re>>1;if(Math.abs(X-ge)+Math.abs(le-Te)>1&&rl[je*Cs+xe])G(ge,Te,X,le,xe,je),G(ye,re,ge,Te,xe,je);else{const Ne=N(X,le),tt=N(ye,re),vt=N(ge,Te);D.emplaceBack(Ne,tt,vt)}}return G(0,0,Io,Io,Io,0),G(Io,Io,0,0,0,Io),{vertices:P,indices:D}}(this.tileID.canonical,i);h=v.vertices,p=v.indices}else{h=new ni,p=new br;for(const{x,y:E}of l)h.emplaceBack(x,E,0,0);const v=Bu(h.int16,void 0,4);for(let x=0;x<v.length;x+=3)p.emplaceBack(v[x],v[x+1],v[x+2])}this._tileBoundsBuffer=t.createVertexBuffer(h,o1.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(p),this._tileBoundsSegments=$i.simpleSegment(0,0,h.length,p.length)}_makeGlobeTileDebugBuffers(t,i){const l=i.projection;if(!l||l.name!=="globe"||i.freezeTileCoverage)return;const h=this.tileID.canonical,p=Cd(Mx(h,i)),v=Lu(i.zoom);let x;v>0&&(x=_v(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,h,i,p,x,v),this._makeGlobeTileDebugTextBuffer(t,h,i,p,x,v)}_globePoint(t,i,l,h,p,v,x){let E=Td(t,i,l);if(v){const T=1<<l.z,k=Es(h.center.lng),P=Ss(h.center.lat),D=(l.x+.5)/T-k;let V=0;D>.5?V=-1:D<-.5&&(V=1);let N=(t/hn+l.x)/T+V,G=(i/hn+l.y)/T;N=(N-k)*h._pixelsPerMercatorPixel+k,G=(G-P)*h._pixelsPerMercatorPixel+P;const X=[N*h.worldSize,G*h.worldSize,0];Bi(X,X,v),E=sc(E,X,x)}return Bi(E,E,p)}_makeGlobeTileDebugBorderBuffer(t,i,l,h,p,v){const x=new en,E=new xs,T=new Wn,k=(D,V,N,G,X)=>{const le=(N-D)/(X-1),ye=(G-V)/(X-1),re=x.length;for(let ge=0;ge<X;ge++){const Te=D+ge*le,xe=V+ge*ye;x.emplaceBack(Te,xe);const je=this._globePoint(Te,xe,i,l,h,p,v);T.emplaceBack(je[0],je[1],je[2]),E.emplaceBack(re+ge)}},P=hn;k(0,0,P,0,16),k(P,0,P,P,16),k(P,P,0,P,16),k(0,P,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(E),this._tileDebugBuffer=t.createVertexBuffer(x,Ed.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(T,Ax.members),this._tileDebugSegments=$i.simpleSegment(0,0,x.length,E.length)}_makeGlobeTileDebugTextBuffer(t,i,l,h,p,v){const x=new en,E=new br,T=new Wn,k=25;E.reserve(32),x.reserve(k),T.reserve(k);const P=(D,V)=>k*D+V;for(let D=0;D<k;D++){const V=2048*D;for(let N=0;N<k;N++){const G=2048*N;x.emplaceBack(G,V);const X=this._globePoint(G,V,i,l,h,p,v);T.emplaceBack(X[0],X[1],X[2])}}for(let D=0;D<4;D++)for(let V=0;V<4;V++){const N=P(D,V),G=P(D,V+1),X=P(D+1,V),le=P(D+1,V+1);E.emplaceBack(N,G,X),E.emplaceBack(X,G,le)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(E),this._tileDebugTextBuffer=t.createVertexBuffer(x,Ed.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(T,Ax.members),this._tileDebugTextSegments=$i.simpleSegment(0,0,k,32)}}class uk{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,i,l){const h=String(i);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][h]=this.stateChanges[t][h]||{},pt(this.stateChanges[t][h],l),this.deletedStates[t]===null){this.deletedStates[t]={};for(const p in this.state[t])p!==h&&(this.deletedStates[t][p]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][h]===null){this.deletedStates[t][h]={};for(const p in this.state[t][h])l[p]||(this.deletedStates[t][h][p]=null)}else for(const p in l)this.deletedStates[t]&&this.deletedStates[t][h]&&this.deletedStates[t][h][p]===null&&delete this.deletedStates[t][h][p]}removeFeatureState(t,i,l){if(this.deletedStates[t]===null)return;const h=String(i);if(this.deletedStates[t]=this.deletedStates[t]||{},l&&i!==void 0)this.deletedStates[t][h]!==null&&(this.deletedStates[t][h]=this.deletedStates[t][h]||{},this.deletedStates[t][h][l]=null);else if(i!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][h])for(l in this.deletedStates[t][h]={},this.stateChanges[t][h])this.deletedStates[t][h][l]=null;else this.deletedStates[t][h]=null;else this.deletedStates[t]=null}getState(t,i){const l=String(i),h=pt({},(this.state[t]||{})[l],(this.stateChanges[t]||{})[l]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const p=this.deletedStates[t][i];if(p===null)return{};for(const v in p)delete h[v]}return h}initializeTileState(t,i){t.setFeatureState(this.state,i)}coalesceChanges(t,i){const l={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const p={};for(const v in this.stateChanges[h])this.state[h][v]||(this.state[h][v]={}),pt(this.state[h][v],this.stateChanges[h][v]),p[v]=this.state[h][v];l[h]=p}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const p={};if(this.deletedStates[h]===null)for(const v in this.state[h])p[v]={},this.state[h][v]={};else for(const v in this.deletedStates[h]){if(this.deletedStates[h][v]===null)this.state[h][v]={};else if(this.state[h][v])for(const x of Object.keys(this.deletedStates[h][v]))delete this.state[h][v][x];p[v]=this.state[h][v]}l[h]=l[h]||{},pt(l[h],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const h in t)t[h].setFeatureState(l,i)}}class a1{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,i){const l=this.toIdx(t,i);return{min:this.minimums[l],max:this.maximums[l]}}isLeaf(t,i){return this.leaves[this.toIdx(t,i)]}toIdx(t,i){return i*this.size+t}}function l1(n,t,i,l){let h=0,p=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(l[v])<1e-15){if(i[v]<n[v]||i[v]>t[v])return null}else{const x=1/l[v];let E=(n[v]-i[v])*x,T=(t[v]-i[v])*x;if(E>T){const k=E;E=T,T=k}if(E>h&&(h=E),T<p&&(p=T),h>p)return null}return h}function c1(n,t,i,l,h,p,v,x,E,T,k){const P=l-n,D=h-t,V=p-i,N=v-n,G=x-t,X=E-i,le=k[1]*X-k[2]*G,ye=k[2]*N-k[0]*X,re=k[0]*G-k[1]*N,ge=P*le+D*ye+V*re;if(Math.abs(ge)<1e-15)return null;const Te=1/ge,xe=T[0]-n,je=T[1]-t,Ne=T[2]-i,tt=(xe*le+je*ye+Ne*re)*Te;if(tt<0||tt>1)return null;const vt=je*V-Ne*D,We=Ne*P-xe*V,it=xe*D-je*P,ot=(k[0]*vt+k[1]*We+k[2]*it)*Te;return ot<0||tt+ot>1?null:(N*vt+G*We+X*it)*Te}function u1(n,t,i){return(n-t)/(i-t)}function h1(n,t,i,l,h,p,v,x,E){const T=1<<i,k=p-l,P=v-h,D=(n+1)/T*k+l,V=(t+0)/T*P+h,N=(t+1)/T*P+h;x[0]=(n+0)/T*k+l,x[1]=V,E[0]=D,E[1]=N}class d1{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(p){const v=Math.ceil(Math.log2(p.dim/8)),x=[];let E=Math.ceil(Math.pow(2,v));const T=1/E,k=(V,N,G,X,le)=>{const ye=X?1:0,re=(V+1)*G-ye,ge=N*G,Te=(N+1)*G-ye;le[0]=V*G,le[1]=ge,le[2]=re,le[3]=Te};let P=new a1(E);const D=[];for(let V=0;V<E*E;V++){k(V%E,Math.floor(V/E),T,!1,D);const N=ol(D[0],D[1],p),G=ol(D[2],D[1],p),X=ol(D[2],D[3],p),le=ol(D[0],D[3],p);P.minimums.push(Math.min(N,G,X,le)),P.maximums.push(Math.max(N,G,X,le)),P.leaves.push(1)}for(x.push(P),E/=2;E>=1;E/=2){const V=x[x.length-1];P=new a1(E);for(let N=0;N<E*E;N++){k(N%E,Math.floor(N/E),2,!0,D);const G=V.getElevation(D[0],D[1]),X=V.getElevation(D[2],D[1]),le=V.getElevation(D[2],D[3]),ye=V.getElevation(D[0],D[3]),re=V.isLeaf(D[0],D[1]),ge=V.isLeaf(D[2],D[1]),Te=V.isLeaf(D[2],D[3]),xe=V.isLeaf(D[0],D[3]),je=Math.min(G.min,X.min,le.min,ye.min),Ne=Math.max(G.max,X.max,le.max,ye.max),tt=re&&ge&&Te&&xe;P.maximums.push(Ne),P.minimums.push(je),P.leaves.push(Ne-je<=5&&tt?1:0)}x.push(P)}return x}(this.dem),l=i.length-1,h=i[l];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(i,0,0,l,0)}raycastRoot(t,i,l,h,p,v,x=1){return l1([t,i,-100],[l,h,this.maximums[0]*x],p,v)}raycast(t,i,l,h,p,v,x=1){if(!this.nodeCount)return null;const E=this.raycastRoot(t,i,l,h,p,v,x);if(E==null)return null;const T=[],k=[],P=[],D=[],V=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;V.length>0;){const{idx:N,t:G,nodex:X,nodey:le,depth:ye}=V.pop();if(this.leaves[N]){h1(X,le,ye,t,i,l,h,P,D);const ge=1<<ye,Te=(X+0)/ge,xe=(X+1)/ge,je=(le+0)/ge,Ne=(le+1)/ge,tt=ol(Te,je,this.dem)*x,vt=ol(xe,je,this.dem)*x,We=ol(xe,Ne,this.dem)*x,it=ol(Te,Ne,this.dem)*x,ot=c1(P[0],P[1],tt,D[0],P[1],vt,D[0],D[1],We,p,v),dt=c1(D[0],D[1],We,P[0],D[1],it,P[0],P[1],tt,p,v),_t=Math.min(ot!==null?ot:Number.MAX_VALUE,dt!==null?dt:Number.MAX_VALUE);if(_t!==Number.MAX_VALUE)return _t;{const Xe=bd([],p,v,G);if(f1(tt,vt,it,We,u1(Xe[0],P[0],D[0]),u1(Xe[1],P[1],D[1]))>=Xe[2])return G}continue}let re=0;for(let ge=0;ge<this._siblingOffset.length;ge++){h1((X<<1)+this._siblingOffset[ge][0],(le<<1)+this._siblingOffset[ge][1],ye+1,t,i,l,h,P,D),P[2]=-100,D[2]=this.maximums[this.childOffsets[N]+ge]*x;const Te=l1(P,D,p,v);if(Te!=null){const xe=Te;T[ge]=xe;let je=!1;for(let Ne=0;Ne<re&&!je;Ne++)xe>=T[k[Ne]]&&(k.splice(Ne,0,ge),je=!0);je||(k[re]=ge),re++}}for(let ge=0;ge<re;ge++){const Te=k[ge];V.push({idx:this.childOffsets[N]+Te,t:T[Te],nodex:(X<<1)+this._siblingOffset[Te][0],nodey:(le<<1)+this._siblingOffset[Te][1],depth:ye+1})}}return null}_addNode(t,i,l){return this.minimums.push(t),this.maximums.push(i),this.leaves.push(l),this.childOffsets.push(0),this.nodeCount++}_construct(t,i,l,h,p){if(t[h].isLeaf(i,l)===1)return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const v=h-1,x=t[v];let E=0,T=0;for(let k=0;k<this._siblingOffset.length;k++){const P=2*i+this._siblingOffset[k][0],D=2*l+this._siblingOffset[k][1],V=x.getElevation(P,D),N=x.isLeaf(P,D),G=this._addNode(V.min,V.max,N);N&&(E|=1<<k),T||(T=G)}for(let k=0;k<this._siblingOffset.length;k++)E&1<<k||this._construct(t,2*i+this._siblingOffset[k][0],2*l+this._siblingOffset[k][1],v,T+k)}}function f1(n,t,i,l,h,p){return Vn(Vn(n,i,p),Vn(t,l,p),h)}function ol(n,t,i){const l=i.dim,h=nt(n*l-.5,0,l-1),p=nt(t*l-.5,0,l-1),v=Math.floor(h),x=Math.floor(p),E=Math.min(v+1,l-1),T=Math.min(x+1,l-1);return f1(i.get(v,x),i.get(E,x),i.get(v,T),i.get(E,T),h-v,p-x)}const p1={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Lm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,i,l,h=!1,p=!1){if(this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return he(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const v=this.dim=i.height-2,x=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=l||"mapbox",this.borderReady=h,!h){for(let E=0;E<v;E++)x[this._idx(-1,E)]=x[this._idx(0,E)],x[this._idx(v,E)]=x[this._idx(v-1,E)],x[this._idx(E,-1)]=x[this._idx(E,0)],x[this._idx(E,v)]=x[this._idx(E,v-1)];x[this._idx(-1,-1)]=x[this._idx(0,0)],x[this._idx(v,-1)]=x[this._idx(v-1,0)],x[this._idx(-1,v)]=x[this._idx(0,v-1)],x[this._idx(v,v)]=x[this._idx(v-1,v-1)],p&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new d1(this)}get(t,i,l=!1){l&&(t=nt(t,-1,this.dim),i=nt(i,-1,this.dim));const h=4*this._idx(t,i);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}static getUnpackVector(t){return p1[t]}get unpackVector(){return p1[this.encoding]}_idx(t,i){if(t<-1||t>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(t+1)}_unpackMapbox(t,i,l){return(256*t*256+256*i+l)/10-1e4}_unpackTerrarium(t,i,l){return 256*t+i+l/256-32768}static pack(t,i){const l=[0,0,0,0],h=Lm.getUnpackVector(i);let p=Math.floor((t+h[3])/h[2]);return l[2]=p%256,p=Math.floor(p/256),l[1]=p%256,p=Math.floor(p/256),l[0]=p,l}getPixels(){return new eo({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,i,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=i*this.dim,p=i*this.dim+this.dim,v=l*this.dim,x=l*this.dim+this.dim;switch(i){case-1:h=p-1;break;case 1:p=h+1}switch(l){case-1:v=x-1;break;case 1:x=v+1}const E=-i*this.dim,T=-l*this.dim;for(let k=v;k<x;k++)for(let P=h;P<p;P++){const D=4*this._idx(P,k),V=4*this._idx(P+E,k+T);this.pixels[D+0]=t.pixels[V+0],this.pixels[D+1]=t.pixels[V+1],this.pixels[D+2]=t.pixels[V+2],this.pixels[D+3]=t.pixels[V+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}$t(Lm,"DEMData"),$t(d1,"DemMinMaxQuadTree",{omit:["dem"]});class hk{constructor(t,i){this.max=t,this.onRemove=i,this.reset()}reset(){for(const t in this.data)for(const i of this.data[t])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(t,i,l){const h=t.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const p={value:i,timeout:void 0};if(l!==void 0&&(p.timeout=setTimeout(()=>{this.remove(t,p)},l)),this.data[h].push(p),this.order.push(h),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const i=this.data[t].shift();return i.timeout&&clearTimeout(i.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),i.value}getByKey(t){const i=this.data[t];return i?i[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,i){if(!this.has(t))return this;const l=t.wrapped().key,h=i===void 0?0:this.data[l].indexOf(i),p=this.data[l][h];return this.data[l].splice(h,1),p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(p.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(t){const i=[];for(const l in this.data)for(const h of this.data[l])t(h.value)||i.push(h);for(const l of i)this.remove(l.value.tileID,l)}}class Wu{constructor(t,i,l){this.func=t,this.mask=i,this.range=l}}Wu.ReadOnly=!1,Wu.ReadWrite=!0,Wu.disabled=new Wu(519,Wu.ReadOnly,[0,1]);const a_=7680;class l_{constructor(t,i,l,h,p,v){this.test=t,this.ref=i,this.mask=l,this.fail=h,this.depthFail=p,this.pass=v}}l_.disabled=new l_({func:519,mask:0},0,0,a_,a_,a_);class As{constructor(t,i,l){this.blendFunction=t,this.blendColor=i,this.mask=l}}As.Replace=[1,0],As.disabled=new As(As.Replace,Ri.transparent,[!1,!1,!1,!1]),As.unblended=new As(As.Replace,Ri.transparent,[!0,!0,!0,!0]),As.alphaBlended=new As([1,771],Ri.transparent,[!0,!0,!0,!0]);const c_=1029,u_=2305;class es{constructor(t,i,l){this.enable=t,this.mode=i,this.frontFace=l}}es.disabled=new es(!1,c_,u_),es.backCCW=new es(!0,c_,u_),es.backCW=new es(!0,c_,2304),es.frontCW=new es(!0,1028,2304),es.frontCCW=new es(!0,1028,u_);class hc extends Uo{constructor(t,i,l){super(),this.id=t,this._onlySymbols=l,i.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new hk(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new uk,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const i=this._tiles[t];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,i){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,i)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const l=this._tiles[i];l.upload(t),l.prepare(this.map.style.imageManager)}}getIds(){return Gt(this._tiles).map(t=>t.tileID).sort(m1).map(t=>t.key)}getRenderableIds(t){const i=[];for(const l in this._tiles)this._isIdRenderable(+l,t)&&i.push(this._tiles[l]);return t?i.sort((l,h)=>{const p=l.tileID,v=h.tileID,x=new Y(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),E=new Y(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-v.overscaledZ||E.y-x.y||E.x-x.x}).map(l=>l.tileID.key):i.map(l=>l.tileID).sort(m1).map(l=>l.key)}hasRenderableParent(t){const i=this.findLoadedParent(t,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(t,i){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(i||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,i){const l=this._tiles[t];l&&(l.state!=="loading"&&(l.state=i),this._loadTile(l,this._tileLoaded.bind(this,l,t,i)))}_tileLoaded(t,i,l,h){if(h)if(t.state="errored",h.status!==404)this._source.fire(new ds(h,{tile:t}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const p=this.map.painter.terrain;this.update(this.transform,p.getScaledDemTileSize(),!0),p.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=qn.now(),l==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(i,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new ti("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const i=this.getRenderableIds();for(let h=0;h<i.length;h++){const p=i[h];if(t.neighboringTiles&&t.neighboringTiles[p]){const v=this.getTileByID(p);l(t,v),l(v,t)}}function l(h,p){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let v=p.tileID.canonical.x-h.tileID.canonical.x;const x=p.tileID.canonical.y-h.tileID.canonical.y,E=Math.pow(2,h.tileID.canonical.z),T=p.tileID.key;v===0&&x===0||Math.abs(x)>1||(Math.abs(v)>1&&(Math.abs(v+E)===1?v+=E:Math.abs(v-E)===1&&(v-=E)),p.dem&&h.dem&&(h.dem.backfillBorder(p.dem,v,x),h.neighboringTiles&&h.neighboringTiles[T]&&(h.neighboringTiles[T].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,i,l,h){for(const p in this._tiles){let v=this._tiles[p];if(h[p]||!v.hasData()||v.tileID.overscaledZ<=i||v.tileID.overscaledZ>l)continue;let x=v.tileID;for(;v&&v.tileID.overscaledZ>i+1;){const T=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[T.key],v&&v.hasData()&&(x=T)}let E=x;for(;E.overscaledZ>i;)if(E=E.scaledTo(E.overscaledZ-1),t[E.key]){h[x.key]=x;break}}}findLoadedParent(t,i){if(t.key in this._loadedParentTiles){const l=this._loadedParentTiles[t.key];return l&&l.tileID.overscaledZ>=i?l:null}for(let l=t.overscaledZ-1;l>=i;l--){const h=t.scaledTo(l),p=this._getLoadedTile(h);if(p)return p}}_getLoadedTile(t){const i=this._tiles[t.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,i){i=i||this._source.tileSize;const l=Math.ceil(t.width/i)+1,h=Math.ceil(t.height/i)+1,p=Math.floor(l*h*5),v=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,p):p,x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(x)}handleWrapJump(t){const i=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,i){const l={};for(const h in this._tiles){const p=this._tiles[h];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+i),l[p.tileID.key]=p}this._tiles=l;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(t,i,l){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!l)return;let h;this.updateCacheSize(t,i),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(x=>new Vr(x.canonical.z,x.wrap,x.canonical.z,x.canonical.x,x.canonical.y)):(h=t.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!l,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(x=>this._source.hasTile(x)))):h=[];const p=this._updateRetainedTiles(h);if(g1(this._source.type)&&h.length!==0){const x={},E={},T=Object.keys(p);for(const P of T){const D=p[P],V=this._tiles[P];if(!V||V.fadeEndTime&&V.fadeEndTime<=qn.now())continue;const N=this.findLoadedParent(D,Math.max(D.overscaledZ-hc.maxOverzooming,this._source.minzoom));N&&(this._addTile(N.tileID),x[N.tileID.key]=N.tileID),E[P]=D}const k=h[h.length-1].overscaledZ;for(const P in this._tiles){const D=this._tiles[P];if(p[P]||!D.hasData())continue;let V=D.tileID;for(;V.overscaledZ>k;){V=V.scaledTo(V.overscaledZ-1);const N=this._tiles[V.key];if(N&&N.hasData()&&E[V.key]){p[P]=D.tileID;break}}}for(const P in x)p[P]||(this._coveredTiles[P]=!0,p[P]=x[P])}for(const x in p)this._tiles[x].clearFadeHold();const v=function(x,E){const T=[];for(const k in x)k in E||T.push(k);return T}(this._tiles,p);for(const x of v){const E=this._tiles[x];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(+x)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const i={};if(t.length===0)return i;const l={},h=t.reduce((T,k)=>Math.min(T,k.overscaledZ),1/0),p=t[0].overscaledZ,v=Math.max(p-hc.maxOverzooming,this._source.minzoom),x=Math.max(p+hc.maxUnderzooming,this._source.minzoom),E={};for(const T of t){const k=this._addTile(T);i[T.key]=T,k.hasData()||h<this._source.maxzoom&&(E[T.key]=T)}this._retainLoadedChildren(E,h,x,i);for(const T of t){let k=this._tiles[T.key];if(k.hasData())continue;if(T.canonical.z>=this._source.maxzoom){const D=T.children(this._source.maxzoom)[0],V=this.getTile(D);if(V&&V.hasData()){i[D.key]=D;continue}}else{const D=T.children(this._source.maxzoom);if(i[D[0].key]&&i[D[1].key]&&i[D[2].key]&&i[D[3].key])continue}let P=k.wasRequested();for(let D=T.overscaledZ-1;D>=v;--D){const V=T.scaledTo(D);if(l[V.key]||(l[V.key]=!0,k=this.getTile(V),!k&&P&&(k=this._addTile(V)),k&&(i[V.key]=V,P=k.wasRequested(),k.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const i=[];let l,h=this._tiles[t].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){l=this._loadedParentTiles[h.key];break}i.push(h.key);const p=h.scaledTo(h.overscaledZ-1);if(l=this._getLoadedTile(p),l)break;h=p}for(const p of i)this._loadedParentTiles[p]=l}}_addTile(t){let i=this._tiles[t.key];if(i)return i;i=this._cache.getAndRemove(t),i&&(this._setTileReloadTimer(t.key,i),i.tileID=t,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,i)));const l=Boolean(i);if(!l){const h=this.map?this.map.painter:null;i=new s_(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,h,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,t.key,i.state))}return i?(i.uses++,this._tiles[t.key]=i,l||this._source.fire(new ti("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(t,i){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const l=i.getExpiryTimeout();l&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},l))}_removeTile(t){const i=this._tiles[t];i&&(i.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,i,l){const h=[],p=this.transform;if(!p)return h;const v=p.projection.name==="globe",x=Es(p.center.lng);for(const E in this._tiles){const T=this._tiles[E];if(l&&T.clearQueryDebugViz(),T.holdingForFade())continue;let k;if(v){const P=T.tileID.canonical;if(P.z===0){const D=[Math.abs(nt(x,...Zd(P,-1))-x),Math.abs(nt(x,...Zd(P,1))-x)];k=[0,2*D.indexOf(Math.min(...D))-1]}else{const D=[Math.abs(nt(x,...Zd(P,-1))-x),Math.abs(nt(x,...Zd(P,0))-x),Math.abs(nt(x,...Zd(P,1))-x)];k=[D.indexOf(Math.min(...D))-1]}}else k=[0];for(const P of k){const D=t.containsTile(T,p,i,P);D&&h.push(D)}}return h}getVisibleCoordinates(t){const i=this.getRenderableIds(t).map(l=>this._tiles[l].tileID);for(const l of i)l.projMatrix=this.transform.calculateProjMatrix(l.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(g1(this._source.type))for(const t in this._tiles){const i=this._tiles[t];if(i.fadeEndTime!==void 0&&i.fadeEndTime>=qn.now())return!0}return!1}setFeatureState(t,i,l){this._state.updateState(t=t||"_geojsonTileLayer",i,l)}removeFeatureState(t,i,l){this._state.removeFeatureState(t=t||"_geojsonTileLayer",i,l)}getFeatureState(t,i){return this._state.getState(t=t||"_geojsonTileLayer",i)}setDependencies(t,i,l){const h=this._tiles[t];h&&h.setDependencies(i,l)}reloadTilesForDependencies(t,i){for(const l in this._tiles)this._tiles[l].hasDependency(t,i)&&this._reloadTile(+l,"reloading");this._cache.filter(l=>!l.hasDependency(t,i))}_preloadTiles(t,i){const l=new Map,h=Array.isArray(t)?t:[t],p=this.map.painter.terrain,v=this.usedForTerrain&&p?p.getScaledDemTileSize():this._source.tileSize;for(const x of h){const E=x.coveringTiles({tileSize:v,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const T of E)l.set(T.key,T);this.usedForTerrain&&x.updateElevation(!1)}at(Array.from(l.values()),(x,E)=>{const T=new s_(x,this._source.tileSize*x.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(T,k=>{this._source.type==="raster-dem"&&T.dem&&this._backfillDEM(T),E(k,T)})},i)}}function m1(n,t){const i=Math.abs(2*n.wrap)-+(n.wrap<0),l=Math.abs(2*t.wrap)-+(t.wrap<0);return n.overscaledZ-t.overscaledZ||l-i||t.canonical.y-n.canonical.y||t.canonical.x-n.canonical.x}function g1(n){return n==="raster"||n==="image"||n==="video"||n==="custom"}function Zd(n,t){const i=1<<n.z;return[n.x/i+t,(n.x+1)/i+t]}hc.maxOverzooming=10,hc.maxUnderzooming=3;class Dm{constructor(t,i,l){this._demTile=t,this._dem=this._demTile.dem,this._scale=i,this._offset=l}static create(t,i,l){const h=l||t.findDEMTileFor(i);if(!h||!h.dem)return;const p=h.dem,v=h.tileID,x=1<<i.canonical.z-v.canonical.z;return new Dm(h,h.tileSize/hn/x,[(i.canonical.x/x-v.canonical.x)*p.dim,(i.canonical.y/x-v.canonical.y)*p.dim])}tileCoordToPixel(t,i){const l=i*this._scale+this._offset[1],h=Math.floor(t*this._scale+this._offset[0]),p=Math.floor(l);return new Y(h,p)}getElevationAt(t,i,l,h){const p=t*this._scale+this._offset[0],v=i*this._scale+this._offset[1],x=Math.floor(p),E=Math.floor(v),T=this._dem;return h=!!h,l?Vn(Vn(T.get(x,E,h),T.get(x,E+1,h),v-E),Vn(T.get(x+1,E,h),T.get(x+1,E+1,h),v-E),p-x):T.get(x,E,h)}getElevationAtPixel(t,i,l){return this._dem.get(t,i,!!l)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*Qo(1,t)*this._dem.stride}}class v1{constructor(t,i){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Wa(hn,16,0),this.featureIndexArray=new ax,this.promoteId=i}insert(t,i,l,h,p,v=0){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,h,p,v);const E=this.grid;for(let T=0;T<i.length;T++){const k=i[T],P=[1/0,1/0,-1/0,-1/0];for(let D=0;D<k.length;D++){const V=k[D];P[0]=Math.min(P[0],V.x),P[1]=Math.min(P[1],V.y),P[2]=Math.max(P[2],V.x),P[3]=Math.max(P[3],V.y)}P[0]<hn&&P[1]<hn&&P[2]>=0&&P[3]>=0&&E.insert(x,P[0],P[1],P[2],P[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new qv(new Fd(this.rawTileData)).layers,this.sourceLayerCoder=new n1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,i,l,h){this.loadVTLayers();const p=t.params||{},v=_u(p.filter),x=t.tileResult,E=t.transform,T=x.bufferedTilespaceBounds,k=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,(N,G,X,le)=>qx(x.bufferedTilespaceGeometry,N,G,X,le));k.sort(dk);let P=null;E.elevation&&k.length>0&&(P=Dm.create(E.elevation,this.tileID));const D={};let V;for(let N=0;N<k.length;N++){const G=k[N];if(G===V)continue;V=G;const X=this.featureIndexArray.get(G);let le=null;this.loadMatchingFeature(D,X,v,p.layers,p.availableImages,i,l,h,(ye,re,ge,Te=0)=>(le||(le=oa(ye,this.tileID.canonical,t.tileTransform)),re.queryIntersectsFeature(x,ye,ge,le,this.z,t.transform,t.pixelPosMatrix,P,Te)))}return D}loadMatchingFeature(t,i,l,h,p,v,x,E,T){const{featureIndex:k,bucketIndex:P,sourceLayerIndex:D,layoutVertexArrayOffset:V}=i,N=this.bucketLayerIDs[P];if(h&&!function(ye,re){for(let ge=0;ge<ye.length;ge++)if(re.indexOf(ye[ge])>=0)return!0;return!1}(h,N))return;const G=this.sourceLayerCoder.decode(D),X=this.vtLayers[G].feature(k);if(l.needGeometry){const ye=ac(X,!0);if(!l.filter(new Be(this.tileID.overscaledZ),ye,this.tileID.canonical))return}else if(!l.filter(new Be(this.tileID.overscaledZ),X))return;const le=this.getId(X,G);for(let ye=0;ye<N.length;ye++){const re=N[ye];if(h&&h.indexOf(re)<0)continue;const ge=v[re];if(!ge)continue;let Te={};le!==void 0&&E&&(Te=E.getState(ge.sourceLayer||"_geojsonTileLayer",le));const xe=pt({},x[re]);xe.paint=_1(xe.paint,ge.paint,X,Te,p),xe.layout=_1(xe.layout,ge.layout,X,Te,p);const je=!T||T(X,ge,Te,V);if(!je)continue;const Ne=new i1(X,this.z,this.x,this.y,le);Ne.layer=xe;let tt=t[re];tt===void 0&&(tt=t[re]=[]),tt.push({featureIndex:k,feature:Ne,intersectionZ:je})}}lookupSymbolFeatures(t,i,l,h,p,v,x,E){const T={};this.loadVTLayers();const k=_u(p);for(const P of t)this.loadMatchingFeature(T,{bucketIndex:l,sourceLayerIndex:h,featureIndex:P,layoutVertexArrayOffset:0},k,v,x,E,i);return T}loadFeature(t){const{featureIndex:i,sourceLayerIndex:l}=t;this.loadVTLayers();const h=this.sourceLayerCoder.decode(l),p=this.vtFeatures[h];if(p[i])return p[i];const v=this.vtLayers[h].feature(i);return p[i]=v,v}hasLayer(t){for(const i of this.bucketLayerIDs)for(const l of i)if(t===l)return!0;return!1}getId(t,i){let l=t.id;if(this.promoteId){const h=typeof this.promoteId=="string"?this.promoteId:this.promoteId[i];h!=null&&(l=t.properties[h]),typeof l=="boolean"&&(l=Number(l))}return l}}function _1(n,t,i,l,h){return Ut(n,(p,v)=>{const x=t instanceof Ue?t.get(v):null;return x&&x.evaluate?x.evaluate(i,l,h):x})}function dk(n,t){return t-n}$t(v1,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class y1{constructor(t,i){this.width=t,this.height=i,this.nextRow=0,this.image=new sa({width:t,height:i}),this.positions={},this.uploaded=!1}getDash(t,i){const l=this.getKey(t,i);return this.positions[l]}trim(){const t=this.width,i=this.height=kt(this.nextRow);this.image.resize({width:t,height:i})}getKey(t,i){return t.join(",")+i}getDashRanges(t,i,l){const h=[];let p=t.length%2==1?-t[t.length-1]*l:0,v=t[0]*l,x=!0;h.push({left:p,right:v,isDash:x,zeroLength:t[0]===0});let E=t[0];for(let T=1;T<t.length;T++){x=!x;const k=t[T];p=E*l,E+=k,v=E*l,h.push({left:p,right:v,isDash:x,zeroLength:k===0})}return h}addRoundDash(t,i,l){const h=i/2;for(let p=-l;p<=l;p++){const v=this.width*(this.nextRow+l+p);let x=0,E=t[x];for(let T=0;T<this.width;T++){T/E.right>1&&(E=t[++x]);const k=Math.abs(T-E.left),P=Math.abs(T-E.right),D=Math.min(k,P);let V;const N=p/l*(h+1);if(E.isDash){const G=h-Math.abs(N);V=Math.sqrt(D*D+G*G)}else V=h-Math.sqrt(D*D+N*N);this.image.data[v+T]=Math.max(0,Math.min(255,V+128))}}}addRegularDash(t,i){for(let E=t.length-1;E>=0;--E){const T=t[E],k=t[E+1];T.zeroLength?t.splice(E,1):k&&k.isDash===T.isDash&&(k.left=T.left,t.splice(E,1))}const l=t[0],h=t[t.length-1];l.isDash===h.isDash&&(l.left=h.left-this.width,h.right=l.right+this.width);const p=this.width*this.nextRow;let v=0,x=t[v];for(let E=0;E<this.width;E++){E/x.right>1&&(x=t[++v]);const T=Math.abs(E-x.left),k=Math.abs(E-x.right),P=Math.min(T,k);this.image.data[p+E]=Math.max(0,Math.min(255,(x.isDash?P:-P)+i+128))}}addDash(t,i){const l=this.getKey(t,i);if(this.positions[l])return this.positions[l];const h=i==="round",p=h?7:0,v=2*p+1;if(this.nextRow+v>this.height)return he("LineAtlas out of space"),null;t.length===0&&t.push(1);let x=0;for(let k=0;k<t.length;k++)t[k]<0&&(he("Negative value is found in line dasharray, replacing values with 0"),t[k]=0),x+=t[k];if(x!==0){const k=this.width/x,P=this.getDashRanges(t,this.width,k);h?this.addRoundDash(P,k,p):this.addRegularDash(P,i==="square"?.5*k:0)}const E=this.nextRow+p;this.nextRow+=v;const T={tl:[E,p],br:[x,0]};return this.positions[l]=T,T}}$t(y1,"LineAtlas");class x1{constructor(t){const i={},l=[];for(const x in t){const E=t[x],T=i[x]={};for(const k in E.glyphs){const P=E.glyphs[+k];if(!P||P.bitmap.width===0||P.bitmap.height===0)continue;const D=P.metrics.localGlyph?2:1,V={x:0,y:0,w:P.bitmap.width+2*D,h:P.bitmap.height+2*D};l.push(V),T[k]=V}}const{w:h,h:p}=Hv(l),v=new sa({width:h||1,height:p||1});for(const x in t){const E=t[x];for(const T in E.glyphs){const k=E.glyphs[+T];if(!k||k.bitmap.width===0||k.bitmap.height===0)continue;const P=i[x][T],D=k.metrics.localGlyph?2:1;sa.copy(k.bitmap,v,{x:0,y:0},{x:P.x+D,y:P.y+D},k.bitmap)}}this.image=v,this.positions=i}}$t(x1,"GlyphAtlas");class fk{constructor(t){this.tileID=new Vr(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile,this.tileTransform=uc(t.tileID.canonical,t.projection),this.projection=t.projection}parse(t,i,l,h,p){this.status="parsing",this.data=t,this.collisionBoxArray=new fv;const v=new n1(Object.keys(t.layers).sort()),x=new v1(this.tileID,this.promoteId);x.bucketLayerIDs=[];const E={},T=new y1(256,256),k={featureIndex:x,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:T,availableImages:l},P=i.familiesBySource[this.source];for(const Te in P){const xe=t.layers[Te];if(!xe)continue;let je=!1,Ne=!1;for(const We of P[Te])We[0].type==="symbol"?je=!0:Ne=!0;if(this.isSymbolTile===!0&&!je||this.isSymbolTile===!1&&!Ne)continue;xe.version===1&&he(`Vector tile source "${this.source}" layer "${Te}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const tt=v.encode(Te),vt=[];for(let We=0;We<xe.length;We++){const it=xe.feature(We),ot=x.getId(it,Te);vt.push({feature:it,id:ot,index:We,sourceLayerIndex:tt})}for(const We of P[Te]){const it=We[0];this.isSymbolTile!==void 0&&it.type==="symbol"!==this.isSymbolTile||it.minzoom&&this.zoom<Math.floor(it.minzoom)||it.maxzoom&&this.zoom>=it.maxzoom||it.visibility!=="none"&&(h_(We,this.zoom,l),(E[it.id]=it.createBucket({index:x.bucketLayerIDs.length,layers:We,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:tt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:l})).populate(vt,k,this.tileID.canonical,this.tileTransform),x.bucketLayerIDs.push(We.map(ot=>ot.id)))}}let D,V,N,G;T.trim();const X={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},le=Ut(k.glyphDependencies,Te=>Object.keys(Te).map(Number));Object.keys(le).length?h.send("getGlyphs",{uid:this.uid,stacks:le},(Te,xe)=>{D||(D=Te,V=xe,ge.call(this))},void 0,!1,X):V={};const ye=Object.keys(k.iconDependencies);ye.length?h.send("getImages",{icons:ye,source:this.source,tileID:this.tileID,type:"icons"},(Te,xe)=>{D||(D=Te,N=xe,ge.call(this))},void 0,!1,X):N={};const re=Object.keys(k.patternDependencies);function ge(){if(D)return p(D);if(V&&N&&G){const Te=new x1(V),xe=new kb(N,G);for(const je in E){const Ne=E[je];Ne instanceof nl?(h_(Ne.layers,this.zoom,l),$A(Ne,V,Te.positions,N,xe.iconPositions,this.showCollisionBoxes,l,this.tileID.canonical,this.tileZoom,this.projection)):Ne.hasPattern&&(Ne instanceof _m||Ne instanceof fm||Ne instanceof Dd)&&(h_(Ne.layers,this.zoom,l),Ne.addFeatures(k,this.tileID.canonical,xe.patternPositions,l,this.tileTransform))}this.status="done",p(null,{buckets:Gt(E).filter(je=>!je.isEmpty()),featureIndex:x,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Te.image,lineAtlas:T,imageAtlas:xe,glyphMap:this.returnDependencies?V:null,iconMap:this.returnDependencies?N:null,glyphPositions:this.returnDependencies?Te.positions:null})}}re.length?h.send("getImages",{icons:re,source:this.source,tileID:this.tileID,type:"patterns"},(Te,xe)=>{D||(D=Te,G=xe,ge.call(this))},void 0,!1,X):G={},ge.call(this)}}function h_(n,t,i){const l=new Be(t);for(const h of n)h.recalculate(l,i)}class b1{constructor(t){this.entries={},this.scheduler=t}request(t,i,l,h){const p=this.entries[t]=this.entries[t]||{callbacks:[]};if(p.result){const[v,x]=p.result;return this.scheduler?this.scheduler.add(()=>{h(v,x)},i):h(v,x),()=>{}}return p.callbacks.push(h),p.cancel||(p.cancel=l((v,x)=>{p.result=[v,x];for(const E of p.callbacks)this.scheduler?this.scheduler.add(()=>{E(v,x)},i):E(v,x);setTimeout(()=>delete this.entries[t],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(v=>v!==h),p.callbacks.length||(p.cancel(),delete this.entries[t]))}}}function w1(n,t,i){const l=JSON.stringify(n.request);return n.data&&(this.deduped.entries[l]={result:[null,n.data]}),this.deduped.request(l,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom},h=>{const p=yo(n.request,(v,x,E,T)=>{v?h(v):x&&h(null,{vectorTile:i?void 0:new qv(new Fd(x)),rawData:x,cacheControl:E,expires:T})});return()=>{p.cancel(),h()}},t)}s.ARRAY_TYPE=Qr,s.AUTH_ERR_MSG=Gs,s.Aabb=Fr,s.Actor=class{constructor(n,t,i){this.target=n,this.parent=t,this.mapId=i,this.callbacks={},this.cancelCallbacks={},bt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=st()?n:w,this.scheduler=new lk}send(n,t,i,l,h=!1,p){const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=p,this.callbacks[v]=i);const x=Nt(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:n,hasCallback:!!i,targetMapId:l,mustQueue:h,sourceMapId:this.mapId,data:Xl(t,x)},x),{cancel:()=>{i&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}receive(n){const t=n.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){const l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l.cancel()}else if(t.mustQueue||st()){const l=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,t),l&&l.metadata||{type:"message"})}else this.processTask(i,t)}processTask(n,t){if(t.type==="<response>"){const i=this.callbacks[n];delete this.callbacks[n],i&&(t.error?i(Yl(t.error)):i(null,Yl(t.data)))}else{const i=Nt(this.globalScope)?void 0:[],l=t.hasCallback?(p,v)=>{delete this.cancelCallbacks[n],this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:p?Xl(p):null,data:Xl(v,i)},i)}:p=>{},h=Yl(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,h,l);else if(this.parent.getWorkerSource){const p=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,p[0],h.source)[p[1]](h,l)}else l(new Error(`Could not find function ${t.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=vm,s.Color=Ri,s.ColorMode=As,s.CullFaceMode=es,s.DEMData=Lm,s.DataConstantProperty=Le,s.DedupedRequest=b1,s.DepthMode=Wu,s.EXTENT=hn,s.Elevation=class{isDataAvailableAtPoint(n){const t=this._source();if(this.isUsingMockSource()||!t||n.y<0||n.y>1)return!1;const i=t.getSource().maxzoom,l=1<<i,h=Math.floor(n.x),p=Math.floor((n.x-h)*l),v=Math.floor(n.y*l),x=this.findDEMTileFor(new Vr(i,h,i,p,v));return!(!x||!x.dem)}getAtPointOrZero(n,t=0){return this.getAtPoint(n,t)||0}getAtPoint(n,t,i=!0){if(this.isUsingMockSource())return null;t==null&&(t=null);const l=this._source();if(!l||n.y<0||n.y>1)return t;const h=l.getSource().maxzoom,p=1<<h,v=Math.floor(n.x),x=n.x-v,E=new Vr(h,v,h,Math.floor(x*p),Math.floor(n.y*p)),T=this.findDEMTileFor(E);if(!T||!T.dem)return t;const k=T.dem,P=1<<T.tileID.canonical.z,D=(x*P-T.tileID.canonical.x)*k.dim,V=(n.y*P-T.tileID.canonical.y)*k.dim,N=Math.floor(D),G=Math.floor(V);return(i?this.exaggeration():1)*Vn(Vn(k.get(N,G),k.get(N,G+1),V-G),Vn(k.get(N+1,G),k.get(N+1,G+1),V-G),D-N)}getAtTileOffset(n,t,i){const l=1<<n.canonical.z;return this.getAtPointOrZero(new Du(n.wrap+(n.canonical.x+t/hn)/l,(n.canonical.y+i/hn)/l))}getAtTileOffsetFunc(n,t,i,l){return h=>{const p=this.getAtTileOffset(n,h.x,h.y),v=l.upVector(n.canonical,h.x,h.y);return co(v,v,p*l.upVectorScale(n.canonical,t,i).metersToTile),v}}getForTilePoints(n,t,i,l){if(this.isUsingMockSource())return!1;const h=Dm.create(this,n,l);return!!h&&(t.forEach(p=>{p[2]=this.exaggeration()*h.getElevationAt(p[0],p[1],i)}),!0)}getMinMaxForTile(n){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(n);if(!t||!t.dem)return null;const i=t.dem.tree,l=t.tileID,h=1<<n.canonical.z-l.canonical.z;let p=n.canonical.x/h-l.canonical.x,v=n.canonical.y/h-l.canonical.y,x=0;for(let E=0;E<n.canonical.z-l.canonical.z&&!i.leaves[x];E++){p*=2,v*=2;const T=2*Math.floor(v)+Math.floor(p);x=i.childOffsets[x]+T,p%=1,v%=1}return{min:this.exaggeration()*i.minimums[x],max:this.exaggeration()*i.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(n,t,i){throw new Error("Pure virtual method called.")}pointCoordinate(n){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(n){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=ds,s.EvaluationParameters=Be,s.Event=ti,s.Evented=Uo,s.FillExtrusionBucket=Dd,s.Frustum=Tv,s.FrustumCorners=Sv,s.GLOBE_RADIUS=bs,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=6,s.GLOBE_ZOOM_THRESHOLD_MIN=5,s.GlobeSharedBuffers=class{constructor(n){this._createGrid(n),this._createPoles(n)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const n of this._poleSegments)n.destroy();for(const n of this._gridSegments)n.withSkirts.destroy(),n.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const n of this._wireframeSegments)n.destroy()}}_fillGridMeshWithLods(n,t){const i=new en,l=new br,h=[],p=n+1+2,v=t[0]+1,x=t[0]+1+(1+t.length),E=(T,k,P)=>{let D=T===p-1?T-2:T===0?T:T-1;return D+=P?24575:0,[D,k]};for(let T=0;T<p;++T)i.emplaceBack(...E(T,0,!0));for(let T=0;T<v;++T)for(let k=0;k<p;++k)i.emplaceBack(...E(k,T,(k===0||k===p-1)&&!0));for(let T=0;T<t.length;++T){const k=t[T];for(let P=0;P<p;++P)i.emplaceBack(...E(P,k,!0))}for(let T=0;T<t.length;++T){const k=l.length,P=t[T]+1+2,D=new br;for(let G=0;G<P-1;G++){const X=G===P-2,le=X?p*(x-t.length+T-G):p;for(let ye=0;ye<p-1;ye++){const re=G*p+ye;G===0||X||ye===0||ye===p-2?(D.emplaceBack(re+1,re,re+le),D.emplaceBack(re+le,re+le+1,re+1)):(l.emplaceBack(re+1,re,re+le),l.emplaceBack(re+le,re+le+1,re+1))}}const V=$i.simpleSegment(0,k,i.length,l.length-k);for(let G=0;G<D.uint16.length;G+=3)l.emplaceBack(D.uint16[G],D.uint16[G+1],D.uint16[G+2]);const N=$i.simpleSegment(0,k,i.length,l.length-k);h.push({withoutSkirts:V,withSkirts:N})}return{vertices:i,indices:l,segments:h}}_createGrid(n){const t=this._fillGridMeshWithLods(oc,Sd);this._gridSegments=t.segments,this._gridBuffer=n.createVertexBuffer(t.vertices,Ed.members),this._gridIndexBuffer=n.createIndexBuffer(t.indices,!0)}_createPoles(n){const t=new br;for(let h=0;h<=oc;h++)t.emplaceBack(0,h+1,h+2);this._poleIndexBuffer=n.createIndexBuffer(t,!0);const i=new Jr,l=new Jr;this._poleSegments=[];for(let h=0,p=0;h<5;h++){const v=360/(1<<h);i.emplaceBack(0,-bs,0,.5,0),l.emplaceBack(0,-bs,0,.5,1);for(let x=0;x<=oc;x++){const E=x/oc,T=Vn(0,v,E),[k,P,D]=Pu(lI,cI,T,bs);i.emplaceBack(k,P,D,E,0),l.emplaceBack(k,P,D,E,1)}this._poleSegments.push($i.simpleSegment(p,0,66,64)),p+=66}this._poleNorthVertexBuffer=n.createVertexBuffer(i,Ix,!1),this._poleSouthVertexBuffer=n.createVertexBuffer(l,Ix,!1)}getGridBuffers(n,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[n].withSkirts:this._gridSegments[n].withoutSkirts]}getPoleBuffers(n){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[n]]}getWirefameBuffers(n,t){if(!this._wireframeSegments){const i=new ys,l=oc,h=l+1+2,p=1;this._wireframeSegments=[];for(let v=0,x=0;v<Sd.length;v++){const E=Sd[v];for(let k=p;k<E+p;k++)for(let P=p;P<l+p;P++){const D=k*h+P;i.emplaceBack(D,D+1),i.emplaceBack(D,D+h),i.emplaceBack(D,D+h+1)}const T=E*l*3;this._wireframeSegments.push($i.simpleSegment(0,x,(E+1)*h,T)),x+=T}this._wireframeIndexBuffer=n.createIndexBuffer(i)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[t]]}},s.GlyphManager=Gu,s.ImagePosition=Xv,s.LivePerformanceUtils=ut,s.LngLat=Nn,s.LngLatBounds=Qa,s.LocalGlyphMode=Jv,s.MAX_MERCATOR_LATITUDE=Er,s.MercatorCoordinate=Du,s.ONE_EM=Sr,s.OverscaledTileID=Vr,s.PerformanceMarkers=Ve,s.Properties=mt,s.RGBAImage=eo,s.Ray=Ev,s.RequestManager=class{constructor(n,t,i){this._transformRequestFn=n,this._customAccessToken=t,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const n=function(){let t="";for(let i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ce,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,t){return this._transformRequestFn&&this._transformRequestFn(n,t)||{url:n}}normalizeStyleURL(n,t){if(!ao(n))return n;const i=Zr(n);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeGlyphsURL(n,t){if(!ao(n))return n;const i=Zr(n);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeSourceURL(n,t,i,l){if(!ao(n))return n;const h=Zr(n);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),i&&h.params.push(`language=${i}`),l&&h.params.push(`worldview=${l}`),this._makeAPIURL(h,this._customAccessToken||t)}normalizeSpriteURL(n,t,i,l){const h=Zr(n);return ao(n)?(h.path=`/styles/v1${h.path}/sprite${t}${i}`,this._makeAPIURL(h,this._customAccessToken||l)):(h.path+=`${t}${i}`,hs(h))}normalizeTileURL(n,t,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!ao(n))return n;const l=Zr(n);l.path=l.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${t||i&&l.authority!=="raster"&&i===512?"@2x":""}${L.supported?".webp":"$1"}`),l.authority==="raster"?l.path=`/${z.RASTER_URL_PREFIX}${l.path}`:(l.path=l.path.replace(/^.+\/v4\//,"/"),l.path=`/${z.TILE_URL_VERSION}${l.path}`);const h=this._customAccessToken||function(p){for(const v of p){const x=v.match(/^access_token=(.*)$/);if(x)return x[1]}return null}(l.params)||z.ACCESS_TOKEN;return z.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&l.params.push(`sku=${this._skuToken}`),this._makeAPIURL(l,h)}canonicalizeTileURL(n,t){const i=Zr(n);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return n;let l="mapbox://";i.path.match(/^\/raster\/v1\//)?l+=`raster/${i.path.replace(`/${z.RASTER_URL_PREFIX}/`,"")}`:l+=`tiles/${i.path.replace(`/${z.TILE_URL_VERSION}/`,"")}`;let h=i.params;return t&&(h=h.filter(p=>!p.match(/^access_token=/))),h.length&&(l+=`?${h.join("&")}`),l}canonicalizeTileset(n,t){const i=!!t&&ao(t),l=[];for(const h of n.tiles||[])qs(h)?l.push(this.canonicalizeTileURL(h,i)):l.push(h);return l}_makeAPIURL(n,t){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",l=Zr(z.API_URL);if(n.protocol=l.protocol,n.authority=l.authority,n.protocol==="http"){const h=n.params.indexOf("secure");h>=0&&n.params.splice(h,1)}if(l.path!=="/"&&(n.path=`${l.path}${n.path}`),!z.REQUIRE_ACCESS_TOKEN)return hs(n);if(t=t||z.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(t[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return n.params=n.params.filter(h=>h.indexOf("access_token")===-1),n.params.push(`access_token=${t||""}`),hs(n)}},s.ResourceType=rr,s.SegmentVector=$i,s.SourceCache=hc,s.StencilMode=l_,s.StructArrayLayout1ui2=xs,s.StructArrayLayout2f1f2i16=yr,s.StructArrayLayout2i4=en,s.StructArrayLayout2ui4=ys,s.StructArrayLayout3f12=xr,s.StructArrayLayout3ui6=br,s.StructArrayLayout4i8=ni,s.StructArrayLayout5f20=Jr,s.Texture=qd,s.Tile=s_,s.Transitionable=wt,s.Uniform1f=Qp,s.Uniform1i=class extends na{constructor(n){super(n),this.current=0}set(n,t,i){this.fetchUniformLocation(n,t)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},s.Uniform2f=class extends na{constructor(n){super(n),this.current=[0,0]}set(n,t,i){this.fetchUniformLocation(n,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}},s.Uniform3f=class extends na{constructor(n){super(n),this.current=[0,0,0]}set(n,t,i){this.fetchUniformLocation(n,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}},s.Uniform4f=hx,s.UniformColor=dx,s.UniformMatrix2f=class extends na{constructor(n){super(n),this.current=WC}set(n,t,i){if(this.fetchUniformLocation(n,t)){for(let l=0;l<4;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}}},s.UniformMatrix3f=class extends na{constructor(n){super(n),this.current=ZC}set(n,t,i){if(this.fetchUniformLocation(n,t)){for(let l=0;l<9;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}},s.UniformMatrix4f=class extends na{constructor(n){super(n),this.current=qC}set(n,t,i){if(this.fetchUniformLocation(n,t)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}},s.UnwrappedTileID=gb,s.ValidationError=Ot,s.VectorTileFeature=mm,s.VectorTileWorkerSource=class extends Uo{constructor(n,t,i,l,h){super(),this.actor=n,this.layerIndex=t,this.availableImages=i,this.loadVectorData=h||w1,this.loading={},this.loaded={},this.deduped=new b1(n.scheduler),this.isSpriteLoaded=l,this.scheduler=n.scheduler}loadTile(n,t){const i=n.uid,l=n&&n.request,h=l&&l.collectResourceTiming,p=this.loading[i]=new fk(n);p.abort=this.loadVectorData(n,(v,x)=>{const E=!this.loading[i];if(delete this.loading[i],E||v||!x)return p.status="done",E||(this.loaded[i]=p),t(v);const T=x.rawData,k={};x.expires&&(k.expires=x.expires),x.cacheControl&&(k.cacheControl=x.cacheControl),p.vectorTile=x.vectorTile||new qv(new Fd(T));const P=()=>{p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,(D,V)=>{if(D||!V)return t(D);const N={};if(h){const G=tn(l);G.length>0&&(N.resourceTiming=JSON.parse(JSON.stringify(G)))}t(null,pt({rawTileData:T.slice(0)},V,k,N))})};this.isSpriteLoaded?P():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(P,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):P()}),this.loaded=this.loaded||{},this.loaded[i]=p})}reloadTile(n,t){const i=this.loaded,l=n.uid,h=this;if(i&&i[l]){const p=i[l];p.showCollisionBoxes=n.showCollisionBoxes,p.enableTerrain=!!n.enableTerrain,p.projection=n.projection,p.tileTransform=uc(n.tileID.canonical,n.projection);const v=(x,E)=>{const T=p.reloadCallback;T&&(delete p.reloadCallback,p.parse(p.vectorTile,h.layerIndex,this.availableImages,h.actor,T)),t(x,E)};p.status==="parsing"?p.reloadCallback=v:p.status==="done"&&(p.vectorTile?p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,v):v())}}abortTile(n,t){const i=n.uid,l=this.loading[i];l&&(l.abort&&l.abort(),delete this.loading[i]),t()}removeTile(n,t){const i=this.loaded,l=n.uid;i&&i[l]&&delete i[l],t()}},s.WritingMode=ho,s.ZoomDependentExpression=ea,s.add=ra,s.addDynamicAttributes=Mm,s.adjoint=function(n,t){var i=t[0],l=t[1],h=t[2],p=t[3],v=t[4],x=t[5],E=t[6],T=t[7],k=t[8];return n[0]=v*k-x*T,n[1]=h*T-l*k,n[2]=l*x-h*v,n[3]=x*E-p*k,n[4]=i*k-h*E,n[5]=h*p-i*x,n[6]=p*T-v*E,n[7]=l*E-i*T,n[8]=i*v-l*p,n},s.asyncAll=at,s.bezier=Ke,s.bindAll=bt,s.boundsAttributes=o1,s.bufferConvexPolygon=function(n,t){const i=[];for(let l=0;l<n.length;l++){const h=Pe(l-1,-1,n.length-1),p=Pe(l+1,-1,n.length-1),v=n[l],x=n[p],E=n[h].sub(v).unit(),T=x.sub(v).unit(),k=T.angleWithSep(E.x,E.y),P=E.add(T).unit().mult(-1*t/Math.sin(k/2));i.push(v.add(P))}return i},s.cacheEntryPossiblyAdded=function(n){vi++,vi>fn&&(n.getActor().send("enforceCacheSizeLimit",on),vi=0)},s.calculateGlobeLabelMatrix=function(n,t){const{x:i,y:l}=n.point,h=Lx(i,l,n.worldSize/n._pixelsPerMercatorPixel,0,0);return nc(h,h,Av(ws(t)))},s.calculateGlobeMatrix=function(n){const{x:t,y:i}=n.point,{lng:l,lat:h}=n._center;return Lx(t,i,n.worldSize,l,h)},s.calculateGlobeMercatorMatrix=function(n){const t=n.pixelsPerMeter,i=t/Qo(1,n.center.lat),l=Ko(new Float64Array(16));return vd(l,l,[n.point.x,n.point.y,0]),ic(l,l,[i,i,t]),Float32Array.from(l)},s.circumferenceAtLatitude=Mv,s.clamp=nt,s.clearTileCache=function(n){if(!Tn())return;const t=w.caches.delete(Et);n&&t.catch(n).then(()=>n())},s.clipLine=$b,s.clone=function(n){var t=new Qr(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},s.clone$1=Dn,s.collisionCircleLayout=fA,s.config=z,s.conjugate=function(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=t[3],n},s.create=function(){var n=new Qr(16);return Qr!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},s.create$1=px,s.createExpression=ja,s.createLayout=Xt,s.createStyleLayer=function(n){return n.type==="custom"?new rk(n):new sk[n.type](n)},s.cross=wv,s.degToRad=Se,s.distance=function(n,t){return Math.hypot(t[0]-n[0],t[1]-n[1],t[2]-n[2])},s.div=function(n,t,i){return n[0]=t[0]/i[0],n[1]=t[1]/i[1],n[2]=t[2]/i[2],n},s.dot=So,s.earthRadius=Id,s.ease=ct,s.easeCubicInOut=ze,s.ecefToLatLng=function([n,t,i]){const l=Math.hypot(n,t,i),h=Math.atan2(n,i),p=.5*Math.PI-Math.acos(-t/l);return new Nn(be(h),be(p))},s.emitValidationErrors=Fp,s.endsWith=Tt,s.enforceCacheSizeLimit=function(n){jn(),Jt&&Jt.then(t=>{t.keys().then(i=>{for(let l=0;l<i.length-n;l++)t.delete(i[l])})})},s.evaluateSizeForFeature=ym,s.evaluateSizeForZoom=Nu,s.evaluateVariableOffset=Zb,s.evented=pe,s.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]},s.exactEquals$1=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]},s.exported=qn,s.exported$1=L,s.extend=pt,s.extend$1=jo,s.fillExtrusionHeightLift=fb,s.filterObject=pn,s.fromMat4=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[4],n[4]=t[5],n[5]=t[6],n[6]=t[8],n[7]=t[9],n[8]=t[10],n},s.fromQuat=function(n,t){var i=t[0],l=t[1],h=t[2],p=t[3],v=i+i,x=l+l,E=h+h,T=i*v,k=l*v,P=l*x,D=h*v,V=h*x,N=h*E,G=p*v,X=p*x,le=p*E;return n[0]=1-P-N,n[1]=k+le,n[2]=D-X,n[3]=0,n[4]=k-le,n[5]=1-T-N,n[6]=V+G,n[7]=0,n[8]=D+X,n[9]=V-G,n[10]=1-T-P,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},s.fromRotation=function(n,t){var i=Math.sin(t),l=Math.cos(t);return n[0]=l,n[1]=i,n[2]=0,n[3]=-i,n[4]=l,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},s.fromScaling=gx,s.furthestTileCorner=function(n){const t=Math.round((n+45+360)%360/90)%4;return De[t]},s.getAABBPointSquareDist=function(n,t,i){let l=0;for(let h=0;h<2;++h){const p=i?i[h]:0;n[h]>p&&(l+=(n[h]-p)*(n[h]-p)),t[h]<p&&(l+=(p-t[h])*(p-t[h]))}return l},s.getAnchorAlignment=Kv,s.getAnchorJustification=e_,s.getBounds=function(n){let t=1/0,i=1/0,l=-1/0,h=-1/0;for(const p of n)t=Math.min(t,p.x),i=Math.min(i,p.y),l=Math.max(l,p.x),h=Math.max(h,p.y);return{min:new Y(t,i),max:new Y(l,h)}},s.getColumn=Ft,s.getGridMatrix=function(n,t,i,l){const h=t.getNorth(),p=t.getSouth(),v=t.getWest(),x=t.getEast(),E=1<<n.z,T=x-v,k=h-p,P=T/oc,D=-k/Sd[i],V=[0,P,0,D,0,0,h,v,0];if(n.z>0){const N=180/l;mx(V,V,[N/T+1,0,0,0,N/k+1,0,-.5*N/P,.5*N/D,1])}return V[2]=E,V[5]=n.x,V[8]=n.y,V},s.getImage=El,s.getJSON=function(n,t){return zr(pt(n,{type:"json"}),t)},s.getLatitudinalLod=function(n){const t=Er-5;n=nt(n,-t,t)/t*90;const i=Math.pow(Math.abs(Math.sin(Se(n))),3);return Math.round(i*(Sd.length-1))},s.getMapSessionAPI=Re,s.getPerformanceMeasurement=tn,s.getProjection=e1,s.getRTLTextPluginStatus=Ce,s.getReferrer=us,s.getTilePoint=function(n,{x:t,y:i},l=0){return new Y(((t-l)*n.scale-n.x)*hn,(i*n.scale-n.y)*hn)},s.getTileVec3=function(n,t,i=0){return Mu(((t.x-i)*n.scale-n.x)*hn,(t.y*n.scale-n.y)*hn,Ox(t.z,t.y))},s.getVideo=function(n,t){const i=w.document.createElement("video");i.muted=!0,i.onloadstart=function(){t(null,i)};for(let l=0;l<n.length;l++){const h=w.document.createElement("source");tr(n[l])||(i.crossOrigin="Anonymous"),h.src=n[l],i.appendChild(h)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(n){const t=[0,0,0],i=Ko(new Float64Array(16));return nc(i,n.pixelMatrix,n.globeMatrix),Bi(t,t,i),new Y(t[0],t[1])},s.globeDenormalizeECEF=Av,s.globeECEFOrigin=function(n,t){const i=[0,0,0];return Bi(i,i,Cd(ws(t.canonical))),Bi(i,i,n),i},s.globeMetersToEcef=im,s.globeNormalizeECEF=Cd,s.globePixelsToTileUnits=function(n,t){return hn/(512*Math.pow(2,n))*om(ws(t))},s.globePoleMatrixForTile=function(n,t,i){const l=Ko(new Float64Array(16)),h=(t/(1<<n)-.5)*Math.PI*2;return nm(l,i.globeMatrix,h),Float32Array.from(l)},s.globeTileBounds=ws,s.globeTiltAtLngLat=Dx,s.globeToMercatorTransition=Lu,s.globeUseCustomAntiAliasing=function(n,t,i){const l=Lu(i.zoom),h=n.style.map._antialias,p=!!t.extStandardDerivatives,v=t.extStandardDerivativesForceOff||n.terrain&&n.terrain.exaggeration()>0;return l===0&&!h&&!v&&p},s.identity=Ko,s.identity$1=Sx,s.invert=_v,s.isFullscreen=function(){return!!w.document.fullscreenElement||!!w.document.webkitFullscreenElement},s.isLngLatBehindGlobe=kv,s.isMapAuthenticated=function(n){return ke.has(n)},s.isMapboxURL=ao,s.isSafariWithAntialiasingBug=function(n){const t=n.navigator?n.navigator.userAgent:null;return!!Nt(n)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=wr,s.latLngToECEF=zu,s.len=nI,s.length=_d,s.length$1=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},s.lngFromMercatorX=uo,s.loadVectorTile=w1,s.makeRequest=zr,s.mapValue=function(n,t,i,l,h){return nt((n-t)/(i-t)*(h-l)+l,l,h)},s.mercatorScale=Fx,s.mercatorXfromLng=Es,s.mercatorYfromLat=Ss,s.mercatorZfromAltitude=Qo,s.mul=eI,s.mul$1=tI,s.multiply=nc,s.multiply$1=mx,s.multiply$2=yx,s.nextPowerOfTwo=kt,s.normalize=Or,s.normalize$1=iI,s.normalize$2=wx,s.number=Vn,s.ortho=function(n,t,i,l,h,p,v){var x=1/(t-i),E=1/(l-h),T=1/(p-v);return n[0]=-2*x,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*E,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*T,n[11]=0,n[12]=(t+i)*x,n[13]=(h+l)*E,n[14]=(v+p)*T,n[15]=1,n},s.pbf=Fd,s.perspective=function(n,t,i,l,h){var p,v=1/Math.tan(t/2);return n[0]=v/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=v,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,h!=null&&h!==1/0?(n[10]=(h+l)*(p=1/(l-h)),n[14]=2*h*l*p):(n[10]=-1,n[14]=-2*l),n},s.pick=function(n,t){const i={};for(let l=0;l<t.length;l++){const h=t[l];h in n&&(i[h]=n[h])}return i},s.plugin=Ae,s.pointGeometry=Y,s.polesInViewport=function(n){const t=Ko(new Float64Array(16));nc(t,n.pixelMatrix,n.globeMatrix);const i=[0,To,0],l=[0,Co,0];return Bi(i,i,t),Bi(l,l,t),[i[0]>0&&i[0]<=n.width&&i[1]>0&&i[1]<=n.height&&!kv(n,new Nn(n.center.lat,90)),l[0]>0&&l[0]<=n.width&&l[1]>0&&l[1]<=n.height&&!kv(n,new Nn(n.center.lat,-90))]},s.polygonContainsPoint=lc,s.polygonIntersectsBox=qx,s.polygonIntersectsPolygon=$x,s.polygonizeBounds=function(n,t,i=0,l=!0){const h=new Y(i,i),p=n.sub(h),v=t.add(h),x=[p,new Y(v.x,p.y),v,new Y(p.x,v.y)];return l&&x.push(p.clone()),x},s.posAttributes=Ed,s.postMapLoadEvent=oe,s.postPerformanceEvent=Ie,s.postTurnstileEvent=U,s.potpack=Hv,s.prevPowerOfTwo=function(n){return n<=1?1:Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},s.radToDeg=be,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(n){return n({pluginStatus:te,pluginURL:W}),pe.on("pluginStateChange",n),n},s.removeAuthState=function(n){ke.delete(n)},s.renderColorRamp=Fv,s.resample=Vx,s.rotateX=yv,s.rotateX$1=Tx,s.rotateY=nm,s.rotateY$1=Cx,s.rotateZ=function(n,t,i){var l=Math.sin(i),h=Math.cos(i),p=t[0],v=t[1],x=t[2],E=t[3],T=t[4],k=t[5],P=t[6],D=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=p*h+T*l,n[1]=v*h+k*l,n[2]=x*h+P*l,n[3]=E*h+D*l,n[4]=T*h-p*l,n[5]=k*h-v*l,n[6]=P*h-x*l,n[7]=D*h-E*l,n},s.rotateZ$1=function(n,t,i){i*=.5;var l=t[0],h=t[1],p=t[2],v=t[3],x=Math.sin(i),E=Math.cos(i);return n[0]=l*E+h*x,n[1]=h*E-l*x,n[2]=p*E+v*x,n[3]=v*E-p*x,n},s.scale=ic,s.scale$1=bx,s.scale$2=co,s.scaleAndAdd=bd,s.set=function(n,t,i,l){return n[0]=t,n[1]=i,n[2]=l,n},s.setCacheLimits=function(n,t){on=n,fn=t},s.setColumn=function(n,t,i){n[4*t+0]=i[0],n[4*t+1]=i[1],n[4*t+2]=i[2],n[4*t+3]=i[3]},s.setRTLTextPlugin=function(n,t,i=!1){if(te===H||te===Q||te===J)throw new Error("setRTLTextPlugin cannot be called multiple times.");W=qn.resolveURL(n),te=H,ee=t,ae(),i||we()},s.smoothstep=ft,s.spec=et,s.squaredLength=function(n){var t=n[0],i=n[1],l=n[2];return t*t+i*i+l*l},s.storeAuthState=function(n,t){t?ke.add(n):ke.delete(n)},s.sub=Jo,s.subtract=bv,s.symbolSize=pA,s.tileAABB=function(n,t,i,l,h,p,v,x,E){if(E.name==="globe")return aI(n,t,new vm(i,l,h));const T=uc({z:i,x:l,y:h},E);return new Fr([(p+T.x/T.scale)*t,t*(T.y/T.scale),v],[(p+T.x2/T.scale)*t,t*(T.y2/T.scale),x])},s.tileCornersToBounds=rm,s.tileTransform=uc,s.transformMat3=function(n,t,i){var l=t[0],h=t[1],p=t[2];return n[0]=l*i[0]+h*i[3]+p*i[6],n[1]=l*i[1]+h*i[4]+p*i[7],n[2]=l*i[2]+h*i[5]+p*i[8],n},s.transformMat4=Bi,s.transformMat4$1=rc,s.transformQuat=xx,s.transitionTileAABBinECEF=Mx,s.translate=vd,s.transpose=function(n,t){if(n===t){var i=t[1],l=t[2],h=t[5];n[1]=t[3],n[2]=t[6],n[3]=i,n[5]=t[7],n[6]=l,n[7]=h}else n[0]=t[0],n[1]=t[3],n[2]=t[6],n[3]=t[1],n[4]=t[4],n[5]=t[7],n[6]=t[2],n[7]=t[5],n[8]=t[8];return n},s.triggerPluginCompletionEvent=ue,s.uniqueId=qt,s.updateGlobeVertexNormal=function(n,t,i,l,h){const p=5*t+2;n.float32[p+0]=i,n.float32[p+1]=l,n.float32[p+2]=h},s.validateCustomStyleLayer=function(n){const t=[],i=n.id;return i===void 0&&t.push({message:`layers.${i}: missing required property "id"`}),n.render===void 0&&t.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&t.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),t},s.validateFilter=n=>Zo(ad(n)),s.validateFog=n=>Zo(Rp(n)),s.validateLayer=n=>Zo(cd(n)),s.validateLight=n=>Zo(Dp(n)),s.validateSource=n=>Zo(Wl(n)),s.validateStyle=Bp,s.validateTerrain=n=>Zo(ud(n)),s.values=Gt,s.vectorTile=pm,s.version=S,s.warnOnce=he,s.window=w,s.wrap=Pe}),g(["./shared"],function(s){function w(se){if(typeof se=="number"||typeof se=="boolean"||typeof se=="string"||se==null)return JSON.stringify(se);if(Array.isArray(se)){let q="[";for(const oe of se)q+=`${w(oe)},`;return`${q}]`}let U="{";for(const q of Object.keys(se).sort())U+=`${q}:${w(se[q])},`;return`${U}}`}function S(se){let U="";for(const q of s.refProperties)U+=`/${w(se[q])}`;return U}class A{constructor(U){this.keyCache={},U&&this.replace(U)}replace(U){this._layerConfigs={},this._layers={},this.update(U,[])}update(U,q){for(const me of U)this._layerConfigs[me.id]=me,(this._layers[me.id]=s.createStyleLayer(me)).compileFilter(),this.keyCache[me.id]&&delete this.keyCache[me.id];for(const me of q)delete this.keyCache[me],delete this._layerConfigs[me],delete this._layers[me];this.familiesBySource={};const oe=function(me,Ie){const Oe={};for(let ke=0;ke<me.length;ke++){const Ve=Ie&&Ie[me[ke].id]||S(me[ke]);Ie&&(Ie[me[ke].id]=Ve);let ut=Oe[Ve];ut||(ut=Oe[Ve]=[]),ut.push(me[ke])}const Re=[];for(const ke in Oe)Re.push(Oe[ke]);return Re}(s.values(this._layerConfigs),this.keyCache);for(const me of oe){const Ie=me.map(Bt=>this._layers[Bt.id]),Oe=Ie[0];if(Oe.visibility==="none")continue;const Re=Oe.source||"";let ke=this.familiesBySource[Re];ke||(ke=this.familiesBySource[Re]={});const Ve=Oe.sourceLayer||"_geojsonTileLayer";let ut=ke[Ve];ut||(ut=ke[Ve]=[]),ut.push(Ie)}}}class z{loadTile(U,q){const{uid:oe,encoding:me,rawImageData:Ie,padding:Oe,buildQuadTree:Re}=U,ke=s.window.ImageBitmap&&Ie instanceof s.window.ImageBitmap?this.getImageData(Ie,Oe):Ie;q(null,new s.DEMData(oe,ke,me,Oe<1,Re))}getImageData(U,q){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(U.width,U.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=U.width,this.offscreenCanvas.height=U.height,this.offscreenCanvasContext.drawImage(U,0,0,U.width,U.height);const oe=this.offscreenCanvasContext.getImageData(-q,-q,U.width+2*q,U.height+2*q);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),oe}}var L=function se(U,q){var oe,me=U&&U.type;if(me==="FeatureCollection")for(oe=0;oe<U.features.length;oe++)se(U.features[oe],q);else if(me==="GeometryCollection")for(oe=0;oe<U.geometries.length;oe++)se(U.geometries[oe],q);else if(me==="Feature")se(U.geometry,q);else if(me==="Polygon")R(U.coordinates,q);else if(me==="MultiPolygon")for(oe=0;oe<U.coordinates.length;oe++)R(U.coordinates[oe],q);return U};function R(se,U){if(se.length!==0){$(se[0],U);for(var q=1;q<se.length;q++)$(se[q],!U)}}function $(se,U){for(var q=0,oe=0,me=0,Ie=se.length,Oe=Ie-1;me<Ie;Oe=me++){var Re=(se[me][0]-se[Oe][0])*(se[Oe][1]+se[me][1]),ke=q+Re;oe+=Math.abs(q)>=Math.abs(Re)?q-ke+Re:Re-ke+q,q=ke}q+oe>=0!=!!U&&se.reverse()}const Z=s.VectorTileFeature.prototype.toGeoJSON;class de{constructor(U){this._feature=U,this.extent=s.EXTENT,this.type=U.type,this.properties=U.tags,"id"in U&&!isNaN(U.id)&&(this.id=parseInt(U.id,10))}loadGeometry(){if(this._feature.type===1){const U=[];for(const q of this._feature.geometry)U.push([new s.pointGeometry(q[0],q[1])]);return U}{const U=[];for(const q of this._feature.geometry){const oe=[];for(const me of q)oe.push(new s.pointGeometry(me[0],me[1]));U.push(oe)}return U}}toGeoJSON(U,q,oe){return Z.call(this,U,q,oe)}}class ne{constructor(U){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=U.length,this._features=U}feature(U){return new de(this._features[U])}}var ce={},K={get exports(){return ce},set exports(se){ce=se}},Ee=s.pointGeometry,Y=s.vectorTile.VectorTileFeature,_e=fe;function fe(se,U){this.options=U||{},this.features=se,this.length=se.length}function ve(se,U){this.id=typeof se.id=="number"?se.id:void 0,this.type=se.type,this.rawGeometry=se.type===1?[se.geometry]:se.geometry,this.properties=se.tags,this.extent=U||4096}fe.prototype.feature=function(se){return new ve(this.features[se],this.options.extent)},ve.prototype.loadGeometry=function(){var se=this.rawGeometry;this.geometry=[];for(var U=0;U<se.length;U++){for(var q=se[U],oe=[],me=0;me<q.length;me++)oe.push(new Ee(q[me][0],q[me][1]));this.geometry.push(oe)}return this.geometry},ve.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var se=this.geometry,U=1/0,q=-1/0,oe=1/0,me=-1/0,Ie=0;Ie<se.length;Ie++)for(var Oe=se[Ie],Re=0;Re<Oe.length;Re++){var ke=Oe[Re];U=Math.min(U,ke.x),q=Math.max(q,ke.x),oe=Math.min(oe,ke.y),me=Math.max(me,ke.y)}return[U,oe,q,me]},ve.prototype.toGeoJSON=Y.prototype.toGeoJSON;var Se=s.pbf,be=_e;function De(se){var U=new Se;return function(q,oe){for(var me in q.layers)oe.writeMessage(3,ze,q.layers[me])}(se,U),U.finish()}function ze(se,U){var q;U.writeVarintField(15,se.version||1),U.writeStringField(1,se.name||""),U.writeVarintField(5,se.extent||4096);var oe={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<se.length;q++)oe.feature=se.feature(q),U.writeMessage(2,Ke,oe);var me=oe.keys;for(q=0;q<me.length;q++)U.writeStringField(3,me[q]);var Ie=oe.values;for(q=0;q<Ie.length;q++)U.writeMessage(4,at,Ie[q])}function Ke(se,U){var q=se.feature;q.id!==void 0&&U.writeVarintField(1,q.id),U.writeMessage(2,ct,se),U.writeVarintField(3,q.type),U.writeMessage(4,Pe,q)}function ct(se,U){var q=se.feature,oe=se.keys,me=se.values,Ie=se.keycache,Oe=se.valuecache;for(var Re in q.properties){var ke=q.properties[Re],Ve=Ie[Re];if(ke!==null){Ve===void 0&&(oe.push(Re),Ie[Re]=Ve=oe.length-1),U.writeVarint(Ve);var ut=typeof ke;ut!=="string"&&ut!=="boolean"&&ut!=="number"&&(ke=JSON.stringify(ke));var Bt=ut+":"+ke,gt=Oe[Bt];gt===void 0&&(me.push(ke),Oe[Bt]=gt=me.length-1),U.writeVarint(gt)}}}function nt(se,U){return(U<<3)+(7&se)}function ft(se){return se<<1^se>>31}function Pe(se,U){for(var q=se.loadGeometry(),oe=se.type,me=0,Ie=0,Oe=q.length,Re=0;Re<Oe;Re++){var ke=q[Re],Ve=1;oe===1&&(Ve=ke.length),U.writeVarint(nt(1,Ve));for(var ut=oe===3?ke.length-1:ke.length,Bt=0;Bt<ut;Bt++){Bt===1&&oe!==1&&U.writeVarint(nt(2,ut-1));var gt=ke[Bt].x-me,tn=ke[Bt].y-Ie;U.writeVarint(ft(gt)),U.writeVarint(ft(tn)),me+=gt,Ie+=tn}oe===3&&U.writeVarint(nt(7,1))}}function at(se,U){var q=typeof se;q==="string"?U.writeStringField(1,se):q==="boolean"?U.writeBooleanField(7,se):q==="number"&&(se%1!=0?U.writeDoubleField(3,se):se<0?U.writeSVarintField(6,se):U.writeVarintField(5,se))}function Gt(se,U,q,oe,me,Ie){if(me-oe<=q)return;const Oe=oe+me>>1;pt(se,U,Oe,oe,me,Ie%2),Gt(se,U,q,oe,Oe-1,Ie+1),Gt(se,U,q,Oe+1,me,Ie+1)}function pt(se,U,q,oe,me,Ie){for(;me>oe;){if(me-oe>600){const Ve=me-oe+1,ut=q-oe+1,Bt=Math.log(Ve),gt=.5*Math.exp(2*Bt/3),tn=.5*Math.sqrt(Bt*gt*(Ve-gt)/Ve)*(ut-Ve/2<0?-1:1);pt(se,U,q,Math.max(oe,Math.floor(q-ut*gt/Ve+tn)),Math.min(me,Math.floor(q+(Ve-ut)*gt/Ve+tn)),Ie)}const Oe=U[2*q+Ie];let Re=oe,ke=me;for(Lt(se,U,oe,q),U[2*me+Ie]>Oe&&Lt(se,U,oe,me);Re<ke;){for(Lt(se,U,Re,ke),Re++,ke--;U[2*Re+Ie]<Oe;)Re++;for(;U[2*ke+Ie]>Oe;)ke--}U[2*oe+Ie]===Oe?Lt(se,U,oe,ke):(ke++,Lt(se,U,ke,me)),ke<=q&&(oe=ke+1),q<=ke&&(me=ke-1)}}function Lt(se,U,q,oe){qt(se,q,oe),qt(U,2*q,2*oe),qt(U,2*q+1,2*oe+1)}function qt(se,U,q){const oe=se[U];se[U]=se[q],se[q]=oe}function Ln(se,U,q,oe){const me=se-q,Ie=U-oe;return me*me+Ie*Ie}K.exports=De,ce.fromVectorTileJs=De,ce.fromGeojsonVt=function(se,U){U=U||{};var q={};for(var oe in se)q[oe]=new be(se[oe].features,U),q[oe].name=oe,q[oe].version=U.version,q[oe].extent=U.extent;return De({layers:q})},ce.GeoJSONWrapper=be;const kt=se=>se[0],Je=se=>se[1];class bt{constructor(U,q=kt,oe=Je,me=64,Ie=Float64Array){this.nodeSize=me,this.points=U;const Oe=U.length<65536?Uint16Array:Uint32Array,Re=this.ids=new Oe(U.length),ke=this.coords=new Ie(2*U.length);for(let Ve=0;Ve<U.length;Ve++)Re[Ve]=Ve,ke[2*Ve]=q(U[Ve]),ke[2*Ve+1]=oe(U[Ve]);Gt(Re,ke,me,0,Re.length-1,0)}range(U,q,oe,me){return function(Ie,Oe,Re,ke,Ve,ut,Bt){const gt=[0,Ie.length-1,0],tn=[];let Qt,Kt;for(;gt.length;){const un=gt.pop(),yn=gt.pop(),qn=gt.pop();if(yn-qn<=Bt){for(let ti=qn;ti<=yn;ti++)Qt=Oe[2*ti],Kt=Oe[2*ti+1],Qt>=Re&&Qt<=Ve&&Kt>=ke&&Kt<=ut&&tn.push(Ie[ti]);continue}const sn=Math.floor((qn+yn)/2);Qt=Oe[2*sn],Kt=Oe[2*sn+1],Qt>=Re&&Qt<=Ve&&Kt>=ke&&Kt<=ut&&tn.push(Ie[sn]);const ei=(un+1)%2;(un===0?Re<=Qt:ke<=Kt)&&(gt.push(qn),gt.push(sn-1),gt.push(ei)),(un===0?Ve>=Qt:ut>=Kt)&&(gt.push(sn+1),gt.push(yn),gt.push(ei))}return tn}(this.ids,this.coords,U,q,oe,me,this.nodeSize)}within(U,q,oe){return function(me,Ie,Oe,Re,ke,Ve){const ut=[0,me.length-1,0],Bt=[],gt=ke*ke;for(;ut.length;){const tn=ut.pop(),Qt=ut.pop(),Kt=ut.pop();if(Qt-Kt<=Ve){for(let ei=Kt;ei<=Qt;ei++)Ln(Ie[2*ei],Ie[2*ei+1],Oe,Re)<=gt&&Bt.push(me[ei]);continue}const un=Math.floor((Kt+Qt)/2),yn=Ie[2*un],qn=Ie[2*un+1];Ln(yn,qn,Oe,Re)<=gt&&Bt.push(me[un]);const sn=(tn+1)%2;(tn===0?Oe-ke<=yn:Re-ke<=qn)&&(ut.push(Kt),ut.push(un-1),ut.push(sn)),(tn===0?Oe+ke>=yn:Re+ke>=qn)&&(ut.push(un+1),ut.push(Qt),ut.push(sn))}return Bt}(this.ids,this.coords,U,q,oe,this.nodeSize)}}const Tt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:se=>se},Ut=Math.fround||(pn=new Float32Array(1),se=>(pn[0]=+se,pn[0]));var pn;class Dn{constructor(U){this.options=Nt(Object.create(Tt),U),this.trees=new Array(this.options.maxZoom+1)}load(U){const{log:q,minZoom:oe,maxZoom:me,nodeSize:Ie}=this.options;q&&console.time("total time");const Oe=`prepare ${U.length} points`;q&&console.time(Oe),this.points=U;let Re=[];for(let ke=0;ke<U.length;ke++)U[ke].geometry&&Re.push(he(U[ke],ke));this.trees[me+1]=new bt(Re,Pt,Ft,Ie,Float32Array),q&&console.timeEnd(Oe);for(let ke=me;ke>=oe;ke--){const Ve=+Date.now();Re=this._cluster(Re,ke),this.trees[ke]=new bt(Re,Pt,Ft,Ie,Float32Array),q&&console.log("z%d: %d clusters in %dms",ke,Re.length,+Date.now()-Ve)}return q&&console.timeEnd("total time"),this}getClusters(U,q){let oe=((U[0]+180)%360+360)%360-180;const me=Math.max(-90,Math.min(90,U[1]));let Ie=U[2]===180?180:((U[2]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,U[3]));if(U[2]-U[0]>=360)oe=-180,Ie=180;else if(oe>Ie){const ut=this.getClusters([oe,me,180,Oe],q),Bt=this.getClusters([-180,me,Ie,Oe],q);return ut.concat(Bt)}const Re=this.trees[this._limitZoom(q)],ke=Re.range(st(oe),yt(Oe),st(Ie),yt(me)),Ve=[];for(const ut of ke){const Bt=Re.points[ut];Ve.push(Bt.numPoints?Me(Bt):this.points[Bt.index])}return Ve}getChildren(U){const q=this._getOriginId(U),oe=this._getOriginZoom(U),me="No cluster with the specified id.",Ie=this.trees[oe];if(!Ie)throw new Error(me);const Oe=Ie.points[q];if(!Oe)throw new Error(me);const Re=this.options.radius/(this.options.extent*Math.pow(2,oe-1)),ke=Ie.within(Oe.x,Oe.y,Re),Ve=[];for(const ut of ke){const Bt=Ie.points[ut];Bt.parentId===U&&Ve.push(Bt.numPoints?Me(Bt):this.points[Bt.index])}if(Ve.length===0)throw new Error(me);return Ve}getLeaves(U,q,oe){const me=[];return this._appendLeaves(me,U,q=q||10,oe=oe||0,0),me}getTile(U,q,oe){const me=this.trees[this._limitZoom(U)],Ie=Math.pow(2,U),{extent:Oe,radius:Re}=this.options,ke=Re/Oe,Ve=(oe-ke)/Ie,ut=(oe+1+ke)/Ie,Bt={features:[]};return this._addTileFeatures(me.range((q-ke)/Ie,Ve,(q+1+ke)/Ie,ut),me.points,q,oe,Ie,Bt),q===0&&this._addTileFeatures(me.range(1-ke/Ie,Ve,1,ut),me.points,Ie,oe,Ie,Bt),q===Ie-1&&this._addTileFeatures(me.range(0,Ve,ke/Ie,ut),me.points,-1,oe,Ie,Bt),Bt.features.length?Bt:null}getClusterExpansionZoom(U){let q=this._getOriginZoom(U)-1;for(;q<=this.options.maxZoom;){const oe=this.getChildren(U);if(q++,oe.length!==1)break;U=oe[0].properties.cluster_id}return q}_appendLeaves(U,q,oe,me,Ie){const Oe=this.getChildren(q);for(const Re of Oe){const ke=Re.properties;if(ke&&ke.cluster?Ie+ke.point_count<=me?Ie+=ke.point_count:Ie=this._appendLeaves(U,ke.cluster_id,oe,me,Ie):Ie<me?Ie++:U.push(Re),U.length===oe)break}return Ie}_addTileFeatures(U,q,oe,me,Ie,Oe){for(const Re of U){const ke=q[Re],Ve=ke.numPoints;let ut,Bt,gt;if(Ve)ut=qe(ke),Bt=ke.x,gt=ke.y;else{const Kt=this.points[ke.index];ut=Kt.properties,Bt=st(Kt.geometry.coordinates[0]),gt=yt(Kt.geometry.coordinates[1])}const tn={type:1,geometry:[[Math.round(this.options.extent*(Bt*Ie-oe)),Math.round(this.options.extent*(gt*Ie-me))]],tags:ut};let Qt;Ve?Qt=ke.id:this.options.generateId?Qt=ke.index:this.points[ke.index].id&&(Qt=this.points[ke.index].id),Qt!==void 0&&(tn.id=Qt),Oe.features.push(tn)}}_limitZoom(U){return Math.max(this.options.minZoom,Math.min(Math.floor(+U),this.options.maxZoom+1))}_cluster(U,q){const oe=[],{radius:me,extent:Ie,reduce:Oe,minPoints:Re}=this.options,ke=me/(Ie*Math.pow(2,q));for(let Ve=0;Ve<U.length;Ve++){const ut=U[Ve];if(ut.zoom<=q)continue;ut.zoom=q;const Bt=this.trees[q+1],gt=Bt.within(ut.x,ut.y,ke),tn=ut.numPoints||1;let Qt=tn;for(const Kt of gt){const un=Bt.points[Kt];un.zoom>q&&(Qt+=un.numPoints||1)}if(Qt>tn&&Qt>=Re){let Kt=ut.x*tn,un=ut.y*tn,yn=Oe&&tn>1?this._map(ut,!0):null;const qn=(Ve<<5)+(q+1)+this.points.length;for(const sn of gt){const ei=Bt.points[sn];if(ei.zoom<=q)continue;ei.zoom=q;const ti=ei.numPoints||1;Kt+=ei.x*ti,un+=ei.y*ti,ei.parentId=qn,Oe&&(yn||(yn=this._map(ut,!0)),Oe(yn,this._map(ei)))}ut.parentId=qn,oe.push(_n(Kt/Qt,un/Qt,qn,Qt,yn))}else if(oe.push(ut),Qt>1)for(const Kt of gt){const un=Bt.points[Kt];un.zoom<=q||(un.zoom=q,oe.push(un))}}return oe}_getOriginId(U){return U-this.points.length>>5}_getOriginZoom(U){return(U-this.points.length)%32}_map(U,q){if(U.numPoints)return q?Nt({},U.properties):U.properties;const oe=this.points[U.index].properties,me=this.options.map(oe);return q&&me===oe?Nt({},me):me}}function _n(se,U,q,oe,me){return{x:Ut(se),y:Ut(U),zoom:1/0,id:q,parentId:-1,numPoints:oe,properties:me}}function he(se,U){const[q,oe]=se.geometry.coordinates;return{x:Ut(st(q)),y:Ut(yt(oe)),zoom:1/0,index:U,parentId:-1}}function Me(se){return{type:"Feature",id:se.id,properties:qe(se),geometry:{type:"Point",coordinates:[(U=se.x,360*(U-.5)),Dt(se.y)]}};var U}function qe(se){const U=se.numPoints,q=U>=1e4?`${Math.round(U/1e3)}k`:U>=1e3?Math.round(U/100)/10+"k":U;return Nt(Nt({},se.properties),{cluster:!0,cluster_id:se.id,point_count:U,point_count_abbreviated:q})}function st(se){return se/360+.5}function yt(se){const U=Math.sin(se*Math.PI/180),q=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return q<0?0:q>1?1:q}function Dt(se){const U=(180-360*se)*Math.PI/180;return 360*Math.atan(Math.exp(U))/Math.PI-90}function Nt(se,U){for(const q in U)se[q]=U[q];return se}function Pt(se){return se.x}function Ft(se){return se.y}function Et(se,U,q,oe){for(var me,Ie=oe,Oe=q-U>>1,Re=q-U,ke=se[U],Ve=se[U+1],ut=se[q],Bt=se[q+1],gt=U+3;gt<q;gt+=3){var tn=Jt(se[gt],se[gt+1],ke,Ve,ut,Bt);if(tn>Ie)me=gt,Ie=tn;else if(tn===Ie){var Qt=Math.abs(gt-Oe);Qt<Re&&(me=gt,Re=Qt)}}Ie>oe&&(me-U>3&&Et(se,U,me,oe),se[me+2]=Ie,q-me>3&&Et(se,me,q,oe))}function Jt(se,U,q,oe,me,Ie){var Oe=me-q,Re=Ie-oe;if(Oe!==0||Re!==0){var ke=((se-q)*Oe+(U-oe)*Re)/(Oe*Oe+Re*Re);ke>1?(q=me,oe=Ie):ke>0&&(q+=Oe*ke,oe+=Re*ke)}return(Oe=se-q)*Oe+(Re=U-oe)*Re}function Wt(se,U,q,oe){var me={id:se===void 0?null:se,type:U,geometry:q,tags:oe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ie){var Oe=Ie.geometry,Re=Ie.type;if(Re==="Point"||Re==="MultiPoint"||Re==="LineString")on(Ie,Oe);else if(Re==="Polygon"||Re==="MultiLineString")for(var ke=0;ke<Oe.length;ke++)on(Ie,Oe[ke]);else if(Re==="MultiPolygon")for(ke=0;ke<Oe.length;ke++)for(var Ve=0;Ve<Oe[ke].length;Ve++)on(Ie,Oe[ke][Ve])}(me),me}function on(se,U){for(var q=0;q<U.length;q+=3)se.minX=Math.min(se.minX,U[q]),se.minY=Math.min(se.minY,U[q+1]),se.maxX=Math.max(se.maxX,U[q]),se.maxY=Math.max(se.maxY,U[q+1])}function fn(se,U,q,oe){if(U.geometry){var me=U.geometry.coordinates,Ie=U.geometry.type,Oe=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),Re=[],ke=U.id;if(q.promoteId?ke=U.properties[q.promoteId]:q.generateId&&(ke=oe||0),Ie==="Point")Tn(me,Re);else if(Ie==="MultiPoint")for(var Ve=0;Ve<me.length;Ve++)Tn(me[Ve],Re);else if(Ie==="LineString")jn(me,Re,Oe,!1);else if(Ie==="MultiLineString"){if(q.lineMetrics){for(Ve=0;Ve<me.length;Ve++)jn(me[Ve],Re=[],Oe,!1),se.push(Wt(ke,"LineString",Re,U.properties));return}Gn(me,Re,Oe,!1)}else if(Ie==="Polygon")Gn(me,Re,Oe,!0);else{if(Ie!=="MultiPolygon"){if(Ie==="GeometryCollection"){for(Ve=0;Ve<U.geometry.geometries.length;Ve++)fn(se,{id:ke,geometry:U.geometry.geometries[Ve],properties:U.properties},q,oe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ve=0;Ve<me.length;Ve++){var ut=[];Gn(me[Ve],ut,Oe,!0),Re.push(ut)}}se.push(Wt(ke,Ie,Re,U.properties))}}function Tn(se,U){U.push(vi(se[0])),U.push(rr(se[1])),U.push(0)}function jn(se,U,q,oe){for(var me,Ie,Oe=0,Re=0;Re<se.length;Re++){var ke=vi(se[Re][0]),Ve=rr(se[Re][1]);U.push(ke),U.push(Ve),U.push(0),Re>0&&(Oe+=oe?(me*Ve-ke*Ie)/2:Math.sqrt(Math.pow(ke-me,2)+Math.pow(Ve-Ie,2))),me=ke,Ie=Ve}var ut=U.length-3;U[2]=1,Et(U,0,ut,q),U[ut+2]=1,U.size=Math.abs(Oe),U.start=0,U.end=U.size}function Gn(se,U,q,oe){for(var me=0;me<se.length;me++){var Ie=[];jn(se[me],Ie,q,oe),U.push(Ie)}}function vi(se){return se/360+.5}function rr(se){var U=Math.sin(se*Math.PI/180),q=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return q<0?0:q>1?1:q}function Hi(se,U,q,oe,me,Ie,Oe,Re){if(oe/=U,Ie>=(q/=U)&&Oe<oe)return se;if(Oe<q||Ie>=oe)return null;for(var ke=[],Ve=0;Ve<se.length;Ve++){var ut=se[Ve],Bt=ut.geometry,gt=ut.type,tn=me===0?ut.minX:ut.minY,Qt=me===0?ut.maxX:ut.maxY;if(tn>=q&&Qt<oe)ke.push(ut);else if(!(Qt<q||tn>=oe)){var Kt=[];if(gt==="Point"||gt==="MultiPoint")us(Bt,Kt,q,oe,me);else if(gt==="LineString")zr(Bt,Kt,q,oe,me,!1,Re.lineMetrics);else if(gt==="MultiLineString")tr(Bt,Kt,q,oe,me,!1);else if(gt==="Polygon")tr(Bt,Kt,q,oe,me,!0);else if(gt==="MultiPolygon")for(var un=0;un<Bt.length;un++){var yn=[];tr(Bt[un],yn,q,oe,me,!0),yn.length&&Kt.push(yn)}if(Kt.length){if(Re.lineMetrics&&gt==="LineString"){for(un=0;un<Kt.length;un++)ke.push(Wt(ut.id,gt,Kt[un],ut.tags));continue}gt!=="LineString"&&gt!=="MultiLineString"||(Kt.length===1?(gt="LineString",Kt=Kt[0]):gt="MultiLineString"),gt!=="Point"&&gt!=="MultiPoint"||(gt=Kt.length===3?"Point":"MultiPoint"),ke.push(Wt(ut.id,gt,Kt,ut.tags))}}}return ke.length?ke:null}function us(se,U,q,oe,me){for(var Ie=0;Ie<se.length;Ie+=3){var Oe=se[Ie+me];Oe>=q&&Oe<=oe&&(U.push(se[Ie]),U.push(se[Ie+1]),U.push(se[Ie+2]))}}function zr(se,U,q,oe,me,Ie,Oe){for(var Re,ke,Ve=yo(se),ut=me===0?$o:js,Bt=se.start,gt=0;gt<se.length-3;gt+=3){var tn=se[gt],Qt=se[gt+1],Kt=se[gt+2],un=se[gt+3],yn=se[gt+4],qn=me===0?tn:Qt,sn=me===0?un:yn,ei=!1;Oe&&(Re=Math.sqrt(Math.pow(tn-un,2)+Math.pow(Qt-yn,2))),qn<q?sn>q&&(ke=ut(Ve,tn,Qt,un,yn,q),Oe&&(Ve.start=Bt+Re*ke)):qn>oe?sn<oe&&(ke=ut(Ve,tn,Qt,un,yn,oe),Oe&&(Ve.start=Bt+Re*ke)):cr(Ve,tn,Qt,Kt),sn<q&&qn>=q&&(ke=ut(Ve,tn,Qt,un,yn,q),ei=!0),sn>oe&&qn<=oe&&(ke=ut(Ve,tn,Qt,un,yn,oe),ei=!0),!Ie&&ei&&(Oe&&(Ve.end=Bt+Re*ke),U.push(Ve),Ve=yo(se)),Oe&&(Bt+=Re)}var ti=se.length-3;tn=se[ti],Qt=se[ti+1],Kt=se[ti+2],(qn=me===0?tn:Qt)>=q&&qn<=oe&&cr(Ve,tn,Qt,Kt),ti=Ve.length-3,Ie&&ti>=3&&(Ve[ti]!==Ve[0]||Ve[ti+1]!==Ve[1])&&cr(Ve,Ve[0],Ve[1],Ve[2]),Ve.length&&U.push(Ve)}function yo(se){var U=[];return U.size=se.size,U.start=se.start,U.end=se.end,U}function tr(se,U,q,oe,me,Ie){for(var Oe=0;Oe<se.length;Oe++)zr(se[Oe],U,q,oe,me,Ie,!1)}function cr(se,U,q,oe){se.push(U),se.push(q),se.push(oe)}function $o(se,U,q,oe,me,Ie){var Oe=(Ie-U)/(oe-U);return se.push(Ie),se.push(q+(me-q)*Oe),se.push(1),Oe}function js(se,U,q,oe,me,Ie){var Oe=(Ie-q)/(me-q);return se.push(U+(oe-U)*Oe),se.push(Ie),se.push(1),Oe}function El(se,U){for(var q=[],oe=0;oe<se.length;oe++){var me,Ie=se[oe],Oe=Ie.type;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")me=Gs(Ie.geometry,U);else if(Oe==="MultiLineString"||Oe==="Polygon"){me=[];for(var Re=0;Re<Ie.geometry.length;Re++)me.push(Gs(Ie.geometry[Re],U))}else if(Oe==="MultiPolygon")for(me=[],Re=0;Re<Ie.geometry.length;Re++){for(var ke=[],Ve=0;Ve<Ie.geometry[Re].length;Ve++)ke.push(Gs(Ie.geometry[Re][Ve],U));me.push(ke)}q.push(Wt(Ie.id,Oe,me,Ie.tags))}return q}function Gs(se,U){var q=[];q.size=se.size,se.start!==void 0&&(q.start=se.start,q.end=se.end);for(var oe=0;oe<se.length;oe+=3)q.push(se[oe]+U,se[oe+1],se[oe+2]);return q}function ao(se,U){if(se.transformed)return se;var q,oe,me,Ie=1<<se.z,Oe=se.x,Re=se.y;for(q=0;q<se.features.length;q++){var ke=se.features[q],Ve=ke.geometry,ut=ke.type;if(ke.geometry=[],ut===1)for(oe=0;oe<Ve.length;oe+=2)ke.geometry.push(qs(Ve[oe],Ve[oe+1],U,Ie,Oe,Re));else for(oe=0;oe<Ve.length;oe++){var Bt=[];for(me=0;me<Ve[oe].length;me+=2)Bt.push(qs(Ve[oe][me],Ve[oe][me+1],U,Ie,Oe,Re));ke.geometry.push(Bt)}}return se.transformed=!0,se}function qs(se,U,q,oe,me,Ie){return[Math.round(q*(se*oe-me)),Math.round(q*(U*oe-Ie))]}function qc(se,U,q,oe,me){for(var Ie=U===me.maxZoom?0:me.tolerance/((1<<U)*me.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:oe,z:U,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Re=0;Re<se.length;Re++){Oe.numFeatures++,Zc(Oe,se[Re],Ie,me);var ke=se[Re].minX,Ve=se[Re].minY,ut=se[Re].maxX,Bt=se[Re].maxY;ke<Oe.minX&&(Oe.minX=ke),Ve<Oe.minY&&(Oe.minY=Ve),ut>Oe.maxX&&(Oe.maxX=ut),Bt>Oe.maxY&&(Oe.maxY=Bt)}return Oe}function Zc(se,U,q,oe){var me=U.geometry,Ie=U.type,Oe=[];if(Ie==="Point"||Ie==="MultiPoint")for(var Re=0;Re<me.length;Re+=3)Oe.push(me[Re]),Oe.push(me[Re+1]),se.numPoints++,se.numSimplified++;else if(Ie==="LineString")Aa(Oe,me,se,q,!1,!1);else if(Ie==="MultiLineString"||Ie==="Polygon")for(Re=0;Re<me.length;Re++)Aa(Oe,me[Re],se,q,Ie==="Polygon",Re===0);else if(Ie==="MultiPolygon")for(var ke=0;ke<me.length;ke++){var Ve=me[ke];for(Re=0;Re<Ve.length;Re++)Aa(Oe,Ve[Re],se,q,!0,Re===0)}if(Oe.length){var ut=U.tags||null;if(Ie==="LineString"&&oe.lineMetrics){for(var Bt in ut={},U.tags)ut[Bt]=U.tags[Bt];ut.mapbox_clip_start=me.start/me.size,ut.mapbox_clip_end=me.end/me.size}var gt={geometry:Oe,type:Ie==="Polygon"||Ie==="MultiPolygon"?3:Ie==="LineString"||Ie==="MultiLineString"?2:1,tags:ut};U.id!==null&&(gt.id=U.id),se.features.push(gt)}}function Aa(se,U,q,oe,me,Ie){var Oe=oe*oe;if(oe>0&&U.size<(me?Oe:oe))q.numPoints+=U.length/3;else{for(var Re=[],ke=0;ke<U.length;ke+=3)(oe===0||U[ke+2]>Oe)&&(q.numSimplified++,Re.push(U[ke]),Re.push(U[ke+1])),q.numPoints++;me&&function(Ve,ut){for(var Bt=0,gt=0,tn=Ve.length,Qt=tn-2;gt<tn;Qt=gt,gt+=2)Bt+=(Ve[gt]-Ve[Qt])*(Ve[gt+1]+Ve[Qt+1]);if(Bt>0===ut)for(gt=0,tn=Ve.length;gt<tn/2;gt+=2){var Kt=Ve[gt],un=Ve[gt+1];Ve[gt]=Ve[tn-2-gt],Ve[gt+1]=Ve[tn-1-gt],Ve[tn-2-gt]=Kt,Ve[tn-1-gt]=un}}(Re,Ie),se.push(Re)}}function Zs(se,U){var q=(U=this.options=function(me,Ie){for(var Oe in Ie)me[Oe]=Ie[Oe];return me}(Object.create(this.options),U)).debug;if(q&&console.time("preprocess data"),U.maxZoom<0||U.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(U.promoteId&&U.generateId)throw new Error("promoteId and generateId cannot be used together.");var oe=function(me,Ie){var Oe=[];if(me.type==="FeatureCollection")for(var Re=0;Re<me.features.length;Re++)fn(Oe,me.features[Re],Ie,Re);else fn(Oe,me.type==="Feature"?me:{geometry:me},Ie);return Oe}(se,U);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",U.indexMaxZoom,U.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),oe=function(me,Ie){var Oe=Ie.buffer/Ie.extent,Re=me,ke=Hi(me,1,-1-Oe,Oe,0,-1,2,Ie),Ve=Hi(me,1,1-Oe,2+Oe,0,-1,2,Ie);return(ke||Ve)&&(Re=Hi(me,1,-Oe,1+Oe,0,-1,2,Ie)||[],ke&&(Re=El(ke,1).concat(Re)),Ve&&(Re=Re.concat(El(Ve,-1)))),Re}(oe,U),oe.length&&this.splitTile(oe,0,0,0),q&&(oe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Zr(se,U,q){return 32*((1<<se)*q+U)+se}function hs(se,U){const q=se.tileID.canonical;if(!this._geoJSONIndex)return U(null,null);const oe=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!oe)return U(null,null);const me=new ne(oe.features);let Ie=ce(me);Ie.byteOffset===0&&Ie.byteLength===Ie.buffer.byteLength||(Ie=new Uint8Array(Ie)),U(null,{vectorTile:me,rawData:Ie.buffer})}Zs.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Zs.prototype.splitTile=function(se,U,q,oe,me,Ie,Oe){for(var Re=[se,U,q,oe],ke=this.options,Ve=ke.debug;Re.length;){oe=Re.pop(),q=Re.pop(),U=Re.pop(),se=Re.pop();var ut=1<<U,Bt=Zr(U,q,oe),gt=this.tiles[Bt];if(!gt&&(Ve>1&&console.time("creation"),gt=this.tiles[Bt]=qc(se,U,q,oe,ke),this.tileCoords.push({z:U,x:q,y:oe}),Ve)){Ve>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",U,q,oe,gt.numFeatures,gt.numPoints,gt.numSimplified),console.timeEnd("creation"));var tn="z"+U;this.stats[tn]=(this.stats[tn]||0)+1,this.total++}if(gt.source=se,me){if(U===ke.maxZoom||U===me)continue;var Qt=1<<me-U;if(q!==Math.floor(Ie/Qt)||oe!==Math.floor(Oe/Qt))continue}else if(U===ke.indexMaxZoom||gt.numPoints<=ke.indexMaxPoints)continue;if(gt.source=null,se.length!==0){Ve>1&&console.time("clipping");var Kt,un,yn,qn,sn,ei,ti=.5*ke.buffer/ke.extent,ds=.5-ti,Uo=.5+ti,et=1+ti;Kt=un=yn=qn=null,sn=Hi(se,ut,q-ti,q+Uo,0,gt.minX,gt.maxX,ke),ei=Hi(se,ut,q+ds,q+et,0,gt.minX,gt.maxX,ke),se=null,sn&&(Kt=Hi(sn,ut,oe-ti,oe+Uo,1,gt.minY,gt.maxY,ke),un=Hi(sn,ut,oe+ds,oe+et,1,gt.minY,gt.maxY,ke),sn=null),ei&&(yn=Hi(ei,ut,oe-ti,oe+Uo,1,gt.minY,gt.maxY,ke),qn=Hi(ei,ut,oe+ds,oe+et,1,gt.minY,gt.maxY,ke),ei=null),Ve>1&&console.timeEnd("clipping"),Re.push(Kt||[],U+1,2*q,2*oe),Re.push(un||[],U+1,2*q,2*oe+1),Re.push(yn||[],U+1,2*q+1,2*oe),Re.push(qn||[],U+1,2*q+1,2*oe+1)}}},Zs.prototype.getTile=function(se,U,q){var oe=this.options,me=oe.extent,Ie=oe.debug;if(se<0||se>24)return null;var Oe=1<<se,Re=Zr(se,U=(U%Oe+Oe)%Oe,q);if(this.tiles[Re])return ao(this.tiles[Re],me);Ie>1&&console.log("drilling down to z%d-%d-%d",se,U,q);for(var ke,Ve=se,ut=U,Bt=q;!ke&&Ve>0;)Ve--,ut=Math.floor(ut/2),Bt=Math.floor(Bt/2),ke=this.tiles[Zr(Ve,ut,Bt)];return ke&&ke.source?(Ie>1&&console.log("found parent tile z%d-%d-%d",Ve,ut,Bt),Ie>1&&console.time("drilling down"),this.splitTile(ke.source,Ve,ut,Bt,se,U,q),Ie>1&&console.timeEnd("drilling down"),this.tiles[Re]?ao(this.tiles[Re],me):null):null};class Wc extends s.VectorTileWorkerSource{constructor(U,q,oe,me,Ie){super(U,q,oe,me,hs),Ie&&(this.loadGeoJSON=Ie)}loadData(U,q){const oe=U&&U.request,me=oe&&oe.collectResourceTiming;this.loadGeoJSON(U,(Ie,Oe)=>{if(Ie||!Oe)return q(Ie);if(typeof Oe!="object")return q(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`));{L(Oe,!0);try{if(U.filter){const ke=s.createExpression(U.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ke.result==="error")throw new Error(ke.value.map(ut=>`${ut.key}: ${ut.message}`).join(", "));Oe={type:"FeatureCollection",features:Oe.features.filter(ut=>ke.value.evaluate({zoom:0},ut))}}this._geoJSONIndex=U.cluster?new Dn(function({superclusterOptions:ke,clusterProperties:Ve}){if(!Ve||!ke)return ke;const ut={},Bt={},gt={accumulated:null,zoom:0},tn={properties:null},Qt=Object.keys(Ve);for(const Kt of Qt){const[un,yn]=Ve[Kt],qn=s.createExpression(yn),sn=s.createExpression(typeof un=="string"?[un,["accumulated"],["get",Kt]]:un);ut[Kt]=qn.value,Bt[Kt]=sn.value}return ke.map=Kt=>{tn.properties=Kt;const un={};for(const yn of Qt)un[yn]=ut[yn].evaluate(gt,tn);return un},ke.reduce=(Kt,un)=>{tn.properties=un;for(const yn of Qt)gt.accumulated=Kt[yn],Kt[yn]=Bt[yn].evaluate(gt,tn)},ke}(U)).load(Oe.features):function(ke,Ve){return new Zs(ke,Ve)}(Oe,U.geojsonVtOptions)}catch(ke){return q(ke)}this.loaded={};const Re={};if(me){const ke=s.getPerformanceMeasurement(oe);ke&&(Re.resourceTiming={},Re.resourceTiming[U.source]=JSON.parse(JSON.stringify(ke)))}q(null,Re)}})}reloadTile(U,q){const oe=this.loaded;return oe&&oe[U.uid]?super.reloadTile(U,q):this.loadTile(U,q)}loadGeoJSON(U,q){if(U.request)s.getJSON(U.request,q);else{if(typeof U.data!="string")return q(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`));try{return q(null,JSON.parse(U.data))}catch{return q(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(U,q){try{q(null,this._geoJSONIndex.getClusterExpansionZoom(U.clusterId))}catch(oe){q(oe)}}getClusterChildren(U,q){try{q(null,this._geoJSONIndex.getChildren(U.clusterId))}catch(oe){q(oe)}}getClusterLeaves(U,q){try{q(null,this._geoJSONIndex.getLeaves(U.clusterId,U.limit,U.offset))}catch(oe){q(oe)}}}class Ws{constructor(U){this.self=U,this.actor=new s.Actor(U,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:Wc},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(q,oe)=>{if(this.workerSourceTypes[q])throw new Error(`Worker source with name "${q}" already registered.`);this.workerSourceTypes[q]=oe},this.self.registerRTLTextPlugin=q=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=q.applyArabicShaping,s.plugin.processBidirectionalText=q.processBidirectionalText,s.plugin.processStyledBidirectionalText=q.processStyledBidirectionalText}}clearCaches(U,q,oe){delete this.layerIndexes[U],delete this.availableImages[U],delete this.workerSources[U],delete this.demWorkerSources[U],oe()}checkIfReady(U,q,oe){oe()}setReferrer(U,q){this.referrer=q}spriteLoaded(U,q){this.isSpriteLoaded[U]=q;for(const oe in this.workerSources[U]){const me=this.workerSources[U][oe];for(const Ie in me)me[Ie]instanceof s.VectorTileWorkerSource&&(me[Ie].isSpriteLoaded=q,me[Ie].fire(new s.Event("isSpriteLoaded")))}}setImages(U,q,oe){this.availableImages[U]=q;for(const me in this.workerSources[U]){const Ie=this.workerSources[U][me];for(const Oe in Ie)Ie[Oe].availableImages=q}oe()}enableTerrain(U,q,oe){this.terrain=q,oe()}setProjection(U,q){this.projections[U]=s.getProjection(q)}setLayers(U,q,oe){this.getLayerIndex(U).replace(q),oe()}updateLayers(U,q,oe){this.getLayerIndex(U).update(q.layers,q.removedIds),oe()}loadTile(U,q,oe){const me=this.enableTerrain?s.extend({enableTerrain:this.terrain},q):q;me.projection=this.projections[U]||this.defaultProjection,this.getWorkerSource(U,q.type,q.source).loadTile(me,oe)}loadDEMTile(U,q,oe){const me=this.enableTerrain?s.extend({buildQuadTree:this.terrain},q):q;this.getDEMWorkerSource(U,q.source).loadTile(me,oe)}reloadTile(U,q,oe){const me=this.enableTerrain?s.extend({enableTerrain:this.terrain},q):q;me.projection=this.projections[U]||this.defaultProjection,this.getWorkerSource(U,q.type,q.source).reloadTile(me,oe)}abortTile(U,q,oe){this.getWorkerSource(U,q.type,q.source).abortTile(q,oe)}removeTile(U,q,oe){this.getWorkerSource(U,q.type,q.source).removeTile(q,oe)}removeSource(U,q,oe){if(!this.workerSources[U]||!this.workerSources[U][q.type]||!this.workerSources[U][q.type][q.source])return;const me=this.workerSources[U][q.type][q.source];delete this.workerSources[U][q.type][q.source],me.removeSource!==void 0?me.removeSource(q,oe):oe()}loadWorkerSource(U,q,oe){try{this.self.importScripts(q.url),oe()}catch(me){oe(me.toString())}}syncRTLPluginState(U,q,oe){try{s.plugin.setState(q);const me=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&me!=null){this.self.importScripts(me);const Ie=s.plugin.isParsed();oe(Ie?void 0:new Error(`RTL Text Plugin failed to import scripts from ${me}`),Ie)}}catch(me){oe(me.toString())}}getAvailableImages(U){let q=this.availableImages[U];return q||(q=[]),q}getLayerIndex(U){let q=this.layerIndexes[U];return q||(q=this.layerIndexes[U]=new A),q}getWorkerSource(U,q,oe){if(this.workerSources[U]||(this.workerSources[U]={}),this.workerSources[U][q]||(this.workerSources[U][q]={}),!this.workerSources[U][q][oe]){const me={send:(Ie,Oe,Re,ke,Ve,ut)=>{this.actor.send(Ie,Oe,Re,U,Ve,ut)},scheduler:this.actor.scheduler};this.workerSources[U][q][oe]=new this.workerSourceTypes[q](me,this.getLayerIndex(U),this.getAvailableImages(U),this.isSpriteLoaded[U])}return this.workerSources[U][q][oe]}getDEMWorkerSource(U,q){return this.demWorkerSources[U]||(this.demWorkerSources[U]={}),this.demWorkerSources[U][q]||(this.demWorkerSources[U][q]=new z),this.demWorkerSources[U][q]}enforceCacheSizeLimit(U,q){s.enforceCacheSizeLimit(q)}getWorkerPerformanceMetrics(U,q,oe){oe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ws(self)),Ws}),g(["./shared"],function(s){function w(f,r){if(Array.isArray(f)){if(!Array.isArray(r)||f.length!==r.length)return!1;for(let u=0;u<f.length;u++)if(!w(f[u],r[u]))return!1;return!0}if(typeof f=="object"&&f!==null&&r!==null){if(typeof r!="object"||Object.keys(f).length!==Object.keys(r).length)return!1;for(const u in f)if(!w(f[u],r[u]))return!1;return!0}return f===r}var S=A;function A(f){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var m,y,b=new Blob([""],{type:"text/javascript"}),C=URL.createObjectURL(b);try{y=new Worker(C),m=!0}catch{m=!1}return y&&y.terminate(),URL.revokeObjectURL(C),m}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var m=document.createElement("canvas");m.width=m.height=1;var y=m.getContext("2d");if(!y)return!1;var b=y.getImageData(0,0,1,1);return b&&b.width===m.width}()?(z[u=r&&r.failIfMajorPerformanceCaveat]===void 0&&(z[u]=function(m){var y,b=function(C){var I=document.createElement("canvas"),M=Object.create(A.webGLContextAttributes);return M.failIfMajorPerformanceCaveat=C,I.getContext("webgl",M)||I.getContext("experimental-webgl",M)}(m);if(!b)return!1;try{y=b.createShader(b.VERTEX_SHADER)}catch{return!1}return!(!y||b.isContextLost())&&(b.shaderSource(y,"void main() {}"),b.compileShader(y),b.getShaderParameter(y,b.COMPILE_STATUS)===!0)}(u)),z[u]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var u}(f)}var z={};function L(f,r,u){const m=s.window.document.createElement(f);return r!==void 0&&(m.className=r),u&&u.appendChild(m),m}function R(f,r,u){const m=s.window.document.createElementNS("http://www.w3.org/2000/svg",f);for(const y of Object.keys(r))m.setAttributeNS(null,y,r[y]);return u&&u.appendChild(m),m}A.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const $=s.window.document&&s.window.document.documentElement.style,Z=$&&$.userSelect!==void 0?"userSelect":"WebkitUserSelect";let de;function ne(){$&&Z&&(de=$[Z],$[Z]="none")}function ce(){$&&Z&&($[Z]=de)}function K(f){f.preventDefault(),f.stopPropagation(),s.window.removeEventListener("click",K,!0)}function Ee(){s.window.addEventListener("click",K,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",K,!0)},0)}function Y(f,r){const u=f.getBoundingClientRect();return ve(f,u,r)}function _e(f,r){const u=f.getBoundingClientRect(),m=[];for(let y=0;y<r.length;y++)m.push(ve(f,u,r[y]));return m}function fe(f){return s.window.InstallTrigger!==void 0&&f.button===2&&f.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function ve(f,r,u){const m=f.offsetWidth===r.width?1:f.offsetWidth/r.width;return new s.pointGeometry((u.clientX-r.left)*m,(u.clientY-r.top)*m)}function Se(f,r){var u=r[0],m=r[1],y=r[2],b=r[3],C=u*b-y*m;return C?(f[0]=b*(C=1/C),f[1]=-m*C,f[2]=-y*C,f[3]=u*C,f):null}function be(f){const{userImage:r}=f;return!!(r&&r.render&&r.render())&&(f.data.replace(new Uint8Array(r.data.buffer)),!0)}class De extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:u,callback:m}of this.requestors)this._notify(u,m);this.requestors=[]}}hasImage(r){return!!this.getImage(r)}getImage(r){return this.images[r]}addImage(r,u){this._validate(r,u)&&(this.images[r]=u)}_validate(r,u){let m=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),m=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),m=!1),this._validateContent(u.content,u)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),m=!1),m}_validateStretch(r,u){if(!r)return!0;let m=0;for(const y of r){if(y[0]<m||y[1]<y[0]||u<y[1])return!1;m=y[1]}return!0}_validateContent(r,u){return!(r&&(r.length!==4||r[0]<0||u.data.width<r[0]||r[1]<0||u.data.height<r[1]||r[2]<0||u.data.width<r[2]||r[3]<0||u.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,u){u.version=this.images[r].version+1,this.images[r]=u,this.updatedImages[r]=!0}removeImage(r){const u=this.images[r];delete this.images[r],delete this.patterns[r],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,u){let m=!0;if(!this.isLoaded())for(const y of r)this.images[y]||(m=!1);this.isLoaded()||m?this._notify(r,u):this.requestors.push({ids:r,callback:u})}_notify(r,u){const m={};for(const y of r){this.images[y]||this.fire(new s.Event("styleimagemissing",{id:y}));const b=this.images[y];b?m[y]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:Boolean(b.userImage&&b.userImage.render)}:s.warnOnce(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,m)}getPixelSize(){const{width:r,height:u}=this.atlasImage;return{width:r,height:u}}getPattern(r){const u=this.patterns[r],m=this.getImage(r);if(!m)return null;if(u&&u.position.version===m.version)return u.position;if(u)u.position.version=m.version;else{const y={w:m.data.width+2,h:m.data.height+2,x:0,y:0},b=new s.ImagePosition(y,m);this.patterns[r]={bin:y,position:b}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const u=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(r,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const b in this.patterns)r.push(this.patterns[b].bin);const{w:u,h:m}=s.potpack(r),y=this.atlasImage;y.resize({width:u||1,height:m||1});for(const b in this.patterns){const{bin:C}=this.patterns[b],I=C.x+1,M=C.y+1,B=this.images[b].data,O=B.width,j=B.height;s.RGBAImage.copy(B,y,{x:0,y:0},{x:I,y:M},{width:O,height:j}),s.RGBAImage.copy(B,y,{x:0,y:j-1},{x:I,y:M-1},{width:O,height:1}),s.RGBAImage.copy(B,y,{x:0,y:0},{x:I,y:M+j},{width:O,height:1}),s.RGBAImage.copy(B,y,{x:O-1,y:0},{x:I-1,y:M},{width:1,height:j}),s.RGBAImage.copy(B,y,{x:0,y:0},{x:I+O,y:M},{width:1,height:j})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const u of r){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const m=this.images[u];be(m)&&this.updateImage(u,m)}}}const ze=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(f,r){return function([u,m,y]){const b=s.degToRad(m+90),C=s.degToRad(y);return{x:u*Math.cos(b)*Math.sin(C),y:u*Math.sin(b)*Math.sin(C),z:u*Math.cos(C),azimuthal:m,polar:y}}(f.expression.evaluate(r))}interpolate(f,r,u){return{x:s.number(f.x,r.x,u),y:s.number(f.y,r.y,u),z:s.number(f.z,r.z,u),azimuthal:s.number(f.azimuthal,r.azimuthal,u),polar:s.number(f.polar,r.polar,u)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)}),Ke="-transition";class ct extends s.Evented{constructor(r){super(),this._transitionable=new s.Transitionable(ze),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,u={}){if(!this._validate(s.validateLight,r,u))for(const m in r){const y=r[m];s.endsWith(m,Ke)?this._transitionable.setTransition(m.slice(0,-Ke.length),y):this._transitionable.setValue(m,y)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,m){return(!m||m.validate!==!1)&&s.emitValidationErrors(this,r.call(s.validateStyle,s.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const nt=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)}),ft="-transition";class Pe extends s.Evented{constructor(r,u){super(),this._transitionable=new s.Transitionable(nt),this.set(r),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=u}get(){return this._transitionable.serialize()}set(r){for(const u in r){const m=r[u];s.endsWith(u,ft)?this._transitionable.setTransition(u.slice(0,-ft.length),m):this._transitionable.setValue(u,m)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}}function at(f,r,u,m){const y=s.smoothstep(45,65,u),[b,C]=Gt(f,m),I=s.length(r);let M=1-Math.min(1,Math.exp((I-b)/(C-b)*-6));return M*=M*M,M=Math.min(1,1.00747*M),M*y*f.alpha}function Gt(f,r){const u=.5/Math.tan(.5*r);return[f.range[0]+u,f.range[1]+u]}const pt=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])}),Lt="-transition";class qt extends s.Evented{constructor(r,u){super(),this._transitionable=new s.Transitionable(pt),this.set(r),this._transitioning=this._transitionable.untransitioned(),this._transform=u}get state(){const r=this._transform,u=r.projection.name==="globe",m=s.globeToMercatorTransition(r.zoom),y=this.properties.get("range"),b=[.5,3];return{range:u?[s.number(b[0],y[0],m),s.number(b[1],y[1],m)]:y,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,u={}){if(!this._validate(s.validateFog,r,u)){for(const m of Object.keys(s.spec.fog))r&&r[m]===void 0&&(r[m]=s.spec.fog[m].default);for(const m in r){const y=r[m];s.endsWith(m,Lt)?this._transitionable.setTransition(m.slice(0,-Lt.length),y):this._transitionable.setValue(m,y)}}}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,r))*u.a}getOpacityAtLatLng(r,u){return this._transform.projection.supportsFog?function(m,y,b){const C=s.MercatorCoordinate.fromLngLat(y),I=b.elevation?b.elevation.getAtPointOrZero(C):0,M=[C.x,C.y,I];return s.transformMat4(M,M,b.mercatorFogMatrix),at(m,M,b.pitch,b._fov)}(this.state,r,u):0}getFovAdjustedRange(r){return this._transform.projection.supportsFog?Gt(this.state,r):[0,1]}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,m){return(!m||m.validate!==!1)&&s.emitValidationErrors(this,r.call(s.validateStyle,s.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class Ln{constructor(r,u){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const m=this.workerPool.acquire(this.id);for(let y=0;y<m.length;y++){const b=new Ln.Actor(m[y],u,this.id);b.name=`Worker ${y}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,u,m){s.asyncAll(this.actors,(y,b)=>{y.send(r,u,b)},m=m||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function kt(f,r,u){return r*(s.EXTENT/(f.tileSize*Math.pow(2,u-f.tileID.overscaledZ)))}Ln.Actor=s.Actor;class Je{constructor(r,u,m,y){this.screenBounds=r,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,y)}static createFromScreenPoints(r,u){let m,y;if(r instanceof s.pointGeometry||typeof r[0]=="number"){const b=s.pointGeometry.convert(r);m=[b],y=u.isPointAboveHorizon(b)}else{const b=s.pointGeometry.convert(r[0]),C=s.pointGeometry.convert(r[1]);m=[b,C],y=s.polygonizeBounds(b,C).every(I=>u.isPointAboveHorizon(I))}return new Je(m,u.getCameraPoint(),y,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const u=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],y=s.polygonizeBounds(u,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<m.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?y[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(y[3]=this.cameraPoint)),s.bufferConvexPolygon(y,r)}bufferedCameraGeometryGlobe(r){const u=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],y=s.polygonizeBounds(u,m,r),b=this.cameraPoint.clone();switch(3*((b.y>u.y)+(b.y>m.y))+((b.x>u.x)+(b.x>m.x))){case 0:y[0]=b,y[4]=b.clone();break;case 1:y.splice(1,0,b);break;case 2:y[1]=b;break;case 3:y.splice(4,0,b);break;case 5:y.splice(2,0,b);break;case 6:y[3]=b;break;case 7:y.splice(3,0,b);break;case 8:y[2]=b}return y}containsTile(r,u,m,y=0){const b=r.queryPadding/u._pixelsPerMercatorPixel+1,C=m?this._bufferedCameraMercator(b,u):this._bufferedScreenMercator(b,u);let I=r.tileID.wrap+(C.unwrapped?y:0);const M=C.polygon.map(te=>s.getTilePoint(r.tileTransform,te,I));if(!s.polygonIntersectsBox(M,0,0,s.EXTENT,s.EXTENT))return;I=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?y:0);const B=this.screenGeometryMercator.polygon.map(te=>s.getTileVec3(r.tileTransform,te,I)),O=B.map(te=>new s.pointGeometry(te[0],te[1])),j=u.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),H=s.getTileVec3(r.tileTransform,j,I),Q=B.map(te=>{const W=s.sub(te,te,H);return s.normalize(W,W),new s.Ray(H,W)}),J=kt(r,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:O,tilespaceRays:Q,bufferedTilespaceGeometry:M,bufferedTilespaceBounds:(ee=s.getBounds(M),ee.min.x=s.clamp(ee.min.x,0,s.EXTENT),ee.min.y=s.clamp(ee.min.y,0,s.EXTENT),ee.max.x=s.clamp(ee.max.x,0,s.EXTENT),ee.max.y=s.clamp(ee.max.y,0,s.EXTENT),ee),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:J};var ee}_bufferedScreenMercator(r,u){const m=Ut(r);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let y;return y=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),u):{polygon:this.bufferedScreenGeometry(r).map(b=>u.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[m]=y,y}}_bufferedCameraMercator(r,u){const m=Ut(r);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let y;return y=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),u):{polygon:this.bufferedCameraGeometry(r).map(b=>u.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[m]=y,y}}_projectAndResample(r,u){const m=function(b,C){const I=s.multiply([],C.pixelMatrix,C.globeMatrix),M=[0,-s.GLOBE_RADIUS,0,1],B=[0,s.GLOBE_RADIUS,0,1],O=[0,0,0,1];s.transformMat4$1(M,M,I),s.transformMat4$1(B,B,I),s.transformMat4$1(O,O,I);const j=new s.pointGeometry(M[0]/M[3],M[1]/M[3]),H=new s.pointGeometry(B[0]/B[3],B[1]/B[3]),Q=s.polygonContainsPoint(b,j)&&M[3]<O[3],J=s.polygonContainsPoint(b,H)&&B[3]<O[3];if(!Q&&!J)return null;const ee=function(Ae,Be,$e){for(let Ge=1;Ge<Ae.length;Ge++){const wt=Tt(Be.pointCoordinate3D(Ae[Ge-1]).x),Fe=Tt(Be.pointCoordinate3D(Ae[Ge]).x);if($e<0){if(wt<Fe)return{idx:Ge,t:-wt/(Fe-1-wt)}}else if(Fe<wt)return{idx:Ge,t:(1-wt)/(Fe+1-wt)}}return null}(b,C,Q?-1:1);if(!ee)return null;const{idx:te,t:W}=ee;let ue=te>1?bt(b.slice(0,te),C):[],ae=te<b.length?bt(b.slice(te),C):[];ue=ue.map(Ae=>new s.pointGeometry(Tt(Ae.x),Ae.y)),ae=ae.map(Ae=>new s.pointGeometry(Tt(Ae.x),Ae.y));const pe=[...ue];pe.length===0&&pe.push(ae[ae.length-1]);const Ce=s.number(pe[pe.length-1].y,(ae.length===0?ue[0]:ae[0]).y,W);let we;return we=Q?[new s.pointGeometry(0,Ce),new s.pointGeometry(0,0),new s.pointGeometry(1,0),new s.pointGeometry(1,Ce)]:[new s.pointGeometry(1,Ce),new s.pointGeometry(1,1),new s.pointGeometry(0,1),new s.pointGeometry(0,Ce)],pe.push(...we),ae.length===0?pe.push(ue[0]):pe.push(...ae),{polygon:pe.map(Ae=>new s.MercatorCoordinate(Ae.x,Ae.y)),unwrapped:!1}}(r,u);if(m)return m;const y=function(b,C){let I=!1,M=-1/0,B=0;for(let j=0;j<b.length-1;j++)b[j].x>M&&(M=b[j].x,B=j);for(let j=0;j<b.length-1;j++){const H=(B+j)%(b.length-1),Q=b[H],J=b[H+1];Math.abs(Q.x-J.x)>.5&&(Q.x<J.x?(Q.x+=1,H===0&&(b[b.length-1].x+=1)):(J.x+=1,H+1===b.length-1&&(b[0].x+=1)),I=!0)}const O=s.mercatorXfromLng(C.center.lng);return I&&O<Math.abs(O-1)&&b.forEach(j=>{j.x-=1}),{polygon:b,unwrapped:I}}(bt(r,u).map(b=>new s.pointGeometry(Tt(b.x),b.y)),u);return{polygon:y.polygon.map(b=>new s.MercatorCoordinate(b.x,b.y)),unwrapped:y.unwrapped}}}function bt(f,r){return s.resample(f,u=>{const m=r.pointCoordinate3D(u);u.x=m.x,u.y=m.y},1/256)}function Tt(f){return f<0?1+f%1:f%1}function Ut(f){return 100*f|0}function pn(f,r,u,m,y){const b=function(C,I){if(C)return y(C);if(I){f.url&&I.tiles&&f.tiles&&delete f.tiles;const M=s.pick(s.extend(I,f),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(M.vectorLayers=I.vector_layers,M.vectorLayerIds=M.vectorLayers.map(B=>B.id)),M.tiles=r.canonicalizeTileset(M,f.url),y(null,M)}};return f.url?s.getJSON(r.transformRequest(r.normalizeSourceURL(f.url,null,u,m),s.ResourceType.Source),b):s.exported.frame(()=>b(null,f))}class Dn{constructor(r,u,m){this.bounds=s.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=u||0,this.maxzoom=m||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const u=Math.pow(2,r.z),m=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*u),y=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*u),b=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*u),C=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*u);return r.x>=m&&r.x<b&&r.y>=y&&r.y<C}}class _n{constructor(r,u,m){this.context=r;const y=r.gl;this.buffer=y.createBuffer(),this.dynamicDraw=Boolean(m),this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const he={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Me{constructor(r,u,m,y){this.length=u.length,this.attributes=m,this.itemSize=u.bytesPerElement,this.dynamicDraw=y,this.context=r;const b=r.gl;this.buffer=b.createBuffer(),r.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,u){for(let m=0;m<this.attributes.length;m++){const y=u.attributes[this.attributes[m].name];y!==void 0&&r.enableVertexAttribArray(y)}}setVertexAttribPointers(r,u,m){for(let y=0;y<this.attributes.length;y++){const b=this.attributes[y],C=u.attributes[b.name];C!==void 0&&r.vertexAttribPointer(C,b.components,r[he[b.type]],!1,this.itemSize,b.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class qe{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class st extends qe{getDefault(){return s.Color.transparent}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class yt extends qe{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Dt extends qe{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Nt extends qe{getDefault(){return[!0,!0,!0,!0]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Pt extends qe{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Ft extends qe{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Et extends qe{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const u=this.current;(r.func!==u.func||r.ref!==u.ref||r.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Jt extends qe{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Wt extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=r,this.dirty=!1}}class on extends qe{getDefault(){return[0,1]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class fn extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=r,this.dirty=!1}}class Tn extends qe{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class jn extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.BLEND):u.disable(u.BLEND),this.current=r,this.dirty=!1}}class Gn extends qe{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class vi extends qe{getDefault(){return s.Color.transparent}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class rr extends qe{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Hi extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=r,this.dirty=!1}}class us extends qe{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class zr extends qe{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class yo extends qe{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class tr extends qe{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class cr extends qe{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class $o extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class js extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class El extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Gs extends qe{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class ao extends qe{getDefault(){return null}set(r){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class qs extends qe{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class qc extends qe{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class Zc extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Aa extends qe{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Zs extends qe{constructor(r,u){super(r),this.context=r,this.parent=u}getDefault(){return null}}class Zr extends Zs{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class hs extends Zs{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Wc extends hs{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ws{constructor(r,u,m,y){this.context=r,this.width=u,this.height=m;const b=this.framebuffer=r.gl.createFramebuffer();this.colorAttachment=new Zr(r,b),y&&(this.depthAttachment=new hs(r,b))}destroy(){const r=this.context.gl,u=this.colorAttachment.get();if(u&&r.deleteTexture(u),this.depthAttachment){const m=this.depthAttachment.get();m&&r.deleteRenderbuffer(m)}r.deleteFramebuffer(this.framebuffer)}}class se{constructor(r,u=!1){if(this.gl=r,this.isWebGL2=u,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),u){const m=r;this.extVertexArrayObject={createVertexArrayOES:m.createVertexArray.bind(r),deleteVertexArrayOES:m.deleteVertexArray.bind(r),bindVertexArrayOES:m.bindVertexArray.bind(r)}}this.clearColor=new st(this),this.clearDepth=new yt(this),this.clearStencil=new Dt(this),this.colorMask=new Nt(this),this.depthMask=new Pt(this),this.stencilMask=new Ft(this),this.stencilFunc=new Et(this),this.stencilOp=new Jt(this),this.stencilTest=new Wt(this),this.depthRange=new on(this),this.depthTest=new fn(this),this.depthFunc=new Tn(this),this.blend=new jn(this),this.blendFunc=new Gn(this),this.blendColor=new vi(this),this.blendEquation=new rr(this),this.cullFace=new Hi(this),this.cullFaceSide=new us(this),this.frontFace=new zr(this),this.program=new yo(this),this.activeTexture=new tr(this),this.viewport=new cr(this),this.bindFramebuffer=new $o(this),this.bindRenderbuffer=new js(this),this.bindTexture=new El(this),this.bindVertexBuffer=new Gs(this),this.bindElementBuffer=new ao(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new qs(this),this.pixelStoreUnpack=new qc(this),this.pixelStoreUnpackPremultiplyAlpha=new Zc(this),this.pixelStoreUnpackFlipY=new Aa(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),u||(this.extTextureHalfFloat=r.getExtension("OES_texture_half_float")),(u||this.extTextureHalfFloat&&r.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=u||r.getExtension("OES_standard_derivatives"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,u){return new _n(this,r,u)}createVertexBuffer(r,u,m){return new Me(this,r,u,m)}createRenderbuffer(r,u,m){const y=this.gl,b=y.createRenderbuffer();return this.bindRenderbuffer.set(b),y.renderbufferStorage(y.RENDERBUFFER,r,u,m),this.bindRenderbuffer.set(null),b}createFramebuffer(r,u,m){return new Ws(this,r,u,m)}clear({color:r,depth:u,stencil:m}){const y=this.gl;let b=0;r&&(b|=y.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(b|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),m!==void 0&&(b|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),y.clear(b)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){w(r.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class U extends s.Evented{constructor(r,u,m,y){if(super(),this.id=r,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(u,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(r){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map._worldview;this._tileJSONRequest=pn(this._options,this.map._requestManager,u,m,(y,b)=>{this._tileJSONRequest=null,this._loaded=!0,y?(u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),m&&m.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new s.ErrorEvent(y))):b&&(s.extend(this,b),b.bounds&&(this.tileBounds=new Dn(b.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(b.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),r&&r(y)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(r,u){const m=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(m,s.ResourceType.Tile),data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile};if(y.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=u:r.request=r.actor.send("reloadTile",y,b.bind(this));else if(r.actor=this._tileWorkers[m]=this._tileWorkers[m]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",y,b.bind(this),void 0,!0);else{const C=s.loadVectorTile.call({deduped:this._deduped},y,(I,M)=>{I||!M?b.call(this,I):(y.data={cacheControl:M.cacheControl,expires:M.expires,rawData:M.rawData.slice(0)},r.actor&&r.actor.send("loadTile",y,b.bind(this),void 0,!0))},!0);r.request={cancel:C}}function b(C,I){return delete r.request,r.aborted?u(null):C&&C.status!==404?u(C):(I&&I.resourceTiming&&(r.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&r.setExpiryData(I),r.loadVectorData(I,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id})}unloadTile(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class q extends s.Evented{constructor(r,u,m,y){super(),this.id=r,this.dispatcher=m,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},u),s.extend(this,s.pick(u,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=pn(this._options,this.map._requestManager,null,null,(u,m)=>{this._tileJSONRequest=null,this._loaded=!0,u?this.fire(new s.ErrorEvent(u)):m&&(s.extend(this,m),m.bounds&&(this.tileBounds=new Dn(m.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(m.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),r&&r(u)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,u){const m=s.exported.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);r.request=s.getImage(this.map._requestManager.transformRequest(y,s.ResourceType.Tile),(b,C,I,M)=>(delete r.request,r.aborted?(r.state="unloaded",u(null)):b?(r.state="errored",u(b)):C?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:I,expires:M}),r.setTexture(C,this.map.painter),r.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void u(null)):u(null)))}static loadTileData(r,u,m){r.setTexture(u,m)}static unloadTileData(r,u){r.texture&&u.saveTileTexture(r.texture)}abortTile(r,u){r.request&&(r.request.cancel(),delete r.request),u()}unloadTile(r,u){r.texture&&this.map.painter.saveTileTexture(r.texture),u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let oe;function me(f,r,u,m,y,b,C,I){const M=[f,u,y,r,m,b,1,1,1],B=[C,I,1],O=s.adjoint([],M),[j,H,Q]=s.transformMat3(B,B,s.transpose(O,O));return s.multiply$1(M,[j,0,0,0,H,0,0,0,Q],M)}class Ie extends s.Evented{constructor(r,u,m,y){super(),this.id=r,this.dispatcher=m,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=u,this._dirty=!1}load(r,u){this._loaded=u||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(m,y)=>{if(this._imageRequest=null,this._loaded=!0,m)this.fire(new s.ErrorEvent(m));else if(y){const{HTMLImageElement:b}=s.window;this.image=y instanceof b?s.exported.getImageData(y):y,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading()}})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(r){this.coordinates=r,this._boundsArray=void 0;const u=r.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(m){let y=1/0,b=1/0,C=-1/0,I=-1/0;for(const j of m)y=Math.min(y,j.x),b=Math.min(b,j.y),C=Math.max(C,j.x),I=Math.max(I,j.y);const M=Math.max(C-y,I-b),B=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),O=Math.pow(2,B);return new s.CanonicalTileID(B,Math.floor((y+C)/2*O),Math.floor((b+I)/2*O))}(u),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(r){for(const M in this.tiles){const B=this.tiles[M];B.state!=="loaded"&&(B.state="loaded",B.texture=this.texture)}if(this._boundsArray)return;const u=s.tileTransform(this.tileID,this.map.transform.projection),[m,y,b,C]=this.coordinates.map(M=>{const B=u.projection.project(M[0],M[1]);return s.getTilePoint(u,B)._round()});this.perspectiveTransform=function(M,B,O,j,H,Q,J,ee,te,W){const ue=me(0,0,M,0,0,B,M,B),ae=me(O,j,H,Q,J,ee,te,W);return s.multiply$1(ae,s.adjoint(ue,ue),ae),[ae[6]/ae[8]*M/s.EXTENT,ae[7]/ae[8]*B/s.EXTENT]}(this.width,this.height,m.x,m.y,y.x,y.y,C.x,C.y,b.x,b.y);const I=this._boundsArray=new s.StructArrayLayout4i8;I.emplaceBack(m.x,m.y,0,0),I.emplaceBack(y.x,y.y,s.EXTENT,0),I.emplaceBack(C.x,C.y,0,s.EXTENT),I.emplaceBack(b.x,b.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=r.createVertexBuffer(I,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,u=r.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(r,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(r)}loadTile(r,u){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},u(null)):(r.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Oe={vector:U,raster:q,"raster-dem":class extends q{constructor(f,r,u,m){super(f,r,u,m),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(f,r){const u=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(y,b){y&&(f.state="errored",r(y)),b&&(f.dem=b,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",r(null))}f.request=s.getImage(this.map._requestManager.transformRequest(u,s.ResourceType.Tile),function(y,b,C,I){if(delete f.request,f.aborted)f.state="unloaded",r(null);else if(y)f.state="errored",r(y);else if(b){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:C,expires:I});const M=s.window.ImageBitmap&&b instanceof s.window.ImageBitmap&&(oe==null&&(oe=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),oe),B=1-(b.width-s.prevPowerOfTwo(b.width))/2;B<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const O=M?b:s.exported.getImageData(b,B),j={uid:f.uid,coord:f.tileID,source:this.id,rawImageData:O,encoding:this.encoding,padding:B};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",j,m.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(f){const r=f.canonical,u=Math.pow(2,r.z),m=(r.x-1+u)%u,y=r.x===0?f.wrap-1:f.wrap,b=(r.x+1+u)%u,C=r.x+1===u?f.wrap+1:f.wrap,I={};return I[new s.OverscaledTileID(f.overscaledZ,y,r.z,m,r.y).key]={backfilled:!1},I[new s.OverscaledTileID(f.overscaledZ,C,r.z,b,r.y).key]={backfilled:!1},r.y>0&&(I[new s.OverscaledTileID(f.overscaledZ,y,r.z,m,r.y-1).key]={backfilled:!1},I[new s.OverscaledTileID(f.overscaledZ,f.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},I[new s.OverscaledTileID(f.overscaledZ,C,r.z,b,r.y-1).key]={backfilled:!1}),r.y+1<u&&(I[new s.OverscaledTileID(f.overscaledZ,y,r.z,m,r.y+1).key]={backfilled:!1},I[new s.OverscaledTileID(f.overscaledZ,f.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},I[new s.OverscaledTileID(f.overscaledZ,C,r.z,b,r.y+1).key]={backfilled:!1}),I}unloadTile(f){f.demTexture&&this.map.painter.saveTileTexture(f.demTexture),f.fbo&&(f.fbo.destroy(),delete f.fbo),f.dem&&delete f.dem,delete f.neighboringTiles,f.state="unloaded"}},geojson:class extends s.Evented{constructor(f,r,u,m){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(m),this._data=r.data,this._options=s.extend({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const y=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*y,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*y,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:s.EXTENT,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*y,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}getClusterExpansionZoom(f,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id},r),this}getClusterChildren(f,r){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id},r),this}getClusterLeaves(f,r,u,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:f,limit:r,offset:u},m),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const f=s.extend({},this.workerOptions),r=this._data;typeof r=="string"?(f.request=this.map._requestManager.transformRequest(s.exported.resolveURL(r),s.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,f,(u,m)=>{if(this._loaded=!0,this._pendingLoad=null,u)this.fire(new s.ErrorEvent(u));else{const y={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&m&&m.resourceTiming&&m.resourceTiming[this.id]&&(y.resourceTiming=m.resourceTiming[this.id]),this.fire(new s.Event("data",y)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,r){const u=f.actor?"reloadTile":"loadTile";f.actor=this.actor,f.request=this.actor.send(u,{type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(m,y)=>(delete f.request,f.unloadVectorData(),f.aborted?r(null):m?r(m):(f.loadVectorData(y,this.map.painter,u==="reloadTile"),r(null))),void 0,u==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f){f.unloadVectorData(),this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ie{constructor(f,r,u,m){super(f,r,u,m),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const r of f.urls)this.urls.push(this.map._requestManager.transformRequest(r,s.ResourceType.Source).url);s.getVideo(this.urls,(r,u)=>{this._loaded=!0,r?this.fire(new s.ErrorEvent(r)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const r=this.video.seekable;f<r.start(0)||f>r.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,r=f.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(f,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ie,canvas:class extends Ie{constructor(f,r,u,m){super(f,r,u,m),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(b=>typeof b!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${f}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?(f||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(r,this.canvas,r.gl.RGBA,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends s.Evented{constructor(f,r,u,m){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=r,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Dn(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this._map=f,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:r,y:u,z:m}=f.canonical;return this._implementation.hasTile({x:r,y:u,z:m})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,r){const{x:u,y:m,z:y}=f.tileID.canonical,b=new s.window.AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:u,y:m,z:y},{signal:b.signal})).then(function(C){return delete f.request,f.aborted?(f.state="unloaded",r(null)):C===void 0?(f.state="errored",r(null)):C===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",r(null)):function(I){return I instanceof s.window.ImageData||I instanceof s.window.HTMLCanvasElement||I instanceof s.window.ImageBitmap||I instanceof s.window.HTMLImageElement}(C)?(this.loadTileData(f,C),f.state="loaded",void r(null)):(f.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(C=>{C.code!==20&&(f.state="errored",r(C))}),f.request.cancel=()=>b.abort()}loadTileData(f,r){q.loadTileData(f,r,this._map.painter)}unloadTileData(f){q.unloadTileData(f,this._map.painter)}unloadTile(f,r){if(this.unloadTileData(f),this._implementation.unloadTile){const{x:u,y:m,z:y}=f.tileID.canonical;this._implementation.unloadTile({x:u,y:m,z:y})}r()}abortTile(f,r){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),r()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Re=function(f,r,u,m){const y=new Oe[r.type](f,r,u,m);if(y.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${y.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],y),y};function ke(f,r){const u=s.identity([]);return s.scale(u,u,[.5*f.width,.5*-f.height,1]),s.translate(u,u,[1,-1,0]),s.multiply(u,u,f.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(u)}function Ve(f,r,u,m,y,b,C,I=!1){const M=f.tilesIn(m,C,I);M.sort(Bt);const B=[];for(const j of M)B.push({wrappedTileID:j.tile.tileID.wrapped().key,queryResults:j.tile.queryRenderedFeatures(r,u,f._state,j,y,b,ke(f.transform,j.tile.tileID),I)});const O=function(j){const H={},Q={};for(const J of j){const ee=J.queryResults,te=J.wrappedTileID,W=Q[te]=Q[te]||{};for(const ue in ee){const ae=ee[ue],pe=W[ue]=W[ue]||{},Ce=H[ue]=H[ue]||[];for(const we of ae)pe[we.featureIndex]||(pe[we.featureIndex]=!0,Ce.push(we))}}return H}(B);for(const j in O)O[j].forEach(H=>{const Q=H.feature,J=Q.layer;J&&J.type!=="background"&&J.type!=="sky"&&(Q.source=J.source,J["source-layer"]&&(Q.sourceLayer=J["source-layer"]),Q.state=Q.id!==void 0?f.getFeatureState(J["source-layer"],Q.id):{})});return O}function ut(f,r){const u=f.getRenderableIds().map(b=>f.getTileByID(b)),m=[],y={};for(let b=0;b<u.length;b++){const C=u[b],I=C.tileID.canonical.key;y[I]||(y[I]=!0,C.querySourceFeatures(m,r))}return m}function Bt(f,r){const u=f.tileID,m=r.tileID;return u.overscaledZ-m.overscaledZ||u.canonical.y-m.canonical.y||u.wrap-m.wrap||u.canonical.x-m.canonical.x}function gt(){return Ql.workerClass!=null?new Ql.workerClass:new s.window.Worker(Ql.workerUrl)}const tn="mapboxgl_preloaded_worker_pool";class Qt{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Qt.workerCount;)this.workers.push(new gt);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[tn]}numActive(){return Object.keys(this.active).length}}let Kt;function un(){return Kt||(Kt=new Qt),Kt}function yn(f,r){const u={};for(const m in f)m!=="ref"&&(u[m]=f[m]);return s.refProperties.forEach(m=>{m in r&&(u[m]=r[m])}),u}function qn(f){f=f.slice();const r=Object.create(null);for(let u=0;u<f.length;u++)r[f[u].id]=f[u];for(let u=0;u<f.length;u++)"ref"in f[u]&&(f[u]=yn(f[u],r[f[u].ref]));return f}Qt.workerCount=2;const sn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function ei(f,r,u){u.push({command:sn.addSource,args:[f,r[f]]})}function ti(f,r,u){r.push({command:sn.removeSource,args:[f]}),u[f]=!0}function ds(f,r,u,m){ti(f,u,m),ei(f,r,u)}function Uo(f,r,u){let m;for(m in f[u])if(f[u].hasOwnProperty(m)&&m!=="data"&&!w(f[u][m],r[u][m]))return!1;for(m in r[u])if(r[u].hasOwnProperty(m)&&m!=="data"&&!w(f[u][m],r[u][m]))return!1;return!0}function et(f,r,u,m,y,b){let C;for(C in r=r||{},f=f||{})f.hasOwnProperty(C)&&(w(f[C],r[C])||u.push({command:b,args:[m,C,r[C],y]}));for(C in r)r.hasOwnProperty(C)&&!f.hasOwnProperty(C)&&(w(f[C],r[C])||u.push({command:b,args:[m,C,r[C],y]}))}function jo(f){return f.id}function Vi(f,r){return f[r.id]=r,f}class fs{constructor(r,u){this.reset(r,u)}reset(r,u){this.points=r||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=s.clamp(r,0,1);let u=1,m=this._distances[u];const y=r*this.paddedLength+this.padding;for(;m<y&&u<this._distances.length;)m=this._distances[++u];const b=u-1,C=this._distances[b],I=m-C,M=I>0?(y-C)/I:0;return this.points[b].mult(1-M).add(this.points[u].mult(M))}}class Qf{constructor(r,u,m){const y=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(r/m),this.yCellCount=Math.ceil(u/m);for(let C=0;C<this.xCellCount*this.yCellCount;C++)y.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=u,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,u,m,y,b){this._forEachCell(u,m,y,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(y),this.bboxes.push(b)}insertCircle(r,u,m,y){this._forEachCell(u-y,m-y,u+y,m+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(u),this.circles.push(m),this.circles.push(y)}_insertBoxCell(r,u,m,y,b,C){this.boxCells[b].push(C)}_insertCircleCell(r,u,m,y,b,C){this.circleCells[b].push(C)}_query(r,u,m,y,b,C){if(m<0||r>this.width||y<0||u>this.height)return!b&&[];const I=[];if(r<=0&&u<=0&&this.width<=m&&this.height<=y){if(b)return!0;for(let M=0;M<this.boxKeys.length;M++)I.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const B=this.circles[3*M],O=this.circles[3*M+1],j=this.circles[3*M+2];I.push({key:this.circleKeys[M],x1:B-j,y1:O-j,x2:B+j,y2:O+j})}return C?I.filter(C):I}return this._forEachCell(r,u,m,y,this._queryCell,I,{hitTest:b,seenUids:{box:{},circle:{}}},C),b?I.length>0:I}_queryCircle(r,u,m,y,b){const C=r-m,I=r+m,M=u-m,B=u+m;if(I<0||C>this.width||B<0||M>this.height)return!y&&[];const O=[];return this._forEachCell(C,M,I,B,this._queryCellCircle,O,{hitTest:y,circle:{x:r,y:u,radius:m},seenUids:{box:{},circle:{}}},b),y?O.length>0:O}query(r,u,m,y,b){return this._query(r,u,m,y,!1,b)}hitTest(r,u,m,y,b){return this._query(r,u,m,y,!0,b)}hitTestCircle(r,u,m,y){return this._queryCircle(r,u,m,!0,y)}_queryCell(r,u,m,y,b,C,I,M){const B=I.seenUids,O=this.boxCells[b];if(O!==null){const H=this.bboxes;for(const Q of O)if(!B.box[Q]){B.box[Q]=!0;const J=4*Q;if(r<=H[J+2]&&u<=H[J+3]&&m>=H[J+0]&&y>=H[J+1]&&(!M||M(this.boxKeys[Q]))){if(I.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[Q],x1:H[J],y1:H[J+1],x2:H[J+2],y2:H[J+3]})}}}const j=this.circleCells[b];if(j!==null){const H=this.circles;for(const Q of j)if(!B.circle[Q]){B.circle[Q]=!0;const J=3*Q;if(this._circleAndRectCollide(H[J],H[J+1],H[J+2],r,u,m,y)&&(!M||M(this.circleKeys[Q]))){if(I.hitTest)return C.push(!0),!0;{const ee=H[J],te=H[J+1],W=H[J+2];C.push({key:this.circleKeys[Q],x1:ee-W,y1:te-W,x2:ee+W,y2:te+W})}}}}}_queryCellCircle(r,u,m,y,b,C,I,M){const B=I.circle,O=I.seenUids,j=this.boxCells[b];if(j!==null){const Q=this.bboxes;for(const J of j)if(!O.box[J]){O.box[J]=!0;const ee=4*J;if(this._circleAndRectCollide(B.x,B.y,B.radius,Q[ee+0],Q[ee+1],Q[ee+2],Q[ee+3])&&(!M||M(this.boxKeys[J])))return C.push(!0),!0}}const H=this.circleCells[b];if(H!==null){const Q=this.circles;for(const J of H)if(!O.circle[J]){O.circle[J]=!0;const ee=3*J;if(this._circlesCollide(Q[ee],Q[ee+1],Q[ee+2],B.x,B.y,B.radius)&&(!M||M(this.circleKeys[J])))return C.push(!0),!0}}}_forEachCell(r,u,m,y,b,C,I,M){const B=this._convertToXCellCoord(r),O=this._convertToYCellCoord(u),j=this._convertToXCellCoord(m),H=this._convertToYCellCoord(y);for(let Q=B;Q<=j;Q++)for(let J=O;J<=H;J++)if(b.call(this,r,u,m,y,this.xCellCount*J+Q,C,I,M))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,u,m,y,b,C){const I=y-r,M=b-u,B=m+C;return B*B>I*I+M*M}_circleAndRectCollide(r,u,m,y,b,C,I){const M=(C-y)/2,B=Math.abs(r-(y+M));if(B>M+m)return!1;const O=(I-b)/2,j=Math.abs(u-(b+O));if(j>O+m)return!1;if(B<=M||j<=O)return!0;const H=B-M,Q=j-O;return H*H+Q*Q<=m*m}}const xo=Math.tan(85*Math.PI/180);function ka(f,r,u,m,y,b,C){const I=s.create();if(u)if(b.name==="globe"){const M=s.calculateGlobeLabelMatrix(y,r);s.multiply(I,I,M)}else{const M=Se([],C);I[0]=M[0],I[1]=M[1],I[4]=M[2],I[5]=M[3],m||s.rotateZ(I,I,y.angle)}else s.multiply(I,y.labelPlaneMatrix,f);return I}function ep(f,r,u,m,y,b,C){const I=ka(f,r,u,m,y,b,C);return b.name==="globe"&&u||(I[2]=I[6]=I[10]=I[14]=0),I}function Ma(f,r,u,m,y,b,C){if(u){if(b.name==="globe"){const I=ka(f,r,u,m,y,b,C);return s.invert(I,I),s.multiply(I,f,I),I}{const I=s.clone(f),M=s.identity([]);return M[0]=C[0],M[1]=C[1],M[4]=C[2],M[5]=C[3],s.multiply(I,I,M),m||s.rotateZ(I,I,-y.angle),I}}return y.glCoordMatrix}function Ct(f,r,u,m){const y=[f,r,u,1];u?s.transformMat4$1(y,y,m):tp(y,y,m);const b=y[3];return y[0]/=b,y[1]/=b,y[2]/=b,y}function zn(f,r){return Math.min(.5+f/r*.5,1.5)}function Cn(f,r){const u=f[0]/f[3],m=f[1]/f[3];return u>=-r[0]&&u<=r[0]&&m>=-r[1]&&m<=r[1]}function bo(f,r,u,m,y,b,C,I,M,B){const O=u.transform,j=m?f.textSizeData:f.iconSizeData,H=s.evaluateSizeForZoom(j,u.transform.zoom),Q=O.projection.name==="globe",J=[256/u.width*2+1,256/u.height*2+1],ee=m?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;ee.clear();let te=null;Q&&(te=m?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const W=f.lineVertexArray,ue=m?f.text.placedSymbolArray:f.icon.placedSymbolArray,ae=u.transform.width/u.transform.height;let pe,Ce=!1;for(let we=0;we<ue.length;we++){const Ae=ue.get(we),{numGlyphs:Be,writingMode:$e}=Ae;if($e!==s.WritingMode.vertical||Ce||pe===s.WritingMode.horizontal||(Ce=!0),pe=$e,(Ae.hidden||$e===s.WritingMode.vertical)&&!Ce){ci(Be,ee);continue}Ce=!1;const Ge=new s.pointGeometry(Ae.tileAnchorX,Ae.tileAnchorY);let{x:wt,y:Fe,z:rt}=O.projection.projectTilePoint(Ge.x,Ge.y,B.canonical);if(M){const[vn,jt,Vt]=M(Ge);wt+=vn,Fe+=jt,rt+=Vt}const He=[wt,Fe,rt,1];if(s.transformMat4$1(He,He,r),!Cn(He,J)){ci(Be,ee);continue}const ht=zn(u.transform.cameraToCenterDistance,He[3]),Ue=s.evaluateSizeForFeature(j,H,Ae),Le=C?Ue/ht:Ue*ht,Ze=Ct(wt,Fe,rt,y);if(Ze[3]<=0){ci(Be,ee);continue}let lt={};const mt=C?null:M,Ht=Sl(Ae,Le,!1,I,r,y,b,f.glyphOffsetArray,W,ee,te,Ze,Ge,lt,ae,mt,O.projection,B,C);Ce=Ht.useVertical,mt&&Ht.needsFlipping&&(lt={}),(Ht.notEnoughRoom||Ce||Ht.needsFlipping&&Sl(Ae,Le,!0,I,r,y,b,f.glyphOffsetArray,W,ee,te,Ze,Ge,lt,ae,mt,O.projection,B,C).notEnoughRoom)&&ci(Be,ee)}m?(f.text.dynamicLayoutVertexBuffer.updateData(ee),te&&f.text.globeExtVertexBuffer.updateData(te)):(f.icon.dynamicLayoutVertexBuffer.updateData(ee),te&&f.icon.globeExtVertexBuffer.updateData(te))}function Hs(f,r,u,m,y,b,C,I,M,B,O,j,H,Q,J,ee){const{lineStartIndex:te,glyphStartIndex:W,segment:ue}=I,ae=W+I.numGlyphs,pe=te+I.lineLength,Ce=r.getoffsetX(W),we=r.getoffsetX(ae-1),Ae=Ir(f*Ce,u,m,y,b,C,ue,te,pe,M,B,O,j,H,!0,Q,J,ee);if(!Ae)return null;const Be=Ir(f*we,u,m,y,b,C,ue,te,pe,M,B,O,j,H,!0,Q,J,ee);return Be?{first:Ae,last:Be}:null}function bn(f,r,u,m){return f===s.WritingMode.horizontal&&Math.abs(m)>Math.abs(u)?{useVertical:!0}:f===s.WritingMode.vertical?m>0?{needsFlipping:!0}:null:r!==0&&function(y,b){return y===0||Math.abs(b/y)>xo}(u,m)?r===1?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function Sl(f,r,u,m,y,b,C,I,M,B,O,j,H,Q,J,ee,te,W,ue){const ae=r/24,pe=f.lineOffsetX*ae,Ce=f.lineOffsetY*ae,{lineStartIndex:we,glyphStartIndex:Ae,numGlyphs:Be,segment:$e,writingMode:Ge,flipState:wt}=f,Fe=we+f.lineLength,rt=He=>{if(O){const[Ze,lt,mt]=He.up,Ht=B.length;s.updateGlobeVertexNormal(O,Ht+0,Ze,lt,mt),s.updateGlobeVertexNormal(O,Ht+1,Ze,lt,mt),s.updateGlobeVertexNormal(O,Ht+2,Ze,lt,mt),s.updateGlobeVertexNormal(O,Ht+3,Ze,lt,mt)}const[ht,Ue,Le]=He.point;s.addDynamicAttributes(B,ht,Ue,Le,He.angle)};if(Be>1){const He=Hs(ae,I,pe,Ce,u,j,H,f,M,b,Q,ee,!1,te,W,ue);if(!He)return{notEnoughRoom:!0};if(m&&!u){let[ht,Ue,Le]=He.first.point,[Ze,lt,mt]=He.last.point;[ht,Ue]=Ct(ht,Ue,Le,C),[Ze,lt]=Ct(Ze,lt,mt,C);const Ht=bn(Ge,wt,(Ze-ht)*J,lt-Ue);if(f.flipState=Ht&&Ht.needsFlipping?1:2,Ht)return Ht}rt(He.first);for(let ht=Ae+1;ht<Ae+Be-1;ht++){const Ue=Ir(ae*I.getoffsetX(ht),pe,Ce,u,j,H,$e,we,Fe,M,b,Q,ee,!1,!1,te,W,ue);if(!Ue)return B.length-=4*(ht-Ae),{notEnoughRoom:!0};rt(Ue)}rt(He.last)}else{if(m&&!u){const ht=Ct(H.x,H.y,0,y),Ue=we+$e+1,Le=new s.pointGeometry(M.getx(Ue),M.gety(Ue)),Ze=Ct(Le.x,Le.y,0,y),lt=Ze[3]>0?Ze:za(H,Le,ht,1,y,void 0,te,W.canonical),mt=bn(Ge,wt,(lt[0]-ht[0])*J,lt[1]-ht[1]);if(f.flipState=mt&&mt.needsFlipping?1:2,mt)return mt}const He=Ir(ae*I.getoffsetX(Ae),pe,Ce,u,j,H,$e,we,Fe,M,b,Q,ee,!1,!1,te,W,ue);if(!He)return{notEnoughRoom:!0};rt(He)}return{}}function Pa(f,r,u,m,y){const{x:b,y:C,z:I}=m.projectTilePoint(f.x,f.y,r);if(!y)return Ct(b,C,I,u);const[M,B,O]=y(f);return Ct(b+M,C+B,I+O,u)}function za(f,r,u,m,y,b,C,I){const M=Pa(f.sub(r)._unit()._add(f),I,y,C,b);return s.sub(M,u,M),s.normalize(M,M),s.scaleAndAdd(M,u,M,m)}function Ir(f,r,u,m,y,b,C,I,M,B,O,j,H,Q,J,ee,te,W){const ue=m?f-r:f+r;let ae=ue>0?1:-1,pe=0;m&&(ae*=-1,pe=Math.PI),ae<0&&(pe+=Math.PI);let Ce=I+C+(ae>0?0:1)|0,we=y,Ae=y,Be=0,$e=0;const Ge=Math.abs(ue),wt=[],Fe=[];let rt=b,He=rt;const ht=()=>za(He,rt,Ae,Ge-Be+1,O,H,ee,te.canonical);for(;Be+$e<=Ge;){if(Ce+=ae,Ce<I||Ce>=M)return null;if(Ae=we,He=rt,wt.push(Ae),Q&&Fe.push(He),rt=new s.pointGeometry(B.getx(Ce),B.gety(Ce)),we=j[Ce],!we){const Vt=Pa(rt,te.canonical,O,ee,H);we=Vt[3]>0?j[Ce]=Vt:ht()}Be+=$e,$e=s.distance(Ae,we)}J&&H&&(j[Ce]&&(we=ht(),$e=s.distance(Ae,we)),j[Ce]=we);const Ue=(Ge-Be)/$e,Le=rt.sub(He)._mult(Ue)._add(He),Ze=s.sub([],we,Ae),lt=s.scaleAndAdd([],Ae,Ze,Ue);let mt=[0,0,1],Ht=Ze[0],vn=Ze[1];if(W&&(mt=ee.upVector(te.canonical,Le.x,Le.y),mt[0]!==0||mt[1]!==0||mt[2]!==1)){const Vt=[mt[2],0,-mt[0]],Xt=s.cross([],mt,Vt);s.normalize(Vt,Vt),s.normalize(Xt,Xt),Ht=s.dot(Ze,Vt),vn=s.dot(Ze,Xt)}if(u){const Vt=s.cross([],mt,Ze);s.normalize(Vt,Vt),s.scaleAndAdd(lt,lt,Vt,u*ae)}const jt=pe+Math.atan2(vn,Ht);return wt.push(lt),Q&&Fe.push(Le),{point:lt,angle:jt,path:wt,tilePath:Fe,up:mt}}function ci(f,r){const u=r.length,m=u+4*f;r.resize(m),r.float32.fill(-1/0,4*u,4*m)}function tp(f,r,u){const m=r[0],y=r[1];return f[0]=u[0]*m+u[4]*y+u[12],f[1]=u[1]*m+u[5]*y+u[13],f[3]=u[3]*m+u[7]*y+u[15],f}const Lr=100;class kh{constructor(r,u,m=new Qf(r.width+200,r.height+200,25),y=new Qf(r.width+200,r.height+200,25)){this.transform=r,this.grid=m,this.ignoredGrid=y,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Lr,this.screenBottomBoundary=r.height+Lr,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=u}placeCollisionBox(r,u,m,y,b,C,I,M){let B=m.projectedAnchorX,O=m.projectedAnchorY,j=m.projectedAnchorZ;const H=m.elevation,Q=m.tileID,J=r.getProjection();if(H&&Q){const[we,Ae,Be]=J.upVector(Q.canonical,m.tileAnchorX,m.tileAnchorY),$e=J.upVectorScale(Q.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;B+=we*H*$e,O+=Ae*H*$e,j+=Be*H*$e}const ee=this.projectAndGetPerspectiveRatio(I,B,O,j,m.tileID,J.name==="globe"||!!H||this.transform.pitch>0,J),te=C*ee.perspectiveRatio,W=(m.x1*u+y.x-m.padding)*te+ee.point.x,ue=(m.y1*u+y.y-m.padding)*te+ee.point.y,ae=(m.x2*u+y.x+m.padding)*te+ee.point.x,pe=(m.y2*u+y.y+m.padding)*te+ee.point.y,Ce=ee.perspectiveRatio<=.55||ee.occluded;return!this.isInsideGrid(W,ue,ae,pe)||!b&&this.grid.hitTest(W,ue,ae,pe,M)||Ce?{box:[],offscreen:!1,occluded:ee.occluded}:{box:[W,ue,ae,pe],offscreen:this.isOffscreen(W,ue,ae,pe),occluded:!1}}placeCollisionCircles(r,u,m,y,b,C,I,M,B,O,j,H,Q,J,ee){const te=[],W=this.transform.elevation,ue=r.getProjection(),ae=W?W.getAtTileOffsetFunc(ee,this.transform.center.lat,this.transform.worldSize,ue):null,pe=new s.pointGeometry(m.tileAnchorX,m.tileAnchorY);let{x:Ce,y:we,z:Ae}=ue.projectTilePoint(pe.x,pe.y,ee.canonical);if(ae){const[Le,Ze,lt]=ae(pe);Ce+=Le,we+=Ze,Ae+=lt}const Be=ue.name==="globe",$e=this.projectAndGetPerspectiveRatio(I,Ce,we,Ae,ee,Be||!!W||this.transform.pitch>0,ue),{perspectiveRatio:Ge}=$e,wt=(j?C/Ge:C*Ge)/s.ONE_EM,Fe=Ct(Ce,we,Ae,M),rt=$e.signedDistanceFromCamera>0?Hs(wt,b,m.lineOffsetX*wt,m.lineOffsetY*wt,!1,Fe,pe,m,y,M,{},W&&!j?ae:null,j&&!!W,ue,ee,j):null;let He=!1,ht=!1,Ue=!0;if(rt&&!$e.occluded){const Le=.5*Q*Ge+J,Ze=new s.pointGeometry(-100,-100),lt=new s.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),mt=new fs,{first:Ht,last:vn}=rt,jt=Ht.path.length;let Vt=[];for(let en=jt-1;en>=1;en--)Vt.push(Ht.path[en]);for(let en=1;en<vn.path.length;en++)Vt.push(vn.path[en]);const Xt=2.5*Le;B&&(Vt=Vt.map(([en,Wn,ni],ui)=>(ae&&!Be&&(ni=ae(ui<jt-1?Ht.tilePath[jt-1-ui]:vn.tilePath[ui-jt+2])[2]),Ct(en,Wn,ni,B))),Vt.some(en=>en[3]<=0)&&(Vt=[]));let In=[];if(Vt.length>0){let en=1/0,Wn=-1/0,ni=1/0,ui=-1/0;for(const oi of Vt)en=Math.min(en,oi[0]),ni=Math.min(ni,oi[1]),Wn=Math.max(Wn,oi[0]),ui=Math.max(ui,oi[1]);Wn>=Ze.x&&en<=lt.x&&ui>=Ze.y&&ni<=lt.y&&(In=[Vt.map(oi=>new s.pointGeometry(oi[0],oi[1]))],(en<Ze.x||Wn>lt.x||ni<Ze.y||ui>lt.y)&&(In=s.clipLine(In,Ze.x,Ze.y,lt.x,lt.y)))}for(const en of In){mt.reset(en,.25*Le);let Wn=0;Wn=mt.length<=.5*Le?1:Math.ceil(mt.paddedLength/Xt)+1;for(let ni=0;ni<Wn;ni++){const ui=ni/Math.max(Wn-1,1),oi=mt.lerp(ui),Ni=oi.x+Lr,Br=oi.y+Lr;te.push(Ni,Br,Le,0);const lo=Ni-Le,Wo=Br-Le,_i=Ni+Le,si=Br+Le;if(Ue=Ue&&this.isOffscreen(lo,Wo,_i,si),ht=ht||this.isInsideGrid(lo,Wo,_i,si),!u&&this.grid.hitTestCircle(Ni,Br,Le,H)&&(He=!0,!O))return{circles:[],offscreen:!1,collisionDetected:He,occluded:!1}}}}return{circles:!O&&He||!ht?[]:te,offscreen:Ue,collisionDetected:He,occluded:$e.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let m=1/0,y=1/0,b=-1/0,C=-1/0;for(const O of r){const j=new s.pointGeometry(O.x+Lr,O.y+Lr);m=Math.min(m,j.x),y=Math.min(y,j.y),b=Math.max(b,j.x),C=Math.max(C,j.y),u.push(j)}const I=this.grid.query(m,y,b,C).concat(this.ignoredGrid.query(m,y,b,C)),M={},B={};for(const O of I){const j=O.key;if(M[j.bucketInstanceId]===void 0&&(M[j.bucketInstanceId]={}),M[j.bucketInstanceId][j.featureIndex])continue;const H=[new s.pointGeometry(O.x1,O.y1),new s.pointGeometry(O.x2,O.y1),new s.pointGeometry(O.x2,O.y2),new s.pointGeometry(O.x1,O.y2)];s.polygonIntersectsPolygon(u,H)&&(M[j.bucketInstanceId][j.featureIndex]=!0,B[j.bucketInstanceId]===void 0&&(B[j.bucketInstanceId]=[]),B[j.bucketInstanceId].push(j.featureIndex))}return B}insertCollisionBox(r,u,m,y,b){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:y,collisionGroupID:b},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,u,m,y,b){const C=u?this.ignoredGrid:this.grid,I={bucketInstanceId:m,featureIndex:y,collisionGroupID:b};for(let M=0;M<r.length;M+=4)C.insertCircle(I,r[M],r[M+1],r[M+2])}projectAndGetPerspectiveRatio(r,u,m,y,b,C,I){const M=[u,m,y,1];let B=!1;if(y||this.transform.pitch>0){s.transformMat4$1(M,M,r);const j=I.name==="globe";this.fogState&&b&&!j&&(B=function(Q,J,ee,te,W,ue){const ae=ue.calculateFogTileMatrix(W),pe=[J,ee,te];return s.transformMat4(pe,pe,ae),at(Q,pe,ue.pitch,ue._fov)}(this.fogState,u,m,y,b.toUnwrapped(),this.transform)>.9)}else tp(M,M,r);const O=M[3];return{point:new s.pointGeometry((M[0]/O+1)/2*this.transform.width+Lr,(-M[1]/O+1)/2*this.transform.height+Lr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/O*.5,1.5),signedDistanceFromCamera:O,occluded:C&&M[2]>O||B}}isOffscreen(r,u,m,y){return m<Lr||r>=this.screenRightBoundary||y<Lr||u>this.screenBottomBoundary}isInsideGrid(r,u,m,y){return m>=0&&r<this.gridRightBoundary&&y>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const r=s.identity([]);return s.translate(r,r,[-100,-100,0]),r}}function Xs(f,r,u){const m=r.createTileMatrix(f,f.worldSize,u.toUnwrapped());return s.multiply(new Float32Array(16),f.projMatrix,m)}function Mh(f,r,u){if(r.projection.name===u.projection.name)return f.projMatrix;const m=u.clone();return m.setProjection(r.projection),Xs(m,r.getProjection(),f)}function Hc(f,r,u){return r.name===u.projection.name?f.projMatrix:Xs(u,r,f)}class Tl{constructor(r,u,m,y){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?u:-u))):y&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class Ys{constructor(r,u,m,y,b,C=!1){this.text=new Tl(r?r.text:null,u,m,b),this.icon=new Tl(r?r.icon:null,u,y,b),this.clipped=C}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class La{constructor(r,u,m,y=!1){this.text=r,this.icon=u,this.skipFade=m,this.clipped=y}}class Ph{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Dr{constructor(r,u,m,y,b){this.bucketInstanceId=r,this.featureIndex=u,this.sourceLayerIndex=m,this.bucketIndex=y,this.tileID=b}}class Ri{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const u=++this.maxGroupID;this.collisionGroups[r]={ID:u,predicate:m=>m.collisionGroupID===u}}return this.collisionGroups[r]}}function Xc(f,r,u,m,y){const{horizontalAlign:b,verticalAlign:C}=s.getAnchorAlignment(f),I=-(b-.5)*r,M=-(C-.5)*u,B=s.evaluateVariableOffset(f,m);return new s.pointGeometry(I+B[0]*y,M+B[1]*y)}function Cl(f,r,u,m,y){const b=new s.pointGeometry(f,r);return u&&b._rotate(m?y:-y),b}class Rr{constructor(r,u,m,y,b){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new kh(this.transform,b),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Ri(m),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,u,m,y){const b=m.getBucket(u),C=m.latestFeatureIndex;if(!b||!C||u.id!==b.layerIds[0])return;const I=b.layers[0].layout,M=m.collisionBoxArray,B=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),O=m.tileSize/s.EXTENT,j=m.tileID.toUnwrapped();this.transform.setProjection(b.projection);const H=(Q=m.tileID,J=b.getProjection(),ee=this.transform,J.name===this.projection?ee.calculateProjMatrix(Q.toUnwrapped()):Xs(ee,J,Q));var Q,J,ee;const te=I.get("text-pitch-alignment")==="map",W=I.get("text-rotation-alignment")==="map";u.compileFilter();const ue=u.dynamicFilter(),ae=u.dynamicFilterNeedsFeature(),pe=this.transform.calculatePixelsToTileUnitsMatrix(m),Ce=ep(H,m.tileID.canonical,te,W,this.transform,b.getProjection(),pe);let we=null;if(te){const $e=Ma(H,m.tileID.canonical,te,W,this.transform,b.getProjection(),pe);we=s.multiply([],this.transform.labelPlaneMatrix,$e)}let Ae=null;ue&&m.latestFeatureIndex&&(Ae={unwrappedTileID:j,dynamicFilter:ue,dynamicFilterNeedsFeature:ae,featureIndex:m.latestFeatureIndex}),this.retainedQueryData[b.bucketInstanceId]=new Dr(b.bucketInstanceId,C,b.sourceLayerIndex,b.index,m.tileID);const Be={bucket:b,layout:I,posMatrix:H,textLabelPlaneMatrix:Ce,labelToScreenMatrix:we,clippingData:Ae,scale:B,textPixelRatio:O,holdingForFade:m.holdingForFade(),collisionBoxArray:M,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(b.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(y)for(const $e of b.sortKeyRanges){const{sortKey:Ge,symbolInstanceStart:wt,symbolInstanceEnd:Fe}=$e;r.push({sortKey:Ge,symbolInstanceStart:wt,symbolInstanceEnd:Fe,parameters:Be})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Be})}attemptAnchorPlacement(r,u,m,y,b,C,I,M,B,O,j,H,Q,J,ee,te,W,ue){const{textOffset0:ae,textOffset1:pe,crossTileID:Ce}=H,we=[ae,pe],Ae=Xc(r,m,y,we,b),Be=this.collisionIndex.placeCollisionBox(J,b,u,Cl(Ae.x,Ae.y,C,I,this.transform.angle),j,M,B,O.predicate);if(te){const $e=J.getSymbolInstanceIconSize(ue,this.transform.zoom,H.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(J,$e,te,Cl(Ae.x,Ae.y,C,I,this.transform.angle),j,M,B,O.predicate).box.length===0)return}if(Be.box.length>0){let $e;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ce]&&this.prevPlacement.placements[Ce]&&this.prevPlacement.placements[Ce].text&&($e=this.prevPlacement.variableOffsets[Ce].anchor),this.variableOffsets[Ce]={textOffset:we,width:m,height:y,anchor:r,textScale:b,prevAnchor:$e},this.markUsedJustification(J,r,H,ee),J.allowVerticalPlacement&&(this.markUsedOrientation(J,ee,H),this.placedOrientations[Ce]=ee),{shift:Ae,placedGlyphBoxes:Be}}}placeLayerBucketPart(r,u,m,y){const{bucket:b,layout:C,posMatrix:I,textLabelPlaneMatrix:M,labelToScreenMatrix:B,clippingData:O,textPixelRatio:j,holdingForFade:H,collisionBoxArray:Q,partiallyEvaluatedTextSize:J,partiallyEvaluatedIconSize:ee,collisionGroup:te}=r.parameters,W=C.get("text-optional"),ue=C.get("icon-optional"),ae=C.get("text-allow-overlap"),pe=C.get("icon-allow-overlap"),Ce=C.get("text-rotation-alignment")==="map",we=C.get("text-pitch-alignment")==="map",Ae=C.get("icon-text-fit")!=="none",Be=C.get("symbol-z-order")==="viewport-y";this.transform.setProjection(b.projection);let $e=ae&&(pe||!b.hasIconData()||ue),Ge=pe&&(ae||!b.hasTextData()||W);!b.collisionArrays&&Q&&b.deserializeCollisionBoxes(Q),m&&y&&b.updateCollisionDebugBuffers(this.transform.zoom,Q);const wt=(Fe,rt,He)=>{const{crossTileID:ht,numVerticalGlyphVertices:Ue}=Fe;if(O){const _i={zoom:this.transform.zoom,pitch:this.transform.pitch};let si=null;if(O.dynamicFilterNeedsFeature){const $n=this.retainedQueryData[b.bucketInstanceId];si=O.featureIndex.loadFeature({featureIndex:Fe.featureIndex,bucketIndex:$n.bucketIndex,sourceLayerIndex:$n.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,O.dynamicFilter)(_i,si,this.retainedQueryData[b.bucketInstanceId].tileID.canonical,new s.pointGeometry(Fe.tileAnchorX,Fe.tileAnchorY),this.transform.calculateDistanceTileData(O.unwrappedTileID)))return this.placements[ht]=new La(!1,!1,!1,!0),void(u[ht]=!0)}if(u[ht])return;if(H)return void(this.placements[ht]=new La(!1,!1,!1));let Le=!1,Ze=!1,lt=!0,mt=!1,Ht=!1,vn=null,jt={box:null,offscreen:null,occluded:null},Vt={box:null,offscreen:null,occluded:null},Xt=null,In=null,en=null,Wn=0,ni=0,ui=0;He.textFeatureIndex?Wn=He.textFeatureIndex:Fe.useRuntimeCollisionCircles&&(Wn=Fe.featureIndex),He.verticalTextFeatureIndex&&(ni=He.verticalTextFeatureIndex);const oi=_i=>{_i.tileID=this.retainedQueryData[b.bucketInstanceId].tileID;const si=this.transform.elevation;(si||_i.elevation)&&(_i.elevation=si?si.getAtTileOffset(_i.tileID,_i.tileAnchorX,_i.tileAnchorY):0)},Ni=He.textBox;if(Ni){oi(Ni);const _i=$n=>{let ki=s.WritingMode.horizontal;if(b.allowVerticalPlacement&&!$n&&this.prevPlacement){const yr=this.prevPlacement.placedOrientations[ht];yr&&(this.placedOrientations[ht]=yr,ki=yr,this.markUsedOrientation(b,ki,Fe))}return ki},si=($n,ki)=>{if(b.allowVerticalPlacement&&Ue>0&&He.verticalTextBox){for(const yr of b.writingModes)if(yr===s.WritingMode.vertical?(jt=ki(),Vt=jt):jt=$n(),jt&&jt.box&&jt.box.length)break}else jt=$n()};if(C.get("text-variable-anchor")){let $n=C.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ht]){const pi=this.prevPlacement.variableOffsets[ht];$n.indexOf(pi.anchor)>0&&($n=$n.filter(xr=>xr!==pi.anchor),$n.unshift(pi.anchor))}const ki=(pi,xr,br)=>{const _s=b.getSymbolInstanceTextSize(J,Fe,this.transform.zoom,rt),Xa=(pi.x2-pi.x1)*_s+2*pi.padding,Wr=(pi.y2-pi.y1)*_s+2*pi.padding,Jr=Ae&&!pe?xr:null;Jr&&oi(Jr);let Ho={box:[],offscreen:!1,occluded:!1};const ys=ae?2*$n.length:$n.length;for(let xs=0;xs<ys;++xs){const Ya=this.attemptAnchorPlacement($n[xs%$n.length],pi,Xa,Wr,_s,Ce,we,j,I,te,xs>=$n.length,Fe,rt,b,br,Jr,J,ee);if(Ya&&(Ho=Ya.placedGlyphBoxes,Ho&&Ho.box&&Ho.box.length)){Le=!0,vn=Ya.shift;break}}return Ho};si(()=>ki(Ni,He.iconBox,s.WritingMode.horizontal),()=>{const pi=He.verticalTextBox;return pi&&oi(pi),b.allowVerticalPlacement&&!(jt&&jt.box&&jt.box.length)&&Ue>0&&pi?ki(pi,He.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),jt&&(Le=jt.box,lt=jt.offscreen,mt=jt.occluded);const yr=_i(jt&&jt.box);if(!Le&&this.prevPlacement){const pi=this.prevPlacement.variableOffsets[ht];pi&&(this.variableOffsets[ht]=pi,this.markUsedJustification(b,pi.anchor,Fe,yr))}}else{const $n=(ki,yr)=>{const pi=b.getSymbolInstanceTextSize(J,Fe,this.transform.zoom,rt),xr=this.collisionIndex.placeCollisionBox(b,pi,ki,new s.pointGeometry(0,0),ae,j,I,te.predicate);return xr&&xr.box&&xr.box.length&&(this.markUsedOrientation(b,yr,Fe),this.placedOrientations[ht]=yr),xr};si(()=>$n(Ni,s.WritingMode.horizontal),()=>{const ki=He.verticalTextBox;return b.allowVerticalPlacement&&Ue>0&&ki?(oi(ki),$n(ki,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),_i(jt&&jt.box&&jt.box.length)}}if(Xt=jt,Le=Xt&&Xt.box&&Xt.box.length>0,lt=Xt&&Xt.offscreen,mt=Xt&&Xt.occluded,Fe.useRuntimeCollisionCircles){const _i=b.text.placedSymbolArray.get(Fe.centerJustifiedTextSymbolIndex>=0?Fe.centerJustifiedTextSymbolIndex:Fe.verticalPlacedTextSymbolIndex),si=s.evaluateSizeForFeature(b.textSizeData,J,_i),$n=C.get("text-padding");In=this.collisionIndex.placeCollisionCircles(b,ae,_i,b.lineVertexArray,b.glyphOffsetArray,si,I,M,B,m,we,te.predicate,Fe.collisionCircleDiameter*si/s.ONE_EM,$n,this.retainedQueryData[b.bucketInstanceId].tileID),Le=ae||In.circles.length>0&&!In.collisionDetected,lt=lt&&In.offscreen,mt=In.occluded}if(He.iconFeatureIndex&&(ui=He.iconFeatureIndex),He.iconBox){const _i=si=>{oi(si);const $n=Ae&&vn?Cl(vn.x,vn.y,Ce,we,this.transform.angle):new s.pointGeometry(0,0),ki=b.getSymbolInstanceIconSize(ee,this.transform.zoom,Fe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(b,ki,si,$n,pe,j,I,te.predicate)};Vt&&Vt.box&&Vt.box.length&&He.verticalIconBox?(en=_i(He.verticalIconBox),Ze=en.box.length>0):(en=_i(He.iconBox),Ze=en.box.length>0),lt=lt&&en.offscreen,Ht=en.occluded}const Br=W||Fe.numHorizontalGlyphVertices===0&&Ue===0,lo=ue||Fe.numIconVertices===0;if(Br||lo?lo?Br||(Ze=Ze&&Le):Le=Ze&&Le:Ze=Le=Ze&&Le,Le&&Xt&&Xt.box&&this.collisionIndex.insertCollisionBox(Xt.box,C.get("text-ignore-placement"),b.bucketInstanceId,Vt&&Vt.box&&ni?ni:Wn,te.ID),Ze&&en&&this.collisionIndex.insertCollisionBox(en.box,C.get("icon-ignore-placement"),b.bucketInstanceId,ui,te.ID),In&&(Le&&this.collisionIndex.insertCollisionCircles(In.circles,C.get("text-ignore-placement"),b.bucketInstanceId,Wn,te.ID),m)){const _i=b.bucketInstanceId;let si=this.collisionCircleArrays[_i];si===void 0&&(si=this.collisionCircleArrays[_i]=new Ph);for(let $n=0;$n<In.circles.length;$n+=4)si.circles.push(In.circles[$n+0]),si.circles.push(In.circles[$n+1]),si.circles.push(In.circles[$n+2]),si.circles.push(In.collisionDetected?1:0)}const Wo=b.projection.name!=="globe";$e=$e&&(Wo||!mt),Ge=Ge&&(Wo||!Ht),this.placements[ht]=new La(Le||$e,Ze||Ge,lt||b.justReloaded),u[ht]=!0};if(Be){const Fe=b.getSortedSymbolIndexes(this.transform.angle);for(let rt=Fe.length-1;rt>=0;--rt){const He=Fe[rt];wt(b.symbolInstances.get(He),He,b.collisionArrays[He])}}else for(let Fe=r.symbolInstanceStart;Fe<r.symbolInstanceEnd;Fe++)wt(b.symbolInstances.get(Fe),Fe,b.collisionArrays[Fe]);if(m&&b.bucketInstanceId in this.collisionCircleArrays){const Fe=this.collisionCircleArrays[b.bucketInstanceId];s.invert(Fe.invProjMatrix,I),Fe.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}markUsedJustification(r,u,m,y){const{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:M,crossTileID:B}=m,O=s.getAnchorJustification(u),j=y===s.WritingMode.vertical?M:O==="left"?b:O==="center"?C:O==="right"?I:-1;b>=0&&(r.text.placedSymbolArray.get(b).crossTileID=j>=0&&b!==j?0:B),C>=0&&(r.text.placedSymbolArray.get(C).crossTileID=j>=0&&C!==j?0:B),I>=0&&(r.text.placedSymbolArray.get(I).crossTileID=j>=0&&I!==j?0:B),M>=0&&(r.text.placedSymbolArray.get(M).crossTileID=j>=0&&M!==j?0:B)}markUsedOrientation(r,u,m){const y=u===s.WritingMode.horizontal||u===s.WritingMode.horizontalOnly?u:0,b=u===s.WritingMode.vertical?u:0,{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:B}=m,O=r.text.placedSymbolArray;C>=0&&(O.get(C).placedOrientation=y),I>=0&&(O.get(I).placedOrientation=y),M>=0&&(O.get(M).placedOrientation=y),B>=0&&(O.get(B).placedOrientation=b)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let m=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const y=u?u.symbolFadeChange(r):1,b=u?u.opacities:{},C=u?u.variableOffsets:{},I=u?u.placedOrientations:{};for(const M in this.placements){const B=this.placements[M],O=b[M];O?(this.opacities[M]=new Ys(O,y,B.text,B.icon,null,B.clipped),m=m||B.text!==O.text.placed||B.icon!==O.icon.placed):(this.opacities[M]=new Ys(null,y,B.text,B.icon,B.skipFade,B.clipped),m=m||B.text||B.icon)}for(const M in b){const B=b[M];if(!this.opacities[M]){const O=new Ys(B,y,!1,!1);O.isHidden()||(this.opacities[M]=O,m=m||B.text.placed||B.icon.placed)}}for(const M in C)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=C[M]);for(const M in I)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=I[M]);m?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:r)}updateLayerOpacities(r,u){const m={};for(const y of u){const b=y.getBucket(r);b&&y.latestFeatureIndex&&r.id===b.layerIds[0]&&this.updateBucketOpacities(b,m,y.collisionBoxArray)}}updateBucketOpacities(r,u,m){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const y=r.layers[0].layout,b=!!r.layers[0].dynamicFilter(),C=new Ys(null,0,!1,!1,!0),I=y.get("text-allow-overlap"),M=y.get("icon-allow-overlap"),B=y.get("text-variable-anchor"),O=y.get("text-rotation-alignment")==="map",j=y.get("text-pitch-alignment")==="map",H=y.get("icon-text-fit")!=="none",Q=new Ys(null,0,I&&(M||!r.hasIconData()||y.get("icon-optional")),M&&(I||!r.hasTextData()||y.get("text-optional")),!0);!r.collisionArrays&&m&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(m);const J=(te,W,ue)=>{for(let ae=0;ae<W/4;ae++)te.opacityVertexArray.emplaceBack(ue)};let ee=0;for(let te=0;te<r.symbolInstances.length;te++){const W=r.symbolInstances.get(te),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:ae,crossTileID:pe,numIconVertices:Ce}=W;let we=this.opacities[pe];u[pe]?we=C:we||(we=Q,this.opacities[pe]=we),u[pe]=!0;const Ae=ue>0||ae>0,Be=Ce>0,$e=this.placedOrientations[pe],Ge=$e===s.WritingMode.vertical,wt=$e===s.WritingMode.horizontal||$e===s.WritingMode.horizontalOnly;if(!Ae&&!Be||we.isHidden()||ee++,Ae){const Fe=Kc(we.text);J(r.text,ue,Ge?Da:Fe),J(r.text,ae,wt?Da:Fe);const rt=we.text.isHidden(),{leftJustifiedTextSymbolIndex:He,centerJustifiedTextSymbolIndex:ht,rightJustifiedTextSymbolIndex:Ue,verticalPlacedTextSymbolIndex:Le}=W,Ze=r.text.placedSymbolArray,lt=rt||Ge?1:0;He>=0&&(Ze.get(He).hidden=lt),ht>=0&&(Ze.get(ht).hidden=lt),Ue>=0&&(Ze.get(Ue).hidden=lt),Le>=0&&(Ze.get(Le).hidden=rt||wt?1:0);const mt=this.variableOffsets[pe];mt&&this.markUsedJustification(r,mt.anchor,W,$e);const Ht=this.placedOrientations[pe];Ht&&(this.markUsedJustification(r,"left",W,Ht),this.markUsedOrientation(r,Ht,W))}if(Be){const Fe=Kc(we.icon),{placedIconSymbolIndex:rt,verticalPlacedIconSymbolIndex:He}=W,ht=r.icon.placedSymbolArray,Ue=we.icon.isHidden()?1:0;rt>=0&&(J(r.icon,Ce,Ge?Da:Fe),ht.get(rt).hidden=Ue),He>=0&&(J(r.icon,W.numVerticalIconVertices,wt?Da:Fe),ht.get(He).hidden=Ue)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Fe=r.collisionArrays[te];if(Fe){let rt=new s.pointGeometry(0,0),He=!0;if(Fe.textBox||Fe.verticalTextBox){if(B){const Ue=this.variableOffsets[pe];Ue?(rt=Xc(Ue.anchor,Ue.width,Ue.height,Ue.textOffset,Ue.textScale),O&&rt._rotate(j?this.transform.angle:-this.transform.angle)):He=!1}b&&(He=!we.clipped),Fe.textBox&&Ar(r.textCollisionBox.collisionVertexArray,we.text.placed,!He||Ge,rt.x,rt.y),Fe.verticalTextBox&&Ar(r.textCollisionBox.collisionVertexArray,we.text.placed,!He||wt,rt.x,rt.y)}const ht=He&&Boolean(!wt&&Fe.verticalIconBox);Fe.iconBox&&Ar(r.iconCollisionBox.collisionVertexArray,we.icon.placed,ht,H?rt.x:0,H?rt.y:0),Fe.verticalIconBox&&Ar(r.iconCollisionBox.collisionVertexArray,we.icon.placed,!ht,H?rt.x:0,H?rt.y:0)}}}if(r.fullyClipped=ee===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const te=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=te.invProjMatrix,r.placementViewportMatrix=te.viewportMatrix,r.collisionCircleArray=te.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,u){const m=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*m>r}setStale(){this.stale=!0}}function Ar(f,r,u,m,y){f.emplaceBack(r?1:0,u?1:0,m||0,y||0),f.emplaceBack(r?1:0,u?1:0,m||0,y||0),f.emplaceBack(r?1:0,u?1:0,m||0,y||0),f.emplaceBack(r?1:0,u?1:0,m||0,y||0)}const np=Math.pow(2,25),Yc=Math.pow(2,24),Xi=Math.pow(2,17),Il=Math.pow(2,16),zh=Math.pow(2,9),Al=Math.pow(2,8),ur=Math.pow(2,1);function Kc(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const r=f.placed?1:0,u=Math.floor(127*f.opacity);return u*np+r*Yc+u*Xi+r*Il+u*zh+r*Al+u*ur+r}const Da=0;class Go{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,u,m,y,b){const C=this._bucketParts;for(;this._currentTileIndex<r.length;)if(u.getBucketParts(C,y,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,C.sort((I,M)=>I.sortKey-M.sortKey));this._currentPartIndex<C.length;){const I=C[this._currentPartIndex];if(u.placeLayerBucketPart(I,this._seenCrossTileIDs,m,I.symbolInstanceStart===0),this._currentPartIndex++,b())return!0}return!1}}class kl{constructor(r,u,m,y,b,C,I,M){this.placement=new Rr(r,b,C,I,M),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(r,u,m){const y=s.exported.now(),b=()=>{const C=s.exported.now()-y;return!this._forceFullPlacement&&C>2};for(;this._currentPlacementIndex>=0;){const C=u[r[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(C.type==="symbol"&&(!C.minzoom||C.minzoom<=I)&&(!C.maxzoom||C.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Go(C)),this._inProgressLayer.continuePlacement(m[C.source],this.placement,this._showCollisionBoxes,C,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Jc=512/s.EXTENT/2;class tv{constructor(r,u,m){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=m;for(let y=0;y<u.length;y++){const b=u.get(y),C=b.key;this.indexedSymbolInstances[C]||(this.indexedSymbolInstances[C]=[]),this.indexedSymbolInstances[C].push({crossTileID:b.crossTileID,coord:this.getScaledCoordinates(b,r)})}}getScaledCoordinates(r,u){const m=Jc/Math.pow(2,u.canonical.z-this.tileID.canonical.z);return{x:Math.floor((u.canonical.x*s.EXTENT+r.tileAnchorX)*m),y:Math.floor((u.canonical.y*s.EXTENT+r.tileAnchorY)*m)}}findMatches(r,u,m){const y=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let b=0;b<r.length;b++){const C=r.get(b);if(C.crossTileID)continue;const I=this.indexedSymbolInstances[C.key];if(!I)continue;const M=this.getScaledCoordinates(C,u);for(const B of I)if(Math.abs(B.coord.x-M.x)<=y&&Math.abs(B.coord.y-M.y)<=y&&!m[B.crossTileID]){m[B.crossTileID]=!0,C.crossTileID=B.crossTileID;break}}}}class Lh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ra{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const u=Math.round((r-this.lng)/360);if(u!==0)for(const m in this.indexes){const y=this.indexes[m],b={};for(const C in y){const I=y[C];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+u),b[I.tileID.key]=I}this.indexes[m]=b}this.lng=r}addBucket(r,u,m){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let b=0;b<u.symbolInstances.length;b++)u.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const y=this.usedCrossTileIDs[r.overscaledZ];for(const b in this.indexes){const C=this.indexes[b];if(Number(b)>r.overscaledZ)for(const I in C){const M=C[I];M.tileID.isChildOf(r)&&M.findMatches(u.symbolInstances,r,y)}else{const I=C[r.scaledTo(Number(b)).key];I&&I.findMatches(u.symbolInstances,r,y)}}for(let b=0;b<u.symbolInstances.length;b++){const C=u.symbolInstances.get(b);C.crossTileID||(C.crossTileID=m.generate(),y[C.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new tv(r,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(r,u){for(const m in u.indexedSymbolInstances)for(const y of u.indexedSymbolInstances[m])delete this.usedCrossTileIDs[r][y.crossTileID]}removeStaleBuckets(r){let u=!1;for(const m in this.indexes){const y=this.indexes[m];for(const b in y)r[y[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,y[b]),delete y[b],u=!0)}return u}}class ip{constructor(){this.layerIndexes={},this.crossTileIDs=new Lh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,u,m,y){let b=this.layerIndexes[r.id];b===void 0&&(b=this.layerIndexes[r.id]=new Ra);let C=!1;const I={};y.name!=="globe"&&b.handleWrapJump(m);for(const M of u){const B=M.getBucket(r);B&&r.id===B.layerIds[0]&&(B.bucketInstanceId||(B.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(M.tileID,B,this.crossTileIDs)&&(C=!0),I[B.bucketInstanceId]=!0)}return b.removeStaleBuckets(I)&&(C=!0),C}pruneUnusedLayers(r){const u={};r.forEach(m=>{u[m]=!0});for(const m in this.layerIndexes)u[m]||delete this.layerIndexes[m]}}const Ml=(f,r)=>s.emitValidationErrors(f,r&&r.filter(u=>u.identifier!=="source.canvas")),Ba=s.pick(sn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),ps=s.pick(sn,["setCenter","setZoom","setBearing","setPitch"]),Qc={version:8,layers:[],sources:{}},ms={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Yr extends s.Evented{constructor(r,u={}){super(),this.map=r,this.dispatcher=new Ln(un(),this),this.imageManager=new De,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(r._requestManager,u.localFontFamily?s.LocalGlyphMode.all:u.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,u.localFontFamily||u.localIdeographFontFamily),this.crossTileSymbolIndex=new ip,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const m=this;this._rtlTextPluginCallback=Yr.registerForPluginStateChange(y=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(b,C)=>{if(s.triggerPluginCompletionEvent(b),C&&C.every(I=>I))for(const I in m._sourceCaches){const M=m._sourceCaches[I],B=M.getSource().type;B!=="vector"&&B!=="geojson"||M.reload()}})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const b=this.getSource(y.sourceId);if(b&&b.vectorLayerIds)for(const C in this._layers){const I=this._layers[C];I.source===b.id&&this._validateLayer(I)}})}loadURL(r,u={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const m=typeof u.validate=="boolean"?u.validate:!s.isMapboxURL(r);r=this.map._requestManager.normalizeStyleURL(r,u.accessToken);const y=this.map._requestManager.transformRequest(r,s.ResourceType.Style);this._request=s.getJSON(y,(b,C)=>{this._request=null,b?this.fire(new s.ErrorEvent(b)):C&&this._load(C,m)})}loadJSON(r,u={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(r,u.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Qc,!1)}_updateLayerCount(r,u){const m=u?1:-1;r.is3D()&&(this._num3DLayers+=m),r.type==="circle"&&(this._numCircleLayers+=m),r.type==="symbol"&&(this._numSymbolLayers+=m)}_load(r,u){if(u&&Ml(this,s.validateStyle(r)))return;this._loaded=!0,this.stylesheet=s.clone$1(r),this._updateMapProjection();for(const y in r.sources)this.addSource(y,r.sources[y],{validate:!1});this._changed=!1,r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(r.glyphs);const m=qn(this.stylesheet.layers);this._order=m.map(y=>y.id),this._layers={},this._serializedLayers={};for(let y of m)y=s.createStyleLayer(y),y.setEventedParent(this,{layer:{id:y.id}}),this._layers[y.id]=y,this._serializedLayers[y.id]=y.serialize(),this._updateLayerCount(y,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ct(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(r){this._spriteRequest=function(u,m,y){let b,C,I;const M=s.exported.devicePixelRatio>1?"@2x":"";let B=s.getJSON(m.transformRequest(m.normalizeSpriteURL(u,M,".json"),s.ResourceType.SpriteJSON),(H,Q)=>{B=null,I||(I=H,b=Q,j())}),O=s.getImage(m.transformRequest(m.normalizeSpriteURL(u,M,".png"),s.ResourceType.SpriteImage),(H,Q)=>{O=null,I||(I=H,C=Q,j())});function j(){if(I)y(I);else if(b&&C){const H=s.exported.getImageData(C),Q={};for(const J in b){const{width:ee,height:te,x:W,y:ue,sdf:ae,pixelRatio:pe,stretchX:Ce,stretchY:we,content:Ae}=b[J],Be=new s.RGBAImage({width:ee,height:te});s.RGBAImage.copy(H,Be,{x:W,y:ue},{x:0,y:0},{width:ee,height:te}),Q[J]={data:Be,pixelRatio:pe,sdf:ae,stretchX:Ce,stretchY:we,content:Ae}}y(null,Q)}}return{cancel(){B&&(B.cancel(),B=null),O&&(O.cancel(),O=null)}}}(r,this.map._requestManager,(u,m)=>{if(this._spriteRequest=null,u)this.fire(new s.ErrorEvent(u));else if(m)for(const y in m)this.imageManager.addImage(y,m[y]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(r){const u=this.getSource(r.source);if(!u)return;const m=r.sourceLayer;m&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(m)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${m}" does not exist on source "${u.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const u=[];for(const m of r){const y=this._layers[m];y.type!=="custom"&&u.push(y.serialize())}return u}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(r){return!!this.terrain&&(typeof r.isLayerDraped=="function"?r.isLayerDraped():ms[r.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(r){if(!this._loaded)return;const u=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(y.length||b.length)&&this._updateWorkerLayers(y,b);for(const C in this._updatedSources){const I=this._updatedSources[C];I==="reload"?this._reloadSource(C):I==="clear"&&this._clearSource(C)}this._updateTilesForChangedImages();for(const C in this._updatedPaintProps)this._layers[C].updateTransitions(r);this.light.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._resetUpdates()}const m={};for(const y in this._sourceCaches){const b=this._sourceCaches[y];m[y]=b.used,b.used=!1}for(const y of this._order){const b=this._layers[y];if(b.recalculate(r,this._availableImages),!b.isHidden(r.zoom)){const I=this._getLayerSourceCache(b);I&&(I.used=!0)}const C=this.map.painter;if(C){const I=b.getProgramIds();if(!I)continue;const M=b.getProgramConfiguration(r.zoom);for(const B of I)C.useProgram(B,M)}}for(const y in m){const b=this._sourceCaches[y];m[y]!==b.used&&b.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:b.getSource().id}))}this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),u&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const u in this._sourceCaches)this._sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(r){if(this._checkLoaded(),Ml(this,s.validateStyle(r)))return!1;(r=s.clone$1(r)).layers=qn(r.layers);const u=function(y,b){if(!y)return[{command:sn.setStyle,args:[b]}];let C=[];try{if(!w(y.version,b.version))return[{command:sn.setStyle,args:[b]}];w(y.center,b.center)||C.push({command:sn.setCenter,args:[b.center]}),w(y.zoom,b.zoom)||C.push({command:sn.setZoom,args:[b.zoom]}),w(y.bearing,b.bearing)||C.push({command:sn.setBearing,args:[b.bearing]}),w(y.pitch,b.pitch)||C.push({command:sn.setPitch,args:[b.pitch]}),w(y.sprite,b.sprite)||C.push({command:sn.setSprite,args:[b.sprite]}),w(y.glyphs,b.glyphs)||C.push({command:sn.setGlyphs,args:[b.glyphs]}),w(y.transition,b.transition)||C.push({command:sn.setTransition,args:[b.transition]}),w(y.light,b.light)||C.push({command:sn.setLight,args:[b.light]}),w(y.fog,b.fog)||C.push({command:sn.setFog,args:[b.fog]}),w(y.projection,b.projection)||C.push({command:sn.setProjection,args:[b.projection]});const I={},M=[];(function(j,H,Q,J){let ee;for(ee in H=H||{},j=j||{})j.hasOwnProperty(ee)&&(H.hasOwnProperty(ee)||ti(ee,Q,J));for(ee in H)H.hasOwnProperty(ee)&&(j.hasOwnProperty(ee)?w(j[ee],H[ee])||(j[ee].type==="geojson"&&H[ee].type==="geojson"&&Uo(j,H,ee)?Q.push({command:sn.setGeoJSONSourceData,args:[ee,H[ee].data]}):ds(ee,H,Q,J)):ei(ee,H,Q))})(y.sources,b.sources,M,I);const B=[];y.layers&&y.layers.forEach(j=>{j.source&&I[j.source]?C.push({command:sn.removeLayer,args:[j.id]}):B.push(j)});let O=y.terrain;O&&I[O.source]&&(C.push({command:sn.setTerrain,args:[void 0]}),O=void 0),C=C.concat(M),w(O,b.terrain)||C.push({command:sn.setTerrain,args:[b.terrain]}),function(j,H,Q){H=H||[];const J=(j=j||[]).map(jo),ee=H.map(jo),te=j.reduce(Vi,{}),W=H.reduce(Vi,{}),ue=J.slice(),ae=Object.create(null);let pe,Ce,we,Ae,Be,$e,Ge;for(pe=0,Ce=0;pe<J.length;pe++)we=J[pe],W.hasOwnProperty(we)?Ce++:(Q.push({command:sn.removeLayer,args:[we]}),ue.splice(ue.indexOf(we,Ce),1));for(pe=0,Ce=0;pe<ee.length;pe++)we=ee[ee.length-1-pe],ue[ue.length-1-pe]!==we&&(te.hasOwnProperty(we)?(Q.push({command:sn.removeLayer,args:[we]}),ue.splice(ue.lastIndexOf(we,ue.length-Ce),1)):Ce++,$e=ue[ue.length-pe],Q.push({command:sn.addLayer,args:[W[we],$e]}),ue.splice(ue.length-pe,0,we),ae[we]=!0);for(pe=0;pe<ee.length;pe++)if(we=ee[pe],Ae=te[we],Be=W[we],!ae[we]&&!w(Ae,Be))if(w(Ae.source,Be.source)&&w(Ae["source-layer"],Be["source-layer"])&&w(Ae.type,Be.type)){for(Ge in et(Ae.layout,Be.layout,Q,we,null,sn.setLayoutProperty),et(Ae.paint,Be.paint,Q,we,null,sn.setPaintProperty),w(Ae.filter,Be.filter)||Q.push({command:sn.setFilter,args:[we,Be.filter]}),w(Ae.minzoom,Be.minzoom)&&w(Ae.maxzoom,Be.maxzoom)||Q.push({command:sn.setLayerZoomRange,args:[we,Be.minzoom,Be.maxzoom]}),Ae)Ae.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?et(Ae[Ge],Be[Ge],Q,we,Ge.slice(6),sn.setPaintProperty):w(Ae[Ge],Be[Ge])||Q.push({command:sn.setLayerProperty,args:[we,Ge,Be[Ge]]}));for(Ge in Be)Be.hasOwnProperty(Ge)&&!Ae.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?et(Ae[Ge],Be[Ge],Q,we,Ge.slice(6),sn.setPaintProperty):w(Ae[Ge],Be[Ge])||Q.push({command:sn.setLayerProperty,args:[we,Ge,Be[Ge]]}))}else Q.push({command:sn.removeLayer,args:[we]}),$e=ue[ue.lastIndexOf(we)+1],Q.push({command:sn.addLayer,args:[Be,$e]})}(B,b.layers,C)}catch(I){console.warn("Unable to compute style diff:",I),C=[{command:sn.setStyle,args:[b]}]}return C}(this.serialize(),r).filter(y=>!(y.command in ps));if(u.length===0)return!1;const m=u.filter(y=>!(y.command in Ba));if(m.length>0)throw new Error(`Unimplemented: ${m.map(y=>y.command).join(", ")}.`);return u.forEach(y=>{y.command!=="setTransition"&&y.command!=="setProjection"&&this[y.command].apply(this,y.args)}),this.stylesheet=r,this._updateMapProjection(),!0}addImage(r,u){return this.getImage(r)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,u),this._afterImageUpdated(r),this)}updateImage(r,u){this.imageManager.updateImage(r,u)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r),this._afterImageUpdated(r),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(r,u,m={}){if(this._checkLoaded(),this.getSource(r)!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(s.validateSource,`sources.${r}`,u,null,m))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const y=Re(r,u,this.dispatcher,this);y.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(r),source:y.serialize(),sourceId:r}));const b=C=>{const I=(C?"symbol:":"other:")+r,M=this._sourceCaches[I]=new s.SourceCache(I,y,C);(C?this._symbolSourceCaches:this._otherSourceCaches)[r]=M,M.style=this,M.onAdd(this.map)};b(!1),u.type!=="vector"&&u.type!=="geojson"||b(!0),y.onAdd&&y.onAdd(this.map),this._changed=!0}removeSource(r){this._checkLoaded();const u=this.getSource(r);if(!u)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===r)return this.fire(new s.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.get().source===r)return this.fire(new s.ErrorEvent(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const m=this._getSourceCaches(r);for(const y of m)delete this._sourceCaches[y.id],delete this._updatedSources[y.id],y.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles();return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(r,u){this._checkLoaded(),this.getSource(r).setData(u),this._changed=!0}getSource(r){const u=this._getSourceCache(r);return u&&u.getSource()}_getSources(){const r=[];for(const u in this._otherSourceCaches){const m=this._getSourceCache(u);m&&r.push(m.getSource())}return r}addLayer(r,u,m={}){this._checkLoaded();const y=r.id;if(this.getLayer(y))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${y}" already exists on this map`)));let b;if(r.type==="custom"){if(Ml(this,s.validateCustomStyleLayer(r)))return;b=s.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(y,r.source),r=s.clone$1(r),r=s.extend(r,{source:y})),this._validate(s.validateLayer,`layers.${y}`,r,{arrayIndex:-1},m))return;b=s.createStyleLayer(r),this._validateLayer(b),b.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}const C=u?this._order.indexOf(u):this._order.length;if(u&&C===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`)));this._order.splice(C,0,y),this._layerOrderChanged=!0,this._layers[y]=b;const I=this._getLayerSourceCache(b);if(this._removedLayers[y]&&b.source&&I&&b.type!=="custom"){const M=this._removedLayers[y];delete this._removedLayers[y],M.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",I.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(r,u){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===u)return;const m=this._order.indexOf(r);this._order.splice(m,1);const y=u?this._order.indexOf(u):this._order.length;u&&y===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`))):(this._order.splice(y,0,r),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(r){this._checkLoaded();const u=this._layers[r];if(!u)return void this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be removed.`)));u.setEventedParent(null),this._updateLayerCount(u,!1);const m=this._order.indexOf(r);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=u,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],u.onRemove&&u.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}hasLayerType(r){for(const u in this._layers)if(this._layers[u].type===r)return!0;return!1}setLayerZoomRange(r,u,m){this._checkLoaded();const y=this.getLayer(r);y?y.minzoom===u&&y.maxzoom===m||(u!=null&&(y.minzoom=u),m!=null&&(y.maxzoom=m),this._updateLayer(y)):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(r,u,m={}){this._checkLoaded();const y=this.getLayer(r);if(y){if(!w(y.filter,u))return u==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(s.validateFilter,`layers.${y.id}.filter`,u,{layerType:y.type},m)||(y.filter=s.clone$1(u),this._updateLayer(y)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be filtered.`)))}getFilter(r){const u=this.getLayer(r);return u&&s.clone$1(u.filter)}setLayoutProperty(r,u,m,y={}){this._checkLoaded();const b=this.getLayer(r);b?w(b.getLayoutProperty(u),m)||(b.setLayoutProperty(u,m,y),this._updateLayer(b)):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(r,u){const m=this.getLayer(r);if(m)return m.getLayoutProperty(u);this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style.`)))}setPaintProperty(r,u,m,y={}){this._checkLoaded();const b=this.getLayer(r);b?w(b.getPaintProperty(u),m)||(b.setPaintProperty(u,m,y)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(r,u){const m=this.getLayer(r);return m&&m.getPaintProperty(u)}setFeatureState(r,u){this._checkLoaded();const m=r.source,y=r.sourceLayer,b=this.getSource(m);if(!b)return void this.fire(new s.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const C=b.type;if(C==="geojson"&&y)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(C==="vector"&&!y)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const I=this._getSourceCaches(m);for(const M of I)M.setFeatureState(y,r.id,u)}removeFeatureState(r,u){this._checkLoaded();const m=r.source,y=this.getSource(m);if(!y)return void this.fire(new s.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const b=y.type,C=b==="vector"?r.sourceLayer:void 0;if(b==="vector"&&!C)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const I=this._getSourceCaches(m);for(const M of I)M.removeFeatureState(C,r.id,u)}getFeatureState(r){this._checkLoaded();const u=r.source,m=r.sourceLayer,y=this.getSource(u);if(y){if(y.type!=="vector"||m)return r.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(u)[0].getFeatureState(m,r.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const r={};for(const u in this._sourceCaches){const m=this._sourceCaches[u].getSource();r[m.id]||(r[m.id]=m.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:r,layers:this._serializeLayers(this._order)},u=>u!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0;const u=this._getLayerSourceCache(r);r.source&&!this._updatedSources[r.source]&&u&&u.getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",u.pause()),this._changed=!0,r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const u=C=>this._layers[C].type==="fill-extrusion",m={},y=[];for(let C=this._order.length-1;C>=0;C--){const I=this._order[C];if(u(I)){m[I]=C;for(const M of r){const B=M[I];if(B)for(const O of B)y.push(O)}}}y.sort((C,I)=>I.intersectionZ-C.intersectionZ);const b=[];for(let C=this._order.length-1;C>=0;C--){const I=this._order[C];if(u(I))for(let M=y.length-1;M>=0;M--){const B=y[M].feature;if(m[B.layer.id]<C)break;b.push(B),y.pop()}else for(const M of r){const B=M[I];if(B)for(const O of B)b.push(O.feature)}}return b}queryRenderedFeatures(r,u,m){u&&u.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",u.filter,null,u);const y={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const M of u.layers){const B=this._layers[M];if(!B)return this.fire(new s.ErrorEvent(new Error(`The layer '${M}' does not exist in the map's style and cannot be queried for features.`))),[];y[B.source]=!0}}const b=[];u.availableImages=this._availableImages;const C=u&&u.layers?u.layers.some(M=>{const B=this.getLayer(M);return B&&B.is3D()}):this.has3DLayers(),I=Je.createFromScreenPoints(r,m);for(const M in this._sourceCaches){const B=this._sourceCaches[M].getSource().id;u.layers&&!y[B]||b.push(Ve(this._sourceCaches[M],this._layers,this._serializedLayers,I,u,m,C,!!this.map._showQueryGeometry))}return this.placement&&b.push(function(M,B,O,j,H,Q,J){const ee={},te=Q.queryRenderedSymbols(j),W=[];for(const ue of Object.keys(te).map(Number))W.push(J[ue]);W.sort(Bt);for(const ue of W){const ae=ue.featureIndex.lookupSymbolFeatures(te[ue.bucketInstanceId],B,ue.bucketIndex,ue.sourceLayerIndex,H.filter,H.layers,H.availableImages,M);for(const pe in ae){const Ce=ee[pe]=ee[pe]||[],we=ae[pe];we.sort((Ae,Be)=>{const $e=ue.featureSortOrder;if($e){const Ge=$e.indexOf(Ae.featureIndex);return $e.indexOf(Be.featureIndex)-Ge}return Be.featureIndex-Ae.featureIndex});for(const Ae of we)Ce.push(Ae)}}for(const ue in ee)ee[ue].forEach(ae=>{const pe=ae.feature,Ce=O(M[ue]).getFeatureState(pe.layer["source-layer"],pe.id);pe.source=pe.layer.source,pe.layer["source-layer"]&&(pe.sourceLayer=pe.layer["source-layer"]),pe.state=Ce});return ee}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),I.screenGeometry,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(r,u){u&&u.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",u.filter,null,u);const m=this._getSourceCaches(r);let y=[];for(const b of m)y=y.concat(ut(b,u));return y}addSourceType(r,u,m){return Yr.getSourceType(r)?m(new Error(`A source type called "${r}" already exists.`)):(Yr.setSourceType(r,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:u.workerSourceURL},m):m(null,null))}getLight(){return this.light.getLight()}setLight(r,u={}){this._checkLoaded();const m=this.light.getLight();let y=!1;for(const C in r)if(!w(r[C],m[C])){y=!0;break}if(!y)return;const b=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(r,u),this.light.updateTransitions(b)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(r,u=1){if(this._checkLoaded(),!r)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(u===1){if(typeof r.source=="object"){const m="terrain-dem-src";this.addSource(m,r.source),r=s.clone$1(r),r=s.extend(r,{source:m})}if(this._validate(s.validateTerrain,"terrain",r))return}if(!this.terrain||this.terrain&&u!==this.terrain.drapeRenderMode)this._createTerrain(r,u);else{const m=this.terrain,y=m.get();for(const b of Object.keys(s.spec.terrain))!r.hasOwnProperty(b)&&s.spec.terrain[b].default&&(r[b]=s.spec.terrain[b].default);for(const b in r)if(!w(r[b],y[b])){m.set(r),this.stylesheet.terrain=r;const C=this._setTransitionParameters({duration:0});m.updateTransitions(C);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const u=this.fog=new qt(r,this.map.transform);this.stylesheet.fog=r;const m=this._setTransitionParameters({duration:0});u.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog,m=u.get();Object.keys(r).length===0&&u.set(r);for(const y in r)if(!w(r[y],m[y])){u.set(r),this.stylesheet.fog=r;const b=this._setTransitionParameters({duration:0});u.updateTransitions(b);break}}else this._createFog(r);this._markersNeedUpdate=!0}_setTransitionParameters(r){return{now:s.exported.now(),transition:s.extend(r,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const r=this._order.filter(m=>this.isLayerDraped(this._layers[m])),u=this._order.filter(m=>!this.isLayerDraped(this._layers[m]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...u)}_createTerrain(r,u){const m=this.terrain=new Pe(r,u);this.stylesheet.terrain=r,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const y=this._setTransitionParameters({duration:0});m.updateTransitions(y)}_force3DLayerUpdate(){for(const r in this._layers){const u=this._layers[r];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const u=this._layers[r];u.type==="symbol"&&this._updateLayer(u)}}_validate(r,u,m,y,b={}){return(!b||b.validate!==!1)&&Ml(this,r.call(s.validateStyle,s.extend({key:u,style:this.serialize(),value:m,styleSpec:s.spec},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this._sourceCaches)this._sourceCaches[r].clearTiles(),this._sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){const u=this._getSourceCaches(r);for(const m of u)m.clearTiles()}_reloadSource(r){const u=this._getSourceCaches(r);for(const m of u)m.resume(),m.reload()}_reloadSources(){for(const r of this._getSources())r.reload&&r.reload()}_updateSources(r){for(const u in this._sourceCaches)this._sourceCaches[u].update(r)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const u=this._sourceCaches[r];u.resume(),u.reload()}}_updatePlacement(r,u,m,y,b=!1){let C=!1,I=!1;const M={};for(const B of this._order){const O=this._layers[B];if(O.type!=="symbol")continue;if(!M[O.source]){const H=this._getLayerSourceCache(O);if(!H)continue;M[O.source]=H.getRenderableIds(!0).map(Q=>H.getTileByID(Q)).sort((Q,J)=>J.tileID.overscaledZ-Q.tileID.overscaledZ||(Q.tileID.isLessThan(J.tileID)?-1:1))}const j=this.crossTileSymbolIndex.addLayer(O,M[O.source],r.center.lng,r.projection);C=C||j}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),b=b||this._layerOrderChanged||m===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(b||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),r.zoom))&&(this.pauseablePlacement=new kl(r,this._order,b,u,m,y,this.placement,this.fog&&r.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),I=!0),C&&this.pauseablePlacement.placement.setStale()),I||C)for(const B of this._order){const O=this._layers[B];O.type==="symbol"&&this.placement.updateLayerOpacities(O,M[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,u,m){this.imageManager.getImages(u.icons,m),this._updateTilesForChangedImages();const y=b=>{b&&b.setDependencies(u.tileID.key,u.type,u.icons)};y(this._otherSourceCaches[u.source]),y(this._symbolSourceCaches[u.source])}getGlyphs(r,u,m){this.glyphManager.getGlyphs(u.stacks,m)}getResource(r,u,m){return s.makeRequest(u,m)}_getSourceCache(r){return this._otherSourceCaches[r]}_getLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}_getSourceCaches(r){const u=[];return this._otherSourceCaches[r]&&u.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&u.push(this._symbolSourceCaches[r]),u}_isSourceCacheLoaded(r){const u=this._getSourceCaches(r);return u.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${r}'`))),!1):u.every(m=>m.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Yr.getSourceType=function(f){return Oe[f]},Yr.setSourceType=function(f,r){Oe[f]=r},Yr.registerForPluginStateChange=s.registerForPluginStateChange;var Pl=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,rp="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",op=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,eu=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,sp=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Dh={},Rh={};const Oa=[];Ks(Pl,Oa),Ks(op,Oa),Ks(eu,Oa),Ks(sp,Oa),Dh=Zn("",op),Rh=Zn(sp,eu);const ap=Zn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),tu=Pl,nu=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Bh={background:Zn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Zn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Zn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Zn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Zn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Zn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Zn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Zn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Zn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Zn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Zn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Zn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Zn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Zn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Zn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Zn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Zn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Zn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Zn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Zn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Zn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Zn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Zn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Zn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Zn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Zn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,rp),skyboxGradient:Zn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,rp),skyboxCapture:Zn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Zn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Zn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Ks(f,r){const u=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let m of u)if(m=m.trim(),m[0]==="#"&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const y=m.split(" ");for(const b of y)r.includes(b)||r.push(b)}}function Zn(f,r){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=r.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),y={},b=[...Oa];return Ks(f,b),Ks(r,b),{fragmentSource:f=f.replace(u,(C,I,M,B,O)=>(y[O]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${O}
varying ${M} ${B} ${O};
#else
uniform ${M} ${B} u_${O};
#endif
`:`
#ifdef HAS_UNIFORM_u_${O}
    ${M} ${B} ${O} = u_${O};
#endif
`)),vertexSource:r=r.replace(u,(C,I,M,B,O)=>{const j=B==="float"?"vec2":"vec4",H=O.match(/color/)?"color":j;return y[O]?I==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${M} ${j} a_${O};
varying ${M} ${B} ${O};
#else
uniform ${M} ${B} u_${O};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = a_${O};
#else
    ${M} ${B} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = unpack_mix_${H}(a_${O}, u_${O}_t);
#else
    ${M} ${B} ${O} = u_${O};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${M} ${j} a_${O};
#else
uniform ${M} ${B} u_${O};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${M} ${B} ${O} = a_${O};
#else
    ${M} ${B} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${M} ${B} ${O} = unpack_mix_${H}(a_${O}, u_${O}_t);
#else
    ${M} ${B} ${O} = u_${O};
#endif
`}),staticAttributes:m,usedDefines:b}}class zl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,u,m,y,b,C,I){this.context=r;let M=this.boundPaintVertexBuffers.length!==y.length;for(let O=0;!M&&O<y.length;O++)this.boundPaintVertexBuffers[O]!==y[O]&&(M=!0);let B=this.boundDynamicVertexBuffers.length!==I.length;for(let O=0;!B&&O<I.length;O++)this.boundDynamicVertexBuffers[O]!==I[O]&&(B=!0);if(!r.extVertexArrayObject||!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==m||M||B||this.boundIndexBuffer!==b||this.boundVertexOffset!==C)this.freshBind(u,m,y,b,C,I);else{r.bindVertexArrayOES.set(this.vao);for(const O of I)O&&O.bind();b&&b.dynamicDraw&&b.bind()}}freshBind(r,u,m,y,b,C){let I;const M=r.numAttributes,B=this.context,O=B.gl;if(B.extVertexArrayObject)this.vao&&this.destroy(),this.vao=B.extVertexArrayObject.createVertexArrayOES(),B.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=r,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=y,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=C;else{I=B.currentNumAttributes||0;for(let j=M;j<I;j++)O.disableVertexAttribArray(j)}u.enableAttributes(O,r),u.bind(),u.setVertexAttribPointers(O,r,b);for(const j of m)j.enableAttributes(O,r),j.bind(),j.setVertexAttribPointers(O,r,b);for(const j of C)j&&(j.enableAttributes(O,r),j.bind(),j.setVertexAttribPointers(O,r,b));y&&y.bind(),B.currentNumAttributes=M}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Oh(f,r){const u=Math.pow(2,r.canonical.z),m=r.canonical.y;return[new s.MercatorCoordinate(0,m/u).toLngLat().lat,new s.MercatorCoordinate(0,(m+1)/u).toLngLat().lat]}function Ll(f,r,u,m,y,b,C){const I=f.context,M=I.gl,B=u.fbo;if(!B)return;f.prepareDrawTile();const O=f.useProgram("hillshade");I.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,B.colorAttachment.get());const j=((ee,te,W,ue)=>{const ae=W.paint.get("hillshade-shadow-color"),pe=W.paint.get("hillshade-highlight-color"),Ce=W.paint.get("hillshade-accent-color");let we=W.paint.get("hillshade-illumination-direction")*(Math.PI/180);W.paint.get("hillshade-illumination-anchor")==="viewport"&&(we-=ee.transform.angle);const Ae=!ee.options.moving;return{u_matrix:ue||ee.transform.calculateProjMatrix(te.tileID.toUnwrapped(),Ae),u_image:0,u_latrange:Oh(0,te.tileID),u_light:[W.paint.get("hillshade-exaggeration"),we],u_shadow:ae,u_highlight:pe,u_accent:Ce}})(f,u,m,f.terrain?r.projMatrix:null);f.prepareDrawProgram(I,O,r.toUnwrapped());const{tileBoundsBuffer:H,tileBoundsIndexBuffer:Q,tileBoundsSegments:J}=f.getTileBoundsBuffers(u);O.draw(I,M.TRIANGLES,y,b,C,s.CullFaceMode.disabled,j,m.id,H,Q,J)}function Dl(f,r,u){if(!r.needsDEMTextureUpload)return;const m=f.context,y=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||f.getTileTexture(u.stride);const b=u.getPixels();r.demTexture?r.demTexture.update(b,{premultiply:!1}):r.demTexture=new s.Texture(m,b,y.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}function iu(f,r,u,m,y,b){const C=f.context,I=C.gl;if(!r.dem)return;const M=r.dem;if(C.activeTexture.set(I.TEXTURE1),Dl(f,r,M),!r.demTexture)return;r.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const B=M.dim;C.activeTexture.set(I.TEXTURE0);let O=r.fbo;if(!O){const J=new s.Texture(C,{width:B,height:B,data:null},I.RGBA);J.bind(I.LINEAR,I.CLAMP_TO_EDGE),O=r.fbo=C.createFramebuffer(B,B,!0),O.colorAttachment.set(J.texture)}C.bindFramebuffer.set(O.framebuffer),C.viewport.set([0,0,B,B]);const{tileBoundsBuffer:j,tileBoundsIndexBuffer:H,tileBoundsSegments:Q}=f.getMercatorTileBoundsBuffers();f.useProgram("hillshadePrepare").draw(C,I.TRIANGLES,m,y,b,s.CullFaceMode.disabled,((J,ee)=>{const te=ee.stride,W=s.create();return s.ortho(W,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(W,W,[0,-s.EXTENT,0]),{u_matrix:W,u_image:1,u_dimension:[te,te],u_zoom:J.overscaledZ,u_unpack:ee.unpackVector}})(r.tileID,M),u.id,j,H,Q),r.needsHillshadePrepare=!1}const ru=f=>({u_matrix:new s.UniformMatrix4f(f),u_image0:new s.Uniform1i(f),u_skirt_height:new s.Uniform1f(f)}),Fh=(f,r)=>({u_matrix:f,u_image0:0,u_skirt_height:r}),ou=(f,r,u,m,y,b,C,I,M,B,O,j,H,Q,J)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:u,u_zoom_transition:y,u_merc_center:b,u_image0:0,u_frustum_tl:C,u_frustum_tr:I,u_frustum_br:M,u_frustum_bl:B,u_globe_pos:O,u_globe_radius:j,u_viewport:H,u_grid_matrix:J?Float32Array.from(J):new Float32Array(9),u_skirt_height:Q});function Vh(f,r){return f!=null&&r!=null&&!(!f.hasData()||!r.hasData())&&f.demTexture!=null&&r.demTexture!=null&&f.tileID.key!==r.tileID.key}const gs=new class{constructor(){this.operations={}}newMorphing(f,r,u,m,y){if(f in this.operations){const b=this.operations[f];b.to.tileID.key!==u.tileID.key&&(b.queued=u)}else this.operations[f]={startTime:m,phase:0,duration:y,from:r,to:u,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const r=this.operations[f];return{from:r.from,to:r.to,phase:r.phase}}update(f){for(const r in this.operations){const u=this.operations[r];for(u.phase=(f-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,f)){delete this.operations[r];break}}}_nextOp(f,r){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=r,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},Js={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function su(f){return 6*Math.pow(1.5,22-f)}function Nh(f,r){const u=1<<f.z;return!r&&(f.x===0||f.x===u-1)||f.y===0||f.y===u-1}const Vn=f=>({u_matrix:f});function Rl(f,r,u,m,y){if(y>0){const b=s.exported.now(),C=(b-f.timeAdded)/y,I=r?(b-r.timeAdded)/y:-1,M=u.getSource(),B=m.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),O=!r||Math.abs(r.tileID.overscaledZ-B)>Math.abs(f.tileID.overscaledZ-B),j=O&&f.refreshedUponExpiration?1:s.clamp(O?C:1-I,0,1);return f.refreshedUponExpiration&&C>=1&&(f.refreshedUponExpiration=!1),r?{opacity:1,mix:1-j}:{opacity:j,mix:0}}return{opacity:1,mix:0}}class lp extends s.SourceCache{constructor(r){const u={type:"raster-dem",maxzoom:r.transform.maxZoom},m=new Ln(un(),null),y=Re("mock-dem",u,m,r.style);super("mock-dem",y,!1),y.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,u){r.state="loaded",u(null)}}class cp extends s.SourceCache{constructor(r){const u=Re("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new Ln(un(),null),r.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,u,m){if(r.freezeTileCoverage)return;this.transform=r;const y=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,C)=>{if(b[C.key]="",!this._tiles[C.key]){const I=new s.Tile(C,this._source.tileSize*C.overscaleFactor(),r.tileZoom);I.state="loaded",this._tiles[C.key]=I}return b},{});for(const b in this._tiles)b in y||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(r){const u=this.proxyCachedFBO[r];if(u!==void 0){const m=Object.values(u);this.renderCachePool.push(...m),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class $h extends s.OverscaledTileID{constructor(r,u,m){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=u,this.projMatrix=m}}class Uh extends s.Elevation{constructor(r,u){super(),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,y,b]=function(M){const B=new s.StructArrayLayout2i4,O=new s.StructArrayLayout3ui6,j=131;B.reserve(17161),O.reserve(33800);const H=s.EXTENT/128,Q=s.EXTENT+H/2,J=Q+H;for(let te=-H;te<J;te+=H)for(let W=-H;W<J;W+=H){const ue=W<0||W>Q||te<0||te>Q?24575:0,ae=s.clamp(Math.round(W),0,s.EXTENT),pe=s.clamp(Math.round(te),0,s.EXTENT);B.emplaceBack(ae+ue,pe)}const ee=(te,W)=>{const ue=W*j+te;O.emplaceBack(ue+1,ue,ue+j),O.emplaceBack(ue+j,ue+j+1,ue+1)};for(let te=1;te<129;te++)for(let W=1;W<129;W++)ee(W,te);return[0,129].forEach(te=>{for(let W=0;W<130;W++)ee(W,te),ee(te,W)}),[B,O,32768]}(),C=r.context;this.gridBuffer=C.createVertexBuffer(m,s.posAttributes.members),this.gridIndexBuffer=C.createIndexBuffer(y),this.gridSegments=s.SegmentVector.simpleSegment(0,0,m.length,y.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,m.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new cp(u.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const I=C.gl;this._overlapStencilMode=new s.StencilMode({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new lp(u.map)}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),r.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=r,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,u,m){if(r&&r.terrain){this._style!==r&&(this.style=r),this.enabled=!0;const y=r.terrain.properties;this.sourceCache=r.terrain.drapeRenderMode===0?this._mockSourceCache:r._getSourceCache(y.get("source")),this._exaggeration=y.get("exaggeration");const b=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const C=this.getScaledDemTileSize();this.sourceCache.update(u,C,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,b(),this._initializing=!0),b(),u.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const r=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||r.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${r.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${r.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._sourceCaches)this._style._sourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const y=this.proxyCoords=u.getIds().map(M=>{const B=u.getTileByID(M).tileID;return B.projMatrix=m.calculateProjMatrix(B.toUnwrapped()),B});(function(M,B){const O=B.transform.pointCoordinate(B.transform.getCameraPoint()),j=new s.pointGeometry(O.x,O.y);M.sort((H,Q)=>{if(Q.overscaledZ-H.overscaledZ)return Q.overscaledZ-H.overscaledZ;const J=new s.pointGeometry(H.canonical.x+(1<<H.canonical.z)*H.wrap,H.canonical.y),ee=new s.pointGeometry(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),te=j.mult(1<<H.canonical.z);return te.x-=.5,te.y-=.5,te.distSqr(J)-te.distSqr(ee)})})(y,this.painter),this._previousZoom=m.zoom;const b=this.proxyToSource||{};this.proxyToSource={},y.forEach(M=>{this.proxyToSource[M.key]={}}),this.terrainTileForTile={};const C=this._style._sourceCaches;for(const M in C){const B=C[M];if(!B.used||(B!==this.sourceCache&&this.resetTileLookupCache(B.id),this._setupProxiedCoordsForOrtho(B,r[M],b),B.usedForTerrain))continue;const O=r[M];B.getSource().reparseOverscaled&&this._assignTerrainTiles(O)}this.proxiedCoords[u.id]=y.map(M=>new $h(M,M.key,this.orthoMatrix)),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const I={};this._visibleDemTiles=[];for(const M of this.proxyCoords){const B=this.terrainTileForTile[M.key];if(!B)continue;const O=B.tileID.key;O in I||(this._visibleDemTiles.push(B),I[O]=O)}}_assignTerrainTiles(r){this._initializing||r.forEach(u=>{if(this.terrainTileForTile[u.key])return;const m=this._findTileCoveringTileID(u,this.sourceCache);m&&(this.terrainTileForTile[u.key]=m)})}_prepareDEMTextures(){const r=this.painter.context,u=r.gl;for(const m in this.terrainTileForTile){const y=this.terrainTileForTile[m],b=y.dem;!b||y.demTexture&&!y.needsDEMTextureUpload||(r.activeTexture.set(u.TEXTURE1),Dl(this.painter,y,b))}}_prepareDemTileUniforms(r,u,m,y){if(!u||u.demTexture==null)return!1;const b=r.tileID.canonical,C=Math.pow(2,u.tileID.canonical.z-b.z),I=y||"";return m[`u_dem_tl${I}`]=[b.x*C%1,b.y*C%1],m[`u_dem_scale${I}`]=C,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const r=this.painter.context,u=r.gl;if(!this._emptyDepthBufferTexture){const m=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(r,m,u.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let r=0;const u=this._visibleDemTiles.reduce((m,y)=>{if(!y.dem)return m;const b=y.dem.tree.minimums[0];return b>0&&r++,m+b},0);return r?u/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,u=r.gl;r.activeTexture.set(u.TEXTURE2);const m=this._getLoadedAreaMinimum(),y=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(m,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(y,{premultiply:!1}):b=this._emptyDEMTexture=new s.Texture(r,y,u.RGBA,{premultiply:!1}),b}setupElevationDraw(r,u,m){const y=this.painter.context,b=y.gl,C=(I=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(I),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var I;C.u_dem_size=this.sourceCache.getSource().tileSize,C.u_exaggeration=this.exaggeration();let M=null,B=null,O=1;if(m&&m.morphing&&this._useVertexMorphing){const j=m.morphing.srcDemTile,H=m.morphing.dstDemTile;O=m.morphing.phase,j&&H&&(this._prepareDemTileUniforms(r,j,C,"_prev")&&(B=j),this._prepareDemTileUniforms(r,H,C)&&(M=H))}if(B&&M?(y.activeTexture.set(b.TEXTURE2),M.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),y.activeTexture.set(b.TEXTURE4),B.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),C.u_dem_lerp=O):(M=this.terrainTileForTile[r.tileID.key],y.activeTexture.set(b.TEXTURE2),(this._prepareDemTileUniforms(r,M,C)?M.demTexture:this.emptyDEMTexture).bind(b.NEAREST,b.CLAMP_TO_EDGE)),y.activeTexture.set(b.TEXTURE3),m&&m.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),this._depthFBO&&(C.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),C.u_depth_size_inv=[1,1]),m&&m.useMeterToDem&&M){const j=(1<<M.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;C.u_meter_to_dem=j}if(m&&m.labelPlaneMatrixInv&&(C.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),u.setTerrainUniformValues(y,C),this.painter.transform.projection.name==="globe"){const j=this.globeUniformValues(this.painter.transform,r.tileID.canonical,m&&m.useDenormalizedUpVectorScale);u.setGlobeUniformValues(y,j)}}globeUniformValues(r,u,m){const y=r.projection;return{u_tile_tl_up:y.upVector(u,0,0),u_tile_tr_up:y.upVector(u,s.EXTENT,0),u_tile_br_up:y.upVector(u,s.EXTENT,s.EXTENT),u_tile_bl_up:y.upVector(u,0,s.EXTENT),u_tile_up_scale:m?s.globeMetersToEcef(1):y.upVectorScale(u,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const u=this.painter,m=this.painter.context;r.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(y,b,C,I,M){if(y.transform.projection.name==="globe")(function(B,O,j,H,Q){const J=B.context,ee=J.gl;let te,W;const ue=B.options.showTerrainWireframe?2:0,ae=B.transform,pe=s.globeUseCustomAntiAliasing(B,J,ae),Ce=(ht,Ue)=>{if(W===ht)return;const Le=[Js[ht],"PROJECTION_GLOBE_VIEW"];pe&&Le.push("CUSTOM_ANTIALIASING"),Ue&&Le.push(Js[ue]),te=B.useProgram("globeRaster",null,Le),W=ht},we=B.colorModeForRenderPass(),Ae=new s.DepthMode(ee.LEQUAL,s.DepthMode.ReadWrite,B.depthRangeFor3D);gs.update(Q);const Be=s.calculateGlobeMercatorMatrix(ae),$e=[s.mercatorXfromLng(ae.center.lng),s.mercatorYfromLat(ae.center.lat)],Ge=ue?[!1,!0]:[!1],wt=B.globeSharedBuffers,Fe=[ae.width*s.exported.devicePixelRatio,ae.height*s.exported.devicePixelRatio],rt=Float32Array.from(ae.globeMatrix),He={useDenormalizedUpVectorScale:!0};if(Ge.forEach(ht=>{const Ue=B.transform,Le=su(Ue.zoom)*O.exaggeration();W=-1;const Ze=ht?ee.LINES:ee.TRIANGLES;for(const lt of H){const mt=j.getTile(lt),Ht=s.StencilMode.disabled,vn=O.prevTerrainTileForTile[lt.key],jt=O.terrainTileForTile[lt.key];Vh(vn,jt)&&gs.newMorphing(lt.key,vn,jt,Q,250),J.activeTexture.set(ee.TEXTURE0),mt.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const Vt=gs.getMorphValuesForProxy(lt.key),Xt=Vt?1:0;Vt&&s.extend$1(He,{morphing:{srcDemTile:Vt.from,dstDemTile:Vt.to,phase:s.easeCubicInOut(Vt.phase)}});const In=s.tileCornersToBounds(lt.canonical),en=s.getLatitudinalLod(In.getCenter().lat),Wn=s.getGridMatrix(lt.canonical,In,en,Ue.worldSize/Ue._pixelsPerMercatorPixel),ni=s.globeNormalizeECEF(s.globeTileBounds(lt.canonical)),ui=ou(Ue.projMatrix,rt,Be,ni,s.globeToMercatorTransition(Ue.zoom),$e,Ue.frustumCorners.TL,Ue.frustumCorners.TR,Ue.frustumCorners.BR,Ue.frustumCorners.BL,Ue.globeCenterInViewSpace,Ue.globeRadius,Fe,Le,Wn);if(Ce(Xt,ht),O.setupElevationDraw(mt,te,He),B.prepareDrawProgram(J,te,lt.toUnwrapped()),wt){const[oi,Ni,Br]=ht?wt.getWirefameBuffers(B.context,en):wt.getGridBuffers(en,Le!==0);te.draw(J,Ze,Ae,Ht,we,s.CullFaceMode.backCCW,ui,"globe_raster",oi,Ni,Br)}}}),wt){const ht=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];pe&&ht.push("CUSTOM_ANTIALIASING"),te=B.useProgram("globeRaster",null,ht);for(const Ue of H){const{x:Le,y:Ze,z:lt}=Ue.canonical,mt=Ze===0,Ht=Ze===(1<<lt)-1,[vn,jt,Vt,Xt]=wt.getPoleBuffers(lt);if(Xt&&(mt||Ht)){const In=j.getTile(Ue);J.activeTexture.set(ee.TEXTURE0),In.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);let en=s.globePoleMatrixForTile(lt,Le,ae);const Wn=s.globeNormalizeECEF(s.globeTileBounds(Ue.canonical)),ni=(ui,oi)=>ui.draw(J,ee.TRIANGLES,Ae,s.StencilMode.disabled,we,s.CullFaceMode.disabled,ou(ae.projMatrix,en,en,Wn,0,$e,ae.frustumCorners.TL,ae.frustumCorners.TR,ae.frustumCorners.BR,ae.frustumCorners.BL,ae.globeCenterInViewSpace,ae.globeRadius,Fe,0),"globe_pole_raster",oi,Vt,Xt);O.setupElevationDraw(In,te,He),B.prepareDrawProgram(J,te,Ue.toUnwrapped()),mt&&ni(te,vn),Ht&&(en=s.scale(s.create(),en,[1,-1,1]),ni(te,jt))}}}})(y,b,C,I,M);else{const B=y.context,O=B.gl;let j,H;const Q=y.options.showTerrainWireframe?2:0,J=(ae,pe)=>{if(H===ae)return;const Ce=[Js[ae]];pe&&Ce.push(Js[Q]),j=y.useProgram("terrainRaster",null,Ce),H=ae},ee=y.colorModeForRenderPass(),te=new s.DepthMode(O.LEQUAL,s.DepthMode.ReadWrite,y.depthRangeFor3D);gs.update(M);const W=y.transform,ue=su(W.zoom)*b.exaggeration();(Q?[!1,!0]:[!1]).forEach(ae=>{H=-1;const pe=ae?O.LINES:O.TRIANGLES,[Ce,we]=ae?b.getWirefameBuffer():[b.gridIndexBuffer,b.gridSegments];for(const Ae of I){const Be=C.getTile(Ae),$e=s.StencilMode.disabled,Ge=b.prevTerrainTileForTile[Ae.key],wt=b.terrainTileForTile[Ae.key];Vh(Ge,wt)&&gs.newMorphing(Ae.key,Ge,wt,M,250),B.activeTexture.set(O.TEXTURE0),Be.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST);const Fe=gs.getMorphValuesForProxy(Ae.key),rt=Fe?1:0;let He;Fe&&(He={morphing:{srcDemTile:Fe.from,dstDemTile:Fe.to,phase:s.easeCubicInOut(Fe.phase)}});const ht=Fh(Ae.projMatrix,Nh(Ae.canonical,W.renderWorldCopies)?ue/10:ue);J(rt,ae),b.setupElevationDraw(Be,j,He),y.prepareDrawProgram(B,j,Ae.toUnwrapped()),j.draw(B,pe,te,$e,ee,s.CullFaceMode.backCCW,ht,"terrain_raster",b.gridBuffer,Ce,we)}})}}(u,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const u=this.painter,m=this.painter.context,y=this.proxySourceCache,b=this.proxiedCoords[y.id],C=this._drapedRenderBatches.shift(),I=[],M=u.style.order;let B=0;for(const O of b){const j=y.getTileByID(O.proxyTileKey),H=y.proxyCachedFBO[O.key]?y.proxyCachedFBO[O.key][r]:void 0,Q=H!==void 0?y.renderCache[H]:this.pool[B++],J=H!==void 0;if(j.texture=Q.tex,J&&!Q.dirty){I.push(j.tileID);continue}let ee;m.bindFramebuffer.set(Q.fb.framebuffer),this.renderedToTile=!1,Q.dirty&&(m.clear({color:s.Color.transparent,stencil:0}),Q.dirty=!1);for(let te=C.start;te<=C.end;++te){const W=u.style._layers[M[te]];if(W.isHidden(u.transform.zoom))continue;const ue=u.style._getLayerSourceCache(W),ae=ue?this.proxyToSource[O.key][ue.id]:[O];if(!ae)continue;const pe=ae;m.viewport.set([0,0,Q.fb.width,Q.fb.height]),ee!==(ue?ue.id:null)&&(this._setupStencil(Q,ae,W,ue),ee=ue?ue.id:null),u.renderLayer(u,ue,W,pe)}this.renderedToTile?(Q.dirty=!0,I.push(j.tileID)):J||--B,B===5&&(B=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,u.width,u.height]),C.end+1}postRender(){}renderCacheEfficiency(r){const u=r.order.length;if(u===0)return{efficiency:100};let m,y=0,b=0,C=!1;for(let I=0;I<u;++I){const M=r._layers[r.order[I]];this._style.isLayerDraped(M)?(C&&++y,++b):C||(C=!0,m=M.id)}return b===0?{efficiency:100}:{efficiency:100*(1-y/b),firstUndrapedLayer:m}}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{r=Math.min(r,u.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,u,m){if(!this._visibleDemTiles)return null;const y=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const C=b.tileID,I=1<<C.overscaledZ,{x:M,y:B}=C.canonical,O=M/I,j=(M+1)/I,H=B/I,Q=(B+1)/I;return{minx:O,miny:H,maxx:j,maxy:Q,t:b.dem.tree.raycastRoot(O,H,j,Q,r,u,m),tile:b}});y.sort((b,C)=>(b.t!==null?b.t:Number.MAX_VALUE)-(C.t!==null?C.t:Number.MAX_VALUE));for(const b of y){if(b.t==null)return null;const C=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,r,u,m);if(C!=null)return C}return null}_createFBO(){const r=this.painter.context,u=r.gl,m=this.drapeBufferSize;r.activeTexture.set(u.TEXTURE0);const y=new s.Texture(r,{width:m[0],height:m[1],data:null},u.RGBA);y.bind(u.LINEAR,u.CLAMP_TO_EDGE);const b=r.createFramebuffer(m[0],m[1],!1);return b.colorAttachment.set(y.texture),b.depthAttachment=new Wc(r,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&!r.extTextureFilterAnisotropicForceOff&&u.texParameterf(u.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:b,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const r in this._style._sourceCaches)if(this._style._sourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const u=this._style._layers[r],m=u.isHidden(this.painter.transform.zoom);return u.type==="custom"?!m&&u.shouldRedrape():!m&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const m of this._style._getSources())if(m instanceof U){r=!0;break}if(!r)return;const u={};for(let m=0;m<this._style.order.length;++m){const y=this._style._layers[this._style.order[m]],b=this._style._getLayerSourceCache(y);if(b&&!u[b.id]&&!y.isHidden(this.painter.transform.zoom)&&y.type==="line"&&y.widthExpression()instanceof s.ZoomDependentExpression){u[b.id]=!0;for(const C of this.proxyCoords){const I=this.proxyToSource[C.key][b.id];if(I)for(const M of I)this._clearRenderCacheForTile(b.id,M)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const m in this._style._sourceCaches)if(this._style._sourceCaches[m]._source instanceof q){r=!0;break}if(!r)return;const u={};for(let m=0;m<this._style.order.length;++m){const y=this._style._layers[this._style.order[m]],b=this._style._getLayerSourceCache(y);if(!b||u[b.id]||y.isHidden(this.painter.transform.zoom)||y.type!=="raster")continue;const C=y.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const M=this.proxyToSource[I.key][b.id];if(M)for(const B of M){const O=Rl(b.getTile(B),b.findLoadedParent(B,0),b,this.painter.transform,C);(O.opacity!==1||O.mix!==0)&&this._clearRenderCacheForTile(b.id,B)}}}}_setupDrapedRenderBatches(){const r=this._style.order,u=r.length;if(u===0)return;const m=[];let y,b=0,C=this._style._layers[r[b]];for(;!this._style.isLayerDraped(C)&&C.isHidden(this.painter.transform.zoom)&&++b<u;)C=this._style._layers[r[b]];for(;b<u;++b){const I=this._style._layers[r[b]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?y===void 0&&(y=b):y!==void 0&&(m.push({start:y,end:b-1}),y=void 0))}y!==void 0&&m.push({start:y,end:b-1}),this._drapedRenderBatches=m}_setupRenderCache(r){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const C=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let I=0;I<C.length;++I){const M=Object.values(C[I]);u.renderCachePool.push(...M)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,y=this._tilesDirty;for(let C=m.length-1;C>=0;C--){const I=m[C];if(u.getTileByID(I.key),u.proxyCachedFBO[I.key]!==void 0){const M=r[I.key],B=this.proxyToSource[I.key];let O=0;for(const j in B){const H=B[j],Q=M[j];if(!Q||Q.length!==H.length||H.some((J,ee)=>J!==Q[ee]||y[j]&&y[j].hasOwnProperty(J.key))){O=-1;break}++O}for(const j in u.proxyCachedFBO[I.key])u.renderCache[u.proxyCachedFBO[I.key][j]].dirty=O<0||O!==Object.values(M).length}}const b=[...this._drapedRenderBatches];b.sort((C,I)=>I.end-I.start-(C.end-C.start));for(const C of b)for(const I of m){if(u.proxyCachedFBO[I.key])continue;let M=u.renderCachePool.pop();M===void 0&&u.renderCache.length<50&&(M=u.renderCache.length,u.renderCache.push(this._createFBO())),M!==void 0&&(u.proxyCachedFBO[I.key]={},u.proxyCachedFBO[I.key][C.start]=M,u.renderCache[M].dirty=!0)}this._tilesDirty={}}_setupStencil(r,u,m,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,C=b.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let I;if(m.isTileClipped())I=u.length,this._overlapStencilMode.test={func:C.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:C.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(r,u){const m=this.painter,y=this.painter.context,b=y.gl;m._tileClippingMaskIDs={},y.setColorMode(s.ColorMode.disabled),y.setDepthMode(s.DepthMode.disabled);const C=m.useProgram("clippingMask");for(const I of r){const M=m._tileClippingMaskIDs[I.key]=--u;C.draw(y,b.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:b.ALWAYS,mask:0},M,255,b.KEEP,b.KEEP,b.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Vn(I.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(r){const u=this.painter.transform;if(r.x<0||r.x>u.width||r.y<0||r.y>u.height)return null;const m=[r.x,r.y,1,1];s.transformMat4$1(m,m,u.pixelMatrixInverse),s.scale$1(m,m,1/m[3]),m[0]/=u.worldSize,m[1]/=u.worldSize;const y=u._camera.position,b=s.mercatorZfromAltitude(1,u.center.lat),C=[y[0],y[1],y[2]/b,0],I=s.subtract([],m.slice(0,3),C);s.normalize(I,I);const M=this.raycast(C,I,this._exaggeration);return M!==null&&M?(s.scaleAndAdd(C,C,I,M),C[3]=C[2],C[2]*=b,C):null}drawDepth(){const r=this.painter,u=r.context,m=this.proxySourceCache,y=Math.ceil(r.width),b=Math.ceil(r.height);if(!this._depthFBO||this._depthFBO.width===y&&this._depthFBO.height===b||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const C=u.gl,I=u.createFramebuffer(y,b,!0);u.activeTexture.set(C.TEXTURE0);const M=new s.Texture(u,{width:y,height:b,data:null},C.RGBA);M.bind(C.NEAREST,C.CLAMP_TO_EDGE),I.colorAttachment.set(M.texture);const B=u.createRenderbuffer(u.gl.DEPTH_COMPONENT16,y,b);I.depthAttachment.set(B),this._depthFBO=I,this._depthTexture=M}u.bindFramebuffer.set(this._depthFBO.framebuffer),u.viewport.set([0,0,y,b]),function(C,I,M,B){if(C.transform.projection.name==="globe")return;const O=C.context,j=O.gl;O.clear({depth:1});const H=C.useProgram("terrainDepth"),Q=new s.DepthMode(j.LESS,s.DepthMode.ReadWrite,C.depthRangeFor3D);for(const J of B){const ee=M.getTile(J),te=Fh(J.projMatrix,0);I.setupElevationDraw(ee,H),H.draw(O,j.TRIANGLES,Q,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,te,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}}(r,this,m,this.proxyCoords)}_setupProxiedCoordsForOrtho(r,u,m){if(r.getSource()instanceof Ie)return this._setupProxiedCoordsForImageSource(r,u,m);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const y=this.proxiedCoords[r.id]=[],b=this.proxyCoords;for(let I=0;I<b.length;I++){const M=b[I],B=this._findTileCoveringTileID(M,r);if(B){const O=this._createProxiedId(M,B,m[M.key]&&m[M.key][r.id]);y.push(O),this.proxyToSource[M.key][r.id]=[O]}}let C=!1;for(let I=0;I<u.length;I++){const M=r.getTile(u[I]);if(!M||!M.hasData())continue;const B=this._findTileCoveringTileID(M.tileID,this.proxySourceCache);if(B&&B.tileID.canonical.z!==M.tileID.canonical.z){const O=this.proxyToSource[B.tileID.key][r.id],j=this._createProxiedId(B.tileID,M,m[B.tileID.key]&&m[B.tileID.key][r.id]);O?O.splice(O.length-1,0,j):this.proxyToSource[B.tileID.key][r.id]=[j],y.push(j),C=!0}}this._sourceTilesOverlap[r.id]=C}_setupProxiedCoordsForImageSource(r,u,m){if(!r.getSource().loaded())return;const y=this.proxiedCoords[r.id]=[],b=this.proxyCoords,C=r.getSource(),I=new s.pointGeometry(C.tileID.x,C.tileID.y)._div(1<<C.tileID.z),M=C.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((O,j)=>(O.min.x=Math.min(O.min.x,j.x-I.x),O.min.y=Math.min(O.min.y,j.y-I.y),O.max.x=Math.max(O.max.x,j.x-I.x),O.max.y=Math.max(O.max.y,j.y-I.y),O),{min:new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),B=(O,j)=>{const H=O.wrap+O.canonical.x/(1<<O.canonical.z),Q=O.canonical.y/(1<<O.canonical.z),J=s.EXTENT/(1<<O.canonical.z),ee=j.wrap+j.canonical.x/(1<<j.canonical.z),te=j.canonical.y/(1<<j.canonical.z);return H+J<ee+M.min.x||H>ee+M.max.x||Q+J<te+M.min.y||Q>te+M.max.y};for(let O=0;O<b.length;O++){const j=b[O];for(let H=0;H<u.length;H++){const Q=r.getTile(u[H]);if(!Q||!Q.hasData()||B(j,Q.tileID))continue;const J=this._createProxiedId(j,Q,m[j.key]&&m[j.key][r.id]),ee=this.proxyToSource[j.key][r.id];ee?ee.push(J):this.proxyToSource[j.key][r.id]=[J],y.push(J)}}}_createProxiedId(r,u,m){let y=this.orthoMatrix;if(m){const b=m.find(C=>C.key===u.tileID.key);if(b)return b}if(u.tileID.key!==r.key){const b=r.canonical.z-u.tileID.canonical.z;let C,I,M;y=s.create();const B=u.tileID.wrap-r.wrap<<r.overscaledZ;b>0?(C=s.EXTENT>>b,I=C*((u.tileID.canonical.x<<b)-r.canonical.x+B),M=C*((u.tileID.canonical.y<<b)-r.canonical.y)):(C=s.EXTENT<<-b,I=s.EXTENT*(u.tileID.canonical.x-(r.canonical.x+B<<-b)),M=s.EXTENT*(u.tileID.canonical.y-(r.canonical.y<<-b))),s.ortho(y,0,C,0,C,0,1),s.translate(y,y,[I,M,0])}return new $h(u.tileID,r.key,y)}_findTileCoveringTileID(r,u){let m=u.getTile(r);if(m&&m.hasData())return m;const y=this._findCoveringTileCache[u.id],b=y[r.key];if(m=b?u.getTileByID(b):null,m&&m.hasData()||b===null)return m;let C=m?m.tileID:r,I=C.overscaledZ;const M=u.getSource().minzoom,B=[];if(!b){const j=u.getSource().maxzoom;if(r.canonical.z>=j){const H=r.canonical.z-j;u.getSource().reparseOverscaled?(I=Math.max(r.canonical.z+2,u.transform.tileZoom),C=new s.OverscaledTileID(I,r.wrap,j,r.canonical.x>>H,r.canonical.y>>H)):H!==0&&(I=j,C=new s.OverscaledTileID(I,r.wrap,j,r.canonical.x>>H,r.canonical.y>>H))}C.key!==r.key&&(B.push(C.key),m=u.getTile(C))}const O=j=>{B.forEach(H=>{y[H]=j}),B.length=0};for(I-=1;I>=M&&(!m||!m.hasData());I--){m&&O(m.tileID.key);const j=C.calculateScaledKey(I);if(m=u.getTileByID(j),m&&m.hasData())break;const H=y[j];if(H===null)break;H===void 0?B.push(j):m=u.getTileByID(H)}return O(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,u){let m=this._tilesDirty[r];m||(m=this._tilesDirty[r]={}),m[u.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const r=function(u){let m=0;const y=new s.StructArrayLayout2ui4,b=131;for(let C=1;C<129;C++){for(let I=1;I<129;I++)m=C*b+I,y.emplaceBack(m,m+1),y.emplaceBack(m,m+b),y.emplaceBack(m+1,m+b),C===128&&y.emplaceBack(m+b,m+b+1);y.emplaceBack(m+1,m+1+b)}return y}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(r),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,r.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class jh{static cacheKey(r,u,m,y){let b=`${u}${y?y.cacheKey:""}`;for(const C of m)r.usedDefines.includes(C)&&(b+=`/${C}`);return b}constructor(r,u,m,y,b,C){const I=r.gl;this.program=I.createProgram();const M=function(W){const ue=[];for(let ae=0;ae<W.length;ae++){if(W[ae]===null)continue;const pe=W[ae].split(" ");ue.push(pe.pop())}return ue}(m.staticAttributes),B=y?y.getBinderAttributes():[],O=M.concat(B);let j=y?y.defines():[];j=j.concat(C.map(W=>`#define ${W}`));const H=r.isWebGL2?`#version 300 es
`:"",Q=H+j.concat(r.extStandardDerivatives&&H.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(nu):nu,nu,tu,ap.fragmentSource,Rh.fragmentSource,m.fragmentSource).join(`
`),J=H+j.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,tu,ap.vertexSource,Rh.vertexSource,Dh.vertexSource,m.vertexSource).join(`
`),ee=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(ee,Q),I.compileShader(ee),I.attachShader(this.program,ee);const te=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(te,J),I.compileShader(te),I.attachShader(this.program,te),this.attributes={},this.numAttributes=O.length;for(let W=0;W<this.numAttributes;W++)O[W]&&(I.bindAttribLocation(this.program,W,O[W]),this.attributes[O[W]]=W);I.linkProgram(this.program),I.deleteShader(te),I.deleteShader(ee),this.fixedUniforms=b(r),this.binderUniforms=y?y.getUniforms(r):[],C.includes("TERRAIN")&&(this.terrainUniforms=(W=>({u_dem:new s.Uniform1i(W),u_dem_prev:new s.Uniform1i(W),u_dem_unpack:new s.Uniform4f(W),u_dem_tl:new s.Uniform2f(W),u_dem_scale:new s.Uniform1f(W),u_dem_tl_prev:new s.Uniform2f(W),u_dem_scale_prev:new s.Uniform1f(W),u_dem_size:new s.Uniform1f(W),u_dem_lerp:new s.Uniform1f(W),u_exaggeration:new s.Uniform1f(W),u_depth:new s.Uniform1i(W),u_depth_size_inv:new s.Uniform2f(W),u_meter_to_dem:new s.Uniform1f(W),u_label_plane_matrix_inv:new s.UniformMatrix4f(W)}))(r)),C.includes("GLOBE")&&(this.globeUniforms=(W=>({u_tile_tl_up:new s.Uniform3f(W),u_tile_tr_up:new s.Uniform3f(W),u_tile_br_up:new s.Uniform3f(W),u_tile_bl_up:new s.Uniform3f(W),u_tile_up_scale:new s.Uniform1f(W)}))(r)),C.includes("FOG")&&(this.fogUniforms=(W=>({u_fog_matrix:new s.UniformMatrix4f(W),u_fog_range:new s.Uniform2f(W),u_fog_color:new s.Uniform4f(W),u_fog_horizon_blend:new s.Uniform1f(W),u_fog_temporal_offset:new s.Uniform1f(W),u_frustum_tl:new s.Uniform3f(W),u_frustum_tr:new s.Uniform3f(W),u_frustum_br:new s.Uniform3f(W),u_frustum_bl:new s.Uniform3f(W),u_globe_pos:new s.Uniform3f(W),u_globe_radius:new s.Uniform1f(W),u_globe_transition:new s.Uniform1f(W),u_is_globe:new s.Uniform1i(W),u_viewport:new s.Uniform2f(W)}))(r))}}setTerrainUniformValues(r,u){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const y in u)m[y]&&m[y].set(this.program,y,u[y])}}setGlobeUniformValues(r,u){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const y in u)m[y]&&m[y].set(this.program,y,u[y])}}setFogUniformValues(r,u){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const y in u)m[y].set(this.program,y,u[y])}}draw(r,u,m,y,b,C,I,M,B,O,j,H,Q,J,ee){const te=r.gl;if(this.failedToCreate)return;r.program.set(this.program),r.setDepthMode(m),r.setStencilMode(y),r.setColorMode(b),r.setCullFace(C);for(const ue of Object.keys(this.fixedUniforms))this.fixedUniforms[ue].set(this.program,ue,I[ue]);J&&J.setUniforms(this.program,r,this.binderUniforms,H,{zoom:Q});const W={[te.LINES]:2,[te.TRIANGLES]:3,[te.LINE_STRIP]:1}[u];for(const ue of j.get()){const ae=ue.vaos||(ue.vaos={});(ae[M]||(ae[M]=new zl)).bind(r,this,B,J?J.getPaintVertexBuffers():[],O,ue.vertexOffset,ee||[]),te.drawElements(u,ue.primitiveLength*W,te.UNSIGNED_SHORT,ue.primitiveOffset*W*2)}}}function up(f,r){const u=Math.pow(2,r.tileID.overscaledZ),m=r.tileSize*Math.pow(2,f.transform.tileZoom)/u,y=m*(r.tileID.canonical.x+r.tileID.wrap*u),b=m*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_tile_units_to_pixels:1/kt(r,1,f.transform.tileZoom),u_pixel_coord_upper:[y>>16,b>>16],u_pixel_coord_lower:[65535&y,65535&b]}}const nv=s.create(),au=(f,r,u,m,y,b,C,I,M,B,O)=>{const j=r.style.light,H=j.properties.get("position"),Q=[H.x,H.y,H.z],J=s.create$1();j.properties.get("anchor")==="viewport"&&(s.fromRotation(J,-r.transform.angle),s.transformMat3(Q,Q,J));const ee=j.properties.get("color"),te=r.transform,W={u_matrix:f,u_lightpos:Q,u_lightintensity:j.properties.get("intensity"),u_lightcolor:[ee.r,ee.g,ee.b],u_vertical_gradient:+u,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:nv,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:y,u_edge_radius:b};return te.projection.name==="globe"&&(W.u_tile_id=[C.canonical.x,C.canonical.y,1<<C.canonical.z],W.u_zoom_transition=M,W.u_inv_rot_matrix=O,W.u_merc_center=B,W.u_up_dir=te.projection.upVector(new s.CanonicalTileID(0,0,0),B[0]*s.EXTENT,B[1]*s.EXTENT),W.u_height_lift=I),W},Gh=(f,r,u,m,y,b,C,I,M,B,O,j)=>{const H=au(f,r,u,m,y,b,C,M,B,O,j),Q={u_height_factor:-Math.pow(2,C.overscaledZ)/I.tileSize/8};return s.extend(H,up(r,I),Q)},lu=f=>({u_matrix:f}),cu=(f,r,u)=>s.extend(lu(f),up(r,u)),hp=(f,r)=>({u_matrix:f,u_world:r}),dp=(f,r,u,m)=>s.extend(cu(f,r,u),{u_world:m}),iv=s.create(),Bl=(f,r,u,m,y,b)=>{const C=f.transform,I=C.projection.name==="globe";let M;if(b.paint.get("circle-pitch-alignment")==="map")if(I){const O=s.globePixelsToTileUnits(C.zoom,r.canonical)*C._pixelsPerMercatorPixel;M=Float32Array.from([O,0,0,O])}else M=C.calculatePixelsToTileUnitsMatrix(u);else M=new Float32Array([C.pixelsToGLUnits[0],0,0,C.pixelsToGLUnits[1]]);const B={u_camera_to_center_distance:C.cameraToCenterDistance,u_matrix:f.translatePosMatrix(r.projMatrix,u,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:M,u_inv_rot_matrix:iv,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){B.u_inv_rot_matrix=m,B.u_merc_center=y,B.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],B.u_zoom_transition=s.globeToMercatorTransition(C.zoom);const O=y[0]*s.EXTENT,j=y[1]*s.EXTENT;B.u_up_dir=C.projection.upVector(new s.CanonicalTileID(0,0,0),O,j)}return B},Ol=f=>{const r=[];return f.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),f.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r},fp=(f,r,u,m)=>{const y=s.EXTENT/u.tileSize;return{u_matrix:f,u_camera_to_center_distance:r.getCameraToCenterDistance(m),u_extrude_scale:[r.pixelsToGLUnits[0]/y,r.pixelsToGLUnits[1]/y]}},Fl=(f,r,u=1)=>({u_matrix:f,u_color:r,u_overlay:0,u_overlay_scale:u}),qh=s.create(),wo=(f,r,u,m,y,b,C)=>{const I=f.transform,M=I.projection.name==="globe",B=M?s.globePixelsToTileUnits(I.zoom,r.canonical)*I._pixelsPerMercatorPixel:kt(u,1,b),O={u_matrix:r.projMatrix,u_extrude_scale:B,u_intensity:C,u_inv_rot_matrix:qh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(M){O.u_inv_rot_matrix=m,O.u_merc_center=y,O.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],O.u_zoom_transition=s.globeToMercatorTransition(I.zoom);const j=y[0]*s.EXTENT,H=y[1]*s.EXTENT;O.u_up_dir=I.projection.upVector(new s.CanonicalTileID(0,0,0),j,H)}return O},Zh=(f,r,u,m,y,b,C)=>{const I=f.transform,M=I.calculatePixelsToTileUnitsMatrix(r);return{u_matrix:Wh(f,r,u,m),u_pixels_to_tile_units:M,u_device_pixel_ratio:b,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:y,u_texsize:hu(u)?r.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:uu(r,f.transform),u_alpha_discard_threshold:0,u_trim_offset:C}},pp=(f,r,u,m,y)=>{const b=f.transform;return{u_matrix:Wh(f,r,u,m),u_texsize:r.imageAtlasTexture.size,u_pixels_to_tile_units:b.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:y,u_image:0,u_tile_units_to_pixels:uu(r,b),u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function uu(f,r){return 1/kt(f,1,r.tileZoom)}function Wh(f,r,u,m){return f.translatePosMatrix(m||r.tileID.projMatrix,r,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}function hu(f){const r=f.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}const rv=(f,r,u,m,y,b)=>{return{u_matrix:f,u_tl_parent:r,u_scale_parent:u,u_fade_t:m.mix,u_opacity:m.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(I=y.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(C=y.paint.get("raster-contrast"),C>0?1/(1-C):1+C),u_spin_weights:Hh(y.paint.get("raster-hue-rotate")),u_perspective_transform:b};var C,I};function Hh(f){f*=Math.PI/180;const r=Math.sin(f),u=Math.cos(f);return[(2*u+1)/3,(-Math.sqrt(3)*r-u+1)/3,(Math.sqrt(3)*r-u+1)/3]}const mp=s.create(),Vl=(f,r,u,m,y,b,C,I,M,B,O,j,H,Q,J,ee)=>{const te=y.transform,W={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:te.cameraToCenterDistance,u_rotate_symbol:+u,u_aspect_ratio:te.width/te.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:C,u_coord_matrix:I,u_is_text:+M,u_pitch_with_map:+m,u_texsize:B,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:mp,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:mp,u_up_vector:[0,-1,0]};return ee.name==="globe"&&(W.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],W.u_zoom_transition=j,W.u_inv_rot_matrix=Q,W.u_merc_center=H,W.u_camera_forward=te._camera.forward(),W.u_ecef_origin=s.globeECEFOrigin(te.globeMatrix,O.toUnwrapped()),W.u_tile_matrix=Float32Array.from(te.globeMatrix),W.u_up_vector=J),W},gp=(f,r,u,m,y,b,C,I,M,B,O,j,H,Q,J,ee,te)=>s.extend(Vl(f,r,u,m,y,b,C,I,M,B,j,H,Q,J,ee,te),{u_gamma_scale:m?y.transform.cameraToCenterDistance*Math.cos(y.terrain?0:y.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+O}),Xh=(f,r,u,m,y,b,C,I,M,B,O,j,H,Q,J,ee)=>s.extend(gp(f,r,u,m,y,b,C,I,!0,M,!0,O,j,H,Q,J,ee),{u_texsize_icon:B,u_texture_icon:1}),ov=(f,r,u)=>({u_matrix:f,u_opacity:r,u_color:u}),Yh=(f,r,u,m,y)=>s.extend(function(b,C,I){const M=C.imageManager.getPattern(b.toString()),{width:B,height:O}=C.imageManager.getPixelSize(),j=Math.pow(2,I.tileID.overscaledZ),H=I.tileSize*Math.pow(2,C.transform.tileZoom)/j,Q=H*(I.tileID.canonical.x+I.tileID.wrap*j),J=H*I.tileID.canonical.y;return{u_image:0,u_pattern_tl:M.tl,u_pattern_br:M.br,u_texsize:[B,O],u_pattern_size:M.displaySize,u_tile_units_to_pixels:1/kt(I,1,C.transform.tileZoom),u_pixel_coord_upper:[Q>>16,J>>16],u_pixel_coord_lower:[65535&Q,65535&J]}}(m,u,y),{u_matrix:f,u_opacity:r}),sv={fillExtrusion:f=>({u_matrix:new s.UniformMatrix4f(f),u_lightpos:new s.Uniform3f(f),u_lightintensity:new s.Uniform1f(f),u_lightcolor:new s.Uniform3f(f),u_vertical_gradient:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f),u_edge_radius:new s.Uniform1f(f),u_ao:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_up_dir:new s.Uniform3f(f),u_height_lift:new s.Uniform1f(f)}),fillExtrusionPattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_lightpos:new s.Uniform3f(f),u_lightintensity:new s.Uniform1f(f),u_lightcolor:new s.Uniform3f(f),u_vertical_gradient:new s.Uniform1f(f),u_height_factor:new s.Uniform1f(f),u_edge_radius:new s.Uniform1f(f),u_ao:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_up_dir:new s.Uniform3f(f),u_height_lift:new s.Uniform1f(f),u_image:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f)}),fill:f=>({u_matrix:new s.UniformMatrix4f(f)}),fillPattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_image:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f)}),fillOutline:f=>({u_matrix:new s.UniformMatrix4f(f),u_world:new s.Uniform2f(f)}),fillOutlinePattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_world:new s.Uniform2f(f),u_image:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f)}),circle:f=>({u_camera_to_center_distance:new s.Uniform1f(f),u_extrude_scale:new s.UniformMatrix2f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_up_dir:new s.Uniform3f(f)}),collisionBox:f=>({u_matrix:new s.UniformMatrix4f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_extrude_scale:new s.Uniform2f(f)}),collisionCircle:f=>({u_matrix:new s.UniformMatrix4f(f),u_inv_matrix:new s.UniformMatrix4f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_viewport_size:new s.Uniform2f(f)}),debug:f=>({u_color:new s.UniformColor(f),u_matrix:new s.UniformMatrix4f(f),u_overlay:new s.Uniform1i(f),u_overlay_scale:new s.Uniform1f(f)}),clippingMask:f=>({u_matrix:new s.UniformMatrix4f(f)}),heatmap:f=>({u_extrude_scale:new s.Uniform1f(f),u_intensity:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_up_dir:new s.Uniform3f(f)}),heatmapTexture:f=>({u_image:new s.Uniform1i(f),u_color_ramp:new s.Uniform1i(f),u_opacity:new s.Uniform1f(f)}),hillshade:f=>({u_matrix:new s.UniformMatrix4f(f),u_image:new s.Uniform1i(f),u_latrange:new s.Uniform2f(f),u_light:new s.Uniform2f(f),u_shadow:new s.UniformColor(f),u_highlight:new s.UniformColor(f),u_accent:new s.UniformColor(f)}),hillshadePrepare:f=>({u_matrix:new s.UniformMatrix4f(f),u_image:new s.Uniform1i(f),u_dimension:new s.Uniform2f(f),u_zoom:new s.Uniform1f(f),u_unpack:new s.Uniform4f(f)}),line:f=>({u_matrix:new s.UniformMatrix4f(f),u_pixels_to_tile_units:new s.UniformMatrix2f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_units_to_pixels:new s.Uniform2f(f),u_dash_image:new s.Uniform1i(f),u_gradient_image:new s.Uniform1i(f),u_image_height:new s.Uniform1f(f),u_texsize:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f),u_alpha_discard_threshold:new s.Uniform1f(f),u_trim_offset:new s.Uniform2f(f)}),linePattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_texsize:new s.Uniform2f(f),u_pixels_to_tile_units:new s.UniformMatrix2f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_image:new s.Uniform1i(f),u_units_to_pixels:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f),u_alpha_discard_threshold:new s.Uniform1f(f)}),raster:f=>({u_matrix:new s.UniformMatrix4f(f),u_tl_parent:new s.Uniform2f(f),u_scale_parent:new s.Uniform1f(f),u_fade_t:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f),u_image0:new s.Uniform1i(f),u_image1:new s.Uniform1i(f),u_brightness_low:new s.Uniform1f(f),u_brightness_high:new s.Uniform1f(f),u_saturation_factor:new s.Uniform1f(f),u_contrast_factor:new s.Uniform1f(f),u_spin_weights:new s.Uniform3f(f),u_perspective_transform:new s.Uniform2f(f)}),symbolIcon:f=>({u_is_size_zoom_constant:new s.Uniform1i(f),u_is_size_feature_constant:new s.Uniform1i(f),u_size_t:new s.Uniform1f(f),u_size:new s.Uniform1f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_rotate_symbol:new s.Uniform1i(f),u_aspect_ratio:new s.Uniform1f(f),u_fade_change:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_label_plane_matrix:new s.UniformMatrix4f(f),u_coord_matrix:new s.UniformMatrix4f(f),u_is_text:new s.Uniform1i(f),u_pitch_with_map:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_camera_forward:new s.Uniform3f(f),u_tile_matrix:new s.UniformMatrix4f(f),u_up_vector:new s.Uniform3f(f),u_ecef_origin:new s.Uniform3f(f),u_texture:new s.Uniform1i(f)}),symbolSDF:f=>({u_is_size_zoom_constant:new s.Uniform1i(f),u_is_size_feature_constant:new s.Uniform1i(f),u_size_t:new s.Uniform1f(f),u_size:new s.Uniform1f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_rotate_symbol:new s.Uniform1i(f),u_aspect_ratio:new s.Uniform1f(f),u_fade_change:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_label_plane_matrix:new s.UniformMatrix4f(f),u_coord_matrix:new s.UniformMatrix4f(f),u_is_text:new s.Uniform1i(f),u_pitch_with_map:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_texture:new s.Uniform1i(f),u_gamma_scale:new s.Uniform1f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_tile_id:new s.Uniform3f(f),u_zoom_transition:new s.Uniform1f(f),u_inv_rot_matrix:new s.UniformMatrix4f(f),u_merc_center:new s.Uniform2f(f),u_camera_forward:new s.Uniform3f(f),u_tile_matrix:new s.UniformMatrix4f(f),u_up_vector:new s.Uniform3f(f),u_ecef_origin:new s.Uniform3f(f),u_is_halo:new s.Uniform1i(f)}),symbolTextAndIcon:f=>({u_is_size_zoom_constant:new s.Uniform1i(f),u_is_size_feature_constant:new s.Uniform1i(f),u_size_t:new s.Uniform1f(f),u_size:new s.Uniform1f(f),u_camera_to_center_distance:new s.Uniform1f(f),u_rotate_symbol:new s.Uniform1i(f),u_aspect_ratio:new s.Uniform1f(f),u_fade_change:new s.Uniform1f(f),u_matrix:new s.UniformMatrix4f(f),u_label_plane_matrix:new s.UniformMatrix4f(f),u_coord_matrix:new s.UniformMatrix4f(f),u_is_text:new s.Uniform1i(f),u_pitch_with_map:new s.Uniform1i(f),u_texsize:new s.Uniform2f(f),u_texsize_icon:new s.Uniform2f(f),u_texture:new s.Uniform1i(f),u_texture_icon:new s.Uniform1i(f),u_gamma_scale:new s.Uniform1f(f),u_device_pixel_ratio:new s.Uniform1f(f),u_is_halo:new s.Uniform1i(f)}),background:f=>({u_matrix:new s.UniformMatrix4f(f),u_opacity:new s.Uniform1f(f),u_color:new s.UniformColor(f)}),backgroundPattern:f=>({u_matrix:new s.UniformMatrix4f(f),u_opacity:new s.Uniform1f(f),u_image:new s.Uniform1i(f),u_pattern_tl:new s.Uniform2f(f),u_pattern_br:new s.Uniform2f(f),u_texsize:new s.Uniform2f(f),u_pattern_size:new s.Uniform2f(f),u_pixel_coord_upper:new s.Uniform2f(f),u_pixel_coord_lower:new s.Uniform2f(f),u_tile_units_to_pixels:new s.Uniform1f(f)}),terrainRaster:ru,terrainDepth:ru,skybox:f=>({u_matrix:new s.UniformMatrix4f(f),u_sun_direction:new s.Uniform3f(f),u_cubemap:new s.Uniform1i(f),u_opacity:new s.Uniform1f(f),u_temporal_offset:new s.Uniform1f(f)}),skyboxGradient:f=>({u_matrix:new s.UniformMatrix4f(f),u_color_ramp:new s.Uniform1i(f),u_center_direction:new s.Uniform3f(f),u_radius:new s.Uniform1f(f),u_opacity:new s.Uniform1f(f),u_temporal_offset:new s.Uniform1f(f)}),skyboxCapture:f=>({u_matrix_3f:new s.UniformMatrix3f(f),u_sun_direction:new s.Uniform3f(f),u_sun_intensity:new s.Uniform1f(f),u_color_tint_r:new s.Uniform4f(f),u_color_tint_m:new s.Uniform4f(f),u_luminance:new s.Uniform1f(f)}),globeRaster:f=>({u_proj_matrix:new s.UniformMatrix4f(f),u_globe_matrix:new s.UniformMatrix4f(f),u_normalize_matrix:new s.UniformMatrix4f(f),u_merc_matrix:new s.UniformMatrix4f(f),u_zoom_transition:new s.Uniform1f(f),u_merc_center:new s.Uniform2f(f),u_image0:new s.Uniform1i(f),u_grid_matrix:new s.UniformMatrix3f(f),u_skirt_height:new s.Uniform1f(f),u_frustum_tl:new s.Uniform3f(f),u_frustum_tr:new s.Uniform3f(f),u_frustum_br:new s.Uniform3f(f),u_frustum_bl:new s.Uniform3f(f),u_globe_pos:new s.Uniform3f(f),u_globe_radius:new s.Uniform1f(f),u_viewport:new s.Uniform2f(f)}),globeAtmosphere:f=>({u_frustum_tl:new s.Uniform3f(f),u_frustum_tr:new s.Uniform3f(f),u_frustum_br:new s.Uniform3f(f),u_frustum_bl:new s.Uniform3f(f),u_horizon:new s.Uniform1f(f),u_transition:new s.Uniform1f(f),u_fadeout_range:new s.Uniform1f(f),u_color:new s.Uniform4f(f),u_high_color:new s.Uniform4f(f),u_space_color:new s.Uniform4f(f),u_star_intensity:new s.Uniform1f(f),u_star_density:new s.Uniform1f(f),u_star_size:new s.Uniform1f(f),u_temporal_offset:new s.Uniform1f(f),u_horizon_angle:new s.Uniform1f(f),u_rotation_matrix:new s.UniformMatrix4f(f)})};let Qs;function vp(f,r,u,m,y,b,C){const I=f.context,M=I.gl,B=f.transform,O=f.useProgram("collisionBox"),j=[];let H=0,Q=0;for(let pe=0;pe<m.length;pe++){const Ce=m[pe],we=r.getTile(Ce),Ae=we.getBucket(u);if(!Ae)continue;const Be=Mh(Ce,Ae,B);let $e=Be;y[0]===0&&y[1]===0||($e=f.translatePosMatrix(Be,we,y,b));const Ge=C?Ae.textCollisionBox:Ae.iconCollisionBox,wt=Ae.collisionCircleArray;if(wt.length>0){const Fe=s.create(),rt=$e;s.mul(Fe,Ae.placementInvProjMatrix,B.glCoordMatrix),s.mul(Fe,Fe,Ae.placementViewportMatrix),j.push({circleArray:wt,circleOffset:Q,transform:rt,invTransform:Fe,projection:Ae.getProjection()}),H+=wt.length/4,Q=H}Ge&&(f.terrain&&f.terrain.setupElevationDraw(we,O),O.draw(I,M.LINES,s.DepthMode.disabled,s.StencilMode.disabled,f.colorModeForRenderPass(),s.CullFaceMode.disabled,fp($e,B,we,Ae.getProjection()),u.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,null,B.zoom,null,[Ge.collisionVertexBuffer,Ge.collisionVertexBufferExt]))}if(!C||!j.length)return;const J=f.useProgram("collisionCircle"),ee=new s.StructArrayLayout2f1f2i16;ee.resize(4*H),ee._trim();let te=0;for(const pe of j)for(let Ce=0;Ce<pe.circleArray.length/4;Ce++){const we=4*Ce,Ae=pe.circleArray[we+0],Be=pe.circleArray[we+1],$e=pe.circleArray[we+2],Ge=pe.circleArray[we+3];ee.emplace(te++,Ae,Be,$e,Ge,0),ee.emplace(te++,Ae,Be,$e,Ge,1),ee.emplace(te++,Ae,Be,$e,Ge,2),ee.emplace(te++,Ae,Be,$e,Ge,3)}(!Qs||Qs.length<2*H)&&(Qs=function(pe){const Ce=2*pe,we=new s.StructArrayLayout3ui6;we.resize(Ce),we._trim();for(let Ae=0;Ae<Ce;Ae++){const Be=6*Ae;we.uint16[Be+0]=4*Ae+0,we.uint16[Be+1]=4*Ae+1,we.uint16[Be+2]=4*Ae+2,we.uint16[Be+3]=4*Ae+2,we.uint16[Be+4]=4*Ae+3,we.uint16[Be+5]=4*Ae+0}return we}(H));const W=I.createIndexBuffer(Qs,!0),ue=I.createVertexBuffer(ee,s.collisionCircleLayout.members,!0);for(const pe of j){const Ce={u_matrix:pe.transform,u_inv_matrix:pe.invTransform,u_camera_to_center_distance:(ae=B).getCameraToCenterDistance(pe.projection),u_viewport_size:[ae.width,ae.height]};J.draw(I,M.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,f.colorModeForRenderPass(),s.CullFaceMode.disabled,Ce,u.id,ue,W,s.SegmentVector.simpleSegment(0,2*pe.circleOffset,pe.circleArray.length,pe.circleArray.length/2),null,B.zoom)}var ae;ue.destroy(),W.destroy()}const Kh=s.create();function _p({width:f,height:r,anchor:u,textOffset:m,textScale:y},b){const{horizontalAlign:C,verticalAlign:I}=s.getAnchorAlignment(u),M=-(C-.5)*f,B=-(I-.5)*r,O=s.evaluateVariableOffset(u,m);return new s.pointGeometry((M/y+O[0])*b,(B/y+O[1])*b)}function Fa(f,r,u,m,y,b,C,I,M,B,O){const j=f.text.placedSymbolArray,H=f.text.dynamicLayoutVertexArray,Q=f.icon.dynamicLayoutVertexArray,J={},ee=f.getProjection(),te=Hc(I,ee,b),W=b.elevation,ue=ee.upVectorScale(I.canonical,b.center.lat,b.worldSize).metersToTile;H.clear();for(let ae=0;ae<j.length;ae++){const pe=j.get(ae),{tileAnchorX:Ce,tileAnchorY:we,numGlyphs:Ae}=pe,Be=f.allowVerticalPlacement&&!pe.placedOrientation,$e=pe.hidden||!pe.crossTileID||Be?null:m[pe.crossTileID];if($e){let Ge=0,wt=0,Fe=0;if(W){const Ht=W?W.getAtTileOffset(I,Ce,we):0,[vn,jt,Vt]=ee.upVector(I.canonical,Ce,we);Ge=Ht*vn*ue,wt=Ht*jt*ue,Fe=Ht*Vt*ue}let[rt,He,ht,Ue]=Ct(pe.projectedAnchorX+Ge,pe.projectedAnchorY+wt,pe.projectedAnchorZ+Fe,u?te:C);const Le=zn(b.getCameraToCenterDistance(ee),Ue);let Ze=y.evaluateSizeForFeature(f.textSizeData,B,pe)*Le/s.ONE_EM;u&&(Ze*=f.tilePixelRatio/M);const lt=_p($e,Ze);u?({x:rt,y:He,z:ht}=ee.projectTilePoint(Ce+lt.x,we+lt.y,I.canonical),[rt,He,ht]=Ct(rt+Ge,He+wt,ht+Fe,C)):(r&&lt._rotate(-b.angle),rt+=lt.x,He+=lt.y,ht=0);const mt=f.allowVerticalPlacement&&pe.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let Ht=0;Ht<Ae;Ht++)s.addDynamicAttributes(H,rt,He,ht,mt);O&&pe.associatedIconIndex>=0&&(J[pe.associatedIconIndex]={x:rt,y:He,z:ht,angle:mt})}else ci(Ae,H)}if(O){Q.clear();const ae=f.icon.placedSymbolArray;for(let pe=0;pe<ae.length;pe++){const Ce=ae.get(pe),{numGlyphs:we}=Ce,Ae=J[pe];if(Ce.hidden||!Ae)ci(we,Q);else{const{x:Be,y:$e,z:Ge,angle:wt}=Ae;for(let Fe=0;Fe<we;Fe++)s.addDynamicAttributes(Q,Be,$e,Ge,wt)}}f.icon.dynamicLayoutVertexBuffer.updateData(Q)}f.text.dynamicLayoutVertexBuffer.updateData(H)}function av(f,r,u){return u.iconsInText&&r?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function yp(f,r,u,m,y,b,C,I,M,B,O,j){const H=f.context,Q=H.gl,J=f.transform,ee=I==="map",te=M==="map",W=ee&&u.layout.get("symbol-placement")!=="point",ue=ee&&!te&&!W,ae=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let pe=!1;const Ce=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),we=[s.mercatorXfromLng(J.center.lng),s.mercatorYfromLat(J.center.lat)],Ae=u.layout.get("text-variable-anchor"),Be=J.projection.name==="globe",$e=[],Ge=[0,-1,0];let wt=Ge;!Be&&!J.mercatorFromTransition||ee||(wt=function(Fe){const rt=Fe._camera.getWorldToCamera(Fe.worldSize,1),He=s.multiply([],rt,Fe.globeMatrix);s.invert(He,He);const ht=[0,0,0],Ue=[0,1,0,0];return s.transformMat4$1(Ue,Ue,He),ht[0]=Ue[0],ht[1]=Ue[1],ht[2]=Ue[2],s.normalize(ht,ht),ht}(J));for(const Fe of m){const rt=r.getTile(Fe),He=rt.getBucket(u);if(!He||He.projection.name==="mercator"&&Be)continue;const ht=y?He.text:He.icon;if(!ht||He.fullyClipped||!ht.segments.get().length)continue;const Ue=ht.programConfigurations.get(u.id),Le=y||He.sdfIcons,Ze=y?He.textSizeData:He.iconSizeData,lt=te||J.pitch!==0,mt=s.evaluateSizeForZoom(Ze,J.zoom);let Ht,vn,jt,Vt,Xt=[0,0],In=null;if(y){if(vn=rt.glyphAtlasTexture,jt=Q.LINEAR,Ht=rt.glyphAtlasTexture.size,He.iconsInText){Xt=rt.imageAtlasTexture.size,In=rt.imageAtlasTexture;const Wr=Ze.kind==="composite"||Ze.kind==="camera";Vt=lt||f.options.rotating||f.options.zooming||Wr?Q.LINEAR:Q.NEAREST}}else{const Wr=u.layout.get("icon-size").constantOr(0)!==1||He.iconsNeedLinear;vn=rt.imageAtlasTexture,jt=Le||f.options.rotating||f.options.zooming||Wr||lt?Q.LINEAR:Q.NEAREST,Ht=rt.imageAtlasTexture.size}const en=He.projection.name==="globe",Wn=en?wt:Ge,ni=en?s.globeToMercatorTransition(J.zoom):0,ui=Hc(Fe,He.getProjection(),J),oi=J.calculatePixelsToTileUnitsMatrix(rt),Ni=ka(ui,rt.tileID.canonical,te,ee,J,He.getProjection(),oi),Br=f.terrain&&te&&W?s.invert(s.create(),Ni):Kh,lo=Ma(ui,rt.tileID.canonical,te,ee,J,He.getProjection(),oi),Wo=Ae&&He.hasTextData(),_i=u.layout.get("icon-text-fit")!=="none"&&Wo&&He.hasIconData();if(W){const Wr=J.elevation,Jr=Wr?Wr.getAtTileOffsetFunc(Fe,J.center.lat,J.worldSize,He.getProjection()):null,Ho=ep(ui,rt.tileID.canonical,te,ee,J,He.getProjection(),oi);bo(He,ui,f,y,Ho,lo,te,B,Jr,Fe)}const si=W||y&&Ae||_i,$n=f.translatePosMatrix(ui,rt,b,C),ki=si?Kh:Ni,yr=f.translatePosMatrix(lo,rt,b,C,!0),pi=He.getProjection().createInversionMatrix(J,Fe.canonical),xr=[];f.terrainRenderModeElevated()&&te&&xr.push("PITCH_WITH_MAP_TERRAIN"),en&&xr.push("PROJECTION_GLOBE_VIEW"),si&&xr.push("PROJECTED_POS_ON_VIEWPORT");const br=Le&&u.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let _s;_s=Le?He.iconsInText?Xh(Ze.kind,mt,ue,te,f,$n,ki,yr,Ht,Xt,Fe,ni,we,pi,Wn,He.getProjection()):gp(Ze.kind,mt,ue,te,f,$n,ki,yr,y,Ht,!0,Fe,ni,we,pi,Wn,He.getProjection()):Vl(Ze.kind,mt,ue,te,f,$n,ki,yr,y,Ht,Fe,ni,we,pi,Wn,He.getProjection());const Xa={program:f.useProgram(av(Le,y,He),Ue,xr),buffers:ht,uniformValues:_s,atlasTexture:vn,atlasTextureIcon:In,atlasInterpolation:jt,atlasInterpolationIcon:Vt,isSDF:Le,hasHalo:br,tile:rt,labelPlaneMatrixInv:Br};if(ae&&He.canOverlap){pe=!0;const Wr=ht.segments.get();for(const Jr of Wr)$e.push({segments:new s.SegmentVector([Jr]),sortKey:Jr.sortKey,state:Xa})}else $e.push({segments:ht.segments,sortKey:0,state:Xa})}pe&&$e.sort((Fe,rt)=>Fe.sortKey-rt.sortKey);for(const Fe of $e){const rt=Fe.state;if(f.terrain&&f.terrain.setupElevationDraw(rt.tile,rt.program,{useDepthForOcclusion:!Be,labelPlaneMatrixInv:rt.labelPlaneMatrixInv}),H.activeTexture.set(Q.TEXTURE0),rt.atlasTexture.bind(rt.atlasInterpolation,Q.CLAMP_TO_EDGE),rt.atlasTextureIcon&&(H.activeTexture.set(Q.TEXTURE1),rt.atlasTextureIcon&&rt.atlasTextureIcon.bind(rt.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),rt.isSDF){const He=rt.uniformValues;rt.hasHalo&&(He.u_is_halo=1,xp(rt.buffers,Fe.segments,u,f,rt.program,Ce,O,j,He)),He.u_is_halo=0}xp(rt.buffers,Fe.segments,u,f,rt.program,Ce,O,j,rt.uniformValues)}}function xp(f,r,u,m,y,b,C,I,M){const B=m.context,O=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.globeExtVertexBuffer];y.draw(B,B.gl.TRIANGLES,b,C,I,s.CullFaceMode.disabled,M,u.id,f.layoutVertexBuffer,f.indexBuffer,r,u.paint,m.transform.zoom,f.programConfigurations.get(u.id),O)}function bp(f,r,u,m,y,b,C){const I=f.context.gl,M=u.paint.get("fill-pattern"),B=M&&M.constantOr(1);let O,j,H,Q,J;C?(j=B&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",O=I.LINES):(j=B?"fillPattern":"fill",O=I.TRIANGLES);for(const ee of m){const te=r.getTile(ee);if(B&&!te.patternsLoaded())continue;const W=te.getBucket(u);if(!W)continue;f.prepareDrawTile();const ue=W.programConfigurations.get(u.id),ae=f.useProgram(j,ue);B&&(f.context.activeTexture.set(I.TEXTURE0),te.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ue.updatePaintBuffers());const pe=M.constantOr(null);if(pe&&te.imageAtlas){const we=te.imageAtlas.patternPositions[pe.toString()];we&&ue.setConstantPatternPositions(we)}const Ce=f.translatePosMatrix(ee.projMatrix,te,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(C){Q=W.indexBuffer2,J=W.segments2;const we=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];H=j==="fillOutlinePattern"&&B?dp(Ce,f,te,we):hp(Ce,we)}else Q=W.indexBuffer,J=W.segments,H=B?cu(Ce,f,te):lu(Ce);f.prepareDrawProgram(f.context,ae,ee.toUnwrapped()),ae.draw(f.context,O,y,f.stencilModeForClipping(ee),b,s.CullFaceMode.disabled,H,u.id,W.layoutVertexBuffer,Q,J,u.paint,f.transform.zoom,ue)}}function Jh(f,r,u,m,y,b,C){const I=f.context,M=I.gl,B=f.transform,O=u.paint.get("fill-extrusion-pattern"),j=O.constantOr(1),H=u.paint.get("fill-extrusion-opacity"),Q=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),u.paint.get("fill-extrusion-ambient-occlusion-radius")],J=u.layout.get("fill-extrusion-edge-radius"),ee=B.projection.name==="globe"?s.fillExtrusionHeightLift():0,te=B.projection.name==="globe",W=te?s.globeToMercatorTransition(B.zoom):0,ue=[s.mercatorXfromLng(B.center.lng),s.mercatorYfromLat(B.center.lat)],ae=[];te&&ae.push("PROJECTION_GLOBE_VIEW"),Q[0]>0&&ae.push("FAUX_AO");for(const pe of m){const Ce=r.getTile(pe),we=Ce.getBucket(u);if(!we||we.projection.name!==B.projection.name)continue;const Ae=we.programConfigurations.get(u.id),Be=f.useProgram(j?"fillExtrusionPattern":"fillExtrusion",Ae,ae);if(f.terrain){const ht=f.terrain;if(f.style.terrainSetForDrapingOnly())ht.setupElevationDraw(Ce,Be,{useMeterToDem:!0});else{if(!we.enableTerrain)continue;if(ht.setupElevationDraw(Ce,Be,{useMeterToDem:!0}),lv(I,r,pe,we,u,ht),!we.centroidVertexBuffer){const Ue=Be.attributes.a_centroid_pos;Ue!==void 0&&M.vertexAttrib2f(Ue,0,0)}}}j&&(f.context.activeTexture.set(M.TEXTURE0),Ce.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),Ae.updatePaintBuffers());const $e=O.constantOr(null);if($e&&Ce.imageAtlas){const ht=Ce.imageAtlas.patternPositions[$e.toString()];ht&&Ae.setConstantPatternPositions(ht)}const Ge=f.translatePosMatrix(pe.projMatrix,Ce,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),wt=B.projection.createInversionMatrix(B,pe.canonical),Fe=u.paint.get("fill-extrusion-vertical-gradient"),rt=j?Gh(Ge,f,Fe,H,Q,J,pe,Ce,ee,W,ue,wt):au(Ge,f,Fe,H,Q,J,pe,ee,W,ue,wt);f.prepareDrawProgram(I,Be,pe.toUnwrapped());const He=[];f.terrain&&He.push(we.centroidVertexBuffer),te&&He.push(we.layoutVertexExtBuffer),Be.draw(I,I.gl.TRIANGLES,y,b,C,s.CullFaceMode.backCCW,rt,u.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,u.paint,f.transform.zoom,Ae,He)}}function lv(f,r,u,m,y,b){const C=[W=>{let ue=W.canonical.x-1,ae=W.wrap;return ue<0&&(ue=(1<<W.canonical.z)-1,ae--),new s.OverscaledTileID(W.overscaledZ,ae,W.canonical.z,ue,W.canonical.y)},W=>{let ue=W.canonical.x+1,ae=W.wrap;return ue===1<<W.canonical.z&&(ue=0,ae++),new s.OverscaledTileID(W.overscaledZ,ae,W.canonical.z,ue,W.canonical.y)},W=>new s.OverscaledTileID(W.overscaledZ,W.wrap,W.canonical.z,W.canonical.x,(W.canonical.y===0?1<<W.canonical.z:W.canonical.y)-1),W=>new s.OverscaledTileID(W.overscaledZ,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y===(1<<W.canonical.z)-1?0:W.canonical.y+1)],I=W=>{const ue=r.getSource().minzoom,ae=Ce=>{const we=r.getTileByID(Ce);if(we&&we.hasData())return we.getBucket(y)},pe=[0,-1,1];for(const Ce of pe){if(W.overscaledZ+Ce<ue)continue;const we=ae(W.calculateScaledKey(W.overscaledZ+Ce));if(we)return we}},M=[0,0,0],B=(W,ue)=>(M[0]=Math.min(W.min.y,ue.min.y),M[1]=Math.max(W.max.y,ue.max.y),M[2]=s.EXTENT-ue.min.x>W.max.x?ue.min.x-s.EXTENT:W.max.x,M),O=(W,ue)=>(M[0]=Math.min(W.min.x,ue.min.x),M[1]=Math.max(W.max.x,ue.max.x),M[2]=s.EXTENT-ue.min.y>W.max.y?ue.min.y-s.EXTENT:W.max.y,M),j=[(W,ue)=>B(W,ue),(W,ue)=>B(ue,W),(W,ue)=>O(W,ue),(W,ue)=>O(ue,W)],H=new s.pointGeometry(0,0);let Q,J,ee;const te=(W,ue,ae,pe,Ce)=>{const we=[[pe?ae:W,pe?W:ae,0],[pe?ae:ue,pe?ue:ae,0]],Ae=Ce<0?s.EXTENT+Ce:Ce,Be=[pe?Ae:(W+ue)/2,pe?(W+ue)/2:Ae,0];return ae===0&&Ce<0||ae!==0&&Ce>0?b.getForTilePoints(ee,[Be],!0,J):we.push(Be),b.getForTilePoints(u,we,!0,Q),Math.max(we[0][2],we[1][2],Be[2])/b.exaggeration()};for(let W=0;W<4;W++){const ue=(W<2?1:5)-W,ae=m.borders[W];if(ae.length===0)continue;const pe=ee=C[W](u),Ce=I(pe);if(!(Ce&&Ce instanceof s.FillExtrusionBucket&&Ce.enableTerrain)||m.borderDoneWithNeighborZ[W]===Ce.canonical.z&&Ce.borderDoneWithNeighborZ[ue]===m.canonical.z||(J=b.findDEMTileFor(pe),!J||!J.dem))continue;if(!Q){const $e=b.findDEMTileFor(u);if(!$e||!$e.dem)return;Q=$e}const we=Ce.borders[ue];let Ae=0;const Be=Ce.borderDoneWithNeighborZ[ue]!==m.canonical.z;if(m.canonical.z===Ce.canonical.z){for(let $e=0;$e<ae.length;$e++){const Ge=m.featuresOnBorder[ae[$e]],wt=Ge.borders[W];let Fe;for(;Ae<we.length&&(Fe=Ce.featuresOnBorder[we[Ae]],!(Fe.borders[ue][1]>wt[0]+3));)Be&&Ce.encodeCentroid(void 0,Fe,!1),Ae++;if(Fe&&Ae<we.length){const rt=Ae;let He=0;for(;!(Fe.borders[ue][0]>wt[1]-3)&&(He++,++Ae!==we.length);)Fe=Ce.featuresOnBorder[we[Ae]];if(Fe=Ce.featuresOnBorder[we[rt]],Ge.intersectsCount()>1||Fe.intersectsCount()>1||He!==1){He!==1&&(Ae=rt),m.encodeCentroid(void 0,Ge,!1),Be&&Ce.encodeCentroid(void 0,Fe,!1);continue}const ht=j[W](Ge,Fe),Ue=W%2?s.EXTENT-1:0;H.x=te(ht[0],Math.min(s.EXTENT-1,ht[1]),Ue,W<2,ht[2]),H.y=0,m.encodeCentroid(H,Ge,!1),Be&&Ce.encodeCentroid(H,Fe,!1)}else m.encodeCentroid(void 0,Ge,!1)}m.borderDoneWithNeighborZ[W]=Ce.canonical.z,m.needsCentroidUpdate=!0,Be&&(Ce.borderDoneWithNeighborZ[ue]=m.canonical.z,Ce.needsCentroidUpdate=!0)}else{for(const $e of ae)m.encodeCentroid(void 0,m.featuresOnBorder[$e],!1);if(Be){for(const $e of we)Ce.encodeCentroid(void 0,Ce.featuresOnBorder[$e],!1);Ce.borderDoneWithNeighborZ[ue]=m.canonical.z,Ce.needsCentroidUpdate=!0}m.borderDoneWithNeighborZ[W]=Ce.canonical.z,m.needsCentroidUpdate=!0}}(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(f)}const Qh=new s.Color(1,0,0,1),ed=new s.Color(0,1,0,1),wp=new s.Color(0,0,1,1),Ep=new s.Color(1,0,1,1),Sp=new s.Color(0,1,1,1);function td(f,r,u){const m=f.context,y=f.transform,b=m.gl,C=y.projection.name==="globe",I=C?["PROJECTION_GLOBE_VIEW"]:null;let M=u.projMatrix;if(C&&s.globeToMercatorTransition(y.zoom)>0){const Ge=s.transitionTileAABBinECEF(u.canonical,y),wt=s.globeDenormalizeECEF(Ge);M=s.multiply(new Float32Array(16),y.globeMatrix,wt),s.multiply(M,y.projMatrix,M)}const B=f.useProgram("debug",null,I),O=r.getTileByID(u.key);f.terrain&&f.terrain.setupElevationDraw(O,B);const j=s.DepthMode.disabled,H=s.StencilMode.disabled,Q=f.colorModeForRenderPass(),J="$debug";m.activeTexture.set(b.TEXTURE0),f.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),C?O._makeGlobeTileDebugBuffers(f.context,y):O._makeDebugTileBoundsBuffers(f.context,y.projection);const ee=O._tileDebugBuffer||f.debugBuffer,te=O._tileDebugIndexBuffer||f.debugIndexBuffer,W=O._tileDebugSegments||f.debugSegments;B.draw(m,b.LINE_STRIP,j,H,Q,s.CullFaceMode.disabled,Fl(M,s.Color.red),J,ee,te,W,null,null,null,[O._globeTileDebugBorderBuffer]);const ue=O.latestRawTileData,ae=Math.floor((ue&&ue.byteLength||0)/1024),pe=r.getTile(u).tileSize,Ce=512/Math.min(pe,512)*(u.overscaledZ/y.zoom)*.5;let we=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(we+=` => ${u.overscaledZ}`),we+=` ${ae}kb`,function(Ge,wt){Ge.initDebugOverlayCanvas();const Fe=Ge.debugOverlayCanvas,rt=Ge.context.gl,He=Ge.debugOverlayCanvas.getContext("2d");He.clearRect(0,0,Fe.width,Fe.height),He.shadowColor="white",He.shadowBlur=2,He.lineWidth=1.5,He.strokeStyle="white",He.textBaseline="top",He.font="bold 36px Open Sans, sans-serif",He.fillText(wt,5,5),He.strokeText(wt,5,5),Ge.debugOverlayTexture.update(Fe),Ge.debugOverlayTexture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE)}(f,we);const Ae=O._tileDebugTextBuffer||f.debugBuffer,Be=O._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,$e=O._tileDebugTextSegments||f.debugSegments;B.draw(m,b.TRIANGLES,j,H,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,Fl(M,s.Color.transparent,Ce),J,Ae,Be,$e,null,null,null,[O._globeTileDebugTextBuffer])}function vs(f,r,u,m){Nl(f,0,r+u/2,f.transform.width,u,m)}function Va(f,r,u,m){Nl(f,r-u/2,0,u,f.transform.height,m)}function Nl(f,r,u,m,y,b){const C=f.context,I=C.gl;I.enable(I.SCISSOR_TEST),I.scissor(r*s.exported.devicePixelRatio,u*s.exported.devicePixelRatio,m*s.exported.devicePixelRatio,y*s.exported.devicePixelRatio),C.clear({color:b}),I.disable(I.SCISSOR_TEST)}const Na=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:$a}=Na;function qo(f,r,u,m){f.emplaceBack(r,u,m)}class du{constructor(r){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,qo(this.vertexArray,-1,-1,1),qo(this.vertexArray,1,-1,1),qo(this.vertexArray,-1,1,1),qo(this.vertexArray,1,1,1),qo(this.vertexArray,-1,-1,-1),qo(this.vertexArray,1,-1,-1),qo(this.vertexArray,-1,1,-1),qo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,$a),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function Rn(f,r,u,m,y,b){const C=f.gl,I=r.paint.get("sky-atmosphere-color"),M=r.paint.get("sky-atmosphere-halo-color"),B=r.paint.get("sky-atmosphere-sun-intensity"),O=((j,H,Q,J,ee)=>({u_matrix_3f:j,u_sun_direction:H,u_sun_intensity:Q,u_color_tint_r:[J.r,J.g,J.b,J.a],u_color_tint_m:[ee.r,ee.g,ee.b,ee.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),m),y,B,I,M);C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+b,r.skyboxTexture,0),u.draw(f,C.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,O,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const fu=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class cv{constructor(r){const u=new s.StructArrayLayout5f20;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const m=new s.StructArrayLayout3ui6;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(u,fu.members),this.indexBuffer=r.createIndexBuffer(m),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const nd={symbol:function(f,r,u,m,y){if(f.renderPass!=="translucent")return;const b=s.StencilMode.disabled,C=f.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(I,M,B,O,j,H,Q){const J=M.transform,ee=j==="map",te=H==="map";for(const W of I){const ue=O.getTile(W),ae=ue.getBucket(B);if(!ae||!ae.text||!ae.text.segments.get().length)continue;const pe=s.evaluateSizeForZoom(ae.textSizeData,J.zoom),Ce=Hc(W,ae.getProjection(),J),we=J.calculatePixelsToTileUnitsMatrix(ue),Ae=ka(Ce,ue.tileID.canonical,te,ee,J,ae.getProjection(),we),Be=B.layout.get("icon-text-fit")!=="none"&&ae.hasIconData();if(pe){const $e=Math.pow(2,J.zoom-ue.tileID.overscaledZ);Fa(ae,ee,te,Q,s.symbolSize,J,Ae,W,$e,pe,Be)}}}(m,f,u,r,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),y),u.paint.get("icon-opacity").constantOr(1)!==0&&yp(f,r,u,m,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),b,C),u.paint.get("text-opacity").constantOr(1)!==0&&yp(f,r,u,m,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),b,C),r.map.showCollisionBoxes&&(vp(f,r,u,m,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),vp(f,r,u,m,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(f,r,u,m){if(f.renderPass!=="translucent")return;const y=u.paint.get("circle-opacity"),b=u.paint.get("circle-stroke-width"),C=u.paint.get("circle-stroke-opacity"),I=u.layout.get("circle-sort-key").constantOr(1)!==void 0;if(y.constantOr(1)===0&&(b.constantOr(1)===0||C.constantOr(1)===0))return;const M=f.context,B=M.gl,O=f.transform,j=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),H=s.StencilMode.disabled,Q=f.colorModeForRenderPass(),J=O.projection.name==="globe",ee=[s.mercatorXfromLng(O.center.lng),s.mercatorYfromLat(O.center.lat)],te=[];for(let ue=0;ue<m.length;ue++){const ae=m[ue],pe=r.getTile(ae),Ce=pe.getBucket(u);if(!Ce||Ce.projection.name!==O.projection.name)continue;const we=Ce.programConfigurations.get(u.id),Ae=Ol(u);J&&Ae.push("PROJECTION_GLOBE_VIEW");const Be=f.useProgram("circle",we,Ae),$e=Ce.layoutVertexBuffer,Ge=Ce.globeExtVertexBuffer,wt=Ce.indexBuffer,Fe=O.projection.createInversionMatrix(O,ae.canonical),rt={programConfiguration:we,program:Be,layoutVertexBuffer:$e,globeExtVertexBuffer:Ge,indexBuffer:wt,uniformValues:Bl(f,ae,pe,Fe,ee,u),tile:pe};if(I){const He=Ce.segments.get();for(const ht of He)te.push({segments:new s.SegmentVector([ht]),sortKey:ht.sortKey,state:rt})}else te.push({segments:Ce.segments,sortKey:0,state:rt})}I&&te.sort((ue,ae)=>ue.sortKey-ae.sortKey);const W={useDepthForOcclusion:!J};for(const ue of te){const{programConfiguration:ae,program:pe,layoutVertexBuffer:Ce,globeExtVertexBuffer:we,indexBuffer:Ae,uniformValues:Be,tile:$e}=ue.state,Ge=ue.segments;f.terrain&&f.terrain.setupElevationDraw($e,pe,W),f.prepareDrawProgram(M,pe,$e.tileID.toUnwrapped()),pe.draw(M,B.TRIANGLES,j,H,Q,s.CullFaceMode.disabled,Be,u.id,Ce,Ae,Ge,u.paint,O.zoom,ae,[we])}},heatmap:function(f,r,u,m){if(u.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const y=f.context,b=y.gl,C=s.StencilMode.disabled,I=new s.ColorMode([b.ONE,b.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(Q,J,ee,te){const W=Q.gl,ue=J.width*te,ae=J.height*te;Q.activeTexture.set(W.TEXTURE1),Q.viewport.set([0,0,ue,ae]);let pe=ee.heatmapFbo;if(!pe||pe&&(pe.width!==ue||pe.height!==ae)){pe&&pe.destroy();const Ce=W.createTexture();W.bindTexture(W.TEXTURE_2D,Ce),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MIN_FILTER,W.LINEAR),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MAG_FILTER,W.LINEAR),pe=ee.heatmapFbo=Q.createFramebuffer(ue,ae,!1),function(we,Ae,Be,$e,Ge,wt){const Fe=we.gl;Fe.texImage2D(Fe.TEXTURE_2D,0,we.isWebGL2&&we.extRenderToTextureHalfFloat?Fe.RGBA16F:Fe.RGBA,Ge,wt,0,Fe.RGBA,we.extRenderToTextureHalfFloat?we.isWebGL2?Fe.HALF_FLOAT:we.extTextureHalfFloat.HALF_FLOAT_OES:Fe.UNSIGNED_BYTE,null),$e.colorAttachment.set(Be)}(Q,0,Ce,pe,ue,ae)}else W.bindTexture(W.TEXTURE_2D,pe.colorAttachment.get()),Q.bindFramebuffer.set(pe.framebuffer)})(y,f,u,f.transform.projection.name==="globe"?.5:.25),y.clear({color:s.Color.transparent});const M=f.transform,B=M.projection.name==="globe",O=B?["PROJECTION_GLOBE_VIEW"]:null,j=B?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,H=[s.mercatorXfromLng(M.center.lng),s.mercatorYfromLat(M.center.lat)];for(let Q=0;Q<m.length;Q++){const J=m[Q];if(r.hasRenderableParent(J))continue;const ee=r.getTile(J),te=ee.getBucket(u);if(!te||te.projection.name!==M.projection.name)continue;const W=te.programConfigurations.get(u.id),ue=f.useProgram("heatmap",W,O),{zoom:ae}=f.transform;f.terrain&&f.terrain.setupElevationDraw(ee,ue),f.prepareDrawProgram(y,ue,J.toUnwrapped());const pe=M.projection.createInversionMatrix(M,J.canonical);ue.draw(y,b.TRIANGLES,s.DepthMode.disabled,C,I,j,wo(f,J,ee,pe,H,ae,u.paint.get("heatmap-intensity")),u.id,te.layoutVertexBuffer,te.indexBuffer,te.segments,u.paint,f.transform.zoom,W,B?[te.globeExtVertexBuffer]:null)}y.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(y,b){const C=y.context,I=C.gl,M=b.heatmapFbo;if(!M)return;C.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,M.colorAttachment.get()),C.activeTexture.set(I.TEXTURE1);let B=b.colorRampTexture;B||(B=b.colorRampTexture=new s.Texture(C,b.colorRamp,I.RGBA)),B.bind(I.LINEAR,I.CLAMP_TO_EDGE),y.useProgram("heatmapTexture").draw(C,I.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,y.colorModeForRenderPass(),s.CullFaceMode.disabled,((O,j,H,Q)=>({u_image:0,u_color_ramp:1,u_opacity:j.paint.get("heatmap-opacity")}))(0,b),b.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,b.paint,y.transform.zoom)}(f,u))},line:function(f,r,u,m){if(f.renderPass!=="translucent")return;const y=u.paint.get("line-opacity"),b=u.paint.get("line-width");if(y.constantOr(1)===0||b.constantOr(1)===0)return;const C=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),I=f.colorModeForRenderPass(),M=f.terrain&&f.terrain.renderingToTexture?1:s.exported.devicePixelRatio,B=u.paint.get("line-dasharray"),O=B.constantOr(1),j=u.layout.get("line-cap"),H=u.paint.get("line-pattern"),Q=H.constantOr(1),J=u.paint.get("line-gradient"),ee=Q?"linePattern":"line",te=f.context,W=te.gl,ue=(pe=>{const Ce=[];hu(pe)&&Ce.push("RENDER_LINE_DASH"),pe.paint.get("line-gradient")&&Ce.push("RENDER_LINE_GRADIENT");const we=pe.paint.get("line-trim-offset");we[0]===0&&we[1]===0||Ce.push("RENDER_LINE_TRIM_OFFSET");const Ae=pe.paint.get("line-pattern").constantOr(1),Be=pe.paint.get("line-opacity").constantOr(1)!==1;return!Ae&&Be&&Ce.push("RENDER_LINE_ALPHA_DISCARD"),Ce})(u);let ae=ue.includes("RENDER_LINE_ALPHA_DISCARD");f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(ae=!1);for(const pe of m){const Ce=r.getTile(pe);if(Q&&!Ce.patternsLoaded())continue;const we=Ce.getBucket(u);if(!we)continue;f.prepareDrawTile();const Ae=we.programConfigurations.get(u.id),Be=f.useProgram(ee,Ae,ue),$e=H.constantOr(null);if($e&&Ce.imageAtlas){const Le=Ce.imageAtlas.patternPositions[$e.toString()];Le&&Ae.setConstantPatternPositions(Le)}const Ge=B.constantOr(null),wt=j.constantOr(null);if(!Q&&Ge&&wt&&Ce.lineAtlas){const Le=Ce.lineAtlas.getDash(Ge,wt);Le&&Ae.setConstantPatternPositions(Le)}let[Fe,rt]=u.paint.get("line-trim-offset");(wt==="round"||wt==="square")&&Fe!==rt&&(Fe===0&&(Fe-=1),rt===1&&(rt+=1));const He=f.terrain?pe.projMatrix:null,ht=Q?pp(f,Ce,u,He,M):Zh(f,Ce,u,He,we.lineClipsArray.length,M,[Fe,rt]);if(J){const Le=we.gradients[u.id];let Ze=Le.texture;if(u.gradientVersion!==Le.version){let lt=256;if(u.stepInterpolant){const mt=r.getSource().maxzoom,Ht=pe.canonical.z===mt?Math.ceil(1<<f.transform.maxZoom-pe.canonical.z):1;lt=s.clamp(s.nextPowerOfTwo(we.maxLineLength/s.EXTENT*1024*Ht),256,te.maxTextureSize)}Le.gradient=s.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:lt,image:Le.gradient||void 0,clips:we.lineClipsArray}),Le.texture?Le.texture.update(Le.gradient):Le.texture=new s.Texture(te,Le.gradient,W.RGBA),Le.version=u.gradientVersion,Ze=Le.texture}te.activeTexture.set(W.TEXTURE1),Ze.bind(u.stepInterpolant?W.NEAREST:W.LINEAR,W.CLAMP_TO_EDGE)}O&&(te.activeTexture.set(W.TEXTURE0),Ce.lineAtlasTexture.bind(W.LINEAR,W.REPEAT),Ae.updatePaintBuffers()),Q&&(te.activeTexture.set(W.TEXTURE0),Ce.imageAtlasTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),Ae.updatePaintBuffers()),f.prepareDrawProgram(te,Be,pe.toUnwrapped());const Ue=Le=>{Be.draw(te,W.TRIANGLES,C,Le,I,s.CullFaceMode.disabled,ht,u.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,u.paint,f.transform.zoom,Ae,[we.layoutVertexBuffer2])};if(ae){const Le=f.stencilModeForClipping(pe).ref;Le===0&&f.terrain&&te.clear({stencil:0});const Ze={func:W.EQUAL,mask:255};ht.u_alpha_discard_threshold=.8,Ue(new s.StencilMode(Ze,Le,255,W.KEEP,W.KEEP,W.INVERT)),ht.u_alpha_discard_threshold=0,Ue(new s.StencilMode(Ze,Le,255,W.KEEP,W.KEEP,W.KEEP))}else Ue(f.stencilModeForClipping(pe))}ae&&(f.resetStencilClippingMasks(),f.terrain&&te.clear({stencil:0}))},fill:function(f,r,u,m){const y=u.paint.get("fill-color"),b=u.paint.get("fill-opacity");if(b.constantOr(1)===0)return;const C=f.colorModeForRenderPass(),I=u.paint.get("fill-pattern"),M=f.opaquePassEnabledForLayer()&&!I.constantOr(1)&&y.constantOr(s.Color.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===M){const B=f.depthModeForSublayer(1,f.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);bp(f,r,u,m,B,C,!1)}if(f.renderPass==="translucent"&&u.paint.get("fill-antialias")){const B=f.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);bp(f,r,u,m,B,C,!0)}},"fill-extrusion":function(f,r,u,m){const y=u.paint.get("fill-extrusion-opacity");if(y!==0&&f.renderPass==="translucent"){const b=new s.DepthMode(f.context.gl.LEQUAL,s.DepthMode.ReadWrite,f.depthRangeFor3D);if(y!==1||u.paint.get("fill-extrusion-pattern").constantOr(1))Jh(f,r,u,m,b,s.StencilMode.disabled,s.ColorMode.disabled),Jh(f,r,u,m,b,f.stencilModeFor3D(),f.colorModeForRenderPass()),f.resetStencilClippingMasks();else{const C=f.colorModeForRenderPass();Jh(f,r,u,m,b,s.StencilMode.disabled,C)}}},hillshade:function(f,r,u,m){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent")return;const y=f.context,b=f.depthModeForSublayer(0,s.DepthMode.ReadOnly),C=f.colorModeForRenderPass(),I=f.terrain&&f.terrain.renderingToTexture,[M,B]=f.renderPass!=="translucent"||I?[{},m]:f.stencilConfigForOverlap(m);for(const O of B){const j=r.getTile(O);if(j.needsHillshadePrepare&&f.renderPass==="offscreen")iu(f,j,u,b,s.StencilMode.disabled,C);else if(f.renderPass==="translucent"){const H=I&&f.terrain?f.terrain.stencilModeForRTTOverlap(O):M[O.overscaledZ];Ll(f,O,j,u,b,H,C)}}y.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,r,u,m,y,b){if(f.renderPass!=="translucent"||u.paint.get("raster-opacity")===0||!m.length)return;const C=f.context,I=C.gl,M=r.getSource(),B=f.useProgram("raster"),O=f.colorModeForRenderPass(),j=f.terrain&&f.terrain.renderingToTexture,[H,Q]=M instanceof Ie||j?[{},m]:f.stencilConfigForOverlap(m),J=Q[Q.length-1].overscaledZ,ee=!f.options.moving;for(const te of Q){const W=j?s.DepthMode.disabled:f.depthModeForSublayer(te.overscaledZ-J,u.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,I.LESS),ue=te.toUnwrapped(),ae=r.getTile(te);if(j&&(!ae||!ae.hasData()))continue;const pe=j?te.projMatrix:f.transform.calculateProjMatrix(ue,ee),Ce=f.terrain&&j?f.terrain.stencilModeForRTTOverlap(te):H[te.overscaledZ],we=b?0:u.paint.get("raster-fade-duration");ae.registerFadeDuration(we);const Ae=r.findLoadedParent(te,0),Be=Rl(ae,Ae,r,f.transform,we);let $e,Ge;f.terrain&&f.terrain.prepareDrawTile();const wt=u.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;C.activeTexture.set(I.TEXTURE0),ae.texture.bind(wt,I.CLAMP_TO_EDGE),C.activeTexture.set(I.TEXTURE1),Ae?(Ae.texture.bind(wt,I.CLAMP_TO_EDGE),$e=Math.pow(2,Ae.tileID.overscaledZ-ae.tileID.overscaledZ),Ge=[ae.tileID.canonical.x*$e%1,ae.tileID.canonical.y*$e%1]):ae.texture.bind(wt,I.CLAMP_TO_EDGE);const Fe=rv(pe,Ge||[0,0],$e||1,Be,u,M instanceof Ie?M.perspectiveTransform:[0,0]);if(f.prepareDrawProgram(C,B,ue),M instanceof Ie)M.boundsBuffer&&M.boundsSegments&&B.draw(C,I.TRIANGLES,W,s.StencilMode.disabled,O,s.CullFaceMode.disabled,Fe,u.id,M.boundsBuffer,f.quadTriangleIndexBuffer,M.boundsSegments);else{const{tileBoundsBuffer:rt,tileBoundsIndexBuffer:He,tileBoundsSegments:ht}=f.getTileBoundsBuffers(ae);B.draw(C,I.TRIANGLES,W,Ce,O,s.CullFaceMode.disabled,Fe,u.id,rt,He,ht)}}f.resetStencilClippingMasks()},background:function(f,r,u,m){const y=u.paint.get("background-color"),b=u.paint.get("background-opacity");if(b===0)return;const C=f.context,I=C.gl,M=f.transform,B=M.tileSize,O=u.paint.get("background-pattern");if(f.isPatternMissing(O))return;const j=!O&&y.a===1&&b===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==j)return;const H=s.StencilMode.disabled,Q=f.depthModeForSublayer(0,j==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),J=f.colorModeForRenderPass(),ee=f.useProgram(O?"backgroundPattern":"background");let te,W=m;W||(te=f.getBackgroundTiles(),W=Object.values(te).map(ue=>ue.tileID)),O&&(C.activeTexture.set(I.TEXTURE0),f.imageManager.bind(f.context));for(const ue of W){const ae=ue.toUnwrapped(),pe=m?ue.projMatrix:f.transform.calculateProjMatrix(ae);f.prepareDrawTile();const Ce=r?r.getTile(ue):te?te[ue.key]:new s.Tile(ue,B,M.zoom,f),we=O?Yh(pe,b,f,O,{tileID:ue,tileSize:B}):ov(pe,b,y);f.prepareDrawProgram(C,ee,ae);const{tileBoundsBuffer:Ae,tileBoundsIndexBuffer:Be,tileBoundsSegments:$e}=f.getTileBoundsBuffers(Ce);ee.draw(C,I.TRIANGLES,Q,H,J,s.CullFaceMode.disabled,we,u.id,Ae,Be,$e)}},sky:function(f,r,u){const m=f.transform,y=m.projection.name==="mercator"||m.projection.name==="globe"?1:s.smoothstep(7,8,m.zoom),b=u.paint.get("sky-opacity")*y;if(b===0)return;const C=f.context,I=u.paint.get("sky-type"),M=new s.DepthMode(C.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),B=f.frameCounter/1e3%1;I==="atmosphere"?f.renderPass==="offscreen"?u.needsSkyboxCapture(f)&&(function(O,j,H,Q){const J=O.context,ee=J.gl;let te=j.skyboxFbo;if(!te){te=j.skyboxFbo=J.createFramebuffer(32,32,!1),j.skyboxGeometry=new du(J),j.skyboxTexture=J.gl.createTexture(),ee.bindTexture(ee.TEXTURE_CUBE_MAP,j.skyboxTexture),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MAG_FILTER,ee.LINEAR);for(let pe=0;pe<6;++pe)ee.texImage2D(ee.TEXTURE_CUBE_MAP_POSITIVE_X+pe,0,ee.RGBA,32,32,0,ee.RGBA,ee.UNSIGNED_BYTE,null)}J.bindFramebuffer.set(te.framebuffer),J.viewport.set([0,0,32,32]);const W=j.getCenter(O,!0),ue=O.useProgram("skyboxCapture"),ae=new Float64Array(16);s.identity(ae),s.rotateY(ae,ae,.5*-Math.PI),Rn(J,j,ue,ae,W,0),s.identity(ae),s.rotateY(ae,ae,.5*Math.PI),Rn(J,j,ue,ae,W,1),s.identity(ae),s.rotateX(ae,ae,.5*-Math.PI),Rn(J,j,ue,ae,W,2),s.identity(ae),s.rotateX(ae,ae,.5*Math.PI),Rn(J,j,ue,ae,W,3),s.identity(ae),Rn(J,j,ue,ae,W,4),s.identity(ae),s.rotateY(ae,ae,Math.PI),Rn(J,j,ue,ae,W,5),J.viewport.set([0,0,O.width,O.height])}(f,u),u.markSkyboxValid(f)):f.renderPass==="sky"&&function(O,j,H,Q,J){const ee=O.context,te=ee.gl,W=O.transform,ue=O.useProgram("skybox");ee.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_CUBE_MAP,j.skyboxTexture);const ae=((pe,Ce,we,Ae,Be)=>({u_matrix:pe,u_sun_direction:Ce,u_cubemap:0,u_opacity:Ae,u_temporal_offset:Be}))(W.skyboxMatrix,j.getCenter(O,!1),0,Q,J);O.prepareDrawProgram(ee,ue),ue.draw(ee,te.TRIANGLES,H,s.StencilMode.disabled,O.colorModeForRenderPass(),s.CullFaceMode.backCW,ae,"skybox",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(f,u,M,b,B):I==="gradient"&&f.renderPass==="sky"&&function(O,j,H,Q,J){const ee=O.context,te=ee.gl,W=O.transform,ue=O.useProgram("skyboxGradient");j.skyboxGeometry||(j.skyboxGeometry=new du(ee)),ee.activeTexture.set(te.TEXTURE0);let ae=j.colorRampTexture;ae||(ae=j.colorRampTexture=new s.Texture(ee,j.colorRamp,te.RGBA)),ae.bind(te.LINEAR,te.CLAMP_TO_EDGE);const pe=((Ce,we,Ae,Be,$e)=>({u_matrix:Ce,u_color_ramp:0,u_center_direction:we,u_radius:s.degToRad(Ae),u_opacity:Be,u_temporal_offset:$e}))(W.skyboxMatrix,j.getCenter(O,!1),j.paint.get("sky-gradient-radius"),Q,J);O.prepareDrawProgram(ee,ue),ue.draw(ee,te.TRIANGLES,H,s.StencilMode.disabled,O.colorModeForRenderPass(),s.CullFaceMode.backCW,pe,"skyboxGradient",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(f,u,M,b,B)},debug:function(f,r,u){for(let m=0;m<u.length;m++)td(f,r,u[m])},custom:function(f,r,u,m){const y=f.context,b=u.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&u.isLayerDraped()){if(f.renderPass==="offscreen"){const C=b.prerender;if(C){if(f.setCustomLayerDefaults(),y.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const I=f.transform.pointMerc;C.call(b,y.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(f.transform.zoom),[I.x,I.y],f.transform.pixelsPerMeterRatio)}else C.call(b,y.gl,f.transform.customLayerMatrix());y.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const I=b.renderToTile;if(I){const M=m[0].canonical,B=new s.MercatorCoordinate(M.x+m[0].wrap*(1<<M.z),M.y,M.z);y.setDepthMode(s.DepthMode.disabled),y.setStencilMode(s.StencilMode.disabled),y.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),I.call(b,y.gl,B),y.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),y.setColorMode(f.colorModeForRenderPass()),y.setStencilMode(s.StencilMode.disabled);const C=b.renderingMode==="3d"?new s.DepthMode(f.context.gl.LEQUAL,s.DepthMode.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(y.setDepthMode(C),f.transform.projection.name==="globe"){const I=f.transform.pointMerc;b.render(y.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(f.transform.zoom),[I.x,I.y],f.transform.pixelsPerMeterRatio)}else b.render(y.gl,f.transform.customLayerMatrix());y.setDirty(),f.setBaseState(),y.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class $l{constructor(r,u,m=!1){this.context=new se(r,m),this.transform=u,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ip,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(r,u){const m=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Uh(this,r));const y=this._terrain;this.transform.elevation=m?y:null,y.update(r,this.transform,u)}_updateFog(r){const u=r.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,y]=u.getFovAdjustedRange(this.transform._fov);if(m>y)return void(this.transform.fogCullDistSq=null);const b=m+.78*(y-m);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(r,u){if(this.width=r*s.exported.devicePixelRatio,this.height=u*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._layers[m].resize()}setup(){const r=this.context,u=new s.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(s.EXTENT,0),u.emplaceBack(0,s.EXTENT),u.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(u,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const m=new s.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(s.EXTENT,0),m.emplaceBack(0,s.EXTENT),m.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=r.createVertexBuffer(m,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const y=new s.StructArrayLayout2i4;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(y,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const b=new s.StructArrayLayout4i8;b.emplaceBack(0,0,0,0),b.emplaceBack(s.EXTENT,0,s.EXTENT,0),b.emplaceBack(0,s.EXTENT,0,s.EXTENT),b.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=r.createVertexBuffer(b,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const C=new s.StructArrayLayout3ui6;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(C);const I=new s.StructArrayLayout1ui2;for(const B of[0,1,3,2,0])I.emplaceBack(B);this.debugIndexBuffer=r.createIndexBuffer(I),this.emptyTexture=new s.Texture(r,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA),this.identityMat=s.create();const M=this.context.gl;this.stencilClearMode=new s.StencilMode({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new cv(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context,u=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(r,u.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,Vn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,u,m){if(!u||this.currentStencilSource===u.id||!r.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const M of m)if(this._tileClippingMaskIDs[M.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=u.id;const y=this.context,b=y.gl;this.nextStencilID+m.length>256&&this.clearStencil(),y.setColorMode(s.ColorMode.disabled),y.setDepthMode(s.DepthMode.disabled);const C=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of m){const M=u.getTile(I),B=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:O,tileBoundsIndexBuffer:j,tileBoundsSegments:H}=this.getTileBoundsBuffers(M);C.draw(y,b.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:b.ALWAYS,mask:0},B,255,b.KEEP,b.KEEP,b.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Vn(I.projMatrix),"$clipping",O,j,H)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,u=this.context.gl;return new s.StencilMode({func:u.NOTEQUAL,mask:255},r,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const u=this.context.gl;return new s.StencilMode({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(r){const u=this.context.gl,m=r.sort((C,I)=>I.overscaledZ-C.overscaledZ),y=m[m.length-1].overscaledZ,b=m[0].overscaledZ-y+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const C={};for(let I=0;I<b;I++)C[I+y]=new s.StencilMode({func:u.GEQUAL,mask:255},I+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=b,[C,m]}return[{[y]:s.StencilMode.disabled},m]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([r.CONSTANT_COLOR,r.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(r,u,m){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new s.DepthMode(m||this.context.gl.LEQUAL,u,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,u){this.style=r,this.options=u,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const m=this.style.order,y=this.style._sourceCaches;for(const M in y){const B=y[M];B.used&&B.prepare(this.context)}const b={},C={},I={};for(const M in y){const B=y[M];b[M]=B.getVisibleCoordinates(),C[M]=b[M].slice().reverse(),I[M]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<m.length;M++)if(this.style._layers[m[M]].is3D()){this.opaquePassCutoff=M;break}if(this.terrain&&(this.terrain.updateTileBinding(I),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),s.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const M of m){const B=this.style._layers[M],O=r._getLayerSourceCache(B);if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const j=O?C[O.id]:void 0;(B.type==="custom"||B.isSky()||j&&j.length)&&this.renderLayer(this,O,B,j)}if(this.depthRangeFor3D=[0,1-(r.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:u.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[m[this.currentLayer]],B=r._getLayerSourceCache(M);if(M.isSky())continue;const O=B?C[B.id]:void 0;this._renderTileClippingMasks(M,B,O),this.renderLayer(this,B,M,O)}if(this.style.fog&&this.transform.projection.supportsFog&&function(M,B){const O=M.context,j=O.gl,H=M.transform,Q=new s.DepthMode(j.LEQUAL,s.DepthMode.ReadOnly,[0,1]),J=M.useProgram("globeAtmosphere",null,H.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ee=s.globeToMercatorTransition(H.zoom),te=B.properties.get("color").toArray01(),W=B.properties.get("high-color").toArray01(),ue=B.properties.get("space-color").toArray01PremultipliedAlpha(),ae=s.identity$1([]);s.rotateY$1(ae,ae,-s.degToRad(H._center.lng)),s.rotateX$1(ae,ae,s.degToRad(H._center.lat)),s.rotateZ$1(ae,ae,H.angle),s.rotateX$1(ae,ae,-H._pitch);const pe=s.fromQuat(new Float32Array(16),ae),Ce=s.mapValue(B.properties.get("star-intensity"),0,1,0,.25),we=5e-4,Ae=s.mapValue(B.properties.get("horizon-blend"),0,1,we,.25),Be=s.globeUseCustomAntiAliasing(M,O,H)&&Ae===we?H.worldSize/(2*Math.PI*1.025)-1:H.globeRadius,$e=M.frameCounter/1e3%1,Ge=s.length(H.globeCenterInViewSpace),wt=Math.sqrt(Math.pow(Ge,2)-Math.pow(Be,2)),Fe=Math.acos(wt/Ge),rt=((ht,Ue,Le,Ze,lt,mt,Ht,vn,jt,Vt,Xt,In,en,Wn)=>({u_frustum_tl:ht,u_frustum_tr:Ue,u_frustum_br:Le,u_frustum_bl:Ze,u_horizon:lt,u_transition:mt,u_fadeout_range:Ht,u_color:vn,u_high_color:jt,u_space_color:Vt,u_star_intensity:Xt,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:In,u_horizon_angle:en,u_rotation_matrix:Wn}))(H.frustumCorners.TL,H.frustumCorners.TR,H.frustumCorners.BR,H.frustumCorners.BL,H.frustumCorners.horizon,ee,Ae,te,W,ue,Ce,$e,Fe,pe);M.prepareDrawProgram(O,J);const He=M.atmosphereBuffer;He&&J.draw(O,j.TRIANGLES,Q,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,rt,"skybox",He.vertexBuffer,He.indexBuffer,He.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const M=this.style._layers[m[this.currentLayer]],B=r._getLayerSourceCache(M);M.isSky()&&this.renderLayer(this,B,M,B?C[B.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;){const M=this.style._layers[m[this.currentLayer]],B=r._getLayerSourceCache(M);if(M.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(M)){if(M.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const O=B?(M.type==="symbol"?I:C)[B.id]:void 0;this._renderTileClippingMasks(M,B,B?b[B.id]:void 0),this.renderLayer(this,B,M,O),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let M=null;s.values(this.style._layers).forEach(B=>{const O=r._getLayerSourceCache(B);O&&!B.isHidden(this.transform.zoom)&&(!M||M.getSource().maxzoom<O.getSource().maxzoom)&&(M=O)}),M&&this.options.showTileBoundaries&&nd.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const B=M.transform.padding;vs(M,M.transform.height-(B.top||0),3,Qh),vs(M,B.bottom||0,3,ed),Va(M,B.left||0,3,wp),Va(M,M.transform.width-(B.right||0),3,Ep);const O=M.transform.centerPoint;(function(j,H,Q,J){Nl(j,H-1,Q-10,2,20,J),Nl(j,H-10,Q-1,20,2,J)})(M,O.x,M.transform.height-O.y,Sp)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}}renderLayer(r,u,m,y){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||y&&y.length)&&(this.id=m.id,this.gpuTimingStart(m),(!r.transform.projection.unsupportedLayers||!r.transform.projection.unsupportedLayers.includes(m.type)||r.terrain&&m.type==="custom")&&nd[m.type](r,u,m,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;let m=this.gpuTimers[r.id];m||(m=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),m.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,m.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,u=r.createQueryEXT();this.deferredRenderGpuTimeQueries.push(u),r.beginQueryEXT(r.TIME_ELAPSED_EXT,u)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const u={};for(const m in r){const y=r[m],b=this.context.extTimerQuery,C=b.getQueryObjectEXT(y.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(y.query),u[m]=C}return u}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.extTimerQuery;let m=0;for(const y of r)m+=u.getQueryObjectEXT(y,u.QUERY_RESULT_EXT)/1e6,u.deleteQueryEXT(y);return m}translatePosMatrix(r,u,m,y,b){if(!m[0]&&!m[1])return r;const C=b?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(C){const B=Math.sin(C),O=Math.cos(C);m=[m[0]*O-m[1]*B,m[0]*B+m[1]*O]}const I=[b?m[0]:kt(u,m[0],this.transform.zoom),b?m[1]:kt(u,m[1],this.transform.zoom),0],M=new Float32Array(16);return s.translate(M,r,I),M}saveTileTexture(r){const u=this._tileTextures[r.size[0]];u?u.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const u=this._tileTextures[r];return u&&u.length>0?u.pop():null}isPatternMissing(r){return r===null||r!==void 0&&!this.imageManager.getPattern(r.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const r=this.terrain&&this.terrain.renderingToTexture,u=this.terrain&&this.terrain.exaggeration()===0,m=this.style&&this.style.fog,y=[];return this.terrainRenderModeElevated()&&y.push("TERRAIN"),this.transform.projection.name==="globe"&&y.push("GLOBE"),u&&y.push("ZERO_EXAGGERATION"),m&&!r&&m.getOpacity(this.transform.pitch)!==0&&y.push("FOG"),r&&y.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&y.push("OVERDRAW_INSPECTOR"),y}useProgram(r,u,m){this.cache=this.cache||{};const y=m||[],b=this.currentGlobalDefines().concat(y),C=jh.cacheKey(Bh[r],r,b,u);return this.cache[C]||(this.cache[C]=new jh(this.context,r,Bh[r],u,sv[r],b)),this.cache[C]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(r,u,m){if(this.terrain&&this.terrain.renderingToTexture)return;const y=this.style.fog;if(y){const b=y.getOpacity(this.transform.pitch),C=((I,M,B,O,j,H,Q,J,ee,te,W)=>{const ue=I.transform,ae=M.properties.get("color").toArray01();ae[3]=O;const pe=I.frameCounter/1e3%1;return{u_fog_matrix:B?ue.calculateFogTileMatrix(B):I.identityMat,u_fog_range:M.getFovAdjustedRange(ue._fov),u_fog_color:ae,u_fog_horizon_blend:M.properties.get("horizon-blend"),u_fog_temporal_offset:pe,u_frustum_tl:j,u_frustum_tr:H,u_frustum_br:Q,u_frustum_bl:J,u_globe_pos:ee,u_globe_radius:te,u_viewport:W,u_globe_transition:s.globeToMercatorTransition(ue.zoom),u_is_globe:+(ue.projection.name==="globe")}})(this,y,m,b,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);u.setFogUniformValues(r,C)}}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,u=r.createTexture();return r.bindTexture(r.TEXTURE_2D,u),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,u=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const y of m)u[y.key]=r[y.key]||new s.Tile(y,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}}class id{constructor(r=0,u=0,m=0,y=0){if(isNaN(r)||r<0||isNaN(u)||u<0||isNaN(m)||m<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=u,this.left=m,this.right=y}interpolate(r,u,m){return u.top!=null&&r.top!=null&&(this.top=s.number(r.top,u.top,m)),u.bottom!=null&&r.bottom!=null&&(this.bottom=s.number(r.bottom,u.bottom,m)),u.left!=null&&r.left!=null&&(this.left=s.number(r.left,u.left,m)),u.right!=null&&r.right!=null&&(this.right=s.number(r.right,u.right,m)),this}getCenter(r,u){const m=s.clamp((this.left+r-this.right)/2,0,r),y=s.clamp((this.top+u-this.bottom)/2,0,u);return new s.pointGeometry(m,y)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new id(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Tp(f,r){const u=s.getColumn(f,3);s.fromQuat(f,r),s.setColumn(f,3,u)}function pu(f,r){const u=s.identity$1([]);return s.rotateZ$1(u,u,-r),s.rotateX$1(u,u,-f),u}function Cp(f,r){const u=[f[0],f[1],0],m=[r[0],r[1],0];if(s.length(u)>=1e-15){const C=s.normalize([],u);s.scale$2(m,C,s.dot(m,C)),r[0]=m[0],r[1]=m[1]}const y=s.cross([],r,f);if(s.len(y)<1e-15)return null;const b=Math.atan2(-y[1],y[0]);return pu(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),b)}class mu{constructor(r,u){this.position=r,this.orientation=u}get position(){return this._position}set position(r){if(r){const u=r instanceof s.MercatorCoordinate?r:new s.MercatorCoordinate(r[0],r[1],r[2]);this._renderWorldCopies&&(u.x=s.wrap(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(r,u){if(this.orientation=null,!this.position)return;const m=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(r)):0,y=this.position,b=s.MercatorCoordinate.fromLngLat(r,m),C=[b.x-y.x,b.y-y.y,b.z-y.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=Cp(C,u)}setPitchBearing(r,u){this.orientation=pu(s.degToRad(r),s.degToRad(-u))}}class Ua{constructor(r,u){this._transform=s.identity([]),this.orientation=u,this.position=r}get mercatorPosition(){const r=this.position;return new s.MercatorCoordinate(r[0],r[1],r[2])}get position(){const r=s.getColumn(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var u;r&&s.setColumn(this._transform,3,[(u=r)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||s.identity$1([]),r&&Tp(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,u){this._orientation=pu(r,u),Tp(this._transform,this._orientation)}forward(){const r=s.getColumn(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=s.getColumn(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=s.getColumn(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,u){const m=new Float64Array(16);return s.invert(m,this.getWorldToCamera(r,u)),m}getWorldToCameraPosition(r,u,m){const y=this.position;s.scale$2(y,y,-r);const b=new Float64Array(16);return s.fromScaling(b,[m,m,m]),s.translate(b,b,y),b[10]*=u,b}getWorldToCamera(r,u){const m=new Float64Array(16),y=new Float64Array(4),b=this.position;return s.conjugate(y,this._orientation),s.scale$2(b,b,-r),s.fromQuat(m,y),s.translate(m,m,b),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=u,m[9]*=u,m[10]*=u,m[11]*=u,m}getCameraToClipPerspective(r,u,m,y){const b=new Float64Array(16);return s.perspective(b,r,u,m,y),b}getDistanceToElevation(r,u=!1){const m=r===0?0:s.mercatorZfromAltitude(r,u?s.latFromMercatorY(this.position[1]):this.position[1]),y=this.forward();return(m-this.position[2])/y[2]}clone(){return new Ua([...this.position],[...this.orientation])}}function ja(f,r){const u=ea(f.projection,f.zoom,f.width,f.height),m=function(b,C,I,M,B){const O=new s.LngLat(I.lng-180*ta,I.lat),j=new s.LngLat(I.lng+180*ta,I.lat),H=b.project(O.lng,O.lat),Q=b.project(j.lng,j.lat),J=-Math.atan2(Q.y-H.y,Q.x-H.x),ee=s.MercatorCoordinate.fromLngLat(I);ee.y=s.clamp(ee.y,-.999975,.999975);const te=ee.toLngLat(),W=b.project(te.lng,te.lat),ue=s.MercatorCoordinate.fromLngLat(te);ue.x+=ta;const ae=ue.toLngLat(),pe=b.project(ae.lng,ae.lat),Ce=jl(pe.x-W.x,pe.y-W.y,J),we=s.MercatorCoordinate.fromLngLat(te);we.y+=ta;const Ae=we.toLngLat(),Be=b.project(Ae.lng,Ae.lat),$e=jl(Be.x-W.x,Be.y-W.y,J),Ge=Math.abs(Ce.x)/Math.abs($e.y),wt=s.identity([]);s.rotateZ(wt,wt,-J*(1-(B?0:M)));const Fe=s.identity([]);return s.scale(Fe,Fe,[1,1-(1-Ge)*M,1]),Fe[4]=-$e.x/$e.y*M,s.rotateZ(Fe,Fe,J),s.multiply(Fe,wt,Fe),Fe}(f.projection,0,f.center,u,r),y=gu(f);return s.scale(m,m,[y,y,1]),m}function gu(f){const r=f.projection,u=ea(f.projection,f.zoom,f.width,f.height),m=Ul(r,f.center),y=Ul(r,s.LngLat.convert(r.center));return Math.pow(2,m*u+(1-u)*y)}function ea(f,r,u,m,y=1/0){const b=f.range;if(!b)return 0;const C=Math.min(y,Math.max(u,m)),I=Math.log(C/1024)/Math.LN2;return s.smoothstep(b[0]+I,b[1]+I,r)}const ta=1/4e4;function Ul(f,r){const u=s.clamp(r.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),m=new s.LngLat(r.lng-180*ta,u),y=new s.LngLat(r.lng+180*ta,u),b=f.project(m.lng,u),C=f.project(y.lng,u),I=s.MercatorCoordinate.fromLngLat(m),M=s.MercatorCoordinate.fromLngLat(y),B=C.x-b.x,O=C.y-b.y,j=M.x-I.x,H=M.y-I.y,Q=Math.sqrt((j*j+H*H)/(B*B+O*O));return Math.log(Q)/Math.LN2}function jl(f,r,u){const m=Math.cos(u),y=Math.sin(u);return{x:f*m-r*y,y:f*y+r*m}}class Ot{constructor(r,u,m,y,b,C,I){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=r||0,this._maxZoom=u||22,this._minPitch=m==null?0:m,this._maxPitch=y==null?60:y,this.setProjection(C),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new id,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Ua,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const r=new Ot(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(r,u=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(r||m)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const m=!w(u,this.getProjection());return m&&this._calcMatrices(),this.mercatorFromTransition=!1,m}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const u=r!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.pointGeometry(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const u=-r*Math.PI/180;var m;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(m=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m),function(y,b,C){var I=b[0],M=b[1],B=b[2],O=b[3],j=Math.sin(C),H=Math.cos(C);y[0]=I*H+B*j,y[1]=M*H+O*j,y[2]=I*-j+B*H,y[3]=M*-j+O*H}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const u=s.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=s.degToRad(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const u=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const r=this._elevation;this._centerAltitude=r.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=r.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let y=0,b=0;for(let C=0;C<u.length;C++){const I=new s.pointGeometry(u[C][0]*this.width,m+u[C][1]*(this.height-m)),M=r.pointCoordinate(I);if(!M)continue;const B=1/Math.hypot(M[0]-this._camera.position[0],M[1]-this._camera.position[1]);y+=M[3]*B,b+=B}return b===0?NaN:y/b}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*u,y=this._mercatorZfromZoom(r),b=this._mercatorZfromZoom(this._maxZoom),C=Math.max(y-m,b);this._setZoom(this._zoomFromMercatorZ(C))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let m;m=r.z<this._camera.position[2]?[u.x,u.y,u.z]:[r.x,r.y,r.z];const y=s.length(s.sub([],this._camera.position,m));return s.clamp(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let u=!1;if(r.orientation&&!s.exactEquals(r.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(r.orientation)),r.position){const m=[r.position.x,r.position.y,r.position.z];s.exactEquals$1(m,this._camera.position)||(this._setCameraPosition(m),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,u=new mu;return u.position=new s.MercatorCoordinate(r[0],r[1],r[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(r){if(!s.length$1(r))return!1;s.normalize$1(r,r);const u=s.transformQuat([],[0,0,-1],r),m=s.transformQuat([],[0,-1,0],r);if(m[2]<0)return!1;const y=Cp(u,m);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(r){const u=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;r[2]=s.clamp(r[2],y/m,y/u),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,u,m){this._unmodified=!1,this._edgeInsets.interpolate(r,u,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const u=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(r){const u=[new s.UnwrappedTileID(0,r)];if(this.renderWorldCopies){const m=this.pointCoordinate(new s.pointGeometry(0,0)),y=this.pointCoordinate(new s.pointGeometry(this.width,0)),b=this.pointCoordinate(new s.pointGeometry(this.width,this.height)),C=this.pointCoordinate(new s.pointGeometry(0,this.height)),I=Math.floor(Math.min(m.x,y.x,b.x,C.x)),M=Math.floor(Math.max(m.x,y.x,b.x,C.x)),B=1;for(let O=I-B;O<=M+B;O++)O!==0&&u.push(new s.UnwrappedTileID(O,r))}return u}coveringTiles(r){let u=this.coveringZoomLevel(r);const m=u,y=this.elevation&&!r.isTerrainDEM,b=this.projection.name==="mercator";if(r.minzoom!==void 0&&u<r.minzoom)return[];r.maxzoom!==void 0&&u>r.maxzoom&&(u=r.maxzoom);const C=this.locationCoordinate(this.center),I=this.center.lat,M=1<<u,B=[M*C.x,M*C.y,0],O=this.projection.name==="globe",j=!O,H=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,j),Q=O?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),J=M*s.mercatorZfromAltitude(1,this.center.lat),ee=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),te=[M*Q.x,M*Q.y,ee*(j?1:J)],W=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),ue=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?u:0,ae=r.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,pe=r.isTerrainDEM?-ae:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ce=this.projection.isReprojectedInTileSpace?gu(this):1,we=Ue=>{const Ze=new s.MercatorCoordinate(Ue.x+25e-6,Ue.y,Ue.z),lt=new s.MercatorCoordinate(Ue.x,Ue.y+25e-6,Ue.z),mt=Ue.toLngLat(),Ht=Ze.toLngLat(),vn=lt.toLngLat(),jt=this.locationCoordinate(mt),Vt=this.locationCoordinate(Ht),Xt=this.locationCoordinate(vn),In=Math.hypot(Vt.x-jt.x,Vt.y-jt.y),en=Math.hypot(Xt.x-jt.x,Xt.y-jt.y);return Math.sqrt(In*en)*Ce/25e-6},Ae=Ue=>{const Le=ae,Ze=pe;return{aabb:s.tileAABB(this,M,0,0,0,Ue,Ze,Le,this.projection),zoom:0,x:0,y:0,minZ:Ze,maxZ:Le,wrap:Ue,fullyVisible:!1}},Be=[];let $e=[];const Ge=u,wt=r.reparseOverscaled?m:u,Fe=Ue=>Ue*Ue,rt=Fe((ee-this._centerAltitude)*J),He=Ue=>{if(!this._elevation||!Ue.tileID||!b)return;const Le=this._elevation.getMinMaxForTile(Ue.tileID),Ze=Ue.aabb;Le?(Ze.min[2]=Le.min,Ze.max[2]=Le.max,Ze.center[2]=(Ze.min[2]+Ze.max[2])/2):(Ue.shouldSplit=ht(Ue),Ue.shouldSplit||(Ze.min[2]=Ze.max[2]=Ze.center[2]=this._centerAltitude))},ht=Ue=>{if(Ue.zoom<ue)return!0;if(Ue.zoom===Ge)return!1;if(Ue.shouldSplit!=null)return Ue.shouldSplit;const Le=Ue.aabb.distanceX(te),Ze=Ue.aabb.distanceY(te);let lt=rt,mt=1;if(O){lt=Fe(Ue.aabb.distanceZ(te));const jt=Math.pow(2,Ue.zoom),Vt=s.latFromMercatorY((Ue.y+1)/jt),Xt=s.latFromMercatorY(Ue.y/jt),In=Math.min(Math.max(I,Vt),Xt),en=s.circumferenceAtLatitude(In)/s.circumferenceAtLatitude(I);if(mt=In===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,en/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&Ue.zoom===Ge-1&&en>=.9)return!0}else if(y&&(lt=Fe(Ue.aabb.distanceZ(te)*J)),this.projection.isReprojectedInTileSpace&&m<=5){const jt=Math.pow(2,Ue.zoom),Vt=we(new s.MercatorCoordinate((Ue.x+.5)/jt,(Ue.y+.5)/jt));mt=Vt>.85?1:Vt}const Ht=Le*Le+Ze*Ze+lt,vn=Fe((1<<Ge-Ue.zoom)*W*mt*((jt,Vt)=>{if(Vt*Fe(.707)<jt)return 1;const Xt=Math.sqrt(Vt/jt);return Xt/(1.4144271570014144+(Math.pow(1.1,Xt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(lt,rt),Ht));return Ht<vn};if(this.renderWorldCopies)for(let Ue=1;Ue<=3;Ue++)Be.push(Ae(-Ue)),Be.push(Ae(Ue));for(Be.push(Ae(0));Be.length>0;){const Ue=Be.pop(),Le=Ue.x,Ze=Ue.y;let lt=Ue.fullyVisible;if(!lt){const mt=Ue.aabb.intersects(H);if(mt===0)continue;lt=mt===2}if(Ue.zoom!==Ge&&ht(Ue))for(let mt=0;mt<4;mt++){const Ht=(Le<<1)+mt%2,vn=(Ze<<1)+(mt>>1),jt={aabb:b?Ue.aabb.quadrant(mt):s.tileAABB(this,M,Ue.zoom+1,Ht,vn,Ue.wrap,Ue.minZ,Ue.maxZ,this.projection),zoom:Ue.zoom+1,x:Ht,y:vn,wrap:Ue.wrap,fullyVisible:lt,tileID:void 0,shouldSplit:void 0,minZ:Ue.minZ,maxZ:Ue.maxZ};y&&!O&&(jt.tileID=new s.OverscaledTileID(Ue.zoom+1===Ge?wt:Ue.zoom+1,Ue.wrap,Ue.zoom+1,Ht,vn),He(jt)),Be.push(jt)}else{const mt=Ue.zoom===Ge?wt:Ue.zoom;if(r.minzoom&&r.minzoom>mt)continue;const Ht=B[0]-(.5+Le+(Ue.wrap<<Ue.zoom))*(1<<u-Ue.zoom),vn=B[1]-.5-Ze,jt=Ue.tileID?Ue.tileID:new s.OverscaledTileID(mt,Ue.wrap,Ue.zoom,Le,Ze);$e.push({tileID:jt,distanceSq:Ht*Ht+vn*vn})}}if(this.fogCullDistSq){const Ue=this.fogCullDistSq,Le=this.horizonLineFromTop();$e=$e.filter(Ze=>{const lt=[0,0,0,1],mt=[s.EXTENT,s.EXTENT,0,1],Ht=this.calculateFogTileMatrix(Ze.tileID.toUnwrapped());s.transformMat4$1(lt,lt,Ht),s.transformMat4$1(mt,mt,Ht);const vn=s.getAABBPointSquareDist(lt,mt);if(vn===0)return!0;let jt=!1;const Vt=this._elevation;if(Vt&&vn>Ue&&Le!==0){const Xt=this.calculateProjMatrix(Ze.tileID.toUnwrapped());let In;r.isTerrainDEM||(In=Vt.getMinMaxForTile(Ze.tileID)),In||(In={min:pe,max:ae});const en=s.furthestTileCorner(this.rotation),Wn=[en[0]*s.EXTENT,en[1]*s.EXTENT,In.max];s.transformMat4(Wn,Wn,Xt),jt=(1-Wn[1])*this.height*.5<Le}return vn<Ue||jt})}return $e.sort((Ue,Le)=>Ue.distanceSq-Le.distanceSq).map(Ue=>Ue.tileID)}resize(r,u){this.width=r,this.height=u,this.pixelsToGLUnits=[2/r,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const u=s.clamp(r.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),m=this.projection.project(r.lng,u);return new s.pointGeometry(m.x*this.worldSize,m.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,u){let m,y;const b=this.centerPoint;if(this.projection.name==="globe"){const I=this.worldSize;m=(u.x-b.x)/I,y=(u.y-b.y)/I}else{const I=this.pointCoordinate(u),M=this.pointCoordinate(b);m=I.x-M.x,y=I.y-M.y}const C=this.locationCoordinate(r);this.setLocation(new s.MercatorCoordinate(C.x-m,C.y-y))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,u){const m=u?s.mercatorZfromAltitude(u,r.lat):void 0,y=this.projection.project(r.lng,r.lat);return new s.MercatorCoordinate(y.x,y.y,m)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,u){const m=u!=null?u:this._centerAltitude,y=[r.x,r.y,0,1],b=[r.x,r.y,1,1];s.transformMat4$1(y,y,this.pixelMatrixInverse),s.transformMat4$1(b,b,this.pixelMatrixInverse);const C=b[3];s.scale$1(y,y,1/y[3]),s.scale$1(b,b,1/C);const I=y[2],M=b[2];return{p0:y,p1:b,t:I===M?0:(m-I)/(M-I)}}screenPointToMercatorRay(r){const u=[r.x,r.y,0,1],m=[r.x,r.y,1,1];return s.transformMat4$1(u,u,this.pixelMatrixInverse),s.transformMat4$1(m,m,this.pixelMatrixInverse),s.scale$1(u,u,1/u[3]),s.scale$1(m,m,1/m[3]),u[2]=s.mercatorZfromAltitude(u[2],this._center.lat)*this.worldSize,m[2]=s.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,s.scale$1(u,u,1/this.worldSize),s.scale$1(m,m,1/this.worldSize),new s.Ray([u[0],u[1],u[2]],s.normalize([],s.sub([],m,u)))}rayIntersectionCoordinate(r){const{p0:u,p1:m,t:y}=r,b=s.mercatorZfromAltitude(u[2],this._center.lat),C=s.mercatorZfromAltitude(m[2],this._center.lat);return new s.MercatorCoordinate(s.number(u[0],m[0],y)/this.worldSize,s.number(u[1],m[1],y)/this.worldSize,s.number(b,C,y))}pointCoordinate(r,u=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,u)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let u=this.projection.pointCoordinate3D(this,r.x,r.y);if(u)return new s.MercatorCoordinate(u[0],u[1],u[2]);let m=0,y=this.horizonLineFromTop();if(r.y>y)return this.pointCoordinate(r);const b=.02*y,C=r.clone();for(let I=0;I<10&&y-m>b;I++){C.y=s.number(m,y,.66);const M=this.projection.pointCoordinate3D(this,C.x,C.y);M?(y=C.y,u=M):m=C.y}return u?new s.MercatorCoordinate(u[0],u[1],u[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}_coordinatePoint(r,u){const m=u&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,y=[r.x*this.worldSize,r.y*this.worldSize,m+r.toAltitude(),1];return s.transformMat4$1(y,y,this.pixelMatrix),y[3]>0?new s.pointGeometry(y[0]/y[3],y[1]/y[3]):new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:u}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,y=this.width-this._edgeInsets.right,b=this.pointLocation3D(new s.pointGeometry(u,r)),C=this.pointLocation3D(new s.pointGeometry(y,r)),I=this.pointLocation3D(new s.pointGeometry(y,m)),M=this.pointLocation3D(new s.pointGeometry(u,m));let B=Math.min(b.lng,C.lng,I.lng,M.lng),O=Math.max(b.lng,C.lng,I.lng,M.lng),j=Math.min(b.lat,C.lat,I.lat,M.lat),H=Math.max(b.lat,C.lat,I.lat,M.lat);const Q=Math.pow(2,-this.zoom)/16*270,J=this.projection.name==="globe"?1:4,ee=(te,W,ue,ae,pe)=>{const Ce=(te+ue)/2,we=(W+ae)/2,Ae=new s.pointGeometry(Ce,we),{lng:Be,lat:$e}=this.pointLocation3D(Ae),Ge=Math.max(0,B-Be,j-$e,Be-O,$e-H);B=Math.min(B,Be),O=Math.max(O,Be),j=Math.min(j,$e),H=Math.max(H,$e),(pe<J||Ge>Q)&&(ee(te,W,Ce,we,pe+1),ee(Ce,we,ue,ae,pe+1))};if(ee(u,r,y,r,1),ee(y,r,y,m,1),ee(y,m,u,m,1),ee(u,m,u,r,1),this.projection.name==="globe"){const[te,W]=s.polesInViewport(this);te?(H=90,O=180,B=-180):W&&(j=-90,O=180,B=-180)}return new s.LngLatBounds(new s.LngLat(B,j),new s.LngLat(O,H))}_getBoundsRectangular(r,u){const{top:m,left:y}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,I=new s.pointGeometry(y,m),M=new s.pointGeometry(C,m),B=new s.pointGeometry(C,b),O=new s.pointGeometry(y,b);let j=this.pointCoordinate(I,r),H=this.pointCoordinate(M,r);const Q=this.pointCoordinate(B,u),J=this.pointCoordinate(O,u),ee=(te,W)=>(W.y-te.y)/(W.x-te.x);return j.y>1&&H.y>=0?j=new s.MercatorCoordinate((1-J.y)/ee(J,j)+J.x,1):j.y<0&&H.y<=1&&(j=new s.MercatorCoordinate(-J.y/ee(J,j)+J.x,0)),H.y>1&&j.y>=0?H=new s.MercatorCoordinate((1-Q.y)/ee(Q,H)+Q.x,1):H.y<0&&j.y<=1&&(H=new s.MercatorCoordinate(-Q.y/ee(Q,H)+Q.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(j)).extend(this.coordinateLocation(H)).extend(this.coordinateLocation(J)).extend(this.coordinateLocation(Q))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=r.visibleDemTiles.reduce((m,y)=>{if(y.dem){const b=y.dem.tree;m.min=Math.min(m.min,b.minimums[0]),m.max=Math.max(m.max,b.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*r.exaggeration(),u.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,m=this.height/2-u*(1-this._horizonShift);return r?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,u){return this.projection.createTileMatrix(this,u,r)}calculateDistanceTileData(r){const u=r.key,m=this._distanceTileDataCache;if(m[u])return m[u];const y=r.canonical,b=1/this.height,C=this.cameraWorldSize,I=C/this.zoomScale(y.z),M=(y.x+Math.pow(2,y.z)*r.wrap)*I,B=y.y*I,O=this.point;O.x*=C/this.worldSize,O.y*=C/this.worldSize;const j=this.angle,H=Math.sin(-j),Q=-Math.cos(-j);return m[u]={bearing:[H,Q],center:[(O.x-M)*b,(O.y-B)*b],scale:I/s.EXTENT*b},m[u]}calculateFogTileMatrix(r){const u=r.key,m=this._fogTileMatrixCache;if(m[u])return m[u];const y=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return s.multiply(y,this.worldToFogMatrix,y),m[u]=new Float32Array(y),m[u]}calculateProjMatrix(r,u=!1){const m=r.key,y=u?this._alignedProjMatrixCache:this._projMatrixCache;if(y[m])return y[m];const b=this.calculatePosMatrix(r,this.worldSize);return s.multiply(b,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:u?this.alignedProjMatrix:this.projMatrix,b),y[m]=new Float32Array(b),y[m]}calculatePixelsToTileUnitsMatrix(r){const u=r.tileID.key,m=this._pixelsToTileUnitsCache;if(m[u])return m[u];const y=function(b,C){const{scale:I}=b.tileTransform,M=I*s.EXTENT/(b.tileSize*Math.pow(2,C.zoom-b.tileID.overscaledZ+b.tileID.canonical.z));return B=new Float32Array(4),H=(O=C.inverseAdjustmentMatrix)[1],Q=O[2],J=O[3],te=(j=[M,M])[1],B[0]=O[0]*(ee=j[0]),B[1]=H*ee,B[2]=Q*te,B[3]=J*te,B;var B,O,j,H,Q,J,ee,te}(r,this);return m[u]=y,m[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,u=s.fromScaling([],[r,r,r]);return s.multiply(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const u=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(u),y=this._camera.forward(),b=s.mercatorZfromAltitude(1,this._center.lat);m[2]/=b,y[2]/=b,s.normalize(y,y);const C=r.raycast(m,y,r.exaggeration());if(C){const I=s.scaleAndAdd([],m,y,C),M=new s.MercatorCoordinate(I[0],I[1],s.mercatorZfromAltitude(I[2],s.latFromMercatorY(I[1]))),B=(M.z+s.length([M.x-m[0],M.y-m[1],M.z-m[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(B),this._centerAltitude=M.toAltitude(),this._center=this.coordinateLocation(M),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const u=this._elevation,m=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(m),b=u.getAtPointOrZero(new s.MercatorCoordinate(...y)),C=this.pixelsPerMeter/this.worldSize*b,I=this._minimumHeightOverTerrain(),M=y[2]-C;if(M<=I)if(M<0||r){const B=this.locationCoordinate(this._center,this._centerAltitude),O=[y[0],y[1],B.z-y[2]],j=s.length(O);O[2]-=(I-M)/this._pixelsPerMercatorPixel;const H=s.length(O);if(H===0)return;s.scale$2(O,O,j/H*this._pixelsPerMercatorPixel),this._camera.position=[y[0],y[1],B.z*this._pixelsPerMercatorPixel-O[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const H=this.center;return H.lat=s.clamp(H.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(H.lng=s.clamp(H.lng,this.minLng,this.maxLng)),this.center=H,void(this._constraining=!1)}const u=this._unmodified,{x:m,y}=this.point;let b=0,C=m,I=y;const M=this.width/2,B=this.height/2,O=this.worldMinY*this.scale,j=this.worldMaxY*this.scale;if(y-B<O&&(I=O+B),y+B>j&&(I=j-B),j-O<this.height&&(b=Math.max(b,this.height/(j-O)),I=(j+O)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const H=this.worldMinX*this.scale,Q=this.worldMaxX*this.scale,J=this.worldSize/2-(H+Q)/2;C=(m+J+this.worldSize)%this.worldSize-J,C-M<H&&(C=H+M),C+M>Q&&(C=Q-M),Q-H<this.width&&(b=Math.max(b,this.width/(Q-H)),C=(Q+H)/2)}C===m&&I===y||(this.center=this.unproject(new s.pointGeometry(C,I))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,u=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const m=ea(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,m),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const y=this.projection.zAxisUnit==="meters"?u:1,b=this._camera.getWorldToCamera(this.worldSize,y),C=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);C[8]=2*-r.x/this.width,C[9]=2*r.y/this.height;let I=s.mul([],C,b);if(this.projection.isReprojectedInTileSpace){const we=this.locationCoordinate(this.center),Ae=s.identity([]);s.translate(Ae,Ae,[we.x*this.worldSize,we.y*this.worldSize,0]),s.multiply(Ae,Ae,ja(this)),s.translate(Ae,Ae,[-we.x*this.worldSize,-we.y*this.worldSize,0]),s.multiply(I,I,Ae),this.inverseAdjustmentMatrix=function(Be){const $e=ja(Be,!0);return Se([],[$e[0],$e[1],$e[4],$e[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],I,[this.worldSize,this.worldSize,this.worldSize/y,1]),this.projMatrix=I,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const M=s.invert([],C);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(M,this.horizonLineFromTop(),this.height);const B=new Float32Array(16);s.identity(B),s.scale(B,B,[1,-1,1]),s.rotateX(B,B,this._pitch),s.rotateZ(B,B,this.angle);const O=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),j=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;O[8]=2*-r.x/this.width,O[9]=2*(r.y+j)/this.height,this.skyboxMatrix=s.multiply(B,O,B);const H=this.point,Q=H.x,J=H.y,ee=this.width%2/2,te=this.height%2/2,W=Math.cos(this.angle),ue=Math.sin(this.angle),ae=Q-Math.round(Q)+W*ee+ue*te,pe=J-Math.round(J)+W*te+ue*ee,Ce=new Float64Array(I);if(s.translate(Ce,Ce,[ae>.5?ae-1:ae,pe>.5?pe-1:pe,0]),this.alignedProjMatrix=Ce,I=s.create(),s.scale(I,I,[this.width/2,-this.height/2,1]),s.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=s.create(),s.scale(I,I,[1,-1,1]),s.translate(I,I,[-1,-1,0]),s.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=s.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=I,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const we=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(we,we,b),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=I;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,m=this._camera.position,y=1/this.height/this._pixelsPerMercatorPixel,b=[r,r,u];s.scale$2(b,b,y),s.scale$2(m,m,-1),s.multiply$2(m,m,b);const C=s.create();s.translate(C,C,m),s.scale(C,C,b),this.mercatorFogMatrix=C,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,u,y)}_computeCameraPosition(r){const u=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),y=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-r/this.worldSize*this._centerAltitude;return[y.x/this.worldSize-m[0]*b,y.y/this.worldSize-m[1]*b,r/this.worldSize*this._centerAltitude-m[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],y=r[2];let b=1;this.projection.wrap&&(this.center=this.center.wrap()),y>0&&(b=Math.min((u-m)/y,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,r,b),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,u=this._camera.forward(),{pitch:m,bearing:y}=this._camera.getPitchBearing(),b=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,C=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),I=Math.max((r[2]-b)/Math.cos(m),C),M=this._zoomFromMercatorZ(I);s.scaleAndAdd(r,r,u,I),this._pitch=s.clamp(m,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(y,-Math.PI,Math.PI),this._setZoom(s.clamp(M,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let u=0,m=s.GLOBE_ZOOM_THRESHOLD_MAX,y=0,b=1/0;for(;m-u>1e-6&&m>u;){const C=u+.5*(m-u),I=this.tileSize*Math.pow(2,C),M=this.getCameraToCenterDistance(this.projection,C,I),B=this.scaleZoom(M/(r*this.tileSize)),O=Math.abs(C-B);O<b&&(b=O,y=C),C<B?u=C:m=C}return y}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,u){const m=Math.min(r.x,u.x),y=Math.max(r.x,u.x),b=Math.min(r.y,u.y),C=Math.max(r.y,u.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const I=[new s.pointGeometry(m,b),new s.pointGeometry(y,C),new s.pointGeometry(m,C),new s.pointGeometry(y,b)],M=this.renderWorldCopies?-3:0,B=this.renderWorldCopies?4:1;for(const O of I){const j=this.pointRayIntersection(O);if(j.t<0)return!0;const H=this.rayIntersectionCoordinate(j);if(H.x<M||H.y<0||H.x>B||H.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.pointGeometry(0,0),new s.pointGeometry(this.width,this.height))}zoomDeltaToMovement(r,u){const m=s.length(s.sub([],this._camera.position,r)),y=this._zoomFromMercatorZ(m)+u;return m-this._mercatorZfromZoom(y)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([u,m,y],b){const C=[u,m,y,1];s.transformMat4$1(C,C,b);const I=C[3]=Math.max(C[3],1e-6);return C[0]/=I,C[1]/=I,C[2]/=I,C}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.pointGeometry(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.pointGeometry(0,r))}}getCameraToCenterDistance(r,u=this.zoom,m=this.worldSize){const y=ea(r,u,this.width,this.height,1024),b=r.pixelSpaceConversion(this.center.lat,m,y);return .5/Math.tan(.5*this._fov)*this.height*b}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(r,r,this.globeMatrix),r}}function Kr(f,r){let u=!1,m=null;const y=()=>{m=null,u&&(f(),m=setTimeout(y,r),u=!1)};return()=>(u=!0,m||y(),m)}class Ip{constructor(r){this._hashName=r&&encodeURIComponent(r),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Kr(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,s.window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const u=rd(r);if(this._hashName){const m=this._hashName;let y=!1;const b=s.window.location.hash.slice(1).split("&").map(C=>{const I=C.split("=")[0];return I===m?(y=!0,`${I}=${u}`):C}).filter(C=>C);return y||b.push(`${m}=${u}`),`#${b.join("&")}`}return`#${u}`}_getCurrentHash(){const r=s.window.location.hash.replace("#","");if(this._hashName){let u;return r.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(u=m)}),(u&&u[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(m=>isNaN(m))){const m=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(u[3]||0):r.getBearing();return r.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:m,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,r)}}function rd(f,r){const u=f.getCenter(),m=Math.round(100*f.getZoom())/100,y=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,y),C=Math.round(u.lng*b)/b,I=Math.round(u.lat*b)/b,M=f.getBearing(),B=f.getPitch();let O=r?`/${C}/${I}/${m}`:`${m}/${I}/${C}`;return(M||B)&&(O+="/"+Math.round(10*M)/10),B&&(O+=`/${Math.round(B)}`),O}const Gl={linearity:.3,easing:s.bezier(0,0,.3,1)},Ga=s.extend({deceleration:2500,maxSpeed:1400},Gl),Ap=s.extend({deceleration:20,maxSpeed:1400},Gl),vu=s.extend({deceleration:1e3,maxSpeed:360},Gl),od=s.extend({deceleration:1e3,maxSpeed:90},Gl);class _u{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,u=s.exported.now();for(;r.length>0&&u-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new s.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)u.zoom+=b.zoomDelta||0,u.bearing+=b.bearingDelta||0,u.pitch+=b.pitchDelta||0,b.panDelta&&u.pan._add(b.panDelta),b.around&&(u.around=b.around),b.pinchAround&&(u.pinchAround=b.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(u.pan.mag()){const b=Zl(u.pan.mag(),m,s.extend({},Ga,r||{}));y.offset=u.pan.mult(b.amount/u.pan.mag()),y.center=this._map.transform.center,ql(y,b)}if(u.zoom){const b=Zl(u.zoom,m,Ap);y.zoom=this._map.transform.zoom+b.amount,ql(y,b)}if(u.bearing){const b=Zl(u.bearing,m,vu);y.bearing=this._map.transform.bearing+s.clamp(b.amount,-179,179),ql(y,b)}if(u.pitch){const b=Zl(u.pitch,m,od);y.pitch=this._map.transform.pitch+b.amount,ql(y,b)}if(y.zoom||y.bearing){const b=u.pinchAround===void 0?u.around:u.pinchAround;y.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),y.noMoveStart=!0,y}}function ql(f,r){(!f.duration||f.duration<r.duration)&&(f.duration=r.duration,f.easing=r.easing)}function Zl(f,r,u){const{maxSpeed:m,linearity:y,deceleration:b}=u,C=s.clamp(f*y/(r/1e3),-m,m),I=Math.abs(C)/(b*y);return{easing:u.easing,duration:1e3*I,amount:C*(I/2)}}class or extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,m,y={}){const b=Y(u.getCanvasContainer(),m),C=u.unproject(b);super(r,s.extend({point:b,lngLat:C,originalEvent:m},y)),this._defaultPrevented=!1,this.target=u}}class yu extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,m){const y=r==="touchend"?m.changedTouches:m.touches,b=_e(u.getCanvasContainer(),y),C=b.map(M=>u.unproject(M)),I=b.reduce((M,B,O,j)=>M.add(B.div(j.length)),new s.pointGeometry(0,0));super(r,{points:b,point:I,lngLats:C,lngLat:u.unproject(I),originalEvent:m}),this._defaultPrevented=!1}}class uv extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,m){super(r,{originalEvent:m}),this._defaultPrevented=!1}}class kp{constructor(r,u){this._map=r,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new uv(r.type,this._map,r))}mousedown(r,u){return this._mousedownPos=u,this._firePreventable(new or(r.type,this._map,r))}mouseup(r){this._map.fire(new or(r.type,this._map,r))}preclick(r){const u=s.extend({},r);u.type="preclick",this._map.fire(new or(u.type,this._map,u))}click(r,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(r),this._map.fire(new or(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new or(r.type,this._map,r))}mouseover(r){this._map.fire(new or(r.type,this._map,r))}mouseout(r){this._map.fire(new or(r.type,this._map,r))}touchstart(r){return this._firePreventable(new yu(r.type,this._map,r))}touchmove(r){this._map.fire(new yu(r.type,this._map,r))}touchend(r){this._map.fire(new yu(r.type,this._map,r))}touchcancel(r){this._map.fire(new yu(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class xu{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new or(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new or("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new or(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sd{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,u){this.isEnabled()&&r.shiftKey&&r.button===0&&(ne(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(r,u){if(!this._active)return;const m=u,y=this._startPos,b=this._lastPos;if(!y||!b||b.equals(m)||!this._box&&m.dist(y)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=L("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const C=Math.min(y.x,m.x),I=Math.max(y.x,m.x),M=Math.min(y.y,m.y),B=Math.max(y.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${C}px,${M}px)`,this._box.style.width=I-C+"px",this._box.style.height=B-M+"px")})}mouseupWindow(r,u){if(!this._active)return;const m=this._startPos,y=u;if(m&&r.button===0){if(this.reset(),Ee(),m.x!==y.x||m.y!==y.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:b=>b.fitScreenCoordinates(m,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ce(),delete this._startPos,delete this._lastPos}_fireEvent(r,u){return this._map.fire(new s.Event(r,{originalEvent:u}))}}function bu(f,r){const u={};for(let m=0;m<f.length;m++)u[f[m].identifier]=r[m];return u}class Mp{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,u,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),m.length===this.numTouches&&(this.centroid=function(y){const b=new s.pointGeometry(0,0);for(const C of y)b._add(C);return b.div(y.length)}(u),this.touches=bu(m,u)))}touchmove(r,u,m){if(this.aborted||!this.centroid)return;const y=bu(m,u);for(const b in this.touches){const C=this.touches[b],I=y[b];(!I||I.dist(C)>30)&&(this.aborted=!0)}}touchend(r,u,m){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class qa{constructor(r){this.singleTap=new Mp(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,u,m){this.singleTap.touchstart(r,u,m)}touchmove(r,u,m){this.singleTap.touchmove(r,u,m)}touchend(r,u,m){const y=this.singleTap.touchend(r,u,m);if(y){const b=r.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(y)<30;if(b&&C||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class ad{constructor(){this._zoomIn=new qa({numTouches:1,numTaps:2}),this._zoomOut=new qa({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,u,m){this._zoomIn.touchstart(r,u,m),this._zoomOut.touchstart(r,u,m)}touchmove(r,u,m){this._zoomIn.touchmove(r,u,m),this._zoomOut.touchmove(r,u,m)}touchend(r,u,m){const y=this._zoomIn.touchend(r,u,m),b=this._zoomOut.touchend(r,u,m);return y?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()+1,around:C.unproject(y)},{originalEvent:r})}):b?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()-1,around:C.unproject(b)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Pp={0:1,2:2};class wu{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,u){return!1}_move(r,u){return{}}mousedown(r,u){if(this._lastPoint)return;const m=fe(r);this._correctButton(r,m)&&(this._lastPoint=u,this._eventButton=m)}mousemoveWindow(r,u){const m=this._lastPoint;if(m){if(r.preventDefault(),this._eventButton!=null&&function(y,b){const C=Pp[b];return y.buttons===void 0||(y.buttons&C)!==C}(r,this._eventButton))this.reset();else if(this._moved||!(u.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(m,u)}}mouseupWindow(r){this._lastPoint&&fe(r)===this._eventButton&&(this._moved&&Ee(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zp extends wu{mousedown(r,u){super.mousedown(r,u),this._lastPoint&&(this._active=!0)}_correctButton(r,u){return u===0&&!r.ctrlKey}_move(r,u){return{around:u,panDelta:u.sub(r)}}}class ld extends wu{_correctButton(r,u){return u===0&&r.ctrlKey||u===2}_move(r,u){const m=.8*(u.x-r.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(r){r.preventDefault()}}class cd extends wu{_correctButton(r,u){return u===0&&r.ctrlKey||u===2}_move(r,u){const m=-.5*(u.y-r.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(r){r.preventDefault()}}class Za{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.pointGeometry(0,0)}touchstart(r,u,m){return this._calculateTransform(r,u,m)}touchmove(r,u,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,u,m)}}touchend(r,u,m){this._calculateTransform(r,u,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,u,m){m.length>0&&(this._active=!0);const y=bu(m,u),b=new s.pointGeometry(0,0),C=new s.pointGeometry(0,0);let I=0;for(const B in y){const O=y[B],j=this._touches[B];j&&(b._add(O),C._add(O.sub(j)),I++,y[B]=O)}if(this._touches=y,I<this._minTouches||!C.mag())return;const M=C.div(I);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(I),panDelta:M}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Eu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,u,m){return{}}touchstart(r,u,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([u[0],u[1]]))}touchmove(r,u,m){const y=this._firstTwoTouches;if(!y)return;r.preventDefault();const[b,C]=y,I=Wl(m,u,b),M=Wl(m,u,C);if(!I||!M)return;const B=this._aroundCenter?null:I.add(M).div(2);return this._move([I,M],B,r)}touchend(r,u,m){if(!this._firstTwoTouches)return;const[y,b]=this._firstTwoTouches,C=Wl(m,u,y),I=Wl(m,u,b);C&&I||(this._active&&Ee(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Wl(f,r,u){for(let m=0;m<f.length;m++)if(f[m].identifier===u)return r[m]}function Lp(f,r){return Math.log(f/r)/Math.LN2}class Dp extends Eu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,u){const m=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Lp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Lp(this._distance,m),pinchAround:u}}}function ud(f,r){return 180*f.angleWith(r)/Math.PI}class Rp extends Eu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,u){const m=this._vector;if(this._vector=r[0].sub(r[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:ud(this._vector,m),pinchAround:u}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const u=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const y=ud(r,m);return Math.abs(y)<u}}function Su(f){return Math.abs(f.y)>Math.abs(f.x)}class _r extends Eu{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,Su(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,u,m){const y=this._lastPoints;if(!y)return;const b=r[0].sub(y[0]),C=r[1].sub(y[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(b,C,m.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(b.y+C.y)/2*-.5})}gestureBeginsVertically(r,u,m){if(this._valid!==void 0)return this._valid;const y=r.mag()>=2,b=u.mag()>=2;if(!y&&!b)return;if(!y||!b)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const C=r.y>0==u.y>0;return Su(r)&&Su(u)&&C}}const hv={panStep:100,bearingStep:15,pitchStep:10};class Bp{constructor(){const r=hv;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let u=0,m=0,y=0,b=0,C=0;switch(r.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:r.shiftKey?m=-1:(r.preventDefault(),b=-1);break;case 39:r.shiftKey?m=1:(r.preventDefault(),b=1);break;case 38:r.shiftKey?y=1:(r.preventDefault(),C=-1);break;case 40:r.shiftKey?y=-1:(r.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(m=0,y=0),{cameraAnimation:I=>{const M=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:dv,zoom:u?Math.round(M)+u*(r.shiftKey?2:1):M,bearing:I.getBearing()+m*this._bearingStep,pitch:I.getPitch()+y*this._pitchStep,offset:[-b*this._panStep,-C*this._panStep],center:I.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function dv(f){return f*(2-f)}const Op=4.000244140625;class Zo{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=r.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const m=s.exported.now(),y=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,u!==0&&u%Op==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(y*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),r.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=r,this._delta-=u,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=Y(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const M=this._type==="wheel"&&Math.abs(this._delta)>Op?this._wheelZoomRate:this._defaultZoomRate;let B=2/(1+Math.exp(-Math.abs(this._delta*M)));this._delta<0&&B!==0&&(B=1/B);const O=u(),j=Math.pow(2,O),H=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):j;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(H*B))),this._type==="wheel"&&(this._startZoom=O,this._easing=this._smoothOutEasing(200)),this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:u(),y=this._startZoom,b=this._easing;let C,I=!1;if(this._type==="wheel"&&y&&b){const M=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),B=b(M);C=s.number(y,m,B),M<1?this._frameId||(this._frameId=!0):I=!0}else C=m,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:C-u(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let u=s.ease;if(this._prevEase){const m=this._prevEase,y=(s.exported.now()-m.start)/m.duration,b=m.easing(y+.01)-m.easing(y),C=.27/Math.sqrt(b*b+1e-4)*.01,I=Math.sqrt(.0729-C*C);u=s.bezier(C,I,.25,1)}return this._prevEase={start:s.exported.now(),duration:r,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Fp{constructor(r,u){this._clickZoom=r,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Wa{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,u){return r.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(r.shiftKey?-1:1),around:m.unproject(u)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Eo{constructor(){this._tap=new qa({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,u,m){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=u[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(r,u,m))}touchmove(r,u,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const y=u[0],b=y.y-this._swipePoint.y;return this._swipePoint=y,r.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(r,u,m)}touchend(r,u,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(r,u,m)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Tu{constructor(r,u,m){this._el=r,this._mousePan=u,this._touchPan=m}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class $t{constructor(r,u,m){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=u,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Vp{constructor(r,u,m,y){this._el=r,this._touchZoom=u,this._touchRotate=m,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Hl=f=>f.zoom||f.drag||f.pitch||f.rotate;class Xl extends s.Event{}class Yl{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,u){const m=s.sub([],u,r);this.radius=s.length(m[2]<0?s.div([],m,this.constants):[m[0],m[1],0])}projectRay(r){s.div(r,r,this.constants),s.normalize(r,r),s.mul$1(r,r,this.constants);const u=s.scale$2([],r,this.radius);if(u[2]>0){const m=s.scale$2([],[0,0,1],s.dot(u,[0,0,1])),y=s.scale$2([],s.normalize([],[u[0],u[1],0]),this.radius),b=s.add([],u,s.scale$2([],s.sub([],s.add([],y,m),u),2));u[0]=b[0],u[1]=b[1]}return u}}function Kl(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class Np{constructor(r,u){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _u(r),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Yl,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),s.bindAll(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[y,b,C]of this._listeners)y.addEventListener(b,y===s.window.document?this.handleWindowEvent:this.handleEvent,C)}destroy(){for(const[r,u,m]of this._listeners)r.removeEventListener(u,r===s.window.document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(r){const u=this._map,m=u.getCanvasContainer();this._add("mapEvent",new kp(u,r));const y=u.boxZoom=new sd(u,r);this._add("boxZoom",y);const b=new ad,C=new Wa;u.doubleClickZoom=new Fp(C,b),this._add("tapZoom",b),this._add("clickZoom",C);const I=new Eo;this._add("tapDragZoom",I);const M=u.touchPitch=new _r(u);this._add("touchPitch",M);const B=new ld(r),O=new cd(r);u.dragRotate=new $t(r,B,O),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);const j=new zp(r),H=new Za(u,r);u.dragPan=new Tu(m,j,H),this._add("mousePan",j),this._add("touchPan",H,["touchZoom","touchRotate"]);const Q=new Rp,J=new Dp;u.touchZoomRotate=new Vp(m,J,Q,I),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",J,["touchPan","touchRotate"]),this._add("blockableMapEvent",new xu(u));const ee=u.scrollZoom=new Zo(u,this);this._add("scrollZoom",ee,["mousePan"]);const te=u.keyboard=new Bp;this._add("keyboard",te);for(const W of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[W]&&u[W].enable(r[W])}_add(r,u,m){this._handlers.push({handlerName:r,handler:u,allowed:m}),this._handlersById[r]=u}stop(r){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Hl(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,u,m){for(const y in r)if(y!==m&&(!u||u.indexOf(y)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const u=[];for(const m of r)this._el.contains(m.target)&&u.push(m);return u}handleEvent(r,u){this._updatingCamera=!0;const m=r.type==="renderFrame",y=m?void 0:r,b={needsRenderFrame:!1},C={},I={},M=r.touches?this._getMapTouches(r.touches):void 0,B=M?_e(this._el,M):m?void 0:Y(this._el,r);for(const{handlerName:H,handler:Q,allowed:J}of this._handlers){if(!Q.isEnabled())continue;let ee;this._blockedByActive(I,J,H)?Q.reset():Q[u||r.type]&&(ee=Q[u||r.type](r,B,M),this.mergeHandlerResult(b,C,ee,H,y),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()),(ee||Q.isActive())&&(I[H]=Q)}const O={};for(const H in this._previousActiveHandlers)I[H]||(O[H]=y);this._previousActiveHandlers=I,(Object.keys(O).length||Kl(b))&&(this._changes.push([b,C,O]),this._triggerRenderFrame()),(Object.keys(I).length||Kl(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:j}=b;j&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],j(this._map))}mergeHandlerResult(r,u,m,y,b){if(!m)return;s.extend(r,m);const C={handlerName:y,originalEvent:m.originalEvent||b};m.zoomDelta!==void 0&&(u.zoom=C),m.panDelta!==void 0&&(u.drag=C),m.pitchDelta!==void 0&&(u.pitch=C),m.bearingDelta!==void 0&&(u.rotate=C)}_applyChanges(){const r={},u={},m={};for(const[y,b,C]of this._changes)y.panDelta&&(r.panDelta=(r.panDelta||new s.pointGeometry(0,0))._add(y.panDelta)),y.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(r.around=y.around),y.aroundCoord!==void 0&&(r.aroundCoord=y.aroundCoord),y.pinchAround!==void 0&&(r.pinchAround=y.pinchAround),y.noInertia&&(r.noInertia=y.noInertia),s.extend(u,b),s.extend(m,C);this._updateMapTransform(r,u,m),this._changes=[]}_updateMapTransform(r,u,m){const y=this._map,b=y.transform,C=ue=>[ue.x,ue.y,ue.z];if((ue=>{const ae=this._eventsInProgress.drag;return ae&&!this._handlersById[ae.handlerName].isActive()})()&&!Kl(r)){const ue=b.zoom;b.cameraElevationReference="sea",b.recenterOnTerrain(),b.cameraElevationReference="ground",ue!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&y._stop(!0),!Kl(r))return void this._fireEvents(u,m,!0);let{panDelta:I,zoomDelta:M,bearingDelta:B,pitchDelta:O,around:j,aroundCoord:H,pinchAround:Q}=r;b._isCameraConstrained&&(M>0&&(M=0),b._isCameraConstrained=!1),Q!==void 0&&(j=Q),(M||(ue=>u.drag&&!this._eventsInProgress.drag)())&&j&&(this._dragOrigin=C(b.pointCoordinate3D(j)),this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",y._stop(!0),j=j||y.transform.centerPoint,B&&(b.bearing+=B),O&&(b.pitch+=O),b._updateCameraState();const J=[0,0,0];if(I)if(b.projection.name==="mercator"){const ue=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(j).dir),ae=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(j.sub(I)).dir);J[0]=ae[0]-ue[0],J[1]=ae[1]-ue[1]}else{const ue=b.pointCoordinate(j);if(b.projection.name==="globe"){I=I.rotate(-b.angle);const ae=b._pixelsPerMercatorPixel/b.worldSize;J[0]=-I.x*s.mercatorScale(s.latFromMercatorY(ue.y))*ae,J[1]=-I.y*s.mercatorScale(b.center.lat)*ae}else{const ae=b.pointCoordinate(j.sub(I));ue&&ae&&(J[0]=ae.x-ue.x,J[1]=ae.y-ue.y)}}const ee=b.zoom,te=[0,0,0];if(M){const ue=C(H||b.pointCoordinate3D(j)),ae={dir:s.normalize([],s.sub([],ue,b._camera.position))};if(ae.dir[2]<0){const pe=b.zoomDeltaToMovement(ue,M);s.scale$2(te,ae.dir,pe)}}const W=s.add(J,J,te);b._translateCameraConstrained(W),M&&Math.abs(b.zoom-ee)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(u,m,!0)}_fireEvents(r,u,m){const y=Hl(this._eventsInProgress),b=Hl(r),C={};for(const O in r){const{originalEvent:j}=r[O];this._eventsInProgress[O]||(C[`${O}start`]=j),this._eventsInProgress[O]=r[O]}!y&&b&&this._fireEvent("movestart",b.originalEvent);for(const O in C)this._fireEvent(O,C[O]);b&&this._fireEvent("move",b.originalEvent);for(const O in r){const{originalEvent:j}=r[O];this._fireEvent(O,j)}const I={};let M;for(const O in this._eventsInProgress){const{handlerName:j,originalEvent:H}=this._eventsInProgress[O];this._handlersById[j].isActive()||(delete this._eventsInProgress[O],M=u[j]||H,I[`${O}end`]=M)}for(const O in I)this._fireEvent(O,I[O]);const B=Hl(this._eventsInProgress);if(m&&(y||b)&&!B){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;O?(j(O.bearing||this._map.getBearing())&&(O.bearing=0),this._map.easeTo(O,{originalEvent:M})):(this._map.fire(new s.Event("moveend",{originalEvent:M})),j(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,u){this._map.fire(new s.Event(r,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new Xl("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const hd="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class $p extends s.Evented{constructor(r,u){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=u.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,u){return this.jumpTo({center:r},u)}panBy(r,u,m){return r=s.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,s.extend({offset:r},u),m)}panTo(r,u,m){return this.easeTo(s.extend({center:r},u),m)}getZoom(){return this.transform.zoom}setZoom(r,u){return this.jumpTo({zoom:r},u),this}zoomTo(r,u,m){return this.easeTo(s.extend({zoom:r},u),m)}zoomIn(r,u){return this.zoomTo(this.getZoom()+1,r,u),this}zoomOut(r,u){return this.zoomTo(this.getZoom()-1,r,u),this}getBearing(){return this.transform.bearing}setBearing(r,u){return this.jumpTo({bearing:r},u),this}getPadding(){return this.transform.padding}setPadding(r,u){return this.jumpTo({padding:r},u),this}rotateTo(r,u,m){return this.easeTo(s.extend({bearing:r},u),m)}resetNorth(r,u){return this.rotateTo(0,s.extend({duration:1e3},r),u),this}resetNorthPitch(r,u){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},r),u),this}snapToNorth(r,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,u):this}getPitch(){return this.transform.pitch}setPitch(r,u){return this.jumpTo({pitch:r},u),this}cameraForBounds(r,u){r=s.LngLatBounds.convert(r);const m=u&&u.bearing||0,y=u&&u.pitch||0,b=r.getNorthWest(),C=r.getSouthEast();return this._cameraForBounds(this.transform,b,C,m,y,u)}_extendCameraOptions(r){const u={top:0,bottom:0,right:0,left:0};if(typeof(r=s.extend({padding:u,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=="number"){const m=r.padding;r.padding={top:m,bottom:m,right:m,left:m}}return r.padding=s.extend(u,r.padding),r}_minimumAABBFrustumDistance(r,u){const m=u.max[0]-u.min[0],y=u.max[1]-u.min[1];return m/y>r.aspect?m/(2*Math.tan(.5*r.fovX)*r.aspect):y/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,u,m,y,b,C){const I=r.clone(),M=this._extendCameraOptions(C);I.bearing=y,I.pitch=b;const B=s.LngLat.convert(u),O=s.LngLat.convert(m),j=.5*(B.lat+O.lat),H=.5*(B.lng+O.lng),Q=s.latLngToECEF(j,H),J=s.normalize([],Q),ee=s.normalize([],s.cross([],J,[0,1,0])),te=s.cross([],ee,J),W=[ee[0],ee[1],ee[2],0,te[0],te[1],te[2],0,J[0],J[1],J[2],0,0,0,0,1],ue=[Q,s.latLngToECEF(B.lat,B.lng),s.latLngToECEF(O.lat,B.lng),s.latLngToECEF(O.lat,O.lng),s.latLngToECEF(B.lat,O.lng),s.latLngToECEF(j,B.lng),s.latLngToECEF(j,O.lng),s.latLngToECEF(B.lat,H),s.latLngToECEF(O.lat,H)];let ae=s.Aabb.fromPoints(ue.map(lt=>[s.dot(ee,lt),s.dot(te,lt),s.dot(J,lt)]));const pe=s.transformMat4([],ae.center,W);s.squaredLength(pe)===0&&s.set(pe,0,0,1),s.normalize(pe,pe),s.scale$2(pe,pe,s.GLOBE_RADIUS),I.center=s.ecefToLatLng(pe);const Ce=I.getWorldToCameraMatrix(),we=s.invert(new Float64Array(16),Ce);ae=s.Aabb.applyTransform(ae,s.multiply([],Ce,W)),s.transformMat4(pe,pe,Ce);const Ae=.5*(ae.max[2]-ae.min[2]),Be=this._minimumAABBFrustumDistance(I,ae),$e=s.scale$2([],[0,0,1],Ae),Ge=s.add($e,pe,$e),wt=Be+(I.pitch===0?0:s.distance(pe,Ge)),Fe=I.globeCenterInViewSpace,rt=s.sub([],pe,[Fe[0],Fe[1],Fe[2]]);s.normalize(rt,rt),s.scale$2(rt,rt,wt);const He=s.add([],pe,rt);s.transformMat4(He,He,we);const ht=s.earthRadius/s.GLOBE_RADIUS,Ue=s.length(He),Le=s.mercatorZfromAltitude(Math.max(Ue*ht-s.earthRadius,Number.EPSILON),0),Ze=Math.min(I.zoomFromMercatorZAdjusted(Le),M.maxZoom);return Ze>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"mercator"}),I.zoom=Ze,this._cameraForBounds(I,u,m,y,b,C)):{center:I.center,zoom:Ze,bearing:y,pitch:b}}queryTerrainElevation(r,u){const m=this.transform.elevation;return m?(u=s.extend({},{exaggerated:!0},u),m.getAtPoint(s.MercatorCoordinate.fromLngLat(r),null,u.exaggerated)):null}_cameraForBounds(r,u,m,y,b,C){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,u,m,y,b,C);const I=r.clone(),M=this._extendCameraOptions(C),B=I.padding;I.bearing=y,I.pitch=b;const O=s.LngLat.convert(u),j=s.LngLat.convert(m),H=new s.LngLat(O.lng,j.lat),Q=new s.LngLat(j.lng,O.lat),J=I.project(O),ee=I.project(j),te=this.queryTerrainElevation(O),W=this.queryTerrainElevation(j),ue=this.queryTerrainElevation(H),ae=this.queryTerrainElevation(Q),pe=[[J.x,J.y,Math.min(te||0,W||0,ue||0,ae||0)],[ee.x,ee.y,Math.max(te||0,W||0,ue||0,ae||0)]];let Ce=s.Aabb.fromPoints(pe);const we=I.getWorldToCameraMatrix(),Ae=s.invert(new Float64Array(16),we);Ce=s.Aabb.applyTransform(Ce,we);const Be=s.sub([],Ce.max,Ce.min),$e=B.left||0,Ge=B.right||0,wt=B.bottom||0,Fe=B.top||0,{left:rt,right:He,top:ht,bottom:Ue}=M.padding,Le=.5*($e+Ge),Ze=.5*(Fe+wt),lt=Math.min(I.scaleZoom(I.scale*Math.min((I.width-($e+Ge+rt+He))/Be[0],(I.height-(wt+Fe+Ue+ht))/Be[1])),M.maxZoom),mt=I.scale/I.zoomScale(lt);Ce=new s.Aabb([Ce.min[0]-(rt+Le)*mt,Ce.min[1]-(Ue+Ze)*mt,Ce.min[2]],[Ce.max[0]+(He+Le)*mt,Ce.max[1]+(ht+Ze)*mt,Ce.max[2]]);const Ht=.5*Be[2],vn=this._minimumAABBFrustumDistance(I,Ce),jt=[0,0,1,0];s.transformMat4$1(jt,jt,we),s.normalize$2(jt,jt);const Vt=s.scale$2([],jt,vn+Ht),Xt=s.add([],Ce.center,Vt),In=(typeof M.offset.x=="number"&&typeof M.offset.y=="number"?new s.pointGeometry(M.offset.x,M.offset.y):s.pointGeometry.convert(M.offset)).rotate(-s.degToRad(y));Ce.center[0]-=In.x*mt,Ce.center[1]+=In.y*mt,s.transformMat4(Ce.center,Ce.center,Ae),s.transformMat4(Xt,Xt,Ae);const en=[Ce.center[0],Ce.center[1],Xt[2]*I.pixelsPerMeter];s.scale$2(en,en,1/I.worldSize);const Wn=s.lngFromMercatorX(en[0]),ni=s.latFromMercatorY(en[1]),ui=Math.min(I._zoomFromMercatorZ(en[2]),M.maxZoom),oi=new s.LngLat(Wn,ni);return I.mercatorFromTransition&&ui<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"globe"}),I.zoom=ui,this._cameraForBounds(I,u,m,y,b,C)):{center:oi,zoom:ui,bearing:y,pitch:b}}fitBounds(r,u,m){const y=this.cameraForBounds(r,u);return this._fitInternal(y,u,m)}fitScreenCoordinates(r,u,m,y,b){const C=s.pointGeometry.convert(r),I=s.pointGeometry.convert(u),M=new s.pointGeometry(Math.min(C.x,I.x),Math.min(C.y,I.y)),B=new s.pointGeometry(Math.max(C.x,I.x),Math.max(C.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(C,I))return this;const O=this.transform.pointLocation3D(M),j=this.transform.pointLocation3D(B),H=this.transform.pointLocation3D(new s.pointGeometry(M.x,B.y)),Q=this.transform.pointLocation3D(new s.pointGeometry(B.x,M.y)),J=[Math.min(O.lng,j.lng,H.lng,Q.lng),Math.min(O.lat,j.lat,H.lat,Q.lat)],ee=[Math.max(O.lng,j.lng,H.lng,Q.lng),Math.max(O.lat,j.lat,H.lat,Q.lat)],te=y&&y.pitch?y.pitch:this.getPitch(),W=this._cameraForBounds(this.transform,J,ee,m,te,y);return this._fitInternal(W,y,b)}_fitInternal(r,u,m){return r?(delete(u=s.extend(r,u)).padding,u.linear?this.easeTo(u,m):this.flyTo(u,m)):this}jumpTo(r,u){this.stop();const m=r.preloadOnly?this.transform.clone():this.transform;let y=!1,b=!1,C=!1;return"zoom"in r&&m.zoom!==+r.zoom&&(y=!0,m.zoom=+r.zoom),r.center!==void 0&&(m.center=s.LngLat.convert(r.center)),"bearing"in r&&m.bearing!==+r.bearing&&(b=!0,m.bearing=+r.bearing),"pitch"in r&&m.pitch!==+r.pitch&&(C=!0,m.pitch=+r.pitch),r.padding==null||m.isPaddingEqual(r.padding)||(m.padding=r.padding),r.preloadOnly?(this._preloadTiles(m),this):(this.fire(new s.Event("movestart",u)).fire(new s.Event("move",u)),y&&this.fire(new s.Event("zoomstart",u)).fire(new s.Event("zoom",u)).fire(new s.Event("zoomend",u)),b&&this.fire(new s.Event("rotatestart",u)).fire(new s.Event("rotate",u)).fire(new s.Event("rotateend",u)),C&&this.fire(new s.Event("pitchstart",u)).fire(new s.Event("pitch",u)).fire(new s.Event("pitchend",u)),this.fire(new s.Event("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(hd),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,u){const m=this.transform;if(!m.projection.supportsFreeCamera)return s.warnOnce(hd),this;this.stop();const y=m.zoom,b=m.pitch,C=m.bearing;m.setFreeCameraOptions(r);const I=y!==m.zoom,M=b!==m.pitch,B=C!==m.bearing;return this.fire(new s.Event("movestart",u)).fire(new s.Event("move",u)),I&&this.fire(new s.Event("zoomstart",u)).fire(new s.Event("zoom",u)).fire(new s.Event("zoomend",u)),B&&this.fire(new s.Event("rotatestart",u)).fire(new s.Event("rotate",u)).fire(new s.Event("rotateend",u)),M&&this.fire(new s.Event("pitchstart",u)).fire(new s.Event("pitch",u)).fire(new s.Event("pitchend",u)),this.fire(new s.Event("moveend",u)),this}easeTo(r,u){this._stop(!1,r.easeId),((r=s.extend({offset:[0,0],duration:500,easing:s.ease},r)).animate===!1||!r.essential&&s.exported.prefersReducedMotion)&&(r.duration=0);const m=this.transform,y=this.getZoom(),b=this.getBearing(),C=this.getPitch(),I=this.getPadding(),M="zoom"in r?+r.zoom:y,B="bearing"in r?this._normalizeBearing(r.bearing,b):b,O="pitch"in r?+r.pitch:C,j="padding"in r?r.padding:m.padding,H=s.pointGeometry.convert(r.offset);let Q,J,ee;if(m.projection.name==="globe"){const $e=s.MercatorCoordinate.fromLngLat(m.center),Ge=H.rotate(-m.angle);$e.x+=Ge.x/m.worldSize,$e.y+=Ge.y/m.worldSize;const wt=$e.toLngLat(),Fe=s.LngLat.convert(r.center||wt);this._normalizeCenter(Fe),Q=m.centerPoint.add(Ge),J=new s.pointGeometry($e.x,$e.y).mult(m.worldSize),ee=new s.pointGeometry(s.mercatorXfromLng(Fe.lng),s.mercatorYfromLat(Fe.lat)).mult(m.worldSize).sub(J)}else{Q=m.centerPoint.add(H);const $e=m.pointLocation(Q),Ge=s.LngLat.convert(r.center||$e);this._normalizeCenter(Ge),J=m.project($e),ee=m.project(Ge).sub(J)}const te=m.zoomScale(M-y);let W,ue;r.around&&(W=s.LngLat.convert(r.around),ue=m.locationPoint(W));const ae=this._zooming||M!==y,pe=this._rotating||b!==B,Ce=this._pitching||O!==C,we=!m.isPaddingEqual(j),Ae=$e=>Ge=>{if(ae&&($e.zoom=s.number(y,M,Ge)),pe&&($e.bearing=s.number(b,B,Ge)),Ce&&($e.pitch=s.number(C,O,Ge)),we&&($e.interpolatePadding(I,j,Ge),Q=$e.centerPoint.add(H)),W)$e.setLocationAtPoint(W,ue);else{const wt=$e.zoomScale($e.zoom-y),Fe=M>y?Math.min(2,te):Math.max(.5,te),rt=Math.pow(Fe,1-Ge),He=$e.unproject(J.add(ee.mult(Ge*rt)).mult(wt));$e.setLocationAtPoint($e.renderWorldCopies?He.wrap():He,Q)}return r.preloadOnly||this._fireMoveEvents(u),$e};if(r.preloadOnly){const $e=this._emulate(Ae,r.duration,m);return this._preloadTiles($e),this}const Be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ae,this._rotating=pe,this._pitching=Ce,this._padding=we,this._easeId=r.easeId,this._prepareEase(u,r.noMoveStart,Be),this._ease(Ae(m),$e=>{m.recenterOnTerrain(),this._afterEase(u,$e)},r),this}_prepareEase(r,u,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",u||m.moving||this.fire(new s.Event("movestart",r)),this._zooming&&!m.zooming&&this.fire(new s.Event("zoomstart",r)),this._rotating&&!m.rotating&&this.fire(new s.Event("rotatestart",r)),this._pitching&&!m.pitching&&this.fire(new s.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new s.Event("move",r)),this._zooming&&this.fire(new s.Event("zoom",r)),this._rotating&&this.fire(new s.Event("rotate",r)),this._pitching&&this.fire(new s.Event("pitch",r))}_afterEase(r,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,y=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new s.Event("zoomend",r)),y&&this.fire(new s.Event("rotateend",r)),b&&this.fire(new s.Event("pitchend",r)),this.fire(new s.Event("moveend",r))}flyTo(r,u){if(!r.essential&&s.exported.prefersReducedMotion){const lt=s.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(lt,u)}this.stop(),r=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},r);const m=this.transform,y=this.getZoom(),b=this.getBearing(),C=this.getPitch(),I=this.getPadding(),M="zoom"in r?s.clamp(+r.zoom,m.minZoom,m.maxZoom):y,B="bearing"in r?this._normalizeBearing(r.bearing,b):b,O="pitch"in r?+r.pitch:C,j="padding"in r?r.padding:m.padding,H=m.zoomScale(M-y),Q=s.pointGeometry.convert(r.offset);let J=m.centerPoint.add(Q);const ee=m.pointLocation(J),te=s.LngLat.convert(r.center||ee);this._normalizeCenter(te);const W=m.project(ee),ue=m.project(te).sub(W);let ae=r.curve;const pe=Math.max(m.width,m.height),Ce=pe/H,we=ue.mag();if("minZoom"in r){const lt=s.clamp(Math.min(r.minZoom,y,M),m.minZoom,m.maxZoom),mt=pe/m.zoomScale(lt-y);ae=Math.sqrt(mt/we*2)}const Ae=ae*ae;function Be(lt){const mt=(Ce*Ce-pe*pe+(lt?-1:1)*Ae*Ae*we*we)/(2*(lt?Ce:pe)*Ae*we);return Math.log(Math.sqrt(mt*mt+1)-mt)}function $e(lt){return(Math.exp(lt)-Math.exp(-lt))/2}function Ge(lt){return(Math.exp(lt)+Math.exp(-lt))/2}const wt=Be(0);let Fe=function(lt){return Ge(wt)/Ge(wt+ae*lt)},rt=function(lt){return pe*((Ge(wt)*($e(mt=wt+ae*lt)/Ge(mt))-$e(wt))/Ae)/we;var mt},He=(Be(1)-wt)/ae;if(Math.abs(we)<1e-6||!isFinite(He)){if(Math.abs(pe-Ce)<1e-6)return this.easeTo(r,u);const lt=Ce<pe?-1:1;He=Math.abs(Math.log(Ce/pe))/ae,rt=function(){return 0},Fe=function(mt){return Math.exp(lt*ae*mt)}}r.duration="duration"in r?+r.duration:1e3*He/("screenSpeed"in r?+r.screenSpeed/ae:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const ht=b!==B,Ue=O!==C,Le=!m.isPaddingEqual(j),Ze=lt=>mt=>{const Ht=mt*He,vn=1/Fe(Ht);lt.zoom=mt===1?M:y+lt.scaleZoom(vn),ht&&(lt.bearing=s.number(b,B,mt)),Ue&&(lt.pitch=s.number(C,O,mt)),Le&&(lt.interpolatePadding(I,j,mt),J=lt.centerPoint.add(Q));const jt=mt===1?te:lt.unproject(W.add(ue.mult(rt(Ht))).mult(vn));return lt.setLocationAtPoint(lt.renderWorldCopies?jt.wrap():jt,J),lt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(u),lt};if(r.preloadOnly){const lt=this._emulate(Ze,r.duration,m);return this._preloadTiles(lt),this}return this._zooming=!0,this._rotating=ht,this._pitching=Ue,this._padding=Le,this._prepareEase(u,!1),this._ease(Ze(m),()=>this._afterEase(u),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,u)}if(!r){const m=this.handlers;m&&m.stop(!1)}return this}_ease(r,u,m){m.animate===!1||m.duration===0?(r(1),u()):(this._easeStart=s.exported.now(),this._easeOptions=m,this._onEaseFrame=r,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,u){r=s.wrap(r,-180,180);const m=Math.abs(r-u);return Math.abs(r-360-u)<m&&(r-=360),Math.abs(r+360-u)<m&&(r+=360),r}_normalizeCenter(r){const u=this.transform;if(!u.renderWorldCopies||u.maxBounds)return;const m=r.lng-u.center.lng;r.lng+=m>180?-360:m<-180?360:0}_emulate(r,u,m){const y=Math.ceil(15*u/1e3),b=[],C=r(m.clone());for(let I=0;I<=y;I++){const M=C(I/y);b.push(M.clone())}return b}}class dd{constructor(r={}){this.options=r,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const u=this.options&&this.options.compact;return this._map=r,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L("button","mapboxgl-ctrl-attrib-button",this._container),L("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(r,u){const m=this._map._getUIString(`AttributionControl.${u}`);r.setAttribute("aria-label",m),r.removeAttribute("title"),r.firstElementChild&&r.firstElementChild.setAttribute("title",m)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(r){const m=u.reduce((y,b,C)=>(b.value&&(y+=`${b.key}=${b.value}${C<u.length-1?"&":""}`),y),"?");r.href=`${s.config.FEEDBACK_URL}/${m}#${rd(this._map,!0)}`,r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const u=this._map.style._sourceCaches;for(const y in u){const b=u[y];if(b.used){const C=b.getSource();C.attribution&&r.indexOf(C.attribution)<0&&r.push(C.attribution)}}r.sort((y,b)=>y.length-b.length),r=r.filter((y,b)=>{for(let C=b+1;C<r.length;C++)if(r[C].indexOf(y)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const m=r.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,r.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class fd{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=L("div","mapboxgl-ctrl");const u=L("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const u in r){const m=r[u].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const u=r[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class Jl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const u=++this._id;return this._queue.push({callback:r,id:u,cancelled:!1}),u}remove(r){const u=this._currentlyRunning,m=u?this._queue.concat(u):this._queue;for(const y of m)if(y.id===r)return void(y.cancelled=!0)}run(r=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const m of u)if(!m.cancelled&&(m.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Cu(f,r,u){if(f=new s.LngLat(f.lng,f.lat),r){const m=new s.LngLat(f.lng-360,f.lat),y=new s.LngLat(f.lng+360,f.lat),b=360*Math.ceil(Math.abs(f.lng-u.center.lng)/360),C=u.locationPoint(f).distSqr(r),I=r.x<0||r.y<0||r.x>u.width||r.y>u.height;u.locationPoint(m).distSqr(r)<C&&(I||Math.abs(m.lng-u.center.lng)<b)?f=m:u.locationPoint(y).distSqr(r)<C&&(I||Math.abs(y.lng-u.center.lng)<b)&&(f=y)}for(;Math.abs(f.lng-u.center.lng)>180;){const m=u.locationPoint(f);if(m.x>=0&&m.y>=0&&m.x<=u.width&&m.y<=u.height)break;f.lng>u.center.lng?f.lng-=360:f.lng+=360}return f}const Ha={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Iu extends s.Evented{constructor(r,u){if(super(),(r instanceof s.window.HTMLElement||u)&&(r=s.extend({element:r},u)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=s.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=L("div");const y=41,b=27,C=R("svg",{display:"block",height:y*this._scale+"px",width:b*this._scale+"px",viewBox:`0 0 ${b} ${y}`},this._element),I=R("radialGradient",{id:"shadowGradient"},R("defs",{},C));R("stop",{offset:"10%","stop-opacity":.4},I),R("stop",{offset:"100%","stop-opacity":.05},I),R("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},C),R("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},C),R("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},C),R("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},C),this._offset=s.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()});const m=this._element.classList;for(const y in Ha)m.remove(`mapboxgl-marker-anchor-${y}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=s.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const u=r.code,m=r.charCode||r.keyCode;u!=="Space"&&u!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(r){const u=r.originalEvent.target,m=this._element;this._popup&&(u===m||m.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,u=this._pos;if(!r||!u)return!1;const m=r.unproject(u),y=r.getFreeCameraOptions();if(!y.position)return!1;const b=y.position.toLngLat();return b.distanceTo(m)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const u=this._pos;if(!u||u.x<0||u.x>r.transform.width||u.y<0||u.y>r.transform.height)return void this._clearFadeTimer();const m=r.unproject(u);let y;r._showingGlobe()&&s.isLngLatBehindGlobe(r.transform,this._lngLat)?y=0:(y=1-r._queryFogOpacity(m),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(y*=this._occludedOpacity)),this._element.style.opacity=`${y}`,this._element.style.pointerEvents=y>0?"auto":"none",this._popup&&this._popup._setOpacity(y),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${Ha[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const r=this._pos,u=this._map,m=this.getPitchAlignment();if(!u||!r||m!=="map")return"";if(!u._showingGlobe()){const M=u.getPitch();return M?`rotateX(${M}deg)`:""}const y=s.radToDeg(s.globeTiltAtLngLat(u.transform,this._lngLat)),b=r.sub(s.globeCenterToScreenPoint(u.transform)),C=Math.abs(b.x)+Math.abs(b.y);if(C===0)return"";const I=y/C;return`rotateX(${-b.y*I}deg) rotateY(${b.x*I}deg)`}_calculateZTransform(){const r=this._pos,u=this._map;if(!u||!r)return"";let m=0;const y=this.getRotationAlignment();if(y==="map")if(u._showingGlobe()){const b=u.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),C=u.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);m=s.radToDeg(Math.atan2(C.y,C.x))-90}else m=-u.getBearing();else if(y==="horizon"){const b=s.smoothstep(4,6,u.getZoom()),C=s.globeCenterToScreenPoint(u.transform);C.y+=b*u.transform.height;const I=r.sub(C),M=s.radToDeg(Math.atan2(I.y,I.x));m=(M>90?M-270:M+90)*(1-b)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(r){s.window.cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=Cu(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat),r===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=s.pointGeometry.convert(r),this._update(),this}_onMove(r){const u=this._map;if(!u)return;const m=this._pointerdownPos,y=this._positionDelta;if(m&&y){if(!this._isDragging){const b=this._clickTolerance||u._clickTolerance;if(r.point.dist(m)<b)return;this._isDragging=!0}this._pos=r.point.sub(y),this._lngLat=u.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(r){const u=this._map,m=this._pos;u&&m&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(m),this._pointerdownPos=r.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const u=this._map;return u&&(r?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Up={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},jp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function pd(f=new s.pointGeometry(0,0),r="bottom"){if(typeof f=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(r){case"top":return new s.pointGeometry(0,f);case"top-left":return new s.pointGeometry(u,u);case"top-right":return new s.pointGeometry(-u,u);case"bottom":return new s.pointGeometry(0,-f);case"bottom-left":return new s.pointGeometry(u,-u);case"bottom-right":return new s.pointGeometry(-u,-u);case"left":return new s.pointGeometry(f,0);case"right":return new s.pointGeometry(-f,0)}return new s.pointGeometry(0,0)}return f instanceof s.pointGeometry||Array.isArray(f)?s.pointGeometry.convert(f):s.pointGeometry.convert(f[r]||[0,0])}class Gp{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const u=s.easeCubicInOut((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,u,m){this._start=this.getValue(u),this._end=r,this._startTime=u,this._endTime=u+m}}const qp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Zp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},md={showCompass:!0,showZoom:!0,visualizePitch:!1};class Wp{constructor(r,u,m=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new ld({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,m&&(this.mousePitch=new cd({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(r,u){this.mouseRotate.mousedown(r,u),this.mousePitch&&this.mousePitch.mousedown(r,u),ne()}move(r,u){const m=this.map,y=this.mouseRotate.mousemoveWindow(r,u),b=y&&y.bearingDelta;if(b&&m.setBearing(m.getBearing()+b),this.mousePitch){const C=this.mousePitch.mousemoveWindow(r,u),I=C&&C.pitchDelta;I&&m.setPitch(m.getPitch()+I)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ce(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(s.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),Y(this.element,r)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,Y(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=_e(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=_e(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Hp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Xp={maxWidth:100,unit:"metric"};function Yp(f,r,u){const m=Au(r),y=m/r,b={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[u];this._map._requestDomTask(()=>{this._container.style.width=f*y+"px",this._container.innerHTML=`${m}&nbsp;${b}`})}function Au(f){const r=Math.pow(10,`${Math.floor(f)}`.length-1);let u=f/r;return u=u>=10?10:u>=5?5:u>=3?3:u>=2?2:u>=1?1:function(m){const y=Math.pow(10,Math.ceil(-Math.log(m)/Math.LN10));return Math.round(m*y)/y}(u),r*u}const Ql={version:s.version,supported:S,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends $p{constructor(f){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(f=s.extend({},Zp,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(f.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ot(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._useWebGL2=f.useWebGL2,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._optimizeForTerrain=f.optimizeForTerrain,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new Jl,this._domRenderTaskQueue=new Jl,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},qp,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Gp(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,typeof f.container=="string"){if(this._container=s.window.document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Np(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,f.style&&this.setStyle(f.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this._hash=f.hash&&new Ip(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,s.extend({},f.fitBoundsOptions,{duration:0})))),this.resize(),f.attributionControl&&this.addControl(new dd({customAttribution:f.customAttribution})),this._logoControl=new fd,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new s.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new s.Event(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(f,r){if(r===void 0&&(r=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=f.onAdd(this);this._controls.push(f);const m=this._controlPositions[r];return r.indexOf("bottom")!==-1?m.insertBefore(u,m.firstChild):m.appendChild(u),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(f);return r>-1&&this._controls.splice(r,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new s.Event("movestart",f)).fire(new s.Event("move",f)),this.fire(new s.Event("resize",f)),r&&this.fire(new s.Event("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(s.LngLatBounds.convert(f)),this._update()}setMinZoom(f){if((f=f==null?-2:f)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f==null?22:f)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f==null?0:f)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f==null?85:f)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?s.window.navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(r=>r==="auto"?s.window.navigator.language:r):f}setLanguage(f){const r=this._parseLanguage(f);if(!this.style||r===this._language)return this;this._language=r,this.style._reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,r=f.projection.name;let u;r==="globe"&&f.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(f.setMercatorFromTransition(),u=!0):r==="mercator"&&f.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(f.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,r){return this._updateProjection(f||r||{name:"mercator"})}_updateProjection(f){let r;if(r=f.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),r){this.painter.clearBackgroundTiles();for(const u in this.style._sourceCaches)this.style._sourceCaches[u].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(f){return this.transform.locationPoint3D(s.LngLat.convert(f))}unproject(f){return this.transform.pointLocation3D(s.pointGeometry.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,r,u){if(f==="mouseenter"||f==="mouseover"){let m=!1;const y=C=>{const I=r.filter(B=>this.getLayer(B)),M=I.length?this.queryRenderedFeatures(C.point,{layers:I}):[];M.length?m||(m=!0,u.call(this,new or(f,this,C.originalEvent,{features:M}))):m=!1},b=()=>{m=!1};return{layers:new Set(r),listener:u,delegates:{mousemove:y,mouseout:b}}}if(f==="mouseleave"||f==="mouseout"){let m=!1;const y=C=>{const I=r.filter(M=>this.getLayer(M));(I.length?this.queryRenderedFeatures(C.point,{layers:I}):[]).length?m=!0:m&&(m=!1,u.call(this,new or(f,this,C.originalEvent)))},b=C=>{m&&(m=!1,u.call(this,new or(f,this,C.originalEvent)))};return{layers:new Set(r),listener:u,delegates:{mousemove:y,mouseout:b}}}{const m=y=>{const b=r.filter(I=>this.getLayer(I)),C=b.length?this.queryRenderedFeatures(y.point,{layers:b}):[];C.length&&(y.features=C,u.call(this,y),delete y.features)};return{layers:new Set(r),listener:u,delegates:{[f]:m}}}}on(f,r,u){if(u===void 0)return super.on(f,r);Array.isArray(r)||(r=[r]);const m=this._createDelegatedListener(f,r,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(m);for(const y in m.delegates)this.on(y,m.delegates[y]);return this}once(f,r,u){if(u===void 0)return super.once(f,r);Array.isArray(r)||(r=[r]);const m=this._createDelegatedListener(f,r,u);for(const y in m.delegates)this.once(y,m.delegates[y]);return this}off(f,r,u){if(u===void 0)return super.off(f,r);r=new Set(Array.isArray(r)?r:[r]);const m=(b,C)=>{if(b.size!==C.size)return!1;for(const I of b)if(!C.has(I))return!1;return!0},y=this._delegatedListeners?this._delegatedListeners[f]:void 0;return y&&(b=>{for(let C=0;C<b.length;C++){const I=b[C];if(I.listener===u&&m(I.layers,r)){for(const M in I.delegates)this.off(M,I.delegates[M]);return b.splice(C,1),this}}})(y),this}queryRenderedFeatures(f,r){return this.style?(r!==void 0||f===void 0||f instanceof s.pointGeometry||Array.isArray(f)||(r=f,f=void 0),this.style.queryRenderedFeatures(f=f||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}querySourceFeatures(f,r){return this.style.querySourceFeatures(f,r)}setStyle(f,r){return(r=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&f?(this._diffStyle(f,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(f,r))}_getUIString(f){const r=this._locale[f];if(r==null)throw new Error(`Missing UI string '${f}'`);return r}_updateStyle(f,r){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f&&(this.style=new Yr(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f):this.style.loadJSON(f)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Yr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,r){if(typeof f=="string"){const u=this._requestManager.normalizeStyleURL(f),m=this._requestManager.transformRequest(u,s.ResourceType.Style);s.getJSON(m,(y,b)=>{y?this.fire(new s.ErrorEvent(y)):b&&this._updateDiff(b,r)})}else typeof f=="object"&&this._updateDiff(f,r)}_updateDiff(f,r){try{this.style.setState(f)&&this._update(!0)}catch(u){s.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(f,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(f,r){return this._lazyInitEmptyStyle(),this.style.addSource(f,r),this._update(!0)}isSourceLoaded(f){return!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){const f=this.style&&this.style._sourceCaches;for(const r in f){const u=f[r]._tiles;for(const m in u){const y=u[m];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}addSourceType(f,r,u){this._lazyInitEmptyStyle(),this.style.addSourceType(f,r,u)}removeSource(f){return this.style.removeSource(f),this._updateTerrain(),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,r,{pixelRatio:u=1,sdf:m=!1,stretchX:y,stretchY:b,content:C}={}){if(this._lazyInitEmptyStyle(),r instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&r instanceof s.window.ImageBitmap){const{width:I,height:M,data:B}=s.exported.getImageData(r);this.style.addImage(f,{data:new s.RGBAImage({width:I,height:M},B),pixelRatio:u,stretchX:y,stretchY:b,content:C,sdf:m,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:M}=r,B=r;this.style.addImage(f,{data:new s.RGBAImage({width:I,height:M},new Uint8Array(B.data)),pixelRatio:u,stretchX:y,stretchY:b,content:C,sdf:m,version:0,userImage:B}),B.onAdd&&B.onAdd(this,f)}}updateImage(f,r){const u=this.style.getImage(f);if(!u)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=r instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&r instanceof s.window.ImageBitmap?s.exported.getImageData(r):r,{width:y,height:b}=m;y!==void 0&&b!==void 0?y===u.data.width&&b===u.data.height?(u.data.replace(m.data,!(r instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&r instanceof s.window.ImageBitmap)),this.style.updateImage(f,u)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${y}, ${b})
                must be that same as the previous version of the image
                (${u.data.width}, ${u.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,r){s.getImage(this._requestManager.transformRequest(f,s.ResourceType.Image),(u,m)=>{r(u,m instanceof s.window.HTMLImageElement?s.exported.getImageData(m):m)})}listImages(){return this.style.listImages()}addLayer(f,r){return this._lazyInitEmptyStyle(),this.style.addLayer(f,r),this._update(!0)}moveLayer(f,r){return this.style.moveLayer(f,r),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}setLayerZoomRange(f,r,u){return this.style.setLayerZoomRange(f,r,u),this._update(!0)}setFilter(f,r,u={}){return this.style.setFilter(f,r,u),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,r,u,m={}){return this.style.setPaintProperty(f,r,u,m),this._update(!0)}getPaintProperty(f,r){return this.style.getPaintProperty(f,r)}setLayoutProperty(f,r,u,m={}){return this.style.setLayoutProperty(f,r,u,m),this._update(!0)}getLayoutProperty(f,r){return this.style.getLayoutProperty(f,r)}setLight(f,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,r),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(f),this.transform):0}setFeatureState(f,r){return this.style.setFeatureState(f,r),this._update()}removeFeatureState(f,r){return this.style.removeFeatureState(f,r),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let u,m,y,b=this._container;for(;b&&(!m||!y);){const C=s.window.getComputedStyle(b).transform;C&&C!=="none"&&(u=C.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(m=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(y=u[3])),b=b.parentElement}this._containerWidth=m?Math.abs(f/m):f,this._containerHeight=y?Math.abs(r/y):r}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=L("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=L("div","mapboxgl-canvas-container",f);this._interactive&&r.classList.add("mapboxgl-interactive"),this._canvas=L("canvas","mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=L("div","mapboxgl-control-container",f),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{m[y]=L("div",`mapboxgl-ctrl-${y}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,r){const u=s.exported.devicePixelRatio||1;this._canvas.width=u*Math.ceil(f),this._canvas.height=u*Math.ceil(r),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${r}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const r=this._markers.indexOf(f);r!==-1&&this._markers.splice(r,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const r=this._popups.indexOf(f);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const f=s.extend({},S.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._useWebGL2&&this._canvas.getContext("webgl2",f),u=r||this._canvas.getContext("webgl",f)||this._canvas.getContext("experimental-webgl",f);u?(this._useWebGL2&&!r&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(u,!0),this.painter=new $l(u,this.transform,!!r),this.on("data",m=>{m.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(u)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let r;const u=this.painter.context.extTimerQuery,m=s.exported.now();if(this.listens("gpu-timing-frame")&&(r=u.createQueryEXT(),u.beginQueryEXT(u.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const y=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,M=this.transform.pitch,B=s.exported.now(),O=new s.EvaluationParameters(I,{now:B,fadeDuration:y,pitch:M,transition:this.style.getTransition()});this.style.update(O)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let b=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),b=this._updateAverageElevation(m),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):b=this._updateAverageElevation(m),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,y,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const I=s.exported.now()-m;u.endQueryEXT(u.TIME_ELAPSED_EXT,r),setTimeout(()=>{const M=u.getQueryObjectEXT(r,u.QUERY_RESULT_EXT)/1e6;u.deleteQueryEXT(r),this.fire(new s.Event("gpu-timing-frame",{cpuTime:I,gpuTime:M})),s.window.performance.mark("frame-gpu",{startTime:m,detail:{gpuTime:M}})},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const M=this.painter.queryGpuTimers(I);this.fire(new s.Event("gpu-timing-layer",{layerTimes:M}))},50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const M=this.painter.queryGpuTimeDeferredRender(I);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:M}))},50)}const C=this._sourcesDirty||this._styleDirty||this._placementDirty||b;if(C||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(b=this._updateAverageElevation(m,!0)),b)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const M=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:M})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||C||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const r of this._markers)f&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!f||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(f,r=!1){const u=m=>(this.transform.averageElevation=m,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);if((r||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const m=this.transform.averageElevation;let y=this.transform.sampleAverageElevation(),b=!1;this.transform.elevation&&(b=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(y)?y=0:this._averageElevationLastSampledAt=f;const C=Math.abs(m-y);if(C>1){if(this._isInitialLoad||b)return this._averageElevation.jumpTo(y),u(y);this._averageElevation.easeTo(y,f,300)}else if(C>1e-4)return this._averageElevation.jumpTo(y),u(y)}return!!this._averageElevation.isEasing(f)&&u(this._averageElevation.getValue(f))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===s.AUTH_ERR_MSG||f.status===401)){const r=this.painter.context.gl;s.storeAuthState(r,!1),this._logoControl instanceof fd&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const u=this.painter.context.gl,m=u.createFramebuffer();function y(b){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,b,0);const C=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,C),C}return u.bindFramebuffer(u.FRAMEBUFFER,m),this._canvasPixelComparison(y(f),r.canvasCopies.map(y),r.timeStamps)}_canvasPixelComparison(f,r,u){let m=u[1]-u[0];const y=f.length/4;for(let b=0;b<r.length;b++){const C=r[b];let I=0;for(let M=0;M<C.length;M+=4)C[M]===f[M]&&C[M+1]===f[M+1]&&C[M+2]===f[M+2]&&C[M+3]===f[M+3]&&(I+=1);m+=(u[b+2]-u[b+1])*(1-I/y)}return m}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=s.exported.frame(r=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(r)}))}_preloadTiles(f){const r=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(r,(u,m)=>u._preloadTiles(f,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){s.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,f&&this._update())}_setCacheLimits(f,r){s.setCacheLimits(f,r)}get version(){return s.version}},NavigationControl:class{constructor(f){this.options=s.extend({},md,f),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),L("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),L("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:r}):u.resetNorth({},{originalEvent:r}))}),this._compassIcon=L("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const r=f.getZoom(),u=r===f.getMaxZoom(),m=r===f.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Wp(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,r){const u=L("button",f,this._container);return u.type="button",u.addEventListener("click",r),u}_setButtonTitle(f,r){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${r}`);f.setAttribute("aria-label",u),f.firstElementChild&&f.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends s.Evented{constructor(f){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},Hp,f),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Kr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const r=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,f(u)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(u=>r(u.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(f){const r=this._map.getMaxBounds(),u=f.coords;return!!r&&(u.longitude<r.getWest()||u.longitude>r.getEast()||u.latitude<r.getSouth()||u.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",f)),this._finish()}}_updateCamera(f){const r=new s.LngLat(f.coords.longitude,f.coords.latitude),u=f.coords.accuracy,m=this._map.getBearing(),y=s.extend({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(u),y,{geolocateSource:!0})}_updateMarker(f){if(f){const r=new s.LngLat(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,r=s.mercatorZfromAltitude(1,f._center.lat)*f.worldSize,u=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=L("button","mapboxgl-ctrl-geolocate",this._container),L("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L("div","mapboxgl-user-location"),this._dotElement.appendChild(L("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(L("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Iu({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=L("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Iu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:dd,ScaleControl:class{constructor(f){this.options=s.extend({},Xp,f),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Yp.bind(this)),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,r=this._map,u=r._containerHeight/2,m=r._containerWidth/2-f/2,y=r.unproject([m,u]),b=r.unproject([m+f,u]),C=y.distanceTo(b);if(this.options.unit==="imperial"){const I=3.2808*C;I>5280?this._setScale(f,I/5280,"mile"):this._setScale(f,I,"foot")}else this.options.unit==="nautical"?this._setScale(f,C/1852,"nautical-mile"):C>=1e3?this._setScale(f,C/1e3,"kilometer"):this._setScale(f,C,"meter")}_setScale(f,r,u){const m=Au(r),y=m/r;this._map._requestDomTask(()=>{this._container.style.width=f*y+"px",this._container.innerHTML=u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:u}).format(m):`${m}&nbsp;nm`})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f){this._fullscreen=!1,f&&f.container&&(f.container instanceof s.window.HTMLElement?this._container=f.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=L("button","mapboxgl-ctrl-fullscreen",this._controlContainer);L("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(f){super(),this.options=s.extend(Object.create(Up),f),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=s.LngLat.convert(f),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(s.window.document.createTextNode(f))}setHTML(f){const r=s.window.document.createDocumentFragment(),u=s.window.document.createElement("body");let m;for(u.innerHTML=f;m=u.firstChild,m;)r.appendChild(m);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=L("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(f),this.options.closeButton){const u=this._closeButton=L("button","mapboxgl-popup-close-button",r);u.type="button",u.setAttribute("aria-label","Close popup"),u.setAttribute("aria-hidden","true"),u.innerHTML="&#215;",u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let r;return this._classList.delete(f)?r=!1:(this._classList.add(f),r=!0),this._updateClassList(),r}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const r=this._map,u=this._container,m=this._pos;if(!r||!u||!m)return"bottom";const y=u.offsetWidth,b=u.offsetHeight,C=m.x<y/2,I=m.x>r.transform.width-y/2;if(m.y+f<b)return C?"top-left":I?"top-right":"top";if(m.y>r.transform.height-b){if(C)return"bottom-left";if(I)return"bottom-right"}return C?"left":I?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),f.className=r.join(" ")}_update(f){const r=this._map,u=this._content;if(!r||!this._lngLat&&!this._trackPointer||!u)return;let m=this._container;if(m||(m=this._container=L("div","mapboxgl-popup",r.getContainer()),this._tip=L("div","mapboxgl-popup-tip",m),m.appendChild(u)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Cu(this._lngLat,this._pos,r.transform)),!this._trackPointer||f){const y=this._pos=this._trackPointer&&f?f:r.project(this._lngLat),b=pd(this.options.offset),C=this._anchor=this._getAnchor(b.y),I=pd(this.options.offset,C),M=y.add(I).round();r._requestDomTask(()=>{this._container&&C&&(this._container.style.transform=`${Ha[C]} translate(${M.x}px,${M.y}px)`)})}if(!this._marker&&r._showingGlobe()){const y=s.isLngLatBehindGlobe(r.transform,this._lngLat)?0:1;this._setOpacity(y)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(jp);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:Iu,Style:Yr,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.pointGeometry,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:mu,Evented:s.Evented,config:s.config,prewarm:function(){un().acquire(tn)},clearPrewarmedResources:function(){const f=Kt;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(tn),Kt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(f){s.config.ACCESS_TOKEN=f},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(f){s.config.API_URL=f},get workerCount(){return Qt.workerCount},set workerCount(f){Qt.workerCount=f},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){s.config.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){s.clearTileCache(f)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return Ql});var _=d;return _})})(l2);const Lc=l2.exports,Ai=Symbol(),tR=gn({__name:"Map",props:{accessToken:null,options:null},emits:["loaded"],setup(e,{expose:o,emit:a}){const c=e;Lc.accessToken=c.accessToken;const d=Ci(),g=Ci(),_=Qe(!1),s=ie(()=>g.value);return o({map:s}),Gi(Ai,s),Ye(()=>{var w;return(w=c.options)==null?void 0:w.center},w=>{!g.value||!w||g.value.flyTo({center:w})}),Ye(()=>{var w;return(w=c.options)==null?void 0:w.zoom},w=>{!g.value||w===void 0||g.value.flyTo({zoom:w})}),Ye(()=>{var w;return(w=c.options)==null?void 0:w.pitch},w=>{!g.value||w===void 0||g.value.flyTo({pitch:w})}),Ye(()=>{var w;return(w=c.options)==null?void 0:w.bearing},w=>{!g.value||w===void 0||g.value.flyTo({bearing:w})}),Ye(()=>{var w;return(w=c.options)==null?void 0:w.bounds},w=>{!g.value||!w||g.value.fitBounds(w)}),Ye(()=>{var w;return(w=c.options)==null?void 0:w.maxZoom},w=>{!g.value||w===void 0||g.value.setMaxZoom(w)}),Ye(()=>{var w;return(w=c.options)==null?void 0:w.minZoom},w=>{!g.value||w===void 0||g.value.setMinZoom(w)}),Ye(()=>{var w;return(w=c.options)==null?void 0:w.maxBounds},w=>{!g.value||!w||g.value.setMaxBounds(w)}),Ye(()=>{var w;return(w=c.options)==null?void 0:w.maxPitch},w=>{!g.value||w===void 0||g.value.setMaxPitch(w)}),Ye(()=>{var w;return(w=c.options)==null?void 0:w.minPitch},w=>{!g.value||w===void 0||g.value.setMinPitch(w)}),Ye(()=>{var w;return(w=c.options)==null?void 0:w.style},w=>{var S;!g.value||!w||(w instanceof Object?(S=g.value)==null||S.setStyle(w,{diff:!0}):g.value.setStyle(w))}),Ye(()=>{var w;return(w=c.options)==null?void 0:w.projection},w=>{!g.value||g.value.setProjection(w)}),Fn(()=>{d.value&&(g.value=new Lc.Map({container:d.value,style:"mapbox://styles/mapbox/streets-v11",center:[120,30],zoom:2,...c.options}),g.value.on("load",()=>{a("loaded"),_.value=!0}))}),gr(()=>{g.value&&g.value.remove()}),(w,S)=>(bi(),go(On,null,[h0("div",{ref_key:"mapRef",ref:d,style:{position:"absolute",height:"100%",width:"100%"}},null,512),_.value?Uf(w.$slots,"default",{key:0}):nP("",!0)],64))}}),nR=gn({__name:"Sprite",props:{name:null,url:null},setup(e){const o=e,a=cn(Ai,void 0),c=()=>{if(!a)return;const d=a.value.hasImage(o.name);typeof o.url=="string"?a.value.loadImage(o.url,(g,_)=>{g||!_||(d?a.value.updateImage(o.name,_):a.value.addImage(o.name,_))}):d?a.value.updateImage(o.name,o.url):a.value.addImage(o.name,o.url)};return Ye(()=>o.url,c),Fn(c),gr(()=>{a&&a.value.hasImage(o.name)&&a.value.removeImage(o.name)}),(d,g)=>null}});function Gm(e,o,a){const c=()=>{e.value&&e.value.removeEventListener(o,a)};Ye(e,d=>{c(),d&&d.addEventListener(o,a)}),Ii(()=>{c()})}function li(e,o,a,c){Fn(()=>{e.on(o,a,c)}),Ii(()=>{e.off(o,a,c)})}function u2(e,o,a){let c;const d=()=>{!c||c.disconnect()};Ye(e,g=>{d(),g&&(c=new MutationObserver(a),c.observe(g,o))}),gr(()=>{d()})}const iR=gn({__name:"Marker",props:{center:null,options:null},emits:["click","mouseenter","mousemove","mouseleave","update:center"],setup(e,{emit:o}){const a=e,c=Ci(),d=cn(Ai,void 0),g=Qe(),_=()=>{if(!d||!a.center)return;const S=a.options||{};g.value.innerHTML&&(S.element=g.value),c.value=new Lc.Marker(S).setLngLat(a.center),c.value.addTo(d.value),c.value.on("dragend",w)},s=()=>{!d||!c.value||(c.value.off("dragend",w),c.value.remove(),c.value=void 0)},w=()=>{if(!c.value)return;const{lng:S,lat:A}=c.value.getLngLat();o("update:center",[S,A])};return u2(g.value,{attributes:!0,childList:!0,subtree:!0},()=>{_()}),Gm(ie(()=>{var S;return(S=c.value)==null?void 0:S.getElement()}),"click",S=>{o("click",S)}),Gm(ie(()=>{var S;return(S=c.value)==null?void 0:S.getElement()}),"mouseenter",S=>{o("mouseenter",S)}),Gm(ie(()=>{var S;return(S=c.value)==null?void 0:S.getElement()}),"mousemove",S=>{o("mousemove",S)}),Gm(ie(()=>{var S;return(S=c.value)==null?void 0:S.getElement()}),"mouseleave",S=>{o("mouseleave",S)}),Ye(()=>a.center,()=>{a.center?c.value?c.value.setLngLat(a.center):_():s()}),Ye(()=>{var S;return(S=a.options)==null?void 0:S.offset},S=>{!c.value||!S||c.value.setOffset(S)}),Ye(()=>{var S;return(S=a.options)==null?void 0:S.draggable},S=>{!c.value||S===void 0||c.value.setDraggable(S)}),Ye(()=>{var S;return(S=a.options)==null?void 0:S.scale},()=>{!c.value||(s(),_())}),Ye(()=>{var S;return(S=a.options)==null?void 0:S.rotation},S=>{!c.value||S===void 0||c.value.setRotation(S)}),Ye(()=>{var S;return(S=a.options)==null?void 0:S.color},()=>{!c.value||(s(),_())}),Ye(()=>{var S;return(S=a.options)==null?void 0:S.anchor},()=>{!c.value||(s(),_())}),Ye(()=>{var S;return(S=a.options)==null?void 0:S.rotationAlignment},S=>{!c.value||!S||c.value.setRotationAlignment(S)}),Ye(()=>{var S;return(S=a.options)==null?void 0:S.pitchAlignment},S=>{var A;S&&((A=c.value)==null||A.setPitchAlignment(S))}),Fn(()=>{_()}),gr(()=>{s()}),(S,A)=>(bi(),go("div",{ref_key:"elRef",ref:g},[Uf(S.$slots,"default")],512))}}),rR=gn({__name:"Popup",props:{visible:{type:Boolean},center:null,options:null},emits:["update:visible"],setup(e,{emit:o}){const a=e,c=cn(Ai,void 0),d=Ci(),g=Qe();u2(ie(()=>g.value),{attributes:!0,childList:!0,subtree:!0,characterData:!0},()=>{a.visible&&d.value&&g.value&&d.value.setHTML(g.value.innerHTML)});const _=()=>{!c||!a.center||!a.visible||!g.value||(d.value=new Lc.Popup(a.options||{}).setLngLat(a.center).setHTML(g.value.innerHTML).addTo(c.value),d.value.on("close",w))},s=()=>{d.value&&(d.value.off("close",w),d.value.remove())};Ye(()=>a.visible,()=>{s(),a.visible&&_()}),Ye(()=>a.center,()=>{!c||!d.value||!a.visible||(a.center?d.value.setLngLat(a.center).addTo(c.value):s())}),Ye(()=>{var S;return(S=a.options)==null?void 0:S.anchor},S=>{!d.value||!a.visible||S&&(s(),_())}),Ye(()=>{var S;return(S=a.options)==null?void 0:S.offset},S=>{!d.value||!a.visible||S&&d.value.setOffset(S)}),Ye(()=>{var S;return(S=a.options)==null?void 0:S.maxWidth},S=>{!d.value||!a.visible||S&&d.value.setMaxWidth(S)});const w=()=>{o("update:visible",!1)};return Fn(()=>{_()}),gr(()=>{s()}),(S,A)=>(bi(),go("div",{style:{display:"none"},ref_key:"popupRef",ref:g},[Uf(S.$slots,"default")],512))}}),oR=gn({__name:"Fog",props:{color:null,range:null},setup(e){const o=e,a=cn(Ai,void 0),c=()=>{if(!a)return;const d={};Object.keys(o).forEach(g=>{o[g]!==void 0&&(d[g]=o[g])}),a.value.setFog(d)};return Ye(()=>o.color,()=>c()),Ye(()=>o["horizon-blend"],()=>c()),Ye(()=>o["high-color"],()=>c()),Ye(()=>o["space-color"],()=>c()),Ye(()=>o["star-intensity"],()=>c()),Ye(()=>o.range,()=>c()),Fn(()=>{c()}),gr(()=>{!a||a.value.setFog()}),(d,g)=>null}}),sR=gn({__name:"FeatureState",props:{feature:null,state:null},setup(e){const o=e,a=cn(Ai,void 0),c=(g,_)=>{!a||!g.id||a.value.setFeatureState(g,_)},d=g=>{!a||!g.id||a.value.removeFeatureState(g)};return Ye(()=>o.feature,(g,_)=>{d(_),c(g,o.state)}),Ye(()=>o.state,g=>{c(o.feature,g)}),Fn(()=>{c(o.feature,o.state)}),gr(()=>{d(o.feature)}),(g,_)=>null}}),aR=gn({__name:"AttributionControl",props:{compact:{type:Boolean},customAttribution:null,position:null},setup(e){const o=e,a=Ci(),c=cn(Ai,void 0);return Fn(()=>{!c||(a.value=new Lc.AttributionControl({compact:o.compact||!1,customAttribution:o.customAttribution}),c.value.addControl(a.value,o.position||"bottom-right"))}),gr(()=>{!c||!a.value||c.value.removeControl(a.value)}),(d,g)=>null}}),lR=gn({__name:"NavigationControl",props:{showCompass:{type:Boolean},showZoom:{type:Boolean},visualizePitch:{type:Boolean},position:null},setup(e){const o=e,a=Ci(),c=cn(Ai,void 0);return Fn(()=>{!c||(a.value=new Lc.NavigationControl({showCompass:o.showCompass||!0,showZoom:o.showZoom||!0,visualizePitch:o.visualizePitch||!1}),c.value.addControl(a.value,o.position||"top-left"))}),gr(()=>{!c||!a.value||c.value.removeControl(a.value)}),(d,g)=>null}}),cR=gn({__name:"ScaleControl",props:{maxWidth:null,unit:null,position:null},setup(e){const o=e,a=Ci(),c=cn(Ai,void 0);return Ye(()=>o.unit,()=>{o.unit&&a.value.setUnit(o.unit)}),Fn(()=>{var d;!c||(a.value=new Lc.ScaleControl({maxWidth:(d=o.maxWidth)!=null?d:100,unit:o.unit||"metric"}),c.value.addControl(a.value,o.position||"top-right"))}),gr(()=>{!c||!a.value||c.value.removeControl(a.value)}),(d,g)=>null}});function ar(e,o,a){for(const c in e)c in o&&e[c]===o[c]||a(c,e[c]);for(const c in o)c in e||a(c,void 0)}const uR=gn({__name:"BackgroundLayer",props:{id:null,sourceLayer:null,paint:null,layout:null},setup(e){const o=e,a=Ci(),c=cn(Ai,void 0),d=(_,s)=>{!c||c.value.setPaintProperty(o.id,_,s)},g=(_,s)=>{!c||c.value.setLayoutProperty(o.id,_,s)};return Ye(()=>({...o.paint}),(_,s)=>{ar(_,s,d)},{deep:!1}),Ye(()=>({...o.layout}),(_,s)=>{ar(_,s,g)},{deep:!1}),Fn(()=>{!c||(c.value.addLayer({id:o.id,type:"background",paint:o.paint||{},layout:o.layout||{}},o.sourceLayer),a.value=c.value.getLayer(o.id))}),Ii(()=>{!c||!a.value||c.value.removeLayer(o.id)}),(_,s)=>null}}),hR=gn({__name:"CircleLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ci(),d=cn(Ai,void 0);d!=null&&d.value&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const g=(w,S)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,S)},_=(w,S)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,S)},s=()=>{var w,S;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(S=a.maxzoom)!=null?S:24)};return Ye(()=>({...a.paint}),(w,S)=>{ar(w,S,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,S)=>{ar(w,S,_)},{deep:!1}),Ye(()=>a.minzoom,s),Ye(()=>a.maxzoom,s),Ye(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),Fn(()=>{var w,S;if(!d)return;const A={type:"circle",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(S=a.maxzoom)!=null?S:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ii(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,S)=>null}}),dR=gn({__name:"FillExtrusionLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ci(),d=cn(Ai,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const g=(w,S)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,S)},_=(w,S)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,S)},s=()=>{var w,S;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(S=a.maxzoom)!=null?S:24)};return Ye(()=>({...a.paint}),(w,S)=>{ar(w,S,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,S)=>{ar(w,S,_)},{deep:!1}),Ye(()=>a.minzoom,s),Ye(()=>a.maxzoom,s),Ye(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),Fn(()=>{var w,S;if(!d)return;const A={type:"fill-extrusion",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(S=a.maxzoom)!=null?S:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ii(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,S)=>null}}),fR=gn({__name:"FillLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ci(),d=cn(Ai,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const g=(w,S)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,S)},_=(w,S)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,S)},s=()=>{var w,S;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(S=a.maxzoom)!=null?S:24)};return Ye(()=>({...a.paint}),(w,S)=>{ar(w,S,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,S)=>{ar(w,S,_)},{deep:!1}),Ye(()=>a.minzoom,s),Ye(()=>a.maxzoom,s),Ye(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),Fn(()=>{var w,S;if(!d)return;const A={type:"fill",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(S=a.maxzoom)!=null?S:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ii(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,S)=>null}}),pR=gn({__name:"HeatmapLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ci(),d=cn(Ai,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const g=(w,S)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,S)},_=(w,S)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,S)},s=()=>{var w,S;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(S=a.maxzoom)!=null?S:24)};return Ye(()=>({...a.paint}),(w,S)=>{ar(w,S,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,S)=>{ar(w,S,_)},{deep:!1}),Ye(()=>a.minzoom,s),Ye(()=>a.maxzoom,s),Ye(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),Fn(()=>{var w,S;if(!d)return;const A={type:"heatmap",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(S=a.maxzoom)!=null?S:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ii(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,S)=>null}}),mR=gn({__name:"HillshadeLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ci(),d=cn(Ai,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const g=(w,S)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,S)},_=(w,S)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,S)},s=()=>{var w,S;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(S=a.maxzoom)!=null?S:24)};return Ye(()=>({...a.paint}),(w,S)=>{ar(w,S,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,S)=>{ar(w,S,_)},{deep:!1}),Ye(()=>a.minzoom,s),Ye(()=>a.maxzoom,s),Ye(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),Fn(()=>{var w,S;if(!d)return;const A={type:"hillshade",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(S=a.maxzoom)!=null?S:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ii(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,S)=>null}}),gR=gn({__name:"LineLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ci(),d=cn(Ai,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const g=(w,S)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,S)},_=(w,S)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,S)},s=()=>{var w,S;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(S=a.maxzoom)!=null?S:24)};return Ye(()=>({...a.paint}),(w,S)=>{ar(w,S,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,S)=>{ar(w,S,_)},{deep:!1}),Ye(()=>a.minzoom,s),Ye(()=>a.maxzoom,s),Ye(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),Fn(()=>{var w,S;if(!d)return;const A={type:"line",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(S=a.maxzoom)!=null?S:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ii(()=>{d&&c.value&&d.value.removeLayer(a.id)}),(w,S)=>null}}),vR=gn({__name:"RasterLayer",props:{id:null,source:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ci(),d=cn(Ai,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const g=(w,S)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,S)},_=(w,S)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,S)},s=()=>{var w,S;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(S=a.maxzoom)!=null?S:24)};return Ye(()=>({...a.paint}),(w,S)=>{ar(w,S,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,S)=>{ar(w,S,_)},{deep:!1}),Ye(()=>a.minzoom,s),Ye(()=>a.maxzoom,s),Ye(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),Fn(()=>{var w,S;if(!d)return;const A={type:"raster",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(S=a.maxzoom)!=null?S:24};a.filter&&(A.filter=a.filter),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ii(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,S)=>null}}),_R=gn({__name:"SymbolLayer",props:{id:null,source:null,sourceLayer:null,paint:null,layout:null,minzoom:null,maxzoom:null,filter:null},emits:["click","mousemove","mouseenter","mouseleave"],setup(e,{emit:o}){const a=e,c=Ci(),d=cn(Ai,void 0);d&&(li(d.value,"click",a.id,w=>{o("click",w)}),li(d.value,"mouseenter",a.id,w=>{o("mouseenter",w)}),li(d.value,"mousemove",a.id,w=>{o("mousemove",w)}),li(d.value,"mouseleave",a.id,w=>{o("mouseleave",w)}));const g=(w,S)=>{!d||!c.value||d.value.setPaintProperty(a.id,w,S)},_=(w,S)=>{!d||!c.value||d.value.setLayoutProperty(a.id,w,S)},s=()=>{var w,S;!d||!c.value||d.value.setLayerZoomRange(a.id,(w=a.minzoom)!=null?w:0,(S=a.maxzoom)!=null?S:24)};return Ye(()=>({...a.paint}),(w,S)=>{ar(w,S,g)},{deep:!1}),Ye(()=>({...a.layout}),(w,S)=>{ar(w,S,_)},{deep:!1}),Ye(()=>a.minzoom,s),Ye(()=>a.maxzoom,s),Ye(()=>a.filter,()=>{!d||!c.value||d.value.setFilter(a.id,a.filter)}),Fn(()=>{var w,S;if(!d)return;const A={type:"symbol",id:a.id,source:a.source,paint:a.paint||{},layout:a.layout||{},minzoom:(w=a.minzoom)!=null?w:0,maxzoom:(S=a.maxzoom)!=null?S:24};a.filter&&(A.filter=a.filter),a.sourceLayer&&(A["source-layer"]=a.sourceLayer),d.value.addLayer(A),c.value=d.value.getLayer(a.id)}),Ii(()=>{!d||!c.value||d.value.removeLayer(a.id)}),(w,S)=>null}}),yR=gn({__name:"SkyLayer",props:{id:null,paint:null,layout:null},setup(e){const o=e,a=Ci(),c=cn(Ai,void 0),d=(_,s)=>{!c||c.value.setPaintProperty(o.id,_,s)},g=(_,s)=>{!c||c.value.setLayoutProperty(o.id,_,s)};return Ye(()=>({...o.paint}),(_,s)=>{ar(_,s,d)},{deep:!1}),Ye(()=>({...o.layout}),(_,s)=>{ar(_,s,g)},{deep:!1}),Fn(()=>{!c||(c.value.addLayer({id:o.id,type:"sky",paint:o.paint||{},layout:o.layout||{}}),a.value=c.value.getLayer(o.id))}),Ii(()=>{!c||!a.value||c.value.removeLayer(o.id)}),(_,s)=>null}}),xR=gn({__name:"GeoSource",props:{id:null,data:null,attribution:null,buffer:null,cluster:{type:Boolean},clusterMaxZoom:null,clusterMinPoints:null,clusterProperties:null,clusterRadius:null,filter:{type:[Boolean,Array,null]},generateId:{type:Boolean},lineMetrics:{type:Boolean},maxzoom:null,protomteId:null,tolerance:null},setup(e){const o=e,a=Ci(),c=cn(Ai,void 0);return Ye(()=>o.data,d=>{!c||!d||!a.value||a.value.setData(d)},{deep:!0}),Fn(()=>{if(!c)return;const d={type:"geojson",data:o.data};o.buffer!==void 0&&(d.buffer=o.buffer),o.generateId&&(d.generateId=o.generateId),o.lineMetrics&&(d.lineMetrics=o.lineMetrics),o.maxzoom!==void 0&&(d.maxzoom=o.maxzoom),o.tolerance!==void 0&&(d.tolerance=o.tolerance),o.filter&&(d.filter=o.filter),o.attribution&&(d.attribution=o.attribution),o.protomteId&&(d.promoteId=o.protomteId),o.cluster&&(d.cluster=o.cluster,o.clusterMaxZoom&&(d.clusterMaxZoom=o.clusterMaxZoom),o.clusterMinPoints&&(d.clusterMinPoints=o.clusterMinPoints),o.clusterProperties&&(d.clusterProperties=o.clusterProperties),o.clusterRadius&&(d.clusterRadius=o.clusterRadius)),c.value.addSource(o.id,d),a.value=c.value.getSource(o.id)}),gr(()=>{!c||!a.value||c.value.removeSource(o.id)}),(d,g)=>null}}),bR=gn({__name:"RasterSource",props:{id:null,url:null,tiles:null,tileSize:null,scheme:null,attribution:null,bounds:null,minzoom:null,maxzoom:null},setup(e){const o=e,a=Ci(),c=cn(Ai,void 0),d=()=>{!c||(c.value.style._sourceCaches[`other:${o.id}`].clearTiles(),c.value.style._sourceCaches[`other:${o.id}`].update(c.value.transform),c.value.triggerRepaint())};return Ye(()=>o.url,g=>{!g||!a.value||(a.value.url=g,d())}),Ye(()=>o.tiles,g=>{o.url||!g||!a.value||(a.value.tiles=g,d())}),Fn(()=>{if(!c)return;const g={id:o.id,type:"raster",scheme:o.scheme||"xyz",tileSize:o.tileSize||256,attribution:o.attribution||"",bounds:o.bounds||[-180,-85.051129,180,85.051129],minzoom:o.minzoom||0,maxzoom:o.maxzoom||22};o.tiles&&(g.tiles=o.tiles),o.url&&(delete g.tiles,g.url=o.url),(g.url||g.tiles)&&(c.value.addSource(o.id,g),a.value=c.value.getSource(o.id))}),gr(()=>{!c||!a.value||c.value.removeSource(o.id)}),(g,_)=>null}}),wR=gn({__name:"RasterDemSource",props:{id:null,url:null,tiles:null,tileSize:null,attribution:null,bounds:null,minzoom:null,maxzoom:null,exaggeration:null,encoding:null,volatile:{type:Boolean}},setup(e){const o=e,a=Ci(),c=cn(Ai,void 0);return Fn(()=>{if(!c)return;const d={id:o.id,type:"raster-dem",tileSize:o.tileSize||256,attribution:o.attribution||"",bounds:o.bounds||[-180,-85.051129,180,85.051129],minzoom:o.minzoom||0,maxzoom:o.maxzoom||22};o.tiles&&(d.tiles=o.tiles),o.url&&(delete d.tiles,d.url=o.url),(d.url||d.tiles)&&(c.value.addSource(o.id,d),a.value=c.value.getSource(o.id),c.value.setTerrain({source:o.id,exaggeration:o.exaggeration||1}))}),gr(()=>{!c||!a.value||(c.value.setTerrain(),c.value.removeSource(o.id))}),(d,g)=>null}}),ER=gn({__name:"VectorSource",props:{id:null,url:null,tiles:null,promoteId:null,scheme:null,attribution:null,bounds:null,minzoom:null,maxzoom:null,volatile:{type:Boolean}},setup(e){const o=e,a=Ci(),c=cn(Ai,void 0);return Ye(()=>o.url,d=>{d&&a.value.setUrl(d)}),Ye(()=>o.tiles,d=>{d&&!o.url&&a.value.setTiles(d)}),Fn(()=>{if(!c)return;const d={id:o.id,type:"vector",scheme:o.scheme||"xyz",attribution:o.attribution||"",bounds:o.bounds||[-180,-85.051129,180,85.051129],minzoom:o.minzoom||0,maxzoom:o.maxzoom||22};o.promoteId&&(d.promoteId=o.promoteId),o.tiles&&(d.tiles=o.tiles),o.url&&(delete d.tiles,d.url=o.url),(d.url||d.tiles)&&(c.value.addSource(o.id,d),a.value=c.value.getSource(o.id))}),gr(()=>{!c||!a.value||c.value.removeSource(o.id)}),(d,g)=>null}}),SR=gn({__name:"ImageSource",props:{id:null,url:null,coordinates:null},setup(e){const o=e,a=Ci(),c=cn(Ai,void 0),d=()=>{!a.value||a.value.updateImage({url:o.url,coordinates:o.coordinates})};return Ye(()=>o.url,d),Ye(()=>o.coordinates,d),Fn(()=>{!c||(c.value.addSource(o.id,{type:"image",url:o.url,coordinates:o.coordinates}),a.value=c.value.getSource(o.id))}),gr(()=>{!c||!a.value||c.value.removeSource(o.id)}),(g,_)=>null}}),TR=gn({__name:"VideoSource",props:{id:null,urls:null,coordinates:null,playing:{type:Boolean}},setup(e){const o=e,a=Ci(),c=cn(Ai,void 0),d=()=>{!c||!a.value||a.value.setCoordinates(o.coordinates)},g=()=>{o.playing?a.value.play():a.value.pause()};return Ye(()=>o.coordinates,d),Ye(()=>o.playing,g),Fn(()=>{!c||(c.value.addSource(o.id,{type:"video",urls:o.urls,coordinates:o.coordinates}),a.value=c.value.getSource(o.id),g())}),gr(()=>{!c||!a.value||c.value.removeSource(o.id)}),(_,s)=>null}}),CR=gn({__name:"CanvasSource",props:{id:null,animate:{type:Boolean},coordinates:null},setup(e,{expose:o}){const a=e,c=Qe(),d=Ci(),g=cn(Ai,void 0);return o({canvas:c}),Ye(()=>a.coordinates,_=>{d.value.setCoordinates(_)}),Ye(()=>a.animate,()=>{a.animate?d.value.play():d.value.pause()}),Fn(()=>{g&&(g.value.addSource(a.id,{type:"canvas",canvas:c.value,animate:a.animate||!1,coordinates:a.coordinates}),d.value=g.value.getSource(a.id))}),gr(()=>{g&&d.value&&g.value.removeSource(a.id)}),(_,s)=>(bi(),go("canvas",{style:{display:"none"},ref_key:"canvasRef",ref:c,height:"400",width:"400"},null,512))}}),IR={install:e=>{e.component("v-map",tR),e.component("v-sprite",nR),e.component("v-marker",iR),e.component("v-popup",rR),e.component("v-fog",oR),e.component("v-feature-state",sR),e.component("v-attribution-control",aR),e.component("v-navigation-control",lR),e.component("v-scale-control",cR),e.component("v-background-layer",uR),e.component("v-circle-layer",hR),e.component("v-fillextrusion-layer",dR),e.component("v-fill-layer",fR),e.component("v-heatmap-layer",pR),e.component("v-hillshade-layer",mR),e.component("v-line-layer",gR),e.component("v-raster-layer",vR),e.component("v-symbol-layer",_R),e.component("v-sky-layer",yR),e.component("v-geo-source",xR),e.component("v-vector-source",ER),e.component("v-raster-source",bR),e.component("v-rasterdem-source",wR),e.component("v-image-source",SR),e.component("v-video-source",TR),e.component("v-canvas-source",CR)}};const yy=Symbol.for("vuetify:display"),Jw={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},AR=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Jw;return va(Jw,e)};function Qw(e){return zi&&!e?window.innerWidth:0}function eE(e){return zi&&!e?window.innerHeight:0}function kR(){const e=zi?window.navigator.userAgent:"ssr";function o($){return Boolean(e.match($))}const a=o(/android/i),c=o(/iphone|ipad|ipod/i),d=o(/cordova/i),g=o(/electron/i),_=o(/chrome/i),s=o(/edge/i),w=o(/firefox/i),S=o(/opera/i),A=o(/win/i),z=o(/mac/i),L=o(/linux/i),R=o(/ssr/i);return{android:a,ios:c,cordova:d,electron:g,chrome:_,edge:s,firefox:w,opera:S,win:A,mac:z,linux:L,touch:IL,ssr:R}}function MR(e,o){const{thresholds:a,mobileBreakpoint:c}=AR(e),d=Qe(eE(o)),g=kR(),_=Ki({}),s=Qe(Qw(o));function w(){d.value=eE(),s.value=Qw()}return Vs(()=>{const S=s.value<a.sm,A=s.value<a.md&&!S,z=s.value<a.lg&&!(A||S),L=s.value<a.xl&&!(z||A||S),R=s.value<a.xxl&&!(L||z||A||S),$=s.value>=a.xxl,Z=S?"xs":A?"sm":z?"md":L?"lg":R?"xl":"xxl",de=typeof c=="number"?c:a[c],ne=g.ssr?g.android||g.ios||g.opera:s.value<de;_.xs=S,_.sm=A,_.md=z,_.lg=L,_.xl=R,_.xxl=$,_.smAndUp=!S,_.mdAndUp=!(S||A),_.lgAndUp=!(S||A||z),_.xlAndUp=!(S||A||z||L),_.smAndDown=!(z||L||R||$),_.mdAndDown=!(L||R||$),_.lgAndDown=!(R||$),_.xlAndDown=!$,_.name=Z,_.height=d.value,_.width=s.value,_.mobile=ne,_.mobileBreakpoint=c,_.platform=g,_.thresholds=a}),zi&&window.addEventListener("resize",w,{passive:!0}),{...e0(_),update:w}}function jg(){const e=cn(yy);if(!e)throw new Error("Could not find Vuetify display injection");return e}function h2(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:o,...a}=e,c=va(o,a),{aliases:d={},components:g={},directives:_={}}=c,s=EL(c.defaults),w=MR(c.display,c.ssr),S=UL(c.theme),A=YL(c.icons),z=cD(c.locale);return{install:R=>{for(const $ in _)R.directive($,_[$]);for(const $ in g)R.component($,g[$]);for(const $ in d)R.component($,zt({...d[$],name:$,aliasName:d[$].name}));if(S.install(R),R.provide(kf,s),R.provide(yy,w),R.provide(zf,S),R.provide(py,A),R.provide(hh,z),zi&&c.ssr){const{mount:$}=R;R.mount=function(){const Z=$(...arguments);return Zi(()=>w.update()),R.mount=$,Z}}Gr.reset(),R.mixin({computed:{$vuetify(){return Ki({defaults:ef.call(this,kf),display:ef.call(this,yy),theme:ef.call(this,zf),icons:ef.call(this,py),locale:ef.call(this,hh)})}}})},defaults:s,display:w,theme:S,icons:A,locale:z}}const PR="3.0.0";h2.version=PR;function ef(e){var g;var o,a;const c=this.$,d=(g=(o=c.parent)==null?void 0:o.provides)!=null?g:(a=c.vnode.appContext)==null?void 0:a.provides;if(d&&e in d)return d[e]}const zR=zt({name:"VApp",props:{...ET({fullHeight:!0}),...Kn()},setup(e,o){let{slots:a}=o;const c=wi(e),{layoutClasses:d,layoutStyles:g,getLayoutItem:_,items:s,layoutRef:w}=ST(e),{rtlClasses:S}=ba();return Mt(()=>{var A;return F("div",{ref:w,class:["v-application",c.themeClasses.value,d.value,S.value],style:g.value},[F("div",{class:"v-application__wrap"},[(A=a.default)==null?void 0:A.call(a)])])}),{getLayoutItem:_,items:s,theme:c}}});const d2=Oo("v-alert-title"),LR=["success","info","warning","error"],DR=zt({name:"VAlert",props:{border:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:mn,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>LR.includes(e)},...vr(),...ss(),...lr(),...Uc(),...xh(),...Di(),...Sn(),...Kn(),...Vo({variant:"flat"})},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=En(e,"modelValue"),d=ie(()=>{var Ee;if(e.icon!==!1)return e.type?(Ee=e.icon)!=null?Ee:`$${e.type}`:e.icon}),g=ie(()=>{var Ee;return{color:(Ee=e.color)!=null?Ee:e.type,variant:e.variant}}),{themeClasses:_}=wi(e),{colorClasses:s,colorStyles:w,variantClasses:S}=$c(g),{densityClasses:A}=qr(e),{dimensionStyles:z}=as(e),{elevationClasses:L}=Pr(e),{locationStyles:R}=jc(e),{positionClasses:$}=bh(e),{roundedClasses:Z}=er(e),{textColorClasses:de,textColorStyles:ne}=oo(St(e,"borderColor")),{t:ce}=ls(),K=ie(()=>({"aria-label":ce(e.closeLabel),onClick(Ee){c.value=!1}}));return()=>{var Ee,Y;const _e=!!(a.prepend||d.value),fe=!!(a.title||e.title),ve=!!(e.text||a.text),Se=!!(a.close||e.closable);return c.value&&F(e.tag,{class:["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${e.border===!0?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},_.value,s.value,A.value,L.value,$.value,Z.value,S.value],style:[w.value,z.value,R.value],role:"alert"},{default:()=>[Nc(!1,"v-alert"),e.border&&F("div",{key:"border",class:["v-alert__border",de.value],style:ne.value},null),_e&&F(Ti,{key:"prepend",defaults:{VIcon:{density:e.density,icon:d.value,size:e.prominent?44:28}}},{default:()=>[F("div",{class:"v-alert__prepend"},[a.prepend?a.prepend():d.value&&F(ir,null,null)])]}),F("div",{class:"v-alert__content"},[fe&&F(d2,{key:"title"},{default:()=>[a.title?a.title():e.title]}),ve&&(a.text?a.text():e.text),(Ee=a.default)==null?void 0:Ee.call(a)]),a.append&&F("div",{key:"append",class:"v-alert__append"},[a.append()]),Se&&F(Ti,{key:"close",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var be;return[F("div",{class:"v-alert__close"},[(be=(Y=a.close)==null?void 0:Y.call(a,{props:K.value}))!=null?be:F(Fi,K.value,null)])]}})]})}}});const f2=zt({name:"VMessages",props:{active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},...Ea({transition:{component:z0,leaveAbsolute:!0,group:!0}})},setup(e,o){let{slots:a}=o;const c=ie(()=>Lo(e.messages)),{textColorClasses:d,textColorStyles:g}=oo(ie(()=>e.color));return Mt(()=>F(Bs,{transition:e.transition,tag:"div",class:["v-messages",d.value],style:g.value},{default:()=>[e.active&&c.value.map((_,s)=>F("div",{class:"v-messages__message",key:`${s}-${c.value}`},[a.message?a.message({message:_}):_]))]})),{}}}),p2=Symbol.for("vuetify:form"),RR=Pn({disabled:Boolean,fastFail:Boolean,lazyValidation:Boolean,readonly:Boolean,modelValue:{type:Boolean,default:null},validateOn:{type:String,default:"input"}},"form");function BR(e){const o=En(e,"modelValue"),a=ie(()=>e.disabled),c=ie(()=>e.readonly),d=Qe(!1),g=Qe([]),_=Qe([]);async function s(){const A=[];let z=!0;_.value=[],d.value=!0;for(const L of g.value){const R=await L.validate();if(R.length>0&&(z=!1,A.push({id:L.id,errorMessages:R})),!z&&e.fastFail)break}return _.value=A,d.value=!1,{valid:z,errors:_.value}}function w(){g.value.forEach(A=>A.reset()),o.value=null}function S(){g.value.forEach(A=>A.resetValidation()),_.value=[],o.value=null}return Ye(g,()=>{let A=0,z=0;const L=[];for(const R of g.value)R.isValid===!1?(z++,L.push({id:R.id,errorMessages:R.errorMessages})):R.isValid===!0&&A++;_.value=L,o.value=z>0?!1:A===g.value.length?!0:null},{deep:!0}),Gi(p2,{register:A=>{let{id:z,validate:L,reset:R,resetValidation:$}=A;g.value.some(Z=>Z.id===z)&&Mc(`Duplicate input name "${z}"`),g.value.push({id:z,validate:L,reset:R,resetValidation:$,isValid:null,errorMessages:[]})},unregister:A=>{g.value=g.value.filter(z=>z.id!==A)},update:(A,z,L)=>{const R=g.value.find($=>$.id===A);!R||(R.isValid=z,R.errorMessages=L)},isDisabled:a,isReadonly:c,isValidating:d,items:g,validateOn:St(e,"validateOn")}),{errors:_,isDisabled:a,isReadonly:c,isValidating:d,items:g,validate:s,reset:w,resetValidation:S}}function OR(){return cn(p2,null)}const Gg=Pn({focused:Boolean},"focus");function Gc(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ya();const a=En(e,"focused"),c=ie(()=>({[`${o}--focused`]:a.value}));function d(){a.value=!0}function g(){a.value=!1}return{focusClasses:c,isFocused:a,focus:d,blur:g}}const m2=Pn({disabled:Boolean,error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:Boolean,rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...Gg()},"validation");function g2(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ya(),a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Gr();const c=En(e,"modelValue"),d=ie(()=>e.validationValue===void 0?c.value:e.validationValue),g=OR(),_=Qe([]),s=Qe(!0),w=ie(()=>!!(Lo(c.value===""?null:c.value).length||Lo(d.value===""?null:d.value).length)),S=ie(()=>!!(e.disabled||g!=null&&g.isDisabled.value)),A=ie(()=>!!(e.readonly||g!=null&&g.isReadonly.value)),z=ie(()=>e.errorMessages.length?Lo(e.errorMessages):_.value),L=ie(()=>e.error||z.value.length?!1:e.rules.length&&s.value?null:!0),R=Qe(!1),$=ie(()=>({[`${o}--error`]:L.value===!1,[`${o}--dirty`]:w.value,[`${o}--disabled`]:S.value,[`${o}--readonly`]:A.value})),Z=ie(()=>{var Ee;return(Ee=e.name)!=null?Ee:Xn(a)});Mg(()=>{g==null||g.register({id:Z.value,validate:K,reset:ne,resetValidation:ce})}),Ii(()=>{g==null||g.unregister(Z.value)});const de=ie(()=>e.validateOn||(g==null?void 0:g.validateOn.value)||"input");Fn(()=>g==null?void 0:g.update(Z.value,L.value,z.value)),Pf(()=>de.value==="input",()=>{Ye(d,()=>{if(d.value!=null)K();else if(e.focused){const Ee=Ye(()=>e.focused,Y=>{Y||K(),Ee()})}})}),Pf(()=>de.value==="blur",()=>{Ye(()=>e.focused,Ee=>{Ee||K()})}),Ye(L,()=>{g==null||g.update(Z.value,L.value,z.value)});function ne(){ce(),c.value=null}function ce(){s.value=!0,_.value=[]}async function K(){const Ee=[];R.value=!0;for(const Y of e.rules){if(Ee.length>=(e.maxErrors||1))break;const fe=await(typeof Y=="function"?Y:()=>Y)(d.value);if(fe!==!0){if(typeof fe!="string"){console.warn(`${fe} is not a valid value. Rule functions must return boolean true or a string.`);continue}Ee.push(fe)}}return _.value=Ee,R.value=!1,s.value=!1,_.value}return{errorMessages:z,isDirty:w,isDisabled:S,isReadonly:A,isPristine:s,isValid:L,isValidating:R,reset:ne,resetValidation:ce,validate:K,validationClasses:$}}function v2(e){const{t:o}=ls();function a(c){var w;let{name:d}=c;const g={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[d],_=e[`onClick:${d}`],s=_&&g?o(`$vuetify.input.${g}`,(w=e.label)!=null?w:""):void 0;return F(ir,{icon:e[`${d}Icon`],"aria-label":s,onClick:_},null)}return{InputIcon:a}}const Sa=Pn({id:String,appendIcon:mn,prependIcon:mn,hideDetails:[Boolean,String],messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:e=>["horizontal","vertical"].includes(e)},"onClick:prepend":vf,"onClick:append":vf,...vr(),...m2()},"VInput"),Us=Li()({name:"VInput",props:{...Sa()},emits:{"update:modelValue":e=>!0},setup(e,o){let{attrs:a,slots:c,emit:d}=o;const{densityClasses:g}=qr(e),{InputIcon:_}=v2(e),s=Gr(),w=ie(()=>e.id||`input-${s}`),{errorMessages:S,isDirty:A,isDisabled:z,isReadonly:L,isPristine:R,isValid:$,isValidating:Z,reset:de,resetValidation:ne,validate:ce,validationClasses:K}=g2(e,"v-input",w),Ee=ie(()=>({id:w,isDirty:A,isDisabled:z,isReadonly:L,isPristine:R,isValid:$,isValidating:Z,reset:de,resetValidation:ne,validate:ce}));return Mt(()=>{var Y,_e,fe,ve,Se;const be=!!(c.prepend||e.prependIcon),De=!!(c.append||e.appendIcon),ze=!!((Y=e.messages)!=null&&Y.length||S.value.length),Ke=!e.hideDetails||e.hideDetails==="auto"&&(ze||!!c.details);return F("div",{class:["v-input",`v-input--${e.direction}`,g.value,K.value]},[be&&F("div",{key:"prepend",class:"v-input__prepend"},[(_e=c.prepend)==null?void 0:_e.call(c,Ee.value),e.prependIcon&&F(_,{key:"prepend-icon",name:"prepend"},null)]),c.default&&F("div",{class:"v-input__control"},[(fe=c.default)==null?void 0:fe.call(c,Ee.value)]),De&&F("div",{key:"append",class:"v-input__append"},[e.appendIcon&&F(_,{key:"append-icon",name:"append"},null),(ve=c.append)==null?void 0:ve.call(c,Ee.value)]),Ke&&F("div",{class:"v-input__details"},[F(f2,{active:ze,messages:S.value.length>0?S.value:e.messages},{message:c.message}),(Se=c.details)==null?void 0:Se.call(c,Ee.value)])])}),{reset:de,resetValidation:ne,validate:ce}}});function wl(e){const o=Object.keys(Us.props).filter(a=>!oT(a));return Bo(e,o)}const Sh=zt({name:"VLabel",props:{text:String,clickable:Boolean,...Kn()},setup(e,o){let{slots:a}=o;return Mt(()=>{var c;return F("label",{class:["v-label",{"v-label--clickable":e.clickable}]},[e.text,(c=a.default)==null?void 0:c.call(a)])}),{}}});const _2=Symbol.for("vuetify:selection-control-group"),R0=Pn({color:String,disabled:Boolean,error:Boolean,id:String,inline:Boolean,falseIcon:mn,trueIcon:mn,ripple:{type:Boolean,default:!0},multiple:{type:Boolean,default:null},name:String,readonly:Boolean,modelValue:null,type:String,valueComparator:{type:Function,default:jf},...Kn(),...vr()},"VSelectionControlGroup"),y2=zt({name:"VSelectionControlGroup",props:{defaultsTarget:{type:String,default:"VSelectionControl"},...R0()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=En(e,"modelValue"),d=Gr(),g=ie(()=>e.id||`v-selection-control-group-${d}`),_=ie(()=>e.name||g.value);return Gi(_2,{modelValue:c}),sr({[e.defaultsTarget]:{color:St(e,"color"),disabled:St(e,"disabled"),density:St(e,"density"),error:St(e,"error"),inline:St(e,"inline"),modelValue:c,multiple:ie(()=>!!e.multiple||e.multiple==null&&Array.isArray(c.value)),name:_,falseIcon:St(e,"falseIcon"),trueIcon:St(e,"trueIcon"),readonly:St(e,"readonly"),ripple:St(e,"ripple"),type:St(e,"type"),valueComparator:St(e,"valueComparator")}}),Mt(()=>{var s;return F("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":e.inline}],"aria-labelled-by":e.type==="radio"?g.value:void 0,role:e.type==="radio"?"radiogroup":void 0},[(s=a.default)==null?void 0:s.call(a)])}),{}}}),qg=Pn({label:String,trueValue:null,falseValue:null,value:null,...R0()},"VSelectionControl");function FR(e){const o=cn(_2,void 0),{densityClasses:a}=qr(e),c=En(e,"modelValue"),d=ie(()=>e.trueValue!==void 0?e.trueValue:e.value!==void 0?e.value:!0),g=ie(()=>e.falseValue!==void 0?e.falseValue:!1),_=ie(()=>!!e.multiple||e.multiple==null&&Array.isArray(c.value)),s=ie({get(){const z=o?o.modelValue.value:c.value;return _.value?z.some(L=>e.valueComparator(L,d.value)):e.valueComparator(z,d.value)},set(z){if(e.readonly)return;const L=z?d.value:g.value;let R=L;_.value&&(R=z?[...Lo(c.value),L]:Lo(c.value).filter($=>!e.valueComparator($,d.value))),o?o.modelValue.value=R:c.value=R}}),{textColorClasses:w,textColorStyles:S}=oo(ie(()=>s.value&&!e.error&&!e.disabled?e.color:void 0)),A=ie(()=>s.value?e.trueIcon:e.falseIcon);return{group:o,densityClasses:a,trueValue:d,falseValue:g,model:s,textColorClasses:w,textColorStyles:S,icon:A}}const qf=Li()({name:"VSelectionControl",directives:{Ripple:bl},inheritAttrs:!1,props:qg(),emits:{"update:modelValue":e=>!0},setup(e,o){let{attrs:a,slots:c}=o;const{densityClasses:d,icon:g,model:_,textColorClasses:s,textColorStyles:w,trueValue:S}=FR(e),A=Gr(),z=ie(()=>e.id||`input-${A}`),L=Qe(!1),R=Qe(!1),$=Qe();function Z(ce){L.value=!0,(!fy||fy&&ce.target.matches(":focus-visible"))&&(R.value=!0)}function de(){L.value=!1,R.value=!1}function ne(ce){_.value=ce.target.checked}return Mt(()=>{var ce,K;const Ee=c.label?c.label({label:e.label,props:{for:z.value}}):e.label,[Y,_e]=Oc(a);return F("div",nn({class:["v-selection-control",{"v-selection-control--dirty":_.value,"v-selection-control--disabled":e.disabled,"v-selection-control--error":e.error,"v-selection-control--focused":L.value,"v-selection-control--focus-visible":R.value,"v-selection-control--inline":e.inline},d.value]},Y),[F("div",{class:["v-selection-control__wrapper",s.value],style:w.value},[(ce=c.default)==null?void 0:ce.call(c),Wi(F("div",{class:["v-selection-control__input"]},[g.value&&F(ir,{key:"icon",icon:g.value},null),F("input",nn({ref:$,checked:_.value,disabled:e.disabled,id:z.value,onBlur:de,onFocus:Z,onInput:ne,"aria-readonly":e.readonly,type:e.type,value:S.value,name:e.name,"aria-checked":e.type==="checkbox"?_.value:void 0},_e),null),(K=c.input)==null?void 0:K.call(c,{model:_,textColorClasses:s,textColorStyles:w,props:{onFocus:Z,onBlur:de,id:z.value}})]),[[mo("ripple"),e.ripple&&[!e.disabled&&!e.readonly,null,["center","circle"]]]])]),Ee&&F(Sh,{for:z.value,clickable:!0},{default:()=>[Ee]})])}),{isFocused:L,input:$}}});function x2(e){return Bo(e,Object.keys(qf.props))}const b2=Pn({indeterminate:Boolean,indeterminateIcon:{type:mn,default:"$checkboxIndeterminate"},...qg({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),Th=zt({name:"VCheckboxBtn",props:b2(),emits:{"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,o){let{slots:a}=o;const c=En(e,"indeterminate"),d=En(e,"modelValue");function g(w){c.value&&(c.value=!1)}const _=ie(()=>e.indeterminate?e.indeterminateIcon:e.falseIcon),s=ie(()=>e.indeterminate?e.indeterminateIcon:e.trueIcon);return Mt(()=>F(qf,nn(e,{modelValue:d.value,"onUpdate:modelValue":[w=>d.value=w,g],class:"v-checkbox-btn",type:"checkbox",inline:!0,falseIcon:_.value,trueIcon:s.value,"aria-checked":e.indeterminate?"mixed":void 0}),a)),{}}});function VR(e){return Bo(e,Object.keys(Th.props))}const NR=zt({name:"VCheckbox",inheritAttrs:!1,props:{...Sa(),...b2()},emits:{"update:focused":e=>!0},setup(e,o){let{attrs:a,slots:c}=o;const{isFocused:d,focus:g,blur:_}=Gc(e),s=Gr(),w=ie(()=>e.id||`checkbox-${s}`);return Mt(()=>{const[S,A]=Oc(a),[z,L]=wl(e),[R,$]=VR(e);return F(Us,nn({class:"v-checkbox"},S,z,{id:w.value,focused:d.value}),{...c,default:Z=>{let{id:de,isDisabled:ne,isReadonly:ce}=Z;return F(Th,nn(R,{id:de.value,disabled:ne.value,readonly:ce.value},A,{onFocus:g,onBlur:_}),c)}})}),{}}});const $R=Pn({start:Boolean,end:Boolean,icon:mn,image:String,...vr(),...Di(),...xa(),...Sn(),...Vo({variant:"flat"})},"VAvatar"),_l=zt({name:"VAvatar",props:$R(),setup(e,o){let{slots:a}=o;const{colorClasses:c,colorStyles:d,variantClasses:g}=$c(e),{densityClasses:_}=qr(e),{roundedClasses:s}=er(e),{sizeClasses:w,sizeStyles:S}=yh(e);return Mt(()=>{var A;return F(e.tag,{class:["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},c.value,_.value,s.value,w.value,g.value],style:[d.value,S.value]},{default:()=>[e.image?F(Eh,{key:"image",src:e.image,alt:""},null):e.icon?F(ir,{key:"icon",icon:e.icon},null):(A=a.default)==null?void 0:A.call(a),Nc(!1,"v-avatar")]})}),{}}});const w2=Symbol.for("vuetify:v-chip-group"),UR=zt({name:"VChipGroup",props:{column:Boolean,filter:Boolean,valueComparator:{type:Function,default:jf},...mh({selectedClass:"v-chip--selected"}),...Sn(),...Kn(),...Vo({variant:"tonal"})},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{themeClasses:c}=wi(e),{isSelected:d,select:g,next:_,prev:s,selected:w}=Vc(e,w2);return sr({VChip:{color:St(e,"color"),filter:St(e,"filter"),variant:St(e,"variant")}}),Mt(()=>{var S;return F(e.tag,{class:["v-chip-group",{"v-chip-group--column":e.column},c.value]},{default:()=>[(S=a.default)==null?void 0:S.call(a,{isSelected:d,select:g,next:_,prev:s,selected:w.value})]})}),{}}}),Zf=zt({name:"VChip",directives:{Ripple:bl},props:{activeClass:String,appendAvatar:String,appendIcon:mn,closable:Boolean,closeIcon:{type:mn,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:Boolean,pill:Boolean,prependAvatar:String,prependIcon:mn,ripple:{type:Boolean,default:!0},text:String,modelValue:{type:Boolean,default:!0},...vo(),...vr(),...lr(),...Fc(),...Di(),...wh(),...xa(),...Sn({tag:"span"}),...Kn(),...Vo({variant:"tonal"})},emits:{"click:close":e=>!0,"update:active":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0},setup(e,o){let{attrs:a,emit:c,slots:d}=o;const{borderClasses:g}=Fo(e),{colorClasses:_,colorStyles:s,variantClasses:w}=$c(e),{densityClasses:S}=qr(e),{elevationClasses:A}=Pr(e),{roundedClasses:z}=er(e),{sizeClasses:L}=yh(e),{themeClasses:R}=wi(e),$=En(e,"modelValue"),Z=gh(e,w2,!1),de=Gf(e,a);function ne(ce){$.value=!1,c("click:close",ce)}return()=>{var ce;const K=de.isLink.value?"a":e.tag,Ee=!!(d.append||e.appendIcon||e.appendAvatar),Y=!!(d.close||e.closable),_e=!!(d.filter||e.filter)&&Z,fe=!!(d.prepend||e.prependIcon||e.prependAvatar),ve=!Z||Z.isSelected.value,Se=!e.disabled&&(!!Z||de.isClickable.value||e.link),be=e.link?e.link:Z==null?void 0:Z.toggle;return $.value&&Wi(F(K,{class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":Se,"v-chip--filter":_e,"v-chip--pill":e.pill},R.value,g.value,ve?_.value:void 0,S.value,A.value,z.value,L.value,w.value,Z==null?void 0:Z.selectedClass.value],style:[ve?s.value:void 0],disabled:e.disabled||void 0,draggable:e.draggable,href:de.href.value,onClick:Se&&be},{default:()=>{var De;return[Nc(Se,"v-chip"),_e&&F(Ti,{key:"filter",defaults:{VIcon:{icon:e.filterIcon}}},{default:()=>[F(L0,null,{default:()=>[Wi(F("div",{class:"v-chip__filter"},[d.filter?d.filter():F(ir,null,null)]),[[$s,Z.isSelected.value]])]})]}),fe&&F(Ti,{key:"prepend",defaults:{VAvatar:{image:e.prependAvatar},VIcon:{icon:e.prependIcon}}},{default:()=>[d.prepend?F("div",{class:"v-chip__prepend"},[d.prepend()]):e.prependAvatar?F(_l,{start:!0},null):e.prependIcon?F(ir,{start:!0},null):void 0]}),(De=(ce=d.default)==null?void 0:ce.call(d,{isSelected:Z==null?void 0:Z.isSelected.value,selectedClass:Z==null?void 0:Z.selectedClass.value,select:Z==null?void 0:Z.select,toggle:Z==null?void 0:Z.toggle,value:Z==null?void 0:Z.value.value,disabled:e.disabled}))!=null?De:e.text,Ee&&F(Ti,{key:"append",defaults:{VAvatar:{image:e.appendAvatar},VIcon:{icon:e.appendIcon}}},{default:()=>[d.append?F("div",{class:"v-chip__append"},[d.append()]):e.appendAvatar?F(_l,{end:!0},null):e.appendIcon?F(ir,{end:!0},null):void 0]}),Y&&F(Ti,{key:"close",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},{default:()=>[F("div",{class:"v-chip__close",onClick:ne},[d.close?d.close():F(ir,null,null)])]})]}}),[[mo("ripple"),Se&&e.ripple,null]])}}});const E2=zt({name:"VDivider",props:{color:String,inset:Boolean,length:[Number,String],thickness:[Number,String],vertical:Boolean,...Kn()},setup(e,o){let{attrs:a}=o;const{themeClasses:c}=wi(e),{backgroundColorClasses:d,backgroundColorStyles:g}=Qi(St(e,"color")),_=ie(()=>{const s={};return e.length&&(s[e.vertical?"maxHeight":"maxWidth"]=Yt(e.length)),e.thickness&&(s[e.vertical?"borderRightWidth":"borderTopWidth"]=Yt(e.thickness)),s});return Mt(()=>F("hr",{class:[{"v-divider":!0,"v-divider--inset":e.inset,"v-divider--vertical":e.vertical},c.value,d.value],style:[_.value,g.value],"aria-orientation":!a.role||a.role==="separator"?e.vertical?"vertical":"horizontal":void 0,role:`${a.role||"separator"}`},null)),{}}}),xy=Symbol.for("vuetify:list");function S2(){const e=cn(xy,{hasPrepend:Qe(!1),updateHasPrepend:()=>null}),o={hasPrepend:Qe(!1),updateHasPrepend:a=>{a&&(o.hasPrepend.value=a)}};return Gi(xy,o),e}function T2(){return cn(xy,null)}const jR={open:e=>{let{id:o,value:a,opened:c,parents:d}=e;if(a){const g=new Set;g.add(o);let _=d.get(o);for(;_!=null;)g.add(_),_=d.get(_);return g}else return c.delete(o),c},select:()=>null},C2={open:e=>{let{id:o,value:a,opened:c,parents:d}=e;if(a){let g=d.get(o);for(c.add(o);g!=null&&g!==o;)c.add(g),g=d.get(g);return c}else c.delete(o);return c},select:()=>null},GR={open:C2.open,select:e=>{let{id:o,value:a,opened:c,parents:d}=e;if(!a)return c;const g=[];let _=d.get(o);for(;_!=null;)g.push(_),_=d.get(_);return new Set(g)}},B0=e=>{const o={select:a=>{let{id:c,value:d,selected:g}=a;if(e&&!d){const _=Array.from(g.entries()).reduce((s,w)=>{let[S,A]=w;return A==="on"?[...s,S]:s},[]);if(_.length===1&&_[0]===c)return g}return g.set(c,d?"on":"off"),g},in:(a,c,d)=>{let g=new Map;for(const _ of a||[])g=o.select({id:_,value:!0,selected:new Map(g),children:c,parents:d});return g},out:a=>{const c=[];for(const[d,g]of a.entries())g==="on"&&c.push(d);return c}};return o},I2=e=>{const o=B0(e);return{select:c=>{let{selected:d,id:g,..._}=c;const s=d.has(g)?new Map([[g,d.get(g)]]):new Map;return o.select({..._,id:g,selected:s})},in:(c,d,g)=>{let _=new Map;return c!=null&&c.length&&(_=o.in(c.slice(0,1),d,g)),_},out:(c,d,g)=>o.out(c,d,g)}},qR=e=>{const o=B0(e);return{select:c=>{let{id:d,selected:g,children:_,...s}=c;return _.has(d)?g:o.select({id:d,selected:g,children:_,...s})},in:o.in,out:o.out}},ZR=e=>{const o=I2(e);return{select:c=>{let{id:d,selected:g,children:_,...s}=c;return _.has(d)?g:o.select({id:d,selected:g,children:_,...s})},in:o.in,out:o.out}},WR=e=>{const o={select:a=>{let{id:c,value:d,selected:g,children:_,parents:s}=a;const w=new Map(g),S=[c];for(;S.length;){const z=S.shift();g.set(z,d?"on":"off"),_.has(z)&&S.push(..._.get(z))}let A=s.get(c);for(;A;){const z=_.get(A),L=z.every($=>g.get($)==="on"),R=z.every($=>!g.has($)||g.get($)==="off");g.set(A,L?"on":R?"off":"indeterminate"),A=s.get(A)}return e&&!d&&Array.from(g.entries()).reduce((L,R)=>{let[$,Z]=R;return Z==="on"?[...L,$]:L},[]).length===0?w:g},in:(a,c,d)=>{let g=new Map;for(const _ of a||[])g=o.select({id:_,value:!0,selected:new Map(g),children:c,parents:d});return g},out:(a,c)=>{const d=[];for(const[g,_]of a.entries())_==="on"&&!c.has(g)&&d.push(g);return d}};return o},Rf=Symbol.for("vuetify:nested"),A2={id:Qe(),root:{register:()=>null,unregister:()=>null,parents:Qe(new Map),children:Qe(new Map),open:()=>null,openOnSelect:()=>null,select:()=>null,opened:Qe(new Set),selected:Qe(new Map),selectedValues:Qe([])}},HR=Pn({selectStrategy:[String,Function],openStrategy:[String,Function],opened:Array,selected:Array,mandatory:Boolean},"nested"),XR=e=>{let o=!1;const a=Qe(new Map),c=Qe(new Map),d=En(e,"opened",e.opened,z=>new Set(z),z=>[...z.values()]),g=ie(()=>{if(typeof e.selectStrategy=="object")return e.selectStrategy;switch(e.selectStrategy){case"single-leaf":return ZR(e.mandatory);case"leaf":return qR(e.mandatory);case"independent":return B0(e.mandatory);case"single-independent":return I2(e.mandatory);case"classic":default:return WR(e.mandatory)}}),_=ie(()=>{if(typeof e.openStrategy=="function")return e.openStrategy;switch(e.openStrategy){case"list":return GR;case"single":return jR;case"multiple":default:return C2}}),s=En(e,"selected",e.selected,z=>g.value.in(z,a.value,c.value),z=>g.value.out(z,a.value,c.value));Ii(()=>{o=!0});function w(z){const L=[];let R=z;for(;R!=null;)L.unshift(R),R=c.value.get(R);return L}const S=Mr("nested"),A={id:Qe(),root:{opened:d,selected:s,selectedValues:ie(()=>{const z=[];for(const[L,R]of s.value.entries())R==="on"&&z.push(L);return z}),register:(z,L,R)=>{L&&z!==L&&c.value.set(z,L),R&&a.value.set(z,[]),L!=null&&a.value.set(L,[...a.value.get(L)||[],z])},unregister:z=>{var R;if(o)return;a.value.delete(z);const L=c.value.get(z);if(L){const $=(R=a.value.get(L))!=null?R:[];a.value.set(L,$.filter(Z=>Z!==z))}c.value.delete(z),d.value.delete(z)},open:(z,L,R)=>{S.emit("click:open",{id:z,value:L,path:w(z),event:R});const $=_.value.open({id:z,value:L,opened:new Set(d.value),children:a.value,parents:c.value,event:R});$&&(d.value=$)},openOnSelect:(z,L,R)=>{const $=_.value.select({id:z,value:L,selected:new Map(s.value),opened:new Set(d.value),children:a.value,parents:c.value,event:R});$&&(d.value=$)},select:(z,L,R)=>{S.emit("click:select",{id:z,value:L,path:w(z),event:R});const $=g.value.select({id:z,value:L,selected:new Map(s.value),children:a.value,parents:c.value,event:R});$&&(s.value=$),A.root.openOnSelect(z,L,R)},children:a,parents:c}};return Gi(Rf,A),A.root},k2=(e,o)=>{const a=cn(Rf,A2),c=ie(()=>{var g;return(g=e.value)!=null?g:Symbol(Gr())}),d={...a,id:c,open:(g,_)=>a.root.open(c.value,g,_),openOnSelect:(g,_)=>a.root.openOnSelect(c.value,g,_),isOpen:ie(()=>a.root.opened.value.has(c.value)),parent:ie(()=>a.root.parents.value.get(c.value)),select:(g,_)=>a.root.select(c.value,g,_),isSelected:ie(()=>a.root.selected.value.get(c.value)==="on"),isIndeterminate:ie(()=>a.root.selected.value.get(c.value)==="indeterminate"),isLeaf:ie(()=>!a.root.children.value.get(c.value)),isGroupActivator:a.isGroupActivator};return!a.isGroupActivator&&a.root.register(c.value,a.id.value,o),Ii(()=>{!a.isGroupActivator&&a.root.unregister(c.value)}),o&&Gi(Rf,d),d},YR=()=>{const e=cn(Rf,A2);Gi(Rf,{...e,isGroupActivator:!0})},KR=zt({name:"VListGroupActivator",setup(e,o){let{slots:a}=o;return YR(),()=>{var c;return(c=a.default)==null?void 0:c.call(a)}}}),JR=Pn({activeColor:String,color:String,collapseIcon:{type:mn,default:"$collapse"},expandIcon:{type:mn,default:"$expand"},prependIcon:mn,appendIcon:mn,fluid:Boolean,subgroup:Boolean,value:null,...Sn()},"VListGroup"),O0=Li()({name:"VListGroup",props:{title:String,...JR()},setup(e,o){let{slots:a}=o;const{isOpen:c,open:d,id:g}=k2(St(e,"value"),!0),_=ie(()=>`v-list-group--id-${String(g.value)}`),s=T2();function w(z){d(!c.value,z)}const S=ie(()=>({onClick:w,class:"v-list-group__header",id:_.value})),A=ie(()=>c.value?e.collapseIcon:e.expandIcon);return Mt(()=>{var z;return F(e.tag,{class:["v-list-group",{"v-list-group--prepend":s==null?void 0:s.hasPrepend.value,"v-list-group--fluid":e.fluid,"v-list-group--subgroup":e.subgroup}]},{default:()=>[a.activator&&F(Ti,{defaults:{VListItem:{active:c.value,activeColor:e.activeColor,color:e.color,prependIcon:e.prependIcon||e.subgroup&&A.value,appendIcon:e.appendIcon||!e.subgroup&&A.value,title:e.title,value:e.value}}},{default:()=>[F(KR,null,{default:()=>[a.activator({props:S.value,isOpen:c})]})]}),F($g,null,{default:()=>[Wi(F("div",{class:"v-list-group__items",role:"group","aria-labelledby":_.value},[(z=a.default)==null?void 0:z.call(a)]),[[$s,c.value]])]})]})}),{}}});function QR(e){return Bo(e,Object.keys(O0.props))}const M2=Oo("v-list-item-subtitle"),P2=Oo("v-list-item-title"),qi=Li()({name:"VListItem",directives:{Ripple:bl},props:{active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:mn,disabled:Boolean,lines:String,link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:mn,subtitle:[String,Number,Boolean],title:[String,Number,Boolean],value:null,...vo(),...vr(),...ss(),...lr(),...Di(),...wh(),...Sn(),...Kn(),...Vo({variant:"text"})},emits:{click:e=>!0},setup(e,o){let{attrs:a,slots:c,emit:d}=o;const g=Gf(e,a),_=ie(()=>{var Pe;return(Pe=e.value)!=null?Pe:g.href.value}),{select:s,isSelected:w,isIndeterminate:S,isGroupActivator:A,root:z,parent:L,openOnSelect:R}=k2(_,!1),$=T2(),Z=ie(()=>{var Pe;return e.active!==!1&&(e.active||((Pe=g.isActive)==null?void 0:Pe.value)||w.value)}),de=ie(()=>e.link!==!1&&g.isLink.value),ne=ie(()=>!e.disabled&&e.link!==!1&&(e.link||g.isClickable.value||e.value!=null&&!!$)),ce=ie(()=>e.rounded||e.nav),K=ie(()=>{var Pe;return{color:Z.value&&(Pe=e.activeColor)!=null?Pe:e.color,variant:e.variant}});Ye(()=>{var Pe;return(Pe=g.isActive)==null?void 0:Pe.value},Pe=>{Pe&&L.value!=null&&z.open(L.value,!0),Pe&&R(Pe)},{immediate:!0});const{themeClasses:Ee}=wi(e),{borderClasses:Y}=Fo(e),{colorClasses:_e,colorStyles:fe,variantClasses:ve}=$c(K),{densityClasses:Se}=qr(e),{dimensionStyles:be}=as(e),{elevationClasses:De}=Pr(e),{roundedClasses:ze}=er(ce),Ke=ie(()=>e.lines?`v-list-item--${e.lines}-line`:void 0),ct=ie(()=>({isActive:Z.value,select:s,isSelected:w.value,isIndeterminate:S.value}));function nt(Pe){var at;d("click",Pe),!(A||!ne.value)&&((at=g.navigate)==null||at.call(g,Pe),e.value!=null&&s(!w.value,Pe))}function ft(Pe){(Pe.key==="Enter"||Pe.key===" ")&&(Pe.preventDefault(),nt(Pe))}return Mt(()=>{var Pe,at,Gt,pt,Lt;const qt=de.value?"a":e.tag,Ln=!$||w.value||Z.value,kt=c.title||e.title,Je=c.subtitle||e.subtitle,bt=!!(c.append||e.appendAvatar||e.appendIcon),Tt=!!(c.prepend||e.prependAvatar||e.prependIcon);return $==null||$.updateHasPrepend(Tt),Wi(F(qt,{class:["v-list-item",{"v-list-item--active":Z.value,"v-list-item--disabled":e.disabled,"v-list-item--link":ne.value,"v-list-item--nav":e.nav,"v-list-item--prepend":!Tt&&($==null?void 0:$.hasPrepend.value),[`${e.activeClass}`]:e.activeClass&&Z.value},Ee.value,Y.value,Ln?_e.value:void 0,Se.value,De.value,Ke.value,ze.value,ve.value],style:[Ln?fe.value:void 0,be.value],href:g.href.value,tabindex:ne.value?0:void 0,onClick:nt,onKeydown:ne.value&&!de.value&&ft},{default:()=>[Nc(ne.value||Z.value,"v-list-item"),Tt&&F(Ti,{key:"prepend",defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon},VListItemAction:{start:!0}}},{default:()=>[F("div",{class:"v-list-item__prepend"},[e.prependAvatar&&F(_l,{key:"prepend-avatar"},null),e.prependIcon&&F(ir,{key:"prepend-icon"},null),(Pe=c.prepend)==null?void 0:Pe.call(c,ct.value)])]}),F("div",{class:"v-list-item__content"},[kt&&F(P2,{key:"title"},{default:()=>{var Ut;return[(Ut=(at=c.title)==null?void 0:at.call(c,{title:e.title}))!=null?Ut:e.title]}}),Je&&F(M2,{key:"subtitle"},{default:()=>{var Ut;return[(Ut=(Gt=c.subtitle)==null?void 0:Gt.call(c,{subtitle:e.subtitle}))!=null?Ut:e.subtitle]}}),(pt=c.default)==null?void 0:pt.call(c,ct.value)]),bt&&F(Ti,{key:"append",defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon},VListItemAction:{end:!0}}},{default:()=>[F("div",{class:"v-list-item__append"},[(Lt=c.append)==null?void 0:Lt.call(c,ct.value),e.appendIcon&&F(ir,{key:"append-icon"},null),e.appendAvatar&&F(_l,{key:"append-avatar"},null)])]})]}),[[mo("ripple"),ne.value]])}),{}}}),z2=zt({name:"VListSubheader",props:{color:String,inset:Boolean,sticky:Boolean,title:String,...Sn()},setup(e,o){let{slots:a}=o;const{textColorClasses:c,textColorStyles:d}=oo(St(e,"color"));return Mt(()=>{var g;const _=!!(a.default||e.title);return F(e.tag,{class:["v-list-subheader",{"v-list-subheader--inset":e.inset,"v-list-subheader--sticky":e.sticky},c.value],style:{textColorStyles:d}},{default:()=>{var s;return[_&&F("div",{class:"v-list-subheader__text"},[(s=(g=a.default)==null?void 0:g.call(a))!=null?s:e.title])]}})}),{}}}),L2=Li()({name:"VListChildren",props:{items:Array},setup(e,o){let{slots:a}=o;return S2(),()=>{var g;var c,d;return(g=(c=a.default)==null?void 0:c.call(a))!=null?g:(d=e.items)==null?void 0:d.map(_=>{var de,ne;let{children:s,props:w,type:S,raw:A}=_;if(S==="divider"){var z;return(de=(z=a.divider)==null?void 0:z.call(a,{props:w}))!=null?de:F(E2,w,null)}if(S==="subheader"){var L;return(ne=(L=a.subheader)==null?void 0:L.call(a,{props:w}))!=null?ne:F(z2,w,{default:a.subheader})}const R={subtitle:a.subtitle?ce=>{var K;return(K=a.subtitle)==null?void 0:K.call(a,{...ce,item:A})}:void 0,prepend:a.prepend?ce=>{var K;return(K=a.prepend)==null?void 0:K.call(a,{...ce,item:A})}:void 0,append:a.append?ce=>{var K;return(K=a.append)==null?void 0:K.call(a,{...ce,item:A})}:void 0,default:a.default?ce=>{var K;return(K=a.default)==null?void 0:K.call(a,{...ce,item:A})}:void 0,title:a.title?ce=>{var K;return(K=a.title)==null?void 0:K.call(a,{...ce,item:A})}:void 0},[$,Z]=QR(w);return s?F(O0,nn({value:w==null?void 0:w.value},$),{activator:ce=>{let{props:K}=ce;return a.header?a.header({...w,...K}):F(qi,nn(w,K),R)},default:()=>F(L2,{items:s},a)}):a.item?a.item(w):F(qi,w,R)})}}}),D2=Pn({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},returnObject:Boolean},"item");function nh(e,o){var s;const a=Rs(o,e.itemTitle,o),c=e.returnObject?o:Rs(o,e.itemValue,a),d=Rs(o,e.itemChildren),g=e.itemProps===!0?typeof o=="object"&&o!=null&&!Array.isArray(o)?"children"in o?Bo(o,["children"])[1]:o:void 0:Rs(o,e.itemProps),_={title:a,value:c,...g};return{title:String((s=_.title)!=null?s:""),value:_.value,props:_,children:Array.isArray(d)?R2(e,d):void 0,raw:o}}function R2(e,o){const a=[];for(const c of o)a.push(nh(e,c));return a}function F0(e){const o=ie(()=>R2(e,e.items));function a(d){return d.map(g=>nh(e,g))}function c(d){return d.map(g=>{let{props:_}=g;return _.value})}return{items:o,transformIn:a,transformOut:c}}function eB(e,o){const a=Rs(o,e.itemType,"item"),c=typeof o=="string"?o:Rs(o,e.itemTitle),d=Rs(o,e.itemValue,void 0),g=Rs(o,e.itemChildren),_=e.itemProps===!0?Bo(o,["children"])[1]:Rs(o,e.itemProps),s={title:c,value:d,..._};return{type:a,title:s.title,value:s.value,props:s,children:a==="item"&&g?B2(e,g):void 0,raw:o}}function B2(e,o){const a=[];for(const c of o)a.push(eB(e,c));return a}function tB(e){return{items:ie(()=>B2(e,e.items))}}const Ta=Li()({name:"VList",props:{activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,lines:{type:[Boolean,String],default:"one"},nav:Boolean,...HR({selectStrategy:"single-leaf",openStrategy:"list"}),...vo(),...vr(),...ss(),...lr(),itemType:{type:String,default:"type"},...D2(),...Di(),...Sn(),...Kn(),...Vo({variant:"text"})},emits:{"update:selected":e=>!0,"update:opened":e=>!0,"click:open":e=>!0,"click:select":e=>!0},setup(e,o){let{slots:a}=o;const{items:c}=tB(e),{themeClasses:d}=wi(e),{backgroundColorClasses:g,backgroundColorStyles:_}=Qi(St(e,"bgColor")),{borderClasses:s}=Fo(e),{densityClasses:w}=qr(e),{dimensionStyles:S}=as(e),{elevationClasses:A}=Pr(e),{roundedClasses:z}=er(e),{open:L,select:R}=XR(e),$=ie(()=>e.lines?`v-list--${e.lines}-line`:void 0),Z=St(e,"activeColor"),de=St(e,"color");S2(),sr({VListGroup:{activeColor:Z,color:de},VListItem:{activeClass:St(e,"activeClass"),activeColor:Z,color:de,density:St(e,"density"),disabled:St(e,"disabled"),lines:St(e,"lines"),nav:St(e,"nav"),variant:St(e,"variant")}});const ne=Qe(!1),ce=Qe();function K(ve){ne.value=!0}function Ee(ve){ne.value=!1}function Y(ve){var Se;!ne.value&&!(ve.relatedTarget&&(Se=ce.value)!=null&&Se.contains(ve.relatedTarget))&&fe()}function _e(ve){!ce.value||(ve.key==="ArrowDown"?fe("next"):ve.key==="ArrowUp"?fe("prev"):ve.key==="Home"?fe("first"):ve.key==="End"&&fe("last"))}function fe(ve){if(!ce.value)return;const Se=[...ce.value.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')].filter(ct=>!ct.hasAttribute("disabled")),be=Se.indexOf(document.activeElement);if(ve)if(ve==="first"){var ze;(ze=Se[0])==null||ze.focus()}else if(ve==="last"){var Ke;(Ke=Se.at(-1))==null||Ke.focus()}else{let ct,nt=be;const ft=ve==="next"?1:-1;do nt+=ft,ct=Se[nt];while((!ct||ct.offsetParent==null)&&nt<Se.length&&nt>=0);ct?ct.focus():fe(ve==="next"?"first":"last")}else{var De;(De=Se[0])==null||De.focus()}}return Mt(()=>F(e.tag,{ref:ce,class:["v-list",{"v-list--disabled":e.disabled,"v-list--nav":e.nav},d.value,g.value,s.value,w.value,A.value,$.value,z.value],style:[_.value,S.value],role:"listbox","aria-activedescendant":void 0,onFocusin:K,onFocusout:Ee,onFocus:Y,onKeydown:_e},{default:()=>[F(L2,{items:c.value},a)]})),{open:L,select:R,focus:fe}}}),nB=Oo("v-list-img"),iB=zt({name:"VListItemAction",props:{start:Boolean,end:Boolean,...Sn()},setup(e,o){let{slots:a}=o;return Mt(()=>F(e.tag,{class:["v-list-item-action",{"v-list-item-action--start":e.start,"v-list-item-action--end":e.end}]},a)),{}}}),rB=zt({name:"VListItemMedia",props:{start:Boolean,end:Boolean,...Sn()},setup(e,o){let{slots:a}=o;return Mt(()=>F(e.tag,{class:["v-list-item-media",{"v-list-item-media--start":e.start,"v-list-item-media--end":e.end}]},a)),{}}});const O2=Pn({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function F2(e,o){const a={},c=d=>()=>{if(!zi)return Promise.resolve(!0);const g=d==="openDelay";return a.closeDelay&&window.clearTimeout(a.closeDelay),delete a.closeDelay,a.openDelay&&window.clearTimeout(a.openDelay),delete a.openDelay,new Promise(_=>{var w;const s=parseInt((w=e[d])!=null?w:0,10);a[d]=window.setTimeout(()=>{o==null||o(g),_(g)},s)})};return{runCloseDelay:c("closeDelay"),runOpenDelay:c("openDelay")}}const by=Symbol.for("vuetify:v-menu"),oB=Pn({activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...O2()},"VOverlay/useActivator");function sB(e,o){let{isActive:a,isTop:c}=o;const d=Qe();let g=!1,_=!1,s=!0;const w=ie(()=>e.openOnFocus||e.openOnFocus==null&&e.openOnHover),S=ie(()=>e.openOnClick||e.openOnClick==null&&!e.openOnHover&&!w.value),{runOpenDelay:A,runCloseDelay:z}=F2(e,K=>{K===(e.openOnHover&&g||w.value&&_)&&!(e.openOnHover&&a.value&&!c.value)&&(a.value!==K&&(s=!0),a.value=K)}),L={click:K=>{K.stopPropagation(),d.value=K.currentTarget||K.target,a.value=!a.value},mouseenter:K=>{g=!0,d.value=K.currentTarget||K.target,A()},mouseleave:K=>{g=!1,z()},focus:K=>{fy&&!K.target.matches(":focus-visible")||(_=!0,K.stopPropagation(),d.value=K.currentTarget||K.target,A())},blur:K=>{_=!1,K.stopPropagation(),z()}},R=ie(()=>{const K={};return S.value&&(K.click=L.click),e.openOnHover&&(K.mouseenter=L.mouseenter,K.mouseleave=L.mouseleave),w.value&&(K.focus=L.focus,K.blur=L.blur),K}),$=ie(()=>{const K={};if(e.openOnHover&&(K.mouseenter=()=>{g=!0,A()},K.mouseleave=()=>{g=!1,z()}),e.closeOnContentClick){const Ee=cn(by,null);K.click=()=>{a.value=!1,Ee==null||Ee.closeParents()}}return K}),Z=ie(()=>{const K={};return e.openOnHover&&(K.mouseenter=()=>{s&&(g=!0,s=!1,A())},K.mouseleave=()=>{g=!1,z()}),K});Ye(c,K=>{K&&(e.openOnHover&&!g&&(!w.value||!_)||w.value&&!_&&(!e.openOnHover||!g))&&(a.value=!1)});const de=Qe();Vs(()=>{!de.value||Zi(()=>{const K=de.value;d.value=Qz(K)?K.$el:K})});const ne=Mr("useActivator");let ce;return Ye(()=>!!e.activator,K=>{K&&zi?(ce=Nf(),ce.run(()=>{aB(e,ne,{activatorEl:d,activatorEvents:R})})):ce&&ce.stop()},{flush:"post",immediate:!0}),{activatorEl:d,activatorRef:de,activatorEvents:R,contentEvents:$,scrimEvents:Z}}function aB(e,o,a){let{activatorEl:c,activatorEvents:d}=a;Ye(()=>e.activator,(w,S)=>{if(S&&w!==S){const A=s(S);A&&_(A)}w&&Zi(()=>g())},{immediate:!0}),Ye(()=>e.activatorProps,()=>{g()}),Dc(()=>{_()});function g(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s(),S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;!w||(Object.entries(d.value).forEach(A=>{let[z,L]=A;w.addEventListener(z,L)}),Object.keys(S).forEach(A=>{S[A]==null?w.removeAttribute(A):w.setAttribute(A,S[A])}))}function _(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s(),S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;!w||(Object.entries(d.value).forEach(A=>{let[z,L]=A;w.removeEventListener(z,L)}),Object.keys(S).forEach(A=>{w.removeAttribute(A)}))}function s(){var w;let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.activator,A;if(S)if(S==="parent"){var z,L;let R=o==null||(z=o.proxy)==null||(L=z.$el)==null?void 0:L.parentNode;for(;R.hasAttribute("data-no-activator");)R=R.parentNode;A=R}else typeof S=="string"?A=document.querySelector(S):"$el"in S?A=S.$el:A=S;return c.value=((w=A)==null?void 0:w.nodeType)===Node.ELEMENT_NODE?A:null,c.value}}const Zg=Pn({eager:Boolean},"lazy");function V0(e,o){const a=Qe(!1),c=ie(()=>a.value||e.eager||o.value);Ye(o,()=>a.value=!0);function d(){e.eager||(a.value=!1)}return{isBooted:a,hasContent:c,onAfterLeave:d}}function R_(e,o){return{x:e.x+o.x,y:e.y+o.y}}function lB(e,o){return{x:e.x-o.x,y:e.y-o.y}}function tE(e,o){if(e.side==="top"||e.side==="bottom"){const{side:a,align:c}=e,d=c==="left"?0:c==="center"?o.width/2:c==="right"?o.width:c,g=a==="top"?0:a==="bottom"?o.height:a;return R_({x:d,y:g},o)}else if(e.side==="left"||e.side==="right"){const{side:a,align:c}=e,d=a==="left"?0:a==="right"?o.width:a,g=c==="top"?0:c==="center"?o.height/2:c==="bottom"?o.height:c;return R_({x:d,y:g},o)}return R_({x:o.width/2,y:o.height/2},o)}const V2={static:hB,connected:fB},cB=Pn({locationStrategy:{type:[String,Function],default:"static",validator:e=>typeof e=="function"||e in V2},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay/locationStrategies");function uB(e,o){const a=Qe({}),c=Qe();let d;Vs(async()=>{var _;(_=d)==null||_.stop(),c.value=void 0,zi&&o.isActive.value&&e.locationStrategy&&(d=Nf(),await Zi(),d.run(()=>{if(typeof e.locationStrategy=="function"){var s;c.value=(s=e.locationStrategy(o,e,a))==null?void 0:s.updateLocation}else{var w;c.value=(w=V2[e.locationStrategy](o,e,a))==null?void 0:w.updateLocation}}))}),zi&&window.addEventListener("resize",g,{passive:!0}),Dc(()=>{var _;zi&&window.removeEventListener("resize",g),c.value=void 0,(_=d)==null||_.stop()});function g(_){var s;(s=c.value)==null||s.call(c,_)}return{contentStyles:a,updateLocation:c}}function hB(){}function dB(e){const o=g0(e);return o.x-=parseFloat(e.style.left||0),o.y-=parseFloat(e.style.top||0),o}function fB(e,o,a){const c=AL(e.activatorEl.value);c&&Object.assign(a.value,{position:"fixed"});const{preferredAnchor:d,preferredOrigin:g}=m0(()=>{const R=cy(o.location,e.isRtl.value),$=o.origin==="overlap"?R:o.origin==="auto"?k_(R):cy(o.origin,e.isRtl.value);return R.side===$.side&&R.align===M_($).align?{preferredAnchor:Mw(R),preferredOrigin:Mw($)}:{preferredAnchor:R,preferredOrigin:$}}),[_,s,w,S]=["minWidth","minHeight","maxWidth","maxHeight"].map(R=>ie(()=>{const $=parseFloat(o[R]);return isNaN($)?1/0:$})),A=ie(()=>{if(Array.isArray(o.offset))return o.offset;if(typeof o.offset=="string"){const R=o.offset.split(" ").map(parseFloat);return R.length<2&&R.push(0),R}return typeof o.offset=="number"?[o.offset,0]:[0,0]});let z=!1;if(zi){const R=new ResizeObserver(()=>{z&&L()});Ye([e.activatorEl,e.contentEl],($,Z)=>{let[de,ne]=$,[ce,K]=Z;ce&&R.unobserve(ce),de&&R.observe(de),K&&R.unobserve(K),ne&&R.observe(ne)},{immediate:!0}),Dc(()=>{R.disconnect()})}function L(){if(z=!1,requestAnimationFrame(()=>{requestAnimationFrame(()=>z=!0)}),!e.activatorEl.value||!e.contentEl.value)return;const R=e.activatorEl.value.getBoundingClientRect(),$=dB(e.contentEl.value),Z=fg(e.contentEl.value),de=12;Z.length||(Z.push(document.documentElement),e.contentEl.value.style.top&&e.contentEl.value.style.left||($.x+=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),$.y+=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const ne=Z.reduce((be,De)=>{const ze=De.getBoundingClientRect(),Ke=new sh({x:De===document.documentElement?0:ze.x,y:De===document.documentElement?0:ze.y,width:De.clientWidth,height:De.clientHeight});return be?new sh({x:Math.max(be.left,Ke.left),y:Math.max(be.top,Ke.top),width:Math.min(be.right,Ke.right)-Math.max(be.left,Ke.left),height:Math.min(be.bottom,Ke.bottom)-Math.max(be.top,Ke.top)}):Ke},void 0);ne.x+=de,ne.y+=de,ne.width-=de*2,ne.height-=de*2;let ce={anchor:d.value,origin:g.value};function K(be){const De=new sh($),ze=tE(be.anchor,R),Ke=tE(be.origin,De);let{x:ct,y:nt}=lB(ze,Ke);switch(be.anchor.side){case"top":nt-=A.value[0];break;case"bottom":nt+=A.value[0];break;case"left":ct-=A.value[0];break;case"right":ct+=A.value[0];break}switch(be.anchor.align){case"top":nt-=A.value[1];break;case"bottom":nt+=A.value[1];break;case"left":ct-=A.value[1];break;case"right":ct+=A.value[1];break}return De.x+=ct,De.y+=nt,De.width=Math.min(De.width,w.value),De.height=Math.min(De.height,S.value),{overflows:zw(De,ne),x:ct,y:nt}}let Ee=0,Y=0;const _e={x:0,y:0},fe={x:!1,y:!1};let ve=-1;for(;;){if(ve++>10){hy("Infinite loop detected in connectedLocationStrategy");break}const{x:be,y:De,overflows:ze}=K(ce);Ee+=be,Y+=De,$.x+=be,$.y+=De;{const Ke=Pw(ce.anchor),ct=ze.x.before||ze.x.after,nt=ze.y.before||ze.y.after;let ft=!1;if(["x","y"].forEach(Pe=>{if(Pe==="x"&&ct&&!fe.x||Pe==="y"&&nt&&!fe.y){const at={anchor:{...ce.anchor},origin:{...ce.origin}},Gt=Pe==="x"?Ke==="y"?M_:k_:Ke==="y"?k_:M_;at.anchor=Gt(at.anchor),at.origin=Gt(at.origin);const{overflows:pt}=K(at);(pt[Pe].before<=ze[Pe].before&&pt[Pe].after<=ze[Pe].after||pt[Pe].before+pt[Pe].after<(ze[Pe].before+ze[Pe].after)/2)&&(ce=at,ft=fe[Pe]=!0)}}),ft)continue}ze.x.before&&(Ee+=ze.x.before,$.x+=ze.x.before),ze.x.after&&(Ee-=ze.x.after,$.x-=ze.x.after),ze.y.before&&(Y+=ze.y.before,$.y+=ze.y.before),ze.y.after&&(Y-=ze.y.after,$.y-=ze.y.after);{const Ke=zw($,ne);_e.x=ne.width-Ke.x.before-Ke.x.after,_e.y=ne.height-Ke.y.before-Ke.y.after,Ee+=Ke.x.before,$.x+=Ke.x.before,Y+=Ke.y.before,$.y+=Ke.y.before}break}const Se=Pw(ce.anchor);Object.assign(a.value,{"--v-overlay-anchor-origin":`${ce.anchor.side} ${ce.anchor.align}`,transformOrigin:`${ce.origin.side} ${ce.origin.align}`,top:Yt(nE(Y)),left:Yt(nE(Ee)),minWidth:Yt(Se==="y"?Math.min(_.value,R.width):_.value),maxWidth:Yt(iE(Mo(_e.x,_.value===1/0?0:_.value,w.value))),maxHeight:Yt(iE(Mo(_e.y,s.value===1/0?0:s.value,S.value)))})}return Ye(()=>[d.value,g.value,o.offset,o.minWidth,o.minHeight,o.maxWidth,o.maxHeight],()=>L(),{immediate:!c}),c&&Zi(()=>L()),requestAnimationFrame(()=>{a.value.maxHeight&&L()}),{updateLocation:L}}function nE(e){return Math.round(e*devicePixelRatio)/devicePixelRatio}function iE(e){return Math.ceil(e*devicePixelRatio)/devicePixelRatio}let wy=!0;const _g=[];function pB(e){!wy||_g.length?(_g.push(e),Ey()):(wy=!1,e(),Ey())}let rE=-1;function Ey(){cancelAnimationFrame(rE),rE=requestAnimationFrame(()=>{const e=_g.shift();e&&e(),_g.length?Ey():wy=!0})}const Sy={none:null,close:vB,block:_B,reposition:yB},mB=Pn({scrollStrategy:{type:[String,Function],default:"block",validator:e=>typeof e=="function"||e in Sy}},"VOverlay/scrollStrategies");function gB(e,o){if(!zi)return;let a;Vs(async()=>{var c;(c=a)==null||c.stop(),o.isActive.value&&e.scrollStrategy&&(a=Nf(),await Zi(),a.run(()=>{if(typeof e.scrollStrategy=="function")e.scrollStrategy(o,e);else{var d;(d=Sy[e.scrollStrategy])==null||d.call(Sy,o,e)}}))})}function vB(e){var a;function o(c){e.isActive.value=!1}N2((a=e.activatorEl.value)!=null?a:e.contentEl.value,o)}function _B(e,o){var a;const c=(a=e.root.value)==null?void 0:a.offsetParent,d=[...new Set([...fg(e.activatorEl.value,o.contained?c:void 0),...fg(e.contentEl.value,o.contained?c:void 0)])].filter(s=>!s.classList.contains("v-overlay-scroll-blocked")),g=window.innerWidth-document.documentElement.offsetWidth,_=(s=>y0(s)&&s)(c||document.documentElement);_&&e.root.value.classList.add("v-overlay--scroll-blocked"),d.forEach((s,w)=>{s.style.setProperty("--v-body-scroll-x",Yt(-s.scrollLeft)),s.style.setProperty("--v-body-scroll-y",Yt(-s.scrollTop)),s.style.setProperty("--v-scrollbar-offset",Yt(g)),s.classList.add("v-overlay-scroll-blocked")}),Dc(()=>{d.forEach((s,w)=>{const S=parseFloat(s.style.getPropertyValue("--v-body-scroll-x")),A=parseFloat(s.style.getPropertyValue("--v-body-scroll-y"));s.style.removeProperty("--v-body-scroll-x"),s.style.removeProperty("--v-body-scroll-y"),s.style.removeProperty("--v-scrollbar-offset"),s.classList.remove("v-overlay-scroll-blocked"),s.scrollLeft=-S,s.scrollTop=-A}),_&&e.root.value.classList.remove("v-overlay--scroll-blocked")})}function yB(e){var d;let o=!1,a=-1;function c(g){pB(()=>{var _,s;const w=performance.now();(_=(s=e.updateLocation).value)==null||_.call(s,g),o=(performance.now()-w)/(1e3/60)>2})}N2((d=e.activatorEl.value)!=null?d:e.contentEl.value,g=>{o?(cancelAnimationFrame(a),a=requestAnimationFrame(()=>{a=requestAnimationFrame(()=>{c(g)})})):c(g)})}function N2(e,o){const a=[document,...fg(e)];a.forEach(c=>{c.addEventListener("scroll",o,{passive:!0})}),Dc(()=>{a.forEach(c=>{c.removeEventListener("scroll",o)})})}const oE=Symbol.for("vuetify:stack"),tf=Ki([]);function xB(e,o){const a=Mr("useStack"),c=cn(oE,void 0),d=Ki({activeChildren:new Set});Gi(oE,d);const g=Qe(+o.value);Pf(e,()=>{var w;const S=(w=tf.at(-1))==null?void 0:w[1];g.value=S?S+10:+o.value,tf.push([a.uid,g.value]),c==null||c.activeChildren.add(a.uid),Dc(()=>{const A=tf.findIndex(z=>z[0]===a.uid);tf.splice(A,1),c==null||c.activeChildren.delete(a.uid)})});const _=Qe(!0);Vs(()=>{var w;const S=((w=tf.at(-1))==null?void 0:w[0])===a.uid;setTimeout(()=>_.value=S)});const s=ie(()=>!d.activeChildren.size);return{globalTop:$f(_),localTop:s,stackStyles:ie(()=>({zIndex:g.value}))}}function _f(e){return{teleportTarget:ie(()=>{const a=e.value;if(a===!0||!zi)return;const c=a===!1?document.body:typeof a=="string"?document.querySelector(a):a;if(c==null){aM(`Unable to locate target ${a}`);return}if(!_f.cache.has(c)){const d=document.createElement("div");d.className="v-overlay-container",c.appendChild(d),_f.cache.set(c,d)}return _f.cache.get(c)})}}_f.cache=new WeakMap;function bB(){return!0}function $2(e,o,a){if(!e||U2(e,a)===!1)return!1;const c=yT(o);if(typeof ShadowRoot<"u"&&c instanceof ShadowRoot&&c.host===e.target)return!1;const d=(typeof a.value=="object"&&a.value.include||(()=>[]))();return d.push(o),!d.some(g=>g==null?void 0:g.contains(e.target))}function U2(e,o){return(typeof o.value=="object"&&o.value.closeConditional||bB)(e)}function wB(e,o,a){const c=typeof a.value=="function"?a.value:a.value.handler;o._clickOutside.lastMousedownWasOutside&&$2(e,o,a)&&setTimeout(()=>{U2(e,a)&&c&&c(e)},0)}function sE(e,o){const a=yT(e);o(document),typeof ShadowRoot<"u"&&a instanceof ShadowRoot&&o(a)}const j2={mounted(e,o){const a=d=>wB(d,e,o),c=d=>{e._clickOutside.lastMousedownWasOutside=$2(d,e,o)};sE(e,d=>{d.addEventListener("click",a,!0),d.addEventListener("mousedown",c,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!0}),e._clickOutside[o.instance.$.uid]={onClick:a,onMousedown:c}},unmounted(e,o){!e._clickOutside||(sE(e,a=>{var c;if(!a||!((c=e._clickOutside)!=null&&c[o.instance.$.uid]))return;const{onClick:d,onMousedown:g}=e._clickOutside[o.instance.$.uid];a.removeEventListener("click",d,!0),a.removeEventListener("mousedown",g,!0)}),delete e._clickOutside[o.instance.$.uid])}};function EB(e){const{modelValue:o,color:a,...c}=e;return F(Fs,{name:"fade-transition",appear:!0},{default:()=>[e.modelValue&&F("div",nn({class:["v-overlay__scrim",e.color.backgroundColorClasses.value],style:e.color.backgroundColorStyles.value},c),null)]})}const Wf=Pn({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[String,Boolean],default:!0},zIndex:{type:[Number,String],default:2e3},...oB(),...ss(),...Zg(),...cB(),...mB(),...Kn(),...Ea()},"v-overlay"),Ch=Li()({name:"VOverlay",directives:{ClickOutside:j2},inheritAttrs:!1,props:Wf(),emits:{"click:outside":e=>!0,"update:modelValue":e=>!0,afterLeave:()=>!0},setup(e,o){let{slots:a,attrs:c,emit:d}=o;const g=En(e,"modelValue"),_=ie({get:()=>g.value,set:Pe=>{Pe&&e.disabled||(g.value=Pe)}}),{teleportTarget:s}=_f(ie(()=>e.attach||e.contained)),{themeClasses:w}=wi(e),{rtlClasses:S,isRtl:A}=ba(),{hasContent:z,onAfterLeave:L}=V0(e,_),R=Qi(ie(()=>typeof e.scrim=="string"?e.scrim:null)),{globalTop:$,localTop:Z,stackStyles:de}=xB(_,St(e,"zIndex")),{activatorEl:ne,activatorRef:ce,activatorEvents:K,contentEvents:Ee,scrimEvents:Y}=sB(e,{isActive:_,isTop:Z}),{dimensionStyles:_e}=as(e);Ye(()=>e.disabled,Pe=>{Pe&&(_.value=!1)});const fe=Qe(),ve=Qe(),{contentStyles:Se,updateLocation:be}=uB(e,{isRtl:A,contentEl:ve,activatorEl:ne,isActive:_});gB(e,{root:fe,contentEl:ve,activatorEl:ne,isActive:_,updateLocation:be});function De(Pe){d("click:outside",Pe),e.persistent?ft():_.value=!1}function ze(){return _.value&&$.value}zi&&Ye(_,Pe=>{Pe?window.addEventListener("keydown",Ke):window.removeEventListener("keydown",Ke)},{immediate:!0});function Ke(Pe){Pe.key==="Escape"&&$.value&&(e.persistent?ft():_.value=!1)}const ct=$T();Pf(()=>e.closeOnBack,()=>{pD(ct,Pe=>{$.value&&_.value?(Pe(!1),e.persistent?ft():_.value=!1):Pe()})});const nt=Qe();Ye(()=>_.value&&(e.absolute||e.contained)&&s.value==null,Pe=>{if(Pe){const at=xT(fe.value);at&&at!==document.scrollingElement&&(nt.value=at.scrollTop)}});function ft(){e.noClickAnimation||ve.value&&Tc(ve.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:Mf})}return Mt(()=>{var Pe,at;return F(On,null,[(Pe=a.activator)==null?void 0:Pe.call(a,{isActive:_.value,props:nn({ref:ce},x_(K.value),e.activatorProps)}),zi&&F(JM,{disabled:!s.value,to:s.value},{default:()=>[z.value&&F("div",nn({class:["v-overlay",{"v-overlay--absolute":e.absolute||e.contained,"v-overlay--active":_.value,"v-overlay--contained":e.contained},w.value,S.value],style:[de.value,{top:Yt(nt.value)}],ref:fe},c),[F(EB,nn({color:R,modelValue:_.value&&!!e.scrim},x_(Y.value)),null),F(Bs,{appear:!0,persisted:!0,transition:e.transition,target:ne.value,onAfterLeave:()=>{L(),d("afterLeave")}},{default:()=>[Wi(F("div",nn({ref:ve,class:["v-overlay__content",e.contentClass],style:[_e.value,Se.value]},x_(Ee.value),e.contentProps),[(at=a.default)==null?void 0:at.call(a,{isActive:_})]),[[$s,_.value],[mo("click-outside"),{handler:De,closeConditional:ze,include:()=>[ne.value]}]])]})])]})])}),{activatorEl:ne,animateClick:ft,contentEl:ve,globalTop:$,localTop:Z,updateLocation:be}}});function Wg(e){return Bo(e,Object.keys(Ch.props))}const B_=Symbol("Forwarded refs");function cs(e){for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];return e[B_]=a,new Proxy(e,{get(d,g){if(Reflect.has(d,g))return Reflect.get(d,g);for(const _ of a)if(_.value&&Reflect.has(_.value,g)){const s=Reflect.get(_.value,g);return typeof s=="function"?s.bind(_.value):s}},getOwnPropertyDescriptor(d,g){const _=Reflect.getOwnPropertyDescriptor(d,g);if(_)return _;if(!(typeof g=="symbol"||g.startsWith("__"))){for(const s of a){if(!s.value)continue;const w=Reflect.getOwnPropertyDescriptor(s.value,g);if(w)return w;if("_"in s.value&&"setupState"in s.value._){const S=Reflect.getOwnPropertyDescriptor(s.value._.setupState,g);if(S)return S}}for(const s of a){let w=s.value&&Object.getPrototypeOf(s.value);for(;w;){const S=Reflect.getOwnPropertyDescriptor(w,g);if(S)return S;w=Object.getPrototypeOf(w)}}for(const s of a){const w=s.value&&s.value[B_];if(!w)continue;const S=w.slice();for(;S.length;){const A=S.shift(),z=Reflect.getOwnPropertyDescriptor(A.value,g);if(z)return z;const L=A.value&&A.value[B_];L&&S.push(...L)}}}}})}function Hg(){const o=Mr("useScopeId").vnode.scopeId;return{scopeId:o?{[o]:""}:void 0}}const Hf=Li()({name:"VMenu",props:{id:String,...Bg(Wf({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:Ng}}),["absolute"])},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=En(e,"modelValue"),{scopeId:d}=Hg(),g=Gr(),_=ie(()=>e.id||`v-menu-${g}`),s=Qe(),w=cn(by,null);let S=0;Gi(by,{register(){++S},unregister(){--S},closeParents(){setTimeout(()=>{S||(c.value=!1,w==null||w.closeParents())},40)}}),Ye(c,z=>{z?w==null||w.register():w==null||w.unregister()});function A(){w==null||w.closeParents()}return Mt(()=>{const[z]=Wg(e);return F(Ch,nn({ref:s,class:["v-menu"]},z,{modelValue:c.value,"onUpdate:modelValue":L=>c.value=L,absolute:!0,activatorProps:nn({"aria-haspopup":"menu","aria-expanded":String(c.value),"aria-owns":_.value},e.activatorProps),"onClick:outside":A},d),{activator:a.activator,default:function(){for(var L,R=arguments.length,$=new Array(R),Z=0;Z<R;Z++)$[Z]=arguments[Z];return F(Ti,{root:!0},{default:()=>[(L=a.default)==null?void 0:L.call(a,...$)]})}})}),cs({id:_},s)}});const af=zt({name:"VFieldLabel",props:{floating:Boolean},setup(e,o){let{slots:a}=o;return Mt(()=>F(Sh,{class:["v-field-label",{"v-field-label--floating":e.floating}],"aria-hidden":e.floating||void 0},a)),{}}}),SB=["underlined","outlined","filled","solo","plain"],Xg=Pn({appendInnerIcon:mn,bgColor:String,clearable:Boolean,clearIcon:{type:mn,default:"$clear"},active:Boolean,color:String,dirty:Boolean,disabled:Boolean,error:Boolean,label:String,persistentClear:Boolean,prependInnerIcon:mn,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:e=>SB.includes(e)},"onClick:clear":vf,"onClick:appendInner":vf,"onClick:prependInner":vf,...Kn(),...I0()},"v-field"),Xf=Li()({name:"VField",inheritAttrs:!1,props:{id:String,...Gg(),...Xg()},emits:{"click:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,o){let{attrs:a,emit:c,slots:d}=o;const{themeClasses:g}=wi(e),{loaderClasses:_}=Vg(e),{focusClasses:s,isFocused:w,focus:S,blur:A}=Gc(e),{InputIcon:z}=v2(e),L=ie(()=>e.dirty||e.active),R=ie(()=>!e.singleLine&&!!(e.label||d.label)),$=Gr(),Z=ie(()=>e.id||`input-${$}`),de=Qe(),ne=Qe(),ce=Qe(),{backgroundColorClasses:K,backgroundColorStyles:Ee}=Qi(St(e,"bgColor")),{textColorClasses:Y,textColorStyles:_e}=oo(ie(()=>L.value&&w.value&&!e.error&&!e.disabled?e.color:void 0));Ye(L,Se=>{if(R.value){const be=de.value.$el,De=ne.value.$el,ze=g0(be),Ke=De.getBoundingClientRect(),ct=Ke.x-ze.x,nt=Ke.y-ze.y-(ze.height/2-Ke.height/2),ft=Ke.width/.75,Pe=Math.abs(ft-ze.width)>1?{maxWidth:Yt(ft)}:void 0,at=getComputedStyle(be),Gt=getComputedStyle(De),pt=parseFloat(at.transitionDuration)*1e3||150,Lt=parseFloat(Gt.getPropertyValue("--v-field-label-scale")),qt=Gt.getPropertyValue("color");be.style.visibility="visible",De.style.visibility="hidden",Tc(be,{transform:`translate(${ct}px, ${nt}px) scale(${Lt})`,color:qt,...Pe},{duration:pt,easing:Mf,direction:Se?"normal":"reverse"}).finished.then(()=>{be.style.removeProperty("visibility"),De.style.removeProperty("visibility")})}},{flush:"post"});const fe=ie(()=>({isActive:L,isFocused:w,controlRef:ce,blur:A,focus:S}));function ve(Se){Se.target!==document.activeElement&&Se.preventDefault(),c("click:control",Se)}return Mt(()=>{var Se,be,De;const ze=e.variant==="outlined",Ke=d["prepend-inner"]||e.prependInnerIcon,ct=!!(e.clearable||d.clear),nt=!!(d["append-inner"]||e.appendInnerIcon||ct),ft=d.label?d.label({label:e.label,props:{for:Z.value}}):e.label;return F("div",nn({class:["v-field",{"v-field--active":L.value,"v-field--appended":nt,"v-field--disabled":e.disabled,"v-field--dirty":e.dirty,"v-field--error":e.error,"v-field--has-background":!!e.bgColor,"v-field--persistent-clear":e.persistentClear,"v-field--prepended":Ke,"v-field--reverse":e.reverse,"v-field--single-line":e.singleLine,"v-field--no-label":!ft,[`v-field--variant-${e.variant}`]:!0},g.value,K.value,s.value,_.value],style:[Ee.value,_e.value],onClick:ve},a),[F("div",{class:"v-field__overlay"},null),F(A0,{name:"v-field",active:e.loading,color:e.error?"error":e.color},{default:d.loader}),Ke&&F("div",{key:"prepend",class:"v-field__prepend-inner"},[e.prependInnerIcon&&F(z,{key:"prepend-icon",name:"prependInner"},null),(Se=d["prepend-inner"])==null?void 0:Se.call(d,fe.value)]),F("div",{class:"v-field__field","data-no-activator":""},[["solo","filled"].includes(e.variant)&&R.value&&F(af,{key:"floating-label",ref:ne,class:[Y.value],floating:!0,for:Z.value},{default:()=>[ft]}),F(af,{ref:de,for:Z.value},{default:()=>[ft]}),(be=d.default)==null?void 0:be.call(d,{...fe.value,props:{id:Z.value,class:"v-field__input"},focus:S,blur:A})]),ct&&F(L0,{key:"clear"},{default:()=>[Wi(F("div",{class:"v-field__clearable"},[d.clear?d.clear():F(z,{name:"clear"},null)]),[[$s,e.dirty]])]}),nt&&F("div",{key:"append",class:"v-field__append-inner"},[(De=d["append-inner"])==null?void 0:De.call(d,fe.value),e.appendInnerIcon&&F(z,{key:"append-icon",name:"appendInner"},null)]),F("div",{class:["v-field__outline",Y.value]},[ze&&F(On,null,[F("div",{class:"v-field__outline__start"},null),R.value&&F("div",{class:"v-field__outline__notch"},[F(af,{ref:ne,floating:!0,for:Z.value},{default:()=>[ft]})]),F("div",{class:"v-field__outline__end"},null)]),["plain","underlined"].includes(e.variant)&&R.value&&F(af,{ref:ne,floating:!0,for:Z.value},{default:()=>[ft]})])])}),{controlRef:ce}}});function N0(e){const o=Object.keys(Xf.props).filter(a=>!oT(a));return Bo(e,o)}const Yg=zt({name:"VCounter",functional:!0,props:{active:Boolean,max:[Number,String],value:{type:[Number,String],default:0},...Ea({transition:{component:z0}})},setup(e,o){let{slots:a}=o;const c=ie(()=>e.max?`${e.value} / ${e.max}`:String(e.value));return Mt(()=>F(Bs,{transition:e.transition},{default:()=>[Wi(F("div",{class:"v-counter"},[a.default?a.default({counter:c.value,max:e.max,value:e.value}):c.value]),[[$s,e.active]])]})),{}}}),TB=["color","file","time","date","datetime-local","week","month"],Kg=Li()({name:"VTextField",directives:{Intersect:Ug},inheritAttrs:!1,props:{autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,hint:String,persistentHint:Boolean,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,type:{type:String,default:"text"},...Sa(),...Xg()},emits:{"click:control":e=>!0,"click:input":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,o){let{attrs:a,emit:c,slots:d}=o;const g=En(e,"modelValue"),{isFocused:_,focus:s,blur:w}=Gc(e),S=ie(()=>{var Y;return typeof e.counterValue=="function"?e.counterValue(g.value):((Y=g.value)!=null?Y:"").toString().length}),A=ie(()=>{if(a.maxlength)return a.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function z(Y,_e){var fe,ve;!e.autofocus||!Y||(fe=_e[0].target)==null||(ve=fe.focus)==null||ve.call(fe)}const L=Qe(),R=Qe(),$=Qe(),Z=ie(()=>TB.includes(e.type)||e.persistentPlaceholder||_.value),de=ie(()=>e.messages.length?e.messages:_.value||e.persistentHint?e.hint:"");function ne(){if($.value!==document.activeElement){var Y;(Y=$.value)==null||Y.focus()}_.value||s()}function ce(Y){ne(),c("click:control",Y)}function K(Y){Y.stopPropagation(),ne(),Zi(()=>{g.value=null,ug(e["onClick:clear"],Y)})}function Ee(Y){g.value=Y.target.value}return Mt(()=>{const Y=!!(d.counter||e.counter||e.counterValue),_e=!!(Y||d.details),[fe,ve]=Oc(a),[{modelValue:Se,...be}]=wl(e),[De]=N0(e);return F(Us,nn({ref:L,modelValue:g.value,"onUpdate:modelValue":ze=>g.value=ze,class:["v-text-field",{"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-text-field--flush-details":["plain","underlined"].includes(e.variant)}],"onClick:prepend":e["onClick:prepend"],"onClick:append":e["onClick:append"]},fe,be,{focused:_.value,messages:de.value}),{...d,default:ze=>{let{id:Ke,isDisabled:ct,isDirty:nt,isReadonly:ft,isValid:Pe}=ze;return F(Xf,nn({ref:R,onMousedown:at=>{at.target!==$.value&&at.preventDefault()},"onClick:control":ce,"onClick:clear":K,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},De,{id:Ke.value,active:Z.value||nt.value,dirty:nt.value||e.dirty,focused:_.value,error:Pe.value===!1}),{...d,default:at=>{let{props:{class:Gt,...pt}}=at;const Lt=Wi(F("input",nn({ref:$,value:g.value,onInput:Ee,autofocus:e.autofocus,readonly:ft.value,disabled:ct.value,name:e.name,placeholder:e.placeholder,size:1,type:e.type,onFocus:ne,onBlur:w},pt,ve),null),[[mo("intersect"),{handler:z},null,{once:!0}]]);return F(On,null,[e.prefix&&F("span",{class:"v-text-field__prefix"},[e.prefix]),d.default?F("div",{class:Gt,onClick:qt=>c("click:input",qt),"data-no-activator":""},[d.default(),Lt]):ga(Lt,{class:Gt}),e.suffix&&F("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:_e?ze=>{var Ke;return F(On,null,[(Ke=d.details)==null?void 0:Ke.call(d,ze),Y&&F(On,null,[F("span",null,null),F(Yg,{active:e.persistentCounter||_.value,value:S.value,max:A.value},d.counter)])])}:void 0})}),cs({},L,R,$)}}),$0=Pn({chips:Boolean,closableChips:Boolean,eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,menu:Boolean,menuIcon:{type:mn,default:"$dropdown"},menuProps:{type:Object},modelValue:null,multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,readonly:Boolean,...D2({itemChildren:!1})},"select"),CB=Li()({name:"VSelect",props:{...$0(),...Ea({transition:{component:Ng}})},emits:{"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,o){let{slots:a}=o;const{t:c}=ls(),d=Qe(),g=En(e,"menu"),{items:_,transformIn:s,transformOut:w}=F0(e),S=En(e,"modelValue",[],K=>s(Lo(K)),K=>{var Y;const Ee=w(K);return e.multiple?Ee:(Y=Ee[0])!=null?Y:null}),A=ie(()=>S.value.map(K=>_.value.find(Ee=>Ee.value===K.value)||K)),z=ie(()=>A.value.map(K=>K.props.value)),L=Qe();function R(K){S.value=[],e.openOnClear&&(g.value=!0)}function $(){e.hideNoData&&!_.value.length||e.readonly||(g.value=!g.value)}function Z(K){if(!e.readonly){if(["Enter","ArrowDown"," "].includes(K.key)&&(g.value=!0),["Escape","Tab"].includes(K.key)&&(g.value=!1),K.key==="ArrowDown"){var Ee;(Ee=L.value)==null||Ee.focus("next")}else if(K.key==="ArrowUp"){var Y;(Y=L.value)==null||Y.focus("prev")}else if(K.key==="Home"){var _e;(_e=L.value)==null||_e.focus("first")}else if(K.key==="End"){var fe;(fe=L.value)==null||fe.focus("last")}}}function de(K){if(e.multiple){const Ee=z.value.findIndex(Y=>Y===K.value);if(Ee===-1)S.value=[...S.value,K];else{const Y=[...S.value];Y.splice(Ee,1),S.value=Y}}else S.value=[K],g.value=!1}function ne(K){var Ee;(Ee=L.value)!=null&&Ee.$el.contains(K.relatedTarget)||(g.value=!1)}function ce(K){if(K.relatedTarget==null){var Ee;(Ee=d.value)==null||Ee.focus()}}return Mt(()=>{const K=!!(e.chips||a.chip);return F(Kg,{ref:d,modelValue:S.value.map(Ee=>Ee.props.value).join(", "),"onUpdate:modelValue":Ee=>{Ee==null&&(S.value=[])},validationValue:S.externalValue,dirty:S.value.length>0,class:["v-select",{"v-select--active-menu":g.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":S.value.length}],appendInnerIcon:e.menuIcon,readonly:!0,"onClick:clear":R,"onClick:control":$,onBlur:ne,onKeydown:Z},{...a,default:()=>{var Ee,Y,_e;return F(On,null,[F(Hf,nn({modelValue:g.value,"onUpdate:modelValue":fe=>g.value=fe,activator:"parent",contentClass:"v-select__content",eager:e.eager,openOnClick:!1,closeOnContentClick:!1,transition:e.transition},e.menuProps),{default:()=>[F(Ta,{ref:L,selected:z.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:fe=>fe.preventDefault(),onFocusout:ce},{default:()=>{var fe;return[!_.value.length&&!e.hideNoData&&((fe=(Ee=a["no-data"])==null?void 0:Ee.call(a))!=null?fe:F(qi,{title:c(e.noDataText)},null)),(Y=a["prepend-item"])==null?void 0:Y.call(a),_.value.map((ve,Se)=>{var De;var be;return(De=(be=a.item)==null?void 0:be.call(a,{item:ve,index:Se,props:nn(ve.props,{onClick:()=>de(ve)})}))!=null?De:F(qi,nn({key:Se},ve.props,{onClick:()=>de(ve)}),{prepend:ze=>{let{isSelected:Ke}=ze;return e.multiple&&!e.hideSelected?F(Th,{modelValue:Ke,ripple:!1},null):void 0}})}),(_e=a["append-item"])==null?void 0:_e.call(a)]}})]}),A.value.map((fe,ve)=>{function Se(De){De.stopPropagation(),De.preventDefault(),de(fe)}const be={"onClick:close":Se,modelValue:!0,"onUpdate:modelValue":void 0};return F("div",{key:fe.value,class:"v-select__selection"},[K?F(Ti,{defaults:{VChip:{closable:e.closableChips,size:"small",text:fe.title}}},{default:()=>[a.chip?a.chip({item:fe,index:ve,props:be}):F(Zf,be,null)]}):a.selection?a.selection({item:fe,index:ve}):F("span",{class:"v-select__selection-text"},[fe.title,e.multiple&&ve<A.value.length-1&&F("span",{class:"v-select__selection-comma"},[Ds(",")])])])})])}})}),cs({menu:g,select:de},d)}}),IB=(e,o,a)=>e==null||o==null?-1:e.toString().toLocaleLowerCase().indexOf(o.toString().toLocaleLowerCase()),G2=Pn({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function AB(e,o,a){var w,S;const c=[],d=(w=a==null?void 0:a.default)!=null?w:IB,g=a!=null&&a.filterKeys?Lo(a.filterKeys):!1,_=Object.keys((S=a==null?void 0:a.customKeyFilter)!=null?S:{}).length;if(!(e!=null&&e.length))return c;e:for(let A=0;A<e.length;A++){const z=e[A],L={},R={};let $=-1;if(o&&!(a!=null&&a.noFilter)){if(typeof z=="object"){const ne=g||Object.keys(z);for(const ce of ne){var s;const K=Rs(z,ce,z),Ee=a==null||(s=a.customKeyFilter)==null?void 0:s[ce];if($=Ee?Ee(K,o,z):d(K,o,z),$!==-1&&$!==!1)Ee?L[ce]=$:R[ce]=$;else if((a==null?void 0:a.filterMode)==="every")continue e}}else $=d(z,o,z),$!==-1&&$!==!1&&(R.title=$);const Z=Object.keys(R).length,de=Object.keys(L).length;if(!Z&&!de||(a==null?void 0:a.filterMode)==="union"&&de!==_&&!Z||(a==null?void 0:a.filterMode)==="intersection"&&(de!==_||!Z))continue}c.push({index:A,matches:{...R,...L}})}return c}function q2(e,o,a){const c=ie(()=>typeof(a==null?void 0:a.value)!="string"&&typeof(a==null?void 0:a.value)!="number"?"":String(a.value));return{filteredItems:ie(()=>{const g=Xn(o);return AB(g,c.value,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}).map(s=>{let{index:w,matches:S}=s;return{item:g[w],matches:S}})})}}function kB(e,o,a){if(Array.isArray(o))throw new Error("Multiple matches is not implemented");return typeof o=="number"&&~o?F(On,null,[F("span",{class:"v-autocomplete__unmask"},[e.substr(0,o)]),F("span",{class:"v-autocomplete__mask"},[e.substr(o,a)]),F("span",{class:"v-autocomplete__unmask"},[e.substr(o+a)])]):e}const MB=Li()({name:"VAutocomplete",props:{search:String,...G2({filterKeys:["title"]}),...$0(),...Ea({transition:!1})},emits:{"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,o){let{slots:a}=o;const{t:c}=ls(),d=Qe(),g=Qe(!1),_=Qe(!0),s=En(e,"menu"),{items:w,transformIn:S,transformOut:A}=F0(e),z=En(e,"search",""),L=En(e,"modelValue",[],be=>S(Lo(be)),be=>{var ze;const De=A(be);return e.multiple?De:(ze=De[0])!=null?ze:null}),{filteredItems:R}=q2(e,w,ie(()=>_.value?void 0:z.value)),$=ie(()=>L.value.map(be=>w.value.find(De=>De.value===be.value)||be)),Z=ie(()=>$.value.map(be=>be.props.value)),de=Qe();function ne(be){L.value=[],e.openOnClear&&(s.value=!0),z.value=""}function ce(){e.hideNoData&&!w.value.length||e.readonly||(s.value=!0)}function K(be){if(!e.readonly){if(["Enter","ArrowDown"].includes(be.key)&&(s.value=!0),["Escape"].includes(be.key)&&(s.value=!1),["Enter","Escape","Tab"].includes(be.key)&&(_.value=!0),be.key==="ArrowDown"){var De;(De=de.value)==null||De.focus("next")}else if(be.key==="ArrowUp"){var ze;(ze=de.value)==null||ze.focus("prev")}}}function Ee(be){z.value=be.target.value}function Y(){g.value&&(_.value=!0)}function _e(be){g.value=!0}function fe(be){if(be.relatedTarget==null){var De;(De=d.value)==null||De.focus()}}const ve=Qe(!1);function Se(be){if(e.multiple){const De=Z.value.findIndex(ze=>ze===be.value);if(De===-1)L.value=[...L.value,be],z.value="";else{const ze=[...L.value];ze.splice(De,1),L.value=ze}}else L.value=[be],ve.value=!0,a.selection||(z.value=be.title),s.value=!1,_.value=!0,Zi(()=>ve.value=!1)}return Ye(g,be=>{var ze;if(be){var De;ve.value=!0,z.value=e.multiple||!!a.selection?"":String((ze=(De=$.value.at(-1))==null?void 0:De.props.title)!=null?ze:""),_.value=!0,Zi(()=>ve.value=!1)}else s.value=!1,z.value=""}),Ye(z,be=>{!g.value||ve.value||(be&&(s.value=!0),_.value=!be)}),Mt(()=>{const be=!!(e.chips||a.chip);return F(Kg,{ref:d,modelValue:z.value,"onUpdate:modelValue":De=>{De==null&&(L.value=[])},validationValue:L.externalValue,dirty:L.value.length>0,onInput:Ee,class:["v-autocomplete",{"v-autocomplete--active-menu":s.value,"v-autocomplete--chips":!!e.chips,[`v-autocomplete--${e.multiple?"multiple":"single"}`]:!0,"v-autocomplete--selection-slot":!!a.selection}],appendInnerIcon:e.menuIcon,readonly:e.readonly,"onClick:clear":ne,"onClick:control":ce,"onClick:input":ce,onFocus:()=>g.value=!0,onBlur:()=>g.value=!1,onKeydown:K},{...a,default:()=>{var De,ze,Ke;return F(On,null,[F(Hf,nn({modelValue:s.value,"onUpdate:modelValue":ct=>s.value=ct,activator:"parent",contentClass:"v-autocomplete__content",eager:e.eager,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:Y},e.menuProps),{default:()=>[F(Ta,{ref:de,selected:Z.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:ct=>ct.preventDefault(),onFocusin:_e,onFocusout:fe},{default:()=>{var ct;return[!R.value.length&&!e.hideNoData&&((ct=(De=a["no-data"])==null?void 0:De.call(a))!=null?ct:F(qi,{title:c(e.noDataText)},null)),(ze=a["prepend-item"])==null?void 0:ze.call(a),R.value.map((nt,ft)=>{var pt;var Pe;let{item:at,matches:Gt}=nt;return(pt=(Pe=a.item)==null?void 0:Pe.call(a,{item:at,index:ft,props:nn(at.props,{onClick:()=>Se(at)})}))!=null?pt:F(qi,nn({key:ft},at.props,{onClick:()=>Se(at)}),{prepend:Lt=>{let{isSelected:qt}=Lt;return e.multiple&&!e.hideSelected?F(Th,{modelValue:qt,ripple:!1},null):void 0},title:()=>{var qt;var Lt;return _.value?at.title:kB(at.title,Gt.title,(qt=(Lt=z.value)==null?void 0:Lt.length)!=null?qt:0)}})}),(Ke=a["append-item"])==null?void 0:Ke.call(a)]}})]}),$.value.map((ct,nt)=>{function ft(at){at.stopPropagation(),at.preventDefault(),Se(ct)}const Pe={"onClick:close":ft,modelValue:!0,"onUpdate:modelValue":void 0};return F("div",{key:ct.value,class:"v-autocomplete__selection"},[be?F(Ti,{defaults:{VChip:{closable:e.closableChips,size:"small",text:ct.title}}},{default:()=>[a.chip?a.chip({item:ct,index:nt,props:Pe}):F(Zf,Pe,null)]}):a.selection?a.selection({item:ct,index:nt}):F("span",{class:"v-autocomplete__selection-text"},[ct.title,e.multiple&&nt<$.value.length-1&&F("span",{class:"v-autocomplete__selection-comma"},[Ds(",")])])])})])}})}),cs({isFocused:g,isPristine:_,menu:s,search:z,filteredItems:R,select:Se},d)}});const PB=zt({name:"VBadge",inheritAttrs:!1,props:{bordered:Boolean,color:String,content:[Number,String],dot:Boolean,floating:Boolean,icon:mn,inline:Boolean,label:{type:String,default:"$vuetify.badge"},max:[Number,String],modelValue:{type:Boolean,default:!0},offsetX:[Number,String],offsetY:[Number,String],textColor:String,...Uc({location:"top end"}),...Di(),...Sn(),...Kn(),...Ea({transition:"scale-rotate-transition"})},setup(e,o){const{backgroundColorClasses:a,backgroundColorStyles:c}=Qi(St(e,"color")),{roundedClasses:d}=er(e),{t:g}=ls(),{textColorClasses:_,textColorStyles:s}=oo(St(e,"textColor")),{themeClasses:w}=TT(),{locationStyles:S}=jc(e,!0,A=>{var L,R;return(e.floating?e.dot?2:4:e.dot?8:12)+(["top","bottom"].includes(A)?+((L=e.offsetY)!=null?L:0):["left","right"].includes(A)?+((R=e.offsetX)!=null?R:0):0)});return Mt(()=>{var A,z,L,R;const $=Number(e.content),Z=!e.max||isNaN($)?e.content:$<=e.max?$:`${e.max}+`,[de,ne]=Bo(o.attrs,["aria-atomic","aria-label","aria-live","role","title"]);return F(e.tag,nn({class:["v-badge",{"v-badge--bordered":e.bordered,"v-badge--dot":e.dot,"v-badge--floating":e.floating,"v-badge--inline":e.inline}]},ne),{default:()=>[F("div",{class:"v-badge__wrapper"},[(A=(z=o.slots).default)==null?void 0:A.call(z),F(Bs,{transition:e.transition},{default:()=>[Wi(F("span",nn({class:["v-badge__badge",w.value,a.value,d.value,_.value],style:[c.value,s.value,e.inline?{}:S.value],"aria-atomic":"true","aria-label":g(e.label,$),"aria-live":"polite",role:"status"},de),[e.dot?void 0:o.slots.badge?(L=(R=o.slots).badge)==null?void 0:L.call(R):e.icon?F(ir,{icon:e.icon},null):Z]),[[$s,e.modelValue]])]})])]})}),{}}});const Z2=zt({name:"VBannerActions",props:{color:String,density:String},setup(e,o){let{slots:a}=o;return sr({VBtn:{color:e.color,density:e.density,variant:"text"}}),Mt(()=>{var c;return F("div",{class:"v-banner-actions"},[(c=a.default)==null?void 0:c.call(a)])}),{}}}),W2=Oo("v-banner-text"),zB=zt({name:"VBanner",props:{avatar:String,color:String,icon:mn,lines:String,stacked:Boolean,sticky:Boolean,text:String,...vo(),...vr(),...ss(),...lr(),...Uc(),...xh(),...Di(),...Sn(),...Kn()},setup(e,o){let{slots:a}=o;const{borderClasses:c}=Fo(e),{densityClasses:d}=qr(e),{mobile:g}=jg(),{dimensionStyles:_}=as(e),{elevationClasses:s}=Pr(e),{locationStyles:w}=jc(e),{positionClasses:S}=bh(e),{roundedClasses:A}=er(e),{themeClasses:z}=wi(e),L=St(e,"color"),R=St(e,"density");sr({VBannerActions:{color:L,density:R}}),Mt(()=>{var $;const Z=!!(e.text||a.text),de=!!(a.prepend||e.avatar||e.icon);return F(e.tag,{class:["v-banner",{"v-banner--stacked":e.stacked||g.value,"v-banner--sticky":e.sticky,[`v-banner--${e.lines}-line`]:!!e.lines},c.value,d.value,s.value,S.value,A.value,z.value],style:[_.value,w.value],role:"banner"},{default:()=>[de&&F(Ti,{key:"prepend",defaults:{VAvatar:{color:L.value,density:R.value,icon:e.icon,image:e.avatar}}},{default:()=>[F("div",{class:"v-banner__prepend"},[a.prepend?a.prepend():(e.avatar||e.icon)&&F(_l,null,null)])]}),F("div",{class:"v-banner__content"},[Z&&F(W2,{key:"text"},{default:()=>[a.text?a.text():e.text]}),($=a.default)==null?void 0:$.call(a)]),a.actions&&F(Z2,null,{default:()=>[a.actions()]})]})})}});const H2=Oo("v-breadcrumbs-divider","li"),X2=zt({name:"VBreadcrumbsItem",props:{active:Boolean,activeClass:String,activeColor:String,color:String,disabled:Boolean,title:String,...wh(),...Sn({tag:"li"})},setup(e,o){let{slots:a,attrs:c}=o;const d=Gf(e,c),g=ie(()=>{var S;return e.active||((S=d.isActive)==null?void 0:S.value)}),_=ie(()=>g.value?e.activeColor:e.color),{textColorClasses:s,textColorStyles:w}=oo(_);return Mt(()=>{var S;const A=d.isLink.value?"a":e.tag;return F(A,{class:["v-breadcrumbs-item",{"v-breadcrumbs-item--active":g.value,"v-breadcrumbs-item--disabled":e.disabled,"v-breadcrumbs-item--link":d.isLink.value,[`${e.activeClass}`]:g.value&&e.activeClass},s.value],style:[w.value],href:d.href.value,"aria-current":g.value?"page":void 0,onClick:d.navigate},{default:()=>{var z;return[(z=(S=a.default)==null?void 0:S.call(a))!=null?z:e.title]}})}),{}}}),LB=Li()({name:"VBreadcrumbs",props:{activeClass:String,activeColor:String,bgColor:String,color:String,disabled:Boolean,divider:{type:String,default:"/"},icon:mn,items:{type:Array,default:()=>[]},...vr(),...Di(),...Sn({tag:"ul"})},setup(e,o){let{slots:a}=o;const{backgroundColorClasses:c,backgroundColorStyles:d}=Qi(St(e,"bgColor")),{densityClasses:g}=qr(e),{roundedClasses:_}=er(e);return sr({VBreadcrumbsItem:{activeClass:St(e,"activeClass"),activeColor:St(e,"activeColor"),color:St(e,"color"),disabled:St(e,"disabled")}}),Mt(()=>{var s;const w=!!(a.prepend||e.icon);return F(e.tag,{class:["v-breadcrumbs",c.value,g.value,_.value],style:d.value},{default:()=>[w&&F(Ti,{key:"prepend",defaults:{VIcon:{icon:e.icon,start:!0}}},{default:()=>[F("div",{class:"v-breadcrumbs__prepend"},[a.prepend?a.prepend():e.icon&&F(ir,null,null)])]}),e.items.map((S,A,z)=>{var L;return F(On,null,[F(X2,nn({key:A,disabled:A>=z.length-1},typeof S=="string"?{title:S}:S),{default:a.title?()=>{var R;return(R=a.title)==null?void 0:R.call(a,{item:S,index:A})}:void 0}),A<z.length-1&&F(H2,null,{default:()=>{var R;return[(R=(L=a.divider)==null?void 0:L.call(a,{item:S,index:A}))!=null?R:e.divider]}})])}),(s=a.default)==null?void 0:s.call(a)]})}),{}}});const Y2=zt({name:"VCardActions",setup(e,o){let{slots:a}=o;return sr({VBtn:{variant:"text"}}),Mt(()=>{var c;return F("div",{class:"v-card-actions"},[(c=a.default)==null?void 0:c.call(a)])}),{}}}),K2=Oo("v-card-subtitle"),J2=Oo("v-card-title"),Q2=gn({name:"VCardItem",props:{appendAvatar:String,appendIcon:mn,prependAvatar:String,prependIcon:mn,subtitle:String,title:String,...vr()},setup(e,o){let{slots:a}=o;return Mt(()=>{var c,d,g,_,s;const w=!!(e.prependAvatar||e.prependIcon||a.prepend),S=!!(e.appendAvatar||e.appendIcon||a.append),A=!!(e.title||a.title),z=!!(e.subtitle||a.subtitle);return F("div",{class:"v-card-item"},[w&&F(Ti,{key:"prepend",defaults:{VAvatar:{density:e.density,icon:e.prependIcon,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},{default:()=>{var L;return[F("div",{class:"v-card-item__prepend"},[(L=(c=a.prepend)==null?void 0:c.call(a))!=null?L:F(_l,null,null)])]}}),F("div",{class:"v-card-item__content"},[A&&F(J2,{key:"title"},{default:()=>{var L;return[(L=(d=a.title)==null?void 0:d.call(a))!=null?L:e.title]}}),z&&F(K2,{key:"subtitle"},{default:()=>{var L;return[(L=(g=a.subtitle)==null?void 0:g.call(a))!=null?L:e.subtitle]}}),(_=a.default)==null?void 0:_.call(a)]),S&&F(Ti,{key:"append",defaults:{VAvatar:{density:e.density,icon:e.appendIcon,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},{default:()=>{var L;return[F("div",{class:"v-card-item__append"},[(L=(s=a.append)==null?void 0:s.call(a))!=null?L:F(_l,null,null)])]}})])}),{}}}),U0=Oo("v-card-text"),j0=zt({name:"VCard",directives:{Ripple:bl},props:{appendAvatar:String,appendIcon:mn,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:mn,ripple:Boolean,subtitle:String,text:String,title:String,...Kn(),...vo(),...vr(),...ss(),...lr(),...I0(),...Uc(),...xh(),...Di(),...wh(),...Sn(),...Vo({variant:"elevated"})},setup(e,o){let{attrs:a,slots:c}=o;const{themeClasses:d}=wi(e),{borderClasses:g}=Fo(e),{colorClasses:_,colorStyles:s,variantClasses:w}=$c(e),{densityClasses:S}=qr(e),{dimensionStyles:A}=as(e),{elevationClasses:z}=Pr(e),{loaderClasses:L}=Vg(e),{locationStyles:R}=jc(e),{positionClasses:$}=bh(e),{roundedClasses:Z}=er(e),de=Gf(e,a),ne=ie(()=>e.link!==!1&&de.isLink.value),ce=ie(()=>!e.disabled&&e.link!==!1&&(e.link||de.isClickable.value));return Mt(()=>{var K,Ee,Y;const _e=ne.value?"a":e.tag,fe=!!(c.title||e.title),ve=!!(c.subtitle||e.subtitle),Se=fe||ve,be=!!(c.append||e.appendAvatar||e.appendIcon),De=!!(c.prepend||e.prependAvatar||e.prependIcon),ze=!!(c.image||e.image),Ke=Se||De||be,ct=!!(c.text||e.text);return Wi(F(_e,{class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":ce.value},d.value,g.value,_.value,S.value,z.value,L.value,$.value,Z.value,w.value],style:[s.value,A.value,R.value],href:de.href.value,onClick:ce.value&&de.navigate},{default:()=>[ze&&F(Ti,{key:"image",defaults:{VImg:{cover:!0,src:e.image}}},{default:()=>{var nt;return[F("div",{class:"v-card__image"},[(nt=(K=c.image)==null?void 0:K.call(c))!=null?nt:F(Eh,null,null)])]}}),F(A0,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:c.loader}),Ke&&F(Q2,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:c.item,prepend:c.prepend,title:c.title,subtitle:c.subtitle,append:c.append}),ct&&F(U0,{key:"text"},{default:()=>{var nt;return[(nt=(Ee=c.text)==null?void 0:Ee.call(c))!=null?nt:e.text]}}),(Y=c.default)==null?void 0:Y.call(c),c.actions&&F(Y2,null,{default:c.actions}),Nc(ce.value,"v-card")]}),[[mo("ripple"),ce.value]])}),{}}});const DB=e=>{const{touchstartX:o,touchendX:a,touchstartY:c,touchendY:d}=e,g=.5,_=16;e.offsetX=a-o,e.offsetY=d-c,Math.abs(e.offsetY)<g*Math.abs(e.offsetX)&&(e.left&&a<o-_&&e.left(e),e.right&&a>o+_&&e.right(e)),Math.abs(e.offsetX)<g*Math.abs(e.offsetY)&&(e.up&&d<c-_&&e.up(e),e.down&&d>c+_&&e.down(e))};function RB(e,o){var a;const c=e.changedTouches[0];o.touchstartX=c.clientX,o.touchstartY=c.clientY,(a=o.start)==null||a.call(o,{originalEvent:e,...o})}function BB(e,o){var a;const c=e.changedTouches[0];o.touchendX=c.clientX,o.touchendY=c.clientY,(a=o.end)==null||a.call(o,{originalEvent:e,...o}),DB(o)}function OB(e,o){var a;const c=e.changedTouches[0];o.touchmoveX=c.clientX,o.touchmoveY=c.clientY,(a=o.move)==null||a.call(o,{originalEvent:e,...o})}function FB(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const o={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:a=>RB(a,o),touchend:a=>BB(a,o),touchmove:a=>OB(a,o)}}function VB(e,o){var w,S;var a;const c=o.value,d=c!=null&&c.parent?e.parentElement:e,g=(w=c==null?void 0:c.options)!=null?w:{passive:!0},_=(a=o.instance)==null?void 0:a.$.uid;if(!d||!_)return;const s=FB(o.value);d._touchHandlers=(S=d._touchHandlers)!=null?S:Object.create(null),d._touchHandlers[_]=s,iT(s).forEach(A=>{d.addEventListener(A,s[A],g)})}function NB(e,o){var a,c;const d=(a=o.value)!=null&&a.parent?e.parentElement:e,g=(c=o.instance)==null?void 0:c.$.uid;if(!(d!=null&&d._touchHandlers)||!g)return;const _=d._touchHandlers[g];iT(_).forEach(s=>{d.removeEventListener(s,_[s])}),delete d._touchHandlers[g]}const G0={mounted:VB,unmounted:NB},eC=Symbol.for("vuetify:v-window"),tC=Symbol.for("vuetify:v-window-group"),nC=Li()({name:"VWindow",directives:{Touch:G0},props:{continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{default:"force"},...Sn(),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{themeClasses:c}=wi(e),{isRtl:d}=ba(),{t:g}=ls(),_=Vc(e,tC),s=Qe(),w=ie(()=>d.value?!e.reverse:e.reverse),S=Qe(!1),A=ie(()=>{const Ee=e.direction==="vertical"?"y":"x",_e=(w.value?!S.value:S.value)?"-reverse":"";return`v-window-${Ee}${_e}-transition`}),z=Qe(0),L=Qe(void 0),R=ie(()=>_.items.value.findIndex(Ee=>_.selected.value.includes(Ee.id)));Ye(R,(Ee,Y)=>{const _e=_.items.value.length,fe=_e-1;_e<=2?S.value=Ee<Y:Ee===fe&&Y===0?S.value=!0:Ee===0&&Y===fe?S.value=!1:S.value=Ee<Y}),Gi(eC,{transition:A,isReversed:S,transitionCount:z,transitionHeight:L,rootRef:s});const $=ie(()=>e.continuous||R.value!==0),Z=ie(()=>e.continuous||R.value!==_.items.value.length-1);function de(){$.value&&_.prev()}function ne(){Z.value&&_.next()}const ce=ie(()=>{const Ee=[],Y={icon:d.value?e.nextIcon:e.prevIcon,class:`v-window__${w.value?"right":"left"}`,onClick:_.prev,ariaLabel:g("$vuetify.carousel.prev")};Ee.push($.value?a.prev?a.prev({props:Y}):F(Fi,Y,null):F("div",null,null));const _e={icon:d.value?e.prevIcon:e.nextIcon,class:`v-window__${w.value?"left":"right"}`,onClick:_.next,ariaLabel:g("$vuetify.carousel.next")};return Ee.push(Z.value?a.next?a.next({props:_e}):F(Fi,_e,null):F("div",null,null)),Ee}),K=ie(()=>e.touch===!1?e.touch:{...{left:()=>{w.value?de():ne()},right:()=>{w.value?ne():de()},start:Y=>{let{originalEvent:_e}=Y;_e.stopPropagation()}},...e.touch===!0?{}:e.touch});return Mt(()=>{var Ee,Y;return Wi(F(e.tag,{ref:s,class:["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover"},c.value]},{default:()=>[F("div",{class:"v-window__container",style:{height:L.value}},[(Ee=a.default)==null?void 0:Ee.call(a,{group:_}),e.showArrows!==!1&&F("div",{class:"v-window__controls"},[ce.value])]),(Y=a.additional)==null?void 0:Y.call(a,{group:_})]}),[[mo("touch"),K.value]])}),{group:_}}}),iC=zt({name:"VWindowItem",directives:{Touch:G0},props:{reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Fc(),...Zg()},emits:{"group:selected":e=>!0},setup(e,o){let{slots:a}=o;const c=cn(eC),d=gh(e,tC),{isBooted:g}=D0();if(!c||!d)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const _=Qe(!1),s=ie(()=>c.isReversed.value?e.reverseTransition!==!1:e.transition!==!1);function w(){!_.value||!c||(_.value=!1,c.transitionCount.value>0&&(c.transitionCount.value-=1,c.transitionCount.value===0&&(c.transitionHeight.value=void 0)))}function S(){if(!(_.value||!c)){if(_.value=!0,c.transitionCount.value===0){var $;c.transitionHeight.value=Yt(($=c.rootRef.value)==null?void 0:$.clientHeight)}c.transitionCount.value+=1}}function A(){w()}function z($){!_.value||Zi(()=>{!s.value||!_.value||!c||(c.transitionHeight.value=Yt($.clientHeight))})}const L=ie(()=>{const $=c.isReversed.value?e.reverseTransition:e.transition;return s.value?{name:typeof $!="string"?c.transition.value:$,onBeforeEnter:S,onAfterEnter:w,onEnterCancelled:A,onBeforeLeave:S,onAfterLeave:w,onLeaveCancelled:A,onEnter:z}:!1}),{hasContent:R}=V0(e,d.isSelected);return Mt(()=>{var $;return F(Bs,{transition:g.value&&L.value},{default:()=>[Wi(F("div",{class:["v-window-item",d.selectedClass.value]},[R.value&&(($=a.default)==null?void 0:$.call(a))]),[[$s,d.isSelected.value]])]})}),{}}}),$B=zt({name:"VCarousel",props:{color:String,cycle:Boolean,delimiterIcon:{type:mn,default:"$delimiter"},height:{type:[Number,String],default:500},hideDelimiters:Boolean,hideDelimiterBackground:Boolean,interval:{type:[Number,String],default:6e3,validator:e=>e>0},modelValue:null,progress:[Boolean,String],showArrows:{type:[Boolean,String],default:!0,validator:e=>typeof e=="boolean"||e==="hover"},verticalDelimiters:[Boolean,String]},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=En(e,"modelValue"),{t:d}=ls(),g=Qe();let _=-1;Ye(c,w),Ye(()=>e.interval,w),Ye(()=>e.cycle,S=>{S?w():window.clearTimeout(_)}),Fn(s);function s(){!e.cycle||!g.value||(_=window.setTimeout(g.value.group.next,+e.interval>0?+e.interval:6e3))}function w(){window.clearTimeout(_),window.requestAnimationFrame(s)}return Mt(()=>F(nC,{ref:g,modelValue:c.value,"onUpdate:modelValue":S=>c.value=S,class:["v-carousel",{"v-carousel--hide-delimiter-background":e.hideDelimiterBackground,"v-carousel--vertical-delimiters":e.verticalDelimiters}],style:{height:Yt(e.height)},continuous:!0,mandatory:"force",showArrows:e.showArrows},{default:a.default,additional:S=>{let{group:A}=S;return F(On,null,[!e.hideDelimiters&&F("div",{class:"v-carousel__controls",style:{left:e.verticalDelimiters==="left"&&e.verticalDelimiters?0:"auto",right:e.verticalDelimiters==="right"?0:"auto"}},[A.items.value.length>0&&F(Ti,{defaults:{VBtn:{color:e.color,icon:e.delimiterIcon,size:"x-small",variant:"text"}},scoped:!0},{default:()=>[A.items.value.map((z,L)=>{const R={"aria-label":d("$vuetify.carousel.ariaLabel.delimiter",L+1,A.items.value.length),class:[A.isSelected(z.id)&&"v-btn--active"],onClick:()=>A.select(z.id,!0)};return a.item?a.item({props:R,item:z}):F(Fi,nn(z,R),null)})]})]),e.progress&&F(C0,{class:"v-carousel__progress",color:typeof e.progress=="string"?e.progress:void 0,modelValue:(A.getItemIndex(c.value)+1)/A.items.value.length*100},null)])},prev:a.prev,next:a.next})),{}}}),UB=zt({name:"VCarouselItem",inheritAttrs:!1,props:{value:null},setup(e,o){let{slots:a,attrs:c}=o;Mt(()=>F(iC,{class:"v-carousel-item",value:e.value},{default:()=>[F(Eh,c,a)]}))}});const jB=Oo("v-code");const GB=zt({name:"VColorPickerCanvas",props:{color:{type:Object},disabled:Boolean,dotSize:{type:[Number,String],default:10},height:{type:[Number,String],default:150},width:{type:[Number,String],default:300}},emits:{"update:color":e=>!0,"update:position":e=>!0},setup(e,o){let{emit:a}=o;const c=Qe(!1),d=Qe(!1),g=Qe({x:0,y:0}),_=ie(()=>{const{x:$,y:Z}=g.value,de=parseInt(e.dotSize,10)/2;return{width:Yt(e.dotSize),height:Yt(e.dotSize),transform:`translate(${Yt($-de)}, ${Yt(Z-de)})`}}),s=Qe();function w($,Z,de){const{left:ne,top:ce,width:K,height:Ee}=de;g.value={x:Mo($-ne,0,K),y:Mo(Z-ce,0,Ee)}}function S($){e.disabled||!s.value||w($.clientX,$.clientY,s.value.getBoundingClientRect())}function A($){$.preventDefault(),!e.disabled&&(c.value=!0,window.addEventListener("mousemove",z),window.addEventListener("mouseup",L),window.addEventListener("touchmove",z),window.addEventListener("touchend",L))}function z($){if(e.disabled||!s.value)return;c.value=!0;const Z=nL($);w(Z.clientX,Z.clientY,s.value.getBoundingClientRect())}function L(){window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",L),window.removeEventListener("touchmove",z),window.removeEventListener("touchend",L)}Ye(g,()=>{var Ee,Y;var $,Z;if(d.value){d.value=!1;return}if(!s.value)return;const{width:de,height:ne}=s.value.getBoundingClientRect(),{x:ce,y:K}=g.value;a("update:color",{h:(Ee=($=e.color)==null?void 0:$.h)!=null?Ee:0,s:Mo(ce,0,de)/de,v:1-Mo(K,0,ne)/ne,a:(Y=(Z=e.color)==null?void 0:Z.a)!=null?Y:1})});function R(){var K;var $;if(!s.value)return;const Z=s.value,de=Z.getContext("2d");if(!de)return;const ne=de.createLinearGradient(0,0,Z.width,0);ne.addColorStop(0,"hsla(0, 0%, 100%, 1)"),ne.addColorStop(1,`hsla(${(K=($=e.color)==null?void 0:$.h)!=null?K:0}, 100%, 50%, 1)`),de.fillStyle=ne,de.fillRect(0,0,Z.width,Z.height);const ce=de.createLinearGradient(0,0,0,Z.height);ce.addColorStop(0,"hsla(0, 0%, 100%, 0)"),ce.addColorStop(1,"hsla(0, 0%, 0%, 1)"),de.fillStyle=ce,de.fillRect(0,0,Z.width,Z.height)}return Ye(()=>{var $;return($=e.color)==null?void 0:$.h},R,{immediate:!0}),Ye(()=>e.color,()=>{if(c.value){c.value=!1;return}!e.color||(d.value=!0,g.value={x:e.color.s*parseInt(e.width,10),y:(1-e.color.v)*parseInt(e.height,10)})},{deep:!0,immediate:!0}),Fn(()=>R()),Mt(()=>F("div",{class:"v-color-picker-canvas",style:{width:Yt(e.width),height:Yt(e.height)},onClick:S,onMousedown:A,onTouchstart:A},[F("canvas",{ref:s,width:e.width,height:e.height},null),F("div",{class:["v-color-picker-canvas__dot",{"v-color-picker-canvas__dot--disabled":e.disabled}],style:_.value},null)])),{}}});var aE;function Cc(e,o){return o.every(a=>e.hasOwnProperty(a))}function rC(e){var a;if(!e)return null;let o=null;if(typeof e=="string"){const c=_L(e);o=pT(c)}return typeof e=="object"&&(Cc(e,["r","g","b"])?o=_0(e):Cc(e,["h","s","l"])?o=dT(e):Cc(e,["h","s","v"])&&(o=e)),o!=null?{...o,a:(a=o.a)!=null?a:1}:null}function qB(e,o){if(o){const{a,...c}=e;return c}return e}function ZB(e,o){if(o==null||typeof o=="string"){const a=mT(e);return e.a===1?a.slice(0,7):a}if(typeof o=="object"){let a;return Cc(o,["r","g","b"])?a=Og(e):Cc(o,["h","s","l"])?a=hT(e):Cc(o,["h","s","v"])&&(a=e),qB(a,!Cc(o,["a"]))}return e}const Jm={h:0,s:0,v:1,a:1},Ty={inputProps:{type:"number",min:0},inputs:[{label:"R",max:255,step:1,getValue:e=>Math.round(e.r),getColor:(e,o)=>({...e,r:Number(o)})},{label:"G",max:255,step:1,getValue:e=>Math.round(e.g),getColor:(e,o)=>({...e,g:Number(o)})},{label:"B",max:255,step:1,getValue:e=>Math.round(e.b),getColor:(e,o)=>({...e,b:Number(o)})},{label:"A",max:1,step:.01,getValue:e=>Math.round(e.a*100)/100,getColor:(e,o)=>({...e,a:Number(o)})}],to:Og,from:_0},WB={...Ty,inputs:(aE=Ty.inputs)==null?void 0:aE.slice(0,3)},Cy={inputProps:{type:"number",min:0},inputs:[{label:"H",max:360,step:1,getValue:e=>Math.round(e.h),getColor:(e,o)=>({...e,h:Number(o)})},{label:"S",max:1,step:.01,getValue:e=>Math.round(e.s*100)/100,getColor:(e,o)=>({...e,s:Number(o)})},{label:"L",max:1,step:.01,getValue:e=>Math.round(e.l*100)/100,getColor:(e,o)=>({...e,l:Number(o)})},{label:"A",max:1,step:.01,getValue:e=>Math.round(e.a*100)/100,getColor:(e,o)=>({...e,a:Number(o)})}],to:hT,from:dT},HB={...Cy,inputs:Cy.inputs.slice(0,3)},oC={inputProps:{type:"text"},inputs:[{label:"HEXA",getValue:e=>e,getColor:(e,o)=>o}],to:mT,from:pT},XB={...oC,inputs:[{label:"HEX",getValue:e=>e.slice(0,7),getColor:(e,o)=>o}]},Ic={rgb:WB,rgba:Ty,hsl:HB,hsla:Cy,hex:XB,hexa:oC},YB=e=>{let{label:o,...a}=e;return F("div",{class:"v-color-picker-edit__input"},[F("input",a,null),F("span",null,[o])])},KB=zt({name:"VColorPickerEdit",props:{color:Object,disabled:Boolean,mode:{type:String,default:"rgba",validator:e=>Object.keys(Ic).includes(e)},modes:{type:Array,default:()=>Object.keys(Ic),validator:e=>Array.isArray(e)&&e.every(o=>Object.keys(Ic).includes(o))}},emits:{"update:color":e=>!0,"update:mode":e=>!0},setup(e,o){let{emit:a}=o;const c=ie(()=>e.modes.map(g=>({...Ic[g],name:g}))),d=ie(()=>{var g;const _=c.value.find(w=>w.name===e.mode);if(!_)return[];const s=e.color?_.to(e.color):{};return(g=_.inputs)==null?void 0:g.map(w=>{let{getValue:S,getColor:A,...z}=w;return{..._.inputProps,...z,disabled:e.disabled,value:S(s),onChange:L=>{const R=L.target;!R||a("update:color",_.from(A(s,R.value)))}}})});return Mt(()=>{var g;return F("div",{class:"v-color-picker-edit"},[(g=d.value)==null?void 0:g.map(_=>F(YB,_,null)),c.value.length>1&&F(Fi,{icon:"$unfold",size:"x-small",variant:"plain",onClick:()=>{const _=c.value.findIndex(s=>s.name===e.mode);a("update:mode",c.value[(_+1)%c.value.length].name)}},null)])}),{}}});const q0=Symbol.for("vuetify:v-slider");function Iy(e,o,a){const c=a==="vertical",d=o.getBoundingClientRect(),g="touches"in e?e.touches[0]:e;return c?g.clientY-(d.top+d.height/2):g.clientX-(d.left+d.width/2)}function JB(e,o){return"touches"in e&&e.touches.length?e.touches[0][o]:"changedTouches"in e&&e.changedTouches.length?e.changedTouches[0][o]:e[o]}const sC=Pn({disabled:Boolean,error:Boolean,readonly:Boolean,max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:0},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:e=>typeof e=="boolean"||e==="always"},thumbSize:{type:[Number,String],default:20},showTicks:{type:[Boolean,String],default:!1,validator:e=>typeof e=="boolean"||e==="always"},ticks:{type:[Array,Object]},tickSize:{type:[Number,String],default:2},color:String,trackColor:String,trackFillColor:String,trackSize:{type:[Number,String],default:4},direction:{type:String,default:"horizontal",validator:e=>["vertical","horizontal"].includes(e)},reverse:Boolean,...Di(),...lr({elevation:2})},"slider"),aC=e=>{let{props:o,handleSliderMouseUp:a,handleMouseMove:c,getActiveThumb:d}=e;const{isRtl:g}=ba(),_=ie(()=>g.value!==o.reverse),s=ie(()=>{let kt=g.value?"rtl":"ltr";return o.reverse&&(kt=kt==="rtl"?"ltr":"rtl"),kt}),w=ie(()=>parseFloat(o.min)),S=ie(()=>parseFloat(o.max)),A=ie(()=>o.step>0?parseFloat(o.step):0),z=ie(()=>{const kt=A.value.toString().trim();return kt.includes(".")?kt.length-kt.indexOf(".")-1:0}),L=ie(()=>parseInt(o.thumbSize,10)),R=ie(()=>parseInt(o.tickSize,10)),$=ie(()=>parseInt(o.trackSize,10)),Z=ie(()=>(S.value-w.value)/A.value),de=St(o,"disabled"),ne=ie(()=>o.direction==="vertical"),ce=ie(()=>{var kt;return o.error||o.disabled?void 0:(kt=o.thumbColor)!=null?kt:o.color}),K=ie(()=>{var kt;return o.error||o.disabled?void 0:(kt=o.trackColor)!=null?kt:o.color}),Ee=ie(()=>{var kt;return o.error||o.disabled?void 0:(kt=o.trackFillColor)!=null?kt:o.color}),Y=Qe(!1),_e=Qe(0),fe=Qe(),ve=Qe();function Se(kt){if(A.value<=0)return kt;const Je=Mo(kt,w.value,S.value),bt=w.value%A.value,Tt=Math.round((Je-bt)/A.value)*A.value+bt;return parseFloat(Math.min(Tt,S.value).toFixed(z.value))}function be(kt){var Je;const bt=o.direction==="vertical",Tt=bt?"top":"left",Ut=bt?"height":"width",pn=bt?"clientY":"clientX",{[Tt]:Dn,[Ut]:_n}=(Je=fe.value)==null?void 0:Je.$el.getBoundingClientRect(),he=JB(kt,pn);let Me=Math.min(Math.max((he-Dn-_e.value)/_n,0),1)||0;return(bt||_.value)&&(Me=1-Me),Se(w.value+Me*(S.value-w.value))}let De=!1;const ze=kt=>{De||(_e.value=0,a(be(kt))),Y.value=!1,De=!1,_e.value=0},Ke=kt=>{ve.value=d(kt),ve.value&&(ve.value.focus(),Y.value=!0,ve.value.contains(kt.target)?(De=!0,_e.value=Iy(kt,ve.value,o.direction)):(_e.value=0,c(be(kt))))},ct={passive:!0,capture:!0};function nt(kt){De=!0,c(be(kt))}function ft(kt){kt.stopPropagation(),kt.preventDefault(),ze(kt),window.removeEventListener("mousemove",nt,ct),window.removeEventListener("mouseup",ft)}function Pe(kt){var Je;ze(kt),window.removeEventListener("touchmove",nt,ct),(Je=kt.target)==null||Je.removeEventListener("touchend",Pe)}function at(kt){var Je;Ke(kt),window.addEventListener("touchmove",nt,ct),(Je=kt.target)==null||Je.addEventListener("touchend",Pe,{passive:!1})}function Gt(kt){kt.preventDefault(),Ke(kt),window.addEventListener("mousemove",nt,ct),window.addEventListener("mouseup",ft,{passive:!1})}const pt=kt=>{const Je=(kt-w.value)/(S.value-w.value)*100;return Mo(isNaN(Je)?0:Je,0,100)},Lt=ie(()=>o.ticks?Array.isArray(o.ticks)?o.ticks.map(kt=>({value:kt,position:pt(kt),label:kt.toString()})):Object.keys(o.ticks).map(kt=>({value:parseFloat(kt),position:pt(parseFloat(kt)),label:o.ticks[kt]})):Z.value!==1/0?Sc(Z.value+1).map(kt=>{const Je=w.value+kt*A.value;return{value:Je,position:pt(Je)}}):[]),qt=ie(()=>Lt.value.some(kt=>{let{label:Je}=kt;return!!Je})),Ln={activeThumbRef:ve,color:St(o,"color"),decimals:z,disabled:de,direction:St(o,"direction"),elevation:St(o,"elevation"),hasLabels:qt,horizontalDirection:s,isReversed:_,min:w,max:S,mousePressed:Y,numTicks:Z,onSliderMousedown:Gt,onSliderTouchstart:at,parsedTicks:Lt,parseMouseMove:be,position:pt,readonly:St(o,"readonly"),rounded:St(o,"rounded"),roundValue:Se,showTicks:St(o,"showTicks"),startOffset:_e,step:A,thumbSize:L,thumbColor:ce,thumbLabel:St(o,"thumbLabel"),ticks:St(o,"ticks"),tickSize:R,trackColor:K,trackContainerRef:fe,trackFillColor:Ee,trackSize:$,vertical:ne};return Gi(q0,Ln),Ln},Ay=zt({name:"VSliderThumb",directives:{Ripple:bl},props:{focused:Boolean,max:{type:Number,required:!0},min:{type:Number,required:!0},modelValue:{type:Number,required:!0},position:{type:Number,required:!0}},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a,emit:c}=o;const d=cn(q0);if(!d)throw new Error("[Vuetify] v-slider-thumb must be used inside v-slider or v-range-slider");const{thumbColor:g,step:_,vertical:s,disabled:w,thumbSize:S,thumbLabel:A,direction:z,readonly:L,elevation:R,isReversed:$,horizontalDirection:Z,mousePressed:de,decimals:ne}=d,{textColorClasses:ce,textColorStyles:K}=oo(g),{pageup:Ee,pagedown:Y,end:_e,home:fe,left:ve,right:Se,down:be,up:De}=ly,ze=[Ee,Y,_e,fe,ve,Se,be,De],Ke=ie(()=>_.value?[1,2,3]:[1,5,10]);function ct(ft,Pe){if(!ze.includes(ft.key))return;ft.preventDefault();const at=_.value||.1,Gt=(e.max-e.min)/at;if([ve,Se,be,De].includes(ft.key)){const Lt=($.value?[ve,De]:[Se,De]).includes(ft.key)?1:-1,qt=ft.shiftKey?2:ft.ctrlKey?1:0;Pe=Pe+Lt*at*Ke.value[qt]}else if(ft.key===fe)Pe=e.min;else if(ft.key===_e)Pe=e.max;else{const pt=ft.key===Y?1:-1;Pe=Pe-pt*at*(Gt>100?Gt/10:10)}return Math.max(e.min,Math.min(e.max,Pe))}function nt(ft){const Pe=ct(ft,e.modelValue);Pe!=null&&c("update:modelValue",Pe)}return Mt(()=>{var ft;const Pe=Yt(s.value?100-e.position:e.position,"%"),at=s.value?"block":"inline",{elevationClasses:Gt}=Pr(ie(()=>w.value?void 0:R.value));return F("div",{class:["v-slider-thumb",{"v-slider-thumb--focused":e.focused,"v-slider-thumb--pressed":e.focused&&de.value}],style:{[`inset-${at}-start`]:`calc(${Pe} - var(--v-slider-thumb-size) / 2)`,"--v-slider-thumb-size":Yt(S.value),direction:s.value?void 0:Z.value},role:"slider",tabindex:w.value?-1:0,"aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.modelValue,"aria-readonly":L.value,"aria-orientation":z.value,onKeydown:L.value?void 0:nt},[F("div",{class:["v-slider-thumb__surface",ce.value,Gt.value],style:{...K.value}},null),Wi(F("div",{class:["v-slider-thumb__ripple",ce.value],style:K.value},null),[[mo("ripple"),!0,null,{circle:!0,center:!0}]]),F(e2,{origin:"bottom center"},{default:()=>{var pt;return[Wi(F("div",{class:"v-slider-thumb__label-container"},[F("div",{class:["v-slider-thumb__label"]},[F("div",null,[(pt=(ft=a["thumb-label"])==null?void 0:ft.call(a,{modelValue:e.modelValue}))!=null?pt:e.modelValue.toFixed(_.value?ne.value:1)])])]),[[$s,A.value&&e.focused||A.value==="always"]])]}})])}),{}}});const lC=zt({name:"VSliderTrack",props:{start:{type:Number,required:!0},stop:{type:Number,required:!0}},emits:{},setup(e,o){let{slots:a}=o;const c=cn(q0);if(!c)throw new Error("[Vuetify] v-slider-track must be inside v-slider or v-range-slider");const{color:d,horizontalDirection:g,parsedTicks:_,rounded:s,showTicks:w,tickSize:S,trackColor:A,trackFillColor:z,trackSize:L,vertical:R,min:$,max:Z}=c,{roundedClasses:de}=er(s),{backgroundColorClasses:ne,backgroundColorStyles:ce}=Qi(z),{backgroundColorClasses:K,backgroundColorStyles:Ee}=Qi(A),Y=ie(()=>`inset-${R.value?"block-end":"inline-start"}`),_e=ie(()=>R.value?"height":"width"),fe=ie(()=>({[Y.value]:"0%",[_e.value]:"100%"})),ve=ie(()=>e.stop-e.start),Se=ie(()=>({[Y.value]:Yt(e.start,"%"),[_e.value]:Yt(ve.value,"%")})),be=ie(()=>(R.value?_.value.slice().reverse():_.value).map((ze,Ke)=>{var Pe;var ct;const nt=R.value?"bottom":"margin-inline-start",ft=ze.value!==$.value&&ze.value!==Z.value?Yt(ze.position,"%"):void 0;return F("div",{key:ze.value,class:["v-slider-track__tick",{"v-slider-track__tick--filled":ze.position>=e.start&&ze.position<=e.stop,"v-slider-track__tick--first":ze.value===$.value,"v-slider-track__tick--last":ze.value===Z.value}],style:{[nt]:ft}},[(ze.label||a["tick-label"])&&F("div",{class:"v-slider-track__tick-label"},[(Pe=(ct=a["tick-label"])==null?void 0:ct.call(a,{tick:ze,index:Ke}))!=null?Pe:ze.label])])}));return Mt(()=>F("div",{class:["v-slider-track",de.value],style:{"--v-slider-track-size":Yt(L.value),"--v-slider-tick-size":Yt(S.value),direction:R.value?void 0:g.value}},[F("div",{class:["v-slider-track__background",K.value,{"v-slider-track__background--opacity":!!d.value||!z.value}],style:{...fe.value,...Ee.value}},null),F("div",{class:["v-slider-track__fill",ne.value],style:{...Se.value,...ce.value}},null),w.value&&F("div",{class:["v-slider-track__ticks",{"v-slider-track__ticks--always-show":w.value==="always"}]},[be.value])])),{}}}),yg=zt({name:"VSlider",props:{...Gg(),...sC(),...Sa(),modelValue:{type:[Number,String],default:0}},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=Qe(),{min:d,max:g,mousePressed:_,roundValue:s,onSliderMousedown:w,onSliderTouchstart:S,trackContainerRef:A,position:z,hasLabels:L,readonly:R}=aC({props:e,handleSliderMouseUp:K=>$.value=s(K),handleMouseMove:K=>$.value=s(K),getActiveThumb:()=>{var K;return(K=c.value)==null?void 0:K.$el}}),$=En(e,"modelValue",void 0,K=>{const Ee=typeof K=="string"?parseFloat(K):K==null?d.value:K;return s(Ee)}),{isFocused:Z,focus:de,blur:ne}=Gc(e),ce=ie(()=>z($.value));return Mt(()=>{const[K,Ee]=wl(e),Y=!!(e.label||a.label||a.prepend);return F(Us,nn({class:["v-slider",{"v-slider--has-labels":!!a["tick-label"]||L.value,"v-slider--focused":Z.value,"v-slider--pressed":_.value,"v-slider--disabled":e.disabled}]},K,{focused:Z.value}),{...a,prepend:Y?_e=>{var Se;var fe,ve;return F(On,null,[((Se=(fe=a.label)==null?void 0:fe.call(a,_e))!=null?Se:e.label)?F(Sh,{class:"v-slider__label",text:e.label},null):void 0,(ve=a.prepend)==null?void 0:ve.call(a,_e)])}:void 0,default:_e=>{let{id:fe}=_e;return F("div",{class:"v-slider__container",onMousedown:R.value?void 0:w,onTouchstartPassive:R.value?void 0:S},[F("input",{id:fe.value,name:e.name||fe.value,disabled:e.disabled,readonly:e.readonly,tabindex:"-1",value:$.value},null),F(lC,{ref:A,start:0,stop:ce.value},{"tick-label":a["tick-label"]}),F(Ay,{ref:c,focused:Z.value,min:d.value,max:g.value,modelValue:$.value,"onUpdate:modelValue":ve=>$.value=ve,position:ce.value,elevation:e.elevation,onFocus:de,onBlur:ne},{"thumb-label":a["thumb-label"]})])}})}),{}}}),QB=zt({name:"VColorPickerPreview",props:{color:{type:Object},disabled:Boolean,hideAlpha:Boolean},emits:{"update:color":e=>!0},setup(e,o){let{emit:a}=o;return Mt(()=>{var g;var c,d;return F("div",{class:["v-color-picker-preview",{"v-color-picker-preview--hide-alpha":e.hideAlpha}]},[F("div",{class:"v-color-picker-preview__dot"},[F("div",{style:{background:fT((g=e.color)!=null?g:Jm)}},null)]),F("div",{class:"v-color-picker-preview__sliders"},[F(yg,{class:"v-color-picker-preview__track v-color-picker-preview__hue",modelValue:(c=e.color)==null?void 0:c.h,"onUpdate:modelValue":_=>{var s;return a("update:color",{...(s=e.color)!=null?s:Jm,h:_})},step:0,min:0,max:360,disabled:e.disabled,thumbSize:14,trackSize:8,trackFillColor:"white",hideDetails:!0},null),!e.hideAlpha&&F(yg,{class:"v-color-picker-preview__track v-color-picker-preview__alpha",modelValue:(d=e.color)==null?void 0:d.a,"onUpdate:modelValue":_=>{var s;return a("update:color",{...(s=e.color)!=null?s:Jm,a:_})},step:0,min:0,max:1,disabled:e.disabled,thumbSize:14,trackSize:8,trackFillColor:"white",hideDetails:!0},null)])])}),{}}});const eO=Object.freeze({base:"#f44336",lighten5:"#ffebee",lighten4:"#ffcdd2",lighten3:"#ef9a9a",lighten2:"#e57373",lighten1:"#ef5350",darken1:"#e53935",darken2:"#d32f2f",darken3:"#c62828",darken4:"#b71c1c",accent1:"#ff8a80",accent2:"#ff5252",accent3:"#ff1744",accent4:"#d50000"}),tO=Object.freeze({base:"#e91e63",lighten5:"#fce4ec",lighten4:"#f8bbd0",lighten3:"#f48fb1",lighten2:"#f06292",lighten1:"#ec407a",darken1:"#d81b60",darken2:"#c2185b",darken3:"#ad1457",darken4:"#880e4f",accent1:"#ff80ab",accent2:"#ff4081",accent3:"#f50057",accent4:"#c51162"}),nO=Object.freeze({base:"#9c27b0",lighten5:"#f3e5f5",lighten4:"#e1bee7",lighten3:"#ce93d8",lighten2:"#ba68c8",lighten1:"#ab47bc",darken1:"#8e24aa",darken2:"#7b1fa2",darken3:"#6a1b9a",darken4:"#4a148c",accent1:"#ea80fc",accent2:"#e040fb",accent3:"#d500f9",accent4:"#aa00ff"}),iO=Object.freeze({base:"#673ab7",lighten5:"#ede7f6",lighten4:"#d1c4e9",lighten3:"#b39ddb",lighten2:"#9575cd",lighten1:"#7e57c2",darken1:"#5e35b1",darken2:"#512da8",darken3:"#4527a0",darken4:"#311b92",accent1:"#b388ff",accent2:"#7c4dff",accent3:"#651fff",accent4:"#6200ea"}),rO=Object.freeze({base:"#3f51b5",lighten5:"#e8eaf6",lighten4:"#c5cae9",lighten3:"#9fa8da",lighten2:"#7986cb",lighten1:"#5c6bc0",darken1:"#3949ab",darken2:"#303f9f",darken3:"#283593",darken4:"#1a237e",accent1:"#8c9eff",accent2:"#536dfe",accent3:"#3d5afe",accent4:"#304ffe"}),oO=Object.freeze({base:"#2196f3",lighten5:"#e3f2fd",lighten4:"#bbdefb",lighten3:"#90caf9",lighten2:"#64b5f6",lighten1:"#42a5f5",darken1:"#1e88e5",darken2:"#1976d2",darken3:"#1565c0",darken4:"#0d47a1",accent1:"#82b1ff",accent2:"#448aff",accent3:"#2979ff",accent4:"#2962ff"}),sO=Object.freeze({base:"#03a9f4",lighten5:"#e1f5fe",lighten4:"#b3e5fc",lighten3:"#81d4fa",lighten2:"#4fc3f7",lighten1:"#29b6f6",darken1:"#039be5",darken2:"#0288d1",darken3:"#0277bd",darken4:"#01579b",accent1:"#80d8ff",accent2:"#40c4ff",accent3:"#00b0ff",accent4:"#0091ea"}),aO=Object.freeze({base:"#00bcd4",lighten5:"#e0f7fa",lighten4:"#b2ebf2",lighten3:"#80deea",lighten2:"#4dd0e1",lighten1:"#26c6da",darken1:"#00acc1",darken2:"#0097a7",darken3:"#00838f",darken4:"#006064",accent1:"#84ffff",accent2:"#18ffff",accent3:"#00e5ff",accent4:"#00b8d4"}),lO=Object.freeze({base:"#009688",lighten5:"#e0f2f1",lighten4:"#b2dfdb",lighten3:"#80cbc4",lighten2:"#4db6ac",lighten1:"#26a69a",darken1:"#00897b",darken2:"#00796b",darken3:"#00695c",darken4:"#004d40",accent1:"#a7ffeb",accent2:"#64ffda",accent3:"#1de9b6",accent4:"#00bfa5"}),cO=Object.freeze({base:"#4caf50",lighten5:"#e8f5e9",lighten4:"#c8e6c9",lighten3:"#a5d6a7",lighten2:"#81c784",lighten1:"#66bb6a",darken1:"#43a047",darken2:"#388e3c",darken3:"#2e7d32",darken4:"#1b5e20",accent1:"#b9f6ca",accent2:"#69f0ae",accent3:"#00e676",accent4:"#00c853"}),uO=Object.freeze({base:"#8bc34a",lighten5:"#f1f8e9",lighten4:"#dcedc8",lighten3:"#c5e1a5",lighten2:"#aed581",lighten1:"#9ccc65",darken1:"#7cb342",darken2:"#689f38",darken3:"#558b2f",darken4:"#33691e",accent1:"#ccff90",accent2:"#b2ff59",accent3:"#76ff03",accent4:"#64dd17"}),hO=Object.freeze({base:"#cddc39",lighten5:"#f9fbe7",lighten4:"#f0f4c3",lighten3:"#e6ee9c",lighten2:"#dce775",lighten1:"#d4e157",darken1:"#c0ca33",darken2:"#afb42b",darken3:"#9e9d24",darken4:"#827717",accent1:"#f4ff81",accent2:"#eeff41",accent3:"#c6ff00",accent4:"#aeea00"}),dO=Object.freeze({base:"#ffeb3b",lighten5:"#fffde7",lighten4:"#fff9c4",lighten3:"#fff59d",lighten2:"#fff176",lighten1:"#ffee58",darken1:"#fdd835",darken2:"#fbc02d",darken3:"#f9a825",darken4:"#f57f17",accent1:"#ffff8d",accent2:"#ffff00",accent3:"#ffea00",accent4:"#ffd600"}),fO=Object.freeze({base:"#ffc107",lighten5:"#fff8e1",lighten4:"#ffecb3",lighten3:"#ffe082",lighten2:"#ffd54f",lighten1:"#ffca28",darken1:"#ffb300",darken2:"#ffa000",darken3:"#ff8f00",darken4:"#ff6f00",accent1:"#ffe57f",accent2:"#ffd740",accent3:"#ffc400",accent4:"#ffab00"}),pO=Object.freeze({base:"#ff9800",lighten5:"#fff3e0",lighten4:"#ffe0b2",lighten3:"#ffcc80",lighten2:"#ffb74d",lighten1:"#ffa726",darken1:"#fb8c00",darken2:"#f57c00",darken3:"#ef6c00",darken4:"#e65100",accent1:"#ffd180",accent2:"#ffab40",accent3:"#ff9100",accent4:"#ff6d00"}),mO=Object.freeze({base:"#ff5722",lighten5:"#fbe9e7",lighten4:"#ffccbc",lighten3:"#ffab91",lighten2:"#ff8a65",lighten1:"#ff7043",darken1:"#f4511e",darken2:"#e64a19",darken3:"#d84315",darken4:"#bf360c",accent1:"#ff9e80",accent2:"#ff6e40",accent3:"#ff3d00",accent4:"#dd2c00"}),gO=Object.freeze({base:"#795548",lighten5:"#efebe9",lighten4:"#d7ccc8",lighten3:"#bcaaa4",lighten2:"#a1887f",lighten1:"#8d6e63",darken1:"#6d4c41",darken2:"#5d4037",darken3:"#4e342e",darken4:"#3e2723"}),vO=Object.freeze({base:"#607d8b",lighten5:"#eceff1",lighten4:"#cfd8dc",lighten3:"#b0bec5",lighten2:"#90a4ae",lighten1:"#78909c",darken1:"#546e7a",darken2:"#455a64",darken3:"#37474f",darken4:"#263238"}),_O=Object.freeze({base:"#9e9e9e",lighten5:"#fafafa",lighten4:"#f5f5f5",lighten3:"#eeeeee",lighten2:"#e0e0e0",lighten1:"#bdbdbd",darken1:"#757575",darken2:"#616161",darken3:"#424242",darken4:"#212121"}),yO=Object.freeze({black:"#000000",white:"#ffffff",transparent:"#ffffff00"}),xO=Object.freeze({red:eO,pink:tO,purple:nO,deepPurple:iO,indigo:rO,blue:oO,lightBlue:sO,cyan:aO,teal:lO,green:cO,lightGreen:uO,lime:hO,yellow:dO,amber:fO,orange:pO,deepOrange:mO,brown:gO,blueGrey:vO,grey:_O,shades:yO});function bO(e){return Object.keys(e).map(o=>{const a=e[o];return a.base?[a.base,a.darken4,a.darken3,a.darken2,a.darken1,a.lighten1,a.lighten2,a.lighten3,a.lighten4,a.lighten5]:[a.black,a.white,a.transparent]})}const wO=zt({name:"VColorPickerSwatches",props:{swatches:{type:Array,default:()=>bO(xO)},disabled:Boolean,color:Object,maxHeight:[Number,String]},emits:{"update:color":e=>!0},setup(e,o){let{emit:a}=o;return Mt(()=>F("div",{class:"v-color-picker-swatches",style:{maxHeight:Yt(e.maxHeight)}},[F("div",null,[e.swatches.map(c=>F("div",{class:"v-color-picker-swatches__swatch"},[c.map(d=>{const g=rC(d);return F("div",{class:"v-color-picker-swatches__color",onClick:()=>g&&a("update:color",g)},[F("div",{style:{background:d}},[e.color&&jf(e.color,g)?F(ir,{size:"x-small",icon:"$success",color:bL(d,"#FFFFFF")>2?"white":"black"},null):void 0])])})]))])])),{}}});const cC=zt({name:"VSheet",props:{color:String,...vo(),...ss(),...lr(),...Uc(),...xh(),...Di(),...Sn(),...Kn()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=wi(e),{backgroundColorClasses:d,backgroundColorStyles:g}=Qi(St(e,"color")),{borderClasses:_}=Fo(e),{dimensionStyles:s}=as(e),{elevationClasses:w}=Pr(e),{locationStyles:S}=jc(e),{positionClasses:A}=bh(e),{roundedClasses:z}=er(e);return()=>F(e.tag,{class:["v-sheet",c.value,d.value,_.value,w.value,A.value,z.value],style:[g.value,s.value,S.value]},a)}}),EO=zt({name:"VColorPicker",inheritAttrs:!1,props:{canvasHeight:{type:[String,Number],default:150},disabled:Boolean,dotSize:{type:[Number,String],default:10},hideCanvas:Boolean,hideSliders:Boolean,hideInputs:Boolean,mode:{type:String,default:"rgba",validator:e=>Object.keys(Ic).includes(e)},modes:{type:Array,default:()=>Object.keys(Ic),validator:e=>Array.isArray(e)&&e.every(o=>Object.keys(Ic).includes(o))},showSwatches:Boolean,swatches:Array,swatchesMaxHeight:{type:[Number,String],default:150},modelValue:{type:[Object,String]},width:{type:[Number,String],default:300},...lr(),...Di(),...Kn()},emits:{"update:modelValue":e=>!0,"update:mode":e=>!0},setup(e){const o=En(e,"mode"),a=Qe(null),c=En(e,"modelValue",void 0,g=>{let _=rC(g);return _?(a.value&&(_={..._,h:a.value.h},a.value=null),_):null},g=>g?ZB(g,e.modelValue):null),d=g=>{c.value=g,a.value=g};return Fn(()=>{e.modes.includes(o.value)||(o.value=e.modes[0])}),Mt(()=>{var g;return F(cC,{rounded:e.rounded,elevation:e.elevation,theme:e.theme,class:["v-color-picker"],style:{"--v-color-picker-color-hsv":fT({...(g=c.value)!=null?g:Jm,a:1})},maxWidth:e.width},{default:()=>[!e.hideCanvas&&F(GB,{key:"canvas",color:c.value,"onUpdate:color":d,disabled:e.disabled,dotSize:e.dotSize,width:e.width,height:e.canvasHeight},null),(!e.hideSliders||!e.hideInputs)&&F("div",{key:"controls",class:"v-color-picker__controls"},[!e.hideSliders&&F(QB,{key:"preview",color:c.value,"onUpdate:color":d,hideAlpha:!o.value.endsWith("a"),disabled:e.disabled},null),!e.hideInputs&&F(KB,{key:"edit",modes:e.modes,mode:o.value,"onUpdate:mode":_=>o.value=_,color:c.value,"onUpdate:color":d,disabled:e.disabled},null)]),e.showSwatches&&F(wO,{key:"swatches",color:c.value,"onUpdate:color":d,maxHeight:e.swatchesMaxHeight,swatches:e.swatches,disabled:e.disabled},null)]})}),{}}});function SO(e,o,a){if(Array.isArray(o))throw new Error("Multiple matches is not implemented");return typeof o=="number"&&~o?F(On,null,[F("span",{class:"v-combobox__unmask"},[e.substr(0,o)]),F("span",{class:"v-combobox__mask"},[e.substr(o,a)]),F("span",{class:"v-combobox__unmask"},[e.substr(o+a)])]):e}const TO=Li()({name:"VCombobox",props:{delimiters:Array,...G2({filterKeys:["title"]}),...$0({hideNoData:!0,returnObject:!0}),...Ea({transition:!1})},emits:{"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,o){var ft;var a;let{emit:c,slots:d}=o;const{t:g}=ls(),_=Qe(),s=Qe(!1),w=Qe(!0),S=En(e,"menu"),A=Qe(-1),z=ie(()=>{var Pe;return(Pe=_.value)==null?void 0:Pe.color}),{items:L,transformIn:R,transformOut:$}=F0(e),{textColorClasses:Z,textColorStyles:de}=oo(z),ne=En(e,"modelValue",[],Pe=>R(Lo(Pe||[])),Pe=>{var Gt;const at=$(Pe);return e.multiple?at:(Gt=at[0])!=null?Gt:null}),ce=Qe(e.multiple?"":(ft=(a=ne.value[0])==null?void 0:a.title)!=null?ft:""),K=ie({get:()=>ce.value,set:Pe=>{var at;if(ce.value=Pe,e.multiple||(ne.value=[nh(e,Pe)]),Pe&&e.multiple&&(at=e.delimiters)!=null&&at.length){const Gt=Pe.split(new RegExp(`(?:${e.delimiters.join("|")})+`));Gt.length>1&&(Gt.forEach(pt=>{pt=pt.trim(),pt&&Ke(nh(e,pt))}),ce.value="")}Pe||(A.value=-1),s.value&&(S.value=!0),w.value=!Pe}});Ye(ce,Pe=>{c("update:search",Pe)}),Ye(ne,Pe=>{var Gt;if(!e.multiple){var at;ce.value=(Gt=(at=Pe[0])==null?void 0:at.title)!=null?Gt:""}});const{filteredItems:Ee}=q2(e,L,ie(()=>w.value?void 0:K.value)),Y=ie(()=>ne.value.map(Pe=>L.value.find(at=>at.value===Pe.value)||Pe)),_e=ie(()=>Y.value.map(Pe=>Pe.props.value)),fe=ie(()=>Y.value[A.value]),ve=Qe();function Se(Pe){ne.value=[],e.openOnClear&&(S.value=!0)}function be(){e.hideNoData&&!L.value.length||e.readonly||(S.value=!0)}function De(Pe){if(e.readonly)return;const at=_.value.selectionStart,Gt=_e.value.length;if(A.value>-1&&Pe.preventDefault(),["Enter","ArrowDown"].includes(Pe.key)&&(S.value=!0),["Escape"].includes(Pe.key)&&(S.value=!1),["Enter","Escape","Tab"].includes(Pe.key)&&(w.value=!0),Pe.key==="ArrowDown"){var pt;(pt=ve.value)==null||pt.focus("next")}else if(Pe.key==="ArrowUp"){var Lt;(Lt=ve.value)==null||Lt.focus("prev")}if(!!e.multiple){if(["Backspace","Delete"].includes(Pe.key)){if(A.value<0){Pe.key==="Backspace"&&!K.value&&(A.value=Gt-1);return}Ke(fe.value),Zi(()=>!fe.value&&(A.value=Gt-2))}if(Pe.key==="ArrowLeft"){if(A.value<0&&at>0)return;const qt=A.value>-1?A.value-1:Gt-1;Y.value[qt]?A.value=qt:(A.value=-1,_.value.setSelectionRange(K.value.length,K.value.length))}if(Pe.key==="ArrowRight"){if(A.value<0)return;const qt=A.value+1;Y.value[qt]?A.value=qt:(A.value=-1,_.value.setSelectionRange(0,0))}Pe.key==="Enter"&&(Ke(nh(e,K.value)),K.value="")}}function ze(){s.value&&(w.value=!0)}function Ke(Pe){if(e.multiple){const at=_e.value.findIndex(Gt=>Gt===Pe.value);if(at===-1)ne.value=[...ne.value,Pe];else{const Gt=[...ne.value];Gt.splice(at,1),ne.value=Gt}K.value=""}else ne.value=[Pe],ce.value=Pe.title,Zi(()=>{S.value=!1,w.value=!0})}function ct(Pe){s.value=!0}function nt(Pe){if(Pe.relatedTarget==null){var at;(at=_.value)==null||at.focus()}}return Ye(Ee,Pe=>{!Pe.length&&e.hideNoData&&(S.value=!1)}),Ye(s,Pe=>{if(Pe)A.value=-1;else{if(S.value=!1,!e.multiple||!K.value)return;ne.value=[...ne.value,nh(e,K.value)],K.value=""}}),Mt(()=>{const Pe=!!(e.chips||d.chip);return F(Kg,{ref:_,modelValue:K.value,"onUpdate:modelValue":[at=>K.value=at,at=>{at==null&&(ne.value=[])}],validationValue:ne.externalValue,dirty:ne.value.length>0,class:["v-combobox",{"v-combobox--active-menu":S.value,"v-combobox--chips":!!e.chips,"v-combobox--selecting-index":A.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0}],appendInnerIcon:e.items.length?e.menuIcon:void 0,readonly:e.readonly,"onClick:clear":Se,"onClick:control":be,"onClick:input":be,onFocus:()=>s.value=!0,onBlur:()=>s.value=!1,onKeydown:De},{...d,default:()=>{var at,Gt,pt;return F(On,null,[F(Hf,nn({modelValue:S.value,"onUpdate:modelValue":Lt=>S.value=Lt,activator:"parent",contentClass:"v-combobox__content",eager:e.eager,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ze},e.menuProps),{default:()=>[F(Ta,{ref:ve,selected:_e.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:Lt=>Lt.preventDefault(),onFocusin:ct,onFocusout:nt},{default:()=>{var Lt;return[!Ee.value.length&&!e.hideNoData&&((Lt=(at=d["no-data"])==null?void 0:at.call(d))!=null?Lt:F(qi,{title:g(e.noDataText)},null)),(Gt=d["prepend-item"])==null?void 0:Gt.call(d),Ee.value.map((qt,Ln)=>{var Tt;var kt;let{item:Je,matches:bt}=qt;return(Tt=(kt=d.item)==null?void 0:kt.call(d,{item:Je,index:Ln,props:nn(Je.props,{onClick:()=>Ke(Je)})}))!=null?Tt:F(qi,nn({key:Ln},Je.props,{onClick:()=>Ke(Je)}),{prepend:Ut=>{let{isSelected:pn}=Ut;return e.multiple&&!e.hideSelected?F(Th,{modelValue:pn,ripple:!1},null):void 0},title:()=>{var pn;var Ut;return w.value?Je.title:SO(Je.title,bt.title,(pn=(Ut=K.value)==null?void 0:Ut.length)!=null?pn:0)}})}),(pt=d["append-item"])==null?void 0:pt.call(d)]}})]}),Y.value.map((Lt,qt)=>{function Ln(Je){Je.stopPropagation(),Je.preventDefault(),Ke(Lt)}const kt={"onClick:close":Ln,modelValue:!0,"onUpdate:modelValue":void 0};return F("div",{key:Lt.value,class:["v-combobox__selection",qt===A.value&&["v-combobox__selection--selected",Z.value]],style:qt===A.value?de.value:{}},[Pe?F(Ti,{defaults:{VChip:{closable:e.closableChips,size:"small",text:Lt.title}}},{default:()=>[d.chip?d.chip({item:Lt,index:qt,props:kt}):F(Zf,kt,null)]}):d.selection?d.selection({item:Lt,index:qt}):F("span",{class:"v-combobox__selection-text"},[Lt.title,e.multiple&&qt<Y.value.length-1&&F("span",{class:"v-combobox__selection-comma"},[Ds(",")])])])})])}})}),cs({isFocused:s,isPristine:w,menu:S,search:K,selectionIndex:A,filteredItems:Ee,select:Ke},_)}});const CO=Li()({name:"VDialog",props:{fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...Wf({origin:"center center",scrollStrategy:"block",transition:{component:Ng},zIndex:2400})},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=En(e,"modelValue"),{scopeId:d}=Hg(),g=Qe();function _(s){var w,S;const A=s.relatedTarget,z=s.target;if(A!==z&&(w=g.value)!=null&&w.contentEl&&(S=g.value)!=null&&S.globalTop&&![document,g.value.contentEl].includes(z)&&!g.value.contentEl.contains(z)){const L=[...g.value.contentEl.querySelectorAll('button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])')].filter(Z=>!Z.hasAttribute("disabled")&&!Z.matches('[tabindex="-1"]'));if(!L.length)return;const R=L[0],$=L[L.length-1];A===R?$.focus():R.focus()}}return zi&&Ye(()=>c.value&&e.retainFocus,s=>{s?document.addEventListener("focusin",_):document.removeEventListener("focusin",_)},{immediate:!0}),Ye(c,async s=>{if(await Zi(),s){var w;(w=g.value.contentEl)==null||w.focus({preventScroll:!0})}else{var S;(S=g.value.activatorEl)==null||S.focus({preventScroll:!0})}}),Mt(()=>{const[s]=Wg(e);return F(Ch,nn({ref:g,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable}]},s,{modelValue:c.value,"onUpdate:modelValue":w=>c.value=w,"aria-role":"dialog","aria-modal":"true",activatorProps:nn({"aria-haspopup":"dialog","aria-expanded":String(c.value)},e.activatorProps)},d),{activator:a.activator,default:function(){for(var w,S=arguments.length,A=new Array(S),z=0;z<S;z++)A[z]=arguments[z];return F(Ti,{root:!0},{default:()=>[(w=a.default)==null?void 0:w.call(a,...A)]})}})}),cs({},g)}});const Bf=Symbol.for("vuetify:v-expansion-panel"),IO=["default","accordion","inset","popout"],AO=zt({name:"VExpansionPanels",props:{color:String,variant:{type:String,default:"default",validator:e=>IO.includes(e)},readonly:Boolean,...mh(),...Sn(),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;Vc(e,Bf);const{themeClasses:c}=wi(e),d=ie(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return sr({VExpansionPanel:{color:St(e,"color")},VExpansionPanelTitle:{readonly:St(e,"readonly")}}),Mt(()=>F(e.tag,{class:["v-expansion-panels",c.value,d.value]},a)),{}}}),uC=Pn({color:String,expandIcon:{type:mn,default:"$expand"},collapseIcon:{type:mn,default:"$collapse"},hideActions:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean},"VExpansionPanelTitle"),hC=zt({name:"VExpansionPanelTitle",directives:{Ripple:bl},props:{...uC()},setup(e,o){let{slots:a}=o;const c=cn(Bf);if(!c)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:d,backgroundColorStyles:g}=Qi(e,"color"),_=ie(()=>({collapseIcon:e.collapseIcon,disabled:c.disabled.value,expanded:c.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return Mt(()=>{var s;return Wi(F("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":c.isSelected.value},d.value],style:g.value,type:"button",tabindex:c.disabled.value?-1:void 0,disabled:c.disabled.value,"aria-expanded":c.isSelected.value,onClick:e.readonly?void 0:c.toggle},[F("span",{class:"v-expansion-panel-title__overlay"},null),(s=a.default)==null?void 0:s.call(a,_.value),!e.hideActions&&F("span",{class:"v-expansion-panel-title__icon"},[a.actions?a.actions(_.value):F(ir,{icon:c.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[mo("ripple"),e.ripple]])}),{}}}),dC=zt({name:"VExpansionPanelText",props:{...Zg()},setup(e,o){let{slots:a}=o;const c=cn(Bf);if(!c)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:d,onAfterLeave:g}=V0(e,c.isSelected);return Mt(()=>{var _;return F($g,{onAfterLeave:g},{default:()=>[Wi(F("div",{class:"v-expansion-panel-text"},[a.default&&d.value&&F("div",{class:"v-expansion-panel-text__wrapper"},[(_=a.default)==null?void 0:_.call(a)])]),[[$s,c.isSelected.value]])]})}),{}}}),kO=zt({name:"VExpansionPanel",props:{title:String,text:String,bgColor:String,...lr(),...Fc(),...Zg(),...Di(),...Sn(),...uC()},emits:{"group:selected":e=>!0},setup(e,o){let{slots:a}=o;const c=gh(e,Bf),{backgroundColorClasses:d,backgroundColorStyles:g}=Qi(e,"bgColor"),{elevationClasses:_}=Pr(e),{roundedClasses:s}=er(e),w=ie(()=>(c==null?void 0:c.disabled.value)||e.disabled),S=ie(()=>c.group.items.value.reduce((L,R,$)=>(c.group.selected.value.includes(R.id)&&L.push($),L),[])),A=ie(()=>{const L=c.group.items.value.findIndex(R=>R.id===c.id);return!c.isSelected.value&&S.value.some(R=>R-L===1)}),z=ie(()=>{const L=c.group.items.value.findIndex(R=>R.id===c.id);return!c.isSelected.value&&S.value.some(R=>R-L===-1)});return Gi(Bf,c),Mt(()=>{var L;const R=!!(a.text||e.text),$=!!(a.title||e.title);return F(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":c.isSelected.value,"v-expansion-panel--before-active":A.value,"v-expansion-panel--after-active":z.value,"v-expansion-panel--disabled":w.value},s.value,d.value],style:g.value,"aria-expanded":c.isSelected.value},{default:()=>[F("div",{class:["v-expansion-panel__shadow",..._.value]},null),$&&F(hC,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[a.title?a.title():e.title]}),R&&F(dC,{key:"text",eager:e.eager},{default:()=>[a.text?a.text():e.text]}),(L=a.default)==null?void 0:L.call(a)]})}),{}}});const MO=zt({name:"VFileInput",inheritAttrs:!1,props:{chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,hint:String,persistentHint:Boolean,placeholder:String,showSize:{type:[Boolean,Number],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(e)},...Sa({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>Lo(e).every(o=>o!=null&&typeof o=="object")},...Xg({clearable:!0})},emits:{"click:control":e=>!0,"update:modelValue":e=>!0},setup(e,o){let{attrs:a,emit:c,slots:d}=o;const{t:g}=ls(),_=En(e,"modelValue"),s=ie(()=>typeof e.showSize!="boolean"?e.showSize:void 0),w=ie(()=>{var Y;return((Y=_.value)!=null?Y:[]).reduce((_e,fe)=>{let{size:ve=0}=fe;return _e+ve},0)}),S=ie(()=>kw(w.value,s.value)),A=ie(()=>{var Y;return((Y=_.value)!=null?Y:[]).map(_e=>{const{name:fe="",size:ve=0}=_e;return e.showSize?`${fe} (${kw(ve,s.value)})`:fe})}),z=ie(()=>{var fe;var Y;const _e=(fe=(Y=_.value)==null?void 0:Y.length)!=null?fe:0;return e.showSize?g(e.counterSizeString,_e,S.value):g(e.counterString,_e)}),L=Qe(),R=Qe(),$=Qe(!1),Z=Qe(),de=ie(()=>e.messages.length?e.messages:e.persistentHint?e.hint:"");function ne(){if(Z.value!==document.activeElement){var Y;(Y=Z.value)==null||Y.focus()}$.value||($.value=!0)}function ce(Y){ug(e["onClick:prepend"],Y),K(Y)}function K(Y){var _e;(_e=Z.value)==null||_e.click(),c("click:control",Y)}function Ee(Y){Y.stopPropagation(),ne(),Zi(()=>{_.value=[],Z!=null&&Z.value&&(Z.value.value=""),ug(e["onClick:clear"],Y)})}return Mt(()=>{const Y=!!(d.counter||e.counter),_e=!!(Y||d.details),[fe,ve]=Oc(a),[{modelValue:Se,...be}]=wl(e),[De]=N0(e);return F(Us,nn({ref:L,modelValue:_.value,"onUpdate:modelValue":ze=>_.value=ze,class:"v-file-input","onClick:prepend":ce,"onClick:append":e["onClick:append"]},fe,be,{focused:$.value,messages:de.value}),{...d,default:ze=>{let{isDisabled:Ke,isDirty:ct,isReadonly:nt,isValid:ft}=ze;return F(Xf,nn({ref:R,"prepend-icon":e.prependIcon,"onClick:control":K,"onClick:clear":Ee,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},De,{active:ct.value||$.value,dirty:ct.value,focused:$.value,error:ft.value===!1}),{...d,default:Pe=>{let{props:{class:at,...Gt}}=Pe;return F(On,null,[F("input",nn({ref:Z,type:"file",readonly:nt.value,disabled:Ke.value,multiple:e.multiple,name:e.name,onClick:pt=>{pt.stopPropagation(),ne()},onChange:pt=>{var qt;if(!pt.target)return;const Lt=pt.target;_.value=[...(qt=Lt.files)!=null?qt:[]]},onFocus:ne,onBlur:()=>$.value=!1},Gt,ve),null),F("div",{class:at},[_.value.length>0&&(d.selection?d.selection({fileNames:A.value,totalBytes:w.value,totalBytesReadable:S.value}):e.chips?A.value.map(pt=>F(Zf,{key:pt,size:"small",color:e.color},{default:()=>[pt]})):A.value.join(", "))])])}})},details:_e?ze=>{var Ke;return F(On,null,[(Ke=d.details)==null?void 0:Ke.call(d,ze),Y&&F(On,null,[F("span",null,null),F(Yg,{active:!!_.value.length,value:z.value},d.counter)])])}:void 0})}),cs({},L,R,Z)}});const PO=zt({name:"VFooter",props:{app:Boolean,color:String,height:{type:[Number,String],default:"auto"},...vo(),...lr(),...vh(),...Di(),...Sn({tag:"footer"}),...Kn()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=wi(e),{backgroundColorClasses:d,backgroundColorStyles:g}=Qi(St(e,"color")),{borderClasses:_}=Fo(e),{elevationClasses:s}=Pr(e),{roundedClasses:w}=er(e),S=Qe(32),{resizeRef:A}=zc(R=>{!R.length||(S.value=R[0].target.clientHeight)}),z=ie(()=>e.height==="auto"?S.value:parseInt(e.height,10)),{layoutItemStyles:L}=_h({id:e.name,order:ie(()=>parseInt(e.order,10)),position:ie(()=>"bottom"),layoutSize:z,elementSize:ie(()=>e.height==="auto"?void 0:z.value),active:ie(()=>e.app),absolute:St(e,"absolute")});return Mt(()=>F(e.tag,{ref:A,class:["v-footer",c.value,d.value,_.value,s.value,w.value],style:[g,e.app?L.value:void 0]},a)),{}}}),zO=zt({name:"VForm",props:{...RR()},emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,o){let{slots:a,emit:c}=o;const d=BR(e),g=Qe();function _(w){w.preventDefault(),d.reset()}function s(w){const S=w,A=d.validate();S.then=A.then.bind(A),S.catch=A.catch.bind(A),S.finally=A.finally.bind(A),c("submit",S),S.defaultPrevented||A.then(z=>{let{valid:L}=z;if(L){var R;(R=g.value)==null||R.submit()}}),S.preventDefault()}return Mt(()=>{var w;return F("form",{ref:g,class:"v-form",novalidate:!0,onReset:_,onSubmit:s},[(w=a.default)==null?void 0:w.call(a,d)])}),cs(d,g)}}),LO=zt({name:"VHover",props:{disabled:Boolean,modelValue:{type:Boolean,default:void 0},...O2()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=En(e,"modelValue"),{runOpenDelay:d,runCloseDelay:g}=F2(e,_=>!e.disabled&&(c.value=_));return()=>{var _;return(_=a.default)==null?void 0:_.call(a,{isHovering:c.value,props:{onMouseenter:d,onMouseleave:g}})}}});const fC=Symbol.for("vuetify:v-item-group"),DO=zt({name:"VItemGroup",props:{...mh({selectedClass:"v-item--selected"}),...Sn(),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{themeClasses:c}=wi(e),{isSelected:d,select:g,next:_,prev:s,selected:w}=Vc(e,fC);return()=>{var S;return F(e.tag,{class:["v-item-group",c.value]},{default:()=>[(S=a.default)==null?void 0:S.call(a,{isSelected:d,select:g,next:_,prev:s,selected:w.value})]})}}}),RO=Li()({name:"VItem",props:Fc(),emits:{"group:selected":e=>!0},setup(e,o){let{slots:a}=o;const{isSelected:c,select:d,toggle:g,selectedClass:_,value:s,disabled:w}=gh(e,fC);return()=>{var S;return(S=a.default)==null?void 0:S.call(a,{isSelected:c.value,selectedClass:_.value,select:d,toggle:g,value:s.value,disabled:w.value})}}});const BO=Oo("v-kbd"),OO=zt({name:"VLazy",directives:{intersect:Ug},props:{modelValue:Boolean,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},...ss(),...Sn(),...Ea({transition:"fade-transition"})},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{dimensionStyles:c}=as(e),d=En(e,"modelValue");function g(_){d.value||(d.value=_)}return Mt(()=>{var _;return Wi(F(e.tag,{class:"v-lazy",style:c.value},{default:()=>[d.value&&F(Bs,{transition:e.transition},{default:()=>[(_=a.default)==null?void 0:_.call(a)]})]}),[[mo("intersect"),g,e.options]])}),{}}});const FO=zt({name:"VLocaleProvider",props:{locale:String,fallbackLocale:String,messages:Object,rtl:{type:Boolean,default:void 0}},setup(e,o){let{slots:a}=o;const{rtlClasses:c}=uD(e);return Mt(()=>{var d;return F("div",{class:["v-locale-provider",c.value]},[(d=a.default)==null?void 0:d.call(a)])}),{}}});function VO(e){let{rootEl:o,isSticky:a,layoutItemStyles:c}=e;const d=Qe(!1),g=Qe(0),_=ie(()=>{const S=typeof d.value=="boolean"?"top":d.value;return[a.value?{top:"auto",bottom:"auto",height:void 0}:void 0,d.value?{[S]:Yt(g.value)}:{top:c.value.top}]});Fn(()=>{Ye(a,S=>{S?window.addEventListener("scroll",w,{passive:!0}):window.removeEventListener("scroll",w)},{immediate:!0})}),Ii(()=>{document.removeEventListener("scroll",w)});let s=0;function w(){var $;const S=s>window.scrollY?"up":"down",A=o.value.getBoundingClientRect(),z=parseFloat(($=c.value.top)!=null?$:0),L=window.scrollY-Math.max(0,g.value-z),R=A.height+Math.max(g.value,z)-window.scrollY-window.innerHeight;A.height<window.innerHeight-z?(d.value="top",g.value=z):S==="up"&&d.value==="bottom"||S==="down"&&d.value==="top"?(g.value=window.scrollY+A.top,d.value=!0):S==="down"&&R<=0?(g.value=0,d.value="bottom"):S==="up"&&L<=0&&(g.value=A.top+L,d.value="top"),s=window.scrollY}return{isStuck:d,stickyStyles:_}}const NO=100,$O=20;function lE(e){const o=1.41421356237;return(e<0?-1:1)*Math.sqrt(Math.abs(e))*o}function cE(e){if(e.length<2)return 0;if(e.length===2)return e[1].t===e[0].t?0:(e[1].d-e[0].d)/(e[1].t-e[0].t);let o=0;for(let a=e.length-1;a>0;a--){if(e[a].t===e[a-1].t)continue;const c=lE(o),d=(e[a].d-e[a-1].d)/(e[a].t-e[a-1].t);o+=(d-c)*Math.abs(d),a===e.length-1&&(o*=.5)}return lE(o)*1e3}function UO(){const e={};function o(d){Array.from(d.changedTouches).forEach(g=>{var s;((s=e[g.identifier])!=null?s:e[g.identifier]=new tL($O)).push([d.timeStamp,g])})}function a(d){Array.from(d.changedTouches).forEach(g=>{delete e[g.identifier]})}function c(d){var g;const _=(g=e[d])==null?void 0:g.values().reverse();if(!_)throw new Error(`No samples for touch id ${d}`);const s=_[0],w=[],S=[];for(const A of _){if(s[0]-A[0]>NO)break;w.push({t:A[0],d:A[1].clientX}),S.push({t:A[0],d:A[1].clientY})}return{x:cE(w),y:cE(S),get direction(){const{x:A,y:z}=this,[L,R]=[Math.abs(A),Math.abs(z)];return L>R&&A>=0?"right":L>R&&A<=0?"left":R>L&&z>=0?"down":R>L&&z<=0?"up":jO()}}}return{addMovement:o,endTouch:a,getVelocity:c}}function jO(){throw new Error}function GO(e){let{isActive:o,isTemporary:a,width:c,touchless:d,position:g}=e;Fn(()=>{window.addEventListener("touchstart",ne,{passive:!0}),window.addEventListener("touchmove",ce,{passive:!1}),window.addEventListener("touchend",K,{passive:!0})}),Ii(()=>{window.removeEventListener("touchstart",ne),window.removeEventListener("touchmove",ce),window.removeEventListener("touchend",K)});const _=ie(()=>g.value!=="bottom"),{addMovement:s,endTouch:w,getVelocity:S}=UO();let A=!1;const z=Qe(!1),L=Qe(0),R=Qe(0);let $;function Z(Y,_e){return(g.value==="left"?Y:g.value==="right"?document.documentElement.clientWidth-Y:g.value==="bottom"?document.documentElement.clientHeight-Y:Qu())-(_e?c.value:0)}function de(Y){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const fe=g.value==="left"?(Y-R.value)/c.value:g.value==="right"?(document.documentElement.clientWidth-Y-R.value)/c.value:g.value==="bottom"?(document.documentElement.clientHeight-Y-R.value)/c.value:Qu();return _e?Math.max(0,Math.min(1,fe)):fe}function ne(Y){if(d.value)return;const _e=Y.changedTouches[0].clientX,fe=Y.changedTouches[0].clientY,ve=25,Se=g.value==="left"?_e<ve:g.value==="right"?_e>document.documentElement.clientWidth-ve:g.value==="bottom"?fe>document.documentElement.clientHeight-ve:Qu(),be=o.value&&(g.value==="left"?_e<c.value:g.value==="right"?_e>document.documentElement.clientWidth-c.value:g.value==="bottom"?fe>document.documentElement.clientHeight-c.value:Qu());(Se||be||o.value&&a.value)&&(A=!0,$=[_e,fe],R.value=Z(_.value?_e:fe,o.value),L.value=de(_.value?_e:fe),w(Y),s(Y))}function ce(Y){const _e=Y.changedTouches[0].clientX,fe=Y.changedTouches[0].clientY;if(A){if(!Y.cancelable){A=!1;return}const Se=Math.abs(_e-$[0]),be=Math.abs(fe-$[1]);(_.value?Se>be&&Se>3:be>Se&&be>3)?(z.value=!0,A=!1):(_.value?be:Se)>3&&(A=!1)}if(!z.value)return;Y.preventDefault(),s(Y);const ve=de(_.value?_e:fe,!1);L.value=Math.max(0,Math.min(1,ve)),ve>1?R.value=Z(_.value?_e:fe,!0):ve<0&&(R.value=Z(_.value?_e:fe,!1))}function K(Y){if(A=!1,!z.value)return;s(Y),z.value=!1;const _e=S(Y.changedTouches[0].identifier),fe=Math.abs(_e.x),ve=Math.abs(_e.y);(_.value?fe>ve&&fe>400:ve>fe&&ve>3)?o.value=_e.direction===({left:"right",right:"left",bottom:"up"}[g.value]||Qu()):o.value=L.value>.5}const Ee=ie(()=>z.value?{transform:g.value==="left"?`translateX(calc(-100% + ${L.value*c.value}px))`:g.value==="right"?`translateX(calc(100% - ${L.value*c.value}px))`:g.value==="bottom"?`translateY(calc(100% - ${L.value*c.value}px))`:Qu(),transition:"none"}:void 0);return{isDragging:z,dragProgress:L,dragStyles:Ee}}function Qu(){throw new Error}const qO=["start","end","left","right","bottom"],pC=zt({name:"VNavigationDrawer",props:{color:String,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,modelValue:{type:Boolean,default:null},permanent:Boolean,rail:Boolean,railWidth:{type:[Number,String],default:56},scrim:{type:[String,Boolean],default:!0},image:String,temporary:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},location:{type:String,default:"start",validator:e=>qO.includes(e)},sticky:Boolean,...vo(),...lr(),...vh(),...Di(),...Sn({tag:"nav"}),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{attrs:a,slots:c}=o;const{isRtl:d}=ba(),{themeClasses:g}=wi(e),{borderClasses:_}=Fo(e),{backgroundColorClasses:s,backgroundColorStyles:w}=Qi(St(e,"color")),{elevationClasses:S}=Pr(e),{mobile:A}=jg(),{roundedClasses:z}=er(e),L=$T(),R=En(e,"modelValue",null,ft=>!!ft),{ssrBootStyles:$}=D0(),Z=Qe(),de=Qe(!1),ne=ie(()=>e.rail&&e.expandOnHover&&de.value?Number(e.width):Number(e.rail?e.railWidth:e.width)),ce=ie(()=>uy(e.location,d.value)),K=ie(()=>!e.permanent&&(A.value||e.temporary)),Ee=ie(()=>e.sticky&&!K.value&&ce.value!=="bottom");e.disableResizeWatcher||Ye(K,ft=>!e.permanent&&(R.value=!ft)),!e.disableRouteWatcher&&L&&Ye(L.currentRoute,()=>K.value&&(R.value=!1)),Ye(()=>e.permanent,ft=>{ft&&(R.value=!0)}),Mg(()=>{e.modelValue!=null||K.value||(R.value=e.permanent||!A.value)});const{isDragging:Y,dragProgress:_e,dragStyles:fe}=GO({isActive:R,isTemporary:K,width:ne,touchless:St(e,"touchless"),position:ce}),ve=ie(()=>{const ft=K.value?0:e.rail&&e.expandOnHover?Number(e.railWidth):ne.value;return Y.value?ft*_e.value:ft}),{layoutItemStyles:Se,layoutRect:be,layoutItemScrimStyles:De}=_h({id:e.name,order:ie(()=>parseInt(e.order,10)),position:ce,layoutSize:ve,elementSize:ne,active:ie(()=>R.value||Y.value),disableTransitions:ie(()=>Y.value),absolute:ie(()=>e.absolute||Ee.value&&typeof ze.value!="string")}),{isStuck:ze,stickyStyles:Ke}=VO({rootEl:Z,isSticky:Ee,layoutItemStyles:Se}),ct=Qi(ie(()=>typeof e.scrim=="string"?e.scrim:null)),nt=ie(()=>({...Y.value?{opacity:_e.value*.2,transition:"none"}:void 0,...be.value?{left:Yt(be.value.left),right:Yt(be.value.right),top:Yt(be.value.top),bottom:Yt(be.value.bottom)}:void 0,...De.value}));return sr({VList:{bgColor:"transparent"}}),Mt(()=>{var ft,Pe,at,Gt;const pt=c.image||e.image;return F(On,null,[F(e.tag,nn({ref:Z,onMouseenter:()=>de.value=!0,onMouseleave:()=>de.value=!1,class:["v-navigation-drawer",`v-navigation-drawer--${ce.value}`,{"v-navigation-drawer--expand-on-hover":e.expandOnHover,"v-navigation-drawer--floating":e.floating,"v-navigation-drawer--is-hovering":de.value,"v-navigation-drawer--rail":e.rail,"v-navigation-drawer--temporary":K.value,"v-navigation-drawer--active":R.value,"v-navigation-drawer--sticky":Ee.value},g.value,s.value,_.value,S.value,z.value],style:[w.value,Se.value,fe.value,$.value,Ke.value]},a),{default:()=>[pt&&F("div",{key:"image",class:"v-navigation-drawer__img"},[c.image?(ft=c.image)==null?void 0:ft.call(c,{image:e.image}):F("img",{src:e.image,alt:""},null)]),c.prepend&&F("div",{class:"v-navigation-drawer__prepend"},[(Pe=c.prepend)==null?void 0:Pe.call(c)]),F("div",{class:"v-navigation-drawer__content"},[(at=c.default)==null?void 0:at.call(c)]),c.append&&F("div",{class:"v-navigation-drawer__append"},[(Gt=c.append)==null?void 0:Gt.call(c)])]}),F(Fs,{name:"fade-transition"},{default:()=>[K.value&&(Y.value||R.value)&&!!e.scrim&&F("div",{class:["v-navigation-drawer__scrim",ct.backgroundColorClasses.value],style:[nt.value,ct.backgroundColorStyles.value],onClick:()=>R.value=!1},null)]})])}),{isStuck:ze}}});function ZO(e){var o,a,c;if(!zi)return;const d=Mr("useHydration"),g=d==null||(o=d.root)==null||(a=o.appContext)==null||(c=a.app)==null?void 0:c._container;return g!=null&&g.__vue_app__?e():Fn(e)}const WO=zt({name:"VNoSsr",setup(e,o){let{slots:a}=o;const c=Qe(!1);return ZO(()=>c.value=!0),()=>{var d;return c.value&&((d=a.default)==null?void 0:d.call(a))}}});function HO(){const e=Qe([]);bS(()=>e.value=[]);function o(a,c){e.value[c]=a}return{refs:e,updateRef:o}}const XO=zt({name:"VPagination",props:{activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:mn,default:"$first"},prevIcon:{type:mn,default:"$prev"},nextIcon:{type:mn,default:"$next"},lastIcon:{type:mn,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...vo(),...vr(),...lr(),...Di(),...xa(),...Sn({tag:"nav"}),...Kn(),...Vo({variant:"text"})},emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,o){let{slots:a,emit:c}=o;const d=En(e,"modelValue"),{t:g,n:_}=ls(),{isRtl:s}=ba(),{themeClasses:w}=wi(e),S=Qe(-1);sr(void 0,{scoped:!0});const{resizeRef:A}=zc(_e=>{if(!_e.length)return;const{target:fe,contentRect:ve}=_e[0],Se=fe.querySelector(".v-pagination__list > *");if(!Se)return;const be=ve.width,De=Se.offsetWidth+parseFloat(getComputedStyle(Se).marginRight)*2,ze=e.showFirstLastPage?5:3;S.value=Math.max(0,Math.floor(+((be-De*ze)/De).toFixed(2)))}),z=ie(()=>parseInt(e.length,10)),L=ie(()=>parseInt(e.start,10)),R=ie(()=>e.totalVisible?parseInt(e.totalVisible,10):S.value>=0?S.value:z.value),$=ie(()=>{if(z.value<=0||isNaN(z.value)||z.value>Number.MAX_SAFE_INTEGER)return[];if(R.value<=1)return[d.value];if(z.value<=R.value)return Sc(z.value,L.value);const _e=R.value%2===0,fe=_e?R.value/2:Math.floor(R.value/2),ve=_e?fe:fe+1,Se=z.value-fe;if(ve-d.value>=0)return[...Sc(Math.max(1,R.value-1),L.value),e.ellipsis,z.value];if(d.value-Se>=(_e?1:0)){const be=R.value-1,De=z.value-be+L.value;return[L.value,e.ellipsis,...Sc(be,De)]}else{const be=Math.max(1,R.value-3),De=be===1?d.value:d.value-Math.ceil(be/2)+L.value;return[L.value,e.ellipsis,...Sc(be,De),e.ellipsis,z.value]}});function Z(_e,fe,ve){_e.preventDefault(),d.value=fe,ve&&c(ve,fe)}const{refs:de,updateRef:ne}=HO();sr({VPaginationBtn:{color:St(e,"color"),border:St(e,"border"),density:St(e,"density"),size:St(e,"size"),variant:St(e,"variant"),rounded:St(e,"rounded"),elevation:St(e,"elevation")}});const ce=ie(()=>$.value.map((_e,fe)=>{const ve=Se=>ne(Se,fe);if(typeof _e=="string")return{isActive:!1,key:`ellipsis-${fe}`,page:_e,props:{ref:ve,ellipsis:!0,icon:!0,disabled:!0}};{const Se=_e===d.value;return{isActive:Se,key:_e,page:_(_e),props:{ref:ve,ellipsis:!1,icon:!0,disabled:!!e.disabled||e.length<2,color:Se?e.activeColor:e.color,ariaCurrent:Se,ariaLabel:g(Se?e.currentPageAriaLabel:e.pageAriaLabel,fe+1),onClick:be=>Z(be,_e)}}}})),K=ie(()=>{const _e=!!e.disabled||d.value<=L.value,fe=!!e.disabled||d.value>=L.value+z.value-1;return{first:e.showFirstLastPage?{icon:s.value?e.lastIcon:e.firstIcon,onClick:ve=>Z(ve,L.value,"first"),disabled:_e,ariaLabel:g(e.firstAriaLabel),ariaDisabled:_e}:void 0,prev:{icon:s.value?e.nextIcon:e.prevIcon,onClick:ve=>Z(ve,d.value-1,"prev"),disabled:_e,ariaLabel:g(e.previousAriaLabel),ariaDisabled:_e},next:{icon:s.value?e.prevIcon:e.nextIcon,onClick:ve=>Z(ve,d.value+1,"next"),disabled:fe,ariaLabel:g(e.nextAriaLabel),ariaDisabled:fe},last:e.showFirstLastPage?{icon:s.value?e.firstIcon:e.lastIcon,onClick:ve=>Z(ve,L.value+z.value-1,"last"),disabled:fe,ariaLabel:g(e.lastAriaLabel),ariaDisabled:fe}:void 0}});function Ee(){var _e;const fe=d.value-L.value;(_e=de.value[fe])==null||_e.$el.focus()}function Y(_e){_e.key===ly.left&&!e.disabled&&d.value>e.start?(d.value=d.value-1,Zi(Ee)):_e.key===ly.right&&!e.disabled&&d.value<L.value+z.value-1&&(d.value=d.value+1,Zi(Ee))}return Mt(()=>F(e.tag,{ref:A,class:["v-pagination",w.value],role:"navigation","aria-label":g(e.ariaLabel),onKeydown:Y,"data-test":"v-pagination-root"},{default:()=>[F("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&F("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[a.first?a.first(K.value.first):F(Fi,nn({_as:"VPaginationBtn"},K.value.first),null)]),F("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[a.prev?a.prev(K.value.prev):F(Fi,nn({_as:"VPaginationBtn"},K.value.prev),null)]),ce.value.map((_e,fe)=>F("li",{key:_e.key,class:["v-pagination__item",{"v-pagination__item--is-active":_e.isActive}],"data-test":"v-pagination-item"},[a.item?a.item(_e):F(Fi,nn({_as:"VPaginationBtn"},_e.props),{default:()=>[_e.page]})])),F("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[a.next?a.next(K.value.next):F(Fi,nn({_as:"VPaginationBtn"},K.value.next),null)]),e.showFirstLastPage&&F("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[a.last?a.last(K.value.last):F(Fi,nn({_as:"VPaginationBtn"},K.value.last),null)])])]})),{}}});function YO(e){return Math.floor(Math.abs(e))*Math.sign(e)}const KO=zt({name:"VParallax",props:{scale:{type:[Number,String],default:.5}},setup(e,o){let{slots:a}=o;const{intersectionRef:c,isIntersecting:d}=S0(),{resizeRef:g,contentRect:_}=zc(),{height:s}=jg(),w=Qe();Vs(()=>{var R;c.value=g.value=(R=w.value)==null?void 0:R.$el});let S;Ye(d,R=>{R?(S=xT(c.value),S=S===document.scrollingElement?document:S,S.addEventListener("scroll",L,{passive:!0}),L()):S.removeEventListener("scroll",L)}),Ii(()=>{var R;(R=S)==null||R.removeEventListener("scroll",L)}),Ye(s,L),Ye(()=>{var R;return(R=_.value)==null?void 0:R.height},L);const A=ie(()=>1-Mo(+e.scale));let z=-1;function L(){!d.value||(cancelAnimationFrame(z),z=requestAnimationFrame(()=>{var _e,fe;var R;const $=((R=w.value)==null?void 0:R.$el).querySelector(".v-img__img");if(!$)return;const Z=(_e=S.clientHeight)!=null?_e:document.documentElement.clientHeight,de=(fe=S.scrollTop)!=null?fe:window.scrollY,ne=c.value.offsetTop,ce=_.value.height,K=ne+(ce-Z)/2,Ee=YO((de-K)*A.value),Y=Math.max(1,(A.value*(Z-ce)+ce)/ce);$.style.setProperty("transform",`translateY(${Ee}px) scale(${Y})`)}))}return Mt(()=>F(Eh,{class:["v-parallax",{"v-parallax--active":d.value}],ref:w,cover:!0,onLoadstart:L,onLoad:L},a)),{}}}),JO=zt({name:"VRadio",props:{...qg({falseIcon:"$radioOff",trueIcon:"$radioOn"})},setup(e,o){let{slots:a}=o;return Mt(()=>F(qf,nn(e,{class:"v-radio",type:"radio"}),a)),{}}});const QO=zt({name:"VRadioGroup",inheritAttrs:!1,props:{height:{type:[Number,String],default:"auto"},...Sa(),...Bg(R0(),["multiple"]),trueIcon:{type:mn,default:"$radioOn"},falseIcon:{type:mn,default:"$radioOff"},type:{type:String,default:"radio"}},emits:{"update:modelValue":e=>!0},setup(e,o){let{attrs:a,slots:c}=o;const d=Gr(),g=ie(()=>e.id||`radio-group-${d}`),_=En(e,"modelValue");return Mt(()=>{const[s,w]=Oc(a),[S,A]=wl(e),[z,L]=x2({...e,multiple:!1}),R=c.label?c.label({label:e.label,props:{for:g.value}}):e.label;return F(Us,nn({class:"v-radio-group"},s,S,{modelValue:_.value,"onUpdate:modelValue":$=>_.value=$,id:g.value}),{...c,default:$=>{let{id:Z,isDisabled:de,isReadonly:ne}=$;return F(On,null,[R&&F(Sh,{for:Z.value,clickable:!0},{default:()=>[R]}),F(y2,nn(z,{id:Z.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:de.value,readonly:ne.value},w,{modelValue:_.value,"onUpdate:modelValue":ce=>_.value=ce}),c)])}})}),{}}}),e3=zt({name:"VRangeSlider",props:{...Gg(),...Sa(),...sC(),strict:Boolean,modelValue:{type:Array,default:()=>[0,0]}},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=Qe(),d=Qe(),g=Qe();function _(fe){if(!c.value||!d.value)return;const ve=Iy(fe,c.value.$el,e.direction),Se=Iy(fe,d.value.$el,e.direction),be=Math.abs(ve),De=Math.abs(Se);return be<De||be===De&&ve<0?c.value.$el:d.value.$el}const{activeThumbRef:s,hasLabels:w,max:S,min:A,mousePressed:z,onSliderMousedown:L,onSliderTouchstart:R,position:$,roundValue:Z,trackContainerRef:de}=aC({props:e,handleSliderMouseUp:fe=>{var ve;ne.value=s.value===((ve=c.value)==null?void 0:ve.$el)?[fe,ne.value[1]]:[ne.value[0],fe]},handleMouseMove:fe=>{var ve;const[Se,be]=ne.value;if(!e.strict&&Se===be&&Se!==A.value){var De,ze,Ke;s.value=fe>Se?(De=d.value)==null?void 0:De.$el:(ze=c.value)==null?void 0:ze.$el,(Ke=s.value)==null||Ke.focus()}s.value===((ve=c.value)==null?void 0:ve.$el)?ne.value=[Math.min(fe,be),be]:ne.value=[Se,Math.max(Se,fe)]},getActiveThumb:_}),ne=En(e,"modelValue",void 0,fe=>!fe||!fe.length?[0,0]:fe.map(ve=>Z(ve))),{isFocused:ce,focus:K,blur:Ee}=Gc(e),Y=ie(()=>$(ne.value[0])),_e=ie(()=>$(ne.value[1]));return Mt(()=>{const[fe,ve]=wl(e),Se=!!(e.label||a.label||a.prepend);return F(Us,nn({class:["v-slider","v-range-slider",{"v-slider--has-labels":!!a["tick-label"]||w.value,"v-slider--focused":ce.value,"v-slider--pressed":z.value,"v-slider--disabled":e.disabled}],ref:g},fe,{focused:ce.value}),{...a,prepend:Se?be=>{var Ke;var De,ze;return F(On,null,[((Ke=(De=a.label)==null?void 0:De.call(a,be))!=null?Ke:e.label)?F(Sh,{class:"v-slider__label",text:e.label},null):void 0,(ze=a.prepend)==null?void 0:ze.call(a,be)])}:void 0,default:be=>{var De,ze;let{id:Ke}=be;return F("div",{class:"v-slider__container",onMousedown:L,onTouchstartPassive:R},[F("input",{id:`${Ke.value}_start`,name:e.name||Ke.value,disabled:e.disabled,readonly:e.readonly,tabindex:"-1",value:ne.value[0]},null),F("input",{id:`${Ke.value}_stop`,name:e.name||Ke.value,disabled:e.disabled,readonly:e.readonly,tabindex:"-1",value:ne.value[1]},null),F(lC,{ref:de,start:Y.value,stop:_e.value},{"tick-label":a["tick-label"]}),F(Ay,{ref:c,focused:ce&&s.value===((De=c.value)==null?void 0:De.$el),modelValue:ne.value[0],"onUpdate:modelValue":ct=>ne.value=[ct,ne.value[1]],onFocus:ct=>{var nt,ft;if(K(),s.value=(nt=c.value)==null?void 0:nt.$el,ne.value[0]===ne.value[1]&&ne.value[1]===A.value&&ct.relatedTarget!==((ft=d.value)==null?void 0:ft.$el)){var Pe,at;(Pe=c.value)==null||Pe.$el.blur(),(at=d.value)==null||at.$el.focus()}},onBlur:()=>{Ee(),s.value=void 0},min:A.value,max:ne.value[1],position:Y.value},{"thumb-label":a["thumb-label"]}),F(Ay,{ref:d,focused:ce&&s.value===((ze=d.value)==null?void 0:ze.$el),modelValue:ne.value[1],"onUpdate:modelValue":ct=>ne.value=[ne.value[0],ct],onFocus:ct=>{var nt,ft;if(K(),s.value=(nt=d.value)==null?void 0:nt.$el,ne.value[0]===ne.value[1]&&ne.value[0]===S.value&&ct.relatedTarget!==((ft=c.value)==null?void 0:ft.$el)){var Pe,at;(Pe=d.value)==null||Pe.$el.blur(),(at=c.value)==null||at.$el.focus()}},onBlur:()=>{Ee(),s.value=void 0},min:ne.value[0],max:S.value,position:_e.value},{"thumb-label":a["thumb-label"]})])}})}),{}}});const t3=Li()({name:"VRating",props:{name:String,itemAriaLabel:{type:String,default:"$vuetify.rating.ariaLabel.item"},activeColor:String,color:String,clearable:Boolean,disabled:Boolean,emptyIcon:{type:mn,default:"$ratingEmpty"},fullIcon:{type:mn,default:"$ratingFull"},halfIncrements:Boolean,hover:Boolean,length:{type:[Number,String],default:5},readonly:Boolean,modelValue:{type:Number,default:0},itemLabels:Array,itemLabelPosition:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},ripple:Boolean,...vr(),...xa(),...Sn(),...Kn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{t:c}=ls(),{themeClasses:d}=wi(e),g=En(e,"modelValue"),_=ie(()=>Sc(Number(e.length),1)),s=ie(()=>_.value.flatMap(K=>e.halfIncrements?[K-.5,K]:[K])),w=Qe(-1),S=Qe(-1),A=Qe();let z=!1;const L=ie(()=>s.value.map(K=>{var De;const Ee=e.hover&&w.value>-1,Y=g.value>=K,_e=w.value>=K,ve=(Ee?_e:Y)?e.fullIcon:e.emptyIcon,Se=(De=e.activeColor)!=null?De:e.color,be=Y||_e?Se:e.color;return{isFilled:Y,isHovered:_e,icon:ve,color:be}})),R=ie(()=>[0,...s.value].map(K=>{function Ee(){w.value=K}function Y(){w.value=-1}function _e(){if(K===0&&g.value===0){var Se;(Se=A.value)==null||Se.focus()}else S.value=K}function fe(){z||(S.value=-1)}function ve(){e.disabled||e.readonly||(g.value=g.value===K&&e.clearable?0:K)}return{onMouseenter:e.hover?Ee:void 0,onMouseleave:e.hover?Y:void 0,onFocus:_e,onBlur:fe,onClick:ve}}));function $(){z=!0}function Z(){z=!1}const de=ie(()=>{var K;return(K=e.name)!=null?K:`v-rating-${Gr()}`});function ne(K){var Ee,Y;let{value:_e,index:fe,showStar:ve=!0}=K;const{onMouseenter:Se,onMouseleave:be,onFocus:De,onBlur:ze,onClick:Ke}=R.value[fe+1],ct=`${de.value}-${String(_e).replace(".","-")}`,nt={color:(Ee=L.value[fe])==null?void 0:Ee.color,density:e.density,disabled:e.disabled,icon:(Y=L.value[fe])==null?void 0:Y.icon,ripple:e.ripple,size:e.size,tag:"span",variant:"plain"};return F(On,null,[F("label",{for:ct,class:{"v-rating__item--half":e.halfIncrements&&_e%1>0,"v-rating__item--full":e.halfIncrements&&_e%1===0},onMousedown:$,onMouseup:Z,onMouseenter:Se,onMouseleave:be},[F("span",{class:"v-rating__hidden"},[c(e.itemAriaLabel,_e,e.length)]),ve?a.item?a.item({...L.value[fe],props:nt,value:_e,index:fe}):F(Fi,nt,null):void 0]),F("input",{class:"v-rating__hidden",name:de.value,id:ct,type:"radio",value:_e,checked:g.value===_e,onClick:Ke,onFocus:De,onBlur:ze,ref:fe===0?A:void 0,readonly:e.readonly,disabled:e.disabled},null)])}function ce(K){return a["item-label"]?a["item-label"](K):K.label?F("span",null,[K.label]):F("span",null,[Ds("\xA0")])}return Mt(()=>{var K;const Ee=!!((K=e.itemLabels)!=null&&K.length)||a["item-label"];return F(e.tag,{class:["v-rating",{"v-rating--hover":e.hover,"v-rating--readonly":e.readonly},d.value]},{default:()=>[F(ne,{value:0,index:-1,showStar:!1},null),_.value.map((Y,_e)=>{var fe,ve;return F("div",{class:"v-rating__wrapper"},[Ee&&e.itemLabelPosition==="top"?ce({value:Y,index:_e,label:(fe=e.itemLabels)==null?void 0:fe[_e]}):void 0,F("div",{class:["v-rating__item",{"v-rating__item--focused":Math.ceil(S.value)===Y}]},[e.halfIncrements?F(On,null,[F(ne,{value:Y-.5,index:_e*2},null),F(ne,{value:Y,index:_e*2+1},null)]):F(ne,{value:Y,index:_e},null)]),Ee&&e.itemLabelPosition==="bottom"?ce({value:Y,index:_e,label:(ve=e.itemLabels)==null?void 0:ve[_e]}):void 0])})]})}),{}}});function uE(e){const a=Math.abs(e);return Math.sign(e)*(a/((1/.501-2)*(1-a)+1))}function hE(e){let{selectedElement:o,containerSize:a,contentSize:c,isRtl:d,currentScrollOffset:g,isHorizontal:_}=e;const s=_?o.clientWidth:o.clientHeight,w=_?o.offsetLeft:o.offsetTop,S=d&&_?c-w-s:w,A=a+g,z=s+S,L=s*.4;return S<=g?g=Math.max(S-L,0):A<=z&&(g=Math.min(g-(A-z-L),c-a)),g}function n3(e){let{selectedElement:o,containerSize:a,contentSize:c,isRtl:d,isHorizontal:g}=e;const _=g?o.clientWidth:o.clientHeight,s=g?o.offsetLeft:o.offsetTop,w=d&&g?c-s-_/2-a/2:s+_/2-a/2;return Math.min(c-a,Math.max(0,w))}const mC=Symbol.for("vuetify:v-slide-group"),gC=Li()({name:"VSlideGroup",props:{centerActive:Boolean,direction:{type:String,default:"horizontal"},symbol:{type:null,default:mC},nextIcon:{type:mn,default:"$next"},prevIcon:{type:mn,default:"$prev"},showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["always","desktop","mobile"].includes(e)},...Sn(),...mh({selectedClass:"v-slide-group-item--active"})},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const{isRtl:c}=ba(),{mobile:d}=jg(),g=Vc(e,e.symbol),_=Qe(!1),s=Qe(0),w=Qe(0),S=Qe(0),A=ie(()=>e.direction==="horizontal"),{resizeRef:z,contentRect:L}=zc(),{resizeRef:R,contentRect:$}=zc(),Z=ie(()=>g.selected.value.length?g.items.value.findIndex(pt=>pt.id===g.selected.value[0]):-1),de=ie(()=>g.selected.value.length?g.items.value.findIndex(pt=>pt.id===g.selected.value[g.selected.value.length-1]):-1);if(zi){let pt=-1;Ye(()=>[g.selected.value,L.value,$.value,A.value],()=>{cancelAnimationFrame(pt),pt=requestAnimationFrame(()=>{if(L.value&&$.value){const Lt=A.value?"width":"height";w.value=L.value[Lt],S.value=$.value[Lt],_.value=w.value+1<S.value}if(Z.value>=0&&R.value){const Lt=R.value.children[de.value];Z.value===0||!_.value?s.value=0:e.centerActive?s.value=n3({selectedElement:Lt,containerSize:w.value,contentSize:S.value,isRtl:c.value,isHorizontal:A.value}):_.value&&(s.value=hE({selectedElement:Lt,containerSize:w.value,contentSize:S.value,isRtl:c.value,currentScrollOffset:s.value,isHorizontal:A.value}))}})})}const ne=Qe(!1);let ce=0,K=0;function Ee(pt){const Lt=A.value?"clientX":"clientY";K=(c.value&&A.value?-1:1)*s.value,ce=pt.touches[0][Lt],ne.value=!0}function Y(pt){if(!_.value)return;const Lt=A.value?"clientX":"clientY",qt=c.value&&A.value?-1:1;s.value=qt*(K+ce-pt.touches[0][Lt])}function _e(pt){const Lt=S.value-w.value;s.value<0||!_.value?s.value=0:s.value>=Lt&&(s.value=Lt),ne.value=!1}function fe(){!z.value||(z.value[A.value?"scrollLeft":"scrollTop"]=0)}const ve=Qe(!1);function Se(pt){if(ve.value=!0,!(!_.value||!R.value)){for(const Lt of pt.composedPath())for(const qt of R.value.children)if(qt===Lt){s.value=hE({selectedElement:qt,containerSize:w.value,contentSize:S.value,isRtl:c.value,currentScrollOffset:s.value,isHorizontal:A.value});return}}}function be(pt){ve.value=!1}function De(pt){var Lt;!ve.value&&!(pt.relatedTarget&&(Lt=R.value)!=null&&Lt.contains(pt.relatedTarget))&&Ke()}function ze(pt){!R.value||(A.value?pt.key==="ArrowRight"?Ke(c.value?"prev":"next"):pt.key==="ArrowLeft"&&Ke(c.value?"next":"prev"):pt.key==="ArrowDown"?Ke("next"):pt.key==="ArrowUp"&&Ke("prev"),pt.key==="Home"?Ke("first"):pt.key==="End"&&Ke("last"))}function Ke(pt){if(!!R.value)if(pt){if(pt==="next"){var qt;const bt=(qt=R.value.querySelector(":focus"))==null?void 0:qt.nextElementSibling;bt?bt.focus():Ke("first")}else if(pt==="prev"){var Ln;const bt=(Ln=R.value.querySelector(":focus"))==null?void 0:Ln.previousElementSibling;bt?bt.focus():Ke("last")}else if(pt==="first"){var kt;(kt=R.value.firstElementChild)==null||kt.focus()}else if(pt==="last"){var Je;(Je=R.value.lastElementChild)==null||Je.focus()}}else{var Lt;(Lt=[...R.value.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')].filter(Tt=>!Tt.hasAttribute("disabled"))[0])==null||Lt.focus()}}function ct(pt){const Lt=s.value+(pt==="prev"?-1:1)*w.value;s.value=Mo(Lt,0,S.value-w.value)}const nt=ie(()=>{let pt=s.value>S.value-w.value?-(S.value-w.value)+uE(S.value-w.value-s.value):-s.value;s.value<=0&&(pt=uE(-s.value));const Lt=c.value&&A.value?-1:1;return{transform:`translate${A.value?"X":"Y"}(${Lt*pt}px)`,transition:ne.value?"none":"",willChange:ne.value?"transform":""}}),ft=ie(()=>({next:g.next,prev:g.prev,select:g.select,isSelected:g.isSelected})),Pe=ie(()=>{switch(e.showArrows){case"always":return!0;case"desktop":return!d.value;case!0:return _.value||Math.abs(s.value)>0;case"mobile":return d.value||_.value||Math.abs(s.value)>0;default:return!d.value&&(_.value||Math.abs(s.value)>0)}}),at=ie(()=>Math.abs(s.value)>0),Gt=ie(()=>S.value>Math.abs(s.value)+w.value);return Mt(()=>{var pt,Lt,qt;return F(e.tag,{class:["v-slide-group",{"v-slide-group--vertical":!A.value,"v-slide-group--has-affixes":Pe.value,"v-slide-group--is-overflowing":_.value}],tabindex:ve.value||g.selected.value.length?-1:0,onFocus:De},{default:()=>{var Ln,kt;return[Pe.value&&F("div",{key:"prev",class:["v-slide-group__prev",{"v-slide-group__prev--disabled":!at.value}],onClick:()=>ct("prev")},[(Ln=(pt=a.prev)==null?void 0:pt.call(a,ft.value))!=null?Ln:F(_y,null,{default:()=>[F(ir,{icon:c.value?e.nextIcon:e.prevIcon},null)]})]),F("div",{key:"container",ref:z,class:"v-slide-group__container",onScroll:fe},[F("div",{ref:R,class:"v-slide-group__content",style:nt.value,onTouchstartPassive:Ee,onTouchmovePassive:Y,onTouchendPassive:_e,onFocusin:Se,onFocusout:be,onKeydown:ze},[(Lt=a.default)==null?void 0:Lt.call(a,ft.value)])]),Pe.value&&F("div",{key:"next",class:["v-slide-group__next",{"v-slide-group__next--disabled":!Gt.value}],onClick:()=>ct("next")},[(kt=(qt=a.next)==null?void 0:qt.call(a,ft.value))!=null?kt:F(_y,null,{default:()=>[F(ir,{icon:c.value?e.prevIcon:e.nextIcon},null)]})])]}})}),{selected:g.selected,scrollTo:ct,scrollOffset:s,focus:Ke}}}),i3=Li()({name:"VSlideGroupItem",props:{...Fc()},emits:{"group:selected":e=>!0},setup(e,o){let{slots:a}=o;const c=gh(e,mC);return()=>{var d;return(d=a.default)==null?void 0:d.call(a,{isSelected:c.isSelected.value,select:c.select,toggle:c.toggle,selectedClass:c.selectedClass.value})}}});const r3=Li()({name:"VSnackbar",props:{multiLine:Boolean,timeout:{type:[Number,String],default:5e3},vertical:Boolean,...Uc({location:"bottom"}),...xh(),...Di(),...Vo(),...Bg(Wf({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=En(e,"modelValue"),{locationStyles:d}=jc(e),{positionClasses:g}=bh(e),{scopeId:_}=Hg(),{colorClasses:s,colorStyles:w,variantClasses:S}=$c(e),{roundedClasses:A}=er(e),z=Qe();Ye(c,R),Ye(()=>e.timeout,R),Fn(()=>{c.value&&R()});let L=-1;function R(){window.clearTimeout(L);const Z=Number(e.timeout);!c.value||Z===-1||(L=window.setTimeout(()=>{c.value=!1},Z))}function $(){window.clearTimeout(L)}return Mt(()=>{const[Z]=Wg(e);return F(Ch,nn({ref:z,class:["v-snackbar",{"v-snackbar--active":c.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--vertical":e.vertical},g.value]},Z,{modelValue:c.value,"onUpdate:modelValue":de=>c.value=de,contentProps:nn({style:d.value},Z.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none"},_),{default:()=>[F("div",{class:["v-snackbar__wrapper",s.value,A.value,S.value],style:[w.value],onPointerenter:$,onPointerleave:R},[Nc(!1,"v-snackbar"),a.default&&F("div",{class:"v-snackbar__content",role:"status","aria-live":"polite"},[a.default()]),a.actions&&F(Ti,{defaults:{VBtn:{variant:"text",ripple:!1}}},{default:()=>[F("div",{class:"v-snackbar__actions"},[a.actions()])]})])],activator:a.activator})}),cs({},z)}});const o3=zt({name:"VSwitch",inheritAttrs:!1,props:{indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Sa(),...qg()},emits:{"update:focused":e=>!0,"update:modelValue":()=>!0,"update:indeterminate":e=>!0},setup(e,o){let{attrs:a,slots:c}=o;const d=En(e,"indeterminate"),g=En(e,"modelValue"),{loaderClasses:_}=Vg(e),{isFocused:s,focus:w,blur:S}=Gc(e),A=ie(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),z=Gr(),L=ie(()=>e.id||`switch-${z}`);function R(){d.value&&(d.value=!1)}return Mt(()=>{const[$,Z]=Oc(a),[de,ne]=wl(e),[ce,K]=x2(e),Ee=Qe();function Y(){var _e,fe;(_e=Ee.value)==null||(fe=_e.input)==null||fe.click()}return F(Us,nn({class:["v-switch",{"v-switch--inset":e.inset},{"v-switch--indeterminate":d.value},_.value]},$,de,{id:L.value,focused:s.value}),{...c,default:_e=>{let{id:fe,isDisabled:ve,isReadonly:Se,isValid:be}=_e;return F(qf,nn({ref:Ee},ce,{modelValue:g.value,"onUpdate:modelValue":[De=>g.value=De,R],id:fe.value,type:"checkbox","aria-checked":d.value?"mixed":void 0,disabled:ve.value,readonly:Se.value,onFocus:w,onBlur:S},Z),{...c,default:()=>F("div",{class:"v-switch__track",onClick:Y},null),input:De=>{let{textColorClasses:ze,textColorStyles:Ke}=De;return F("div",{class:["v-switch__thumb",ze.value],style:Ke.value},[e.loading&&F(A0,{name:"v-switch",active:!0,color:be.value===!1?void 0:A.value},{default:ct=>c.loader?c.loader(ct):F(T0,{active:ct.isActive,color:ct.color,indeterminate:!0,size:"16",width:"2"},null)})])}})}})}),{}}});const s3=zt({name:"VSystemBar",props:{color:String,height:[Number,String],window:Boolean,...lr(),...vh(),...Di(),...Sn(),...Kn()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=wi(e),{backgroundColorClasses:d,backgroundColorStyles:g}=Qi(St(e,"color")),{elevationClasses:_}=Pr(e),{roundedClasses:s}=er(e),w=ie(()=>{var A;return(A=e.height)!=null?A:e.window?32:24}),{layoutItemStyles:S}=_h({id:e.name,order:ie(()=>parseInt(e.order,10)),position:Qe("top"),layoutSize:w,elementSize:w,active:ie(()=>!0),absolute:St(e,"absolute")});return Mt(()=>F(e.tag,{class:["v-system-bar",{"v-system-bar--window":e.window},c.value,d.value,_.value,s.value],style:[g.value,S.value]},a)),{}}});const vC=Symbol.for("vuetify:v-tabs"),_C=zt({name:"VTab",props:{fixed:Boolean,icon:[Boolean,String,Function,Object],prependIcon:mn,appendIcon:mn,stacked:Boolean,title:String,ripple:{type:Boolean,default:!0},color:String,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Sn(),...wh(),...Fc({selectedClass:"v-tab--selected"}),...Kn()},setup(e,o){let{slots:a,attrs:c}=o;const{textColorClasses:d,textColorStyles:g}=oo(e,"sliderColor"),_=ie(()=>e.direction==="horizontal"),s=Qe(!1),w=Qe(),S=Qe();function A(z){let{value:L}=z;if(s.value=L,L){var R,$;const Z=(R=w.value)==null||($=R.$el.parentElement)==null?void 0:$.querySelector(".v-tab--selected .v-tab__slider"),de=S.value;if(!Z||!de)return;const ne=getComputedStyle(Z).color,ce=Z.getBoundingClientRect(),K=de.getBoundingClientRect(),Ee=_.value?"x":"y",Y=_.value?"X":"Y",_e=_.value?"right":"bottom",fe=_.value?"width":"height",ve=ce[Ee],Se=K[Ee],be=ve>Se?ce[_e]-K[_e]:ce[Ee]-K[Ee],De=Math.sign(be)>0?_.value?"right":"bottom":Math.sign(be)<0?_.value?"left":"top":"center",Ke=(Math.abs(be)+(Math.sign(be)<0?ce[fe]:K[fe]))/Math.max(ce[fe],K[fe]),ct=ce[fe]/K[fe],nt=1.5;Tc(de,{backgroundColor:[ne,""],transform:[`translate${Y}(${be}px) scale${Y}(${ct})`,`translate${Y}(${be/nt}px) scale${Y}(${(Ke-1)/nt+1})`,""],transformOrigin:Array(3).fill(De)},{duration:225,easing:Mf})}}return Mt(()=>{const[z]=Bo(e,["href","to","replace","icon","stacked","prependIcon","appendIcon","ripple","theme","disabled","selectedClass","value","color"]);return F(Fi,nn({_as:"VTab",symbol:vC,ref:w,class:["v-tab"],tabindex:s.value?0:-1,role:"tab","aria-selected":String(s.value),active:!1,block:e.fixed,maxWidth:e.fixed?300:void 0,variant:"text",rounded:0},z,c,{"onGroup:selected":A}),{default:()=>[a.default?a.default():e.title,!e.hideSlider&&F("div",{ref:S,class:["v-tab__slider",d.value],style:g.value},null)]})}),{}}});function a3(e){return e?e.map(o=>typeof o=="string"?{title:o,value:o}:o):[]}const l3=zt({name:"VTabs",props:{alignTabs:{type:String,default:"start"},color:String,direction:{type:String,default:"horizontal"},fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,modelValue:null,mandatory:{type:[Boolean,String],default:"force"},...vr(),...Sn()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=En(e,"modelValue"),d=ie(()=>a3(e.items)),{densityClasses:g}=qr(e),{backgroundColorClasses:_,backgroundColorStyles:s}=Qi(St(e,"bgColor"));return sr({VTab:{color:St(e,"color"),direction:St(e,"direction"),stacked:St(e,"stacked"),fixed:St(e,"fixedTabs"),sliderColor:St(e,"sliderColor"),hideSlider:St(e,"hideSlider")}}),Mt(()=>F(gC,{modelValue:c.value,"onUpdate:modelValue":w=>c.value=w,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},g.value,_.value],style:[{"--v-tabs-height":Yt(e.height)},s.value],role:"tablist",symbol:vC,mandatory:e.mandatory,direction:e.direction},{default:()=>[a.default?a.default():d.value.map(w=>F(_C,nn(w,{key:w.title}),null))]})),{}}});const c3=zt({name:"VTable",props:{fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...vr(),...Sn(),...Kn()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=wi(e),{densityClasses:d}=qr(e);return Mt(()=>{var g,_;return F(e.tag,{class:["v-table",{"v-table--fixed-height":!!e.height,"v-table--fixed-header":e.fixedHeader,"v-table--fixed-footer":e.fixedFooter,"v-table--has-top":!!a.top,"v-table--has-bottom":!!a.bottom,"v-table--hover":e.hover},c.value,d.value]},{default:()=>[(g=a.top)==null?void 0:g.call(a),a.default&&F("div",{class:"v-table__wrapper",style:{height:Yt(e.height)}},[F("table",null,[a.default()])]),(_=a.bottom)==null?void 0:_.call(a)]})}),{}}});const u3=zt({name:"VTextarea",directives:{Intersect:Ug},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,hint:String,persistentHint:Boolean,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,...Sa(),...Xg()},emits:{"click:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,o){let{attrs:a,emit:c,slots:d}=o;const g=En(e,"modelValue"),{isFocused:_,focus:s,blur:w}=Gc(e),S=ie(()=>typeof e.counterValue=="function"?e.counterValue(g.value):(g.value||"").toString().length),A=ie(()=>{if(a.maxlength)return a.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function z(Se,be){var De,ze;!e.autofocus||!Se||(De=be[0].target)==null||(ze=De.focus)==null||ze.call(De)}const L=Qe(),R=Qe(),$=Qe(""),Z=Qe(),de=ie(()=>_.value||e.persistentPlaceholder),ne=ie(()=>e.messages.length?e.messages:de.value||e.persistentHint?e.hint:"");function ce(){if(Z.value!==document.activeElement){var Se;(Se=Z.value)==null||Se.focus()}_.value||s()}function K(Se){ce(),c("click:control",Se)}function Ee(Se){Se.stopPropagation(),ce(),Zi(()=>{g.value="",ug(e["onClick:clear"],Se)})}function Y(Se){g.value=Se.target.value}const _e=Qe();function fe(){!e.autoGrow||Zi(()=>{if(!_e.value||!R.value)return;const Se=getComputedStyle(_e.value),be=getComputedStyle(R.value.$el),De=parseFloat(Se.getPropertyValue("--v-field-padding-top"))+parseFloat(Se.getPropertyValue("--v-input-padding-top"))+parseFloat(Se.getPropertyValue("--v-field-padding-bottom")),ze=_e.value.scrollHeight,Ke=parseFloat(Se.lineHeight),ct=Math.max(parseFloat(e.rows)*Ke+De,parseFloat(be.getPropertyValue("--v-input-control-height"))),nt=parseFloat(e.maxRows)*Ke+De||1/0;$.value=Yt(Mo(ze!=null?ze:0,ct,nt))})}Fn(fe),Ye(g,fe),Ye(()=>e.rows,fe),Ye(()=>e.maxRows,fe),Ye(()=>e.density,fe);let ve;return Ye(_e,Se=>{if(Se)ve=new ResizeObserver(fe),ve.observe(_e.value);else{var be;(be=ve)==null||be.disconnect()}}),Ii(()=>{var Se;(Se=ve)==null||Se.disconnect()}),Mt(()=>{const Se=!!(d.counter||e.counter||e.counterValue),be=!!(Se||d.details),[De,ze]=Oc(a),[{modelValue:Ke,...ct}]=wl(e),[nt]=N0(e);return F(Us,nn({ref:L,modelValue:g.value,"onUpdate:modelValue":ft=>g.value=ft,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(e.variant)}],"onClick:prepend":e["onClick:prepend"],"onClick:append":e["onClick:append"]},De,ct,{focused:_.value,messages:ne.value}),{...d,default:ft=>{let{isDisabled:Pe,isDirty:at,isReadonly:Gt,isValid:pt}=ft;return F(Xf,nn({ref:R,style:{"--v-textarea-control-height":$.value},"onClick:control":K,"onClick:clear":Ee,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},nt,{active:de.value||at.value,dirty:at.value||e.dirty,focused:_.value,error:pt.value===!1}),{...d,default:Lt=>{let{props:{class:qt,...Ln}}=Lt;return F(On,null,[e.prefix&&F("span",{class:"v-text-field__prefix"},[e.prefix]),Wi(F("textarea",nn({ref:Z,class:qt,value:g.value,onInput:Y,autofocus:e.autofocus,readonly:Gt.value,disabled:Pe.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:ce,onBlur:w},Ln,ze),null),[[mo("intersect"),{handler:z},null,{once:!0}]]),e.autoGrow&&Wi(F("textarea",{class:[qt,"v-textarea__sizer"],"onUpdate:modelValue":kt=>g.value=kt,ref:_e,readonly:!0,"aria-hidden":"true"},null),[[NP,g.value]]),e.suffix&&F("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:be?ft=>{var Pe;return F(On,null,[(Pe=d.details)==null?void 0:Pe.call(d,ft),Se&&F(On,null,[F("span",null,null),F(Yg,{active:e.persistentCounter||_.value,value:S.value,max:A.value},d.counter)])])}:void 0})}),cs({},L,R,Z)}});const h3=zt({name:"VThemeProvider",props:{withBackground:Boolean,...Kn(),...Sn()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=wi(e);return()=>{var d,g;return e.withBackground?F(e.tag,{class:["v-theme-provider",c.value]},{default:()=>[(g=a.default)==null?void 0:g.call(a)]}):(d=a.default)==null?void 0:d.call(a)}}});const d3=zt({name:"VTimeline",props:{align:{type:String,default:"center",validator:e=>["center","start"].includes(e)},direction:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},justify:{type:String,default:"auto",validator:e=>["auto","center"].includes(e)},side:{type:String,validator:e=>e==null||["start","end"].includes(e)},lineInset:{type:[String,Number],default:0},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:e=>["start","end","both"].includes(e)},...vr(),...Sn(),...Kn()},setup(e,o){let{slots:a}=o;const{themeClasses:c}=wi(e),{densityClasses:d}=qr(e);sr({VTimelineDivider:{lineColor:St(e,"lineColor")},VTimelineItem:{density:St(e,"density"),lineInset:St(e,"lineInset")}});const g=ie(()=>{const s=e.side?e.side:e.density!=="default"?"end":null;return s&&`v-timeline--side-${s}`}),_=ie(()=>{const s=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(e.truncateLine){case"both":return s;case"start":return s[0];case"end":return s[1];default:return null}});return Mt(()=>F(e.tag,{class:["v-timeline",`v-timeline--${e.direction}`,`v-timeline--align-${e.align}`,`v-timeline--justify-${e.justify}`,_.value,{"v-timeline--inset-line":!!e.lineInset},c.value,d.value,g.value],style:{"--v-timeline-line-thickness":Yt(e.lineThickness)}},a)),{}}}),f3=zt({name:"VTimelineDivider",props:{dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:mn,iconColor:String,lineColor:String,...Di(),...xa(),...lr()},setup(e,o){let{slots:a}=o;const{sizeClasses:c,sizeStyles:d}=yh(e,"v-timeline-divider__dot"),{backgroundColorStyles:g,backgroundColorClasses:_}=Qi(St(e,"dotColor")),{roundedClasses:s}=er(e,"v-timeline-divider__dot"),{elevationClasses:w}=Pr(e),{backgroundColorClasses:S,backgroundColorStyles:A}=Qi(St(e,"lineColor"));return sr({VIcon:{color:St(e,"iconColor"),icon:St(e,"icon"),size:St(e,"size")}}),Mt(()=>{var L;var z;return F("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":e.fillDot}]},[F("div",{class:["v-timeline-divider__before",S.value],style:A.value},null),!e.hideDot&&F("div",{key:"dot",class:["v-timeline-divider__dot",w.value,s.value,c.value],style:d.value},[F("div",{class:["v-timeline-divider__inner-dot",_.value,s.value],style:g.value},[(L=(z=a.default)==null?void 0:z.call(a))!=null?L:e.icon?F(ir,null,null):void 0])]),F("div",{class:["v-timeline-divider__after",S.value],style:A.value},null)])}),{}}}),p3=zt({name:"VTimelineItem",props:{density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:mn,iconColor:String,lineInset:[Number,String],...Di(),...lr(),...xa(),...Sn(),...ss()},setup(e,o){let{slots:a}=o;const{dimensionStyles:c}=as(e),d=Qe(0),g=Qe();return Ye(g,_=>{var w;var s;!_||(d.value=(w=(s=_.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:s.getBoundingClientRect().width)!=null?w:0)},{flush:"post"}),Mt(()=>{var _,s;return F("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":e.fillDot}],style:{"--v-timeline-dot-size":Yt(d.value),"--v-timeline-line-inset":e.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${Yt(e.lineInset)})`:Yt(0)}},[F("div",{class:"v-timeline-item__body",style:c.value},[(_=a.default)==null?void 0:_.call(a)]),F(f3,{ref:g,hideDot:e.hideDot,icon:e.icon,iconColor:e.iconColor,size:e.size,elevation:e.elevation,dotColor:e.dotColor,fillDot:e.fillDot,rounded:e.rounded},{default:a.icon}),e.density!=="compact"&&F("div",{class:"v-timeline-item__opposite"},[!e.hideOpposite&&((s=a.opposite)==null?void 0:s.call(a))])])}),{}}});const m3=Li()({name:"VTooltip",props:{id:String,text:String,...Bg(Wf({closeOnBack:!1,location:"end",locationStrategy:"connected",minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent","eager"])},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=En(e,"modelValue"),{scopeId:d}=Hg(),g=Gr(),_=ie(()=>e.id||`v-tooltip-${g}`),s=Qe(),w=ie(()=>e.location.split(" ").length>1?e.location:e.location+" center"),S=ie(()=>e.origin==="auto"||e.origin==="overlap"||e.origin.split(" ").length>1||e.location.split(" ").length>1?e.origin:e.origin+" center"),A=ie(()=>e.transition?e.transition:c.value?"scale-transition":"fade-transition");return Mt(()=>{const[z]=Wg(e);return F(Ch,nn({ref:s,class:["v-tooltip"],id:_.value},z,{modelValue:c.value,"onUpdate:modelValue":L=>c.value=L,transition:A.value,absolute:!0,location:w.value,origin:S.value,persistent:!0,role:"tooltip",eager:!0,activatorProps:nn({"aria-describedby":_.value},e.activatorProps)},d),{activator:a.activator,default:function(){var de;for(var L,R=arguments.length,$=new Array(R),Z=0;Z<R;Z++)$[Z]=arguments[Z];return(de=(L=a.default)==null?void 0:L.call(a,...$))!=null?de:e.text}})}),cs({},s)}}),g3=zt({name:"VValidation",props:{...m2()},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:a}=o;const c=g2(e,"validation");return()=>{var d;return(d=a.default)==null?void 0:d.call(a,c)}}}),v3=Object.freeze(Object.defineProperty({__proto__:null,VApp:zR,VAppBar:o2,VAppBarNavIcon:UD,VAppBarTitle:GD,VAlert:DR,VAlertTitle:d2,VAutocomplete:MB,VAvatar:_l,VBadge:PB,VBanner:zB,VBannerActions:Z2,VBannerText:W2,VBottomNavigation:IT,VBreadcrumbs:LB,VBreadcrumbsItem:X2,VBreadcrumbsDivider:H2,VBtn:Fi,VBtnGroup:CT,VBtnToggle:qL,VCard:j0,VCardActions:Y2,VCardItem:Q2,VCardSubtitle:K2,VCardText:U0,VCardTitle:J2,VCarousel:$B,VCarouselItem:UB,VCheckbox:NR,VCheckboxBtn:Th,VChip:Zf,VChipGroup:UR,VCode:jB,VColorPicker:EO,VCombobox:TO,VCounter:Yg,VDefaultsProvider:Ti,VDialog:CO,VDivider:E2,VExpansionPanels:AO,VExpansionPanel:kO,VExpansionPanelText:dC,VExpansionPanelTitle:hC,VField:Xf,VFieldLabel:af,VFileInput:MO,VFooter:PO,VForm:zO,VContainer:gD,VCol:yD,VRow:CD,VSpacer:vy,VHover:LO,VIcon:ir,VComponentIcon:AT,VSvgIcon:kT,VLigatureIcon:HL,VClassIcon:E0,VImg:Eh,VInput:Us,VItemGroup:DO,VItem:RO,VKbd:BO,VLabel:Sh,VLayout:s2,VLayoutItem:HD,VLazy:OO,VList:Ta,VListGroup:O0,VListImg:nB,VListItem:qi,VListItemAction:iB,VListItemMedia:rB,VListItemSubtitle:M2,VListItemTitle:P2,VListSubheader:z2,VLocaleProvider:FO,VMain:a2,VMenu:Hf,VMessages:f2,VNavigationDrawer:pC,VNoSsr:WO,VOverlay:Ch,VPagination:XO,VParallax:KO,VProgressCircular:T0,VProgressLinear:C0,VRadio:JO,VRadioGroup:QO,VRangeSlider:e3,VRating:t3,VResponsive:t2,VSelect:CB,VSelectionControl:qf,VSelectionControlGroup:y2,VSheet:cC,VSlideGroup:gC,VSlideGroupItem:i3,VSlider:yg,VSnackbar:r3,VSwitch:o3,VSystemBar:s3,VTabs:l3,VTab:_C,VTable:c3,VTextarea:u3,VTextField:Kg,VThemeProvider:h3,VTimeline:d3,VTimelineItem:p3,VToolbar:vg,VToolbarTitle:gg,VToolbarItems:jD,VTooltip:m3,VValidation:g3,VWindow:nC,VWindowItem:iC,VDialogTransition:Ng,VFabTransition:AD,VDialogBottomTransition:kD,VDialogTopTransition:MD,VFadeTransition:_y,VScaleTransition:e2,VScrollXTransition:PD,VScrollXReverseTransition:zD,VScrollYTransition:LD,VScrollYReverseTransition:DD,VSlideXTransition:RD,VSlideXReverseTransition:BD,VSlideYTransition:z0,VSlideYReverseTransition:OD,VExpandTransition:$g,VExpandXTransition:L0},Symbol.toStringTag,{value:"Module"}));function _3(e,o){var z,L,R,$;const a=o.modifiers||{},c=o.value,{once:d,immediate:g,..._}=a,s=!Object.keys(_).length,{handler:w,options:S}=typeof c=="object"?c:{handler:c,options:{attributes:(z=_==null?void 0:_.attr)!=null?z:s,characterData:(L=_==null?void 0:_.char)!=null?L:s,childList:(R=_==null?void 0:_.child)!=null?R:s,subtree:($=_==null?void 0:_.sub)!=null?$:s}},A=new MutationObserver(function(){let Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],de=arguments.length>1?arguments[1]:void 0;w==null||w(Z,de),d&&yC(e,o)});g&&(w==null||w([],A)),e._mutate=Object(e._mutate),e._mutate[o.instance.$.uid]={observer:A},A.observe(e,S)}function yC(e,o){var a;!((a=e._mutate)!=null&&a[o.instance.$.uid])||(e._mutate[o.instance.$.uid].observer.disconnect(),delete e._mutate[o.instance.$.uid])}const y3={mounted:_3,unmounted:yC};function x3(e,o){var a,c;const d=o.value,g={passive:!((a=o.modifiers)!=null&&a.active)};window.addEventListener("resize",d,g),e._onResize=Object(e._onResize),e._onResize[o.instance.$.uid]={handler:d,options:g},(c=o.modifiers)!=null&&c.quiet||d()}function b3(e,o){var a;if(!((a=e._onResize)!=null&&a[o.instance.$.uid]))return;const{handler:c,options:d}=e._onResize[o.instance.$.uid];window.removeEventListener("resize",c,d),delete e._onResize[o.instance.$.uid]}const w3={mounted:x3,unmounted:b3};function xC(e,o){var s;const{self:a=!1}=(s=o.modifiers)!=null?s:{},c=o.value,d=typeof c=="object"&&c.options||{passive:!0},g=typeof c=="function"||"handleEvent"in c?c:c.handler,_=a?e:o.arg?document.querySelector(o.arg):window;!_||(_.addEventListener("scroll",g,d),e._onScroll=Object(e._onScroll),e._onScroll[o.instance.$.uid]={handler:g,options:d,target:a?void 0:_})}function bC(e,o){var a;if(!((a=e._onScroll)!=null&&a[o.instance.$.uid]))return;const{handler:c,options:d,target:g=e}=e._onScroll[o.instance.$.uid];g.removeEventListener("scroll",c,d),delete e._onScroll[o.instance.$.uid]}function E3(e,o){o.value!==o.oldValue&&(bC(e,o),xC(e,o))}const S3={mounted:xC,unmounted:bC,updated:E3},T3=Object.freeze(Object.defineProperty({__proto__:null,ClickOutside:j2,Intersect:i2,Mutate:y3,Resize:w3,Ripple:bl,Scroll:S3,Touch:G0},Symbol.toStringTag,{value:"Module"})),C3={dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF",primary:"#f6f8fc",secondary:"#d5e0fc",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},fonts:{body:"Roboto",heading:"Roboto",button:"Roboto"}},I3=h2({components:v3,directives:T3,theme:{defaultTheme:"myCustomLightTheme",themes:{myCustomLightTheme:C3}}}),A3={};function k3(e,o){return bi(),jr(j0,null,{default:fi(()=>[F(pC,{"expand-on-hover":"",rail:"",width:"200",permanent:"",color:"primary",elevation:"0"},{default:fi(()=>[F(qi,{nav:""},{append:fi(()=>[]),_:1}),Uf(e.$slots,"default")]),_:3})]),_:3})}const Yf=wa(A3,[["render",k3]]),nf=gn({__name:"LeftIndex",setup(e){const o=fh(),{icons:a,toggleIcon:c}=ph({icons:{index:"mdi-map-outline",land:"mdi-tree-outline",elevation:"mdi-landslide-outline"},activeIcons:{index:"mdi-map",land:"mdi-tree",elevation:"mdi-landslide"},temp:{index:"mdi-map-outline",land:"mdi-tree-outline",elevation:"mdi-landslide-outline"}});function d(){o.push({name:"sub_index"}),c("index")}function g(){o.push({name:"land"}),c("land")}function _(){o.push({name:"elevation"}),c("elevation")}return(s,w)=>(bi(),jr(Yf,null,{default:fi(()=>[F(Ta,{density:"compact",nav:""},{default:fi(()=>[F(qi,{onClick:d,class:"rounded-end-pill","prepend-icon":Xn(a).index,title:"\u5168\u7403\u6838\u7535",value:"nuclear"},null,8,["prepend-icon"]),F(qi,{onClick:g,class:"rounded-end-pill","prepend-icon":Xn(a).land,title:"\u571F\u5730\u5229\u7528",value:"land"},null,8,["prepend-icon"]),F(qi,{onClick:_,class:"rounded-end-pill","prepend-icon":Xn(a).elevation,title:"\u5730\u5F62\u9AD8\u7A0B",value:"elevation"},null,8,["prepend-icon"])]),_:1})]),_:1}))}});const O_=gn({__name:"LeftFinance",setup(e){const o=fh(),{icons:a,toggleIcon:c}=ph({icons:{GDP:"mdi-bank-outline",density:"mdi-account-multiple-outline"},activeIcons:{GDP:"mdi-bank",density:"mdi-account-multiple"},temp:{GDP:"mdi-bank-outline",density:"mdi-account-multiple-outline"}});function d(){o.push({name:"gdp"}),c("GDP")}function g(){o.push({name:"density"}),c("density")}return(_,s)=>(bi(),jr(Yf,null,{default:fi(()=>[F(Ta,{density:"compact",nav:""},{default:fi(()=>[F(qi,{onClick:d,class:"rounded-end-pill","prepend-icon":Xn(a).GDP,title:"\u56FD\u6C11\u751F\u4EA7\u603B\u503C",value:"GDP"},null,8,["prepend-icon"]),F(qi,{onClick:g,class:"rounded-end-pill","prepend-icon":Xn(a).density,title:"\u4EBA\u53E3\u5BC6\u5EA6",value:"density"},null,8,["prepend-icon"])]),_:1})]),_:1}))}});const qm=gn({__name:"LeftMeteorology",setup(e){const o=fh(),{icons:a,toggleIcon:c}=ph({icons:{weather:"mdi-cloud-percent-outline",typhoon:"mdi-lightning-bolt-outline",inversion:"mdi-chart-areaspline"},activeIcons:{weather:"mdi-cloud-percent",typhoon:"mdi-lightning-bolt",inversion:"mdi-chart-areaspline-variant"},temp:{weather:"mdi-cloud-percent-outline",typhoon:"mdi-lightning-bolt-outline",inversion:"mdi-chart-areaspline"}});function d(){o.push({name:"weather"}),c("weather")}function g(){o.push({name:"typhoon"}),c("typhoon")}function _(){o.push({name:"inversion"}),c("inversion")}return(s,w)=>(bi(),jr(Yf,null,{default:fi(()=>[F(Ta,{density:"compact",nav:""},{default:fi(()=>[F(qi,{onClick:d,class:"rounded-end-pill","prepend-icon":Xn(a).weather,title:"\u5168\u7403\u6C14\u8C61",value:"weather"},null,8,["prepend-icon"]),F(qi,{onClick:g,class:"rounded-end-pill","prepend-icon":Xn(a).typhoon,title:"\u53F0\u98CE\u60C5\u51B5",value:"typhoon"},null,8,["prepend-icon"]),F(qi,{onClick:_,class:"rounded-end-pill","prepend-icon":Xn(a).inversion,title:"\u6C14\u8C61\u53CD\u6F14",value:"inversion"},null,8,["prepend-icon"])]),_:1})]),_:1}))}});const Zm=gn({__name:"LeftNuclear",setup(e){const o=fh(),{icons:a,toggleIcon:c}=ph({icons:{dose_single:"mdi-account-outline",dose_mutilate:"mdi-account-group-outline",other:"mdi-circle-outline"},activeIcons:{dose_single:"mdi-account",dose_mutilate:"mdi-account-group",other:"mdi-circle"},temp:{dose_single:"mdi-account-outline",dose_mutilate:"mdi-account-group-outline",other:"mdi-circle-outline"}});function d(){o.push({name:"single"}),c("dose_single")}function g(){o.push({name:"multiple"}),c("dose_mutilate")}function _(){o.push({name:"other"}),c("other")}return(s,w)=>(bi(),jr(Yf,null,{default:fi(()=>[F(Ta,{density:"compact",nav:""},{default:fi(()=>[F(qi,{onClick:d,class:"rounded-end-pill","prepend-icon":Xn(a).dose_single,title:"\u4E2A\u4EBA\u5242\u91CF",value:"dose_single"},null,8,["prepend-icon"]),F(qi,{onClick:g,class:"rounded-end-pill","prepend-icon":Xn(a).dose_mutilate,title:"\u96C6\u4F53\u8BA1\u91CF",value:"dose_mutilate"},null,8,["prepend-icon"]),F(qi,{onClick:_,class:"rounded-end-pill","prepend-icon":Xn(a).other,title:"\u5176\u4ED6",value:"other"},null,8,["prepend-icon"])]),_:1})]),_:1}))}});const F_=gn({__name:"LeftEvacuate",setup(e){const o=fh(),{icons:a,toggleIcon:c}=ph({icons:{success:"mdi-run",failure:"mdi-alert-circle-outline"},activeIcons:{success:"mdi-run-fast",failure:"mdi-alert-circle"},temp:{success:"mdi-run",failure:"mdi-alert-circle-outline"}});function d(){o.push({name:"success"}),c("success")}function g(){o.push({name:"failure"}),c("failure")}return(_,s)=>(bi(),jr(Yf,null,{default:fi(()=>[F(Ta,{density:"compact",nav:""},{default:fi(()=>[F(qi,{onClick:d,class:"rounded-end-pill","prepend-icon":Xn(a).success,title:"\u64A4\u79BB\u6210\u529F",value:"success"},null,8,["prepend-icon"]),F(qi,{onClick:g,class:"rounded-end-pill","prepend-icon":Xn(a).failure,title:"\u64A4\u79BB\u5931\u8D25",value:"failure"},null,8,["prepend-icon"])]),_:1})]),_:1}))}});function wC(e,o){return function(){return e.apply(o,arguments)}}const{toString:EC}=Object.prototype,{getPrototypeOf:Z0}=Object,W0=(e=>o=>{const a=EC.call(o);return e[a]||(e[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),Ca=e=>(e=e.toLowerCase(),o=>W0(o)===e),Jg=e=>o=>typeof o===e,{isArray:Kf}=Array,ky=Jg("undefined");function M3(e){return e!==null&&!ky(e)&&e.constructor!==null&&!ky(e.constructor)&&Ih(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const SC=Ca("ArrayBuffer");function P3(e){let o;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?o=ArrayBuffer.isView(e):o=e&&e.buffer&&SC(e.buffer),o}const z3=Jg("string"),Ih=Jg("function"),TC=Jg("number"),CC=e=>e!==null&&typeof e=="object",L3=e=>e===!0||e===!1,Qm=e=>{if(W0(e)!=="object")return!1;const o=Z0(e);return(o===null||o===Object.prototype||Object.getPrototypeOf(o)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},D3=Ca("Date"),R3=Ca("File"),B3=Ca("Blob"),O3=Ca("FileList"),F3=e=>CC(e)&&Ih(e.pipe),V3=e=>{const o="[object FormData]";return e&&(typeof FormData=="function"&&e instanceof FormData||EC.call(e)===o||Ih(e.toString)&&e.toString()===o)},N3=Ca("URLSearchParams"),$3=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Qg(e,o,{allOwnKeys:a=!1}={}){if(e===null||typeof e>"u")return;let c,d;if(typeof e!="object"&&(e=[e]),Kf(e))for(c=0,d=e.length;c<d;c++)o.call(null,e[c],c,e);else{const g=a?Object.getOwnPropertyNames(e):Object.keys(e),_=g.length;let s;for(c=0;c<_;c++)s=g[c],o.call(null,e[s],s,e)}}function My(){const e={},o=(a,c)=>{Qm(e[c])&&Qm(a)?e[c]=My(e[c],a):Qm(a)?e[c]=My({},a):Kf(a)?e[c]=a.slice():e[c]=a};for(let a=0,c=arguments.length;a<c;a++)arguments[a]&&Qg(arguments[a],o);return e}const U3=(e,o,a,{allOwnKeys:c}={})=>(Qg(o,(d,g)=>{a&&Ih(d)?e[g]=wC(d,a):e[g]=d},{allOwnKeys:c}),e),j3=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),G3=(e,o,a,c)=>{e.prototype=Object.create(o.prototype,c),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:o.prototype}),a&&Object.assign(e.prototype,a)},q3=(e,o,a,c)=>{let d,g,_;const s={};if(o=o||{},e==null)return o;do{for(d=Object.getOwnPropertyNames(e),g=d.length;g-- >0;)_=d[g],(!c||c(_,e,o))&&!s[_]&&(o[_]=e[_],s[_]=!0);e=a!==!1&&Z0(e)}while(e&&(!a||a(e,o))&&e!==Object.prototype);return o},Z3=(e,o,a)=>{e=String(e),(a===void 0||a>e.length)&&(a=e.length),a-=o.length;const c=e.indexOf(o,a);return c!==-1&&c===a},W3=e=>{if(!e)return null;if(Kf(e))return e;let o=e.length;if(!TC(o))return null;const a=new Array(o);for(;o-- >0;)a[o]=e[o];return a},H3=(e=>o=>e&&o instanceof e)(typeof Uint8Array<"u"&&Z0(Uint8Array)),X3=(e,o)=>{const c=(e&&e[Symbol.iterator]).call(e);let d;for(;(d=c.next())&&!d.done;){const g=d.value;o.call(e,g[0],g[1])}},Y3=(e,o)=>{let a;const c=[];for(;(a=e.exec(o))!==null;)c.push(a);return c},K3=Ca("HTMLFormElement"),J3=e=>e.toLowerCase().replace(/[_-\s]([a-z\d])(\w*)/g,function(a,c,d){return c.toUpperCase()+d}),dE=(({hasOwnProperty:e})=>(o,a)=>e.call(o,a))(Object.prototype),Q3=Ca("RegExp"),IC=(e,o)=>{const a=Object.getOwnPropertyDescriptors(e),c={};Qg(a,(d,g)=>{o(d,g,e)!==!1&&(c[g]=d)}),Object.defineProperties(e,c)},eF=e=>{IC(e,(o,a)=>{const c=e[a];if(!!Ih(c)){if(o.enumerable=!1,"writable"in o){o.writable=!1;return}o.set||(o.set=()=>{throw Error("Can not read-only method '"+a+"'")})}})},tF=(e,o)=>{const a={},c=d=>{d.forEach(g=>{a[g]=!0})};return Kf(e)?c(e):c(String(e).split(o)),a},nF=()=>{},iF=(e,o)=>(e=+e,Number.isFinite(e)?e:o),xt={isArray:Kf,isArrayBuffer:SC,isBuffer:M3,isFormData:V3,isArrayBufferView:P3,isString:z3,isNumber:TC,isBoolean:L3,isObject:CC,isPlainObject:Qm,isUndefined:ky,isDate:D3,isFile:R3,isBlob:B3,isRegExp:Q3,isFunction:Ih,isStream:F3,isURLSearchParams:N3,isTypedArray:H3,isFileList:O3,forEach:Qg,merge:My,extend:U3,trim:$3,stripBOM:j3,inherits:G3,toFlatObject:q3,kindOf:W0,kindOfTest:Ca,endsWith:Z3,toArray:W3,forEachEntry:X3,matchAll:Y3,isHTMLForm:K3,hasOwnProperty:dE,hasOwnProp:dE,reduceDescriptors:IC,freezeMethods:eF,toObjectSet:tF,toCamelCase:J3,noop:nF,toFiniteNumber:iF};function ai(e,o,a,c,d){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",o&&(this.code=o),a&&(this.config=a),c&&(this.request=c),d&&(this.response=d)}xt.inherits(ai,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const AC=ai.prototype,kC={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{kC[e]={value:e}});Object.defineProperties(ai,kC);Object.defineProperty(AC,"isAxiosError",{value:!0});ai.from=(e,o,a,c,d,g)=>{const _=Object.create(AC);return xt.toFlatObject(e,_,function(w){return w!==Error.prototype},s=>s!=="isAxiosError"),ai.call(_,e.message,o,a,c,d),_.cause=e,_.name=e.name,g&&Object.assign(_,g),_};var rF=typeof self=="object"?self.FormData:window.FormData;function Py(e){return xt.isPlainObject(e)||xt.isArray(e)}function MC(e){return xt.endsWith(e,"[]")?e.slice(0,-2):e}function fE(e,o,a){return e?e.concat(o).map(function(d,g){return d=MC(d),!a&&g?"["+d+"]":d}).join(a?".":""):o}function oF(e){return xt.isArray(e)&&!e.some(Py)}const sF=xt.toFlatObject(xt,{},null,function(o){return/^is[A-Z]/.test(o)});function aF(e){return e&&xt.isFunction(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator]}function ev(e,o,a){if(!xt.isObject(e))throw new TypeError("target must be an object");o=o||new(rF||FormData),a=xt.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Z,de){return!xt.isUndefined(de[Z])});const c=a.metaTokens,d=a.visitor||A,g=a.dots,_=a.indexes,w=(a.Blob||typeof Blob<"u"&&Blob)&&aF(o);if(!xt.isFunction(d))throw new TypeError("visitor must be a function");function S($){if($===null)return"";if(xt.isDate($))return $.toISOString();if(!w&&xt.isBlob($))throw new ai("Blob is not supported. Use a Buffer instead.");return xt.isArrayBuffer($)||xt.isTypedArray($)?w&&typeof Blob=="function"?new Blob([$]):Buffer.from($):$}function A($,Z,de){let ne=$;if($&&!de&&typeof $=="object"){if(xt.endsWith(Z,"{}"))Z=c?Z:Z.slice(0,-2),$=JSON.stringify($);else if(xt.isArray($)&&oF($)||xt.isFileList($)||xt.endsWith(Z,"[]")&&(ne=xt.toArray($)))return Z=MC(Z),ne.forEach(function(K,Ee){!(xt.isUndefined(K)||K===null)&&o.append(_===!0?fE([Z],Ee,g):_===null?Z:Z+"[]",S(K))}),!1}return Py($)?!0:(o.append(fE(de,Z,g),S($)),!1)}const z=[],L=Object.assign(sF,{defaultVisitor:A,convertValue:S,isVisitable:Py});function R($,Z){if(!xt.isUndefined($)){if(z.indexOf($)!==-1)throw Error("Circular reference detected in "+Z.join("."));z.push($),xt.forEach($,function(ne,ce){(!(xt.isUndefined(ne)||ne===null)&&d.call(o,ne,xt.isString(ce)?ce.trim():ce,Z,L))===!0&&R(ne,Z?Z.concat(ce):[ce])}),z.pop()}}if(!xt.isObject(e))throw new TypeError("data must be an object");return R(e),o}function pE(e){const o={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(c){return o[c]})}function H0(e,o){this._pairs=[],e&&ev(e,this,o)}const PC=H0.prototype;PC.append=function(o,a){this._pairs.push([o,a])};PC.toString=function(o){const a=o?function(c){return o.call(this,c,pE)}:pE;return this._pairs.map(function(d){return a(d[0])+"="+a(d[1])},"").join("&")};function lF(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function zC(e,o,a){if(!o)return e;const c=a&&a.encode||lF,d=a&&a.serialize;let g;if(d?g=d(o,a):g=xt.isURLSearchParams(o)?o.toString():new H0(o,a).toString(c),g){const _=e.indexOf("#");_!==-1&&(e=e.slice(0,_)),e+=(e.indexOf("?")===-1?"?":"&")+g}return e}class mE{constructor(){this.handlers=[]}use(o,a,c){return this.handlers.push({fulfilled:o,rejected:a,synchronous:c?c.synchronous:!1,runWhen:c?c.runWhen:null}),this.handlers.length-1}eject(o){this.handlers[o]&&(this.handlers[o]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(o){xt.forEach(this.handlers,function(c){c!==null&&o(c)})}}const LC={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},cF=typeof URLSearchParams<"u"?URLSearchParams:H0,uF=FormData,hF=(()=>{let e;return typeof navigator<"u"&&((e=navigator.product)==="ReactNative"||e==="NativeScript"||e==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),pa={isBrowser:!0,classes:{URLSearchParams:cF,FormData:uF,Blob},isStandardBrowserEnv:hF,protocols:["http","https","file","blob","url","data"]};function dF(e,o){return ev(e,new pa.classes.URLSearchParams,Object.assign({visitor:function(a,c,d,g){return pa.isNode&&xt.isBuffer(a)?(this.append(c,a.toString("base64")),!1):g.defaultVisitor.apply(this,arguments)}},o))}function fF(e){return xt.matchAll(/\w+|\[(\w*)]/g,e).map(o=>o[0]==="[]"?"":o[1]||o[0])}function pF(e){const o={},a=Object.keys(e);let c;const d=a.length;let g;for(c=0;c<d;c++)g=a[c],o[g]=e[g];return o}function DC(e){function o(a,c,d,g){let _=a[g++];const s=Number.isFinite(+_),w=g>=a.length;return _=!_&&xt.isArray(d)?d.length:_,w?(xt.hasOwnProp(d,_)?d[_]=[d[_],c]:d[_]=c,!s):((!d[_]||!xt.isObject(d[_]))&&(d[_]=[]),o(a,c,d[_],g)&&xt.isArray(d[_])&&(d[_]=pF(d[_])),!s)}if(xt.isFormData(e)&&xt.isFunction(e.entries)){const a={};return xt.forEachEntry(e,(c,d)=>{o(fF(c),d,a,0)}),a}return null}function mF(e,o,a){const c=a.config.validateStatus;!a.status||!c||c(a.status)?e(a):o(new ai("Request failed with status code "+a.status,[ai.ERR_BAD_REQUEST,ai.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}const gF=pa.isStandardBrowserEnv?function(){return{write:function(a,c,d,g,_,s){const w=[];w.push(a+"="+encodeURIComponent(c)),xt.isNumber(d)&&w.push("expires="+new Date(d).toGMTString()),xt.isString(g)&&w.push("path="+g),xt.isString(_)&&w.push("domain="+_),s===!0&&w.push("secure"),document.cookie=w.join("; ")},read:function(a){const c=document.cookie.match(new RegExp("(^|;\\s*)("+a+")=([^;]*)"));return c?decodeURIComponent(c[3]):null},remove:function(a){this.write(a,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function vF(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function _F(e,o){return o?e.replace(/\/+$/,"")+"/"+o.replace(/^\/+/,""):e}function RC(e,o){return e&&!vF(o)?_F(e,o):o}const yF=pa.isStandardBrowserEnv?function(){const o=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a");let c;function d(g){let _=g;return o&&(a.setAttribute("href",_),_=a.href),a.setAttribute("href",_),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:a.pathname.charAt(0)==="/"?a.pathname:"/"+a.pathname}}return c=d(window.location.href),function(_){const s=xt.isString(_)?d(_):_;return s.protocol===c.protocol&&s.host===c.host}}():function(){return function(){return!0}}();function Jf(e,o,a){ai.call(this,e==null?"canceled":e,ai.ERR_CANCELED,o,a),this.name="CanceledError"}xt.inherits(Jf,ai,{__CANCEL__:!0});function xF(e){const o=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return o&&o[1]||""}const bF=xt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),wF=e=>{const o={};let a,c,d;return e&&e.split(`
`).forEach(function(_){d=_.indexOf(":"),a=_.substring(0,d).trim().toLowerCase(),c=_.substring(d+1).trim(),!(!a||o[a]&&bF[a])&&(a==="set-cookie"?o[a]?o[a].push(c):o[a]=[c]:o[a]=o[a]?o[a]+", "+c:c)}),o},gE=Symbol("internals"),BC=Symbol("defaults");function lf(e){return e&&String(e).trim().toLowerCase()}function eg(e){return e===!1||e==null?e:xt.isArray(e)?e.map(eg):String(e)}function EF(e){const o=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let c;for(;c=a.exec(e);)o[c[1]]=c[2];return o}function vE(e,o,a,c){if(xt.isFunction(c))return c.call(this,o,a);if(!!xt.isString(o)){if(xt.isString(c))return o.indexOf(c)!==-1;if(xt.isRegExp(c))return c.test(o)}}function SF(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(o,a,c)=>a.toUpperCase()+c)}function TF(e,o){const a=xt.toCamelCase(" "+o);["get","set","has"].forEach(c=>{Object.defineProperty(e,c+a,{value:function(d,g,_){return this[c].call(this,o,d,g,_)},configurable:!0})})}function rf(e,o){o=o.toLowerCase();const a=Object.keys(e);let c=a.length,d;for(;c-- >0;)if(d=a[c],o===d.toLowerCase())return d;return null}function Do(e,o){e&&this.set(e),this[BC]=o||null}Object.assign(Do.prototype,{set:function(e,o,a){const c=this;function d(g,_,s){const w=lf(_);if(!w)throw new Error("header name must be a non-empty string");const S=rf(c,w);S&&s!==!0&&(c[S]===!1||s===!1)||(c[S||_]=eg(g))}return xt.isPlainObject(e)?xt.forEach(e,(g,_)=>{d(g,_,o)}):d(o,e,a),this},get:function(e,o){if(e=lf(e),!e)return;const a=rf(this,e);if(a){const c=this[a];if(!o)return c;if(o===!0)return EF(c);if(xt.isFunction(o))return o.call(this,c,a);if(xt.isRegExp(o))return o.exec(c);throw new TypeError("parser must be boolean|regexp|function")}},has:function(e,o){if(e=lf(e),e){const a=rf(this,e);return!!(a&&(!o||vE(this,this[a],a,o)))}return!1},delete:function(e,o){const a=this;let c=!1;function d(g){if(g=lf(g),g){const _=rf(a,g);_&&(!o||vE(a,a[_],_,o))&&(delete a[_],c=!0)}}return xt.isArray(e)?e.forEach(d):d(e),c},clear:function(){return Object.keys(this).forEach(this.delete.bind(this))},normalize:function(e){const o=this,a={};return xt.forEach(this,(c,d)=>{const g=rf(a,d);if(g){o[g]=eg(c),delete o[d];return}const _=e?SF(d):String(d).trim();_!==d&&delete o[d],o[_]=eg(c),a[_]=!0}),this},toJSON:function(e){const o=Object.create(null);return xt.forEach(Object.assign({},this[BC]||null,this),(a,c)=>{a==null||a===!1||(o[c]=e&&xt.isArray(a)?a.join(", "):a)}),o}});Object.assign(Do,{from:function(e){return xt.isString(e)?new this(wF(e)):e instanceof this?e:new this(e)},accessor:function(e){const a=(this[gE]=this[gE]={accessors:{}}).accessors,c=this.prototype;function d(g){const _=lf(g);a[_]||(TF(c,g),a[_]=!0)}return xt.isArray(e)?e.forEach(d):d(e),this}});Do.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent"]);xt.freezeMethods(Do.prototype);xt.freezeMethods(Do);function CF(e,o){e=e||10;const a=new Array(e),c=new Array(e);let d=0,g=0,_;return o=o!==void 0?o:1e3,function(w){const S=Date.now(),A=c[g];_||(_=S),a[d]=w,c[d]=S;let z=g,L=0;for(;z!==d;)L+=a[z++],z=z%e;if(d=(d+1)%e,d===g&&(g=(g+1)%e),S-_<o)return;const R=A&&S-A;return R?Math.round(L*1e3/R):void 0}}function _E(e,o){let a=0;const c=CF(50,250);return d=>{const g=d.loaded,_=d.lengthComputable?d.total:void 0,s=g-a,w=c(s),S=g<=_;a=g;const A={loaded:g,total:_,progress:_?g/_:void 0,bytes:s,rate:w||void 0,estimated:w&&_&&S?(_-g)/w:void 0};A[o?"download":"upload"]=!0,e(A)}}function yE(e){return new Promise(function(a,c){let d=e.data;const g=Do.from(e.headers).normalize(),_=e.responseType;let s;function w(){e.cancelToken&&e.cancelToken.unsubscribe(s),e.signal&&e.signal.removeEventListener("abort",s)}xt.isFormData(d)&&pa.isStandardBrowserEnv&&g.setContentType(!1);let S=new XMLHttpRequest;if(e.auth){const R=e.auth.username||"",$=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";g.set("Authorization","Basic "+btoa(R+":"+$))}const A=RC(e.baseURL,e.url);S.open(e.method.toUpperCase(),zC(A,e.params,e.paramsSerializer),!0),S.timeout=e.timeout;function z(){if(!S)return;const R=Do.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),Z={data:!_||_==="text"||_==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:R,config:e,request:S};mF(function(ne){a(ne),w()},function(ne){c(ne),w()},Z),S=null}if("onloadend"in S?S.onloadend=z:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(z)},S.onabort=function(){!S||(c(new ai("Request aborted",ai.ECONNABORTED,e,S)),S=null)},S.onerror=function(){c(new ai("Network Error",ai.ERR_NETWORK,e,S)),S=null},S.ontimeout=function(){let $=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const Z=e.transitional||LC;e.timeoutErrorMessage&&($=e.timeoutErrorMessage),c(new ai($,Z.clarifyTimeoutError?ai.ETIMEDOUT:ai.ECONNABORTED,e,S)),S=null},pa.isStandardBrowserEnv){const R=(e.withCredentials||yF(A))&&e.xsrfCookieName&&gF.read(e.xsrfCookieName);R&&g.set(e.xsrfHeaderName,R)}d===void 0&&g.setContentType(null),"setRequestHeader"in S&&xt.forEach(g.toJSON(),function($,Z){S.setRequestHeader(Z,$)}),xt.isUndefined(e.withCredentials)||(S.withCredentials=!!e.withCredentials),_&&_!=="json"&&(S.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&S.addEventListener("progress",_E(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&S.upload&&S.upload.addEventListener("progress",_E(e.onUploadProgress)),(e.cancelToken||e.signal)&&(s=R=>{!S||(c(!R||R.type?new Jf(null,e,S):R),S.abort(),S=null)},e.cancelToken&&e.cancelToken.subscribe(s),e.signal&&(e.signal.aborted?s():e.signal.addEventListener("abort",s)));const L=xF(A);if(L&&pa.protocols.indexOf(L)===-1){c(new ai("Unsupported protocol "+L+":",ai.ERR_BAD_REQUEST,e));return}S.send(d||null)})}const xE={http:yE,xhr:yE},bE={getAdapter:e=>{if(xt.isString(e)){const o=xE[e];if(!e)throw Error(xt.hasOwnProp(e)?`Adapter '${e}' is not available in the build`:`Can not resolve adapter '${e}'`);return o}if(!xt.isFunction(e))throw new TypeError("adapter is not a function");return e},adapters:xE},IF={"Content-Type":"application/x-www-form-urlencoded"};function AF(){let e;return typeof XMLHttpRequest<"u"?e=bE.getAdapter("xhr"):typeof process<"u"&&xt.kindOf(process)==="process"&&(e=bE.getAdapter("http")),e}function kF(e,o,a){if(xt.isString(e))try{return(o||JSON.parse)(e),xt.trim(e)}catch(c){if(c.name!=="SyntaxError")throw c}return(a||JSON.stringify)(e)}const Ah={transitional:LC,adapter:AF(),transformRequest:[function(o,a){const c=a.getContentType()||"",d=c.indexOf("application/json")>-1,g=xt.isObject(o);if(g&&xt.isHTMLForm(o)&&(o=new FormData(o)),xt.isFormData(o))return d&&d?JSON.stringify(DC(o)):o;if(xt.isArrayBuffer(o)||xt.isBuffer(o)||xt.isStream(o)||xt.isFile(o)||xt.isBlob(o))return o;if(xt.isArrayBufferView(o))return o.buffer;if(xt.isURLSearchParams(o))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),o.toString();let s;if(g){if(c.indexOf("application/x-www-form-urlencoded")>-1)return dF(o,this.formSerializer).toString();if((s=xt.isFileList(o))||c.indexOf("multipart/form-data")>-1){const w=this.env&&this.env.FormData;return ev(s?{"files[]":o}:o,w&&new w,this.formSerializer)}}return g||d?(a.setContentType("application/json",!1),kF(o)):o}],transformResponse:[function(o){const a=this.transitional||Ah.transitional,c=a&&a.forcedJSONParsing,d=this.responseType==="json";if(o&&xt.isString(o)&&(c&&!this.responseType||d)){const _=!(a&&a.silentJSONParsing)&&d;try{return JSON.parse(o)}catch(s){if(_)throw s.name==="SyntaxError"?ai.from(s,ai.ERR_BAD_RESPONSE,this,null,this.response):s}}return o}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:pa.classes.FormData,Blob:pa.classes.Blob},validateStatus:function(o){return o>=200&&o<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};xt.forEach(["delete","get","head"],function(o){Ah.headers[o]={}});xt.forEach(["post","put","patch"],function(o){Ah.headers[o]=xt.merge(IF)});function V_(e,o){const a=this||Ah,c=o||a,d=Do.from(c.headers);let g=c.data;return xt.forEach(e,function(s){g=s.call(a,g,d.normalize(),o?o.status:void 0)}),d.normalize(),g}function OC(e){return!!(e&&e.__CANCEL__)}function N_(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Jf}function wE(e){return N_(e),e.headers=Do.from(e.headers),e.data=V_.call(e,e.transformRequest),(e.adapter||Ah.adapter)(e).then(function(c){return N_(e),c.data=V_.call(e,e.transformResponse,c),c.headers=Do.from(c.headers),c},function(c){return OC(c)||(N_(e),c&&c.response&&(c.response.data=V_.call(e,e.transformResponse,c.response),c.response.headers=Do.from(c.response.headers))),Promise.reject(c)})}function Of(e,o){o=o||{};const a={};function c(S,A){return xt.isPlainObject(S)&&xt.isPlainObject(A)?xt.merge(S,A):xt.isPlainObject(A)?xt.merge({},A):xt.isArray(A)?A.slice():A}function d(S){if(xt.isUndefined(o[S])){if(!xt.isUndefined(e[S]))return c(void 0,e[S])}else return c(e[S],o[S])}function g(S){if(!xt.isUndefined(o[S]))return c(void 0,o[S])}function _(S){if(xt.isUndefined(o[S])){if(!xt.isUndefined(e[S]))return c(void 0,e[S])}else return c(void 0,o[S])}function s(S){if(S in o)return c(e[S],o[S]);if(S in e)return c(void 0,e[S])}const w={url:g,method:g,data:g,baseURL:_,transformRequest:_,transformResponse:_,paramsSerializer:_,timeout:_,timeoutMessage:_,withCredentials:_,adapter:_,responseType:_,xsrfCookieName:_,xsrfHeaderName:_,onUploadProgress:_,onDownloadProgress:_,decompress:_,maxContentLength:_,maxBodyLength:_,beforeRedirect:_,transport:_,httpAgent:_,httpsAgent:_,cancelToken:_,socketPath:_,responseEncoding:_,validateStatus:s};return xt.forEach(Object.keys(e).concat(Object.keys(o)),function(A){const z=w[A]||d,L=z(A);xt.isUndefined(L)&&z!==s||(a[A]=L)}),a}const FC="1.1.3",X0={};["object","boolean","number","function","string","symbol"].forEach((e,o)=>{X0[e]=function(c){return typeof c===e||"a"+(o<1?"n ":" ")+e}});const EE={};X0.transitional=function(o,a,c){function d(g,_){return"[Axios v"+FC+"] Transitional option '"+g+"'"+_+(c?". "+c:"")}return(g,_,s)=>{if(o===!1)throw new ai(d(_," has been removed"+(a?" in "+a:"")),ai.ERR_DEPRECATED);return a&&!EE[_]&&(EE[_]=!0,console.warn(d(_," has been deprecated since v"+a+" and will be removed in the near future"))),o?o(g,_,s):!0}};function MF(e,o,a){if(typeof e!="object")throw new ai("options must be an object",ai.ERR_BAD_OPTION_VALUE);const c=Object.keys(e);let d=c.length;for(;d-- >0;){const g=c[d],_=o[g];if(_){const s=e[g],w=s===void 0||_(s,g,e);if(w!==!0)throw new ai("option "+g+" must be "+w,ai.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new ai("Unknown option "+g,ai.ERR_BAD_OPTION)}}const zy={assertOptions:MF,validators:X0},ul=zy.validators;class Pc{constructor(o){this.defaults=o,this.interceptors={request:new mE,response:new mE}}request(o,a){typeof o=="string"?(a=a||{},a.url=o):a=o||{},a=Of(this.defaults,a);const{transitional:c,paramsSerializer:d}=a;c!==void 0&&zy.assertOptions(c,{silentJSONParsing:ul.transitional(ul.boolean),forcedJSONParsing:ul.transitional(ul.boolean),clarifyTimeoutError:ul.transitional(ul.boolean)},!1),d!==void 0&&zy.assertOptions(d,{encode:ul.function,serialize:ul.function},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();const g=a.headers&&xt.merge(a.headers.common,a.headers[a.method]);g&&xt.forEach(["delete","get","head","post","put","patch","common"],function($){delete a.headers[$]}),a.headers=new Do(a.headers,g);const _=[];let s=!0;this.interceptors.request.forEach(function($){typeof $.runWhen=="function"&&$.runWhen(a)===!1||(s=s&&$.synchronous,_.unshift($.fulfilled,$.rejected))});const w=[];this.interceptors.response.forEach(function($){w.push($.fulfilled,$.rejected)});let S,A=0,z;if(!s){const R=[wE.bind(this),void 0];for(R.unshift.apply(R,_),R.push.apply(R,w),z=R.length,S=Promise.resolve(a);A<z;)S=S.then(R[A++],R[A++]);return S}z=_.length;let L=a;for(A=0;A<z;){const R=_[A++],$=_[A++];try{L=R(L)}catch(Z){$.call(this,Z);break}}try{S=wE.call(this,L)}catch(R){return Promise.reject(R)}for(A=0,z=w.length;A<z;)S=S.then(w[A++],w[A++]);return S}getUri(o){o=Of(this.defaults,o);const a=RC(o.baseURL,o.url);return zC(a,o.params,o.paramsSerializer)}}xt.forEach(["delete","get","head","options"],function(o){Pc.prototype[o]=function(a,c){return this.request(Of(c||{},{method:o,url:a,data:(c||{}).data}))}});xt.forEach(["post","put","patch"],function(o){function a(c){return function(g,_,s){return this.request(Of(s||{},{method:o,headers:c?{"Content-Type":"multipart/form-data"}:{},url:g,data:_}))}}Pc.prototype[o]=a(),Pc.prototype[o+"Form"]=a(!0)});class Y0{constructor(o){if(typeof o!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(g){a=g});const c=this;this.promise.then(d=>{if(!c._listeners)return;let g=c._listeners.length;for(;g-- >0;)c._listeners[g](d);c._listeners=null}),this.promise.then=d=>{let g;const _=new Promise(s=>{c.subscribe(s),g=s}).then(d);return _.cancel=function(){c.unsubscribe(g)},_},o(function(g,_,s){c.reason||(c.reason=new Jf(g,_,s),a(c.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(o){if(this.reason){o(this.reason);return}this._listeners?this._listeners.push(o):this._listeners=[o]}unsubscribe(o){if(!this._listeners)return;const a=this._listeners.indexOf(o);a!==-1&&this._listeners.splice(a,1)}static source(){let o;return{token:new Y0(function(d){o=d}),cancel:o}}}function PF(e){return function(a){return e.apply(null,a)}}function zF(e){return xt.isObject(e)&&e.isAxiosError===!0}function VC(e){const o=new Pc(e),a=wC(Pc.prototype.request,o);return xt.extend(a,Pc.prototype,o,{allOwnKeys:!0}),xt.extend(a,o,null,{allOwnKeys:!0}),a.create=function(d){return VC(Of(e,d))},a}const so=VC(Ah);so.Axios=Pc;so.CanceledError=Jf;so.CancelToken=Y0;so.isCancel=OC;so.VERSION=FC;so.toFormData=ev;so.AxiosError=ai;so.Cancel=so.CanceledError;so.all=function(o){return Promise.all(o)};so.spread=PF;so.isAxiosError=zF;so.formToJSON=e=>DC(xt.isHTMLForm(e)?new FormData(e):e);const LF="pk.eyJ1Ijoia29pZ29rb3JvIiwiYSI6ImNsOXAxZDIzZDA0OHQ0MW1wMHd2Y3Rxa3IifQ.X9ACqkqRQ_m3IvwqsGYy0w",DF={};function RF(e,o){const a=Os("v-scale-control");return bi(),jr(a,{class:"scale-control",position:"bottom-right"})}const BF=wa(DF,[["render",RF]]),OF=gn({__name:"SwitchBgMap",emits:["switch-map"],setup(e,{emit:o}){const a=Qe("mapbox://styles/mapbox/light-v11"),c=Ki({mapbox:"mapbox://styles/mapbox/light-v11",earth:"mapbox://styles/mapbox/satellite-streets-v11"});function d(g){g==="mapbox"?a.value=c.mapbox:g==="earth"&&(a.value=c.earth),o("switch-map",a.value)}return(g,_)=>(bi(),jr(Hf,{class:"switch-map"},{activator:fi(({props:s})=>[F(Fi,nn({class:"switch-map",elevation:"4",icon:"mdi-switch",color:"primary"},s),null,16)]),default:fi(()=>[F(Fi,{onClick:_[0]||(_[0]=s=>d("mapbox")),icon:"mdi-earth"}),F(Fi,{onClick:_[1]||(_[1]=s=>d("earth")),icon:"mdi-mapbox"})]),_:1}))}});const FF=wa(OF,[["__scopeId","data-v-00fecbd1"]]),VF={};function NF(e,o){const a=Os("v-navigation-control");return bi(),jr(a,{showCompass:!0,showZoom:!0,visualizePitch:!0})}const $F=wa(VF,[["render",NF]]),Ia=gn({__name:"MapMain",setup(e){const o=Ki({center:[120,30],zoom:5,style:"mapbox://styles/mapbox/light-v11",projection:"mercator"}),a=Qe();function c(d){o.style=d}return(d,g)=>{const _=Os("v-map");return bi(),jr(_,{ref_key:"mapRef",ref:a,accessToken:Xn(LF),options:o},{default:fi(()=>[Uf(d.$slots,"default"),F(BF),F(FF,{onReceiveChild:c}),F($F)]),_:3},8,["accessToken","options"])}}}),UF=gn({__name:"MapIndex",setup(e){let o=Qe("mapbox://styles/mapbox/light-v11");const a=Qe(),c=Ki({features:[]});let d=Ki({mapOptions:{style:o,projection:"mercator"},popupOptions:{visible:!1,center:void 0,content:""}});async function g(){try{const A=await so.get("http://127.0.0.1:8000/index/index_geojson");c.features=A.data.features,console.log(a.value.map)}catch(A){console.error(A)}}const _=A=>{const z=A.target;console.log(A.target);const L=z.queryRenderedFeatures(A.point,{layers:["nuclear-stations-circle"]}),R=L[0].properties.cluster_id;z.getSource("nuclear-stations").getClusterExpansionZoom(R,($,Z)=>{$||z.easeTo({center:L[0].geometry.coordinates,zoom:Z})})},s=A=>{A.target.getCanvas().style.cursor="pointer"},w=A=>{A.target.getCanvas().style.cursor=""},S=A=>{const z=A.features[0].geometry.coordinates.slice();for(;Math.abs(A.lngLat.lng-z[0])>180;)z[0]+=A.lngLat.lng>z[0]?360:-360;d.popupOptions.visible=!0,d.popupOptions.content=c.features[0].name,d.popupOptions.center=z};return(A,z)=>{const L=Os("v-geo-source"),R=Os("v-circle-layer"),$=Os("v-symbol-layer");return bi(),go("div",null,[F(Ia,{onLoaded:g},{default:fi(()=>[F(L,{id:"nuclear-stations",data:c,cluster:!0,clusterRadius:50},null,8,["data"]),F(R,{id:"nuclear-stations-circle",source:"nuclear-stations",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#51bbd6",20,"#f1f075",60,"#f28cb1",100,"#e20656"],"circle-radius":["step",["get","point_count"],20,20,30,60,40,100,50]},onClick:_,onMouseenter:s,onMouseleave:w}),F($,{id:"cluster-count",source:"nuclear-stations",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}}),F(R,{id:"uncluster-point",source:"nuclear-stations",filter:["!",["has","point_count"]],paint:{"circle-color":"#11b4da","circle-radius":4,"circle-stroke-width":1,"circle-stroke-color":"#fff"},onClick:S})]),_:1})])}}});const _c=wa(UF,[["__scopeId","data-v-9f563088"]]),$_=gn({__name:"MapLand",setup(e){return(o,a)=>(bi(),go("div",null,[F(Ia)]))}}),jF=gn({__name:"MapElevation",setup(e){return(o,a)=>(bi(),go("div",null,[F(Ia)]))}});var io=63710088e-1,GF={centimeters:io*100,centimetres:io*100,degrees:io/111325,feet:io*3.28084,inches:io*39.37,kilometers:io/1e3,kilometres:io/1e3,meters:io,metres:io,miles:io/1609.344,millimeters:io*1e3,millimetres:io*1e3,nauticalmiles:io/1852,radians:1,yards:io*1.0936};function Ff(e,o,a){a===void 0&&(a={});var c={type:"Feature"};return(a.id===0||a.id)&&(c.id=a.id),a.bbox&&(c.bbox=a.bbox),c.properties=o||{},c.geometry=e,c}function qF(e,o,a){if(a===void 0&&(a={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!CE(e[0])||!CE(e[1]))throw new Error("coordinates must contain numbers");var c={type:"Point",coordinates:e};return Ff(c,o,a)}function Ly(e,o,a){a===void 0&&(a={});for(var c=0,d=e;c<d.length;c++){var g=d[c];if(g.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var _=0;_<g[g.length-1].length;_++)if(g[g.length-1][_]!==g[0][_])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:e};return Ff(s,o,a)}function K0(e,o){o===void 0&&(o={});var a={type:"FeatureCollection"};return o.id&&(a.id=o.id),o.bbox&&(a.bbox=o.bbox),a.features=e,a}function SE(e,o,a){a===void 0&&(a={});var c={type:"MultiPolygon",coordinates:e};return Ff(c,o,a)}function ZF(e,o){o===void 0&&(o="kilometers");var a=GF[o];if(!a)throw new Error(o+" units is invalid");return e/a}function TE(e){var o=e%(2*Math.PI);return o*180/Math.PI}function U_(e){var o=e%360;return o*Math.PI/180}function CE(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function WF(e){return!!e&&e.constructor===Object}function HF(e,o){if(e.type==="Feature")o(e,0);else if(e.type==="FeatureCollection")for(var a=0;a<e.features.length&&o(e.features[a],a)!==!1;a++);}function XF(e,o){var a,c,d,g,_,s,w,S,A,z,L=0,R=e.type==="FeatureCollection",$=e.type==="Feature",Z=R?e.features.length:1;for(a=0;a<Z;a++){for(s=R?e.features[a].geometry:$?e.geometry:e,S=R?e.features[a].properties:$?e.properties:{},A=R?e.features[a].bbox:$?e.bbox:void 0,z=R?e.features[a].id:$?e.id:void 0,w=s?s.type==="GeometryCollection":!1,_=w?s.geometries.length:1,d=0;d<_;d++){if(g=w?s.geometries[d]:s,g===null){if(o(null,L,S,A,z)===!1)return!1;continue}switch(g.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(o(g,L,S,A,z)===!1)return!1;break}case"GeometryCollection":{for(c=0;c<g.geometries.length;c++)if(o(g.geometries[c],L,S,A,z)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}L++}}function YF(e,o){XF(e,function(a,c,d,g,_){var s=a===null?null:a.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return o(Ff(a,d,{bbox:g,id:_}),c,0)===!1?!1:void 0}var w;switch(s){case"MultiPoint":w="Point";break;case"MultiLineString":w="LineString";break;case"MultiPolygon":w="Polygon";break}for(var S=0;S<a.coordinates.length;S++){var A=a.coordinates[S],z={type:w,coordinates:A};if(o(Ff(z,d),c,S)===!1)return!1}})}function KF(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function JF(e,o,a){if(!e)throw new Error("No featureCollection passed");if(!a)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+a+", FeatureCollection required");for(var c=0,d=e.features;c<d.length;c++){var g=d[c];if(!g||g.type!=="Feature"||!g.geometry)throw new Error("Invalid input to "+a+", Feature with geometry required");if(!g.geometry||g.geometry.type!==o)throw new Error("Invalid input to "+a+": must be a "+o+", given "+g.geometry.type)}}function QF(e,o,a,c){c===void 0&&(c={});var d=KF(e),g=U_(d[0]),_=U_(d[1]),s=U_(a),w=ZF(o,c.units),S=Math.asin(Math.sin(_)*Math.cos(w)+Math.cos(_)*Math.sin(w)*Math.cos(s)),A=g+Math.atan2(Math.sin(s)*Math.sin(w)*Math.cos(_),Math.cos(w)-Math.sin(_)*Math.sin(S)),z=TE(A),L=TE(S);return qF([z,L],c.properties)}function IE(e,o,a){a===void 0&&(a={});for(var c=a.steps||64,d=a.properties?a.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},g=[],_=0;_<c;_++)g.push(QF(e,o,_*-360/c,a).geometry.coordinates);return g.push(g[0]),Ly([g],d)}function AE(e){if(!e)throw new Error("geojson is required");var o=[];return YF(e,function(a){o.push(a)}),K0(o)}/**
 * splaytree v3.1.1
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function e5(e,o){var a={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},c,d,g,_;return _={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(_[Symbol.iterator]=function(){return this}),_;function s(S){return function(A){return w([S,A])}}function w(S){if(c)throw new TypeError("Generator is already executing.");for(;a;)try{if(c=1,d&&(g=S[0]&2?d.return:S[0]?d.throw||((g=d.return)&&g.call(d),0):d.next)&&!(g=g.call(d,S[1])).done)return g;switch(d=0,g&&(S=[S[0]&2,g.value]),S[0]){case 0:case 1:g=S;break;case 4:return a.label++,{value:S[1],done:!1};case 5:a.label++,d=S[1],S=[0];continue;case 7:S=a.ops.pop(),a.trys.pop();continue;default:if(g=a.trys,!(g=g.length>0&&g[g.length-1])&&(S[0]===6||S[0]===2)){a=0;continue}if(S[0]===3&&(!g||S[1]>g[0]&&S[1]<g[3])){a.label=S[1];break}if(S[0]===6&&a.label<g[1]){a.label=g[1],g=S;break}if(g&&a.label<g[2]){a.label=g[2],a.ops.push(S);break}g[2]&&a.ops.pop(),a.trys.pop();continue}S=o.call(e,a)}catch(A){S=[6,A],d=0}finally{c=g=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}}var yl=function(){function e(o,a){this.next=null,this.key=o,this.data=a,this.left=null,this.right=null}return e}();function t5(e,o){return e>o?1:e<o?-1:0}function pl(e,o,a){for(var c=new yl(null,null),d=c,g=c;;){var _=a(e,o.key);if(_<0){if(o.left===null)break;if(a(e,o.left.key)<0){var s=o.left;if(o.left=s.right,s.right=o,o=s,o.left===null)break}g.left=o,g=o,o=o.left}else if(_>0){if(o.right===null)break;if(a(e,o.right.key)>0){var s=o.right;if(o.right=s.left,s.left=o,o=s,o.right===null)break}d.right=o,d=o,o=o.right}else break}return d.right=o.left,g.left=o.right,o.left=c.right,o.right=c.left,o}function j_(e,o,a,c){var d=new yl(e,o);if(a===null)return d.left=d.right=null,d;a=pl(e,a,c);var g=c(e,a.key);return g<0?(d.left=a.left,d.right=a,a.left=null):g>=0&&(d.right=a.right,d.left=a,a.right=null),d}function kE(e,o,a){var c=null,d=null;if(o){o=pl(e,o,a);var g=a(o.key,e);g===0?(c=o.left,d=o.right):g<0?(d=o.right,o.right=null,c=o):(c=o.left,o.left=null,d=o)}return{left:c,right:d}}function n5(e,o,a){return o===null?e:(e===null||(o=pl(e.key,o,a),o.left=e),o)}function Dy(e,o,a,c,d){if(e){c(""+o+(a?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+d(e)+`
`);var g=o+(a?"    ":"\u2502   ");e.left&&Dy(e.left,g,!1,c,d),e.right&&Dy(e.right,g,!0,c,d)}}var J0=function(){function e(o){o===void 0&&(o=t5),this._root=null,this._size=0,this._comparator=o}return e.prototype.insert=function(o,a){return this._size++,this._root=j_(o,a,this._root,this._comparator)},e.prototype.add=function(o,a){var c=new yl(o,a);this._root===null&&(c.left=c.right=null,this._size++,this._root=c);var d=this._comparator,g=pl(o,this._root,d),_=d(o,g.key);return _===0?this._root=g:(_<0?(c.left=g.left,c.right=g,g.left=null):_>0&&(c.right=g.right,c.left=g,g.right=null),this._size++,this._root=c),this._root},e.prototype.remove=function(o){this._root=this._remove(o,this._root,this._comparator)},e.prototype._remove=function(o,a,c){var d;if(a===null)return null;a=pl(o,a,c);var g=c(o,a.key);return g===0?(a.left===null?d=a.right:(d=pl(o,a.left,c),d.right=a.right),this._size--,d):a},e.prototype.pop=function(){var o=this._root;if(o){for(;o.left;)o=o.left;return this._root=pl(o.key,this._root,this._comparator),this._root=this._remove(o.key,this._root,this._comparator),{key:o.key,data:o.data}}return null},e.prototype.findStatic=function(o){for(var a=this._root,c=this._comparator;a;){var d=c(o,a.key);if(d===0)return a;d<0?a=a.left:a=a.right}return null},e.prototype.find=function(o){return this._root&&(this._root=pl(o,this._root,this._comparator),this._comparator(o,this._root.key)!==0)?null:this._root},e.prototype.contains=function(o){for(var a=this._root,c=this._comparator;a;){var d=c(o,a.key);if(d===0)return!0;d<0?a=a.left:a=a.right}return!1},e.prototype.forEach=function(o,a){for(var c=this._root,d=[],g=!1;!g;)c!==null?(d.push(c),c=c.left):d.length!==0?(c=d.pop(),o.call(a,c),c=c.right):g=!0;return this},e.prototype.range=function(o,a,c,d){for(var g=[],_=this._comparator,s=this._root,w;g.length!==0||s;)if(s)g.push(s),s=s.left;else{if(s=g.pop(),w=_(s.key,a),w>0)break;if(_(s.key,o)>=0&&c.call(d,s))return this;s=s.right}return this},e.prototype.keys=function(){var o=[];return this.forEach(function(a){var c=a.key;return o.push(c)}),o},e.prototype.values=function(){var o=[];return this.forEach(function(a){var c=a.data;return o.push(c)}),o},e.prototype.min=function(){return this._root?this.minNode(this._root).key:null},e.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},e.prototype.minNode=function(o){if(o===void 0&&(o=this._root),o)for(;o.left;)o=o.left;return o},e.prototype.maxNode=function(o){if(o===void 0&&(o=this._root),o)for(;o.right;)o=o.right;return o},e.prototype.at=function(o){for(var a=this._root,c=!1,d=0,g=[];!c;)if(a)g.push(a),a=a.left;else if(g.length>0){if(a=g.pop(),d===o)return a;d++,a=a.right}else c=!0;return null},e.prototype.next=function(o){var a=this._root,c=null;if(o.right){for(c=o.right;c.left;)c=c.left;return c}for(var d=this._comparator;a;){var g=d(o.key,a.key);if(g===0)break;g<0?(c=a,a=a.left):a=a.right}return c},e.prototype.prev=function(o){var a=this._root,c=null;if(o.left!==null){for(c=o.left;c.right;)c=c.right;return c}for(var d=this._comparator;a;){var g=d(o.key,a.key);if(g===0)break;g<0?a=a.left:(c=a,a=a.right)}return c},e.prototype.clear=function(){return this._root=null,this._size=0,this},e.prototype.toList=function(){return r5(this._root)},e.prototype.load=function(o,a,c){a===void 0&&(a=[]),c===void 0&&(c=!1);var d=o.length,g=this._comparator;if(c&&Oy(o,a,0,d-1,g),this._root===null)this._root=Ry(o,a,0,d),this._size=d;else{var _=o5(this.toList(),i5(o,a),g);d=this._size+d,this._root=By({head:_},0,d)}return this},e.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.toString=function(o){o===void 0&&(o=function(c){return String(c.key)});var a=[];return Dy(this._root,"",!0,function(c){return a.push(c)},o),a.join("")},e.prototype.update=function(o,a,c){var d=this._comparator,g=kE(o,this._root,d),_=g.left,s=g.right;d(o,a)<0?s=j_(a,c,s,d):_=j_(a,c,_,d),this._root=n5(_,s,d)},e.prototype.split=function(o){return kE(o,this._root,this._comparator)},e.prototype[Symbol.iterator]=function(){var o;return e5(this,function(a){switch(a.label){case 0:o=this.minNode(),a.label=1;case 1:return o?[4,o]:[3,3];case 2:return a.sent(),o=this.next(o),[3,1];case 3:return[2]}})},e}();function Ry(e,o,a,c){var d=c-a;if(d>0){var g=a+Math.floor(d/2),_=e[g],s=o[g],w=new yl(_,s);return w.left=Ry(e,o,a,g),w.right=Ry(e,o,g+1,c),w}return null}function i5(e,o){for(var a=new yl(null,null),c=a,d=0;d<e.length;d++)c=c.next=new yl(e[d],o[d]);return c.next=null,a.next}function r5(e){for(var o=e,a=[],c=!1,d=new yl(null,null),g=d;!c;)o?(a.push(o),o=o.left):a.length>0?(o=g=g.next=a.pop(),o=o.right):c=!0;return g.next=null,d.next}function By(e,o,a){var c=a-o;if(c>0){var d=o+Math.floor(c/2),g=By(e,o,d),_=e.head;return _.left=g,e.head=e.head.next,_.right=By(e,d+1,a),_}return null}function o5(e,o,a){for(var c=new yl(null,null),d=c,g=e,_=o;g!==null&&_!==null;)a(g.key,_.key)<0?(d.next=g,g=g.next):(d.next=_,_=_.next),d=d.next;return g!==null?d.next=g:_!==null&&(d.next=_),c.next}function Oy(e,o,a,c,d){if(!(a>=c)){for(var g=e[a+c>>1],_=a-1,s=c+1;;){do _++;while(d(e[_],g)<0);do s--;while(d(e[s],g)>0);if(_>=s)break;var w=e[_];e[_]=e[s],e[s]=w,w=o[_],o[_]=o[s],o[s]=w}Oy(e,o,a,s,d),Oy(e,o,s+1,c,d)}}function No(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function ME(e,o){for(var a=0;a<o.length;a++){var c=o[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function Xr(e,o,a){return o&&ME(e.prototype,o),a&&ME(e,a),e}var of=function(o,a){return o.ll.x<=a.x&&a.x<=o.ur.x&&o.ll.y<=a.y&&a.y<=o.ur.y},Fy=function(o,a){if(a.ur.x<o.ll.x||o.ur.x<a.ll.x||a.ur.y<o.ll.y||o.ur.y<a.ll.y)return null;var c=o.ll.x<a.ll.x?a.ll.x:o.ll.x,d=o.ur.x<a.ur.x?o.ur.x:a.ur.x,g=o.ll.y<a.ll.y?a.ll.y:o.ll.y,_=o.ur.y<a.ur.y?o.ur.y:a.ur.y;return{ll:{x:c,y:g},ur:{x:d,y:_}}},ml=Number.EPSILON;ml===void 0&&(ml=Math.pow(2,-52));var s5=ml*ml,Vy=function(o,a){if(-ml<o&&o<ml&&-ml<a&&a<ml)return 0;var c=o-a;return c*c<s5*o*a?0:o<a?-1:1},a5=function(){function e(){No(this,e),this.reset()}return Xr(e,[{key:"reset",value:function(){this.xRounder=new PE,this.yRounder=new PE}},{key:"round",value:function(a,c){return{x:this.xRounder.round(a),y:this.yRounder.round(c)}}}]),e}(),PE=function(){function e(){No(this,e),this.tree=new J0,this.round(0)}return Xr(e,[{key:"round",value:function(a){var c=this.tree.add(a),d=this.tree.prev(c);if(d!==null&&Vy(c.key,d.key)===0)return this.tree.remove(a),d.key;var g=this.tree.next(c);return g!==null&&Vy(c.key,g.key)===0?(this.tree.remove(a),g.key):a}}]),e}(),Vf=new a5,yf=function(o,a){return o.x*a.y-o.y*a.x},NC=function(o,a){return o.x*a.x+o.y*a.y},zE=function(o,a,c){var d={x:a.x-o.x,y:a.y-o.y},g={x:c.x-o.x,y:c.y-o.y},_=yf(d,g);return Vy(_,0)},xg=function(o){return Math.sqrt(NC(o,o))},l5=function(o,a,c){var d={x:a.x-o.x,y:a.y-o.y},g={x:c.x-o.x,y:c.y-o.y};return yf(g,d)/xg(g)/xg(d)},c5=function(o,a,c){var d={x:a.x-o.x,y:a.y-o.y},g={x:c.x-o.x,y:c.y-o.y};return NC(g,d)/xg(g)/xg(d)},LE=function(o,a,c){return a.y===0?null:{x:o.x+a.x/a.y*(c-o.y),y:c}},DE=function(o,a,c){return a.x===0?null:{x:c,y:o.y+a.y/a.x*(c-o.x)}},u5=function(o,a,c,d){if(a.x===0)return DE(c,d,o.x);if(d.x===0)return DE(o,a,c.x);if(a.y===0)return LE(c,d,o.y);if(d.y===0)return LE(o,a,c.y);var g=yf(a,d);if(g==0)return null;var _={x:c.x-o.x,y:c.y-o.y},s=yf(_,a)/g,w=yf(_,d)/g,S=o.x+w*a.x,A=c.x+s*d.x,z=o.y+w*a.y,L=c.y+s*d.y,R=(S+A)/2,$=(z+L)/2;return{x:R,y:$}},Ps=function(){Xr(e,null,[{key:"compare",value:function(a,c){var d=e.comparePoints(a.point,c.point);return d!==0?d:(a.point!==c.point&&a.link(c),a.isLeft!==c.isLeft?a.isLeft?1:-1:bg.compare(a.segment,c.segment))}},{key:"comparePoints",value:function(a,c){return a.x<c.x?-1:a.x>c.x?1:a.y<c.y?-1:a.y>c.y?1:0}}]);function e(o,a){No(this,e),o.events===void 0?o.events=[this]:o.events.push(this),this.point=o,this.isLeft=a}return Xr(e,[{key:"link",value:function(a){if(a.point===this.point)throw new Error("Tried to link already linked events");for(var c=a.point.events,d=0,g=c.length;d<g;d++){var _=c[d];this.point.events.push(_),_.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var a=this.point.events.length,c=0;c<a;c++){var d=this.point.events[c];if(d.segment.consumedBy===void 0)for(var g=c+1;g<a;g++){var _=this.point.events[g];_.consumedBy===void 0&&d.otherSE.point.events===_.otherSE.point.events&&d.segment.consume(_.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var a=[],c=0,d=this.point.events.length;c<d;c++){var g=this.point.events[c];g!==this&&!g.segment.ringOut&&g.segment.isInResult()&&a.push(g)}return a}},{key:"getLeftmostComparator",value:function(a){var c=this,d=new Map,g=function(s){var w=s.otherSE;d.set(s,{sine:l5(c.point,a.point,w.point),cosine:c5(c.point,a.point,w.point)})};return function(_,s){d.has(_)||g(_),d.has(s)||g(s);var w=d.get(_),S=w.sine,A=w.cosine,z=d.get(s),L=z.sine,R=z.cosine;return S>=0&&L>=0?A<R?1:A>R?-1:0:S<0&&L<0?A<R?-1:A>R?1:0:L<S?-1:L>S?1:0}}}]),e}(),h5=0,bg=function(){Xr(e,null,[{key:"compare",value:function(a,c){var d=a.leftSE.point.x,g=c.leftSE.point.x,_=a.rightSE.point.x,s=c.rightSE.point.x;if(s<d)return 1;if(_<g)return-1;var w=a.leftSE.point.y,S=c.leftSE.point.y,A=a.rightSE.point.y,z=c.rightSE.point.y;if(d<g){if(S<w&&S<A)return 1;if(S>w&&S>A)return-1;var L=a.comparePoint(c.leftSE.point);if(L<0)return 1;if(L>0)return-1;var R=c.comparePoint(a.rightSE.point);return R!==0?R:-1}if(d>g){if(w<S&&w<z)return-1;if(w>S&&w>z)return 1;var $=c.comparePoint(a.leftSE.point);if($!==0)return $;var Z=a.comparePoint(c.rightSE.point);return Z<0?1:Z>0?-1:1}if(w<S)return-1;if(w>S)return 1;if(_<s){var de=c.comparePoint(a.rightSE.point);if(de!==0)return de}if(_>s){var ne=a.comparePoint(c.rightSE.point);if(ne<0)return 1;if(ne>0)return-1}if(_!==s){var ce=A-w,K=_-d,Ee=z-S,Y=s-g;if(ce>K&&Ee<Y)return 1;if(ce<K&&Ee>Y)return-1}return _>s?1:_<s||A<z?-1:A>z?1:a.id<c.id?-1:a.id>c.id?1:0}}]);function e(o,a,c,d){No(this,e),this.id=++h5,this.leftSE=o,o.segment=this,o.otherSE=a,this.rightSE=a,a.segment=this,a.otherSE=o,this.rings=c,this.windings=d}return Xr(e,[{key:"replaceRightSE",value:function(a){this.rightSE=a,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var a=this.leftSE.point.y,c=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:a<c?a:c},ur:{x:this.rightSE.point.x,y:a>c?a:c}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(a){return a.x===this.leftSE.point.x&&a.y===this.leftSE.point.y||a.x===this.rightSE.point.x&&a.y===this.rightSE.point.y}},{key:"comparePoint",value:function(a){if(this.isAnEndpoint(a))return 0;var c=this.leftSE.point,d=this.rightSE.point,g=this.vector();if(c.x===d.x)return a.x===c.x?0:a.x<c.x?1:-1;var _=(a.y-c.y)/g.y,s=c.x+_*g.x;if(a.x===s)return 0;var w=(a.x-c.x)/g.x,S=c.y+w*g.y;return a.y===S?0:a.y<S?-1:1}},{key:"getIntersection",value:function(a){var c=this.bbox(),d=a.bbox(),g=Fy(c,d);if(g===null)return null;var _=this.leftSE.point,s=this.rightSE.point,w=a.leftSE.point,S=a.rightSE.point,A=of(c,w)&&this.comparePoint(w)===0,z=of(d,_)&&a.comparePoint(_)===0,L=of(c,S)&&this.comparePoint(S)===0,R=of(d,s)&&a.comparePoint(s)===0;if(z&&A)return R&&!L?s:!R&&L?S:null;if(z)return L&&_.x===S.x&&_.y===S.y?null:_;if(A)return R&&s.x===w.x&&s.y===w.y?null:w;if(R&&L)return null;if(R)return s;if(L)return S;var $=u5(_,this.vector(),w,a.vector());return $===null||!of(g,$)?null:Vf.round($.x,$.y)}},{key:"split",value:function(a){var c=[],d=a.events!==void 0,g=new Ps(a,!0),_=new Ps(a,!1),s=this.rightSE;this.replaceRightSE(_),c.push(_),c.push(g);var w=new e(g,s,this.rings.slice(),this.windings.slice());return Ps.comparePoints(w.leftSE.point,w.rightSE.point)>0&&w.swapEvents(),Ps.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),d&&(g.checkForConsuming(),_.checkForConsuming()),c}},{key:"swapEvents",value:function(){var a=this.rightSE;this.rightSE=this.leftSE,this.leftSE=a,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var c=0,d=this.windings.length;c<d;c++)this.windings[c]*=-1}},{key:"consume",value:function(a){for(var c=this,d=a;c.consumedBy;)c=c.consumedBy;for(;d.consumedBy;)d=d.consumedBy;var g=e.compare(c,d);if(g!==0){if(g>0){var _=c;c=d,d=_}if(c.prev===d){var s=c;c=d,d=s}for(var w=0,S=d.rings.length;w<S;w++){var A=d.rings[w],z=d.windings[w],L=c.rings.indexOf(A);L===-1?(c.rings.push(A),c.windings.push(z)):c.windings[L]+=z}d.rings=null,d.windings=null,d.consumedBy=c,d.leftSE.consumedBy=c.leftSE,d.rightSE.consumedBy=c.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var a=this.prev.consumedBy||this.prev;this._beforeState=a.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var a=this.beforeState();this._afterState={rings:a.rings.slice(0),windings:a.windings.slice(0),multiPolys:[]};for(var c=this._afterState.rings,d=this._afterState.windings,g=this._afterState.multiPolys,_=0,s=this.rings.length;_<s;_++){var w=this.rings[_],S=this.windings[_],A=c.indexOf(w);A===-1?(c.push(w),d.push(S)):d[A]+=S}for(var z=[],L=[],R=0,$=c.length;R<$;R++)if(d[R]!==0){var Z=c[R],de=Z.poly;if(L.indexOf(de)===-1)if(Z.isExterior)z.push(de);else{L.indexOf(de)===-1&&L.push(de);var ne=z.indexOf(Z.poly);ne!==-1&&z.splice(ne,1)}}for(var ce=0,K=z.length;ce<K;ce++){var Ee=z[ce].multiPoly;g.indexOf(Ee)===-1&&g.push(Ee)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var a=this.beforeState().multiPolys,c=this.afterState().multiPolys;switch(is.type){case"union":{var d=a.length===0,g=c.length===0;this._isInResult=d!==g;break}case"intersection":{var _,s;a.length<c.length?(_=a.length,s=c.length):(_=c.length,s=a.length),this._isInResult=s===is.numMultiPolys&&_<s;break}case"xor":{var w=Math.abs(a.length-c.length);this._isInResult=w%2===1;break}case"difference":{var S=function(z){return z.length===1&&z[0].isSubject};this._isInResult=S(a)!==S(c);break}default:throw new Error("Unrecognized operation type found ".concat(is.type))}return this._isInResult}}],[{key:"fromRing",value:function(a,c,d){var g,_,s,w=Ps.comparePoints(a,c);if(w<0)g=a,_=c,s=1;else if(w>0)g=c,_=a,s=-1;else throw new Error("Tried to create degenerate segment at [".concat(a.x,", ").concat(a.y,"]"));var S=new Ps(g,!0),A=new Ps(_,!1);return new e(S,A,[d],[s])}}]),e}(),RE=function(){function e(o,a,c){if(No(this,e),!Array.isArray(o)||o.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=a,this.isExterior=c,this.segments=[],typeof o[0][0]!="number"||typeof o[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var d=Vf.round(o[0][0],o[0][1]);this.bbox={ll:{x:d.x,y:d.y},ur:{x:d.x,y:d.y}};for(var g=d,_=1,s=o.length;_<s;_++){if(typeof o[_][0]!="number"||typeof o[_][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var w=Vf.round(o[_][0],o[_][1]);w.x===g.x&&w.y===g.y||(this.segments.push(bg.fromRing(g,w,this)),w.x<this.bbox.ll.x&&(this.bbox.ll.x=w.x),w.y<this.bbox.ll.y&&(this.bbox.ll.y=w.y),w.x>this.bbox.ur.x&&(this.bbox.ur.x=w.x),w.y>this.bbox.ur.y&&(this.bbox.ur.y=w.y),g=w)}(d.x!==g.x||d.y!==g.y)&&this.segments.push(bg.fromRing(g,d,this))}return Xr(e,[{key:"getSweepEvents",value:function(){for(var a=[],c=0,d=this.segments.length;c<d;c++){var g=this.segments[c];a.push(g.leftSE),a.push(g.rightSE)}return a}}]),e}(),d5=function(){function e(o,a){if(No(this,e),!Array.isArray(o))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new RE(o[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var c=1,d=o.length;c<d;c++){var g=new RE(o[c],this,!1);g.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=g.bbox.ll.x),g.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=g.bbox.ll.y),g.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=g.bbox.ur.x),g.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=g.bbox.ur.y),this.interiorRings.push(g)}this.multiPoly=a}return Xr(e,[{key:"getSweepEvents",value:function(){for(var a=this.exteriorRing.getSweepEvents(),c=0,d=this.interiorRings.length;c<d;c++)for(var g=this.interiorRings[c].getSweepEvents(),_=0,s=g.length;_<s;_++)a.push(g[_]);return a}}]),e}(),BE=function(){function e(o,a){if(No(this,e),!Array.isArray(o))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof o[0][0][0]=="number"&&(o=[o])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var c=0,d=o.length;c<d;c++){var g=new d5(o[c],this);g.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=g.bbox.ll.x),g.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=g.bbox.ll.y),g.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=g.bbox.ur.x),g.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=g.bbox.ur.y),this.polys.push(g)}this.isSubject=a}return Xr(e,[{key:"getSweepEvents",value:function(){for(var a=[],c=0,d=this.polys.length;c<d;c++)for(var g=this.polys[c].getSweepEvents(),_=0,s=g.length;_<s;_++)a.push(g[_]);return a}}]),e}(),f5=function(){Xr(e,null,[{key:"factory",value:function(a){for(var c=[],d=0,g=a.length;d<g;d++){var _=a[d];if(!(!_.isInResult()||_.ringOut)){for(var s=null,w=_.leftSE,S=_.rightSE,A=[w],z=w.point,L=[];s=w,w=S,A.push(w),w.point!==z;)for(;;){var R=w.getAvailableLinkedEvents();if(R.length===0){var $=A[0].point,Z=A[A.length-1].point;throw new Error("Unable to complete output ring starting at [".concat($.x,",")+" ".concat($.y,"]. Last matching segment found ends at")+" [".concat(Z.x,", ").concat(Z.y,"]."))}if(R.length===1){S=R[0].otherSE;break}for(var de=null,ne=0,ce=L.length;ne<ce;ne++)if(L[ne].point===w.point){de=ne;break}if(de!==null){var K=L.splice(de)[0],Ee=A.splice(K.index);Ee.unshift(Ee[0].otherSE),c.push(new e(Ee.reverse()));continue}L.push({index:A.length,point:w.point});var Y=w.getLeftmostComparator(s);S=R.sort(Y)[0].otherSE;break}c.push(new e(A))}}return c}}]);function e(o){No(this,e),this.events=o;for(var a=0,c=o.length;a<c;a++)o[a].segment.ringOut=this;this.poly=null}return Xr(e,[{key:"getGeom",value:function(){for(var a=this.events[0].point,c=[a],d=1,g=this.events.length-1;d<g;d++){var _=this.events[d].point,s=this.events[d+1].point;zE(_,a,s)!==0&&(c.push(_),a=_)}if(c.length===1)return null;var w=c[0],S=c[1];zE(w,a,S)===0&&c.shift(),c.push(c[0]);for(var A=this.isExteriorRing()?1:-1,z=this.isExteriorRing()?0:c.length-1,L=this.isExteriorRing()?c.length:-1,R=[],$=z;$!=L;$+=A)R.push([c[$].x,c[$].y]);return R}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var a=this.enclosingRing();this._isExteriorRing=a?!a.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var a=this.events[0],c=1,d=this.events.length;c<d;c++){var g=this.events[c];Ps.compare(a,g)>0&&(a=g)}for(var _=a.segment.prevInResult(),s=_?_.prevInResult():null;;){if(!_)return null;if(!s)return _.ringOut;if(s.ringOut!==_.ringOut)return s.ringOut.enclosingRing()!==_.ringOut?_.ringOut:_.ringOut.enclosingRing();_=s.prevInResult(),s=_?_.prevInResult():null}}}]),e}(),OE=function(){function e(o){No(this,e),this.exteriorRing=o,o.poly=this,this.interiorRings=[]}return Xr(e,[{key:"addInterior",value:function(a){this.interiorRings.push(a),a.poly=this}},{key:"getGeom",value:function(){var a=[this.exteriorRing.getGeom()];if(a[0]===null)return null;for(var c=0,d=this.interiorRings.length;c<d;c++){var g=this.interiorRings[c].getGeom();g!==null&&a.push(g)}return a}}]),e}(),p5=function(){function e(o){No(this,e),this.rings=o,this.polys=this._composePolys(o)}return Xr(e,[{key:"getGeom",value:function(){for(var a=[],c=0,d=this.polys.length;c<d;c++){var g=this.polys[c].getGeom();g!==null&&a.push(g)}return a}},{key:"_composePolys",value:function(a){for(var c=[],d=0,g=a.length;d<g;d++){var _=a[d];if(!_.poly)if(_.isExteriorRing())c.push(new OE(_));else{var s=_.enclosingRing();s.poly||c.push(new OE(s)),s.poly.addInterior(_)}}return c}}]),e}(),m5=function(){function e(o){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bg.compare;No(this,e),this.queue=o,this.tree=new J0(a),this.segments=[]}return Xr(e,[{key:"process",value:function(a){var c=a.segment,d=[];if(a.consumedBy)return a.isLeft?this.queue.remove(a.otherSE):this.tree.remove(c),d;var g=a.isLeft?this.tree.insert(c):this.tree.find(c);if(!g)throw new Error("Unable to find segment #".concat(c.id," ")+"[".concat(c.leftSE.point.x,", ").concat(c.leftSE.point.y,"] -> ")+"[".concat(c.rightSE.point.x,", ").concat(c.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var _=g,s=g,w=void 0,S=void 0;w===void 0;)_=this.tree.prev(_),_===null?w=null:_.key.consumedBy===void 0&&(w=_.key);for(;S===void 0;)s=this.tree.next(s),s===null?S=null:s.key.consumedBy===void 0&&(S=s.key);if(a.isLeft){var A=null;if(w){var z=w.getIntersection(c);if(z!==null&&(c.isAnEndpoint(z)||(A=z),!w.isAnEndpoint(z)))for(var L=this._splitSafely(w,z),R=0,$=L.length;R<$;R++)d.push(L[R])}var Z=null;if(S){var de=S.getIntersection(c);if(de!==null&&(c.isAnEndpoint(de)||(Z=de),!S.isAnEndpoint(de)))for(var ne=this._splitSafely(S,de),ce=0,K=ne.length;ce<K;ce++)d.push(ne[ce])}if(A!==null||Z!==null){var Ee=null;if(A===null)Ee=Z;else if(Z===null)Ee=A;else{var Y=Ps.comparePoints(A,Z);Ee=Y<=0?A:Z}this.queue.remove(c.rightSE),d.push(c.rightSE);for(var _e=c.split(Ee),fe=0,ve=_e.length;fe<ve;fe++)d.push(_e[fe])}d.length>0?(this.tree.remove(c),d.push(a)):(this.segments.push(c),c.prev=w)}else{if(w&&S){var Se=w.getIntersection(S);if(Se!==null){if(!w.isAnEndpoint(Se))for(var be=this._splitSafely(w,Se),De=0,ze=be.length;De<ze;De++)d.push(be[De]);if(!S.isAnEndpoint(Se))for(var Ke=this._splitSafely(S,Se),ct=0,nt=Ke.length;ct<nt;ct++)d.push(Ke[ct])}}this.tree.remove(c)}return d}},{key:"_splitSafely",value:function(a,c){this.tree.remove(a);var d=a.rightSE;this.queue.remove(d);var g=a.split(c);return g.push(d),a.consumedBy===void 0&&this.tree.insert(a),g}}]),e}(),FE=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,g5=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,v5=function(){function e(){No(this,e)}return Xr(e,[{key:"run",value:function(a,c,d){is.type=a,Vf.reset();for(var g=[new BE(c,!0)],_=0,s=d.length;_<s;_++)g.push(new BE(d[_],!1));if(is.numMultiPolys=g.length,is.type==="difference")for(var w=g[0],S=1;S<g.length;)Fy(g[S].bbox,w.bbox)!==null?S++:g.splice(S,1);if(is.type==="intersection"){for(var A=0,z=g.length;A<z;A++)for(var L=g[A],R=A+1,$=g.length;R<$;R++)if(Fy(L.bbox,g[R].bbox)===null)return[]}for(var Z=new J0(Ps.compare),de=0,ne=g.length;de<ne;de++)for(var ce=g[de].getSweepEvents(),K=0,Ee=ce.length;K<Ee;K++)if(Z.insert(ce[K]),Z.size>FE)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var Y=new m5(Z),_e=Z.size,fe=Z.pop();fe;){var ve=fe.key;if(Z.size===_e){var Se=ve.segment;throw new Error("Unable to pop() ".concat(ve.isLeft?"left":"right"," SweepEvent ")+"[".concat(ve.point.x,", ").concat(ve.point.y,"] from segment #").concat(Se.id," ")+"[".concat(Se.leftSE.point.x,", ").concat(Se.leftSE.point.y,"] -> ")+"[".concat(Se.rightSE.point.x,", ").concat(Se.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Z.size>FE)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(Y.segments.length>g5)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var be=Y.process(ve),De=0,ze=be.length;De<ze;De++){var Ke=be[De];Ke.consumedBy===void 0&&Z.insert(Ke)}_e=Z.size,fe=Z.pop()}Vf.reset();var ct=f5.factory(Y.segments),nt=new p5(ct);return nt.getGeom()}}]),e}(),is=new v5,_5=function(o){for(var a=arguments.length,c=new Array(a>1?a-1:0),d=1;d<a;d++)c[d-1]=arguments[d];return is.run("union",o,c)},y5=function(o){for(var a=arguments.length,c=new Array(a>1?a-1:0),d=1;d<a;d++)c[d-1]=arguments[d];return is.run("intersection",o,c)},x5=function(o){for(var a=arguments.length,c=new Array(a>1?a-1:0),d=1;d<a;d++)c[d-1]=arguments[d];return is.run("xor",o,c)},b5=function(o){for(var a=arguments.length,c=new Array(a>1?a-1:0),d=1;d<a;d++)c[d-1]=arguments[d];return is.run("difference",o,c)},VE={union:_5,intersection:y5,xor:x5,difference:b5};function w5(e,o){if(o=o||{},!WF(o))throw new Error("options is invalid");var a=o.propertyName;JF(e,"Polygon","dissolve");var c=[];if(o.propertyName){var d={};HF(e,function(w){Object.prototype.hasOwnProperty.call(d,w.properties[a])||(d[w.properties[a]]=[]),d[w.properties[a]].push(w)});for(var g=Object.keys(d),_=0;_<g.length;_++){var s=SE(VE.union.apply(null,d[g[_]].map(function(w){return w.geometry.coordinates})));s.properties[a]=g[_],c.push(s)}}else return AE(SE(VE.union.apply(null,e.features.map(function(w){return w.geometry.coordinates}))));return AE(K0(c))}const E5={class:"container"},S5=gn({__name:"MapSPF",setup(e){let o=Qe(50),a=Qe();function c(){o.value++}function d(){o.value--}const g=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[4,0,2,4,8,5,4,6,5,9,1,3,2,4,4,6],[3,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],[4,0,2,4,8,6,5,6,5,8,1,3,2,4,4,6],[5,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[6,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,1,5,9,2,3,2,4,3,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,8,2,5,9,1,3,2,4,4,6],[5,0,2,4,8,6,4,6,5,9,1,3,2,8,4,6],[1,0,2,4,8,6,4,6,4,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,2,2,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,5,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,3,9,1,3,2,4,4,6],[1,0,6,4,8,6,4,6,5,9,1,3,2,4,4,5],[1,2,2,4,1,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,6,4,6,5,9,1,3,2,4,4,6],[1,0,2,4,8,3,4,6,5,9,2,3,2,4,4,6],[8,0,2,4,8,6,4,6,7,9,1,3,2,4,4,6],[1,2,6,4,8,6,4,6,3,9,1,3,2,4,4,6],[1,6,2,4,8,6,4,6,5,9,1,3,2,5,4,6],[1,8,2,4,8,6,4,6,5,9,1,3,2,4,4,7],[1,0,2,4,8,6,4,6,3,9,1,3,2,4,4,6],[1,0,5,4,8,6,4,6,5,9,1,3,2,4,4,6]],_=["#FFEBEE","#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828","#B71C1C"];Qe(0);function s(L){return L===0?"black":_[L]}const w=K0([]),S=30,A=[120,30];let z;for(let L=0;L<S;L++){let R=IE(A,L+1,{steps:64,units:"kilometers"});const $=g[L];for(let Z=0;Z<16;Z++)$[Z]!==0&&(L===0?w.features.push(Ly([[A,...R.geometry.coordinates[0].slice(4*Z,4*(Z+1)+1),A]],{color:s($[Z])})):(z=IE(A,L,{steps:64,units:"kilometers"}),w.features.push(Ly([[...z.geometry.coordinates[0].slice(4*Z,4*(Z+1)+1),...R.geometry.coordinates[0].slice(4*Z,4*(Z+1)+1).reverse(),z.geometry.coordinates[0][4*Z]]],{color:s($[Z])}))));a=w5(w,{propertyName:"color"})}return(L,R)=>{const $=Os("v-geo-source"),Z=Os("v-fill-layer");return bi(),go("div",E5,[F(Ia,null,{default:fi(()=>[F($,{id:"spf",data:Xn(a)},null,8,["data"]),F(Z,{ref:"fillLayerRef",id:"spf",source:"spf",paint:{"fill-color":["get","color"],"fill-opacity":Xn(o)/100}},null,8,["paint"])]),_:1}),F(j0,{class:"slide-opacity mx-auto",width:"400",color:"primary",height:"74"},{default:fi(()=>[F(U0,null,{default:fi(()=>[F(yg,{modelValue:Xn(o),"onUpdate:modelValue":R[0]||(R[0]=de=>Pi(o)?o.value=de:o=de),color:"black","track-color":"grey",min:"0",max:"100",step:1},{prepend:fi(()=>[F(Fi,{size:"small",variant:"text",icon:"mdi-minus",color:"black",onClick:d})]),append:fi(()=>[F(Fi,{size:"small",variant:"text",icon:"mdi-plus",color:"black",onClick:c})]),_:1},8,["modelValue"])]),_:1})]),_:1})])}}});const T5=wa(S5,[["__scopeId","data-v-6caf2904"]]),C5=gn({__name:"MapPopulation",setup(e){return(o,a)=>(bi(),go("div",null,[F(Ia)]))}}),I5=gn({__name:"MapWorldMeteorology",setup(e){return(o,a)=>(bi(),go("div",null,[F(Ia)]))}}),A5=gn({__name:"MapTyphoon",setup(e){return(o,a)=>(bi(),go("div",null,[F(Ia)]))}}),k5=gn({__name:"MapInversion",setup(e){return(o,a)=>(bi(),go("div",null,[F(Ia)]))}}),G_=gn({__name:"MapDose",setup(e){return(o,a)=>(bi(),go("div",null,[F(Ia)]))}}),M5=[{path:"/",components:{left_draw:nf,main_view:_c}},{path:"/index",name:"index",components:{left_draw:nf,main_view:_c}},{path:"/finance",name:"finance",components:{left_draw:O_,main_view:_c}},{path:"/meteorology",name:"meteorology",components:{left_draw:qm,main_view:_c}},{path:"/nuclear",name:"nuclear",components:{left_draw:Zm,main_view:_c}},{path:"/evacuate",name:"evacuate",components:{left_draw:F_,main_view:T5}},{path:"/index/index",name:"sub_index",components:{left_draw:nf,main_view:_c}},{path:"/index/land",name:"land",components:{left_draw:nf,main_view:$_}},{path:"/index/elevation",name:"elevation",components:{left_draw:nf,main_view:jF}},{path:"/finance/gdp",name:"gdp",components:{left_draw:O_,main_view:_c}},{path:"/finance/density",name:"density",components:{left_draw:O_,main_view:C5}},{path:"/meteorology/weather",name:"weather",components:{left_draw:qm,main_view:I5}},{path:"/meteorology/typhoon",name:"typhoon",components:{left_draw:qm,main_view:A5}},{path:"/meteorology/inversion",name:"inversion",components:{left_draw:qm,main_view:k5}},{path:"/nuclear/single",name:"single",components:{left_draw:Zm,main_view:G_}},{path:"/nuclear/multiple",name:"multiple",components:{left_draw:Zm,main_view:G_}},{path:"/nuclear/single",name:"single",components:{left_draw:Zm,main_view:G_}},{path:"/evacuate/success",name:"success",components:{left_draw:F_,main_view:$_}},{path:"/evacuate/failure",name:"failure",components:{left_draw:F_,main_view:$_}}],P5=Wz({history:cz(),routes:M5});jP(QD).use(P5).use(I3).use(IR).mount("#app");
